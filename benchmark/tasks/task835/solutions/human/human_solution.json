[
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <boost/range/algorithm.hpp>\n#include <boost/range/numeric.hpp>\n#include <boost/range/irange.hpp>\n#include <boost/range/adaptor/indexed.hpp>\nusing namespace std;\nusing namespace boost;\nusing namespace adaptors;\nusing ll = int64_t;\nusing vecint = vector<int>;\nusing vecll = vector<ll>;\n\nstring solve(const string& s) {\n  int n = s.size();\n  int mx = 0;\n  int cnt = 0;\n  string last = \"\";\n  for(const auto& p : index(s)) {\n    if (p.value() == 'b') {\n      ++cnt;\n      if (cnt > mx) {\n        mx = cnt;\n        last = \"\";\n      }\n      if (cnt == mx) {\n        last = max(last, s.substr(p.index()+1));\n      }\n    } else {\n      --cnt;\n    }\n  }\n  if (mx == 0) {\n    vecint dp(n+1);\n    vecint apos(n);\n    int cnt_a = 0;\n    int cnt_b = 0;\n    for (const auto& p : index(s)) {\n      if (p.value() == 'a') {\n        dp[p.index()+1] = dp[p.index()];\n        apos[cnt_a] = p.index();\n        ++cnt_a;\n      } else {\n        dp[p.index()+1] = max(dp[p.index()], dp[apos[cnt_b]]+1);\n        ++cnt_b;\n      }\n    }\n    int rep = dp[n];\n    string res = \"\";\n    for (auto i : irange(0, rep)) res += \"ab\";\n    return res;\n  } else {\n    return string(mx, 'b') + last;\n  }\n}\n\nint main() {\n  int n;\n  cin>>n;\n  string s;\n  cin>>s;\n  int cnt = 0;\n  int old = 0;\n  vector<string> subs;\n  for(const auto& p : index(s)) {\n    if (p.value() == 'a') {\n      ++cnt;\n    } else {\n      --cnt;\n    }\n    if (cnt == 0) {\n      subs.push_back(s.substr(old, p.index()-old+1));\n      old = p.index()+1;\n    }\n  }\n  boost::reverse(subs);\n  string res = \"\";\n  for (const auto& sub : subs) {\n    auto tmp = solve(sub);\n    res = max(res, tmp + res);\n  }\n  cout << res << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nstring HandleAB(string s) {\n\tint cnt_a = 0, cnt_b = 0, nxt_b = 0;\n\tstring ans = \"\";\n\tfor (int i = 0; i < s.length(); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\tcnt_a++;\n\t\t} else {\n\t\t\tif (cnt_b == nxt_b) {\n\t\t\t\tans += \"ab\";\n\t\t\t\tnxt_b = cnt_a;\n\t\t\t}\n\t\t\t++cnt_b;\n\t\t}\n\t}\n\treturn ans;\n}\n\nstring HandleBA(string s) {\n\tstring ans;\n\twhile (!s.empty()) {\n\t\tif (s > ans) {\n\t\t\tans = s;\n\t\t}\n\t\tint fst_a = 0;\n\t\tfor (int i = 0; i < s.length(); ++i) {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\tfst_a = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\ts = s.substr(1, fst_a - 1) + s.substr(fst_a + 1);\n\t}\n\treturn ans;\n}\n\nstring Solve(string s) {\n\tif (s.empty()) {\n\t\treturn s;\n\t}\n\tint break_point = 0;\n\tint diff = 0;\n\tfor (int i = 0; i < s.length(); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\tdiff++;\n\t\t} else {\n\t\t\tdiff--;\n\t\t}\n\t\tif (diff == 0) {\n\t\t\tbreak_point = i+1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstring suffix = Solve(s.substr(break_point));\n\ts = s.substr(0, break_point);\n\tif (s[0] == 'a') {\n\t\ts = HandleAB(s) + suffix;\n\t} else {\n\t\ts = HandleBA(s) + suffix;\n\t}\n\tif (s > suffix) {\n\t\treturn s;\n\t} else {\n\t\treturn suffix;\n\t}\n}\n\nint main() {\n\tint n;\n\tcin >> n;\n\tstring s;\n\tcin >> s;\n\tcout << Solve(s) << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define ld long double\n#define db double\n#define pint pair<int,int>\n#define mk(x,y) make_pair(x,y)\n#define fir first\n#define sec second\n#define Rep(x,y,z) for(int x=y;x<=z;x++)\n#define Red(x,y,z) for(int x=y;x>=z;x--)\nusing namespace std;\nconst int MAXN=6e3+5;\nchar buf[1<<12],*p1=buf,*p2=buf,nc;int ny;\n//inline char gc() {return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<12,stdin),p1==p2)?EOF:*p1++;}\ninline char gc(){return getchar();}\ninline int read(){\n\tint x=0;for(ny=1;nc=gc(),(nc<48||nc>57)&&nc!=EOF;)if(nc==45)ny=-1;if(nc<0)return nc;\n\tfor(x=nc-48;nc=gc(),47<nc&&nc<58&&nc!=EOF;x=(x<<3)+(x<<1)+(nc^48));return x*ny;\n}int n,tmp,p[MAXN],kind[MAXN],cnt,bel[MAXN];string s,F[MAXN];\nint main(){\n\tn=read(),cin>>s,p[0]=-1;\n\tRep(i,0,2*n-1){\n\t\ttmp+=s[i]=='a'?1:-1;\n\t\tif(!tmp)p[++cnt]=i,kind[cnt]=s[i]=='a';\n\t}bool flg=1;\n\tRed(i,cnt,1){\n\t\tif(kind[i]){\n\t\t\tint s1=0,s2=0;\n\t\t\tRep(j,p[i-1]+1,p[i])if(s[j]=='a')bel[j]=++s1;else bel[j]=++s2;\n\t\t\tF[i]=F[i+1],flg=0;\n\t\t\tRep(j,1,s1){\n\t\t\t\tstring cur;\n\t\t\t\tRep(k,p[i-1]+1,p[i])if(bel[k]>=j)cur+=s[k];\n\t\t\t\tF[i]=max(F[i],cur+F[i+1]);\n\t\t\t}\n\t\t}else if(flg){\n\t\t\tint s1=0,s2=0;\n\t\t\tRep(j,p[i-1]+1,p[i])if(s[j]=='a')bel[j]=++s1;else bel[j]=++s2;\n\t\t\tfor(int r=p[i-1]+1;;){\n\t\t\t\tfor(;r<=p[i]&&s[r]=='b';r++);\n\t\t\t\tif(r>p[i])break;int t=bel[r];\n\t\t\t\tfor(r++,F[i]+=\"ab\";bel[r]!=t;r++);r++;\n\t\t\t}F[i]+=F[i+1];\n\t\t}else F[i]=F[i+1];\n\t}cout<<F[1]<<'\\n';\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>/*{{{*/\n#include<cctype>\n#include<cassert>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<ctime>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<set>\n#include<vector>\nusing namespace std;\ntypedef long long lld;\ntypedef long double lf;\ntypedef unsigned long long uld;\ntypedef pair<int,int> pii;\n#define fi first\n#define se second\n#define pb push_back\n#define mk make_pair\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define ROF(i,a,b) for(int i=(a);i>=(b);--i)\nnamespace RA{\n    int r(int p){return 1ll*rand()*rand()%p;}\n    int r(int L,int R){return r(R-L+1)+L;}\n}/*}}}*/\n/******************heading******************/\nconst int N=3050*2;\n\nint n;\nchar s[N];\nstring a[N];\nint la;\n\nvoid del_a(string &s){\n    for(string::iterator it=s.begin();it!=s.end();it++){\n        if(*it=='a')return s.erase(it),void();\n    }\n}\nvoid del_b(string &s){\n    for(string::iterator it=s.begin();it!=s.end();it++){\n        if(*it=='b')return s.erase(it),void();\n    }\n}\nstring calc(string s){\n    //cout<<\"calc \"<<s<<endl;\n    if(s[0]=='a'){\n        string res=\"\";\n        res.pb(s[0]);\n        char las=s[0];\n        for(char c:s){\n            if(c!=las)res.pb(c),las=c;\n        }\n        //cout<<\"res=\"<<res<<endl;\n        return res;\n    }else {\n        string res=s;\n        while(s!=\"\"){\n            del_a(s);\n            del_b(s);\n            res=max(res,s);\n        }\n        //cout<<\"res=\"<<res<<endl;\n        return res;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    scanf(\"%s\",s+1);\n    int ca=0,cb=0;\n    string t=\"\";\n    FOR(i,1,n*2){\n        if(s[i]=='a')ca++;\n        else cb++;\n        t.pb(s[i]);\n        if(ca==cb)a[++la]=calc(t),t=\"\";\n    }\n    assert(t==\"\");\n    string ans=\"\";\n    ROF(i,la,1)ans=max(ans,a[i]+ans);\n    cout<<ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define REP(i,a,b) for(int i=(a),_end_=(b);i<=_end_;i++)\n#define DREP(i,a,b) for(int i=(a),_end_=(b);i>=_end_;i--)\n#define EREP(i,u) for(int i=start[u];i;i=e[i].next)\n#define fi first\n#define se second\n#define mkr(a,b) make_pair(a,b)\n#define SZ(A) ((int)A.size())\ntemplate<class T>inline void chkmin(T &a,T b){ if(a>b)a=b;}\ntemplate<class T>inline void chkmax(T &a,T b){ if(a<b)a=b;}\ninline int read()\n{\n\tint s=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch) && ch!='-')ch=getchar();\n\tif(ch=='-')ch=getchar(),f=-1;\n\twhile(isdigit(ch))s=s*10+ch-'0',ch=getchar();\n\treturn ~f?s:-s;\n}\n\nconst int maxn=3e3+20;\n\nchar str[maxn];\nint s[maxn];\nint a[maxn],b[maxn];\nint n;\n\nbitset<3020>f[maxn];\n\ninline void init()\n{\n\tn=read();\n\tint an=0,bn=0;\n\tscanf(\"%s\",str+1);\n\tREP(i,1,2*n)\n\t{\n\t\tif(str[i]=='a')a[++an]=i,s[i]=an;\n\t\telse b[++bn]=i,s[i]=bn+n;\n\t}\n}\n\ninline string GetString(bitset<3020>f)\n{\n\tstatic int vis[6020];\n\tmemset(vis,0,sizeof(int)*(2*n+1));\n\tREP(i,1,n)if(f[i])vis[a[i]]=1,vis[b[i]]=1;\n\tstring S;\n\tREP(i,1,2*n)if(vis[i])S+=str[i];\n\treturn S;\n}\n\ninline int ID(int x){ return s[x]>n?s[x]-n:s[x];}\n\ninline void doing()\n{\n\tDREP(i,n,1)\n\t{\n\t\tf[i]=f[i+1];\n\t\tbitset<3020>tmp;\n\t\ttmp.set(i);\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\t//tmp|=f[i+b[i]-a[i]];\n\t\t\tint far=i;\n\t\t\tREP(j,a[i]+1,b[i]-1)chkmax(far,ID(j));\n\t\t\ttmp|=f[far+1];\n\t\t}else {\n\t\t\tint far=a[i];\n\t\t\t//REP(j,b[i]+1,far)\n\t\t\tfor(int j=b[i]+1;j<=far;j++)\n\t\t\t\tif(ID(j)>i && s[j]>n)tmp.set(s[j]-n),chkmax(far,a[s[j]-n]);\n\t\t\tint to=far+1;\n\t\t\tif(to<=2*n)\n\t\t\t{\n\t\t\t\tto=s[to]>n?s[to]-n:s[to];\n\t\t\t\ttmp|=f[to];\n\t\t\t}\n\t\t}\n\t\tstring A=GetString(f[i]),B=GetString(tmp);\n\t\tf[i]=A>B?f[i]:tmp;\n\t}\n\tstring s=GetString(f[1]);\n\tcout<<s<<endl;\n\t\n}\n\nint main()\n{\n\tinit();\n\tdoing();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 3005;\n\nint n;\nint p[2][N], sz[2];\nint nxt[N * 2];\nbool vis[N * 2];\nstring s;\n\nstruct Data {\n\tstring s; int l, r;\n\n\tbool operator < (const Data& rhs) const {\n\t\treturn make_pair(s, -l) < make_pair(rhs.s, -rhs.l);\n\t}\n};\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> n >> s;\n\tfor (int i = 0; i < n * 2; ++i) {\n\t\tint x = s[i] - 'a'; p[x][sz[x]++] = i;\n\t}\n\tfor (int i = 0; i < n; ++i) {\n\t\tnxt[p[0][i]] = p[1][i], nxt[p[1][i]] = p[0][i];\n\t}\n\tvector<Data> vec;\n\tfor (int i = 0; i < n * 2; ++i) {\n\t\tif (s[i] != 'b' || i > nxt[i]) continue;\n\t\tstring tmp;\n\t\tint lim = i;\n\t\tfor (int j = i; j <= lim; ++j) {\n\t\t\tif (j < nxt[j] && s[j] == 'b') vis[j] = vis[nxt[j]] = 1, lim = nxt[j];\n\t\t}\n\t\tfor (int j = i; j <= lim; ++j) {\n\t\t\tif (vis[j]) tmp += s[j], vis[j] = 0;\n\t\t}\n\t\tvec.push_back({tmp, i, lim});\n\t}\n\tsort(vec.begin(), vec.end());\n\treverse(vec.begin(), vec.end());\n\tint cur = 0;\n\tstring res;\n\tfor (auto i : vec) {\n\t\tif (i.l < cur) continue;\n\t\tcur = i.r, res += i.s;\n\t}\n\tfor (int i = cur; i < n * 2; ++i) {\n\t\tif (i < nxt[i]) vis[i] = vis[nxt[i]] = 1, i = nxt[i]; \n\t}\n\tfor (int i = cur; i < n * 2; ++i) {\n\t\tif (vis[i]) res += s[i];\n\t}\n\tcout << res;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define cs const\n#define re register\n#define pb push_back\n#define pii pair<int,int>\n#define ll long long\n#define y1 shinkle\n#define fi first\n#define se second\n#define bg begin\nnamespace IO{\n\ncs int RLEN=1<<20|1;\ninline char gc(){\n    static char ibuf[RLEN],*ib,*ob;\n    (ib==ob)&&(ob=(ib=ibuf)+fread(ibuf,1,RLEN,stdin));\n    return (ib==ob)?EOF:*ib++;\n}\ninline int read(){\n    char ch=gc();\n    int res=0;bool f=1;\n    while(!isdigit(ch))f^=ch=='-',ch=gc();\n    while(isdigit(ch))res=(res*10)+(ch^48),ch=gc();\n    return f?res:-res;\n}\ninline ll readll(){\n    char ch=gc();\n    ll res=0;bool f=1;\n    while(!isdigit(ch))f^=ch=='-',ch=gc();\n    while(isdigit(ch))res=(res*10)+(ch^48),ch=gc();\n    return f?res:-res;\n}\ninline char readchar(){\n\tchar ch=gc();\n\twhile(isspace(ch))ch=gc();\n\treturn ch;\n}\ninline int readstring(char *s){\n\tint top=0;char ch=gc();\n\twhile(isspace(ch))ch=gc();\n\twhile(!isspace(ch)&&ch!=EOF)s[++top]=ch,ch=gc();\n\ts[top+1]='\\0';return top;\n}\n\n}\nusing IO::read;\nusing IO::readll;\nusing IO::readstring;\nusing IO::readchar; \ntemplate<typename tp>inline void chemx(tp &a,tp b){(a<b)?(a=b):0;}\ntemplate<typename tp>inline void chemn(tp &a,tp b){(a>b)?(a=b):0;}\ncs int N=6005;\nstring f[N];\nint bel[N],pos[N],kd[N],n,cnt;\nchar str[N];\nint main(){\n\t#ifdef Stargazer\n\tfreopen(\"lx.in\",\"r\",stdin);\n\t#endif\n\tn=read();readstring(str);\n\tfor(int i=1,s=0;i<=2*n;i++){\n\t\ts+=(str[i]=='a'?1:-1);\n\t\tif(!s){\n\t\t\tpos[++cnt]=i,kd[cnt]=(str[i]=='a');\n\t\t}\n\t}\n\tbool vt=0;\n\tfor(int i=cnt;i;i--)\n\tif(kd[i]){\n\t\tvt=1;\n\t\tint c1=0,c2=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n\t\tif(str[j]=='a')bel[j]=++c1;else bel[j]=++c2;\n\t\tf[i]=f[i+1];\n\t\tfor(int j=1;j<=c1;j++){\n\t\t\tstring now;\n\t\t\tfor(int k=pos[i-1]+1;k<=pos[i];k++)\n\t\t\tif(bel[k]>=j)now=now+str[k];\n\t\t\tf[i]=max(f[i],now+f[i+1]);\n\t\t}\n\t}\n\telse if(!vt){\n\t\tint c1=0,c2=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n\t\tif(str[j]=='a')bel[j]=++c1;else bel[j]=++c2;\n\t\tfor(int r=pos[i-1]+1;;){\n\t\t\twhile(r<=pos[i]&&str[r]=='b')r++;\n\t\t\tif(r>pos[i])break;\n\t\t\tf[i]+=\"ab\";\n\t\t\tint t=bel[r];r++;\n\t\t\tif(bel[r]!=t)r++;\n\t\t\tr++;\n\t\t}f[i]+=f[i+1];\n\t}\n\telse f[i]=f[i+1];\n\tcout<<f[1];return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[2 * N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.resize(b.size());\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans,)\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <set>\n#include <map>\n#include <list>\n#include <time.h>\n#include <math.h>\n#include <random>\n#include <deque>\n#include <queue>\n#include <cassert>\n#include <unordered_map>\n#include <unordered_set>\n#include <iomanip>\n#include <bitset>\n#include <sstream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nmt19937 rnd(228);\n\nconst int N = 6000 + 7;\n\nstring dp[N][N][2];\nint type[N];\n\nint main()\n{\n#ifdef ONPC\n    freopen(\"a.in\", \"r\", stdin);\n#endif\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n    int n;\n    cin >> n;\n    n *= 2;\n    string s;\n    cin >> s;\n    vector <int> l, r;\n    for (int i = 0; i < n; i++)\n    {\n        if (s[i] == 'a') l.push_back(i);\n        else r.push_back(i);\n    }\n    vector <bool> open(n);\n    vector <int> par(n);\n    for (int i = 0; i < n / 2; i++)\n    {\n        par[min(l[i], r[i])] = max(l[i], r[i]);\n        open[min(l[i], r[i])] = 1;\n    }\n    vector <bool> grab(n);\n    for (int it = 0; it < n; it++)\n    {\n        string t = \"\";\n        for (int i = 0; i < n; i++)\n        {\n            if (grab[i])\n            {\n                t += s[i];\n            }\n        }\n        int pos = -1;\n        for (int i = n - 1; i >= 0; i--)\n        {\n            if (open[i] && !grab[i])\n            {\n                grab[i] = grab[par[i]] = 1;\n                string q = \"\";\n                for (int j = 0; j < n; j++)\n                {\n                    if (grab[j])\n                    {\n                        q += s[j];\n                    }\n                }\n                if (q > t)\n                {\n                    t = q;\n                    pos = i;\n                }\n                grab[i] = grab[par[i]] = 0;\n            }\n        }\n        if (pos != -1)\n        {\n            grab[pos] = grab[par[pos]] = 1;\n        }\n        else\n        {\n            break;\n        }\n    }\n    string t = \"\";\n    for (int i = 0; i < n; i++)\n    {\n        if (grab[i])\n        {\n            t += s[i];\n        }\n    }\n    cout << t << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "/*====Corycle====*/\n#include<algorithm>\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cstdlib>\n#include<complex>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<ctime>\n#include<stack>\n#include<queue>\n#include<map>\n#define ll long long\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nconst int N=6005;\nint read(){\n\tint s=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){s=s*10+c-'0';c=getchar();}\n\treturn s*f;\n}\nstring S,F[N];\nint n,m,id[N],PosA[N],PosB[N],nxt[N];\nint main(){\n//\tfreopen(\"_.in\",\"r\",stdin);\n//\tfreopen(\"_.out\",\"w\",stdout);\n\tn=read();cin>>S;S=\" \"+S;\n\tfor(int i=1,n1=0,n2=0;i<=n*2;i++){\n\t\tif(S[i]=='a')PosA[id[i]=++n1]=i;\n\t\tif(S[i]=='b')PosB[id[i]=++n2]=i;\n\t}\n\tid[PosA[n+1]=PosB[n+1]=n*2+1]=n+1;\n\tfor(int i=1,j=1;i<=n+1;i++)while(j<min(PosA[i],PosB[i])){nxt[j]=i;j++;}\n\tfor(int i=n;i>=1;i--){\n\t\tif(PosA[i]<PosB[i])F[i]=\"ab\"+F[nxt[PosB[i]]];\n\t\telse{\n\t\t\tint j=PosB[i],k=PosA[i];\n\t\t\twhile(j<=k&&(id[j]<=i||PosB[id[j]]<=k)){\n\t\t\t\tif(id[j]>=i){F[i]+=S[j];k=max(k,PosA[id[j]]);}\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tF[i]+=F[id[j]];\n\t\t}\n\t\tF[i]=max(F[i],F[i+1]);\n\t}\n\tcout<<F[1]<<'\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nint n;\nstring s;\nint a[3005], b[3005];\nint order[6005];\n\nstring calc(int l, int r, string &ans)\n{\n\tstring ret;\n\tif(s[l] == 'a'){\n\t\tif(ans.size() && ans[0] == 'b') return ans;\n\t\tint x = l;\n\t\twhile(x <= r){\n\t\t\tret += \"ab\";\n\t\t\tx = b[order[x]];\n\t\t\twhile(x <= r && s[x] != 'a') x++;\n\t\t}\n\t\tret += ans;\n\t\treturn ret;\n\t}\n\t\n\tret = ans;\n\tfor(int i = l; i <= r; i++){\n\t\tif(s[i] == 'a') continue;\n\t\tint p = a[order[i]];\n\t\tstring tmp;\n\t\tfor(int j = i; j <= r; j++){\n\t\t\tif(s[j] == 'b') tmp += \"b\";\n\t\t\telse if(j >= p) tmp += \"a\";\n\t\t}\n\t\tret = max(ret, tmp + ans);\n\t}\n\treturn ret;\n}\n\nint main(void)\n{\n\tcin >> n;\n\tcin >> s;\n\ts = \"#\" + s;\n\tn *= 2;\n\t\n\tint aid = 1, bid = 1;\n\tfor(int i = 1; i <= n; i++){\n\t\tif(s[i] == 'a') a[aid] = i, order[i] = aid++;\n\t\tif(s[i] == 'b') b[bid] = i, order[i] = bid++;\n\t}\n\t\n\tstring ans; int l = n+1, r = n;\n\tfor(int i = n; i >= 1; i--){\n\t\tif(s[i] == 'a') l = min(l, b[order[i]]);\n\t\tif(s[i] == 'b') l = min(l, a[order[i]]);\n\t\tif(i == l){\n\t\t\tans = calc(l, r, ans);\n\t\t\tr = l-1;\n\t\t}\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int i = 0;\n    while (i < s.size()){\n        int b = 2*(s[i] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=i+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if ((B < 0 && b > 0) || (b < 0 && B > 0)){\n                g.push_back({i, j-1});\n                good.push_back(b < 0);\n                i = j;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({i, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    if (b > 0) break;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw) continue;\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define LL long long\n#define fgx cerr<<\"--------------\"<<endl;\n#define dgx cerr<<\"==============\"<<endl;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nconst int MAXN = 100010;\nconst int INF = 2147483600;\n\nint N; char s[MAXN+1]; \nint vis[MAXN+1]; int pos[MAXN+1]; int p[MAXN+1];\n\ninline void prt(vector<int> &x){\n\tcout<<\"Prt:\";\n\tfor(int i=x.size()-1;i>=0;i--){\n\t\tcout<<(char)('a'+x[i]);\n\t} cout<<endl;\n}\ninline int Link(int x){ x=p[x]; return pos[(x>N/2?x-N/2:x+N/2)]; }\ninline void Update(int &l1,int &r1,vector<int>& A1,int l2,int r2,vector<int>& A2,bool opr){\n\tif(!A1.size()){ A1.clear(); for(int l=0;l<(int)A2.size();l++) A1.push_back(A2[l]); l1=l2; r1=r2; return ; } bool flag=1;\n\tint sz1=A1.size(),sz2=A2.size();\n\tfor(int l=1;l<=min(sz1,sz2);l++){\n\t\tif(A1[sz1-l]>A2[sz2-l]) {flag=0; break;}\n\t\tif(A1[sz1-l]<A2[sz2-l]) {flag=1; break;}\n\t}\n\tif(flag){\n\t\tl1=l2; r1=r2;\n\t\tif(!opr) A1.clear();\n\t\tfor(int l=0;l<(int)A2.size();l++)\t\n\t\t\tA1.push_back(A2[l]);\n\t} return ;\n} vector<int> Ans,Ans2;\n\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tN=read()*2; scanf(\"%s\",s+1); int nowa=0,nowb=0;\n\tfor(int i=1;i<=N;i++){\n\t\tif(s[i]=='a') p[i]=nowa+1,++nowa;\n\t\telse p[i]=nowb+N/2+1,++nowb;\n\t\tpos[p[i]]=i;\n\t} int l1=INF,r1=INF,l2=0,r2=0; int tim=0,lastk=0;\n\tfor(int i=N;i>=1;i--){\n\t\tint k=Link(i);\n\t\tif(k<i) continue;\n\t\tif(s[i]=='b'){\n\t\t\tvector<int> n; n.clear(); ++tim;\n\t\t\tint j=i; n.push_back((int)s[i]-'a'); vis[k]=tim;\n\t\t\twhile(j<=k){\n\t\t\t\t++j; if(vis[j]==tim) n.push_back((int)s[j]-'a'); int to=Link(j);\n\t\t\t\tif(s[j]=='b'&&to>=j) k=to,vis[to]=tim,n.push_back(1);\n\t\t\t}\n\t\t\tif(k!=lastk&&lastk){\n\t\t\t\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\t\t\t\tAns2.clear(); l2=0,r2=0;\n\t\t\t} \n\t\t\treverse(n.begin(),n.end());\n\t\t\tUpdate(l2,r2,Ans2,i,k,n,0);\n\t\t} else{\n\t\t\tvector<int> n; n.clear();\n\t\t\tn.push_back(1); n.push_back(0);\n\t\t\tif(k!=lastk&&lastk){\n\t\t\t\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\t\t\t\tAns2.clear(); l2=0,r2=0;\n\t\t\t} \n\t\t\tif(k<l1) Update(l1,r1,Ans,i,k,n,1);\n\t\t}\n\t\tlastk=k;\n\t} \n\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\tAns2.clear(); l2=0,r2=0;\n\tfor(int i=Ans.size()-1;i>=0;i--)\n\t\tprintf(\"%c\",(char)(Ans[i]+'a'));\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(i,l,r){\n        if(S[i]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  vector<string> dp(s.size()+1);\n  REP(i,s.size()) REP(j,i+1){\n    chmax(dp[i+1],dp[j]+s[i]);\n  }\n\n  cout << dp.back() << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <memory.h>\n#include <math.h>\n#include <assert.h>\n#include <queue>\n#include <map>\n#include <set>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <functional>\n#include <unordered_map>\n\nusing namespace std;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define Fi first\n#define Se second\n#define pb(x) push_back(x)\n#define szz(x) (int)x.size()\n#define rep(i, n) for(int i=0;i<n;i++)\n#define all(x) x.begin(), x.end()\ntypedef tuple<int, int, int> t3;\n\nchar S[6060];\nint pl[3030], pr[3030];\nint mat[6060];\nint N;\n\nstring Do2(int l, int r) {\n\tstring res = \"\";\n\tfor(int i=l;i<=r;) {\n\t\tif(S[i] == 'a') i = mat[i] + 1, res.pb('a'), res.pb('b');\n\t\telse ++i;\n\t}\n\treturn res;\n}\n\nstring Do(string X) {\n\tint max_val = 0, n = szz(X), now = 0;\n\tvector <int> pv;\n\trep(i, n) {\n\t\tif(X[i] == 'b') ++now;\n\t\telse --now;\n\t\tif(max_val < now) {\n\t\t\tmax_val = now;\n\t\t\tpv.clear();\n\t\t\tpv.pb(i);\n\t\t}\n\t\telse if(max_val == now) pv.pb(i);\n\t}\n\tstring res = \"\";\n\tfor(int e : pv) {\n\t\tstring tt = \"\";\n\t\trep(j, max_val) tt.pb('b');\n\t\tfor(int j=e+1;j<n;j++) tt.pb(X[j]);\n\t\tif(res < tt) res = tt;\n\t}\n\treturn res;\n}\n\nvoid solve(){\n\tscanf(\"%d%s\", &N, S + 1);\n\tN *= 2;\n\tint ca = 0, cb = 0;\n\tfor(int i=1;i<=N;i++) {\n\t\tif(S[i] == 'a') pl[++ca] = i;\n\t\telse pr[++cb] = i;\n\t}\n\tfor(int i=1;i<=N/2;i++) mat[pl[i]] = pr[i], mat[pr[i]] = pl[i];\n\tint val[6060] = {};\n\tfor(int i=1;i<=N;i++) val[i] = val[i-1] + (S[i] == 'b' ? 1 : -1);\n\tint md = 0, p = -1;\n\tstring res = \"\";\n\tfor(int i=1;i<=N;i++) {\n\t\tif(md == 0) md = val[i], p = i;\n\t\tif(i == N || (val[i] == 0 && !(md == -1 && val[i+1] == -1))) {\n\t\t\tstring tt = \"\";\n\t\t\tfor(int j=p;j<=i;j++) tt.pb(S[j]);\n\t\t\tif(md == 1) res = res + Do(tt);\n\t\t\telse {\n\t\t\t\tif(i == N) res = res + Do2(p, i);\n\t\t\t}\n\t\t\tmd = 0;\n\t\t}\n\t}\n\tprintf(\"%s\\n\", res.c_str());\n}\n\nint main(){\n\tint Tc = 1; //scanf(\"%d\", &Tc);\n\tfor(int tc=1;tc<=Tc;tc++){\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 6020\n#define rep(i,l,r) for(register int i = l ; i <= r ; i++)\n#define repd(i,r,l) for(register int i = r ; i >= l ; i--)\n#define rvc(i,S) for(register int i = 0 ; i < (int)S.size() ; i++)\n#define rvcd(i,S) for(register int i = ((int)S.size()) - 1 ; i >= 0 ; i--)\n#define fore(i,x)for (register int i = head[x] ; i ; i = e[i].next)\n#define pb push_back\n#define prev prev_\n#define stack stack_\n#define mp make_pair\n#define fi first\n#define se second\n#define inf 0x3f3f3f3f\ntypedef long long ll;\ntypedef pair<int,int> pr;\n\nchar ch[maxn],ans[maxn],tmp[maxn],cur[maxn];\nint n,a[maxn],b[maxn],tota,totb,tot,len,len2,clen[maxn],tag[maxn];\nchar vec[maxn / 2][maxn];\n\nvoid getmx1(int x,int l,int r){\n\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\tint lastb = b[l];\n\trep(i,l + 1,r){\n\t\tif ( a[i] > lastb ){\n\t\t\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\t\t\tlastb = b[i];\n\t\t}\n\t}\n}\ninline int cmp(char s[],int l1,char t[],int l2){\n\trep(i,1,min(l1,l2)){\n\t\tif ( s[i] != t[i] ) return s[i] > t[i];\n\t}\n\treturn l1 >= l2;\n}\nvoid getmx2(int x,int l,int r){\n\tlen = 2;\n\ttmp[1] = 'b' , tmp[2] = 'a';\n\trep(i,l,r - 1){\n\t\tlen2 = 0;\n\t\tint pa = i , pb = i;\n\t\twhile ( pa <= r && pb <= r ){\n\t\t\tif ( a[pa] < b[pb] ) cur[++len2] = 'a' , pa++;\n\t\t\telse cur[++len2] = 'b' , pb++;\n\t\t}\n\t\twhile ( pa <= r ) cur[++len2] = 'a' , pa++;\n\t\twhile ( pb <= r ) cur[++len2] = 'b' , pb++;\n\t\tif ( !cmp(tmp,len,cur,len2) ){\n\t\t\trep(j,1,len2) tmp[j] = cur[j];\n\t\t\tlen = len2;\n\t\t}\n\t}\n\trep(i,1,len) vec[x][i] = tmp[i];\n\tclen[x] = len;\n}\n\nvoid getans(){\n\tlen = 0;\n\trepd(i,n,1){\n\t\tif ( cmp(vec[i],clen[i],tmp,len) ){\n\t\t\ttag[i] = 1;\n\t\t\trep(j,1,clen[i]) tmp[i] = vec[i][j];\n\t\t\tlen = clen[i];\n\t\t}\n\t}\n\trep(i,1,n) if ( tag[i] ){\n\t\trep(j,1,clen[i]) putchar(vec[i][j]);\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",ch + 1);\n\trep(i,1,n * 2){\n\t\tif ( ch[i] == 'a' ) a[++tota] = i;\n\t\telse b[++totb] = i;\n\t}\n\tint last = 1 , mx = 0;\n\trep(i,1,n){\n\t\tmx = max(mx,max(a[i],b[i]));\n\t\tif ( mx == i * 2 ){\n\t\t\t++tot;\n\t\t\tif ( a[i] < b[i] ) getmx1(tot,last,i);\n\t\t\telse getmx2(tot,last,i);\n\t\t\tlast = i + 1 , mx = 0;\n\t\t}\n\t}\n\tgetans();\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\nint PAIR[6050];\nstring dp[6050];\n\nint main() {\n    //cout.precision(10);\n    int N;\n    string S;\n    cin >> N >> S;\n    S = \"#\" + S;\n    queue<int> a, b;\n    for(int i = 1; i <= 2*N; i++) {\n        if(S[i] == 'a') a.push(i);\n        else b.push(i);\n    }\n    for(int i = 1; i <= N; i++) {\n        int A = a.front();\n        int B = b.front();\n        a.pop();\n        b.pop();\n        PAIR[A] = B;\n        PAIR[B] = A;\n    }\n    for(int i = 1; i <= 2*N; i++) {\n        //cerr << PAIR[i] << endl;\n    }\n    for(int index = 2*N; index >= 1; index--) {\n        dp[index] = dp[index + 1];\n        if(PAIR[index] < index) continue;\n        if(S[index] == 'a') {\n            string sub = \"ab\" + dp[PAIR[index] + 1];\n            dp[index] = max(dp[index], sub);\n            continue;\n        }\n        if(S[index] == 'b') {\n            string sub = \"b\";\n            int plus = 1;\n            int sub_index = index + 1;\n            for(; plus > 0; sub_index++) {\n                if(S[sub_index] == 'b') {\n                    sub += \"b\";\n                    plus++;\n                    continue;\n                }\n                if(sub_index < PAIR[index]) continue;\n                sub += \"a\";\n                plus--;\n            }\n            sub += dp[sub_index];\n            dp[index] = max(dp[index], sub);\n        }\n    }\n    cout << dp[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <cstring>\n\nconst int MaxN = 3000, MaxLen = MaxN * 2;\n\nint N;\nchar S[MaxLen + 5];\nint A[MaxN + 5], B[MaxN + 5];\nchar F[MaxN + 5][MaxLen + 5], G[MaxN + 5][MaxLen + 5];\nint CntA, CntB;\n\nvoid init() {\n  scanf(\"%d\", &N);\n  scanf(\"%s\", S + 1);\n  for (int i = 1; i <= N * 2; ++i)\n    if (S[i] == 'a') A[++CntA] = i;\n    else B[++CntB] = i;\n}\n\nvoid solve() {\n  for (int i = N; i >= 1; --i) {\n    if (A[i] < B[i]) {\n      F[i][1] = 'a', F[i][2] = 'b';\n      for (int j = i; j <= N; ++j) {\n        if (j == N || A[j + 1] > B[i]) {\n          strcpy(F[i] + 3, G[j + 1] + 1);\n          break;\n        }\n      }\n    } else {\n      for (int j = i; j <= N; ++j) {\n        if (j == N || B[j + 1] > A[i]) {\n          int cnt = 0;\n          for (int k = i; k <= j; ++k) F[i][++cnt] = 'b';\n          F[i][++cnt] = 'a';\n          if (i == j) strcpy(F[i] + cnt + 1, G[i + 1] + 1);\n          else strcpy(F[i] + cnt + 1, F[i + 1] + j - i + 1);\n          break;\n        }\n      }\n    }\n    if (strcmp(F[i] + 1, G[i + 1] + 1) < 0) strcpy(G[i] + 1, G[i + 1] + 1);\n    else strcpy(G[i] + 1, F[i] + 1);\n    // printf(\"F[%d] = %s, G = %s\\n\", i, F[i] + 1, G[i] + 1);\n  }\n  printf(\"%s\\n\", G[1] + 1);\n}\n\nint main() {\n  init();\n  solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntemplate<class T> using V = vector<T>;\ntemplate<class T> using VV = V<V<T>>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fi first\n#define se second\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define ALL(c) (c).begin(),(c).end()\n\n#define LOCAL\n#ifdef LOCAL\n#define dump(x) cerr << __LINE__ << \" \" << #x << \" = \" << (x) << endl\n#else \n#define dump(x) true\n#endif\n\nconstexpr ll TEN(int n) { return (n == 0) ? 1 : 10 * TEN(n-1); }\n\ntemplate<class T, class U> void chmin(T& t, const U& u) { if (t > u) t = u; }\ntemplate<class T, class U> void chmax(T& t, const U& u) { if (t < u) t = u; }\n\ntemplate<class T, class U>\nostream& operator<<(ostream& os, const pair<T, U>& p) {\n\tos<<\"(\"<<p.first<<\",\"<<p.second<<\")\";\n\treturn os;\n}\n\ntemplate<class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n\tos<<\"{\";\n\trep(i, v.size()) {\n\t\tif (i) os<<\",\";\n\t\tos<<v[i];\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nstring solve(string s) {\n\tV<int> apos, bpos;\n\tint n = s.size();\n\trep(i, n) {\n\t\tif (s[i] == 'a') {\n\t\t\tapos.pb(i);\n\t\t} else {\n\t\t\tbpos.pb(i);\n\t\t}\n\t}\n\tdump(apos);\n\tdump(bpos);\n\tstring res;\n\n\tif (s[0] == 'b') {\n\t\trep(i, apos.size()) {\n\t\t\tstring tmp;\n\t\t\trep(j, n) {\n\t\t\t\tif (s[j] == 'a' && j >= apos[i]) {\n\t\t\t\t\ttmp.pb(s[j]);\n\t\t\t\t} else if (s[j] == 'b' && j >= bpos[i]) {\n\t\t\t\t\ttmp.pb(s[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tchmax(res, tmp);\n\t\t}\n\t} else {\n\t\tint p = 0;\n\t\tint now = 0;\n\t\twhile (p < n) {\n\t\t\twhile (now < apos.size() && apos[now] < p) {\n\t\t\t\t++now;\n\t\t\t}\n\t\t\tif (now != apos.size()) {\n\t\t\t\tres.pb('a');\n\t\t\t\tres.pb('b');\n\t\t\t\tp = bpos[now];\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn res;\n}\n\nint main() {\n\tint n;  cin >> n;\n\tstring s; cin >> s;\n\n\tstring cur;\n\tint c = 0;\n\tstring ans;\n\n\tV<string> cand;\n\n\trep(i, n * 2) {\n\t\tif (s[i] == 'a') {\n\t\t\t++c;\n\t\t\tcur.pb(s[i]);\n\t\t} else {\n\t\t\t--c;\n\t\t\tcur.pb(s[i]);\n\t\t}\n\n\t\tif (c == 0) {\n\t\t\tcand.pb(solve(cur));\n\t\t\tcur = \"\";\n\t\t}\n\t}\n\n\tint sz = cand.size();\n\tV<string> dp(sz + 1);\n\tfor (int i = sz - 1; i >= 0; --i) {\n\t\tdp[i] = max(dp[i+1], cand[i] + dp[i+1]);\n\t}\n\tcout << dp[0] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <string>\n\nusing namespace std;\n\nchar s[6001];\nint a[6000];\nint b[6000];\nint h[6001];\nint m[6001];\nint z[6001];\n\nstring solve(int l, int r) {\n    int i, j;\n    string ans = \"\";\n    \n    for (i = 0; i < (r - l) / 2; i++) {\n        int c[2] = {};\n        string tmp = \"\";\n        \n        for (j = l; j < r; j++) {\n            if (c[s[j] - 'a']++ >= i) tmp += s[j];\n        }\n        \n        if (tmp > ans) ans = tmp;\n    }\n    \n    return ans;\n}\n\nint main() {\n    int n, ca = 0, cb = 0, i;\n    string ans = \"\";\n    \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s);\n    \n    for (i = 0; i < n * 2; i++) {\n        if (s[i] == 'a') {\n            a[i] = ca++;\n            h[i + 1] = h[i] - 1;\n        } else {\n            b[cb++] = i;\n            h[i + 1] = h[i] + 1;\n        }\n    }\n    \n    m[n * 2] = z[n * 2] = n * 2;\n    \n    for (i = n * 2 - 1; i >= 0; i--) {\n        m[i] = m[i + 1];\n        z[i] = z[i + 1];\n        if (h[i] >= h[m[i]]) m[i] = i;\n        if (h[i] == 0) z[i] = i;\n    }\n    \n    for (i = 0; i < n * 2; ) {\n        if (h[m[i]] > 0) {\n            ans += solve(i, z[m[i]]);\n            i = z[m[i]];\n        } else {\n            ans += \"ab\";\n            i = b[a[i]] + 1;\n        }\n    }\n    \n    printf(\"%s\\n\", ans.c_str());\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6002\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (lef < a.size() || rig < b.size()){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] > s[rig])return true;\n\t\tif (s[lef] < s[rig])return false;\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2*n,0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first <= pos[b].second){\n\t\tint til = 0;\n\t\tint cnt = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (min(pos[j].second, pos[j].first)> pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttil = j;\n\t\t\tcnt++;\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (min(pos[j].second,pos[j].first) > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnex[pos[j].first] = true;\n\t\t\tnex[pos[j].second] = true;\n\t\t}\n\t\tif (cmp(nex,dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t}\n\telse{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = max(pos[b].first, pos[b].second);\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i]|k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss=dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <string>\n#include <cmath>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <complex>\n#include <unordered_map>\n#include <unordered_set>\n#include <random>\n#include <cassert>\nusing namespace std;\ntypedef long long int ll;\ntypedef pair<int, int> P;\n\nint main()\n{\n\tint n;\n  string s;\n  cin>>n>>s;\n  int a[3010], b[3010];\n  int ia=0, ib=0;\n  for(int i=0; i<2*n; i++){\n    if(s[i]=='a'){\n      a[ia]=i;\n      ia++;\n    }else{\n      b[ib]=i;\n      ib++;\n    }\n  }\n  bool nuo[3010]={};\n  for(int i=0; i<n; ){\n    if(a[i]<b[i]){\n      while(i<n && a[i]<b[i]) i++;\n    }else{\n      while(i<n && a[i]>b[i]) nuo[i]=1, i++;\n    }\n  }\n  string ans;\n  for(int i=0; i<n; i++){\n    bool used[6010]={};\n    for(int j=i; j<n; j++){\n      if(nuo[j]) used[a[j]]=used[b[j]]=1;\n    }\n    string ans0;\n    for(int j=0; j<2*n; j++){\n      if(used[j]) ans0+=s[j];\n    }\n    if(ans<ans0) ans=ans0;\n  }\n  int t=n-1;\n  while(t>=0 && a[t]<b[t]) t--;\n  int r=-1;\n  for(int i=t+1; i<n; i++){\n    if(a[i]<r) continue;\n    ans+='a'; ans+='b';\n    r=b[i];\n  }\n  cout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\nint c[6011];\nint begin0;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nstring best=\"\";\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin0=2*n;\n\tmemset(c,0,sizeof(c));\n\t\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin0 && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbegin0=a[i];\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttmp=\"\";\n\t\t\tc[b[i]]=c[a[i]]=1;\n\t\t\tfor(j=b[i];j<2*n;j++)\n\t\t\t{\n\t\t\t\tif(c[j]==1)\n\t\t\t\t{\n\t\t\t\t\ttmp+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(tmp+ans>best)\n\t\t\t{\n\t\t\t\tbest=tmp+ans;\n\t\t\t}\n\t\t\t\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tcout<<best<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\nint N,sum[6010],pos[6010],nxt[6010];\nchar S[6010],lt[6010][6010];\nbool cmp(int i,int j){\n\tif(sum[i]!=sum[j])return sum[i]>sum[j];\n\tif(lt[i][j])return lt[i][j]==1;\n\treturn i<j;\n}\nint main(){\n\tscanf(\"%d%s\",&N,S);\n\tfor(int i=0;i<N*2;i++)sum[i+1]=sum[i]+(S[i]=='b'?1:-1),pos[i]=i;\n\tnxt[N*2]=N*2;\n\tfor(int i=N*2;i--;)nxt[i]=sum[i+1]?nxt[i+1]:i+1;\n\tfor(int i=N*2;i>=0;i--){\n\t\tfor(int j=N*2;j>=0;j--){ \n\t\t\tif(i==j)lt[i][j]=0;\n\t\t\telse if(S[i]!=S[j])lt[i][j]=(S[i]<S[j]?-1:1);\n\t\t\telse if(sum[i+1]>0&&sum[j+1]>0)lt[i][j]=lt[i+1][j+1];\n\t\t\telse lt[i][j]=sum[i+1]>0?1:sum[j+1]>0?-1:0;\n\t\t}\n\t}\n\tstd::sort(pos,pos+N*2,cmp);\n\tint r=0;\n\tfor(;;){\n\t\tint i=0;\n\t\twhile(i<N*2&&sum[pos[i]]>0&&pos[i]<r)i++;\n\t\tif(i==N*2||sum[pos[i]]<=0){\n\t\t\tfor(int pa=r,pb=r;pb<N*2;pb++)if(S[pb]=='b'){\n\t\t\t\tif(pa>=r)printf(\"ab\"),r=pb;\n\t\t\t\tfor(pa++;pa<N*2&&S[pa]=='b';pa++);\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t\treturn 0;\n\t\t}\n\t\tfor(int j=sum[pos[i]];j--;)putchar('b');\n\t\tfor(int j=pos[i];j<nxt[pos[i]];j++)putchar(S[j]);\n\t\tr=nxt[pos[i]];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> stk;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      string res = naive(string(s.begin() + i, s.begin() + last));\n      while (!stk.empty()) {\n        if (stk.back().size() > res.size() && res > stk.back())\n          stk.pop_back();\n        else if (res.substr(0, res.size()) > stk.back())\n          stk.pop_back();\n        else\n          break;\n      }\n      stk.push_back(res);\n      i = r - 1;\n    }\n  }\n  for (const auto& str : stk)\n    ans += str;\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 3005;\n\nint A[N], B[N], n, tA, tB, l[N], r[N], tot;\n\nstring s, dp[N];\n\nvoid solve(int x) {\n  if(A[l[x]] < B[l[x]]) {\n    int L = 0;\n    for(int i = l[x]; i <= r[x]; ++ i) {\n      if(A[i] > L) {\n        dp[x] += \"ab\";\n        L = B[i];\n      }\n    }\n  }\n  else {\n    dp[x] = \"\";\n    vector < pair < int, char> > it;\n    for(int i = r[x]; i >= l[x]; -- i) {\n      string now = \"\";\n      it.clear();\n      for(int j = i; j <= r[x]; ++ j)\n        it.push_back(make_pair(B[j], 'b')),\n          it.push_back(make_pair(A[j], 'a'));\n      sort(it.begin(), it.end());\n      for(int j = 0; j < (int) it.size(); ++ j)\n        now += it[j].second;\n      dp[x] = max(dp[x], now);\n    }\n  }\n}\n\nmain(void) {\n  cin >> n;\n  cin >> s;\n  for(int i = 0; i < n * 2; ++ i) {\n    if(s[i] == 'a') A[++ tA] = i + 1;\n    else B[++ tB] = i + 1;\n  }\n  if(tA != n || tB != n) throw;\n  int L = 1;\n  for(int i = 2; i <= n; ++ i) {\n    if(((A[i] < B[i]) ^ (A[i - 1] < B[i - 1]))) {\n      //[L, i - 1]\n      l[++ tot] = L;\n      r[tot] = i - 1;\n      L = i;\n    }\n  }\n  l[++ tot] = L;\n  r[tot] = n;\n  for(int i = 1; i <= tot; ++ i) solve(i);\n  for(int i = tot - 1; i >= 1; -- i) {\n    dp[i] = max(dp[i] + dp[i + 1], dp[i + 1]);\n  }\n  cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\n\n#define rep(i, j, k) for (int i = j; i < k; i++)\n#define pb push_back\n#define all(x) x.begin(), x.end()\n#define mt make_tuple\n\n#define iv inline void\n#define ii inline int\n#define ill inline ll\n\ntemplate <typename S, typename T>\ninline bool smin(S &l, T r) {\n  return r < l ? l = r, 1 : 0;\n}\ntemplate <typename S, typename T>\ninline bool smax(S &l, T r) {\n  return l < r ? l = r, 1 : 0;\n}\n\nconstexpr int MOD = 1e9 + 7;  // 998244353;\n\ntemplate <typename S>\ninline S mod(S &l) {\n  return l = (l % MOD + MOD) % MOD;\n}\ntemplate <typename S, typename T>\ninline S add(S &l, T r) {\n  return mod(l += r);\n}\nill po(ll v, ll u) {\n  return u ? po(v * v % MOD, u >> 1) * (u & 1 ? v : 1) % MOD : 1;\n}\n\nvoid fileIO(string s) {\n  freopen((s + \".in\").c_str(), \"r\", stdin);\n  freopen((s + \".out\").c_str(), \"w\", stdout);\n}\n\nconstexpr int N = 3e3 + 10;\n\nint n, A[N], B[N];\nstring s;\n\nstring dp[N];\n\nint main() {\n#ifndef LOCAL\n  // fileIO(\"\");\n#endif\n\n  cin >> n >> s;\n\n  int lptr = 0, rptr = 0;\n  rep(i, 0, 2 * n) {\n    if (s[i] == 'a')\n      A[lptr++] = i;\n    else\n      B[rptr++] = i;\n  }\n\n  for (int i = n - 1; ~i; i--) {\n    dp[i] = dp[i + 1];\n    if (A[i] < B[i]) {\n      int j = i;\n      while (j < n && A[j] < B[i]) j++;\n      smax(dp[i], \"ab\" + dp[j]);\n    } else {\n      set<int> st;\n      st.insert(A[i]);\n      st.insert(B[i]);\n      int j = i + 1;\n      while (j < n && min(A[j], B[j]) < *st.rbegin()) {\n        st.insert(A[j]);\n        st.insert(B[j]);\n        j++;\n      }\n      string t = \"\";\n      for (auto e : st) t.pb(s[e]);\n      smax(dp[i], t + dp[j]);\n    }\n  }\n\n  cout << dp[0] << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nint n,tot,p1[6005],p2[6005],num[6005];\nchar s[6005],ans[6005];\nvoid solve(int l,int r)\n{\n\tif(l>r)return;\n\tint now1=0,now2=0;\n\tfor(int i=l;i<=r;i++)\n\t{\n\t\tif(s[i]=='a')p1[++now1]=i;\n\t\telse p2[++now2]=i;\n\t}\n\tint maxx=-1;\n\tfor(int i=1;i<=now1;i++)\n\t{\n\t\tnum[i]=0;\n\t\tif(p1[i]>p2[i])\n\t\t{\n\t\t\tfor(int j=p2[i]+1;j<p1[i];j++)\n\t\t\t  if(s[j]=='b')num[i]++;\n\t\t\tmaxx=max(maxx,num[i]);\n\t\t}\n\t\telse num[i]=-1;\n\t}\n\tif(maxx==-1)\n\t{\n\t\tint nowr=l-1;\n\t\tfor(int i=1;i<=now1;i++)\n\t\t{\n\t\t\tif(p1[i]<nowr)continue;\n\t\t\tans[++tot]='a';\n\t\t\tans[++tot]='b';\n\t\t\tnowr=p2[i];\n\t\t}\n\t\treturn;\n\t}\n\tint pos=0;\n\tfor(int i=1;i<=now1;i++)\n\t{\n\t\tif(num[i]<0)continue;\n\t\tif(!pos)pos=i;\n\t\telse\n\t\t{\n\t\t\tint p=pos,j=i;\n\t\t\twhile(num[p]&&num[j]&&num[p]==num[j])p++,j++;\n\t\t\tif(num[p]<num[j])pos=i;\n\t\t}\n\t}\n\tint c=0,i=p2[pos];\n\tfor(;;i++)\n\t{\n\t\tif(i>p2[pos]&&i<p1[pos]&&s[i]=='a')continue;\n\t\tans[++tot]=s[i];\n\t\tif(s[i]=='b')c++;\n\t\telse c--;\n\t\tif(c==0)break;\n\t}\n\tsolve(i+1,r);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tsolve(1,2*n);\n\tfor(int i=1;i<=tot;i++)putchar(ans[i]);\n\tputchar('\\n');\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nchar s[6010];\nbasic_string <char> ans[6010];\nint q[6010], head, tail, n;\nbasic_string <int> a, b;\nint pos[6010], choose[6010];\nint main() {\n    scanf(\"%d%s\", &n, s + 1);\n    n <<= 1;\n    for (int i = 1; i <= n; i++) (s[i] == 'a' ? a : b).push_back(i);\n    for (int i = 0; i < n / 2; i++) pos[a[i]] = b[i], pos[b[i]] = a[i];\n    int cnt = 0, nxt = n + 1;\n    for (int i = n; i > 0; i--) {\n        cnt += s[i] == 'a' ? 1 : -1;\n        if (cnt) continue;\n        ans[i] = ans[nxt];\n        memset(choose, 0, sizeof choose);\n        head = 1, tail = 0;\n        for (int j = i; j < nxt; j++) {\n            if (s[j] == 'a') {\n                if (choose[j]) {\n                    basic_string <char> now = \"\";\n                    for (int k = i; k < nxt; k++) {\n                        if(s[k] == 'a' && (choose[k] || k > pos[q[tail]])) now += \"a\";\n                        if(s[k] == 'b' && (choose[k] || k > j)) now += \"b\";\n                    }\n                    // cerr << now << endl;\n                    ans[i] = max(ans[i], now + ans[nxt]);\n                    head++;\n                    choose[j] = choose[pos[j]] = 0;\n                }\n                continue;\n            }\n            if(pos[j] < j) continue;\n            q[++tail] = j, choose[j] = choose[pos[j]] = 1;\n        }\n        if (tail == 0) {\n            memset(choose, 0, sizeof choose);\n            for (int j = i; j < nxt; j++) {\n                if (s[j] == 'a') {\n                    choose[j] = choose[pos[j]] = 1;\n                    basic_string <char> now = \"\";\n                    for (int k = i; k <= pos[j]; k++) if(choose[k]) now += s[k];\n                    ans[i] = max(ans[i], now + ans[j]);\n                    j = pos[j];\n                }\n            }\n        }\n        nxt = i;\n    }\n    return cout << ans[1] << endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6010;\nint n,a[N],b[N],f[N],ans[N][N],top[N]; char s[N];\nstring tmp[N],dp[N],mx[N]; bool vis[N];\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    for(int i=1; i<=2*n; ++i)\n        if(s[i]=='a')a[++a[0]]=i;\n        else b[++b[0]]=i;\n    a[0]=b[0]=0;\n    bool flag=0;\n    for(int i=1; i<=n; ++i)\n        if(b[i]<a[i])flag=1;\n    if(!flag){\n        for(int i=1; i<=n; ++i)f[i]=1;\n        for(int i=1; i<=n; ++i)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i])f[i]=max(f[i],f[j]+1);\n        int ans=0;\n        for(int i=1; i<=n; ++i)ans=max(ans,f[i]);\n        for(int i=1; i<=ans; ++i)printf(\"ab\");\n        return 0;\n    }\n    for(int i=1; i<=n; ++i)if(b[i]<a[i]){\n        int t=a[i]; ans[i][top[i]=1]=i;\n        for(int j=i+1; j<=n; ++j){\n            if(b[j]>t)break;\n            if(b[j]<a[j]){\n                t=max(t,a[j]);\n                ans[i][++top[i]]=j;\n            }\n        }\n    }\n    for(int i=1; i<=n; ++i){\n        memset(vis,0,sizeof(vis));\n        for(int j=1; j<=top[i]; ++j)\n            vis[a[ans[i][j]]]=vis[b[ans[i][j]]]=1;\n        for(int j=1; j<=2*n; ++j)\n            if(vis[j])tmp[i]=tmp[i]+s[j];\n    }\n    for(int i=n,t=n; i>=1; --i)if(a[i]>b[i]){\n        while(t>i&&b[t]>a[ans[i][top[i]]])--t; ++t;\n        dp[i]=tmp[i]+mx[t]; --t;\n        mx[i]=max(mx[i+1],dp[i]);\n    }else mx[i]=mx[i+1];\n    int pos=0;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>b[i])pos=i;\n    int R=a[pos];\n    for(int i=1; i<=n; ++i)if(a[i]>R)f[i]=1;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>R)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i]&&a[j]>R)f[i]=max(f[i],f[j]+1);\n    int res=0;\n    for(int i=1; i<=n; ++i)res=max(res,f[i]);\n    cout << mx[1]; for(int i=1; i<=res; ++i)printf(\"ab\");\n    return 0;\n}\n/*\n11\nabbbaababaababbabaabaabb\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef long long lint;\ntypedef long double louble;\n\nconst char lf = '\\n';\n\ntemplate<typename T1,typename T2> inline T1 max(T1 a,T2 b){return a<b?b:a;}\ntemplate<typename T1,typename T2> inline T1 min(T1 a,T2 b){return a<b?a:b;}\n\nnamespace ae86\n{\n\tconst int bufl = 1<<15;\n\t\n\tchar buf[bufl],*s=buf,*t=buf;\n\t\n\tinline int fetch()\n\t{\n\t\tif(s==t){t=(s=buf)+fread(buf,1,bufl,stdin);if(s==t)return EOF;}\n\t\treturn *s++;\n\t}\n\t\n\tinline int ty()\n\t{\n\t\tint a=0,b=1,c=fetch();\n\t\twhile(!isdigit(c))b^=c=='-',c=fetch();\n\t\twhile(isdigit(c))a=a*10+c-48,c=fetch();\n\t\treturn b?a:-a;\n\t}\n\n\ttemplate<typename T> inline int ts(T *s)\n\t{\n\t\tint a=0,c=fetch();\n\t\twhile(c<=32 && c!=EOF)c=fetch();\n\t\twhile(c>32 && c!=EOF)s[a++]=c,c=fetch();\n\t\ts[a]=0;\n\t\treturn a;\n\t}\n}\nusing ae86::ty;\nusing ae86::ts;\n\nconst int _ = 3007 , __ = _<<1;\n\nint n,nn,s[__];\nint rk[__]={0},loc[2][_]={0};\nstring f[__];\n\ninline string fuck(int l,int r)\n{\n\tstring ret=\"\";\n\tfor(int i=1;i<=nn;i++)if(l<=rk[i] && rk[i]<=r)ret.push_back(s[i]+'a');\n\treturn ret;\n}\n\nint main()\n{\n\tios::sync_with_stdio(0),cout.tie(nullptr);\n\n\tn=ty(),nn=n+n,ts(s+1);\n\tfor(int i=1,temp[2]={0};i<=nn;i++)s[i]-='a',temp[s[i]]++,rk[i]=temp[s[i]],loc[s[i]][temp[s[i]]]=i;\n\n\tf[n+1]=\"\";\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tf[i]=f[i+1];\n\t\tif(loc[0][i]<loc[1][i])\n\t\t{\n\t\t\tint j=i;\n\t\t\twhile(j<=n && loc[0][j]<loc[1][i])j++;\n\t\t\tf[i]=max(f[i],\"ab\"+f[j]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint j=i+1;\n\t\t\twhile(j<=n && loc[1][j]<loc[0][j-1])j++;\n\t\t\tf[i]=max(f[i],fuck(i,j-1)+f[j]);\n\t\t}\n\t}\n\tcout<<f[1]<<lf;\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//minamoto\n#include<bits/stdc++.h>\n#define R register\n#define pb push_back\n#define fp(i,a,b) for(R int i=(a),I=(b)+1;i<I;++i)\n#define fd(i,a,b) for(R int i=(a),I=(b)-1;i>I;--i)\n#define go(u) for(int i=head[u],v=e[i].v;i;i=e[i].nx,v=e[i].v)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nvector<string>s;string t,ans,cur;int n,m,cnt;\nvoid solve(string &s){\n\tvector<int>p1,p2;string t=\"\";\n\tfp(i,0,s.size()-1)(s[i]=='a'?p1:p2).pb(i);\n\tif(s[0]=='a'){\n\t\tint las=-1;\n\t\tfp(i,0,p1.size()-1)if(p1[i]>las)las=p2[i],t+=\"ab\";\n\t}else{\n\t\tfp(i,0,p1.size()-1){\n\t\t\tstring p=\"\";\n\t\t\tint x=i,y=i;\n\t\t\twhile(233){\n\t\t\t\tif(x<p1.size()&&(y==p2.size()||p1[x]<p2[y]))p+='a',++x;\n\t\t\t\telse if(y<p2.size())p+='b',++y;\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tif(p>t)t=p;\n\t\t}\n\t}\n\ts=t;\n}\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n\tscanf(\"%d\",&n),cin>>t;\n\tfor(auto v:t){\n\t\tcnt+=v=='a'?1:-1,cur+=v;\n\t\tif(!cnt)s.pb(cur),cur=\"\";\n\t}\n\tfor(auto &v:s)solve(v);\n\treverse(s.begin(),s.end());\n\tfor(auto v:s){\n\t\tint fl=1;\n\t\tfp(i,0,min(v.size(),ans.size())-1)\n\t\t\tif(v[i]!=ans[i]){\n\t\t\t\tif(v[i]<ans[i])fl=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif(fl)ans=v+ans;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = max(pos[b].second,pos[b].first);\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (min(pos[j].first, pos[j].second) > maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define F(i, a, b) for (int i = a; i <= b; i ++)\n#define G(i, a, b) for (int i = a; i >= b; i --)\n#define out4(x, y, z, w) { if (debug) printf(#x\" = \"),W(x),printf(\" \"#y\" = \"),W(y),printf(\" \"#z\" = \"),W(z),printf(\" \"#w\" = \"),W(w),putc('\\n'); }\n#define out3(x, y, z) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), printf(\" \"#z\" = \"), W(z), putc('\\n'); }\n#define out2(x, y) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), putc('\\n'); }\n#define out1(x) { if (debug) printf(#x\" = \"), W(x), putc('\\n'); }\n#define outline(x) { if (debug) puts(\"-------------------------------------------\"#x\"----------------------------------------\"); }\n#define outarr(a, L, R) { if (debug) { printf(#a\"[%d..%d] = \", L, R); F(i, L, R) W(a[i]), putc(' '); putc('\\n'); } }\n#define Assert(x) { if ((debug) && (!(x))) { puts(\"Wrong Answer\"); exit(0); } }\n#define max(a, b) ((a) > (b) ? (a) : (b))\n#define min(a, b) ((a) < (b) ? (a) : (b))\n#define mem(a, b) memset(a, b, sizeof a)\n#define mec(a, b) memcpy(a, b, sizeof a)\n#define mx(a, b) ((a) = max(a, b))\n#define mn(a, b) ((a) = min(a, b))\n#define lowbit(x) ((x) & (-(x)))\n#define abs(x) ((max(x, - (x))))\n#define get getchar()\n#define pb push_back\n#define putc putchar\n#define inf 2e9\n\ntemplate <typename Int>\nvoid R(Int &x) {\n\tchar c = get; x = 0; Int t = 1;\n\tfor (; !isdigit(c); c = get) t = (c == '-' ? - 1 : t);\n\tfor (; isdigit(c); x = (x << 3) + (x << 1) + c - '0', c = get); x *= t;\n}\ntemplate <typename Int>\nvoid W(Int x) {\n\tif (x < 0) { putc('-'); x = - x ; }\n\tif (x > 9) W(x / 10); putc(x % 10 + '0');\n}\n\n#define debug (0)\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\nint n, L, LEN, c[N], Ans[N], cnt[2], C[N], D[N];\nstruct node {\n\tint num; vector <int> c;\n\tfriend bool operator < (node a, node b) {\n\t\tint len = min(a.c.size(), b.c.size());\n\t\tF(i, 0, len - 1)\n\t\t\tif (a.c[i] < b.c[i]) return 1; else\n\t\t\tif (a.c[i] > b.c[i]) return 0;\n\t\treturn a.c.size() < b.c.size() || a.c.size() == b.c.size() && a.num > b.num;\n\t}\n\tvoid add(int x) { c.pb(x); }\n} a, b[N];\n\nchar ch[N];\nstruct nobe { int x, l, r; } d[N];\n\nint main() {\n//\tfreopen(\"data.in\",\"r\",stdin);\n\n\tR(n), scanf(\"%s\", ch + 1), n *= 2;\n\tint las = 0, s = 0;\n\tF(i, 1, n) {\n\t\ts += (ch[i] == 'b' ? 1 : (-1));\n\t\tif (s == 0)\n\t\t\td[++ L] = {ch[las + 1] - 'a', las + 1, i}, las = i;\n//\t\tprintf(\"%d \", s);\n\t}\n//\tputc('\\n');\n\n\tint flag = 0, total = 0;\n\tG(i, L, 1) {\n\t\tint l = d[i].l, r = d[i].r;\n\t\tif (d[i].x) {\n\t\t\tout4(d[i].x, d[i].l, d[i].r, i);\n\t\t\tflag = 1, b[++ total].num = i;\n\t\t\tF(k, 1, (r - l + 1) / 2) {\n\t\t\t\tcnt[0] = cnt[1] = 0;\n\t\t\t\tint len = 0;\n\t\t\t\tG(j, r, l)\n\t\t\t\t\tif (++ cnt[ch[j] - 'a'] <= k)\n\t\t\t\t\t\tc[++ len] = ch[j] - 'a';\n\t\t\t\treverse(c + 1, c + len + 1);\n//\t\t\t\toutarr(c, 1, len);\n\t\t\t\ta.c.clear(), a.num = i;\n\t\t\t\tF(j, 1, len) a.add(c[j]);\n\t\t\t\tif (b[total] < a)\n\t\t\t\t\tb[total] = a;\n\t\t\t}\n//\t\t\tprintf(\"%d %d\\n\", b[total].c.size(), b[total].num);\n//\t\t\tF(j, 0, b[total].c.size() - 1)\n//\t\t\t\tprintf(\"%c\", b[total].c[j] + 'a');\n//\t\t\tputc('\\n');\n\t\t}\n\t\telse {\n\t\t\tif (flag) continue;\n\t\t\tint len = 0, bz = 0;\n\t\t\tF(j, l, r) {\n\t\t\t\tif (ch[j] == 'a') {\n\t\t\t\t\tif (!bz)\n\t\t\t\t\t\tC[++ len] = 0, bz = 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (bz)\n\t\t\t\t\t\tC[++ len] = 1, bz = 0;\n\t\t\t\t}\n\t\t\t\toutarr(C, 1, len);\n\t\t\t}\n\t\t\tG(j, len, 1) D[++ LEN] = C[j];\n\t\t}\n\t}\n\n\tsort(b + 1, b + total + 1);\n\n\tout1(b[1].num);\n\tlas = 0;\n\tG(i, total, 1)\n\t\tif (b[i].num > las) {\n\t\t\tF(j, 0, b[i].c.size() - 1)\n\t\t\t\tprintf(\"%c\", b[i].c[j] + 'a');\n\t\t\tlas = b[i].num;\n\t\t}\n\tG(i, LEN, 1) printf(\"%c\", D[i] + 'a');\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <stdio.h>\n#include <stdlib.h>\n#include <vector>\n#include <map>\n#include <queue>\n#include <set>\n#include <string>\n#include <string.h>\n#include <stack>\n#define Endl endl\n#define mp make_pair\n#define ll long long \n#define pii pair<int,int>\n#define pll pair<ll,ll>\n#define over(A) {cout<<A<<endl;exit(0);}\n#define all(A) A.begin(),A.end()\n#define ceil(a,b) ((a-1)/b+1)\n#define srand() mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n#define rand(l,r) uniform_int_distribution<int>(l,r)(rng)\ntypedef unsigned long long ull;\nconst int inf=1039074182;\nusing namespace std;\nint n;\nchar c[6005];\nbool use[6005];\nvector <string> vec;\n\nvoid solve(int l,int r)\n{\n\tstring res=\"\";\n\tif(c[l]=='b')\n\t{\n\t\tvector <string> vec;\n\t\tfor(int i=l;i<r;i++)\n\t\t{\n\t\t\tuse[i]=true;\n\t\t}\n\t\tfor(int i=0;i<(r-l)/2;i++)\n\t\t{\n\t\t\tstring t=\"\";\n\t\t\tfor(int j=l;j<r;j++)\n\t\t\t{\n\t\t\t\tif(use[j]) t+=c[j];\n\t\t\t}\n\t\t\tvec.push_back(t);\n\t\t\tfor(int j=l;j<r;j++)\n\t\t\t{\n\t\t\t\tif(c[j]=='a' && use[j]==true)\n\t\t\t\t{\n\t\t\t\t\tuse[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=l;j<r;j++)\n\t\t\t{\n\t\t\t\tif(c[j]=='b' && use[j]==true)\n\t\t\t\t{\n\t\t\t\t\tuse[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(all(vec));\n\t\tres=vec[(int)vec.size()-1];\n\t}\n\telse\n\t{\n\t\tint sa=0,sb=0,la=0;\n\t\tfor(int i=l;i<r;i++)\n\t\t{\n\t\t\tif(c[i]=='a') sa++;else sb++;\n\t\t\tif(sb>la) la=sa,res+=\"ab\";\n\t\t}\n\t}\n\tvec.push_back(res);\n}\n\nint main()\n{\n//\tfreopen(\"input.txt\",\"r\",stdin);\n\tcin>>n;\n\tn*=2;\n\tscanf(\"%s\",c);\n\tint s=0;\n\tint last=0;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tif(c[i]=='a') s++;else s--;\n\t\tif(s==0)\n\t\t{\n\t\t\tsolve(last,i+1);\n\t\t\tlast=i+1;\n\t\t}\n\t}\n\tstring res=vec[(int)vec.size()-1];\n\tfor(int i=(int)vec.size()-2;i>=0;i--)\n\t{\n\t\tint isres=0;\n\t\tfor(int len=0;len<min((int)res.size(),(int)vec[i].size());len++)\n\t\t{\n\t\t\tif(vec[i][len]!=res[len])\n\t\t\t{\n\t\t\t\tif(vec[i][len]<res[len])\n\t\t\t\t{\n\t\t\t\t\tisres=1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tisres=0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\tcout<<i<<endl;\n\t\tif(!isres) res=vec[i]+res;\n\t}\n\tcout<<res<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll=int64_t;\n#define int ll\n\n#define FOR(i,a,b) for(int i=int(a);i<int(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define MP make_pair\n#define PB push_back\n#define ALL(x) x.begin(),x.end()\n#ifdef MAROON_LOCAL\n#define cerr (cerr<<\"-- line \"<<__LINE__<<\" -- \")\n#else\nclass CerrDummy{}cerrDummy;\ntemplate<class T>\nCerrDummy& operator<<(CerrDummy&cd,const T&){\n\treturn cd;\n}\nusing charTDummy=char;\nusing traitsDummy=char_traits<charTDummy>;\nCerrDummy& operator<<(CerrDummy&cd,basic_ostream<charTDummy,traitsDummy>&(basic_ostream<charTDummy,traitsDummy>&)){\n\treturn cd;\n}\n#define cerr cerrDummy\n#endif\n#define REACH cerr<<\"reached\"<<endl\n#define DMP(x) cerr<<#x<<\":\"<<x<<endl\n#define ZERO(x) memset(x,0,sizeof(x))\n#define ONE(x) memset(x,-1,sizeof(x))\n\nusing pi=pair<int,int>;\nusing vi=vector<int>;\nusing ld=long double;\n\ntemplate<class T,class U>\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\tos<<\"(\"<<p.first<<\",\"<<p.second<<\")\";\n\treturn os;\n}\n\ntemplate<class T>\nostream& operator <<(ostream& os,const vector<T>& v){\n\tos<<\"{\";\n\tREP(i,(int)v.size()){\n\t\tif(i)os<<\",\";\n\t\tos<<v[i];\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nll read(){\n\tll i;\n\tscanf(\"%\" SCNd64,&i);\n\treturn i;\n}\n\nvoid printSpace(){\n\tprintf(\" \");\n}\n\nvoid printEoln(){\n\tprintf(\"\\n\");\n}\n\nvoid print(ll x,int suc=1){\n\tprintf(\"%\" PRId64,x);\n\tif(suc==1)\n\t\tprintEoln();\n\tif(suc==2)\n\t\tprintSpace();\n}\n\nstring readString(){\n\tstatic char buf[3341000];\n\tscanf(\"%s\",buf);\n\treturn string(buf);\n}\n\nchar* readCharArray(){\n\tstatic char buf[3341000];\n\tstatic int bufUsed=0;\n\tchar* ret=buf+bufUsed;\n\tscanf(\"%s\",ret);\n\tbufUsed+=strlen(ret)+1;\n\treturn ret;\n}\n\ntemplate<class T,class U>\nvoid chmax(T& a,U b){\n\tif(a<b)\n\t\ta=b;\n}\n\ntemplate<class T,class U>\nvoid chmin(T& a,U b){\n\tif(b<a)\n\t\ta=b;\n}\n\ntemplate<class T>\nT Sq(const T& t){\n\treturn t*t;\n}\n\n#define CAPITAL\nvoid Yes(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"YES\"<<endl;\n\t#else\n\tcout<<\"Yes\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\nvoid No(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"NO\"<<endl;\n\t#else\n\tcout<<\"No\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\n\nconst ll infLL=LLONG_MAX/3;\n\n#ifdef int\nconst int inf=infLL;\n#else\nconst int inf=INT_MAX/2-100;\n#endif\n\nsigned main(){\n\tint n=read();\n\tstring s=readString();\n\tvi pos(n,-1);\n\tint cnt[2]{};\n\tvi cor(n*2,-1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tint j=cnt[s[i]-'a']++;\n\t\tif(pos[j]==-1)\n\t\t\tpos[j]=i;\n\t\telse\n\t\t\tcor[i]=pos[j];\n\t}\n\tcerr<<cor<<endl;\n\tvi ans;\n\tconst auto Compare=[&](const vi&a,const vi&b){\n\t\tint i=0,j=0;\n\t\twhile(1){\n\t\t\tif(i==int(a.size()))return false;\n\t\t\tif(j==int(b.size()))return true;\n\t\t\tif(s[a[i]]!=s[b[j]])return s[a[i]]>s[b[j]];\n\t\t\ti++;\n\t\t\tj++;\n\t\t}\n\t};\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tif(cor[i]!=-1){\n\t\t\tvi nx=ans;\n\t\t\tnx.insert(lower_bound(ALL(nx),i),i);\n\t\t\tnx.insert(lower_bound(ALL(nx),cor[i]),cor[i]);\n\t\t\tif(Compare(nx,ans))ans=nx;\n\t\t}\n\t}\n\tfor(auto i:ans)\n\t\tcout<<s[i];\n\tcout<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#pragma GCC optimize (\"O2,unroll-loops\")\n//#pragma GCC optimize(\"no-stack-protector,fast-math\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<pii, int> piii;\ntypedef pair<ll, ll> pll;\n#define debug(x) cerr<<#x<<'='<<(x)<<endl;\n#define debugp(x) cerr<<#x<<\"= {\"<<(x.first)<<\", \"<<(x.second)<<\"}\"<<endl;\n#define debug2(x, y) cerr<<\"{\"<<#x<<\", \"<<#y<<\"} = {\"<<(x)<<\", \"<<(y)<<\"}\"<<endl;\n#define debugv(v) {cerr<<#v<<\" : \";for (auto x:v) cerr<<x<<' ';cerr<<endl;}\n#define all(x) x.begin(), x.end()\n#define pb push_back\n#define kill(x) return cout<<x<<'\\n', 0;\n\nconst ld eps=1e-7;\nconst int inf=1000000010;\nconst ll INF=10000000000000010LL;\nconst int mod=1000000007;\nconst int MAXN=2010, LOG=20;\n\nint n, m, k, u, v, x, y, t, a, b, sum;\nint A[2][MAXN];\nbool mark[MAXN];\nstring ans, S, T;\n\nstring Solve(string T){\n\tstring res;\n\tif (T[0]=='a'){\n\t\tfor (char ch:T) if (res.empty() || res.back()!=ch) res+=ch;\n\t\treturn res;\n\t}\n\tint a=0, b=0;\n\tfor (int i=T.size()-1; ~i; i--){\n\t\tif (T[i]=='a') A[0][a++]=i;\n\t\tif (T[i]=='b') A[1][b++]=i;\n\t\tmark[i]=0;\n\t}\n\tfor (int i=0; 2*i<T.size(); i++){\n\t\tmark[A[0][i]]=mark[A[1][i]]=1;\n\t\tstring s;\n\t\tfor (int j=0; j<T.size(); j++) if (mark[j]) s+=T[j];\n\t\tres=max(res, s);\n\t}\n\treturn res;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\t//freopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\tcin>>n>>S;\n\tfor (int i=2*n-1; ~i; i--){\n\t\tif (S[i]=='a') sum++;\n\t\telse sum--;\n\t\tT=S[i]+T;\n\t\tif (sum==0){\n\t\t\tT=Solve(T);\n\t\t\tans=max(ans, T+ans);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\tcout<<ans<<\"\\n\";\n\t\n\treturn 0;\n}\n/*\n3\nbbabaa\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n;\nstring s;\n\ninline string get(int l, int r) {\n  string ret = \"\";\n  if (s[l] == 'a') {\n    for (int i = l, j = 0, k = 0, m = 0; i <= r; i++) {\n      if (s[i] == 'a') {\n        ++j;\n        if (k <= m) {\n          ret += \"ab\";\n          k = j;\n        }\n      } else {\n        ++m;\n      }\n    }\n  } else {\n    for (int t = 1; t <= r - l + 1 >> 1; t++) {\n      string cur = \"\";\n      for (int i = l, j = 0, k = 0; i <= r; i++) {\n        if (++(s[i] == 'a' ? j : k) >= t) {\n          cur += s[i];\n        }\n      }\n      ret = max(ret, cur);\n    }\n  }\n  return ret;\n}\n\nint main() {\n  cin >> n >> s;\n  vector<string> t, f;\n  for (int i = 0, sum = 0, last = 0; i < n << 1; i++) {\n    sum += s[i] == 'a' ? 1 : -1;\n    if (sum == 0) {\n      t.push_back(get(last, i));\n      last = i + 1;\n    }\n  }\n  f.resize(t.size());\n  for (int i = (int) t.size() - 1; ~i; i--) {\n    f[i] = i == (int) t.size() - 1 ? t[i] : max(f[i + 1], t[i] + f[i + 1]);\n  }\n  cout << f[0] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n,la[N];\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint check2(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn 1;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=1,j=1;i<=n;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj++;\n\t\t}\n\t\tla[j-1]=i-1;\n\t}\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\tj=la[i];\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tvector<int> p1,p2;\n\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\tif (s[l]=='a')p1.push_back(l);\n\t\t\t\telse p2.push_back(l);\n\t\t\tint now=0;\n\t\t\twhile (now<p1.size()){\n\t\t\t\ts1[++len1]='a';s1[++len1]='b';\n\t\t\t\tint k=p2[now];\n\t\t\t\twhile (now<p1.size()&&p1[now]<k)now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1,cnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1,cntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check2(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstring s;\nint n;\n\nstring solve(string t) {\n\tstring ans = \"\";\n\tif(t[0] == 'a') {\n\t\tvector <int> A, B;\n\t\tfor(int i = 0; i < t.size(); i++) {\n\t\t\tif(t[i] == 'a') {\n\t\t\t\tA.push_back(i);\n\t\t\t} else {\n\t\t\t\tB.push_back(i);\n\t\t\t}\n\t\t}\n\t\tint last = -1;\n\t\tfor(int i = 0; i < A.size(); i++) {\n\t\t\tif(last < A[i]) {\n\t\t\t\tans += \"ab\";\n\t\t\t\tlast = B[i];\n\t\t\t}\n\t\t}\n\t} else {\n\t\tans = \"\";\n\t\tfor(int i = 1; i <= (t.size() >> 1); i++) {\n\t\t\tint cntA = 0;\n\t\t\tint cntB = 0;\n\t\t\tstring str = \"\";\n\t\t\tfor(int j = 0; j < t.size(); j++) {\n\t\t\t\tif(t[j] == 'a') ++cntA;\n\t\t\t\telse ++cntB;\n\t\t\t\tif(t[j] == 'a' && cntA >= i) {\n\t\t\t\t\tstr += t[j];\n\t\t\t\t}\n\t\t\t\tif(t[j] == 'b' && cntB >= i) {\n\t\t\t\t\tstr += t[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, str);\n\t\t}\n\t}\n\t// cout << t << ' ' << ans << endl;\n\treturn ans;\n}\n\n\nint main(int argc, char const *argv[])\n{\n\tcin >> n;\n\tcin >> s;\n\tn <<= 1;\n\tstring t = \"\"; \n\tint cnt = 0;\n\tvector <string> part;\n\tfor(int i = 0; i < n; i++) {\n\t\tif(s[i] == 'a') {\n\t\t\t++cnt;\n\t\t} else {\n\t\t\t--cnt;\n\t\t}\n\t\tt += s[i];\n\t\tif(cnt == 0) {\n\t\t\tpart.emplace_back(solve(t));\n\t\t\tt = \"\";\n\t\t}\n\t}\n\tfor(int i = 0; i < part.size(); i++) {\n\t\tbool bad = false;\n\t\tfor(int j = i + 1; j < part.size(); j++) {\n\t\t\tif(part[i] < part[j]) {\n\t\t\t\tbad = true;\n\t\t\t\tbreak;\n\t\t\t} \t\n \t\t}\n \t\tif(!bad) {\n \t\t\tcout << part[i];\n \t\t}\n\t}\n\tcout << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int N = 3005;\nstd::string s, f[N];\nint n, apos[N], bpos[N], id[N];\nint main() {\n\tstd::ios::sync_with_stdio(0), std::cin.tie(0);\n\tstd::cin >> n >> s;\n\tint a = 0, b = 0;\n\tfor (int i = 0; i < n + n; ++i)\n\t\tif (s[i] == 'a') apos[a] = i, id[i] = a++;\n\t\telse bpos[b] = i, id[i] = b++;\n\tf[n - 1] = apos[n - 1] < bpos[n - 1] ? \"ab\" : \"ba\";\n\tfor (int i = n - 2; ~i; --i) {\n\t\tf[i] = f[i + 1];\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tf[i] = std::max(f[i], \"ab\" + f[i + std::count(s.begin() + apos[i], s.begin() + bpos[i], 'a')]);\n\t\t} else {\n\t\t\tstd::string t; int q = 0;\n\t\t\tfor (int j = bpos[i]; j < n + n; ++j) if (id[j] >= i) {\n\t\t\t\tq += s[j] == 'b' ? 1 : -1, t += s[j];\n\t\t\t\tif (!q) break;\n\t\t\t}\n\t\t\tf[i] = std::max(f[i], t + f[i + t.size() / 2]);\n\t\t}\n\t}\n\tstd::cout << f[0] << '\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\nint fre(int i) {\n\tint id = loc[i];\n\tif (s[i] == 'a')return vb[id];\n\telse return va[id];\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (fre(i)>i) {\n\t\t\t\tint to = fre(i) + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[fre(i)] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn;\n\n\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size() == len) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i]|ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tz[i].push_back(i);\n\t\t\t\tbz[i][i] = 1;\n\t\t\t\tbz[i][va[loc[i]]] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tint iid = loc[j];\n\t\t\t\t\t\tif (va[iid] > j) {\n\t\t\t\t\t\t\tz[i].push_back(j);\n\t\t\t\t\t\t\tbz[i][j] = 1;\n\t\t\t\t\t\t\tbz[i][va[loc[j]]] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(0);\n\tcout << trans(ans[0]) << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n#define pb push_back\n#define eb emplace_back\n#define all(x) x.begin(), x.end()\n#define debug(x) cerr << #x <<\": \" << (x) << endl\n//Ã�Â¥Ã¯Â¿Â½Ã�Â¨Ã�Â¦Ã�Â¯Ã¯Â¿Â½Ã�Â¤Ã�Â¸Ã�ÂªÃ�Â¥Ã¯Â¿Â½Ã�Â½Ã�Â¦Ã¯Â¿Â½Ã�Â°Ã�Â§Ã¯Â¿Â½Ã¯Â¿Â½Ã�Â¥Ã¯Â¿Â½Ã�Â¥Ã�Â¥Ã¯Â¿Â½Ã�Â£Ã�Â¥Ã�Â¤Ã¯Â¿Â½Ã�Â¦Ã¯Â¿Â½Ã�Â§Ã�Â¨Ã�Â¡Ã¯Â¿Â½Ã�Â¤Ã�Â¸Ã¯Â¿Â½Ã�Â¦Ã�Â¬Ã�Â¡Ã�Â¯Ã�Â¼Ã¯Â¿Â½Ã�Â¥Ã¯Â¿Â½Ã�ÂºÃ�Â¥Ã¯Â¿Â½Ã�Â£Ã�Â¥Ã�Â¤Ã¯Â¿Â½Ã�Â¦Ã¯Â¿Â½Ã�Â§Ã�Â¨Ã�Â¡Ã¯Â¿Â½Ã�Â¤Ã�Â¸Ã¯Â¿Â½Ã�Â¦Ã�Â¬Ã�Â¡Ã�Â£Ã¯Â¿Â½Ã¯Â¿Â½Ã�Â§Ã¯Â¿Â½Ã�Â¶Ã�Â¥Ã¯Â¿Â½Ã¯Â¿Â½Ã�Â¥Ã�Â°Ã�Â±Ã�Â¥Ã¯Â¿Â½Ã�Â¯Ã�Â¤Ã�Â»Ã�Â¥Ã�Â¥Ã�Â¿Ã�Â«Ã�Â©Ã¯Â¿Â½Ã¯Â¿Â½Ã�Â¥Ã�Â¾Ã¯Â¿Â½Ã�Â§Ã¯Â¿Â½Ã�Â¥Ã�Â¦Ã¯Â¿Â½Ã�Â¯Ã�Â¥Ã¯Â¿Â½Ã�ÂªÃ�Â¤Ã�Â¸Ã�ÂªÃ�Â¥Ã¯Â¿Â½Ã�Â°Ã�Â¦Ã¯Â¿Â½Ã�Â¹Ã�Â¦Ã�Â®Ã�ÂµÃ�Â©Ã¯Â¿Â½Ã¯Â¿Â½Ã�Â¨Ã�Â¯Ã�Â¯Ã�Â¤Ã�ÂºÃ¯Â¿Â½\n#define DEBUG printf(\"Passing [%s] in LINE %d\\n\",__FUNCTION__,__LINE__)\n#ifdef LOCAL\n#define see(x) cout  << #x << \": \" << (x) << endl\n#endif\n#ifndef LOCAL\n#define see(x)\n#endif\n\n\n#define rep(n) for(int _ = 0; _ != (n); ++_)\n//#define rep(i, a, b) for(int i = (a); i <= (b); ++i)\n#define Rng(i, n) for(int i = 0; i != (n); ++i)\n#define rng(i, a, b) for(int i = (a); i < (b); ++i)\n#define rno(i, b) for(int i = 0; i<(b); ++i)\n#define rnc(i, a, b) for(int i = (a); i<=(b); ++i)\n#define RNG(i, a) for(auto &i: (a))\n#define dwn(i, r, l) for(int i = (r); i>=(l); i--)\n\nnamespace std {\n    template<class T>\n    T begin(std::pair<T, T> p)\n    {\n        return p.first;\n    }\n    template<class T>\n    T end(std::pair<T, T> p)\n    {\n        return p.second;\n    }\n}\n\n\n#if __cplusplus < 201402L\ntemplate<class Iterator>\nstd::reverse_iterator<Iterator> make_reverse_iterator(Iterator it)\n{\n    return std::reverse_iterator<Iterator>(it);\n}\n#endif\n\ntemplate<class Range>\nstd::pair<std::reverse_iterator<decltype(begin(std::declval<Range>()))>, std::reverse_iterator<decltype(begin(std::declval<Range>()))>> make_reverse_range(Range &&r)\n{\n    return std::make_pair(make_reverse_iterator(::begin(r)), make_reverse_iterator(::end(r)));\n}\n\n#define RRNG(x, cont) for (auto &x: make_reverse_range(cont))\n\n\n\ntemplate<class T> int sign(const T &a) { return a == 0 ? 0 : a > 0 ? 1 : -1; }\ntemplate<class T> inline T min(T a, T b, T c){return min(min(a, b), c);}\ntemplate<class T> inline T max(T a, T b, T c){return max(max(a, b), c);}\ntemplate<class T> void Min(T &a, const T &b){ a = min(a, b); }\ntemplate<class T> void Max(T &a, const T &b){ a = max(a, b); }\n\ntemplate<typename T> void println(const T &t) { cout << t << '\\n'; }\ntemplate<typename T, typename ...Args> void println(const T &t, const Args &...rest) { cout << t << ' '; println(rest...); }\n\ntemplate<typename T> void print(const T &t) { cout << t << ' '; }\n\ntemplate<typename T, typename ...Args> void print(const T &t, const Args &...rest) { cout << t; print(rest...); }\n\n// this overload is chosen when there's only one argument\ntemplate<class T> void scan(T &t) { cin >> t; }\ntemplate<class T, class ...Args> void scan(T &a, Args &...rest) { cin >> a; scan(rest...); }\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing vec = vector<ll>;\nusing mat = vector<vec>;\nusing pii = pair<int, int>;\nusing pdd = pair<double, double>;\nusing pip = pair<int, pii>;\nusing szt = size_t;\nusing vi = vector<int>;\nusing vl = vector<ll>;\nusing vb = vector<bool>;\nusing vpii = vector<pii>;\nusing vvi = vector<vi>;\nusing pli = pair<ll,int>;\nusing wg = vector<vpii>; //weighted graph\n\nint cas;\nconst double pi = acos(-1);\nll mod = 1e9 + 7;\n\ntemplate<class T>\ninline void add_mod(T &a, const T &b) {\n    a += b;\n    if (a >= mod) a -= mod;\n}\ntemplate<class T>\nvoid sub_mod(T &a, const T &b){\n    a -= b;\n    if (a < 0) a += mod;\n}\nauto bo=[](int x){ //Ã�Â¤Ã�ÂºÃ¯Â¿Â½Ã�Â¨Ã�Â¿Ã¯Â¿Â½Ã�Â¥Ã¯Â¿Â½Ã�Â¶Ã�Â¨Ã�Â¾Ã¯Â¿Â½Ã�Â¥Ã¯Â¿Â½Ã�Âº\n    bitset<5> a(x);\n    cout << a << endl;\n};\n\n\n\nmat operator*(const mat &a, const mat &b) {\n    mat c(a.size(), vec(b[0].size()));\n    for (int i = 0; i < a.size(); i++) {\n        for (int j = 0; j < a[0].size(); j++) {\n            if (a[i][j]) { // optimization for sparse matrix\n                for (int k = 0; k < b[0].size(); k++) {\n                    add_mod(c[i][k], a[i][j] * b[j][k] % mod);\n                }\n            }\n        }\n    }\n    return c;\n}\n\nvec operator*(const mat &a, const vec &b) {\n    vec c(a.size());\n    for (int i = 0; i < a.size(); i++) {\n        for (int j = 0; j < a[0].size(); j++) {\n            add_mod(c[i], a[i][j] * b[j] % mod);\n        }\n    }\n    return c;\n}\n\nmat pow(mat a, ull n) {\n    mat res(a.size(), vec(a[0].size()));\n    for (int i = 0; i < a.size(); i++) {\n        res[i][i] = 1;\n    }\n    while (n) {\n        if (n & 1) {\n            res = res * a;\n        }\n        a = a * a;\n        n >>= 1;\n    }\n    return res;\n}\n\nstd::ostream& operator<<(std::ostream& os, __int128 T) {\n    if (T<0) os<<\"-\";\n    if (T>=10 ) os<<T/10;\n    if (T<=-10) os<<(-(T/10));\n    return os<<( (int) (T%10) >0 ? (int) (T%10) : -(int) (T%10) ) ;\n}\n\n__int128 LPOW(__int128 x, ll n) {\n    __int128 res = 1;\n    for (; n; n /= 2, x *= x, x %= mod) {\n        if (n & 1) {\n            res *= x;\n            res %= mod;\n        }\n    }\n    return res;\n}\n\nll POW(ll x, ll n){\n    ll res = 1;\n    for (; n; n /= 2, x *= x, x %= mod) {\n        if (n & 1) {\n            res *= x;\n            res %= mod;\n        }\n    }\n    return res;\n}\n\n\nll INV(ll x) {\n    return POW(x, mod - 2);\n}\n\nll inv(ll x){\n//    see(x);\n    return x == 1? 1: (mod - mod/x * inv(mod%x) % mod);\n}\n\n\n\n// 2D rotation\nvoid rotate(double &x, double &y, double theta) {\n    double tx = cos(theta) * x - sin(theta) * y;\n    double ty = sin(theta) * x + cos(theta) * y;\n    x = tx, y = ty;\n}\nnamespace bit {\n    const int BIT_N = 1e5 + 5;\n\n    int bit[BIT_N];\n    void init(int n){\n        rng(i, 1, n+1) bit[i] = 0;\n    }\n    int sum(int x) {\n        int res = 0;\n        while (x) {\n            res += bit[x];\n            x -= x & -x;\n        }\n        return res;\n    }\n\n    int sum(int l, int r) {\n        if (l > r) return 0;\n        return sum(r) - sum(l - 1);\n    }\n\n    void add(int x, int v, int n) {\n        while (x <= n) {\n            bit[x] += v;\n            x += x & -x;\n        }\n    }\n}\n\n\nnamespace util{\n    int len(ll x){return snprintf(nullptr, 0, \"%lld\", x);}\n    vi get_d(ll x){\n        vi res;\n        while(x) {\n            res.pb(x%10);\n            x /= 10;\n        }\n        reverse(all(res));\n        return res;\n    }\n    template <class T> T parity(const T &a){\n        return a & 1;\n    }\n    template <class T>\n    void out (const vector<T> &a){\n        std::copy(a.begin(), a.end(), std::ostream_iterator<T>(std::cout, \", \"));\n        cout << endl;\n    };\n}\n\nusing namespace util;\n\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\n\n\nusing order_statistic_tree = __gnu_pbds::tree<\n        int,\n        __gnu_pbds::null_type,\n        greater<int>,\n        __gnu_pbds::rb_tree_tag,\n        __gnu_pbds::tree_order_statistics_node_update>;\n\n\nconst ll LINF = LLONG_MAX/10;\nconst int INF = INT_MAX/10;\nconst int M = 3000 + 5;\n\n\nconst int N = 5e5+5;\n\n\nint m[1005][1005];\n\nint main() {\n    // Single Cut of Failure taught me\n    cout << std::fixed; //\n    cout << setprecision(10);\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n\n\n#ifdef LOCAL\n    freopen(\"main.in\", \"r\", stdin);\n//    freopen(\"main.out\", \"w\", stdout);\n#endif\n\n    int n;\n    scan(n);\n    string s;\n    scan(s);\n    vi a, b;\n    rng(i, 0, s.size()){\n        if(s[i]=='a') a.pb(i);\n        else b.pb(i);\n    }\n    int ma = 0;\n    rng(i, 0, n){\n        Max(ma, a[i] - b[i]);\n    }\n    if(ma == 0){\n        int t = 0;\n        string ans;\n        rng(i, 0, n){\n            if(a[i] >= t){\n                ans += \"ab\";\n                t = b[i]+1;\n            }\n        }\n        println(ans);\n    }\n    else{\n        vector<pair<string,pii>> x;\n        auto cmp =[](pair<string,pii> x, pair<string,pii> y){\n            return x.first > y.first || (x.first == y.first && x.second < y.second);\n        };\n        rng(i, 0, n){\n            if(b[i] < a[i]) {\n                vector<int> tmp;\n                tmp.pb(a[i]);\n                tmp.pb(b[i]);\n                int j = i+1;\n                int t = a[i];\n                while (j < n && b[j] < t) {\n                    tmp.pb(b[j]);\n                    tmp.pb(a[j]);\n                    t = a[j];\n                    ++j;\n                }\n                sort(all(tmp));\n                string str;\n                RNG(pos, tmp) str += s[pos];\n                x.eb(str, pii{b[i], t+1});\n            }\n        }\n        sort(all(x), cmp);\n        int pos = 0;\n        string ans;\n        RNG(i, x){ // x中不存在某个串是另一个串的 proper prefix\n//            println(i.first, i.second.first, i.second.second);\n            if(i.second.first >= pos){\n                ans += i.first;\n                pos = i.second.second;\n            }\n        }\n        rng(i, 0, n){\n            if(a[i] >= pos){\n                ans += \"ab\";\n                pos = b[i];\n            }\n        }\n        println(ans);\n    }\n\n\n#ifdef LOCAL\n    cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \" s.\\n\";\n#endif\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nconst int MAX = 3000;\n\nstring greedA(string S, int l) { // 先頭がaだった時の貪欲取得(abab…系)\n\tfor (int i = 1, j, k;i < l;++ i) {\n\t\tif (S[i] == 'a') { // 連続した'a'を発見\n\t\t\tfor (j = i + 1;S[j] == 'a';++ j); // 最初に出てくるb(消さない)\n\t\t\tfor (k = j + 1;S[k] == 'a';++ k); // 次に出てくるb(消す)\n\t\t\tS.erase(S.begin() + k);\n\t\t\tS.erase(S.begin() + i);\n\t\t\t-- i;\n\t\t} else ++ i;\n\t}\n\treturn S;\n}\n\nstring greedB(string S, int l) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring comp = S;\n\tfor (int i = 0, ma = l >> 1, j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tS = S > comp ? S : comp;\n\t}\n\treturn S;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstring greed[MAX];\n\tint use = 0;\n\t\n\tstring subst;\n\tfor (int l = 0, r = 0;l < N;l = r, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\t++ r;\n\t\tsubst = S.substr(l, r - l);\n\t\tif (isA[l]) greed[use] = greedA(subst, r - l);\n\t\telse greed[use] = greedB(subst, r - l);\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2*n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string fans;\n  for (int s = n - 1; s >= 0; s--) {\n    string ans;\n    vector<int> cind;\n    for (int i = s; i >= 0; i--) {\n      string cand = ans;\n      vector<int> candcind = cind;\n      {\n        int pos = b[i];\n        auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n        cand.insert(cand.begin() + (insind - candcind.begin()), 'b');\n        candcind.insert(insind, pos);\n      }\n      {\n        int pos = a[i];\n        auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n        cand.insert(cand.begin() + (insind - candcind.begin()), 'a');\n        candcind.insert(insind, pos);\n      }\n      if (cand > ans) {\n        ans = move(cand);\n        cind = move(candcind);\n      }\n    }\n    fans = max(fans, ans);\n  }\n  printf(\"%s\\n\", fans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#ifdef WIN32\n\t#define I64 \"%I64d\"\n#else\n\t#define I64 \"%lld\"\n#endif\n\ntypedef long long ll;\n\n#define f first\n#define s second\n#define mp make_pair\n#define pb push_back\n#define all(s) s.begin(), s.end()\n#define sz(s) (int(s.size()))\n#define fname \"a\"\n#define MAXN 7777\n\nint n, k;\nchar s[MAXN];\nint pos[MAXN];\nvector <int> g[2];\nstring d[MAXN], t;\nint dp[MAXN];\n\nint main()\n{\n\t#ifdef LOCAL\n\tfreopen(fname\".in\", \"r\", stdin);\n\tfreopen(fname\".out\", \"w\", stdout);\n\t#endif\n\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s);\n\tfor (int i = 0; i < n + n; ++i) {\n\t\tpos[i] = sz(g[s[i] - 'a']);\n\t\tg[s[i] - 'a'].pb(i);\n\t}\n\n\tfor (int i = 0, j; i < n + n; i = j, ++k) {\n\t\tint ka = 0, kb = 0;\n\t\ts[i] == 'a' ? ++ka : ++kb;\n\t\tj = i + 1;\n\t\twhile(j < n + n && ka != kb) {\n\t\t\ts[j] == 'a' ? ++ka : ++kb;\n\t\t\t++j;\n\t\t}\n\n\t\tint first = pos[i], last = pos[j - 1];\n\t\tint hasba = 0;\n\t\tfor (int z = first; z <= last; ++z) {\n\t\t\tif (g[0][z] > g[1][z])\n\t\t\t\thasba = 1;\n\t\t}\n\n\t\tif (!hasba) {\n\t\t\td[k] = \"\";\n\t\t\tint ri = -1;\n\t\t\tfor (int z = first; z <= last; ++z) {\n\t\t\t\tif (g[0][z] <= ri) continue;\n\t\t\t\tri = g[1][z];\n\t\t\t\td[k] += \"ab\";\n\t\t\t}\n\t\t} else {\n\t\t\td[k] = \"\";\n\t\t\tfor (int z = first; z <= last; ++z) {\n\t\t\t\tt = \"\";\n\t\t\t\tfor (int y = i; y < j; ++y) {\n\t\t\t\t\tif (pos[y] < z) continue;\n\t\t\t\t\tt += s[y];\n\t\t\t\t}\n\t\t\t\tif (lexicographical_compare(all(d[k]), all(t))) {\n\t\t\t\t\td[k] = t;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\n\tstring ans = \"\";\n\tfor (int i = k - 1; i >= 0; --i) {\n\t\tt = d[i] + ans;\n\t\tif (lexicographical_compare(all(ans), all(t))) {\n\t\t\tans = t;\n\t\t}\n\t\tt = d[i];\n\t\tif (lexicographical_compare(all(ans), all(t))) {\n\t\t\tans = t;\n\t\t}\n\t}\n\n\tputs(ans.c_str());\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n//    ios_base::sync_with_stdio(0); cin.tie(0);\n    int n; string s;\n    cin >> n >> s;\n    vector<pair<int, int>> vals;\n    vector<string> mx(n + 1);\n    vector<int> go(2 * n);\n    vector<int> label(2 * n);\n    int it1 = 0, it2 = 0;\n    while(it1 != 2 * n && it2 != 2 * n){\n        while(s[it1] != 'a') it1++;\n        while(s[it2] != 'b') it2++;\n        vals.emplace_back(min(it1, it2), max(it1, it2));\n        go[it1] = it2, go[it2] = it1;\n        it1++, it2++;\n    }\n    sort(vals.begin(), vals.end());\n    for(int i = 0; i < n; i++){\n        label[vals[i].first] = i;\n        label[vals[i].second] = i;\n    }\n    for(int loc = n - 1; loc >= 0; loc--){\n        int st = vals[loc].first, ed = vals[loc].second;\n        int last = st;\n        int cut = ed;\n        if(s[st] == 'b'){\n            while(last != cut){\n                cut = max(cut, go[last]);\n                last++;\n            }\n            if(go[last] > last) last--;\n        }\n        string fin = \"\";\n        if(s[st] == 'a'){\n            fin = \"ab\";\n        }\n        else{\n            for(int i = st; i <= last; i++){\n                if(s[i] == 'a' && go[i] < st) continue;\n                fin += s[i];\n            }\n        }\n        int nxt = -1;\n        for(int i = last + 1; i < 2 * n; i++){\n            if(go[i] > i){\n                nxt = i;\n                break;\n            }\n        }\n        if(nxt != -1) fin += mx[label[nxt]];\n        mx[loc] = max(mx[loc + 1], fin);\n    }\n    cout << mx[0] << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nconst int MAX = 3000;\n\nstring greedA(bool *isA, int l, int r) { // 先頭がaだった時の貪欲取得(abab…系)\n\tstring ret = \"a\";\n\t++ l;\n\tfor (bool useA = false;l < r;l ++) {\n\t\tif (isA[l] == useA) {\n\t\t\tret += useA ? 'a' : 'b';\n\t\t\tuseA = !useA;\n\t\t}\n\t}\n\treturn ret;\n}\n\nstring greedB(string S, int l, int r) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring ret = S.substr(l, (r - l)), comp = ret;\n\tfor (int i = 0, ma = ((r - l) >> 1), j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tret = ret > comp ? ret : comp;\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstring greed[MAX];\n\tint use = 0;\n\t\n\tfor (int l = 0, r = 0;l < N;l = r + 1, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\tif (isA[l]) greed[use] = greedA(isA, l, r + 1);\n\t\telse greed[use] = greedB(S, l, r + 1);\n//\t\tcout << \"[\" << l << \",\" << r << \"): \" << greed[use] << endl;\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using gpp_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename L> using gpp_map = tree<T, L, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T> using gpp_multiset = tree<T, null_type, less_equal<T>, rb_tree_tag, tree_order_statistics_node_update>;*/\nstruct fast_ios { fast_ios(){ cin.tie(0); ios::sync_with_stdio(false); cout << fixed << setprecision(20); }; } fast_ios_;\n#define FOR(i, begin, end) for(int i=(begin);i<(end);i++)\n#define REP(i, n) FOR(i,0,n)\n#define IFOR(i, begin, end) for(int i=(end)-1;i>=(begin);i--)\n#define IREP(i, n) IFOR(i,0,n)\n#define Sort(v) sort(v.begin(), v.end())\n#define Reverse(v) reverse(v.begin(), v.end())\n#define all(v) v.begin(),v.end()\n#define SZ(v) ((int)v.size())\n#define Lower_bound(v, x) distance(v.begin(), lower_bound(v.begin(), v.end(), x))\n#define Upper_bound(v, x) distance(v.begin(), upper_bound(v.begin(), v.end(), x))\n#define Max(a, b) a = max(a, b)\n#define Min(a, b) a = min(a, b)\n#define bit(n) (1LL<<(n))\n#define bit_exist(x, n) ((x >> n) & 1)\n#define debug(x) cout << #x << \"=\" << x << endl;\n#define vdebug(v) cout << #v << \"=\" << endl; REP(i_debug, v.size()){ cout << v[i_debug] << \",\"; } cout << endl;\n#define mdebug(m) cout << #m << \"=\" << endl; REP(i_debug, m.size()){ REP(j_debug, m[i_debug].size()){ cout << m[i_debug][j_debug] << \",\"; } cout << endl;}\n#define pb push_back\n#define f first\n#define s second\n#define int long long\n#define INF 1000000000000000000\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v){ for (auto &x : v) is >> x; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &v){ for(int i = 0; i < v.size(); i++) { cout << v[i]; if(i != v.size() - 1) cout << endl; }; return os; }\ntemplate<typename T> void Out(T x) { cout << x << endl; }\ntemplate<typename T1, typename T2> void Ans(bool f, T1 y, T2 n) { if(f) Out(y); else Out(n); }\n\nusing vec = vector<int>;\nusing mat = vector<vec>;\nusing Pii = pair<int, int>;\nusing PiP = pair<int, Pii>;\nusing PPi = pair<Pii, int>;\nusing bools = vector<bool>;\nusing pairs = vector<Pii>;\n\n//int dx[4] = {1,0,-1,0};\n//int dy[4] = {0,1,0,-1};\n//char d[4] = {'D','R','U','L'};\n\nconst int mod = 1000000007;\n//const int mod = 998244353;\n//#define Add(x, y) x = (x + (y)) % mod\n//#define Mult(x, y) x = (x * (y)) % mod\n\nvoid add_a(string &S, int i0, int i1, vector<string> &v){\n    char t = 'a';\n    string x = \"\";\n    FOR(i, i0, i1 + 1){\n        if(S[i] == t){\n            if(t == 'a') t = 'b';\n            else{\n                x += \"ab\";\n                t = 'a';\n            }\n        }\n    }\n    if(SZ(v) > 0 && v.back()[0] == 'a') v.back() += x;\n    else v.pb(x);\n}\n\nvoid add_b(string &S, int i0, int i1, vector<string> &v){\n    string x = \"\";\n    int now = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        Max(x, string(now, 'b') + S.substr(i + 1, i1 - i));\n    }\n    v.pb(x);\n}\n\nsigned main(){\n\n    int N; cin >> N;\n    string S; cin >> S;\n\n    vector<string> v;\n    int now = 0, i0 = 0;\n    REP(i, 2 * N){\n        if(S[i] == 'b') now++;\n        else now--;\n        if(now == 0){\n            if(S[i0] == 'a') add_a(S, i0, i, v);\n            else add_b(S, i0, i, v);\n            i0 = i + 1;\n        }\n    }\n    //vdebug(v);\n\n    vector<string> ans;\n    for(string x: v){\n        while(SZ(ans) > 0 && ans.back() < x) ans.pop_back();\n        ans.pb(x);\n    }\n    for(string x: ans) cout << x;\n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[N];\nstring s, ans = \"\";\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.assign(b.size(), \"\");\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans, c[i]);\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <string>\nint idx[6005], a[3005], b[3005], n, cnta, cntb;\nchar str[6005];\nstd::string work(int l, int r)\n{\n\tint lp = -1, rp;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tif (l <= a[i] && a[i] <= r)\n\t\t{\n\t\t\tif (lp == -1)\n\t\t\t\tlp = i;\n\t\t\trp = i;\n\t\t}\n\t}\n\tstd::string ans = \"\";\n\tif (a[lp] < b[lp])\n\t{\n\t\tint lst = -1;\n\t\tfor (int i = lp; i <= rp; i++)\n\t\t{\n\t\t\tif (lst < a[i])\n\t\t\t{\n\t\t\t\tans += \"ab\";\n\t\t\t\tlst = b[i];\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tfor (int i = lp; i <= rp; i++)\n\t{\n\t\tstd::string res = \"\";\n\t\tfor (int j = l; j <= r; j++)\n\t\t{\n\t\t\tif (idx[j] >= i)\n\t\t\t\tres += str[j];\n\t\t}\n\t\tans = std::max(ans, res);\n\t}\n\treturn ans;\n}\nstd::string dp[6005], val[6005];\nint main()\n{\n\t// freopen(\"AGC026-E.in\", \"r\", stdin);\n\tscanf(\"%d%s\", &n, str);\n\tfor (int i = 0; i < n << 1; i++)\n\t{\n\t\tif (str[i] == 'a')\n\t\t{\n\t\t\tidx[i] = cnta++;\n\t\t\ta[idx[i]] = i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tidx[i] = cntb++;\n\t\t\tb[idx[i]] = i;\n\t\t}\n\t}\n\tint len = 0, lst = 0, cur = 0;\n\tfor (int i = 0; i < n << 1; i++)\n\t{\n\t\tcur += str[i] == 'a' ? 1 : -1;\n\t\tif (!cur)\n\t\t{\n\t\t\tval[len++] = work(lst, i);\n\t\t\tlst = i + 1;\n\t\t}\n\t}\n\tfor (int i = len - 1; i >= 0; i--)\n\t\tdp[i] = std::max(dp[i + 1], val[i] + dp[i + 1]);\n\tputs(dp[0].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> vs;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      vs.push_back(naive(string(s.begin() + i, s.begin() + last)));\n      i = r - 1;\n    }\n  }\n  reverse(vs.begin(), vs.end());\n  for (const auto& str : vs)\n    ans = max(ans, str + ans);\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/*\nЗАПУСКАЕМ \n░ГУСЯ░▄▀▀▀▄░РАБОТЯГУ░░\n▄███▀░◐░░░▌░░░░░░░\n░░░░▌░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▌░░░░░▐▄▄░░░░░\n░░░░▌░░░░▄▀▒▒▀▀▀▀▄\n░░░▐░░░░▐▒▒▒▒▒▒▒▒▀▀▄\n░░░▐░░░░▐▄▒▒▒▒▒▒▒▒▒▒▀▄\n░░░░▀▄░░░░▀▄▒▒▒▒▒▒▒▒▒▒▀▄\n░░░░░░▀▄▄▄▄▄█▄▄▄▄▄▄▄▄▄▄▄▀▄\n░░░░░░░░░░░▌▌░▌▌░░░░░\n░░░░░░░░░░░▌▌░▌▌░░░░░\n░░░░░░░░░▄▄▌▌▄▌▌░░░░░ \n */\n#include <iostream>\n#include <complex>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <cstring>\n#include <ctime>\n#include <cstdlib>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <list>\n#include <cmath>\n#include <bitset>\n#include <cassert>\n#include <queue>\n#include <stack>\n#include <deque>\n    \n     \nusing namespace std;\ntemplate<typename T1, typename T2>inline void chkmin(T1 &x, T2 y) { if (x > y) x = y; }\ntemplate<typename T1, typename T2>inline void chkmax(T1 &x, T2 y) { if (x < y) x = y; } \ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const pair<T, U> &_p) { _out << _p.first << ' ' << _p.second; return _out; }\ntemplate<typename T, typename U> inline istream &operator>> (istream &_in, pair<T, U> &_p) { _in >> _p.first >> _p.second; return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const vector<T> &_v) { if (_v.empty()) { return _out; } _out << _v.front(); for (auto _it = ++_v.begin(); _it != _v.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline istream &operator>> (istream &_in, vector<T> &_v) { for (auto &_i : _v) { _in >> _i; } return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const unordered_map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\n#define sz(c) (int)(c).size()\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define left left228\n#define right right228\n#define next next228\n#define rank rank228\n#define prev prev228\n#define y1 y1228                                                         \n#define read(FILENAME) freopen((FILENAME + \".in\").c_str(), \"r\", stdin)\n#define write(FILENAME) freopen((FILENAME + \".out\").c_str(), \"w\", stdout)\n#define files(FILENAME) read(FILENAME), write(FILENAME)\n#define pb push_back\nconst string FILENAME = \"input\";\nconst int MAXN = 6001;\n\n\nint n;\nstring s;\nbool used[MAXN];\n\n\nstring get(string a) {\n\tvector<int> ga, gb;\n\tfor (int i = 0; i < sz(a); i++) {\n\t \tif (a[i] == 'a') {\n\t \t\tga.pb(i);\n\t \t} else {\n\t \t\tgb.pb(i);\n\t \t}\n\t}\n\tif (ga[0] < gb[0]) {\n\t\tstring cur;\n\t\tcur = \"ab\";\n\t\tint last = gb[0];\n\t\tfor (int i = 1; i < sz(ga); i++) {\n\t\t\tif (last < ga[i]) {\n\t\t\t\tcur += \"ab\";\n\t\t\t\tlast = gb[i];\n\t\t\t}\n\t\t}\n\t\treturn cur;\n\t} else {\n\t\tstring opt;\n\t\tfor (int i = sz(ga) - 1; i >= 0; i--) {\n\t\t\tmemset(used, 0, sizeof(used));\n\t\t\tfor (int j = i; j < sz(ga); j++) {\n\t\t\t\tused[ga[j]] = true;\n\t\t\t}\n\t\t\tfor (int j = i; j < sz(gb); j++) {\n\t\t\t\tused[gb[j]] = true;\n\t\t\t}\n\t\t\tstring b;\n\t\t\tfor (int j = 0; j < sz(a); j++) {\n\t\t\t\tif (used[j]) {\n\t\t\t\t\tb += a[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tchkmax(opt, b);\n\t\t}\n\t\treturn opt;\n\t}\n}\n\n\n\nstring dp[MAXN];\n\n\nint main() {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\t//read(FILENAME);\n\tcin >> n;\n\tcin >> s;\n\tstring cur;\n\tint bal = 0;\n\tvector<string> st;\n\tfor (int i = 0; i <\t2 * n; i++) {\n\t\tcur += s[i];\n\t\tif (s[i] == 'a') {\n\t\t\tbal++;\n\t\t} else {\n\t\t\tbal--;\n\t\t}\n\t\tif (bal == 0) {\n\t\t\tst.pb(get(cur));\n\t\t\tcur.clear();\n\t\t}\n\t}\n\tfor (int i = sz(st) - 1; i >= 0; i--) {\n\t\t//cout << st[i] << endl;\n\t\tdp[i] = st[i];\n\t\tchkmax(dp[i], dp[i + 1]);\n\t\tchkmax(dp[i], st[i] + dp[i + 1]);\n\t}\n\tcout << dp[0] << '\\n';\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3333;\nbool is_ab[maxn];\nint a[maxn], b[maxn];\nbool active[maxn * 2];\nint to[maxn];\nint main(){\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tvector<int> p[2];\n\tfor(int i = 0; i < 2 * n; i++){\n\t\tp[s[i] - 'a'].push_back(i);\n\t}\n\tfor(int i = 0; i < n; i++){\n\t\ta[i] = p[0][i];\n\t\tb[i] = p[1][i];\n\t\tis_ab[i] = a[i] < b[i];\n\t}\n\tvector<int> ab, ba;\n\tfor(int i = n - 1; i >= -1; i--){\n\t\tif(i == -1 || !is_ab[i]){\n\t\t\tfor(int j = 0; j <= i; j++) if(!is_ab[j]) ba.push_back(j);\n\t\t\tfor(int j = i + 1; j < n; j++) if(is_ab[j]) ab.push_back(j);\n\t\t\tbreak;\n\t\t}\n\t}\n\tint len_ba = ba.size();\n\tvector<string> dp(len_ba + 1, \"\");\n\tfor(int i = len_ba - 1; i >= 0; i--){\n\t\tdp[i] = dp[i + 1];\n\t\tto[i] = i;\n\t\tfor(int j = i + 1; j < len_ba; j++){\n\t\t\tif(b[ba[i]] <= b[ba[j]] && b[ba[j]] <= a[ba[i]]) to[i] = max(to[i], to[j]);\n\t\t}\n\t\tstring ival;\n\t\tvector<pair<int, char> > now;\n\t\tfor(int j = i; j <= to[i]; j++){\n\t\t\tnow.push_back({a[ba[j]], 'a'});\n\t\t\tnow.push_back({b[ba[j]], 'b'});\n\t\t}\n\t\tsort(now.begin(), now.end());\n\t\tfor(auto e : now) ival.push_back(e.second);\n\t\tival += dp[to[i] + 1];\n\t\tdp[i] = max(dp[i], ival);\n\t}\n\tint len_ab = ab.size();\n\tvector<string> f(len_ab + 1, \"\");\n\tfor(int i = len_ab - 1; i >= 0; i--){\n\t\tint nxt = len_ab;\n\t\tfor(int j = i + 1; j < len_ab; j++) if(a[ab[j]] > b[ab[i]]){\n\t\t\tnxt = j;\n\t\t\tbreak;\n\t\t}\n\t\tf[i] = max(f[i + 1], \"ab\" + f[nxt]);\n\t}\n\tcout << dp[0] + f[0] << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L;\n\t\twhile(cur>=L and cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t\tcontinue;\n\t\t\tres+=\"ab\";\n\t\t\tcur=nxt[cur]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tnxt[A]=-1;\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<X.size();A++)\n\t\tfor(int B=A+1;B<X.size();B++)\n\t\t\tif(occurence[A]==occurence[B])\n\t\t\t\tnxt[A]=B;\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define pb push_back\n\nconst int maxn = 3e3 + 20;\n\nint match[maxn * 2];\n\nstring s[maxn] , dp[maxn];\n\nint main()\n{\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\n\tint n;\n\tcin >> n >> s[0];\n\n\tfor(int i = 1; i < n; i++)\n\t{\n\t\ts[i] = s[i - 1];\n\t\tfor(int j = 0; j < (int)s[i].size(); j++)\n\t\t\tif(s[i][j] == 'a')\n\t\t\t{\n\t\t\t\ts[i].erase(s[i].begin() + j);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\tfor(int j = 0; j < (int)s[i].size(); j++)\n\t\t\tif(s[i][j] == 'b')\n\t\t\t{\n\t\t\t\ts[i].erase(s[i].begin() + j);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\tfor(int i = n - 1; i >= 0; i--)\n\t{\n\t\tdp[i] = dp[i + 1];\n\t\tint sz = s[i].size();\n\t\tvector<int> A , B;\n\t\tfor(int j = 0; j < sz; j++)\n\t\t{\n\t\t\tif(s[i][j] == 'a')\n\t\t\t\tA.pb(j);\n\t\t\telse\n\t\t\t\tB.pb(j);\n\t\t}\n\n\t\tfor(int j = 0; j < sz / 2; j++)\n\t\t\tmatch[A[j]] = B[j] , match[B[j]] = A[j];\n\n\t\tint mx = 0;\n\t\tfor(int k = 0; k < sz; k++)\n\t\t{\n\t\t\tmx = max(mx , match[k]);\n\t\t\tif(mx <= k)\n\t\t\t{\n\t\t\t\tdp[i] = max(dp[i] , s[i].substr(0 , k + 1) + dp[i + (k + 1) / 2]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << dp[0] << endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define FOR(i,a,b) for (register int i=(a);i<=(b);i++)\n#define For(i,a,b) for (register int i=(a);i>=(b);i--)\n#define MP make_pair\n#define pb push_back\n#define fi first\n#define se second\nusing namespace std;\nconst int N=6005;\nint n,a[N],b[N],vis[N],balance=0;\nstring s,ans=\"\";\nvector <string> vec;\ninline string sub(int l,int r)\n{\n\tstring str=\"\";\n\tFOR(i,l,r) if (!vis[i]) str+=s[i];\n\treturn str;\n}\ninline void solve(int l,int r)\n{\n\ta[0]=b[0]=0;\n\tFOR(i,l,r)\n\t\tif (s[i]=='a') a[++a[0]]=i;\n\t\telse b[++b[0]]=i;\n\tint last,tmp,mx=0;\n\tstring str=\"\";\n\tif (s[l]=='a')\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tlast=i,tmp=1;\n\t\t\tFOR(j,i+1,a[0]) if (a[j]>b[last]) last=j,tmp++;\n\t\t\tmx=max(mx,tmp);\n\t\t}\n\t\tFOR(i,1,mx) str+=\"ab\";\n\t}\n\telse\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tstr=max(str,sub(l,r));\n\t\t\tvis[a[i]]=vis[b[i]]=1;\n\t\t}\n\t\tFOR(i,1,a[0]) vis[a[i]]=vis[b[i]]=0;\n\t}\n\tvec.pb(str);\n\treturn;\n}\ninline int check(string s1,string s2)\n{\n\tint l1=s1.length(),l2=s2.length(),len=min(l1,l2);\n\tFOR(i,0,len-1)\n\t{\n\t\tif (s1[i]<s2[i]) return 1;\n\t\tif (s1[i]>s2[i]) return 0;\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tcin>>s;\n\tfor (register int l=0,r=0;l<2*n&&r<2*n;r++)\n\t{\n\t\tbalance+=(s[r]=='a')?1:-1;\n\t\tif (!balance) solve(l,r),l=r+1;\n\t}\n\tFOR(i,0,(int)vec.size()-1)\n\t{\n\t\tint tag=1;\n\t\tFOR(j,i+1,(int)vec.size()-1)\n\t\t\tif (check(vec[i],vec[j])) {tag=0;break;}\n\t\tif (tag) ans+=vec[i];\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\nstring re;\n\npair<string,int> solve(int r,string hint=\"\"){\n\tint i=r-1;\n\tvector<string> ss(1,hint);\n\twhile(abs((int)s[r-1]-(int)s[i-1])!=1){\n\t\tauto p=solve(i,ss.back());\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\t--i;\n\tvector<string> re;\n\trep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret,reb;\n\trreps(i,1,(int)re.size()) ret+=re[i];\n\tout(re,ret,1);\n\t// reps(i,1,re.size())if(re[i][0]=='b') reb+=re[i];\n\tif(i) MX(ret,string(1,s[i])+ret+string(1,s[r-1]));\n\t// if(i && re.size()>1) MX(ret,string(1,s[i])+re.front()+string(1,s[r-1]));\n\t// if(re.size()>1) MX(ret,re.front());\n\t// MX(ret,reb);\n\t// if(i) MX(ret,string(1,s[i])+reb+string(1,s[r-1]));\n\tout(i,r,ret,ss,re,1);\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\ts=\"e\"+s+\"f\";\n\tauto re=solve(2*n+2);\n\tcout<<re.X<<endl;\n\tout(re,1);\n\t// assert(re[0]=='e');\n\t// assert(re[m-1]=='f');\n\t// cout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,id[3010],a[3010],b[3010],p[2];\nchar s[3010];\nstring f[3010],g[3010];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n+n;i++)\n\t\tif (s[i]=='a') id[i]=++numa,a[numa]=i;\n\t\t\telse id[i]=++numb,b[numb]=i;\n\tint now=0;\n\tf[0]=\"\";\n\tfor (int i=n+n,j;i>=1;i=j-1)\n\t{\n\t\tj=i;\n\t\tp[0]=p[1]=0;\n\t\tp[s[j]-'a']=1;\n\t\twhile (p[0]!=p[1]) p[s[--j]-'a']++;\n\t\tf[++now]=\"\";\n\t\tif (s[j]=='a')\n\t\t{\n\t\t\tint k=j;\n\t\t\twhile (k<=i)\n\t\t\t{\n\t\t\t\tif (s[k]=='b') { k++;continue;}\n\t\t\t\tf[now]=f[now]+\"ab\";\n\t\t\t\tk=b[id[k]]+1;\n\t\t\t}\n\t\t}else\n\t\t{\n\t\t\tint S=id[j],T=id[i];\n\t\t\tfor (int k=T;k>=S;k--)\n\t\t\t{\n\t\t\t\tint x=k;\n\t\t\t\tg[k]=\"\";\n\t\t\t\twhile (x<T&&b[x+1]<a[x]) x++;\n\t\t\t\tfor (int l=j;l<=i;l++)\n\t\t\t\t\tif (id[l]>=k&&id[l]<=x) g[k]=g[k]+s[l];\n\t\t\t\tif (x+1<=T) g[k]=g[k]+g[x+1];\n\t\t\t\tif (k+1<+T) g[k]=max(g[k],g[k+1]);\n\t\t\t}\n\t\t\tf[now]=g[S];\n\n\t\t}\n\t\tf[now]=max(f[now]+f[now-1],f[now-1]);\n\t}\n\tprintf(\"%s\\n\",f[now].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\nchar str[6010];\nint aloc[3010], bloc[3010];\nint loc[6010];\nvector<int> ran;\n\nvector<string> vs;\nvoid print(int s, int e) {\n    if (str[s]=='a') {\n        int i;\n        for (i=s;i<e;i++) {\n            if (str[i]=='a') {\n                printf(\"ab\");\n                i = bloc[loc[i]];\n            }\n        }\n        return;\n    }\n    int i, j;\n    for (i=loc[s];i<loc[e];i++) {\n        string tmp;\n        for (j=s;j<e;j++) {\n            if (loc[j]>=i) tmp.push_back(str[j]);\n        }\n        vs.push_back(tmp);\n    }\n    sort(vs.begin(),vs.end());\n    for (char &ch : vs.back()) printf(\"%c\",ch);\n    vs.clear();\n}\n\nint main() {\n    int i, j;\n\n    scanf(\"%d\",&n);\n    scanf(\"%s\",str);\n    int a = 0, b = 0;\n    for (i=0;i<2*n;i++) {\n        if (str[i]=='a') {loc[i] = a; aloc[a] = i; a++;}\n        else {loc[i] = b; bloc[b] = i; b++;}\n    }\n    loc[2*n] = n;\n    int ps = 0;\n    ran.push_back(0);\n    for (i=0;i<2*n;i++) {\n        ps += ((str[i]=='a')?1:-1);\n        if (!ps) {\n            ran.push_back(i+1);\n        }\n    }\n    int p = -1;\n    for (i=(int)ran.size()-2;i>=0;i--) {\n        if (str[ran[i]]=='b') {\n            p = i;\n            break;\n        }\n    }\n    for (i=0;i<=p;i++) {\n        if (str[ran[i]]=='a') continue;\n        print(ran[i],ran[i+1]);\n    }\n    for (;i+1<ran.size();i++) {\n        print(ran[i],ran[i+1]);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MAX_N 3000\nusing namespace std;\ntemplate <class T> inline void read(T &x) {\n\tx = 0; int c = getchar(), f = 1;\n\tfor (; !isdigit(c); c = getchar()) if (c == 45) f = -1;\n\tfor (; isdigit(c); c = getchar()) (x *= 10) += f*(c-'0');\n}\nvector <string> S;\nstring s, f[MAX_N+5];\nstring sol() {\n\tvector <int> a, b, id, p;\n\tfor (int i = 0; i < (int)s.size(); i++)\n\t\tif (s[i] == 'a') a.push_back(i);\n\t\telse b.push_back(i);\n\tfor (int i = 0, pa = 0, pb = 0; i < (int)s.size(); i++)\n\t\tif (s[i] == 'a') id.push_back(pa), p.push_back(b[pa]), pa++;\n\t\telse id.push_back(pb), p.push_back(a[pb]), pb++;\n\tstring ret = \"\";\n\tif (s[0] == 'a') {\n\t\tfor (int i = 0; i < (int)s.size(); i++)\n\t\t\tif (s[i] == 'a') ret += \"ab\", i = p[i];\n\t} else {\n\t\tfor (int i = (int)id.size()-1; ~i; i--) {\n\t\t\tstring ss = \"\";\n\t\t\tfor (int j = 0; j < (int)s.size(); j++)\n\t\t\t\tif (id[j] >= i) ss.push_back(s[j]);\n\t\t\tret = max(ret, ss);\n\t\t}\n\t}\n\treturn ret;\n}\nint main() {\n\tint n; read(n); string str; cin >> str, s = \"\";\n\tfor (int i = 0, cnt = 0; i < (int)str.size(); i++) {\n\t\ts.push_back(str[i]), cnt += str[i] == 'a' ? 1 : -1;\n\t\tif (!cnt) S.push_back(sol()), s.clear();\n\t}\n\tstring ans = \"\";\n\tfor (int i = (int)S.size()-1; ~i; i--) {\n\t\tf[i] = S[i];\n\t\tfor (int j = i+1; j < (int)S.size(); j++)\n\t\t\tf[i] = max(f[i], S[i]+f[j]);\n\t\tans = max(ans, f[i]);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace TYC\n{\n\ttypedef pair<int, int> pii;\n\tconst int N = 3005;\n\n\tinline bool operator < (const string &a, const string &b)\n\t{\n\t\tint la = int(a.size()), lb = int(b.size()), l = min(la, lb);\n\t\tfor (int i = 0; i < l; i++)\n\t\t\tif (a[i] != b[i])\n\t\t\t\treturn a[i] < b[i];\n\t\treturn la < lb;\n\t}\n\n\tvoid solve(string &S)\n\t{\n\t\tstring ans;\n\t\tint len = int(S.size());\n\t\tif (S[0] == 'a')\n\t\t{\n\t\t\tstatic int A[N], B[N];\n\t\t\tfor (int i = 0, a = 0, b = 0; i < len; i++)\n\t\t\t\t(S[i] == 'a' ? A[++a] : B[++b]) = i;\n\t\t\tfor (int i = 1, c = len >> 1, p = 0; i <= c; i++)\n\t\t\t\tif (A[i] >= p)\n\t\t\t\t\tans += \"ab\", p = B[i] + 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twhile (len)\n\t\t\t{\n\t\t\t\tans = max(ans, S); \n\t\t\t\tS[0] = '#';\n\t\t\t\tfor (int i = 1; i < len; i++)\n\t\t\t\t\tif (S[i] == 'a')\n\t\t\t\t\t{\n\t\t\t\t\t\tS[i] = '#';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tfor (int i = 0, j = 0; i < len; i++)\n\t\t\t\t\tif (S[i] != '#')\n\t\t\t\t\t\tS[j++] = S[i];\n\t\t\t\tlen -= 2;\n\t\t\t\tS.resize(len);\n\t\t\t}\n\t\t}\n\t\tS = ans;\n\t}\n\n\tvoid work()\n\t{\n\t\tios::sync_with_stdio(false);\n\t\tcin.tie(0);\n\t\tstatic string S[N], Str;\n\t\tint n, tot = 1;\n\t\tcin >> n >> Str;\n\t\tfor (int i = 0, c = 0; i < (n << 1); i++)\n\t\t{\n\t\t\tS[tot] += Str[i];\n\t\t\tc += Str[i] == 'a' ? 1 : -1;\n\t\t   \tif (!c)\n\t\t\t\t++tot;\n\t\t}\t\n\t\tfor (int i = 1; i <= tot; i++)\n\t\t\tsolve(S[i]);\n\t\tstring ans;\n\t\tfor (int i = tot; i; i--)\n\t\t\tans = max(ans, S[i] + ans);\n\t\tcout << ans << '\\n';\n\t}\n}\n\nint main()\n{\n\tTYC::work();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n#ifdef wxh010910\n  freopen(\"input.txt\", \"r\", stdin);\n#endif\n  int n;\n  cin >> n;\n  string s;\n  cin >> s;\n  vector<int> sum(n << 1 | 1, 0);\n  for (int i = 0; i < n << 1; ++i) {\n    sum[i + 1] = sum[i] + (s[i] == 'a' ? 1 : -1);\n  }\n  int last = 0;\n  vector<string> all;\n  function<string(int, int)> get = [&](int l, int r) {\n    vector<int> a, b;\n    for (int i = l; i < r; ++i) {\n      if (s[i] == 'a') {\n        a.push_back(i);\n      } else {\n        b.push_back(i);\n      }\n    }\n    vector<bool> choose(r - l, false);\n    if (a[0] < b[0]) {\n      int last = -1;\n      for (int i = 0; i < r - l >> 1; ++i) {\n        if (a[i] > last) {\n          choose[a[i] - l] = choose[b[i] - l] = true;\n          last = b[i];\n        }\n      }\n      string result = \"\";\n      for (int i = 0; i < r - l; ++i) {\n        if (choose[i]) {\n          result += s[i + l];\n        }\n      }\n      return result;\n    } else {\n      string result = \"\";\n      for (int i = (r - l >> 1) - 1; ~i; --i) {\n        choose[a[i] - l] = choose[b[i] - l] = true;\n        string current = \"\";\n        for (int j = 0; j < r - l; ++j) {\n          if (choose[j]) {\n            current += s[j + l];\n          }\n        }\n        result = max(result, current);\n      }\n      return result;\n    }\n  };\n  for (int i = 1; i <= n << 1; ++i) {\n    if (!sum[i]) {\n      all.push_back(get(last, i));\n      last = i;\n    }\n  }\n  vector<string> suffix = all;\n  for (int i = all.size() - 2; ~i; --i) {\n    suffix[i] = max(suffix[i], suffix[i + 1]);\n  }\n  string answer = \"\";\n  for (int i = 0; i < all.size(); ++i) {\n    if (all[i] == suffix[i]) {\n      answer += all[i];\n    }\n  }\n  cout << answer << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    for(LL i=1;i<=2*n;++i) a[i]=1;\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n//#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    For(i, 0, b.size()){\n        c.pb(b[i]);\n        For(j, 0, i){\n            if (c[j] + b[i] > c[i]){\n                c[i] = c[j] + b[i];\n            }\n        }\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<vector>\nusing namespace std;\nvector<string> str,damn;\nvector<string> lis;\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tint n,i,j,k,l,lst=0,numa=0,numb=0,ite,nowa=0,nowb=0;\n\tstring s,t,hix;\n\tcin>>n>>s;\n\tfor(i=0;i<2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tnuma++;\n\t\t}\n\t\telse{\n\t\t\tnumb++;\n\t\t}\n\t\tif(numa==numb){\n\t\t\tstr.push_back(s.substr(lst,i-lst+1));\n\t\t\tlst=i+1;\n\t\t}\n\t}\n\tfor(i=0;i<str.size();i++){\n\t\tt=str[i];\n\t\thix=\"\";\n\t\tif(t[0]=='a'){\n\t\t\tite=0;\n\t\t\tnowa=0;\n\t\t\tnowb=0;\n\t\t\twhile(ite<t.size()){\n\t\t\t\twhile(ite<t.size()&&t[ite]=='b'){\n\t\t\t\t\tite++;\n\t\t\t\t\tnowb++;\n\t\t\t\t}\n\t\t\t\tif(ite==t.size()){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\thix+=\"ab\";\n\t\t\t\tj=nowa+1;\n\t\t\t\twhile(j>nowb){\n\t\t\t\t\tif(t[ite]=='b'){\n\t\t\t\t\t\tnowb++;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tnowa++;\n\t\t\t\t\t}\n\t\t\t\t\tite++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tt=damn.back();\n\t\t\tif(damn.size()&&t[0]=='a'){\n\t\t\t\tt+=hix;\n\t\t\t\tdamn.pop_back();\n\t\t\t\tdamn.push_back(t);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdamn.push_back(hix);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tnowb=0;\n\t\t\tfor(j=0;j<t.size();j++){\n\t\t\t\tif(t[j]=='b'){\n\t\t\t\t\tnowb++;\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnowb--;\n\t\t\t\t}\n\t\t\t\thix=max(hix,string(nowb,'b')+t.substr(j+1,t.size()-j-1));\n\t\t\t}\n\t\t\tdamn.push_back(hix);\n\t\t}\n\t}\n\tfor(i=0;i<damn.size();i++){\n\t\twhile(lis.size()&&lis.back()<damn[i]){\n\t\t\tlis.pop_back();\n\t\t}\n\t\tlis.push_back(damn[i]);\n\t}\n\tfor(i=0;i<lis.size();i++){\n\t\tcout<<lis[i];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring str , ans[6003]; int L;\n\nstring solve(int id){\n\tif(id == 2 * L) return string();\n\tif(ans[id].size()) return ans[id];\n\tif(str[id] == 'a'){\n\t\tint sum = 0 , pos = id;\n\t\twhile(pos < 2 * L && sum <= 0) sum += str[pos++] == 'a' ? -1 : 1;\n\t\tif(pos == 2 * L){\n\t\t\tqueue < int > stk; int r = -1;\n\t\t\tfor(int i = id ; i < 2 * L ; ++i)\n\t\t\t\tif(str[i] == 'a') stk.push(i);\n\t\t\t\telse{if(stk.front() > r){r = i; ans[id] += \"ab\";} stk.pop();}\n\t\t}\n\t\telse ans[id] = solve(pos - 1);\n\t}\n\telse{\n\t\tint sum = 1 , pos = id + 1;\n\t\twhile(pos < 2 * L && sum > 0) sum += str[pos++] == 'a' ? -1 : 1;\n\t\tstring temp = solve(pos); int num = (pos - id) / 2;\n\t\tfor(int i = 0 ; i <= num ; ++i){\n\t\t\tint cnta = 0 , cntb = 0; string now;\n\t\t\tfor(int j = id ; j < pos ; ++j)\n\t\t\t\tif(str[j] == 'a' && ++cnta > i) now += 'a';\n\t\t\t\telse if(str[j] == 'b' && ++cntb > i) now += 'b';\n\t\t\tnow += temp; if(ans[id] < now) ans[id] = now;\n\t\t}\n\t}\n\treturn ans[id];\n}\n\nint main(){cin >> L >> str; solve(0); cout << ans[0]; return 0;}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntemplate <typename T> void read(T &t) {\n\tt=0; char ch=getchar(); int f=1;\n\twhile (ch<'0'||ch>'9') { if (ch=='-') f=-1; ch=getchar(); }\n\tdo { (t*=10)+=ch-'0'; ch=getchar(); } while ('0'<=ch&&ch<='9'); t*=f;\n}\nconst int maxn=6010;\nint n,s[maxn],tot;\nchar t[maxn],ans[maxn],res[maxn];\nstruct node { int l,r,flag; } d[maxn];\nbool cmp(char *a,char *b) {\n\tint t1=strlen(a+1),t2=strlen(b+1);\n\tfor (int i=1;i<=max(t1,t2);i++) {\n\t\tif (i>t1) a[i]=0;\n\t\tif (i>t2) b[i]=0;\n\t\tif (a[i]!=b[i]) return a[i]<b[i];\n\t}\n\treturn 1;\n}\nbool cmp2(char *a,char *b) {\n\tint t1=strlen(a+1),t2=strlen(b+1);\n\tfor (int i=1;i<=t2;i++) {\n\t\tif (i>t1) a[i]=0;\n\t\tif (a[i]!=b[i]) return a[i]<b[i];\n\t}\n\treturn 1;\n}\nchar tmp[maxn];\nint id[maxn];\nvoid eq(char *a,char *b) {\n\tint len=strlen(b+1);\n\tfor (int i=1;i<=len;i++) a[i]=b[i];\n\ta[len+1]=0;\n}\nvoid solve(int l,int r) {\n\t// [l,r] has more 'b' than 'a' in every prefix\n\tint t1=0,t2=0,len;\n\tres[1]='a'-1; res[2]=0;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (t[i]=='a') id[i]=++t1;\n\t\telse id[i]=++t2;\n\t}\n\tfor (int i=1;i<=t1;i++) {\n\t\tlen=0;\n\t\tfor (int j=l;j<=r;j++)\n\t\t\tif (id[j]>=i) tmp[++len]=t[j];\n\t\ttmp[len+1]=0;\n\t\t//printf(\"%s\\n\",tmp+1);\n\t\tif (cmp(res,tmp)) eq(res,tmp);\n\t}\n}\nbool mk[maxn];\nint dy[maxn];\nvoid solve2(int l,int r) {\n\tint t1=0,t2=0;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (t[i]=='a') id[i]=++t1;\n\t\telse id[i]=++t2,dy[t2]=i;\n\t}\n\tint pos;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (!mk[i]&&t[i]=='a') {\n\t\t\tpos=dy[id[i]];\n\t\t\tfor (int j=i;j<=pos;j++) mk[j]=1;\n\t\t\ti=pos;\n\t\t\tprintf(\"ab\");\n\t\t}\n\t}\n}\nint main() {\n\t//freopen(\"1.txt\",\"r\",stdin);\n\tread(n); n*=2;\n\tscanf(\"%s\",t+1);\n\tint flag=0,sum=0;\n\tfor (int i=1;i<=n;i++) {\n\t\tif (t[i]=='a') sum++;\n\t\telse sum--;\n\t\ts[i]=sum;\n\t\tif (!flag) {\n\t\t\tif (sum<0) flag=-1;\n\t\t\telse if (sum>0) flag=1;\n\t\t}\n\t\tif (sum==0) {\n\t\t\ttot++;\n\t\t\td[tot]=(node){d[tot-1].r+1,i,flag};\n\t\t\tflag=0;\n\t\t}\n\t}\n\t//for (int i=1;i<=tot;i++)\n\t\t//printf(\"%d %d %d\\n\",d[i].l,d[i].r,d[i].flag);\n\tint pos=0,len;\n\tfor (int i=tot;i>=1;i--) {\n\t\tif (d[i].flag==1) continue;\n\t\tif (!pos) pos=i;\n\t\tsolve(d[i].l,d[i].r);\n\t//\tprintf(\"res=%s\\n\",res+1);\n\t\tif (cmp2(ans,res)) {\n\t\t\tlen=strlen(ans+1);\n\t\t\treverse(ans+1,ans+len+1);\n\t\t\tfor (int j=strlen(res+1);j>=1;j--)\n\t\t\t\tans[++len]=res[j];\n\t\t\t//printf(\"ans=%s\\n\",ans+1);\n\t\t\tans[len+1]=0;\n\t\t\treverse(ans+1,ans+len+1);\n\t\t}\n\t}\n\tprintf(\"%s\",ans+1);\n\tfor (int i=pos+1;i<=tot;i++) {\n\t\tsolve2(d[i].l,d[i].r);\n\t}\n\tprintf(\"\\n\");\n\treturn 0;\n}\n/*\n  0. Enough array size? Enough array size? Enough array size? Interger overflow?\n  \n  1. Think TWICE, Code ONCE!\n  Are there any counterexamples to your algo?\n    \n  2. Be careful about the BOUNDARIES!\n  N=1? P=1? Something about 0?\n    \n  3. Do not make STUPID MISTAKES!\n  Time complexity? Memory usage? Precision error?\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for((i)=1;(i)<=(n);(i)++)\nusing namespace std;\nint n,m,i,j,a[3005],b[3005],c1,c2,id[6005],pos[3005];\nstring st,f[3005];\nint main(){\n\tcin>>n>>st;\n\trep(i,n+n){\n\t\tif(st[i-1]=='a'){\n\t\t\ta[++c1]=i;\n\t\t\tid[i]=c1;\n\t\t}\n\t\telse{\n\t\t\tb[++c2]=i;\n\t\t\tid[i]=c2;\n\t\t}\n\t}\n\tst=\" \"+st;\n\tj=0;\n\ta[n+1]=b[n+1]=n+n+1;\n\tpos[n+n+1]=n+1;\n\trep(i,n+1){\n\t\twhile(j<min(a[i],b[i])){\n\t\t\tpos[++j]=i;\n\t\t}\n\t}\n\tfor(i=n;i;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tf[i]=\"ab\"+f[pos[b[i]+1]];\n\t\t}\n\t\telse{\n\t\t\tint j=b[i];\n\t\t\tf[i]=\"\";\n\t\t\twhile(b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1])){\n\t\t\t\tif(id[j]>=i) f[i]+=st[j];\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tf[i]+=f[id[j]];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n//\t\tcerr<<f[i]<<endl;\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  int N;\n  string s;\n  cin >> N;\n  cin >> s;\n\n  N *= 2;\n\n  vector<int> id(N);\n  {\n    int a = 0, b = 0;\n    for ( int i = 0; i < N; i++ ) {\n      if ( s[i] == 'a' ) id[i] = a++;\n      else id[i] = b++;      \n    }\n  }\n\n  vector<string> vs;\n  {\n    string t = \"\";\n    int sum = 0;  \n    for ( int i = 0; i < N; i++ ) {\n      sum += (s[i] == 'a' ? 1 : -1);\n      t += s[i];\n      if ( sum == 0 ) {\n\tvs.emplace_back(t);\n\tt = \"\";\n      }\n    }    \n  }\n\n  vector<string> maxs;\n  int off = 0;\n  for ( string t : vs ) {\n    string u = \"\";\n    if ( t[0] == 'a' ) {\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) {\n\t  u += \"ab\";\n\t  int j = i;\t  \n\t  i++;\t  \n\t  while ( id[off+j] != id[off+i] ) i++;\t  \n\t}\n      }\n    } else {\n      string ma = \"\";\t\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) continue;\t\n\tu = \"\";\t\n\tfor ( int j = i; j < (int)t.size(); j++ ) {\n\t  if ( id[off+i] <= id[off+j] ) u += t[j];\t  \n\t}\n\tma = max(ma, u);\t\n      }\n      u = ma;\n    }\n    off += t.size();    \n    maxs.emplace_back(u);    \n  }\n\n  string ans = \"\";\n  for ( int i = (int)maxs.size()-1; i >= 0; i-- ) {\n    // cout << maxs[i] << endl;\n    if ( ans <= maxs[i]+ans ) ans = maxs[i]+ans;    \n  }\n\n  cout << ans << endl;\n  \n  return 0;  \n}\n"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<vector>\n#include<tuple>\n#include<algorithm>\nusing namespace std;\n#define ran 6200\nint n,m;string s;\nvector<int> A, B;\ntuple<int, int, bool> a[ran];\npair<string, int> c[ran];\nvector<string> dp[ran];\nbool g[ran];\nvoid upd(vector<string>&A,const vector<string>&B) {\n\tstring a = \"\", b = \"\";\n\tfor (auto c : A)a += c;\n\tfor (auto c : B)b += c;\n\tif (a < b)A = B;\n}\nint main() {\n\tcin >> n >> s;\n\tm = s.length();\n\tfor (int i = 0; i < m; i++) {\n\t\tif (s[i] == 'a')A.push_back(i);else\n\t\t\tB.push_back(i);\n\t\tc[i].second = -1;\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tif (A[i] < B[i])\n\t\t\ta[i] = make_tuple(A[i], B[i], false);\n\t\telse\n\t\t\ta[i] = make_tuple(B[i], A[i], true);\n\t}\n\tsort(a, a + n);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (!get<2>(a[i])) {\n\t\t\tc[get<0>(a[i])] = make_pair(\"ab\", get<1>(a[i]) + 1);\n\t\t}\n\t\telse {\n\t\t\tmemset(g, 0, sizeof(g));\n\t\t\tint L = get<0>(a[i]), R = get<1>(a[i]);\n\t\t\tfor (int j = 0; j < n; j++){\n\t\t\t\tint x = get<0>(a[j]), y = get<1>(a[j]);\n\t\t\t\tif (x >= L && x <= R && get<2>(a[j])) {\n\t\t\t\t\tR = max(R, y);\n\t\t\t\t\tg[x] = g[y] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring cur = \"\";L = R = -1;\n\t\t\tfor (int j = 0; j < m; j++)if (g[j]) {\n\t\t\t\tif (L == -1)L = j;\n\t\t\t\tR = j;\n\t\t\t\tcur += s[j];\n\t\t\t}\n\t\t\tc[L] = make_pair(cur, R + 1);\n\t\t}\n\t}\n\tdp[0].clear();\n\tfor (int i = 0; i < m; i++){\n\t\tauto vs = dp[i];\n\t\tupd(dp[i + 1], dp[i]);\n\t\tif (c[i].second != -1) {\n\t\t\twhile (vs.size() > 0 && vs.back() < c[i].first)\n\t\t\t\tvs.pop_back();\n\t\t\tvs.push_back(c[i].first);\n\t\t\tupd(dp[c[i].second], vs);\n\t\t}\n\t}\n\tstring out = \"\";\n\tfor (auto it : dp[m])\n\t\tout += it;\n\tputs(out.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6e5+5;\nint n,i,j,k,id[N],oo[N];\nstring s,f[N];\nvector<int>v[2];\nint main(){\n\tios::sync_with_stdio(0);cin.tie(0);\n\tcin>>n>>s;for(i=0;i<n*2;++i)v[s[i]-'a'].push_back(i);\n\tfor(i=0;i<n;++i)id[v[0][i]]=id[v[1][i]]=i,oo[v[0][i]]=v[1][i],oo[v[1][i]]=v[0][i];\n\tfor(i=n*2-1;i>=0;--i)if(oo[i]>i){\n\t\tif(s[i]=='a'){f[i]=max(\"ab\"+f[oo[i]+1],f[i+1]);continue;}\n\t\tf[i]=\"b\";\n\t\tfor(j=i+1,k=oo[i];j<k;++j){\n\t\t\tif(oo[j]>j)k=oo[j];\n\t\t\tif(id[j]>=id[i])f[i]=f[i]+s[j];\n\t\t}\n\t\tf[i]=f[i]+\"a\"+f[j+1];\n\t\tf[i]=max(f[i],f[i+1]);\n\t}else f[i]=f[i+1];\n\tcout<<f[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\nstring re;\n\npair<string,int> solve(int r,string hint=\"\"){\n\tint i=r-1;\n\tout(r,i,1);\n\tvector<string> ss(1,hint);\n\twhile(abs(s[r-1]-s[i-1])!=1){\n\t\tauto p=solve(i,ss.back());\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\tvector<string> re;\n\trrep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret,reb;\n\trrep(i,re.size()) ret+=re[i];\n\trrep(i,re.size())if(re[i][0]=='b') reb+=re[i];\n\tif(i) MX(ret,string(1,s[i])+ret+string(1,s[r-1]));\n\tif(i && re.size()) MX(ret,string(1,s[i])+re.front()+string(1,s[r-1]));\n\tif(re.size()) MX(ret,re.front());\n\tMX(ret,reb);\n\tif(i) MX(ret,string(1,s[i])+reb+string(1,s[r-1]));\n\tout(i,r,ret,1);\n\t--i;\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\ts=\"e\"+s+\"f\";\n\tsolve(2*n+2);\n\tauto re=solve(0);\n\tcout<<re.X<<endl;\n\tout(re,1);\n\t// assert(re[0]=='e');\n\t// assert(re[m-1]=='f');\n\t// cout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n  int n;\n  scanf(\"%d\",&n);\n  static char s[10000];\n  scanf(\"%s\",s);\n  static int a[3000],b[3000],c[10000];\n  int na=0,nb=0;\n  for(int i=0;i<2*n;i++){\n    if(s[i]=='a'){\n      a[na]=i;\n      c[i]=na++;\n    }\n    else{\n      b[nb]=i;\n      c[i]=nb++;\n    }\n  }\n  vector<int> bg,ed;\n  for(int i=0;i<n;){\n    if(a[i]>b[i]){\n      bg.push_back(i);\n      int t=a[i];\n      while(b[i]<t){\n\tt=a[i];\n\ti++;\n      }\n      ed.push_back(i);\n    }\n    else{\n      i++;\n    }\n  }\n  string ans;\n  for(int t=bg.size()-1;t>=0;t--){\n    int x=bg[t],y=ed[t];\n    string p=\"\";\n    for(int i=x;i<y;i++){\n      string q;\n      for(int j=0;j<2*n;j++){\n\tif(c[j]>=i&&c[j]<y){\n\t  q+=s[j];\n\t}\n      }\n      if(p<q){\n\tp=q;\n      }\n    }\n    if(p+ans>ans){\n      ans=p+ans;\n    }\n  }\n  for(int i=n-1;i>=0&&a[i]<b[i];){\n    ans+=\"ab\";\n    int t=a[i];\n    while(i>=0&&b[i]>t)i--;\n  }\n  printf(\"%s\\n\",ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\nint PAIR[6050];\nstring dp[6050];\n\nint main() {\n    //cout.precision(10);\n    int N;\n    string S;\n    cin >> N >> S;\n    S = \"#\" + S;\n    queue<int> a, b;\n    for(int i = 1; i <= 2*N; i++) {\n        if(S[i] == 'a') a.push(i);\n        else b.push(i);\n    }\n    for(int i = 1; i <= N; i++) {\n        int A = a.front();\n        int B = b.front();\n        a.pop();\n        b.pop();\n        PAIR[A] = B;\n        PAIR[B] = A;\n    }\n    for(int i = 1; i <= 2*N; i++) {\n        //cerr << PAIR[i] << endl;\n    }\n    for(int index = 2*N; index >= 1; index--) {\n        dp[index] = dp[index + 1];\n        if(PAIR[index] < index) continue;\n        if(S[index] == 'a') {\n            string sub = \"ab\" + dp[PAIR[index] + 1];\n            dp[index] = max(dp[index], sub);\n            continue;\n        }\n        if(S[index] == 'b') {\n            string sub = \"b\";\n            int plus = 1;\n            int sub_index = index + 1;\n            for(; plus > 0; sub_index++) {\n                if(S[sub_index] == 'b') {\n                    sub.push_back('b');\n                    plus++;\n                    continue;\n                }\n                if(sub_index < PAIR[index]) continue;\n                sub.push_back('a');\n                plus--;\n            }\n            sub = sub + dp[sub_index];\n            dp[index] = max(dp[index], sub);\n        }\n    }\n    cout << dp[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/detail/standard_policies.hpp>\nusing ll = int64_t;\nusing ld = double;\nusing ull = uint64_t;\nusing namespace std;\nusing namespace __gnu_pbds;     \n\nconst int MAXN = 6228;\nint l[MAXN];\nint r[MAXN];\nint la[MAXN];\nint ra[MAXN];\nstring f[MAXN];\n\nint main() {\n#ifdef BZ\n    freopen(\"input.txt\", \"r\", stdin); freopen(\"output.txt\", \"w\", stdout);\n#endif\n    ios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr); cout.setf(ios::fixed); cout.precision(20);\n    int n;\n    string s;\n    cin >> n >> s;\n    int lc = 0, rc = 0;\n\n    for (int i = 0; i < s.length(); ++i) {\n        if (s[i] == 'b') {\n            l[lc++] = i;\n        } else {\n            r[rc++] = i;\n        }\n    }\n\n    int ac = 0;\n\n    for (int i = 0; i < n; ++i) {\n        if (l[i] < r[i]) {\n            la[ac] = l[i];\n            ra[ac] = r[i];\n            ++ac;\n        }\n    }\n\n    la[ac] = ra[ac] = MAXN;\n\n    if (!ac) {\n        int cur = 0;\n        while (cur < n) {\n            cout << \"ab\";\n            int cb = l[cur];\n            while (r[cur] < cb) {\n                ++cur;\n            }\n        }\n\n        cout << \"\\n\";\n        return 0;\n    }\n\n\n    f[ac] = \"\";\n    for (int i = ac - 1; i >= 0; --i) {\n        int lp = i, rp = i;\n        string cur;\n        do {\n            if (la[lp] < ra[rp]) {\n                cur += 'b';\n                ++lp;\n            } else {\n                cur += 'a';\n                ++rp;\n            }\n        } while (lp != rp);\n\n        cur += f[lp];\n        f[i] = max(f[i + 1], cur);\n    }\n\n    cout << f[0] << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define db(x) cerr << #x << \"=\" << x << endl\n#define db2(x, y) cerr << #x << \"=\" << x << \",\" << #y << \"=\" << y << endl\n#define db3(x, y, z) cerr << #x << \"=\" << x << \",\" << #y << \"=\" << y << \",\" << #z << \"=\" << z << endl\n#define dbv(v) cerr << #v << \"=\"; for (auto x : v) cerr << x << \", \"; cerr << endl\n#define dba(a, n) cerr << #a << \"=\"; for (int i = 0; i < (n); ++i) cerr << a[i] << \", \"; cerr << endl\ntypedef long long ll;\ntypedef long double ld;\nchar S[6005];\nint occa[3005], occb[3005], times[6005];\nstring ans[3005];\nint main() {\n\tint n;\n\tscanf(\"%d%s\", &n, S);\n\tint len = strlen(S);\n\tfor (int i = 0, a = 0, b = 0; i < len; ++i) {\n\t\tif (S[i] == 'a') {\n\t\t\tocca[++a] = i;\n\t\t\ttimes[i] = a;\n\t\t} else {\n\t\t\toccb[++b] = i;\n\t\t\ttimes[i] = b;\n\t\t}\n\t}\n\tstring best;\n\tfor (int i = n; i >= 1; --i) {\n\t\t// start from i-th occurence\n\t\tif (occa[i] < occb[i]) {\n\t\t\tint t = i;\n\t\t\tfor (int j = occa[i] + 1; j < occb[i]; ++j)\n\t\t\t\tt = max(t, times[j]);\n\t\t\tans[i] = \"ab\" + ans[t + 1];\n\t\t} else {\n\t\t\tint t = i;\n\t\t\twhile (t <= n && occb[t + 1] < occa[t]) {\n\t\t\t\t++t;\n\t\t\t}\n\t\t\tfor (int j = occb[i]; j < len; ++j) {\n\t\t\t\tif (times[j] >= i && times[j] <= t) ans[i] += S[j];\n\t\t\t}\n\t\t\tans[i] += ans[t + 1];\n\t\t}\n\t\tans[i] = max(ans[i], ans[i + 1]);\n\t\tbest = max(best, ans[i]);\n\t}\n\tprintf(\"%s\\n\", best.c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned ll\n#define uint unsigned\n#define pii pair<int,int>\n#define pll pair<ll,ll>\n#define PB push_back\n#define fi first\n#define se second\n#define For(i,j,k) for (int i=(int)(j);i<=(int)(k);i++)\n#define Rep(i,j,k) for (int i=(int)(j);i>=(int)(k);i--)\n#define CLR(a,v) memset(a,v,sizeof(a));\n#define CPY(a,b) memcpy(a,b,sizeof(a));\nusing namespace std;\nconst int N=6005;\nint A[N],B[N];\nchar s[N];\nstring ans;\nint n,vis[N];\nvoid work(int x,int y){\n\t//printf(\"%d %d\\n\",x,y);\n\tstring tmp=\"\";\n\tif (A[x]<B[x]){\n\t\tint p=2*x-2;\n\t\tfor (;;){\n\t\t\tint np=-1;\n\t\t\tFor(j,x,y)\n\t\t\t\tif (p<A[j]&&(np==-1||B[j]<B[np])) np=j;\n\t\t\tif (np==-1) break;\n\t\t\ttmp=tmp+\"ab\";\n\t\t\tp=B[np];\n\t\t}\n\t}\n\telse{\n\t\tRep(i,y,x){\n\t\t\tstring tmpp=\"\";\n\t\t\tvis[A[i]]=vis[B[i]]=1;\n\t\t\tFor(j,2*x-1,2*y) if (vis[j]) tmpp.PB(s[j]);\n\t\t\tif (tmpp>tmp) tmp=tmpp;\n\t\t\t//cout<<tmp<<' '<<tmpp<<endl;\n\t\t}\n\t}\n\t//cout<<tmp<<endl;\n\tif (tmp+ans>ans)\n\t\tans=tmp+ans;\n}\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tFor(i,1,2*n)\n\t\tif (s[i]=='a')\n\t\t\tA[++*A]=i;\n\t\telse B[++*B]=i;\n\tint p=2*n,S=0;\n\tRep(i,2*n,1){\n\t\tS+=(s[i]=='a'?1:-1);\n\t\tif (!S) work((i+1)/2,p/2),p=i;\n\t}\n\tcout<<ans;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nstring calc(string s){\n  //cout<<s<<endl;\n  string res;\n  Int n=s.size();\n  if(s[0]=='a'){\n    vector<Int> a(n*2);\n    for(Int i=0,j=0;i<n;i++){\n      if(s[i]=='b') continue;\n      while(s[j]=='a') j++;\n      a[i]=j++;\n    }\n    for(Int i=0;i<n;i++){\n      if(s[i]=='x') continue;\n      assert(s[i]=='a');\n      res+=\"ab\";\n      for(Int j=i;j<a[i];j++)\n\tif(s[j]=='a') s[j]=s[a[j]]='x';\n    }\n  }else{\n    for(Int k=0;k<n;k++){\n      Int a=0,b=0;\n      string tmp;\n      for(Int i=0;i<n;i++){\n\tif(s[i]=='a'){\n\t  if(a>=k) tmp+=s[i];\n\t  a++;\n\t}else{\n\t  if(b>=k) tmp+=s[i];\n\t  b++;\n\t}\n      }\n      chmax(res,tmp);\n    }\n  }\n  //cout<<res<<endl;\n  return res;\n}\n\nsigned main(){\n  Int n;\n  string s;\n  cin>>n>>s;\n  n*=2;\n  vector<string> v;\n  Int x[2]={1,-1};\n  for(Int i=0;i<n;){\n    Int j=i,k=x[s[j++]-'a'];\n    while(j<n&&k!=0) k+=x[s[j++]-'a'];\n    assert(k==0);\n    v.emplace_back(calc(s.substr(i,j-i)));\n    //cout<<i<<\" \"<<j<<endl;\n    i=j;\n  }\n  reverse(v.begin(),v.end());\n  string ans;\n  for(string t:v)\n    chmax(ans,t+ans);\n  cout<<ans<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\n\nint main() {\n  int n;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  vector<int> a, b;\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  vector<int> ba;\n  int ab_start = 0;\n  for (int i = 0; i < n; i++) {\n    if (a[i] > b[i]) {\n      ba.push_back(i);\n      ab_start = i + 1;\n    }\n  }\n  string ans;\n  for (int i = ba.size() - 1; i >= 0; i--) {\n    vector<int> indices;\n    indices.reserve(2 * n);\n    for (int j = i; j < ba.size(); j++) {\n      indices.push_back(a[ba[j]]);\n      indices.push_back(b[ba[j]]);\n    }\n    sort(indices.begin(), indices.end());\n    string cur;\n    cur.reserve(indices.size());\n    for (auto vi : indices) {\n      cur.push_back(buff[vi]);\n    }\n    ans = max(ans, cur);\n  }\n  int last_ind = -1;\n  for (int i = ab_start; i < n; i++) {\n    if (last_ind < a[i]) {\n      ans += \"ab\";\n      last_ind = b[i];\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tint lsta = 0;\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tcntb += o[k] == 'b';\n\t\t\t\tif(o[k] == 'a') {\n\t\t\t\t\tcnta += o[k] == 'a';\n\t\t\t\t\tif(to.empty() || to.back() == 'b') to += 'a';\n\t\t\t\t\tlsta = k;\n\t\t\t\t} else {\n\t\t\t\t\tcntb += o[k] == 'a';\n\t\t\t\t\tif(cntb == lsta) to += 'b';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\nint fre(int i) {\n\tint id = loc[i];\n\tif (s[i] == 'a')return vb[id];\n\telse return va[id];\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (valid[i]) {\n\t\t\t\tint to = i + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[vb[loc[i]]] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn;\n\n\t\tint to = le + 1;\n\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\tdfs(to);\n\t\tans[le] = ans[to];\n\t\tans[le][le] = 1;\n\t\tif (s[le] == 'a') {\n\t\t\tint id = loc[le];\n\t\t\tans[le][vb[id]] = 1;\n\t\t}\n\t\telse {\n\t\t\tint id = loc[le];\n\t\t\tans[le][va[id]] = 1;\n\t\t}\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size() == len) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i]|ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tz[i].push_back(i);\n\t\t\t\tbz[i][i] = 1;\n\t\t\t\tbz[i][va[loc[i]]] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tint iid = loc[j];\n\t\t\t\t\t\tif (va[iid] > j) {\n\t\t\t\t\t\t\tz[i].push_back(j);\n\t\t\t\t\t\t\tbz[i][j] = 1;\n\t\t\t\t\t\t\tbz[i][va[loc[j]]] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(0);\n\tcout << trans(ans[0]) << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nclock_t t=clock();\nnamespace my_std{\n\tusing namespace std;\n\t#define pii pair<int,int>\n\t#define fir first\n\t#define sec second\n\t#define MP make_pair\n\t#define rep(i,x,y) for (int i=(x);i<=(y);i++)\n\t#define drep(i,x,y) for (int i=(x);i>=(y);i--)\n\t#define go(x) for (int i=head[x];i;i=edge[i].nxt)\n\t#define templ template<typename T>\n\t#define sz 3300\n\ttypedef long long ll;\n\ttypedef double db;\n\tmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ttempl inline T rnd(T l,T r) {return uniform_int_distribution<T>(l,r)(rng);}\n\ttempl inline bool chkmax(T &x,T y){return x<y?x=y,1:0;}\n\ttempl inline bool chkmin(T &x,T y){return x>y?x=y,1:0;}\n\ttempl inline void read(T& t)\n\t{\n\t\tt=0;char f=0,ch=getchar();double d=0.1;\n\t\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\t\twhile(ch<='9'&&ch>='0') t=t*10+ch-48,ch=getchar();\n\t\tif(ch=='.'){ch=getchar();while(ch<='9'&&ch>='0') t+=d*(ch^48),d*=0.1,ch=getchar();}\n\t\tt=(f?-t:t);\n\t}\n\ttemplate<typename T,typename... Args>inline void read(T& t,Args&... args){read(t); read(args...);}\n\tchar __sr[1<<21],__z[20];int __C=-1,__zz=0;\n\tinline void Ot(){fwrite(__sr,1,__C+1,stdout),__C=-1;}\n\tinline void print(register int x)\n\t{\n\t\tif(__C>1<<20)Ot();if(x<0)__sr[++__C]='-',x=-x;\n\t\twhile(__z[++__zz]=x%10+48,x/=10);\n\t\twhile(__sr[++__C]=__z[__zz],--__zz);__sr[++__C]='\\n';\n\t}\n\tvoid file()\n\t{\n\t\t#ifdef NTFOrz\n\t\tfreopen(\"a.in\",\"r\",stdin);\n\t\t#endif\n\t}\n\tinline void chktime()\n\t{\n\t\t#ifdef NTFOrz\n\t\tcout<<(clock()-t)/1000.0<<'\\n';\n\t\t#endif\n\t}\n\t#ifdef mod\n\tll ksm(ll x,int y){ll ret=1;for (;y;y>>=1,x=x*x%mod) if (y&1) ret=ret*x%mod;return ret;}\n\tll inv(ll x){return ksm(x,mod-2);}\n\t#else\n\tll ksm(ll x,int y){ll ret=1;for (;y;y>>=1,x=x*x) if (y&1) ret=ret*x;return ret;}\n\t#endif\n//\tinline ll mul(ll a,ll b){ll d=(ll)(a*(double)b/mod+0.5);ll ret=a*b-d*mod;if (ret<0) ret+=mod;return ret;}\n}\nusing namespace my_std;\n\nint n;\nchar a[sz];\nint p1[sz],p2[sz],c1,c2;\n\nstring s[sz],dp[sz];\nint link[sz],to[sz];\n\nint book[sz],T;\n\nint main()\n{\n\tfile();\n\tread(n);n*=2;\n\tcin>>(a+1);\n\trep(i,1,n) if (a[i]=='a') p1[++c1]=i; else p2[++c2]=i;\n\trep(i,1,n>>1) link[min(p1[i],p2[i])]=max(p1[i],p2[i]);\n\trep(i,1,n) if (link[i])\n\t{\n\t\tif (a[i]=='a') { s[i]=\"ab\",to[i]=link[i]; continue; }\n\t\t++T;book[i]=book[link[i]]=T;int R=link[i];\n\t\trep(j,i,R) if (link[j]) book[j]=book[R=link[j]]=T;\n\t\trep(j,i,R) if (book[j]==T) s[i]+=a[j];\n\t\tto[i]=R;\n\t}\n\tdrep(i,n,1)\n\t{\n\t\tdp[i]=dp[i+1];\n\t\tif (link[i]) chkmax(dp[i],s[i]+dp[to[i]+1]);\n\t}\n\tcout<<dp[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 3000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res = \"ab\";\n    int pa = l + 1, pb = b[l];\n\n    while(a[r] > pb) {\n        while(a[pa] < pb) ++ pa;\n        res += \"ab\";\n        pb = b[pa];\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i; else b[++ b[0]] = i;\n    }\n\n    string tmp;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        while(!stk.empty() && tmp > stk.back()) {\n            stk.pop_back();\n        }\n        stk.push_back(tmp);\n    }\n    for(auto s : stk) std::cout << s;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#include <cstring>\n#include <queue>\n#include <set>\n#include <map>\n#include <functional>\n#include <string>\n#include <cmath>\n#define SIZE 6005\n\nusing namespace std;\ntypedef long long int ll;\ntypedef pair <int,int> P;\n\nstring dp[SIZE];\nchar str[SIZE];\nint pa[SIZE],pb[SIZE];\nint pos[SIZE];\nbool use[SIZE];\n\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&str);\n\tint sa=0,sb=0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(str[i]=='a')\n\t\t{\n\t\t\tpa[sa++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[sb++]=i;\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tpos[pa[i]]=pb[i];\n\t\tpos[pb[i]]=pa[i];\n\t}\n\tdp[2*n]=\"\";\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\tdp[i]=dp[i+1];\n\t\tif(i<pos[i])\n\t\t{\n\t\t\tif(str[i]=='a')\n\t\t\t{\n\t\t\t\tstring to=\"ab\";\n\t\t\t\tto+=dp[pos[i]+1];\n\t\t\t\tdp[i]=max(dp[i],to);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tint cnt=0;\n\t\t\t\tstring now=\"\";\n\t\t\t\tfor(int j=i;j<2*n;j++)\n\t\t\t\t{\n\t\t\t\t\tif(pos[j]<i) continue;\n\t\t\t\t\tif(str[j]=='a')\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]<j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"a\";\n\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]>j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(cnt==0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnow+=dp[j+1];\n\t\t\t\t\t\tdp[i]=max(dp[i],now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%s\\n\",dp[0].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <iostream>\n#include <numeric>\n#include <set>\n#include <tuple>\n#include <vector>\nusing namespace std;\n\nvector<int> build_edges(const string &s) {\n  const int n = s.size();\n  vector<int> edges(n);\n  for (int i = 0, j = 0; ; ++i, ++j ) {\n    while (i < n && s[i] != 'a') ++i;\n    while (j < n && s[j] != 'b') ++j;\n    if (i < n) {\n      assert(j < n);\n      edges[i] = j;\n      edges[j] = i;\n    } else {\n      assert(j == n);\n      break;\n    }\n  }\n  return edges;\n}\n\nstring solve_a(const string &s) {\n  string res = \"\";\n  const vector<int> edges = build_edges(s);\n  for (int i = 0; i < s.size(); ++i) {\n    if (s[i] == 'a') {\n      res += \"ab\";\n      assert(edges[i] > i);\n      i = edges[i];\n    }\n  }\n  return res;\n}\n\nstring solve_b(const string &s) {\n  string res = \"\";\n  for (int i = 0, skipped_b = 0; i < s.size(); ++i) {\n    if (s[i] == 'b') {\n      // try pick this one first\n      string current;\n      for (int j = i, rest_a = skipped_b; j < s.size(); ++j) {\n        if (rest_a <= 0 || s[j] == 'b') current += s[j];\n        if (s[j] == 'a') --rest_a;\n      }\n      res = max(res, current);\n      ++skipped_b;\n    }\n  }\n  return res;\n}\n\nint main() {\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> l, r;\n  for (int i = 0, t = 0; i < 2 * n; ++i) {\n    if (t == 0) l.push_back(i);\n    t += s[i] == 'a' ? +1 : -1;\n    if (t == 0) r.push_back(i + 1);\n  }\n  assert(l.size() == r.size());\n  assert(l.front() == 0);\n  assert(r.back() == 2 * n);\n  const int t = l.size();\n\n  reverse(l.begin(), l.end());\n  reverse(r.begin(), r.end());\n  string res = \"\";\n  for (int i = 0; i < t; ++i) {\n    string chunk = s.substr(l[i], r[i] - l[i]);\n    string current = (s[l[i]] == 'a') ? solve_a(chunk) : solve_b(chunk);\n    res = max(res, current + res);\n  }\n  cout << res << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=6e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    scanf(\" %s\",s+1);\n//    LL N(2*n);\n//    for(LL i=1;i<=2000;++i) a[i]=(s[i]-'a')^1;\n//    return 0;\n    \n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n//    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nint n, u[6009], depth[6009], num[6009]; string S; pair<string, int> dp[6009]; bool used[6009];\nvector<int>A, B;\n\nint main() {\n\tcin >> n >> S;\n\tfor (int i = 0; i < 2 * n; i++) {\n\t\tif (S[i] == 'b') { depth[i + 1] = depth[i] + 1; num[i] = B.size(); B.push_back(i); }\n\t\telse { depth[i + 1] = depth[i] - 1; num[i] = A.size(); A.push_back(i); }\n\t\tif (depth[i + 1] == 0) used[i] = true;\n\t}\n\tfor (int i = 2 * n - 1; i >= 0; i--) { if (used[i] == true) u[i] = i; else u[i] = u[i + 1]; }\n\n\tfor (int i = 2 * n - 1; i >= 0; i--) {\n\t\tdp[i] = dp[i + 1];\n\t\tif (depth[i + 1] > 0 && S[i] == 'b') {\n\t\t\tstring V = \"\";\n\t\t\tfor (int j = i; j < A[num[i]]; j++) { if (S[j] == 'b') V += S[j]; }\n\t\t\tfor (int j = A[num[i]]; j <= u[i]; j++) V += S[j];\n\t\t\tdp[i] = max(dp[i], make_pair(V, -i));\n\t\t}\n\t}\n\tstring ans = \"\"; int cx = 0;\n\twhile (dp[cx].first != \"\") {\n\t\tans += dp[cx].first;\n\t\tcx = u[dp[cx].second * -1] + 1;\n\t}\n\tfor (int i = 0; i < A.size(); i++) {\n\t\tif (A[i] >= cx) { cx = B[i] + 1; ans += \"ab\"; }\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tstring pre = \"\";\n\tfor(int i=1;i<vec.size();i++){\n\t\tstring S = vec[i];\n\t\tfor(int j=0;j<i;j++) dp[vec[i]] = max(dp[vec[i]],dp[vec[j]]+S);\n\t\tint nxt = b[pos[vec[i]]]+1;\n\t\tstring cur = dp[i];\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tif(a[p]>b[p]) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t\n\t}\n\tcout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cassert>\n#include <cstring>\n#include <vector>\n#include <algorithm>\n\nint N;\nchar str[6005];\n\nchar curr[6005];\nint ind[6005];\nint where[2][6005];\nint curr_len=0;\n\nchar add[6005];\nstd::vector<int> add_len;\n\nchar ans[6005];\nstd::vector<int> ans_len(1,0);\n\nvoid show(const char* s,const std::vector<int>& s_len){\n  return;\n  assert(std::is_sorted(s_len.begin(),s_len.end()));\n  //assert(std::unique(s_len.begin(),s_len.end())==s_len.end());\n  int s_len_i=0;\n  assert(!s_len.empty());\n  for(int i=0;;i++){\n    while(i==s_len[s_len_i]){\n      printf(\"|\");\n      if(++s_len_i==s_len.size()){\n\tprintf(\"\\n\");\n\t/*\n\tprintf(\"[ \");\n\tfor(int l:s_len){\n\t  printf(\"%d \",l);\n\t}\n\tprintf(\"]\\n\");\n\t*/\n\treturn;\n      }\n    }\n    printf(\"%c\",s[i]);\n  }\n}\n\nvoid add_to(char* dest,std::vector<int>& dest_len,const char* src,std::vector<int> src_len){\n  //printf(\"ADD TO:\");\n  show(dest,dest_len);\n  //printf(\"  \");\n  show(src,src_len);\n  int i=0;\n  while((i<src_len.back())&&(i<dest_len.back())&&(src[i]==dest[i])) i++;\n  if(i==dest_len.back()||(i!=src_len.back()&&src[i]>dest[i])){\n    //printf(\"11111111\\n\");\n    strcpy(dest,src);\n    while(dest_len.back()>i){\n      dest_len.pop_back();\n    }\n  }else{\n    //printf(\"22222222\\n\");\n    while(src_len.back()>i){\n      src_len.pop_back();\n    }\n  }\n  //printf(\"I=%d\\n\",i);\n  std::vector<int> tmp;\n  std::merge(src_len.begin(),src_len.end(),\n\t     dest_len.begin(),dest_len.end(),\n\t     std::back_inserter(tmp));\n  dest_len=tmp;\n  dest_len.erase(std::unique(dest_len.begin(),dest_len.end()),dest_len.end());\n  \n  //printf(\" => \");\n  show(dest,dest_len);\n}\n\n\nvoid append(){\n  //printf(\"APPEND\\n\");\n  char base[6005];\n  strcpy(base,ans);\n  std::vector<int> base_len=ans_len;\n  char adding[6005];\n  for(int len:base_len){\n    std::vector<int> adding_len;\n    for(int l:add_len){\n      adding_len.push_back(l+len);\n    }\n    strcpy(adding,base);\n    strcpy(adding+len,add);\n    //printf(\"ADDING TO ANS:\");\n    show(adding,adding_len);\n    add_to(ans,ans_len,adding,adding_len);\n  }\n  //printf(\"ANS SO FAR:\");\n  show(ans,ans_len);\n}\n/*\nvoid add_to_add(char* sub,int sub_len){\n  for(int i=0;;i++){\n    if(i==sub_len){\n      auto it=std::lower_bound(add_len.begin(),add_len.end(),sub_len);\n      if(it==add_len.end()||*it!=sub_len){\n\tadd_len.insert(it,sub_len);\n      }\n      return;\n    }\n    if(i==add_len.back()){\n      strcpy(add,sub);\n      add_len.push_back(sub_len);\n      return;\n    }\n    if(add[i]>sub[i]){\n      return;\n    }\n    if(add[i]<sub[i]){\n      while(add_len.size()&&add_len.back()>=i){\n\tadd_len.pop_back();\n      }\n      strcpy(add,sub);\n      add_len.push_back(sub_len);\n      return;\n    }\n  }\n}\n*/\n\nchar sub[6005];\n\nvoid flush(){\n  int nth[2]={0,0};\n  for(int i=0;i<curr_len;i++){\n    ind[i]=nth[curr[i]-'a']++;\n    where[curr[i]-'a'][ind[i]]=i;\n  }\n  add_len.clear();\n  add_len.push_back(0);\n  if(curr[0]=='a'){\n    for(int i=0;i<curr_len;i=where[1][ind[i]]+1){\n      while(curr[i]!='a'&&i<curr_len) i++;\n      if(i==curr_len) break;\n      add[add_len.back()]='a';\n      add[add_len.back()+1]='b';\n      add_len.push_back(add_len.back()+2);\n    }\n  }else{\n    for(int i=0;i<curr_len/2;i++){\n      int sub_len=0;\n      for(int j=where[1][i];j<curr_len;j++){\n\tif(ind[j]>=i){\n\t  sub[sub_len++]=curr[j];\n\t}\n      }\n      //printf(\"CONSIDERING: %.*s\\n\",sub_len,sub);\n      std::vector<int> sub_len_v(1,sub_len);\n      add_to(add,add_len,sub,sub_len_v);\n    }\n  }\n  //printf(\"APPENDING:\\n\");\n  show(add,add_len);\n  append();\n  curr_len=0;\n}\n\nint main(){\n  scanf(\"%d %s\",&N,str);\n  int diff=0;\n  for(int i=0;str[i];i++){\n    curr[curr_len++]=str[i];\n    diff+=(str[i]=='a')-(str[i]=='b');\n    if(diff==0) flush();\n  }\n  printf(\"%.*s\\n\",ans_len.back(),ans);\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n;\nstring s;\n\ninline string get(int l, int r) {\n  string ret = \"\";\n  if (s[l] == 'a') {\n    for (int i = l, j = 0, k = 0, m = 0; i <= r; i++) {\n      if (s[i] == 'a') {\n        ++j;\n        if (k <= m) {\n          ret += \"ab\";\n          k = j;\n        }\n      } else {\n        ++m;\n      }\n    }\n  } else {\n    for (int t = 1; t <= r - l + 1 >> 1; t++) {\n      string cur = \"\";\n      for (int i = l, j = 0, k = 0; i <= r; i++) {\n        if (++(s[i] == 'a' ? j : k) >= t) {\n          cur += s[i];\n        }\n      }\n      ret = max(ret, cur);\n    }\n  }\n  return ret;\n}\n\nint main() {\n  cin >> n >> s;\n  vector<string> t, f;\n  for (int i = 0, sum = 0, last = 0; i < n << 1; i++) {\n    sum += s[i] == 'a' ? 1 : -1;\n    if (sum == 0) {\n      t.push_back(get(last, i));\n      last = i + 1;\n    }\n  }\n  f.resize(t.size());\n  for (int i = (int) t.size() - 1; ~i; i--) {\n    f[i] = i == (int) t.size() - 1 ? t[i] : max(f[i + 1], t[i] + f[i + 1]);\n  }\n  cout << f[0] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tstring to = \"\";\n\t\tif(s[i] == 'a') {\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tint lsta = 0;\n\t\t\tfor(int k = i;k < j;k++) {\n\t\t\t\tcntb += s[k] == 'b';\n\t\t\t\tif(s[k] == 'a') {\n\t\t\t\t\tcnta += s[k] == 'a';\n\t\t\t\t\tif(to.empty() || to.back() == 'b') to += 'a', lsta = cnta;\n\t\t\t\t} else {\n\t\t\t\t\tcntb += s[k] == 'a';\n\t\t\t\t\tif(cntb == lsta) to += 'b';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tto = s.substr(i,j-i);\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt) {\n\t\t\t\t\t\tcurcnt--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcur += s[z];\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(res <= in[i] + res) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstring>\n#include <cstdio>\n#include <string>\n#include <vector>\nusing namespace std;\n\nconst int Maxn = 6005;\nint n, sza, szb;\nchar str[Maxn];\nint a[Maxn], b[Maxn], pos[Maxn];\nstring dp[Maxn];\n\ninline string Max(string a, string b) {\n\tif (a == \"\") return b;\n\telse if (b == \"\") return a;\n\tfor (int i = 0; i < (int)min(a.size(), b.size()); ++ i)\n\t\tif (a[i] != b[i]) return a[i] > b[i] ? a : b;\n\treturn a.size() > b.size() ? a : b;\n}\n\nint main() {\n\tscanf(\"%d\\n%s\", &n, str + 1);\n\tfor (int i = 1; i <= (n << 1); ++ i)\n\t\tif (str[i] == 'a') a[++ sza] = i, pos[i] = sza;\n\t\telse b[++ szb] = i, pos[i] = szb;\n\tfor (int i = n; i; -- i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint k = i;\n\t\t\tfor (int j = b[i] - 1; j > a[i]; -- j)\n\t\t\t\tif (str[j] == 'a') {\n\t\t\t\t\tk = pos[j];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tdp[i] = \"ab\"s + dp[k + 1];\n\t\t}\n\t\telse {\n\t\t\tint k = i;\n\t\t\twhile (k < n && b[k + 1] < a[k]) ++ k;\n\t\t\tfor (int j = b[i]; j <= (n << 1); ++ j)\n\t\t\t\tif (i <= pos[j] && pos[j] <= k) dp[i] += str[j];\n\t\t\tdp[i] += dp[k + 1];\n\t\t}\n\t\tdp[i] = Max(dp[i], dp[i + 1]);\n\t}\n\tstring ans = \"\";\n\tfor (int i = 1; i <= n; ++ i)\n\t\tans = Max(ans, dp[i]);\n\tprintf(\"%s\\n\", ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring str,f[3005];\nint pos[3005];\nbool kind[3005];\n\nint bel[6005];\n\nint main() {\n  int n;\n  cin>>n>>str;\n  int cnt=0,s=0;\n  for(int i=0;i<2*n;i++) {\n  \ts+=((str[i]=='b')?1:-1);\n  \tif (!s) {\n  \t\tpos[++cnt]=i;\n  \t\tkind[cnt]=((str[i]=='a')?0:1);\n\t  }\n  }\n  pos[0]=-1;\n  bool v=1;\n  for(int i=cnt;i>0;i--)\n    if (!kind[i]) {\n    \tv=0;\n    \tint s1=0,s2=0;\n    \tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n    \t  if (str[j]=='b') bel[j]=++s1; else bel[j]=++s2;\n    \tf[i]=f[i+1];\n    \tfor(int j=1;j<=s1;j++) {\n          string cur;\n    \t  for(int k=pos[i-1]+1;k<=pos[i];k++)\n    \t    if (bel[k]>=j) cur+=str[k];\n    \t  f[i]=max(f[i],cur+f[i+1]);\n    \t}\n\t}\n\telse if (v) {\n\t\tbool t=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n\t\t  if (t^(str[j]=='a')) {\n\t\t  \tf[i]+=str[j];\n\t\t  \tt^=1;\n\t\t  }\n\t\tf[i]+=f[i+1];\n\t}\n\telse f[i]=f[i+1];\n  cout<<f[1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define debug(x) cout << #x << \" = \" << x << endl\n#define fori(i, ini, lim) for(int i = int(ini); i < int(lim); i++)\n#define ford(i, ini, lim) for(int i = int(ini); i >= int(lim); i--)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> ii;\n\nconst int MAX = 3000 + 5;\nstring s;\nint n;\n\nstring optimal(int left, int right) {\n    string opt = \"\";\n    if(s[left] == 'a') {\n        int sum = 0;\n        fori(i, left, right + 1) {\n            if(sum == 0 && s[i] == 'a') {\n                sum = 1;\n            }\n            else if(sum == 1 && s[i] == 'b') {\n                sum = 0;\n                opt += \"ab\";\n            }\n        }\n    }\n    else {\n        vector<int> a, b;\n        fori(i, left, right + 1) {\n            if(s[i] == 'a') {\n               a.push_back(i);\n           }\n           else {\n               b.push_back(i);\n           }\n        }\n        ford(i, a.size() - 1, 0) {\n            string cur = \"\"; \n            int a_ptr = i, b_ptr = i;\n            while(a_ptr < (int) a.size() || b_ptr < (int) b.size()) {\n                if(a_ptr == (int) a.size()) {\n                    cur += \"b\";\n                    b_ptr++;\n                }\n                else if(b_ptr == (int) b.size()) {\n                    cur += \"a\";\n                    a_ptr++;\n                }\n                else if(a[a_ptr] < b[b_ptr]) {\n                    cur += \"a\";\n                    a_ptr++;\n                }\n                else {\n                    cur += \"b\";\n                    b_ptr++;\n                }\n            }\n            opt = max(opt, cur);\n        }\n    }\n    return opt;\n}\n\nint main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(0);\n    cin >> n;\n    cin >> s;\n    vector<string> optimals;\n    int sum = 0, start = 0;\n    fori(i, 0, 2 * n) {\n        sum += s[i] == 'a';\n        sum -= s[i] == 'b';\n        if(sum == 0) {\n            optimals.push_back(optimal(start, i));\n            start = i + 1;\n        }\n    }\n    string best = \"\";\n    ford(i, (int) optimals.size() - 1, 0) {\n        best = max(best, optimals[i] + best); \n    }\n    cout << best << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int N=6005;\nint n,q[N],hd=1,tl,mat[N],vis[N];string str,f[N];\nint main(){\n\tcin>>n>>str;n<<=1;\n\tfor(int i=0;i<n;++i)\n\t\tif(hd<=tl&&str[q[hd]]!=str[i])\n\t\t\tmat[i]=q[hd],mat[q[hd]]=i,++hd;\n\t\telse\n\t\t\tq[++tl]=i;\n\tf[n]=\"\";\n\tfor(int i=n-1;~i;--i){\n\t\tif(mat[i]>i)\n\t\t\tif(str[i]=='a')\n\t\t\t\tf[i]=\"ab\"+f[mat[i]+1];\n\t\t\telse{\n\t\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\t\tint k=i;\n\t\t\t\tfor(int j=i;j<=k;++j){\n\t\t\t\t\tif(str[j]=='b')\n\t\t\t\t\t\tvis[j]=vis[mat[j]]=1,k=mat[j];\n\t\t\t\t\tif(vis[j])\n\t\t\t\t\t\tf[i]+=str[j];\n\t\t\t\t}\n\t\t\t\tf[i]+=f[k+1];\n\t\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t}\n\tcout<<f[0]<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n#include <string>\nusing namespace std;\n\n#define FILL(a, n, x) memset((a), (x), sizeof ((a)[0]) * (n))\n#define FILLA(a, x) memset((a), (x), sizeof (a))\n#define COPY(a, n, b) memcpy((b), (a), sizeof ((a)[0]) * (n))\n#define COPYA(a, b) memcpy((b), (a), sizeof (a))\n\ntypedef unsigned long long lu;\ntypedef long long li;\ntypedef pair<int, int> pii;\nconst int mod = 1e9 + 7;\n\ninline int Add(int x) { return x >= mod ? x - mod : x; }\ninline void Add(int &x, int y) { x += y; if (x >= mod) x -= mod; }\ninline int Sub(int x) { return x < 0 ? x + mod : x; }\ninline void Sub(int &x, int y) { x = Sub(x - y); }\ninline int Mul(int x, int y) { return (int)((lu)x * y % mod); }\ninline int Mul(int x, int y, int z) { return (int)((lu)x * y % mod * z % mod); }\n\nint Pow(int x, int y) {\n  int z = 1;\n  for (; y; y >>= 1) {\n    if (y & 1) z = Mul(z, x);\n    x = Mul(x, x);\n  }\n  return z;\n}\n\nint Inv(int x) { return Pow(x, mod - 2); }\ntemplate <class T> inline void Max(T &x, T y) { if (y > x) x = y; }\ntemplate <class T> inline void Min(T &x, T y) { if (y < x) x = y; }\n\n// ----------------------------------------\n\nconst int maxn = 6000;\n\nint n;\nchar s[maxn + 1];\nint m;\nstring part[maxn];\n\nstring Solve(string s) {\n  static int A[maxn], B[maxn];\n  int len = s.length();\n  int n = len / 2;\n  int ca = 0, cb = 0;\n  for (int i = 0; i < len; ++i) {\n    if (s[i] == 'a') {\n      A[ca++] = i;\n    } else {\n      B[cb++] = i;\n    }\n  }\n\n  if (s[0] == 'a') {\n    string ans = \"\";\n    int last = -1;\n    for (int i = 0; i < n; ++i) {\n      if (A[i] > last) {\n        ans += \"ab\";\n        last = B[i];\n      }\n    }\n    return ans;\n  } else {\n    string ans = \"\";\n    static bool sel[maxn];\n    for (int i = 0; i < n; ++i) {\n      FILL(sel, len, 0);\n      for (int j = i; j < n; ++j) {\n        sel[A[j]] = sel[B[j]] = true;\n      }\n      string now = \"\";\n      for (int j = 0; j < len; ++j) {\n        if (sel[j]) now += s[j];\n      }\n      Max(ans, now);\n    }\n    return ans;\n  }\n}\n\nint main(void) {\n  scanf(\"%d\", &n);\n  scanf(\"%s\", s);\n  m = 0;\n  int ca = 0, cb = 0, begin = 0;\n  for (int i = 0; i < 2 * n; ++i) {\n    ca += s[i] == 'a';\n    cb += s[i] == 'b';\n    if (ca == cb) {\n      part[m++] = string(s + begin, s + i + 1);\n      begin = i + 1;\n    }\n  }\n  for (int i = 0; i < m; ++i) {\n    part[i] = Solve(part[i]);\n  }\n  string ans = \"\";\n  for (int i = m - 1; i >= 0; --i) {\n    ans = max(ans, part[i] + ans);\n  }\n  cout << ans << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// #pragma GCC optimize(2)\n// #pragma G++ optimize(2)\n// #pragma comment(linker,\"/STACK:102400000,102400000\")\n\n//#include <bits/stdc++.h>\n#include <map>\n#include <set>\n#include <list>\n#include <array>\n#include <cfenv>\n#include <cmath>\n#include <ctime>\n#include <deque>\n#include <mutex>\n#include <queue>\n#include <ratio>\n#include <regex>\n#include <stack>\n#include <tuple>\n#include <atomic>\n#include <bitset>\n#include <cctype>\n#include <cerrno>\n#include <cfloat>\n#include <chrono>\n#include <cstdio>\n#include <cwchar>\n#include <future>\n#include <limits>\n#include <locale>\n#include <memory>\n#include <random>\n#include <string>\n#include <thread>\n#include <vector>\n#include <cassert>\n#include <climits>\n#include <clocale>\n#include <complex>\n#include <csetjmp>\n#include <csignal>\n#include <cstdarg>\n#include <cstddef>\n#include <cstdint>\n#include <cstdlib>\n#include <cstring>\n#include <ctgmath>\n#include <cwctype>\n#include <fstream>\n#include <iomanip>\n#include <numeric>\n#include <sstream>\n#include <ccomplex>\n#include <cstdbool>\n#include <iostream>\n#include <typeinfo>\n#include <valarray>\n#include <algorithm>\n#include <cinttypes>\n#include <cstdalign>\n#include <stdexcept>\n#include <typeindex>\n#include <functional>\n#include <forward_list>\n#include <system_error>\n#include <unordered_map>\n#include <unordered_set>\n#include <scoped_allocator>\n#include <condition_variable>\n//#include <conio.h>\n//#include <windows.h>\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned int ui;\ntypedef unsigned long long ull;\ntypedef float fl;\ntypedef double ld;\ntypedef long double LD;\ntypedef pair<int,int> pii;\n#if (WIN32) || (WIN64) || (__WIN32) || (__WIN64) || (_WIN32) || (_WIN64) || (WINDOWS)\n#define lld \"%I64d\"\n#define llu \"%I64u\"\n#else\n#define lld \"%lld\"\n#define llu \"%llu\"\n#endif\n#define ui(n) ((unsigned int)(n))\n#define LL(n) ((long long)(n))\n#define ull(n) ((unsigned long long)(n))\n#define fl(n) ((float)(n))\n#define ld(n) ((double)(n))\n#define LD(n) ((long double)(n))\n#define char(n) ((char)(n))\n#define Bool(n) ((bool)(n))\n#define fixpoint(n) fixed<<setprecision(n)\n\nconst int INF=1061109567;\nconst LL LINF=4557430888798830399;\nconst ld eps=1e-15;\n#define MOD (1000000007)\n#define PI (3.1415926535897932384626433832795028841971)\n\n/*\n#define MB_LEN_MAX 5\n#define SHRT_MIN (-32768)\n#define SHRT_MAX 32767\n#define USHRT_MAX 0xffffU\n#define INT_MIN (-2147483647 - 1)\n#define INT_MAX 2147483647\n#define UINT_MAX 0xffffffffU\n#define LONG_MIN (-2147483647L - 1)\n#define LONG_MAX 2147483647L\n#define ULONG_MAX 0xffffffffUL\n#define LLONG_MAX 9223372036854775807ll\n#define LLONG_MIN (-9223372036854775807ll - 1)\n#define ULLONG_MAX 0xffffffffffffffffull\n*/\n\n#define MP make_pair\n#define MT make_tuple\n#define All(a) (a).begin(),(a).end()\n#define pall(a) (a).rbegin(),(a).rend()\n#define log2(x) log(x)/log(2)\n#define Log(x,y) log(x)/log(y)\n#define sz(a) ((int)(a).size())\n#define rep(i,n) for(int i=0;i<((int)(n));i++)\n#define rep1(i,n) for(int i=1;i<=((int)(n));i++)\n#define repa(i,a,n) for(int i=((int)(a));i<((int)(n));i++)\n#define repa1(i,a,n) for(int i=((int)(a));i<=((int)(n));i++)\n#define repd(i,n) for(int i=((int)(n))-1;i>=0;i--)\n#define repd1(i,n) for(int i=((int)(n));i>=1;i--)\n#define repda(i,n,a) for(int i=((int)(n));i>((int)(a));i--)\n#define repda1(i,n,a) for(int i=((int)(n));i>=((int)(a));i--)\n#define FOR(i,a,n,step) for(int i=((int)(a));i<((int)(n));i+=((int)(step)))\n#define repv(itr,v) for(__typeof((v).begin()) itr=(v).begin();itr!=(v).end();itr++)\n#define repV(i,v) for(auto i:v)\n#define repE(i,v) for(auto &i:v)\n#define MS(x,y) memset(x,y,sizeof(x))\n#define MC(x) MS(x,0)\n#define MINF(x) MS(x,63)\n#define MCP(x,y) memcpy(x,y,sizeof(y))\n#define sqr(x) ((x)*(x))\n#define UN(v) sort(All(v)),v.erase(unique(All(v)),v.end())\n#define filein(x) freopen(x,\"r\",stdin)\n#define fileout(x) freopen(x,\"w\",stdout)\n#define fileio(x)\\\n\tfreopen(x\".in\",\"r\",stdin);\\\n\tfreopen(x\".out\",\"w\",stdout)\n#define filein2(filename,name) ifstream name(filename,ios::in)\n#define fileout2(filename,name) ofstream name(filename,ios::out)\n#define file(filename,name) fstream name(filename,ios::in|ios::out)\n#define Pause system(\"pause\")\n#define Cls system(\"cls\")\n#define fs first\n#define sc second\n#define PC(x) putchar(x)\n#define GC(x) x=getchar()\n#define Endl PC('\\n')\n#define SF scanf\n#define PF printf\n\ninline int Read()\n{\n    int X=0,w=0;char ch=0;while(!isdigit(ch)){w|=ch=='-';ch=getchar();}while(isdigit(ch))X=(X<<3)+(X<<1)+(ch^48),ch=getchar();\n\treturn w?-X:X;\n}\ninline void Write(int x){if(x<0)putchar('-'),x=-x;if(x>9)Write(x/10);putchar(x%10+'0');}\n\ninline LL powmod(LL a,LL b){LL RES=1;a%=MOD;assert(b>=0);for(;b;b>>=1){if(b&1)RES=RES*a%MOD;a=a*a%MOD;}return RES%MOD;}\ninline LL gcdll(LL a,LL b){return b?gcdll(b,a%b):a;}\nconst int dx[]={0,1,0,-1,1,-1,-1,1};\nconst int dy[]={1,0,-1,0,-1,-1,1,1};\n/************************************************************Begin************************************************************/\nconst int maxn=6010;\n\nint n,pos[maxn];\nstring s,dp[maxn];\nvector<int> a,b;\n\nint main()\n{\n\tcin>>n>>s;s=\" \"+s;\n\n\ta.push_back(0);b.push_back(0);\n\trep1(i,n*2) if(s[i]=='a') a.push_back(i),pos[i]=a.size()-1; else b.push_back(i),pos[i]=b.size()-1;\n\n\trepd1(i,n)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tint mx=0;\n\t\t\trepa1(j,a[i],b[i]) mx=max(mx,pos[j]);\n\t\t\tdp[i]=\"ab\"+dp[mx+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile(k<=n&&b[k+1]<a[k]) k++;\n\t\t\trep1(j,n*2) if(pos[j]>=i&&pos[j]<=k) dp[i]+=s[j];\n\t\t\tdp[i]+=dp[k+1];\n\t\t}\n\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\n\t// rep1(i,n) cout<<dp[i]<<endl;\n\t\n\tcout<<dp[1];\n\n\treturn 0;\n}\n/*************************************************************End**************************************************************/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/detail/standard_policies.hpp>\nusing ll = int64_t;\nusing ld = double;\nusing ull = uint64_t;\nusing namespace std;\nusing namespace __gnu_pbds;     \n\nconst int MAXN = 6228;\nint l[MAXN];\nint r[MAXN];\nint la[MAXN];\nint ra[MAXN];\nstring f[MAXN];\nint n;\n\nvoid pt(int x) {\n    int cur = 0;\n    while (r[cur] < x) {\n        ++cur;\n    }\n\n    while (cur < n) {\n        cout << \"ab\";\n        int cb = l[cur];\n        while (r[cur] < cb) {\n            ++cur;\n        }\n    }\n\n    cout << \"\\n\";\n    exit(0);\n}\n\nint main() {\n#ifdef BZ\n    freopen(\"input.txt\", \"r\", stdin); freopen(\"output.txt\", \"w\", stdout);\n#endif\n    ios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr); cout.setf(ios::fixed); cout.precision(20);\n\n    string s;\n    cin >> n >> s;\n    int lc = 0, rc = 0;\n\n    for (int i = 0; i < s.length(); ++i) {\n        if (s[i] == 'b') {\n            l[lc++] = i;\n        } else {\n            r[rc++] = i;\n        }\n    }\n\n    l[n] = r[n] = MAXN;\n\n    int ac = 0;\n\n    for (int i = 0; i < n; ++i) {\n        if (l[i] < r[i]) {\n            la[ac] = l[i];\n            ra[ac] = r[i];\n            ++ac;\n        }\n    }\n\n    la[ac] = ra[ac] = MAXN;\n\n    if (!ac) {\n        pt(0);\n    }\n\n\n    f[ac] = \"\";\n    for (int i = ac - 1; i >= 0; --i) {\n        int lp = i, rp = i;\n        string cur;\n        do {\n            if (la[lp] < ra[rp]) {\n                cur += 'b';\n                ++lp;\n            } else {\n                cur += 'a';\n                ++rp;\n            }\n        } while (lp != rp);\n\n        cur += f[lp];\n        f[i] = max(f[i + 1], cur);\n    }\n\n    cout << f[0];\n    pt(ra[ac - 1] + 1);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[6600];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[i], tmpbs[i]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        tmpas.push_back(as[i]);\n        tmpbs.push_back(bs[i]);\n        if(max(as[i], bs[i]) == i * 2 + 1){\n            string tmp = calc(tmpas, tmpbs);\n            int pos = 0;\n            while(pos < strs.size() && strs[pos] >= tmp)pos++;\n            if(pos == strs.size())strs.push_back(tmp);\n            else{\n                strs[pos] = tmp;\n                while(strs.size() > pos+1)strs.pop_back();\n            }\n            tmpas.clear();tmpbs.clear();\n        }\n    }\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> vs;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      vs.push_back(naive(string(s.begin() + i, s.begin() + last)));\n      i = r - 1;\n    }\n  }\n  vector<int> match(n * 2);\n  queue<int> q;\n  for (int i = last; i < n * 2; ++i)\n    if (s[i] == 'a')\n      q.push(i);\n    else {\n      match[q.front()] = i;\n      q.pop();\n    }\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'b') continue;\n    ans += \"ab\";\n    i = match[i];\n  }\n  reverse(vs.begin(), vs.end());\n  for (const auto& str : vs)\n    ans = max(ans, str + ans);\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(j,l,r){\n        if(S[j]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  vector<string> dp(s.size()+1);\n  RREP(i,s.size()){\n    FOR(j,i+1,s.size()+1){\n      chmax(dp[i],s[i]+dp[j]);\n    }\n  }\n\n  string ans;\n  REP(i,s.size()) chmax(ans,dp[i]); \n  cout << ans << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::cerr; \n\ntemplate <class T>\ninline void relax(T &x, const T &y) {\n\tif (x < y) x = y; \n}\n\nconst int MaxM = 6e3 + 5; \nconst int MaxN = 3e3 + 5; \n\nint n; \nchar s[MaxM]; \nstd::string f[MaxN]; \n\nint idx[MaxM]; \nint a[MaxN], b[MaxN]; \n\nint main() {\n#ifdef orzczk\n\tfreopen(\"subsequnce.in\", \"r\", stdin); \n#endif\n\n\tscanf(\"%d%s\", &n, s + 1); \n\tfor (int i = 1, cA = 0, cB = 0; i <= (n << 1); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[idx[i] = ++cA] = i; \n\t\t} else {\n\t\t\tb[idx[i] = ++cB] = i; \n\t\t}\n\t}\n\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint nxt = i + 1; \n\t\t\tfor (int j = b[i] - 1; j > a[i]; --j)\n\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\tnxt = idx[j] + 1; \n\t\t\t\t\tbreak; \n\t\t\t\t}\n\t\t\t\n\t\t\tf[i] = \"ab\" + f[nxt]; \n\t\t} else {\n\t\t\tint border = a[i], maxIdx = i; \n\t\t\tfor (int j = b[i] + 1; j <= border; ++j)\n\t\t\t\tif (s[i] == 'b') {\n\t\t\t\t\trelax(border, a[idx[j]]); \n\t\t\t\t}\n\t\t\t\n\t\t\tfor (int j = b[i]; j <= border; ++j)\n\t\t\t\tif (idx[j] >= i) {\n\t\t\t\t\tf[i] += s[j]; \n\t\t\t\t\trelax(maxIdx, idx[j]); \n\t\t\t\t}\n\t\t\t\n\t\t\tf[i] += f[maxIdx + 1]; \n\t\t}\n\n\t\t// cerr << i << ' ' << f[i] << '\\n'; \n\t\trelax(f[i], f[i + 1]); \n\t}\n\n\tstd::cout << f[1] << '\\n'; \n\n\treturn 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 6000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res;\n    int p = -1;\n    for(int i = l; i <= r; ++i) if(a[i] > p) {\n        p = b[i];\n        res += \"ab\";\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint s[N + 5];\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i, ++ s[i]; else b[++ b[0]] = i, -- s[i];\n        s[i + 1] = s[i];\n    }\n\n    string tmp, ans;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(s[b[j]] && j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(s[a[j]] && j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        while(!stk.empty() && tmp > stk.back()) {\n            stk.pop_back();\n        }\n        stk.push_back(tmp);\n    }\n\n    for(auto t : stk) ans += t;\n    std::cout << ans << std::endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\t\n\tint lenx=strlen(x+1),leny=strlen(y+1),ans=0; \n\tif (lenx>leny) swap(x,y),swap(lenx,leny),ans=1;\n\tif (leny%lenx==0)\n\t{\n\t\tbool flag=1;\n\t\tfor (int i=1;i<=leny;i++)\n\t\t\tif (x[(i-1)%lenx+1]!=y[i]) { flag=0; break; }\n\t\tif (flag) return 2;\n\t}\n\tint len=max(lenx,leny);\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return ans^1;\n\t\telse if (x[i]<y[i]) return ans;\n\treturn 2;\n}\n\nint compare(char *x,char *y,int len)\n{\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t],len)==1)\n\t\t\t{\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=NULL;\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n20\nba ab bbabaa bbbabbabbabbaaaaaa aabb aabababb\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#define M 6006\n#define N 3003\nchar a[M];int b[N],c[N],d[M],f[N][M],g[N],i,j,k,n,u;\nint main()\n{\n    scanf(\"%d%s\",&n,a+1);\n    for(i=1;i<=n<<1;i++)a[i]==97?b[++j]=i:c[++k]=i;\n    for(i=1;i<=n;i++)d[b[i]<c[i]?b[i]:c[i]]++;\n    for(i=1;i<=n<<1;i++)d[i]+=d[i-1];\n    for(i=n;i;i--)\n    {\n        if(b[i]<c[i])f[i][1]=b[i],f[i][2]=c[i],u=d[c[i]]+1,memcpy(f[i]+3,f[u]+1,g[u]<<2),g[i]=g[u]+2;\n        else\n        {\n            for(u=d[b[j=i]]+1;j<u;j++)f[i][++g[i]]=c[j];\n            for(j=i,k=1;j<u||k<=g[u];)\n            if(j<u&&(g[u]<k||b[j]<f[u][k]))f[i][++g[i]]=b[j++];\n            else f[i][++g[i]]=f[u][k++];\n        }\n        for(j=1;a[f[i][j]]==a[f[i+1][j]];j++);\n        if(a[f[i][j]]<a[f[i+1][j]])memcpy(f[i]+1,f[i+1]+1,g[i+1]<<2),g[i]=g[i+1],f[i][g[i]+1]=0;\n    }\n    for(i=1;i<=g[1];i++)printf(\"%c\",a[f[1][i]]);\n    return 0&puts(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define vi vector<int>\n#define pii pair<int,int>\n#define vp  vector<pii>\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define ls l,mid,rt<<1\n#define rs mid+1,r,rt<<1|1\n#define de(x) cout<< #x<<\" = \"<<x<<endl\n#define dd(x) cout<< #x<<\" = \"<<x<<\" \"\n#define sf scanf\n#define pf printf\n#define all(x) (x).begin(),(x).end()\n#define SZ(x) ((int)(x).size())\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\ntypedef long long ll;\ntypedef unsigned long long ull;\n//typedef __int128 INT128;\n//INT128 read(){\n//    INT128 x=0,f=1;\n//    char ch=getchar();\n//    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n//    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n//    return x*f;\n//}\n//void write(INT128 x){\n//    if(x<0){putchar('-');x=-x;}\n//    if(x<10){putchar(x+'0'); return;}\n//    write(x/10);putchar(x%10+'0');\n//}\ntypedef long double ld;\nconst int INF=0x3f3f3f3f;\nconst double eps=1e-8;\nconst double PI=acos(-1.0);\nconst int MAXN=1e5+5;\nconst int MAXM=2e6+5;\nconst int MOD=1e9+7;\nint sgn(double x){if(fabs(x)<eps)return 0;if(x<0)return -1;else return 1;}\nll pw(ll a,ll n,ll mod){ll ret=1;while(n){if(n&1)ret=ret*a%mod;a=a*a%mod;n>>=1;}return ret;}\nll gcd(ll a,ll b){return b==0?a:gcd(b,a%b);}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\nvoid inc(ll &a,ll b){a+=b;if(a>=MOD)a-=MOD;}\nvoid dec(ll &a,ll b){a-=b;if(a<0)a+=MOD;}\nint mul(int x, int y){ll z=1ll*x*y;return z-z/MOD*MOD;}\n//head\n\nint n,ta,tb,pos_a[MAXN],pos_b[MAXN],pos[MAXN];\nstring s,ans,dp[MAXN];\nint main(){\n    cin>>n>>s; ta=tb=0;\n    rep(i,0,2*n){\n        if(s[i]=='a')pos_a[++ta]=i,pos[i]=ta;\n        else pos_b[++tb]=i,pos[i]=tb;\n    }\n    per(i,1,n+1){\n        if(pos_a[i]<pos_b[i]){\n            int k=i;\n            rep(j,pos_a[i]+1,pos_b[i])k=max(k,pos[j]);\n            dp[i]=\"ab\"+dp[k+1];\n        }else{\n            int k=i;\n            while(k<n&&pos_b[k+1]<pos_a[k])k++;\n            rep(j,pos_b[i],2*n)if(pos[j]>=i&&pos[j]<=k)dp[i]+=s[j];\n            //de(k);\n            dp[i]+=dp[k+1];\n        }\n        //dd(i); de(dp[i]);\n        dp[i]=max(dp[i],dp[i+1]);\n        ans=max(ans,dp[i]);\n    }\n    cout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tif(to.empty() || to.back() != o[k]) to += o[k];\n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n// iostream is too mainstream\n#include <cstdio>\n// bitch please\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <stack>\n#include <list>\n#include <cmath>\n#include <iomanip>\n#include <time.h>\n#define dibs reserve\n#define OVER9000 1234567890\n#define ALL_THE(CAKE,LIE) for(auto LIE =CAKE.begin(); LIE != CAKE.end(); LIE++)\n#define tisic 47\n#define soclose 1e-8\n#define chocolate win\n// so much chocolate\n#define patkan 9\n#define ff first\n#define ss second\n#define abs(x) (((x) < 0)?-(x):(x))\n#define uint unsigned int\n#define dbl long double\n#define pi 3.14159265358979323846\nusing namespace std;\n// mylittledoge\n\nusing cat = long long;\n\n#ifdef DONLINE_JUDGE\n\t// palindromic tree is better than splay tree!\n\t#define lld I64d\n#endif\n\nint main() {\n\tcin.sync_with_stdio(0);\n\tcin.tie(0);\n\tcout << fixed << setprecision(10);\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tvector<int> id(2*N);\n\tint a = 0, id_cur = 0;\n\tfor(int i = 0; i < 2*N; i++) if(S[i] == 'b') {\n\t\twhile(S[a] == 'b') a++;\n\t\tid[i] = id[a] = id_cur;\n\t\tid_cur++;\n\t\ta++;\n\t}\n\tvector<int> p(2*N);\n\tfor(int i = 0; i < 2*N; i++) for(int j = 0; j < i; j++) if(id[j] == id[i]) {\n\t\tp[i] = j;\n\t\tp[j] = i;\n\t\tbreak;\n\t}\n\tvector<string> ans(2*N+1, \"\");\n\tfor(int i = 2*N-1; i >= 0; i--) {\n\t\tans[i] = ans[i+1];\n\t\tif(p[i] < i) continue;\n\t\tif(S[i] == 'a') {\n\t\t\tans[i] = max(ans[i], \"ab\" + ans[p[i]+1]);\n\t\t\tcontinue;\n\t\t}\n\t\tint cnt = 0, mina = 2*N;\n\t\tfor(int j = i; j < mina; j++) if(p[j] >= i)\n\t\t\tif(S[j] == 'b') {\n\t\t\t\tcnt++;\n\t\t\t\tmina = min(mina, p[j]);\n\t\t\t}\n\t\tstring s_cur = \"\";\n\t\tvector<int> used_id(N, 0);\n\t\tint maxa = 0;\n\t\tint curj = i;\n\t\tfor(int j = i; j < 2*N; j++) if(S[j] == 'b' && p[j] >= i) {\n\t\t\ts_cur += 'b';\n\t\t\tused_id[id[j]] = 1;\n\t\t\tcnt--;\n\t\t\tmaxa = p[j];\n\t\t\tcurj = j+1;\n\t\t\tif(cnt == 0) break;\n\t\t}\n\t\tfor(int j = i; j < curj; j++) if(S[j] == 'a' && used_id[id[j]])\n\t\t\ts_cur += S[j];\n\t\twhile(curj <= maxa) {\n\t\t\tif(p[curj] < i) {\n\t\t\t\tcurj++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(used_id[id[curj]]) { // 'a'\n\t\t\t\ts_cur += S[curj];\n\t\t\t\tcurj++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// 'b'\n\t\t\ts_cur += S[curj];\n\t\t\tused_id[id[curj]] = 1;\n\t\t\tmaxa = max(maxa, p[curj]);\n\t\t\tcurj++;\n\t\t}\n\t\tans[i] = max(ans[i], s_cur + ans[curj]);\n\t}\n\tcout << ans[0] << \"\\n\";\n\treturn 0;\n}\n\n// look at my code\n// my code is amazing\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <vector>\n#define PB push_back\n#define ll long long\nusing namespace std;\ntemplate <class T>\ninline void rd(T &x) {\n\tx=0; char c=getchar(); int f=1;\n\twhile(!isdigit(c)) { if(c=='-') f=-1; c=getchar(); }\n\twhile(isdigit(c)) x=x*10-'0'+c,c=getchar(); x*=f;\n}\nvector<string> s;\nstring S,ans,cur;\nint n,m;\n\nvoid sol(string &s) {\n\tvector<int> p1,p2;\n\tstring t=\"\";\n\tfor(int i=0;i<s.length();++i)\n\t\tif(s[i]=='a') p1.PB(i);\n\t\telse p2.PB(i);\n\tif(s[0]=='a') {\n\t\tint last=-1;\n\t\tfor(int i=0;i<p1.size();++i)\n\t\t\tif(p1[i]>last) last=p2[i],t+=\"ab\";\n\t}\n\telse {\n\t\tfor(int i=0;i<p1.size();++i) {\n\t\t\tstring p=\"\";\n\t\t\tint x=i,y=i;\n\t\t\twhile(1)\n\t\t\t\tif(x<p1.size()&&(y==p2.size()||p1[x]<p2[y]))\n\t\t\t\t\tp+='a',x++;\n\t\t\t\telse if(y<p2.size())\n\t\t\t\t\tp+='b',y++;\n\t\t\t\telse break;\n\t\t\tif(p>t) t=p;\n\t\t}\n\t}\n\ts=t;\n}\n\n\nint main() {\n\trd(n);\n\tcin>>S;\n\tint cnt=0;\t\n\tfor(int i=0;i<n*2;++i) {\n\t\tif(S[i]=='a') cnt++;\n\t\telse cnt--;\n\t\tcur+=S[i];\n\t\tif(cnt==0) {\n\t\t\ts.PB(cur);\n\t\t\tcur=\"\";\n\t\t}\n\t}\n\tfor(int i=0;i<s.size();++i) sol(s[i]);\n\tans=s.back();\n\tfor(int i=(int)s.size()-2;i>=0;--i) {\n\t\tint flg=1;\n\t\tfor(int j=0;j<min(s[i].length(),ans.length());++j)\n\t\t\tif(s[i][j]!=ans[j]) {\n\t\t\t\tif(s[i][j]<ans[j]) flg=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif(flg) ans=s[i]+ans;\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\nint c[6011];\nint begin0;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nstring best=\"\";\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin0=2*n;\n\tmemset(c,0,sizeof(c));\n\tint lab=2*n;\n\tint laa=2*n;\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin0 && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbegin0=a[i];\n\t\t\t\tlaa=begin0;\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(a[i]<lab)\n\t\t\t{\n\t\t\t\tif(best+ans>ans)\n\t\t\t\t{\n\t\t\t\t     ans=best+ans;\n\t\t\t    }\n\t\t\t\tlaa=lab;\n\t\t\t\tbest=\"\";\n\t\t\t}\n\t\t\t\n\t\t\tc[a[i]]=c[b[i]]=1;\n\t\t\ttmp=\"\";\n\t\t\tfor(j=b[i];j<laa;j++)\n\t\t\t{\n\t\t\t\tif(c[j]==1)\n\t\t\t\t{\n\t\t\t\t\ttmp+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(tmp>best)\n\t\t\t{\n\t\t\t\tbest=tmp;\n\t\t\t}\n\t\t\tlab=b[i];\n\t\t\t\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tcout<<best+ans<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[3300];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[0], tmpbs[0]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        if(tmpas.empty() || tmpas.back() < tmpbs.back() == as[i] < bs[i]){\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n        else{\n            string tmp = calc(tmpas, tmpbs);\n            int pos = 0;\n            while(pos < strs.size() && strs[pos] > tmp)pos++;\n            if(pos == strs.size())strs.push_back(tmp);\n            else{\n                strs[pos] = tmp;\n                while(strs.size() > pos+1)strs.pop_back();\n            }\n            tmpas.clear();tmpbs.clear();\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n    }\n    string tmp = calc(tmpas, tmpbs);\n    int pos = 0;\n    while(pos < strs.size() && strs[pos] > tmp)pos++;\n    if(pos == strs.size())strs.push_back(tmp);\n    else{\n        strs[pos] = tmp;\n        while(strs.size() > pos+1)strs.pop_back();\n    }\n    tmpas.clear();tmpbs.clear();\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Why I am so dumb? :c\n#include <bits/stdc++.h>\n\n#define pb push_back\n#define mp make_pair\n\n#define all(x) (x).begin(), (x).end()\n\n#define fi first\n#define se second\n\nusing namespace std;\n\ntypedef long long ll;\n\nint a[3005], b[3005];\n\nstring best[3005];\n\nstring dp[3005];\n\nint pref[6005];\n\nint id[6005];\n\nchar s[6005];\n\nint n;\n\nstring calc(int l, int r) {\n    static string ret;\n    ret.clear();\n\n    int cl = id[l];\n    int cr = id[r + 1] - 1;\n\n    if (s[l] == 'a') {\n        int p = -1;\n        \n        for (int i = cl; i <= cr; ++i) {\n            if (a[i] > p) {\n                p = b[i];\n                ret += \"ab\";\n            }\n        }\n    }\n    else {\n        string cur;\n\n        for (int i = cl; i <= cr; ++i) {\n            cur.clear();    \n\n            for (int j = b[i]; j <= r; ++j) {\n                if (id[j] >= i && id[j] <= cr) {\n                    cur += s[j];\n                }\n            }\n\n            ret = max(ret, cur);\n        }\n    }\n\n    return ret;\n}\n\nvoid solve() {                   \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s + 1);\n    id[n * 2 + 1] = n + 1;\n\n    for (int i = 1, szA = 0, szB = 0; i <= n * 2; ++i) {\n        pref[i] = pref[i - 1];\n\n        if (s[i] == 'a') {\n            a[++szA] = i;\n            id[i] = szA;\n            ++pref[i];\n        }    \n        else {\n            b[++szB] = i;\n            id[i] = szB;\n            --pref[i];\n        }\n    }\n\n    vector<pair<int, int>> vv;\n\n    for (int l = 1, r; l <= (n << 1); l = r) {\n        int bal = 0;\n        r = l + 1;\n                  \n        s[l] == 'a' ? ++bal : --bal;\n\n        while (r <= (n << 1) && bal != 0) {\n            s[r] == 'a' ? ++bal : --bal;\n            ++r;\n        }\n\n        vv.pb(mp(l, r - 1));\n    }\n\n    for (int i = 0; i < vv.size(); ++i) {\n        best[i] = calc(vv[i].fi, vv[i].se);\n    }\n\n    for (int i = (int)vv.size() - 1; i >= 0; --i) {\n        dp[i] = max(dp[i + 1], best[i] + dp[i + 1]);\n    }\n\n    cout << dp[0] << '\\n';\n}\n\nint main() {    \n    int tt = 1;\n\n    while (tt--) {\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#pragma GCC optimize(\"Ofast,no-stack-protector\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx\")\n//#pragma GCC target(\"avx,tune=native\")\n#include<bits/stdc++.h>\n//#include<ext/pb_ds/assoc_container.hpp>\nusing namespace std;\n//using namespace __gnu_pbds;\nconst int inf=0x3f3f3f3f;\nconst double eps=1e-6;\nconst int mod=1000000007;\ntypedef long long ll;\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\ninline string getstr(string &s,int l,int r){string ret=\"\";for(int i=l;i<=r;i++)ret.push_back(s[i]);return ret;}\nint modpow(int x,int y,int md=mod){if(y==0)return 1;int ret=modpow(x,y>>1,md);ret=(ll)ret*ret%md;if(y&1)ret=(ll)ret*x%md;return ret;}\nint n;\nstring s;\nstring dp[3003];\nstring suf[3003];\nint pos[6003];\nvector<int>a,b;\nint main(){\n\tcin>>n>>s;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(s[i]=='a')pos[i]=a.size(),a.push_back(i);\n\t\telse pos[i]=b.size(),b.push_back(i);\n\t}\n\tdp[n]=\"\";\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(a[i]<b[i]){\n\t\t\t//ab\n\t\t\tint mx=-inf;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tmx=max(mx,pos[j]);\n\t\t\t}\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[mx+1]);\n\t\t}else{\n\t\t\t//ba\n\t\t\tint tmp=i;\n\t\t\twhile(b[tmp+1]<a[tmp])tmp++;\n\t\t\tfor(int j=b[i];j<s.size();j++)if(i<=pos[j]&&pos[j]<=tmp)dp[i].push_back(s[j]);\n\t\t\tdp[i]+=dp[tmp+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<*max_element(dp,dp+n)<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\nchar str[6050];\nstring dp[6050];\nint a[3050],b[3050],ink[6050];\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str + 1);\n\tint ac = 0,bc = 0;\n\tfor(int i = 1;i <= 2 * n; ++ i)\n\t{\n\t\tif(str[i] == 'a')\n\t\t\ta[++ ac] = i,ink[i] = ac;\n\t\telse\n\t\t\tb[++ bc] = i,ink[i] = bc;\n\t}\n\tfor(int i = n;i >= 1; -- i)\n\t{\n\t\tdp[i] = dp[i + 1];\n\t\tif(a[i] < b[i])\n\t\t{\n\t\t\tint fk = i;\n\t\t\tfor(int j = a[i] + 1;j < b[i]; ++ j)\n\t\t\t\tif(str[j] == 'a')\n\t\t\t\t\tfk = max(fk,ink[j]);\n\t\t\tdp[i] = max(dp[i],\"ab\" + dp[fk + 1]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint fk = i; bool mark[6050] = {0};\n\t\t\tint r = a[i];\n\t\t\tmark[b[i]] = mark[a[i]] = 1;\n\t\t\tfor(int j = b[i] + 1;j <= r; ++ j)\n\t\t\t\tif(str[j] == 'b')\n\t\t\t\t\tmark[j] = mark[a[ink[j]]] = 1,\n\t\t\t\t\tr = max(r,a[ink[j]]);\n\t\t\tstring tmp = \"\";\n\t\t\tfor(int j = b[i];j <= 2 * n; ++ j)\n\t\t\t\tif(mark[j]) (tmp = tmp + str[j]);\n\t\t\tint zjk = i + 1;\n\t\t\twhile(zjk <= n && min(a[zjk],b[zjk]) <= r) zjk ++;\n\t\t\tdp[i] = max(dp[i],tmp + dp[zjk]);\n\t\t}\n\t}\n\tcout << dp[1] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define inf 0x3f3f3f3f\n#define mod 1000000007\n#define pb push_back\n#define mp make_pair\n#define ll long long\n#define vi vector <int>\n#define pii pair <int, int>\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\n#define rep(i,n) for (int i = 0; i < (int) (n); ++ i)\n#define foreach(it,c) for (__typeof(c.begin()) it = c.begin(); it != c.end(); ++ it)\n\ninline int read() {\n\tint x = 0, f = 1, c = getchar();\n\tfor (;!isdigit(c);c = getchar()) if (c == '-') f ^= 1;\n\tfor (; isdigit(c);c = getchar()) x = x * 10 + c - '0';\n\treturn f ? x : -x;\n}\n\nint n;\nchar s[6005];\nint a[3005], b[3005];\nint cnt1 = 0, cnt2 = 0;\nint bel[6005];\nstring dp[3005];\n\nint main() {\n\tn = read();\n\tscanf(\"%s\", s);\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') bel[i] = cnt1, a[cnt1 ++] = i;\n\t\telse bel[i] = cnt2, b[cnt2 ++] = i;\n\t}\n\tfor (int i = n - 1; ~i; -- i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint nex = i;\n\t\t\tfor (int j = a[i]; j <= b[i]; ++ j) {\n\t\t\t\tnex = max(nex, bel[j] + 1);\n\t\t\t}\n\t\t\tdp[i] = \"ab\" + dp[nex];\n\t\t} else {\n\t\t\tint x = i;\n\t\t\twhile (x + 1 < n && b[x + 1] <= a[x]) ++ x;\n\t\t\trep(j, 2 * n) {\n\t\t\t\tif (bel[j] >= i && bel[j] <= x) dp[i] += s[j];\n\t\t\t}\n\t\t\tdp[i] += dp[x + 1];\n\t\t}\n\t\tdp[i] = max(dp[i], dp[i + 1]);\n\t}\n\tprintf(\"%s\\n\", dp[0].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 6000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res = \"ab\";\n    int pa = l + 1, pb = b[l];\n\n    while(a[r] > pb) {\n        while(a[pa] < pb) ++ pa;\n        res += \"ab\";\n        pb = b[pa];\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i; else b[++ b[0]] = i;\n    }\n\n    string tmp, ans;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        stk.push_back(tmp);\n    }\n\n    std::reverse(stk.begin(), stk.end());\n    for(auto s : stk) chkmax(ans, ans + s);\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first,pos[b].second)){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = max(pos[b].second,pos[b].first);\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (min(pos[j].first, pos[j].second) > maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define pb push_back\nusing namespace std;\nstring str;\nvector<int> pos[2];\nvector<string> vec;\nstring work(int l, int r)\n{\n\tint x = -1, y = -1;\n\tfor (int i = 0; i < (int)pos[0].size(); i++) {\n\t\tif (l <= pos[0][i] && pos[0][i] <= r) {\n\t\t\tif (-1 == x) {\n\t\t\t\tx = i;\n\t\t\t}\n\t\t\ty = i;\n\t\t}\n\t}\n\tstring res;\n\tif (pos[0][x] < pos[1][x]) {\n\t\tint lst = l - 1;\n\t\tfor (int i = x; i <= y; i++) {\n\t\t\tif (pos[0][i] > lst) {\n\t\t\t\tres += \"ab\";\n\t\t\t\tlst = pos[1][i];\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\tfor (int i = x; i <= y; i++) {\n\t\tstring tmp;\n\t\tfor (int j = l; j <= r; j++) {\n\t\t\tif (j >= pos[str[j] - 'a'][i]) {\n\t\t\t\ttmp += str[j];\n\t\t\t}\n\t\t}\n\t\tres = max(res, tmp);\n\t}\n\treturn res;\n}\nint main()\n{\n\t// freopen(\"AGC026-E.in\", \"r\", stdin);\n\tint n;\n\tcin >> n >> str;\n\tfor (int i = 0; i < n << 1; i++) {\n\t\tpos[str[i] - 'a'].pb(i);\n\t}\n\tint cur = 0, lst = 0;\n\tfor (int i = 0; i < n << 1; i++) {\n\t\tcur += str[i] == 'a' ? 1 : -1;\n\t\tif (!cur) {\n\t\t\tvec.pb(work(lst, i));\n\t\t\tlst = i + 1;\n\t\t}\n\t}\n\tstring ans;\n\tfor (int i = vec.size() - 1; i >= 0; i--) {\n\t\tans = max(ans, vec[i] + ans);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N], z[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            int ca = 0, cb = 0;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (a[j]) z[j] = ++cb;\n                else z[j] = ++ca;\n            }\n            int len = (p[i + 1] - p[i]) / 2;\n            for1(k, len, 1) {\n                string cur;\n                forn(j, p[i], p[i + 1] - 1)\n                    if (z[j] >= k) cur.pb('a' + a[j]);\n                cans = max(cans, cur);\n            }\n            ans = ans + cans;\n        }\n        else {\n            if (i < lst) continue;\n            int cnt = 0;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    ans.pb('a'), ans.pb('b');\n                    cnt = 0;\n                }\n            }\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nbool bo[6010];\nint n,p[6010],tA[3010],tB[3010],tnA,tnB,len,la,fn[6010],gn[6010],po[6010],fp[6010];\nchar s[6010],f[6010][6010],g[6010][6010];\n\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1),tnA=tnB=0;\n\tfor (int i=1; i<=2*n; i++)\n\t\tif (s[i]=='a') tA[++tnA]=i; else tB[++tnB]=i;\n\tfor (int i=1; i<=n; i++) p[tA[i]]=tB[i],p[tB[i]]=tA[i];\n\tfor (int i=1; i<=2*n; i++) if (s[i]=='b'&&p[i]>i)\n\t{\n\t\tint P=p[i];\n\t\tbo[i]=bo[p[i]]=1;\n\t\tfor (int j=i+1; j<=P; j++)\n\t\t\tif (s[j]=='b'&&p[j]>j) P=p[j],bo[j]=bo[p[j]]=1;\n\t\tpo[i]=P,gn[i]=0;\n\t\tfor (int j=1; j<=2*n; j++) if (bo[j]) g[i][++gn[i]]=s[j],bo[j]=0;\n\t}\n\tfn[2*n+1]=0,fp[2*n+1]=0;\n\tfor (int i=2*n; i; i--) \n\t\tif (s[i]=='b'&&p[i]>i)\n\t\t{\n\t\t\tfn[i]=gn[i]+fn[po[i]+1];\n\t\t\tfor (int j=1; j<=gn[i]; j++) f[i][j]=g[i][j];\n\t\t\tfor (int j=1; j<=fn[po[i]+1]; j++) f[i][j+gn[i]]=f[po[i]+1][j];\n\t\t\tfp[i]=max(fp[po[i]+1],po[i]);\n\t\t\tbool bo=0;\n\t\t\tfor (int j=1; j<=fn[i]&&j<=fn[i+1]; j++)\n\t\t\t\tif (f[i][j]!=f[i+1][j])\n\t\t\t\t{\n\t\t\t\t\tbo=1;\n\t\t\t\t\tif (f[i][j]<f[i+1][j]) \n\t\t\t\t\t{\n\t\t\t\t\t\tfn[i]=fn[i+1],fp[i]=fp[i+1];\n\t\t\t\t\t\tfor (int k=1; k<=fn[i]; k++) f[i][k]=f[i+1][k];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tif (!bo&&fn[i]<fn[i+1])\n\t\t\t{\n\t\t\t\tfn[i]=fn[i+1],fp[i]=fp[i+1];\n\t\t\t\tfor (int j=1; j<=fn[i]; j++) f[i][j]=f[i+1][j];\n\t\t\t}\n\t\t} else \n\t\t{\n\t\t\tfn[i]=fn[i+1],fp[i]=fp[i+1];\n\t\t\tfor (int j=1; j<=fn[i]; j++) f[i][j]=f[i+1][j];\n\t\t}\n\tfor (int i=1; i<=fn[1]; i++) putchar(f[1][i]);\n\tlen=0,la=fp[1];\n\tfor (int i=1; i<=n; i++) \n\t{\n\t\tint mi=2*n+1;\n\t\tfor (int j=la+1; j<=2*n; j++)\n\t\t\tif (s[j]=='a'&&p[j]<mi) mi=p[j];\n\t\tif (mi==2*n+1) break;\n\t\tla=mi,len++;\n\t}\n\tfor (int i=1; i<=len; i++) putchar('a'),putchar('b');\n\treturn puts(\"\"),0;\n} "
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tstring to = \"\";\n\t\tif(s[i] == 'a') {\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tint lsta = 0;\n\t\t\tfor(int k = i;k < j;k++) {\n\t\t\t\tcntb += s[k] == 'b';\n\t\t\t\tif(s[k] == 'a') {\n\t\t\t\t\tcnta += s[k] == 'a';\n\t\t\t\t\tif(to.empty() || to.back() == 'b') to += 'a', lsta = cnta;\n\t\t\t\t} else {\n\t\t\t\t\tcntb += s[k] == 'a';\n\t\t\t\t\tif(cntb == lsta) to += 'b';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tto = s.substr(i,j-i);\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(res <= in[i] + res) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nstring f[6005];\nint id[6005];\nstring st;\nint pos[2][6005];\nint rep[2][6005];\n#define aa 0\n#define bb 1\n\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(st[i]=='a')rep[0][i]=++pos[0][0],pos[0][pos[0][0]]=i;\n\t\telse rep[1][i]=++pos[1][0],pos[1][pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[aa][i]<<\" \"<<pos[bb][i]<<endl;\n\t}\n\t*/\n\tint t=0;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(pos[aa][i]<pos[bb][i])\n\t\t{\n\t\t\tfor(int j=pos[aa][i]+1,t=i;j<pos[bb][i];j++)t=max(t,max(rep[aa][j],rep[bb][j]-1));\n\t\t\tf[i]+=\"ab\";\n\t\t\tf[i]+=f[i+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tt=i;\n\t\t\twhile(t<=n&&pos[bb][t+1]<pos[aa][t])t++;\n\t\t\tfor(int j=pos[bb][i];j<=2*n;j++)if(i<=max(rep[aa][j],rep[bb][j])&&max(rep[aa][j],rep[bb][j])<=t)f[i]+=st[j];\n\t\t\tf[i]+=f[t+1];\n\t\t}\n\t}\n\tstring mx=\"\";\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tmx=max(mx,f[i]);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for((i)=1;(i)<=(n);(i)++)\nusing namespace std;\nint n,m,i,j,a[3005],b[3005],c1,c2,id[6005],pos[3005];\nstring st,f[3005];\nint main(){\n\tcin>>n>>st;\n\trep(i,n+n){\n\t\tif(st[i-1]=='a'){\n\t\t\ta[++c1]=i;\n\t\t\tid[i]=c1;\n\t\t}\n\t\telse{\n\t\t\tb[++c2]=i;\n\t\t\tid[i]=c2;\n\t\t}\n\t}\n\tst=\" \"+st;\n\tj=0;\n\trep(i,n){\n\t\twhile(j<min(a[i],b[i])){\n\t\t\tpos[++j]=i;\n\t\t}\n\t}\n\tfor(i=n;i;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tf[i]=\"ab\"+f[pos[b[i]+1]];\n\t\t}\n\t\telse{\n\t\t\tint j=b[i];\n\t\t\tf[i]=\"\";\n\t\t\twhile(b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1])){\n\t\t\t\tif(id[j]>=i) f[i]+=st[j];\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tf[i]+=f[id[j]];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n//\t\tcerr<<f[i]<<endl;\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\nusing namespace std;\nint N;\nchar S[6005];\nchar P[6005][6005];\nint p;\nint Pair[6005];\nint Ind[6005];\nint Right[6005];\nchar W[6005], Sol[6005], DP[6005][6005];\nvector <int> V[2];\nvoid Read()\n{\n    cin >> N;\n    cin.get();\n    cin.getline(S + 1, 6005);\n    for(int i = 1; i <= N * 2; i++)\n    {\n        if(S[i] == 'a')\n            V[0].push_back(i);\n        else\n            V[1].push_back(i);\n    }\n    for(int i = 0; i < V[0].size(); i++)\n    {\n        Pair[V[0][i]] = V[1][i];\n        Pair[V[1][i]] = V[0][i];\n    }\n}\nvoid fillP(int pos)\n{\n    int left = Right[pos - 1] + 1, right = Right[pos];\n    if(S[left] == 'a')\n    {\n        int curr = Pair[left], ind = 0;\n        P[pos][++Ind[pos]] = 'a';\n        P[pos][++Ind[pos]] = 'b';\n        ++curr;\n        while(curr >= left && curr <= right)\n        {\n            if(S[curr] == 'b')\n            {\n                ++curr;\n                continue;\n            }\n            P[pos][++Ind[pos]] = 'a';\n            P[pos][++Ind[pos]] = 'b';\n            curr = Pair[curr] + 1;\n        }\n    }\n    else\n    {\n        int ind = 0;\n        for(int i = left; i <= right; i++)\n            Sol[++ind] = S[i];\n        Sol[ind + 1] = 0;\n        ind = 0;\n        for(int i = left + 1; i <= right; i++)\n        {\n            ind = 0;\n            for(int j = i; j <= right; j++)\n            {\n                if(S[j] == 'b')\n                    W[++ind] = S[j];\n                else\n                    if(Pair[j] >= i && Pair[j] <= right)\n                        W[++ind] = S[j];\n            }\n            W[ind + 1] = 0;\n            if(strcmp(Sol + 1, W + 1) < 0)\n            {\n                for(int j = 1; j <= ind; j++)\n                    Sol[j] = W[j];\n                Sol[ind + 1] = 0;\n            }\n        }\n        ind = 0;\n        for(int j = 1; Sol[j] != 0; j++)\n            P[pos][++ind] = Sol[j];\n    }\n}\nvoid Parts()\n{\n    int cnt = 0;\n    for(int i = 1; i <= N * 2; i++)\n    {\n        if(S[i] == 'a')\n            ++cnt;\n        else\n            --cnt;\n        if(cnt == 0)\n        {\n            ++p;\n            Right[p] = i;\n            fillP(p);\n        }\n    }\n}\n\nvoid precalcDP()\n{\n    strcpy(DP[p] + 1, P[p] + 1);\n    for(int i = p - 1; i >= 1; i--)\n    {\n        strcpy(DP[i] + 1, DP[i + 1] + 1);\n        strcpy(W + 1, P[i] + 1);\n        if(strcmp(DP[i] + 1, W + 1) < 0)\n            strcpy(DP[i] + 1, W + 1);\n        strcat(W + 1, DP[i + 1] + 1);\n        if(strcmp(DP[i] + 1, W + 1) < 0)\n            strcpy(DP[i] + 1, W + 1);\n    }\n    cout << (DP[1] + 1) << \"\\n\";\n}\nint main()\n{\n    Read();\n    Parts();\n    precalcDP();\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "    #include<bits/stdc++.h>\n    using namespace std;\n    #define vi vector<int>\n    #define pii pair<int,int>\n    #define vp  vector<pii>\n    #define fi first\n    #define se second\n    #define mp make_pair\n    #define pb push_back\n    #define ls l,mid,rt<<1\n    #define rs mid+1,r,rt<<1|1\n    #define de(x) cout<< #x<<\" = \"<<x<<endl\n    #define dd(x) cout<< #x<<\" = \"<<x<<\" \"\n    #define sf scanf\n    #define pf printf\n    #define all(x) (x).begin(),(x).end()\n    #define SZ(x) ((int)(x).size())\n    #define rep(i,a,n) for (int i=a;i<n;i++)\n    #define per(i,a,n) for (int i=n-1;i>=a;i--)\n    typedef long long ll;\n    typedef unsigned long long ull;\n    //typedef __int128 INT128;\n    //INT128 read(){\n    //    INT128 x=0,f=1;\n    //    char ch=getchar();\n    //    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    //    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n    //    return x*f;\n    //}\n    //void write(INT128 x){\n    //    if(x<0){putchar('-');x=-x;}\n    //    if(x<10){putchar(x+'0'); return;}\n    //    write(x/10);putchar(x%10+'0');\n    //}\n    typedef long double ld;\n    const int INF=0x3f3f3f3f;\n    const double eps=1e-8;\n    const double PI=acos(-1.0);\n    const int MAXN=1e5+5;\n    const int MAXM=2e6+5;\n    const int MOD=1e9+7;\n    int sgn(double x){if(fabs(x)<eps)return 0;if(x<0)return -1;else return 1;}\n    ll pw(ll a,ll n,ll mod){ll ret=1;while(n){if(n&1)ret=ret*a%mod;a=a*a%mod;n>>=1;}return ret;}\n    ll gcd(ll a,ll b){return b==0?a:gcd(b,a%b);}\n    ll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n    void inc(ll &a,ll b){a+=b;if(a>=MOD)a-=MOD;}\n    void dec(ll &a,ll b){a-=b;if(a<0)a+=MOD;}\n    int mul(int x, int y){ll z=1ll*x*y;return z-z/MOD*MOD;}\n    //head\n     \n    int n,ta,tb,pos_a[MAXN],pos_b[MAXN],pos[MAXN];\n    string s,ans,dp[MAXN];\n    int main(){\n        cin>>n>>s; ta=tb=0;\n        rep(i,0,2*n){\n            if(s[i]=='a')pos_a[++ta]=i,pos[i]=ta;\n            else pos_b[++tb]=i,pos[i]=tb;\n        }\n        per(i,1,n+1){\n            if(pos_a[i]<pos_b[i]){\n                int k=i;\n                rep(j,pos_a[i]+1,pos_b[i])k=max(k,pos[j]);\n                dp[i]=\"ab\"+dp[k+1];\n            }else{\n                int k=i;\n                while(k<n&&pos_b[k+1]<pos_a[k])k++;\n                rep(j,pos_b[i],2*n)if(pos[j]>=i&&pos[j]<=k)dp[i]+=s[j];\n                //de(k);\n                dp[i]+=dp[k+1];\n            }\n            //dd(i); de(dp[i]);\n            dp[i]=max(dp[i],dp[i+1]);\n            ans=max(ans,dp[i]);\n        }\n        cout<<ans<<endl;\n    }\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast,inline\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,sse4.1,sse4.2,popcnt,abm,mmx,avx,avx2,tune=native\")\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mxn=3333;\nstring f[mxn];char s[mxn<<1];\nint s1[mxn],s2[mxn],n,pos[mxn<<1],t1,t2;\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n<<1;++i){\n\t\tif(s[i]=='a')s1[++t1]=i,pos[i]=t1;\n\t\telse s2[++t2]=i,pos[i]=t2;\n\t}\n\tstring ans;\n\tfor(int i=n;i;--i){\n\t\tif(s1[i]<s2[i]){\n\t\t\tint k=i;\n\t\t\tfor(int j=s1[i]+1;j<s2[i];++j)k=max(k,pos[j]);\n\t\t\tf[i]=\"ab\"+f[k+1];\n\t\t}else{\n\t\t\tint k=i;\n\t\t\twhile(k<n and s2[k+1]<s1[k])++k;\n\t\t\tfor(int j=s2[i];j<=n<<1;++j)if(i<=pos[j] and pos[j]<=k)f[i]+=s[j];\n\t\t\tf[i]+=f[k+1];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%s\\n\",ans.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tint ret=0; char c=getchar();\n\twhile(c<48||c>57)c=getchar();\n\twhile(c>=48&&c<=57)ret=ret*10+c-48,c=getchar();\n\treturn ret;\n}\n#define N 6099\nint n,nn;\nchar s[6159];\nint d,g_[N],h[N],g[N],a[N],b[N],a1,b1,f[N],ma,vi[N],t[N];\nint main()\n{\n\tn=read();nn=n*2;\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=nn;++i)if(s[i]=='a')a[++a1]=i;else b[++b1]=i; b[n+1]=a[n+1]=nn+10;\n\tfor(int i=1;i<=n;++i){\n\t\tif(b[i]<a[i]){\n\t\t\tf[i]=lower_bound(b+1,b+n+1,a[i])-b-i;\n\t\t\tma=max(ma,f[i]);\n\t\t}\n\t}\n\t\n\tif(!ma){\n\t\tint u=0;\n\t\tfor(int i=1;i<=n;++i)if(a[i]>u&&b[i]>u)printf(\"ab\"),u=max(u,a[i]),u=max(u,b[i]);\n\t\texit(0);\n\t}\n\tg[n]=f[n]; \n\tfor(int i=n-1;i;--i)g[i]=max(g[i+1],f[i]);\n\tfor(int i=1;i<=n;++i)if(f[i]==g[i]){ ////ddd\n\t\tif(!g[i])break;\n\t\tvi[i]=1;\n\t}\n\tfor(int i=1;i<=n;++i)if(vi[i])t[a[i]]=t[b[i]]=1;\n\tfor(int i=1;i<=nn;++i)if(t[i])printf(\"%c\",s[i]);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw){\n            continue;\n        }\n        if (ppp[i].first[0] == 'a'){\n            for (int j=i; j < ppp.size(); j++){\n                if (ppp[i].second > nw) ans += ppp[j].first;\n            }\n            break;\n        }\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#define MN 6010\n\nchar c[MN], s[MN], t[MN], now[MN];\nbool S[MN], T[MN], tmp[MN], used[MN];\nint p[MN], n;\nint qa[MN], ha = 0, ta = 0;\nint qb[MN], hb = 0, tb = 0;\n\nvoid Find(int l, int r)\n{\n\tfor(int i = 1; i <= n; i++) T[i] = 0, t[i] = '\\0'; \n\tfor(int i = r; i >= l; i--)\n\t{\n\t\tif(c[i] == 'b') continue;\n\t\tused[i] = used[p[i]] = 1;\n\t\tint len = 0;\n\t\tfor(int j = l; j <= r; j++) if(used[j]) now[++len] = c[j];\n\t\tint N = strlen(t + 1);\n\t\tint ok = N + 1;\n\t\tfor(int j = 1; j <= N; j++) \n\t\t{\n\t\t\tif(t[j] < now[j]) {ok = j; break;}\n\t\t\tif(t[j] > now[j]) {ok = 0; break;}\n\t\t}\n\t\tif(ok) \n\t\t{\n\t\t\tfor(int k = ok; k <= len; k++) t[k] = now[k], T[k] = 0;\n\t\t\tT[len] = 1;\n\t\t}\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%s\", &n, c + 1); n *= 2;\n\tint lst = 0, sum = 0, R = 0;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tif(c[i] == 'a')\n\t\t{\n\t\t\tif(hb < tb) p[i] = qb[hb], p[qb[hb++]] = i;\n\t\t\telse qa[ta++] = i;\n\t\t\tsum--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(ha < ta) p[i] = qa[ha], p[qa[ha++]] = i;\n\t\t\telse qb[tb++] = i;\n\t\t\tsum++;\n\t\t}\n\t\tif(sum == 0)\n\t\t{\n\t\t\tif(c[i] == 'a')\n\t\t\t{\n\t\t\t\tFind(lst + 1, i); \n\t\t\t\tint N = strlen(t + 1), len = strlen(s + 1), L = 0;\n\t\t\t\tmemset(tmp, 0, sizeof(tmp)); tmp[N] = 1; \n\t\t\t\tfor(int j = 1; j <= len; j++)\n\t\t\t\t{\n\t\t\t\t\tif(S[j])\n\t\t\t\t\t{\n\t\t\t\t\t\tbool ok = N + 1;\n\t\t\t\t\t\tfor(int k = 1; k <= N; k++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(t[k] < (L + k > j ? t[L + k - j] : s[L + k])) {ok = k; break;}\n\t\t\t\t\t\t\tif(t[k] > (L + k > j ? t[L + k - j] : s[L + k])) {ok = 0; break;}\n\t\t\t\t\t\t\ttmp[L + k] |= (L + k > j ? T[L + k - j] : S[L + k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ok)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(int k = L + ok; k <= j + N; k++)\n\t\t\t\t\t\t\t\ttmp[k] = (k > j ? T[k - j] : S[k]);\n\t\t\t\t\t\t\tL = j;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = L + 1; j <= L + N; j++) s[j] = t[j - L];\n\t\t\t\tfor(int j = L + N + 1; j <= n; j++) s[j] = '\\0';\n\t\t\t\tmemcpy(S, tmp, sizeof(tmp));\n\t\t\t\tR = i;\n\t\t\t}\n\t\t\tlst = i;\n\t\t}\n\t}\n\tint len = strlen(s + 1);\n\tfor(int i = R + 1; i <= n; i++)\n\t{\n\t\tif(c[i] == 'a') s[++len] = 'a', s[++len] = 'b', i = p[i];\n\t}\n\tprintf(\"%s\", s + 1);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nint n;\nstring s;\nint a[3005], b[3005];\nint order[6005];\n\nstring calc(int l, int r, string &ans)\n{\n\tstring ret;\n\tif(s[l] == 'a'){\n\t\tif(ans.size() && ans[0] == 'b') return ans;\n\t\tint x = l;\n\t\twhile(x <= r){\n\t\t\tret += \"ab\";\n\t\t\tx = b[order[x]];\n\t\t\twhile(x <= r && s[x] != 'a') x++;\n\t\t}\n\t\tret += ans;\n\t\treturn ret;\n\t}\n\t\n\tfor(int i = l; i <= r; i++){\n\t\tif(s[i] == 'a') continue;\n\t\tint p = a[order[i]];\n\t\tstring tmp;\n\t\tfor(int j = i; j <= r; j++){\n\t\t\tif(s[j] == 'b') tmp += \"b\";\n\t\t\telse if(j >= p) tmp += \"a\";\n\t\t}\n\t\tret = max(ret, tmp + ans);\n\t}\n\treturn ret;\n}\n\nint main(void)\n{\n\tcin >> n;\n\tcin >> s;\n\ts = \"#\" + s;\n\tn *= 2;\n\t\n\tint aid = 1, bid = 1;\n\tfor(int i = 1; i <= n; i++){\n\t\tif(s[i] == 'a') a[aid] = i, order[i] = aid++;\n\t\tif(s[i] == 'b') b[bid] = i, order[i] = bid++;\n\t}\n\t\n\tstring ans; int l = n+1, r = n;\n\tfor(int i = n; i >= 1; i--){\n\t\tif(s[i] == 'a') l = min(l, b[order[i]]);\n\t\tif(s[i] == 'b') l = min(l, a[order[i]]);\n\t\tif(i == l){\n\t\t\tans = calc(l, r, ans);\n\t\t\tr = l-1;\n\t\t}\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using gpp_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename L> using gpp_map = tree<T, L, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T> using gpp_multiset = tree<T, null_type, less_equal<T>, rb_tree_tag, tree_order_statistics_node_update>;*/\nstruct fast_ios { fast_ios(){ cin.tie(0); ios::sync_with_stdio(false); cout << fixed << setprecision(20); }; } fast_ios_;\n#define FOR(i, begin, end) for(int i=(begin);i<(end);i++)\n#define REP(i, n) FOR(i,0,n)\n#define IFOR(i, begin, end) for(int i=(end)-1;i>=(begin);i--)\n#define IREP(i, n) IFOR(i,0,n)\n#define Sort(v) sort(v.begin(), v.end())\n#define Reverse(v) reverse(v.begin(), v.end())\n#define all(v) v.begin(),v.end()\n#define SZ(v) ((int)v.size())\n#define Lower_bound(v, x) distance(v.begin(), lower_bound(v.begin(), v.end(), x))\n#define Upper_bound(v, x) distance(v.begin(), upper_bound(v.begin(), v.end(), x))\n#define Max(a, b) a = max(a, b)\n#define Min(a, b) a = min(a, b)\n#define bit(n) (1LL<<(n))\n#define bit_exist(x, n) ((x >> n) & 1)\n#define debug(x) cout << #x << \"=\" << x << endl;\n#define vdebug(v) cout << #v << \"=\" << endl; REP(i_debug, v.size()){ cout << v[i_debug] << \",\"; } cout << endl;\n#define mdebug(m) cout << #m << \"=\" << endl; REP(i_debug, m.size()){ REP(j_debug, m[i_debug].size()){ cout << m[i_debug][j_debug] << \",\"; } cout << endl;}\n#define pb push_back\n#define f first\n#define s second\n#define int long long\n#define INF 1000000000000000000\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v){ for (auto &x : v) is >> x; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &v){ for(int i = 0; i < v.size(); i++) { cout << v[i]; if(i != v.size() - 1) cout << endl; }; return os; }\ntemplate<typename T> void Out(T x) { cout << x << endl; }\ntemplate<typename T1, typename T2> void Ans(bool f, T1 y, T2 n) { if(f) Out(y); else Out(n); }\n\nusing vec = vector<int>;\nusing mat = vector<vec>;\nusing Pii = pair<int, int>;\nusing PiP = pair<int, Pii>;\nusing PPi = pair<Pii, int>;\nusing bools = vector<bool>;\nusing pairs = vector<Pii>;\n\n//int dx[4] = {1,0,-1,0};\n//int dy[4] = {0,1,0,-1};\n//char d[4] = {'D','R','U','L'};\n\nconst int mod = 1000000007;\n//const int mod = 998244353;\n//#define Add(x, y) x = (x + (y)) % mod\n//#define Mult(x, y) x = (x * (y)) % mod\n\nvoid add_a(string &S, int i0, int i1, vector<string> &v){\n    char t = 'a';\n    string x = \"\";\n    FOR(i, i0, i1 + 1){\n        if(S[i] == t){\n            if(t == 'a') t = 'b';\n            else{\n                x += \"ab\";\n                t = 'a';\n            }\n        }\n    }\n    v.pb(x);\n}\n\nvoid add_b(string &S, int i0, int i1, vector<string> &v){\n    string x = \"\";\n    int now = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        Max(x, string(now, 'b') + S.substr(i + 1, i1 - i));\n    }\n    v.pb(x);\n}\n\nsigned main(){\n\n    int N; cin >> N;\n    string S; cin >> S;\n\n    vector<string> v;\n    int now = 0, i0 = 0;\n    REP(i, 2 * N){\n        if(S[i] == 'b') now++;\n        else now--;\n        if(now == 0){\n            if(S[i0] == 'a') add_a(S, i0, i, v);\n            else add_b(S, i0, i, v);\n            i0 = i + 1;\n        }\n    }\n    //vdebug(v);\n\n    vector<string> ans;\n    for(string x: v){\n        while(SZ(ans) > 0 && ans.back() < x) ans.pop_back();\n        ans.pb(x);\n    }\n    for(string x: ans) cout << x;\n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef signed long long ll;\n\n#undef _P\n#define _P(...) (void)printf(__VA_ARGS__)\n#define FOR(x,to) for(x=0;x<(to);x++)\n#define FORR(x,arr) for(auto& x:arr)\n#define ITR(x,c) for(__typeof(c.begin()) x=c.begin();x!=c.end();x++)\n#define ALL(a) (a.begin()),(a.end())\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n//-------------------------------------------------------\n\nint N;\nstring S;\n\nstring hoge(string S) {\n\tint cnt[6030]={};\n\tint vis[6030]={};\n\tvector<int> As,Bs;\n\t\n\tint a=0,b=0,i,j;\n\tFOR(i,S.size()) {\n\t\tif(S[i]=='a') {\n\t\t\tcnt[i]=a++;\n\t\t\tAs.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tcnt[i]=b++;\n\t\t\tBs.push_back(i);\n\t\t}\n\t}\n\t\n\tstring R;\n\t\n\tif(S[0]=='a') {\n\t\tFOR(i,S.size()) {\n\t\t\tif(vis[i]==0) {\n\t\t\t\tR+=S[i];\n\t\t\t\tif(S[i]=='a') {\n\t\t\t\t\tfor(int j=i+1;j<Bs[cnt[i]];j++) vis[j]=vis[Bs[cnt[j]]]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tFOR(i,S.size()/2) {\n\t\t\tstring T;\n\t\t\tFOR(j,S.size()) {\n\t\t\t\tif(cnt[j]>=i) T+=S[j];\n\t\t\t}\n\t\t\tR=max(R,T);\n\t\t}\n\t\t\n\t}\n\treturn R;\n}\n\n\nvoid solve() {\n\tint i,j,k,l,r,x,y; string s;\n\t\n\tcin>>N>>S;\n\tstring T;\n\tvector<string> V;\n\t\n\tx=0;\n\tFORR(c,S) {\n\t\tT+=c;\n\t\tif(c=='a') x++;\n\t\telse x--;\n\t\tif(x==0) {\n\t\t\tstring P=hoge(T);\n\t\t\t\n\t\t\twhile(V.size() && T > V.back()+T) V.pop_back();\n\t\t\tV.push_back(T);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\t\n\tFORR(c,V) cout<<c;\n\tcout<<endl;\n\t\n}\n\n\nint main(int argc,char** argv){\n\tstring s;int i;\n\tif(argc==1) ios::sync_with_stdio(false), cin.tie(0);\n\tFOR(i,argc-1) s+=argv[i+1],s+='\\n'; FOR(i,s.size()) ungetc(s[s.size()-1-i],stdin);\n\tcout.tie(0); solve(); return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 3005\n#define re register\nusing namespace std;\nint n,la[N],lb[N],loca[N],locb[N];\nchar a[N<<1];\nbool dp[N][N];\nstring ans = \"\";\n\nstring get(bool dp[])//对这个存在性的数组求对应的串 \n{\n\tstring ret = \"\";\n\tfor(re int i=0;i<n * 2;++i)\n\t{\n\t\tif(a[i] == 'a' && dp[la[i]]) ret += \"a\";\n\t\tif(a[i] == 'b' && dp[lb[i]]) ret += \"b\";\n\t}\n\treturn ret;\n}\nint main()\n{\n\tscanf(\"%d%s\",&n,a);\n\tfor(int i=0,ca=0,cb=0;i<n*2;++i)\n\t{\n\t\tif(a[i] == 'a') la[i] = ++ca,loca[ca] = i;\n\t\telse lb[i] = ++cb,locb[cb] = i;\n\t}\n\tdp[n][n] = 1;\n\tfor(int i=n - 1;i>=1;--i)\n\t{\n\t\tint mx = i;\n\t\tdp[i][i] = 1;\n\t\tif(loca[i] < locb[i])\n\t\t{\t\n\t\t\tfor(int j=loca[i] + 1;j<locb[i];++j) if(a[j] == 'a') mx = max(mx,la[j]);\n\t\t\tfor(int j=mx + 1;j<=n;++j) dp[i][j] = dp[mx + 1][j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint R = loca[i];\n\t\t\tfor(int j=locb[i] + 1;j<R;++j) \n\t\t\tif(a[j] == 'b')\n\t\t\t{\n\t\t\t\tR = max(R,loca[lb[j]]);\n\t\t\t\tmx = lb[j]; dp[i][lb[j]] = 1;\n\t\t\t}\n\t\t\tfor(int j=mx + 1;j<=n;++j) dp[i][j] = dp[mx + 1][j];\n\t\t}\n\t\tif(get(dp[i]) < get(dp[i + 1])) memcpy(dp[i],dp[i + 1],sizeof(dp[i]));\n\t}\n\tcout<<get(dp[1])<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\nint n,dp[3010][3010],c[6020];\nint a[3010],b[3010],cnta,cntb;\nchar S[6010],S1[6010],S2[6010];\nbool check(int x){\n\tint len1=0,len2=0;\n\tfor(int i=1;i<=2*n;i++){\n\t\tif(dp[x][c[i]])S1[++len1]=S[i];\n\t\tif(dp[x+1][c[i]])S2[++len2]=S[i];\n\t}\n\tS1[++len1]=' ';\n\tS2[++len2]=' ';\n\tfor(int i=1;i<=std::max(len1,len2);i++){\n\t\tif(S1[i]>S2[i])return false;\n\t\tif(S1[i]<S2[i])return true;\n\t}\n\t\t\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",S+1);\n\tfor(int i=1;i<=2*n;i++)\n\t\tif(S[i]=='a'){\n\t\t\ta[++cnta]=i;\n\t\t\tc[i]=cnta;\n\t\t}\n\t\telse{\n\t\t\tb[++cntb]=i;\n\t\t\tc[i]=cntb;\n\t\t}\n\tdp[n][n]=1;\n\tfor(int i=n-1;i>=1;i--){\n\t\tdp[i][i]=1;\n\t\tif(a[i]<b[i]){\n\t\t\tint maxn=0;\n\t\t\tfor(int j=a[i];j<=b[i];j++)\n\t\t\t\tif(c[j]>=i)maxn=std::max(maxn,c[j]);\n\t\t\tfor(int j=b[i]+1;j<=2*n;j++)\n\t\t\t\tif(c[j]>maxn)\n\t\t\t\t\tdp[i][c[j]]=dp[maxn+1][c[j]];\t\t\t\t\n\t\t}\n\t\telse{\n\t\t\tint tot=0,maxn=0;\n\t\t\tfor(int j=b[i];j<=a[i];j++) {\n\t\t\t\tif(c[j]<i)continue;\n\t\t\t\tif(c[j]!=i)tot++;\n\t\t\t\tmaxn=std::max(maxn,c[j]);\n\t\t\t\tdp[i][c[j]]=1;\n            }\n            for(int j=a[i]+1;j<=2*n;j++){\n            \tif(S[j]=='b'){\n\t\t\t\t\tif(tot==0)dp[i][c[j]]=dp[maxn+1][c[j]];\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][c[j]]=1;\n\t\t\t\t\t\ttot++;\n\t\t\t\t\t}\n\t\t\t\t}\n            \telse{\n\t\t\t\t\tif(tot==0)dp[i][c[j]]=dp[maxn+1][c[j]];\n                    else{\n                        dp[i][c[j]] = 1;\n                        maxn=std::max(maxn,c[j]);\n                        tot--;\n                    }\n            \t}\n            }\n\t\t}\n\t\tif(check(i))\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tdp[i][j]=dp[i+1][j];\n\t}\n\tfor(int i=1;i<=2*n;i++)\n\t\tif(dp[1][c[i]])putchar(S[i]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n\treturn 0;\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 3002\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\n/*\nint dfs2(int b){\n\tif (b == n)return 0;\n\tif(mode[b]==0)dp[b] = dfs2(b + 1);  //choose nothing\n\tif (pos[b].first <= pos[b].second){\n\t\tint til = 0;\n\t\tint cnt = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (pos[j].first > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tuse[pos[j].first] = use[pos[j].second] = true;\n\t\t\ttil = j;\n\t\t\tcnt++;\n\t\t}\n\t\tif (mode[b] == 1){\n\t\t\tdfs2(til + 1);\n\t\t}\n\t}\n\tif (mode[b] == 2){\n\t\tuse[pos[b].first] = use[pos[b].second] = true;\n\t\tint maxt = max(pos[b].first, pos[b].second);\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tdfs2(j);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n*/\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (lef < a.size() || rig < b.size()){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] > s[rig])return true;\n\t\tif (s[lef] < s[rig])return false;\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2*n,0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tmode[b] = 0;\n\tif (pos[b].first <= pos[b].second){\n\t\tint til = 0;\n\t\tint cnt = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (pos[j].first > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttil = j;\n\t\t\tcnt++;\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (pos[j].first > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnex[pos[j].first] = true;\n\t\t\tnex[pos[j].second] = true;\n\t\t}\n\t\tif (cmp(nex,dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t}\n\telse{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = max(pos[b].first, pos[b].second);\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i]|k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss=dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <utility>\n#include <tuple>\n#include <cstring>\nusing namespace std;\n\nchar s[6001];\nint a[3000], b[3000];\nint mat[6000];\n\nchar dp[6001][6001];\n\nint main() {\n    int n;\n    scanf(\"%d%s\", &n, s);\n\n    for (int i = 0, ai = 0, bi = 0; i < 2 * n; i++)\n        if (s[i] == 'a')\n            a[ai++] = i;\n        else\n            b[bi++] = i;\n    for (int i = 0; i < n; i++)\n        mat[a[i]] = b[i], mat[b[i]] = a[i];\n    n *= 2;\n\n    // dp[n] = \"\"\n    for (int i = n - 1; i >= 0; i--) {\n        if (mat[i] < i) {\n            strcpy(dp[i], dp[i + 1]);\n        } else {\n            if (s[i] == 'a') {\n                dp[i][0] = 'a';\n                dp[i][1] = 'b';\n                strcpy(dp[i] + 2, dp[mat[i] + 1]);\n            } else {\n                int si = 0, ed = mat[i];\n                for (int j = i; j <= ed; j++)\n                    if (i <= mat[j]) {\n                        dp[i][si++] = s[j];\n                        ed = max(ed, mat[j]);\n                    }\n                strcpy(dp[i] + si, dp[ed + 1]);\n            }\n            if (strcmp(dp[i], dp[i + 1]) < 0)\n                strcpy(dp[i], dp[i + 1]);\n        }\n    }\n\n    puts(dp[0]);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\nvoid ok(string a, string b) {\n  if (a == b) return;\n  if (a.size() < b.size()) swap(a, b);\n  if (b == \"\") return;\n  rep(i, b.size()) if (a[i] != b[i]) return;\n  assert(false);\n}\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  int ctr = 0;\n  while (!s.empty()) {\n    while (!s.empty() && s.front() != 'a') s.erase(s.begin());\n    if (s.empty()) break;\n    s.erase(s.begin());\n    while (s.front() != 'b') s.erase(s.begin());\n    s.erase(s.begin());\n    ctr++;\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (b == num || pos_a[a] < pos_b[b]) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    //cout<<\"offset=\"<<offset<<\": \"<<o<<\"\\n\";\n    ok(m, o);\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<pair<string, int> > list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(make_pair(solve_ba(s), -i));\n    }\n  }\n  sort(all(list2), greater<pair<string, int> >());\n  for (auto p1 : list2) for (auto p2 : list2) ok(p1._1, p2._1); //\n  string out = \"\";\n  int lp = -1;\n  for (auto p : list2) {\n    int ord = -p._2;\n    if (lp < ord) {\n      out += p._1;\n      lp = ord;\n    }\n  }\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  //cout<<\"add=\"<<add<<\"\\n\";\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#ifdef WIN32\n\t#define I64 \"%I64d\"\n#else\n\t#define I64 \"%lld\"\n#endif\n\ntypedef long long ll;\n\n#define f first\n#define s second\n#define mp make_pair\n#define pb push_back\n#define all(s) s.begin(), s.end()\n#define sz(s) (int(s.size()))\n#define fname \"a\"\n#define MAXN 7777\n\nint n, k;\nchar s[MAXN];\nint pos[MAXN];\nvector <int> g[2];\nstring d[MAXN], t;\nint dp[MAXN];\n\nint main()\n{\n\t#ifdef LOCAL\n\tfreopen(fname\".in\", \"r\", stdin);\n\tfreopen(fname\".out\", \"w\", stdout);\n\t#endif\n\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s);\n\tfor (int i = 0; i < n + n; ++i) {\n\t\tpos[i] = sz(g[s[i] - 'a']);\n\t\tg[s[i] - 'a'].pb(i);\n\t}\n\n\tstring ans = \"\";\n\tfor (int i = 0, j; i < n + n; i = j, ++k) {\n\t\tint ka = 0, kb = 0;\n\t\ts[i] == 'a' ? ++ka : ++kb;\n\t\tj = i + 1;\n\t\twhile(j < n + n && ka != kb) {\n\t\t\ts[j] == 'a' ? ++ka : ++kb;\n\t\t\t++j;\n\t\t}\n\n\t\tint first = pos[i], last = pos[j - 1];\n\t\tint hasba = 0;\n\t\tfor (int z = first; z <= last; ++z) {\n\t\t\tif (g[0][z] > g[1][z])\n\t\t\t\thasba = 1;\n\t\t}\n\n\t\tif (!hasba) {\n\t\t\td[k] = \"\";\n\t\t\tint ri = -1;\n\t\t\tfor (int z = first; z <= last; ++z) {\n\t\t\t\tif (g[0][z] <= ri) continue;\n\t\t\t\tri = g[1][z];\n\t\t\t\td[k] += \"ab\";\n\t\t\t}\n\t\t} else {\n\t\t\td[k] = \"\";\t\t\t\n\t\t\tfor (int z = first; z <= last; ++z) {\n\t\t\t\tt = \"\";\n\t\t\t\tfor (int y = i; y < j; ++y) {\n\t\t\t\t\tif (pos[y] < z) continue;\n\t\t\t\t\tt += s[y];\n\t\t\t\t}\n\t\t\t\tif (lexicographical_compare(all(d[k]), all(t))) {\n\t\t\t\t\td[k] = t;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\n\t\tstring cur = d[k];\n\t\tfor (int kk = 0; kk < k; ++kk) {\n\t\t\tt = d[kk] + cur;\n\t\t\tif (lexicographical_compare(all(d[k]), all(t))) d[k] = t;\n\t\t}\n\n\t\tif (lexicographical_compare(all(ans), all(d[k]))) {\n\t\t\tans = d[k];\n\t\t}\n\t}\n\n\tputs(ans.c_str());\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n#include <cstdlib>\n#include <cmath>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <ctime>\n#include <vector>\n#include <fstream>\n#include <list>\n#include <iomanip>\n#include <numeric>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\n#define ms(s) memset(s, 0, sizeof(s))\nconst int INF = 1e9;\ninline int read(){\n\tint X = 0,w = 0 ;\n\tchar ch = 0;\n\twhile(!isdigit(ch)) {w |= ch == '-';ch = getchar();}\n\twhile(isdigit(ch)) X = (X<<3) + (X<<1) + (ch ^ 48),ch = getchar();\n\treturn w ? -X : X;\n}\nint n,p[10005],pp[10005],t[10005];\nint q[10005],head,tail;\nstring res[10005],now;\nchar s[10005];\nvector <int> a,b;\nint main()\n{\n\tcin>>n;\n\tn<<=1;\n\tscanf(\"%s\",s+1);\n\ta.clear(),b.clear();\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t\ta.push_back(i);\n\t\telse\n\t\t\tb.push_back(i);\n\t}\n\tfor (int i=1;i<=n/2;i++)\n\t{\n\t\tp[b[i-1]]=a[i-1],pp[a[i-1]]=b[i-1];\n\t}\n\tfor (int i=1;i<=n+1;i++)\n\t{\n\t\tres[i]=\"\";\n\t}\n\tint tot=0;\n\tint nxt=n+1;\n\tfor (int i=n;i>=1;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t\ttot++;\n\t\telse\n\t\t\ttot--;\n\t\tif (tot)\n\t\t\tcontinue;\n\t\tmemset(t,0,sizeof t);\n\t\thead=1,tail=0;\n\t\tres[i]=res[nxt];\n\t\tfor (int j=i;j<nxt;j++)\n\t\t{\n\t\t\tif (s[j]=='a')\n\t\t\t{\n\t\t\t\tif (t[j])\n\t\t\t\t{\n\t\t\t\t\tnow=\"\";\n\t\t\t\t\tfor (int k=i;k<nxt;k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (s[k]=='b')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (t[k]||k>j)\n\t\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (t[k]||k>p[q[tail]])\n\t\t\t\t\t\t\tnow+=\"a\";\n\t\t\t\t\t}\n\t\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\t\thead++;\n\t\t\t\t\tt[j]=t[pp[j]]=0;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (p[j]<j)\n\t\t\t\tcontinue;\n\t\t\tq[++tail]=j;\n\t\t\tt[j]=t[p[j]]=1;\n\t\t}\n\t\tmemset(t,0,sizeof t);\n\t\tif (tail==0)\n\t\t{\n\t\t\tfor (int j=i;j<nxt;j++)\n\t\t\t{\n\t\t\t\tif (s[j]=='b')\n\t\t\t\t\tcontinue;\n\t\t\t\tt[j]=t[pp[j]]=1;\n\t\t\t\tnow=\"\";\n\t\t\t\tfor (int k=i;k<=pp[j];k++)\n\t\t\t\t\tif (t[k])\n\t\t\t\t\t\tnow+=s[k];\n\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\tj=pp[j];\n\t\t\t}\n\t\t}\n\t\tnxt=i;\n\t}\n\tcout<<res[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#include <cstring>\n#include <queue>\n#include <set>\n#include <map>\n#include <functional>\n#include <string>\n#include <cmath>\n#define SIZE 6005\n\nusing namespace std;\ntypedef long long int ll;\ntypedef pair <int,int> P;\n\nstring dp[SIZE];\nchar str[SIZE];\nint pa[SIZE],pb[SIZE];\nint pos[SIZE];\nbool use[SIZE];\n\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&str);\n\tint sa=0,sb=0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(str[i]=='a')\n\t\t{\n\t\t\tpa[sa++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[sb++]=i;\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tpos[pa[i]]=pb[i];\n\t\tpos[pb[i]]=pa[i];\n\t}\n\tdp[2*n]=\"\";\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\tdp[i]=dp[i+1];\n\t\tif(i<pos[i])\n\t\t{\n\t\t\tif(str[i]=='a')\n\t\t\t{\n\t\t\t\tstring to=\"ab\";\n\t\t\t\tto+=dp[pos[i]+1];\n\t\t\t\tdp[i]=max(dp[i],to);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tint cnt=0;\n\t\t\t\tstring now=\"\";\n\t\t\t\tfor(int j=i;j<2*n;j++)\n\t\t\t\t{\n\t\t\t\t\tif(pos[j]<i) continue;\n\t\t\t\t\tif(str[j]=='a')\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]<j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"a\";\n\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]>j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(cnt==0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnow+=dp[j+1];\n\t\t\t\t\t\tdp[i]=max(dp[i],now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%s\\n\",dp[0].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>/*{{{*/\n#include<cctype>\n#include<cassert>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<ctime>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<set>\n#include<vector>\nusing namespace std;\ntypedef long long lld;\ntypedef long double lf;\ntypedef unsigned long long uld;\ntypedef pair<int,int> pii;\n#define fi first\n#define se second\n#define pb push_back\n#define mk make_pair\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define ROF(i,a,b) for(int i=(a);i>=(b);--i)\nnamespace RA{\n    int r(int p){return 1ll*rand()*rand()%p;}\n    int r(int L,int R){return r(R-L+1)+L;}\n}/*}}}*/\n/******************heading******************/\nconst int N=3050*2;\n\nint n;\nchar s[N];\nstring a[N];\nint la;\n\nbool del_a(string &s){\n    for(string::iterator it=s.begin();it!=s.end();it++){\n        if(*it=='a')return s.erase(it),1;\n    }\n    return 0;\n}\nbool del_b(string &s){\n    for(string::iterator it=s.begin();it!=s.end();it++){\n        if(*it=='b')return s.erase(it),1;\n    }\n    return 0;\n}\nstring calc(string s){\n    //cout<<\"calc \"<<s<<endl;\n    if(s[0]=='a'){\n        string res=\"\";\n        int las_b=-1;\n        int pos_a=-1,pos_b=-1;\n        while(pos_b<(int)s.size()){\n            ++pos_b;\n            while(pos_b<(int)s.size()&&s[pos_b]=='a')++pos_b;\n            ++pos_a;\n            while(pos_a<(int)s.size()&&s[pos_a]=='b')++pos_a;\n            if(pos_b==s.size())break;\n            //printf(\"%d %d\\n\",pos_a,pos_b);\n            if(pos_a>las_b)res+=\"ab\", las_b=pos_b;\n        }\n        return res;\n    }else {\n        string res=s;\n        while(s!=\"\"){\n            del_a(s);\n            del_b(s);\n            res=max(res,s);\n        }\n        //cout<<\"res=\"<<res<<endl;\n        return res;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    scanf(\"%s\",s+1);\n    int ca=0,cb=0;\n    string t=\"\";\n    FOR(i,1,n*2){\n        if(s[i]=='a')ca++;\n        else cb++;\n        t.pb(s[i]);\n        if(ca==cb)a[++la]=calc(t),t=\"\";\n    }\n    assert(t==\"\");\n    string ans=\"\";\n    ROF(i,la,1)ans=max(ans,a[i]+ans);\n    cout<<ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp = \"\"; int a = 0, b = 0;\n      FOR(j,l,r){\n        if(S[j]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  string ans;\n  RREP(i,s.size()){\n    chmax(ans,s[i]+ans);\n  }\n\n  cout << ans << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define mod 1000000007\n#define sp ' '\n#define intmax 2147483647\n#define llmax 9223372036854775807\n#define mkp make_pair\n#define lP pair<ll, ll>\n#define iP pair<int,int>\ntypedef long long ll;\nusing namespace std;\n\nstruct T {\n\tint l, r;\n\tstring s;\n};\n\nint N, r[3000], b[3000], cr, cb, R;\nstring S;\nvector<T>v;\ndeque<string>q;\n\nint main() {\n\tcin >> N >> S;\n\tfor (int i = 0; i < N * 2; ++i) {\n\t\tif (S[i] == 'a') {\n\t\t\tr[cr] = i;\n\t\t\t++cr;\n\t\t}\n\t\telse {\n\t\t\tb[cb] = i;\n\t\t\t++cb;\n\t\t}\n\t}\n\tv.push_back({ 0,0,\"\" });\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (b[i] < r[i]) {\n\t\t\tif (r[v.back().r] < b[i]) {\n\t\t\t\tv.push_back({ i,i,\"\" });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tv.back().r = i;\n\t\t\t}\n\t\t}\n\t}\n\tif (r[0] < b[0]) {\n\t\tv.erase(v.begin());\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\tvector<bool>B(N * 2, false);\n\t\tfor (int j = v[i].r; j >= v[i].l; --j) {\n\t\t\tB[b[j]] = B[r[j]] = true;\n\t\t\tstring s;\n\t\t\tfor (int k = b[j]; k <= r[v[i].r]; ++k) {\n\t\t\t\tif (B[k]) {\n\t\t\t\t\ts.push_back(S[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tv[i].s = max(v[i].s, s);\n\t\t}\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\twhile (!q.empty() && q.back() < v[i].s) {\n\t\t\tq.pop_back();\n\t\t}\n\t\tq.push_back(v[i].s);\n\t\tR = r[v[i].r] + 1;\n\t}\n\twhile (!q.empty()) {\n\t\tcout << q.front();\n\t\tq.pop_front();\n\t}\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (r[i] < b[i] && r[i] >= R) {\n\t\t\tcout << \"ab\";\n\t\t\tR = b[i];\n\t\t}\n\t}\n\tcout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "/*{{{*/\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<set>\n#include<map>\n#include<queue>\n#include<bitset>\n#include<vector>\n#include<limits.h>\n#include<assert.h>\n#define SZ(X) ((int)(X).size())\n#define ALL(X) (X).begin(), (X).end()\n#define REP(I, N) for (int I = 0; I < (N); ++I)\n#define REPP(I, A, B) for (int I = (A); I < (B); ++I)\n#define FOR(I, A, B) for (int I = (A); I <= (B); ++I)\n#define FORS(I, S) for (int I = 0; S[I]; ++I)\n#define RS(X) scanf(\"%s\", (X))\n#define SORT_UNIQUE(c) (sort(c.begin(),c.end()), c.resize(distance(c.begin(),unique(c.begin(),c.end()))))\n#define GET_POS(c,x) (lower_bound(c.begin(),c.end(),x)-c.begin())\n#define CASET int ___T; scanf(\"%d\", &___T); for(int cs=1;cs<=___T;cs++)\n#define MP make_pair\n#define PB push_back\n#define MS0(X) memset((X), 0, sizeof((X)))\n#define MS1(X) memset((X), -1, sizeof((X)))\n#define LEN(X) strlen(X)\n#define F first\n#define S second\nusing namespace std;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef long double LD;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<LL> VL;\ntypedef vector<PII> VPII;\ntypedef pair<LL,LL> PLL;\ntypedef vector<PLL> VPLL;\ntemplate<class T> void _R(T &x) { cin >> x; }\nvoid _R(int &x) { scanf(\"%d\", &x); }\nvoid _R(LL &x) { scanf(\"%lld\", &x); }\nvoid _R(double &x) { scanf(\"%lf\", &x); }\nvoid _R(char &x) { scanf(\" %c\", &x); }\nvoid _R(char *x) { scanf(\"%s\", x); }\nvoid R() {}\ntemplate<class T, class... U> void R(T &head, U &... tail) { _R(head); R(tail...); }\ntemplate<class T> void _W(const T &x) { cout << x; }\nvoid _W(const int &x) { printf(\"%d\", x); }\nvoid _W(const LL &x) { printf(\"%lld\", x); }\nvoid _W(const double &x) { printf(\"%.16f\", x); }\nvoid _W(const char &x) { putchar(x); }\nvoid _W(const char *x) { printf(\"%s\", x); }\ntemplate<class T,class U> void _W(const pair<T,U> &x) {_W(x.F); putchar(' '); _W(x.S);}\ntemplate<class T> void _W(const vector<T> &x) { for (auto i = x.begin(); i != x.end(); _W(*i++)) if (i != x.cbegin()) putchar(' '); }\nvoid W() {}\ntemplate<class T, class... U> void W(const T &head, const U &... tail) { _W(head); putchar(sizeof...(tail) ? ' ' : '\\n'); W(tail...); }\n#ifdef HOME\n #define DEBUG(...) {printf(\"# \");printf(__VA_ARGS__);puts(\"\");}\n#else\n #define DEBUG(...)\n#endif\nint MOD = 1e9+7;\nvoid ADD(LL& x,LL v){x=(x+v)%MOD;if(x<0)x+=MOD;}\n/*}}}*/\nconst int SIZE = 1e6+10;\nchar s[SIZE];\nPII d[SIZE];\nint main(){\n    int N; R(N);\n    RS(s);\n    int AA[2]={};\n    REP(i,2*N){\n        if(s[i]=='a'){\n            d[AA[0]++].F=i;\n        }\n        else{\n            d[AA[1]++].S=i;\n        }\n    }\n    bool a_start=1;\n    REP(i,N){\n        if(d[i].F>d[i].S){\n            a_start=0;\n        }\n    }\n    if(a_start){\n        VI dp(N);\n        dp[0]=1;\n        int ma=1;\n        REPP(i,1,N){\n            REP(j,i){\n                if(d[j].S<d[i].F)dp[i]=max(dp[i],dp[j]+1);\n            }\n            ma=max(ma,dp[i]);\n        }\n        REP(i,ma)printf(\"ab\");\n        W(\"\");\n    }\n    else{\n        string an=\"\";\n        REP(i,N){\n            if(d[i].S<d[i].F){\n                VI u(N*2);\n                REPP(j,i,N){\n                    if(d[j].S<d[j].F){\n                        u[d[j].S]=u[d[j].F]=1;\n                    }\n                }\n                string tmp=\"\";\n                REPP(j,d[i].S,2*N){\n                    if(u[j])tmp+=s[j];\n                }\n                an=max(an,tmp);\n            }\n        }\n        W(an);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\n\nint begin0;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin0=2*n;\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin0 && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbegin0=a[i];\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttmp=ans;\n\t\t\t\n\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t{\n\t\t\t\tif(r[j]>a[i])\n\t\t\t\t{\n\t\t\t\t\ttmp.insert(tmp.begin()+j,'a');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(j==r.size())\n\t\t\t{\n\t\t\t\ttmp.insert(tmp.end(),'a');\n\t\t\t}\n\t\t\ttmp.insert(tmp.begin(),'b');\n\t\t\t/*\n\t\t\tcout<<i<<' '<<tmp<<endl;\n\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t{\n\t\t\t\tcout<<r[j]<<' ';\n\t\t\t}\n\t\t\tcout<<\" RRRR\"<<endl;\n\t\t\t*/\n\t\t\t\n\t\t\tif(tmp>ans)\n\t\t\t{\n\t\t\t\tans=tmp;\n\t\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t\t{\n\t\t\t\t\tif(r[j]>a[i])\n\t\t\t\t\t{\n\t\t\t\t\t\tr.insert(r.begin()+j,a[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j==r.size())\n\t\t\t\t{\n\t\t\t\t\tr.insert(r.end(),a[i]);\n\t\t\t\t}\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t}\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tcout<<ans<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define debug(x) cout << #x << \" = \" << x << endl\n#define fori(i, ini, lim) for(int i = int(ini); i < int(lim); i++)\n#define ford(i, ini, lim) for(int i = int(ini); i >= int(lim); i--)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> ii;\n\nstring s;\nint n;\n\nstring optimal(int left, int right) {\n    string opt = \"\";\n    vector<int> a, b;\n    fori(i, left, right + 1) {\n        if(s[i] == 'a') {\n           a.push_back(i);\n       }\n       else {\n           b.push_back(i);\n       }\n    }\n    if(s[left] == 'a') {\n        int limit = -1;\n        fori(i, 0, a.size()) {\n            if(limit < a[i]) {\n                opt += \"ab\";\n                limit = b[i];\n            }\n        }\n    }\n    else {\n        ford(i, a.size() - 1, 0) {\n            string cur = \"\"; \n            int a_ptr = i, b_ptr = i;\n            while(a_ptr < (int) a.size() || b_ptr < (int) b.size()) {\n                if(a_ptr == (int) a.size()) {\n                    cur += \"b\";\n                    b_ptr++;\n                }\n                else if(b_ptr == (int) b.size()) {\n                    cur += \"a\";\n                    a_ptr++;\n                }\n                else if(a[a_ptr] < b[b_ptr]) {\n                    cur += \"a\";\n                    a_ptr++;\n                }\n                else {\n                    cur += \"b\";\n                    b_ptr++;\n                }\n            }\n            opt = max(opt, cur);\n        }\n    }\n    return opt;\n}\n\nint main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(0);\n    cin >> n;\n    cin >> s;\n    vector<string> optimals;\n    int sum = 0, start = 0;\n    fori(i, 0, 2 * n) {\n        sum += s[i] == 'a';\n        sum -= s[i] == 'b';\n        if(sum == 0) {\n            optimals.push_back(optimal(start, i));\n            start = i + 1;\n        }\n    }\n    string best = \"\";\n    ford(i, (int) optimals.size() - 1, 0) {\n        best = max(best, optimals[i] + best); \n    }\n    cout << best << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nstring slow(string s) {\n    vi id(s.size());\n    int ca = 0, cb = 0;\n    forn(i, 0, s.size() - 1) {\n        if (s[i] == 'a') id[i] = ca++;\n        if (s[i] == 'b') id[i] = cb++;\n    }\n    string ans;\n    forn(mask, 0, (1 << s.size()) - 1) {\n        vi cnt(s.size() / 2);\n        string cur;\n        forn(i, 0, s.size() - 1)\n            if (mask & (1 << i))\n                ++cnt[id[i]], cur.pb(s[i]);\n        bool shit = 0;\n        for (auto x : cnt)\n            if (x == 1) shit = 1;\n        if (shit) continue;\n        ans = max(ans, cur);\n    }\n    cerr << \"opt = \" << ans << \"\\n\";\n    return ans;\n}\n\nint n, a[N];\nint bal[N];\nstring str[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2)\n        bal[i] = 0, str[i] = sx[i] = \"\";\n    string given;\n    int ga = n, gb = n;\n    forn(i, 1, n * 2) {\n        char c;\n//        c = rand() % 2 + 'a';\n//        if (ga == 0) c = 'b';\n//        if (gb == 0) c = 'a';\n//        if (c == 'a') --ga;\n//        if (c == 'b') --gb;\n        cin >> c;\n        given.pb(c);\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            str[i] = cans;\n        }\n        else {\n            string cur;\n            vi pa, pb;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (!a[j]) pa.pb(j);\n                if (a[j]) pb.pb(j);\n            }\n            int prv = 0;\n            forn(i, 0, pa.size() - 1)\n                if (pa[i] > prv)\n                    cur = cur + \"ab\", prv = pb[i];\n            str[i] = cur;\n        }\n    }\n    for1(i, p.size() - 2, 0)\n        sx[i] = max(sx[i + 1], str[i]);\n    forn(i, 0, p.size() - 2)\n        if (s[i] == 1 && str[i] == sx[i])\n            ans = ans + str[i];\n    forn(i, 0, p.size() - 2)\n        if (i > lst && s[i] == -1)\n            ans = ans + str[i];\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tstring pre = \"\";\n\tfor(int i=1;i<vec.size();i++){\n\t\tfor(int j=0;j<i;j++) dp[i] = max(dp[i],dp[j]+dp[i]);\n\t\tint nxt = b[pos[vec[i]]]+1;\n\t\tstring cur = dp[i];\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\n#ifndef LOCAL\n#pragma comment(linker, \"/STACK:167772160\")\n#endif\n\nusing namespace std;\n\n#ifdef LOCAL\n\ntemplate <typename T, typename Q>\nostream& operator<<(ostream& os, pair<T, Q> p)\n{\n\treturn (os << '(' << p.first << \", \" << p.second << ')');\n}\n\nint _iterable_indent = 0;\ntemplate<class T>\nstd::ostream& print_iterable(std::ostream& os, T beg, T end)\n{\n\tif (_iterable_indent > 0)\n\t\tos << \"\\n\";\n\tfor (int i = 0; i < _iterable_indent; ++i)\n\t\tos << \"\\t\";\n\tos << \"[\";\n\tfor (auto it = beg; it != end; ++it)\n\t{\n\t\tif (it != beg)\n\t\t\tos << \", \";\n\t\t++_iterable_indent;\n\t\tos << *it;\n\t\t--_iterable_indent;\n\t}\n\tos << \"]\";\n\treturn os;\n}\n\ntemplate <class T >\nstd::ostream& operator << (std::ostream& os, const std::vector<T>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\ntemplate <class T >\nstd::ostream& operator << (std::ostream& os, const std::set<T>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\ntemplate <class T >\nstd::ostream& operator << (std::ostream& os, const std::multiset<T>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\ntemplate <class T >\nstd::ostream& operator << (std::ostream& os, const std::unordered_set<T>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\ntemplate <class T, class Q>\nstd::ostream& operator << (std::ostream& os, const std::map<T, Q>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\ntemplate <class T, class Q>\nstd::ostream& operator << (std::ostream& os, const std::unordered_map<T, Q>& v)\n{\n\treturn print_iterable(os, v.begin(), v.end());\n}\n\nvector<string> _split(const string& s, char c) {\n\tvector<string> v;\n\tstringstream ss(s);\n\tstring x;\n\tauto arr_skip = false;\n\twhile (getline(ss, x, c))\n\t{\n\t\twhile (x[0] == ' ')\n\t\t\tx = x.substr(1);\n\t\tif (arr_skip)\n\t\t{\n\t\t\tfor (auto h : x)\n\t\t\t\tif (h == ')')\n\t\t\t\t\tarr_skip = false;\n\t\t\tcontinue;\n\t\t}\n\t\tif (x.size() >= 3 && x.substr(0, 3) == \"ARR\")\n\t\t{\n\t\t\tarr_skip = true;\n\t\t\tv.emplace_back(x.substr(4));\n\t\t}\n\t\telse\n\t\t\tv.emplace_back(x);\n\t}\n\treturn v;\n}\n\nvoid _print(vector<string>::iterator) {}\ntemplate<typename T, typename... Args>\nvoid _print(vector<string>::iterator it, T a, Args... args) {\n\tstring name = it->substr((*it)[0] == ' ', it->length());\n\tif (isalpha(name[0]))\n\t\tcerr << name << \" = \" << a << endl;\n\telse\n\t\tcerr << name << endl;\n\t_print(++it, args...);\n}\n\ntemplate<class T>\nauto _kekeke(T x)\n{\n\treturn x;\n}\n\ntemplate<class T>\nauto make_vector(T arr)\n{\n\treturn arr;\n}\n\ntemplate<class T, class... Args>\nauto make_vector(T arr, int len, Args... args)\n{\n\tauto inside = make_vector(arr[0], args...);\n\tvector<decltype(_kekeke(inside))> v;\n\tfor (int i = 0; i < len; ++i)\n\t\tv.push_back(make_vector(arr[i], args...));\n\treturn v;\n}\n\n#define dbg(...) { _print(_split(#__VA_ARGS__, ',').begin(), __VA_ARGS__); }\n#define ARR(arr, ...) make_vector(arr, __VA_ARGS__)\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define dbg(...) (void)0\n#define ARR(arr, ...) (void)0\n#define eprintf(...) (void)0\n#endif\n#define mp make_pair\n#define rand govno_ebanoe\n#define dbg_time() eprintf(\"\\n\\nTime: %.3lf\\n\", double(clock()) / CLOCKS_PER_SEC)\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing uint = unsigned int;\nusing pii = pair<int, int>;\nusing pli = pair<ll, int>;\nusing pll = pair<ll, ll>;\nusing dbl = double;\n\nconst int INF = (int)1e9 + 10;\nconst ll LINF = ll(2e18) + 10;\nconst double PI = acosl(-1);\nconst double eps = 1e-8;\n\nconst int N = 6010;\nint n;\nint bs[N];\nint as[N];\nint id[N];\n\nstring solve_a(string s)\n{\n    int a = 0;\n    int b = 0;\n    for(int i = 0; i < int(s.size()); ++i)\n        if (s[i] == 'a')\n        {\n            id[i] = a;\n            as[a++] = i;\n        }\n        else\n        {\n            id[i] = b;\n            bs[b++] = i;\n        }\n    string res = \"\";\n    for(int i = 0; i < int(s.size()); ++i)\n    {\n        if (s[i] == 'b')\n            continue;\n        res.push_back('a');\n        res.push_back('b');\n        i = bs[id[i]];\n    }\n    return res;\n}\n\nstring solve_b(string s)\n{\n    vector<string> comp;\n    string best = \"\";\n    reverse(s.begin(), s.end());\n    for(int i = 1; 2 * i <= int(s.size()); ++i)\n    {\n        int cnt[2] = {};\n        string cur = \"\";\n        for(auto c : s)\n            if (cnt[c - 'a'] < i)\n            {\n                ++cnt[c - 'a'];\n                cur.push_back(c);\n            }\n        reverse(cur.begin(), cur.end());\n        if (cur > best)\n            best = cur;\n    }\n    return best;\n}\n\nstring solve(string s)\n{\n    if (s[0] == 'a')\n        return solve_a(s);\n    else\n        return solve_b(s);\n}\n\nvoid solve()\n{\n    string s1;\n    cin >> n >> s1;\n    int bal = 0;\n    vector<string> parts;\n    string cur = \"\";\n    for(int i = 0; i < 2 * n; ++i)\n    {\n        if (s1[i] == 'a')\n            ++bal;\n        else\n            --bal;\n        cur.push_back(s1[i]);\n        if (bal == 0)\n        {\n            parts.push_back(solve(cur));\n            cur = \"\";\n        }\n    }\n    dbg(parts);\n    vector<string> res;\n    while(!parts.empty() && parts.back()[0] == 'a')\n    {\n        res.push_back(parts.back());\n        parts.pop_back();\n    }\n    string last = \"ba\";\n    reverse(parts.begin(), parts.end());\n    for(auto s : parts)\n        if (s >= last)\n        {\n            res.push_back(s);\n            last = s;\n        }\n    reverse(res.begin(), res.end());\n    for(auto s : res)\n        cout << s;\n}\n\n#ifdef LOCAL\n#define ERR_CATCH\n//#define NOERR\n#endif\n\nint main()\n{\n#ifdef LOCAL\n\tfreopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n#ifdef NOERR\n\tfreopen(\"err.txt\", \"w\", stderr);\n#endif\n#else\n\t//freopen(\"sum.in\", \"r\", stdin);\n\t//freopen(\"sum.out\", \"w\", stdout);\n#endif\n\n#ifdef ERR_CATCH\n\ttry\n\t{\n#endif\n\n#ifdef ST\n\t\tios_base::sync_with_stdio(false);\n\t\twhile (true)\n\t\t\tsolve();\n#endif\n\n#ifdef CASES\n#define MULTITEST\n#endif\n\n#ifdef MULTITEST\n\t\tint t;\n\t\tscanf(\"%d\", &t);\n\t\tchar endl1[5];\n\t\tfgets(endl1, 5, stdin);\n\t\tfor (int i = 0; i < t; ++i)\n\t\t{\n#ifdef CASES\n\t\t\tprintf(\"Case #%d: \", i + 1);\n#endif\n\t\t\tsolve();\n#ifdef CASES\n\t\t\teprintf(\"Passed case #%d:\\n\", i + 1);\n#endif\n\t\t}\n#else\n\t\tsolve();\n#endif\n\n#ifdef ERR_CATCH\n\t}\n\tcatch (logic_error e)\n\t{\n\t\tdbg(e.what());\n\t\tputs(\"___________________________________________________________________________\");\n\t\texit(0);\n\t}\n#endif\n\tdbg_time();\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\n    _____\n  .'     '.\n /  0   0  \\\n|     ^     |\n|  \\     /  |\n \\  '---'  /\n  '._____.'\n*/\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\nstruct chash\n{\n\tint operator()(int x) const\n\t{\n\t\tx ^= (x >> 20) ^ (x >> 12);\n\t\treturn x ^ (x >> 7) ^ (x >> 4);\n\t}\n};\n\ntemplate<typename T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename U> using hashtable = gp_hash_table<T, U, chash>;\nrandom_device(rd);\nmt19937 rng(rd());\n\ntemplate<class T>\nvoid readi(T &x)\n{\n\tT input = 0;\n\tbool negative = false;\n\tchar c = ' ';\n\twhile (c < '-')\n\t{\n\t\tc = getchar();\n\t}\n\tif (c == '-')\n\t{\n\t\tnegative = true;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0')\n\t{\n\t\tinput = input * 10 + (c - '0');\n\t\tc = getchar();\n\t}\n\tif (negative)\n\t{\n\t\tinput = -input;\n\t}\n\tx = input;\n}\ntemplate<class T>\nvoid printi(T output)\n{\n\tif (output == 0)\n\t{\n\t\tputchar('0');\n\t\treturn;\n\t}\n\tif (output < 0)\n\t{\n\t\tputchar('-');\n\t\toutput = -output;\n\t}\n\tint aout[20];\n\tint ilen = 0;\n\twhile(output)\n\t{\n\t\taout[ilen] = ((output % 10));\n\t\toutput /= 10;\n\t\tilen++;\n\t}\n\tfor (int i = ilen - 1; i >= 0; i--)\n\t{\n\t\tputchar(aout[i] + '0');\n\t}\n\treturn;\n}\ntemplate<class T>\nvoid ckmin(T &a, T b)\n{\n\ta = min(a, b);\n}\ntemplate<class T>\nvoid ckmax(T &a, T b)\n{\n\ta = max(a, b);\n}\ntemplate<class T, class U>\nT nmod(T &x, U mod)\n{\n\tif (x >= mod) x -= mod;\n}\ntemplate<class T>\nT randomize(T mod)\n{\n\treturn (uniform_int_distribution<T>(0, mod - 1))(rng);\n}\n\n#define y0 ___y0\n#define y1 ___y1\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define PF push_front\n#define LB lower_bound\n#define UB upper_bound\n#define fi first\n#define se second\n#define debug(x) cerr << #x << \" = \" << x << endl;\n\nconst long double PI = 4.0 * atan(1.0);\nconst long double EPS = 1e-10;\n\n#define MAGIC 347\n#define SINF 10007\n#define CO 1000007\n#define INF 1000000007\n#define BIG 1000000931\n#define LARGE 1696969696967ll\n#define GIANT 2564008813937411ll\n#define LLINF 2696969696969696969ll\n#define MAXN 6013\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ld, ld> pdd;\n\nint N, K;\nint arr[MAXN], pref[MAXN];\nint blocks[MAXN];\nint partner[MAXN];\nbitset<MAXN> typ;\nvector<pii> idx[MAXN];\nvector<bool> dp[MAXN];\nvector<bool> ans;\nbitset<MAXN> flag;\n\nbool operator < (const vector<bool> &a, const vector<bool> &b)\n{\n\tfor (int i = 0; i < min(a.size(), b.size()); i++)\n\t{\n\t\tif (a[i] != b[i])\n\t\t{\n\t\t\treturn a[i] < b[i];\n\t\t}\n\t}\n\treturn (a.size() < b.size());\n}\nbool operator > (const vector<bool> &a, const vector<bool> &b)\n{\n\treturn b < a;\n}\n\nint32_t main()\n{\n\tios_base::sync_with_stdio(0);\n\t// cout << fixed << setprecision(10);\n\t// cerr << fixed << setprecision(10);\n\tfreopen (\"file.in\", \"r\", stdin);\n\tfreopen (\"file.out\", \"w\", stdout);\n\tcin >> N;\n\tN *= 2;\n\tstring temps;\n\tcin >> temps;\n\tfor (int i = 0; i < N; i++)\n\t{\n\t\tarr[i] = (temps[i] == 'a' ? 1 : -1);\n\t\tpref[i + 1] = pref[i] + arr[i];\n\t}\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tif (pref[i] == 0)\n\t\t{\n\t\t\tK++;\n\t\t\tblocks[K] = i - 1;\n\t\t}\n\t}\n\tblocks[0] = -1;\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tidx[i].resize((rt - lt + 1) / 2);\n\t\tint iter = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == 1)\n\t\t\t{\n\t\t\t\tidx[i][iter].fi = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\titer = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == -1)\n\t\t\t{\n\t\t\t\tidx[i][iter].se = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\t// cerr << \"block \" << i << endl;\n\t\tfor (pii p : idx[i])\n\t\t{\n\t\t\tpartner[p.fi] = p.se;\n\t\t\tpartner[p.se] = p.fi;\n\t\t\t// cerr << p.fi << ' ' << p.se << endl;\n\t\t}\n\t\ttyp[i] = (bool) (idx[i][0].fi > idx[i][0].se);\n\t}\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t//if typ[i] is true, it's abababababab\n\t\t//if typ[i] is false, it's babababababa\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tif (typ[i])\n\t\t{\n\t\t\t//babababa\n\t\t\tvector<bool> temp;\n\t\t\tfor (int j = idx[i].size() - 1; j >= 0; j--)\n\t\t\t{\n\t\t\t\tflag[idx[i][j].fi] = true;\n\t\t\t\tflag[idx[i][j].se] = true;\n\t\t\t\ttemp.clear();\n\t\t\t\tfor (int k = lt; k <= rt; k++)\n\t\t\t\t{\n\t\t\t\t\tif (flag[k])\n\t\t\t\t\t{\n\t\t\t\t\t\ttemp.PB(arr[k] - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (temp > dp[i])\n\t\t\t\t{\n\t\t\t\t\tdp[i] = temp;\n\t\t\t\t}\n\t\t\t\t// for (bool b : dp[i])\n\t\t\t\t// {\n\t\t\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t\t\t// }\n\t\t\t\t// cerr << endl;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//ababababab\n\t\t\tfor (int j = lt; j <= rt;)\n\t\t\t{\n\t\t\t\tdp[i].PB(0);\n\t\t\t\tdp[i].PB(1);\n\t\t\t\tj = partner[j];\n\t\t\t\tauto it = UB(idx[i].begin(), idx[i].end(), MP(j + 1, -INF));\n\t\t\t\tif (it == idx[i].end()) break;\n\t\t\t\tj = it -> fi;\n\t\t\t}\n\t\t}\n\t}\n\t// cerr << \"our dps\\n\";\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t// for (bool b : dp[i])\n\t\t// {\n\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t// }\n\t\t// cerr << endl;\n\t\tbool used = true;\n\t\tfor (int j = i + 1; j <= K; j++)\n\t\t{\n\t\t\tfor (int k = 0; k < min(dp[i].size(), dp[j].size()); k++)\n\t\t\t{\n\t\t\t\tif (dp[j][k] == 1 && dp[i][k] == 0)\n\t\t\t\t{\n\t\t\t\t\tused = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (used)\n\t\t{\n\t\t\tfor (bool b : dp[i])\n\t\t\t{\n\t\t\t\tans.PB(b);\n\t\t\t}\n\t\t}\n\t}\n\tfor (bool b : ans)\n\t{\n\t\tcout << (b ? 'b' : 'a');\n\t}\n\tcout << '\\n';\n\t// cerr << \"time elapsed = \" << (clock() / (CLOCKS_PER_SEC / 1000)) << \" ms\" << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n\n#include<bits/stdc++.h>\nusing namespace std;\n\n#define endl '\\n'\n#define lfs cout<<fixed<<setprecision(10)\n#define ALL(a)  (a).begin(),(a).end()\n#define ALLR(a)  (a).rbegin(),(a).rend()\n#define spa << \" \" <<\n#define fi first\n#define se second\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define EB emplace_back\n#define rep(i,n,m) for(ll i = (n); i < (ll)(m); i++)\n#define rrep(i,n,m) for(ll i = (ll)(m) - 1; i >= (ll)(n); i--)\nusing ll = long long;\nusing ld = long double;\nconst ll MOD1 = 1e9+7;\nconst ll MOD9 = 998244353;\nconst ll INF = 1e18;\nusing P = pair<ll, ll>;\ntemplate<typename T1, typename T2>\nbool chmin(T1 &a,T2 b){if(a>b){a=b;return true;}else return false;}\ntemplate<typename T1, typename T2>\nbool chmax(T1 &a,T2 b){if(a<b){a=b;return true;}else return false;}\nll median(ll a,ll b, ll c){return a+b+c-max({a,b,c})-min({a,b,c});}\nvoid ans1(bool x){if(x) cout<<\"Yes\"<<endl;else cout<<\"No\"<<endl;}\nvoid ans2(bool x){if(x) cout<<\"YES\"<<endl;else cout<<\"NO\"<<endl;}\nvoid ans3(bool x){if(x) cout<<\"Yay!\"<<endl;else cout<<\":(\"<<endl;}\ntemplate<typename T1,typename T2>\nvoid ans(bool x,T1 y,T2 z){if(x)cout<<y<<endl;else cout<<z<<endl;}  \ntemplate<typename T>\nvoid debug(vector<vector<T>>&v,ll h,ll w){for(ll i=0;i<h;i++)\n{cout<<v[i][0];for(ll j=1;j<w;j++)cout spa v[i][j];cout<<endl;}};\nvoid debug(vector<string>&v,ll h,ll w){for(ll i=0;i<h;i++)\n{for(ll j=0;j<w;j++)cout<<v[i][j];cout<<endl;}};\ntemplate<typename T>\nvoid debug(vector<T>&v,ll n){if(n!=0)cout<<v[0];\nfor(ll i=1;i<n;i++)cout spa v[i];cout<<endl;};\ntemplate<typename T>\nvector<vector<T>>vec(ll x, ll y, T w){\n  vector<vector<T>>v(x,vector<T>(y,w));return v;}\nll gcd(ll x,ll y){ll r;while(y!=0&&(r=x%y)!=0){x=y;y=r;}return y==0?x:y;}\nvector<ll>dx={1,-1,0,0,1,1,-1,-1};\nvector<ll>dy={0,0,1,-1,1,-1,1,-1};\ntemplate<typename T>\nvector<T> make_v(size_t a,T b){return vector<T>(a,b);}\ntemplate<typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v(ts...))>(a,make_v(ts...));\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2>&p){\n  return os << p.first << \" \" << p.second;\n}\n//mt19937 mt(chrono::steady_clock::now().time_since_epoch().count());\n\nint main(){\n  cin.tie(nullptr);\n  ios_base::sync_with_stdio(false);\n  ll res=0,buf=0;\n  bool judge = true;\n  ll n;cin>>n;\n  string s;cin>>s;\n  vector<ll>a,b,c;\n  rep(i,0,2*n){\n    if(s[i]=='a'){\n      c.PB(a.size());\n      a.PB(i);\n    }\n    else{\n      c.PB(b.size());\n      b.PB(i);\n    }\n  }\n  auto f=[&](string t){\n    ll nxt=0;\n    queue<ll>ch;\n    stack<ll>st;\n    rep(i,0,2*n){\n      if(nxt==t.size())break;\n      if(!ch.empty()&&ch.front()==i){\n        ch.pop();\n        if(s[i]==t[nxt]){\n          st.push(c[i]);\n          nxt++;\n        }\n        else{\n          ll mi=min(a[c[i]],b[c[i]]);\n          while(!st.empty()){\n            ll p=st.top();\n            if(max(a[p],b[p])>mi){\n              chmin(mi,min(a[p],b[p]));\n              nxt-=2;\n              st.pop();\n            }\n            else break;\n          }\n          nxt--;\n        }\n      }\n      else if(min(a[c[i]],b[c[i]])==i&&s[i]==t[nxt]){\n        nxt++;\n        ch.push(max(a[c[i]],b[c[i]]));\n      }\n    }\n    //cout<<t spa nxt<<endl;\n    return nxt==t.size();\n  };\n  string ret;\n  while(1){\n    if(f(ret+'b')){\n      ret+='b';\n    }\n    else if(f(ret+'a')){\n      ret+='a';\n    }\n    else break;\n  }\n  cout<<ret<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<queue>\n#include<set>\n#include<cstdio>\n#include<algorithm>\n#define LL long long\n#define mp make_pair\n#define INF 0x3f3f3f3f\n#define Inf 1000000000000000000LL\n#define F first\n#define S second\n#define all(x) (x).begin(),(x).end()\nusing namespace std;\ntypedef pair<int,int>pii;\nint n,n2;\nchar s[6010];\nint pos[6010];\nint a[3010],b[3010];\nstring dp[6010],ans;\nint main(){\n\tcin>>n;\n\tn2=2*n;\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=n2;i++)\n\t\tif(s[i]=='a')a[++a[0]]=i,pos[i]=a[0];\n\t\telse b[++b[0]]=i,pos[i]=b[0];\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint k=i;\n\t\t\tfor(int j=a[i]+1;j<b[i];j++)k=max(k,pos[j]);\n\t\t\tdp[i]=\"ab\"+dp[k+1];\n\t\t}else{\n\t\t\tint k=i;\n\t\t\twhile(k<n&&b[k+1]<a[k])k++;\n\t\t\tfor(int j=b[i];j<=n2;j++)if(i<=pos[j]&&pos[j]<=k)dp[i]+=s[j];\n\t\t\tdp[i]+=dp[k+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n; string s; cin >> n >> s; n *= 2; assert(n > 6);\n\tvector<string> v;\n\tfor(int i = 0, k = 0, p = 0; i < n; i++){\n\t\tif(s[i] == 'a') k++;\n\t\telse k--;\n\t\tif(k == 0){\n\t\t\tv.pb(s.substr(p, i + 1 - p));\n\t\t\tp = i + 1;\n\t\t}\n\t}\n\treverse(all(v));\n\t\n\tstring ans;\n\tbool b = 0;\n\t\n\tfor(string i : v){\n\t\tvi ord(i.size());\n\t\tint x = 0, y = 0;\n\t\tstring tmp;\n\t\trep(j, i.size()){\n\t\t\tif(i[j] == 'a') ord[j] = x++;\n\t\t\telse ord[j] = y++;\n\t\t}\n\t\t\n\t\tif(i[0] == 'a'){\n\t\t\tif(b) continue;\n\t\t\t\n\t\t\tint cnt = 0;\n\t\t\trep(j, i.size()){\n\t\t\t\tcnt++;\n\t\t\t\tint o = ord[j];\n\t\t\t\twhile(j < i.size() && !(i[j] == 'b' && ord[j] == o)) j++;\n\t\t\t}\n\t\t\trep(it, cnt) tmp += \"ab\";\n\t\t\tans = tmp + ans;\n\t\t}\n\t\telse{\n\t\t\tb = 1;\n\t\t\ttmp = ans;\n\t\t\trep(j, x){\n\t\t\t\tstring t;\n\t\t\t\trep(k, i.size()) if(ord[k] >= j) t += i[k];\n\t\t\t\ttmp = max(tmp, t + ans);\n\t\t\t}\n\t\t\tans = tmp;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (true || pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first,pos[b].second)){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (true || pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < min(pos[b].first, pos[b].second)){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){ \n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < min(pos[b].first, pos[b].second)){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < max(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < min(pos[b].first, pos[b].second)){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = pos[b].first;\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (pos[j].first> maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].second;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].first> maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].second;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].second > maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].first;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].second > maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 6005;\ntypedef long long ll;\ntypedef long double ld;\ntypedef unsigned long long ull;\ntemplate <typename T> void chkmax(T &x, T y) {x = max(x, y); }\ntemplate <typename T> void chkmin(T &x, T y) {x = min(x, y); } \ntemplate <typename T> void read(T &x) {\n\tx = 0; int f = 1;\n\tchar c = getchar();\n\tfor (; !isdigit(c); c = getchar()) if (c == '-') f = -f;\n\tfor (; isdigit(c); c = getchar()) x = x * 10 + c - '0';\n\tx *= f;\n}\ntemplate <typename T> void write(T x) {\n\tif (x < 0) x = -x, putchar('-');\n\tif (x > 9) write(x / 10);\n\tputchar(x % 10 + '0');\n}\ntemplate <typename T> void writeln(T x) {\n\twrite(x);\n\tputs(\"\");\n}\nchar s[MAXN];\nint n, tot, rk[MAXN];\nstring res[MAXN], dp[MAXN];\nint la, lb, a[MAXN], b[MAXN];\nint main() {\n\tread(n), scanf(\"\\n%s\", s + 1);\n\tfor (int i = 1; i <= 2 * n; i++)\n\t\tif (s[i] == 'a') a[++la] = i, rk[i] = la;\n\t\telse b[++lb] = i, rk[i] = lb;\n\tint last = 0;\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (i == n || max(a[i], b[i]) < min(a[i + 1], b[i + 1])) {\n\t\t\tif (a[i] < b[i]) {\n\t\t\t\tres[++tot] = \"\"; int Max = 0;\n\t\t\t\tfor (int j = last + 1; j <= i; j++)\n\t\t\t\t\tif (a[j] > Max) {\n\t\t\t\t\t\tres[tot] += \"ab\";\n\t\t\t\t\t\tMax = b[j];\n\t\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tres[++tot] = \"\";\n\t\t\t\tfor (int j = last + 1; j <= i; j++) {\n\t\t\t\t\tstring tmp = \"\";\n\t\t\t\t\tfor (int k = last * 2 + 1; k <= i * 2; k++)\n\t\t\t\t\t\tif (rk[k] >= j) tmp += s[k];\n\t\t\t\t\tchkmax(res[tot], tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlast = i;\n\t\t}\n\t}\n\tfor (int i = tot; i >= 1; i--)\n\t\tdp[i] = max(dp[i + 1], res[i] + dp[i + 1]);\n\tcout << dp[1] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint A[3010],B[3010];\nchar str[6010];\nstring getans(int l,int r)\n{\n\tstring ans=\"\";\n\tif(A[l]<B[l])\n\t{\n\t\tint now=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(A[i]>now){\n\t\t\t\tnow=B[i];\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t}\n\telse{\n\t\tint L=B[l],R=A[r];\n\t\tfor(int i=1;i<=r-l+1;i++)\n\t\t{\n\t\t\tint nowa=i,nowb=i;\n\t\t\tstring cur=\"\";\n\t\t\tfor(int j=R;j>=L;j--)\n\t\t\t{\n\t\t\t\tif(str[j]=='a'&&nowa>0)nowa--,cur+='a';\n\t\t\t\tif(str[j]=='b'&&nowb>0)nowb--,cur+='b';\n\t\t\t}\n\t\t\treverse(cur.begin(),cur.end());\n\t\t\tans=max(ans,cur);\n\t\t}\n\t}\n\treturn ans;\n}\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint nowa=0,nowb=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')A[++nowa]=i;\n\t\telse B[++nowb]=i;\n\tstring ans=\"\";\n\tfor(int i=n;i>=1;)\n\t{\n\t\tint j=i;\n\t\tif(A[i]<B[i])while(j>0&&A[j]<B[j])j--;\n\t\telse while(j>0&&A[j]>B[j])j--;\n\t\tstring tmp=getans(j+1,i);\n\t\tbool flag=true;\n\t\tfor(int k=0;k<min(tmp.length(),ans.length());k++)\n\t\t\tif(tmp[k]>ans[k])break;\n\t\t\telse if(tmp[k]<ans[k]){\n\t\t\t\tflag=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif(flag)ans=tmp+ans;\n\t\ti=j;\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nint n,p[N],pp[N],t[N];\nint q[N],head,tail;\nstring res[N],now;\nchar s[N];\nvector <int> a,b;\nint main(){\n    scanf(\"%d\",&n);\n    n<<=1;\n    scanf(\"%s\",s+1);\n    a.clear(),b.clear();\n    for (int i=1;i<=n;i++)\n        if (s[i]=='a')\n            a.push_back(i);\n        else\n            b.push_back(i);\n    for (int i=1;i<=n/2;i++)\n        p[b[i-1]]=a[i-1],pp[a[i-1]]=b[i-1];\n    for (int i=1;i<=n+1;i++)\n        res[i]=\"\";\n    int tot=0;\n    int nxt=n+1;\n    for (int i=n;i>=1;i--){\n        if (s[i]=='a')\n            tot++;\n        else\n            tot--;\n        if (tot)\n            continue;\n        memset(t,0,sizeof t);\n        head=1,tail=0;\n        res[i]=res[nxt];\n        for (int j=i;j<nxt;j++){\n            if (s[j]=='a'){\n                if (t[j]){\n                    now=\"\";\n                    for (int k=i;k<nxt;k++)\n                        if (s[k]=='b'){\n                            if (t[k]||k>j)\n                                now+=\"b\";\n                        }\n                        else if (t[k]||k>p[q[tail]])\n                            now+=\"a\";\n                    res[i]=max(res[i],now+res[nxt]);\n                    head++;\n                    t[j]=t[pp[j]]=0;\n                }\n                continue;\n            }\n            if (p[j]<j)\n                continue;\n            q[++tail]=j;\n            t[j]=t[p[j]]=1;\n        }\n        memset(t,0,sizeof t);\n        if (tail==0){\n            for (int j=i;j<nxt;j++){\n                if (s[j]=='b')\n                    continue;\n                t[j]=t[pp[j]]=1;\n                now=\"\";\n                for (int k=i;k<=pp[j];k++)\n                    if (t[k])\n                        now+=s[k];\n                res[i]=max(res[i],now+res[nxt]);\n                j=pp[j];\n            }\n        }\n        nxt=i;\n    }\n    cout << res[1];\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/****************************************************************\n*\tAuthor: huhao\n*\tEmail: 826538400@qq.com\n*\tCreate time: 2020-03-09 22:15:28\n****************************************************************/\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#define fr(i,a,b) for(int i=(a),end_##i=(b);i<=end_##i;i++)\n#define fd(i,a,b) for(int i=(a),end_##i=(b);i>=end_##i;i--)\nint read()\n{\n\tint r=0,t=1,c=getchar();\n\twhile(c<'0'||c>'9')\n\t{\n\t\tt=c=='-'?-1:1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tr=(r<<3)+(r<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn r*t;\n}\n#include<iostream>\n#include<string>\nconst int N=6010;\nint n,v[N],id[N][2],c[2],p[N];\nchar s[N];\nstd::string f[N];\nint main()\n{\n\tn=read()*2; scanf(\"%s\",s+1);\n\tfr(i,1,n){ s[i]-='a'; id[++c[s[i]]][s[i]]=i; }\n\tfr(i,1,n/2){ p[id[i][0]]=id[i][1]; p[id[i][1]]=id[i][0]; }\n//\tfr(i,1,n/2) printf(\"%d %d\\n\",id[i][0],id[i][1]);\n\tfd(i,n,1)\n\t{\n\t\tif(p[i]>i)\n\t\t{\n\t\t\tif(s[i]<s[p[i]]) f[i]=\"ab\"+f[p[i]+1];\n\t\t\telse\n\t\t\t{\n\t\t\t\tint j=i;\n\t\t\t\tfor(int k=i;k<=j;k++)\n\t\t\t\t\tif(s[k]){ f[i]+='b'; v[p[k]]=1; j=p[k]; }\n\t\t\t\t\telse if(v[k]) f[i]+='a';\n\t\t\t\tfr(k,i,j) v[k]=0;\n\t\t\t\tf[i]+=f[j+1];\n\t\t\t}\n\t\t}\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t}\n\tstd::cout<<f[1]<<std::endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  int N;\n  string s;\n  cin >> N;\n  cin >> s;\n\n  N *= 2;\n\n  vector<int> id(N);\n  {\n    int a = 0, b = 0;\n    for ( int i = 0; i < N; i++ ) {\n      if ( s[i] == 'a' ) id[i] = a++;\n      else id[i] = b++;      \n    }\n  }\n\n  vector<string> vs;\n  {\n    string t = \"\";\n    vector<int> idn;    \n    int sum = 0;  \n    for ( int i = 0; i < N; i++ ) {\n      sum += (s[i] == 'a' ? 1 : -1);\n      t += s[i];\n      if ( sum == 0 ) {\n\tvs.emplace_back(t);\n\tt = \"\";\n      }\n    }    \n  }\n\n  vector<string> maxs;\n  for ( string t : vs ) {\n    string u = \"\";\n    if ( t[0] == 'a' ) {\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) {\n\t  u += \"ab\";\n\t  int j = i;\t  \n\t  i++;\t  \n\t  while ( id[j] != id[i] ) i++;\t  \n\t}\n      }\n    } else {\n      string ma = \"\";\t\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) continue;\t\n\tu = \"\";\t\n\tfor ( int j = i; j < (int)t.size(); j++ ) {\n\t  if ( id[i] <= id[j] ) u += t[j];\t  \n\t}\n\tma = max(ma, u);\t\n      }\n      u = ma;\n    }\n    maxs.emplace_back(u);    \n  }\n\n  string ans = \"\";\n  for ( int i = (int)maxs.size()-1; i >= 0; i-- ) {\n    // cout << maxs[i] << endl;\n    if ( ans <= maxs[i]+ans ) ans = maxs[i]+ans;    \n  }\n\n  cout << ans << endl;\n  \n  return 0;  \n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nstring calc(string s){\n  //cout<<s<<endl;\n  string res;\n  Int n=s.size();\n  if(s[0]=='a'){\n    Int i=0,j=0;\n    while(i<n){\n      res+=\"ab\";\n      i++;\n      while(i<n){\n\tif(s[i]=='x'){\n\t  i++;\n\t  continue;\n\t}\n\tif(s[i]=='a'){\n\t  i++;\n\t  while(s[j]=='a') j++;\n\t  s[j++]='x';\n\t}else{\n\t  break;\n\t}\n      }\n    }\n  }else{\n    for(Int k=0;k<n;k++){\n      Int a=0,b=0;\n      string tmp;\n      for(Int i=0;i<n;i++){\n\tif(s[i]=='a'){\n\t  if(a>=k) tmp+=s[i];\n\t  a++;\n\t}else{\n\t  if(b>=k) tmp+=s[i];\n\t  b++;\n\t}\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nsigned main(){\n  Int n;\n  string s;\n  cin>>n>>s;\n  n*=2;\n  vector<string> v;\n  Int x[2]={1,-1};\n  for(Int i=0;i<n;){\n    Int j=i,k=x[s[j++]-'a'];\n    while(j<n&&k!=0) k+=x[s[j++]-'a'];\n    v.emplace_back(calc(s.substr(i,j-i)));\n    i=j;\n  }\n  reverse(v.begin(),v.end());\n  string ans=\"\";\n  for(string t:v)\n    chmax(ans,t+ans);\n  cout<<ans<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MAXN 6010\n\nint n,n2,m1,m2,m;\nchar s[MAXN];\nint p1[MAXN],p2[MAXN],id[MAXN];\nint s1[MAXN];\nint a[MAXN],b[MAXN];\nint h[MAXN][MAXN],len[MAXN];\nint ans[MAXN];\nbool visit[MAXN];\n\nint getS1(int l,int r){ return s1[r]-s1[l-1]; }\nint getS2(int l,int r){ return r-l+1-s1[r]+s1[l-1]; }\n\nbool cmp(int x,int y){\n\tfor(int i=1;i<=len[x] && i<=len[y];i++)\n\t\tif(h[x][i]^h[y][i]) return h[x][i]<h[y][i];\n\treturn len[x]<len[y];\n}\n\nint main(){\n#ifdef DEBUG\n\tfreopen(\"E.in\",\"r\",stdin);\n#endif\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tn2=n<<1;\n\tfor(int i=1;i<=n2;i++)\n\t\tif(s[i]=='a') p1[++m1]=i,id[i]=m1;\n\t\telse p2[++m2]=i,id[i]=m2;\n\tfor(int i=1;i<=n2;i++) s1[i]=s1[i-1]+(s[i]=='a'?1:0);\n\tfor(int i=1;i<=n;i++)\n\t\tif(p2[i]<p1[i])\n\t\t\ta[p2[i]]=getS2(p2[i],p1[i]);\n\tbool flag=0;\n\tint last=n2+1,lastp=n2+1;\n\tfor(int i=n2;i>=1;i--)\n\t\tif(getS1(i,n2)==getS2(i,n2)){\n\t\t\tif(s[i]=='b'){\n\t\t\t\tflag=1;\n\t\t\t\tlen[last]=m;\n\t\t\t\tfor(int j=1;j<=m;j++) h[last][j]=b[m-j+1];\n\t\t\t\tfor(int j=last-1;j>=i;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tfor(int k=j;k<last;k++)\n\t\t\t\t\t\t\tif(s[k]=='b')\n\t\t\t\t\t\t\t\th[j][++len[j]]=a[k];\n\t\t\t\t\t\tfor(int k=m;k>=1;k--)\n\t\t\t\t\t\t\th[j][++len[j]]=b[k];\n\t\t\t\t\t}\n\t\t\t\tint res=last;\n\t\t\t\tfor(int j=i;j<last;j++)\n\t\t\t\t\tif(s[j]=='b' && cmp(res,j))\n\t\t\t\t\t\tres=j;\n\t\t\t\tfor(int j=last-1;j>=res;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tb[++m]=a[j];\n\t\t\t\t\t\tans[m]=id[j];\n\t\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(!flag) lastp=i;\n\t\t\t}\n\t\t\tlast=i;\n\t\t}\n\tfor(int i=1;i<=m;i++) visit[p1[ans[i]]]=visit[p2[ans[i]]]=1;\n\tfor(int i=1;i<=n2;i++) if(visit[i]) putchar(s[i]);\n\tint j=lastp-1;\n\tfor(int i=lastp;i<=n2;i++)\n\t\tif(s[i]=='a' && i>j){\n\t\t\tputchar('a'); putchar('b');\n\t\t\tj=p2[id[i]];\n\t\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nstring mx=\"\",a,ret,cmp;\nconst int Q=1<<16;\nint cc[Q],pa[Q],pb[Q],to[Q];\nint owo[Q];\nint Time=0;\nvoid Deal(int l,int r)\n{\n\tret=\"\";\n\tif(a[l]=='a'){\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(a[i]=='a')ret+=\"ab\",i=to[i];\n\t\treturn;\n\t}\n\tfor(int i=(r-l+1)>>1;i;--i){\n\t\tint use=0;\n\t\t++Time;\n\t\tfor(int j=r;j>=l&&use<i;--j)\n\t\t\tif(a[j]=='b')owo[j]=owo[to[j]]=Time,++use;\n\t\tcmp=\"\";\n\t\tfor(int j=l;j<=r;j++)\n\t\t\tif(owo[j]==Time)cmp+=a[j];\n\t\tret=max(ret,cmp);\n\t}\n}\nint main()\n{\n\tint n;\n\tcin>>n>>a;\n\ta=\"*\"+a;\n\tfor(int i=1,ca=0,cb=0;i<=(n<<1);i++){\n\t\tcc[i]=cc[i-1]+(a[i]=='a'?1:-1);\n\t\tif(a[i]=='a')pa[++ca]=i;\n\t\telse pb[++cb]=i;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tto[pa[i]]=pb[i],to[pb[i]]=pa[i];\n\tfor(int i=(n<<1)-1,lst=n<<1;i>=0;--i)\n\t\tif(cc[i]==0){\n\t\t\tDeal(i+1,lst),lst=i;\n\t\t\tmx=max(mx,ret+mx);\n\t\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#define PB push_back\n#define MP make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long LL;\nconst int N=7000 +10;\n\nstring f[N];\nchar s[N];\nint  tk[N], od[N], a[N], b[N],n;\nvoid DP1();\nvoid DP2();\n\nint main(){\n\t#ifdef che \n\tfreopen(\"input.txt\",\"rt\",stdin);\n\t#endif\n\tscanf(\"%d%s\", &n, s);\n\tint an=0, bn= 0;\n\tfor (int i=0; i<2*n; ++i)\n\t\tif ( s[i]=='a' ){\n\t\t\tod[i] = an;a[an++] = i;\n\t\t}else{\n\t\t\tod[i] = bn;b[bn++] = i;\n\t\t}\n\t#ifdef che\n\tfor (int i=0; i<2*n; ++i) debug(\"od[%d] = %d\\n\", i, od[i]);\n\tfor (int i=0; i<n; ++i) debug(\"a[%d]= %d\\tb[%d]=%d\\n\", i, a[i], i, b[i]);\n\t#endif\n\tbool flag= false;\n\tfor (int i=0; i<n ; ++i)\n\t\tif ( b[i] < a[i]) flag= true;\n\tif ( !flag) DP1();\n\t\telse DP2();\n\treturn 0;\n}\n\nvoid DP1(){\n\tfor  (int i=0; i<2*n; ++i )  f[i]=\"\";\n\tfor (int i=2*n-1; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='a')\n\t\t\tf[i]= max( \"ab\"+f[b[od[i]]+1],f[i]);\n\t}\n\tcout<<f[0]<<endl;\n}\nvoid DP2(){\n\tfor (int i=2*n-1; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='b'){\n\t\t\tstring t=\"\";\n\t\t\tfor (int j=0; j<=n; ++j) tk[j] = false;\n\t\t\tint ri=  a[od[i]];\n\t\t\tfor (int j=i;j<=ri; ++j){\n\t\t\t\tif ( s[j]=='b') tk[ od[j]]= true, ri= a[od[j]];\n\t\t\t\tif ( tk[od[j]]) t+=s[j];\n\t\t\t}\n\t\t\tif ( t.size()) f[i] = max(f[i], t+f[ri+1]);\n\t\t}\n\t}\n\tcout<<f[0]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \n// Shortcut\n \n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n \n// I/O & Debug\n \n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n \n// Functions\n \n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n \n// Data Structure\n \n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n \nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n \nint n;\nint a[2 * N];\nstring s, ans = \"\";\nvs b, c;\n \nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.assign(b.size(), \"\");\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans, c[i]);\n    }\n    cout << ans;\n}\n \n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n \n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n \n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nint n;\nchar s[6003];\nstd::string parts[3003];\nint main()\n{\n\tscanf(\"%d %s\",&n,s);\n\tint i = 0, j = 0;\n\twhile(i < 2 * n) {\n\t\tstd::string max;\n\t\tint sum = 0;\n\t\tint type = s[i] - 'a';\n\t\tstd::vector<int> va, vb;\n\t\tdo {\n\t\t\tif(s[i] == 'a') {\n\t\t\t\t++sum;\n\t\t\t\tva.push_back(i);\n\t\t\t} else {\n\t\t\t\t--sum;\n\t\t\t\tvb.push_back(i);\n\t\t\t}\n\t\t\t++i;\n\t\t} while(sum != 0);\n\t\tif(type == 0) {\n\t\t\twhile(!va.empty()) {\n\t\t\t\tassert(va[0] < vb[0]);\n\t\t\t\tmax += \"ab\";\n\t\t\t\tint j = vb[0];\n\t\t\t\twhile(!va.empty() && va[0] < j) {\n\t\t\t\t\tva.erase(va.begin());\n\t\t\t\t\tvb.erase(vb.begin());\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint s = va.size();\n\t\t\tfor(int k = 0;k < s;++k) {\n\t\t\t\tstd::string cur;\n\t\t\t\tint a = k, b = k;\n\t\t\t\twhile(a < s || b < s) {\n\t\t\t\t\tif(b == s || (a != s && va[a] < vb[b])) {\n\t\t\t\t\t\tcur.push_back('a');\n\t\t\t\t\t\t++a;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcur.push_back('b');\n\t\t\t\t\t\t++b;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(cur > max) max = cur;\n\t\t\t}\n\t\t}\n\t\tparts[j++] = max;\n\t}\n\tstd::string max, ans;\n\tfor(int k = j-1;k >= 0;--k) {\n\t\tif(parts[k] >= max) {\n\t\t\tmax = parts[k];\n\t\t}\n\t\tif(parts[k] + max >= max) {\n\t\t\tans = parts[k] + ans;\n\t\t}\n\t}\n\tprintf(\"%s\\n\", ans.c_str());\n\t\t\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<queue>\n#include<set>\n#include<cstdio>\n#include<algorithm>\n#define LL long long\n#define mp make_pair\n#define INF 0x3f3f3f3f\n#define Inf 1000000000000000000LL\n#define F first\n#define S second\n#define all(x) (x).begin(),(x).end()\nusing namespace std;\ntypedef pair<int,int>pii;\nint n,n2;\nchar s[6010];\nint pos[6010];\nint a[3010],b[3010];\nstring dp[6010],ans;\nint main(){\n\tcin>>n;\n\tn2=2*n;\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=n2;i++)\n\t\tif(s[i]=='a')a[++a[0]]=i,pos[i]=a[0];\n\t\telse b[++b[0]]=i,pos[i]=b[0];\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint k=i;\n\t\t\tfor(int j=a[i]+1;j<b[i];j++)k=max(k,pos[j]);\n\t\t\tdp[i]=\"ab\"+dp[k+1];\n\t\t}else{\n\t\t\tint k=i;\n\t\t\twhile(k<n&&b[k+1]<a[k])k++;\n\t\t\tfor(int j=b[i];j<=n2;j++)if(i<=pos[j]&&pos[j]<=k)dp[i]+=s[j];\n\t\t\tdp[i]+=dp[k+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nint n,m,ans[6011],b[6011],c[6011],cnt[2],w[3011][2],f[6011];\nchar s[6011];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tm=n*2;\n\tscanf(\"%s\",s+1);\n\tcnt[0]=cnt[1]=0;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tcnt[s[i]-'a']++;\n\t\tw[cnt[s[i]-'a']][s[i]-'a']=i;\n\t}\n\tfor(int i=1;i<=m;i++)ans[i]=-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)c[j]=b[j]=-1;\n\t\tb[w[i][1]]=1;\n\t\tb[w[i][0]]=0;\n\t\tint nw=i;\n\t\tfor(int j=i+1;j<=n;j++)if(w[j][1]<w[j][0])\n\t\t{\n\t\t\tb[w[j][1]]=1;\n\t\t\tb[w[j][0]]=0;\n\t\t\tnw=j;\n\t\t}\n\t\tint pre=w[nw][1];\n\t\tfor(int j=nw+1;j<=n;j++)if(w[j][0]>pre)\n\t\t{\n\t\t\tpre=w[j][1];\n\t\t\tb[w[j][1]]=1;\n\t\t\tb[w[j][0]]=0;\n\t\t}\n\t\tint tot=0;\n\t\tfor(int j=1;j<=m;j++)if(b[j]>=0)\n\t\t{\n\t\t\ttot++;\n\t\t\tc[tot]=b[j];\n\t\t}\n\t\tbool p=true;\n\t\tfor(int j=1;j<=m;j++)if(ans[j]<c[j])break;\n\t\telse\n\t\t{\n\t\t\tif(ans[j]>c[j])\n\t\t\t{\n\t\t\t\tp=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(p)for(int j=1;j<=m;j++)ans[j]=c[j];\n\t}\n\tfor(int i=1;i<=m;i++)if(ans[i]>=0)printf(\"%c\",ans[i]+'a');\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,match[6060],slen[6060],nlen;\nchar s[6060],suf[6060][6060],now[6060];\nbool used[6060];\nbool cmp(char a[],char b[],int lena,int lenb)\n{\n\tfor(int i=1;i<=lena&&i<=lenb;++i)\n\t\tif(a[i]!=b[i])return a[i]>b[i];\n\treturn lena>lenb;\n}\nint main()\n{\n\tscanf(\"%d %s\",&n,s+1);\n\tint t1=1,t2=1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\twhile(s[t1]!='a')++t1;\n\t\twhile(s[t2]!='b')++t2;\n\t\tmatch[t1]=t2,match[t2]=t1;\n\t\t++t1,++t2;\n\t}\n\tfor(int i=2*n;i;--i)\n\t{\n\t\tmemcpy(suf[i]+1,suf[i+1]+1,slen[i]=slen[i+1]);\n\t\tif(i<match[i])\n\t\t{\n\t\t\tif(s[i]=='a')\n\t\t\t{\n\t\t\t\tmemcpy(now+3,suf[match[i]+1]+1,slen[match[i]+1]);nlen=slen[match[i]+1]+2;\n\t\t\t\tnow[1]='a',now[2]='b';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tint r=match[i];\n\t\t\t\tmemset(used,0,sizeof(used));used[i]=used[match[i]]=1;\n\t\t\t\tfor(int j=i+1;j<=r;++j)\n\t\t\t\t\tif(s[j]=='b'&&j<match[j])used[j]=used[match[j]]=1,r=match[j];\n\t\t\t\tnlen=0;\n\t\t\t\tfor(int j=i;j<=r;++j)if(used[j])now[++nlen]=s[j];\n\t\t\t\tmemcpy(now+nlen+1,suf[r+1]+1,slen[r+1]);nlen+=slen[r+1];\n\t\t\t}\n\t\t//\tprintf(\"%d:\\n\",i);\n\t\t//\tfor(int j=1;j<=nlen;++j)putchar(now[j]);putchar('\\n');\n\t\t\tif(cmp(now,suf[i],nlen,slen[i]))memcpy(suf[i]+1,now+1,slen[i]=nlen);\n\t\t}\n\t//\tfor(int j=1;j<=slen[i];++j)putchar(suf[i][j]);putchar('\\n');\n\t}\n\tfor(int i=1;i<=slen[1];++i)putchar(suf[1][i]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\nvoid ok(string a, string b) {\n  if (a == b) return;\n  if (a.size() < b.size()) swap(a, b);\n  if (b == \"\") return;\n  rep(i, b.size()) if (a[i] != b[i]) return;\n  assert(false);\n}\nvoid ok2(string s) {\n  int a = 0, b = 0;\n  rep(i, (int)s.size()-1) {\n    if (s[i] == 'a') a++;\n    else b++;\n    assert(a != b);\n  }\n}\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  int ctr = 0;\n  while (!s.empty()) {\n    while (!s.empty() && s.front() != 'a') s.erase(s.begin());\n    if (s.empty()) break;\n    s.erase(s.begin());\n    while (s.front() != 'b') s.erase(s.begin());\n    s.erase(s.begin());\n    ctr++;\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (a < num && (b == num || pos_a[a] < pos_b[b])) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    //cout<<\"offset=\"<<offset<<\": \"<<o<<\"\\n\";\n    ok2(o);\n    ok(m, o);\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<pair<string, int> > list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(make_pair(solve_ba(s), -i));\n    }\n  }\n  sort(all(list2), greater<pair<string, int> >());\n  for (auto p1 : list2) for (auto p2 : list2) ok(p1._1, p2._1); //\n  string out = \"\";\n  int lp = -1;\n  for (auto p : list2) {\n    int ord = -p._2;\n    if (lp < ord) {\n      out += p._1;\n      lp = ord;\n    }\n  }\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  //cout<<\"add=\"<<add<<\"\\n\";\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define mp make_pair\n#define pbk push_back\n#define ph push\n#define ptc putchar\n#define enter putchar('\\n')\n#define mod 998244353\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef double db;\ntypedef long double ldb;\ntypedef long long ll;\ntypedef long long lnt;\ninline int read(){\n\tint x = 0;char c = getchar();\n\twhile (!isdigit(c)) c = getchar();\n\twhile (isdigit(c)) x = (x << 1) + (x << 3) + c - '0' , c = getchar();\n\treturn x;\n}\ninline void write(int x){\n\tif (!x){\n       ptc('0');\n       return;\n\t}\n\tint dg[20] , len = 0;\n\twhile (x) dg[len++] = x % 10 , x /= 10;\n\twhile (len--) ptc(dg[len]+'0');\n}\ninline void writeln(int x){\n\twrite(x);\n\tptc('\\n');\n}\ninline int add(int x,int y){\n\tx += y;if (x >= mod) x -= mod;\n\treturn x;\n}\ninline int sub(int x,int y){\n\tx -= y;if (x < 0) x += mod;\n\treturn x;\n}\ninline int qpow(int x,int y){\n\tint res = 1;\n\twhile (y){\n\t\tif (y & 1) res = 1ll * res * x % mod;\n\t\tx = 1ll * x * x % mod;y >>= 1;\n\t}\n\treturn res;\n}\n\nconst int N = 6e3 + 10;\nint n , pa[N] , pb[N] , ca , cb , pos[N];\nchar s[N];\nint sg;\nbool visit[N];\nstring SegMax[N] , f[N];\n \nint main(){\n\tscanf(\"%d\",&n);\t\n\tscanf(\"%s\",s + 1);\n\tn <<= 1;\n\tfor (int i = 1;i <= n;i++){\n\t\tif (s[i] == 'a'){\n\t\t\tpa[++ca] = i;\n\t\t\tpos[i] = ca;\n\t\t}else{\n\t\t\tpb[++cb] = i;\n\t\t\tpos[i] = cb;\n\t\t}\n\t}\n\t\n\tfor (int i = 1;i <= n;i++){\n\t\t\n\t\tint j = i , sum = s[i] == 'a' ? 1 : -1;\n\t\twhile (sum != 0){\n\t\t\tj++;\n\t\t\tsum += s[j] == 'a' ? 1 : -1;\n\t\t}\n//\t\tprintf(\"(%d %d)\\n\",i,j);\n\t\t\n\t\tif (s[i] == 'a'){\n\t\t\t++sg;\n\t\t\tfor (int k = i;k <= j;k++){\n\t\t\t\tif (s[k] == 'b') continue;\n\t\t\t\tvisit[k] = visit[pb[pos[k]]] = 1;\n\t\t\t\tk = pb[pos[k]];\n\t\t\t}\n\t\t\tfor (int k = i;k <= j;k++){\n\t\t\t\tif (visit[k]) SegMax[sg].pbk(s[k]);\n\t\t\t}\n\t\t}else{\n\t\t\t++sg;\n\t\t\tstring tmp;\n\t\t\tint L = pos[i] , R = pos[j];\n\t\t\t\n//\t\t\tprintf(\"(%d %d)\\n\",L,R);\n\t\t\tfor (int k = R;k >= L;k--){//k , L\n\t\t\t\ttmp.clear();\n\t\t\t\tfor (int _k = i;_k <= j;_k++) if (pos[_k] >= k) tmp.pbk(s[_k]);\n//\t\t\t\tcout<<tmp<<endl;\n\t\t\t\tSegMax[sg] = max(SegMax[sg] , tmp);\n\t\t\t}\n\t\t}\n//\t\tprintf(\"[%d %d]\\n\",i,j);\n//\t\tcout<<SegMax[sg]<<endl;\n\t\ti = j;\n\t}\n\t\n\tfor (int i = sg;i >= 1;i--){\n\t\tf[i] = max(f[i + 1] , SegMax[i] + f[i + 1]);\n\t}\n\t\n\tcout<<f[1]<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<string>\nusing namespace std;\nchar p[6010];\nint n;\nstruct point {\n\tint a, b;\n}w[3010];\nint A[6010], Num[6010], cA, cB;\nstring D[6010];\nchar q[6010];\nint main() {\n\tint i, j;\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", p + 1);\n\tfor (i = 1; i <= n+n; i++) {\n\t\tif (p[i] == 'a')w[++cA].a = i;\n\t\tif (p[i] == 'b')w[++cB].b = i;\n\t}\n\tfor (i = 1; i <= n; i++) {\n\t\tNum[w[i].a] = Num[w[i].b] = i;\n\t}\n\tfor (i = n+n - 1; i >= 1; i--) {\n\t\tint pv = Num[i];\n\t\tD[i] = D[i + 1];\n\t\tif (p[i] == 'a') {\n\t\t\tif (w[pv].b < w[pv].a)continue;\n\t\t\tif (!D[i + 1].size() || D[i + 1][0] == 'a') {\n\t\t\t\tD[i] = max(D[i], \"ab\" + D[w[pv].b + 1]);\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\telse {\n\t\t\tif (w[pv].a < w[pv].b)continue;\n\t\t\tint c = 0;\n\t\t\tfor (j = pv+1; j <= n; j++) {\n\t\t\t\tif (min(w[j].a,w[j].b) > max(w[j-1].a,w[j-1].b))break;\n\t\t\t}\n\t\t\tint ed = j - 1, last = 0;\n\t\t\tfor (j = i; j <= n + n; j++) {\n\t\t\t\tif (Num[j] >= pv && Num[j] <= ed) q[c++] = p[j], last = j;\n\t\t\t}\n\t\t\tq[c] = 0;\n\t\t\tD[i] = max(D[i], q + D[last + 1]);\n\t\t}\n\t}\n\tprintf(\"%s\\n\", D[1].c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num){\n\t\tv[i]=bs(i);\n\t\trep(j,v[i]) v.pb(0);\n\t}\n\tint p=ok();\n\tassert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint n,sa[3010],sb[3010],ta=0,tb=0,pos[6010];\nchar s[6010];\nstring f[3010];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++)\n\t{\n\t\tif(s[i]=='a') sa[++ta]=i,pos[i]=ta;\n\t\telse sb[++tb]=i,pos[i]=tb;\n\t}\n\tstring ans;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(sa[i]<sb[i])\n\t\t{\n\t\t\tint k=i;\n\t\t\tfor(int j=sa[i]+1;j<sb[i];j++) k=min(k,pos[j]);\n\t\t\tf[i]=\"ab\"+f[k+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile(k<n&&sb[k+1]<sa[k]) k++;\n\t\t\tfor(int j=sb[i];j<=2*n;j++) if(pos[j]>=i&&pos[j]<=k) f[i]+=s[j];\n\t\t\tf[i]+=f[k+1];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%s\",ans.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3050;\nint f[N][N],a[N],b[N],c[N],na,nb,n;\nchar s[N*2];\nstring func(int *g){\n  string ans=\"\";\n  for (int i=1; i<=2*n; ++i)\n    if (g[c[i]])\n      ans+=s[i];\n  return ans;\n}\nint main(){\n  cin>>n;\n  scanf(\"%s\",s+1);\n  for (int i=1; i<=2*n; ++i)\n    if (s[i]=='a')\n      a[++na]=i,c[i]=na;\n    else\n      b[++nb]=i,c[i]=nb;\n  f[n][n]=1;\n  for (int i=n-1; i>=1; --i){\n    f[i][i]=1;\n    int mx=0;\n    if (a[i]<b[i]){\n      for (int j=a[i]; j<=b[i]; ++j)\n\tmx=max(mx,c[j]);\n      for (int j=mx+1; j<=n; ++j)\n\tf[i][j]=f[mx+1][j];\n    }\n    else{\n      int tot=0;\n      for (int j=b[i]; j<=a[i]; ++j){\n\tif (c[j]<i) continue;\n\tif (c[j]!=i) ++tot;\n\tmx=max(mx,c[j]),f[i][c[j]]=1;\n      }\n      for (int j=a[i]+1; j<=2*n; ++j)\n\tif (s[j]=='b'){\n\t  if (tot==0)\n\t    f[i][c[j]]=f[mx+1][c[j]];\n\t  else\n\t    f[i][c[j]]=1,++tot;\n\t}\n\telse{\n\t  if (tot==0)\n\t    f[i][c[j]]=f[mx+1][c[j]];\n\t  else\n\t    f[i][c[j]]=1,mx=max(mx,c[j]),--tot;\n\t}\n    }\n    if (func(f[i])<func(f[i+1]))\n      memcpy(f[i],f[i+1],sizeof f[i]);\n  }\n  cout<<func(f[1]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<tuple>\n#include<algorithm>\nusing namespace std;\n#define ran 6200\nint n,m;string s;\nvector<int> A, B;\ntuple<int, int, bool> a[ran];\npair<string, int> c[ran];\nvector<string> dp[ran];\nbool g[ran];\nvoid upd(vector<string>&A,const vector<string>&B) {\n\tstring a = \"\", b = \"\";\n\tfor (auto c : A)a += c;\n\tfor (auto c : B)b += c;\n\tif (a < b)A = B;\n}\nint main() {\n\tcin >> n >> s;\n\tm = s.length();\n\tfor (int i = 0; i < m; i++) {\n\t\tif (s[i] == 'a')A.push_back(i);else\n\t\t\tB.push_back(i);\n\t\tc[i].second = -1;\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tif (A[i] < B[i])\n\t\t\ta[i] = make_tuple(A[i], B[i], false);\n\t\telse\n\t\t\ta[i] = make_tuple(B[i], A[i], true);\n\t}\n\tsort(a, a + n);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (!get<2>(a[i])) {\n\t\t\tc[get<0>(a[i])] = make_pair(\"ab\", get<1>(a[i]) + 1);\n\t\t}\n\t\telse {\n\t\t\tmemset(g, 0, sizeof(g));\n\t\t\tint L = get<0>(a[i]), R = get<1>(a[i]);\n\t\t\tfor (int j = 0; j < n; j++){\n\t\t\t\tint x = get<0>(a[j]), y = get<1>(a[j]);\n\t\t\t\tif (x >= L && x <= R && get<2>(a[j])) {\n\t\t\t\t\tR = max(R, y);\n\t\t\t\t\tg[x] = g[y] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring cur = \"\";L = R = -1;\n\t\t\tfor (int j = 0; j < m; j++)if (g[j]) {\n\t\t\t\tif (L == -1)L = j;\n\t\t\t\tR = j;\n\t\t\t\tcur += s[j];\n\t\t\t}\n\t\t\tc[L] = make_pair(cur, R + 1);\n\t\t}\n\t}\n\tdp[0].clear();\n\tfor (int i = 0; i < m; i++){\n\t\tauto vs = dp[i];\n\t\tupd(dp[i + 1], dp[i]);\n\t\tif (c[i].second != -1) {\n\t\t\twhile (vs.size() > 0 && vs.back() < c[i].first)\n\t\t\t\tvs.pop_back();\n\t\t\tvs.push_back(c[i].first);\n\t\t\tupd(dp[c[i].second], vs);\n\t\t}\n\t}\n\tstring out = \"\";\n\tfor (auto it : dp[m])\n\t\tout += it;\n\tputs(out.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint N;\nchar sir[6009];\nbool valid[6009];\n\nstring takeString (vector < int > p)\n{\n    string curr;\n    for (auto i : p)\n        curr.push_back (sir[i]);\n    return curr;\n}\n\nvoid updateAns (vector < int > &ans, vector < int > potentialAns)\n{\n    if (takeString (potentialAns) > takeString (ans))\n        ans = potentialAns;\n}\n\nvector < int > solve ()\n{\n    vector < int > posA, posB;\n    int bg = -1, bg2 = -1;\n    for (int i=1; i<=2 * N; i++)\n        if (valid[i] == 1)\n        {\n            bg = i;\n            break;\n        }\n    if (bg == -1) return {};\n    posA.push_back (bg);\n    for (int i=bg + 1; i<=2 * N; i++)\n        if (valid[i])\n        {\n            if (sir[i] == sir[bg]) posA.push_back (i);\n            else\n            {\n                bg2 = i, posB.push_back (i);\n                break;\n            }\n        }\n    for (int i=bg2 + 1; i<=2 * N; i++)\n        if (valid[i])\n        {\n            if (posB.size () == posA.size ()) break;\n            if (sir[i] != sir[bg]) posB.push_back (i);\n        }\n    for (auto i : posA)\n        valid[i] = 0;\n    for (auto i : posB)\n        valid[i] = 0;\n    if (sir[bg] == 'b')\n        reverse (posA.begin (), posA.end ()),\n        reverse (posB.begin (), posB.end ());\n    vector < int > curr = solve (), ans = curr;\n    for (int i=0; i<posA.size (); i++)\n    {\n        curr.push_back (posA[i]), curr.push_back (posB[i]);\n        sort (curr.begin (), curr.end ());\n        updateAns (ans, curr);\n    }\n    return ans;\n}\n\nint main ()\n{\n//freopen (\"input\", \"r\", stdin);\n//freopen (\"output\", \"w\", stdout);\n\nscanf (\"%d\\n\", &N);\nscanf (\"%s\", sir + 1);\nfor (int i=1; i<=2 * N; i++)\n    valid[i] = 1;\nprintf (\"%s\\n\", takeString (solve ()).c_str ());\nreturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using gpp_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename L> using gpp_map = tree<T, L, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T> using gpp_multiset = tree<T, null_type, less_equal<T>, rb_tree_tag, tree_order_statistics_node_update>;*/\nstruct fast_ios { fast_ios(){ cin.tie(0); ios::sync_with_stdio(false); cout << fixed << setprecision(20); }; } fast_ios_;\n#define FOR(i, begin, end) for(int i=(begin);i<(end);i++)\n#define REP(i, n) FOR(i,0,n)\n#define IFOR(i, begin, end) for(int i=(end)-1;i>=(begin);i--)\n#define IREP(i, n) IFOR(i,0,n)\n#define Sort(v) sort(v.begin(), v.end())\n#define Reverse(v) reverse(v.begin(), v.end())\n#define all(v) v.begin(),v.end()\n#define SZ(v) ((int)v.size())\n#define Lower_bound(v, x) distance(v.begin(), lower_bound(v.begin(), v.end(), x))\n#define Upper_bound(v, x) distance(v.begin(), upper_bound(v.begin(), v.end(), x))\n#define Max(a, b) a = max(a, b)\n#define Min(a, b) a = min(a, b)\n#define bit(n) (1LL<<(n))\n#define bit_exist(x, n) ((x >> n) & 1)\n#define debug(x) cout << #x << \"=\" << x << endl;\n#define vdebug(v) cout << #v << \"=\" << endl; REP(i_debug, v.size()){ cout << v[i_debug] << \",\"; } cout << endl;\n#define mdebug(m) cout << #m << \"=\" << endl; REP(i_debug, m.size()){ REP(j_debug, m[i_debug].size()){ cout << m[i_debug][j_debug] << \",\"; } cout << endl;}\n#define pb push_back\n#define f first\n#define s second\n#define int long long\n#define INF 1000000000000000000\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v){ for (auto &x : v) is >> x; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &v){ for(int i = 0; i < v.size(); i++) { cout << v[i]; if(i != v.size() - 1) cout << endl; }; return os; }\ntemplate<typename T> void Out(T x) { cout << x << endl; }\ntemplate<typename T1, typename T2> void Ans(bool f, T1 y, T2 n) { if(f) Out(y); else Out(n); }\n\nusing vec = vector<int>;\nusing mat = vector<vec>;\nusing Pii = pair<int, int>;\nusing PiP = pair<int, Pii>;\nusing PPi = pair<Pii, int>;\nusing bools = vector<bool>;\nusing pairs = vector<Pii>;\n\n//int dx[4] = {1,0,-1,0};\n//int dy[4] = {0,1,0,-1};\n//char d[4] = {'D','R','U','L'};\n\nconst int mod = 1000000007;\n//const int mod = 998244353;\n//#define Add(x, y) x = (x + (y)) % mod\n//#define Mult(x, y) x = (x * (y)) % mod\n\nvoid add_a(string &S, int i0, int i1, vector<string> &v){\n    char t = 'a';\n    string x = \"\";\n    FOR(i, i0, i1 + 1){\n        if(S[i] == t){\n            if(t == 'a') t = 'b';\n            else{\n                x += \"ab\";\n                t = 'a';\n            }\n        }\n    }\n    if(SZ(v) > 0 && v.back()[0] == 'a') v.back() += x;\n    else v.pb(x);\n}\n\nvoid add_b(string &S, int i0, int i1, vector<string> &v){\n    string x = \"\";\n    int now = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        Max(x, string(now, 'b') + S.substr(i + 1, i1 - i));\n    }\n    v.pb(x);\n}\n\nsigned main(){\n\n    int N; cin >> N;\n    string S; cin >> S;\n\n    vector<string> v;\n    int now = 0, i0 = 0;\n    REP(i, 2 * N){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        if(now == 0){\n            if(S[i0] == 'a') add_a(S, i0, i, v);\n            else add_b(S, i0, i, v);\n            i0 = i + 1;\n        }\n    }\n    assert(now == 0);\n    //vdebug(v);\n\n    vector<string> ans;\n    for(string x: v){\n        while(SZ(ans) > 0 && ans.back() < x) ans.pop_back();\n        ans.pb(x);\n    }\n    for(string x: ans) cout << x;\n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <cassert>\n#include <random>\n#include <iomanip>\n#define FOR(i, n, m) for(ll i = n; i < (int)m; i++)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll, ll>;\nconstexpr ll inf = 1000000000;\nconstexpr ll mod = 1000000007;\nconstexpr long double eps = 1e-15;\n \ntemplate<typename T1, typename T2>\nostream& operator<<(ostream& os, pair<T1, T2> p) {\n    os << to_string(p.first) << \" \" << to_string(p.second);\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& v) {\n    REP(i, v.size()) {\n        if(i) os << \" \";\n        os << to_string(v[i]);\n    }\n    return os;\n}\n \nstruct modint {\n    ll n;\npublic:\n    modint(const ll n = 0) : n((n % mod + mod) % mod) {}\n    static modint pow(modint a, int m) {\n        modint r = 1;\n        while(m > 0) {\n            if(m & 1) { r *= a; }\n            a = (a * a); m /= 2;\n        }\n        return r;\n    }\n    modint &operator++() { *this += 1; return *this; }\n    modint &operator--() { *this -= 1; return *this; }\n    modint operator++(int) { modint ret = *this; *this += 1; return ret; }\n    modint operator--(int) { modint ret = *this; *this -= 1; return ret; }\n    modint operator~() const { return (this -> pow(n, mod - 2)); } // inverse\n    friend bool operator==(const modint& lhs, const modint& rhs) {\n        return lhs.n == rhs.n;\n    }\n    friend bool operator<(const modint& lhs, const modint& rhs) {\n        return lhs.n < rhs.n;\n    }\n    friend bool operator>(const modint& lhs, const modint& rhs) {\n        return lhs.n > rhs.n;\n    }\n    friend modint &operator+=(modint& lhs, const modint& rhs) {\n        lhs.n += rhs.n;\n        if (lhs.n >= mod) lhs.n -= mod;\n        return lhs;\n    }\n    friend modint &operator-=(modint& lhs, const modint& rhs) {\n        lhs.n -= rhs.n;\n        if (lhs.n < 0) lhs.n += mod;\n        return lhs;\n    }\n    friend modint &operator*=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * rhs.n) % mod;\n        return lhs;\n    }\n    friend modint &operator/=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * (~rhs).n) % mod;\n        return lhs;\n    }\n    friend modint operator+(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n + rhs.n);\n    }\n    friend modint operator-(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n - rhs.n);\n    }\n    friend modint operator*(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * rhs.n);\n    }\n    friend modint operator/(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * (~rhs).n);\n    }\n};\nistream& operator>>(istream& is, modint m) { is >> m.n; return is; }\nostream& operator<<(ostream& os, modint m) { os << m.n; return os; }\n \n#define MAX_N 3030303\nlong long extgcd(long long a, long long b, long long& x, long long& y) {\n    long long d = a;\n    if (b != 0) {\n        d = extgcd(b, a % b, y, x);\n        y -= (a / b) * x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nlong long mod_inverse(long long a, long long m) {\n    long long x, y;\n    if(extgcd(a, m, x, y) == 1) return (m + x % m) % m;\n    else return -1;\n}\nvector<long long> fact(MAX_N+1, inf);\nlong long mod_fact(long long n, long long& e) {\n    if(fact[0] == inf) {\n        fact[0]=1;\n        if(MAX_N != 0) fact[1]=1;\n        for(ll i = 2; i <= MAX_N; ++i) {\n            fact[i] = (fact[i-1] * i) % mod;\n        }\n    }\n    e = 0;\n    if(n == 0) return 1;\n    long long res = mod_fact(n / mod, e);\n    e += n / mod;\n    if((n / mod) % 2 != 0) return (res * (mod - fact[n % mod])) % mod;\n    return (res * fact[n % mod]) % mod;\n}\n// return nCk\nlong long mod_comb(long long n, long long k) {\n    if(n < 0 || k < 0 || n < k) return 0;\n    long long e1, e2, e3;\n    long long a1 = mod_fact(n, e1), a2 = mod_fact(k, e2), a3 = mod_fact(n - k, e3);\n    if(e1 > e2 + e3) return 0;\n    return (a1 * mod_inverse((a2 * a3) % mod, mod)) % mod;\n}\n \nusing mi = modint;\n \nmi mod_pow(mi a, ll n) {\n    mi ret = 1;\n    mi tmp = a;\n    while(n > 0) {\n        if(n % 2) ret *= tmp;\n        tmp = tmp * tmp;\n        n /= 2;\n    }\n    return ret;\n}\n \nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n \nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<pair<int, int>> idx(n);\n    vector<int> v(2 * n, -1);\n    int ca = 0, cb = 0;\n    REP(i, 2 * n) {\n        if(s[i] == 'a') {\n            idx[ca].first = i;\n            v[i] = ca;\n            ca++;\n        } else {\n            idx[cb].second = i;\n            v[i] = cb;\n            cb++;\n        }\n    }\n    vector<string> mx(n, \"\");\n    for(int i = n - 1; i >= 0; i--) {\n        if(idx[i].first < idx[i].second) {\n            mx[i] = \"ab\";\n            int tmp = i;\n            for(int j = idx[i].first + 1; j < idx[i].second; j++) if(s[j] == 'a') tmp++;\n            if(tmp + 1 < n) mx[i] += mx[tmp + 1];\n        } else {\n            int tmp = i;\n            for(int j = idx[i].second; j < 2 * n; j++) {\n                if(s[j] == 'b') {\n                    mx[i] += 'b';\n                    tmp = v[j];\n                } else {\n                    if(v[j] < i) continue;\n                    if(v[j] > tmp) {\n                        mx[i] += mx[v[j]];\n                        break;\n                    } else mx[i] += 'a';\n                }\n            }\n        }\n        if(i < n - 1) mx[i] = max(mx[i], mx[i + 1]);\n    }\n    string ans = mx[0];\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\n#include<cmath>\n#include<queue>\n#include<vector>\n#include<ctime>\n#include<map>\n#include<bitset>\n#include<set>\n#include<assert.h>\n#define LL long long\n#define mp(x,y) make_pair(x,y)\n#define pll pair<long long,long long>\n#define pii pair<int,int>\n#define SZ(x) ((int)x.size())\nusing namespace std;\ninline LL read()\n{\n\tLL f=1,x=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint stack[20];\ntemplate<typename T>inline void write(T x)\n{\n\tif(x<0){putchar('-');x=-x;}\n    if(!x){putchar('0');return;}\n    int top=0;\n    while(x)stack[++top]=x%10,x/=10;\n    while(top)putchar(stack[top--]+'0');\n}\ntemplate<typename T>inline void pr1(T x){write(x);putchar(' ');}\ntemplate<typename T>inline void pr2(T x){write(x);putchar('\\n');}\ntemplate<typename T>inline void chkmin(T &x,T y){x=x<y?x:y;}\ntemplate<typename T>inline void chkmax(T &x,T y){x=x>y?x:y;}\nconst int MAXN=3005;\nchar ch[2*MAXN];int n;\nvector<char> ans[MAXN];int id;\nvector<char> temp,N;\nint id1[2*MAXN],id2[2*MAXN],p1[2*MAXN],p2[2*MAXN];\nvoid insert_a(int l,int r)\n{\n\tfor(int i=l,mx=0;i<=r;i++)if(ch[i]=='a'&&i>mx)\n\t{\n\t\tans[id].emplace_back('a');ans[id].emplace_back('b');\n\t\tmx=p2[id1[i]];\n\t}\n}\nvector<char> check(vector<char> A,vector<char> B)\n{\n\tint l1=SZ(A),l2=SZ(B),lm=min(l1,l2);\n\tfor(int i=0;i<lm;i++)\n\t{\n\t\tif(A[i]-'a'<B[i]-'a')return B;\n\t\tif(A[i]-'a'>B[i]-'a')return A;\n\t}return l1>l2?A:B;\n}\nvoid insert_b(int l,int r)\n{\n\tfor(int i=l;i<=r;i++)ans[id].emplace_back(ch[i]);\n\tfor(int i=l+1;i<=r;i++)if(ch[i]=='b')\n\t{\n\t\ttemp.clear();\n\t\tfor(int j=i;j<=r;j++)if(id1[j]>=id2[i]||id2[j]>=id2[i])\n\t\t\ttemp.emplace_back(ch[j]);\n\t\tans[id]=check(ans[id],temp);\n\t}\n}\nvoid solve(int l,int r)\n{\n\t++id;\n\tif(ch[l]=='a')insert_a(l,r);\n\telse insert_b(l,r);\n}\nint main()\n{\n\tn=read();scanf(\"%s\",ch+1);\n\tfor(int i=1,c1=0,c2=0;i<=2*n;i++)\n\t{\n\t\tif(ch[i]=='a')id1[i]=++c1,p1[c1]=i;\n\t\telse id2[i]=++c2,p2[c2]=i;\n\t}int cnt=0;\n\tfor(int i=1,nxt;i<=2*n;i=nxt+1)\n\t{\n\t\tnxt=i;int cnt=(ch[i]=='a'?1:-1);\n\t\twhile(nxt+1<=2*n&&cnt)\n\t\t{\n\t\t\t++nxt;\n\t\t\tcnt+=(ch[nxt]=='a'?1:-1);\n\t\t}\n\t\tsolve(i,nxt);\n\t}temp.clear();\n\ttemp=ans[id];\n\tfor(int i=id-1;i>=1;i--)\n\t{\n\t\tN.clear();\n\t\tfor(auto p:ans[i])N.emplace_back(p);\n\t\tfor(auto p:temp)N.emplace_back(p);\n\t\ttemp=check(temp,N);\n\t\ttemp=check(temp,ans[i]);\t\n\t}\n\tfor(auto p:temp)putchar(p);puts(\"\");\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\t\n\tint lenx=strlen(x+1),leny=strlen(y+1),ans=0; \n\tbool flag=1;\n\tfor (int i=3;i<=lenx;i++)\n\t\tif (x[i]!=x[i-2]) { flag=0; break; }\n\tfor (int i=3;i<=leny;i++)\n\t\tif (y[i]!=y[i-2]) { flag=0; break; }\n\tif (flag)\n\t{\n\t\tfor (int i=1;i<=2;i++)\n\t\t\tif (x[1]!=y[1]&&x[2]!=y[2]) return 2;\n\t}\n\t\n\tint len=max(lenx,leny);\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return ans^1;\n\t\telse if (x[i]<y[i]) return ans;\n\treturn 2;\n}\n\nint compare(char *x,char *y,int len)\n{\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t],len)==1)\n\t\t\t{\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=NULL;\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n20\nba ab bbabaa bbbabbabbabbaaaaaa aabb aabababb\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 3010;\n\nstring mx;\nint n, last;\nint vis[maxn<<1];\nchar str[maxn<<1];\nvector<string> ans;\nint sum;\n\nvoid solve1(int l, int r) {\n\tstring res;\n\tint cur_a = l, cur_b = l;\n\tint cnt_a = 0, cnt_b = 0;\n\tint lastp = l-1;\n\tfor (int i = 1; i <= (r-l+1)/2; i++) {\n\t\twhile (cnt_a < i) {\n\t\t\tif (str[cur_a] == 'a') ++ cnt_a;\n\t\t\t++ cur_a;\n\t\t}\n\t\twhile (cnt_b < i) {\n\t\t\tif (str[cur_b] == 'b') ++ cnt_b;\n\t\t\t++ cur_b;\n\t\t}\n\t\tif (cur_a - 1 > lastp) {\n\t\t\tlastp = cur_b - 1;\n\t\t\tres.push_back('a');\n\t\t\tres.push_back('b');\n\t\t}\n\t}\n\tif (res >= mx) {\n\t\tmx = res;\n\t\tans.push_back(mx);\n\t}\n}\n\nvoid solve2(int l, int r) {\n\tstring t_mx;\n\tint cnt_a = 0, cnt_b = 0;\n\tint cur_a = r, cur_b = r;\n\tfor (int i = 1; i <= (r-l+1)/2; i++) {\n\t\twhile (cnt_a < i) {\n\t\t\tif (str[cur_a] == 'a') {\n\t\t\t\tvis[cur_a] = 1;\n\t\t\t\t++ cnt_a;\n\t\t\t}\n\t\t\t-- cur_a;\n\t\t}\n\t\twhile (cnt_b < i) {\n\t\t\tif (str[cur_b] == 'b') {\n\t\t\t\tvis[cur_b] = 1;\n\t\t\t\t++ cnt_b;\n\t\t\t}\n\t\t\t-- cur_b;\n\t\t}\n\t\tstring tmp;\n\t\tfor (int j = l; j <= r; j++) if (vis[j]) tmp.push_back(str[j]);\n\t\tt_mx = max(t_mx, tmp);\n\t}\n\tif (t_mx >= mx) {\n\t\tmx = t_mx;\n\t\tans.push_back(mx);\n\t}\n}\n\nvoid solve(int l, int r) {\n\tif (str[l] == 'a') solve1(l, r);\n\telse solve2(l, r);\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", str+1);\n\tlast = 2*n;\n\tfor (int i = 2*n; i >= 1; i--) {\n\t\tif (str[i] == 'a') ++ sum;\n\t\tif (str[i] == 'b') -- sum;\n\t\tif (sum == 0) {\n\t\t\tsolve(i, last);\n\t\t\tlast = i-1;\n\t\t}\n\t}\n\treverse(ans.begin(), ans.end());\n\tfor (int i = 0; i < ans.size(); i++) printf(\"%s\", ans[i].c_str());\t\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n\treturn 0;\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <math.h>\n#include <string.h>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <set>\n#include <list>\n#include <bitset>\n\nusing namespace std;\n\n#define fi first\n#define se second\n#define long long long\ntypedef pair<int,int> ii;\ntypedef pair<int,ii> iii;\n\nint A[5003], B[5003];\nstring dp[5003];\nvector<string> vec, opt;\n\nint main()\n{\n\tios_base::sync_with_stdio(); cin.tie(0); cout.tie(0);\n\t// freopen(\"input.in\", \"r\", stdin);\n\t\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tint cnt1 = 0, cnt2 = 0;\n\tstring temp = \"\";\n\tfor(int i = 0; i < s.size(); i++)\n\t{\n\t\ttemp += s[i];\n\t\tcnt1 += (s[i] == 'a');\n\t\tcnt2 += (s[i] == 'b');\n\t\tif(cnt1 == cnt2)\n\t\t{\n\t\t\tvec.push_back(temp);\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\ttemp = \"\";\n\t\t}\n\t}\n\tfor(string t : vec)\n\t{\n\t\t// cout << \"T : \" << t << \"\\n\"; fflush(stdout);\n\t\tstring temp = \"\";\t\n\t\tif(t[0] == 'a')\n\t\t{\n\t\t\tmemset(A, 0, sizeof A);\n\t\t\tmemset(B, 0, sizeof B);\n\t\t\tcnt1 = cnt2 = 1;\n\t\t\tfor(int i = 0; i < t.size(); i++)\n\t\t\t{\n\t\t\t\tif(t[i] == 'a') A[cnt1++] = i;\n\t\t\t\tif(t[i] == 'b') B[cnt2++] = i;\n\t\t\t}\n\t\t\tint ri = -1;\n\t\t\tfor(int i = 1; i < cnt1; i++)\n\t\t\t{\n\t\t\t\t// cout << A[i] << \" \" << B[i] << \" \" << ri << \"\\n\";\n\t\t\t\tif(A[i] > ri)\n\t\t\t\t{\n\t\t\t\t\ttemp += \"ab\";\n\t\t\t\t\tri = B[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttemp = \"\";\n\t\t\tstring now = \"\";\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\tfor(int i = t.size()-1; i >= 0; i--)\n\t\t\t{\n\t\t\t\tnow += t[i];\n\t\t\t\tcnt1 += (t[i] == 'a');\n\t\t\t\tcnt2 += (t[i] == 'b');\n\t\t\t\tstring temp2 = now;\n\t\t\t\tint cnt3 = cnt2;\n\t\t\t\tint j = i;\n\t\t\t\twhile(cnt3 != cnt1)\n\t\t\t\t{\n\t\t\t\t\tj--;\n\t\t\t\t\tif(t[j] == 'a') continue;\n\t\t\t\t\ttemp2 += 'b';\n\t\t\t\t\tcnt3++;\n\t\t\t\t}\n\t\t\t\treverse(temp2.begin(), temp2.end());\n\t\t\t\ttemp = max(temp,temp2);\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t}\n\tstring ans = \"\";\n\tfor(int i = 0; i < opt.size(); i++)\n\t{\n\t\tdp[i] = opt[i];\n\t\tans = max(dp[i], ans);\n\t\tfor(int j = 0; j < i; j++)\n\t\t{\n\t\t\tdp[i] = max(dp[i], dp[j]+opt[i]);\n\t\t\tans = max(dp[i], ans);\n\t\t}\n\t}\n\tcout << ans << \"\\n\";\n}\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nconst int MAX_N = 6e3 + 5;\n\nint n;\nint arr [MAX_N];\nint idx [MAX_N];\nint pos [MAX_N][2];\nint incl [MAX_N];\n\nvector<int> get_cur () {\n  vector<int> ans;\n  for (int i = 0; i < n; i++) {\n    if (incl[i]) {\n      ans.push_back(arr[i]);\n    }\n  }\n  return ans;\n}\n\nint main () {\n  ios::sync_with_stdio(false);\n  \n  cin >> n;\n  n *= 2;\n\n  string s;\n  cin >> s;\n\n  int ac = 0, bc = 0;\n  for (int i = 0; i < n; i++) {\n    if (s[i] == 'a') {\n      arr[i] = 0;\n      idx[i] = ac;\n      pos[ac][0] = i;\n      ac++;\n    } else {\n      arr[i] = 1;\n      idx[i] = bc;\n      pos[bc][1] = i;\n      bc++;\n    }\n  }\n\n  vector<int> cur;\n  for (int i = n; i >= 0; i--) {\n    int id = idx[i];\n    if (i == min(pos[id][0], pos[id][1])) {\n      // try including\n      incl[pos[id][0]] = 1;\n      incl[pos[id][1]] = 1;\n\n      vector<int> nxt = get_cur();\n      if (nxt > cur) {\n        cur = nxt;\n      } else {\n        incl[pos[id][0]] = 0;\n        incl[pos[id][1]] = 0;\n      }\n    }\n  }\n\n  for (int u : cur) {\n    cout << (char) ('a' + u);\n  }\n  cout << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nbool bo[6010];\nint n,p[6010],tA[3010],tB[3010],tnA,tnB,len,la,fn[6010],gn[6010],po[6010];\nchar s[6010],f[6010][6010],g[6010][6010];\n\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1),tnA=tnB=0;\n\tfor (int i=1; i<=2*n; i++)\n\t\tif (s[i]=='a') tA[++tnA]=i; else tB[++tnB]=i;\n\tbool Bo=1;\n\tfor (int i=1; i<=n; i++) p[tA[i]]=tB[i],p[tB[i]]=tA[i],Bo&=(tA[i]<tB[i]);\n\tif (Bo)\n\t{\n\t\tlen=la=0;\n\t\tfor (int i=1; i<=n; i++) \n\t\t{\n\t\t\tint mi=2*n+1;\n\t\t\tfor (int j=la+1; j<=2*n; j++)\n\t\t\t\tif (s[j]=='a'&&p[j]<mi) mi=p[j];\n\t\t\tif (mi==2*n+1) break;\n\t\t\tla=mi,len++;\n\t\t}\n\t\tfor (int i=1; i<=len; i++) putchar('a'),putchar('b');\n\t\treturn puts(\"\"),0;\n\t}\n\tfor (int i=1; i<=2*n; i++) if (s[i]=='b'&&p[i]>i)\n\t{\n\t\tint P=p[i];\n\t\tbo[i]=bo[p[i]]=1;\n\t\tfor (int j=i+1; j<=P; j++)\n\t\t\tif (s[j]=='b'&&p[j]>j) P=max(P,p[j]),bo[j]=bo[p[j]]=1;\n\t\tpo[i]=P;\n\t\tfor (int j=1; j<=2*n; j++) if (bo[j]) g[i][++gn[i]]=s[j],bo[j]=0;\n\t}\n\tfn[2*n+1]=0;\n\tfor (int i=2*n; i; i--) \n\t\tif (s[i]=='b'&&p[i]>i)\n\t\t{\n\t\t\tfn[i]=gn[i]+fn[po[i]+1];\n\t\t\tfor (int j=1; j<=gn[i]; j++) f[i][j]=g[i][j];\n\t\t\tfor (int j=1; j<=fn[po[i]+1]; j++) f[i][j+gn[i]]=f[po[i]+1][j];\n\t\t\tbool bo=0;\n\t\t\tfor (int j=1; j<=fn[i]&&j<=fn[i+1]; j++)\n\t\t\t\tif (f[i][j]!=f[i+1][j])\n\t\t\t\t{\n\t\t\t\t\tbo=1;\n\t\t\t\t\tif (f[i][j]<f[i+1][j]) \n\t\t\t\t\t{\n\t\t\t\t\t\tfn[i]=fn[i+1];\n\t\t\t\t\t\tfor (int j=1; j<=fn[i]; j++) f[i][j]=f[i+1][j];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tif (!bo&&fn[i]<fn[i+1])\n\t\t\t{\n\t\t\t\tfn[i]=fn[i+1];\n\t\t\t\tfor (int j=1; j<=fn[i]; j++) f[i][j]=f[i+1][j];\n\t\t\t}\n\t\t} else \n\t\t{\n\t\t\tfn[i]=fn[i+1];\n\t\t\tfor (int j=1; j<=fn[i]; j++) f[i][j]=f[i+1][j];\n\t\t}\n\tfor (int i=1; i<=fn[1]; i++) putchar(f[1][i]);\n\treturn puts(\"\"),0;\n} "
  },
  {
    "language": "C++",
    "code": "\n// Problem : E - Synchronized Subsequence\n// Contest : AtCoder - AtCoder Grand Contest 026\n// URL : https://atcoder.jp/contests/agc026/tasks/agc026_e\n// Memory Limit : 1024 MB\n// Time Limit : 2000 ms\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\n\n//Code written by IMALYD\n//LK AK IOI Orz\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<int,ll > pil;\ntypedef pair<ll ,int> pli;\ntypedef pair<ll ,ll > pll;\n#define rep(i,l,r) for(i=(l);i<=(r);++i)\n#define per(i,l,r) for(i=(l);i>=(r);--i)\n#define REP(i,l,r) for(i=(l);i< (r);++i)\n#define PER(i,l,r) for(i=(l);i> (r);--i)\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define pob pop_back\n#define pof pop_front\n#define fi first\n#define se second\n#define it iterator\ntemplate<class IT>inline void cmx(IT &a,IT b){if(a<b)a=b;}\ntemplate<class IT>inline void cmn(IT &a,IT b){if(b<a)a=b;}\ntemplate<class IT>inline bool bmx(IT &a,IT b){if(a<b){a=b;return true;}else return false;}\ntemplate<class IT>inline bool bmn(IT &a,IT b){if(b<a){a=b;return true;}else return false;}\nconst int N=6005;\nchar S[N],T[N];\ninline void ac(){\n\tint n,i,j,c=0,a,b,k;string s,t,u;\n\tscanf(\"%d%s\",&n,S+1);\n\tfor(i=n<<1;i;i=j-1){\n\t\tfor(j=i;;--j)if(!((S[j]=='a')?(++c):(--c)))break;\n\t\t//printf(\"j=%d i=%d\\n\",j,i);\n\t\tt=\"\";\n\t\tif(S[j]=='a'){\n\t\t\ta=b=j;\n\t\t\tdo{\n\t\t\t\twhile(S[a]=='b'&&a<=i)++a;if(a>i)break;\n\t\t\t\twhile(S[b]=='a'      )++b;\n\t\t\t\t//printf(\"a=%d b=%d\\n\",a,b);\n\t\t\t\tt+=\"ab\";\n\t\t\t\ta=++b;\n\t\t\t}while(true);\n\t\t}else{\n\t\t\ta=b=i;\n\t\t\tdo{\n\t\t\t\twhile(S[a]=='b'&&a>=j)--a;if(a<j)break;\n\t\t\t\twhile(S[b]=='a'      )--b;\n\t\t\t\tT[a]='a';\n\t\t\t\tT[b]='b';\n\t\t\t\tu=\"\";\n\t\t\t\trep(k,j,i)if(T[k])u+=T[k];\n\t\t\t\tcmx(t,u);\n\t\t\t\t--a;--b;\n\t\t\t}while(true);\n\t\t}\n\t\tcmx(s,t+s);\n\t}\n\tcout<<s;\n}\nint main(){\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"a.out\",\"w\",stdout);\n\t\n\tac();\n\treturn 0;\n}\n#undef rep\n#undef per\n#undef REP\n#undef PER\n#undef mp\n#undef pb\n#undef pf\n#undef pob\n#undef pof\n#undef fi\n#undef se\n#undef it"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <set>\n#include <map>\n#include <list>\n#include <time.h>\n#include <math.h>\n#include <random>\n#include <deque>\n#include <queue>\n#include <cassert>\n#include <unordered_map>\n#include <unordered_set>\n#include <iomanip>\n#include <bitset>\n#include <sstream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nmt19937 rnd(228);\n\nconst int N = 6000 + 7;\n\nstring dp[N][N][2];\nint type[N];\n\nint main()\n{\n#ifdef ONPC\n    freopen(\"a.in\", \"r\", stdin);\n#endif\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n    int n;\n    cin >> n;\n    n *= 2;\n    string s;\n    cin >> s;\n    vector <int> l, r;\n    for (int i = 0; i < n; i++)\n    {\n        if (s[i] == 'a') l.push_back(i);\n        else r.push_back(i);\n    }\n    vector <bool> open(n);\n    vector <int> par(n);\n    for (int i = 0; i < n / 2; i++)\n    {\n        par[min(l[i], r[i])] = max(l[i], r[i]);\n        open[min(l[i], r[i])] = 1;\n    }\n    vector <bool> grab(n);\n    for (int it = 0; it < n; it++)\n    {\n        string t = \"\";\n        for (int i = 0; i < n; i++)\n        {\n            if (grab[i])\n            {\n                t += s[i];\n            }\n        }\n        int pos = -1;\n        for (int i = n - 1; i >= 0; i--)\n        {\n            if (open[i] && !grab[i])\n            {\n                grab[i] = grab[par[i]] = 1;\n                string q = \"\";\n                for (int j = 0; j < n; j++)\n                {\n                    if (grab[i])\n                    {\n                        q += s[j];\n                    }\n                }\n                if (q > t)\n                {\n                    t = q;\n                    pos = i;\n                }\n                grab[i] = grab[par[i]] = 0;\n            }\n        }\n        if (pos != -1)\n        {\n            grab[pos] = grab[par[pos]] = 1;\n        }\n    }\n    string t = \"\";\n    for (int i = 0; i < n; i++)\n    {\n        if (grab[i])\n        {\n            t += s[i];\n        }\n    }\n    cout << t << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n//string ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tvector<string>vs;\n\tfor(int i=0;i<vec.size();i++){\n\t\tstring str = dp[vec[i]];\n\t\tif(i == vec.size()-1){\n\t\t    assert(vec[i] == pos.size()-1);\n\t\t\tint nxt = a[pos[vec[i]]]+1;\n\t\t\twhile(nxt<2*n){\n\t\t\t\tint p = POSL(a,nxt);\n\t\t\t\tif(p == a.size()) break;\n\t\t\t\tassert(a[p]<b[p]);\n\t\t\t\tstr.pb('a'); str.pb('b');\n\t\t\t\tnxt = b[p]+1;\n\t\t\t}\n\t\t}\n\t\tvs.pb(str);\n\t}\n\treverse(vs.begin(),vs.end());\n\tstring ans = \"\",c = \"\";\n\tfor(int i=0;i<vs.size();i++){\n\t\tc = vs[i]+c;\n\t\tans=max(ans,c);\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#include <cstring>\n#include <queue>\n#include <set>\n#include <map>\n#include <functional>\n#include <string>\n#include <cmath>\n#define SIZE 6005\n\nusing namespace std;\ntypedef long long int ll;\ntypedef pair <int,int> P;\n\nstring dp[SIZE];\nchar str[SIZE];\nint pa[SIZE],pb[SIZE];\nint pos[SIZE];\nbool use[SIZE];\n\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&str);\n\tint sa=0,sb=0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(str[i]=='a')\n\t\t{\n\t\t\tpa[sa++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[sb++]=i;\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tpos[pa[i]]=pb[i];\n\t\tpos[pb[i]]=pa[i];\n\t}\n\tdp[2*n]=\"\";\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\tdp[i]=dp[i+1];\n\t\tif(i<pos[i])\n\t\t{\n\t\t\tif(str[i]=='a')\n\t\t\t{\n\t\t\t\tstring to=\"ab\";\n\t\t\t\tto+=dp[pos[i]+1];\n\t\t\t\tdp[i]=max(dp[i],to);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tint cnt=0;\n\t\t\t\tstring now=\"\";\n\t\t\t\tfor(int j=i;j<2*n;j++)\n\t\t\t\t{\n\t\t\t\t\tif(pos[j]<i) continue;\n\t\t\t\t\tif(str[j]=='a')\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]<j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"a\";\n\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif(pos[j]>j)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(cnt==0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnow+=dp[j+1];\n\t\t\t\t\t\tdp[i]=max(dp[i],now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%s\\n\",dp[0].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n// {{{ Definitions\n#define reg register\n#define pr std::pair<int, int>\n#define fi first\n#define se second\n#define FIN(s) freopen(s, \"r\", stdin)\n#define FOUT(s) freopen(s, \"w\", stdout)\n#define FERR(s) freopen(s, \"w\", stderr)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define dputs(s) fprintf(stderr, s\"\\n\")\n#define rep(i, l, r) for (int i = l; i <= r; ++i)\n#define lep(i, l, r) for (int i = l; i < r; ++i)\n#define irep(i, r, l) for (int i = r; i >= l; --i)\n#define ilep(i, r, l) for (int i = r; i > l; --i)\n#define Rep(i, n) rep(i, 1, n)\n#define Lep(i, n) lep(i, 1, n)\n#define IRep(i, n) irep(i, n, 1)\n#define ILep(i, n) ilep(i, n, 1)\ntypedef long long ll;\ntypedef long double ld;\n// }}}\n// {{{ Modular\nnamespace modular {\n    const int MOD = 1000000007;\n    inline int add(int x, int y) { return (x += y) >= MOD ? x -= MOD : x; }\n    inline void inc(int &x, int y) { (x += y) >= MOD ? x -= MOD : 0; }\n    inline int mul(int x, int y) { return 1LL * x * y % MOD; }\n    inline int qpow(int x, int y) {\n        int ans = 1;\n        for (; y; y >>= 1, x = mul(x, x))\n            if (y & 1)\n                ans = mul(ans, x);\n        return ans;\n    }\n}; // namespace modular\n// }}}\n// {{{ Base\nnamespace Base {\n    template <typename Tp> inline Tp input() {\n        Tp x = 0, y = 1;\n        char c = getchar();\n        while ((c < '0' || '9' < c) && c != EOF) {\n            if (c == '-')\n                y = -1;\n            c = getchar();\n        }\n        if (c == EOF)\n            return 0;\n        while ('0' <= c && c <= '9')\n            x = x * 10 + c - '0', c = getchar();\n        return x *= y;\n    }\n    template <typename Tp> inline void read(Tp &x) { x = input<Tp>(); }\n    template <typename Tp> inline void chmax(Tp &x, Tp y) { x < y ? x = y : 0; }\n    template <typename Tp> inline void chmin(Tp &x, Tp y) { x > y ? x = y : 0; }\n}; // namespace Base\n// }}}\nusing namespace Base;\n\n#define MAX_N 6007\n\nint N, tot;\nint len[MAX_N];\nchar s[MAX_N], ans[MAX_N][MAX_N], res[MAX_N], tmp[MAX_N];\n\ninline bool sml(char *s1, int l1, char *s2, int l2) { //s1<s2\n    int l = std::min(l1, l2);\n    Rep(i, l)\n        if (s1[i] < s2[i]) return true;\n        else if (s1[i] > s2[i]) return false;\n    return l1 < l2;\n}\n\nint rk[MAX_N];\nbool vis[MAX_N];\ninline void solve(int l, int r) {\n    // debug(\"%d %d\\n\", l, r);\n    ++tot;\n    int &L = len[tot];\n    L = 0;\n    if (s[l] == 'a') {\n        int nb = 0, na = 0, cnt = 0;\n        rep(i, l, r) {\n            if (s[i] == 'a') {\n                na++;\n                int tmp = na;\n                while (i < r) {\n                    ++i;\n                    if (s[i] == 'b') nb++;\n                    else na++;\n                    if (nb == tmp) break;\n                }\n                cnt++;\n            } else {\n                nb++;\n            }\n        }\n        if (!cnt) return --tot, void();\n        L = cnt << 1;\n        Rep(i, cnt) ans[tot][i * 2 - 1] = 'a', ans[tot][i * 2] = 'b';\n    } else {\n        int k = r - l + 1 >> 1, na = 0, nb = 0;\n        rep(i, l, r) {\n            s[i] == 'a' ? rk[i] = ++na : rk[i] = ++nb;\n        }\n        Rep(i, k) {\n            int L2 = 0;\n            rep(j, l, r) {\n                if (rk[j] >= i) tmp[++L2] = s[j];\n            }\n            if (sml(ans[tot], L, tmp, L2)) {\n                L = L2;\n                Rep(j, L) ans[tot][j] = tmp[j];\n            }\n        }\n    }\n}\n\nint main() {\n#ifndef ONLINE_JUDGE\n    FIN(\"c.in\");\n    FOUT(\"c.out\");\n    FERR(\"c.log\");\n#endif\n    read(N);\n    N <<= 1;\n    scanf(\"%s\", s + 1);\n    int cnt = 0, las = 1;\n    Rep(i, N) {\n        cnt += s[i] == 'a' ? 1 : -1;\n        if (cnt == 0) {\n            solve(las, i);\n            las = i + 1;\n        }\n    }\n    // Rep(i, tot) {\n        // debug(\"%d:\\n\", i);\n        // Rep(j, len[i]) debug(\"%c\", ans[i][j]); dputs(\"\");\n    // }\n    // dputs(\"----\");\n    int top = 0;\n    IRep(i, tot) {\n        int tl = 0;\n        Rep(j, len[i]) tmp[j] = ans[i][j];\n        Rep(j, top) tmp[j + len[i]] = res[j];\n        tmp[top + len[i] + 1] = 0;\n        // debug(\"%s %s\\n\", tmp + 1, res + 1);\n        if (!sml(tmp, top + len[i], res, top)) {\n            top += len[i];\n            Rep(j, top) res[j] = tmp[j];\n        }\n    }\n    Rep(i, top) putchar(res[i]); puts(\"\");\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//khodaya khodet komak kon\n#include <bits/stdc++.h>\n\n#define F first\n#define S second\n#define pb push_back\n#define all(x) x.begin(), x.end()\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nconst int N = 3010;\nconst ll MOD = 1000000000 + 7;\nconst ll INF = 1000000010;\nconst ll LOG = 25;\n\n\nint n;\nchar S[N * 2 + 5];\nint A[N + 5], B[N + 5];\nchar F[N * 2 + 5][N * 2 + 5], G[N + 5][N * 2 + 5];\nint CntA, CntB;\n\nint main(){\n \tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n\tcin >> n;\n  \tfor (int i = 1; i <= 2 * n; i++) cin >> S[i];\n \tfor (int i = 1; i <= n * 2; ++i)\n    if (S[i] == 'a') A[++CntA] = i;\n    else B[++CntB] = i;\n\tfor (int i = n; i >= 1; --i) {\n    \tif (A[i] < B[i]) {\n    \t  F[i][1] = 'a', F[i][2] = 'b';\n      \tfor (int j = i; j <= n; ++j) {\n       \t if (j == n || A[j + 1] > B[i]) {\n       \t   strcpy(F[i] + 3, G[j + 1] + 1);\n       \t   break;\n       \t }\n      \t}\n    } else {\n      for (int j = i; j <= n; ++j) {\n        if (j == n || B[j + 1] > A[i]) {\n          int cnt = 0;\n          for (int k = i; k <= j; ++k) F[i][++cnt] = 'b';\n          F[i][++cnt] = 'a';\n          if (i == j) strcpy(F[i] + cnt + 1, G[i + 1] + 1);\n          else strcpy(F[i] + cnt + 1, F[i + 1] + j - i + 1);\n          break;\n        }\n      }\n    }\n    if (strcmp(F[i] + 1, G[i + 1] + 1) < 0) strcpy(G[i] + 1, G[i + 1] + 1);\n    else strcpy(G[i] + 1, F[i] + 1);\n  }\n    cout << G[1] + 1;\n  \treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nconst int MAX = 3000;\n\nstring greedA(string S, int l) { // 先頭がaだった時の貪欲取得(abab…系)\n\tfor (int i = 1, j, k;i < l;++ i) {\n\t\tif (S[i] == 'a') { // 連続した'a'を発見\n\t\t\tfor (j = i + 1;S[j] == 'a';++ j); // 最初に出てくるb(消さない)\n\t\t\tfor (k = j + 1;S[k] == 'a';++ k); // 次に出てくるb(消す)\n\t\t\tS.erase(S.begin() + k);\n\t\t\tS.erase(S.begin() + i);\n\t\t\t-- i;\n\t\t} else ++ i;\n\t}\n\treturn S;\n}\n\nstring greedB(string S, int l) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring comp = S;\n\tfor (int i = 0, ma = l >> 1, j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tS = S > comp ? S : comp;\n\t}\n\treturn S;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstatic string greed[MAX];\n\tint use = 0;\n\t\n\tstring subst;\n\tfor (int l = 0, r = 0;l < N;l = r, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\t++ r;\n\t\tsubst = S.substr(l, r - l);\n\t\tif (isA[l]) greed[use] = greedA(subst, r - l);\n\t\telse greed[use] = greedB(subst, r - l);\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define pb push_back\n#define all(v) v.begin(), v.end()\n#define sz(v) int(v.size())\n#define pii pair<int, int>\n#define mp make_pair\n#define f first\n#define ll long long\n#define ld long double\n#define s second\n#define vec vector<int>\n\nusing namespace std;\n\nconst int N = (int) 5e3 + 10;\nconst int M = (int) 2018 * 2018;\nconst int K = (int) 15;\nconst int INF = (int) 1e9 + 7;\nconst int mod = (int) 998244353;\nconst ld EPS = (ld) 1e-9;\nconst ll LINF = (ll) 1e18;\n\nint n;\nstring s;\nstring dp[N];\n\nint main() {\n\t#ifdef sony\n\t\tfreopen(\"input.txt\", \"r\", stdin);\n\t\tfreopen(\"output.txt\", \"w\", stdout);\n\t#endif\n\tsrand(time(0));\n\tcin >> n >> s;\n\tn += n;\n\tstring str = \"\";\n\tvector<string> v;\n\tfor (int i = 0, b = 0; i < n; i++) {\n\t\tif (s[i] == 'a') b++;\n\t\telse b--;\n\t\tstr += s[i];\n\t\tif (!b) {\n\t\t\tvec id[2];\n\t\t\tfor (int j = 0; j < sz(str); j++) {\n\t\t\t\tif (str[j] == 'a') { \n\t\t\t\t\tid[0].pb(j);\n\t\t\t\t} else { \n\t\t\t\t\tid[1].pb(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring cur = \"\";\n\t\t\tif (id[0][0] < id[1][0]) {\n\t\t\t\tint cur_id = -1;\n\t\t\t\tfor (int j = 0; j < sz(id[0]); j++) {\n\t\t\t\t\tif (id[0][j] > cur_id) {\n\t\t\t\t\t\tcur += \"ab\";\n\t\t\t\t\t\tcur_id = id[1][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset<int> st;\n\t\t\t\tfor (int j = sz(id[0]) - 1; j >= 0; j--) {\n\t\t\t\t\tst.insert(id[0][j]);\n\t\t\t\t\tst.insert(id[1][j]);\n\t\t\t\t\tstring tmp = \"\";\n\t\t\t\t\tfor (auto it : st) tmp += s[it];\n\t\t\t\t\tcur = max(cur, tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t\tv.pb(cur);\n\t\t\tstr = \"\";\n\t\t}\n\t}\n\tfor (int i = sz(v) - 1; i >= 0; i--) {\n\t\tdp[i] = max(dp[i + 1], v[i] + dp[i + 1]);\n\t}\n\tcout << dp[0];\n\treturn 0;\t\n}"
  },
  {
    "language": "C++",
    "code": "// Ala be zekrellah tatmaenolgholoob ...\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n#define F first\n#define S second\n#define MP make_pair\nconst int maxn = 3e3+9;\nconst ll mod = 1e9+7;\n\nint f[maxn], last[maxn];\nbool mx[maxn][maxn];\nqueue <int> q;\n\nint main () {\n\tios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\tmemset(f, -1, sizeof f);\n\tmemset(last, -1, sizeof last);\n\tint n;\n\tstring s, curmx;\n\tcin >> n >> s;\n\tfor (int i = s.length() - 1; i >= 0; i--) {\n\t\tif (q.size() == 0 || s[q.front()] == s[i]) {\n\t\t\tq.push(i);\n\t\t\tlast[i] = last[i + 1];\n\t\t\tcontinue;\n\t\t}\n\t\tstring cur;\n\t\tint ind = q.front();\n\t\tq.pop();\n\t\tf[i] = ind;\n\t\tmx[i][i] = mx[i][ind] = true;\n\t\tif (s[i] == 'b')\n\t\t\tfor (int t = i; t < ind; t++)\n\t\t\t\tif (f[t] + 1)\n\t\t\t\t\tmx[i][t] = mx[i][f[t]] = true;\n\t\tif (last[ind] + 1)\n\t\t\tfor (int t = ind + 1; t < s.length(); t++)\n\t\t\t\tif (mx[last[ind]][t])\n\t\t\t\t\tmx[i][t] = true;\n\t\tfor (int t = 0; t < s.length(); t++)\n\t\t\tif (mx[i][t])\n\t\t\t\tcur += s[t];\n\t\tif (cur > curmx) {\n\t\t\tlast[i] = i;\n\t\t\tcurmx = cur;\n\t\t}\n\t\telse\n\t\t\tlast[i] = last[i + 1];\n\t}\n\t// ans\n\tcout << curmx << \"\\n\";\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[3003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2*n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string ans;\n  vector<int> cind;\n  for (int i = n - 1; i >= 0; i--) {\n    string cand = ans;\n    vector<int> candcind = cind;\n    {\n      int pos = b[i];\n      auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n      cand.insert(cand.begin() + (insind - candcind.begin()), 'b');\n      candcind.insert(insind, pos);\n    }\n    {\n      int pos = a[i];\n      auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n      cand.insert(cand.begin() + (insind - candcind.begin()), 'a');\n      candcind.insert(insind, pos);\n    }\n    if (cand > ans) {\n      ans = move(cand);\n      cind = move(candcind);\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint A[3010],B[3010];\nchar str[6010];\nstring getans(int l,int r)\n{\n\tstring ans=\"\";\n\tif(A[l]<B[l])\n\t{\n\t\tint now=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(A[i]>now){\n\t\t\t\tnow=B[i];\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t}\n\telse{\n\t\tint L=B[l],R=A[r];\n\t\tfor(int i=1;i<=r-l+1;i++)\n\t\t{\n\t\t\tint nowa=i,nowb=i;\n\t\t\tstring cur=\"\";\n\t\t\tfor(int j=R;j>=L;j--)\n\t\t\t{\n\t\t\t\tif(str[j]=='a'&&nowa>0)nowa--,cur+='a';\n\t\t\t\tif(str[j]=='b'&&nowb>0)nowb--,cur+='b';\n\t\t\t}\n\t\t\treverse(cur.begin(),cur.end());\n\t\t\tans=max(ans,cur);\n\t\t}\n\t}\n\treturn ans;\n}\nstring res[3010];\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint nowa=0,nowb=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')A[++nowa]=i;\n\t\telse B[++nowb]=i;\n\tstring ans=\"\";\n\tint cnt=0,lst=1,now=0;\n\tfor(int i=1;i<=n*2;i++)\n\t{\n\t\tif(str[i]=='a')cnt++;\n\t\telse cnt--;\n\t\tif(cnt==0){\n\t\t\tres[++now]=getans(lst,i/2);\n\t\t\tlst=i/2+1;\n\t\t}\n\t}\n\tfor(int i=n;i>=1;)\n\t{\n\t\tint j=i;\n\t\tif(A[i]<B[i])while(j>0&&A[j]<B[j])j--;\n\t\telse while(j>0&&A[j]>B[j])j--;\n\t\tstring tmp=getans(j+1,i);\n\t\tbool flag=true;\n\t\tfor(int k=0;k<min(tmp.length(),ans.length());k++)\n\t\t\tif(tmp[k]>ans[k])break;\n\t\t\telse if(tmp[k]<ans[k]){\n\t\t\t\tflag=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif(flag)ans=tmp+ans;\n\t\ti=j;\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <iostream>\n#include <numeric>\n#include <set>\n#include <tuple>\n#include <vector>\nusing namespace std;\n\nvector<int> build_edges(const string &s) {\n  const int n = s.size();\n  vector<int> edges(n);\n  for (int i = 0, j = 0; ; ++i, ++j ) {\n    while (i < n && s[i] != 'a') ++i;\n    while (j < n && s[j] != 'b') ++j;\n    if (i < n) {\n      assert(j < n);\n      edges[i] = j;\n      edges[j] = i;\n    } else {\n      assert(j == n);\n      break;\n    }\n  }\n  return edges;\n}\n\nstring solve_a(const string &s) {\n  string res = \"\";\n  const vector<int> edges = build_edges(s);\n  for (int i = 0; i < s.size(); ++i) {\n    if (s[i] == 'a') {\n      res += \"ab\";\n      assert(edges[i] > i);\n      i = edges[i];\n    }\n  }\n  return res;\n}\n\nstring solve_b(const string &s) {\n  string res = \"\";\n  for (int i = 0, skipped_b = 0; i < s.size(); ++i) {\n    if (s[i] == 'b') {\n      // try pick this one first\n      string current;\n      for (int j = i, rest_a = skipped_b; j < s.size(); ++j) {\n        if (rest_a <= 0 || s[j] == 'b') current += s[j];\n        if (s[j] == 'a') --rest_a;\n      }\n      res = max(res, current);\n      ++skipped_b;\n    } else if (s[i] == 'a') {\n      --skipped_b;\n    }\n  }\n  return res;\n}\n\nint main() {\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> l, r;\n  for (int i = 0, t = 0; i < 2 * n; ++i) {\n    if (t == 0) l.push_back(i);\n    t += s[i] == 'a' ? +1 : -1;\n    if (t == 0) r.push_back(i + 1);\n  }\n  assert(l.size() == r.size());\n  assert(l.front() == 0);\n  assert(r.back() == 2 * n);\n  const int t = l.size();\n\n  reverse(l.begin(), l.end());\n  reverse(r.begin(), r.end());\n  string res = \"\";\n  for (int i = 0; i < t; ++i) {\n    string chunk = s.substr(l[i], r[i] - l[i]);\n    string current = (s[l[i]] == 'a') ? solve_a(chunk) : solve_b(chunk);\n    res = max(res, current + res);\n  }\n  cout << res << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<string>\nusing namespace std;\nchar p[6010];\nint n;\nstruct point {\n\tint a, b;\n}w[3010];\nint A[6010], Num[6010], cA, cB;\nstring D[6010];\nchar q[6010];\nint main() {\n\tint i, j;\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", p + 1);\n\tfor (i = 1; i <= n+n; i++) {\n\t\tif (p[i] == 'a')w[++cA].a = i;\n\t\tif (p[i] == 'b')w[++cB].b = i;\n\t}\n\tfor (i = 1; i <= n; i++) {\n\t\tNum[w[i].a] = Num[w[i].b] = i;\n\t}\n\tfor (i = n+n - 1; i >= 1; i--) {\n\t\tint pv = Num[i];\n\t\tD[i] = D[i + 1];\n\t\tif (p[i] == 'a') {\n\t\t\tif (w[pv].b < w[pv].a)continue;\n\t\t\tif (!D[i + 1].size() || D[i + 1][0] == 'a') {\n\t\t\t\tD[i] = max(D[i], \"ab\" + D[w[pv].b + 1]);\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\telse {\n\t\t\tif (w[pv].a < w[pv].b)continue;\n\t\t\tint c = 0;\n\t\t\tfor (j = pv; j <= n; j++) {\n\t\t\t\tif (w[j].a < w[j].b)break;\n\t\t\t}\n\t\t\tint ed = j - 1, last = 0;\n\t\t\tfor (j = i; j <= n + n; j++) {\n\t\t\t\tif (Num[j] >= pv && Num[j] <= ed) q[c++] = p[j], last = j;\n\t\t\t}\n\t\t\tq[c] = 0;\n\t\t\tD[i] = max(D[i], q + D[last + 1]);\n\t\t}\n\t}\n\tprintf(\"%s\\n\", D[1].c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\n#define N 6005\nint n,l1,l2,v[N][2],ct[N];\nchar s[N],dp[N][N];\nbool check(int i,int j){for(int k=1;k<=n*2;k++)if(dp[i][k]<dp[j][k])return 1;else if(dp[i][k]>dp[j][k])return 0;return 0;}\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n*2;i++)\n\tif(s[i]=='a')v[++l1][0]=i;\n\telse v[++l2][1]=i;\n\tfor(int i=n;i>=1;i--)\n\tif(v[i][0]<v[i][1])\n\t{\n\t\tint rb=i;\n\t\twhile(rb<n&&(v[i][1]>v[rb+1][1]||v[i][1]>v[rb+1][0]))rb++;\n\t\tct[i]=2;dp[i][1]='a';dp[i][2]='b';\n\t\tfor(int j=1;j<=ct[rb+1];j++)dp[i][j+ct[i]]=dp[rb+1][j];\n\t\tct[i]+=ct[rb+1];\n\t\tif(check(i,i+1))\n\t\t{\n\t\t\tct[i]=ct[i+1];\n\t\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t\t\tdp[i][ct[i]+1]=0;\n\t\t}\n\t}\n\telse\n\t{\n\t\tint rb=i;\n\t\twhile(rb<n&&v[rb][0]>v[rb+1][1])rb++;\n\t\tint l1=i,l2=i;\n\t\tfor(ct[i]=1;ct[i]<=(rb-i+1)*2;ct[i]++)\n\t\tif(l1==rb+1)dp[i][ct[i]]='b',++l2;\n\t\telse if(l2==rb+1)dp[i][ct[i]]='a',++l1;\n\t\telse if(v[l1][0]<v[l2][1])dp[i][ct[i]]='a',++l1;\n\t\telse dp[i][ct[i]]='b',++l2;\n\t\tct[i]--;\n\t\tfor(int j=1;j<=ct[rb+1];j++)dp[i][j+ct[i]]=dp[rb+1][j];\n\t\tct[i]+=ct[rb+1];\n\t\tif(check(i,i+1))\n\t\t{\n\t\t\tct[i]=ct[i+1];\n\t\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t\t\tdp[i][ct[i]+1]=0;\n\t\t}\n\t}\n\tprintf(\"%s\\n\",dp[1]+1);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n// {{{ Definitions\n#define reg register\n#define pr std::pair<int, int>\n#define fi first\n#define se second\n#define FIN(s) freopen(s, \"r\", stdin)\n#define FOUT(s) freopen(s, \"w\", stdout)\n#define FERR(s) freopen(s, \"w\", stderr)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define dputs(s) fprintf(stderr, s\"\\n\")\n#define rep(i, l, r) for (int i = l; i <= r; ++i)\n#define lep(i, l, r) for (int i = l; i < r; ++i)\n#define irep(i, r, l) for (int i = r; i >= l; --i)\n#define ilep(i, r, l) for (int i = r; i > l; --i)\n#define Rep(i, n) rep(i, 1, n)\n#define Lep(i, n) lep(i, 1, n)\n#define IRep(i, n) irep(i, n, 1)\n#define ILep(i, n) ilep(i, n, 1)\ntypedef long long ll;\ntypedef long double ld;\n// }}}\n// {{{ Modular\nnamespace modular {\n    const int MOD = 1000000007;\n    inline int add(int x, int y) { return (x += y) >= MOD ? x -= MOD : x; }\n    inline void inc(int &x, int y) { (x += y) >= MOD ? x -= MOD : 0; }\n    inline int mul(int x, int y) { return 1LL * x * y % MOD; }\n    inline int qpow(int x, int y) {\n        int ans = 1;\n        for (; y; y >>= 1, x = mul(x, x))\n            if (y & 1)\n                ans = mul(ans, x);\n        return ans;\n    }\n}; // namespace modular\n// }}}\n// {{{ Base\nnamespace Base {\n    template <typename Tp> inline Tp input() {\n        Tp x = 0, y = 1;\n        char c = getchar();\n        while ((c < '0' || '9' < c) && c != EOF) {\n            if (c == '-')\n                y = -1;\n            c = getchar();\n        }\n        if (c == EOF)\n            return 0;\n        while ('0' <= c && c <= '9')\n            x = x * 10 + c - '0', c = getchar();\n        return x *= y;\n    }\n    template <typename Tp> inline void read(Tp &x) { x = input<Tp>(); }\n    template <typename Tp> inline void chmax(Tp &x, Tp y) { x < y ? x = y : 0; }\n    template <typename Tp> inline void chmin(Tp &x, Tp y) { x > y ? x = y : 0; }\n}; // namespace Base\n// }}}\nusing namespace Base;\n\n#define MAX_N 6007\n\nint N, tot;\nint len[MAX_N];\nchar s[MAX_N], ans[MAX_N][MAX_N], res[MAX_N], tmp[MAX_N];\n\ninline bool sml(char *s1, int l1, char *s2, int l2) { //s1<s2\n    int l = std::min(l1, l2);\n    Rep(i, l)\n        if (s1[i] < s2[i]) return true;\n        else if (s1[i] > s2[i]) return false;\n    return l1 < l2;\n}\n\nint rk[MAX_N];\nbool vis[MAX_N];\ninline void solve(int l, int r) {\n    // debug(\"%d %d\\n\", l, r);\n    ++tot;\n    int &L = len[tot];\n    L = 0;\n    if (s[l] == 'a') {\n        int nb = 0, na = 0, cnt = 0;\n        rep(i, l, r) {\n            if (s[i] == 'a') {\n                na++;\n                int tmp = na;\n                while (i < r) {\n                    ++i;\n                    if (s[i] == 'b') nb++;\n                    else na++;\n                    if (nb == tmp) break;\n                }\n                cnt++;\n            } else {\n                nb++;\n            }\n        }\n        if (!cnt) return --tot, void();\n        L = cnt << 1;\n        Rep(i, cnt) ans[tot][i * 2 - 1] = 'a', ans[tot][i * 2] = 'b';\n    } else {\n        int k = r - l + 1 >> 1, na = 0, nb = 0;\n        rep(i, l, r) {\n            s[i] == 'a' ? rk[i] = ++na : rk[i] = ++nb;\n        }\n        Rep(i, k) {\n            int L2 = 0;\n            rep(j, l, r) {\n                if (rk[j] >= i) tmp[++L2] = s[j];\n            }\n            if (sml(ans[tot], L, tmp, L2)) {\n                L = L2;\n                Rep(j, L) ans[tot][j] = tmp[j];\n            }\n        }\n    }\n}\n\nint main() {\n    read(N);\n    N <<= 1;\n    scanf(\"%s\", s + 1);\n    int cnt = 0, las = 1;\n    Rep(i, N) {\n        cnt += s[i] == 'a' ? 1 : -1;\n        if (cnt == 0) {\n            solve(las, i);\n            las = i + 1;\n        }\n    }\n    // Rep(i, tot) {\n        // debug(\"%d:\\n\", i);\n        // Rep(j, len[i]) debug(\"%c\", ans[i][j]); dputs(\"\");\n    // }\n    // dputs(\"----\");\n    int top = 0;\n    IRep(i, tot) {\n        int tl = 0;\n        Rep(j, len[i]) tmp[j] = ans[i][j];\n        Rep(j, top) tmp[j + len[i]] = res[j];\n        tmp[top + len[i] + 1] = 0;\n        // debug(\"%s %s\\n\", tmp + 1, res + 1);\n        if (!sml(tmp, top + len[i], res, top)) {\n            top += len[i];\n            Rep(j, top) res[j] = tmp[j];\n        }\n    }\n    Rep(i, top) putchar(res[i]); puts(\"\");\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n#define sz(a) int(a.size())\n#define clr(a) memset(a,0,sizeof(a))\n#define all(a) a.begin(),a.end()\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<int,int> pii;\ntypedef pair<ll,int> pli;\nconst int inf=1e9;\nconst ll Inf=1e18;\nconst int N=6e3+10;\nconst int mod=0;\nint gi() {\n    int x=0,o=1;char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-') ch=getchar();\n    if(ch=='-') o=-1,ch=getchar();\n    while(ch>='0'&&ch<='9') x=x*10+ch-'0',ch=getchar();\n    return x*o;\n}\ntemplate<typename T> bool chkmax(T &a,T b) { return a<b?a=b,1:0; };\ntemplate<typename T> bool chkmin(T &a,T b) { return a>b?a=b,1:0; };\nint add(int a,int b) { return a+b>=mod?a+b-mod:a+b; }\nint sub(int a,int b) { return a-b<0?a-b+mod:a-b; }\nvoid inc(int &a,int b) { a=(a+b>=mod?a+b-mod:a+b); }\nvoid dec(int &a,int b) { a=(a-b<0?a-b+mod:a-b); }\nchar s[N];\nint n,f[N][N],a[N],b[N],A=0,B=0,c[N];\nstring getstr(int f[]) {\n    string ret;\n    for(int i=1;i<=2*n;i++)\n        if(f[c[i]]) ret+=s[i];\n    return ret;\n}\nint main() {\n    n=gi(),scanf(\"%s\",s+1);\n    for(int i=1;i<=2*n;i++) {\n        if(s[i]=='a') a[++A]=i,c[i]=A;\n        else b[++B]=i,c[i]=B;\n    }\n    f[n][n]=1;\n    for(int i=n-1;i;i--) {\n        f[i][i]=1;\n        if(a[i]<b[i]) {\n            int mx=0;\n            for(int j=a[i];j<=b[i];j++) chkmax(mx,c[j]);\n            for(int j=i+1;j<=n;j++) f[i][j]=f[mx+1][j];\n        }\n        else {\n            int tot=0,mx=0;\n            for(int j=b[i];j<=a[i];j++) {\n                if(c[j]<i) continue;\n                f[i][c[j]]=1,chkmax(mx,c[j]);\n                s[j]=='b'?++tot:--tot;\n            }\n            for(int j=a[i]+1;j<=2*n;j++) {\n                if(s[j]=='b') {\n                    if(tot==0) f[i][c[j]]=f[mx+1][c[j]];\n                    else ++tot,chkmax(mx,c[j]),f[i][c[j]]=1;\n                }\n                else {\n                    if(tot==0) f[i][c[j]]=f[mx+1][c[j]];\n                    else --tot,f[i][c[j]]=1;\n                }\n            }\n        }\n        if(getstr(f[i])<getstr(f[i+1])) memcpy(f[i],f[i+1],sizeof(f[i]));\n    }\n    cout<<getstr(f[1]);\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#ifndef BZ\n#pragma GCC optimize \"-O3\"\n#endif\n#include <bits/stdc++.h>\n\n#define FASTIO\n\n#ifdef FASTIO\n#define scanf abacaba\n#define printf abacaba\n#endif\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\n\n/*\nll pw(ll a, ll b) {\n\tll ans = 1; while (b) {\n\t\twhile (!(b & 1)) b >>= 1, a = (a * a) % MOD;\n\t\tans = (ans * a) % MOD, --b;\n\t} return ans;\n}\n*/\n\nint n;\nstring s;\nstring dp[6100];\nint ps[6100];\nint go[6100];\nvector<int> pa, pb;\n\nint main() {\n#ifdef FASTIO\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n#endif\n\tcin >> n >> s;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\tps[i] = pa.size();\n\t\t\tpa.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tps[i] = pb.size();\n\t\t\tpb.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < n; ++i)\n\t\tgo[pa[i]] = pb[i], go[pb[i]] = pa[i];\n\tdp[2 * n] = \"\";\n\tfor (int i = 2 * n - 1; i >= 0; --i) {\n\t\tdp[i] = dp[i + 1];\n\t\tif (go[i] < i)\n\t\t\tcontinue;\n\t\tif (s[i] == 'b') {\n\t\t\tstring cur;\n\t\t\tint pos = i;\n\t\t\tfor (int j = i; j < 2 * n; ++j) {\n\t\t\t\tif (s[j] == 'b')\n\t\t\t\t\tcur += 'b', pos = j + 1;\n\t\t\t\telse if (go[j] >= i && go[j] < j) {\n\t\t\t\t\tpos = j + 1;\n\t\t\t\t\tcur += 'a';\n\t\t\t\t}\n\t\t\t\telse if (go[j] >= j)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdp[i] = max(dp[i], cur + dp[pos]);\n\t\t}\n\t\telse {\n\t\t\tdp[i] = max(dp[i], \"ab\" + dp[go[i] + 1]);\n\t\t}\n\t}\n\tcout << dp[0] << \"\\n\";\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#ifdef DEMETRIO\n#define deb(...) fprintf(stderr,__VA_ARGS__)\n#define deb1(x) cerr << #x << \" = \" << x << endl\n#else\n#define deb(...) 0\n#define deb1(x) 0\n#endif\n#define pb push_back\n#define mp make_pair\n#define fst first\n#define snd second\n#define fore(i,a,b) for(int i=a,ThxDem=b;i<ThxDem;++i)\n#define SZ(x) ((int)(x).size())\n#define mset(a,v) memset(a,v,sizeof(a))\n#define mcpy(a,b) memcpy(a,b,sizeof(a))\nusing namespace std;\ntypedef long long ll;\n\nint n;\nchar _s[6005];\nstring s;\n\nvoid comb(string& r, string s){\n\tr=max(r,s+r);\n}\n\nstring doit(string s){\n\tstring r=\"\";\n\tint n=SZ(s);\n\tif(s[0]=='a'){\n\t\tint a=0,b=0,l=-1;\n\t\tbool aa=true;\n\t\tfore(i,0,n){\n\t\t\tif(s[i]=='a'){\n\t\t\t\tif(aa)r.pb('a'),l=a,aa=false;\n\t\t\t\ta++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(b==l)r.pb('b'),aa=true;\n\t\t\t\tb++;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tint a=0,b=0;\n\t\tfore(i,0,n){\n\t\t\tif(s[i]=='a'){\n\t\t\t\ta++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstring t=\"\";\n\t\t\t\tint aa=a;\n\t\t\t\tfore(j,i,n){\n\t\t\t\t\tif(s[j]=='a'){\n\t\t\t\t\t\tif(aa>=b)t.pb('a');\n\t\t\t\t\t\taa++;\n\t\t\t\t\t}\n\t\t\t\t\telse t.pb('b');\n\t\t\t\t}\n\t\t\t\tr=max(r,t);\n\t\t\t\tb++;\n\t\t\t}\n\t\t}\n\t}\n\treturn r;\n}\n\nvector<string> v;\n\nint main(){\n\tscanf(\"%d%s\",&n,_s);n*=2;\n\ts=string(_s);\n\tint l=0,t=0;\n\tstring r=\"\";\n\tfore(i,0,n){\n\t\tif(s[i]=='a')t++;\n\t\telse t--;\n\t\tif(t==0)v.pb(doit(s.substr(l,i-l+1))),l=i+1;\n\t}\n\tfor(int i=SZ(v)-1;i>=0;--i)comb(r,v[i]);\n\tputs(r.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int N = 3005, M = 6005;\n\nint n, na, nb, a[N], b[N], wh[M];\nchar s[M];\nstd::string f[N];\n\nint main()\n{\n\tstd::cin >> n;\n\tscanf(\"%s\", s + 1);\n\tfor (int i = 1; i <= n * 2; i++)\n\t\tif (s[i] == 'a') a[++na] = i; else b[wh[i] = ++nb] = i;\n\tfor (int i = n; i >= 1; i--)\n\t{\n\t\tif (a[i] < b[i])\n\t\t{\n\t\t\tint j = i;\n\t\t\twhile (j <= n && (a[j] <= b[i] || b[j] <= b[i])) j++;\n\t\t\tf[i].push_back('a'); f[i].push_back('b'); f[i] = f[i] + f[j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint mx = a[i], k = n + 1;\n\t\t\tfor (int j = b[i]; j <= mx; j++)\n\t\t\t\tif (s[j] == 'b' && a[wh[j]] > mx) mx = a[wh[j]];\n\t\t\tfor (int j = 1; j <= n; j++) if (a[j] > mx && b[j] > mx && j < k)\n\t\t\t\tk = j;\n\t\t\tfor (int j = b[i]; j <= mx; j++) f[i].push_back(s[j]);\n\t\t\tf[i] = f[i] + f[k];\n\t\t}\n\t\tif (f[i + 1] > f[i]) f[i] = f[i + 1];\n\t}\n\treturn std::cout << f[1] << std::endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n#define int ll\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<int,int,int> tp;\n//typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint n;\nstring s;\nstring f(int l,int r){\n\tvvi pos((r-l)/2,vi(2));\n\tint q;\n\tq=0;loop(i,l,r)if(s[i]=='a')pos[q++][0]=i;\n\tq=0;loop(i,l,r)if(s[i]=='b')pos[q++][1]=i;\n\tstring t=\"\";\n\tif(s[l]=='a'){\n\t\tq=-1;\n\t\trep(i,pos.size()){\n\t\t\tif(pos[i][0]>q){\n\t\t\t\tt+=\"ab\";\n\t\t\t\tq=pos[i][1];\n\t\t\t}\n\t\t}\n\t}else{\n\t\tvi used(r-l);\n\t\trep(i,pos.size()){\n\t\t\tstring w=\"\";\n\t\t\tused[pos[pos.size()-1-i][0]-l]=1;\n\t\t\tused[pos[pos.size()-1-i][1]-l]=1;\n\t\t\trep(j,used.size())if(used[j])w+=s[l+j];\n\t\t\tcmax(t,w);\n\t\t}\n\t}\n\treturn t;\n}\nsigned main(){\n\tcin>>n>>s;\n\tvs dp;\n\tint t=0,p=0;\n\trep(i,s.size()){\n\t\tif(s[i]=='a')t++;\n\t\telse t--;\n\t\tif(!t){\n\t\t\tdp.pb(f(p,i+1));\n\t\t\tp=i+1;\n\t\t}\n\t}\n\tint N=dp.size();\n\tfor(int i=N-1;i>=0;i--){\n\t\tstring w=dp[i];\n\t\tloop(j,i+1,N)cmax(w,dp[i]+dp[j]);\n\t\tif(i!=N-1)cmax(w,dp[i+1]);\n\t\tdp[i]=w;\n\t}\n\tcout<<dp[0]<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#ifndef LOCAL\n#pragma GCC optimize (\"O3\")\n#endif\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define sim template < class c\n#define ris return * this\n#define dor > debug & operator <<\n#define eni(x) sim > typename \\\nenable_if<sizeof dud<c>(0) x 1, debug&>::type operator<<(c i) {\nsim > struct rge { c b, e; };\nsim > rge<c> range(c i, c j) { return {i, j}; }\nsim > auto dud(c* x) -> decltype(cerr << *x, 0);\nsim > char dud(...);\nstruct debug {\n#ifdef LOCAL\n~debug() { cerr << endl; }\neni(!=) cerr << boolalpha << i; ris; }\neni(==) ris << range(begin(i), end(i)); }\nsim, class b dor(pair < b, c > d) {\n  ris << \"(\" << d.first << \", \" << d.second << \")\";\n}\nsim dor(rge<c> d) {\n  *this << \"[\";\n  for (c it = d.b; it != d.e; ++it)\n    *this << \", \" + 2 * (it == d.b) << *it;\n  ris << \"]\";\n}\n#else\nsim dor(const c&) { ris; }\n#endif\n};\n#define imie(x...) \" [\" #x \": \" << (x) << \"] \"\n\nusing ld = long double;\nusing ll = long long;\n\nconstexpr int mod = 1000 * 1000 * 1000 + 7;\nconstexpr int odw2 = (mod + 1) / 2;\n\nvoid OdejmijOd(int& a, int b) { a -= b; if (a < 0) a += mod; }\nint Odejmij(int a, int b) { OdejmijOd(a, b); return a; }\nvoid DodajDo(int& a, int b) { a += b; if (a >= mod) a -= mod; }\nint Dodaj(int a, int b) { DodajDo(a, b); return a; }\nint Mnoz(int a, int b) { return (ll) a * b % mod; }\nvoid MnozDo(int& a, int b) { a = Mnoz(a, b); }\nint Pot(int a, int b) { int res = 1; while (b) { if (b % 2 == 1) MnozDo(res, a); a = Mnoz(a, a); b /= 2; } return res; }\nint Odw(int a) { return Pot(a, mod - 2); }\nvoid PodzielDo(int& a, int b) { MnozDo(a, Odw(b)); }\nint Podziel(int a, int b) { return Mnoz(a, Odw(b)); }\nint Moduluj(ll x) { x %= mod; if (x < 0) x += mod; return x; }\n\ntemplate <typename T> T Maxi(T& a, T b) { return a = max(a, b); }\ntemplate <typename T> T Mini(T& a, T b) { return a = min(a, b); }\n\nint main() {\n  ios_base::sync_with_stdio(0);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> parts;\n  int bal = 0;\n  string last_part;\n  for (char c : s) {\n    if (c == 'a') bal++;\n    else if (c == 'b') bal--;\n    else assert(false);\n    last_part.push_back(c);\n    if (bal == 0) {\n      parts.push_back(last_part);\n      last_part.clear();\n    }\n  }\n  assert(last_part.empty());\n  debug() << imie(parts);\n\n  for (string& p : parts) {\n    assert((int) p.size() % 2 == 0);\n    string res;\n    if (p[0] == 'a') {\n      for (int i = 0; i < (int) p.size(); i++) {\n        if (p[i] == 'a') {\n          res.push_back('a');\n          res.push_back('b');\n          while (p[i] != 'b') i++;\n        }\n      }\n    } else {\n      for (int i = 0; i < (int) p.size() / 2; i++) {\n        string st;\n        int zost[2] = {i, i};\n        for (char c : p) {\n          int idx = 0;\n          if (c == 'b') idx = 1;\n          if (zost[idx] > 0) {\n            zost[idx]--;\n          } else {\n            st.push_back(c);\n          }\n        }\n        Maxi(res, st);\n      }\n    }\n    swap(res, p);\n  }\n  debug() << imie(parts);\n  string wyn;\n  for (int i = (int) parts.size() - 1; i >= 0; i--) {\n    if ((parts[i] + wyn).substr(0, (int) wyn.size()) >= wyn) {\n      wyn = parts[i] + wyn;\n    }\n  }\n  cout << wyn << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <cassert>\n#include <random>\n#include <iomanip>\n#define FOR(i, n, m) for(ll i = n; i < (int)m; i++)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll, ll>;\nconstexpr ll inf = 1000000000;\nconstexpr ll mod = 1000000007;\nconstexpr long double eps = 1e-15;\n \ntemplate<typename T1, typename T2>\nostream& operator<<(ostream& os, pair<T1, T2> p) {\n    os << to_string(p.first) << \" \" << to_string(p.second);\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& v) {\n    REP(i, v.size()) {\n        if(i) os << \" \";\n        os << to_string(v[i]);\n    }\n    return os;\n}\n \nstruct modint {\n    ll n;\npublic:\n    modint(const ll n = 0) : n((n % mod + mod) % mod) {}\n    static modint pow(modint a, int m) {\n        modint r = 1;\n        while(m > 0) {\n            if(m & 1) { r *= a; }\n            a = (a * a); m /= 2;\n        }\n        return r;\n    }\n    modint &operator++() { *this += 1; return *this; }\n    modint &operator--() { *this -= 1; return *this; }\n    modint operator++(int) { modint ret = *this; *this += 1; return ret; }\n    modint operator--(int) { modint ret = *this; *this -= 1; return ret; }\n    modint operator~() const { return (this -> pow(n, mod - 2)); } // inverse\n    friend bool operator==(const modint& lhs, const modint& rhs) {\n        return lhs.n == rhs.n;\n    }\n    friend bool operator<(const modint& lhs, const modint& rhs) {\n        return lhs.n < rhs.n;\n    }\n    friend bool operator>(const modint& lhs, const modint& rhs) {\n        return lhs.n > rhs.n;\n    }\n    friend modint &operator+=(modint& lhs, const modint& rhs) {\n        lhs.n += rhs.n;\n        if (lhs.n >= mod) lhs.n -= mod;\n        return lhs;\n    }\n    friend modint &operator-=(modint& lhs, const modint& rhs) {\n        lhs.n -= rhs.n;\n        if (lhs.n < 0) lhs.n += mod;\n        return lhs;\n    }\n    friend modint &operator*=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * rhs.n) % mod;\n        return lhs;\n    }\n    friend modint &operator/=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * (~rhs).n) % mod;\n        return lhs;\n    }\n    friend modint operator+(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n + rhs.n);\n    }\n    friend modint operator-(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n - rhs.n);\n    }\n    friend modint operator*(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * rhs.n);\n    }\n    friend modint operator/(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * (~rhs).n);\n    }\n};\nistream& operator>>(istream& is, modint m) { is >> m.n; return is; }\nostream& operator<<(ostream& os, modint m) { os << m.n; return os; }\n \n#define MAX_N 3030303\nlong long extgcd(long long a, long long b, long long& x, long long& y) {\n    long long d = a;\n    if (b != 0) {\n        d = extgcd(b, a % b, y, x);\n        y -= (a / b) * x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nlong long mod_inverse(long long a, long long m) {\n    long long x, y;\n    if(extgcd(a, m, x, y) == 1) return (m + x % m) % m;\n    else return -1;\n}\nvector<long long> fact(MAX_N+1, inf);\nlong long mod_fact(long long n, long long& e) {\n    if(fact[0] == inf) {\n        fact[0]=1;\n        if(MAX_N != 0) fact[1]=1;\n        for(ll i = 2; i <= MAX_N; ++i) {\n            fact[i] = (fact[i-1] * i) % mod;\n        }\n    }\n    e = 0;\n    if(n == 0) return 1;\n    long long res = mod_fact(n / mod, e);\n    e += n / mod;\n    if((n / mod) % 2 != 0) return (res * (mod - fact[n % mod])) % mod;\n    return (res * fact[n % mod]) % mod;\n}\n// return nCk\nlong long mod_comb(long long n, long long k) {\n    if(n < 0 || k < 0 || n < k) return 0;\n    long long e1, e2, e3;\n    long long a1 = mod_fact(n, e1), a2 = mod_fact(k, e2), a3 = mod_fact(n - k, e3);\n    if(e1 > e2 + e3) return 0;\n    return (a1 * mod_inverse((a2 * a3) % mod, mod)) % mod;\n}\n \nusing mi = modint;\n \nmi mod_pow(mi a, ll n) {\n    mi ret = 1;\n    mi tmp = a;\n    while(n > 0) {\n        if(n % 2) ret *= tmp;\n        tmp = tmp * tmp;\n        n /= 2;\n    }\n    return ret;\n}\n \nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n \nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<pair<int, int>> idx(n);\n    vector<int> v(2 * n, -1);\n    int ca = 0, cb = 0;\n    REP(i, 2 * n) {\n        if(s[i] == 'a') {\n            idx[ca].first = i;\n            v[i] = ca;\n            ca++;\n        } else {\n            idx[cb].second = i;\n            v[i] = cb;\n            cb++;\n        }\n    }\n    vector<string> mx(n, \"\");\n    for(int i = n - 1; i >= 0; i--) {\n        if(idx[i].first < idx[i].second) {\n            mx[i] = \"ab\";\n            int tmp = i;\n            for(int j = idx[i].first + 1; j < idx[i].second; j++) if(s[j] == 'a') tmp++;\n            if(tmp + 1 < n) mx[i] += mx[tmp + 1];\n        } else {\n            int tmp = i;\n            for(int j = idx[i].second; j < 2 * n; j++) {\n                if(s[j] == 'b') {\n                    mx[i] += 'b';\n                    tmp = v[j];\n                } else {\n                    if(v[j] < i) continue;\n                    mx[i] += 'a';\n                    if(v[j] == tmp) {\n                      if(v[j] < n - 1) mx[i] += mx[v[j] + 1];\n                      break;\n                    }\n                }\n            }\n        }\n        if(i < n - 1) mx[i] = max(mx[i], mx[i + 1]);\n    }\n    string ans = mx[0];\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nvector<string> separate(const string& S){\n\tvector<string> res;\n\tint prev = 0, sum = 0;\n\tfor(int i=0;i<S.size();i++){\n\t\tsum += (S[i] == 'a' ? 1 : -1);\n\t\tif(sum == 0){\n\t\t\tres.push_back(S.substr(prev, i - prev + 1));\n\t\t\tprev = i + 1;\n\t\t}\n\t}\n\treturn res;\n}\n\nstring solvePart(const string& S){\n\tstring res = \"\";\n\tif(S[0] == 'a'){\n\t\tvector<int> dp(S.size()+1, 0);\n\t\tvector<int> posB;\n\t\tfor(int i=0;i<S.size();i++){\n\t\t\tif(S[i] == 'b') posB.push_back(i);\n\t\t}\n\t\tint cntA = 0;\n\t\tfor(int i=0;i<S.size();i++){\n\t\t\tdp[i+1] = max(dp[i], dp[i+1]);\n\t\t\tif(S[i] == 'a'){\n\t\t\t\tdp[posB[cntA]] = max(dp[posB[cntA]], dp[i]+1);\n\t\t\t\t++cntA;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<dp.back();i++) res += \"ab\";\n\t} else {\n\t\tvector<int> order(S.size());\n\t\tint cnt[2] = {0, 0};\n\t\tfor(int i=0;i<S.size();i++){\n\t\t\torder[i] = cnt[S[i]-'a'];\n\t\t\tcnt[S[i]-'a']++;\n\t\t}\n\t\tfor(int i=S.size()/2-1;i>=0;i--){\n\t\t\tstring tmp = \"\";\n\t\t\tfor(int j=0;j<S.size();j++){\n\t\t\t\tif(order[j] >= i) tmp += S[j];\n\t\t\t}\n\t\t\tres = max(res, tmp);\n\t\t}\n\t}\n\treturn res;\n}\n\nint main(){\n\tint N;\n\twhile(cin >> N){\n\t\tstring S; cin >> S;\n\t\tvector<string> vs = separate(S);\n\t\tfor(auto& s : vs) s = solvePart(s);\n\t\tstring res = \"\";\n\t\tfor(int i=vs.size()-1;i>=0;i--){\n\t\t\tif(res < vs[i] + res) res = vs[i] + res;\n\t\t}\n\t\tcout << res << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n#ifdef wxh010910\n  freopen(\"input.txt\", \"r\", stdin);\n#endif\n  int n;\n  cin >> n;\n  string s;\n  cin >> s;\n  vector<int> sum(n << 1 | 1, 0);\n  for (int i = 0; i < n << 1; ++i) {\n    sum[i + 1] = sum[i] + (s[i] == 'a' ? 1 : -1);\n  }\n  int last = 0;\n  vector<string> all;\n  function<string(int, int)> get = [&](int l, int r) {\n    vector<int> a, b;\n    for (int i = l; i < r; ++i) {\n      if (s[i] == 'a') {\n        a.push_back(i);\n      } else {\n        b.push_back(i);\n      }\n    }\n    vector<bool> choose(r - l, false);\n    if (a[0] < b[0]) {\n      int last = -1;\n      for (int i = 0; i < r - l >> 1; ++i) {\n        if (a[i] > last) {\n          choose[a[i] - l] = choose[b[i] - l] = true;\n          last = b[i];\n        }\n      }\n      string result = \"\";\n      for (int i = 0; i < r - l; ++i) {\n        if (choose[i]) {\n          result += s[i + l];\n        }\n      }\n      return result;\n    } else {\n      string result = \"\";\n      for (int i = (r - l >> 1) - 1; ~i; --i) {\n        choose[a[i] - l] = choose[b[i] - l] = true;\n        string current = \"\";\n        for (int j = 0; j < r - l; ++j) {\n          if (choose[j]) {\n            current += s[j + l];\n          }\n        }\n        result = max(result, current);\n      }\n      return result;\n    }\n  };\n  for (int i = 1; i <= n << 1; ++i) {\n    if (!sum[i]) {\n      all.push_back(get(last, i));\n      last = i;\n    }\n  }\n  vector<string> dp(all.size() + 1, \"\");\n  for (int i = all.size() - 1; ~i; --i) {\n    dp[i] = max(dp[i + 1], all[i] + dp[i + 1]);\n  }\n  cout << dp[0] << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*{{{*/\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<set>\n#include<map>\n#include<queue>\n#include<bitset>\n#include<vector>\n#include<limits.h>\n#include<assert.h>\n#define SZ(X) ((int)(X).size())\n#define ALL(X) (X).begin(), (X).end()\n#define REP(I, N) for (int I = 0; I < (N); ++I)\n#define REPP(I, A, B) for (int I = (A); I < (B); ++I)\n#define FOR(I, A, B) for (int I = (A); I <= (B); ++I)\n#define FORS(I, S) for (int I = 0; S[I]; ++I)\n#define RS(X) scanf(\"%s\", (X))\n#define SORT_UNIQUE(c) (sort(c.begin(),c.end()), c.resize(distance(c.begin(),unique(c.begin(),c.end()))))\n#define GET_POS(c,x) (lower_bound(c.begin(),c.end(),x)-c.begin())\n#define CASET int ___T; scanf(\"%d\", &___T); for(int cs=1;cs<=___T;cs++)\n#define MP make_pair\n#define PB push_back\n#define MS0(X) memset((X), 0, sizeof((X)))\n#define MS1(X) memset((X), -1, sizeof((X)))\n#define LEN(X) strlen(X)\n#define F first\n#define S second\nusing namespace std;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef long double LD;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<LL> VL;\ntypedef vector<PII> VPII;\ntypedef pair<LL,LL> PLL;\ntypedef vector<PLL> VPLL;\ntemplate<class T> void _R(T &x) { cin >> x; }\nvoid _R(int &x) { scanf(\"%d\", &x); }\nvoid _R(LL &x) { scanf(\"%lld\", &x); }\nvoid _R(double &x) { scanf(\"%lf\", &x); }\nvoid _R(char &x) { scanf(\" %c\", &x); }\nvoid _R(char *x) { scanf(\"%s\", x); }\nvoid R() {}\ntemplate<class T, class... U> void R(T &head, U &... tail) { _R(head); R(tail...); }\ntemplate<class T> void _W(const T &x) { cout << x; }\nvoid _W(const int &x) { printf(\"%d\", x); }\nvoid _W(const LL &x) { printf(\"%lld\", x); }\nvoid _W(const double &x) { printf(\"%.16f\", x); }\nvoid _W(const char &x) { putchar(x); }\nvoid _W(const char *x) { printf(\"%s\", x); }\ntemplate<class T,class U> void _W(const pair<T,U> &x) {_W(x.F); putchar(' '); _W(x.S);}\ntemplate<class T> void _W(const vector<T> &x) { for (auto i = x.begin(); i != x.end(); _W(*i++)) if (i != x.cbegin()) putchar(' '); }\nvoid W() {}\ntemplate<class T, class... U> void W(const T &head, const U &... tail) { _W(head); putchar(sizeof...(tail) ? ' ' : '\\n'); W(tail...); }\n#ifdef HOME\n #define DEBUG(...) {printf(\"# \");printf(__VA_ARGS__);puts(\"\");}\n#else\n #define DEBUG(...)\n#endif\nint MOD = 1e9+7;\nvoid ADD(LL& x,LL v){x=(x+v)%MOD;if(x<0)x+=MOD;}\n/*}}}*/\nconst int SIZE = 6e3+10;\nchar s[SIZE];\nint far[SIZE];\nPII pp[SIZE];\nstring dp[SIZE];\nint id[SIZE];\nchar tmp[SIZE];\nint main(){\n    int n; R(n);\n    RS(s);\n    int it[2]={};\n    REP(i,2*n){\n        if(s[i]=='a'){\n            id[i]=it[0];\n            pp[it[0]++].F=i;\n        }\n        else {\n            id[i]=it[1];\n            pp[it[1]++].S=i;\n        }\n    }\n    for(int i=n-1;i>=0;i--){\n        if(pp[i].F<pp[i].S){\n            dp[i]=\"ab\";\n            REPP(j,i+1,n){\n                if(min(pp[j].F,pp[j].S)>pp[i].S){\n                    dp[i]=\"ab\"+dp[j];\n                    break;\n                }\n            }\n        }\n        else{\n            if(i+1<n&&pp[i+1].S<pp[i].F&&far[i+1])far[i]=far[i+1];\n            else far[i]=i;\n            int len=0;\n            REPP(j,pp[i].S,2*n){\n                if(id[j]>=i&&id[j]<=far[i])tmp[len++]=s[j];\n            }\n            tmp[len]=0;\n            dp[i]=string(tmp);\n            REPP(j,far[i]+1,n){\n                if(min(pp[j].F,pp[j].S)>pp[far[i]].F){\n                    dp[i]+=dp[j];\n                    break;\n                }\n            }\n        }\n        if(i+1<n)dp[i]=max(dp[i],dp[i+1]);\n    }\n    W(dp[0]);\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\ntemplate<typename S, typename T>\nvoid xmin(S&a, T const&b){if(b<a) a=b;}\ntemplate<typename S, typename T>\nvoid xmax(S&a, T const&b){if(b>a) a=b;}\n\nsigned main()\n{\n    #ifdef LOCAL_RUN\n    freopen(\"in.txt\", \"r\", stdin);\n    //freopen(\"out.txt\", \"w\", stdout);\n    cin.tie(0); cout.tie(0); ios_base::sync_with_stdio(false);\n    int TTT; cin >> TTT; while(TTT--){\n    #else\n    cin.tie(0); cout.tie(0); ios_base::sync_with_stdio(false);\n    #endif // LOCAL_RUN\n\n    int n, m;\n    cin >> m;\n    n = 2*m;\n    string s;\n    cin >> s;\n    vector<int> A, B, index(n);\n    for(int i=0;i<n;++i){\n        if(s[i] == 'a'){\n            index[i] = A.size();\n            A.push_back(i);\n        } else {\n            index[i] = B.size();\n            B.push_back(i);\n        }\n    }\n    assert((int)A.size() == m && (int)B.size() == m);\n    vector<string> suffs(n+1, string(\"\"));\n    for(int i=n-1;i>=0;--i){\n        string &cand = suffs[i];\n        cand = suffs[i+1];\n\n        if(s[i] == 'a'){\n            int b = B[index[i]];\n            if(b < i) continue;\n            string t = string(\"ab\") + suffs[b+1];\n            xmax(cand, t);\n        } else {\n            int a = A[index[i]];\n            if(a < i) continue;\n            string t = \"b\";\n            for(int j=i+1;j<=a;++j){\n                if(s[j] == 'a'){\n                    if(i <= B[index[j]]){\n                        assert(B[index[j]]<j);\n                        t.push_back('a');\n                    }\n                } else {\n                    assert(A[index[j]] > a);\n                    a = A[index[j]];\n                    t.push_back('b');\n                }\n            }\n            t+=suffs[a+1];\n            xmax(cand, t);\n        }\n        //cerr << i << \" \" << suffs[i] << \"\\n\";\n    }\n\n    cout << suffs[0] << \"\\n\";\n\n\n    #ifdef LOCAL_RUN\n    }\n    #endif // LOCAL_RUN\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ui unsigned int\n#define ull unsigned long long\n#define db long double\n#define pii pair<int,int>\n#define pli pair<ll,int>\n#define X first\n#define Y second\n#define mp make_pair\n#define pb push_back\n#define vi vector<int>\n#define vii vector<vi>\n#define lb lower_bound\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\n#define per(i,b,a) for(int i=(b);i>=(a);--i)\n#define rep0(i,a,b) for(int i=(a);i<(b);++i)\n#define fore(i,a) for(int i=0;i<a.size();++i)\n#define gc() getchar()\n#define ls x<<1,l,m\n#define rs x<<1|1,m+1,r\ninline ll rd()\n{\n\tll x=0,w=1;char c=gc();while(!isdigit(c)&&c!='-')c=gc();\n\tif(c=='-')c=gc(),w=-1;while(isdigit(c))x=x*10+c-48,c=gc();return x*w;\n}\nint n;string S,T,ans;\nvector<string>V;\nstring sol(string s)\n{\n\tint m=s.size();string res=\"\";vi p1,p2;\n\trep0(i,0,m)if(s[i]=='a')p1.pb(i);else p2.pb(i);\n\tif(s[0]=='a')\n\t{\n\t\tint lst=-1;\n\t\tfore(i,p1)if(p1[i]>lst)lst=p2[i],res+=\"ab\";\n\t\treturn res;\n\t}\n\tfore(i,p1)\n\t{\n\t\tint x=i,y=i;string t=\"\";\n\t\twhile(true)\n\t\t{\n\t\t\tif(x<p1.size()&&(y==p2.size()||p1[x]<p2[y]))t+=\"a\",x++;\n\t\t\telse if(y<p2.size())t+=\"b\",y++;\n\t\t\telse break;\n\t\t}\n\t\tres=max(res,t);\n\t}\n\treturn res;\n}\nint main()\n{\n\tn=rd();cin>>S;int c=0;T=\"\";ans=\"\";\n\trep0(i,0,n*2)\n\t{\n\t\tif(S[i]=='a')c++;else c--;\n\t\tT+=S[i];if(!c){V.pb(T);T=\"\";}\n\t}\n\tfore(i,V)V[i]=sol(V[i]);\n\tper(i,V.size()-1,0)ans=max(ans,V[i]+ans);\n\tcout<<ans<<endl;return 0;\n}\n "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[3300];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[0], tmpbs[0]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        if(tmpas.empty() || tmpas.back() < tmpbs.back() == as[i] < bs[i]){\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n        else{\n            string tmp = calc(tmpas, tmpbs);\n            while(!strs.empty() && strs.back() < tmp)strs.pop_back();\n            strs.push_back(tmp);\n            tmpas.clear();tmpbs.clear();\n        }\n    }\n    string tmp = calc(tmpas, tmpbs);\n    while(!strs.empty() && strs.back() < tmp)strs.pop_back();\n    strs.push_back(tmp);\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <string>\nint a[3005], b[3005], n;\nchar str[3005];\nstd::string work(int l, int r)\n{\n\tint L = n, R = -1;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tif (l <= a[i] && a[i] <= r)\n\t\t{\n\t\t\tL = std::min(L, i);\n\t\t\tR = std::max(R, i);\n\t\t}\n\t}\n\tstd::string ans;\n\tif (a[L] < b[L])\n\t{\n\t\tint lst = l - 1;\n\t\tfor (int i = L; i <= R; i++)\n\t\t{\n\t\t\tif (a[i] > lst)\n\t\t\t{\n\t\t\t\tans += \"ab\";\n\t\t\t\tlst = b[i];\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tfor (int i = L; i <= R; i++)\n\t{\n\t\tauto res = ans;\n\t\tres = \"\";\n\t\tfor (int j = l; j <= r; j++)\n\t\t{\n\t\t\tif ((str[j] == 'a' && j >= a[i]) || (str[j] == 'b' && j >= b[i]))\n\t\t\t\tres += str[j];\n\t\t}\n\t\tans = std::max(ans, res);\n\t}\n\treturn ans;\n}\nstd::string part[3005];\nint main()\n{\n\t// freopen(\"AGC026-E.in\", \"r\", stdin);\n\tscanf(\"%d%s\", &n, str);\n\tint cur = 0, lst = 0, cnt = 0, cnta = 0, cntb = 0;\n\tfor (int i = 0; i < n << 1; i++)\n\t\t(str[i] == 'a' ? a[cnta++] : b[cntb++]) = i;\n\tfor (int i = 0; i < n << 1; i++)\n\t{\n\t\tcur += str[i] == 'a' ? -1 : 1;\n\t\tif (!cur)\n\t\t{\n\t\t\tpart[cnt++] = work(lst, i);\n\t\t\tlst = i + 1;\n\t\t}\n\t}\n\tstd::string ans;\n\tfor (int i = cnt - 1; i >= 0; i--)\n\t\tans = std::max(ans, part[i] + ans);\n\tputs(ans.c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nconst int N=3040; \nstring s,f[N],g[N];\nint cnt1=0,cnt2=0,n,id1[2*N],id2[2*N],a[N],b[N];\n\nint main(){\n\tcin>>n>>s;\n\tfor(int i=0;i<2*n;++i){\n\t\tid1[i]=cnt1;id2[i]=cnt2;\n\t\tif(s[i]=='a')a[cnt1++]=i;\n\t\telse b[cnt2++]=i;\n\t}\n\tf[n]=g[n]=\"\";\n\tfor(int i=n-1;i>=0;--i){\n\t\tg[i]=g[i+1];\n\t\tint u=a[i],v=b[i];\n\t\tif(u<v)f[i]=\"ab\"+g[id1[v]];\n\t\telse{\n\t\t\tint j=i+1;for(;j<n&&b[j]<a[j-1];++j);\n\t\t\tfor(int p=i,q=i;p!=j||q!=j;)\n\t\t\t\tif(p!=j&&(q==j||a[p]<b[q]))f[i]+='a',++p;\n\t\t\t\telse f[i]+='b',++q;\n\t\t\tf[i]+=g[j];\n\t\t}\n\t\tg[i]=max(f[i],g[i+1]);\n\t}\n\tcout<<g[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <algorithm>\n#include <string>\nusing namespace std;\n\nint N; char S[6060];\nint A[3030],B[3030],C[6060];\n\nint main()\n{\n\tscanf (\"%d %s\",&N,S);\n\tA[0] = B[0] = -1;\n\tfor (int i=0,a=0,b=0;i<N*2;i++){\n\t\tif (S[i] == 'a') A[++a] = i;\n\t\tif (S[i] == 'b') B[++b] = i;\n\t}\n\n\tstring ans = \"\", best = \"\";\n\tint la = N*2+1, lb = N*2+1, lm = N*2+1;\n\tfor (int i=N;i>=0;i--) if (A[i] >= B[i]){\n\n\t\tif (A[i] < lb) best = ans, lm = lb;\n\n\t\tif (i){\n\t\t\tC[A[i]] = C[B[i]] = 1;\n\t\t\tstring now = \"\";\n\t\t\tfor (int j=B[i];j<lm;j++) if (C[j]) now += S[j];\n\n\t\t\tstring mk = now + best;\n\t\t\tif (ans < mk)\n\t\t\t\tans = move(mk);\n\t\t}\n\n\t\tla = A[i]; lb = B[i];\n\t}\n\n\tif (ans == \"\"){\n\t\tint l = -1;\n\t\tfor (int i=1;i<=N;i++) if (l < A[i]){\n\t\t\tans += \"ab\";\n\t\t\tl = B[i];\n\t\t}\n\t}\n\tputs(ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<vector>\nusing namespace std;\nvector<string> str,damn;\nvector<string> lis;\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tint n,i,j,k,l,lst=0,numa=0,numb=0,ite,nowa=0,nowb=0;\n\tstring s,t,hix;\n\tcin>>n>>s;\n\tfor(i=0;i<2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tnuma++;\n\t\t}\n\t\telse{\n\t\t\tnumb++;\n\t\t}\n\t\tif(numa==numb){\n\t\t\tstr.push_back(s.substr(lst,i-lst+1));\n\t\t\tlst=i+1;\n\t\t}\n\t}\n\tfor(i=0;i<str.size();i++){\n\t\tt=str[i];\n\t\thix=\"\";\n\t\tif(t[0]=='a'){\n\t\t\tite=0;\n\t\t\tnowa=0;\n\t\t\tnowb=0;\n\t\t\twhile(ite<t.size()){\n\t\t\t\twhile(ite<t.size()&&t[ite]=='b'){\n\t\t\t\t\tite++;\n\t\t\t\t\tnowb++;\n\t\t\t\t}\n\t\t\t\tif(ite==t.size()){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\thix+=\"ab\";\n\t\t\t\tj=nowa+1;\n\t\t\t\twhile(j>nowb){\n\t\t\t\t\tif(t[ite]=='b'){\n\t\t\t\t\t\tnowb++;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tnowa++;\n\t\t\t\t\t}\n\t\t\t\t\tite++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(damn.size()){\n\t\t\t\tt=damn.back();\n\t\t\t}\n\t\t\tif(damn.size()&&t[0]=='a'){\n\t\t\t\tt+=hix;\n\t\t\t\tdamn.pop_back();\n\t\t\t\tdamn.push_back(t);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdamn.push_back(hix);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tnowb=0;\n\t\t\tfor(j=0;j<t.size();j++){\n\t\t\t\tif(t[j]=='b'){\n\t\t\t\t\tnowb++;\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnowb--;\n\t\t\t\t}\n\t\t\t\thix=max(hix,string(nowb,'b')+t.substr(j+1,t.size()-j-1));\n\t\t\t}\n\t\t\tdamn.push_back(hix);\n\t\t}\n\t}\n\tfor(i=0;i<damn.size();i++){\n\t\twhile(lis.size()&&lis.back()<damn[i]){\n\t\t\tlis.pop_back();\n\t\t}\n\t\tlis.push_back(damn[i]);\n\t}\n\tfor(i=0;i<lis.size();i++){\n\t\tcout<<lis[i];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N], sx[N];\nbool u[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    string str;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        str.pb(c);\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            forn(j, p[i], p[i + 1] - 1)\n                u[j] = 1;\n            int cnt = p[i + 1] - p[i], len = 1;\n            for (; len <= p[i + 1] - p[i]; ++len) {\n                //cerr << len << \"\\n\";\n                int mx = -1;\n                forn(j, p[i], p[i + 1] - 1) {\n                    if (!u[j]) continue;\n                    if (j + (len - bal[j - 1]) - 1 >= p[i + 1])\n                        u[j] = 0, --cnt;\n                    else\n                        mx = max(mx, len <= bal[j - 1] ? 'b' : a[j + len - bal[j - 1] - 1]);\n                }\n                forn(j, p[i], p[i + 1] - 1) {\n                    if (!u[j]) continue;\n                    if ((len <= bal[j - 1] ? 'b' : a[j + len - bal[j - 1] - 1]) != mx) u[j] = 0, --cnt;\n                }\n                if (cnt == 1) break;\n            }\n            assert(cnt == 1);\n\n            forn(j, p[i], p[i + 1] - 1) {\n                if (!u[j]) continue;\n                ans = ans + string(bal[j - 1], 'b')\n                    + str.substr(j - 1, len - bal[j - 1])\n                    + string(bal[j + len - bal[j - 1] - 1], 'a');\n                break;\n            }\n        }\n        else {\n            if (i < lst) continue;\n            forn(j, p[i], p[i + 1] - 1)\n                if (a[j] == 1 && a[j - 1] == 0)\n                    ans.pb('a'), ans.pb('b');\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<string>\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> P;\n\n#define fr first\n#define sc second\n\nint N;\nstring S;\n\nbool comp(string x,string y){\n\tfor(int i = 0 ; i < min(x.size(),y.size()) ; i ++){\n\t\tif(x[i] != y[i]){\n\t\t\treturn x[i] > y[i];\n\t\t}\n\t}\n\treturn x.size() > y.size();\n}\n\nbool eq(string x,string y){\n\tif(x.size() != y.size())return false;\n\tfor(int i = 0 ; i < x.size() ; i ++){\n\t\tif(x[i] != y[i])return false;\n\t}\n\treturn true;\n}\n\nbool comp2(pair<string,int> x,pair<string,int> y){\n\tif(eq(x.fr,y.fr))return x.sc < y.sc;\n\treturn comp(x.fr,y.fr);\n}\n\nstring solve(int s,int t){\n\tif(S[s] == 'a'){\n\t\tstring ret = \"a\";\n\t\tfor(int i = s+1 ; i <= t ; i ++){\n\t\t\tif(ret[ret.size()-1] != S[i]){\n\t\t\t\tret += S[i];\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\tvector<string> vec;\n\tfor(int k = 0 ; k <= (t-s)/2 ; k ++){\n\t\tint cnt[2] = {};\n\t\tstring ret;\n\t\tfor(int i = s ; i <= t ; i ++){\n\t\t\tif(cnt[S[i]-'a'] == k)ret += S[i];\n\t\t\telse cnt[S[i]-'a'] ++;\n\t\t}\n\t\tvec.push_back(ret);\n\t}\n\tsort(vec.begin(),vec.end(),comp);\n\treturn vec[0];\n}\n\nint main(){\n\tcin >> N >> S;\n\t\n\tint cnt[6002] = {};\n\tfor(int i = 0 ; i < S.size() ; i++){\n\t\tcnt[i+1] = cnt[i]+1-2*(S[i]=='b'?1:0);\n\t}\n\tvector<pair<string,int>> vec;\n\tint l = 0;\n\tfor(int i = 0 ; i < S.size() ; i ++){\n\t\tif(cnt[i+1] == 0){\n\t\t\tstring s = solve(l,i);\n\t\t\tif(s[0] == 'a'){\n\t\t\t\tfor(int j = 0 ; j < s.size() ; j += 2){\n\t\t\t\t\tvec.push_back(pair<string,int>(\"ab\",(int)vec.size()));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse vec.push_back(pair<string,int>(s,(int)vec.size()));\n\t\t\tl = i+1;\n\t\t}\n\t}\n\t\n\tsort(vec.begin(),vec.end(),comp2);\n\tstring ret = \"\";\n\tint Max = -1;\n\tfor(int i = 0 ; i < vec.size() ; i ++){\n\t\tif(vec[i].sc > Max){\n\t\t\tMax = vec[i].sc;\n\t\t\tret += vec[i].fr;\n\t\t}\n\t}\n\tcout << ret << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = true;\n    int a = 0, b = 0, x = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') a++;\n      else b++;\n      if(flag){\n        if(S[i]=='a') res += 'a', x = a, flag = false;\n      }\n      else{\n        if(S[i]=='b' && b == x) res += 'b', flag = true;\n      }\n    }\n  }\n  else{\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(j,l,r){\n        if(S[j]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  string ans;\n  RREP(i,s.size()){\n    chmax(ans,s[i]+ans);\n  }\n\n  cout << ans << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\nЗАПУСКАЕМ \n░ГУСЯ░▄▀▀▀▄░РАБОТЯГУ░░\n▄███▀░◐░░░▌░░░░░░░\n░░░░▌░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▐░░░░░▐░░░░░░░\n░░░░▌░░░░░▐▄▄░░░░░\n░░░░▌░░░░▄▀▒▒▀▀▀▀▄\n░░░▐░░░░▐▒▒▒▒▒▒▒▒▀▀▄\n░░░▐░░░░▐▄▒▒▒▒▒▒▒▒▒▒▀▄\n░░░░▀▄░░░░▀▄▒▒▒▒▒▒▒▒▒▒▀▄\n░░░░░░▀▄▄▄▄▄█▄▄▄▄▄▄▄▄▄▄▄▀▄\n░░░░░░░░░░░▌▌░▌▌░░░░░\n░░░░░░░░░░░▌▌░▌▌░░░░░\n░░░░░░░░░▄▄▌▌▄▌▌░░░░░ \n */\n#include <iostream>\n#include <complex>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <cstring>\n#include <ctime>\n#include <cstdlib>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <list>\n#include <cmath>\n#include <bitset>\n#include <cassert>\n#include <queue>\n#include <stack>\n#include <deque>\n    \n     \nusing namespace std;\ntemplate<typename T1, typename T2>inline void chkmin(T1 &x, T2 y) { if (x > y) x = y; }\ntemplate<typename T1, typename T2>inline void chkmax(T1 &x, T2 y) { if (x < y) x = y; } \ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const pair<T, U> &_p) { _out << _p.first << ' ' << _p.second; return _out; }\ntemplate<typename T, typename U> inline istream &operator>> (istream &_in, pair<T, U> &_p) { _in >> _p.first >> _p.second; return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const vector<T> &_v) { if (_v.empty()) { return _out; } _out << _v.front(); for (auto _it = ++_v.begin(); _it != _v.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline istream &operator>> (istream &_in, vector<T> &_v) { for (auto &_i : _v) { _in >> _i; } return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const unordered_map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\n#define sz(c) (int)(c).size()\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define left left228\n#define right right228\n#define next next228\n#define rank rank228\n#define prev prev228\n#define y1 y1228                                                         \n#define read(FILENAME) freopen((FILENAME + \".in\").c_str(), \"r\", stdin)\n#define write(FILENAME) freopen((FILENAME + \".out\").c_str(), \"w\", stdout)\n#define files(FILENAME) read(FILENAME), write(FILENAME)\n#define pb push_back\nconst string FILENAME = \"input\";\nconst int MAXN = 3001;\n\n\nint n;\nstring s;\nbool used[MAXN];\n\n\nstring get(string a) {\n\tvector<int> ga, gb;\n\tfor (int i = 0; i < sz(a); i++) {\n\t \tif (a[i] == 'a') {\n\t \t\tga.pb(i);\n\t \t} else {\n\t \t\tgb.pb(i);\n\t \t}\n\t}\n\tif (ga[0] < gb[0]) {\n\t\tstring cur;\n\t\tcur = \"ab\";\n\t\tint last = gb[0];\n\t\tfor (int i = 1; i < sz(ga); i++) {\n\t\t\tif (last < ga[i]) {\n\t\t\t\tcur += \"ab\";\n\t\t\t\tlast = gb[i];\n\t\t\t}\n\t\t}\n\t\treturn cur;\n\t} else {\n\t\tstring opt;\n\t\tfor (int i = sz(ga) - 1; i >= 0; i--) {\n\t\t\tmemset(used, 0, sizeof(used));\n\t\t\tfor (int j = i; j < sz(ga); j++) {\n\t\t\t\tused[ga[j]] = true;\n\t\t\t}\n\t\t\tfor (int j = i; j < sz(gb); j++) {\n\t\t\t\tused[gb[j]] = true;\n\t\t\t}\n\t\t\tstring b;\n\t\t\tfor (int j = 0; j < sz(a); j++) {\n\t\t\t\tif (used[j]) {\n\t\t\t\t\tb += a[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tchkmax(opt, b);\n\t\t}\n\t\treturn opt;\n\t}\n}\n\n\n\nstring dp[MAXN];\n\n\nint main() {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\t//read(FILENAME);\n\tcin >> n;\n\tcin >> s;\n\tstring cur;\n\tint bal = 0;\n\tvector<string> st;\n\tfor (int i = 0; i <\t2 * n; i++) {\n\t\tcur += s[i];\n\t\tif (s[i] == 'a') {\n\t\t\tbal++;\n\t\t} else {\n\t\t\tbal--;\n\t\t}\n\t\tif (bal == 0) {\n\t\t\tst.pb(get(cur));\n\t\t\tcur.clear();\n\t\t}\n\t}\n\tfor (int i = sz(st) - 1; i >= 0; i--) {\n\t\t//cout << st[i] << endl;\n\t\tdp[i] = st[i];\n\t\tchkmax(dp[i], dp[i + 1]);\n\t\tchkmax(dp[i], st[i] + dp[i + 1]);\n\t}\n\tcout << dp[0] << '\\n';\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N];\nstring str[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            str[i] = cans;\n        }\n        else {\n            if (i < lst) continue;\n            int cnt = 0;\n            string cur;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    cur.pb('a'), cur.pb('b');\n                    cnt = 0;\n                }\n            }\n            str[i] = cur;\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    for1(i, p.size() - 2, 0)\n        sx[i] = max(sx[i + 1], str[i]);\n    forn(i, 0, p.size() - 2)\n        if (str[i] == sx[i])\n            ans = ans + str[i];\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 3005;\n\nint n, posa[N], posb[N], cnta = 0, cntb = 0;\nstring str, f[N];\nbool choose[N << 1];\n\nint main () {\n\tcin >> n >> str;\n\tfor (int i = 0; i < (n << 1); i++) {\n\t\tif (str[i] == 'a') posa[cnta++] = i;\n\t\telse posb[cntb++] = i;\n\t}\n\n\tfor (int i = n - 1; i >= 0; i--) {\n\t\tif (posa[i] < posb[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j < n && min(posa[j], posb[j]) <= posb[i]) j++;\n\t\t\tf[i] = max(f[i + 1], \"ab\" + f[j]);\n\t\t}\n\t\telse {\n\t\t\tint k = i;\n\t\t\tfor (int j = 0; j < (n << 1); j++) choose[j] = false;\n\t\t\tfor (int j = i; k < n && posb[k] <= posa[j]; k++) {\n\t\t\t\tif (posb[k] < posa[k]) {\n\t\t\t\t\tchoose[posa[k]] = choose[posb[k]] = true;\n\t\t\t\t\tj = k;\n\t\t\t\t}\n\t\t\t}\n\t\t\tf[i] = f[k];\n\t\t\tfor (int j = (n << 1) - 1; j >= 0; j--) {\n\t\t\t\tif (choose[j]) f[i] = str[j] + f[i];\n\t\t\t}\n\t\t\tf[i] = max(f[i], f[i + 1]);\n\t\t}\n\t}\n\n\tcout << f[0] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#ifdef DEBUG\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define debug(...)\n#endif\n\n#ifdef __WIN32\n#define LLFORMAT \"I64\"\n#define Rand() ((rand() << 15) + rand())\n#else\n#define LLFORMAT \"ll\"\n#define Rand() (rand())\n#endif\n\nusing namespace std;\n\nconst int maxn = 3030;\n\nint n, sb[maxn];\nstring s, dp[maxn];\nset<pair<int, int> > ab, ba;\n\nint cntb(int l, int r) { return sb[r] - (l ? sb[l - 1] : 0); }\n\nvoid upd(string &s, const string &t) {\n\tfor (int i = 0; i < s.size() && i < t.size(); ++i) if(s[i] != t[i]) { if(s[i] < t[i]) s = t; return; }\n\tif(s.size() < t.size()) s = t;\n\treturn;\n}\n\nstring DP(int beg) {\n\tif(beg == n) return \"\";\n\tauto &dp = ::dp[beg]; if(dp.size() != 0) return dp;\n\tauto it = ba.lower_bound(make_pair(beg, -1));\n\tif(it == ba.end()) {\n\t\tint lst = beg - 1;\n\t\tit = ab.lower_bound(make_pair(beg, -1));\n\t\twhile(it != ab.end()) {\n\t\t\tif(it->first > lst) dp += \"ab\", lst = it->second;\n\t\t\t++it;\n\t\t}\n\t\treturn dp;\n\t}\n\tint mx = -1;\n\tvector<int> nxt;\n\tmemset(sb, 0, sizeof sb);\n\tfor (auto t = ba.lower_bound(make_pair(beg, -1)); t != ba.end(); ++t) sb[t->first] = 1;\n\tfor (int i = beg + 1; i < n; ++i) sb[i] += sb[i - 1];\n\twhile(it != ba.end()) {\n\t\tint foo = cntb(it->first, it->second);\n\t\tif(foo > mx) mx = foo, nxt.clear();\n\t\tif(foo == mx) nxt.push_back(it->first);\n\t\t++it;\n\t}\n\tif(nxt.size() && nxt[0] == beg) {\n\t\tit = ba.lower_bound(make_pair(beg, -1));\n\t\tvector<int> tmp; int lst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t++it;\n\t\twhile(it != ba.end()) {\n\t\t\tif(it->first > lst) break;\n\t\t\tlst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t\t++it;\n\t\t}\n\t\tsort(tmp.begin(), tmp.end());\n\t\tfor (int i: tmp) dp += s[i];\n\t\tdp += DP(tmp.back() + 1);\n\t\tupd(dp, DP(beg + 1));\n\t\treturn dp;\n\t}\n\treturn dp = DP(beg + 1);\n}\n\nint main() {\n\tcin >> n >> s; n *= 2;\n\tfor (int i = 0; i < n; ++i) sb[i] = (s[i] == 'b');\n\tfor (int i = 1; i < n; ++i) sb[i] += sb[i - 1];\n\tfor (int pb = -1, pa = 0; pa < n; ++pa) if(s[pa] == 'a') {\n\t\t++pb; while(s[pb] != 'b') ++pb;\n\t\tif(pa < pb) ab.insert(make_pair(pa, pb));\n\t\telse ba.insert(make_pair(pb, pa));\n\t}\n\tcout << DP(0) << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nstring f[6005];\nint id[6005];\nstring st;\nint pos[2][6005];\nint rep[2][6005];\n#define aa 0\n#define bb 1\n\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(st[i]=='a')rep[0][i]=++pos[0][0],pos[0][pos[0][0]]=i;\n\t\telse rep[1][i]=++pos[1][0],pos[1][pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[aa][i]<<\" \"<<pos[bb][i]<<endl;\n\t}\n\t*/\n\tint t=0;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(pos[aa][i]<pos[bb][i])\n\t\t{\n\t\t\tfor(int j=pos[aa][i]+1,t=i;j<pos[bb][i];j++)t=max(t,max(rep[aa][j],rep[bb][j]));\n\t\t\tf[i]+=\"ab\";\n\t\t\tf[i]+=f[t+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tt=i;\n\t\t\twhile(t<=n&&pos[bb][t+1]<pos[aa][t])t++;\n\t\t\tfor(int j=pos[bb][i];j<=2*n;j++)if(i<=max(rep[aa][j],rep[bb][j])&&max(rep[aa][j],rep[bb][j])<=t)f[i]+=st[j];\n\t\t\tf[i]+=f[t+1];\n\t\t}\n\t}\n\tstring mx=\"\";\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tmx=max(mx,f[i]);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*----------------by syr----------------*/\n/*\n\n         iii                  ii\n     rBQBBBBBBE       BBR iBBBBQBBL     XBBBBBBQBBBBB\n   iBBQJ    7BBB      BBsSBBr   BBQ      i      cBBB\n  rBBU       iBBw     BBBQi     HBBi           KBBi\n  BBH         BB5    iBBB       isL          wBB5\n GBB         iBBi    6BB                   iBBB\n BBQ         BQB     BBD                  QBBi\n BBB        BQB     iQBi                1BBv\n sBBg     wBBB      QBB               iBBB\n  7BBBBBBBBBi       BBR              wBBBBBBBBBBBBB\n     irvi           ii               ii    i i iii\n                i5U\n               BBB\n               BB7\n              1BB\n      iPBBBBBKBBR    JBR1       rQBO   BR  UBQP  iBBQi\n    7BBBGs7sXBBBi     QBBr     gBBE   rBB BB2BB7HBZQBB\n   QBBi      sBQ       BBB   iBBB     SQBBR  BBBB  cBQ\n  gBQ        BBg        BBB KBBi      MBBH   BBB   BBs\n iBBv       iBBi         QBBBL        BBR   pBB   iBB\n pBB        BBB         iBBBB        iBB    BBL   KBB\n MBB       BBBR        BBB JBBi      DBR   iBQ    BBL\n GBB     7BBBB2      PBBH   BBBi     BQr   DBB   iBB\n  BQBXwgBBP BB7    1BBB      BBQ7   1BB    BBc   BBB\n   2BBBBw   BB    EBBS        QBBi  HBa   iBB    BB7\n*/\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define PH push\n#define MP make_pair\n#define PB push_back\n#define fst first\n#define snd second\n#define FOR(i, x, y) for(int i = (x); i < (y); ++i)\n#define REP(i, x, y) for(int i = (x); i <= (y); ++i)\n#define x0 x0123456789\n#define y0 y0123456789\n#define x1 x1234567890\n#define y1 y1234567890\n#define x2 x2345678901\n#define y2 y2345678901\ntypedef double db;\ntypedef long long ll;\ntypedef long double ldb;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int INF = 1e9 + 7;\nconst int maxn = 6005;\n\nint n, cnta, cntb;\nint toOrd[maxn], aPos[maxn], bPos[maxn];\nstring s;\nstring dp[maxn];\n\nstring getStr(const vector<int> &vec){\n\tstring ret = \"\";\n\tFOR(i, 0, vec.size())\n\t\tret += s[vec[i] - 1];\n\treturn ret;\n}\n\nint main(){\n\tcin >> n >> s;\n\tREP(i, 1, n << 1){\n\t\tif(s[i - 1] == 'a'){\n\t\t\ttoOrd[i] = cnta;\n\t\t\taPos[cnta] = i;\n\t\t\tcnta++;\n\t\t}\n\t\telse{\n\t\t\ttoOrd[i] = cntb;\n\t\t\tbPos[cntb] = i;\n\t\t\tcntb++;\n\t\t}\n\t}\n\t//REP(i, 1, n << 1)\n\t\t//cout << toOrd[i] << \" \";\n\tcout << endl;\n\tfor(int i = n - 1; i >= 0; --i){\n\t\tint ap = aPos[i], bp = bPos[i];\n\t\tif(ap < bp){\n\t\t\tint mx = i;\n\t\t\tFOR(j, ap + 1, bp){\n\t\t\t\tmx = max(mx, toOrd[j]);\n\t\t\t}\n\t\t\tdp[i] = dp[mx + 1];\n\t\t\tdp[i] = \"ab\" + dp[i];\n\t\t}\n\t\telse{\n\t\t\tint mx = i;\n\t\t\tfor(; mx + 1 < n && aPos[mx] > bPos[mx + 1]; ++mx);\n\t\t\t//cout << \"i = \" << i << \"mx = \" << mx << endl;\n\t\t\tREP(j, 1, n << 1) if(toOrd[j] >= i && toOrd[j] <= mx)\n\t\t\t\tdp[i] += s[j - 1];\n\t\t\tdp[i] += dp[mx + 1];\n\t\t}\n\t\tdp[i] = max(dp[i], dp[i + 1]);\n\t}\n\t//FOR(i, 0, n)\n\t\t//cout << dp[i] << endl;\n\tcout << dp[0] << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MAXN 6010\n\nint n,n2,m1,m2,m;\nchar s[MAXN];\nint p1[MAXN],p2[MAXN],id[MAXN];\nint s1[MAXN];\nint a[MAXN],b[MAXN];\nint h[MAXN][MAXN],len[MAXN];\nint ans[MAXN];\nbool visit[MAXN];\n\nint getS1(int l,int r){ return s1[r]-s1[l-1]; }\nint getS2(int l,int r){ return r-l+1-s1[r]+s1[l-1]; }\n\nbool cmp(int x,int y){\n\tfor(int i=1;i<=len[x] && i<=len[y];i++)\n\t\tif(h[x][i]^h[y][i]) return h[x][i]<h[y][i];\n\treturn len[x]<len[y];\n}\n\nint main(){\n#ifdef DEBUG\n\tfreopen(\"E.in\",\"r\",stdin);\n#endif\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tn2=n<<1;\n\tfor(int i=1;i<=n2;i++)\n\t\tif(s[i]=='a') p1[++m1]=i,id[i]=m1;\n\t\telse p2[++m2]=i,id[i]=m2;\n\tfor(int i=1;i<=n2;i++) s1[i]=s1[i-1]+(s[i]=='a'?1:0);\n\tfor(int i=1;i<=n;i++)\n\t\tif(p2[i]<p1[i])\n\t\t\ta[p2[i]]=getS2(p2[i],p1[i]);\n\tbool flag=0;\n\tint last=n2+1,lastp=n2+1;\n\tfor(int i=n2;i>=1;i--)\n\t\tif(getS1(i,n2)==getS2(i,n2)){\n\t\t\tif(s[i]=='b'){\n\t\t\t\tflag=1;\n\t\t\t\tfor(int j=last-1;j>=i;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tfor(int k=j;k<last;k++)\n\t\t\t\t\t\t\tif(s[k]=='b')\n\t\t\t\t\t\t\t\th[j][++len[j]]=a[k];\n\t\t\t\t\t\tfor(int k=m;k>=1;k--)\n\t\t\t\t\t\t\th[j][++len[j]]=b[k];\n\t\t\t\t\t}\n\t\t\t\tint res=i;\n\t\t\t\tfor(int j=i+1;j<last;j++)\n\t\t\t\t\tif(s[j]=='b' && cmp(res,j))\n\t\t\t\t\t\tres=j;\n\t\t\t\tfor(int j=last-1;j>=res;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tb[++m]=a[j];\n\t\t\t\t\t\tans[m]=id[j];\n\t\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(!flag) lastp=i;\n\t\t\t}\n\t\t\tlast=i;\n\t\t}\n\tfor(int i=1;i<=m;i++) visit[p1[ans[i]]]=visit[p2[ans[i]]]=1;\n\tfor(int i=1;i<=n2;i++) if(visit[i]) putchar(s[i]);\n\tint j=lastp-1;\n\tfor(int i=lastp;i<=n2;i++)\n\t\tif(s[i]=='a' && i>j){\n\t\t\tputchar('a'); putchar('b');\n\t\t\tj=p2[id[i]];\n\t\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#ifndef LOCAL\n#pragma GCC optimize(\"O3\")\n#endif\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define sim template < class c\n#define ris return * this\n#define dor > debug & operator <<\n#define eni(x) sim > typename \\\n  enable_if<sizeof dud<c>(0) x 1, debug&>::type operator<<(c i) {\nsim > struct rge { c b, e; };\nsim > rge<c> range(c i, c j) { return rge<c>{i, j}; }\nsim > auto dud(c* x) -> decltype(cerr << *x, 0);\nsim > char dud(...);\nstruct debug {\n#ifdef LOCAL\n~debug() { cerr << endl; }\neni(!=) cerr << boolalpha << i; ris; }\neni(==) ris << range(begin(i), end(i)); }\nsim, class b dor(pair < b, c > d) {\n  ris << \"(\" << d.first << \", \" << d.second << \")\";\n}\nsim dor(rge<c> d) {\n  *this << \"[\";\n  for (auto it = d.b; it != d.e; ++it)\n    *this << \", \" + 2 * (it == d.b) << *it;\n  ris << \"]\";\n}\n#else\nsim dor(const c&) { ris; }\n#endif\n};\n#define imie(...) \" [\" << #__VA_ARGS__ \": \" << (__VA_ARGS__) << \"] \"\n\ntypedef long long ll;\n\n\n\nint main() {\n\tint n;\n\tcin >> n;\n\tn *= 2;\n\tstring s;\n\tcin >> s;\n\t\n\tvector<int> a, b;\n\tfor(int i = 0; i < n; ++i) {\n\t\tif(s[i] == 'a') a.push_back(i);\n\t\telse b.push_back(i);\n\t}\n\tvector<int> his(n);\n\tfor(int i = 0; i < n / 2; ++i) {\n\t\this[a[i]] = b[i];\n\t\this[b[i]] = a[i];\n\t}\n\t\n\tvector<string> dp(n + 1);\n\tfor(int i = n - 1; i >= 0; --i) {\n\t\tdp[i] = dp[i+1];\n\t\tif(his[i] > i) {\n\t\t\tif(s[i] == 'a') {\n\t\t\t\tdp[i] = max(dp[i], \"ab\" + dp[his[i] + 1]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvector<bool> taken(n);\n\t\t\ttaken[i] = taken[his[i]] = true;\n\t\t\tint rightmost = his[i];\n\t\t\tfor(int k = i + 1; k < rightmost; ++k) if(s[k] == 'b') {\n\t\t\t\ttaken[k] = taken[his[k]] = true;\n\t\t\t\trightmost = his[k];\n\t\t\t}\n\t\t\tstring maybe;\n\t\t\tfor(int k = i; k <= rightmost; ++k) if(taken[k]) maybe += s[k];\n\t\t\tmaybe += dp[rightmost+1];\n\t\t\tdp[i] = max(dp[i], maybe);\n\t\t\tdebug() << imie(i) imie(maybe);\n\t\t}\n\t}\n\tcout << dp[0] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 6010;\n\nstring dp[N]; char s[N];\n\nint a[N], b[N], bel[N], mark[N];\n\nint main() {\n    int n; scanf(\"%d%s\", &n, s + 1);\n    for (int i = 1, ct1 = 0, ct2 = 0; i <= n * 2; i++) {\n        if (s[i] == 'a') a[++ct1] = i, bel[i] = ct1;\n        else b[++ct2] = i, bel[i] = ct2;\n    }\n    for (int i = n; i >= 1; i--) {\n        dp[i] = dp[i + 1];\n        if (b[i] > a[i]) {\n            int pos = i + 1;\n            while (pos <= n && min(a[pos], b[pos]) <= b[i]) pos++;\n            dp[i] = max(dp[i], \"ab\" + dp[pos]);\n        } else {\n            int r = a[i]; string tmp; memset(mark, 0, sizeof(mark));\n            mark[b[i]] = mark[r] = 1;\n            for (int j = b[i] + 1; j < r; j++) if (s[j] == 'b') \n                r = max(r, a[bel[j]]), mark[j] = mark[a[bel[j]]] = 1;\n            for (int j = b[i]; j <= n * 2; j++) if (mark[j]) tmp += s[j];\n            int pos = bel[r] + 1;\n            while (pos <= n && min(a[pos], b[pos]) <= r) pos++;\n            dp[i] = max(dp[i], tmp + dp[pos]);\n        }\n    }\n    cout << dp[1] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define N 10000\n#define M 1000005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Max[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Max(int x,int y) {\n\tif(f[x]<N&&f[y]>N) return 0;\n\tif(f[x]>N&&f[y]<N) return 1;\n\tif(f[x]<N) return f[x]>=f[y];\n\tif(f[x]/N>f[y]/N||(f[x]/N==f[y]/N&&check(f[y]%N,R[y],f[x]%N,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n//\tfreopen(\"a.in\",\"r\",stdin);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\t//cout<<\"-_-\"<<l<<\" \"<<r<<endl;\n\t\tif(s[l]=='a') {\n\t\t\tshu=0;\n\t\t\tfor1(l,r,i) {\n\t\t\t\t/*\n\t\t\t\t这么低级的错误，你会c++吗！！！\n\t\t\t\tif(s[i]=='a'&&!shu) ++f[be[l]],shu=1;\n\t\t\t\telse shu=0;\n\t\t\t\t*/\n\t\t\t\tif(s[i]=='a') f[be[l]]+=!shu,shu=1;\n\t\t\t\telse shu=0;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r-1,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*N+id;\n\t\t}\n\t}\n\t\n\t//abab是累加，不能比较字典序。。\n\tFOR2(be[0],1,i) {\n\t\tMax[i]=Max[i+1];\n\t\tif(f[i]>N&&check_Max(i,Max[i])) Max[i]=i;\n\t}\n\tfor1(1,be[0],i) if(!Max[i]) Max[i]=i;\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Max[pos+1];\n\t\tif(f[pos]>N) {\n\t\t\tFOR2(f[pos]/N,1,i) putchar('b');\n\t\t\tfor1(f[pos]%N,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010],num[6010];\nstring s;int n;\nstring cal(int l,int h){\n\tstring ret=\"\";\n\tif(a[l]<b[l]){\n\t\twhile(l<h){\n\t\t\tret+=\"ab\";\n\t\t\tint ne=l;\n\t\t\twhile(ne<n && a[ne]<b[l]) ne++;\n\t\t\tl=ne;\n\t\t}\n\t}\n\telse{\n\t\tREP(i,l,h){\n\t\t\tstring t=\"\";\n\t\t\tREP(j,l*2,h*2){\n\t\t\t\tif(num[j]>=i) t+=s[j];\n\t\t\t}\n\t\t\tret=max(ret,t);\n\t\t}\n\t}\n\treturn ret;\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0,now=0;\n\tvector<int> v;v.pb(0);\n\trep(i,n*2){\n\t\tif(s[i]=='a'){\n\t\t\ta[an]=i;num[i]=an++;now++;\n\t\t}\n\t\telse{\n\t\t\tb[bn]=i;num[i]=bn++;now--;\n\t\t}\n\t\tif(now==0) v.pb(i+1);\n\t}\n\tvector<string> ret;\n\trep(i,(int)v.size()-1) ret.pb(cal(v[i]/2,v[i+1]/2));\n\tstring out=\"\";\n\treverse(All(ret));\n\trep(i,ret.size()){\n\t\tif(out<ret[i]+out) out=ret[i]+out;\n\t}\n\tcout<<out<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint main(){\n    int n;\n    string str;\n    cin >> n >> str;\n    vector<bool> b(2 * n, false);\n\n    auto get = [&](){\n        string ret;\n        for(int i = 0; i < 2 * n; ++i)\n            if(b[i])\n                ret.push_back(str[i]);\n        return ret; };\n\n    vector<int> as(n), bs(n);\n\n    for(int i = 0, ia = 0, ib = 0; i < 2 * n; ++i){\n        if(str[i] == 'a')\n            as[ia++] = i; \n        else bs[ib++] = i; }\n\n    for(int i = n-1; i >= 0; --i){\n        auto tmp = get();\n        b[as[i]] = b[bs[i]] = true;\n        auto tmp2 = get();\n\n        if(tmp > tmp2) b[as[i]] = b[bs[i]] = false; }\n\n    cout << get() << endl; }\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define F(i, a, b) for (int i = a; i <= b; i ++)\n#define G(i, a, b) for (int i = a; i >= b; i --)\n#define out4(x, y, z, w) { if (debug) printf(#x\" = \"),W(x),printf(\" \"#y\" = \"),W(y),printf(\" \"#z\" = \"),W(z),printf(\" \"#w\" = \"),W(w),putc('\\n'); }\n#define out3(x, y, z) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), printf(\" \"#z\" = \"), W(z), putc('\\n'); }\n#define out2(x, y) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), putc('\\n'); }\n#define out1(x) { if (debug) printf(#x\" = \"), W(x), putc('\\n'); }\n#define outline(x) { if (debug) puts(\"-------------------------------------------\"#x\"----------------------------------------\"); }\n#define outarr(a, L, R) { if (debug) { printf(#a\"[%d..%d] = \", L, R); F(i, L, R) W(a[i]), putc(' '); putc('\\n'); } }\n#define Assert(x) { if ((debug) && (!(x))) { puts(\"Wrong Answer\"); exit(0); } }\n#define max(a, b) ((a) > (b) ? (a) : (b))\n#define min(a, b) ((a) < (b) ? (a) : (b))\n#define mem(a, b) memset(a, b, sizeof a)\n#define mec(a, b) memcpy(a, b, sizeof a)\n#define mx(a, b) ((a) = max(a, b))\n#define mn(a, b) ((a) = min(a, b))\n#define lowbit(x) ((x) & (-(x)))\n#define abs(x) ((max(x, - (x))))\n#define get getchar()\n#define pb push_back\n#define putc putchar\n#define inf 2e9\n\ntemplate <typename Int>\nvoid R(Int &x) {\n\tchar c = get; x = 0; Int t = 1;\n\tfor (; !isdigit(c); c = get) t = (c == '-' ? - 1 : t);\n\tfor (; isdigit(c); x = (x << 3) + (x << 1) + c - '0', c = get); x *= t;\n}\ntemplate <typename Int>\nvoid W(Int x) {\n\tif (x < 0) { putc('-'); x = - x ; }\n\tif (x > 9) W(x / 10); putc(x % 10 + '0');\n}\n\n#define debug (0)\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\nint n, L, LEN, sum, p[N];\nint c[N], Ans[N], cnt[2], f[N];\nstruct node {\n\tint num; vector <int> c;\n\tfriend bool operator < (node a, node b) {\n\t\tint len = min(a.c.size(), b.c.size());\n\t\tF(i, 0, len - 1)\n\t\t\tif (a.c[i] < b.c[i]) return 1; else\n\t\t\tif (a.c[i] > b.c[i]) return 0;\n\t\treturn a.c.size() < b.c.size() || a.c.size() == b.c.size() && a.num > b.num;\n\t}\n\tvoid add(int x) { c.pb(x); }\n} a, b[N];\n\nchar ch[N];\nstruct nobe { int x, l, r; } d[N];\n\nint main() {\n//\tfreopen(\"data.in\",\"r\",stdin);\n//\tfreopen(\"no.out\",\"w\",stdout);\n\n\tR(n), scanf(\"%s\", ch + 1), n *= 2;\n\tint las = 0, s = 0;\n\tF(i, 1, n) {\n\t\ts += (ch[i] == 'b' ? 1 : (-1));\n\t\tif (s == 0)\n\t\t\td[++ L] = {ch[las + 1] - 'a', las + 1, i}, las = i;\n//\t\tprintf(\"%d \", s);\n\t}\n//\tputc('\\n');\n\n\tint flag = 0, total = 0;\n\tG(i, L, 1) {\n\t\tint l = d[i].l, r = d[i].r;\n\t\tif (d[i].x) {\n//\t\t\tout4(d[i].x, d[i].l, d[i].r, i);\n\t\t\tflag = 1, b[++ total].num = i;\n\t\t\tF(k, 1, (r - l + 1) / 2) {\n\t\t\t\tcnt[0] = cnt[1] = 0;\n\t\t\t\tint len = 0;\n\t\t\t\tG(j, r, l)\n\t\t\t\t\tif (++ cnt[ch[j] - 'a'] <= k)\n\t\t\t\t\t\tc[++ len] = ch[j] - 'a';\n\t\t\t\treverse(c + 1, c + len + 1);\n//\t\t\t\toutarr(c, 1, len);\n\t\t\t\ta.c.clear(), a.num = i;\n\t\t\t\tF(j, 1, len) a.add(c[j]);\n\t\t\t\tif (b[total] < a)\n\t\t\t\t\tb[total] = a;\n\t\t\t}\n//\t\t\tprintf(\"%d %d\\n\", b[total].c.size(), b[total].num);\n//\t\t\tF(j, 0, b[total].c.size() - 1)\n//\t\t\t\tprintf(\"%c\", b[total].c[j] + 'a');\n//\t\t\tputc('\\n');\n\t\t}\n\t\telse {\n\t\t\tif (flag) continue;\n\t\t\tint len = 0, bz = 0, Max = 0;\n\t\t\tout2(l, r);\n\t\t\tp[0] = f[l - 1] = 0;\n\t\t\tF(j, l, r) {\n\t\t\t\tint v = ch[j] - 'a';\n\t\t\t\tif (!v) p[++ p[0]] = j; else len ++;\n\t\t\t\tf[j] = f[j - 1];\n\t\t\t\tif (v)\n\t\t\t\t\tmx(f[j], f[p[len] - 1] + 1);\n\t\t\t\tmx(Max, f[j]);\n\t\t\t}\n\t\t\tout1(Max);\n\t\t\tsum += Max;\n\t\t}\n\t}\n\n\tsort(b + 1, b + total + 1);\n\n\tlas = 0;\n\tG(i, total, 1)\n\t\tif (b[i].num > las) {\n\t\t\tF(j, 0, b[i].c.size() - 1)\n\t\t\t\tprintf(\"%c\", b[i].c[j] + 'a');\n\t\t\tlas = b[i].num;\n\t\t}\n\tF(i, 1, sum) printf(\"ab\");\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * Since g++10 is released, some characters is not valid inside #if 0 :(\n * So, why not using clang++? :D\n\n * Date:\n  echo -n '  ' && date +%Y.%m.%d\n\n * Solution:\n  To be updated.\n\n * Digression:\n\n * CopyRight:\n          ▁▃▄▄▄▃▃▃▃▄▶\n        ▗▇▀▔    ▔▔▔▔\n       ▄▛   ▃▅━━■▄▂\n      ▟▊   ▐▘     ▀▙\n     ▟▜▌   ▐▖   ▋  ▐▍\n    ▟▘ ▜   ▝▀▇▆●▘  ▐▌\n  ▗▟▘   ▜▃       ▁▅▛\n  ▔▀▼▅▄▃▃██▅▄▄▄▅■▀▔\n        ▔▔▔▔▔▔\n */\n\n#include <cstdio>\n#include <algorithm>\n#include <string>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long ll;\ntypedef std::string str;\n\nstruct _{\n\tinline operator int () { int x; return scanf(\"%d\", &x), x; }\n\tinline operator ll () { ll x; return scanf(\"%lld\", &x), x; }\n} read;\n\nconst int maxn = 3000;\nchar s[maxn * 2 + 5];\nint apos[maxn + 5], bpos[maxn + 5];\nstr f[maxn + 5], g[maxn + 5];\n\nint main () {\n\tint n = read;\n\tscanf(\"%s\", s + 1);\n\n\tfor (int i = 1, ap = 0, bp = 0; i <= n * 2; i ++) {\n\t\tif (s[i] == 'a') apos[++ ap] = i;\n\t\tif (s[i] == 'b') bpos[++ bp] = i;\n\t}\n\n\tfor (int i = n; i; i --) {\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and apos[j] < bpos[i]) ++ j;\n\t\t\tf[i] = \"ab\" + g[j];\n\t\t}\n\t\tif (apos[i] > bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and bpos[j] < apos[i]) ++ j;\n\t\t\tfor (int k = 0; k < j - i; k ++) f[i] += 'b';\n\t\t\tf[i] += 'a' + f[i + 1].substr(size_t(j - i - 1), str::npos);\n\t\t}\n\t\tg[i] = std::max(f[i], g[i + 1]);\n\t}\n\n\tputs(g[1].c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MAXN = 3000;\nchar S[2*MAXN + 5];\nint a[MAXN + 5], b[MAXN + 5], c[2*MAXN + 5];\nint dp[MAXN + 5][MAXN + 5];\nint N, A, B;\nstring fun(int num[]) {\n\tstring ret = \"\";\n\tfor(int i=1;i<=2*N;i++)\n\t\tif( num[c[i]] ) ret.insert(ret.end(), S[i]);\n\treturn ret;\n}\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S+1);\n\tfor(int i=1;i<=2*N;i++) {\n\t\tif( S[i] == 'a' ) {\n\t\t\ta[++A] = i;\n\t\t\tc[i] = A;\n\t\t}\n\t\telse {\n\t\t\tb[++B] = i;\n\t\t\tc[i] = B;\n\t\t}\n\t}\n\tdp[N][N] = 1;\n\tfor(int i=N-1;i>=1;i--) {\n\t\tdp[i][i] = 1;\n\t\tif( a[i] < b[i] ) {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=a[i];j<=b[i];j++) {\n\t\t\t\tif( c[j] < i ) continue;\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\t}\n\t\t\tfor(int j=b[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] > Max )\n\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t}\n\t\telse {\n\t\t\tint tot = 0, Max = 0;\n\t\t\tfor(int j=b[i];j<=a[i];j++) {\n\t\t\t\tif( c[j] < i ) continue;\n\t\t\t\tif( c[j] != i ) tot++;\n\t\t\t\tMax = max(Max, c[j]);dp[i][c[j]] = 1;\n\t\t\t}\n\t\t\tfor(int j=a[i]+1;j<=2*N;j++) {\n\t\t\t\tif( S[j] == 'b' ) {\n\t\t\t\t\tif( tot == 0 ) {\n\t\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\ttot++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif( tot == 0 ) {\n\t\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\tMax = max(Max, c[j]);\n\t\t\t\t\t\ttot--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( fun(dp[i]) < fun(dp[i+1]) )\n\t\t\tmemcpy(dp[i], dp[i+1], sizeof dp[i+1]);\n\t}\n\tcout << fun(dp[1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nlong long n,a[3005],b[3005],conta,contb,cont;\nstring s,dp[3005],tmp1,tmp2;\nvector<pair<int,char> > v; \n\nint main(){\n\n\tcin>>n>>s;\n\t\n\tfor(int i=0;i<2*n;i++){\n\t    if(s[i]=='a')a[conta++]=i;\n\t    else b[contb++]=i;\n    }\n    \n    dp[n]=\"\";\n    for(int i=n-1;i>=0;i--){\n        tmp1=dp[i+1];\n        tmp2.clear();\n        cont=i;\n        \n        if(a[i]<b[i]){\n            while(cont<n && a[cont]<b[i])cont++;\n            \n            tmp2=\"ab\"+dp[cont];\n        }\n        else{\n            v.clear();\n            v.push_back({a[cont],'a'});\n            v.push_back({b[cont],'b'});\n            while(cont+1<n && b[cont+1]<a[cont]){\n            cont++;\n            v.push_back({a[cont],'a'});\n            v.push_back({b[cont],'b'});\n            }\n            sort(v.begin(),v.end());\n            for(int j=0;j<v.size();j++)tmp2.push_back(v[j].second);\n            tmp2=tmp2+dp[cont+1];\n        }\n        \n        \n        dp[i]=max(tmp1,tmp2);\n    }\n\t\n\tcout<<dp[0];\n\t\nreturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>2][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\tint len=max(strlen(x+1),strlen(y+1));\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t])==1)\n\t\t\t{\t\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=NULL;\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<iostream>\n#include<set>\n#include<vector>\n#include<queue>\n#include<stack>\n#include<map>\n#include<bitset>\n#define Fail puts(\"NO\"),exit(0);\n#define eps 1e-10\n#define maxn 3010\n#define maxm 150010\n#define inf 1000000007\n#define mod 1000000007\n#define inv 500000005\n#define G 3\n#define pi acos(-1)\n#define mp(x,y) make_pair(x,y)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<ll,int>pii;\ntypedef bitset<maxn> bit;\ntypedef long double ld;\nint read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch-'0'<0||ch-'0'>9){if(ch=='-') f=-1;ch=getchar();}\n    while(ch-'0'>=0&&ch-'0'<=9){x=x*10+ch-'0';ch=getchar();}\n    return x*f;\n}\nint n;\nchar s[maxn*2];\nstruct P{\n    char t[maxn*2];\n    int len;\n    void operator += (P x)\n    {\n        for(int i=1;i<=x.len;i++)  t[++len]=x.t[i];\n    }\n}f[maxn],com;\npii p[maxn];\nint used[maxn*2],top,nxt[maxn*2],bel[maxn*2];\nbool check(P a,P b)\n{\n    int len=min(a.len,b.len);\n    for(int i=1;i<=len;i++)\n    {\n        if(a.t[i]==b.t[i])  continue;\n        if(a.t[i]>b.t[i])  return true;\n        return false;\n    }\n    return (a.len>b.len);\n}\nint main()\n{\n    n=read();\n    scanf(\"%s\",s+1);\n    for(int i=1;i<=2*n;i++)\n    {\n        if(used[i])  continue;\n        for(int j=i+1;j<=2*n;j++)\n        {\n            if(s[i]!=s[j]&&!used[j])\n            {\n                p[++top]=mp(i,j);\n                used[i]=used[j]=1;\n                bel[i]=bel[j]=top;\n                nxt[i]=j;\n                break;\n            }\n        }\n    }\n    for(int i=n;i>=1;i--)\n    {\n        f[i]=f[i+1];\n        if(s[p[i].fi]=='a')\n        {\n            int cnt=0;\n            for(int j=p[i].fi+1;j<p[i].se;j++)  cnt+=(s[j]=='a'); \n            com.t[1]='a';com.t[2]='b';com.len=2;\n            com+=f[i+cnt+1];\n            f[i]=check(f[i],com)?f[i]:com;\n        }\n        else{\n            com.len=0;\n            int L=p[i].fi+1,R=p[i].se;\n            while(true)\n            {\n                int tmp=0;\n                for(int j=L;j<=R;j++)\n                  if(s[j]=='b') tmp=max(tmp,nxt[j]);\n                if(!tmp)  break;\n                L=R+1;R=tmp;  \n            }\n            com.t[++com.len]='b';\n            for(int j=p[i].fi+1;j<p[i].se;j++)  \n              if(s[j]=='b')  com.t[++com.len]='b';\n            com.t[++com.len]='a';\n            for(int j=p[i].se+1;j<=R;j++)  com.t[++com.len]=s[j];\n            com+=f[bel[R]+1];\n            f[i]=check(f[i],com)?f[i]:com;\n        }\n    }\n    for(int i=1;i<=f[1].len;i++)  printf(\"%c\",f[1].t[i]);\n    puts(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=A)\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * Since g++10 is released, some characters is not valid inside #if 0 :(\n * So, why not using clang++? :D\n\n * Date:\n  echo -n '  ' && date +%Y.%m.%d\n\n * Solution:\n  To be updated.\n\n * Digression:\n\n * CopyRight:\n          ▁▃▄▄▄▃▃▃▃▄▶\n        ▗▇▀▔    ▔▔▔▔\n       ▄▛   ▃▅━━■▄▂\n      ▟▊   ▐▘     ▀▙\n     ▟▜▌   ▐▖   ▋  ▐▍\n    ▟▘ ▜   ▝▀▇▆●▘  ▐▌\n  ▗▟▘   ▜▃       ▁▅▛\n  ▔▀▼▅▄▃▃██▅▄▄▄▅■▀▔\n        ▔▔▔▔▔▔\n */\n\n#include <cstdio>\n#include <algorithm>\n#include <string>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long ll;\ntypedef std::string str;\n\nstruct _{\n\tinline operator int () { int x; return scanf(\"%d\", &x), x; }\n\tinline operator ll () { ll x; return scanf(\"%lld\", &x), x; }\n} read;\n\nconst int maxn = 3000;\nchar s[maxn * 2 + 5];\nint apos[maxn + 5], bpos[maxn + 5];\nstr f[maxn + 5], g[maxn + 5];\n\nint main () {\n\tint n = read;\n\tscanf(\"%s\", s + 1);\n\n\tfor (int i = 1, ap = 0, bp = 0; i <= n * 2; i ++) {\n\t\tif (s[i] == 'a') apos[++ ap] = i;\n\t\tif (s[i] == 'b') bpos[++ bp] = i;\n\t}\n\n\tfor (int i = n; i; i --) {\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and apos[j] < bpos[i]) ++ j;\n\t\t\tf[i] = \"ab\" + g[j];\n\t\t}\n\t\tif (apos[i] > bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and bpos[j] < apos[i]) ++ j;\n\t\t\tfor (int k = 0; k < j - i; k ++) f[i] += 'b';\n\t\t\tf[i] += 'a' + g[i + 1].substr(size_t(j - i - 1), str::npos);\n\t\t}\n\t\tg[i] = std::max(f[i], g[i + 1]);\n\t}\n\n\tputs(g[1].c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n\nconst int MN = 3005;\n\nint N, pa[MN], pb[MN], id[MN * 2], nx[MN * 2];\nstd::string str, f[MN];\n\nint main() {\n\tstd::cin >> N >> str;\n\tstr = \" \" + str;\n\tfor (int i = 1, a = 0, b = 0; i <= N * 2; ++i)\n\t\tif (str[i] == 'a') pa[id[i] = ++a] = i;\n\t\telse pb[id[i] = ++b] = i;\n\tpa[N + 1] = pb[N + 1] = N * 2 + 1, id[N * 2 + 1] = N + 1;\n\tfor (int i = 1, j = 0; i <= N + 1; ++i)\n\t\twhile (j < std::min(pa[i], pb[i]))\n\t\t\tnx[++j] = i;\n\tfor (int i = N; i >= 1; --i) {\n\t\tif (pa[i] > pb[i]) {\n\t\t\tint j = pb[i];\n\t\t\tfor (; pb[id[j]] < pa[id[j]] && (id[j] <= i || pb[id[j]] < pa[id[j] - 1]); ++j)\n\t\t\t\tif (id[j] >= i) f[i] += str[j];\n\t\t\tf[i] += f[id[j]];\n\t\t} else f[i] = \"ab\" + f[nx[pb[i] + 1]];\n\t\tf[i] = std::max(f[i], f[i + 1]);\n\t}\n\tstd::cout << f[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,a,b) for (int i = (a); i <= (b); ++ i)\n#define rrp(i,a,b) for (int i = (a); i >= (b); -- i)\n#define gc() getchar()\n#define fir first\n#define sec second\ntypedef pair<int,int> pii;\ntypedef double db;\ntypedef long long ll;\ntemplate <typename tp>\ninline void read(tp& x) {\n  x = 0; char tmp; bool key = 0;\n  for (tmp = gc(); !isdigit(tmp); tmp = gc())\n    key = (tmp == '-');\n  for (; isdigit(tmp); tmp = gc()) \n    x = (x << 3) + (x << 1) + (tmp ^ '0');\n  if (key) x = -x;\n}\ntemplate <typename tp>\ninline void ckmn(tp& x,tp y) {\n  x = x < y ? x : y;\n}\ntemplate <typename tp>\ninline void ckmx(tp& x,tp y) {\n  x = x < y ? y : x;\n}\n\nconst int N = 3010;\nint n;\nchar str[N << 1];\nstruct data {\n  int lp,rp,tp;\n  bool operator < (const data& a) const {\n    return lp < a.lp;\n  }\n} dat[N];\nstring dp[N];\nint cnt, vis[N << 1];\nstring doit(int l,int r) {\n  string ret = \"\";\n  if (dat[l].tp == 0) {\n    int cur = 0;\n    rep (i, l, r) {\n      if (dat[i].lp > cur) {\n\tcur = dat[i].rp;\n\tret += \"ab\";\n      }\n    }\n  } else {\n    rep (i, l, r) {\n      rep (j, i, r) vis[dat[j].lp] = vis[dat[j].rp] = 1;\n      string tmp = \"\";\n      rep (j, 1, 2*n) if (vis[j]) tmp += str[j];\n      ret = max(ret, tmp);\n      rep (j, i, r) vis[dat[j].lp] = vis[dat[j].rp] = 0;      \n    }\n  }\n  return ret;\n}\nint main() {\n  read(n);\n  scanf(\"%s\", str + 1);\n  for (int i = 1, j = 1; i <= 2 * n; ++ i)\n    if (str[i] == 'a') dat[j++].lp = i;\n  for (int i = 1, j = 1; i <= 2 * n; ++ i)\n    if (str[i] == 'b') dat[j++].rp = i;\n  rep (i, 1, n) if (dat[i].lp > dat[i].rp) {\n    dat[i].tp = 1;\n    swap(dat[i].lp, dat[i].rp);\n  }\n  sort(dat + 1, dat + n + 1);\n  dp[0] = \"\";\n  for (int i = 1, j = 1; i <= n; ++ i) {\n    j = i;\n    while (j < n && dat[j+1].lp < dat[j].rp) ++ j;\n    string tmp = doit(i, j);\n    ++ cnt;\n    rep (k, 0, cnt-1) dp[cnt] = max(dp[k] + tmp, dp[cnt]);\n    i = j;\n  }\n  string ans = \"\";\n  rep (i, 1, cnt) ans = max(ans, dp[i]);\n  cout << ans << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n//#define int long long\nusing namespace std;\n\nint n,cnt[6010];\nstring dp[6010];\nstring s;\nvector<int> a,b;\n\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tcin>>s;\n\tfor(int i=0;i<n*2;i++){\n\t\tif(s[i]=='a'){a.push_back(i);cnt[i]=a.size()-1;}\n\t\telse{b.push_back(i);cnt[i]=b.size()-1;}\n\t}\n\tfor(int i=0;i<=2*n;i++) dp[i]=\"\";\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint maxv=i;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tmaxv=max(maxv,cnt[j]);\n\t\t\t}\n\t\t\tdp[i]=\"ab\"+dp[maxv+1];\n\t\t}\n\t\telse{\n\t\t\tint cur=i;\n\t\t\twhile(cur+1<n&&b[cur+1]<a[cur]) cur++;\n\t\t\tfor(int j=b[i];j<2*n;j++){\n\t\t\t\tif(cnt[j]>=i&&cnt[j]<=cur){\n\t\t\t\t\tdp[i]+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i]+=dp[cur+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nstring calc(string s){\n  //cout<<s<<endl;\n  string res;\n  Int n=s.size();\n  if(s[0]=='a'){\n    res=\"a\";\n    for(Int i=1;i<n;i++)\n      if(res.back()!=s[i]) res+=s[i];\n  }else{\n    for(Int k=0;k<n/2;k++){\n      Int a=0,b=0;\n      string tmp;\n      for(Int i=0;i<n;i++){\n\tif(s[i]=='a'){\n\t  if(a>=k) tmp+=s[i];\n\t  a++;\n\t}else{\n\t  if(b>=k) tmp+=s[i];\n\t  b++;\n\t}\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nsigned main(){\n  Int n;\n  string s;\n  cin>>n>>s;\n  n*=2;\n  vector<string> v;\n  Int x[2]={1,-1};\n  for(Int i=0;i<n;){\n    Int j=i,k=x[s[j++]-'a'];\n    while(j<n&&k!=0) k+=x[s[j++]-'a'];\n    v.emplace_back(calc(s.substr(i,j-i)));\n    i=j;\n  }\n  reverse(v.begin(),v.end());\n  string ans=\"\";\n  for(string t:v)\n    chmax(ans,t+ans);\n  cout<<ans<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define pb push_back\n\nusing namespace std;\n\nstring max(string a, string b){\n\tint x;\n\tfor (x = 0; x < min(a.length(), b.length()); x ++) if (a[x] != b[x]) return a[x] > b[x] ? a : b;\n\treturn a.length() > b.length() ? a : b;\n}\n\nstring func(string S, string T){\n\tif (S[0] == 'b') {\n\t\tint n = S.length() >> 1, x, i, j;\n\t\tvector <int> A, B;\n\t\tfor (x = 0; x < n << 1; x ++) {\n\t\t\tif (S[x] == 'a') A.pb(x);\n\t\t\tif (S[x] == 'b') B.pb(x);\n\t\t}\n\t\tstring r = T;\n\t\tfor (x = 0; x < n; x ++) {\n\t\t\tstring u;\n\t\t\ti = j = x;\n\t\t\twhile (i < n && j < n) A[i] < B[j] ? (++i, u += 'a') : (++j, u += 'b');\n\t\t\twhile (i < n) u += 'a', ++i;\n\t\t\twhile (j < n) u += 'b', ++j;\n\t\t\tr = max(r, u + T);\n\t\t}\n\t\treturn r;\n\t} else {\n\t\tint n = S.length(), x, y = 0, c = 0;\n\t\tstring r = T, u = \"\";\n\t\tfor (x = 0; x < n; x ++) if (S[x] == c + 'a') c ^= 1, ++y;\n\t\ty >>= 1;\n\t\tfor (x = 0; x < y; x ++) u += \"ab\", r = max(r, u + T);\n\t\treturn r;\n\t}\n}\n\nstring solve(string S){\n\tstring res = \"\";\n\tint x, y = S.length(), z, c = 0;\n\tfor (x = y - 1; x >= 0; x --) {\n\t\tc += S[x] == 'a' ? 1 : -1;\n\t\tif (c == 0) {\n\t\t\tstring T = \"\";\n\t\t\tfor (z = x; z < y; z ++) T += S[z];\n\t\t\tres = func(T, res);\n\t\t\ty = x;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main(){\n\tstring S;\n\tscanf(\"%*d\"), cin >> S;\n\tcout << solve(S) << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring str,f[3005];\nint pos[3005];\nbool kind[3005];\n\nint bel[6005];\n\nint main() {\n  int n;\n  cin>>n>>str;\n  int cnt=0,s=0;\n  for(int i=0;i<2*n;i++) {\n  \ts+=((str[i]=='b')?1:-1);\n  \tif (!s) {\n  \t\tpos[++cnt]=i;\n  \t\tkind[cnt]=((str[i]=='a')?0:1);\n\t  }\n  }\n  pos[0]=-1;\n  bool v=1;\n  for(int i=cnt;i>0;i--)\n    if (!kind[i]) {\n    \tv=0;\n    \tint s1=0,s2=0;\n    \tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n    \t  if (str[j]=='b') bel[j]=++s1; else bel[j]=++s2;\n    \tf[i]=f[i+1];\n    \tfor(int j=1;j<=s1;j++) {\n          string cur;\n    \t  for(int k=pos[i-1]+1;k<=pos[i];k++)\n    \t    if (bel[k]>=j) cur+=str[k];\n    \t  f[i]=max(f[i],cur+f[i+1]);\n    \t}\n\t}\n\telse if (v) {\n\t\tint s1=0,s2=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n    \t  if (str[j]=='a') bel[j]=++s1; else bel[j]=++s2;\n    \tint r=pos[i-1]+1;\n    \tfor(;;) {\n    \t\twhile (r<=pos[i]&&str[r]=='b') r++;\n    \t\tif (r>pos[i]) break;\n    \t\tf[i]+=\"ab\";\n    \t\tint t=bel[r];\n    \t\tr++;\n    \t\twhile (bel[r]!=t) r++;\n    \t\tr++;\n\t\t}\n\t\tf[i]+=f[i+1];\n\t}\n\telse f[i]=f[i+1];\n  cout<<f[1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\nint c[6011];\nint begin0;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nstring best=\"\";\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin0=2*n;\n\tmemset(c,0,sizeof(c));\n\t\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin0 && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbest=ans;\n\t\t\t\tbegin0=a[i];\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttmp=\"\";\n\t\t\tc[b[i]]=c[a[i]]=1;\n\t\t\tfor(j=b[i];j<2*n;j++)\n\t\t\t{\n\t\t\t\tif(c[j]==1)\n\t\t\t\t{\n\t\t\t\t\ttmp+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(tmp+ans>best)\n\t\t\t{\n\t\t\t\tbest=tmp+ans;\n\t\t\t}\n\t\t\t\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tcout<<best<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef signed long long ll;\n\n#undef _P\n#define _P(...) (void)printf(__VA_ARGS__)\n#define FOR(x,to) for(x=0;x<(to);x++)\n#define FORR(x,arr) for(auto& x:arr)\n#define ITR(x,c) for(__typeof(c.begin()) x=c.begin();x!=c.end();x++)\n#define ALL(a) (a.begin()),(a.end())\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n//-------------------------------------------------------\n\nint N;\nstring S;\n\nstring hoge(string S) {\n\tint cnt[3030]={};\n\tint vis[3030]={};\n\tvector<int> As,Bs;\n\t\n\tint a=0,b=0,i,j;\n\tFOR(i,S.size()) {\n\t\tif(S[i]=='a') {\n\t\t\tcnt[i]=a++;\n\t\t\tAs.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tcnt[i]=b++;\n\t\t\tBs.push_back(i);\n\t\t}\n\t}\n\t\n\tstring R;\n\t\n\tif(S[0]=='a') {\n\t\tFOR(i,S.size()) {\n\t\t\tif(vis[i]==0) {\n\t\t\t\tR+=S[i];\n\t\t\t\tif(S[i]=='a') {\n\t\t\t\t\tfor(int j=i+1;j<Bs[cnt[i]];j++) vis[j]=vis[Bs[cnt[j]]]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tFOR(i,S.size()/2) {\n\t\t\tstring T;\n\t\t\tFOR(j,S.size()) {\n\t\t\t\tif(cnt[j]>=i) T+=S[j];\n\t\t\t}\n\t\t\tR=max(R,T);\n\t\t}\n\t\t\n\t}\n\treturn R;\n}\n\n\nvoid solve() {\n\tint i,j,k,l,r,x,y; string s;\n\t\n\tcin>>N>>S;\n\tstring T;\n\tvector<string> V;\n\t\n\tx=0;\n\tFORR(c,S) {\n\t\tT+=c;\n\t\tif(c=='a') x++;\n\t\telse x--;\n\t\tif(x==0) {\n\t\t\tstring P=hoge(T);\n\t\t\t\n\t\t\twhile(V.size() && T > V.back()+T) V.pop_back();\n\t\t\tV.push_back(T);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\t\n\tFORR(c,V) cout<<c;\n\tcout<<endl;\n\t\n}\n\n\nint main(int argc,char** argv){\n\tstring s;int i;\n\tif(argc==1) ios::sync_with_stdio(false), cin.tie(0);\n\tFOR(i,argc-1) s+=argv[i+1],s+='\\n'; FOR(i,s.size()) ungetc(s[s.size()-1-i],stdin);\n\tcout.tie(0); solve(); return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num){\n\t\tv[i]=bs(i);\n\t\trep(j,v[i]);v.pb(0);\n\t}\n\tint p=ok();\n\tassert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring chop(string& s, int i, int j) {\n    assert(i <= j);\n    return s.substr(i, j - i);\n}\n\nstring _solve(string s) {\n    if (s[0] == 'a') {\n        vector<int> ap, bp;\n        for (int i = 0; i < s.size(); i++) {\n            (s[i] == 'a' ? ap : bp).push_back(i);\n        }\n        string t;\n        for (int i = 0; i < ap.size();) {\n            t.push_back('a');\n            t.push_back('b');\n            for (int targ = bp[i]; i < ap.size() && ap[i] <= targ; i++);\n        }\n        return t;\n    } else {\n        string t = s;\n        for (string u = s; !u.empty();) {\n            int i = 0, j = 0;\n            while (u[i] != 'a') i++;\n            while (u[j] != 'b') j++;\n            u = chop(u, 0, min(i, j)) + chop(u, min(i, j) + 1, max(i, j)) + chop(u, max(i, j) + 1, u.size());\n            t = max(t, u);\n        }\n        return t;\n    }\n}\n\nint main() {\n    int n;\n    vector<string> parts;\n    string s;\n    cin >> n >> s;\n    for (int i = 0; i < s.size();) {\n        int t = 0, j = i;\n        while (j < s.size()) {\n            if (!(t += s[j++] == 'b' ? 1 : -1)) break;\n        }\n        parts.push_back(_solve(chop(s, i, j)));\n        i = j;\n    }\n    string t = \"\";\n    reverse(parts.begin(), parts.end());\n    for (string& u: parts) {\n        t = max(t, u + t);\n    }\n    cout << t << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <set>\n#include <iterator>\n#include <algorithm>\n#include <cstdint>\n\nusing namespace std;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tint n;\n\tstring s;\n\tcin >> n >> s;\n\tconst int m = n * 2;\n\tvector<int> pos(m), inv(m), a(n), b(n);\n\tfor(int i = 0, j = 0, k = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\ta[j] = i;\n\t\t\tpos[i] = j++;\n\t\t}else{\n\t\t\tb[k] = i;\n\t\t\tpos[i] = k++;\n\t\t}\n\t}\n\tfor(int i = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\tinv[i] = b[pos[i]];\n\t\t}else{\n\t\t\tinv[i] = a[pos[i]];\n\t\t}\n\t}\n\tvector<uint8_t> current_marks(m);\n\tvector<char> current_string;\n\tfor(int current_state = 0; current_state < m; ){\n\t\t{\t// append 'b'\n\t\t\tauto marks = current_marks;\n\t\t\tauto target = current_string;\n\t\t\tint state = current_state, done = target.size();\n\t\t\ttarget.push_back('b');\n\t\t\twhile(state < m && done < target.size()){\n\t\t\t\tif(inv[state] > state){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks[state] = true;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}\n\t\t\t\t\t++state;\n\t\t\t\t}else if(marks[inv[state]]){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks[state] = true;\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint rollback = inv[state];\n\t\t\t\t\t\tfor(int p = state; p >= rollback; --p){\n\t\t\t\t\t\t\tif(!marks[p]){ continue; }\n\t\t\t\t\t\t\tif(inv[p] < p){ rollback = min(rollback, inv[p]); }\n\t\t\t\t\t\t\tif(inv[p] <= state){\n\t\t\t\t\t\t\t\tmarks[p] = false;\n\t\t\t\t\t\t\t\t--done;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++state;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t++state;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(done == target.size()){\n\t\t\t\tcurrent_state = state;\n\t\t\t\tcurrent_marks = move(marks);\n\t\t\t\tcurrent_string = move(target);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\t{\t// append 'a'\n\t\t\tauto marks = current_marks;\n\t\t\tauto target = current_string;\n\t\t\tint state = current_state, done = target.size();\n\t\t\ttarget.push_back('a');\n\t\t\twhile(state < m && done < target.size()){\n\t\t\t\tif(inv[state] > state){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks[state] = true;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}\n\t\t\t\t\t++state;\n\t\t\t\t}else if(marks[inv[state]]){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks[state] = true;\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint rollback = inv[state];\n\t\t\t\t\t\tfor(int p = state; p >= rollback; --p){\n\t\t\t\t\t\t\tif(!marks[p]){ continue; }\n\t\t\t\t\t\t\tif(inv[p] < p){ rollback = min(rollback, inv[p]); }\n\t\t\t\t\t\t\tif(inv[p] <= state){\n\t\t\t\t\t\t\t\tmarks[p] = false;\n\t\t\t\t\t\t\t\t--done;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++state;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t++state;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(done == target.size()){\n\t\t\t\tcurrent_state = state;\n\t\t\t\tcurrent_marks = move(marks);\n\t\t\t\tcurrent_string = move(target);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\tcurrent_string.push_back('\\0');\n\tcout << current_string.data() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nstring solve(int n, string s) {\n\tvector<int> a(n), b(n);\n\tint ca = 0, cb = 0;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') a[ca++] = i;\n\t\tif (s[i] == 'b') b[cb++] = i;\n\t}\n\tstring ans;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tvector<int> st;\n\t\tfor (int j = 0; j < n; ++j) {\n\t\t\tif (b[j] >= i && a[j] > b[j]) {\n\t\t\t\tst.push_back(a[j]);\n\t\t\t\tst.push_back(b[j]);\n\t\t\t}\n\t\t}\n\t\tsort(st.begin(), st.end());\n\t\tstring sub;\n\t\tfor (int j : st) {\n\t\t\tsub += s[j];\n\t\t}\n\t\tint ptr = (st.empty() ? i : st.back() + 1);\n\t\tfor (int j = 0; j < n; ++j) {\n\t\t\tif (a[j] >= ptr) {\n\t\t\t\tsub += \"ab\";\n\t\t\t\tptr = b[j] + 1;\n\t\t\t}\n\t\t}\n\t\tans = max(ans, sub);\n\t}\n\treturn ans;\n}\nint main() {\n\tint n; string s;\n\tcin >> n >> s;\n\tcout << solve(n, s) << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\t//cout<<f<<\" \"<<l<<\" \"<<r<<endl;\n\t//system(\"pause\");\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tif ((s[i]-'a')!=f)\n\t\t\t{\n\t\t\t\ti++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/*\n\t\t\tcout<<i<<endl;\n\t\t\tsystem(\"pause\");\n\t\t\t*/\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\t/*\n\t\ts0=s1=0;\n\t\tint lst=r;\n\t\tfor (int j=r;j>=l;j--)\n\t\t{\n\t\t\tif ((s[j]-'a')==f)\n\t\t\t{\n\t\t\t\ts0++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ts1++;\n\t\t\t}\n\t\t\tif (s0==s1)\n\t\t\t{\n\t\t\t\tnode now;\n\t\t\t\tfor (int i=lst;i>=j;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tif ((now.s+res)>res)\n\t\t\t\t{\n\t\t\t\t\tres=now.s+res;\n\t\t\t\t}\n\t\t\t\tlst=j-1;\n\t\t\t}\n\t\t}\n\t\tnode now;\n\t\t\t\tfor (int i=r;i>=l;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tres=now.s;\n\t\t*/\n\t\tfor (int i=l-1;i<=r;i++)\n\t\t{\n\t\t\tc[i]=0;\n\t\t}\n\t\tfor (int i=l;i<=r;i++)\n\t\t{\n\t\t\tif ((s[i]-'a')==f)\n\t\t\t{\n\t\t\t\tc[i]=c[i-1]+1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tc[i]=c[i-1];\n\t\t\t}\n\t\t}\n\t\tint mx=l;\n\t\tfor (int i=l+1;i<=r;i++)\n\t\t{\n\t\t\tif (c[b[i]]-c[i]>c[b[mx]]-c[mx])\n\t\t\t{\n\t\t\t\tmx=i;\n\t\t\t}\n\t\t}\n\t\tfor (int i=mx;i<=r;i++)\n\t\t{\n\t\t\tif ((s[i]-'a')==f)\n\t\t\t{\n\t\t\t\tres.push_back(s[i]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (i>=b[mx])\n\t\t\t\t{\n\t\t\t\t\tres.push_back(s[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=2*n-1;\n\tstring ans=\"\";\n\tfor (int i=2*n-1;i>=0;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa!=sb)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tif (s[i-1]=='b')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (lst==2*n-1)\n\t\t\t{\n\t\t\t\tans=work(0,i,lst)+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring str=work(1,i,lst);\n\t\t\t/*\n\t\t\tfor (int j=i;j<=lst;j++)\n\t\t\t{\n\t\t\t\tstr.push_back(s[j]);\n\t\t\t}\n\t\t\t*/\n\t\t\tif ((str+ans)>ans)\n\t\t\t{\n\t\t\t\tans=str+ans;\n\t\t\t}\n\t\t\t//cout<<ans<<endl;\n\t\t\tlst=i-1;\n\t\t}\n\t}\n\t/*\n\tfor (int i=0;i<2*n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa==sb)\n\t\t{\n\t\t\tif (i==2*n-1 || s[i+1]!=s[lst])\n\t\t\t{\n\t\t\t\tif (i==2*n-1 || (s[i+1]!=s[lst] && s[lst]!='a'))\n\t\t\t\t{\n\t\t\t\t\tans=ans+work(s[lst]-'a',lst,i);\n\t\t\t\t}\n\t\t\t\tsa=sb=0;\n\t\t\t\tlst=i+1;\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[6600];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[0], tmpbs[0]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        if(tmpas.empty() || tmpas.back() < tmpbs.back() == as[i] < bs[i]){\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n        else{\n            string tmp = calc(tmpas, tmpbs);\n            int pos = 0;\n            while(pos < strs.size() && strs[pos] > tmp)pos++;\n            if(pos == strs.size())strs.push_back(tmp);\n            else{\n                strs[pos] = tmp;\n                while(strs.size() > pos+1)strs.pop_back();\n            }\n            tmpas.clear();tmpbs.clear();\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n    }\n    string tmp = calc(tmpas, tmpbs);\n    int pos = 0;\n    while(pos < strs.size() && strs[pos] > tmp)pos++;\n    if(pos == strs.size())strs.push_back(tmp);\n    else{\n        strs[pos] = tmp;\n        while(strs.size() > pos+1)strs.pop_back();\n    }\n    tmpas.clear();tmpbs.clear();\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,id[6010],a[6010],b[6010],p[2];\nchar s[6010];\nstring f[6010],g[6010];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n+n;i++)\n\t\tif (s[i]=='a') id[i]=++numa,a[numa]=i;\n\t\t\telse id[i]=++numb,b[numb]=i;\n\tint now=0;\n\tf[0]=\"\";\n\tfor (int i=n+n,j;i>=1;i=j-1)\n\t{\n\t\tj=i;\n\t\tp[0]=p[1]=0;\n\t\tp[s[j]-'a']=1;\n\t\twhile (p[0]!=p[1]) p[s[--j]-'a']++;\n\t\tf[++now]=\"\";\n\t\tif (s[j]=='a')\n\t\t{\n\t\t\tint k=j;\n\t\t\twhile (k<=i)\n\t\t\t{\n\t\t\t\tif (s[k]=='b') { k++;continue;}\n\t\t\t\tf[now]=f[now]+\"ab\";\n\t\t\t\tk=b[id[k]]+1;\n\t\t\t}\n\t\t}else\n\t\t{\n\t\t\tint S=id[j],T=id[i];\n\t\t\tfor (int k=T;k>=S;k--)\n\t\t\t{\n\t\t\t\tint x=k;\n\t\t\t\tg[k]=\"\";\n\t\t\t\twhile (x<T&&b[x+1]<a[x]) x++;\n\t\t\t\tfor (int l=j;l<=i;l++)\n\t\t\t\t\tif (id[l]>=k&&id[l]<=x) g[k]=g[k]+s[l];\n\t\t\t\tif (x+1<=T) g[k]=g[k]+g[x+1];\n\t\t\t\tif (k+1<+T) g[k]=max(g[k],g[k+1]);\n\t\t\t}\n\t\t\tf[now]=g[S];\n\n\t\t}\n\t\tf[now]=max(f[now]+f[now-1],f[now-1]);\n\t}\n\tprintf(\"%s\\n\",f[now].c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <bits/stdc++.h>\n\n#define FOR(i, n)     for(lli i = 0; i < (lli)(n); ++i)\n#define FORU(i, j, k) for(lli i = (j); i <= (lli)(k); ++i)\n#define FORD(i, j, k) for(lli i = (j); i >= (lli)(k); --i)\n\n#define SQ(x) ((x)*(x))\n\n#define all(x) begin(x), end(x)\n#define rall(x) rbegin(x), rend(x)\n#define mp make_pair\n#define mt make_tuple\n#define pb push_back\n#define eb emplace_back\n\nusing namespace std;\n\ntemplate<typename... As>\nstruct tpl : public std::tuple<As...> {\n  using std::tuple<As...>::tuple;\n  tpl(){}\n  tpl(std::tuple<As...> const& b) { std::tuple<As...>::operator=(b); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<0, T>::type const&\n  x() const { return get<0>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<0, T>::type&\n  x() { return get<0>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<1, T>::type const&\n  y() const { return get<1>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<1, T>::type&\n  y() { return get<1>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<2, T>::type const&\n  z() const { return get<2>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<2, T>::type&\n  z() { return get<2>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<3, T>::type const&\n  w() const { return get<3>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<3, T>::type&\n  w() { return get<3>(*this); }\n};\n\nusing lli   = int;\n\nusing pii   = tpl<lli, lli>;\nusing piii  = tpl<lli, lli, lli>;\nusing piiii = tpl<lli, lli, lli, lli>;\nusing vi    = vector<lli>;\nusing vii   = vector<pii>;\nusing viii  = vector<piii>;\nusing vvi   = vector<vi>;\nusing vvii  = vector<vii>;\nusing vviii = vector<viii>;\n\ntemplate<class T>\nusing min_queue = priority_queue<T, vector<T>, greater<T> >;\ntemplate<class T>\nusing max_queue = priority_queue<T>;\n\ntemplate<size_t... I>\nstruct my_index_sequence {\n  using type = my_index_sequence;\n  static constexpr array<size_t, sizeof...(I)> value = { {I...} };\n};\n\nnamespace my_index_sequence_detail {\n  template<typename I, typename J> struct concat;\n  template<size_t... I, size_t... J>\n  struct concat<my_index_sequence<I...>, my_index_sequence<J...> > :\n    my_index_sequence<I..., (sizeof...(I)+J)...> { };\n  template<size_t N> struct make_index_sequence :\n    concat<typename make_index_sequence<N/2>::type, typename make_index_sequence<N-N/2>::type>::type { };\n  template <> struct make_index_sequence<0> : my_index_sequence<>{};\n  template <> struct make_index_sequence<1> : my_index_sequence<0>{};\n}\n\ntemplate<class... A>\nusing my_index_sequence_for = typename my_index_sequence_detail::make_index_sequence<sizeof...(A)>::type;\n\ntemplate<class T, size_t... I>\nvoid print_tuple(ostream& s, T const& a, my_index_sequence<I...>){\n  using swallow = int[];\n  (void)swallow{0, (void(s << (I == 0? \"\" : \", \") << get<I>(a)), 0)...};\n}\n\ntemplate<class T>\nostream& print_collection(ostream& s, T const& a);\ntemplate<class... A>\nostream& operator<<(ostream& s, tpl<A...> const& a);\ntemplate<class... A>\nostream& operator<<(ostream& s, tuple<A...> const& a);\ntemplate<class A, class B>\nostream& operator<<(ostream& s, pair<A, B> const& a);\n\ntemplate<class T, size_t I>\nostream& operator<<(ostream& s, array<T, I> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, vector<T> const& a) { return print_collection(s, a); }\ntemplate<class T, class U>\nostream& operator<<(ostream& s, multimap<T, U> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, multiset<T> const& a) { return print_collection(s, a); }\ntemplate<class T, class U>\nostream& operator<<(ostream& s, map<T, U> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, set<T> const& a) { return print_collection(s, a); }\n\ntemplate<class T>\nostream& print_collection(ostream& s, T const& a){\n  s << '[';\n  for(auto it = begin(a); it != end(a); ++it){\n    s << *it;\n    if(it != prev(end(a))) s << \" \";\n  }\n  return s << ']';\n}\n\ntemplate<class... A>\nostream& operator<<(ostream& s, tpl<A...> const& a){\n  s << '(';\n  print_tuple(s, a, my_index_sequence_for<A...>{});\n  return s << ')';\n}\n\ntemplate<class... A>\nostream& operator<<(ostream& s, tuple<A...> const& a){\n  s << '(';\n  print_tuple(s, a, my_index_sequence_for<A...>{});\n  return s << ')';\n}\n\ntemplate<class A, class B>\nostream& operator<<(ostream& s, pair<A, B> const& a){\n  return s << \"(\" << get<0>(a) << \", \" << get<1>(a) << \")\";\n}\n\n//------------------------------------------------------------------------------\n\nconst int N = 3000;\nint S[2*N];\n\n// --- BEGIN SNIPPET BINARY INDEXED TREE ---\n\nstruct BIT {\n  vi A;\n  BIT(lli n) : A(n+1){ }\n\n  lli get(lli i){\n    i += 1;\n    lli r = 0;\n    for(; i > 0; i -= i &-i){\n      r += A[i];\n    }\n    return r;\n  }\n\n  lli getR(lli l, lli r) {\n    lli ans = get(r);\n    if(l) ans -= get(l-1);\n    return ans;\n  }\n\n  void add(lli i, lli v){\n    i += 1;\n    for(; i < (lli)A.size(); i += i & -i){\n      A[i] += v;\n    }\n  }\n};\n\n// --- END SNIPPET BINARY INDEXED TREE ---\n\n\nint main(){\n  ios::sync_with_stdio(0); cin.tie(0);\n  lli n; cin>>n;\n\n  // srand(time(0));\n  // vi I(2*n); iota(all(I),0);\n  // random_shuffle(all(I));\n  // sort(all(I));\n  // FOR(i,n) S[2*i+1]=1;\n\n  FOR(i,2*n) {\n    char c; cin>>c;\n    S[i] = (c=='b');\n  }\n\n\n  vi as, bs;\n  FOR(i,2*n) if(S[i]) bs.pb(i); else as.pb(i);\n  vii ab;\n  FOR(i,n) ab.eb(as[i],bs[i]);\n  reverse(all(ab));\n\n\n\n  auto test = [&](vi x) -> bool {\n    vi y;\n    lli na=0,nb=0;\n    FOR(i,x.size()) {\n      FOR(j,x[i]) {y.pb(1); nb++;}\n      if(i != (lli)x.size()-1) {y.pb(0);na++;}\n    }\n\n    BIT bit(2*n+1);\n    FOR(i,2*n) bit.add(i+1,1);\n    vii L, R; R = ab;\n    while(1) {\n      if((lli)(L.size()+R.size()) < min(na,nb)) return 0;\n      if(R.empty()) {\n        return (lli)L.size() >= na && (lli)L.size() >= nb;\n      }\n      lli a,b; tie(a,b) = R.back(); R.pop_back();\n      lli ai = bit.get(a);\n      if(ai >= (lli)y.size()) return 1;\n      if(y[ai]) {\n        bit.add(a+1,-1);\n        bit.add(b+1,-1);\n        while(!L.empty()) {\n          auto p = L.back();\n          lli aa,bb; tie(aa,bb) = p;\n          if((aa>a)||(bb>a)||(aa>b)||(bb>b)) {\n            L.pop_back();\n            R.pb(p);\n          }else{\n            break;\n          }\n        }\n      }else{\n        L.eb(a,b);\n      }\n    }\n  };\n\n  vi ans;\n  while(1) {\n    ans.eb(0);\n    if(!test(ans)) {\n      ans.pop_back();\n      break;\n    }\n    while(1) {\n      ans.back() += 1;\n      if(!test(ans)) {\n        ans.back() -= 1;\n        break;\n      }\n    }\n  }\n  string out;\n  FOR(i,ans.size()) {\n    FOR(j,ans[i]) out += 'b';\n    if(i != (lli)ans.size()-1) out += 'a';\n  }\n  cout << out << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int, int> pii;\n\nconst int MN = 3010;\n\nint N;\nstring S;\nint chk[MN], inva[MN], invb[MN];\nvector<pii> seg;\n\nbool cmp(string &a, string &b) {\n    int n = a.size();\n    for(int i = 0; i < b.size(); i++) {\n        if(a[i % n] != b[i]) return a[i % n] > b[i];\n    }\n    return true;\n}\n\nint main() {\n    std::ios::sync_with_stdio(false);\n\n    cin >> N >> S;\n\n    int cnt1 = 0;\n    int cnt2 = 0;\n    for(int i = 0; i < 2 * N; i++) {\n        if(S[i] == 'a') chk[i] = cnt1++, inva[ chk[i] ] = i;\n        else chk[i] = cnt2++, invb[ chk[i] ] = i;\n    }\n\n    int sum = 0, st = 0;\n    for(int i = 0; i < 2 * N; i++) {\n        if(S[i] == 'a') sum++;\n        else sum--;\n        if(sum == 0) {\n            seg.push_back({st, i});\n            st = i + 1;\n        }\n    }\n    seg.push_back({st, 2 * N - 1});\n\n    string ans;\n    for(int i = (int)seg.size() - 1; i >= 0; i--) {\n        int l = seg[i].first;\n        int r = seg[i].second;\n\n        if(S[l] == 'a') {\n            string tmp;\n            for(int j = l; j <= r; j++) {\n                if(S[j] == 'a') {\n                    tmp.push_back('a');\n                    tmp.push_back('b');\n                    j = invb[ chk[j] ];\n                }\n            }\n            if(cmp(tmp, ans)) ans = tmp + ans;\n        }\n        else {\n            int ll = chk[l];\n            int rr = chk[r];\n\n            string mx;\n            for(int j = rr; j >= ll; j--) {\n                string tmp;\n                for(int k = l; k <= r; k++) {\n                    if(chk[k] >= j) tmp.push_back(S[k]);\n                }\n                if(mx < tmp) mx = tmp;\n            }\n            if(cmp(mx, ans)) ans = mx + ans;\n        }\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#ifndef BZ\n#pragma GCC optimize \"-O3\"\n#endif\n#include <bits/stdc++.h>\n\n#define FASTIO\n\n#ifdef FASTIO\n#define scanf abacaba\n#define printf abacaba\n#endif\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\n\n/*\nll pw(ll a, ll b) {\n\tll ans = 1; while (b) {\n\t\twhile (!(b & 1)) b >>= 1, a = (a * a) % MOD;\n\t\tans = (ans * a) % MOD, --b;\n\t} return ans;\n}\n*/\n\nint n;\nstring s;\nstring dp[6100];\nint ps[6100];\nint go[6100];\nvector<int> pa, pb;\n\nint main() {\n#ifdef FASTIO\n\tios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n#endif\n\tcin >> n >> s;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\tps[i] = pa.size();\n\t\t\tpa.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tps[i] = pb.size();\n\t\t\tpb.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < n; ++i)\n\t\tgo[pa[i]] = pb[i], go[pb[i]] = pa[i];\n\tdp[2 * n] = \"\";\n\tfor (int i = 2 * n - 1; i >= 0; --i) {\n\t\tdp[i] = dp[i + 1];\n\t\tif (go[i] < i)\n\t\t\tcontinue;\n\t\tif (s[i] == 'b') {\n\t\t\tstring cur;\n\t\t\tint pos = i;\n\t\t\tint cnt = 0;\n\t\t\tfor (int j = i; j < 2 * n; ++j) {\n\t\t\t\tif (s[j] == 'b')\n\t\t\t\t\tcur += 'b', pos = j + 1, ++cnt;\n\t\t\t\telse if (go[j] >= i) {\n\t\t\t\t\tpos = j + 1;\n\t\t\t\t\tcur += 'a';\n\t\t\t\t\t--cnt;\n\t\t\t\t\tif (cnt == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i] = max(dp[i], cur + dp[pos]);\n\t\t}\n\t\telse {\n\t\t\tdp[i] = max(dp[i], \"ab\" + dp[go[i] + 1]);\n\t\t}\n\t}\n\tcout << dp[0] << \"\\n\";\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nP2<string,Vct<int> > f[6005];\nint id[6005];\nstring st;\nint pos[2][6005];\nVct<int>t;\nint cmp(int a,int b)\n{\n\tt.clear();\n\tt=f[b].Se;\n\tt.Pb(a);\n\tt.Pb(id[a]-1);\n\tsort(t.begin(),t.end());\n\tstring st2=\"\";\n\t//cout<<\"!\";\n\tfor(int i=0;i<t.size();i++)\n\t{\n\t\tst2+=st[t[i]];\n\t\t//cout<<t[i]<<\" \";\n\t}\n\t//cout<<st2<<\" \"<<a<<\"-\"<<b<<\" \"<<(bool)(st2>f[a].Fi)<<endl;\n\tif(f[a].Fi<st2)\n\t{\n\t\tf[a].Se=t;\n\t\tf[a].Fi=st2;\n\t}\n\treturn 0;\n}\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tf[i].Fi=\"0\";\n\t\tif(st[i]=='a')pos[0][++pos[0][0]]=i;\n\t\telse pos[1][++pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[0][i]<<\" \"<<pos[1][i]<<endl;\n\t}\n\t*/\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(pos[0][i]<pos[1][i])id[pos[0][i]]=pos[1][i]+1;\n\t\telse id[pos[1][i]]=pos[0][i]+1;\n\t}\n\tstring mx;\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\t//cout<<i<<\" \"<<id[i]<<endl;\n\t\tif(!id[i])continue;\n\t\tif(st[i]=='a')continue;\n\t\tf[i].Fi=\"\";\n\t\tf[i].Fi+=st[i];\n\t\tf[i].Fi+=st[id[i]-1]; \n\t\tf[i].Se.Pb(i);\n\t\tf[i].Se.Pb(id[i]-1);\n\t\t//cout<<\"!\"<<i<<\" \"<<id[i]-1<<\" \"<<f[i].Fi<<\"!\"<<endl;\n\t\tfor(int j=i+1;j<st.Sz();j++)\n\t\t{\n\t\t\t//cout<<\"!\"<<j<<endl;\n\t\t\t//cout<<i/*<<\" \"<<f[i].Fi*/<<\":\"<<j<<\" \";\n\t\t\tcmp(i,j);\n\t\t\t//cout<<endl;\n\t\t}\n\t\t//cout<<\">\"<<i<<\" \"<<f[i].Fi<<endl;\n\t\tmx=max(mx,f[i].Fi);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nostream &operator<<(ostream &os, const vector<int> &a) {\n\tos<<\"[\";\n\trep(i,a.size()){\n\t\tos<<a[i];\n\t\tif(i<a.size()-1) os<<\",\";\n\t}\n\tos<<\"]\";\n\treturn os; \n}\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(int len){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,len){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok(p+1)>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num){\n\t\tv[i]=bs(i);\n\t\tnum+=v[i];\n\t\trep(j,v[i]) v.pb(0);\n\t}\n\tint p=ok(v.size());\n\tassert(p>=0);\n\t//cout<<v<<endl;\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define N 6010\n#define mr make_pair\nusing namespace std;\nint n,g[2],s[N][2],w[N];\nstring dp[N];\nchar ch[N];\nstring que(int l,int r){string no=\"\";for (int i=0;i<2*n;i++)if (w[i]>=l&&w[i]<=r)no+=ch[i];return no;}\nint main(){\n\tcin>>n;\n\tfor (int i=0;i<2*n;i++){\n\t\tch[i]=getchar();while (ch[i]!='a'&&ch[i]!='b')ch[i]=getchar();\n\t\tg[ch[i]-'a']++;s[g[ch[i]-'a']][ch[i]-'a']=i;w[i]=g[ch[i]-'a'];\n\t}\n\tfor (int i=n;i>=1;i--){\n\t\tdp[i]=dp[i+1];\n\t\tif (s[i][0]<s[i][1]){\n\t\t\tint x=i+1;\n\t\t\twhile (x<=n&&s[x][0]<=s[i][1])x++;\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[x]);\n\t\t}else{\n\t\t\tint x=i+1,y=s[i][0];\n\t\t\twhile (x<=n&&s[x][1]<=y)x++,y=max(y,s[x][0]);\n\t\t\tdp[i]=max(dp[i],que(i,x-1)+dp[x]);\n\t\t}\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tstring pre = \"\";\n\tfor(int i=0;i<vec.size();i++){\n\t\tstring S = dp[vec[i]];\n\t\tfor(int j=0;j<i;j++) dp[vec[i]] = max(dp[vec[i]],dp[vec[j]]+S);\n\t\tint nxt = a[pos[vec[i]]]+1;//cout<<nxt<<endl;\n\t\tstring cur = dp[vec[i]];\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tif(a[p]>b[p]) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t\n\t}\n\tcout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define e1 first\n#define e2 second\n#define pb push_back\n#define mp make_pair\n#define boost ios_base::sync_with_stdio(false)\n#define eb emplace_back\n#define OUT(x) {cout << x; exit(0); }\n#define REYNA(i,a,b) for(int i=(a);i<(b);++i)\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define scanf(...) scanf(__VA_ARGS__)?:0\ntypedef long long int ll;\ntypedef unsigned long long ull;\ntypedef pair <int, int> PII;\ntypedef pair <ll, ll> PLL;\ntypedef pair <PLL, int> PLLI;\ntypedef pair <PLL, pair <int, ll> > PP;\ntypedef pair <PII, int> PPI;\ntypedef pair <int, PII> PIP;\ntypedef pair <ll, int> PLI;\ntypedef unsigned int ui;\nconst int mod = 1e9+7;\nconst int inf = 1e9+9;\nconst ll MOD = 1e9+696969;\nconst long long INF = 1e18+3;\nconst int maxn = 6010;\nstring s;\n\nPII tab[6010];\nint ca, cb, n;\nint kta[6010], ktb[6010];\n\nstring best[6010];\nint endblock[6010], sadd[6010];\nint dp[6010];\nstring ovbest[6010];\n\nint main()\n{\n\tboost;\n\tcin >> n >> s;\n\tint N = 2 * n;\n\tca = cb = 0;\n\tfor (int i=0; i<N; ++i)\n\t{\n\t\tif (s[i] == 'a') \n\t\t{\n\t\t\tkta[++ca] = i + 1;\n\t\t\tif (ca <= cb) \n\t\t\t{\n\t\t\t\ttab[ca] = mp(ktb[ca], kta[ca]);\n\t\t\t\tif (ca == cb) endblock[ca] = 1;\n\t\t\t}\n\t\t}\n\t\telse \n\t\t{\n\t\t\tktb[++cb] = i + 1;\n\t\t\tif (cb <= ca) \n\t\t\t{\n\t\t\t\ttab[cb] = mp(ktb[cb], kta[cb]);\n\t\t\t\tif (ca == cb) endblock[cb] = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (int i=n; i>0; --i) sadd[i] = sadd[i + 1] + (tab[i].e1 < tab[i].e2);\n\tN = n;\n\twhile (n > 0 && sadd[n] == 0) --n;\n\t//potem dopisujemy na koncu \"ababab\" dostatecznie wiele razy\n\tbest[n + 1] = \"\";\n\tfor (int i=n; i>0; --i)\n\t{\n\t\tif (tab[i].e1 > tab[i].e2)\n\t\t{\n\t\t\tbest[i] = best[i + 1];\n\t\t\tovbest[i] = ovbest[i + 1];\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tstring cur_string = \"\";\n\t\tint j = i; while (endblock[j] == false) ++j;\n\t\t//teraz mam pewien przedzial liter\n\t\tvector <pair <int, char> > pp;\n\t\t\n\t\tfor (int k = i; k <= j; ++k)\n\t\t{\n\t\t\tpp.push_back(mp(tab[k].e1, 'b'));\n\t\t\tpp.push_back(mp(tab[k].e2, 'a'));\n\t\t}\n\t\t\n\t\tsort(pp.begin(), pp.end());\n\t\tfor (auto u : pp) cur_string += u.e2;\n\t\tcur_string += ovbest[j + 1];\n\t\tif (cur_string > ovbest[j + 1]) best[i] = cur_string;\n\t\telse best[i] = ovbest[j + 1];\n\t\tif (ovbest[i + 1] > best[i]) ovbest[i] = ovbest[i + 1];\n\t\telse ovbest[i] = best[i];\n\t}\n\t\n\tstring ret = best[1];\n\tfor (int i=2; i<=n; ++i)\n\t\tif (best[i] > ret) ret = best[i];\n\t\n\tint start = n + 1; n = N;\n\tfor (int i=start; i<=n; ++i) assert(tab[i].e1 > tab[i].e2);\n\tdp[start] = 1;\n\tfor (int i = start + 1; i <= n; ++i)\n\t\tfor (int j = start; j < i; ++j)\n\t\t\tif (tab[j].e1 < tab[i].e2) dp[i] = max(dp[i], dp[j] + 1);\n\t\n\tint hal = 0;\n\tfor (int i=start; i<=n; ++i) hal = max(hal, dp[i]);\n\tfor (int i=1; i<=hal; ++i) ret += \"ab\";\n\tcout << ret;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define INF int(1e9+5)\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define REP(i,n) for(int i=1;i<=(n);i++)\n#define mp make_pair\n#define pb push_back\n#define fst first\n#define snd second\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\nconst int maxn=6005;\nint n,cnta,cntb;\nchar s[maxn];\nstring val[maxn];\nint mat[maxn],a[maxn],b[maxn],nxt[maxn];\n\nint main(){\n\tscanf(\"%d%s\",&n,s);\n\trep(i,2*n){\n\t\tif(s[i]=='a')a[cnta++]=i;\n\t\telse b[cntb++]=i;\n\t}\n\trep(i,n)mat[a[i]]=b[i],mat[b[i]]=a[i];\n\tnxt[2*n]=2*n;\n\tfor(int i=2*n-1;i>=0;i--){\n\t\tnxt[i]=nxt[i+1];\n\t\tif(i<mat[i]){\n\t\t\tint cur=i;\n\t\t\twhile(cur<2*n){\n\t\t\t\tif(s[cur]=='a')val[i]+=\"ab\",cur=nxt[mat[cur]+1];\n\t\t\t\telse{\n\t\t\t\t\tint cur2=cur+1,cnt=1;\n\t\t\t\t\tval[i]+=\"b\";\n\t\t\t\t\twhile(cnt){\n\t\t\t\t\t\tif(s[cur2]=='b'&&cur2<mat[cur2])val[i]+=\"b\",cnt++;\n\t\t\t\t\t\telse if(s[cur2]=='a'&&mat[cur2]<cur2&&mat[cur2]>=cur)val[i]+=\"a\",cnt--;\n\t\t\t\t\t\tcur2++;\n\t\t\t\t\t}\n\t\t\t\t\tcur=nxt[cur2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(val[i]>val[nxt[i]])nxt[i]=i;\n\t\t}\n\t}\n\tprintf(\"%s\\n\",val[nxt[0]].c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nstring s,ss[3030],now,ans;\nint dn=0;\nvoid work(int l,int r)\n{\n\tint p=0,ap=0,bp=0;\n\tdn++;\n\tss[dn]=\"\";\n\tif(s[l]=='a')\n\t{\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tif(s[i]=='a')\n\t\t\t{\n\t\t\t\tap++;\n\t\t\t\tif(p==0)\n\t\t\t\t{\n\t\t\t\t\tp=ap;\n\t\t\t\t\tss[dn]+='a';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbp++;\n\t\t\t\tif(p==bp)\n\t\t\t\t{\n\t\t\t\t\tp=0;\n\t\t\t\t\tss[dn]+='b';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor(int i=1;i<=(r-l+1)/2;i++)\n\t\t{\n\t\t\tnow=\"\";\n\t\t\tap=bp=0;\n\t\t\tfor(int j=l;j<=r;j++)\n\t\t\t{\n\t\t\t\tif(s[j]=='a')\n\t\t\t\t{\n\t\t\t\t\tap++;\n\t\t\t\t\tif(ap>=i)\n\t\t\t\t\t\tnow+='a';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbp++;\n\t\t\t\t\tif(bp>=i)\n\t\t\t\t\t\tnow+='b';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(now>ss[dn])\n\t\t\t\tss[dn]=now;\n\t\t}\n\t}\n}\nint main()\n{\n\tint n,cnt=0,l=0;\n\tcin>>n;\n\tcin>>s;\n\tn<<=1;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t\tcnt++;\n\t\telse\n\t\t\tcnt--;\n\t\tif(cnt==0)\n\t\t{\n\t\t\twork(l,i);\n\t\t\tl=i+1;\n\t\t}\n\t}\n\tans=\"\";\n\tfor(int i=dn;i>=1;i--)\n\t\tif(ss[i]+ans>ans)\n\t\t\tans=ss[i]+ans;\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n\ntypedef long long ll;\ntypedef pair<int, int> pi;\n\nstring s;\nint n;\nconst int maxn = 3005;\nint a[maxn], b[maxn];\nstring dp[maxn];\nbool vis[maxn * 2];\n\nint main(){\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    cin >> s;\n    int n1 = 0, n2 = 0;\n    for(int i = 0;i < 2 * n;i++){\n        if(s[i] == 'a'){\n            a[++n1] = i;\n        }else{\n            b[++n2] = i;\n        }\n    }\n    for(int i = 0;i < maxn;i++){\n        dp[i] = \"\";\n    }\n    for(int i = n;i >= 1;i--){\n        if(a[i] < b[i]){\n            int j = i;\n            while(j <= n and (a[j] < b[i])){\n                j++;\n            }\n            dp[i] = \"ab\" + dp[j];\n        }else{\n            memset(vis, false, sizeof(vis));\n            int r = a[i], j = i;\n            while(j <= n and b[j] <= r){\n                vis[a[j]] = true;\n                vis[b[j]] = true;\n                r = max(r, a[j]);\n                j++;\n            }\n            for(int k = 0;k < 2 * n;k++){\n                if(vis[k])\n                    dp[i].push_back(s[k]);\n            }\n            dp[i] += dp[j];\n        }\n        dp[i] = max(dp[i], dp[i + 1]);\n    }\n    cout << dp[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define per(i,a,b) for(int i=a;i>=b;i--)\nusing namespace std;\nint n;char s[6666];bool a[6666];\nstring x,y;\nint main(){\n\tscanf(\"%d%s\",&n,s+1);n<<=1;\n\tper(t,n>>1,1){\n\t\ty=\"\";int cnt0=0,cnt1=0;\n\t\trep(i,1,n){\n\t\t\ts[i]=='a'?cnt0++:cnt1++;\n\t\t\tif(a[i]||(s[i]=='a'&&cnt0==t)||(s[i]=='b'&&cnt1==t))y=y+s[i];\n\t\t}\n\t\tif(y>x){\n\t\t\tx=y;cnt0=0,cnt1=0;\n\t\t\trep(i,1,n){\n\t\t\t\ts[i]=='a'?cnt0++:cnt1++;\n\t\t\t\ta[i]|=(s[i]=='a'&&cnt0==t)|(s[i]=='b'&&cnt1==t);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<x;return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//一个奇怪的做法...QwQ\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define qwq(x) cout<<\"# \"<<#x<<\" = \"<<x<<endl;\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef long long ll;\n \ntemplate<class T> inline void read(T &x){\n\tint f=0;x=0;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())f|=(ch=='-');\n\tfor(;isdigit(ch);ch=getchar())x=x*10+ch-'0';\n\tif(f)x=-x;\n}\n\nconst int N=3005;\nint l[N],r[N],id[N],n,cnt,ia,ib;\nstring f[N],g[N];\nchar s[N];\n\nstring calc(int l,int r){\n\tif(s[l]=='a'){\n\t\tstring res;\n\t\tint flag=0;\n\t\trep(i,l,r)\n\t\t\tif(s[i]=='a'){\n\t\t\t\tflag=1;\n\t\t\t}\n\t\t\telse if(s[i]=='b'&&flag){\n\t\t\t\tres+=\"ab\";\n\t\t\t\tflag=0;\n\t\t\t}\n\t\treturn res;\n\t}\n\tstring best,now;\n\trep(i,l,r)\n\t\tif(s[i]=='b'){\n\t\t\tnow=\"\";\n\t\t\trep(j,i,r)\n\t\t\t\tif(id[j]>=id[i])\n\t\t\t\t\tnow+=s[j];\n\t\t\tbest=max(best,now);\n\t\t}\n\treturn best;\n}\n\nint main(){\n\tread(n);\n\tscanf(\"%s\",s+1);\n\tint t=0,las=0;\n\trep(i,1,n*2){\n\t\tif(s[i]=='a'){\n\t\t\tt++;\n\t\t\tid[i]=++ia;\n\t\t}\n\t\telse{\n\t\t\tt--;\n\t\t\tid[i]=++ib;\n\t\t}\n\t\tif(t==0){\n\t\t\tl[++cnt]=las+1;\n\t\t\tr[cnt]=i;\n\t\t\tlas=i;\n\t\t}\n\t}\n\trep(i,1,cnt){\n\t\tg[i]=calc(l[i],r[i]);\n\t}\n\tper(i,cnt,1){\n\t\tf[i]=max(f[i+1],g[i]+f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cstring>\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define FOR(i, a, b) for (int i = (a); i < (b); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define TRACE(x) cout << #x << \" = \" << x << endl\n#define _ << \" _ \" <<\n\ntypedef long long llint;\n\nconst int MAX = 6666;\n\nchar s[MAX];\nint w[MAX];\nstring f[MAX];\nstring g[MAX];\nint h[MAX];\nint bio[MAX];\nint cookie;\n\nint main(void) {\n  int N;\n  scanf(\"%d\", &N);\n  scanf(\"%s\", s);\n\n  vector<int> a, b;\n  REP(i, 2 * N) {\n    if (s[i] == 'a') {\n      w[i] = a.size();\n      a.push_back(i);\n    } else {\n      w[i] = b.size();\n      b.push_back(i);\n    }\n  }\n\n  REP(i, 2 * N) {\n    if (s[i] == 'b' && a[w[i]] > i) {\n      cookie++;\n\n      int e = i, j = i;\n      while (j <= e) {\n        if (s[j] == 'b' && a[w[j]] > j) {\n          if (a[w[j]] > j) {\n            bio[a[w[j]]] = cookie;\n            e = max(e, a[w[j]]);\n          }\n          g[i].push_back(s[j]);\n        } else if (bio[j] == cookie) {\n          if (s[j] == 'a') {\n            if (b[w[j]] > i) {\n              bio[b[w[j]]] = cookie;\n            }\n          }\n          g[i].push_back(s[j]);\n        }\n        j++;\n      }\n      h[i] = e;\n\n      while (j < 2 * N) {\n        if (bio[j] == cookie) g[i].push_back(s[j]);\n        j++;\n      }\n\n    }\n  }\n\n  f[N] = \"\";\n  for (int i = 2 * N - 1; i >= 0; --i) {\n    f[i] = f[i + 1];\n    if (s[i] == 'a') {\n      if (b[w[i]] > i) {\n        f[i] = max(f[i], \"ab\" + f[b[w[i]] + 1]);\n      }\n    } else {\n      if (a[w[i]] > i) {\n        f[i] = max(f[i], g[i] + f[h[i] + 1]);\n      }\n    }\n  }\n\n  puts(f[0].c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint n;\nstring s;\nint posa[3005], posb[3005], m[6005];\n\nstring dp[6005];\n\nint main() {\n\tcin >> n >> s;\n\tint cta = 0, ctb = 0;\n\tfor (int i = 0; i < 2*n; ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\tposa[cta] = i;\n\t\t\tcta++;\n\t\t} if (s[i] == 'b') {\n\t\t\tposb[ctb] = i;\n\t\t\tctb++;\n\t\t}\n\t}\n\tfor (int i = 0; i < n; ++i) {\n\t\tm[posa[i]] = posb[i];\n\t\tm[posb[i]] = posa[i];\n\t}\n\n\tfor (int i = 2*n; i >= 0; --i) {\n\t\tif (i == 2*n) {\n\t\t\tdp[i] = \"\";\n\t\t\tcontinue;\n\t\t}\n\t\tif (m[i] < i) {\n\t\t\tdp[i] = dp[i+1];\n\t\t\tcontinue;\n\t\t}\n\t\tdp[i] = dp[i+1];\n\t\tif (s[i] == 'a') {\n\t\t\tint k = m[i];\n\t\t\tdp[i] = max(dp[i], \"ab\" + dp[k+1]);\n\t\t\tcontinue;\n\t\t}\n\t\tbool c[6005];\n\t\tmemset(c, 0, sizeof(c));\n\t\tc[i] = c[m[i]] = 1;\n\t\tint r = m[i];\n\t\tint l = i;\n\t\twhile (true) {\n\t\t\tif (l > r)\n\t\t\t\tbreak;\n\t\t\tif (c[l]) {\n\t\t\t\tl++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (s[l] == 'b') {\n\t\t\t\tc[l] = c[m[l]] = 1;\n\t\t\t\tr = m[l];\n\t\t\t}\n\t\t\tl++;\n\t\t}\n\t\tstring res = \"\";\n\t\tfor (int j = 0; j < 2*n; ++j)\n\t\t\tif (c[j])\n\t\t\t\tres += s[j];\n\t\tres += dp[l];\n\t\tdp[i] = max(dp[i], res);\n\t}\n\n\tcout << dp[0] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw){\n            continue;\n        }\n        if (ppp[i].first[0] == 'a'){\n            for (int j=i; j < ppp.size(); j++){\n                if (ppp[i].second > nw) ans += ppp[j].first;\n            }\n            break;\n        }\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n; string s; cin >> n >> s; n *= 2; assert(n > 6);\n\tvector<string> v;\n\tfor(int i = 0, k = 0, p = 0; i < n; i++){\n\t\tif(s[i] == 'a') k++;\n\t\telse k--;\n\t\tif(k == 0){\n\t\t\tv.pb(s.substr(p, i + 1 - p));\n\t\t\tp = i + 1;\n\t\t}\n\t}\n\treverse(all(v));\n\t\n\tstring ans;\n\tbool b = 0;\n\t\n\tfor(string i : v){\n\t\tvi ord(i.size());\n\t\tint x = 0, y = 0;\n\t\tstring tmp;\n\t\trep(j, i.size()){\n\t\t\tif(i[j] == 'a') ord[j] = x++;\n\t\t\telse ord[j] = y++;\n\t\t}\n\t\tassert(x == y);\n\t\tif(i[0] == 'a'){\n\t\t\tif(b) continue;\n\t\t\t\n\t\t\tint cnt = 0;\n\t\t\trep(j, i.size()){\n\t\t\t\tcnt++;\n\t\t\t\tint o = ord[j];\n\t\t\t\twhile(j < i.size() && !(i[j] == 'b' && ord[j] == o)) j++;\n\t\t\t}\n\t\t\trep(it, cnt) tmp += \"ab\";\n\t\t\tans = tmp + ans;\n\t\t}\n\t\telse{\n\t\t\tb = 1;\n\t\t\ttmp = ans;\n\t\t\trep(j, x + 1){\n\t\t\t\tstring t;\n\t\t\t\trep(k, i.size()) if(ord[k] >= j) t += i[k];\n\t\t\t\ttmp = max(tmp, t + ans);\n\t\t\t}\n\t\t\tans = tmp;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num) v[i]=bs(i);\n\tint p=ok();\n\t//assert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\nvoid ok(string a, string b) {\n  if (a == b) return;\n  if (a.size() < b.size()) swap(a, b);\n  if (b == \"\") return;\n  rep(i, b.size()) if (a[i] != b[i]) return;\n  assert(false);\n}\nvoid ok2(string s) {\n  int a = 0, b = 0;\n  rep(i, (int)s.size()-1) {\n    if (s[i] == 'a') a++;\n    else b++;\n    assert(a != b);\n  }\n}\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  int ctr = 0;\n  while (!s.empty()) {\n    while (!s.empty() && s.front() != 'a') s.erase(s.begin());\n    if (s.empty()) break;\n    s.erase(s.begin());\n    while (s.front() != 'b') s.erase(s.begin());\n    s.erase(s.begin());\n    ctr++;\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (b == num || pos_a[a] < pos_b[b]) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    //cout<<\"offset=\"<<offset<<\": \"<<o<<\"\\n\";\n    ok2(o);\n    ok(m, o);\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<pair<string, int> > list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(make_pair(solve_ba(s), -i));\n    }\n  }\n  sort(all(list2), greater<pair<string, int> >());\n  for (auto p1 : list2) for (auto p2 : list2) ok(p1._1, p2._1); //\n  string out = \"\";\n  int lp = -1;\n  for (auto p : list2) {\n    int ord = -p._2;\n    if (lp < ord) {\n      out += p._1;\n      lp = ord;\n    }\n  }\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  //cout<<\"add=\"<<add<<\"\\n\";\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t\tcontinue;\n\t\t\tres+=\"ab\";\n\t\t\tcur=nxt[cur]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<X.size();A++)\n\t\tfor(int B=A+1;B<X.size();B++)\n\t\t\tif(occurence[A]==occurence[B])\n\t\t\t\tnxt[A]=B;\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\nusing namespace std;\nint N;\nchar S[6005];\nchar P[6005][6005];\nint p;\nint Pair[6005];\nint Ind[6005];\nint Right[6005];\nchar W[6005], Sol[6005], DP[6005][6005];\nvector <int> V[2];\nvoid Read()\n{\n    cin >> N;\n    cin.get();\n    cin.getline(S + 1, 6005);\n    for(int i = 1; i <= N * 2; i++)\n    {\n        if(S[i] == 'a')\n            V[0].push_back(i);\n        else\n            V[1].push_back(i);\n    }\n    for(int i = 0; i < V[0].size(); i++)\n    {\n        Pair[V[0][i]] = V[1][i];\n        Pair[V[1][i]] = V[0][i];\n    }\n}\nvoid fillP(int pos)\n{\n    int left = Right[pos - 1] + 1, right = Right[pos];\n    if(S[left] == 'a')\n    {\n        int curr = Pair[left], ind = 0;\n        P[pos][++Ind[pos]] = 'a';\n        P[pos][++Ind[pos]] = 'b';\n        ++curr;\n        while(curr >= left && curr <= right)\n        {\n            if(S[curr] == 'b')\n            {\n                ++curr;\n                continue;\n            }\n            P[pos][++Ind[pos]] = 'a';\n            P[pos][++Ind[pos]] = 'b';\n            curr = Pair[curr] + 1;\n        }\n    }\n    else\n    {\n        int ind = 0;\n        for(int i = left; i <= right; i++)\n            Sol[++ind] = S[i];\n        Sol[ind + 1] = 0;\n        ind = 0;\n        for(int i = left + 1; i <= right; i++)\n        {\n            ind = 0;\n            for(int j = i; j <= right; j++)\n            {\n                if(S[j] == 'b')\n                    W[++ind] = S[j];\n                else\n                    if(Pair[j] >= i && Pair[j] <= right)\n                        W[++ind] = S[j];\n            }\n\n            if(strcmp(Sol + 1, W + 1) < 0)\n            {\n                for(int j = 1; j <= ind; j++)\n                    Sol[j] = W[j];\n                Sol[ind + 1] = 0;\n            }\n        }\n        ind = 0;\n        for(int j = 1; Sol[j] != 0; j++)\n            P[pos][++ind] = Sol[j];\n    }\n}\nvoid Parts()\n{\n    int cnt = 0;\n    for(int i = 1; i <= N * 2; i++)\n    {\n        if(S[i] == 'a')\n            ++cnt;\n        else\n            --cnt;\n        if(cnt == 0)\n        {\n            ++p;\n            Right[p] = i;\n            fillP(p);\n        }\n    }\n}\n\nvoid precalcDP()\n{\n    strcpy(DP[p] + 1, P[p] + 1);\n    for(int i = p - 1; i >= 1; i--)\n    {\n        strcpy(DP[i] + 1, DP[i + 1] + 1);\n        strcpy(W + 1, P[i] + 1);\n        if(strcmp(DP[i] + 1, W + 1) < 0)\n            strcpy(DP[i] + 1, W + 1);\n        strcat(W + 1, DP[i + 1] + 1);\n        if(strcmp(DP[i] + 1, W + 1) < 0)\n            strcpy(DP[i] + 1, W + 1);\n    }\n    cout << (DP[1] + 1) << \"\\n\";\n}\nint main()\n{\n    Read();\n    Parts();\n    precalcDP();\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nnamespace {\n\n#define VEVE(i, a, b) for (ll i = a, __##i = b; i < __##i; ++i)\n#define DYDY(i, a, b) for (ll i = a, __##i = b; i > __##i; --i)\n#define RARA(x, seq) for (auto &x : seq)\n#define SIZE(x) ((ll)(x.size()))\n#define ALL(x) x.begin(), x.end()\n\ntypedef int ll;\ntypedef double dd;\n\nvoid Solve(ll) {\n  ll n;\n  string str;\n  cin >> n >> str;\n  vector<ll> pos[2];\n  VEVE(i, 0, 2 * n) {\n    pos[str[i] - 'a'].push_back(i);\n  }\n  vector<pair<ll, ll>> ab, ba;\n  VEVE(i, 0, n) {\n    if (pos[0][i] < pos[1][i])\n      ab.emplace_back(pos[0][i], pos[1][i]);\n    else\n      ba.emplace_back(pos[1][i], pos[0][i]);\n  }\n  ba.emplace_back(1e7, 1e7 + 1);\n  auto is_less = [&](const vector<ll>& a, const vector<ll>& b) {\n    VEVE(i, 0, min(SIZE(a), SIZE(b))) if (str[a[i]] != str[b[i]]) {\n        return str[a[i]] < str[b[i]];\n      }\n    return SIZE(a) < SIZE(b);\n  };\n  // max string starting at ba-segment >= i\n  vector<vector<ll>> dp(SIZE(ba) + 1);\n  queue<ll> eds;\n  DYDY(i, SIZE(ba) - 2, -1) {\n    while (not eds.empty())\n      eds.pop();\n    eds.push(ba[i].second);\n    vector<ll> now;\n    now.push_back(ba[i].first);\n    VEVE(j, i + 1, SIZE(ba)) {\n      while (not eds.empty() and ba[j].first > eds.front()) {\n        now.push_back(eds.front());\n        eds.pop();\n      }\n      if (eds.empty()) {\n        dp[i] = now;\n        RARA(v, dp[j]) {\n          dp[i].push_back(v);\n        }\n        break;\n      } else {\n        eds.push(ba[j].second);\n        now.push_back(ba[j].first);\n      }\n    }\n    if (is_less(dp[i], dp[i + 1]))\n      dp[i] = dp[i + 1];\n  }\n  auto seq = dp.front();\n  RARA(oth, ab) {\n    if (seq.empty() or oth.first > seq.back()) {\n      seq.push_back(oth.first);\n      seq.push_back(oth.second);\n    }\n  }\n  string res;\n  RARA(idx, seq) res += str[idx];\n  cout << res << endl;\n}\n\nvoid Init() {\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n}\n}\n\nint32_t main() {\n#ifdef AZN\n  freopen(\"input.txt\", \"r\", stdin);\n#endif\n  Init();\n  ll tests = 1;\n//  cin >> tests;\n  VEVE(test, 1, tests + 1) Solve(test);\n  return 0;\n}\n// bbaababababa"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MAXN 6010\n\nint n,n2,m1,m2,m;\nchar s[MAXN];\nint p1[MAXN],p2[MAXN],id[MAXN];\nint s1[MAXN];\nint a[MAXN],b[MAXN];\nint h[MAXN][MAXN],len[MAXN];\nint ans[MAXN];\nbool visit[MAXN];\n\nint getS1(int l,int r){ return s1[r]-s1[l-1]; }\nint getS2(int l,int r){ return r-l+1-s1[r]+s1[l-1]; }\n\nbool cmp(int x,int y){\n\tfor(int i=1;i<=len[x] && i<=len[y];i++)\n\t\tif(h[x][i]^h[y][i]) return h[x][i]<h[y][i];\n\treturn len[x]<len[y];\n}\n\nint main(){\n#ifdef DEBUG\n\tfreopen(\"E.in\",\"r\",stdin);\n#endif\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tn2=n<<1;\n\tfor(int i=1;i<=n2;i++)\n\t\tif(s[i]=='a') p1[++m1]=i,id[i]=m1;\n\t\telse p2[++m2]=i,id[i]=m2;\n\tfor(int i=1;i<=n2;i++) s1[i]=s1[i-1]+(s[i]=='a'?1:0);\n\tfor(int i=1;i<=n;i++)\n\t\tif(p2[i]<p1[i])\n\t\t\ta[p2[i]]=getS2(p2[i],p1[i]);\n\tbool flag=0;\n\tint last=n2+1,lastp=n2+1;\n\tfor(int i=n2;i>=1;i--)\n\t\tif(getS1(i,n2)==getS2(i,n2)){\n\t\t\tif(s[i]=='b'){\n\t\t\t\tflag=1;\n\t\t\t\tfor(int j=last-1;j>=i;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tfor(int k=j;k<last;k++)\n\t\t\t\t\t\t\tif(s[k]=='b')\n\t\t\t\t\t\t\t\th[j][++len[j]]=a[k];\n\t\t\t\t\t\tfor(int k=m;k>=1;k--)\n\t\t\t\t\t\t\th[j][++len[j]]=b[k];\n\t\t\t\t\t}\n\t\t\t\tint res=i;\n\t\t\t\tfor(int j=i+1;j<last;j++)\n\t\t\t\t\tif(s[j]=='b' && cmp(res,j))\n\t\t\t\t\t\tres=j;\n\t\t\t\tfor(int j=last-1;j>=res;j--)\n\t\t\t\t\tif(s[j]=='b'){\n\t\t\t\t\t\tb[++m]=a[j];\n\t\t\t\t\t\tans[m]=id[j];\n\t\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(!flag) lastp=i;\n\t\t\t}\n\t\t\tlast=i;\n\t\t}\n\tfor(int i=1;i<=m;i++) visit[p1[ans[i]]]=visit[p2[ans[i]]]=1;\n\tfor(int i=1;i<=n2;i++) if(visit[i]) putchar(s[i]);\n\tint j=lastp-1;\n\tfor(int i=lastp;i<=n2;i++)\n\t\tif(s[i]=='a' && i>j){\n\t\t\tputchar('a'); putchar('b');\n\t\t\tj=p2[id[i]];\n\t\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef signed long long ll;\n\n#undef _P\n#define _P(...) (void)printf(__VA_ARGS__)\n#define FOR(x,to) for(x=0;x<(to);x++)\n#define FORR(x,arr) for(auto& x:arr)\n#define ITR(x,c) for(__typeof(c.begin()) x=c.begin();x!=c.end();x++)\n#define ALL(a) (a.begin()),(a.end())\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n//-------------------------------------------------------\n\nint N;\nstring S;\n\nstring hoge(string S) {\n\tint cnt[6030]={};\n\tint vis[6030]={};\n\tvector<int> As,Bs;\n\t\n\tint a=0,b=0,i,j;\n\tFOR(i,S.size()) {\n\t\tif(S[i]=='a') {\n\t\t\tcnt[i]=a++;\n\t\t\tAs.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tcnt[i]=b++;\n\t\t\tBs.push_back(i);\n\t\t}\n\t}\n\t\n\tstring R;\n\t\n\tif(S[0]=='a') {\n\t\tFOR(i,S.size()) {\n\t\t\tif(vis[i]==0) {\n\t\t\t\tR+=S[i];\n\t\t\t\tif(S[i]=='a') {\n\t\t\t\t\tfor(int j=i+1;j<Bs[cnt[i]];j++) vis[j]=vis[Bs[cnt[j]]]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tFOR(i,S.size()/2) {\n\t\t\tstring T;\n\t\t\tFOR(j,S.size()) {\n\t\t\t\tif(cnt[j]>=i) T+=S[j];\n\t\t\t}\n\t\t\tR=max(R,T);\n\t\t}\n\t}\n\treturn R;\n}\n\n\nvoid solve() {\n\tint i,j,k,l,r,x,y; string s;\n\t\n\tcin>>N>>S;\n\tstring T;\n\tvector<string> V;\n\t\n\tx=0;\n\tFORR(c,S) {\n\t\tT+=c;\n\t\tif(c=='a') x++;\n\t\telse x--;\n\t\tif(x==0) {\n\t\t\tstring P=hoge(T);\n\t\t\t\n\t\t\twhile(V.size() && P > V.back()+P) V.pop_back();\n\t\t\tV.push_back(P);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\t\n\tFORR(c,V) cout<<c;\n\tcout<<endl;\n\t\n}\n\n\nint main(int argc,char** argv){\n\tstring s;int i;\n\tif(argc==1) ios::sync_with_stdio(false), cin.tie(0);\n\tFOR(i,argc-1) s+=argv[i+1],s+='\\n'; FOR(i,s.size()) ungetc(s[s.size()-1-i],stdin);\n\tcout.tie(0); solve(); return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<vector>\nusing namespace std;\nvector<string> str,damn;\nvector<string> lis;\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tint n,i,j,k,l,lst=0,numa=0,numb=0,ite,nowa=0,nowb=0;\n\tstring s,t,hix;\n\tcin>>n>>s;\n\tfor(i=0;i<2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tnuma++;\n\t\t}\n\t\telse{\n\t\t\tnumb++;\n\t\t}\n\t\tif(numa==numb){\n\t\t\tstr.push_back(s.substr(lst,i-lst+1));\n\t\t\tlst=i+1;\n\t\t}\n\t}\n\tfor(i=0;i<str.size();i++){\n\t\tt=str[i];\n\t\thix=\"\";\n\t\tif(t[0]=='a'){\n\t\t\tite=0;\n\t\t\tnowa=0;\n\t\t\tnowb=0;\n\t\t\twhile(ite<t.size()){\n\t\t\t\twhile(ite<t.size()&&t[ite]=='b'){\n\t\t\t\t\tite++;\n\t\t\t\t\tnowb++;\n\t\t\t\t}\n\t\t\t\tif(ite==t.size()){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\thix+=\"ab\";\n\t\t\t\tnowa++;\n\t\t\t\tj=nowa;\n\t\t\t\twhile(j>nowb){\n\t\t\t\t\tite++;\n\t\t\t\t\tif(t[ite]=='b'){\n\t\t\t\t\t\tnowb++;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tnowa++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tnowb=0;\n\t\t\tfor(j=0;j<t.size();j++){\n\t\t\t\tif(t[j]=='b'){\n\t\t\t\t\tnowb++;\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnowb--;\n\t\t\t\t}\n\t\t\t\thix=max(hix,string(nowb,'b')+t.substr(j+1,t.size()-j-1));\n\t\t\t}\n\t\t}\n\t\tdamn.push_back(hix);\n\t}\n\tfor(i=0;i<damn.size();i++){\n\t\twhile(lis.size()&&lis.back()<damn[i]){\n\t\t\tlis.pop_back();\n\t\t}\n\t\tlis.push_back(damn[i]);\n\t}\n\tfor(i=0;i<lis.size();i++){\n\t\tcout<<lis[i];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// {{{ by shik\n#include <bits/stdc++.h>\n#pragma GCC diagnostic ignored \"-Wunused-result\"\n#pragma GCC diagnostic ignored \"-Wunused-function\"\n#define SZ(x) ((int)(x).size())\n#define ALL(x) begin(x), end(x)\n#define REP(i, n) for (int i = 0; i < int(n); i++)\n#define REP1(i, a, b) for (int i = (a); i <= int(b); i++)\n#define MP make_pair\n#define PB push_back\nusing namespace std;\ntypedef int64_t LL;\ntypedef pair<int, int> PII;\ntypedef vector<int> VI;\n\nnamespace { namespace shik {\n\ntemplate<class T> void _R(T &x) { cin >> x; }\nvoid _R(int &x) { scanf(\"%d\", &x); }\nvoid _R(int64_t &x) { scanf(\"%\" SCNd64, &x); }\nvoid _R(double &x) { scanf(\"%lf\", &x); }\nvoid _R(char &x) { scanf(\" %c\", &x); }\nvoid _R(char *x) { scanf(\"%s\", x); }\nvoid R() {}\ntemplate<class T, class... U> void R(T &head, U &... tail) { _R(head); R(tail...); }\n\ntemplate<class T> void _W(const T &x) { cout << x; }\nvoid _W(const int &x) { printf(\"%d\", x); }\nvoid _W(const int64_t &x) { printf(\"%\" PRId64, x); }\nvoid _W(const double &x) { printf(\"%.16f\", x); }\nvoid _W(const char &x) { putchar(x); }\nvoid _W(const char *x) { printf(\"%s\", x); }\ntemplate<class T> void _W(const vector<T> &x) { for (auto i = x.begin(); i != x.end(); _W(*i++)) if (i != x.cbegin()) putchar(' '); }\nvoid W() {}\ntemplate<class T, class... U> void W(const T &head, const U &... tail) { _W(head); putchar(sizeof...(tail) ? ' ' : '\\n'); W(tail...); }\n\n#ifdef SHIK\n#include \"dump.hpp\"\n#else\n#define dump(...)\n#endif\n\ntemplate<class T, class F = less<T>> void sort_uniq(vector<T> &v, F f = F()) { sort(begin(v), end(v), f); v.resize(unique(begin(v), end(v)) - begin(v)); }\ntemplate<class T> inline T bit(T x, int i) { return (x >> i) & 1; }\ntemplate<class T> inline bool chkmax(T &a, const T &b) { return b > a ? a = b, true : false; }\ntemplate<class T> inline bool chkmin(T &a, const T &b) { return b < a ? a = b, true : false; }\ntemplate<class T> using MaxHeap = priority_queue<T>;\ntemplate<class T> using MinHeap = priority_queue<T, vector<T>, greater<T>>;\n\n// }}}\n\nconst int N=3010;\nint n,na,nb,a[N],b[N];\nchar s[2*N];\nstring dp[N];\n\nvoid main() {\n    R(n,s);\n    REP(i,2*n) {\n        if ( s[i]=='a' ) a[na++]=i;\n        else b[nb++]=i;\n    }\n    assert(na==n && nb==n);\n    for ( int i=n-1; i>=0; i-- ) {\n        dp[i]=dp[i+1];\n        if ( a[i]<b[i] ) {\n            int j=i+1;\n            while ( j<n && min(a[j],b[j])<b[i] ) j++;\n            chkmax(dp[i],\"ab\"s+dp[j]);\n        } else {\n            int mx=max(a[i],b[i]);\n            int j=i;\n            vector<pair<int,char>> v;\n            while ( j<n && min(a[j],b[j])<=mx ) {\n                v.PB({a[j],'a'});\n                v.PB({b[j],'b'});\n                chkmax(mx,max(a[j],b[j]));\n                j++;\n            }\n            sort(ALL(v));\n            string z;\n            for ( auto &k:v ) z.push_back(k.second);\n            chkmax(dp[i],z+dp[j]);\n        }\n        dump(i,dp[i]);\n    }\n    W(dp[0]);\n}\n\n// {{{ main\n}}\nint main() { shik::main(); return 0; }\n// }}}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\n\npair<string,int> solve(int l){\n\tint i=l+1;\n\tvector<string> ss;\n\twhile(abs(s[l]-s[i])!=1){\n\t\tauto p=solve(i);\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\tvector<string> re;\n\trrep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret,reb;\n\trrep(i,re.size()) ret+=re[i];\n\trrep(i,re.size())if(re[i][0]=='b') reb+=re[i];\n\tif(l) MX(ret,string(1,s[l])+ret+string(1,s[i]));\n\tif(l && re.size()) MX(ret,string(1,s[l])+re.front()+string(1,s[i]));\n\tif(re.size()) MX(ret,re.front());\n\tMX(ret,reb);\n\tif(l) MX(ret,string(1,s[l])+reb+string(1,s[i]));\n\t++i;\n\tout(l,i,ret,1);\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\twhile(1){\n\t\ts=\"e\"+s+\"f\";\n\t\tauto re=solve(0);\n\t\tif(re.X==s.substr(1,s.size()-2)) break;\n\t\ts=re.X;\n\t\tout(re,1);\n\t\tassert(re.Y==2*n+2);\n\t}\n\tcout<<s.substr(1,s.size()-2)<<endl;\n\t// assert(re[0]=='e');\n\t// assert(re[m-1]=='f');\n\t// cout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool compare(string s1, string s2){\n    int l1 = s1.length();\n    int l2 = s2.length();\n    for(int i=0; i<min(l1,l2); i++){\n        if(s1[i] -'a' > s2[i]-'a')\n            return true;\n        else if(s1[i] -'a' < s2[i] -'a')\n            return false;\n    }\n    if(l1 >= l2)\n        return true;\n    else\n        return false;\n}\n\nstring solve(string s){\n    int l = s.length();\n    int n = l/2;\n    int a[n],b[n];\n    int acount = 0, bcount = 0;\n    for(int i=0; i<l; i++){\n        if(s[i] =='a'){\n            a[acount] = i;\n            acount++;\n        }\n        else{\n            b[bcount] = i;\n            bcount++;\n        }\n    }\n    vector<string> all;\n    for(int i=0; i<n; i++){\n        string t = \"\";\n        for(int j=b[i]; j<a[i]; j++){\n            if(s[j] =='b')\n                t+=\"b\";\n        }\n        t += s.substr(a[i], l - a[i]);\n        all.push_back(t);\n    }\n    string ans = all[0];\n    for(int i=0; i<n; i++){\n        if(!compare(ans,all[i]))\n            ans = all[i];\n    }\n    return ans;\n}\n\n\nint main()\n{\n    int N;\n    string S;\n    cin>>N;\n    cin>>S;\n    vector<pair<int,int> > segments;\n    int partials = 0;\n    int prev = 0;\n    bool check = false;\n    for(int i=0; i<2*N; i++){\n        if(S[i] == 'a')\n            partials++;\n        else\n            partials--;\n        if(partials == 0){\n            if(S[i] == 'a'){\n                segments.push_back(make_pair(prev, i));\n                check = true;\n            }\n            prev = i+1;\n        }\n    }\n\n\n\n    int l = segments.size();\n    vector<string> subanswers;\n    for(int i=0; i<l; i++){\n        subanswers.push_back(solve(S.substr(segments[i].first, segments[i].second - segments[i].first + 1)));\n    }\n\n\n    if(check){\n        string output = \"\";\n        for(int i=0; i<l; i++){\n            bool use = true;\n            string s1 = subanswers[i];\n            for(int j=i; j<l; j++){\n                string s2 = subanswers[j];\n                if(!compare(s1,s2))\n                    use = false;\n\n            }\n            if(use){\n                output += s1;\n            }\n\n\n        }\n        cout<<output;\n        int last = segments[l-1].second;\n        int current = 0;\n        int repeats = 0;\n        for(int i= last +1; i<l ; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    current = 1;\n                    repeats += 1;\n                }\n            }\n            else{\n                if(S[i]=='b'){\n                    current = 0;\n                }\n            }\n\n        }\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n    else{\n        int current = 0;\n        int repeats = 0;\n        for(int i=0; i<2*N; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    current = 1;\n                    repeats += 1;\n                }\n            }\n            else{\n                if(S[i]=='b'){\n                    current = 0;\n                }\n            }\n        }\n\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cmath>\n#include<cstdio>\n#include<queue>\n#include<algorithm>\nusing namespace std;\nint n,a[6005],b[6005],c[6005],n1,n2;\nchar s[6005];\nbool dp[3005][3005];\nstring ask(bool dp[])\n{\n\tstring ans=\"\";\n\tfor(int i=1;i<=2*n;i++) if(dp[c[i]]) ans+=s[i];\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++)\n\t{\n\t\tif(s[i]=='a') a[++n1]=i,c[i]=n1;\n\t\telse b[++n2]=i,c[i]=n2;\n\t}\n\tdp[n][n]=1;\n\tfor(int i=n-1;i>=1;i--)\n\t{\n\t\tdp[i][i]=1;\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tint maxx=0;\n\t\t\tfor(int j=a[i];j<=b[i];j++) if(c[j]>=i) maxx=max(maxx,c[j]);\n\t\t\tfor(int j=b[i]+1;j<=2*n;j++) if(c[j]>maxx) dp[i][c[j]]=dp[i+1][c[j]];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint maxx=i,num=0;\n\t\t\tfor(int j=b[i];j<=a[i];j++)\n\t\t\t{\n\t\t\t\tif(c[j]<i) continue;\n\t\t\t\tif(c[j]!=i) num++;\n\t\t\t\tmaxx=max(maxx,c[j]);dp[i][c[j]]=1;\n\t\t\t}\n\t\t\tfor(int j=a[i]+1;j<=2*n;j++)\n\t\t\t{\n\t\t\t\tif(c[j]<i) continue;\n\t\t\t\tif(s[j]=='b')\n\t\t\t\t{\n\t\t\t\t\tif(!num) dp[i][c[j]]=dp[maxx+1][c[j]];\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]]=1;maxx=max(maxx,c[j]);\n\t\t\t\t\t\tnum++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(!num) dp[i][c[j]]=dp[maxx+1][c[j]];\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]]=1;maxx=max(maxx,c[j]);\n\t\t\t\t\t\tnum--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(ask(dp[i])<=ask(dp[i+1])) memcpy(dp[i],dp[i+1],sizeof(dp[i+1]));\n\t}\n\tcout<<ask(dp[1]);\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * Since g++10 is released, some characters is not valid inside #if 0 :(\n * So, why not using clang++? :D\n\n * Date:\n  echo -n '  ' && date +%Y.%m.%d\n\n * Solution:\n  To be updated.\n\n * Digression:\n\n * CopyRight:\n          ▁▃▄▄▄▃▃▃▃▄▶\n        ▗▇▀▔    ▔▔▔▔\n       ▄▛   ▃▅━━■▄▂\n      ▟▊   ▐▘     ▀▙\n     ▟▜▌   ▐▖   ▋  ▐▍\n    ▟▘ ▜   ▝▀▇▆●▘  ▐▌\n  ▗▟▘   ▜▃       ▁▅▛\n  ▔▀▼▅▄▃▃██▅▄▄▄▅■▀▔\n        ▔▔▔▔▔▔\n */\n\n#include <cstdio>\n#include <algorithm>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long ll;\n\nstruct _{\n\tinline operator int () { int x; return scanf(\"%d\", &x), x; }\n\tinline operator ll () { ll x; return scanf(\"%lld\", &x), x; }\n} read;\n\nconst int maxn = 3000;\nchar s[maxn * 2 + 5], t[maxn * 2 + 5], ans[maxn * 2 + 5];\nbool mark[maxn * 2 + 5];\nint apos[maxn + 5], bpos[maxn + 5];\n/* struct R { int l, r; } ra[maxn + 5]; */\n\n/* bool cmp (R a, R b) { */\n/* \tint alim = a.r - a.l + 1, blim = b.r - b.l + 1; */\n/* \tfor (int i = 0; i < alim and i < blim; i ++) */\n/* \t\tif (t[a.l + i] != t[b.l + i]) */\n/* \t\t\treturn t[a.l + i] > t[b.l + i]; */\n/* \tif (alim == blim) return a.l < b.l; */\n/* \treturn alim > blim; // impossible */\n/* } */\n\nbool check (int ansp, int tp) {\n\tint lim = std::min(ansp, tp);\n\tfor (int i = 1; i <= lim; i ++)\n\t\tif (t[i] != ans[i])\n\t\t\treturn t[i] > ans[i];\n\treturn tp > ansp;\n}\n\nint main () {\n\tint n = read;\n\tscanf(\"%s\", s + 1);\n\n\tint ap = 0, bp = 0;\n\tfor (int i = 1; i <= n * 2; i ++) {\n\t\tif (s[i] == 'a') apos[++ ap] = i;\n\t\tif (s[i] == 'b') bpos[++ bp] = i;\n\t}\n\n\tint ansp = 0, end = 0;\n\tfor (int be = n; be; be --)\n\t\tif (apos[be] > bpos[be]) {\n\t\t\tmark[apos[be]] = mark[bpos[be]] = 1;\n\t\t\tint tp = 0;\n\t\t\tfor (int i = 1; i <= n * 2; i ++)\n\t\t\t\tif (mark[i])\n\t\t\t\t\tt[++ tp] = s[i];\n\t\t\t/* t[tp + 1] = 0; */\n\t\t\t/* debug(\"%s\\n\", t + 1); */\n\t\t\tif (check(ansp, tp)) {\n\t\t\t\tstd::copy(t, t + tp + 1, ans);\n\t\t\t\tansp = tp;\n\t\t\t}\n\t\t\tif (!end) end = apos[be];\n\t\t}\n\n\tfor (int i = 1; i <= ansp; i ++)\n\t\tputchar(ans[i]);\n\tfor (int i = 1; i <= n; i ++)\n\t\tif (end < apos[i] and apos[i] < bpos[i])\n\t\t\tputchar('a'), putchar('b'), end = bpos[i];\n\n\tputs(\"\");\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n; string s; cin >> n >> s; n *= 2; assert(n > 6);\n\tvector<string> v;\n\tfor(int i = 0, k = 0, p = 0; i < n; i++){\n\t\tif(s[i] == 'a') k++;\n\t\telse k--;\n\t\tif(k == 0){\n\t\t\tv.pb(s.substr(p, i + 1 - p));\n\t\t\tp = i + 1;\n\t\t}\n\t}\n\treverse(all(v));\n\t\n\tstring ans;\n\tbool b = 0;\n\t\n\tfor(string i : v){\n\t\tvi ord(i.size());\n\t\tint x = 0, y = 0;\n\t\tstring tmp;\n\t\trep(j, i.size()){\n\t\t\tif(i[j] == 'a') ord[j] = x++;\n\t\t\telse ord[j] = y++;\n\t\t}\n\t\t\n\t\tif(i[0] == 'a'){\n\t\t\tif(b) continue;\n\t\t\t\n\t\t\tint cnt = 0;\n\t\t\trep(j, i.size()){\n\t\t\t\tcnt++;\n\t\t\t\tint o = ord[j];\n\t\t\t\twhile(j < i.size() && !(i[j] == 'b' && ord[j] == o)) j++;\n\t\t\t}\n\t\t\trep(it, cnt) tmp += \"ab\";\n\t\t}\n\t\telse{\n\t\t\tb = 1;\n\t\t\trep(j, x){\n\t\t\t\tstring t;\n\t\t\t\trep(k, i.size()) if(ord[k] >= j) t += i[k];\n\t\t\t\ttmp = max(tmp, t);\n\t\t\t}\n\t\t}\n\t\tans = tmp + ans;\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e6;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#endif\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long double ld;\n\n#ifdef DEBUG\n#define eprintf(...) fprintf(stderr, __VA_ARGS__), fflush(stderr)\n#else\n#define eprintf(...) ;\n#endif\n\n#define sz(x) ((int) (x).size())\n#define TASK \"text\"\n\nconst int inf = (int) 1.01e9;\nconst long long infll = (long long) 1.01e18;\nconst ld eps = 1e-9;\nconst ld pi = acos((ld) -1);\n\nmt19937 mrand(random_device{} ()); \n\nint rnd(int x) {\n  return mrand() % x;\n}\n\nvoid precalc() {\n}\n\nconst int maxn = 6005;\nint n;\nstring s;\nchar tmp[maxn];\n\nint read() {\n  if (scanf(\"%d\", &n) < 1) {\n    return false;\n  }\n  scanf(\"%s\", tmp);\n  s = tmp;\n  return true;\n}\n\nstring ans;\nint id[maxn];\n\nvoid solve1(const string &t, const string curans) {\n  for (int k = 0; k <= sz(t) / 2; k++) {\n    string cur;\n    int ca = 0, cb = 0;\n    for (int i = 0; i < sz(t); i++) {\n      if (t[i] == 'a') {\n        if (ca >= k) {\n          cur += t[i];\n        }\n        ca++;\n      } else {\n        if (cb >= k) {\n          cur += t[i];\n        }\n        cb++;\n      }\n    }\n    ans = max(ans, cur + curans);\n  }\n  {\n    int ca = 0, cb = 0;\n    for (int i = 0; i < sz(t); i++) {\n      if (t[i] == 'a') {\n        id[i] = ca;\n        ca++;\n      } else {\n        id[i] = cb;\n        cb++;\n      }\n    }\n  }\n  {\n    string cur;\n    for (int i = 0; i < sz(t);) {\n      while (i < sz(t) && t[i] != 'a') {\n        i++;\n      }\n      if (i >= sz(t)) {\n        break;\n      }\n      int p = id[i];\n      while (i < sz(t) && (t[i] != 'b' || id[i] != p)) {\n        i++;\n      }\n      if (i >= sz(t)) {\n        break;\n      }\n      cur += \"ab\";\n    }\n    ans = max(ans, cur + curans);\n  }\n}\n\nvoid solve() {\n  int bal = 0;\n  ans = \"\";\n  for (int i = 2 * n - 1, j = 2 * n; i >= 0; i--) {\n    bal += (s[i] == 'a' ? 1 : -1);\n    if (!bal) {\n      string t = s.substr(i, j - i);\n      solve1(t, ans);\n      j = i;\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n}\n\nint main() {\n  precalc();\n#ifdef DEBUG\n  assert(freopen(TASK \".in\", \"r\", stdin));\n  assert(freopen(TASK \".out\", \"w\", stdout));\n#endif\n  while (read()) {\n    solve();\n#ifdef DEBUG\n    eprintf(\"Time %.2f\\n\", (double) clock() / CLOCKS_PER_SEC);\n#endif\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define fi first\n#define se second\n#define pb push_back\n#define SZ(x) ((int)x.size())\n#define L(i,u) for (register int i=head[u]; i; i=nxt[i])\n#define rep(i,a,b) for (register int i=(a); i<=(b); i++)\n#define per(i,a,b) for (register int i=(a); i>=(b); i--)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\ntypedef pair<int,int> Pii;\ntypedef vector<int> Vi;\ninline void read(int &x) {\n\tx=0; char c=getchar(); int f=1;\n\twhile (!isdigit(c)) {if (c=='-') f=-1; c=getchar();}\n\twhile (isdigit(c)) {x=x*10+c-'0'; c=getchar();} x*=f;\n}\ninline ui R() {\n\tstatic ui seed=416;\n\treturn seed^=seed>>5,seed^=seed<<17,seed^=seed>>13;\n}\nconst int N = 6060;\nint n,dy[N];char s[N];vector<string>a;\ninline string geta(int l, int r){\n\tstring a;int lst=l-1;\n\trep(i,l,r)if(s[i]=='a'&&i>lst){\n\t\ta+=\"ab\";lst=dy[i];\n\t}\n\treturn a;\n}\ninline string getb(int l, int r){\n\tstring res;static bool vis[N];\n\trep(t,1,(r-l+1)/2){\n\t\trep(i,l,r)vis[i]=0;\n\t\tfor(int i=r,c=1;i>=l;i--)if(s[i]=='a'&&c<=t){vis[i]=1;c++;}\n\t\tfor(int i=r,c=1;i>=l;i--)if(s[i]=='b'&&c<=t){vis[i]=1;c++;}\n\t\tstring a;rep(i,l,r)if(vis[i])a+=s[i];res=max(res,a);\n\t}\n\treturn res;\n}\nint main() {\n\tread(n);scanf(\"%s\",s+1);n*=2;\n\tVi u,v;rep(i,1,n)if(s[i]=='a')u.pb(i);else v.pb(i);\n\trep(i,0,SZ(u)-1)dy[u[i]]=v[i],dy[v[i]]=u[i];\n\tfor(int i=1,lst=0,now=0;i<=n;i++){\n\t\tnow+=s[i]=='a'?1:-1;if(!now){\n\t\t\t//lst+1..i\n\t\t\tif(s[lst+1]=='a')a.pb(geta(lst+1,i));else a.pb(getb(lst+1,i));\n\t\t\tlst=i;\n\t\t}\n\t}\n\tstring r;per(i,SZ(a)-1,0)r=max(r,a[i]+r);cout<<r;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=105,p=1000000007;\nint read(){\n\tint f=1,g=0;\n\tchar ch=getchar();\n\tfor (;!isdigit(ch);ch=getchar()) if (ch=='-') f=-1;\n\tfor (;isdigit(ch);ch=getchar()) g=g*10+ch-'0';\n\treturn f*g;\n}\nint qpow(int x,int k){\n\tint t=1;\n\tfor (;k;k>>=1){\n\t\tif (k&1) t=(ll)t*x%p;\n\t\tx=(ll)x*x%p;\n\t}\n\treturn t;\n}\nint n,a[N],b[N],cnt,r[N];\nstring s,f[N];\nstring calc(int l,int r){\n\tstring ans=\"\";\n\tif (a[l]<b[l]){\n\t\tint las=a[l]-1;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (las<a[i]){ans+=\"ab\";las=b[i];}\n\t}\n\telse{\n\t\tstring t;\n\t\tfor (int i=l;i<=r;i++){\n\t\t\tt=\"\";\n\t\t\tint j=i,k=i;\n\t\t\twhile ((j<=r)||(k<=r))\n\t\t\tif (a[j]<b[k]){t+='a';j++;}\n\t\t\telse {t+='b';k++;}\n\t\t\tans=max(ans,t);\n\t\t}\n\t}\n\treturn ans;\n}\nint main(){\n\tcin>>n>>s;\n\tfor (int i=0;i<n*2;i++)\n\tif (s[i]=='a') a[++a[0]]=i+1;\n\telse b[++b[0]]=i+1;\n\ta[n+1]=b[n+1]=n*2+1;\n\t\n\tfor (int i=1;i<=n;i++)\n\tif (max(a[i],b[i])==i*2) r[++cnt]=i;\n\tfor (int i=1;i<=cnt;i++) f[i]=calc(r[i-1]+1,r[i]);\n\tfor (int i=cnt-1;i;i--) f[i]=max(f[i+1],f[i]+f[i+1]);\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nP2<string,Vct<int> > f[3005];\nint id[3005];\nstring st;\nint pos[2][3005];\nVct<int>t;\nint cmp(int a,int b)\n{\n\tt.clear();\n\tt=f[b].Se;\n\tt.Pb(a);\n\tt.Pb(id[a]-1);\n\tsort(t.begin(),t.end());\n\tstring st2=\"\";\n\t//cout<<\"!\";\n\tfor(int i=0;i<t.size();i++)\n\t{\n\t\tst2+=st[t[i]];\n\t\t//cout<<t[i]<<\" \";\n\t}\n\t//cout<<st2<<\" \"<<a<<\"-\"<<b<<\" \"<<(bool)(st2>f[a].Fi)<<endl;\n\tif(f[a].Fi<st2)\n\t{\n\t\tf[a].Se=t;\n\t\tf[a].Fi=st2;\n\t}\n\treturn 0;\n}\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tf[i].Fi=\"0\";\n\t\tif(st[i]=='a')pos[0][++pos[0][0]]=i;\n\t\telse pos[1][++pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[0][i]<<\" \"<<pos[1][i]<<endl;\n\t}\n\t*/\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(pos[0][i]<pos[1][i])id[pos[0][i]]=pos[1][i]+1;\n\t\telse id[pos[1][i]]=pos[0][i]+1;\n\t}\n\tstring mx;\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\t//cout<<i<<\" \"<<id[i]<<endl;\n\t\tif(!id[i])continue;\n\t\tf[i].Fi=\"\";\n\t\tf[i].Fi+=st[i];\n\t\tf[i].Fi+=st[id[i]-1];\n\t\tf[i].Se.Pb(i);\n\t\tf[i].Se.Pb(id[i]-1);\n\t\t//cout<<\"!\"<<i<<\" \"<<id[i]-1<<\" \"<<f[i].Fi<<\"!\"<<endl;\n\t\tfor(int j=i+1;j<st.Sz();j++)\n\t\t{\n\t\t\t//cout<<\"!\"<<j<<endl;\n\t\t\t//cout<<i/*<<\" \"<<f[i].Fi*/<<\":\"<<j<<\" \";\n\t\t\tcmp(i,j);\n\t\t\t//cout<<endl;\n\t\t}\n\t\t//cout<<\">\"<<i<<\" \"<<f[i].Fi<<endl;\n\t\tmx=max(mx,f[i].Fi);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for((i)=1;(i)<=(n);(i)++)\nusing namespace std;\nint n,m,i,j,a[3005],b[3005],c1,c2,id[6005],pos[3005];\nstring st,f[3005];\nint main(){\n\tcin>>n>>st;\n\trep(i,n+n){\n\t\tif(st[i-1]=='a'){\n\t\t\ta[++c1]=i;\n\t\t\tid[i]=c1;\n\t\t}\n\t\telse{\n\t\t\tb[++c2]=i;\n\t\t\tid[i]=c2;\n\t\t}\n\t}\n\tst=\" \"+st;\n\tj=0;\n\trep(i,n){\n\t\twhile(j<min(a[i],b[i])){\n\t\t\tpos[++j]=i;\n\t\t}\n\t}\n\ta[n+1]=b[n+1]=n+n+1;\n\tpos[n+n+1]=n+1;\n\tfor(i=n;i;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tf[i]=\"ab\"+f[pos[b[i]+1]];\n\t\t}\n\t\telse{\n\t\t\tint j=b[i];\n\t\t\tf[i]=\"\";\n\t\t\twhile(b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1])){\n\t\t\t\tif(id[j]>=i) f[i]+=st[j];\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tf[i]+=f[id[j]];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n//\t\tcerr<<f[i]<<endl;\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define pb push_back\n\nusing namespace std;\n\nstring max(string a, string b){\n\tint x;\n\tfor (x = 0; x < min(a.length(), b.length()); x ++) if (a[x] != b[x]) return a[x] > b[x] ? a : b;\n\treturn a.length() > b.length() ? a : b;\n}\n\nstring func(string S, string T){\n\tint n = S.length() >> 1, x;\n\tvector <int> A, B;\n\tfor (x = 0; x < n << 1; x ++) {\n\t\tif (S[x] == 'a') A.pb(x);\n\t\tif (S[x] == 'b') B.pb(x);\n\t}\n\tif (S[0] == 'b') {\n\t\tint i, j;\n\t\tstring r = T;\n\t\tfor (x = 0; x < n; x ++) {\n\t\t\tstring u;\n\t\t\ti = j = x;\n\t\t\twhile (i < n && j < n) A[i] < B[j] ? (++i, u += 'a') : (++j, u += 'b');\n\t\t\twhile (i < n) u += 'a', ++i;\n\t\t\twhile (j < n) u += 'b', ++j;\n\t\t\tr = max(r, u + T);\n\t\t}\n\t\treturn r;\n\t} else {\n\t\tint y = 0, c = 0;\n\t\tstring r = T, u = \"\";\n\t\tfor (x = 0; x < n; x ++) if (A[x] >= y) ++c, y = B[x] + 1;\n\t\tfor (x = 0; x < c; x ++) u += \"ab\", r = max(r, u + T);\n\t\treturn r;\n\t}\n}\n\nstring solve(string S){\n\tstring res = \"\";\n\tint x, y = S.length(), z, c = 0;\n\tfor (x = y - 1; x >= 0; x --) {\n\t\tc += S[x] == 'a' ? 1 : -1;\n\t\tif (c == 0) {\n\t\t\tstring T = \"\";\n\t\t\tfor (z = x; z < y; z ++) T += S[z];\n\t\t\tres = func(T, res);\n\t\t\ty = x;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main(){\n\tstring S;\n\tscanf(\"%*d\"), cin >> S;\n\tcout << solve(S) << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << (x) << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\ntemplate<class S,class T> ostream& operator<<(ostream& o,const pair<S,T> &p){return o<<\"(\"<<p.fs<<\",\"<<p.sc<<\")\";}\ntemplate<class T> ostream& operator<<(ostream& o,const vector<T> &vc){o<<\"sz = \"<<vc.size()<<endl<<\"[\";for(const T& v:vc) o<<v<<\",\";o<<\"]\";return o;}\nint N;\nstring s;\nconst int MN = 6010;\nint a[MN],b[MN];\nint id[MN];\nstring dp[MN];\nint main(){\n\tcin>>N>>s;\n\tint A=0,B=0;\n\trep(i,N*2){\n\t\tif(s[i]=='a'){\n\t\t\ta[A] = i;\n\t\t\tid[i] = A;\n\t\t\tA++;\n\t\t}else{\n\t\t\tb[B] = i;\n\t\t\tid[i] = B;\n\t\t\tB++;\n\t\t}\n\t}\n\tstring ans;\n\tfor(int i=N-1;i>=0;i--){\n\t\tvector<bool> sel(N,false);\n\t\tsel[i] = 1;\n\t\tint nxt = N;\n\t\tif(a[i]<b[i]){\n\t\t\tfor(int x=i+1;x<N;x++){\n\t\t\t\tif(a[x]<b[i]){\n\t\t\t\t\tsel[x]=0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnxt = x;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}else{\n\t\t\tfor(int x=i+1;x<N;x++){\n\t\t\t\tif(b[x]<a[x-1]){\n\t\t\t\t\tsel[x]=1;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnxt = x;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstring now;\n\t\trep(j,2*N) if(sel[id[j]]) now += s[j];\n\t\tdp[i] = max(dp[i+1],now+dp[nxt]);\n\t}\n\tcout<<dp[0]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define F first\n#define S second\n#define int long long\n#define ll long long\n//#define int  unsigned long long\n#define pb push_back\n//#define double long double\n\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef  tree< int , null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> ordered_set;\nconst int mod = 1e9 + 7;\nconst int N = 650055;\nconst int K = 700 ;\nint a[N], p1[N], p2[N], d[N];\nvector < pair < int, int > > t;\nmain(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    //freopen(\"input.txt\", \"r\", stdin);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    for (int i = 1; i <= n + n; i++){\n        if (s[i - 1] == 'a') a[i] = -1; else a[i] = 1;\n    }\n    int x = 0;\n    int l = 1;\n    int q = 0;\n    for (int i = 1; i <= n + n; i++){\n        x += a[i];\n        if (x == 0){\n            if (a[l] == 1) q = 1;\n            t.pb({l, i});\n            l = i + 1;\n        }\n    }\n    int c = 0;\n    if (q == 0){\n        string ans = \"\";\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int i = 1; i <= n + n; i++){\n            if (a[i] == -1){\n                cnt1++;\n                cnt2 = 0;\n                for (int j = 1; j <= n + n; j++){\n                    if (a[j] == 1) cnt2++;\n                    if (cnt2 == cnt1){\n                        d[i] = j;\n                        break;\n                    }\n                }\n            }\n        }\n        int c = 1;\n        while (c <= n + n){\n            ans += \"ab\";\n            c = d[c];\n            while(a[c] == 1) c++;\n        }\n        cout << ans;\n        return 0;\n    }\n    vector < string > v;\n    for (auto i: t){\n        if (a[i.F] == -1) continue;\n        string res = \"\";\n        string cur = s.substr(i.F - 1, i.S - i.F + 1);\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a'){\n                cnt2++;\n                p2[j] = p1[cnt2];\n            } else{\n                cnt1++;\n                p1[cnt1] = j;\n            }\n        }\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a') continue;\n            string x = \"\";\n            for (int l = j; l < cur.length(); l++){\n                if (cur[l] == 'b') x += \"b\"; else\n                if (cur[l] == 'a' && p2[l] >= j) x += \"a\";\n            }\n            res = max(res, x);\n        }\n        v.pb(res);\n    }\n    string ans = \"\";\n    for (int j = v.size() - 1; j >= 0; j--){\n        ans = max(ans, v[j] + ans);\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n\n \n \n  bool t=true;int x=0;\n string sx;\n   vector<string> ss;\n  for(int i=2*n-1;i>=0;i--){\n\n    if(x==0){\n      if(s[i]=='a'){\n        t=false;\n        string ns;\n        ss.push_back(ns);\n        ss[ss.size()-1].push_back(s[i]);\n        x++;\n        }\n      else{\n        if(t)sx.push_back(s[i]);\n        x--;\n      } \n   \n      continue;\n    }\n    if(x>0)ss[ss.size()-1].push_back(s[i]);\n    if(x<0&&t)sx.push_back(s[i]);\n      if(s[i]=='a')x++;\n      else x--;\n  }\n     \nreverse(sx.begin(),sx.end());\nfor(int i=0;i<ss.size();i++)reverse(ss[i].begin(),ss[i].end());\n\n  string ans[ss.size()],ans2=sx;\n\n  for(int ii=0;ii<ss.size();ii++){\n    ans[ii]=ss[ii];\n    while(!ss[ii].empty()){\n    int i=0;\n    while(ss[ii][i]=='b')i++;\n    ss[ii].erase(ss[ii].begin()+i);\n    ss[ii].erase(ss[ii].begin());\n    ans[ii]=max(ans[ii],ss[ii]);\n  }\n  }\n  \nstring sxx[sx.size()];\nbool b[sx.size()]={};\nfor(int i=sx.size()-1;i>=0;i--){\n  if(sx[i]=='b'){\n   if(i!=sx.size()-1) sxx[i]=sxx[i+1];\n  \n    continue;\n  }\n  for(int j=sx.size()-1;j>i;j--)if(sx[j]=='b'&&b[j]==false){\n    b[j]=true;\n    sxx[i]=\"ab\"+sxx[j];\n    break;\n  }\n\n  ans2=max(ans2,sxx[i]);\n}\n  \nfor(int i=0;i<ss.size();i++){\n  ans2=max(ans2,ans[i]+ans2);\n}\ncout<<ans2<<endl;\n\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#define N 6006\nchar a[N],x[N];int b[N],i,j,n,o,p,q,t,y;\nint main()\n{\n    scanf(\"%d%s\",&n,a+1);\n    for(*b=i=j=1;j<=n<<1;j++)if(a[j]==97?o++:p++,o==p)\n    if(a[i]==97)\n    {\n        for(o=p=q=y=0;i<=j;i++)if(a[i]==97&&x[++o,y]!=97||a[i]==98&&++p==q&&x[y]!=98)x[++y]=a[i],q=o;\n        memcpy(a+b[t],x+1,y),b[t+1]=b[t]+y,t++;\n    }\n    else\n    {\n        for(y=j-i+1,memcpy(x+1,a+i,y),memset(a+b[t],0,y);y;)\n        {\n            if(strncmp(a+b[t],x+1,y)<0)memcpy(a+b[t],x+1,y),b[t+1]=b[t]+y;\n            for(i=1;x[i]==98;i++);\n            for(y--;i<=y;i++)x[i]=x[i+1];\n            for(i=1;x[i]==97;i++);\n            for(y--;i<=y;i++)x[i]=x[i+1];\n        }\n        i=j+1,t++;\n    }\n    for(i=t,y=0;i--;)x[y+1]=a[b[i+1]]=0,strncmp(x+1,a+b[i],b[i+1]-b[i])<=0?memcpy(a+b[i+1],x+1,y),y+=b[i+1]-b[i],memcpy(x+1,a+b[i],y):0;\n    return 0&(x[y+1]=0,printf(\"%s\\n\",x+1));\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.resize(b.size());\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans, c[i]);\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "//一个奇怪的做法...QwQ\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define qwq(x) cout<<\"# \"<<#x<<\" = \"<<x<<endl;\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef long long ll;\n \ntemplate<class T> inline void read(T &x){\n\tint f=0;x=0;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())f|=(ch=='-');\n\tfor(;isdigit(ch);ch=getchar())x=x*10+ch-'0';\n\tif(f)x=-x;\n}\n\nconst int N=6005;\nint l[N],r[N],id[N],n,cnt,ia,ib;\nstring f[N],g[N];\nchar s[N];\n\nstring calc(int l,int r){\n\tif(s[l]=='a'){\n\t\tstring res;\n\t\tint flag=0;\n\t\trep(i,l,r)\n\t\t\tif(s[i]=='a'){\n\t\t\t\tflag=1;\n\t\t\t}\n\t\t\telse if(s[i]=='b'&&flag){\n\t\t\t\tres+=\"ab\";\n\t\t\t\tflag=0;\n\t\t\t}\n\t\treturn res;\n\t}\n\tstring best,now;\n\trep(i,l,r)\n\t\tif(s[i]=='b'){\n\t\t\tnow=\"\";\n\t\t\trep(j,i,r)\n\t\t\t\tif(id[j]>=id[i])\n\t\t\t\t\tnow+=s[j];\n\t\t\tbest=max(best,now);\n\t\t}\n\treturn best;\n}\n\nint main(){\n\tread(n);\n\tscanf(\"%s\",s+1);\n\tint t=0,las=0;\n\trep(i,1,n*2){\n\t\tif(s[i]=='a'){\n\t\t\tt++;\n\t\t\tid[i]=++ia;\n\t\t}\n\t\telse{\n\t\t\tt--;\n\t\t\tid[i]=++ib;\n\t\t}\n\t\tif(t==0){\n\t\t\tl[++cnt]=las+1;\n\t\t\tr[cnt]=i;\n\t\t\tlas=i;\n\t\t}\n\t}\n\trep(i,1,cnt){\n\t\tg[i]=calc(l[i],r[i]);\n\t}\n\tper(i,cnt,1){\n\t\tf[i]=max(f[i+1],g[i]+f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n,la[N];\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint check2(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn 1;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=1,j=1;i<=n;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj++;\n\t\t}\n\t\tla[j-1]=i-1;\n\t}\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\tj=la[i];\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1,cnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1,cntb++;\n\t\t\t\t\t}\n\t\t\t\tassert(cntb==cnta&&cntb==k);\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check2(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=3e3+5;\nstring dp[maxn<<1];\nchar s[maxn<<1];\nint a[maxn],b[maxn],n,A,B,t[maxn<<1],p,fi[maxn<<1];\nint cnt,group[maxn<<1];\nstring ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=2*n;i++){\n\t\tif (s[i]=='a'){\n\t\t\ta[++A]=i;\n\t\t\tt[i]=A;\n\t\t\tcnt++;\n\t\t}else{\n\t\t\tb[++B]=i;\n\t\t\tt[i]=B;\n\t\t\tcnt--;\n\t\t}\n\t\tgroup[i]=p;\n\t\tif (cnt==0)\n\t\t\tfi[++p]=i+1;\n\t}\n\tfi[++p]=n*2+1;\n\tfor (int i=2*n;i>=1;i--){\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi != i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tstring S;\n\t\t\tfor (int j = i;group[j] == group[i];j++){\n\t\t\t\tif (b[t[j]] >= i)\n\t\t\t\t\tS+=s[j];\n\t\t\t}\n\t\t\tS+=dp[fi[group[i]+1]];\n//\t\t\tcout << group[i] << ' ' << fi[group[i]+1] << '\\n';\n//\t\t\tcout << i << ' ' << S << ' ' << dp[fi[group[i]+1]] << '\\n';\n\t\t\tdp[i]=max(S,dp[fi[group[i]+1]]);\n\t\t}else{\n\t\t\tdp[i]=max(\"ab\"+dp[b[t[i]]+1],dp[b[t[i]]+1]);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout << ans ;\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "// Why I am so dumb? :c\n#include <bits/stdc++.h>\n\n#define pb push_back\n#define mp make_pair\n\n#define all(x) (x).begin(), (x).end()\n\n#define fi first\n#define se second\n\nusing namespace std;\n\ntypedef long long ll;\n\nint a[3005], b[3005];\n\nstring best[3005];\n\nstring dp[3005];\n\nint pref[6005];\n\nint id[6005];\n\nchar s[6005];\n\nint n;\n\nstring calc(int l, int r) {\n    static string ret;\n    ret.clear();\n\n    int cl = id[l];\n    int cr = id[r + 1] - 1;\n\n    if (s[l] == 'a') {\n        int p = -1;\n        \n        for (int i = cl; i <= cr; ++i) {\n            if (a[i] > p) {\n                p = b[i];\n                ret += \"ab\";\n            }\n        }\n    }\n    else {\n        string cur;\n\n        for (int i = cl; i <= cr; ++i) {\n            cur.clear();    \n\n            for (int j = b[i]; j <= r; ++j) {\n                if (id[j] >= i && id[j] <= cr) {\n                    cur += s[j];\n                }\n            }\n\n            ret = max(ret, cur);\n        }\n    }\n\n    return ret;\n}\n\nvoid solve() {                   \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s + 1);\n    id[n * 2 + 1] = n + 1;\n\n    for (int i = 1, szA = 0, szB = 0; i <= n * 2; ++i) {\n        pref[i] = pref[i - 1];\n\n        if (s[i] == 'a') {\n            a[++szA] = i;\n            id[i] = szA;\n            ++pref[i];\n        }    \n        else {\n            b[++szB] = i;\n            id[i] = szB;\n            --pref[i];\n        }\n    }\n\n    vector<pair<int, int>> vv;\n\n    for (int l = 1, r; l <= (n << 1); l = r) {\n        int bal = 0;\n        r = l + 1;\n                  \n        s[l] == 'a' ? ++bal : --bal;\n\n        while (r <= (n << 1) && bal != 0) {\n            s[r] == 'a' ? ++bal : --bal;\n            ++r;\n        }\n\n        vv.pb(mp(l, r - 1));\n    }\n\n    for (int i = 0; i < vv.size(); ++i) {\n        best[i] = calc(vv[i].fi, vv[i].se);\n    }\n\n    for (int i = 0; i < vv.size(); ++i) {\n        dp[i] = best[i];\n\n        for (int j = 0; j < i; ++j) {\n            dp[i] = max(dp[i], dp[j] + best[i]);\n        }\n    }\n\n    cout << dp[vv.size() - 1];\n}\n\nint main() {    \n    int tt = 1;\n\n    while (tt--) {\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fi first\n#define se second\n#define mp make_pair\n#define fastIO ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\nconst int N = 6005;\nint a[N];\nint d[N];\nbool take[N];\n\nvector<int> solve(vector<int> g){ \n  if(g[0] == 0){\n    vector<int> pa, pb;\n    for(int i = 0 ; i < g.size() ; i ++ ){\n      if(g[i] == 0)pa.push_back(i);\n      else pb.push_back(i);\n    }\n    int cur = -1;\n    vector<int> sol;\n    for(int i = 0 ; i < pa.size(); i ++ ){\n      if(pa[i] > cur){\n        sol.push_back(0);\n        sol.push_back(1);\n        cur = pb[i];\n      }\n    }\n    return sol;\n  }\n  else{\n    vector<int> best;\n    vector<int> pa, pb;\n    for(int i = 0 ; i < g.size() ; i ++ ){\n      if(g[i] == 0) pa.push_back(i);\n      else pb.push_back(i);\n    }\n    for(int i = 0 ; i < pb.size(); i ++ ){\n      for(int j = 0 ; j < g.size(); j ++ ){\n        take[j] = false;\n      }\n      for(int j = i ; j < pb.size(); j ++ ){\n        take[pb[j]] = true;\n        take[pa[j]] = true;\n      }\n      vector<int> cur;\n      for(int j = 0 ; j < g.size(); j ++ ){\n        if(take[j])\n          cur.push_back(g[j]);\n      }\n      if(cur > best)\n        best = cur;\n    }\n    return best;\n  }\n}\n\nint main(){\n  fastIO;\n  int n;\n  cin >> n;\n  n *= 2;\n  char f;\n  for(int i = 1; i <= n; i ++ ){\n    cin >> f;\n    a[i] = f - 'a';\n  }\n  for(int i = 1; i <= n; i ++ ){\n    d[i] = d[i - 1] + (a[i] == 0 ? 1 : -1);\n  }\n  vector<string> parts;\n  int b;\n  for(int i = 1; i <= n; i ++ ){\n    if(d[i] == 0){\n      b=i;\n      while(d[b-1] != 0) b--;\n      vector<int> pp;\n      for(int j = b; j <= i ; j ++ ){\n        pp.push_back(a[j]);\n      }\n      vector<int> bes = solve(pp);\n      string go;\n      for(int x : bes){\n        go.push_back((x == 0 ? 'a' : 'b'));\n      }\n      parts.push_back(go);\n    }\n  }\n  string sol;\n  for(int i = (int)parts.size() - 1; i >= 0 ; i -- ){\n    sol = max(sol, parts[i] + sol);\n  }\n  cout << sol << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::cerr; \n\ntemplate <class T>\ninline void relax(T &x, const T &y) {\n\tif (x < y) x = y; \n}\n\nconst int MaxM = 6e3 + 5; \nconst int MaxN = 3e3 + 5; \n\nint n; \nchar s[MaxM]; \nstd::string f[MaxN]; \n\nint idx[MaxM]; \nint a[MaxN], b[MaxN]; \n\nint main() {\n#ifdef orzczk\n\tfreopen(\"subsequence.in\", \"r\", stdin); \n#endif\n\n\tscanf(\"%d%s\", &n, s + 1); \n\tfor (int i = 1, cA = 0, cB = 0; i <= (n << 1); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[idx[i] = ++cA] = i; \n\t\t} else {\n\t\t\tb[idx[i] = ++cB] = i; \n\t\t}\n\t}\n\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint j = i; \n\t\t\twhile (j <= n && a[j] <= b[i])\n\t\t\t\t++j; \n\t\t\tf[i] = \"ab\" + f[j]; \n\t\t} else {\n\t\t\tint border = a[i], maxIdx = i; \n\t\t\tfor (int j = b[i] + 1; j <= border; ++j)\n\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\trelax(border, a[idx[j]]); \n\t\t\t\t}\n\t\t\t\n\t\t\tfor (int j = b[i]; j <= border; ++j)\n\t\t\t\tif (idx[j] >= i) {\n\t\t\t\t\tf[i] += s[j]; \n\t\t\t\t\trelax(maxIdx, idx[j]); \n\t\t\t\t}\n\t\t\t\n\t\t\t// cerr << \": border = \" << border << '\\n'; \n\t\t\tf[i] += f[maxIdx + 1]; \n\t\t}\n\n\t\t// cerr << i << ' ' << f[i] << '\\n'; \n\t\trelax(f[i], f[i + 1]); \n\t}\n\n\tstd::cout << f[1] << '\\n'; \n\n\treturn 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 3005;\n\nint A[N], B[N], n, tA, tB, l[N], r[N], tot;\n\nstring s, dp[N];\n\nvoid solve(int x) {\n  if(A[l[x]] < B[l[x]]) {\n    int L = 0;\n    for(int i = l[x]; i <= r[x]; ++ i) {\n      if(A[i] > L) {\n        dp[x] += \"ab\";\n        L = B[i];\n      }\n    }\n  }\n  else {\n    dp[x] = \"\";\n    vector < pair < int, char> > it;\n    for(int i = r[x]; i >= l[x]; -- i) {\n      string now = \"\";\n      it.clear();\n      for(int j = i; j <= r[x]; ++ j)\n        it.push_back(make_pair(B[j], 'b')),\n          it.push_back(make_pair(A[j], 'a'));\n      sort(it.begin(), it.end());\n      for(int j = 0; j < (int) it.size(); ++ j)\n        now += it[j].second;\n      dp[x] = max(dp[x], now);\n    }\n  }\n}\n\nmain(void) {\n  cin >> n;\n  cin >> s;\n  for(int i = 0; i < n * 2; ++ i) {\n    if(s[i] == 'a') A[++ tA] = i + 1;\n    else B[++ tB] = i + 1;\n  }\n  int L = 1;\n  for(int i = 2; i <= n; ++ i) {\n    if(((A[i] < B[i]) ^ (A[i - 1] < B[i - 1]))) {\n      //[L, i - 1]\n      l[++ tot] = L;\n      r[tot] = i - 1;\n      L = i;\n    }\n  }\n  l[++ tot] = L;\n  r[tot] = n;\n  for(int i = 1; i <= tot; ++ i) solve(i);\n  for(int i = tot - 1; i >= 1; -- i) {\n    dp[i] = max(dp[i] + dp[i + 1], dp[i + 1]);\n  }\n  cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> vs;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      vs.push_back(naive(string(s.begin() + i, s.begin() + last)));\n      i = r - 1;\n    }\n  }\n  vector<int> match(n * 2);\n  queue<int> q;\n  for (int i = last; i < n * 2; ++i)\n    if (s[i] == 'a')\n      q.push(i);\n    else {\n      match[q.front()] = i;\n      q.pop();\n    }\n  for (int i = last; i < n * 2; ++i) {\n    ans += \"ab\";\n    i = match[i];\n  }\n  reverse(vs.begin(), vs.end());\n  for (const auto& str : vs)\n    ans = max(ans, str + ans);\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 3005;\n\nint A[N], B[N], n, tA, tB, l[N], r[N], tot;\n\nstring s, dp[N];\n\nvoid solve(int x) {\n  if(A[l[x]] < B[l[x]]) {\n    int L = 0;\n    for(int i = l[x]; i <= r[x]; ++ i) {\n      if(A[i] > L) {\n        dp[x] += \"ab\";\n        L = B[i];\n      }\n    }\n  }\n  else {\n    // cerr << l[x] <<\" \" << r[x] << endl;\n    dp[x] = \"\";\n    vector < pair < int, char> > it;\n    for(int i = r[x]; i >= l[x]; -- i) {\n      string now = \"\";\n      it.clear();\n      for(int j = i; j <= r[x]; ++ j)\n        it.push_back(make_pair(B[j], 'b')),\n          it.push_back(make_pair(A[j], 'a'));\n      sort(it.begin(), it.end());\n      for(int j = 0; j < (int) it.size(); ++ j)\n        now += it[j].second;\n      dp[x] = max(dp[x], now);\n    }\n  }\n}\n\nmain(void) {\n  cin >> n;\n  cin >> s;\n  for(int i = 0; i < n * 2; ++ i) {\n    if(s[i] == 'a') A[++ tA] = i + 1;\n    else B[++ tB] = i + 1;\n  }\n  int L = 1;\n  for(int i = 2; i <= n; ++ i) {\n    if(((A[i] < B[i]) ^ (A[i - 1] < B[i - 1]))) {\n      //[L, i - 1]\n      l[++ tot] = L;\n      r[tot] = i - 1;\n      L = i;\n    }\n  }\n  l[++ tot] = L;\n  r[tot] = n;\n  for(int i = 1; i <= tot; ++ i) solve(i);\n  for(int i = tot; i >= 1; -- i) {\n    dp[i] = max(dp[i], max(dp[i] + dp[i + 1], dp[i + 1]));\n  }\n  cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define to edge[i].v\n#define mp make_pair\n#define rint register int\n#define debug(x) cout<<#x<<\"=\"<<x<<endl\n#define fgx cout<<\"-------------\"<<endl\n#define N 10000\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\nchar c[N];int a[N],p[2],pos[N][2],b[N],id[N],ban[N];string s[N],f[N];\nint main()\n{\tint n,sum=0,m=0,la=1; cin>>n; n+=n; scanf(\"%s\",c+1);\n\tfor(rint i=1;i<=n;i++)\n\t{\tsum+=(a[i]=(c[i]=='a'))?1:-1; pos[id[i]=++p[a[i]]][a[i]]=i;\n\t\tif(!sum) b[++m]=la,la=i+1;\n\t}\n\tb[++m]=n+1;\n\tfor(rint i=1;i<m;i++)\n\tif(a[b[i]])\n\t{\tfor(rint j=b[i],k=b[i];j<b[i+1];j=k)\n\t\tif(a[k]) for(s[i]+=\"ab\",ban[pos[id[k]][0]]=1;k<b[i+1]&&(a[k]||!ban[k]);k++);\n\t\telse k++;\n\t}\n\telse\n\t{\tint l=id[b[i]],r=id[b[i+1]-1]; set<pair<int,char>> S;\n\t\tfor(rint j=r;j>=l;j--)\n\t\t{\tS.insert(mp(pos[j][0],'b')),S.insert(mp(pos[j][1],'a')); string t=\"\";\n\t\t\tfor(set<pair<int,char>>::iterator it=S.begin();it!=S.end();it++)\n\t\t\tt+=(*it).second; s[i]=max(s[i],t);\n\t\t}\n\t}\n\tfor(rint i=1;i<m;i++)\n\tfor(rint j=0;j<i;j++) f[i]=max(f[i],f[j]+s[i]);\n\tcout<<f[m-1];\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<string.h>\nusing namespace std;\n\ntypedef long long LL;\ntypedef vector<int> VI;\n\n#define REP(i,n) for(int i=0, i##_len=(n); i<i##_len; ++i)\n#define EACH(i,c) for(__typeof((c).begin()) i=(c).begin(),i##_end=(c).end();i!=i##_end;++i)\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate<class T> inline void amin(T &x, const T &y) { if (y<x) x=y; }\ntemplate<class T> inline void amax(T &x, const T &y) { if (x<y) x=y; }\ntemplate<class Iter> void rprintf(const char *fmt, Iter begin, Iter end) {\n    for (bool sp=0; begin!=end; ++begin) { if (sp) putchar(' '); else sp = true; printf(fmt, *begin); }\n    putchar('\\n');\n}\n\nint dp[6011];\nint mem[6011];\nbool act[6011];\nstring solve(const string &s) {\n    int n = s.size();\n\n    if (s[0] == 'a') {\n\tmemset(dp, 0, sizeof (int) * (n+1));\n\n\tfor (int i=0, j=0; i<n && j<n;) {\n\t    while (s[i] != 'a') i++;\n\t    while (s[j] != 'b') j++;\n\t    mem[i] = j;\n\t    i++;\n\t    j++;\n\t}\n\n\tint ma = 0;\n\tREP (i, n) {\n\t    if (s[i] == 'a') {\n\t\tdp[mem[i]] = ma + 1;\n\t    } else {\n\t\tamax(ma, dp[i]);\n\t    }\n\t}\n\n\tstring ret;\n\tREP (i, ma) {\n\t    ret.push_back('a');\n\t    ret.push_back('b');\n\t}\n\treturn ret;\n    }\n\n    for (int i=0, j=0; i<n && j<n;) {\n\twhile (s[i] != 'b') i++;\n\twhile (s[j] != 'a') j++;\n\tmem[i] = j;\n\ti++;\n\tj++;\n    }\n\n    string ret;\n    REP (i, n) if (s[i] == 'b') {\n\tstring tmp;\n\tint ma = mem[i];\n\tmemset(act, 0, sizeof (bool) * (n+1));\n\tfor (int j=i; j<n; j++) {\n\t    if (s[j] == 'b') {\n\t\tif (j < ma) {\n\t\t    tmp.push_back('b');\n\t\t    ma = mem[j];\n\t\t    act[ma] = true;\n\t\t}\n\t    } else {\n\t\tif (act[j]) {\n\t\t    tmp.push_back('a');\n\t\t}\n\t    }\n\t}\n\tamax(ret, tmp);\n    }\n    return ret;\n}\n\nint N, N2;\nchar S[6011];\n\nvoid MAIN() {\n    scanf(\"%d%s\", &N, S);\n    N2 = N+N;\n\n    vector<string> X;\n    int sum = 0;\n    int prv = 0;\n    REP (i, N2) {\n\tif (S[i] == 'a') sum--;\n\telse sum++;\n\tif (sum == 0) {\n\t    X.push_back(solve(string(S+prv, S+i+1)));\n\n\t    prv = i+1;\n\t}\n    }\n\n    string ans;\n    for (int i=X.size(); i--;) {\n\tamax(ans, X[i] + ans);\n    }\n\n    puts(ans.c_str());\n}\n\nint main() {\n    int TC = 1;\n\n    REP (tc, TC) MAIN();\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define N 10000\n#define M 1000005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Min[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Min(int x,int y) {\n\tif(f[x]<N&&f[y]>N) return 0;\n\tif(f[x]>N&&f[y]<N) return 1;\n\tif(f[x]<N) return f[x]>=f[y];\n\tif(f[x]/N>f[y]/N||(f[x]/N==f[y]/N&&check(f[y]%N,R[y],f[x]%N,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\t//cout<<\"-_-\"<<l<<\" \"<<r<<endl;\n\t\tif(s[l]=='a') {\n\t\t\tshu=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='a'&&!shu) ++f[be[l]],shu=1;\n\t\t\t\telse shu=0;\n\t\t} \n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*N+id;\n\t\t}\n\t}\n\t\n\t\n\tMin[be[0]]=be[0];\n\tFOR2(be[0]-1,1,i) {\n\t\tMin[i]=Min[i+1];\n\t\tif(check_Min(i,Min[i])) Min[i]=i;\n\t}\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Min[pos+1];\n\t\tif(f[pos]>N) {\n\t\t\tFOR2(f[pos]/N,1,i) putchar('b');\n\t\t\tfor1(f[pos]%N,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define F(i, a, b) for (int i = a; i <= b; i ++)\n#define G(i, a, b) for (int i = a; i >= b; i --)\n#define out4(x, y, z, w) { if (debug) printf(#x\" = \"),W(x),printf(\" \"#y\" = \"),W(y),printf(\" \"#z\" = \"),W(z),printf(\" \"#w\" = \"),W(w),putc('\\n'); }\n#define out3(x, y, z) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), printf(\" \"#z\" = \"), W(z), putc('\\n'); }\n#define out2(x, y) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), putc('\\n'); }\n#define out1(x) { if (debug) printf(#x\" = \"), W(x), putc('\\n'); }\n#define outline(x) { if (debug) puts(\"-------------------------------------------\"#x\"----------------------------------------\"); }\n#define outarr(a, L, R) { if (debug) { printf(#a\"[%d..%d] = \", L, R); F(i, L, R) W(a[i]), putc(' '); putc('\\n'); } }\n#define Assert(x) { if ((debug) && (!(x))) { puts(\"Wrong Answer\"); exit(0); } }\n#define max(a, b) ((a) > (b) ? (a) : (b))\n#define min(a, b) ((a) < (b) ? (a) : (b))\n#define mem(a, b) memset(a, b, sizeof a)\n#define mec(a, b) memcpy(a, b, sizeof a)\n#define mx(a, b) ((a) = max(a, b))\n#define mn(a, b) ((a) = min(a, b))\n#define lowbit(x) ((x) & (-(x)))\n#define abs(x) ((max(x, - (x))))\n#define get getchar()\n#define pb push_back\n#define putc putchar\n#define inf 2e9\n\ntemplate <typename Int>\nvoid R(Int &x) {\n\tchar c = get; x = 0; Int t = 1;\n\tfor (; !isdigit(c); c = get) t = (c == '-' ? - 1 : t);\n\tfor (; isdigit(c); x = (x << 3) + (x << 1) + c - '0', c = get); x *= t;\n}\ntemplate <typename Int>\nvoid W(Int x) {\n\tif (x < 0) { putc('-'); x = - x ; }\n\tif (x > 9) W(x / 10); putc(x % 10 + '0');\n}\n\n#define debug (0)\n\nusing namespace std;\n\nconst int N = 6e3 + 10;\nint n, L, LEN, c[N], Ans[N], cnt[2], C[N], D[N];;\nstruct node {\n\tint num; vector <int> c;\n\tfriend bool operator < (node a, node b) {\n\t\tint len = min(a.c.size(), b.c.size());\n\t\tF(i, 0, len - 1)\n\t\t\tif (a.c[i] < b.c[i]) return 1; else\n\t\t\tif (a.c[i] > b.c[i]) return 0;\n\t\treturn a.c.size() < b.c.size() || a.c.size() == b.c.size() && a.num > b.num;\n\t}\n\tvoid add(int x) { c.pb(x); }\n} a, b[N / 2];\n\nchar ch[N];\nstruct nobe { int x, l, r; } d[N];\n\nint main() {\n//\tfreopen(\"data.in\",\"r\",stdin);\n\n\tR(n), scanf(\"%s\", ch + 1), n *= 2;\n\tint las = 0, s = 0;\n\tF(i, 1, n) {\n\t\ts += (ch[i] == 'b' ? 1 : (-1));\n\t\tif (s == 0)\n\t\t\td[++ L] = {ch[las + 1] - 'a', las + 1, i}, las = i;\n//\t\tprintf(\"%d \", s);\n\t}\n//\tputc('\\n');\n\n\tint flag = 0, total = 0;\n\tG(i, L, 1) {\n\t\tint l = d[i].l, r = d[i].r;\n\t\tif (d[i].x) {\n\t\t\tout4(d[i].x, d[i].l, d[i].r, i);\n\t\t\tflag = 1, b[++ total].num = i;\n\t\t\tF(k, 1, (r - l + 1) / 2) {\n\t\t\t\tcnt[0] = cnt[1] = 0;\n\t\t\t\tint len = 0;\n\t\t\t\tG(j, r, l)\n\t\t\t\t\tif (++ cnt[ch[j] - 'a'] <= k)\n\t\t\t\t\t\tc[++ len] = ch[j] - 'a';\n\t\t\t\treverse(c + 1, c + len + 1);\n//\t\t\t\toutarr(c, 1, len);\n\t\t\t\ta.c.clear(), a.num = i;\n\t\t\t\tF(j, 1, len) a.add(c[j]);\n\t\t\t\tif (b[total] < a)\n\t\t\t\t\tb[total] = a;\n\t\t\t}\n//\t\t\tprintf(\"%d %d\\n\", b[total].c.size(), b[total].num);\n//\t\t\tF(j, 0, b[total].c.size() - 1)\n//\t\t\t\tprintf(\"%c\", b[total].c[j] + 'a');\n//\t\t\tputc('\\n');\n\t\t}\n\t\telse {\n\t\t\tif (flag) continue;\n\t\t\tint len = 0, bz = 0;\n\t\t\tF(j, l, r) {\n\t\t\t\tif (ch[j] == 'a') {\n\t\t\t\t\tif (!bz)\n\t\t\t\t\t\tC[++ len] = 0, bz = 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (bz)\n\t\t\t\t\t\tC[++ len] = 1, bz = 0;\n\t\t\t\t}\n\t\t\t\toutarr(C, 1, len);\n\t\t\t}\n\t\t\tG(j, len, 1) D[++ LEN] = C[j];\n\t\t}\n\t}\n\n\tsort(b + 1, b + total + 1);\n\n\tout1(b[1].num);\n\tlas = 0;\n\tG(i, total, 1)\n\t\tif (b[i].num > las) {\n\t\t\tF(j, 0, b[i].c.size() - 1)\n\t\t\t\tprintf(\"%c\", b[i].c[j] + 'a');\n\t\t\tlas = b[i].num;\n\t\t}\n\tG(i, LEN, 1) printf(\"%c\", D[i] + 'a');\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int N = 3008;\ntypedef vector<int> vec;\ntypedef vec::iterator it;\n\nchar s[N*2];\nint d[N], c[N], *L[N], *R[N];\n\nint Lyndon(int i) {\n\twhile (d[i]) {\n\t\tint j = i, k = i + 1;\n\t\tfor (; d[k] && d[j] >= d[k]; k++)\n\t\t\tif (d[j] > d[k]) j = i;\n\t\t\telse j++;\n\t\tif (!d[k]) return i;\n\t\tk -= j;\n\t\twhile (i <= j) i += k;\n\t}\n\treturn i;\n}\n\nvoid out(int *l, int *r) {\n\tint *t = c;\n\twhile (l < r) {\n\t\tputchar('b');\n\t\tt[*l++]++;\n\t\twhile (*t) putchar('a'), --*t;\n\t\tt++;\n\t}\n}\n\nint main() {\n\tscanf(\"%*d%s\",s);\n\tint a = 0, b = 0, n = 0;\n\tfor (int i = 0; s[i]; i++) {\n\t\tif (s[i] == 'b') b++;\n\t\telse d[a++] = b;\n\t\tif (a < b) n = b;\n\t}\n\tint l = 0, top = -1;\n\tfor (int i = 0; i < n; i++)\n\t\tif (!(d[i] -= i + 1)) {\n\t\t\tint t = Lyndon(l); l = i + 1;\n\t\t\twhile (~top && lexicographical_compare(L[top], R[top], d+t, d+l)) top--;\n\t\t\tL[++top] = d+t; R[top] = d+l;\n\t\t}\n\t\telse if (d[i] < 0) l = i + 1;\n\tfor (int i = 0; i <= top; i++)\n\t\tout(L[i], R[i]);\n\tfor (int i = n; i < b; i++)\n\t\tif (d[i] >= n) n = i+1, printf(\"ab\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nchar s[6001];\nint a[6000];\nint b[6000];\nint h[6001];\nint m[6001];\nint z[6001];\n\nstring solvea(int l, int r) {\n    int i;\n    string ans = \"\";\n    \n    for (i = l; i < r; ) {\n        if (s[i] == 'a') {\n            ans += \"ab\";\n            i = b[a[i]] + 1;\n        }\n    }\n    \n    return ans;\n}\n\nstring solveb(int l, int r) {\n    int i, j;\n    string ans = \"\";\n    \n    for (i = 0; i < (r - l) / 2; i++) {\n        int c[2] = {};\n        string tmp = \"\";\n        \n        for (j = l; j < r; j++) {\n            if (c[s[j] - 'a']++ >= i) tmp += s[j];\n        }\n        \n        if (tmp > ans) ans = tmp;\n    }\n    \n    return ans;\n}\n\nint main() {\n    int n, ca = 0, cb = 0, i;\n    vector <string> v;\n    string ans = \"\";\n    \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s);\n    \n    for (i = 0; i < n * 2; i++) {\n        if (s[i] == 'a') {\n            a[i] = ca++;\n            h[i + 1] = h[i] - 1;\n        } else {\n            b[cb++] = i;\n            h[i + 1] = h[i] + 1;\n        }\n    }\n    \n    m[n * 2] = z[n * 2] = n * 2;\n    \n    for (i = n * 2 - 1; i >= 0; i--) {\n        m[i] = m[i + 1];\n        z[i] = z[i + 1];\n        if (h[i] >= h[m[i]]) m[i] = i;\n        if (h[i] == 0) z[i] = i;\n    }\n    \n    for (i = 0; i < n * 2; ) {\n        if (s[i] == 'a') {\n            v.push_back(solvea(i, z[i + 1]));\n        } else {\n            v.push_back(solveb(i, z[i + 1]));\n        }\n        \n        i = z[i + 1];\n    }\n    \n    for (i = v.size() - 1; i >= 0; i--) {\n        if (v[i] + ans > ans) ans = v[i] + ans;\n    }\n    \n    printf(\"%s\\n\", ans.c_str());\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nstring calc(string s){\n  //cout<<s<<endl;\n  string res;\n  Int n=s.size();\n  if(s[0]=='a'){\n    res=\"a\";\n    for(Int i=0;i<n;i++)\n      if(res.back()!=s[i]) res+=s[i];\n  }else{\n    for(Int k=0;k<n;k++){\n      Int a=0,b=0;\n      string tmp;\n      for(Int i=0;i<n;i++){\n\tif(s[i]=='a'){\n\t  if(a>=k) tmp+=s[i];\n\t  a++;\n\t}else{\n\t  if(b>=k) tmp+=s[i];\n\t  b++;\n\t}\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nsigned main(){\n  Int n;\n  string s;\n  cin>>n>>s;\n  n*=2;\n  vector<string> v;\n  Int x[2]={1,-1};\n  for(Int i=0;i<n;){\n    Int j=i,k=x[s[j++]-'a'];\n    while(j<n&&k!=0) k+=x[s[j++]-'a'];\n    v.emplace_back(calc(s.substr(i,j-i)));\n    i=j;\n  }\n  reverse(v.begin(),v.end());\n  string ans=\"\";\n  for(string t:v)\n    chmax(ans,t+ans);\n  cout<<ans<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define mk make_pair\n#define sc second\n#define fr first\n#define pb emplace_back\n#define all(s) s.begin(), s.end()\n#define sz(s) ( (int)s.size() )\n#define Scan(a) scanf (\"%I64d\", &a)\n#define scan(a) scanf (\"%d\", &a)\n\nusing namespace std;\n\nconst int inf = (int)1e9 + 7;\nconst int N = (int)2e5 + 7;\n\nint n;\nint u[N];\n\nstring a,res;\n\nvector <int> c,d;\n\nmain () {\n      cin >> n;\n      cin >> a;\n\n      for (int i = 0; i < a.size(); i ++) {\n            if (a[i] == 'a') c.pb(i);\n            else d.pb(i);\n      }\n      for (int i = (int)c.size() - 1; i >= 0; i --) {\n            int id1 = c[i],id2 = d[i];\n            string cur = \"\";\n\n            for (int j = 0; j < n * 2; j ++) {\n                  if (u[j]) cur += a[j];\n                  else if (j == id1 || j == id2) cur += a[j];\n            }\n            if (cur > res) u[id1] = u[id2] = 1,res = cur;\n      }\n      cout << res << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define cs const\n#define pb push_back\nusing namespace std;\ncs int N = 6e3 + 50;\nint n, A[N], B[N], c[N], tr[N]; \nchar S[N]; string f[N];\nint main(){\n\t#ifdef FSYolanda\n\tfreopen(\"1.in\",\"r\",stdin);\n\t#endif\n\tscanf(\"%d%s\",&n,S+1);\n\tfor(int i=1,a=0,b=0; i<=n+n; i++)\n\tif(S[i]=='a') A[c[i]=++a]=i;\n\telse B[c[i]=++b]=i;\n\tfor(int i=1; i<=n; i++) tr[min(A[i],B[i])]=i;\n\tfor(int i=n; i>=1; i--){\n\t\tif(A[i]>B[i]){\n\t\t\tint j=B[i];\n\t\t\twhile(A[c[j]]>B[c[j]]){\n\t\t\t\tif(c[j]>i&&B[c[j]]>A[c[j]-1]) break;\n\t\t\t\tif(c[j]>=i) f[i]+=S[j]; ++j;\n\t\t\t} f[i]+=f[c[j]];\n\t\t} else f[i] = \"ab\" + f[tr[B[i]+1]];\n\t\tf[i] = max(f[i], f[i+1]);\n\t} cout << f[1]; return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef int sign;\ntypedef long long ll;\n#define For(i,a,b) for(register sign i=(sign)(a);i<=(sign)(b);++i)\n#define Fordown(i,a,b) for(register sign i=(sign)(a);i>=(sign)(b);--i)\nconst int N=6e3+5;\ntemplate<typename T>bool cmax(T &a,T b){return (a<b)?a=b,1:0;}\ntemplate<typename T>bool cmin(T &a,T b){return (a>b)?a=b,1:0;}\ntemplate<typename T>T read()\n{\n\tT ans=0,f=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)&&ch!='-')ch=getchar();\n\tif(ch=='-')f=-1,ch=getchar();\n\twhile(isdigit(ch))ans=(ans<<3)+(ans<<1)+(ch-'0'),ch=getchar();\n\treturn ans*f;\n}\ntemplate<typename T>void write(T x,char y)\n{\n\tif(x==0)\n\t{\n\t\tputchar('0'),putchar(y);\n\t\treturn;\n\t}\n\tif(x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tstatic char wr[20];\n\tint top=0;\n\tfor(;x;x/=10)wr[++top]=x%10+'0';\n\twhile(top)putchar(wr[top--]);\n\tputchar(y);\n}\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in\",\"r\",stdin);\n\tfreopen(\"out\",\"w\",stdout);\n#endif\n}\nint n;\nchar s[N];\nvoid input()\n{\n\tn=read<int>();\n\tscanf(\"%s\",s+1);\n}\nvector<string>E;\n#define pb push_back\nint a[N],b[N];\nint sum[N];\nstring get1(int l,int r)\n{\n\tstring res;\n\tint last=0;\n\tFor(i,l,r)if(a[i]>last)res+=\"ab\",last=b[i]+1;\n\treturn res;\n}\nbool vis[N];\nstring get2(int l,int r)\n{\n\tstring res,now;\n\tFor(i,l,r)vis[a[i]]=vis[b[i]]=1;\n\tFor(i,l,r)\n\t{\n\t\tnow.clear();\n\t\tFor(j,1,n*2)if(vis[j])now+=s[j];\n\t\tcmax(res,now);\n\t\tvis[a[i]]=vis[b[i]]=0;\n\t}\n\treturn res;\n}\nvoid work()\n{\n\tFor(i,1,n*2)\n\t{\n\t\tif(s[i]=='a')a[++a[0]]=i,sum[i]++;\n\t\telse b[++b[0]]=i,sum[i]--;\n\t\tsum[i+1]=sum[i];\n\t}\n\tint j;\n\tstring now;\n\tFor(i,1,n)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[j+1]&&a[j+1]<b[j+1];j++);\n\t\t\tnow=get1(i,j);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[j+1]&&a[j+1]>b[j+1];j++);\n\t\t\tnow=get2(i,j);\n\t\t}\n\t\t//cout<<now<<endl;\n\t\tE.pb(now);\n\t\ti=j;\n\t}\n\treverse(E.begin(),E.end());\n\tstring ans;\n\tfor(auto now:E)ans=max(ans,now+ans);\n\tcout<<ans<<endl;\n}\nint main()\n{\n\t\n\tinput();\n\twork();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define REPS(i,x) for(int i=1;i<=(int)(x);i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RREPS(i,x) for(int i=((int)(x));i>0;i--)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) (container).begin(), (container).end()\n#define RALL(container) (container).rbegin(), (container).rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define pb push_back\n#define eb emplace_back\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n#define __builtin_popcount __builtin_popcountll\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\n    os<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\n    os<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const map<S, T> &t) {\n    os<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T> pair<S,T> operator+(const pair<S,T> &s, const pair<S,T> &t){ return pair<S,T>(s.first+t.first, s.second+t.second);}\ntemplate<class S, class T> pair<S,T> operator-(const pair<S,T> &s, const pair<S,T> &t){ return pair<S,T>(s.first-t.first, s.second-t.second);}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n\nint T, n, m;\nstring s;\n\nstring solve(string s) {\n    n = s.size() / 2;\n    vi a, b;\n    REP(i, 2 * n) {\n        if (s[i] == 'a') a.push_back(i);\n        if (s[i] == 'b') b.push_back(i);\n    }\n    a.push_back(2 * n);\n    b.push_back(2 * n);\n    vector<string> dp(n + 1), ma;\n    int lastb = 0;\n    RREP(i, n) {\n        int c = 0, mx = 0;\n        string ans = \"\";\n        if (b[i] < a[i]) {\n            for (int ja = i, jb = i; ja < n || jb < n;) {\n                if (b[jb] < a[ja]) {\n                    jb++;\n                    ans.push_back('b');\n                } else {\n                    ja++;\n                    ans.push_back('a');\n                }\n                if (ja == jb) {\n                    ans += dp[ja];\n                    break;\n                }\n            }\n            lastb = i;\n            dp[i] = max(ans, dp[i + 1]);\n        } else {\n            for (int ja = i; ; ja++) {\n                if (b[i] < a[ja]) {\n                    ans = dp[ja];\n                    break;\n                }\n            }\n            dp[i] = max(\"ab\" + ans, dp[i + 1]);\n        }\n    }\n    return dp[0];\n}\n\nint main(int argc, char *argv[]){\n    ios::sync_with_stdio(false);\n    while(cin >> n >> s){\n        cout << solve(s) << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\n#define REP(i, s) for (int i = 0; i < s; ++i)\n#define ALL(v) (v.begin(), v.end())\n#define COUT(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << endl\n#define EACH(i, s) for (__typeof__((s).begin()) i = (s).begin(); i != (s).end(); ++i)\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, pair<T1,T2> P)\n{ return s << '<' << P.first << \", \" << P.second << '>'; }\ntemplate<class T> ostream& operator << (ostream &s, vector<T> P)\n{ for (int i = 0; i < P.size(); ++i) { if (i > 0) { s << \" \"; } s << P[i]; } return s; }\ntemplate<class T> ostream& operator << (ostream &s, vector<vector<T> > P)\n{ for (int i = 0; i < P.size(); ++i) { s << endl << P[i]; } return s << endl; }\n\n\nint N;\nstring S;\n\nstring subSolve(const string &s) {\n    if (s[0] == 'a') {\n        string res = \"\";\n        int prev_a = -1;\n        int a_num = 0, b_num = 0;\n        bool search_a = true;\n        for (int i = 0; i < s.size(); ++i) {\n            if (s[i] == 'a') {\n                if (search_a) {\n                    res += \"a\";\n                    prev_a = a_num;\n                    search_a = false;\n                }\n                ++a_num;\n            }\n            else {\n                if (!search_a) {\n                    if (b_num == prev_a) {\n                        res += \"b\";\n                        search_a = true;\n                    }\n                }\n                ++b_num;\n            }\n        }\n        return res;\n    }\n    else {\n        string res = \"\";\n        for (int i = 0; i*2 < s.size(); ++i) {\n            string tmp = \"\";\n            int a_num = 0, b_num = 0;\n            for (int j = 0; j < s.size(); ++j) {\n                if (s[j] == 'a') {\n                    if (a_num >= i) tmp += s[j];\n                    ++a_num;\n                }\n                else {\n                    if (b_num >= i) tmp += s[j];\n                    ++b_num;\n                }\n            }\n            res = max(res, tmp);\n        }\n        return res;\n    }\n}\n\nint main() {\n    cin >> N >> S;\n    int iter = 0;\n    vector<string> vec;\n    string tmp = \"\";\n    bool exist = false;\n    for (int i = (int)S.size()-1; i >= 0; --i) {\n        tmp += S[i];\n        if (S[i] == 'a') ++iter;\n        else --iter;\n        if (iter == 0) {\n            reverse(tmp.begin(), tmp.end());\n            if (tmp[0] == 'a' && exist) { tmp = \"\"; continue; }\n            if (tmp[0] == 'b') exist = true;\n            string ma = subSolve(tmp);\n            vec.push_back(ma);\n            tmp = \"\";\n        }\n    }\n\n    //COUT(vec);\n    \n    vector<string> dp; dp.assign(N+1, \"\");\n    for (int i = 0; i < vec.size(); ++i) {\n        dp[i+1] = max(dp[i+1], dp[i]);\n        dp[i+1] = max(dp[i+1], vec[i] +dp[i]);\n    }\n    cout << dp[vec.size()] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool compare(string s1, string s2){\n    int l1 = s1.length();\n    int l2 = s2.length();\n    for(int i=0; i<min(l1,l2); i++){\n        if(s1[i] -'a' > s2[i]-'a')\n            return true;\n        else if(s1[i] -'a' < s2[i] -'a')\n            return false;\n    }\n    if(l1 >= l2)\n        return true;\n    else\n        return false;\n}\n\nstring solve(string s){\n    int l = s.length();\n    int n = l/2;\n    int a[n],b[n];\n    int acount = 0, bcount = 0;\n    for(int i=0; i<l; i++){\n        if(s[i] =='a'){\n            a[acount] = i;\n            acount++;\n        }\n        else{\n            b[bcount] = i;\n            bcount++;\n        }\n    }\n    vector<string> all;\n    for(int i=0; i<n; i++){\n        string t = \"\";\n        for(int j=b[i]; j<a[i]; j++){\n            if(s[j] =='b')\n                t+=\"b\";\n        }\n        t += s.substr(a[i], l - a[i]);\n        all.push_back(t);\n    }\n    string ans = all[0];\n    for(int i=0; i<n; i++){\n        if(!compare(ans,all[i]))\n            ans = all[i];\n    }\n    return ans;\n}\n\n\nint main()\n{\n    int N;\n    string S;\n    cin>>N;\n    cin>>S;\n    vector<pair<int,int> > segments;\n    int partials = 0;\n    int prev = 0;\n    bool check = false;\n    for(int i=0; i<2*N; i++){\n        if(S[i] == 'a')\n            partials++;\n        else\n            partials--;\n        if(partials == 0){\n            if(S[i] == 'a'){\n                segments.push_back(make_pair(prev, i));\n                check = true;\n            }\n            prev = i+1;\n        }\n    }\n\n\n\n    int l = segments.size();\n    vector<string> subanswers;\n    for(int i=0; i<l; i++){\n        subanswers.push_back(solve(S.substr(segments[i].first, segments[i].second - segments[i].first + 1)));\n    }\n\n\n    if(check){\n        string output = \"\";\n        for(int i=0; i<l; i++){\n            bool use = true;\n            string s1 = subanswers[i];\n            for(int j=i; j<l; j++){\n                string s2 = subanswers[j];\n                if(!compare(s1,s2))\n                    use = false;\n\n            }\n            if(use){\n                output += s1;\n            }\n\n\n        }\n        cout<<output;\n        int last = segments[l-1].second;\n        int current = 0;\n        int repeats = 0;\n        for(int i= last +1; i<2*N ; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    current = 1;\n                    repeats += 1;\n                }\n            }\n            else{\n                if(S[i]=='b'){\n                    current = 0;\n                }\n            }\n\n        }\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n    else{\n        int current = 0;\n        int repeats = 0;\n        for(int i=0; i<2*N; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    current = 1;\n                    repeats += 1;\n                }\n            }\n            else{\n                if(S[i]=='b'){\n                    current = 0;\n                }\n            }\n        }\n\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  int N;\n  string s;\n  cin >> N;\n  cin >> s;\n\n  N *= 2;\n\n  vector<int> id(N);\n  {\n    int a = 0, b = 0;\n    for ( int i = 0; i < N; i++ ) {\n      if ( s[i] == 'a' ) id[i] = a++;\n      else id[i] = b++;      \n    }\n  }\n\n  vector<string> vs;\n  {\n    string t = \"\";\n    int sum = 0;  \n    for ( int i = 0; i < N; i++ ) {\n      sum += (s[i] == 'a' ? 1 : -1);\n      t += s[i];\n      if ( sum == 0 ) {\n\tvs.emplace_back(t);\n\tt = \"\";       \t\n      }\n    }\n  }\n\n  vector<string> maxs;\n  for ( string t : vs ) {\n    string u = \"\";    \n    if ( t[0] == 'a' ) {\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) {\n\t  u += \"ab\";\n\t  int j = i;\t  \n\t  i++;\t  \n\t  while ( id[j] != id[i] ) i++;\t  \n\t}\n      }\n      maxs.emplace_back(u);      \n    } else {\n      string ma = \"\";\t\n      for ( int i = 0; i < (int)t.size(); i++ ) {\n\tif ( t[i] == 'a' ) continue;\t\n\tu = \"\";\t\n\tfor ( int j = i; j < (int)t.size(); j++ ) {\n\t  if ( id[i] <= id[j] ) u += t[j];\t  \n\t}\n\tma = max(ma, u);\t\n      }\n      u = ma;\n    }\n    maxs.emplace_back(u);    \n  }\n\n  string ans = \"\";\n  for ( int i = (int)maxs.size()-1; i >= 0; i-- ) {\n    if ( ans <= maxs[i]+ans ) ans = maxs[i]+ans;    \n  }\n\n  cout << ans << endl;\n  \n  return 0;  \n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n    ios_base::sync_with_stdio(0); cin.tie(0);\n    int n; string s;\n    cin >> n >> s;\n    vector<pair<int, int>> vals;\n    vector<string> mx(n + 1);\n    vector<int> go(2 * n);\n    vector<int> label(2 * n);\n    int it1 = 0, it2 = 0;\n    while(it1 != 2 * n && it2 != 2 * n){\n        while(s[it1] != 'a') it1++;\n        while(s[it2] != 'b') it2++;\n        vals.emplace_back(min(it1, it2), max(it1, it2));\n        go[it1] = it2, go[it2] = it1;\n        it1++, it2++;\n    }\n    sort(vals.begin(), vals.end());\n    for(int i = 0; i < n; i++){\n        label[vals[i].first] = i;\n        label[vals[i].second] = i;\n    }\n    for(int loc = n - 1; loc >= 0; loc--){\n        int st = vals[loc].first, ed = vals[loc].second;\n        int last = st;\n        if(s[st] == 'b'){\n            int cut = ed;\n            while(last != cut){\n                cut = max(cut, go[last]);\n                last++;\n            }\n            if(go[last] > last) last--;\n        }\n        else{\n            last = ed;\n        }\n        string fin = \"\";\n        if(s[st] == 'a'){\n            fin = \"ab\";\n        }\n        else{\n            for(int i = st; i <= last; i++){\n                if(s[i] == 'a' && go[i] < st) continue;\n                fin += s[i];\n            }\n        }\n        int nxt = -1;\n        for(int i = last + 1; i < 2 * n; i++){\n            if(go[i] > i){\n                nxt = i;\n                break;\n            }\n        }\n        if(nxt != -1) fin += mx[label[nxt]];\n        mx[loc] = max(mx[loc + 1], fin);\n    }\n    cout << mx[0] << '\\n';\n    return 0;\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<string>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\nchar ch[6060];\nstring str;\nint h[6060];\n\nstring solve(int l, int r){\n\tif(str[l] == 'a'){\n\t\tvector<int> A, B;\n\t\tfor(int i = l; i < r; ++i){\n\t\t\tif(str[i] == 'a') A.push_back(i);\n\t\t\telse B.push_back(i);\n\t\t}\n\t\tint cnt = 0;\n\t\tint prv = -1;\n\t\tfor(int i = 0; i < A.size(); ++i){\n\t\t\tif(A[i] >= prv){\n\t\t\t\tprv = B[i];\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t\tstring s(cnt * 2, 'a');\n\t\tfor(int i = 0; i < s.size(); ++i){\n\t\t\tif(i % 2 == 1) s[i] = 'b';\n\t\t}\n\t\treturn s;\n/*\n\t\tint cnt = 0;\n\t\tint num = 0;\n\t\tbool pending = false;\n\t\tstring ans = \"\";\n\t\tfor(int i = l; i < r; ++i){\n\t\t\tif(str[i] == 'a'){\n\t\t\t\tif(num == 0)\n\t\t\tif(!pending){\n\t\t\t\tpending = true;\n\t\t\t}else{\n\t\t\t\tif(str[i] == 'b'){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tpending = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring s(cnt * 2, 'a');\n\t\tfor(int i = 0; i < s.size(); ++i){\n\t\t\tif(i % 2 == 1) s[i] = 'b';\n\t\t}\n\t\treturn s;*/\n\t}else{\n\t\tint mi = 0;\n\t\tfor(int i = l + 1; i <= r; ++i){\n\t\t\tmi = min(mi, h[i]);\n\t\t}\n\t\tstring s = \"\";\n\t\tfor(int i = l + 1; i <= r; ++i){\n\t\t\tif(h[i] == mi){\n\t\t\t\tstring tmp = str.substr(i, r - i);\n\t\t\t\tif(s == \"\" || s < tmp) s = tmp;\n\t\t\t}\n\t\t}\n\t\tstring ans(-mi, 'b');\n\t\treturn ans + s;\n\t}\n}\n\nstring solve(){\n\th[0] = 0;\n\tfor(int i = 0; i < str.size(); ++i){\n\t\tif(str[i] == 'a') h[i + 1] = h[i] + 1;\n\t\telse h[i + 1] = h[i] - 1;\n\t}\n\tstring ans;\n\tint prv = str.size();\n\tfor(int i = str.size() - 1; i >= 0; --i){\n\t\tif(h[i] == 0){\n\t\t\tstring tmp = solve(i, prv);\n\t\t\tprv = i;\n\t\t\ttmp = tmp + ans;\n\t\t\tif(tmp > ans) ans = tmp;\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint N;\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", ch);\n\tstr = ch;\n\tstring ans = solve();\n\tprintf(\"%s\\n\", ans.c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<string>\n#include<algorithm>\n\nusing namespace std;\n\nchar ch[6060];\nstring str;\nint h[6060];\n\nstring solve(int l, int r){\n\tif(str[l] == 'a'){\n\t\tint cnt = 0;\n\t\tbool pending = false;\n\t\tfor(int i = l; i < r; ++i){\n\t\t\tif(!pending){\n\t\t\t\tpending = true;\n\t\t\t}else{\n\t\t\t\tif(str[i] == 'b'){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tpending = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring s(cnt * 2, 'a');\n\t\tfor(int i = 0; i < s.size(); ++i){\n\t\t\tif(i % 2 == 1) s[i] = 'b';\n\t\t}\n\t\treturn s;\n\t}else{\n\t\tint mi = 0;\n\t\tfor(int i = l + 1; i <= r; ++i){\n\t\t\tmi = min(mi, h[i]);\n\t\t}\n\t\tstring s = \"\";\n\t\tfor(int i = l + 1; i <= r; ++i){\n\t\t\tif(h[i] == mi){\n\t\t\t\tstring tmp = str.substr(i, r - i);\n\t\t\t\tif(s == \"\" || s < tmp) s = tmp;\n\t\t\t}\n\t\t}\n\t\tstring ans(-mi, 'b');\n\t\treturn ans + s;\n\t}\n}\n\nstring solve(){\n\th[0] = 0;\n\tfor(int i = 0; i < str.size(); ++i){\n\t\tif(str[i] == 'a') h[i + 1] = h[i] + 1;\n\t\telse h[i + 1] = h[i] - 1;\n\t}\n\tstring ans;\n\tint prv = str.size();\n\tfor(int i = str.size() - 1; i >= 0; --i){\n\t\tif(h[i] == 0){\n\t\t\tstring tmp = solve(i, prv);\n\t\t\tprv = i;\n\t\t\ttmp = tmp + ans;\n\t\t\tif(tmp > ans) ans = tmp;\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint N;\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", ch);\n\tstr = ch;\n\tstring ans = solve();\n\tprintf(\"%s\\n\", ans.c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <limits>\n#include <ctime>\n#include <cassert>\n#include <map>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <iterator>\n#include <bitset>\n#include <unordered_map>\n#include <unordered_set>\n\nusing namespace std;\n#define FOR(i,n) for(int i = 0; i < (n); i++)\n#define sz(c) ((int)c.size())\n#define ten(n) ((int)1e##n)\nusing ll = long long;\nusing Pii = pair<int, int>;\nusing Pll = pair<ll, ll>;\n\ntemplate<typename ...> static inline int getchar_unlocked(void) { return getchar(); }\ntemplate<typename ...> static inline void putchar_unlocked(int c) { putchar(c); }\n#define mygc(c) (c)=getchar_unlocked()\n#define mypc(c) putchar_unlocked(c)\nvoid reader(int& x) { int k, m = 0; x = 0; for (;;) { mygc(k); if (k == '-') { m = 1; break; }if ('0' <= k&&k <= '9') { x = k - '0'; break; } }for (;;) { mygc(k); if (k<'0' || k>'9')break; x = x * 10 + k - '0'; }if (m) x = -x; }\nvoid reader(ll& x) { int k, m = 0; x = 0; for (;;) { mygc(k); if (k == '-') { m = 1; break; }if ('0' <= k&&k <= '9') { x = k - '0'; break; } }for (;;) { mygc(k); if (k<'0' || k>'9')break; x = x * 10 + k - '0'; }if (m) x = -x; }\nint reader(char c[]) { int i, s = 0; for (;;) { mygc(i); if (i != ' '&&i != '\\n'&&i != '\\r'&&i != '\\t'&&i != EOF) break; }c[s++] = i; for (;;) { mygc(i); if (i == ' ' || i == '\\n' || i == '\\r' || i == '\\t' || i == EOF) break; c[s++] = i; }c[s] = '\\0'; return s; }\nint reader(string& c) { int i; for (;;) { mygc(i); if (i != ' '&&i != '\\n'&&i != '\\r'&&i != '\\t'&&i != EOF) break; }c.push_back(i); for (;;) { mygc(i); if (i == ' ' || i == '\\n' || i == '\\r' || i == '\\t' || i == EOF) break; c.push_back(i); }; return sz(c); }\ntemplate <class T, class S> void reader(T& x, S& y) { reader(x); reader(y); }\ntemplate <class T, class S, class U> void reader(T& x, S& y, U& z) { reader(x); reader(y); reader(z); }\ntemplate <class T, class S, class U, class V> void reader(T& x, S& y, U& z, V & w) { reader(x); reader(y); reader(z); reader(w); }\nvoid writer(int x, char c) { int s = 0, m = 0; char f[10]; if (x<0)m = 1, x = -x; while (x)f[s++] = x % 10, x /= 10; if (!s)f[s++] = 0; if (m)mypc('-'); while (s--)mypc(f[s] + '0'); mypc(c); }\nvoid writer(ll x, char c) { int s = 0, m = 0; char f[20]; if (x<0)m = 1, x = -x; while (x)f[s++] = x % 10, x /= 10; if (!s)f[s++] = 0; if (m)mypc('-'); while (s--)mypc(f[s] + '0'); mypc(c); }\nvoid writer(const char c[]) { int i; for (i = 0; c[i] != '\\0'; i++)mypc(c[i]); }\nvoid writer(const string& x, char c) { int i; for (i = 0; x[i] != '\\0'; i++)mypc(x[i]); mypc(c); }\nvoid writer(const char x[], char c) { int i; for (i = 0; x[i] != '\\0'; i++)mypc(x[i]); mypc(c); }\ntemplate<class T> void writerLn(T x) { writer(x, '\\n'); }\ntemplate<class T, class S> void writerLn(T x, S y) { writer(x, ' '); writer(y, '\\n'); }\ntemplate<class T, class S, class U> void writerLn(T x, S y, U z) { writer(x, ' '); writer(y, ' '); writer(z, '\\n'); }\ntemplate<class T, class S, class U, class V> void writerLn(T x, S y, U z, V v) { writer(x, ' '); writer(y, ' '); writer(z, ' '); writer(v, '\\n'); }\ntemplate<class T> void writerArr(T x[], int n) { if (!n) { mypc('\\n'); return; }FOR(i, n - 1)writer(x[i], ' '); writer(x[n - 1], '\\n'); }\ntemplate<class T> void writerArr(vector<T>& x) { writerArr(x.data(), (int)x.size()); }\n\ntemplate<class T> void chmin(T& a, const T& b) { if (a > b) a = b; }\ntemplate<class T> void chmax(T& a, const T& b) { if (a < b) a = b; }\n\ntemplate<class T> T gcd(T a, T b) { return b ? gcd(b, a % b) : a; }\ntemplate<class T> T lcm(T a, T b) { return a / gcd(a, b) * b; }\nll mod_pow(ll a, ll n, ll mod) {\n\tll ret = 1;\n\tll p = a % mod;\n\twhile (n) {\n\t\tif (n & 1) ret = ret * p % mod;\n\t\tp = p * p % mod;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\ntemplate<class T> T extgcd(T a, T b, T& x, T& y) { for (T u = y = 1, v = x = 0; a;) { T q = b / a; swap(x -= q * u, u); swap(y -= q * v, v); swap(b -= q * a, a); } return b; }\nll mod_inv(ll a, ll m) { ll x, y; extgcd<ll>(a, m, x, y); return (m + x % m) % m; }\n\nvector<int> fidx(string s) {\n\tconst int n = sz(s);\n\tvector<int> idx;\n\tint ac = 0, bc = 0;\n\tFOR(i, n) {\n\t\tif (s[i] == 'a') {\n\t\t\tidx.push_back(ac++);\n\t\t} else {\n\t\t\tidx.push_back(bc++);\n\t\t}\n\t}\n\n\treturn idx;\n}\n\nstring naive(string s) {\n\tstring ret;\n\tconst int n = sz(s);\n\tvector<int> idx = fidx(s);\n\n\tstring ans;\n\tint binary = -1;\n\tFOR(F, (1 << (n - 1))) {\n\t\tstring cur;\n\t\tFOR(i, n) {\n\t\t\tif ((1 << idx[i]) & F) {\n\t\t\t\tcur.push_back(s[i]);\n\t\t\t}\n\t\t}\n\t\tif (ans < cur) {\n\t\t\tbinary = F;\n\t\t\tans = cur;\n\t\t}\n\t}\n\tstring c = bitset<20>(binary).to_string();\n\tcout << c << endl;\n\n\treturn ans;\n\n}\n\n\nstring solvePlus(string s) {\n\tvector<int> idx = fidx(s);\n\tstring ret = \"ba\";\n\tFOR(i, sz(s) / 2) {\n\t\tstring cur;\n\t\tFOR(j, sz(s)) {\n\t\t\tif (idx[j] >= i)  cur.push_back(s[j]);\n\t\t}\n\t\tif (ret < cur) {\n\t\t\tret = cur;\n\t\t}\n\t}\n\n\treturn ret;\n}\n\nstring solveMinus(string s) {\n\tvector<int> idx = fidx(s);\n\tstring ret;\n\tFOR(i, sz(s)) {\n\t\tif (s[i] != 'a') {\n\t\t\tcout << \"?\";\n\t\t\texit(-1);\n\t\t}\n\t\tret.push_back(s[i]);\n\t\tint cidx = idx[i];\n\t\ti++;\n\t\twhile (idx[i] != cidx) i++;\n\t\tret.push_back(s[i]);\n\t}\n\n\treturn ret;\n}\n\nstring solve(string s) {\n\tvector<string> vs;\n\tint cnt = 0;\n\tFOR(i, sz(s)) {\n\t\tif (cnt == 0) {\n\t\t\tvs.emplace_back();\n\t\t}\n\t\tif (s[i] == 'a') {\n\t\t\tcnt--;\n\t\t}\n\t\tif (s[i] == 'b') {\n\t\t\tcnt++;\n\t\t}\n\t\tvs.back().push_back(s[i]);\n\t}\n\n\tvector<string> vs2;\n\tFOR(i, sz(vs)) {\n\t\tbool strong = vs[i][0] == 'b';\n\t\twhile (sz(vs2) && vs2.back()[0] == 'a' && strong) {\n\t\t\tvs2.pop_back();\n\t\t}\n\t\tvs2.push_back(vs[i]);\n\t}\n\n\tstring ans;\n\tfor (auto s : vs2) {\n\t\tstring cur;\n\t\tif (s[0] == 'a') {\n\t\t\tcur = solveMinus(s);\n\t\t} else {\n\t\t\tcur = solvePlus(s);\n\t\t}\n\t\tif (ans < cur) {\n\t\t\tans = cur;\n\t\t} else {\n\t\t\tans += cur;\n\t\t}\n\t}\n\n\treturn ans;\n}\n\nvoid test() {\n\n}\n\nint main() {\n\tint n; reader(n);\n\tstring s; reader(s);\n\n\tcout << solve(s) << endl;\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr long  double EPS = 1e-8;\n\n//int N, M, K, H, W, L, R;\nlong long int N, M, K, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tcin >> N;\n\tstring s;\n\tcin >> s;\n\tvector<int>sum(N*2);\n\tfor (int i = 0; i < N * 2; i++) {\n\t\tif (s[i] == 'a')sum[i]++;\n\t\telse sum[i]--;\n\t\tif (i)sum[i] += sum[i - 1];\n\t}\n\tvector<string>st;\n\tint bef = 0;\n\tfor (int i = 0; i < N*2; i++) {\n\t\tstring nx;\n\t\tif (sum[i] == 0) {\n\t\t\tif (s[bef] == 'a') {\n\t\t\t\tnx.push_back('a');\n\t\t\t\tfor (int j = bef+1; j <= i; j++) {\n\t\t\t\t\tif (nx.back() != s[j])nx.push_back(s[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tint num = i - bef + 1;\n\t\t\t\tnum >>= 1;\n\t\t\t\tfor (int j = 0; j < num; j++) {\n\t\t\t\t\tint a = j, b = j;\n\t\t\t\t\tstring box;\n\t\t\t\t\tfor (int k = bef; k <= i; k++) {\n\t\t\t\t\t\tif (s[k] == 'a') {\n\t\t\t\t\t\t\tif (a)a--;\n\t\t\t\t\t\t\telse box.push_back('a');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (b)b--;\n\t\t\t\t\t\t\telse box.push_back('b');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnx = max(nx, box);\n\t\t\t\t}\n\t\t\t}\n\t\t\tst.push_back(nx);\n\t\t\tbef = i + 1;\n\t\t}\n\t}\n\tstring ans;\n\treverse(st.begin(), st.end());\n\tfor (auto i : st) {\n\t\tans = max(ans, i + ans);\n\t}\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/detail/standard_policies.hpp>\nusing ll = int64_t;\nusing ld = double;\nusing ull = uint64_t;\nusing namespace std;\nusing namespace __gnu_pbds;     \n\nconst int MAXN = 6228;\nint l[MAXN];\nint r[MAXN];\nint la[MAXN];\nint ra[MAXN];\nstring f[MAXN];\nint n;\n\nvoid pt(int x) {\n    int cur = 0;\n    while (r[cur] < x) {\n        ++cur;\n    }\n\n    while (cur < n) {\n        cout << \"ab\";\n        int cb = l[cur];\n        while (r[cur] < cb) {\n            ++cur;\n        }\n    }\n\n    cout << \"\\n\";\n    exit(0);\n}\n\nint main() {\n#ifdef BZ\n    freopen(\"input.txt\", \"r\", stdin); freopen(\"output.txt\", \"w\", stdout);\n#endif\n    ios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr); cout.setf(ios::fixed); cout.precision(20);\n\n    string s;\n    cin >> n >> s;\n    int lc = 0, rc = 0;\n\n    for (int i = 0; i < s.length(); ++i) {\n        if (s[i] == 'b') {\n            l[lc++] = i;\n        } else {\n            r[rc++] = i;\n        }\n    }\n\n    int ac = 0;\n\n    for (int i = 0; i < n; ++i) {\n        if (l[i] < r[i]) {\n            la[ac] = l[i];\n            ra[ac] = r[i];\n            ++ac;\n        }\n    }\n\n    la[ac] = ra[ac] = MAXN;\n\n    if (!ac) {\n        pt(0);\n    }\n\n\n    f[ac] = \"\";\n    for (int i = ac - 1; i >= 0; --i) {\n        int lp = i, rp = i;\n        string cur;\n        do {\n            if (la[lp] < ra[rp]) {\n                cur += 'b';\n                ++lp;\n            } else {\n                cur += 'a';\n                ++rp;\n            }\n        } while (lp != rp);\n\n        cur += f[lp];\n        f[i] = max(f[i + 1], cur);\n    }\n\n    cout << f[0];\n    pt(ra[ac - 1] + 1);\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <math.h>\n#include <string.h>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <set>\n#include <list>\n#include <bitset>\n\nusing namespace std;\n\n#define fi first\n#define se second\n#define long long long\ntypedef pair<int,int> ii;\ntypedef pair<int,ii> iii;\n\nstring dp[5003];\nvector<string> vec, opt;\n\nint main()\n{\n\tios_base::sync_with_stdio(); cin.tie(0); cout.tie(0);\n\t// freopen(\"input.in\", \"r\", stdin);\n\t\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tint cnt1 = 0, cnt2 = 0;\n\tstring temp = \"\";\n\tfor(int i = 0; i < s.size(); i++)\n\t{\n\t\ttemp += s[i];\n\t\tcnt1 += (s[i] == 'a');\n\t\tcnt2 += (s[i] == 'b');\n\t\tif(cnt1 == cnt2)\n\t\t{\n\t\t\tvec.push_back(temp);\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\ttemp = \"\";\n\t\t}\n\t}\n\tfor(string t : vec)\n\t{\n\t\t// cout << \"T : \" << t << \"\\n\"; fflush(stdout);\n\t\tstring temp = \"\";\n\t\tif(t[0] == 'a')\n\t\t{\n\t\t\ttemp += 'a';\n\t\t\tfor(int i = 1; i < t.size(); i++)\n\t\t\t{\n\t\t\t\tif(temp.back() != t[i])\n\t\t\t\t\ttemp += t[i];\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttemp = \"\";\n\t\t\tstring now = \"\";\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\tfor(int i = t.size()-1; i >= 0; i--)\n\t\t\t{\n\t\t\t\tnow += t[i];\n\t\t\t\tcnt1 += (t[i] == 'a');\n\t\t\t\tcnt2 += (t[i] == 'b');\n\t\t\t\tstring temp2 = now;\n\t\t\t\tint cnt3 = cnt2;\n\t\t\t\tint j = i;\n\t\t\t\twhile(cnt3 != cnt1)\n\t\t\t\t{\n\t\t\t\t\tj--;\n\t\t\t\t\tif(t[j] == 'a') continue;\n\t\t\t\t\ttemp2 += 'b';\n\t\t\t\t\tcnt3++;\n\t\t\t\t}\n\t\t\t\treverse(temp2.begin(), temp2.end());\n\t\t\t\ttemp = max(temp,temp2);\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t}\n\tstring ans = \"\";\n\tfor(int i = 0; i < opt.size(); i++)\n\t{\n\t\tdp[i] = opt[i];\n\t\tans = max(dp[i], ans);\n\t\tfor(int j = 0; j < i; j++)\n\t\t{\n\t\t\tdp[i] = max(dp[i], dp[j]+opt[i]);\n\t\t\tans = max(dp[i], ans);\n\t\t}\n\t}\n\tcout << ans << \"\\n\";\n}\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#define PB push_back\n#define MP make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long LL;\nconst int N=6000 +10;\n\nstring f[N];\nchar s[N];\nint  tk[N], od[N], a[N], b[N],n;\nvoid DP1();\nvoid DP2();\n\nint main(){\n\tscanf(\"%d%s\", &n, s);\n\tint an=0, bn= 0;\n\tfor (int i=0; i<2*n; ++i)\n\t\tif ( s[i]=='a' ){\n\t\t\tod[i] = an;a[an++] = i;\n\t\t}else{\n\t\t\tod[i] = bn;b[bn++] = i;\n\t\t}\n\t#ifdef che\n\tfor (int i=0; i<2*n; ++i) debug(\"od[%d] = %d\\n\", i, od[i]);\n\tfor (int i=0; i<n; ++i) debug(\"a[%d]= %d\\tb[%d]=%d\\n\", i, a[i], i, b[i]);\n\t#endif\n\tbool flag= false;\n\tfor (int i=0; i<n ; ++i)\n\t\tif ( b[i] < a[i]) flag= true;\n\tif ( !flag) DP1();\n\t\telse DP2();\n\treturn 0;\n}\n\nvoid DP1(){\n\tfor  (int i=0; i<2*n; ++i )  f[i]=\"\";\n\tfor (int i=2*n-2; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='a')\n\t\t\tf[i]= max( \"ab\"+f[b[od[i]]+1],f[i]);\n\t}\n\tcout<<f[0]<<endl;\n}\nvoid DP2(){\n\tfor (int i=2*n-2; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='b'){\n\t\t\tstring t=\"\";\n\t\t\tfor (int j=0; j<=n; ++j) tk[j] = false;\n\t\t\tint ri=  a[od[i]];\n\t\t\tfor (int j=i;j<=ri; ++j){\n\t\t\t\tif ( s[j]=='b') tk[ od[j]]= true, ri= a[od[j]];\n\t\t\t\tif ( tk[od[j]]) t+=s[j];\n\t\t\t}\n\t\t\tif ( t.size()) f[i] = max(f[i], t+f[ri+1]);\n\t\t}\n\t}\n\tcout<<f[0]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define MN 3000\nusing namespace std;\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n    return x*f;\n}\nchar s[MN*2+5];\nint n,posb[MN+5],posa[MN+5],anum,bnum,match[MN*2+5],no[MN+5];\nstring f[MN*2+5];\nstring Max(string a,string b)\n{\n    int n=a.length(),m=b.length();\n    for(int j=0;j<min(n,m);++j)\n    {\n        if(a[j]<b[j]) return b;\n        if(a[j]>b[j]) return a;\n    }\n    return n<=m?b:a;\n}\nint main()\n{   \n    n=read();scanf(\"%s\",s+1);\n    for(int i=1;i<=n<<1;++i)\n        if(s[i]=='a') posa[++anum]=i;\n        else posb[++bnum]=i;\n    for(int i=1;i<=n;++i) match[posa[i]]=posb[i],match[posb[i]]=posa[i],no[posb[i]]=no[posa[i]]=i;\n    for(int i=n<<1;i;--i)\n        if(match[i]<i) f[i]=f[i+1];\n        else if(s[i]=='a') f[i]=Max(f[i+1],string(\"ab\")+f[match[i]+1]);\n        else\n        {\n            int j=no[i],k=no[i];\n            while(k<n&&posb[k+1]<posa[k]) ++k;\n            for(int l=i;l<=posa[k];++l)\n                if(no[l]>=j&&no[l]<=k) f[i]+=s[l];\n            f[i]=Max(f[i]+f[posa[k]+1],f[i+1]);\n            //cout<<i<<\" \"<<j<<\" \"<<k<<\" \"<<f[i]<<endl;\n        }\n    cout<<f[1];\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw){\n            continue;\n        }\n        if (ppp[i].first[0] == 'a'){\n            for (int j=i; j < ppp.size(); j++){\n                if (ppp[j].second > nw) ans += ppp[j].first;\n            }\n            break;\n        }\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (true || pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first,pos[b].second)){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = max(pos[b].second,pos[b].first);\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (min(pos[j].first, pos[j].second) > maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/********************************************************************************\n\t\n\tCode by a weak man who named CYJian, and he hopes the code can get more points.\n\n\tAlgorithm: \n\n ********************************************************************************/\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n//{{{ FAST IO AND SOME FUNCTIONS\nconst int __SIZE = 1 << 18;\nchar ibuf[__SIZE], *iS, *iT;\n\n#define ge (iS == iT ? (iT = (iS = ibuf) + fread(ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS++)) : *iS++)\n#define ri read_int()\n#define rl read_ll()\n#define ra read_alpha()\n#define FILE(s) freopen(s\"in\", \"r\", stdin), freopen(s\"out\", \"w\", stdout), freopen(s\"log\", \"w\", stderr)\n\ntemplate<typename T>\ninline void read(T &x) {\n\tchar ch, t = 0; x = 0;\n\twhile(!isdigit(ch = ge)) t |= ch == '-';\n\twhile(isdigit(ch)) x = x * 10 + (ch ^ 48), ch = ge;\n\tx = t ? -x : x;\n}\ninline int read_int() { int x; return read(x), x; }\ninline ll read_ll() { ll x; return read(x), x; }\ninline char read_alpha() { char ch = ge; while(!isalpha(ch)) ch = ge; return ch; }\n\ntemplate<typename T> inline void chkmin(T&a, T b) { a = a < b ? a : b; }\ntemplate<typename T> inline void chkmax(T&a, T b) { a = a > b ? a : b; }\n//}}}\n\nconst int MAXN = 6010;\n\nbool s[MAXN];\nint p[MAXN];\nint N;\n\nbool t[MAXN];\nint L[MAXN];\nint R[MAXN];\nint pos;\n\ninline void Solve0(int x) {\n\tint l = p[x - 1] + 1, r = p[x];\n\tint now = 0, ct = 0;\n\tfor(int i = l; i <= r; i++)\n\t\tif(s[i] == now) now ^= 1, ++ct;\n\tL[x] = pos + 1, ct >>= 1;\n\tfor(int i = 1; i <= ct; i++)\n\t\tt[++pos] = 0, t[++pos] = 1;\n\tR[x] = pos;\n}\n\nbool S[MAXN]; int ls;\nbool T[MAXN]; int lt;\n\ninline bool cmp() {\n\tint len = min(ls, lt);\n\tfor(int i = 1; i <= len; i++)\n\t\tif(S[i] != T[i]) {\n\t\t\tif(S[i] > T[i]) return 0;\n\t\t\tif(S[i] < T[i]) {\n\t\t\t\tls = lt;\n\t\t\t\tfor(int i = 1; i <= lt; i++)\n\t\t\t\t\tS[i] = T[i];\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\tif(ls > lt) return 0;\n\tls = lt;\n\tfor(int i = 1; i <= lt; i++)\n\t\tS[i] = T[i];\n\treturn 1;\n}\n\ninline void Solve1(int x) {\n\tls = 0;\n\tint l = p[x - 1] + 1, r = p[x];\n\tint N = (r - l + 1) >> 1;\n\tfor(int i = 1; i <= N; i++) {\n\t\tint c[2] = {0, 0}, p = i << 1;\n\t\tfor(int j = r; j >= l; j--)\n\t\t\tif(c[s[j]] < i)\n\t\t\t\tc[s[j]]++, T[p--] = s[j];\n\t\tlt = i << 1, cmp();\n\t}\n\tL[x] = pos + 1;\n\tfor(int i = 1; i <= ls; i++)\n\t\tt[++pos] = S[i];\n\tR[x] = pos;\n}\n\nint endp[MAXN], cep;\nint nowp[MAXN], cnp;\nint tr[36000000][2];\nint tot;\n\ninline void Insert(int x, int l, int r) {\n\tfor(int i = l; i <= r; i++) {\n\t\tif(!tr[x][t[i]])\n\t\t\ttr[x][t[i]] = ++tot;\n\t\tx = tr[x][t[i]];\n\t} nowp[++cnp] = x;\n}\n\ninline int find(int x) {\n\tif(!tr[x][0] && !tr[x][1]) return x;\n\treturn tr[x][1] ? find(tr[x][1]) : find(tr[x][0]);\n}\n\ninline void print(int x) {\n\tif(tr[x][1]) return putchar('b'), print(tr[x][1]);\n\tif(tr[x][0]) return putchar('a'), print(tr[x][0]);\n}\n\nint main() {\n#ifdef LOCAL\n\tFILE(\"\");\n#endif\n\n\tint n = ri << 1;\n\tfor(int i = 1; i <= n; i++) s[i] = ra - 'a';\n\tint sum = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tsum += s[i];\n\t\tif(i == (sum << 1)) p[++N] = i;\n\t}\n\n\tfor(int i = 1; i <= N; i++)\n\t\ts[p[i - 1] + 1] ? Solve1(i) : Solve0(i);\n\n\tendp[++cep] = 0;\n\tfor(int i = 1; i <= N; i++) {\n\t\tfor(int j = 1; j <= cep; j++)\n\t\t\tInsert(endp[j], L[i], R[i]);\n\t\tendp[++cep] = find(0), cnp = 0;\n\t} print(0), puts(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#pragma GCC optimize (\"O2,unroll-loops\")\n//#pragma GCC optimize(\"no-stack-protector,fast-math\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<pii, int> piii;\ntypedef pair<ll, ll> pll;\n#define debug(x) cerr<<#x<<'='<<(x)<<endl;\n#define debugp(x) cerr<<#x<<\"= {\"<<(x.first)<<\", \"<<(x.second)<<\"}\"<<endl;\n#define debug2(x, y) cerr<<\"{\"<<#x<<\", \"<<#y<<\"} = {\"<<(x)<<\", \"<<(y)<<\"}\"<<endl;\n#define debugv(v) {cerr<<#v<<\" : \";for (auto x:v) cerr<<x<<' ';cerr<<endl;}\n#define all(x) x.begin(), x.end()\n#define pb push_back\n#define kill(x) return cout<<x<<'\\n', 0;\n\nconst ld eps=1e-7;\nconst int inf=1000000010;\nconst ll INF=10000000000000010LL;\nconst int mod=1000000007;\nconst int MAXN=6010, LOG=20;\n\nint n, m, k, u, v, x, y, t, a, b, sum;\nint A[2][MAXN];\nbool mark[MAXN];\nstring ans, S, T;\n\nstring Solve(string T){\n\tstring res;\n\tint a=0, b=0;\n\tfor (int i=T.size()-1; ~i; i--){\n\t\tif (T[i]=='a') A[0][a++]=i;\n\t\tif (T[i]=='b') A[1][b++]=i;\n\t\tmark[i]=0;\n\t}\n\tif (T[0]=='a'){\n\t\tint last=-1;\n\t\tfor (int i=a-1; ~i; i--) if (last<A[0][i]){\n\t\t\tres+=\"ab\";\n\t\t\tlast=A[1][i];\n\t\t}\n\t\treturn res;\n\t}\n\tfor (int i=0; 2*i<T.size(); i++){\n\t\tmark[A[0][i]]=mark[A[1][i]]=1;\n\t\tstring s;\n\t\tfor (int j=0; j<T.size(); j++) if (mark[j]) s+=T[j];\n\t\tres=max(res, s);\n\t}\n\treturn res;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\t//freopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\tcin>>n>>S;\n\tfor (int i=2*n-1; ~i; i--){\n\t\tif (S[i]=='a') sum++;\n\t\telse sum--;\n\t\tT=S[i]+T;\n\t\tif (sum==0){\n\t\t\tT=Solve(T);\n\t\t\tans=max(ans, T+ans);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\tcout<<ans<<\"\\n\";\n\t\n\treturn 0;\n}\n/*\n5\naaabababbb\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\nchar str[6010];\nstring ans[3010];\nint occur_a[3010], occur_b[3010], pos[3010];\n\nint main() {\n\tscanf(\"%d%s\", &n, str + 1);\n\tint top_a = 0, top_b = 0;\n\tfor (int i = 1; i <= n * 2; ++i) {\n\t\tif (str[i] == 'a') {\n\t\t\toccur_a[++top_a] = i;\n\t\t\tpos[i] = top_a;\n\t\t} else {\n\t\t\toccur_b[++top_b] = i;\n\t\t\tpos[i] = top_b;\n\t\t}\n\t}\n\tstring result;\n\t\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (occur_a[i] < occur_b[i]) {\n\t\t\tint k = i;\n\t\t\tfor (int j = occur_a[i] + 1; j < occur_b[i]; ++j) k = max(k, pos[j]);\n\t\t\tans[i] = \"ab\" + ans[k + 1];\n\t\t} else {\n\t\t\tint k = i;\n\t\t\twhile (k < n && occur_b[k + 1] < occur_a[k]) ++k;\n\t\t\tfor (int j = occur_b[i]; j <= 2 * n; ++j)\n\t\t\t\tif (pos[j] >= i && pos[j] <= k) ans[i] += str[j];\n\t\t\tans[i] += ans[k + 1];\n\t\t}\n\t\tans[i] = max(ans[i], ans[i + 1]);\n\t\tresult = max(result, ans[i]);\n\t}\n\t\n\tcout << result << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n\n \n \n  bool t=true;int x=0;\n string sx;\n   vector<string> ss;\n  for(int i=2*n-1;i>=0;i--){\n    if(x==0){\n      if(s[i]=='a'){\n        t=false;\n        string ns;\n        ss.push_back(ns);\n        ss[ss.size()-1].push_back(s[i]);\n        x++;\n        }\n      else{\n        if(t)sx.push_back(s[i]);\n        x--;\n      } \n   \n      continue;\n    }\n    if(x>0)ss[ss.size()-1].push_back(s[i]);\n    if(x<0&&t)sx.push_back(s[i]);\n      if(s[i]=='a')x++;\n      else x--;\n  }\nreverse(sx.begin(),sx.end());\nfor(int i=0;i<ss.size();i++)reverse(ss[i].begin(),ss[i].end());\n  string ans[ss.size()],ans2=sx;\n  for(int ii=0;ii<ss.size();ii++){\n    ans[ii]=ss[ii];\n    while(!ss[ii].empty()){\n    int i=0;\n    while(ss[ii][i]=='b')i++;\n    ss[ii].erase(ss[ii].begin()+i);\n    ss[ii].erase(ss[ii].begin());\n    ans[ii]=max(ans[ii],ss[ii]);\n  }\n  }\n  \nstring sxx[sx.size()];\nbool b[sx.size()]={};\nfor(int i=sx.size()-1;i>=0;i--){\n  if(sx[i]=='b'){\n   if(i!=sx.size()-1) sxx[i]=sxx[i+1];\n  \n    continue;\n  }\n  for(int j=sx.size()-1;j>i;j--)if(sx[j]=='b'&&b[j]==false){\n    b[j]=true;\n    sxx[i]=\"ab\"+sxx[j];\n    break;\n  }\n\n  ans2=max(ans2,sxx[i]);\n}\nfor(int i=ss.size()-1;i>=0;i--)cout<<ans[i];\n  cout<<ans2<<endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define pb push_back\n#define all(v) v.begin(), v.end()\n#define sz(v) int(v.size())\n#define pii pair<int, int>\n#define mp make_pair\n#define f first\n#define ll long long\n#define ld long double\n#define s second\n#define vec vector<int>\n\nusing namespace std;\n\nconst int N = (int) 5e3 + 10;\nconst int M = (int) 2018 * 2018;\nconst int K = (int) 15;\nconst int INF = (int) 1e9 + 7;\nconst int mod = (int) 998244353;\nconst ld EPS = (ld) 1e-9;\nconst ll LINF = (ll) 1e18;\n\nint n;\nstring s;\nstring dp[N];\n\nint main() {\n\t#ifdef sony\n\t\tfreopen(\"input.txt\", \"r\", stdin);\n\t\tfreopen(\"output.txt\", \"w\", stdout);\n\t#endif\n\tsrand(time(0));\n\tcin >> n >> s;\n\tn += n;\n\tstring str = \"\";\n\tvector<string> v;\n\tfor (int i = 0, b = 0; i < n; i++) {\n\t\tif (s[i] == 'a') b++;\n\t\telse b--;\n\t\tstr += s[i];\n\t\tif (!b) {\n\t\t\t//cout << str << \" ~~~~~~~\\n\";\n\t\t\tvec id[2];\n\t\t\tfor (int j = 0; j < sz(str); j++) {\n\t\t\t\tif (str[j] == 'a') { \n\t\t\t\t\tid[0].pb(j);\n\t\t\t\t} else { \n\t\t\t\t\tid[1].pb(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring cur = \"\";\n\t\t\tif (id[0][0] < id[1][0]) {\n\t\t\t\tint cur_id = -1;\n\t\t\t\tfor (int j = 0; j < sz(id[0]); j++) {\n\t\t\t\t\tif (id[0][j] > cur_id) {\n\t\t\t\t\t\tcur += \"ab\";\n\t\t\t\t\t\tcur_id = id[1][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset<int> st;\n\t\t\t\tfor (int j = sz(id[0]) - 1; j >= 0; j--) {\n\t\t\t\t\tst.insert(id[0][j]);\n\t\t\t\t\tst.insert(id[1][j]);\n\t\t\t\t\tstring tmp = \"\";\n\t\t\t\t\tfor (auto it : st) tmp += str[it];\n\t\t\t\t\tcur = max(cur, tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t\tv.pb(cur);\n\t\t\tstr = \"\";\n\t\t}\n\t}\n\tfor (auto it : v) {\n\t\t//cout << it << \"\\n\";\n\t}\n\tfor (int i = sz(v) - 1; i >= 0; i--) {\n\t\tdp[i] = max(dp[i + 1], v[i] + dp[i + 1]);\n\t}\n\tcout << dp[0];\n\treturn 0;\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<math.h>\n#include<algorithm>\n#include<queue>\n#include<deque>\n#include<stack>\n#include<string>\n#include<string.h>\n#include<vector>\n#include<set>\n#include<map>\n#include<bitset>\n#include<stdlib.h>\n#include<cassert>\n#include<time.h>\n#include<bitset>\nusing namespace std;\nconst long long mod=1000000007;\nconst long long inf=mod*mod;\nconst long long d2=(mod+1)/2;\nconst long double EPS=1e-13;\nconst long double PI=acos(-1.0);\nint ABS(int a){return max(a,-a);}\nlong long ABS(long long a){return max(a,-a);}\nlong double ABS(long double a){return max(a,-a);}\nchar in[7100];\nint A[3100];\nint B[3100];\nint lv[3100];\nint use[3100];\nint v[6100];\nstring dp[3100];\nint n;\nstring pa(int a,int b){\n\tfor(int i=0;i<6100;i++){\n\t\tv[i]=0;\n\t}\n\tfor(int i=a;i<b;i++){\n\t\tv[A[i]]=v[B[i]]=1;\n\t}\n\tstring ret=\"\";\n\tfor(int i=0;i<6100;i++){\n\t\tif(v[i])ret+=in[i];\n\t}\n\treturn ret;\n}\nstring calc(int a){\n\tif(dp[a]!=\"wolf\")return dp[a];\n\tif(a==n)return dp[a]=\"\";\n\tstring ret=calc(a+1);\n\tif(A[a]<B[a]){\n\t\tint to=a;\n\t\tstring tmp=\"ab\";\n\t\twhile(to<n&&A[to]<B[a]){\n\t\t\tto++;\n\t\t}\n\t\ttmp+=calc(to);\n\t\tif(ret<tmp)ret=tmp;\n\t\treturn dp[a]=ret;\n\t}\n\tint at=a+1;\n\tint ar=A[a];\n\twhile(at<n&&B[at]<ar){\n\t\tar=A[at];\n\t\tat++;\n\t}\n\tstring tmp=pa(a,at)+calc(at);\n\tif(ret<tmp)ret=tmp;\n\treturn dp[a]=ret;\n\n}\nint main(){\n\tint a;scanf(\"%d\",&a);\n\tn=a;\n\tscanf(\"%s\",in);\n\tint as=0;\n\tint bs=0;\n\tfor(int i=0;i<a*2;i++){\n\t\tif(in[i]=='a')A[as++]=i;\n\t\tif(in[i]=='b')B[bs++]=i;\n\t}\n\tfor(int i=0;i<=a;i++){\n\t\tdp[i]=\"wolf\";\n\t}\n\tstring ret=calc(0);\n\tprintf(\"%s\\n\",ret.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    for(LL i=1;i<=2000;++i) a[i]=(s[i]-'a')^1;\n//    return 0;\n    \n    /*for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;*/\n//    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// Ala be zekrellah tatmaenolgholoob ...\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n#define F first\n#define S second\n#define MP make_pair\nconst int maxn = 6e3+9;\nconst ll mod = 1e9+7;\n\nint f[maxn], last[maxn];\nbool mx[maxn][maxn];\nqueue <int> q;\n\nint main () {\n\tios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\tmemset(f, -1, sizeof f);\n\tmemset(last, -1, sizeof last);\n\tint n;\n\tstring s, curmx;\n\tcin >> n >> s;\n\tfor (int i = s.length() - 1; i >= 0; i--) {\n\t\tif (q.size() == 0 || s[q.front()] == s[i]) {\n\t\t\tq.push(i);\n\t\t\tlast[i] = last[i + 1];\n\t\t\tcontinue;\n\t\t}\n\t\tstring cur;\n\t\tint ind = q.front();\n\t\tq.pop();\n\t\tf[i] = ind;\n\t\tmx[i][i] = mx[i][ind] = true;\n\t\tif (s[i] == 'b')\n\t\t\tfor (int t = i; t < ind; t++)\n\t\t\t\tif (f[t] + 1)\n\t\t\t\t\tmx[i][t] = mx[i][f[t]] = true;\n\t\tif (last[ind] + 1)\n\t\t\tfor (int t = ind + 1; t < s.length(); t++)\n\t\t\t\tif (mx[last[ind]][t])\n\t\t\t\t\tmx[i][t] = true;\n\t\tfor (int t = 0; t < s.length(); t++)\n\t\t\tif (mx[i][t])\n\t\t\t\tcur += s[t];\n\t\tif (cur > curmx) {\n\t\t\tlast[i] = i;\n\t\t\tcurmx = cur;\n\t\t}\n\t\telse\n\t\t\tlast[i] = last[i + 1];\n\t}\n\t// ans\n\tcout << curmx << \"\\n\";\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// FUCKED UP FUCKED UP FUCKED UP FUCKED UP FUCKED UP\n#include <bits/stdc++.h>\nusing namespace std;\n\n#pragma GCC optimize(\"O2,no-stack-protector,unroll-loops,fast-math\")\n\n#define F first\n#define S second\n#define pb push_back\n#define SZ(x) (ll)(x.size())\n#define all(x) x.begin(),x.end()\n#define MP make_pair\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\n\n//mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\nconst ll maxn=3e3+10, maxm=1e6+10, lg=21, mod=1e9+7, inf=1e18;\n\nint n;\nchar s[100100];\nint ap[100100],bp[100100];\nint ca,cb;\nstring f[3030];\nbool book[6060];\nint nxt[6060];\n\nint main(){\n\tios_base::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n\t\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tn=strlen(s+1);\n\tfor(int i=1;i<=n;++i)\n\t\tif(s[i]=='a')ap[++ca]=i;\n\t\telse bp[++cb]=i;\n\tn/=2;\n\tfor(int i=1;i<=n;++i)nxt[min(ap[i],bp[i])]=i;\n\tfor(int i=n*2;i;--i)if(!nxt[i])nxt[i]=nxt[i+1];\n\tfor(int i=n;i;--i)\n\t{\n\t\tmemset(book,0,sizeof(book));\n\t\tbook[ap[i]]=book[bp[i]]=1;\n\t\tif(bp[i]<ap[i])\n\t\t{\n\t\t\tint mxa=ap[i];\n\t\t\tfor(int j=i+1;j<=n;++j)\n\t\t\t\tif(bp[j]<ap[j]&&bp[j]<mxa)\n\t\t\t\t{\n\t\t\t\t\tbook[ap[j]]=book[bp[j]]=1;\n\t\t\t\t\tmxa=max(mxa,ap[j]);\n\t\t\t\t}\n\t\t\tfor(int j=1;j<=n*2;++j)\n\t\t\t\tif(book[j])f[i]+=s[j];\n\t\t\tf[i]+=f[nxt[mxa+1]];\n\t\t}\n\t\telse f[i]=\"ab\"+f[nxt[bp[i]+1]];\n\t\tf[i]=max(f[i],f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\t\n\t\n\treturn 0;\n}\n\n\n\n \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, A[6003], B[6003];\nint id[6003], nx[6003];\nstring s, res[6003];\n\nint main() {\n    cin >> n >> s, s = \" \" + s;\n    for (int i = 1, ca = 0, cb = 0; i <= n * 2; ++i)\n        (s[i] ^ 'a') ? B[id[i] = ++cb] = i : A[id[i] = ++ca] = i;\n    A[n + 1] = B[n + 1] = n * 2 + 1;\n\n    for (int i = 1, p = 1; i <= n + 1; ++i)\n        while (p < min(A[i], B[i])) nx[p++] = i;\n\n    for (int i = n, p, mx; i >= 1; --i) {\n        if (B[i] < A[i]) {\n            for (p = B[i], mx = A[i]; p <= mx; ++p)\n                if (id[p] >= i) res[i] += s[p], mx = max(mx, A[id[p]]);\n            res[i] += res[id[p]];\n        } else {\n            res[i] = \"ab\" + res[nx[B[i]]];\n        }\n        res[i] = max(res[i], res[i + 1]);\n    }\n    cout << res[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string ans;\n  vector<int> bestind;\n  vector<string> bestsave(n + 1);\n  vector<vector<int>> bestsave_ind(n + 1);\n  for (int x = n - 1; x >= 0; x--) {\n    vector<int> cur;\n    cur.push_back(a[x]);\n    cur.push_back(b[x]);\n\n    int limit = a[x];\n    for (int i = x+1; i < n; i++) {\n      limit = min(limit, a[i]);\n      if (b[i] >= limit) {\n        cur.insert(cur.end(), bestsave_ind[i].begin(), bestsave_ind[i].end());\n        break;\n      }\n      cur.push_back(a[i]);\n      cur.push_back(b[i]);\n    }\n    sort(cur.begin(), cur.end());\n    string cand;\n    for (int vi : cur) {\n      cand.push_back(buff[vi]);\n    }\n    if (cand > ans) {\n      ans = cand;\n      bestind = cur;\n    }\n    bestsave[x] = ans;\n    bestsave_ind[x] = bestind;\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#ifdef DEBUG\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define debug(...)\n#endif\n\n#ifdef __WIN32\n#define LLFORMAT \"I64\"\n#define Rand() ((rand() << 15) + rand())\n#else\n#define LLFORMAT \"ll\"\n#define Rand() (rand())\n#endif\n\nusing namespace std;\n\nconst int maxn = 3030;\n\nint n, sb[maxn];\nstring s, dp[maxn];\nset<pair<int, int> > ab, ba;\n\nint cntb(int l, int r) { return sb[r] - (l ? sb[l - 1] : 0); }\n\nvoid upd(string &s, const string &t) {\n\tfor (int i = 0; i < s.size() && i < t.size(); ++i) if(s[i] != t[i]) { if(s[i] < t[i]) s = t; return; }\n\tif(s.size() < t.size()) s = t;\n\treturn;\n}\n\nstring DP(int beg) {\n\tif(beg == n) return \"\";\n\tauto &dp = ::dp[beg]; if(dp.size() != 0) return dp;\n\tauto it = ba.lower_bound(make_pair(beg, -1));\n\tif(it == ba.end()) {\n\t\tint lst = beg - 1;\n\t\tit = ab.lower_bound(make_pair(beg, -1));\n\t\twhile(it != ab.end()) {\n\t\t\tif(it->first > lst) dp += \"ab\", lst = it->second;\n\t\t\t++it;\n\t\t}\n\t\tupd(dp, DP(beg + 1));\n\t\treturn dp;\n\t}\n\tif(it->first > beg) return dp = DP(beg + 1);\n\tvector<int> tmp;\n\tint lst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t++it;\n\twhile(it != ba.end()) {\n\t\tif(it->first > lst) break;\n\t\tlst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t++it;\n\t}\n\tsort(tmp.begin(), tmp.end());\n\tfor (int i: tmp) dp += s[i];\n\tdp += DP(tmp.back() + 1);\n\tupd(dp, DP(beg + 1));\n\treturn dp;\n}\n\nint main() {\n\tcin >> n >> s; n *= 2;\n\tfor (int pb = -1, pa = 0; pa < n; ++pa) if(s[pa] == 'a') {\n\t\t++pb; while(s[pb] != 'b') ++pb;\n\t\tif(pa < pb) ab.insert(make_pair(pa, pb));\n\t\telse ba.insert(make_pair(pb, pa));\n\t}\n\tcout << DP(0) << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n      \n#define FOR(i,a,b) for(ll i = (a); i < (ll)(b); i++)\n#define REP(i,n) FOR(i,0,n)\n#define YYS(x,arr) for(auto& x:arr)\n#define PW(x) (1LL<<(x))\n#define SZ(x) ((ll)(x).size())\n\n#define pb emplace_back\n#define fi first\n#define se second\n\nusing namespace std;\n\nusing ld = long double;\nusing ll = long long int;\n\nconst ll INF = (ll)1e9 + 10;\nconst ll INFLL = (ll)1e18 + 10;\nconst ll MOD = 1e9+7;\n     \ntemplate<class T> T &chmin( T &a , const T &b ){ return a = min(a,b); }\ntemplate<class T> T &chmax( T &a , const T &b ){ return a = max(a,b); }\ntemplate<class T> void UNIQUE(vector<T> &a){ a.erase(unique(a.begin(), a.end()), a.end()); }\n\ntemplate<class S, class T> ostream& operator << (ostream& os, const pair<S, T> v){\n  os << \"(\" << v.first << \", \" << v.second << \")\"; return os;\n}\ntemplate<class T> ostream& operator << (ostream& os, const vector<T> v){\n  for(int i = 0; i < v.size(); i++){if(i > 0){os << \" \";} os << v[i];} return os;\n}\ntemplate<class T> ostream& operator << (ostream& os, const vector<vector<T>> v){\n  for(int i = 0; i < v.size(); i++){if(i > 0){os << endl;} os << v[i];} return os;\n}\n\nll in(){long long int x; scanf(\"%lld\", &x); return x;}\nld fin(){double x; scanf(\"%lf\", &x); return x;}\nchar yuyushiki[1000010]; string stin(){scanf( \"%s\", yuyushiki ); return yuyushiki;}\n\n// head\n\nusing vi = vector<int>;\n\nstruct SA : public vi{\n  int n, k;\n  vi rank, tmp;\n  \n  bool compare( int i , int j ){\n    if( rank[i] != rank[j] ) return rank[i] < rank[j];\n\n    int ri = i + k <= n ? rank[i+k] : -1;\n    int rj = j + k <= n ? rank[j+k] : -1;\n    return ri < rj;\n  }\n\n  struct Compare_SA{\n    SA *sa;\n    Compare_SA( SA *s ) : sa(s) {}\n    bool operator() ( const int &i , const int &j ){\n      return sa->compare( i , j );\n    }\n  };\n\n  void init(vector<int> S){\n    n = S.size();\n\n    resize( n+1 );\n    rank = tmp = vi( n+1 );\n    REP( i , n+1 ){\n      at(i) = i;\n      rank[i] = i < n ? S[i] : -1;\n    }\n\n    for( k = 1; k <= n; k *= 2 ){\n      sort( begin() , end() , Compare_SA(this) );\n\n      tmp[at(0)] = 0;\n      FOR( i , 1 , n+1 )\n\ttmp[at(i)] = tmp[at(i-1)] + (compare(at(i-1),at(i))?1:0);\n\n      REP( i , n+1 ) rank[i] = tmp[i];\n    }\n  }\n};\n\n\nSA sa;\n\nint a[3010];\n\nint main(){\n\n  int n = in();\n  string s = stin();\n\n  REP(i, 2*n){\n    if(s[i] == 'b'){\n      a[i+1] = a[i] + 1;\n    } else {\n      a[i+1] = a[i] - 1;\n    }\n  }\n\n  vector<vector<int>> vx(0);\n  vector<vector<char>> vc(0);\n  vector<int> c = {0};\n  vector<char> d = {s[0]};\n  int it = 1;\n  while(it <= 2*n){\n    if(a[it] == 0){\n      vx.pb(c);\n      vc.pb(d);\n      c.clear();\n      c.pb(0);\n      d.clear();\n      if(it < 2*n){\n        d.pb(s[it]);\n      }\n    } else {\n      c.pb(a[it]);\n      d.pb(s[it]);\n    }\n    it++;\n  }\n\n  // cout << vx << endl;\n  // cout << vc << endl;\n\n  /*\n  REP(i, 2*n+1){\n    cout << a[i] << \" \";\n  }\n  cout << endl;\n  */\n\n  vector<vector<int>> nvx(0);\n  vector<vector<char>> nvc(0);\n  vector<char> la;\n  int mm = 1;\n  bool f = false;\n  for(int i = SZ(vx) - 1; i >= 0; i--){\n    int ma = *max_element(vx[i].begin(), vx[i].end());\n    if(ma >= mm){\n      mm = ma;\n      f = true;\n      nvx.pb(vx[i]);\n      nvc.pb(vc[i]);\n    } else if(!f){\n      for(int j = SZ(vc[i]) - 1; j >= 0; j--){\n        la.pb(vc[i][j]);\n      }\n    }\n  }\n\n  reverse(nvx.begin(), nvx.end());\n  reverse(nvc.begin(), nvc.end());\n  reverse(la.begin(), la.end());\n  \n  string ans = \"\";\n  \n  REP(i, SZ(nvx)){\n    sa.init(nvx[i]);\n    // cout << nvx[i] << endl;\n    // cout << sa[SZ(nvx[i])] << endl;\n    int p = sa[SZ(nvx[i])];\n    ans += string(nvx[i][p], 'b');\n    while(p < SZ(nvc[i])){\n      ans += nvc[i][p];\n      p++;\n    }\n  }\n\n  vector<int> ai(SZ(la));\n  vector<int> bi(SZ(la));\n  vector<int> ia(SZ(la));\n  vector<int> ib(SZ(la));\n\n  int ca = 0;\n  int cb = 0;\n\n  REP(i, SZ(la)){\n    if(la[i] == 'a'){\n      ai[i] = ca;\n      ia[ca] = i;\n      ca++;\n    } else {\n      bi[i] = cb;\n      ib[cb] = i;\n      cb++;\n    }\n  }\n\n  assert(ca == cb);\n  \n  it = 0;\n  while(it < SZ(la)){\n    if(la[it] == 'a'){\n      int p = ib[ai[it]];\n      assert(p > it);\n      ans += \"ab\";\n      it = p+1;\n    }\n  }\n\n  /*\n  int cur = 0;\n  while(cur < 2*n){\n    int p = max_element(a+cur, a+2*n) - a;\n    if(a[p] > 0){\n      ans += string(a[p], 'b');\n    } else {\n      ans += string(-a[p], 'a');\n      break;\n    }\n    while(p < 2*n && a[p] > 0){\n      ans += s[p];\n      p++;\n    }\n    cur = p;\n  }\n  */\n\n  printf(\"%s\\n\", ans.c_str());\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// Tenshi ni Fureta yo!\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned int UI;\ntypedef pair<int, int> pii;\n\n#define DEBUG(...) fprintf(stderr, __VA_ARGS__)\n#define MP make_pair\n#define fst first\n#define snd second\n#define SZ(u) ((int) (u).size())\n#define ALL(u) (u).begin(), (u).end()\n\ninline void proc_status()\n{\n\tifstream t(\"/proc/self/status\");\n\tcerr << string(istreambuf_iterator<char>(t), istreambuf_iterator<char>()) << endl;\n}\n\ntemplate<typename T> inline int chkmin(T &a, const T &b) { return b < a ? a = b, 1 : 0; }\ntemplate<typename T> inline int chkmax(T &a, const T &b) { return b > a ? a = b, 1 : 0; }\ntemplate<typename T> inline T sqr(const T &val) { return val * val; }\n\nnamespace fastIO\n{\n\tconst int MAX_BUFFER_SIZE = 1 << 16;\n\n\tchar buffer[MAX_BUFFER_SIZE], *cur = buffer, *ed = buffer;\n\n\tinline char getc() { return *(cur == ed ? ed = buffer + fread(buffer, 1, MAX_BUFFER_SIZE, stdin), cur = buffer : cur)++; }\n}\nusing fastIO::getc;\n\ntemplate<typename T> inline T read()\n{\n\tregister T sum(0), fg(1);\n\tregister char ch(getc());\n\tfor(; !isdigit(ch); ch = getc()) if(ch == '-') fg = -1;\n\tfor(;  isdigit(ch); ch = getc()) sum = sum * 10 - '0' + ch;\n\treturn sum * fg;\n}\n\n// END tpl.\n\nconst int MAXN = (int) 3e3;\n\nint n;\n\nvector<string> S;\n\ninline char safe_getc()\n{\n\tregister char ch(getc());\n\twhile(!isgraph(ch)) ch = getc();\n\treturn ch;\n}\n\ninline void input()\n{\n\tn = read<int>();\n\tstring res;\n\tfor(int cnt = 0, i = 1; i <= 2 * n; ++i)\n\t{\n\t\tchar ch = safe_getc();\n\t\tcnt += ch == 'a' ? +1 : -1;\n\t\tres.push_back(ch);\n\t\tif(cnt == 0) S.push_back(res), res = \"\", cnt = 0;\n\t}\n}\n\ninline string calc(const string &s)\n{\n\tint len = s.length();\n\tif(s[0] == 'a')\n\t{\n\t\tstring res = \"\";\n\t\tfor(int i = 0, j; i < len; i = j + 1)\n\t\t{\n\t\t\tfor(j = i + 1; s[j] != 'b' && j < len; ++j);\n\t\t\tif(j == len) break;\n\t\t\telse res += \"ab\";\n\t\t}\n\t\treturn res;\n\t}\n\telse\n\t{\n\t\tstring ans = \"\";\n\t\tfor(int i = 1; i <= len / 2; ++i)\n\t\t{\n\t\t\tstring res;\n\t\t\tint cnta = i, cntb = i;\n\t\t\tfor(int j = len - 1; j >= 0; --j)\n\t\t\t{\n\t\t\t\tif(s[j] == 'a' && cnta > 0) res += 'a', --cnta;\n\t\t\t\tif(s[j] == 'b' && cntb > 0) res += 'b', --cntb;\n\t\t\t}\n\t\t\treverse(ALL(res));\n\t\t\tchkmax(ans, res);\n\t\t}\n\t\treturn ans;\n\t}\n}\n\ninline void solve()\n{\n\treverse(ALL(S));\n\n\tstring ans = \"\";\n\tfor(auto i : S)\n\t{\n\t\tstring res = calc(i);\n\t\tint fg = 1;\n\t\tfor(int j = 0, len = min(res.length(), ans.length()); j < len; ++j)\n\t\t{\n\t\t\tif(res[j] < ans[j]) { fg = 0; break; }\n\t\t\tif(res[j] > ans[j]) break;\n\t\t}\n\t\tif(fg) ans = res + ans;\n\t}\n\tputs(ans.c_str());\n}\n\nint main()\n{\n#ifdef K_ON\n\tfreopen(\"E.in\", \"r\", stdin);\n\tfreopen(\"E.out\", \"w\", stdout);\n#endif\n\n\tinput();\n\tsolve();\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 'a'];\n    }\n    for (int i = n; i >= 1; --i) {\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n\treturn 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define to edge[i].v\n#define mp make_pair\n#define rint register int\n#define debug(x) cout<<#x<<\"=\"<<x<<endl\n#define fgx cout<<\"-------------\"<<endl\n#define N 10000\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\nchar c[N];int a[N],p[2],pos[N][2],b[N],id[N],ban[N];string s[N],f[N];\nint main()\n{\tint n,sum=0,m=0,la=1; cin>>n; n+=n; scanf(\"%s\",c+1);\n\tfor(rint i=1;i<=n;i++)\n\t{\tsum+=(a[i]=(c[i]=='a'))?1:-1; pos[id[i]=++p[a[i]]][a[i]]=i;\n\t\tif(!sum) b[++m]=la,la=i+1;\n\t}\n\tb[++m]=n+1;\n\tfor(rint i=1;i<m;i++)\n\tif(a[b[i]])\n\t{\tfor(rint j=b[i],k=b[i];j<b[i+1];j=k)\n\t\tif(a[k]) for(s[i]+=\"ab\",ban[pos[id[k]][0]]=1;k<b[i+1]&&(a[k]||!ban[k]);k++);\n\t\telse k++;\n\t}\n\telse\n\t{\tint l=id[b[i]],r=id[b[i+1]-1]; set<pair<int,char>> S;\n\t\tfor(rint j=r;j>=l;j--)\n\t\t{\tS.insert(mp(pos[j][0],'b')),S.insert(mp(pos[j][1],'a')); string t=\"\";\n\t\t\tfor(set<pair<int,char>>::iterator it=S.begin();it!=S.end();it++)\n\t\t\tt+=(*it).second; s[i]=max(s[i],t);\n\t\t}\n\t}\n\tfor(rint i=1;i<m;i++)\n\tfor(rint j=0;j<i;j++) f[i]=max(f[i],f[j]+s[i]);\n\tcout<<f[m-1];\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n//    ios_base::sync_with_stdio(0); cin.tie(0);\n    int n; string s;\n    cin >> n >> s;\n    vector<pair<int, int>> vals;\n    vector<string> mx(2 * n + 2);\n    vector<int> go(2 * n);\n    vector<int> label(2 * n);\n    int it1 = 0, it2 = 0;\n    while(it1 != 2 * n && it2 != 2 * n){\n        while(s[it1] != 'a') it1++;\n        while(s[it2] != 'b') it2++;\n        vals.emplace_back(min(it1, it2), max(it1, it2));\n        go[it1] = it2, go[it2] = it1;\n        it1++, it2++;\n    }\n    sort(vals.begin(), vals.end());\n    for(int i = 0; i < n; i++){\n        label[vals[i].first] = i;\n        label[vals[i].second] = i;\n    }\n    for(int loc = n - 1; loc >= 0; loc--){\n        int st = vals[loc].first, ed = vals[loc].second;\n        int last = ed;\n        if(s[st] == 'b'){\n            while(last != 2 * n - 1){\n                if(go[last] < last){\n                    last++;\n                    continue;\n                }\n                if(s[last] == 'a') break;\n                last++;\n            }\n            if(go[last] > last) last--;\n        }\n        string fin = \"\";\n        if(s[st] == 'a'){\n            fin = \"ab\";\n        }\n        else{\n            for(int i = st; i <= last; i++){\n                if(s[i] == 'a' && go[i] < st) continue;\n                fin += s[i];\n            }\n        }\n        int nxt = -1;\n        for(int i = last + 1; i < 2 * n; i++){\n            if(go[i] > i){\n                nxt = i;\n                break;\n            }\n        }\n        if(nxt != -1) fin += mx[label[nxt]];\n        mx[loc] = max(mx[loc + 1], fin);\n    }\n    cout << mx[0] << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\nAuthor: QAQAutomaton\nLang: C++\nCode: E.cpp\nMail: lk@qaq-am.com\nBlog: https://www.qaq-am.com/\n*/\n#include<bits/stdc++.h>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#define DEBUG printf(\"Passing [%s] in LINE %d\\n\",__FUNCTION__,__LINE__)\n#define Debug debug(\"Passing [%s] in LINE %d\\n\",__FUNCTION__,__LINE__)\n#define all(x) x.begin(),x.end()\n#define x first\n#define y second\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\nint inf;\nconst double eps=1e-8;\nconst double pi=acos(-1.0);\ntemplate<class T>int chkmin(T &a,T b){return a>b?a=b,1:0;}\ntemplate<class T>int chkmax(T &a,T b){return a<b?a=b,1:0;}\ntemplate<class T>T sqr(T a){return a*a;}\ntemplate<class T>T mmin(T a,T b){return a<b?a:b;}\ntemplate<class T>T mmax(T a,T b){return a>b?a:b;}\ntemplate<class T>T aabs(T a){return a<0?-a:a;}\ntemplate<class T>int dcmp(T a,T b){return a>b;}\ntemplate<int *a>int cmp_a(int x,int y){return a[x]<a[y];}\n#define min mmin\n#define max mmax\n#define abs aabs\nstruct __INIT__{\n\t__INIT__(){\n\t\tmemset(&inf,0x3f,sizeof(inf));\n\t}\n}__INIT___;\nnamespace io {\n\tconst int SIZE = (1 << 21) + 1;\n\tchar ibuf[SIZE], *iS, *iT, obuf[SIZE], *oS = obuf, *oT = oS + SIZE - 1, c, qu[55]; int f, qr;\n\t// getchar\n\t#define gc() (iS == iT ? (iT = (iS = ibuf) + fread (ibuf, 1, SIZE, stdin), (iS == iT ? EOF : *iS ++)) : *iS ++)\n\t// print the remaining part\n\tinline void flush () {\n\t\tfwrite (obuf, 1, oS - obuf, stdout);\n\t\toS = obuf;\n\t}\n\t// putchar\n\tinline void putc (char x) {\n\t\t*oS ++ = x;\n\t\tif (oS == oT) flush ();\n\t}\n\ttemplate<typename A>\n\tinline bool read (A &x) {\n\t\tfor (f = 1, c = gc(); c < '0' || c > '9'; c = gc()) if (c == '-') f = -1;else if(c==EOF)return 0;\n\t\tfor (x = 0; c <= '9' && c >= '0'; c = gc()) x = x * 10 + (c & 15); x *= f;\n\t\treturn 1;\n\t}\n\tinline bool read (char &x) {\n\t\twhile((x=gc())==' '||x=='\\n' || x=='\\r');\n\t\treturn x!=EOF;\n\t}\n\tinline bool read(char *x){\n\t\twhile((*x=gc())=='\\n' || *x==' '||*x=='\\r');\n\t\tif(*x==EOF)return 0;\n\t\twhile(!(*x=='\\n'||*x==' '||*x=='\\r'))*(++x)=gc();\n\t\t*x=0;\n\t\treturn 1;\n\t}\n\ttemplate<typename A,typename ...B>\n\tinline bool read(A &x,B &...y){\n\t\treturn read(x)&&read(y...);\n\t}\n\ttemplate<typename A>\n\tinline bool write (A x) {\n\t\tif (!x) putc ('0'); if (x < 0) putc ('-'), x = -x;\n\t\twhile (x) qu[++ qr] = x % 10 + '0',  x /= 10;\n\t\twhile (qr) putc (qu[qr --]);\n\t\treturn 0;\n\t}\n\tinline bool write (char x) {\n\t\tputc(x);\n\t\treturn 0;\n\t}\n\tinline bool write(const char *x){\n\t\twhile(*x){putc(*x);++x;}\n\t\treturn 0;\n\t}\n\tinline bool write(char *x){\n\t\twhile(*x){putc(*x);++x;}\n\t\treturn 0;\n\t}\n\ttemplate<typename A,typename ...B>\n\tinline bool write(A x,B ...y){\n\t\treturn write(x)||write(y...);\n\t}\n\t//no need to call flush at the end manually!\n\tstruct Flusher_ {~Flusher_(){flush();}}io_flusher_;\n}\nusing io :: read;\nusing io :: putc;\nusing io :: write;\nchar s[6005];\nint at[2][3005],cnt[2],w[6005];\nstring ans[3005];\nbitset<6005> is;\nsigned main(){\n#ifdef QAQAutoMaton \n\tfreopen(\"E.in\",\"r\",stdin);\n\tfreopen(\"E.out\",\"w\",stdout);\n#endif\n\tint n;\n\tread(n);\n\tread(s+1);\n\tfor(int i=1;i<=n+n;++i){\n\t\tat[s[i]-'a'][++cnt[s[i]-'a']]=i;\n\t}\n\tfor(int i=1;i<=n+n;++i)w[i]=n+1;\n\tfor(int i=n;i;--i){\n\t\tfor(int j=min(at[0][i-1],at[1][i-1])+1;j<=min(at[0][i],at[1][i]);++j){\n\t\t\tw[j]=i;\n\t\t}\n\t}\n\tfor(int i=n;i;--i){\n\t\tif(at[0][i]<at[1][i]){\n\t\t\tans[i]=\"ab\"+ans[w[at[1][i]+1]];\t\t\t\n\t\t}\n\t\telse{\n\t\t\tint rr=at[0][i];\t\n\t\t\tfor(int j=i;j<=n;++j){\n\t\t\t\tif(at[0][j]>at[1][j] && at[1][j]<=rr){\n\t\t\t\t\tchkmax(rr,at[0][j]);\n\t\t\t\t\tis[at[0][j]]=is[at[1][j]]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans[i]=\"\";\n\t\t\tfor(int j=1;j<=n+n;++j)if(is[j]){\n\t\t\t\tans[i]+=s[j];\n\t\t\t\tis[j]=0;\n\t\t\t}\n\t\t\tans[i]+=ans[w[rr+1]];\n\t\t}\n\t\tchkmax(ans[i],ans[i+1]);\n\t}\n\twrite(ans[1].c_str(),'\\n');\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nint n,p[N],pp[N],t[N];\nint q[N],head,tail;\nstring res[N],now;\nchar s[N];\nvector <int> a,b;\nint main(){\n\tscanf(\"%d\",&n);\n\tn<<=1;\n\tscanf(\"%s\",s+1);\n\ta.clear(),b.clear();\n\tfor (int i=1;i<=n;i++)\n\t\tif (s[i]=='a')\n\t\t\ta.push_back(i);\n\t\telse\n\t\t\tb.push_back(i);\n\tfor (int i=1;i<=n/2;i++)\n\t\tp[b[i-1]]=a[i-1],pp[a[i-1]]=b[i-1];\n\tfor (int i=1;i<=n+1;i++)\n\t\tres[i]=\"\";\n\tint tot=0;\n\tint nxt=n+1;\n\tfor (int i=n;i>=1;i--){\n\t\tif (s[i]=='a')\n\t\t\ttot++;\n\t\telse\n\t\t\ttot--;\n\t\tif (tot)\n\t\t\tcontinue;\n\t\tmemset(t,0,sizeof t);\n\t\thead=1,tail=0;\n\t\tfor (int j=i;j<nxt;j++){\n/*\t\t\tprintf(\"%d: \",j);\n\t\t\tfor (int k=i;k<nxt;k++)\n\t\t\t\tprintf(\"%d\",t[k]);puts(\"\");*/\n\t\t\tif (s[j]=='a'){\n\t\t\t\tif (t[j]){\n\t\t\t\t\tnow=\"\";\n\t\t\t\t\tfor (int k=i;k<nxt;k++)\n\t\t\t\t\t\tif (s[k]=='b'){\n\t\t\t\t\t\t\tif (t[k]||k>j)\n\t\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (t[k]||k>p[q[tail]])\n\t\t\t\t\t\t\tnow+=\"a\";\n//\t\t\t\t\tif (i==7)\n//\t\t\t\t\t\tcout << now << endl;\n\t\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\t\thead++;\n\t\t\t\t\tt[j]=t[pp[j]]=0;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (p[j]<j)\n\t\t\t\tcontinue;\n\t\t\t//s[j]==b\n\t\t\tq[++tail]=j;\n\t\t\tt[j]=t[p[j]]=1;\n\t\t}\n\t\tmemset(t,0,sizeof t);\n\t\tif (res[i]==\"\"){\n\t\t\tres[i]=res[nxt];\n\t\t\tfor (int j=i;j<nxt;j++){\n\t\t\t\tif (s[j]=='b')\n\t\t\t\t\tcontinue;\n\t\t\t\tt[j]=t[pp[j]]=1;\n\t\t\t\tnow=\"\";\n\t\t\t\tfor (int k=i;k<=pp[j];k++)\n\t\t\t\t\tif (t[k])\n\t\t\t\t\t\tnow+=s[k];\n\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\tj=pp[j];\n\t\t\t}\n\t\t}\n\t\tnxt=i;\n\t}\n//\tcout << res[7]  << endl;\n//\tcout << res[11] << endl;\n\tcout << res[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h> \nusing namespace std; \n  \nstring LexicographicalMaxString(string str) \n{ \n    string mx = \"\"; \n    for (int i = 0; i < str.length(); ++i) \n        mx = max(mx, str.substr(i)); \n  \n    return mx; \n} \n\nint main() \n{ \n\tint n;\n\tcin >> n;\n    string str; \n    cin >> str;\n    cout << LexicographicalMaxString(str); \n    return 0; \n}"
  },
  {
    "language": "C++",
    "code": "\t#include <iostream>\n    #include <string>\n    #include <set>  \n    #include <stack>\n    #include <algorithm>\n    #include <vector>\n    #include <cmath>\n    #include <queue>\n    #include <deque>\n    #include <cstring>\n    #include <cstdio>\n    #include <map>\n    #include <numeric>\n    #include <cassert>\n    #include <iomanip>\n    #include <sstream>\n    #include <ctime>\n    #include <bitset> \nusing namespace std;\n#define for1(i,a,b) for(int i=(a);i<(int)(b);++i)\n#define rep(i,maxn) for1(i,0,maxn)\n#define ford(i,b,a) for(int i=(int)(b)-1;i>=a;--i)\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<int,pii > piii;\n#define inf 0x3f3f3f3f\n#define mod 1000000007\n#define st first\n#define nd second\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define dprintf(...) printf(__VA_ARGS__)\nconst int maxn=3412;\nint n;\nstring s;\nint id[maxn+maxn];\nvector<string> ds;\nvoid cal(string& s)\n{\n\tstring cur=\"\";\n\tmemset(id,-1,sizeof(id));\n\tint ai=0,bi=0;\n\trep(i,s.length())\n\t{\n\t\tif(s[i]=='a')ai++,id[i]=ai;\n\t\telse bi++,id[i]=bi;\n\t//\tcout<<id[i]<<endl;\n\t}\n\tif(s[0]=='a')\n\t{\n\t\tint ai=0,bi=0;\n\t\tcur.pb(s[0]);ai++;\n\t\tint nd=ai;bool ok=0;\n\t\tfor1(i,1,s.length())\n\t\t{\n\t\t\tif(s[i]=='a')\n\t\t\t{\n\t\t\t\tai++;\n\t\t\t\tif(ok)cur.pb(s[i]),nd=ai,ok=0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbi++;\n\t\t\t\tif(bi==nd)cur.pb(s[i]),ok=1;\n\t\t\t}\n\t\t//\tcout<<i<<\" \"<<cur<<endl;\n\t\t//\tsystem(\"pause\");\n\t\t}\n\t}\n\telse\n\t{\n\t\tint mxid=id[s.length()-1];\n\t\tfor1(l,1,mxid+1)\n\t\t{\n\t\t\tstring bst=\"\";\n\t\t\trep(i,s.length())\n\t\t\t\tif(id[i]>=l)bst.pb(s[i]);\n\t\t//\tcout<<l<<\" \"<<bst<<endl;\n\t\t\tcur=max(cur,bst);\n\t\t}\n\t}\n\ts=cur;\n}\nint main()\n{\n\tcin>>n>>s;\n\tstring buf=\"\";\n\tint ai=0,bi=0;\n\trep(i,s.length())\n\t{\n\t\tbuf.pb(s[i]);\n\t\tif(s[i]=='a')ai++;\n\t\telse bi++;\n\t\tif(ai==bi)ds.pb(buf),buf=\"\";\n\t}\n\trep(i,ds.size())\n\t{\n\t//\tcout<<ds[i]<<endl;\n\t\tcal(ds[i]);\n\t//\tcout<<ds[i]<<endl;\n\t//\tsystem(\"pause\"); \n\t}\n\tford(i,ds.size()-1,0)\n\t\tds[i]=max(ds[i+1],ds[i]+ds[i+1]);\n\tcout<<ds[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntemplate <typename T> void read(T &t) {\n\tt=0; char ch=getchar(); int f=1;\n\twhile (ch<'0'||ch>'9') { if (ch=='-') f=-1; ch=getchar(); }\n\tdo { (t*=10)+=ch-'0'; ch=getchar(); } while ('0'<=ch&&ch<='9'); t*=f;\n}\nconst int maxn=3010;\nint n,s[maxn],tot;\nchar t[maxn],ans[maxn],res[maxn];\nstruct node { int l,r,flag; } d[maxn];\nbool cmp(char *a,char *b) {\n\tint t1=strlen(a+1),t2=strlen(b+1);\n\tfor (int i=1;i<=max(t1,t2);i++) {\n\t\tif (i>t1) a[i]=0;\n\t\tif (i>t2) b[i]=0;\n\t\tif (a[i]!=b[i]) return a[i]<b[i];\n\t}\n\treturn 1;\n}\nbool cmp2(char *a,char *b) {\n\tint t1=strlen(a+1),t2=strlen(b+1);\n\tfor (int i=1;i<=t2;i++) {\n\t\tif (i>t1) a[i]=0;\n\t\tif (a[i]!=b[i]) return a[i]<b[i];\n\t}\n\treturn 1;\n}\nchar tmp[maxn];\nint id[maxn];\nvoid eq(char *a,char *b) {\n\tint len=strlen(b+1);\n\tfor (int i=1;i<=len;i++) a[i]=b[i];\n\ta[len+1]=0;\n}\nvoid solve(int l,int r) {\n\t// [l,r] has more 'b' than 'a' in every prefix\n\tint t1=0,t2=0,len;\n\tres[1]='a'-1; res[2]=0;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (t[i]=='a') id[i]=++t1;\n\t\telse id[i]=++t2;\n\t}\n\tfor (int i=1;i<=t1;i++) {\n\t\tlen=0;\n\t\tfor (int j=l;j<=r;j++)\n\t\t\tif (id[j]>=i) tmp[++len]=t[j];\n\t\ttmp[len+1]=0;\n\t\t//printf(\"%s\\n\",tmp+1);\n\t\tif (cmp(res,tmp)) eq(res,tmp);\n\t}\n}\nbool mk[maxn];\nint dy[maxn];\nvoid solve2(int l,int r) {\n\tint t1=0,t2=0;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (t[i]=='a') id[i]=++t1;\n\t\telse id[i]=++t2,dy[t2]=i;\n\t}\n\tint pos;\n\tfor (int i=l;i<=r;i++) {\n\t\tif (!mk[i]&&t[i]=='a') {\n\t\t\tpos=dy[id[i]];\n\t\t\tfor (int j=i;j<=pos;j++) mk[j]=1;\n\t\t\ti=pos;\n\t\t\tprintf(\"ab\");\n\t\t}\n\t}\n}\nint main() {\n\t//freopen(\"1.txt\",\"r\",stdin);\n\tread(n); n*=2;\n\tscanf(\"%s\",t+1);\n\tint flag=0,sum=0;\n\tfor (int i=1;i<=n;i++) {\n\t\tif (t[i]=='a') sum++;\n\t\telse sum--;\n\t\ts[i]=sum;\n\t\tif (!flag) {\n\t\t\tif (sum<0) flag=-1;\n\t\t\telse if (sum>0) flag=1;\n\t\t}\n\t\tif (sum==0) {\n\t\t\ttot++;\n\t\t\td[tot]=(node){d[tot-1].r+1,i,flag};\n\t\t\tflag=0;\n\t\t}\n\t}\n\t//for (int i=1;i<=tot;i++)\n\t\t//printf(\"%d %d %d\\n\",d[i].l,d[i].r,d[i].flag);\n\tint pos=0,len;\n\tfor (int i=tot;i>=1;i--) {\n\t\tif (d[i].flag==1) continue;\n\t\tif (!pos) pos=i;\n\t\tsolve(d[i].l,d[i].r);\n\t//\tprintf(\"res=%s\\n\",res+1);\n\t\tif (cmp2(ans,res)) {\n\t\t\tlen=strlen(ans+1);\n\t\t\treverse(ans+1,ans+len+1);\n\t\t\tfor (int j=strlen(res+1);j>=1;j--)\n\t\t\t\tans[++len]=res[j];\n\t\t\t//printf(\"ans=%s\\n\",ans+1);\n\t\t\tans[len+1]=0;\n\t\t\treverse(ans+1,ans+len+1);\n\t\t}\n\t}\n\tprintf(\"%s\",ans+1);\n\tfor (int i=pos+1;i<=tot;i++) {\n\t\tsolve2(d[i].l,d[i].r);\n\t}\n\tprintf(\"\\n\");\n\treturn 0;\n}\n/*\n  0. Enough array size? Enough array size? Enough array size? Interger overflow?\n  \n  1. Think TWICE, Code ONCE!\n  Are there any counterexamples to your algo?\n    \n  2. Be careful about the BOUNDARIES!\n  N=1? P=1? Something about 0?\n    \n  3. Do not make STUPID MISTAKES!\n  Time complexity? Memory usage? Precision error?\n*/"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <random>\n#include <set>\n#include <sstream>\n#include <string>\n#include <utility>\n#include <vector>\n\nconst int DEBUG = 0;\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n#define DEBUGP(val) cerr << #val << \"=\" << val << \"\\n\"\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\n\nstring compact_pos(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  int delta = 0;\n  string cur;\n  REP(i, 0, n + 1) {\n    ma = max(ma, cur + s.substr(i, n));\n    if (i == n) break;\n    if (cur.size() > 0){\n      if (cur[cur.size() - 1] == 'a' && s[i] == 'b') {\n\tassert (delta > 0);\n\tcur = string(delta, 'b');\n      }\n    }\n    cur += s[i];\n    delta += s[i] == 'b' ? 1 : -1;\n  }\n  return ma;\n}\n\nstring compact_neg(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  string cur;\n  vector<bool> used(n);\n  VI ukk(n, -1);\n  VI a,b;\n  REP(i, 0, n) {\n    if (s[i]=='a') a.push_back(i);\n    else b.push_back(i);\n  }\n  REP(i, 0, a.size()) ukk[a[i]] = b[i];\n  int pos = 0;\n  REP(i, 1, n) {\n    if (used[i]) continue;\n    if (s[i] == 'b') {\n      cur += \"ab\";\n      REP(j, pos, i) {\n\tif (not used[j]) {\n\t  assert (s[j] == 'a');\n\t  used[j] = 1;\n\t  used[ukk[j]] = 1;\n\t}\n      }\n      pos = i + 1;\n    }\n  }\n  return cur;\n}\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> cand;\n  string ma = \"\";\n  int delta = 0;\n  VI zeros(1, 0);\n  REP(i, 0, 2 * n) {\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) zeros.push_back(i + 1);\n  }\n  REP(i, 0, zeros.size() - 1) {\n    int ta = zeros[i];\n    int tb = zeros[i + 1];\n    string u = s.substr(ta, tb - ta);\n    cand.push_back(u[0] == 'a' ? compact_neg(u) : compact_pos(u));\n  }\n  if (DEBUG) {\n    REP(i, 0, cand.size()) {\n      DEBUGP(cand[i]);\n    }\n  }\n  ma = \"\";\n  for (int i = (int)cand.size() - 1; i >= 0; --i) {\n    ma = max(ma, cand[i] + ma);\n  }\n  cout << ma << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll int\n#define pb push_back\n#define mp make_pair\n#define ld long double\n#define F first\n#define S second\n#define pii pair<ll,ll>\n#define pie pair<pii,ll>\nusing namespace :: std;\n\nconst ll maxn=6100;\nll dp[maxn];\nll a[maxn];\nll b[maxn];\nll o[maxn];\nstring fa(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n\n    fill(dp,dp+maxn,0);\n    for(ll i=n-2;i>=0;i--){\n        dp[i]=dp[i+1];\n        if(s[i]=='a'){\n            dp[i]=max(dp[i],1+dp[b[o[i]]]);\n        }\n    }\n    string ans;\n    for(ll i=0;i<dp[0];i++){\n        ans+=\"ab\";\n    }\n    return ans;\n}\nstring fb(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n    string maxx;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='b'){\n            string res=\"\";\n            for(ll j=i;j<n;j++){\n                if(o[j]>=o[i]){\n                    res+=s[j];\n                }\n            }\n            maxx=max(maxx,res);\n        }\n    }\n    return maxx;\n\n}\nstring dps[maxn];\nint main()\n{\n    ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n    string s;\n    ll n;\n    cin>>n>>s;\n    n*=2;\n    string last;\n    ll sum=0;\n    vector<string> vec;\n    for(ll i=0;i<n;i++){\n        last+=s[i];\n        if(s[i]=='a'){\n            sum++;\n        }else{\n            sum--;\n        }\n        if(sum==0){\n            vec.pb(last);\n            last=\"\";\n        }\n    }\n    if(last.size()>0)\n        vec.pb(last);\n    string sara;\n    vector<string> sarb;\n    for(ll i=vec.size()-1;i>=0;i--){\n        if(sarb.empty()){\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }else{\n                sara=vec[i]+sara;\n            }\n        }else{\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }\n        }\n    }\n    reverse(sarb.begin(),sarb.end());\n    for(ll i=0;i<sarb.size();i++){\n        sarb[i]=fb(sarb[i]);\n    }\n    if(sarb.size()==0){\n        cout<<fa(sara);\n        return 0;\n    }\n    dps[sarb.size()-1]=sarb.back();\n    for(ll i=(ll)sarb.size()-2;i>=0;i--){\n        dps[i]=max(dps[i+1],dps[i]+sarb[i]);\n    }\n    cout<<dps[0]<<fa(sara);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#include <cmath>\n#include <queue>\n#include <ctime>\n#include <map>\n#include <set>\n#define fi first\n#define se second\n#define pii pair<int,int>\n//#define ivorysi\n#define mp make_pair\n#define pb push_back\n#define enter putchar('\\n')\n#define space putchar(' ')\n#define MAXN 6005\nusing namespace std;\ntypedef long long int64;\ntypedef double db;\ntypedef unsigned int u32;\ntemplate<class T>\nvoid read(T &res) {\n\tres = 0;T f = 1;char c = getchar();\n\twhile(c < '0' || c > '9') {\n\t\tif(c == '-') f = -1;\n\t\tc = getchar();\n\t}\n\twhile(c >= '0' && c <= '9' ) {\n\t\tres = res * 10 - '0' + c;\n\t\tc = getchar();\n\t}\n\tres *= f;\n}\ntemplate<class T>\nvoid out(T x) {\n\tif(x < 0) {x = -x;putchar('-');}\n\tif(x >= 10) {\n\t\tout(x / 10);\n\t}\n\tputchar('0' + x % 10);\n}\nnamespace task {\n\tchar s[MAXN];\n\tint N,a[MAXN],b[MAXN],tota,totb,pos[MAXN];\n\tstring str[MAXN];\n\tbool vis[MAXN];\n\tvoid Init() {\n\t\tread(N);\n\t\tscanf(\"%s\",s + 1);\n\t\ttota = 0;totb = 0;\n\t\tfor(int i = 1 ; i <= 2 * N ; ++i) {\n\t\t\tif(s[i] == 'a') {a[++tota] = i;pos[i] = tota;}\n\t\t\telse {b[++totb] = i;pos[i] = totb;}\n\t\t}\n\t}\n\tvoid Solve() {\n\t\tstr[2 * N + 1] = \"\";\n\t\tfor(int i = 2 * N ; i >= 1 ; --i) {\n\t\t\tstr[i] = max(str[i],str[i + 1]);\n\t\t\tstring t = \"\";\n\t\t\tint p = pos[i];\n\t\t\tif(s[i] == 'a' && a[p] < b[p]) {\n\t\t\t\tstr[i] = max(str[i],\"ab\" + str[b[p] + 1]);\n\t\t\t}\n\t\t\telse if(s[i] == 'b' && b[p] < a[p]) {\n\t\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\t\tint maxv = a[p];\n\t\t\t\tfor(int j = i ; j <= maxv ; ++j) {\n\t\t\t\t\tif(s[j] == 'b') {\n\t\t\t\t\t\tp = pos[j];\n\t\t\t\t\t\tvis[b[p]] = 1;vis[a[p]] = 1;\n\t\t\t\t\t\tmaxv = max(a[p],maxv);\n\t\t\t\t\t}\n\t\t\t\t\tif(vis[j]) t += s[j];\n\t\t\t\t}\n\t\t\t\tt += str[maxv + 1];\n\t\t\t\tstr[i] = max(str[i],t);\n\t\t\t}\n\t\t}\n\t\tcout<<str[1]<<endl;\n\t}\n}\nint main() {\n#ifdef ivorysi\n\tfreopen(\"f1.in\",\"r\",stdin);\n#endif\n\ttask::Init();\n\ttask::Solve();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6010;\nint n,a[N],b[N],f[N],ans[N][N],top[N]; char s[N];\nstring tmp[N],dp[N],mx[N]; bool vis[N];\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    for(int i=1; i<=2*n; ++i)\n        if(s[i]=='a')a[++a[0]]=i;\n        else b[++b[0]]=i;\n    a[0]=b[0]=0;\n    bool flag=0;\n    for(int i=1; i<=n; ++i)\n        if(b[i]<a[i])flag=1;\n    if(!flag){\n        for(int i=1; i<=n; ++i)f[i]=1;\n        for(int i=1; i<=n; ++i)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i])f[i]=max(f[i],f[j]+1);\n        int ans=0;\n        for(int i=1; i<=n; ++i)ans=max(ans,f[i]);\n        for(int i=1; i<=ans; ++i)printf(\"ab\");\n        return 0;\n    }\n    for(int i=1; i<=n; ++i)if(b[i]<a[i]){\n        int t=a[i]; ans[i][top[i]=1]=i;\n        for(int j=i+1; j<=n; ++j){\n            if(b[j]>t)break;\n            if(b[j]<a[j]){\n                t=max(t,a[j]);\n                ans[i][++top[i]]=j;\n            }\n        }\n    }\n    for(int i=1; i<=n; ++i){\n        memset(vis,0,sizeof(vis));\n        for(int j=1; j<=top[i]; ++j)\n            vis[a[ans[i][j]]]=vis[b[ans[i][j]]]=1;\n        for(int j=1; j<=2*n; ++j)\n            if(vis[j])tmp[i]=tmp[i]+s[j];\n    }\n    for(int i=1,t=1; i<=n; ++i)if(b[i]<a[i]){\n        while(t<=n&&a[ans[t][top[t]]]<b[i])++t; --t;\n        dp[i]=max(mx[t]+tmp[i],tmp[i]);\n        mx[i]=max(mx[i-1],dp[i]); ++t;\n    }else mx[i]=mx[i-1];\n    int pos=0;\n    for(int i=1; i<=n; ++i)\n        if(dp[i]==mx[n]){\n            pos=i; break;\n        }\n    int R=a[ans[pos][top[pos]]];\n    for(int i=1; i<=n; ++i)if(a[i]>R)f[i]=1;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>R)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i]&&a[j]>R)f[i]=max(f[i],f[j]+1);\n    int res=0;\n    for(int i=1; i<=n; ++i)res=max(res,f[i]);\n    cout << mx[n]; for(int i=1; i<=res; ++i)printf(\"ab\");\n    return 0;\n}\n/*\n11\nabbbaababaababbabaabaabb\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nconst int maxn=3e3+10;\nint n,a[maxn],b[maxn],id[maxn<<1];\nchar s[maxn<<1];\nvector<string> vec;\nstring ans;\n\nint main(){\n\tscanf(\"%d%s\",&n,s);\n\tfor(int i=0,cnta=0,cntb=0,last=0;s[i];++i){\n\t\tif(s[i]=='a')\n\t\t\ta[++cnta]=i,id[i]=cnta;\n\t\telse\n\t\t\tb[++cntb]=i,id[i]=cntb;\n\t\tif(cnta==cntb){\n\t\t\tif(a[cnta]<b[cntb]){\n\t\t\t\tint cnt=1;\n\t\t\t\tfor(int j=last+2,lst=last+1;j<=cnta;++j)\n\t\t\t\t\tif(a[j]>b[lst])\n\t\t\t\t\t\t++cnt,lst=j;\n\t\t\t\tstring str;\n\t\t\t\tfor(int j=1;j<=cnt;++j){\n\t\t\t\t\tstr.push_back('a');\n\t\t\t\t\tstr.push_back('b');\n\t\t\t\t}\n\t\t\t\tvec.push_back(str);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tstring str;\n\t\t\t\tfor(int j=last+1;j<=cnta;++j){\n\t\t\t\t\tstring tmp;\n\t\t\t\t\tfor(int k=b[j];k<=a[cnta];++k)\n\t\t\t\t\t\tif(id[k]>=j)\n\t\t\t\t\t\t\ttmp.push_back(s[k]);\n\t\t\t\t\tif(tmp>str)\n\t\t\t\t\t\tstr=tmp;\n\t\t\t\t}\n\t\t\t\tvec.push_back(str);\n\t\t\t}\n\t\t\tlast=cnta;\n\t\t}\n\t}\n\tfor(int i=vec.size()-1;~i;--i)\n\t\tif(ans<vec[i]+ans)\n\t\t\tans=vec[i]+ans;\n\tcout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define LL long long\n#define fgx cerr<<\"--------------\"<<endl;\n#define dgx cerr<<\"==============\"<<endl;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nconst int MAXN = 100010;\nconst int INF = 2147483600;\n\nint N; char s[MAXN+1]; \nint vis[MAXN+1]; int pos[MAXN+1]; int p[MAXN+1];\n\ninline void prt(vector<int> &x){\n\tcout<<\"Prt:\";\n\tfor(int i=x.size()-1;i>=0;i--){\n\t\tcout<<(char)('a'+x[i]);\n\t} cout<<endl;\n}\ninline int Link(int x){ x=p[x]; return pos[(x>N/2?x-N/2:x+N/2)]; }\ninline int Cmp(vector<int> &A1,vector<int> &A2){\n\tint flag=-1;\n\tint sz1=A1.size(),sz2=A2.size();\n\tfor(int l=1;l<=min(sz1,sz2);l++){\n\t\tif(A1[sz1-l]>A2[sz2-l]) {flag=0; break;}\n\t\tif(A1[sz1-l]<A2[sz2-l]) {flag=1; break;}\n\t} return flag;\n}vector<int> Ans,Ans2;\ninline void Update(int &l1,int &r1,vector<int>& A1,int l2,int r2,vector<int>& A2,bool opr){\n\tif(!A1.size()){ A1.clear(); for(int l=0;l<(int)A2.size();l++) A1.push_back(A2[l]); l1=l2; r1=r2; return ; } \n\tint flag=Cmp(A1,A2);\n\tif(flag==-1){\n\t\tif(opr) flag=1;\n\t\telse{\n\t\t\tvector<int> n; n.clear();\n\t\t\tfor(int i=0;i<A2.size()-A1.size();i++){\n\t\t\t\tn.push_back(A2[i]);\n\t\t\t} flag=Cmp(Ans,n);\n\t\t\tif(flag) flag=1;\n\t\t}\n\t} \n\tif(flag==1){\n\t\tl1=l2; r1=r2;\n\t\tif(!opr) A1.clear();\n\t\tfor(int l=0;l<(int)A2.size();l++)\t\n\t\t\tA1.push_back(A2[l]);\n\t} return ;\n} \n\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tN=read()*2; scanf(\"%s\",s+1); int nowa=0,nowb=0;\n\tfor(int i=1;i<=N;i++){\n\t\tif(s[i]=='a') p[i]=nowa+1,++nowa;\n\t\telse p[i]=nowb+N/2+1,++nowb;\n\t\tpos[p[i]]=i;\n\t} int l1=INF,r1=INF,l2=0,r2=0; int tim=0,lastk=0;\n\tfor(int i=N;i>=1;i--){\n\t\tint k=Link(i);\n\t\tif(k<i) continue;\n\t\tvector<int> n;n.clear();\n\t\tif(s[i]=='b'){  ++tim;\n\t\t\tint j=i; n.push_back((int)s[i]-'a'); vis[k]=tim;\n\t\t\twhile(j<=k){\n\t\t\t\t++j; if(vis[j]==tim) n.push_back((int)s[j]-'a'); int to=Link(j);\n\t\t\t\tif(s[j]=='b'&&to>=j) k=to,vis[to]=tim,n.push_back(1);\n\t\t\t}\n\t\t}\n\t\tif(k!=lastk&&lastk){\n\t\t\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\t\t\tAns2.clear(); l2=0,r2=0;\n\t\t} if(n.size()){\n\t\t\treverse(n.begin(),n.end());\n\t\t\tUpdate(l2,r2,Ans2,i,k,n,0);\n\t\t} else{\n\t\t\tn.push_back(1); n.push_back(0);\n\t\t\tif(k<l1) Update(l1,r1,Ans,i,k,n,1);\n\t\t}lastk=k;\n\t} \n\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\tAns2.clear(); l2=0,r2=0;\n\tfor(int i=Ans.size()-1;i>=0;i--)\n\t\tprintf(\"%c\",(char)(Ans[i]+'a'));\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "/* be name khoda */\n\n// #define stream_enable\n#define long_enable\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <numeric>\n#include <iomanip>\n#include <sstream>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\nusing namespace std;\n\n#ifdef stream_enable\n#define cin sss\n#endif\n#ifdef long_enable\ntypedef long long int ll;\n#else\ntypedef int ll;\n#endif\n\ntypedef pair<ll, ll> pii;\ntypedef pair<pii, ll> ppi;\ntypedef pair<ll, pii> pip;\ntypedef vector<ll> vi;\ntypedef vector<pii> vpii;\n\nconst ll MOD = 1000000007;\nconst long long BIG = 1446803456761533460;\nconst int Big = 336860180;\n\n#define F first\n#define S second\n#define pb push_back\n#define eb emplace_back\n#define all(x) (x).begin(), (x).end()\n\n#define debug(x) cout << #x << \" -> \" << (x) << endl\n#define debug2(x, y) cout << #x << ' ' << #y << \" -> \" << (x) << ' ' << (y) << endl\n#define debug3(x, y, z) cout << #x << ' ' << #y << ' ' << #z << \" -> \" << (x) << ' ' << (y) << ' ' << (z) << endl\n#define debug4(x, y, z, t) cout << #x << ' ' << #y << ' ' << #z << ' ' << #t << \" -> \" << (x) << ' ' << (y) << ' ' << (z) << ' ' << (t) << endl\n#define debugp(x) cout << #x << \" -> \" << \"(\" << (x).F << \", \" << (x).S << \")\" << endl\n#define debuga(x, n) cout << #x << \" -> \"; fori (i1_da, n) { cout << (x)[i1_da] << ' '; } cout << endl\n#define debugap(x, n) cout << #x << \" ->\\n\"; fori (i1_dap, n) { cout << \"(\" << (x)[i1_dap].F << \", \" << (x)[i1_dap].S << \")\\n\"; } cout << endl\n#define debugaa(x, n, m) cout << #x << \" ->\\n\"; fori (i1_daa, n) { fori (i2_daa, m) { cout << (x)[i1_daa][i2_daa] << ' '; } cout << '\\n'; } cout << endl\n#define debugav(x, n) cout << #x << \" ->\\n\"; fori (i1_dav, n) { fori (i2_dav, (x)[i1_dav].size()) { cout << (x)[i1_dav][i2_dav] << ' '; } cout << '\\n'; } cout << endl\n#define debugia(x, n) cout << #x << \" ->\\n\"; fori (i1_dia, n) { cout << i1_dia << \" : \" << (x)[i1_dia] << '\\n'; } cout << endl\n\n#define forifrom(i, s, n) for(ll i = (s); i < (n); ++i)\n#define forirto(i, n, e) for(ll i = (n) - 1; i >= (e); --i)\n#define fori(i, n) forifrom (i, 0, n)\n#define forir(i, n) forirto (i, n, 0)\n\n#define smin(a, b) a = min(a, (b))\n#define smax(a, b) a = max(a, (b))\n\n#define Add(a, b) a = (a + (b)) % MOD\n#define Mul(a, b) a = (a * (b)) % MOD\n\nstringstream sss;\n\n// -----------------------------------------------------------------------\n\nconst ll maxn = 3010;\n\ntypedef vector<pair<ll, char>> vpic;\n\nll n;\nstring S;\npii ab[maxn];\nvpic str;\n\nbool cmp(vpic &a, vpic &b) {\n    ll m = a.size();\n    fori (i, m) {\n        if (a[i].S > b[i].S) return false;\n        else if (a[i].S < b[i].S) return true;\n    }\n    return true;\n}\n\nvoid print(vpic &x) {\n    for (auto c : x) cout << c.S;\n    cout << '\\n';\n}\n\nvoid MAIN() {\n\n    cin >> n >> S;\n    ll ia = 0, ib = 0;\n    fori (i, n * 2) {\n        if (S[i] == 'a') {\n            ab[ia++].F = i;\n        } else {\n            ab[ib++].S = i;\n        }\n    }\n    forir (i, n) {\n        vpic str2(str);\n        str2.insert(lower_bound(all(str2), make_pair(ab[i].F, 'a')), {ab[i].F, 'a'});\n        str2.insert(lower_bound(all(str2), make_pair(ab[i].S, 'b')), {ab[i].S, 'b'});\n        if (cmp(str, str2)) str = str2;\n    }\n    print(str);\n\n}\n\n// -----------------------------------------------------------------------\n\nint main() {\n    ios_base::sync_with_stdio(false), cin.tie(0), cout.tie(0);\n    cout << fixed << setprecision(10);\n    sss << R\"(\n3\naababb\n\n9\nabbbaababaababbaba\n    )\";\n    MAIN();\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int MAXN = 3010;\n\ntypedef std::bitset<MAXN> B;\nchar arr[MAXN << 1];\nint n, L[MAXN], R[MAXN], cr[MAXN << 1];\nvoid decode(B t, char * dst) {\n\tfor (int i = 1; i <= n * 2; ++i)\n\t\tif (t.test(cr[i]))\n\t\t\t*dst++ = arr[i];\n\t*dst = 0;\n}\nbool cmp(B src, B dst) {\n\tstatic char s1[MAXN << 1], s2[MAXN << 1];\n\tdecode(src, s1); decode(dst, s2);\n\treturn strcmp(s1, s2) < 0;\n}\nvoid getmax(B & a, B b) { cmp(a, b) ? (a = b, 0) : 0; }\nB dp[MAXN];\n\nint main() {\n\tstd::ios_base::sync_with_stdio(false), std::cin.tie(0);\n\tstd::cin >> n >> arr + 1;\n\tfor (int i = 1, ta = 0, tb = 0; i <= n * 2; ++i)\n\t\tarr[i] == 'a' ? L[++ta] = i : R[++tb] = i;\n\tfor (int i = 1; i <= n; ++i) cr[L[i]] = i;\n\tfor (int i = 1; i <= n; ++i) cr[R[i]] = i;\n\tfor (int i = n; i; --i) {\n\t\tstatic B t;\n\t\tdp[i] = dp[i + 1];\n\t\tif (L[i] < R[i]) {\n\t\t\tint r = *std::max_element(cr + L[i], cr + R[i] + 1);\n\t\t\t(t = dp[r + 1]).set(i);\n\t\t\tgetmax(dp[i], t);\n\t\t} else {\n\t\t\tt.reset();\n\t\t\tfor (int j = R[i]; j <= L[i]; ++j)\n\t\t\t\tif (arr[j] == 'b') t.set(cr[j]);\n\t\t\tint r = *std::max_element(cr + R[i], cr + L[i] + 1);\n\t\t\tgetmax(dp[i], t | dp[r + 1]);\n\t\t}\n\t}\n\tdecode(dp[1], arr);\n\tstd::cout << arr << std::endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define bb(L,R) (preb[R]-preb[L-1])\n#define pz system(\"pause\")\nusing namespace std;\nint N;\nint preb[6010];\nint oca[6010],ocb[6010],act,bct,last;\nint anum[6010],bnum[6010];\nchar a[6010];\nint gcnt;\nint tog[6010];\nstring * go[6010];\nstring ans;\nstring f[6010];\nstruct pstr{\n    string *s;\n    int id;\n}P[60010];\nbool cmp(pstr a,pstr b) {\n    if(*(a.s)!=*(b.s)) return *(a.s)>*(b.s);\n    else return a.id<b.id;\n}\nstring * do_b_max(int L,int R) {\n    //printf(\"\\tdo_b_max in [%d,%d]\\n\",L,R);\n    string *ret=new string;\n    for(int i=L;i<=R;++i) tog[i]=0;\n    for(int i=L;i<=R;++i) {\n        if(a[i]=='b') {\n            *ret+=a[i];\n            tog[oca[bnum[i]]]=true;\n        } else if(tog[i]) {\n            *ret+=a[i];\n        }\n    }\n    //cout<<\"\\t\"<<*ret<<endl;\n    return ret;\n}\nvoid solve(int L,int R,bool flag) {//flag==true a first else b first\n    //printf(\"\\tsolve [%d,%d] flag=%d\\n\",L,R,(int)(flag));\n\t++gcnt;\n\tgo[gcnt]=new string;\n\tstring &ret=*go[gcnt];\n\tif(flag) {\n        int now=L;\n        while(now<=R) {\n                            //printf(\"prenow=%d\\n\",now);\n            if(a[now]!='a') {\n                ++now;\n                continue;\n            }\n            //printf(\"now=%d\\n\",now);\n            ret+=\"ab\";\n            int t=anum[now];\n            now=ocb[t]+1;\n            //printf(\"nxtnow=%d\\n\",now);\n        }\n       // cout<<\"\\t\"<<ret<<endl;\n        return;\n\t} else {\n        int maxb=0;\n        for(int i=L;i<=R;++i) if(a[i]=='b'){\n            if(bb(i,oca[bnum[i]])>maxb) {\n                maxb=bb(i,oca[bnum[i]]);\n            }\n        }\n        //printf(\"\\tmaxb=%d\\n\",maxb);\n        for(int i=L;i<=R;++i) if(a[i]=='b'&&bb(i,oca[bnum[i]])==maxb) {\n            string *tmp=do_b_max(i,R);\n            if(*tmp>*go[gcnt]) {\n                delete go[gcnt];\n                go[gcnt]=tmp;\n            }\n            else delete tmp;\n        }\n\t}\n\t//printf(\"\\tto_solve [%d,%d] flag=%d\\n\",L,R,(int)(flag));\n    //cerr<<\"\\t\"<<*go[gcnt]<<endl;\n}\nint main() {\n\tscanf(\"%d\",&N);\n\tscanf(\"%s\",a+1);\n\tfor(int i=1;i<=2*N;++i) {\n        preb[i]=preb[i-1]+(a[i]=='b');\n\t\tif(a[i]=='a') oca[++act]=i,anum[i]=act;\n\t\telse ocb[++bct]=i,bnum[i]=bct;\n\t\tif(act==bct) {\n\t\t\tint t=last+1;last=i;\n\t\t\t//if(oca[act]<ocb[bct]) puts(\"~\");\n\t\t\tsolve(t,last,oca[act]<ocb[bct]);\n\t\t}\n\t}\n//    for(int i=1;i<=2*N;++i) printf(\"%d \",oca[i]);puts(\"\");\n//    for(int i=1;i<=2*N;++i) printf(\"%d \",ocb[i]);puts(\"\");\n//    for(int i=1;i<=2*N;++i) printf(\"%d \",anum[i]);puts(\"\");\n//    for(int i=1;i<=2*N;++i) printf(\"%d \",bnum[i]);puts(\"\");\n\n    for(int i=1;i<=gcnt;++i) {\n        P[i].s=go[i];\n        P[i].id=i;\n        //cerr<<*P[i].s<<endl;\n    }\n//    sort(P+1,P+gcnt+1,cmp);\n//        for(int i=1;i<=gcnt;++i) {\n//        cout<<*P[i].s<<endl;\n//    }\n//    ans=*(P[1].s);\n//    int up=P[1].id;\n//    for(int i=2;i<=gcnt;++i) {\n//        if(P[i].id>up) {\n//            ans+=*(P[i].s);\n//            up=P[i].id;\n//        }\n//    }\n//cerr<<\"Yessssssssss\"<<endl;\n    ans=f[1]=*P[1].s;\n    for(int i=2;i<=gcnt;++i) {\n        f[i]=*P[i].s;\n        for(int j=1;j<i;++j) {\n            string t=f[j]+(*P[i].s);\n            if(f[i]<t) f[i]=t;\n        }\n\n\n        if(f[i]>ans) ans=f[i];\n        //cerr<<i<<\" \"<<f[i]<<endl;\n    }\n    cout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=4e3+5;\nstring dp[maxn<<1];\nchar s[maxn<<1];\nint a[maxn],b[maxn],n,A,B,t[maxn<<1],p,fi[maxn<<1];\nint cnt,group[maxn<<1];\nstring ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=2*n;i++){\n\t\tif (s[i]=='a'){\n\t\t\ta[++A]=i;\n\t\t\tt[i]=A;\n\t\t\tcnt++;\n\t\t}else{\n\t\t\tb[++B]=i;\n\t\t\tt[i]=B;\n\t\t\tcnt--;\n\t\t}\n\t\tgroup[i]=p;\n\t\tif (cnt==0)\n\t\t\tfi[++p]=i+1;\n\t}\n\tfi[++p]=n*2+1;\n\tfor (int i=2*n;i>=1;i--){\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi != i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tstring S=\"\";\n\t\t\tfor (int j = i;group[j] == group[i];j++){\n\t\t\t\tif (b[t[j]] >= i)\n\t\t\t\t\tS+=s[j];\n\t\t\t}\n\t\t\tS+=dp[fi[group[i]+1]];\n\t\t\tdp[i]=max(S,ans);\n\t\t}else{\n\t\t\tdp[i]=max(\"ab\"+dp[b[t[i]]+1],ans);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tfor (int i=0;i<ans.size();i++){\n\t\tif (ans[i]!='a'&&ans[i]!='b')\n\t\t\tbreak;\n\t\tcout << ans[i];\n\t}\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n//    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6010;\nint n,a[N],b[N],f[N],ans[N][N],top[N]; char s[N];\nstring tmp[N],dp[N],mx[N]; bool vis[N];\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    for(int i=1; i<=2*n; ++i)\n        if(s[i]=='a')a[++a[0]]=i;\n        else b[++b[0]]=i;\n    a[0]=b[0]=0;\n    bool flag=0;\n    for(int i=1; i<=n; ++i)\n        if(b[i]<a[i])flag=1;\n    if(!flag){\n        for(int i=1; i<=n; ++i)f[i]=1;\n        for(int i=1; i<=n; ++i)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i])f[i]=max(f[i],f[j]+1);\n        int ans=0;\n        for(int i=1; i<=n; ++i)ans=max(ans,f[i]);\n        for(int i=1; i<=ans; ++i)printf(\"ab\");\n        return 0;\n    }\n    for(int i=1; i<=n; ++i)if(b[i]<a[i]){\n        int t=a[i]; ans[i][top[i]=1]=i;\n        for(int j=i+1; j<=n; ++j){\n            if(b[j]>t)break;\n            if(b[j]<a[j]){\n                t=max(t,a[j]);\n                ans[i][++top[i]]=j;\n            }\n        }\n    }\n    for(int i=1; i<=n; ++i){\n        memset(vis,0,sizeof(vis));\n        for(int j=1; j<=top[i]; ++j)\n            vis[a[ans[i][j]]]=vis[b[ans[i][j]]]=1;\n        for(int j=1; j<=2*n; ++j)\n            if(vis[j])tmp[i]=tmp[i]+s[j];\n    }\n    for(int i=1,t=1; i<=n; ++i)if(b[i]<a[i]){\n        while(t<=n&&a[ans[t][top[t]]]<b[i])++t; --t;\n        dp[i]=mx[t]+tmp[i];\n        mx[i]=max(mx[i-1],dp[i]); ++t;\n    }else mx[i]=mx[i-1];\n    int pos=0;\n    for(int i=1; i<=n; ++i)\n        if(dp[i]==mx[n]){\n            pos=i; break;\n        }\n    int R=a[ans[pos][top[pos]]];\n    for(int i=1; i<=n; ++i)if(a[i]>R)f[i]=1;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>R)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i]&&a[j]>R)f[i]=max(f[i],f[j]+1);\n    int res=0;\n    for(int i=1; i<=n; ++i)res=max(res,f[i]);\n    cout << mx[n]; for(int i=1; i<=res; ++i)printf(\"ab\");\n    return 0;\n}\n/*\n11\nabbbaababaababbabaabaabb\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                //cout << pp << endl;\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw) continue;\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\tint lenx=strlen(x+1),leny=strlen(y+1);\n\tif (lenx>leny) swap(x,y),swap(lenx,leny);\n\tif (leny%lenx==0)\n\t{\n\t\tbool flag=1;\n\t\tfor (int i=1;i<=leny;i++)\n\t\t\tif (x[(i-1)%lenx+1]!=y[i]) { flag=0; break; }\n\t\tif (flag) return 2;\n\t}\n\tint len=max(strlen(x+1),strlen(y+1));\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\n\nint compare(char *x,char *y,int len)\n{\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t],len)==1)\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n20\nba ab bbabaa bbbabbabbabbaaaaaa aabb aabababb\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nclock_t t=clock();\nnamespace my_std{\n\tusing namespace std;\n\t#define pii pair<int,int>\n\t#define fir first\n\t#define sec second\n\t#define MP make_pair\n\t#define rep(i,x,y) for (int i=(x);i<=(y);i++)\n\t#define drep(i,x,y) for (int i=(x);i>=(y);i--)\n\t#define go(x) for (int i=head[x];i;i=edge[i].nxt)\n\t#define templ template<typename T>\n\t#define sz 6300\n\ttypedef long long ll;\n\ttypedef double db;\n\tmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ttempl inline T rnd(T l,T r) {return uniform_int_distribution<T>(l,r)(rng);}\n\ttempl inline bool chkmax(T &x,T y){return x<y?x=y,1:0;}\n\ttempl inline bool chkmin(T &x,T y){return x>y?x=y,1:0;}\n\ttempl inline void read(T& t)\n\t{\n\t\tt=0;char f=0,ch=getchar();double d=0.1;\n\t\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\t\twhile(ch<='9'&&ch>='0') t=t*10+ch-48,ch=getchar();\n\t\tif(ch=='.'){ch=getchar();while(ch<='9'&&ch>='0') t+=d*(ch^48),d*=0.1,ch=getchar();}\n\t\tt=(f?-t:t);\n\t}\n\ttemplate<typename T,typename... Args>inline void read(T& t,Args&... args){read(t); read(args...);}\n\tchar __sr[1<<21],__z[20];int __C=-1,__zz=0;\n\tinline void Ot(){fwrite(__sr,1,__C+1,stdout),__C=-1;}\n\tinline void print(register int x)\n\t{\n\t\tif(__C>1<<20)Ot();if(x<0)__sr[++__C]='-',x=-x;\n\t\twhile(__z[++__zz]=x%10+48,x/=10);\n\t\twhile(__sr[++__C]=__z[__zz],--__zz);__sr[++__C]='\\n';\n\t}\n\tvoid file()\n\t{\n\t\t#ifdef NTFOrz\n\t\tfreopen(\"a.in\",\"r\",stdin);\n\t\t#endif\n\t}\n\tinline void chktime()\n\t{\n\t\t#ifdef NTFOrz\n\t\tcout<<(clock()-t)/1000.0<<'\\n';\n\t\t#endif\n\t}\n\t#ifdef mod\n\tll ksm(ll x,int y){ll ret=1;for (;y;y>>=1,x=x*x%mod) if (y&1) ret=ret*x%mod;return ret;}\n\tll inv(ll x){return ksm(x,mod-2);}\n\t#else\n\tll ksm(ll x,int y){ll ret=1;for (;y;y>>=1,x=x*x) if (y&1) ret=ret*x;return ret;}\n\t#endif\n//\tinline ll mul(ll a,ll b){ll d=(ll)(a*(double)b/mod+0.5);ll ret=a*b-d*mod;if (ret<0) ret+=mod;return ret;}\n}\nusing namespace my_std;\n\nint n;\nchar a[sz];\nint p1[sz],p2[sz],c1,c2;\n\nstring s[sz],dp[sz];\nint link[sz],to[sz];\n\nint book[sz],T;\n\nint main()\n{\n\tfile();\n\tread(n);n*=2;\n\tcin>>(a+1);\n\trep(i,1,n) if (a[i]=='a') p1[++c1]=i; else p2[++c2]=i;\n\trep(i,1,n>>1) link[min(p1[i],p2[i])]=max(p1[i],p2[i]);\n\trep(i,1,n) if (link[i])\n\t{\n\t\tif (a[i]=='a') { s[i]=\"ab\",to[i]=link[i]; continue; }\n\t\t++T;book[i]=book[link[i]]=T;int R=link[i];\n\t\trep(j,i,R) if (link[j]) book[j]=book[R=link[j]]=T;\n\t\trep(j,i,R) if (book[j]==T) s[i]+=a[j];\n\t\tto[i]=R;\n\t}\n\tdrep(i,n,1)\n\t{\n\t\tdp[i]=dp[i+1];\n\t\tif (link[i]) chkmax(dp[i],s[i]+dp[to[i]+1]);\n\t}\n\tcout<<dp[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[60003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2*n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string ans;\n  vector<int> cind;\n  for (int i = n - 1; i >= 0; i--) {\n    string cand = ans;\n    vector<int> candcind = cind;\n    {\n      int pos = b[i];\n      auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n      cand.insert(cand.begin() + (insind - candcind.begin()), 'b');\n      candcind.insert(insind, pos);\n    }\n    {\n      int pos = a[i];\n      auto insind = lower_bound(candcind.begin(), candcind.end(), pos);\n      cand.insert(cand.begin() + (insind - candcind.begin()), 'a');\n      candcind.insert(insind, pos);\n    }\n    if (cand > ans) {\n      ans = move(cand);\n      cind = move(candcind);\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N;\nstring S;\n\nint X[3333],Y[3333];\nint Z[6666];\n\nsigned main(){\n    cin>>N;\n    cin>>S;\n\n    int uku=0,ushi=0;\n    rep(i,S.size()){\n        if(S[i]=='a'){\n            Z[i]=uku;\n            X[uku++]=i;\n        }\n        else{\n            Z[i]=ushi;\n            Y[ushi++]=i;\n        }\n    }\n\n    vector<string>st;\n    int cur=0;\n    while(cur<N){\n        int nex=cur+1;\n        while(nex<N&&max(X[nex-1],Y[nex-1])>min(X[nex],Y[nex]))nex++;\n        if(X[cur]<Y[cur]){//ab\n            string s;\n            int pre=-1;\n            for(int i=cur;i<nex;i++){\n                if(X[i]<pre)continue;\n                s+=\"ab\";\n                pre=Y[i];\n            }\n            st.pb(s);\n        }\n        else{//ba\n            string s=\"\";\n            for(int i=cur;i<nex;i++){\n                string t;\n                rep(j,S.size())if(i<=Z[j]&&Z[j]<nex)t+=S[j];\n                chmax(s,t);\n            }\n            while(st.size()&&st.back()<s)st.pop_back();\n            st.pb(s);\n        }\n        cur=nex;\n    }\n\n    string ans;\n    rep(i,st.size())ans+=st[i];\n    cout<<ans<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "    #include<bits/stdc++.h>\n    using namespace std;\n    #define vi vector<int>\n    #define pii pair<int,int>\n    #define vp  vector<pii>\n    #define fi first\n    #define se second\n    #define mp make_pair\n    #define pb push_back\n    #define ls l,mid,rt<<1\n    #define rs mid+1,r,rt<<1|1\n    #define de(x) cout<< #x<<\" = \"<<x<<endl\n    #define dd(x) cout<< #x<<\" = \"<<x<<\" \"\n    #define sf scanf\n    #define pf printf\n    #define all(x) (x).begin(),(x).end()\n    #define SZ(x) ((int)(x).size())\n    #define rep(i,a,n) for (int i=a;i<n;i++)\n    #define per(i,a,n) for (int i=n-1;i>=a;i--)\n    typedef long long ll;\n    typedef unsigned long long ull;\n    //typedef __int128 INT128;\n    //INT128 read(){\n    //    INT128 x=0,f=1;\n    //    char ch=getchar();\n    //    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    //    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n    //    return x*f;\n    //}\n    //void write(INT128 x){\n    //    if(x<0){putchar('-');x=-x;}\n    //    if(x<10){putchar(x+'0'); return;}\n    //    write(x/10);putchar(x%10+'0');\n    //}\n    typedef long double ld;\n    const int INF=0x3f3f3f3f;\n    const double eps=1e-8;\n    const double PI=acos(-1.0);\n    const int MAXN=1e5+5;\n    const int MAXM=2e6+5;\n    const int MOD=1e9+7;\n    int sgn(double x){if(fabs(x)<eps)return 0;if(x<0)return -1;else return 1;}\n    ll pw(ll a,ll n,ll mod){ll ret=1;while(n){if(n&1)ret=ret*a%mod;a=a*a%mod;n>>=1;}return ret;}\n    ll gcd(ll a,ll b){return b==0?a:gcd(b,a%b);}\n    ll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n    void inc(ll &a,ll b){a+=b;if(a>=MOD)a-=MOD;}\n    void dec(ll &a,ll b){a-=b;if(a<0)a+=MOD;}\n    int mul(int x, int y){ll z=1ll*x*y;return z-z/MOD*MOD;}\n    //head\n     \n    int n,ta,tb,pos_a[MAXN],pos_b[MAXN],pos[MAXN];\n    string s,ans,dp[MAXN];\n    int main(){\n        cin>>n>>s; ta=tb=0;\n        rep(i,0,2*n){\n            if(s[i]=='a')pos_a[++ta]=i,pos[i]=ta;\n            else pos_b[++tb]=i,pos[i]=tb;\n        }\n        per(i,1,n+1){\n            if(pos_a[i]<pos_b[i]){\n                int k=i;\n                rep(j,pos_a[i]+1,pos_b[i])k=max(k,pos[j]);\n                dp[i]=\"ab\"+dp[k+1];\n            }else{\n                int k=i;\n                while(k<n&&pos_b[k+1]<pos_a[k])k++;\n                rep(j,pos_b[i],2*n)if(pos[j]>=i&&pos[j]<=k)dp[i]+=s[j];\n                //de(k);\n                dp[i]+=dp[k+1];\n            }\n            //dd(i); de(dp[i]);\n            dp[i]=max(dp[i],dp[i+1]);\n            ans=max(ans,dp[i]);\n        }\n        cout<<ans<<endl;\n    }\n"
  },
  {
    "language": "C++",
    "code": "/*\n    _____\n  .'     '.\n /  0   0  \\\n|     ^     |\n|  \\     /  |\n \\  '---'  /\n  '._____.'\n*/\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\nstruct chash\n{\n\tint operator()(int x) const\n\t{\n\t\tx ^= (x >> 20) ^ (x >> 12);\n\t\treturn x ^ (x >> 7) ^ (x >> 4);\n\t}\n};\n\ntemplate<typename T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename U> using hashtable = gp_hash_table<T, U, chash>;\nrandom_device(rd);\nmt19937 rng(rd());\n\ntemplate<class T>\nvoid readi(T &x)\n{\n\tT input = 0;\n\tbool negative = false;\n\tchar c = ' ';\n\twhile (c < '-')\n\t{\n\t\tc = getchar();\n\t}\n\tif (c == '-')\n\t{\n\t\tnegative = true;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0')\n\t{\n\t\tinput = input * 10 + (c - '0');\n\t\tc = getchar();\n\t}\n\tif (negative)\n\t{\n\t\tinput = -input;\n\t}\n\tx = input;\n}\ntemplate<class T>\nvoid printi(T output)\n{\n\tif (output == 0)\n\t{\n\t\tputchar('0');\n\t\treturn;\n\t}\n\tif (output < 0)\n\t{\n\t\tputchar('-');\n\t\toutput = -output;\n\t}\n\tint aout[20];\n\tint ilen = 0;\n\twhile(output)\n\t{\n\t\taout[ilen] = ((output % 10));\n\t\toutput /= 10;\n\t\tilen++;\n\t}\n\tfor (int i = ilen - 1; i >= 0; i--)\n\t{\n\t\tputchar(aout[i] + '0');\n\t}\n\treturn;\n}\ntemplate<class T>\nvoid ckmin(T &a, T b)\n{\n\ta = min(a, b);\n}\ntemplate<class T>\nvoid ckmax(T &a, T b)\n{\n\ta = max(a, b);\n}\ntemplate<class T, class U>\nT nmod(T &x, U mod)\n{\n\tif (x >= mod) x -= mod;\n}\ntemplate<class T>\nT randomize(T mod)\n{\n\treturn (uniform_int_distribution<T>(0, mod - 1))(rng);\n}\n\n#define y0 ___y0\n#define y1 ___y1\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define PF push_front\n#define LB lower_bound\n#define UB upper_bound\n#define fi first\n#define se second\n#define debug(x) cerr << #x << \" = \" << x << endl;\n\nconst long double PI = 4.0 * atan(1.0);\nconst long double EPS = 1e-10;\n\n#define MAGIC 347\n#define SINF 10007\n#define CO 1000007\n#define INF 1000000007\n#define BIG 1000000931\n#define LARGE 1696969696967ll\n#define GIANT 2564008813937411ll\n#define LLINF 2696969696969696969ll\n#define MAXN 6013\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ld, ld> pdd;\n\nint N, K;\nint arr[MAXN], pref[MAXN];\nint blocks[MAXN];\nint partner[MAXN];\nbitset<MAXN> typ;\nvector<pii> idx[MAXN];\nvector<bool> dp[MAXN];\nvector<bool> ans;\nbitset<MAXN> flag;\n\nbool operator < (const vector<bool> &a, const vector<bool> &b)\n{\n\tfor (int i = 0; i < min(a.size(), b.size()); i++)\n\t{\n\t\tif (a[i] != b[i])\n\t\t{\n\t\t\treturn a[i] < b[i];\n\t\t}\n\t}\n\treturn (a.size() < b.size());\n}\nbool operator > (const vector<bool> &a, const vector<bool> &b)\n{\n\treturn b < a;\n}\n\nint32_t main()\n{\n\tios_base::sync_with_stdio(0);\n\t// cout << fixed << setprecision(10);\n\t// cerr << fixed << setprecision(10);\n\t// freopen (\"file.in\", \"r\", stdin);\n\t// freopen (\"file.out\", \"w\", stdout);\n\tcin >> N;\n\tN *= 2;\n\tstring temps;\n\tcin >> temps;\n\tfor (int i = 0; i < N; i++)\n\t{\n\t\tarr[i] = (temps[i] == 'a' ? 1 : -1);\n\t\tpref[i + 1] = pref[i] + arr[i];\n\t}\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tif (pref[i] == 0)\n\t\t{\n\t\t\tK++;\n\t\t\tblocks[K] = i - 1;\n\t\t}\n\t}\n\tblocks[0] = -1;\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tidx[i].resize((rt - lt + 1) / 2);\n\t\tint iter = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == 1)\n\t\t\t{\n\t\t\t\tidx[i][iter].fi = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\titer = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == -1)\n\t\t\t{\n\t\t\t\tidx[i][iter].se = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\t// cerr << \"block \" << i << endl;\n\t\tfor (pii p : idx[i])\n\t\t{\n\t\t\tpartner[p.fi] = p.se;\n\t\t\tpartner[p.se] = p.fi;\n\t\t\t// cerr << p.fi << ' ' << p.se << endl;\n\t\t}\n\t\ttyp[i] = (bool) (idx[i][0].fi > idx[i][0].se);\n\t}\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t//if typ[i] is true, it's abababababab\n\t\t//if typ[i] is false, it's babababababa\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tif (typ[i])\n\t\t{\n\t\t\t//babababa\n\t\t\tvector<bool> temp;\n\t\t\tfor (int j = idx[i].size() - 1; j >= 0; j--)\n\t\t\t{\n\t\t\t\tflag[idx[i][j].fi] = true;\n\t\t\t\tflag[idx[i][j].se] = true;\n\t\t\t\ttemp.clear();\n\t\t\t\tfor (int k = lt; k <= rt; k++)\n\t\t\t\t{\n\t\t\t\t\tif (flag[k])\n\t\t\t\t\t{\n\t\t\t\t\t\ttemp.PB(arr[k] - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (temp > dp[i])\n\t\t\t\t{\n\t\t\t\t\tdp[i] = temp;\n\t\t\t\t}\n\t\t\t\t// for (bool b : dp[i])\n\t\t\t\t// {\n\t\t\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t\t\t// }\n\t\t\t\t// cerr << endl;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//ababababab\n\t\t\tfor (int j = lt; j <= rt;)\n\t\t\t{\n\t\t\t\tdp[i].PB(0);\n\t\t\t\tdp[i].PB(1);\n\t\t\t\tj = partner[j];\n\t\t\t\tauto it = UB(idx[i].begin(), idx[i].end(), MP(j + 1, -INF));\n\t\t\t\tif (it == idx[i].end()) break;\n\t\t\t\tj = it -> fi;\n\t\t\t}\n\t\t}\n\t}\n\t// cerr << \"our dps\\n\";\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t// for (bool b : dp[i])\n\t\t// {\n\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t// }\n\t\t// cerr << endl;\n\t\tbool used = true;\n\t\tfor (int j = i + 1; j <= K; j++)\n\t\t{\n\t\t\tif (dp[j] > dp[i])\n\t\t\t{\n\t\t\t\tused = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (used)\n\t\t{\n\t\t\tfor (bool b : dp[i])\n\t\t\t{\n\t\t\t\tans.PB(b);\n\t\t\t}\n\t\t}\n\t}\n\tfor (bool b : ans)\n\t{\n\t\tcout << (b ? 'b' : 'a');\n\t}\n\tcout << '\\n';\n\t// cerr << \"time elapsed = \" << (clock() / (CLOCKS_PER_SEC / 1000)) << \" ms\" << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>2][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nbool compare(char *x,char *y)\n{\n\tint len=max(strlen(x+1),strlen(y+1));\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 0;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\t\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t]))\n\t\t\t{\t\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=' ';\n\t\t\t}\n\t\t}\n\t}\n}\nint compareid(int x,int y) { return compare(ST[x],ST[y]); } \nint main()\n{\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nusing namespace std;\ntemplate<class T> void read(T &x)\n{\n    x=0; int f=1,ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=x*10-'0'+ch;ch=getchar();}\n    x*=f;\n}\ntemplate<class T> inline bool Cmax(T &x,T y) {return x<y?x=y,1:0;}\nconst int maxn=3000+50;\nint n;\nint a[maxn],b[maxn],bel[maxn<<1];\nchar s[maxn<<1];\nstring an;\nvoid sol(int L,int R)\n{\n    string re;\n    int l=1; while(a[l]<L) ++l;\n    int r=n; while(a[r]>R) --r;\n    if(s[L]=='a')\n    {\n        int cnt=1,k=l;\n        for(int i=l;i<=r;++i)\n        {\n            if(a[i]>b[k]) ++cnt,k=i;\n        }\n        while(cnt--) re.push_back('a'),re.push_back('b');\n    }\n    else\n    {\n        for(int i=l;i<=r;++i)\n        {\n            string now; \n            for(int j=b[i];j<=R;++j) if(bel[j]>=i) now.push_back(s[j]);\n            Cmax(re,now);\n        }\n    }\n    // cerr<<L<<' '<<R<<' '<<l<<' '<<r<<' '<<re<<endl;\n    if(re+an>an) an=re+an;\n}\nint main()\n{\n    read(n);\n    scanf(\"%s\",s+1);\n    for(int i=1,x=0,y=0;i<=(n<<1);++i)\n    {\n        if(s[i]=='a') a[++x]=i,bel[i]=x;\n        else b[++y]=i,bel[i]=y;\n    }\n    for(int i=(n<<1),cnt=0,las=(n<<1);i>=1;--i)\n    {\n        if(s[i]=='a') ++cnt; else --cnt;\n        if(cnt==0)\n        {\n            sol(i,las);\n            las=i-1;\n        }\n    }\n    cout<<an<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int MAX = 6005;\nint go[MAX];\nint label[MAX];\nvector<int> used[MAX];\nstring res[MAX];\nint n;\nstring s;\nvector<pair<int, int>> vals;\nstring construct(int loc){\n    vector<int> cur;\n    for(int x: used[loc]) cur.push_back(vals[x].first), cur.push_back(vals[x].second);\n    sort(cur.begin(), cur.end());\n    assert(cur.back() < 2 * n);\n    string ret = \"\";\n    for(int x: cur) ret += s[x];\n    return ret;\n}\nvoid solve(int loc){\n    int st = vals[loc].first, ed = vals[loc].second;\n    used[loc].push_back(loc);\n    for(int i = st + 1; i < ed; i++){\n        if(go[i] < i) continue;\n        if(s[st] == 'a'){\n            continue;\n        }\n        else{\n            used[loc].push_back(label[i]);\n        }\n    }\n    string use = \"\";\n    for(int i = 0; i < 2 * n; i++) use += 'a';\n    vector<int> best;\n    for(int x: used[loc]) best.push_back(x);\n    for(int i = ed + 1; i < 2 * n; i++){\n        if(go[i] < i) continue;\n        vector<int> cur;\n        vector<int> tmp;\n        for(int x: used[loc]) cur.push_back(vals[x].first), cur.push_back(vals[x].second), tmp.push_back(x);\n        for(int x: used[label[i]]) cur.push_back(vals[x].first), cur.push_back(vals[x].second), tmp.push_back(x);\n        sort(cur.begin(), cur.end());\n        string fin = \"\";\n        for(int x: cur) fin += s[x];\n        if(fin > use){\n            use = fin;\n            swap(tmp, best);\n        }\n    }\n    swap(best, used[loc]);\n}\nint main(){\n    ios_base::sync_with_stdio(0); cin.tie(0);\n    cin >> n >> s;\n    int it1 = 0, it2 = 0;\n    while(it1 != 2 * n && it2 != 2 * n){\n        while(s[it1] != 'a') it1++;\n        while(s[it2] != 'b') it2++;\n        vals.emplace_back(min(it1, it2), max(it1, it2));\n        go[it1] = it2, go[it2] = it1;\n        it1++, it2++;\n    }\n    sort(vals.begin(), vals.end());\n    for(int i = 0; i < n; i++){\n        label[vals[i].first] = i;\n        label[vals[i].second] = i;\n    }\n    string ans = \"a\";\n    for(int i = n - 1; i >= 0; i--){\n        solve(i);\n        if(construct(i) > ans){\n            ans = construct(i);\n        }\n    }\n    cout << ans << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main() {\n\tint n; string s;\n\tcin >> n >> s;\n\tvector<int> a(n), b(n);\n\tint ca = 0, cb = 0;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') a[ca++] = i;\n\t\tif (s[i] == 'b') b[cb++] = i;\n\t}\n\tstring ans;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tvector<int> st;\n\t\tfor (int j = 0; j < n; ++j) {\n\t\t\tif (b[j] >= i && a[j] > b[j]) {\n\t\t\t\tst.push_back(a[j]);\n\t\t\t\tst.push_back(b[j]);\n\t\t\t}\n\t\t}\n\t\tsort(st.begin(), st.end());\n\t\tstring sub;\n\t\tfor (int j : st) {\n\t\t\tsub += s[j];\n\t\t}\n\t\tint ptr = (st.empty() ? i : st.back());\n\t\tfor (int j = ptr; j < n; ++j) {\n\t\t\tif (a[j] >= ptr) {\n\t\t\t\tsub += \"ab\";\n\t\t\t\tptr = b[j] + 1;\n\t\t\t}\n\t\t}\n\t\tans = max(ans, sub);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    for(LL i=1;i<=N;++i) a[i]=1;\n//    for(LL i=1;i<=2*n;++i) a[i]=(s[i]-'a');\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]-'a');\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n      \n#define FOR(i,a,b) for(ll i = (a); i < (ll)(b); i++)\n#define REP(i,n) FOR(i,0,n)\n#define YYS(x,arr) for(auto& x:arr)\n#define PW(x) (1LL<<(x))\n#define SZ(x) ((ll)(x).size())\n\n#define pb emplace_back\n#define fi first\n#define se second\n\nusing namespace std;\n\nusing ld = long double;\nusing ll = long long int;\n\nconst ll INF = (ll)1e9 + 10;\nconst ll INFLL = (ll)1e18 + 10;\nconst ll MOD = 1e9+7;\n     \ntemplate<class T> T &chmin( T &a , const T &b ){ return a = min(a,b); }\ntemplate<class T> T &chmax( T &a , const T &b ){ return a = max(a,b); }\ntemplate<class T> void UNIQUE(vector<T> &a){ a.erase(unique(a.begin(), a.end()), a.end()); }\n\ntemplate<class S, class T> ostream& operator << (ostream& os, const pair<S, T> v){\n  os << \"(\" << v.first << \", \" << v.second << \")\"; return os;\n}\ntemplate<class T> ostream& operator << (ostream& os, const vector<T> v){\n  for(int i = 0; i < v.size(); i++){if(i > 0){os << \" \";} os << v[i];} return os;\n}\ntemplate<class T> ostream& operator << (ostream& os, const vector<vector<T>> v){\n  for(int i = 0; i < v.size(); i++){if(i > 0){os << endl;} os << v[i];} return os;\n}\n\nll in(){long long int x; scanf(\"%lld\", &x); return x;}\nld fin(){double x; scanf(\"%lf\", &x); return x;}\nchar yuyushiki[1000010]; string stin(){scanf( \"%s\", yuyushiki ); return yuyushiki;}\n\n// head\n\nusing vi = vector<int>;\n\nstruct SA : public vi{\n  int n, k;\n  vi rank, tmp;\n  \n  bool compare( int i , int j ){\n    if( rank[i] != rank[j] ) return rank[i] < rank[j];\n\n    int ri = i + k <= n ? rank[i+k] : -1;\n    int rj = j + k <= n ? rank[j+k] : -1;\n    return ri < rj;\n  }\n\n  struct Compare_SA{\n    SA *sa;\n    Compare_SA( SA *s ) : sa(s) {}\n    bool operator() ( const int &i , const int &j ){\n      return sa->compare( i , j );\n    }\n  };\n\n  void init(vector<int> S){\n    n = S.size();\n\n    resize( n+1 );\n    rank = tmp = vi( n+1 );\n    REP( i , n+1 ){\n      at(i) = i;\n      rank[i] = i < n ? S[i] : -1;\n    }\n\n    for( k = 1; k <= n; k *= 2 ){\n      sort( begin() , end() , Compare_SA(this) );\n\n      tmp[at(0)] = 0;\n      FOR( i , 1 , n+1 )\n\ttmp[at(i)] = tmp[at(i-1)] + (compare(at(i-1),at(i))?1:0);\n\n      REP( i , n+1 ) rank[i] = tmp[i];\n    }\n  }\n};\n\n\nSA sa;\n\nint a[3010];\n\nint main(){\n\n  int n = in();\n  string s = stin();\n\n  REP(i, 2*n){\n    if(s[i] == 'b'){\n      a[i+1] = a[i] + 1;\n    } else {\n      a[i+1] = a[i] - 1;\n    }\n  }\n\n  vector<vector<int>> vx(0);\n  vector<vector<char>> vc(0);\n  vector<int> c = {0};\n  vector<char> d = {s[0]};\n  int it = 1;\n  while(it <= 2*n){\n    if(a[it] == 0){\n      vx.pb(c);\n      vc.pb(d);\n      c.clear();\n      c.pb(0);\n      d.clear();\n      if(it < 2*n){\n        d.pb(s[it]);\n      }\n    } else {\n      c.pb(a[it]);\n      d.pb(s[it]);\n    }\n    it++;\n  }\n\n  // cout << vx << endl;\n  // cout << vc << endl;\n\n  /*\n  REP(i, 2*n+1){\n    cout << a[i] << \" \";\n  }\n  cout << endl;\n  */\n\n  vector<vector<int>> nvx(0);\n  vector<vector<char>> nvc(0);\n  vector<char> la;\n  int mm = 1;\n  bool f = false;\n  for(int i = SZ(vx) - 1; i >= 0; i--){\n    int ma = *max_element(vx[i].begin(), vx[i].end());\n    if(ma >= mm){\n      mm = ma;\n      f = true;\n      nvx.pb(vx[i]);\n      nvc.pb(vc[i]);\n    } else if(!f){\n      for(int j = SZ(vc[i]) - 1; j >= 0; j--){\n        la.pb(vc[i][j]);\n      }\n    }\n  }\n\n  reverse(nvx.begin(), nvx.end());\n  reverse(nvc.begin(), nvc.end());\n  reverse(la.begin(), la.end());\n  \n  string ans = \"\";\n  \n  REP(i, SZ(nvx)){\n    sa.init(nvx[i]);\n    // cout << nvx[i] << endl;\n    // cout << sa[SZ(nvx[i])] << endl;\n    int p = sa[SZ(nvx[i])];\n    ans += string(nvx[i][p], 'b');\n    while(p < SZ(nvc[i])){\n      ans += nvc[i][p];\n      p++;\n    }\n  }\n\n  vector<int> ai(SZ(la));\n  vector<int> bi(SZ(la));\n  vector<int> ia(SZ(la));\n  vector<int> ib(SZ(la));\n\n  int ca = 0;\n  int cb = 0;\n\n  REP(i, SZ(la)){\n    if(la[i] == 'a'){\n      ai[i] = ca;\n      ia[ca] = i;\n      ca++;\n    } else {\n      bi[i] = cb;\n      ib[cb] = i;\n      cb++;\n    }\n  }\n  \n  // assert(ca == cb);\n  \n  it = 0;\n  while(it < SZ(la)){\n    if(la[it] == 'a'){\n      int p = ib[ai[it]];\n      //assert(p > it);\n      ans += \"ab\";\n      it = p+1;\n    }\n  }\n\n  /*\n  int cur = 0;\n  while(cur < 2*n){\n    int p = max_element(a+cur, a+2*n) - a;\n    if(a[p] > 0){\n      ans += string(a[p], 'b');\n    } else {\n      ans += string(-a[p], 'a');\n      break;\n    }\n    while(p < 2*n && a[p] > 0){\n      ans += s[p];\n      p++;\n    }\n    cur = p;\n  }\n  */\n\n  printf(\"%s\\n\", ans.c_str());\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    For(i, 0, b.size()){\n        c.pb(b[i]);\n        For(j, 0, i){\n            if (c[j] + b[i] > c[i]){\n                c[i] = c[j] + b[i];\n            }\n        }\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/detail/standard_policies.hpp>\nusing ll = int64_t;\nusing ld = double;\nusing ull = uint64_t;\nusing namespace std;\nusing namespace __gnu_pbds;     \n\nconst int MAXN = 6228;\nint l[MAXN];\nint r[MAXN];\nint la[MAXN];\nint ra[MAXN];\nstring f[MAXN];\nint n;\n\nvoid pt(int x) {\n    int cur = 0;\n    while (r[cur] < x) {\n        ++cur;\n    }\n\n    while (cur < n) {\n        cout << \"ab\";\n        int cb = l[cur];\n        while (r[cur] < cb) {\n            ++cur;\n        }\n    }\n\n    cout << \"\\n\";\n    exit(0);\n}\n\nint main() {\n#ifdef BZ\n    freopen(\"input.txt\", \"r\", stdin); freopen(\"output.txt\", \"w\", stdout);\n#endif\n    ios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr); cout.setf(ios::fixed); cout.precision(20);\n\n    string s;\n    cin >> n >> s;\n    int lc = 0, rc = 0;\n\n    for (int i = 0; i < s.length(); ++i) {\n        if (s[i] == 'b') {\n            l[lc++] = i;\n        } else {\n            r[rc++] = i;\n        }\n    }\n\n    int ac = 0;\n\n    for (int i = 0; i < n; ++i) {\n        if (l[i] < r[i]) {\n            la[ac] = l[i];\n            ra[ac] = r[i];\n            ++ac;\n        }\n    }\n\n    la[ac] = ra[ac] = MAXN;\n\n    if (!ac) {\n        pt(0);\n    }\n\n\n    f[ac] = \"\";\n    for (int i = ac - 1; i >= 0; --i) {\n        int lp = i, rp = i;\n        string cur;\n        do {\n            if (la[lp] < ra[rp]) {\n                cur += 'b';\n                ++lp;\n            } else {\n                cur += 'a';\n                ++rp;\n            }\n        } while (lp != rp);\n\n        cur += f[lp];\n        f[i] = max(f[i + 1], cur);\n    }\n\n    cout << f[0];\n    pt(r[ac - 1] + 1);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 1) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            ans = ans + cans;\n        }\n        else {\n            if (i < lst) continue;\n            int cnt = 0;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    ans.pb('a'), ans.pb('b');\n                    cnt = 0;\n                }\n            }\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nusing int64 = long long;\nconst int INF = 1 << 30;\n\ntemplate< class T >\nstruct BinaryIndexedTree {\n  vector< T > data;\n\n  BinaryIndexedTree(int sz) {\n    data.assign(++sz, 0);\n  }\n\n  T sum(int k) {\n    T ret = 0;\n    for(++k; k > 0; k -= k & -k) ret = max(ret, data[k]);\n    return (ret);\n  }\n\n  void add(int k, T x) {\n    for(++k; k < data.size(); k += k & -k) data[k] = max(data[k], x);\n  }\n};\n\nint main() {\n  int N;\n  string S;\n\n  cin >> N;\n  cin >> S;\n  vector< int > latte, malta;\n  for(int i = 0; i < 2 * N; i++) {\n    if(S[i] == 'a') latte.push_back(i);\n    else malta.push_back(i);\n  }\n  int type = 0, pre = 0;\n  vector< string > myon;\n\n  auto get_beet = [&](int l, int r) {\n\n/*\n    cout << l << \" \" << r << endl;\n    for(int i = l; i < r; i++) {\n      cout << latte[i] << \" \" << malta[i] << endl;\n    }\n    cout << \"---\" << endl;\n*/\n    if(latte[l] < malta[l]) {\n      BinaryIndexedTree< int > bit(2 * N);\n      for(int i = l; i < r; i++) {\n        bit.add(malta[i], bit.sum(latte[i]) + 1);\n      }\n      int ans = bit.sum(2 * N - 1);\n      string s;\n      for(int i = 0; i < ans; i++) s += \"ab\";\n      return s;\n    } else {\n      string s;\n      for(int i = l; i < r; i++) {\n        vector< int > vx;\n        for(int j = i; j < r; j++) {\n          vx.push_back(latte[j]);\n          vx.push_back(malta[j]);\n        }\n        sort(begin(vx), end(vx));\n        string t;\n        for(int j = 0; j < vx.size(); j++) t += S[vx[j]];\n        s = max(s, t);\n      }\n      return s;\n    }\n  };\n  vector< int > ev;\n  int sum = 0;\n  ev.push_back(0);\n  for(int i = 0; i < 2 * N; i++) {\n    if(S[i] == 'a') ++sum;\n    else --sum;\n    if(sum == 0) ev.push_back(i + 1);\n  }\n  for(int i = 1; i < ev.size(); i++) {\n    int l = -1, r = -1;\n    for(int j = 0; j < N; j++) {\n      if(latte[j] == ev[i - 1] || malta[j] == ev[i - 1]) l = j;\n      if(latte[j] + 1 == ev[i] || malta[j] + 1 == ev[i]) r = j;\n    }\n    myon.push_back(get_beet(l, r + 1));\n  }\n  vector< string > dp(myon.size());\n\n  for(int i = 0; i < myon.size(); i++) {\n    dp[i] = max(dp[i], myon[i]);\n    for(int j = 0; j < i; j++) {\n      dp[i] = max(dp[i], dp[j] + myon[i]);\n    }\n  }\n  cout << *max_element(begin(dp), end(dp)) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cassert>\n#include <cstring>\n#include <vector>\n#include <algorithm>\n\nint N;\nchar str[6005];\n\nchar curr[6005];\nint ind[6005];\nint where[2][3005];\nint curr_len=0;\n\nchar add[6005];\nstd::vector<int> add_len;\n\nchar ans[6005];\nstd::vector<int> ans_len(1,0);\n\nvoid show(char* s,std::vector<int>& s_len){\n  return;\n  assert(std::is_sorted(s_len.begin(),s_len.end()));\n  assert(std::unique(s_len.begin(),s_len.end())==s_len.end());\n  int s_len_i=0;\n  assert(!s_len.empty());\n  for(int i=0;;i++){\n    while(i==s_len[s_len_i]){\n      printf(\"|\");\n      if(++s_len_i==s_len.size()){\n\tprintf(\"\\n\");\n\t/*\n\tprintf(\"[ \");\n\tfor(int l:s_len){\n\t  printf(\"%d \",l);\n\t}\n\tprintf(\"]\\n\");\n\t*/\n\treturn;\n      }\n    }\n    printf(\"%c\",s[i]);\n  }\n}\n\nvoid add_to(char* dest,std::vector<int>& dest_len,char* src,std::vector<int>& src_len){\n  //printf(\"ADD TO:\");\n  show(dest,dest_len);\n  //printf(\"  \");\n  show(src,src_len);\n  int i=0;\n  while((i<src_len.back())&&(i<dest_len.back())&&(src[i]==dest[i])) i++;\n  if(i==dest_len.back()||(i!=src_len.back()&&src[i]>dest[i])){\n    //printf(\"11111111\\n\");\n    strcpy(dest,src);\n    while(dest_len.back()>i){\n      dest_len.pop_back();\n    }\n  }else{\n    //printf(\"22222222\\n\");\n    while(src_len.back()>i){\n      src_len.pop_back();\n    }\n  }\n  //printf(\"I=%d\\n\",i);\n  std::vector<int> tmp;\n  std::merge(src_len.begin(),src_len.end(),\n\t     dest_len.begin(),dest_len.end(),\n\t     std::back_inserter(tmp));\n  dest_len=tmp;\n  dest_len.erase(std::unique(dest_len.begin(),dest_len.end()),dest_len.end());\n  \n  //printf(\" => \");\n  show(dest,dest_len);\n}\n\n\nvoid append(){\n  //printf(\"APPEND\\n\");\n  char base[6005];\n  strcpy(base,ans);\n  std::vector<int> base_len=ans_len;\n  char adding[6005];\n  for(int len:base_len){\n    std::vector<int> adding_len;\n    for(int l:add_len){\n      adding_len.push_back(l+len);\n    }\n    strcpy(adding,base);\n    strcpy(adding+len,add);\n    //printf(\"ADDING TO ANS:\");\n    show(adding,adding_len);\n    add_to(ans,ans_len,adding,adding_len);\n  }\n  //printf(\"ANS SO FAR:\");\n  show(ans,ans_len);\n}\n/*\nvoid add_to_add(char* sub,int sub_len){\n  for(int i=0;;i++){\n    if(i==sub_len){\n      auto it=std::lower_bound(add_len.begin(),add_len.end(),sub_len);\n      if(it==add_len.end()||*it!=sub_len){\n\tadd_len.insert(it,sub_len);\n      }\n      return;\n    }\n    if(i==add_len.back()){\n      strcpy(add,sub);\n      add_len.push_back(sub_len);\n      return;\n    }\n    if(add[i]>sub[i]){\n      return;\n    }\n    if(add[i]<sub[i]){\n      while(add_len.size()&&add_len.back()>=i){\n\tadd_len.pop_back();\n      }\n      strcpy(add,sub);\n      add_len.push_back(sub_len);\n      return;\n    }\n  }\n}\n*/\n\n\nvoid flush(){\n  int nth[2]={0,0};\n  for(int i=0;i<curr_len;i++){\n    where[curr[i]-'a'][ind[i]=nth[curr[i]-'a']++]=i;\n  }\n  add_len.clear();\n  add_len.push_back(0);\n  if(curr[0]=='a'){\n    for(int i=0;i<curr_len;i=where[1][ind[i]]+1){\n      assert(curr[i]=='a');\n      add[add_len.back()]='a';\n      add[add_len.back()+1]='b';\n      add_len.push_back(add_len.back()+2);\n    }\n  }else{\n    for(int i=0;i<curr_len/2;i++){\n      char sub[6005];\n      int sub_len=0;\n      for(int j=where[1][i];j<curr_len;j++){\n\tif(ind[j]>=i){\n\t  sub[sub_len++]=curr[j];\n\t}\n      }\n      //printf(\"CONSIDERING: %.*s\\n\",sub_len,sub);\n      std::vector<int> sub_len_v(1,sub_len);\n      add_to(add,add_len,sub,sub_len_v);\n    }\n  }\n  //printf(\"APPENDING:\\n\");\n  show(add,add_len);\n  append();\n  curr_len=0;\n}\n\nint main(){\n  scanf(\"%d %s\",&N,str);\n  int diff=0;\n  for(int i=0;str[i];i++){\n    curr[curr_len++]=str[i];\n    diff+=(str[i]=='a')-(str[i]=='b');\n    if(diff==0) flush();\n  }\n  printf(\"%.*s\\n\",ans_len.back(),ans);\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define INF int(1e9+5)\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define REP(i,n) for(int i=1;i<=(n);i++)\n#define mp make_pair\n#define pb push_back\n#define fst first\n#define snd second\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\nconst int maxn=6005;\nint n,cnta,cntb;\nchar s[maxn];\nstring val[maxn];\nint mat[maxn],a[maxn],b[maxn],nxt[maxn];\n\nint main(){\n\tscanf(\"%d%s\",&n,s);\n\trep(i,2*n){\n\t\tif(s[i]=='a')a[cnta++]=i;\n\t\telse b[cntb++]=i;\n\t}\n\trep(i,n)mat[a[i]]=b[i],mat[b[i]]=a[i];\n\tnxt[2*n]=2*n;\n\tfor(int i=2*n-1;i>=0;i--){\n\t\tnxt[i]=nxt[i+1];\n\t\tif(i<mat[i]){\n\t\t\tint cur=i;\n\t\t\twhile(cur<2*n){\n\t\t\t\tif(s[cur]=='a')val[i]+=\"ab\",cur=nxt[mat[cur]+1];\n\t\t\t\telse{\n\t\t\t\t\tint cur2=cur+1,cnt=1;\n\t\t\t\t\tval[i]+=\"b\";\n\t\t\t\t\twhile(cnt){\n\t\t\t\t\t\tif(s[cur2]=='b'&&cur2<mat[cur2])val[i]+=\"b\",cnt++;\n\t\t\t\t\t\telse if(s[cur2]=='a'&&mat[cur2]<cur2&&mat[cur2]>=i)val[i]+=\"a\",cnt--;\n\t\t\t\t\t\tcur2++;\n\t\t\t\t\t}\n\t\t\t\t\tcur=nxt[cur2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(val[i]>val[nxt[i]])nxt[i]=i;\n\t\t}\n\t}\n\tprintf(\"%s\\n\",val[nxt[0]].c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n\treturn 0;\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <bits/stdc++.h>\n\n#define FOR(i, n)     for(lli i = 0; i < (lli)(n); ++i)\n#define FORU(i, j, k) for(lli i = (j); i <= (lli)(k); ++i)\n#define FORD(i, j, k) for(lli i = (j); i >= (lli)(k); --i)\n\n#define SQ(x) ((x)*(x))\n\n#define all(x) begin(x), end(x)\n#define rall(x) rbegin(x), rend(x)\n#define mp make_pair\n#define mt make_tuple\n#define pb push_back\n#define eb emplace_back\n\nusing namespace std;\n\ntemplate<typename... As>\nstruct tpl : public std::tuple<As...> {\n  using std::tuple<As...>::tuple;\n  tpl(){}\n  tpl(std::tuple<As...> const& b) { std::tuple<As...>::operator=(b); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<0, T>::type const&\n  x() const { return get<0>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<0, T>::type&\n  x() { return get<0>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<1, T>::type const&\n  y() const { return get<1>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<1, T>::type&\n  y() { return get<1>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<2, T>::type const&\n  z() const { return get<2>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<2, T>::type&\n  z() { return get<2>(*this); }\n\n  template<typename T = tuple<As...> >\n  typename tuple_element<3, T>::type const&\n  w() const { return get<3>(*this); }\n  template<typename T = tuple<As...> >\n  typename tuple_element<3, T>::type&\n  w() { return get<3>(*this); }\n};\n\nusing lli   = long long int;\nusing llu   = long long unsigned;\n\nusing pii   = tpl<lli, lli>;\nusing piii  = tpl<lli, lli, lli>;\nusing piiii = tpl<lli, lli, lli, lli>;\nusing vi    = vector<lli>;\nusing vii   = vector<pii>;\nusing viii  = vector<piii>;\nusing vvi   = vector<vi>;\nusing vvii  = vector<vii>;\nusing vviii = vector<viii>;\n\ntemplate<class T>\nusing min_queue = priority_queue<T, vector<T>, greater<T> >;\ntemplate<class T>\nusing max_queue = priority_queue<T>;\n\ntemplate<size_t... I>\nstruct my_index_sequence {\n  using type = my_index_sequence;\n  static constexpr array<size_t, sizeof...(I)> value = { {I...} };\n};\n\nnamespace my_index_sequence_detail {\n  template<typename I, typename J> struct concat;\n  template<size_t... I, size_t... J>\n  struct concat<my_index_sequence<I...>, my_index_sequence<J...> > :\n    my_index_sequence<I..., (sizeof...(I)+J)...> { };\n  template<size_t N> struct make_index_sequence :\n    concat<typename make_index_sequence<N/2>::type, typename make_index_sequence<N-N/2>::type>::type { };\n  template <> struct make_index_sequence<0> : my_index_sequence<>{};\n  template <> struct make_index_sequence<1> : my_index_sequence<0>{};\n}\n\ntemplate<class... A>\nusing my_index_sequence_for = typename my_index_sequence_detail::make_index_sequence<sizeof...(A)>::type;\n\ntemplate<class T, size_t... I>\nvoid print_tuple(ostream& s, T const& a, my_index_sequence<I...>){\n  using swallow = int[];\n  (void)swallow{0, (void(s << (I == 0? \"\" : \", \") << get<I>(a)), 0)...};\n}\n\ntemplate<class T>\nostream& print_collection(ostream& s, T const& a);\ntemplate<class... A>\nostream& operator<<(ostream& s, tpl<A...> const& a);\ntemplate<class... A>\nostream& operator<<(ostream& s, tuple<A...> const& a);\ntemplate<class A, class B>\nostream& operator<<(ostream& s, pair<A, B> const& a);\n\ntemplate<class T, size_t I>\nostream& operator<<(ostream& s, array<T, I> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, vector<T> const& a) { return print_collection(s, a); }\ntemplate<class T, class U>\nostream& operator<<(ostream& s, multimap<T, U> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, multiset<T> const& a) { return print_collection(s, a); }\ntemplate<class T, class U>\nostream& operator<<(ostream& s, map<T, U> const& a) { return print_collection(s, a); }\ntemplate<class T>\nostream& operator<<(ostream& s, set<T> const& a) { return print_collection(s, a); }\n\ntemplate<class T>\nostream& print_collection(ostream& s, T const& a){\n  s << '[';\n  for(auto it = begin(a); it != end(a); ++it){\n    s << *it;\n    if(it != prev(end(a))) s << \" \";\n  }\n  return s << ']';\n}\n\ntemplate<class... A>\nostream& operator<<(ostream& s, tpl<A...> const& a){\n  s << '(';\n  print_tuple(s, a, my_index_sequence_for<A...>{});\n  return s << ')';\n}\n\ntemplate<class... A>\nostream& operator<<(ostream& s, tuple<A...> const& a){\n  s << '(';\n  print_tuple(s, a, my_index_sequence_for<A...>{});\n  return s << ')';\n}\n\ntemplate<class A, class B>\nostream& operator<<(ostream& s, pair<A, B> const& a){\n  return s << \"(\" << get<0>(a) << \", \" << get<1>(a) << \")\";\n}\n\n//------------------------------------------------------------------------------\n\nconst int N = 3000;\nint S[2*N];\n\n// --- BEGIN SNIPPET BINARY INDEXED TREE ---\n\nstruct BIT {\n  vi A;\n  BIT(lli n) : A(n+1){ }\n\n  lli get(lli i){\n    i += 1;\n    lli r = 0;\n    for(; i > 0; i -= i &-i){\n      r += A[i];\n    }\n    return r;\n  }\n\n  lli getR(lli l, lli r) {\n    lli ans = get(r);\n    if(l) ans -= get(l-1);\n    return ans;\n  }\n\n  void add(lli i, lli v){\n    i += 1;\n    for(; i < (lli)A.size(); i += i & -i){\n      A[i] += v;\n    }\n  }\n};\n\n// --- END SNIPPET BINARY INDEXED TREE ---\n\n\nint main(){\n  ios::sync_with_stdio(0); cin.tie(0);\n  int n; cin>>n;\n  FOR(i,2*n) {\n    char c; cin>>c;\n    S[i] = (c=='b');\n  }\n  vi as, bs;\n  FOR(i,2*n) if(S[i]) bs.pb(i); else as.pb(i);\n  vii ab;\n  FOR(i,n) ab.eb(as[i],bs[i]);\n  reverse(all(ab));\n\n  auto test = [&](vi x) -> bool {\n    vi y;\n    int na=0,nb=0;\n    FOR(i,x.size()) {\n      FOR(j,x[i]) {y.pb(1); nb++;}\n      if(i != (int)x.size()-1) {y.pb(0);na++;}\n    }\n\n    BIT bit(2*n+1);\n    FOR(i,2*n) bit.add(i+1,1);\n    vii L, R; R = ab;\n    while(1) {\n      if(R.empty()) {\n        return (int)L.size() >= na && (int)L.size() >= nb;\n      }\n      lli a,b; tie(a,b) = R.back(); R.pop_back();\n      lli ai = bit.get(a);\n      if(ai >= (int)y.size()) return 1;\n      if(y[ai]) {\n        bit.add(a+1,-1);\n        bit.add(b+1,-1);\n        while(!L.empty()) {\n          auto p = L.back(); L.pop_back();\n          R.pb(p);\n        }\n      }else{\n        L.eb(a,b);\n      }\n    }\n  };\n\n  vi ans;\n  while(1) {\n    ans.eb(0);\n    if(!test(ans)) {\n      ans.pop_back();\n      break;\n    }\n    while(1) {\n      ans.back() += 1;\n      if(!test(ans)) {\n        ans.back() -= 1;\n        break;\n      }\n    }\n  }\n  string out;\n  FOR(i,ans.size()) {\n    FOR(j,ans[i]) out += 'b';\n    if(i != (int)ans.size()-1) out += 'a';\n  }\n  cout << out << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3333;\nbool is_ab[maxn];\nint a[maxn], b[maxn];\nbool active[maxn * 2];\nint main(){\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tvector<int> p[2];\n\tfor(int i = 0; i < 2 * n; i++){\n\t\tp[s[i] - 'a'].push_back(i);\n\t}\n\tfor(int i = 0; i < n; i++){\n\t\ta[i] = p[0][i];\n\t\tb[i] = p[1][i];\n\t\tis_ab[i] = a[i] < b[i];\n\t}\n\tvector<int> ab, ba;\n\tfor(int i = n - 1; i >= -1; i--){\n\t\tif(i == -1 || !is_ab[i]){\n\t\t\tfor(int j = 0; j <= i; j++) if(!is_ab[j]) ba.push_back(j);\n\t\t\tfor(int j = i + 1; j < n; j++) if(is_ab[j]) ab.push_back(j);\n\t\t\tbreak;\n\t\t}\n\t}\n\twhile(!ba.empty()){\n\t\tint x = b[ba.back()], y = a[ba.back()]; ba.pop_back();\n\t\tint f = 0, g = 0;\n\t\tfor(int j = y - 1; j > x; j--){\n\t\t\tif(active[j]){\n\t\t\t\tif(s[j] == 'b') f++;\n\t\t\t\telse break;\n\t\t\t}\n\t\t}\n\t\tfor(int j = y + 1; j < 2 * n; j++){\n\t\t\tif(active[j]){\n\t\t\t\tif(s[j] == 'b') g++;\n\t\t\t\telse break;\n\t\t\t}\n\t\t}\n\t\tif(f == 0 || g <= 1){\n\t\t\tactive[x] = 1;\n\t\t\tactive[y] = 1;\n\t\t}\n\t}\n\twhile(!ab.empty()){\n\t\tint x = a[ab.back()], y = b[ab.back()]; ab.pop_back();\n\t\tint has_a = 0;\n\t\tfor(int j = y - 1; j > x; j--){\n\t\t\tif(active[j] && s[j] == 'a') has_a = 1;\n\t\t}\n\t\tif(!has_a){\n\t\t\tactive[x] = 1;\n\t\t\tactive[y] = 1;\n\t\t}\n\t}\t\n\tstring ans;\n\tfor(int i = 0; i < 2 * n; i++) if(active[i]) ans.push_back(s[i]);\n\tcout << ans << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint check2(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn 1;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check2(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"O2,unroll-loops\")\n#pragma GCC target(\"avx,avx2,sse,sse2,ssse3\")\n#include<bits/stdc++.h>\n#define all(x) x.begin(), x.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing vi = vector<ll>;\nusing pi = pair<ll, ll>;\nconst int maxn = 1<<17, mlg = 17, mod = 1e9 + 7;\nvi cur;\nvoid append(int x) {\n\tif(!x) return;\n\tcur.pb(x);\n\t//for(auto i : cur) cout << i << \" \"; cout << '\\n';\n\tif(x > 0)\n\twhile(cur.size() > 2 && cur.back() + cur[cur.size()-2] > 0) {\n\t\tcur[cur.size()-3] += cur.back() + cur[cur.size()-2];\n\t\tcur.pop_back();\n\t\tcur.pop_back();\n\t}\n\tif(x < 0)\n\twhile(cur.size() > 2 && (cur[cur.size()-3] + cur[cur.size()-2] > 0 || (cur[cur.size()-3] + cur[cur.size()-2] == 0 && cur[cur.size()-3] < cur.back()))) {\n\t\tswap(cur[cur.size()-3], cur.back());\n\t\tcur.pop_back();\n\t\tcur.pop_back();\n\t}\n\t//for(auto i : cur) cout << i << \" \"; cout << \";\\n\";\n}\nint main() {\n\tcin.tie(0)->sync_with_stdio(0);\n\tint n;\n\tstring _s, _cur, ans, q;\n\tvector<string> blocks;\n\tcin >> n >> _s;\n\tint ca = 0, cb = 0;\n\tfor(auto i : _s) {\n\t\t(i == 'a' ? ca : cb)++;\n\t\t_cur.pb(i);\n\t\tif(ca == cb) blocks.pb(_cur), _cur = \"\";\n\t}\n\tfor(int i = 0; i < blocks.size(); i++) {\n\t\tif(i + 1 < blocks.size() && blocks[i][0] == 'a') continue;\n\t\t//cout << blocks[i] << '\\n';\n\t\tif(blocks[i][0] == 'a') {\n\t\t\tchar p = '\\0';\n\t\t\tfor(auto c : blocks[i]) {\n\t\t\t\tif(c != p) q += c;\n\t\t\t\tp = c;\n\t\t\t}\n\t\t} else {\n\t\t\tchar p = '\\0';\n\t\t\tint len = 0;\n\t\t\tfor(auto c : blocks[i]) {\n\t\t\t\tif(p == c) len++;\n\t\t\t\telse append(p == 'a' ? -len : len), len = 1;\n\t\t\t\tp = c;\n\t\t\t}\n\t\t\tappend(p == 'a' ? -len : len);\n\t\t}\n\t}\n\tfor(auto i : cur) {\n\t\tfor(int j = 0; j < abs(i); j++) ans += 'a' + (i > 0);\n\t}\n\t//for(auto i : cur) cout << i << \" \"; cout << '\\n';\n\tans += q;\n\tcout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "// Created by Alphagocc\n#include<bits/stdc++.h>\n\n#define likely(x) __builtin_expect(!!(x), 1)\n#define unlikely(x) __builtin_expect(!!(x), 0)\n// namespace IO \nnamespace IO\n{\ntemplate <typename T>\nvoid __RI(T &x)\n{\n    int ch = getchar(), neg = 1;\n    x = 0;\n    for (; !(isdigit(ch) || ch == '-' || ch == EOF); ch = getchar())\n        ;\n    if (unlikely(ch == EOF)) return;\n    if (ch == '-') neg = -1;\n    for (; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    x *= neg;\n}\nvoid R(int &x) { __RI(x); }\nvoid R(int64_t &x) { __RI(x); }\nvoid R(double &x) { scanf(\"%lf\", &x); }\nvoid R(char &x) { scanf(\"%c\", &x); }\nvoid R(char *x) { scanf(\"%s\", x); }\nvoid R(std::string &x) { std::cin >> x; }\ntemplate <typename T1, typename T2>\nvoid R(std::pair<T1, T2> &x)\n{\n    R(x.first);\n    R(x.second);\n}\ntemplate <typename T>\nvoid R(std::vector<T> &x)\n{\n    for (auto &i : x) { R(i); }\n}\ntemplate <typename T>\nvoid R(T &x)\n{\n    std::cin >> x;\n}\ntemplate <typename T, typename... Args>\nvoid R(T &x, Args &... args)\n{\n    R(x), R(args...);\n}\nchar space = ' ';\ntemplate <typename T>\nvoid __WI(T x)\n{\n    if (unlikely(x == 0)) putchar('0');\n    if (x < 0) putchar('-'), x = -x;\n    char ch[ 64 ];\n    int  pos = 0;\n    while (x) ch[ pos++ ] = x % 10 + 48, x /= 10;\n    while (pos) putchar(ch[ --pos ]);\n}\nvoid W() {}\nvoid W(const int &x) { __WI(x); }\nvoid W(const int64_t &x) { __WI(x); }\nvoid W(const double &x) { printf(\"%lf\",static_cast<double>(x)); }\nvoid W(const char &x) { putchar(x); }\nvoid W(const std::string &x) { printf(\"%s\", x.c_str()); }\ntemplate <typename T1, typename T2>\nvoid W(const std::pair<T1, T2> &x)\n{\n    W(x.first);\n    W(space);\n    W(x.second);\n}\ntemplate <typename T>\nvoid W(const std::vector<T> &x)\n{\n    for (auto it = x.cbegin();it != x.cend(); it++)\n    {\n        W(*it);\n        W(space);\n    }\n    W('\\n');\n}\ntemplate <typename T>\nvoid W(const T &x)\n{\n    std::cout << x;\n}\ntemplate <typename T, typename... Args>\nvoid W(const T &x,const Args &... args)\n{\n    W(x), W(space), W(args...);\n}\ntemplate <typename... Args>\nvoid WL(const Args &... args)\n{\n    W(args...), W('\\n');\n}\n}; // namespace IO\n\nusing namespace std;\n\n#define REP(i, x, y) for (int i = x;i < y; i++)\n\nconst int8_t  INFC = 0x3f;\nconst int16_t INFS = 0x3f3f;\nconst int32_t INF  = 0x3f3f3f3f;\nconst int64_t INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst int MAXN = 6.1e3;\n\nint    posA[ MAXN ], posB[ MAXN ];\nstring dp[ MAXN ];\nbool cmp(const string&a, const string&b)\n{\n    int pa=0,pb=0;\n    while(pa<a.size()&&pb<b.size())\n    {\n        if (a[pa]==' ') pa++;\n        else if (b[pb]==' ') pb++;\n        else if (a[pa]!=b[pb]) return a[pa]<b[pb];\n        else pa++,pb++;\n    }\n    return (pa>pb);\n}\nint    main()\n{\n    int    n;\n    string s;\n    IO::R(n, s);\n    int ka = 0, kb = 0;\n    for (int i = 0; i < s.size(); i++)\n    {\n        if (s[ i ] == 'a') posA[ ++ka ] = i;\n        if (s[ i ] == 'b') posB[ ++kb ] = i;\n    }\n    for (int i = 0; i <= n; i++) { dp[ i ] = string(s.size(),' '); }\n    for (int i=1;i<=n;i++)\n    {\n        for (int j=0;j<i;j++)\n        {\n            string t=dp[j];\n            t[posA[i]]='a';t[posB[i]]='b';\n            if (cmp(dp[i],t)) dp[i]=t;\n        }\n    }\n    for (auto i:dp[n])\n    {\n        if (i!=' ') IO::W(i);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint n,sa[3010],sb[3010],ta=0,tb=0,pos[6010];\nchar s[6010];\nstring f[3010];\nint main()\n{\n\tscanf(\"%d\\n%s\",&n,s+1);\n\tfor(int i=1;i<=2*n;i++)\n\t{\n\t\tif(s[i]=='a') sa[++ta]=i,pos[i]=ta;\n\t\telse sb[++tb]=i,pos[i]=tb;\n\t}\n\tstring ans;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(sa[i]<sb[i])\n\t\t{\n\t\t\tint k=i;\n\t\t\tfor(int j=sa[i]+1;j<sb[i];j++) k=max(k,pos[j]);\n\t\t\tf[i]=\"ab\"+f[k+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile(k<n&&sb[k+1]<sa[k]) k++;\n\t\t\tfor(int j=sb[i];j<=2*n;j++) if(i<=pos[j]&&pos[j]<=k) f[i]+=s[j];\n\t\t\tf[i]+=f[k+1];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%s\",ans.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw){\n            if (ppp[i].first + ans < ans) continue;\n            ans = ppp[i].first + ans;\n            continue;\n        }\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  int ctr = 0;\n  while (!s.empty()) {\n    while (!s.empty() && s.front() != 'a') s.erase(s.begin());\n    if (s.empty()) break;\n    s.erase(s.begin());\n    while (s.front() != 'b') s.erase(s.begin());\n    s.erase(s.begin());\n    ctr++;\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (b == num || pos_a[a] < pos_b[b]) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    //cout<<\"offset=\"<<offset<<\": \"<<o<<\"\\n\";\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  if (!buf.empty() && a == b) block_list.pb(buf);\n\n  vector<pair<string, int> > list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(make_pair(solve_ba(s), -i));\n    }\n  }\n  sort(all(list2), greater<pair<string, int> >());\n  string out = \"\";\n  int lp = -1;\n  for (auto p : list2) {\n    int ord = -p._2;\n    if (lp < ord) {\n      out += p._1;\n      lp = ord;\n    }\n  }\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  //cout<<\"add=\"<<add<<\"\\n\";\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cassert>\n#include<cmath>\n#include<map>\n#include<set>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<bitset>\n#include<vector>\n#include<time.h>\n#include<algorithm>\nusing namespace std;\n#define REP(i,x,y) for(int i=x;i<=y;i++)\n#define rep(i,n) REP(i,1,n)\n#define rep0(i,n) REP(i,0,n-1)\n#define repG(i,x) for(int i=pos[x];~i;i=e[i].next)\n#define ll long long\n#define db double\nconst int N=6007;\nconst int INF=1e9+7;\nint n;\nchar s[N];\nint ad[N],bd[N],f[N][N],a[N],va[N],vb[N],g[N];\nvoid solve(){\n\tg[0]=0;\n\trep(i,n*2){\n\t\tg[i]=g[i-1];\n\t\tif(a[i]==1)g[i]=max(g[i],g[va[bd[i]]-1]+1);\n\t}\n\trep(i,g[n*2])putchar('a'),putchar('b');\n\tputs(\"\");\n}\nbool vis[N];\nbool cp(int *a,int *b,int o1,int o2){\n\trep(i,min(o1,o2)){\n\t\tif(a[i]>b[i])return 1;\n\t\tif(a[i]<b[i])return 0;\n\t}\n\treturn o1>o2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\trep(i,2*n)a[i]=s[i]-'a';\n\tint c1=0,c2=0;\n\trep(i,2*n){\n\t\tif(a[i]==1){\n\t\t\tvb[++c2]=i;\n\t\t\tbd[i]=c2;\n\t\t}\n\t\telse{\n\t\t\tva[++c1]=i;\n\t\t\tad[i]=c1;\n\t\t}\n\t}\n\tbool fl=0;\n\trep(i,n)if(va[i]>vb[i])fl=1;\n\tif(!fl){\n\t\tsolve();\n\t\treturn 0;\n\t}\n\tbool fls=0;\n\tfor(int i=n;i;i--){\n\t\tif(va[i]<vb[i]){\n\t\t\tf[i][0]=f[i+1][0];\n\t\t\trep(j,f[i][0])f[i][j]=f[i+1][j];\n\t\t\tif(fls)continue;\n\t\t\tif(!f[i][0]||f[i][1]==0){\n\t\t\t\tint md=n+1;\n\t\t\t\tfor(int j=n;j;j--)if(va[j]>vb[i])md=j;\n\t\t\t\tif(f[i][0]<2+f[md][0]){\n\t\t\t\t\tf[i][0]=f[md][0];\n\t\t\t\t\trep(j,f[md][0])f[i][j]=f[md][j];\n\t\t\t\t\tf[i][++f[i][0]]=0;\n\t\t\t\t\tf[i][++f[i][0]]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfls=1;\n\t\tint cnt=0,mx=va[i];\n\t\trep(j,n*2)vis[j]=0;\n\t\tvis[va[i]]=1;\n\t\tREP(j,vb[i],mx){\n\t\t\tif(a[j]==1){\n\t\t\t\tg[++cnt]=1;\n\t\t\t\tvis[va[bd[j]]]=1;\n\t\t\t\tmx=max(mx,va[bd[j]]);\n\t\t\t}\n\t\t\telse if(vis[j])g[++cnt]=0;\n\t\t}\n\t\tint md=n+1;\n\t\tfor(int j=n;j;j--)if(vb[j]>mx)md=j;\n\t\trep(k,f[md][0])g[++cnt]=f[md][k];\n\t\tf[i][0]=f[i+1][0];\n\t\trep(j,f[i][0])f[i][j]=f[i+1][j];\n\t\tif(cp(g,f[i],cnt,f[i][0])){\n\t\t\tf[i][0]=cnt;\n\t\t\trep(j,cnt)f[i][j]=g[j];\n\t\t}\n\t}\n\trep(i,f[1][0])putchar('a'+f[1][i]);\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n// #include <cstdlib>\n#include <cstring>\n#include <cstdio>\n#include <string>\n#include <queue>\n#include <cmath>\n#include <set>\n#include <map>\n#include <bitset>\n#include <iostream>\nusing namespace std;\ntypedef long long LL;\ntypedef double db;\nconst int oo=2139063143;\nconst int N=3010;\nconst int P=1000000007;\nconst db eps=1e-7;\n#define pritnf printf\n//char buf[1<<22],*p1=buf,*p2=buf,obuf[1<<22],*O=obuf;\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\ntemplate <typename T>\ninline void sc (T &x)\n{\n    x=0; static int p; p=1; static char c; c=getchar();\n    while (!isdigit(c)) { if (c=='-') p=-1; c=getchar(); }\n    while ( isdigit(c)) { x=(x<<1)+(x<<3)+(c-48); c=getchar(); }\n    x*=p;\n}\ntemplate <typename T>\ninline void print (T x)\n{\n    if (x< 0) putchar('-'),x=-x;\n    if (x>=10) print(x/10);\n    putchar(x%10+'0');\n}\ntemplate <typename T>\ninline void pr (T x) { print(x),putchar('\\n'); }\ntemplate <typename T1,typename T2>\nvoid chkmax (T1 &A,T2 B) { A=A>=B?A:B; }\ntemplate <typename T1,typename T2>\nvoid chkmin (T1 &A,T2 B) { A=A<=B?A:B; }\n\nstring f[N],s,ans;\nint n,a[N],b[N],id[N],p[N];\nint find (int x)\n{\n\tfor (int i=1; i<=n>>1; i++)\n\t\tif (min (a[i],b[i])> x) return i;\n\treturn n/2+1;\n}\nstring get (int l,int r)\n{\n\tstring g=\"\";\n\tfor (int i=l; i<=r; i++)\n\t\tif (id[i]>=id[l]) g+=s[i];\n\treturn g;\n}\nint main ()\n{\n    // freopen (\".in\",\"r\",stdin);\n    // freopen (\".out\",\"w\",stdout);\n    sc(n); n<<=1;\n\tcin>>s;\n\tfor (int i=0; i< n; i++)\n\t\tif (s[i]=='a') a[++a[0]]=i,id[i]=a[0];\n\t\telse b[++b[0]]=i,id[i]=b[0];\n\tfor (int i=n>>1; i>=1; i--)\n\t{\n\t\tf[i]=f[i+1];\n\t\tif (a[i]< b[i])\n\t\t{\n\t\t\tchkmax (f[i],\"ab\"+f[find (b[i])]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint nx=a[i];\n\t\t\tfor (int j=b[i]; j<=nx; j++)\n\t\t\t\tif (s[j]=='b') chkmax (nx,a[id[j]]);\n\t\t\tchkmax (f[i],get (b[i],nx)+f[find (nx)]);\n\t\t}\n\t\tchkmax (ans,f[i]);\n\t\t//cout<<i<<' '<<f[i]<<endl;\n\t}\n\tcout<<ans;\n\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/**\n *    author:  tourist\n *    created: 14.07.2018 15:39:29       \n**/\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  cin >> n;\n  string s;\n  cin >> s;\n  n *= 2;\n  int bal = 0;\n  string t = \"\";\n  vector<string> res;\n  for (int i = 0; i < n; i++) {\n    if (s[i] == 'a') {\n      bal++;\n    } else {\n      bal--;\n    }\n    t += s[i];\n    if (bal == 0) {\n      if (t[0] == 'a') {\n        int tlen = (int) t.length();\n        vector<int> as, bs;\n        for (int j = 0; j < tlen; j++) {\n          if (t[j] == 'a') {\n            as.push_back(j);\n          } else {\n            bs.push_back(j);\n          }\n        }\n        string cur = \"\";\n        int start = 0;\n        for (int j = 0; j < tlen / 2; j++) {\n          if (as[j] >= start) {\n            cur += \"ab\";\n            start = bs[j] + 1;\n          }\n        }\n        res.push_back(cur);\n      } else {\n        string cur = t;\n        while (t != \"\") {\n          string new_t = \"\";\n          int first_a = 1, first_b = 1;\n          for (int j = 0; j < (int) t.length(); j++) {\n            if (t[j] == 'a' && first_a) {\n              first_a = 0;\n              continue;\n            }\n            if (t[j] == 'b' && first_b) {\n              first_b = 0;\n              continue;\n            }\n            new_t += t[j];\n          }\n          t = new_t;\n          cur = max(cur, t);\n        }\n        res.push_back(cur);\n      }\n      t = \"\";\n    }\n  }\n  int sz = (int) res.size();\n  vector<int> good(sz, 1);\n  for (int i = 0; i < sz; i++) {\n    for (int j = i + 1; j < sz; j++) {\n      if (res[i][0] == 'a' && res[j][0] == 'b') {\n        good[i] = 0;\n      }\n      if (res[i][0] == 'b' && res[j][0] == 'b' && res[i] < res[j]) {\n        good[i] = 0;\n      }\n    }\n  }\n  for (int i = 0; i < sz; i++) {\n    if (good[i]) {\n      cout << res[i];\n    }\n  }\n  cout << '\\n';\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define range(i, m, n) for(int i = m; i < n; i++)\n#define husk(i, m, n) for(int i = m; i > n; i--)\n\n\ntemplate <typename T>\nvoid debug_out(T t) {\n  cerr << t;\n}\n\ntemplate <typename A, typename B>\nvoid debug_out(pair<A, B> u) {\n  cerr << \"(\" << u.first << \" \" << u.second << \")\";\n}\n\ntemplate <typename T>\nvoid debug_out(vector<T> t) {\n  int sz = t.size();\n  for(int i = 0; i < sz; i++) {\n    debug_out(t[i]);\n    if(i != sz - 1) cerr << \", \";\n  }\n}\n\ntemplate <typename T>\nvoid debug_out(vector<vector<T>> t) {\n  int sz = t.size();\n  for(int i = 0; i < sz; i++) {\n    debug_out(t[i]);\n    if(i != sz - 1) cerr << endl;\n  }\n}\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\" << endl, debug_out(__VA_ARGS__), cerr << endl;\n\nint n;\nstring s;\n\nint main() {\n  cin >> n >> s;\n  vector<int> a, b;\n  range(i, 0, 2 * n) {\n    if(s[i] == 'a') a.push_back(i);\n    else b.push_back(i);\n  }\n  vector<string> dp(n + 1);\n  husk(i, n - 1, -1) {\n    dp[i] = dp[i + 1];\n    if(b[i] < a[i]) {\n      int pos = i;\n      string c;\n      vector<int> id;\n      while(pos < n && b[pos] < a[pos] && (pos == i || b[pos] < a[pos - 1])) {\n        id.push_back(b[pos]);\n        id.push_back(a[pos]);\n        pos++;\n      }\n      sort(id.begin(), id.end());\n      for(int j : id) c += s[j];\n      dp[i] = max(dp[i], c + dp[pos]);\n    } else {\n      int pos = i;\n      while(pos < n && a[pos] < b[i]) pos++;\n      dp[i] = max(dp[i], \"ab\" + dp[pos]);\n    }\n  }\n  cout << dp[0] << endl;;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <map>\n#include <set>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <cmath>\nusing namespace std;\n\nint main() {\n        int n;\n        scanf(\"%d\", &n);\n        string s;\n        cin >> s;\n        int acc = 0;\n        vector<string> hoge;\n        string cur = \"\";\n        for (int i = 0; i < 2 * n; i ++) {\n                if (s[i] == 'a') {\n                        acc ++;\n                } else {\n                        acc --;\n                }\n                cur += s[i];\n                if (acc == 0) {\n                        hoge.push_back(cur);\n                        cur = \"\";\n                }\n        }\n        vector<string> best;\n        for (int f = 0; f < (int) hoge.size(); f ++) {\n                string t = hoge[f];\n                int N = (int) t.size();\n                int ac = 0, bc = 0;\n                vector<int> p(N);\n                for (int i = 0; i < N; i ++) {\n                        if (t[i] == 'a') {\n                                p[i] = ac ++;\n                        } else {\n                                p[i] = bc ++;\n                        }\n                }\n                vector<int> pos(N);\n                for (int i = 0; i < N; i ++) {\n                        for (int j = i + 1; j < N; j ++) {\n                                if (p[i] == p[j] && t[i] != t[j]) {\n                                        pos[i] = j;\n                                        pos[j] = i;\n                                }\n                        }\n                }\n                string ma = \"\";\n                if (t[0] == 'b') { \n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        continue;\n                                }\n                                string now = \"\";\n                                for (int j = i; j < N; j ++) {\n                                        if (pos[j] >= i) {\n                                                now += t[j];\n                                        }\n                                }\n                                ma = max(ma, now);\n                        }\n                } else {\n                        bool last = true;\n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        ma += t[i];\n                                        i = pos[i] - 1;\n                                        last = false;\n                                } else if (!last) {\n                                        ma += t[i];\n                                        last = true;\n                                }\n                        }\n                }\n                best.push_back(ma);\n        }\n        /*\n        vector<vector<string>> dp(best.size(), vector<string> (2 * n + 1, \"\"));\n        dp[0][0] = \"\";\n        dp[0][(int) best[0].size()] = best[0];\n        int sum = (int) best[0].size();\n        for (int i = 1; i < (int) best.size(); i ++) {\n                int len = (int) best[i].size();\n                sum += len;\n                for (int j = 0; j <= sum - len; j ++) {\n                        if (j != 0 && dp[i - 1][j] == \"\") continue;\n                        dp[i][j + len] = max(dp[i][j + len], dp[i - 1][j] + best[i]);\n                        dp[i][j] = max(dp[i][j], dp[i - 1][j]);\n                }\n        }\n        string ans = \"\";\n        for (int j = 0; j <= 2 * n; j ++) {\n                ans = max(ans, dp[(int) best.size() - 1][j]);\n        }\n        cout << ans << endl;\n        */\n        return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 6000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res;\n    int p = -1;\n    for(int i = l; i <= r; ++i) if(a[i] > p) {\n        p = b[i];\n        res += \"ab\";\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint s[N + 5];\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i, ++ s[i]; else b[++ b[0]] = i, -- s[i];\n        s[i + 1] = s[i];\n    }\n\n    string tmp, ans;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(s[b[j]] && j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(s[a[j]] && j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        stk.push_back(tmp);\n    }\n\n    std::reverse(stk.begin(), stk.end());\n    for(auto t : stk) chkmax(ans, t + ans);\n    std::cout << ans << std::endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define isA(x) ((x) < 0)\n#define isB(x) ((x) >= 0)\n\ntypedef std::bitset <3001> bitset;\nconst int N = 6054;\n\nint n;\nint a[N], b[N], s[N];\nchar buf[N];\nbitset f[N], mask;\n\ninline int abs(int x) {return x ^ x >> 31;}\ninline char get(int x) {return 98 + (x >> 31);}\n\nchar * parse(const bitset &B, char *ret) {\n\tfor (int i = 0; i < 2 * n; ++i) if (B.test(abs(s[i]))) *ret++ = get(s[i]);\n\treturn *ret = 0, ret;\n}\n\ninline void up(bitset &A, const bitset &B) {\n\tstatic char bufA[N], bufB[N];\n\tif (parse(A, bufA), parse(B, bufB), strcmp(bufA, bufB) < 0) A = B;\n}\n\nint main() {\n\tint i, j = 0, k = 0, r;\n\tscanf(\"%d%s\", &n, buf);\n\tfor (i = 0; i < 2 * n; ++i) s[i] = (buf[i] & 1 ? (a[j] = i, ~j++) : (b[k] = i, k++));\n\tf[n - 1].set(n - 1), mask.set(n - 1);\n\tfor (i = n - 2; i >= 0; --i) {\n\t\tif (a[i] < b[i])\n\t\t\tr = *std::min_element(s + a[i], s + b[i]),\n\t\t\tassert(isA(r)), f[i] = f[-r], f[i].set(i);\n\t\telse {\n\t\t\tfor (r = 0, j = b[i]; j < 2 * n; ++j) {\n\t\t\t\tif (isB(s[j])) f[i].set(s[j]), ++r;\n\t\t\t\telse if (~s[j] >= i) --r;\n\t\t\t\tif (!r) break;\n\t\t\t}\n\t\t\tf[i] |= f[abs(s[++j])];\n\t\t}\n\t\tup(f[i], f[i + 1]), mask.set(i);\n\t}\n\treturn parse(*f, buf), puts(buf), 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num) v[i]=bs(i);\n\tint p=ok();\n\t//assert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (!j)for (;;);\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<=k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<=k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//khodaya khodet komak kon\n#include <bits/stdc++.h>\n\n#define F first\n#define S second\n#define pb push_back\n#define all(x) x.begin(), x.end()\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nconst int N = 3010;\nconst ll MOD = 1000000000 + 7;\nconst ll INF = 1000000010;\nconst ll LOG = 25;\n\n\nint n;\nchar S[N * 2 + 5];\nint A[N + 5], B[N + 5];\nchar F[N * 2 + 5][N * 2 + 5], G[N + 5][N * 2 + 5];\nint CntA, CntB;\n\nint main(){\n \tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n\tcin >> n;\n  \tfor (int i = 1; i <= 2 * n; i++) cin >> S[i];\n \tfor (int i = 1; i <= n * 2; ++i)\n    if (S[i] == 'a') A[++CntA] = i;\n    else B[++CntB] = i;\n\tfor (int i = n; i >= 1; --i) {\n    \tif (A[i] < B[i]) {\n    \t  F[i][1] = 'a', F[i][2] = 'b';\n      \tfor (int j = i; j <= n; ++j) {\n       \t if (j == n || A[j + 1] > B[i]) {\n       \t   strcpy(F[i] + 3, G[j + 1] + 1);\n       \t   break;\n       \t }\n      \t}\n    } else {\n      for (int j = i; j <= n; ++j) {\n        if (j == n || B[j + 1] > A[i]) {\n          int cnt = 0;\n          for (int k = i; k <= j; ++k) F[i][++cnt] = 'b';\n          F[i][++cnt] = 'a';\n          if (i == j) strcpy(F[i] + cnt + 1, G[i + 1] + 1);\n          else strcpy(F[i] + cnt + 1, F[i + 1] + j - i + 1);\n          break;\n        }\n      }\n    }\n    if (strcmp(F[i] + 1, G[i + 1] + 1) < 0) strcpy(G[i] + 1, G[i + 1] + 1);\n    else strcpy(G[i] + 1, F[i] + 1);\n    // printf(\"F[%d] = %s, G = %s\\n\", i, F[i] + 1, G[i] + 1);\n  }\n    cout << G[1] + 1;\n  \treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned ll\n#define uint ungigned\n#define db double\n#define pii pair<int,int>\n#define pll pair<ll,ll> \n#define pli pair<ll,int>\n#define vi vector<int>\n#define vpi vector<pii >\n#define IT iterator\n \n#define PB push_back\n#define MK make_pair\n#define LB lower_bound\n#define UB upper_bound\n#define y1 wzpakking \n#define fi first\n#define se second\n#define BG begin\n#define ED end\n \n#define For(i,j,k) for (int i=(int)(j);i<=(int)(k);i++)\n#define Rep(i,j,k) for (int i=(int)(j);i>=(int)(k);i--)\n#define UPD(x,y) (((x)+=(y))>=mo?(x)-=mo:233)\n#define CLR(a,v) memset(a,v,sizeof(a))\n#define CPY(a,b) memcpy(a,b,sizeof(a))\n#define sqr(x) (1ll*x*x)\n \n#define LS3 k*2,l,mid\n#define RS3 k*2+1,mid+1,r\n#define LS5 k*2,l,mid,x,y\n#define RS5 k*2+1,mid+1,r,x,y\n#define GET pushdown(k);int mid=(l+r)/2\n#define INF (1<<30)\nusing namespace std;\n\nconst int N=3005;\nchar s[N*2];\nint a[N],b[N],tp[N*2];\nstring ss[N],f[N];\nint n,an,bn;\nstring work(int l,int r){\n\tint tl=-1,tr;\n\tFor(i,1,n) if (a[i]>=l&&a[i]<=r){\n\t\tif (tl==-1) tl=i; tr=i;\n\t}\n\tstring ans=\"\";\n\tif (a[tl]<b[tl]){\n\t\tint las=0;\n\t\tFor(i,tl,tr) if (las<a[i])\n\t\t\tans=ans+\"ab\",las=b[i];\n\t\treturn ans;\n\t}\n\tFor(i,tl,tr){\n\t\tstring c=\"\";\n\t\tFor(j,l,r) if (tp[j]>=i) c.PB(s[j]);\n\t\tans=max(ans,c);\n\t}\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tFor(i,1,n+n)\n\t\tif (s[i]=='a') a[tp[i]=++an]=i;\n\t\telse b[tp[i]=++bn]=i;\n\tint cnt=1,sum=0,las=0;\n\tFor(i,1,n+n){\n\t\tsum+=(s[i]=='a'?1:-1);\n\t\tif (!sum) ss[++cnt]=work(las,i),las=i+1;\n\t}\n\tRep(i,cnt,1)\n\t\tf[i]=max(ss[i]+f[i+1],f[i+1]);\n\tcout<<f[1];\n} "
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(i,l,r){\n        if(S[i]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  vector<string> dp(s.size()+1);\n  RREP(i,s.size()) FOR(j,i+1,s.size()+1){\n    chmax(dp[i],s[i]+dp[j]);\n  }\n\n  cout << dp[0] << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            ans = ans + cans;\n        }\n        else {\n            if (i < lst) continue;\n            int cnt = 0;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    ans.pb('a'), ans.pb('b');\n                    cnt = 0;\n                }\n            }\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tstring to = \"\";\n\t\tif(s[i] == 'a') {\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tint lsta = 0;\n\t\t\tfor(int k = i;k < j;k++) {\n\t\t\t\tcntb += s[k] == 'b';\n\t\t\t\tif(s[k] == 'a') {\n\t\t\t\t\tcnta += s[k] == 'a';\n\t\t\t\t\tif(to.empty() || to.back() == 'b') to += 'a', lsta = cnta;\n\t\t\t\t} else {\n\t\t\t\t\tcntb += s[k] == 'a';\n\t\t\t\t\tif(cntb == lsta) to += 'b';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tto = s.substr(i,j-i);\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt) {\n\t\t\t\t\t\tcurcnt--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcur += s[z];\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(res <= in[i] + res) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for((i)=1;(i)<=(n);(i)++)\nusing namespace std;\nint n,m,i,j,a[3005],b[3005],c1,c2,id[6005],nxt[6005];\nstring st,f[3005];\nint main(){\n\tcin>>n>>st;\n\tst=\" \"+st;\n\trep(i,n+n){\n\t\tif(st[i]=='a'){\n\t\t\ta[++c1]=i;\n\t\t\tid[i]=c1;\n\t\t}\n\t\telse{\n\t\t\tb[++c2]=i;\n\t\t\tid[i]=c2;\n\t\t}\n\t}\n\tj=0;\n\ta[n+1]=b[n+1]=n+n+1;\n\tid[n+n+1]=n+1;\n\trep(i,n+1){\n\t\twhile(j<min(a[i],b[i])){\n\t\t\tnxt[++j]=i;\n\t\t}\n\t}\n\tfor(i=n;i;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tf[i]=\"ab\"+f[nxt[b[i]+1]];\n\t\t}\n\t\telse{\n\t\t\tint j=b[i];\n\t\t\tf[i]=\"\";\n\t\t\twhile(b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1])){\n\t\t\t\tif(id[j]>=i) f[i]+=st[j];\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tf[i]+=f[id[j]];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n//\t\tcerr<<f[i]<<endl;\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define fo(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\nusing namespace std;\n\nconst int N=1e4+5;\n\nint n,pa[N],pb[N],ta,tb,pos[N];\nchar st[N];\nstring an[N];\n\nint main() {\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",st+1);\n\tfo(i,1,n<<1)\n\t\tif (st[i]=='a') pa[++ta]=i,pos[i]=ta;\n\t\telse pb[++tb]=i,pos[i]=tb;\n\tfd(i,n,1) {\n\t\tif (pa[i]<pb[i]) {\n\t\t\tint k=i;\n\t\t\tfo(j,pa[i]+1,pb[i]) k=max(k,pos[j]);\n\t\t\tan[i]=\"ab\"+an[k+1];\n\t\t} else {\n\t\t\tint k=i;\n\t\t\tfor(;k<n&&pb[k+1]<pa[k];k++);\n\t\t\tfo(j,pb[i],n<<1) if (pos[j]>=i&&pos[j]<=k) an[i]=an[i]+st[j];\n\t\t\tan[i]=an[i]+an[k+1];\n\t\t}\n\t\tan[i]=max(an[i],an[i+1]);\n\t}\n\tcout<<an[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3005;\n\nint n, dp[maxn][maxn], pa[maxn], pb[maxn], c[maxn<<1];\nchar s[maxn<<1], a[maxn<<1], b[maxn<<1];\nbool used[maxn<<1];\n\nbool check(int x)\n{\n\tint cnta = 0, cntb = 0;\n\tfor(int i = x; i <= n; ++i)\n\t\tif(dp[x][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x], pb[x]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\ta[++cnta] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = x + 1; i <= n; ++i)\n\t\tif(dp[x+1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x+1], pb[x+1]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\tb[++cntb] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = 1; i <= min(cnta, cntb); ++i)\n\t\tif(a[i] != b[i])\n\t\t\treturn b[i] > a[i];\n\treturn cntb > cnta;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\tint cnta = 0, cntb = 0;\n\tfor(int i = 1; i <= (n << 1); ++i)\t\n\t{\n\t\tif(s[i] == 'a')\n\t\t{\n\t\t\tpa[++cnta] = i;\n\t\t\tc[i] = cnta;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[++cntb] = i;\n\t\t\tc[i] = cntb;\n\t\t}\n\t}\n\tdp[n][n] = 1;\n\tfor(int i = n - 1; i >= 1; --i)\n\t{\n\t\tdp[i][i] = 1;\n\t\tif(pa[i] > pb[i])\n\t\t{\n\t\t\tint p = n + 1, tot = 0;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t{\n\t\t\t\tif(pb[j] > pa[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t++ tot;\n\t\t\t\tdp[i][j] = 1;\n\t\t\t}\n\t\t\tfor(int j = pa[i] + 1; j <= (n << 1); ++j)\n\t\t\t{\n\t\t\t\tif(s[j] == 'b')\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\t++ tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\tp = max(p, c[j] + 1);\n\t\t\t\t\t\t-- tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint p = n + 1;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t\tif(pa[j] > pb[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tfor(int j = p; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[p][j];\n\t\t}\n\t\tif(check(i))\n\t\t{\n\t\t\tfor(int j = i; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[i+1][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(dp[1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\t\n\t\t}\n\tfor(int i = 1; i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t\tprintf(\"%c\", s[i]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n\n#include <algorithm>\n\n#include <string>\n\nusing namespace std;\n\n\nint N; char S[6060];\nint A[3030], B[3030], C[6060];\n\n\nint main()\n{\n\n\tscanf(\"%d %s\", &N, S);\n\n\tA[0] = B[0] = -1;\n\n\tfor (int i=0, a=0, b=0;i<N*2;i++){\n\t\tif (S[i] == 'a') A[++a] = i;\n\t\tif (S[i] == 'b') B[++b] = i;\n\t}\n\n\tstring ans = \"\", best = \"\";\n\tint l = N*2+1, lm = N*2+1; bool see = false;\n\tfor (int i=N;i>=0;i--){\n\t\tif (A[i] >= B[i]){\n\t\t\tif (A[i] < l) best = ans, lm = l;\n\n\t\t\tif (i){\n\t\t\t\tC[A[i]] = C[B[i]] = 1;\n\t\t\t\tstring now = \"\";\n\t\t\t\tfor (int j=B[i];j<lm;j++) if (C[j]) now += S[j];\n\n\t\t\t\tstring mk = now + best;\n\t\t\t\tif (ans < mk)\n\t\t\t\t\tans = move(mk);\n\t\t\t}\n\n\t\t\tl = B[i];\n\t\t\tsee = true;\n\t\t}\n\t\telse if (!see){\n\t\t\tif (B[i] < l){\n\t\t\t\tans += \"ab\";\n\t\t\t\tbest += \"ab\";\n\t\t\t\tl = A[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tputs(ans.c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\t#include <iostream>\n    #include <string>\n    #include <set>  \n    #include <stack>\n    #include <algorithm>\n    #include <vector>\n    #include <cmath>\n    #include <queue>\n    #include <deque>\n    #include <cstring>\n    #include <cstdio>\n    #include <map>\n    #include <numeric>\n    #include <cassert>\n    #include <iomanip>\n    #include <sstream>\n    #include <ctime>\n    #include <bitset> \nusing namespace std;\n#define for1(i,a,b) for(int i=(a);i<(int)(b);++i)\n#define rep(i,maxn) for1(i,0,maxn)\n#define ford(i,b,a) for(int i=(int)(b)-1;i>=a;--i)\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<int,pii > piii;\n#define inf 0x3f3f3f3f\n#define mod 1000000007\n#define st first\n#define nd second\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define dprintf(...) printf(__VA_ARGS__)\nconst int maxn=3412;\nint n;\nstring s;\nint id[maxn+maxn];\nvector<string> ds;\nvoid cal(string& s)\n{\n\tstring cur=\"\";\n\tmemset(id,-1,sizeof(id));\n\tint ai=0,bi=0;\n\trep(i,s.length())\n\t{\n\t\tif(s[i]=='a')ai++,id[i]=ai;\n\t\telse bi++,id[i]=bi;\n\t//\tcout<<id[i]<<endl;\n\t}\n\tif(s[0]=='a')\n\t{\n\t\tint ai=0,bi=0;\n\t\tcur.pb(s[0]);ai++;\n\t\tint nd=ai;bool ok=0;\n\t\tfor1(i,1,s.length())\n\t\t{\n\t\t\tif(s[i]=='a')\n\t\t\t{\n\t\t\t\tai++;\n\t\t\t\tif(ok)cur.pb(s[i]),nd=ai;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbi++;\n\t\t\t\tif(bi==nd)cur.pb(s[i]),ok=1;\n\t\t\t}\n\t\t//\tcout<<i<<\" \"<<cur<<endl;\n\t\t//\tsystem(\"pause\");\n\t\t}\n\t}\n\telse\n\t{\n\t\tint mxid=id[s.length()-1];\n\t\tfor1(l,1,mxid+1)\n\t\t{\n\t\t\tstring bst=\"\";\n\t\t\trep(i,s.length())\n\t\t\t\tif(id[i]>=l)bst.pb(s[i]);\n\t\t//\tcout<<l<<\" \"<<bst<<endl;\n\t\t\tcur=max(cur,bst);\n\t\t}\n\t}\n\ts=cur;\n}\nint main()\n{\n\tcin>>n>>s;\n\tstring buf=\"\";\n\tint ai=0,bi=0;\n\trep(i,s.length())\n\t{\n\t\tbuf.pb(s[i]);\n\t\tif(s[i]=='a')ai++;\n\t\telse bi++;\n\t\tif(ai==bi)ds.pb(buf),buf=\"\";\n\t}\n\trep(i,ds.size())\n\t{\n\t//\tcout<<ds[i]<<endl;\n\t\tcal(ds[i]);\n\t//\tcout<<ds[i]<<endl;\n\t}\n\tford(i,ds.size()-1,0)\n\t\tds[i]=max(ds[i+1],ds[i]+ds[i+1]);\n\tcout<<ds[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=4e3+5;\nstring dp[maxn<<1];\nchar s[maxn<<1];\nint a[maxn],b[maxn],n,A,B,t[maxn<<1],p,fi[maxn<<1];\nint cnt,group[maxn<<1];\nstring ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tp=1;\n\tfor (int i=1;i<=2*n;i++){\n\t\tif (s[i]=='a'){\n\t\t\ta[++A]=i;\n\t\t\tt[i]=A;\n\t\t\tcnt++;\n\t\t}else{\n\t\t\tb[++B]=i;\n\t\t\tt[i]=B;\n\t\t\tcnt--;\n\t\t}\n\t\tgroup[i]=p;\n\t\tif (cnt==0)\n\t\t\tfi[++p]=i+1;\n\t}\n\tfi[++p]=n*2+1;\n\tfor (int i=2*n;i>=1;i--){\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi != i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tstring S=\"\";\n\t\t\tfor (int j = i;group[j] == group[i];j++){\n\t\t\t\tif (b[t[j]] >= i){\n\t\t\t\t\tS+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tS+=dp[fi[group[i]+1]];\n\t\t\tdp[i]=max(S,ans);\n\t\t}else{\n\t\t\tdp[i]=max(\"ab\"+dp[b[t[i]]+1],ans);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout << ans << '\\n';\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <set>\n\n#define MIN_INT -2147483648\n#define MAX_INT 2147483647\n#define MIN_LONG -9223372036854775808L\n#define MAX_LONG 9223372036854775807L\n#define PI 3.141592653589793238462643383279502884L\n\n#define long long long int\n\nusing std::vector;\nusing std::map;\nusing std::set;\nusing std::string;\nusing std::pair;\nusing std::cin;\nusing std::cout;\nusing std::cerr;\n\n// @author: pashka\n\nint main() {\n    std::ios::sync_with_stdio(false);\n\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<int> aa;\n    vector<int> bb;\n    for (int i = 0; i < 2 * n; i++) {\n        if (s[i] == 'a') aa.push_back(i); else bb.push_back(i);\n    }\n\n    vector<int> p(2 * n);\n    for (int i = 0; i < n; i++) {\n        p[aa[i]] = bb[i];\n        p[bb[i]] = aa[i];\n    }\n\n    vector<pair<string, int>> t;\n    int r = -1;\n    string ss = \"\";\n    for (int i = 0; i <= 2 * n; i++) {\n        if (i > r && ss.size() > 0) {\n            t.push_back({ss, i});\n            ss = \"\";\n        }\n        if (i < 2 * n) {\n            if (s[i] == 'b' && p[i] > i) {\n                ss += 'b';\n                r = std::max(r, p[i]);\n            } else if (s[i] == 'a' && p[i] < i) {\n                ss += 'a';\n            }\n        }\n    }\n//    for (auto item : t) {\n//        cout << item.first << \"\\n\";\n//    }\n    std::reverse(t.begin(), t.end());\n    string ans = \"\";\n    for (auto item : t) {\n        string ss = item.first + ans;\n        if (ss > ans) {\n            ans = ss;\n        }\n    }\n    int l = t.size() == 0 ? -1 : t[0].second;\n    for (int i = 0; i < 2 * n; i++) {\n        if (i > l && s[i] == 'a' && p[i] > i) {\n            ans += \"ab\";\n            l = p[i];\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define pb push_back\n\nconst int maxn = 3e3 + 20;\n\nint match[maxn * 2];\n\nstring s[maxn] , dp[maxn];\n\nint main()\n{\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\n\tint n;\n\tcin >> n >> s[0];\n\n\tfor(int i = 1; i < n; i++)\n\t{\n\t\ts[i] = s[i - 1];\n\t\tfor(int j = 0; j < (int)s[i].size(); j++)\n\t\t\tif(s[i][j] == 'a')\n\t\t\t{\n\t\t\t\ts[i].erase(s[i].begin() + j);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\tfor(int j = 0; j < (int)s[i].size(); j++)\n\t\t\tif(s[i][j] == 'b')\n\t\t\t{\n\t\t\t\ts[i].erase(s[i].begin() + j);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\tfor(int i = n - 1; i >= 0; i--)\n\t{\n\t\tdp[i] = dp[i + 1];\n\t\tint sz = s[i].size();\n\t\tvector<int> A , B;\n\t\tfor(int j = 0; j < sz; j++)\n\t\t{\n\t\t\tif(s[i][j] == 'a')\n\t\t\t\tA.pb(j);\n\t\t\telse\n\t\t\t\tB.pb(j);\n\t\t}\n\n\t\tfor(int j = 0; j < sz / 2; j++)\n\t\t\tmatch[A[j]] = B[j] , match[B[j]] = A[j];\n\n\t\tif(s[i][0] == 'b')\n\t\t{\n\t\t\tint mx = 0;\n\t\t\tfor(int k = 0; k < sz; k++)\n\t\t\t{\n\t\t\t\tmx = max(mx , match[k]);\n\t\t\t\tif(mx <= k)\n\t\t\t\t{\n\t\t\t\t\tdp[i] = max(dp[i] , s[i].substr(0 , k + 1) + dp[i + (k + 1) / 2]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tdp[i] = max(dp[i] , \"ab\" + dp[i + match[0]]);\n\t}\n\n\tcout << dp[0] << endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fi first\n#define se second\n#define mp make_pair\n#define fastIO ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\nconst int N = 3005;\nint a[N];\nint d[N];\nbool take[N];\n\nvector<int> solve(vector<int> g){ \n  if(g[0] == 0){\n    vector<int> pa, pb;\n    for(int i = 0 ; i < g.size() ; i ++ ){\n      if(g[i] == 0)pa.push_back(i);\n      else pb.push_back(i);\n    }\n    int cur = -1;\n    vector<int> sol;\n    for(int i = 0 ; i < pa.size(); i ++ ){\n      if(pa[i] > cur){\n        sol.push_back(0);\n        sol.push_back(1);\n        cur = pb[i];\n      }\n    }\n    return sol;\n  }\n  else{\n    vector<int> best;\n    vector<int> pa, pb;\n    for(int i = 0 ; i < g.size() ; i ++ ){\n      if(g[i] == 0) pa.push_back(i);\n      else pb.push_back(i);\n    }\n    for(int i = 0 ; i < pb.size(); i ++ ){\n      for(int j = 0 ; j < g.size(); j ++ ){\n        take[j] = false;\n      }\n      for(int j = i ; j < pb.size(); j ++ ){\n        take[pb[j]] = true;\n        take[pa[j]] = true;\n      }\n      vector<int> cur;\n      for(int j = 0 ; j < g.size(); j ++ ){\n        if(take[j])\n          cur.push_back(g[j]);\n      }\n      if(cur > best)\n        best = cur;\n    }\n    return best;\n  }\n}\n\nint main(){\n  fastIO;\n  int n;\n  cin >> n;\n  n *= 2;\n  char f;\n  for(int i = 1; i <= n; i ++ ){\n    cin >> f;\n    a[i] = f - 'a';\n  }\n  for(int i = 1; i <= n; i ++ ){\n    d[i] = d[i - 1] + (a[i] == 0 ? 1 : -1);\n  }\n  vector<string> parts;\n  int b;\n  for(int i = 1; i <= n; i ++ ){\n    if(d[i] == 0){\n      b=i;\n      while(d[b-1] != 0) b--;\n      vector<int> pp;\n      for(int j = b; j <= i ; j ++ ){\n        pp.push_back(a[j]);\n      }\n      vector<int> bes = solve(pp);\n      string go;\n      for(int x : bes){\n        go.push_back((x == 0 ? 'a' : 'b'));\n      }\n      parts.push_back(go);\n    }\n  }\n  string sol;\n  for(int i = (int)parts.size() - 1; i >= 0 ; i -- ){\n    sol = max(sol, parts[i] + sol);\n  }\n  cout << sol << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <string>\n#include <cmath>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <complex>\n#include <unordered_map>\n#include <unordered_set>\n#include <random>\n#include <cassert>\nusing namespace std;\ntypedef long long int ll;\ntypedef pair<int, int> P;\n\nint main()\n{\n\tint n;\n  string s;\n  cin>>n>>s;\n  int a[3010], b[3010];\n  int ia=0, ib=0;\n  for(int i=0; i<2*n; i++){\n    if(s[i]=='a'){\n      a[ia]=i;\n      ia++;\n    }else{\n      b[ib]=i;\n      ib++;\n    }\n  }\n  vector<int> ind;\n  for(int i=0; i<n; i++){\n    ind.push_back(i);\n    if(a[i]<b[i]){\n      while(i<n-1 && b[i]>a[i+1]) i++;\n    }else{\n      while(i<n-1 && a[i]>b[i+1]) i++;\n    }\n  }\n  //for(auto x:ind) cerr<<x<<endl;\n  string ans;\n  ind.push_back(n);\n  for(int t=ind.size()-2; t>=0; t--){\n    int i=ind[t];\n    string ans0;\n    if(a[i]<b[i]){\n      //continue;\n      int r=-1;\n      for(int j=i; j<ind[t+1]; j++){\n        if(a[j]<r) continue;\n        ans0+='a'; ans0+='b';\n        r=b[j];\n      }\n    }else{\n      for(int j=i; j<ind[t+1]; j++){\n        vector<int> v;\n        for(int k=j; k<ind[t+1]; k++){\n          v.push_back(a[k]);\n          v.push_back(b[k]);\n        }\n        sort(v.begin(), v.end());\n        string ans1;\n        for(auto x:v) ans1+=s[x];\n        if(ans0<ans1) ans0=ans1;\n      }\n    }\n    ans=max(ans, ans0+ans);\n  }\n  cout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define qwq(x) cout<<\"# \"<<#x<<\" = \"<<x<<endl;\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef long long ll;\n \ntemplate<class T> inline void read(T &x){\n\tint f=0;x=0;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())f|=(ch=='-');\n\tfor(;isdigit(ch);ch=getchar())x=x*10+ch-'0';\n\tif(f)x=-x;\n}\n\nconst int N=6005;\nint l[N],r[N],id[N],n,cnt,ia,ib;\nstring f[N],g[N];\nchar s[N];\n\nstring calc(int l,int r){\n\tif(s[l]=='a'){\n\t\tstring res;\n\t\tint flag=0;\n\t\trep(i,l,r)\n\t\t\tif(s[i]=='a'){\n\t\t\t\tif(!flag)flag=id[i];\n\t\t\t}\n\t\t\telse if(s[i]=='b'&&flag&&flag==id[i]){\n\t\t\t\tres+=\"ab\";\n\t\t\t\tflag=0;\n\t\t\t}\n\t\treturn res;\n\t}\n\tstring best,now;\n\trep(i,l,r)\n\t\tif(s[i]=='b'){\n\t\t\tnow=\"\";\n\t\t\trep(j,i,r)\n\t\t\t\tif(id[j]>=id[i])\n\t\t\t\t\tnow+=s[j];\n\t\t\tbest=max(best,now);\n\t\t}\n\treturn best;\n}\n\nint main(){\n\tread(n);\n\tscanf(\"%s\",s+1);\n\tint t=0,las=0;\n\trep(i,1,n*2){\n\t\tif(s[i]=='a'){\n\t\t\tt++;\n\t\t\tid[i]=++ia;\n\t\t}\n\t\telse{\n\t\t\tt--;\n\t\t\tid[i]=++ib;\n\t\t}\n\t\tif(t==0){\n\t\t\tl[++cnt]=las+1;\n\t\t\tr[cnt]=i;\n\t\t\tlas=i;\n\t\t}\n\t}\n\trep(i,1,cnt){\n\t\tg[i]=calc(l[i],r[i]);\n\t}\n\tper(i,cnt,1){\n\t\tf[i]=max(f[i+1],g[i]+f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Tenshi ni Fureta yo!\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned int UI;\ntypedef pair<int, int> pii;\n\n#define DEBUG(...) fprintf(stderr, __VA_ARGS__)\n#define MP make_pair\n#define fst first\n#define snd second\n#define SZ(u) ((int) (u).size())\n#define ALL(u) (u).begin(), (u).end()\n\ninline void proc_status()\n{\n\tifstream t(\"/proc/self/status\");\n\tcerr << string(istreambuf_iterator<char>(t), istreambuf_iterator<char>()) << endl;\n}\n\ntemplate<typename T> inline int chkmin(T &a, const T &b) { return b < a ? a = b, 1 : 0; }\ntemplate<typename T> inline int chkmax(T &a, const T &b) { return b > a ? a = b, 1 : 0; }\ntemplate<typename T> inline T sqr(const T &val) { return val * val; }\n\nnamespace fastIO\n{\n\tconst int MAX_BUFFER_SIZE = 1 << 16;\n\n\tchar buffer[MAX_BUFFER_SIZE], *cur = buffer, *ed = buffer;\n\n\tinline char getc() { return *(cur == ed ? ed = buffer + fread(buffer, 1, MAX_BUFFER_SIZE, stdin), cur = buffer : cur)++; }\n}\nusing fastIO::getc;\n\ntemplate<typename T> inline T read()\n{\n\tregister T sum(0), fg(1);\n\tregister char ch(getc());\n\tfor(; !isdigit(ch); ch = getc()) if(ch == '-') fg = -1;\n\tfor(;  isdigit(ch); ch = getc()) sum = sum * 10 - '0' + ch;\n\treturn sum * fg;\n}\n\n// END tpl.\n\nconst int MAXN = (int) 3e3;\n\nint n;\n\nvector<string> S;\n\ninline char safe_getc()\n{\n\tregister char ch(getc());\n\twhile(!isgraph(ch)) ch = getc();\n\treturn ch;\n}\n\ninline void input()\n{\n\tn = read<int>();\n\tstring res;\n\tfor(int cnt = 0, i = 1; i <= 2 * n; ++i)\n\t{\n\t\tchar ch = safe_getc();\n\t\tcnt += ch == 'a' ? +1 : -1;\n\t\tres.push_back(ch);\n\t\tif(cnt == 0) S.push_back(res), res = \"\", cnt = 0;\n\t}\n}\n\ninline string calc(const string &s)\n{\n\tint len = s.length();\n\n\tstatic vector<int> A, B;\n\tA.clear();\n\tB.clear();\n\n\tfor(int i = 0; i < len; ++i)\n\t\tif(s[i] == 'a') A.push_back(i);\n\t\telse B.push_back(i);\n\n\tif(s[0] == 'a')\n\t{\n\t\tstring res = \"\";\n\t\tfor(int lst = -1, i = 0; i < len / 2; ++i) if(A[i] > lst) lst = B[i], res += \"ab\";\n\t\treturn res;\n\t}\n\telse\n\t{\n\t\tstring ans = \"\";\n\t\tfor(int i = 1; i <= len / 2; ++i)\n\t\t{\n\t\t\tstring res;\n\t\t\tint cnta = i, cntb = i;\n\t\t\tfor(int j = len - 1; j >= 0; --j)\n\t\t\t{\n\t\t\t\tif(s[j] == 'a' && cnta > 0) res += 'a', --cnta;\n\t\t\t\tif(s[j] == 'b' && cntb > 0) res += 'b', --cntb;\n\t\t\t}\n\t\t\treverse(ALL(res));\n\t\t\tchkmax(ans, res);\n\t\t}\n\t\treturn ans;\n\t}\n}\n\ninline void solve()\n{\n\treverse(ALL(S));\n\n\tstring ans = \"\";\n\tfor(auto i : S)\n\t{\n\t\tstring res = calc(i);\n\t\tint fg = 1;\n\t\tfor(int j = 0, len = min(res.length(), ans.length()); j < len; ++j)\n\t\t{\n\t\t\tif(res[j] < ans[j]) { fg = 0; break; }\n\t\t\tif(res[j] > ans[j]) break;\n\t\t}\n\t\tif(fg) ans = res + ans;\n\t}\n\tputs(ans.c_str());\n}\n\nint main()\n{\n#ifdef K_ON\n\tfreopen(\"E.in\", \"r\", stdin);\n\tfreopen(\"E.out\", \"w\", stdout);\n#endif\n\n\tinput();\n\tsolve();\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3005;\n\nint n, dp[maxn][maxn], pa[maxn], pb[maxn], c[maxn];\nchar s[maxn<<1], a[maxn<<1], b[maxn<<1];\nbool used[maxn<<1];\n\nbool check(int x)\n{\n\tint cnta = 0, cntb = 0;\n\tfor(int i = x; i <= n; ++i)\n\t\tif(dp[x][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x], pb[x]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\ta[++cnta] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = x + 1; i <= n; ++i)\n\t\tif(dp[x+1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x+1], pb[x+1]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\tb[++cntb] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = 1; i <= min(cnta, cntb); ++i)\n\t\tif(a[i] != b[i])\n\t\t\treturn b[i] > a[i];\n\treturn cntb > cnta;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\tint cnta = 0, cntb = 0;\n\tfor(int i = 1; i <= (n << 1); ++i)\t\n\t{\n\t\tif(s[i] == 'a')\n\t\t{\n\t\t\tpa[++cnta] = i;\n\t\t\tc[i] = cnta;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[++cntb] = i;\n\t\t\tc[i] = cntb;\n\t\t}\n\t}\n\tdp[n][n] = 1;\n\tfor(int i = n - 1; i >= 1; --i)\n\t{\n\t\tdp[i][i] = 1;\n\t\tif(pa[i] > pb[i])\n\t\t{\n\t\t\tint p = n + 1, tot = 0;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t{\n\t\t\t\tif(pb[j] > pa[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t++ tot;\n\t\t\t\tdp[i][j] = 1;\n\t\t\t}\n\t\t\tfor(int j = pa[i] + 1; j <= (n << 1); ++j)\n\t\t\t{\n\t\t\t\tif(s[j] == 'b')\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\t++ tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\tp = max(p, c[j] + 1);\n\t\t\t\t\t\t-- tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint p = n + 1;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t\tif(pa[j] > pb[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tfor(int j = p; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[p][j];\n\t\t}\n\t\tif(check(i))\n\t\t{\n\t\t\tfor(int j = i; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[i+1][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(dp[1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\t\n\t\t}\n\tfor(int i = 1; i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t\tprintf(\"%c\", s[i]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll=int64_t;\n#define int ll\n\n#define FOR(i,a,b) for(int i=int(a);i<int(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define MP make_pair\n#define PB push_back\n#define ALL(x) x.begin(),x.end()\n#ifdef MAROON_LOCAL\n#define cerr (cerr<<\"-- line \"<<__LINE__<<\" -- \")\n#else\nclass CerrDummy{}cerrDummy;\ntemplate<class T>\nCerrDummy& operator<<(CerrDummy&cd,const T&){\n\treturn cd;\n}\nusing charTDummy=char;\nusing traitsDummy=char_traits<charTDummy>;\nCerrDummy& operator<<(CerrDummy&cd,basic_ostream<charTDummy,traitsDummy>&(basic_ostream<charTDummy,traitsDummy>&)){\n\treturn cd;\n}\n#define cerr cerrDummy\n#endif\n#define REACH cerr<<\"reached\"<<endl\n#define DMP(x) cerr<<#x<<\":\"<<x<<endl\n#define ZERO(x) memset(x,0,sizeof(x))\n#define ONE(x) memset(x,-1,sizeof(x))\n\nusing pi=pair<int,int>;\nusing vi=vector<int>;\nusing ld=long double;\n\ntemplate<class T,class U>\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\tos<<\"(\"<<p.first<<\",\"<<p.second<<\")\";\n\treturn os;\n}\n\ntemplate<class T>\nostream& operator <<(ostream& os,const vector<T>& v){\n\tos<<\"{\";\n\tREP(i,(int)v.size()){\n\t\tif(i)os<<\",\";\n\t\tos<<v[i];\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nll read(){\n\tll i;\n\tscanf(\"%\" SCNd64,&i);\n\treturn i;\n}\n\nvoid printSpace(){\n\tprintf(\" \");\n}\n\nvoid printEoln(){\n\tprintf(\"\\n\");\n}\n\nvoid print(ll x,int suc=1){\n\tprintf(\"%\" PRId64,x);\n\tif(suc==1)\n\t\tprintEoln();\n\tif(suc==2)\n\t\tprintSpace();\n}\n\nstring readString(){\n\tstatic char buf[3341000];\n\tscanf(\"%s\",buf);\n\treturn string(buf);\n}\n\nchar* readCharArray(){\n\tstatic char buf[3341000];\n\tstatic int bufUsed=0;\n\tchar* ret=buf+bufUsed;\n\tscanf(\"%s\",ret);\n\tbufUsed+=strlen(ret)+1;\n\treturn ret;\n}\n\ntemplate<class T,class U>\nvoid chmax(T& a,U b){\n\tif(a<b)\n\t\ta=b;\n}\n\ntemplate<class T,class U>\nvoid chmin(T& a,U b){\n\tif(b<a)\n\t\ta=b;\n}\n\ntemplate<class T>\nT Sq(const T& t){\n\treturn t*t;\n}\n\n#define CAPITAL\nvoid Yes(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"YES\"<<endl;\n\t#else\n\tcout<<\"Yes\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\nvoid No(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"NO\"<<endl;\n\t#else\n\tcout<<\"No\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\n\nconst ll infLL=LLONG_MAX/3;\n\n#ifdef int\nconst int inf=infLL;\n#else\nconst int inf=INT_MAX/2-100;\n#endif\n\n/*\nsigned main(){\n\tint n=read();\n\tstring s=readString();\n\tvi pos(n,-1);\n\tint cnt[2]{};\n\tvi cor(n*2,-1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tint j=cnt[s[i]-'a']++;\n\t\tif(pos[j]==-1)\n\t\t\tpos[j]=i;\n\t\telse\n\t\t\tcor[i]=pos[j];\n\t}\n\tcerr<<cor<<endl;\n\tvector<string> ans(n*2+1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\t\n\t}\n}*/\n\nsigned main(){\n\tint n=read();\n\tstring s=readString();\n\tvi pos(n,-1);\n\tint cnt[2]{};\n\tvi cor(n*2,-1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tint j=cnt[s[i]-'a']++;\n\t\tif(pos[j]==-1)\n\t\t\tpos[j]=i;\n\t\telse\n\t\t\tcor[i]=pos[j];\n\t}\n\tcerr<<cor<<endl;\n\tstring ans;\n\tint t=n*2;\n\tfor(int i=n*2-1;i>=0;){\n\t\tif(s[i]=='b'){\n\t\t\tint j=i,cur=0;\n\t\t\twhile(1){\n\t\t\t\tcur+=(s[j--]-'a')*2-1;\n\t\t\t\tif(cur==0)break;\n\t\t\t}\n\t\t\ti=j;\n\t\t\tt=i+1;\n\t\t}else\n\t\t\tbreak;\n\t}\n\tcerr<<t<<endl;\n\tvector<string> dp(t+1);\n\tfor(int head=t-1;head>=0;head--)if(s[head]=='b'&&cor[head]!=-1){\n\t\tvi use(n*2,0);\n\t\tstring w;\n\t\tint right=cor[head],i=head;\n\t\twhile(i<=right){\n\t\t\tif(s[i]=='b'){\n\t\t\t\tif(cor[i]!=-1){\n\t\t\t\t\tw+=s[i];\n\t\t\t\t\tuse[cor[i]]=1;\n\t\t\t\t\tright=cor[i];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(use[i])\n\t\t\t\t\tw+=s[i];\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tcerr<<i<<\" \"<<w<<endl;\n\t\tw+=dp[i];\n\t\tdp[head]=w;\n\t\tchmax(ans,w);\n\t}else\n\t\tdp[head]=dp[head+1];\n\tcerr<<dp<<endl;\n\tfor(int i=t;i<n*2;){\n\t\tif(s[i]=='a'){\n\t\t\tans+=\"ab\";\n\t\t\ti=cor[i];\n\t\t}else{\n\t\t\ti++;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "// Why I am so dumb? :c\n#include <bits/stdc++.h>\n\n#define pb push_back\n#define mp make_pair\n\n#define all(x) (x).begin(), (x).end()\n\n#define fi first\n#define se second\n\nusing namespace std;\n\ntypedef long long ll;\n\nvector<int> pos[2];\n\nbool mark[6005];\n\nchar s[6005];\n\nstring ans;\n\nint n;\n\nvoid solve() {                   \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s);\n\n    for (int i = 0; s[i]; ++i) {\n        pos[s[i] - 'a'].pb(i);\n    }\n\n    vector<pair<int, int>> vv;\n\n    for (int i = 0; i < n; ++i) {\n        if (pos[0][i] > pos[1][i]) {\n            vv.pb(mp(pos[0][i], pos[1][i]));\n        }\n    }    \n\n    if (vv.empty()) {\n        int cur = -1;\n\n        for (int i = 0; i < n; ++i) {\n            if (pos[0][i] > cur) {\n                cur = pos[1][i];\n                ans += \"ab\";\n            }\n        }\n\n        cout << ans << '\\n';\n        return;\n    }    \n\n    for (int l = 0; l < vv.size(); ++l) {\n        for (int r = l; r < vv.size(); ++r) {\n            for (int i = 0; i < (n << 1); ++i) {\n                mark[i] = 0;\n            }\n\n            for (int i = l; i <= r; ++i) {\n                mark[vv[i].fi] = 1;\n                mark[vv[i].se] = 1;\n            }\n\n            string cur;\n            int p = 0;\n\n            for (int i = 0; i < (n << 1); ++i) {\n                if (mark[i]) {\n                    cur += s[i];\n                    p = i;\n                }\n            } \n                    \n            for (int i = 0; i < n; ++i) {\n                if (pos[0][i] > pos[1][i]) {\n                    continue;\n                }\n\n                if (pos[0][i] > p) {\n                    cur += \"ab\";\n                    p = pos[1][i];\n                }\n            }\n\n            ans = max(ans, cur);\n        }\n    }\n\n    cout << ans;\n}\n\nint main() {    \n    int tt = 1;\n\n    while (tt--) {\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 6000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res = \"ab\";\n    int pa = l + 1, pb = b[l];\n\n    while(a[r] > pb) {\n        while(a[pa] < pb) ++ pa;\n        res += \"ab\";\n        pb = b[pa];\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i; else b[++ b[0]] = i;\n    }\n\n    string tmp;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        while(!stk.empty() && tmp > stk.back()) {\n            stk.pop_back();\n        }\n        stk.push_back(tmp);\n    }\n    for(auto s : stk) std::cout << s;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdlib>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cmath>\n#include<set>\n#include<map>\nusing namespace std;\ntypedef long long LL;\nconst int N = 6e3+10;\ninline int read()\n{\n\tregister int x = 0 , f = 0; register char c = getchar();\n\twhile(c < '0' || c > '9') f |= c == '-' , c = getchar();\n\twhile(c >= '0' && c <= '9') x = (x << 3) + (x << 1) + c - '0' , c = getchar();\n\treturn f ? -x : x;\n}\nint n;\nint pa[N] , pb[N] , id[N] , nx[N];\nstring s , f[N];\nint main()\n{\n\tcin >> n; cin >> s; s = \" \" + s;\n\tint cnta = 0 , cntb = 0;\n\tfor(int i = 1 ; i <= n * 2 ; ++i)\n\t\tif(s[i] == 'a') pa[id[i] = ++cnta] = i; else pb[id[i] = ++cntb] = i;\n\tpa[n + 1] = pb[n + 1] = 2 * n + 1; id[n * 2 + 1] = n + 1;\n\tfor(int i = 1 , j = 0 ; i <= n + 1 ; ++i)\n\t\twhile(j < min(pa[i] , pb[i])) nx[++j] = i;\n\tfor(int i = n ; i >= 1 ; --i)\n\t{\n\t\tif(pb[i] < pa[i])\n\t\t{\n\t\t\tint j = pb[i];\n\t\t\tfor( ; pb[id[j]] < pa[id[j]] && (id[j] <= i || pa[id[j] - 1] > pb[id[j]]) ; ++j)\n\t\t\t\tif(id[j] >= i) f[i] += s[j];\n\t\t\tf[i] += f[id[j]];\n\t\t}\n\t\telse\n\t\tf[i] = \"ab\" + f[nx[pb[i] + 1]];\n\t\tf[i] = max(f[i] , f[i + 1]);\n\t}\n\tcout << f[1] << '\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n  bool used[2*n];fill(used,used+2*n,false);\n \n \n  bool t=true;int x=0;\n string sx;\n   string ss;\n  for(int i=2*n-1;i>=0;i--){\n    if(x==0){\n      if(s[i]=='a'){\n        t=false;\n        used[i]=true;\n        x++;\n        }\n      else{\n        if(t)sx.push_back(s[i]);\n        x--;\n      } \n   \n      continue;\n    }\n    if(x>0)used[i]=true;\n    if(x<0&&t)sx.push_back(s[i]);\n      if(s[i]=='a')x++;\n      else x--;\n  }\nreverse(sx.begin(),sx.end());\n  for(int i=0;i<2*n;i++)if(used[i])ss.push_back(s[i]);\n  string ans=ss,ans2=sx;\n  while(!ss.empty()){\n    int i=0;\n    while(ss[i]=='b')i++;\n    ss.erase(ss.begin()+i);\n    ss.erase(ss.begin());\n    ans=max(ans,ss);\n  }\nstring sxx[sx.size()];\nbool b[sx.size()]={};\nfor(int i=sx.size()-1;i>=0;i--){\n  if(sx[i]=='b'){\n   if(i!=sx.size()-1) sxx[i]=sxx[i+1];\n  \n    continue;\n  }\n  for(int j=sx.size()-1;j>i;j--)if(sx[j]=='b'&&b[j]==false){\n    b[j]=true;\n    sxx[i]=\"ab\"+sxx[j];\n    break;\n  }\n\n  ans2=max(ans2,sxx[i]);\n}\n  cout<<ans<<ans2<<endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ff first\n#define ss second\n#define pb push_back\n#define mp make_pair\ntypedef long long LL;\ntypedef unsigned long long uLL;\ntypedef pair<int,int> pii;\n\nconst int maxn=6111;\nint n,a[maxn],b[maxn],ps[maxn];\nchar s[maxn],tmpv[maxn];\n\nvector<string> vs;\nvoid check(int l,int r)\n{\n\tif(a[l]<b[l])\n\t{\n\t\tint tot=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\ttmpv[tot++]='a';tmpv[tot++]='b';\n\t\t\tint tmp=i;\n\t\t\twhile(i<=r&&a[i]<b[tmp])i++;\n\t\t\ti--;\n\t\t}\n\t\ttmpv[tot]=0;\n\t\tvs.pb(string(tmpv));\n\t}\n\telse\n\t{\n\t\tstring opt=\"\";\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tint tot=0;\n\t\t\tfor(int j=b[l];j<=a[r];j++)if(ps[j]>=i)tmpv[tot++]=s[j];\n\t\t\ttmpv[tot]=0;\n\t\t\topt=max(opt,string(tmpv));\n\t\t}\n\t\tvs.pb(opt);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\t\n\tint cnta=0,cntb=0,last=0;\n\tfor(int i=1;i<=n+n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[++cnta]=i;\n\t\t\tps[i]=cnta;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[++cntb]=i;\n\t\t\tps[i]=cntb;\n\t\t}\n\t\tif(cnta==cntb)\n\t\t{\n\t\t\tcheck(last+1,cnta);\n\t\t\tlast=cnta;\n\t\t}\n\t}\n\t\n\tstring ans=\"\";\n\tfor(int i=(int)vs.size()-1;i>=0;i--)\n\t{\n\t\tif(vs[i]+ans>ans)ans=vs[i]+ans;\n\t}\n\tprintf(\"%s\\n\",ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int I = 0;\n    while (I < s.size()){\n        int b = 2*(s[I] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=I+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({I, j});\n                good.push_back(b < 0);\n                I = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({I, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            return 1;\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw){\n            continue;\n        }\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nstring solve(int n, string s) {\n\tvector<int> a(n), b(n), c(2 * n);\n\tint ca = 0, cb = 0;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') c[i] = ca, a[ca++] = i;\n\t\tif (s[i] == 'b') c[i] = cb, b[cb++] = i;\n\t}\n\tvector<string> dp(2 * n), cmax(2 * n + 1);\n\tfor (int i = 2 * n - 1; i >= 0; --i) {\n\t\tint others = (s[i] == 'a' ? b[c[i]] : a[c[i]]);\n\t\tif (others >= i) {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\tdp[i] = \"ab\" + cmax[others + 1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvector<int> st;\n\t\t\t\tint right = i;\n\t\t\t\tfor (int j = c[i]; j < n; ++j) {\n\t\t\t\t\tif (a[j] < b[j]) continue;\n\t\t\t\t\tif (!st.empty() && b[j] > right) break;\n\t\t\t\t\tst.push_back(a[j]);\n\t\t\t\t\tst.push_back(b[j]);\n\t\t\t\t\tright = max(right, a[j]);\n\t\t\t\t}\n\t\t\t\tsort(st.begin(), st.end());\n\t\t\t\tstring prefix;\n\t\t\t\tfor (int j : st) prefix += s[j];\n\t\t\t\tdp[i] = prefix + (st.empty() ? \"\" : cmax[st.back() + 1]);\n\t\t\t}\n\t\t}\n\t\tcmax[i] = max(cmax[i + 1], dp[i]);\n\t}\n\treturn cmax[0];\n}\nint main() {\n\tint n; string s;\n\tcin >> n >> s;\n\tcout << solve(n, s) << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nP2<string,Vct<int> > f[6005];\nint id[6005];\nstring st;\nint pos[2][6005];\nVct<int>t;\nint cmp(int a,int b)\n{\n\tt.clear();\n\tt=f[b].Se;\n\tt.Pb(a);\n\tt.Pb(id[a]-1);\n\tsort(t.begin(),t.end());\n\tstring st2=\"\";\n\t//cout<<\"!\";\n\tfor(int i=0;i<t.size();i++)\n\t{\n\t\tst2+=st[t[i]];\n\t\t//cout<<t[i]<<\" \";\n\t}\n\t//cout<<st2<<\" \"<<a<<\"-\"<<b<<\" \"<<(bool)(st2>f[a].Fi)<<endl;\n\tif(f[a].Fi<st2)\n\t{\n\t\tf[a].Se=t;\n\t\tf[a].Fi=st2;\n\t}\n\treturn 0;\n}\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tf[i].Fi=\"0\";\n\t\tif(st[i]=='a')pos[0][++pos[0][0]]=i;\n\t\telse pos[1][++pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[0][i]<<\" \"<<pos[1][i]<<endl;\n\t}\n\t*/\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(pos[0][i]<pos[1][i])id[pos[0][i]]=pos[1][i]+1;\n\t\telse id[pos[1][i]]=pos[0][i]+1;\n\t}\n\tstring mx;\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\t//cout<<i<<\" \"<<id[i]<<endl;\n\t\tif(!id[i])continue;\n\t\tf[i].Fi=\"\";\n\t\tf[i].Fi+=st[i];\n\t\tf[i].Fi+=st[id[i]-1];\n\t\tf[i].Se.Pb(i);\n\t\tf[i].Se.Pb(id[i]-1);\n\t\t//cout<<\"!\"<<i<<\" \"<<id[i]-1<<\" \"<<f[i].Fi<<\"!\"<<endl;\n\t\tfor(int j=i+1;j<st.Sz();j++)\n\t\t{\n\t\t\t//cout<<\"!\"<<j<<endl;\n\t\t\t//cout<<i/*<<\" \"<<f[i].Fi*/<<\":\"<<j<<\" \";\n\t\t\tcmp(i,j);\n\t\t\t//cout<<endl;\n\t\t}\n\t\t//cout<<\">\"<<i<<\" \"<<f[i].Fi<<endl;\n\t\tmx=max(mx,f[i].Fi);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\nint fre(int i) {\n\tint id = loc[i];\n\tif (s[i] == 'a')return vb[id];\n\telse return va[id];\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (fre(i)>i) {\n\t\t\t\tint to = fre(i) + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[fre(i)] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn;\n\n\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size()) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && fre(to) < to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i] | ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\n\nstring nex[6000];\nint nexri[6000];\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tbz[i][i] = bz[i][fre(i)] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tbz[i][j] = bz[i][fre(j)] = 1;\n\t\t\t\t\t\tri = fre(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnex[i] = trans(bz[i]);\n\t\t\t\tnexri[i] = ri + 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tint cur = 0;\n\tstring ans;\n\twhile (cur < 2 * n) {\n\t\tstring ma = \"\"; int to = -1;\n\t\tRep(i, cur, 2 * n) {\n\t\t\tif (ma<nex[i]) {\n\t\t\t\tma = nex[i]; to = nexri[i];\n\t\t\t}\n\t\t}\n\t\tif (to < 0) {\n\t\t\tans += \"ab\";\n\t\t\tto = fre(cur) + 1;\n\t\t}\n\t\telse {\n\t\t\tans += ma;\n\t\t}\n\t\twhile (to<2 * n&&fre(to) < to)to++;\n\t\tcur = to;\n\t}\n\tcout << ans << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 97];\n    }\n    for (int i = n; i >= 1; --i) {\n        dp[i] = dp[i + 1];\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n        dp[i] = max(dp[i], dp[i + 1]);\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <map>\n#include <set>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <vector>\n#include <bitset>\n#include <cstdio>\n#include <cctype>\n#include <string>\n#include <numeric>\n#include <cstring>\n#include <cassert>\n#include <climits>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std ;\n#define rep(i, a, b) for (register int i = (a); i <= (b); ++i)\n#define per(i, a, b) for (register int i = (a); i >= (b); --i)\n#define loop(it, v) for (auto it = v.begin(); it != v.end(); it++)\n#define cont(i, x) for (register int i = head[x]; i; i = edge[i].nex)\n#define clr(a) memset(a, 0, sizeof(a))\n#define ass(a, cnt) memset(a, cnt, sizeof(a))\n#define cop(a, b) memcpy(a, b, sizeof(a))\n#define lowbit(x) (x & -x)\n#define all(x) x.begin(), x.end()\n#define SC(t, x) static_cast <t> (x)\n#define ub upper_bound\n#define lb lower_bound\n#define pqueue priority_queue\n#define mp make_pair\n#define pb push_back\n#define pof pop_front\n#define pob pop_back\n#define fi first\n#define se second\n#define y1 y1_\n#define Pi acos(-1.0)\n#define iv inline void\n#define enter putchar('\\n')\n#define siz(x) ((int)x.size())\n#define file(x) freopen(x\".in\", \"r\", stdin),freopen(x\".out\", \"w\", stdout)\ntypedef double db ;\ntypedef long long ll ;\ntypedef unsigned long long ull ;\ntypedef pair <int, int> pii ;\ntypedef vector <int> vi ;\ntypedef vector <pii> vii ;\ntypedef queue <int> qi ;\ntypedef queue <pii> qii ;\ntypedef set <int> si ;\ntypedef map <int, int> mii ;\ntypedef map <string, int> msi ;\nconst int maxn = 6e3 + 100 ;\nconst int inf = 0x3f3f3f3f ;\nconst int iinf = 1 << 30 ;\nconst ll linf = 2e18 ;\nconst ll mod = 998244353 ;\nconst double eps = 1e-7 ;\ntemplate <class T = int> T read()\n{\n\tT f = 1, a = 0;\n\tchar ch = getchar() ;\n\twhile (!isdigit(ch)) { if (ch == '-') f = -1 ; ch = getchar() ; }\n\twhile (isdigit(ch)) { a =  (a << 3) + (a << 1) + ch - '0' ; ch = getchar() ; }\n\treturn a * f ;\n}\n\nint n, last = 1, lpos = 1;\n\nchar s[maxn];\n\nint posa[maxn], posb[maxn], suma, sumb, rnk[maxn];\n\npair <string, int> c[maxn];\n\nstring ans;\n\nint tot;\n\nvoid solve(int l, int r)\n{\n\t++ tot;\n\tc[tot].se = tot;\n\tif(s[l] == 'a')\n\t{\n\t\tint pos = l;\n\t\twhile(pos < r)\n\t\t{\n\t\t\tc[tot].fi += \"ab\";\n\t\t\tpos = posb[rnk[pos]] + 1;\n\t\t\twhile(s[pos] == 'b' && pos <= r) pos ++;\n\t\t}\n\t}\n\telse\n\t{\n\t\trep(i, lpos, rnk[r])\n\t\t{\n\t\t\tstring tmp = \"\";\n\t\t\trep(j, l, r) if(rnk[j] >= i) tmp += s[j];\n\t\t\tc[tot].fi = max(c[tot].fi, tmp);\n\t\t}\n\t}\n}\n\nsigned main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\trep(i, 1, 2 * n)\n\t{\n\t\tif(s[i] == 'a') posa[++ suma] = i, rnk[i] = suma;\n\t\telse posb[++ sumb] = i, rnk[i] = sumb;\n\t\tif(suma == sumb) solve(last, i), last = i + 1, lpos = suma + 1;\n\t}\n\tper(i, n, 1) ans = max(ans, c[i].fi + ans);\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntemplate<typename T> void cmax(T &x, const T &y)\n{\n\tif(y > x) x = y;\n}\n\ntemplate<typename T> void read(T &x)\n{\n\tx = 0;\n\tchar c = getchar();\n\tbool f = 0;\n\twhile(!isdigit(c) && c!='-') c = getchar();\n\tif(c == '-') f = 1, c = getchar();\n\twhile(isdigit(c)) x = x*10+c-'0', c = getchar();\n\tif(f) x = -x;\n}\n\nstring calca(string s)\n{\n\tvector<int> pa, pb;\n\tstring ret;\n\tfor(int i=0; i<s.length(); i++)\n\t\tif(s[i] == 'a') pa.push_back(i);\n\t\telse pb.push_back(i);\n\tint lst = -1;\n\tfor(int i=0; i<pa.size(); i++)\n\t\tif(pa[i] > lst) ret += \"ab\", lst = pb[i];\n\treturn ret;\n}\n\nstring calcb(string s)\n{\n\tvector<int> pa, pb;\n\tstring ret;\n\tfor(int i=0; i<s.length(); i++)\n\t\tif(s[i] == 'a') pa.push_back(i);\n\t\telse pb.push_back(i);\n\tfor(int i=0; i<pa.size(); i++)\n\t{\n\t\tstring cur;\n\t\tauto ia = pa.begin()+i, ib = pb.begin()+i;\n\t\twhile(ia!=pa.end() && ib!=pb.end())\n\t\t\tif(*ia < *ib) cur.push_back('a'), ia++;\n\t\t\telse cur.push_back('b'), ib++;\n\t\twhile(ia != pa.end()) cur.push_back('a'), ia++;\n\t\twhile(ib != pb.end()) cur.push_back('b'), ib++;\n\t\tcmax(ret, cur);\n\t}\n\treturn ret;\n}\n\nint main()\n{\n\tint n;\n\tstring str;\n\tread(n);\n\tcin >> str;\n\tint sum = 0;\n\tstring cur, nxt;\n\tvector<string> ans;\n\tfor(auto c : str)\n\t{\n\t\tif(c == 'a') sum--;\n\t\telse sum++;\n\t\tcur.push_back(c);\n\t\tif(sum == 0)\n\t\t{\n\t\t\tif(*cur.begin() == 'a') nxt = calca(cur);\n\t\t\telse nxt = calcb(cur);\n\t\t\twhile(ans.size())\n\t\t\t{\n\t\t\t\tbool greater = 0;\n\t\t\t\tfor(int i=0; i<min(nxt.length(), ans.back().length()); i++)\n\t\t\t\t\tif(nxt[i] != ans.back()[i])\n\t\t\t\t\t{\n\t\t\t\t\t\tif(ans.back()[i] < nxt[i]) greater = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tif(greater) ans.pop_back();\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tans.push_back(nxt);\n\t\t\tcur.clear();\n\t\t}\n\t}\n\tfor(auto i : ans) cout << i;\n\tcout << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tint lsta = 0;\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tcntb += o[k] == 'b';\n\t\t\t\tif(o[k] == 'a') {\n\t\t\t\t\tcnta += o[k] == 'a';\n\t\t\t\t\tif(to.empty() || to.back() == 'b') to += 'a', lsta = cnta;\n\t\t\t\t} else {\n\t\t\t\t\tcntb += o[k] == 'a';\n\t\t\t\t\tif(cntb == lsta) to += 'b';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\n \nusing namespace std;\nusing namespace __gnu_pbds;\n \n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n \ntypedef long long ll;\ntypedef pair<int,int> ii;\ntypedef vector<int> vi;\ntypedef long double ld; \ntypedef tree<ii, null_type, less<ii>, rb_tree_tag, tree_order_statistics_node_update> pbds;\n\nint a[3333];\nint b[3333];\nint iv[6666];\n\nint main()\n{\n\tios_base::sync_with_stdio(0); cin.tie(0);\n\tint n; cin>>n;\n\tstring s; cin>>s;\n\tint acnt = 0; int bcnt = 0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a') {iv[i] = acnt; a[acnt++] = i;}\n\t\telse {iv[i] = bcnt; b[bcnt++] = i;}\n\t}\n\tvector<ii> groups;\n\tint l=0; \n\tfor(int i=0;i<n;i++)\n\t{\n\t\tif(i>0&&min(a[i],b[i])>max(a[i-1],b[i-1]))\n\t\t{\n\t\t\tgroups.pb(mp(l,i-1));\n\t\t\tl=i;\n\t\t}\n\t}\n\tgroups.pb(mp(l,n-1));\n\tvector<string> bestg;\n\tfor(int z=0;z<groups.size();z++)\n\t{\n\t\tint l = groups[z].fi; int r = groups[z].se;\n\t\tif(a[l]>b[l])\n\t\t{\n\t\t\tset<int> S;\n\t\t\tstring best = \"\"; \n\t\t\tfor(int i=r;i>=l;i--)\n\t\t\t{\n\t\t\t\tstring cur=\"\";\n\t\t\t\tS.insert(a[i]); S.insert(b[i]);\n\t\t\t\tfor(int v:S) cur+=s[v];\n\t\t\t\tif(cur>best) best=cur;\n\t\t\t}\n\t\t\tbestg.pb(best);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring cur = \"\";\n\t\t\tint i=a[l];\n\t\t\twhile(i<=b[r])\n\t\t\t{\n\t\t\t\tif(s[i]=='a')\n\t\t\t\t{\n\t\t\t\t\tcur+=\"ab\";\n\t\t\t\t\ti = b[iv[i]]+1;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbestg.pb(cur);\n\t\t}\n\t}\n\tstack<string> S;\n\tfor(string x:bestg)\n\t{\n\t\twhile(!S.empty()&&x>S.top()) S.pop();\n\t\tS.push(x);\n\t}\n\tstring ans;\n\tvector<string> V; while(!S.empty()) {V.pb(S.top()); S.pop();}\n\tfor(int i=int(V.size())-1;i>=0;i--) ans+=V[i];\n\tcout<<ans<<'\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int l=1;l<=len;l++)s1[l+len1]=ans[l];\n\t\tlen1+=len;\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*\nCoded by 秦惜梦\nThe most attractive girl in the world\n.........   `;!!!!!!!!!;;;;;;;;::::::'''''''``''''''''````````````````````....`:;;;;;:'.....`:|$$$$$$$|;;;:`.    ..........`''``...`''``.   ........   ...  ...   ....  ...   ...  '\n........     '!!!!!!!!!;;;;;;;:::::::::''''':::''''`````````````````````......`:;;;;;!%$$%!'.....`:|$%!;;;'....   .....`....`'''`...```..    ........  ..   ...    ..   ...  ...   '\n........     .:!!!!!!!!;;;;;;;:::::::::::::::'''''''`````````..```````........`:;!%$$$$$$$$$$$%!'.....`:|!'````..   .........`''``.......    ........  ...  ...   ...   ..   ..   .'\n.......       `;!!!!!!;;;;;;;;::::::::::::::::'''''```````````.``````...       .`';|%$$$$$&&$$$$$$%%;'..`'':'''``..  ...``.....```.   ....    .......  ...  ...   ...  ...  ...   .'\n.......      . '!!!!!!;;;;;;;:::'''''''''::::::'''```````````````````.........':'`.......`:!%%|||%$$$$$&%;'::::''``.   .```..   ....   ....   .......   ..  ...   ..   ...  ...  ..'\n......      '::'''':::::::::::::'''''''''''::::''''``````````````````.........'!$$$$$$%!:`.......`:!%&&&|'``':::'''``.....```.   ....   ...    ......   .......   ..   ..  ...   ..'\n``...       .`.``'::::::::;;;;:::::'''''''`'''''`````````````..```````........'!$$$$$$$$$$$$$$%!;'`.....`'`..`'::''''`.....```..  ....   ...   ......   ........ .... .......  ....'\n````.      .````.`;!!!;;;;;;;;::'''''''``'''''`````````````````````````.. ....`:!|%$$$&&&&&&&$%%$&&&&@&$|::'`.`''''''''`....````.  ....   ...   ......   .  .....```..``.....  ... '\n````      .````.  `;!!;;;;;;;:::::'''''':::'''''````````````........`````.... ........````........``'::::::::'``.``'''''``...````.. ....   ...  ......   .  ......``.```....   ..  '\n```.      .```.  .`';!!;;;;;;;:::::::::::::'''''``````````..........````````...`;$$$$&&&&&&$%%||||!|!;;::::::::'`...`'''''`....````.  .... ...   .....   .   .. .``..```....  ..   '\n``.       .``.  .`'`';!;;;;;;;;:::::::::::'''''`````````...........`````````....'!|%%%%%%%%%%%%%%%%%%$&&&|:'''''''`...`'''''`....```.  .... ...   .....  .   ..  ..  ......   .   .'\n`.        .`.  `''''`';!;;;;;;;::::::::::'''''''```````..........````````````....:|%%%%%%%%%%%%%%%%%%%%%%|:`''''''''`...`''''`....```.. ...   ..  .....  ..  .   ..  .. ...  ..  ..'\n`         .  .`'''''``';!;;;;;;;:::::::''''''''''```.``........```````````````````!%%%%%%%%%%||!;:''`.........`'''''''`...`''''`...````.....  ..   ....  ..  .   .   .  ..  ..  ...'\n            .''''''````';!;;;;;;;:::::'''''''''''```````````````````````````.........``````...  ...```':;!!:....`'''''''``..`'''`....```.  ... ..  ....      ..  .   .  ..  ..  ...'\n         .`''''''''``````;!;;;;;;:::::'''''''''''``````````'''''''''``....```````````````````````````':!||%|;``....`''''''``..`''``....`..  ...     ...   .  .   .  .. ..  .   ... '\n        .'''''''''````````:;;;;:::'''''':::::::::::::''''''''''''``..``````....```````````````````````````:!!'`'`.....`'''''``...```.  .........    ....     .  ..  .  .  ..  ...  '\n        `'''''''''````';;;:::::::::::::::::::::::''''```````````..........```````````````````````````````````'`.``'``....`''''``.. .`.. ..... ...    ...        .  .. ..  .   ..   '\n       .'''''''''```````';;:::::''''''''''''''''''`''```````.`````.....````````````````````````````````''``````....``''`...``''```......  ........   ...     .     .  .  .   ..    '\n       `''''''''````'''`````.`::::::::'''''''''''''''''``.``.```........````````````''''`````````````````''''''''`....``'``...``````...... ........   ..     .  .  . .   .  ..     '\n      .`'''''''```'''''````````':::::::''''''''''''''``.``.`............`````````'''''''''''''''``````````'''''''''`.....````....```...  ..  ......    .                .   .     .'\n      `'''''''`''''''''````````.`::::::'''''''''''''`.```..............``````````'''''''''''''''''````````''''''''''``.......```.........  .  ....     .     ........              '\n     .`''''''`''''''''``````````.`:::::::'''''''''``.`..............```````'''''''''''''''''''''''''``````'''''''''''''.........``... .....  .  ...     ..`:::::::::::::'`.        '\n      .'''''`''''''''``````````````':::::''''''''``..````````````````````''''''''''''''''''':''''''```''````''''::''''''`.```..........  .....   ....    `'::::::::::::::::`.      '\n     ....`''''''''''```````````````.`':::::'''''`...``````````''''''''''''''''''''''''''''''';:'''``''`::````';:''''''''''.....``......... .....   ...   `::::::::::::::::::'`.....'\n    ......`''''''''``````````````````.':::::::'`...``'''````''''''''''''''''''''''''''''''';!:;:'''':!;::'```````''''''''''`   ........ ..... ...    ..  ....`':::':::::::::::'... '\n    .......`'''''`````````````````````.`':::'```.`''''''````''''''''':'''::'''::''':;::!!!;:;!;;:```````::`````````'''''''''`.     ............  ..   ..          .':::::::::''`   '\n   ........`''`````````````````````````..`':''`:;:'':''':''''''''''''::'':;:'''''''''::'''''':;;;:``````:;'```''``````'``'''''`.... ...........    ..                 `::::::'`.   '\n  ..........`````````````````````````'::::''':;!!!!;:'::':!;;;:::'''';;'''::::''''':'''::'''''''::'`````':''``''````::`':'''''''''.         ......                      .''`....   '\n.`'`.......```````````````````````````````'':!;:::::::::':;::::::::''::''`''::::'`''''':::'':''`:;'`````':'```''`````::`````'''''':;'..................                 .......  . '\n`'''''```````````````````````````````````.`;!:::::::::::'''::::::::''::''``'::::'``'''''::''''''':'````````````'`````''````````````:!!;'................              ..........   '\n'''''`````````````````````````````````````;!;;;:':::''::''''::::;;:'':::'```'::'````''''''''''''':'```````````''````````````````````';!!!;'....  ......               .......      '\n''''````````````````````````````````````';!;;;:'::::':''`''':::;;;:'''':'``'':'````.```''''''''`':'````````````'`````````..``....`...`:!!!!:`.`.....                    .          '\n'''````````````````````````````````````':;!;;:`'::':'''``''':::;;;:''``'```'':'``....''`'''''''`''`.`````````````.````````.............';;'.`:;;;'`.                 .....   ...   '\n''````````````````````````````````````'':!;::'`::':::''`''''':;;;;:```````'''''```...''`'''''''`''`.``.````````````````````............... `;;;;;;;;;:`.                ....   ....'\n''''''''````````````````````````````''`:!;;:''':''::''`'':''':;;;;'```'```''''''`.`'``:'''::''''''```````````````````````````.............`:;;;;;;;;;;;'.      .         ....    ..'\n:::::::''''````````````````````````''`'!!;:''''''':''`''''''':;;;:```::``'''':'''`';:';:'::::':`''`''`````````````````'``````````..........`:;;;;;;;;;:.     `'..          .....   '\n|%$$%%!;;:'''````````````````````''``';!;:'''':'``'''`'':''':::;:'``:!:``':::::::`:!;';;':::::''`''::````'''''````````''`````````...........`:;;;;;;;'.    .':` `;;;;:. ..   ..... '\n@@@@@@@@$|;:''`````````````````''```';!;:::::::'``````'':''::::::'`'!|:`':::;:::'';|!:;;'''''''::::;:``'::''`'````````''````````````.........`:;;;;;`     .:;'..';;;;;;;;;:` ......'\n@@@@@@@@@@$|;:''`````````````:'`````;;;:';;;;::'`'````'':''::::::'`;!!;':::::::'`.';!;;;:::::';!!::;'`':::'``'`.``````''````````.......... ..``';;:`     .';;` `:;;;;;;;;;:` `;;;;;;\n@@@@@@@@@@@&|;:'``````````''```````;;::':;;;;:'`''```'':'::::;;;:':;|!!;:'''''::::!||!!!!;!!!!||;:!'`:::::'````..``````''`````.......... .  ..`':;`     .';;:` ';;;;;;;;;;:. ';;;;;;\n@@@@@@@@@@#@$!:''`````````````````::```';;;;::``'''``'::':::;;;::;;!|||!::;;!!!;;;:'``````'':!!!!|:``':::'`````:;:`.``````.............   . ..`';'     .';;;'..:;;;;;;;;;;'..';;;;;;\n@@@@@@@@@@@@$|;:'````````````````::````:;;;::'.`''```''''':::;:::;||%|||%%%%%|!:''''`...`'':!;:;|;```:::'``''`';!;'..`````..............  . ..`''.    .';;;:` `;;;;;;;;;;;' .:;;;;;;\n@@@@@@@@@@@&%!;:'```````````````''````':;;;::'..''```````:::::';||%%%%%%$$&&&%!;!|$&%:..';!%%!!|!'`;::::'``''';!;;'...````..............  ....``..   .';;;;'..';;;;;;;;;;;` `:;;;;;;\n@@@@@@@@@#@%!!;:'````````````````````.'''::::`..````'''::!||||%%%%&&&&&&&&&&&&&$&&&%||||!|%%%%|!:';;;;!;``''`:;;;:`....`...................`....```. .`':::` `:;;;;;;;;;;:` `;;;;;;;\n@@@@@@##@$|!!;:''```````````````````````':'```..`````':!;:''''':!%$&&&&&&&&&&&&$$$|!;;!|%%%%%%|;':;''::'`'''`:!;:`........................```..````........  .':;;;;;;;;;'. ';;;;;;;\n!%$$$$%%|!!!;:''``````````````````````````````````````';!:'::'``':|$&&&&&&&&&&&&$$$$$$$$%%%%%|!:```''::'''''```...........................``..`'''`........   ......'::;;'..';;;;;;;\n;!!!!!!!!!!;:''``````````````````````````````..````````'!%!;!;;!!%$%$&&&&&&&&&&&&$$$$$$$$$$%%||;``'''':''''``..`....    ... .................`'''````.....   .....`.......  `::;;;;;\n::;!!!!!;;:''````````````````````````````````...````````'!%|!|%$$$$%$&&&&&&&&&&&&&&$$$$$$$$%|||:``''''''''```..`....      ..    ...     ....`'''`''```....   .'|%%;......    .... .'\n``'::::'''````````````````````````````````````..`...```'`'|&$$$$$$$%$&&&&&&&&&&&&&&$$$$$$$$%%%|:`'''''''''```..`....                    ....`''```''```... .:%%%%|:......   .......'\n .````````````````````````````````````````````.``..```````:|&$$$$$$|%$&&&&&&&&&&&&&&&&&$$$$%%%|:'`'''''''````..`....                      .``'`````''````. :%%%%%;`....... ........'\n  .``````````````````````````````````````````..`..`````````:%&&&&&&$%|%$&&&&&&&&&&&&&&&&$$$%$%|:'`'''''''````.``.....                    .``'`````'`'':|:.'!%%%%|'.`````.   .......'\n  .```````````````````````````````````````````'`..`````````.:$&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$$%|;'```''''```````.......                  .``'```'``':|%%|'.'|%%%%;```````...........'\n  .`````````````````````````````````````````:'`..''````````..!&&&&&&&&&&&&&&&&&&&&&&&&&&&$$&$%%;''```''````````....   .                .'''`.`'``'`;%%%;``;%%$%!'..................'\n  .``````````````````````````````````````;|:.``.`''''`````...`|&&&&&&&&&&&&&&&&&&&&&&&&&&$$&&$%!:'```````````.``..                    .`''```;;'''';%%%:.:%&&$|:...................:\n  .```````````````````````````````````'!!```'`.`:!:''`````. ..`|&&&&&&&&&&&$%%$$$%|%$$&&&$$&&&$%;'`.``..`......`.                   ..`''''!;''''':|%$|'`!&&$|:...................`:\n   .````````````````````````````````;|:````'::`'!;::''''`.  ...`!&&&&&&&&&&&&&&$&&&&&&&&&&$&&&&$|:'```.``.........        .`.    ....`'''```''''';$&&&;`:!;`......................`:\n   .`````````````````````````````:|;`````'';:'`';:'''```.. ......'|&&&&&&&&&&&%%%$&&&&&&&$$&&&&&%;'`'`..```........         ``  `;:`''''``'```'!$&&&%!'.....................```````:\n   .``````````````````````````:|;``````'':;:'``':'''`````. ........`:%&&&&&&&&&&&&&&&&&&&$&&&&|!!!;'''`....``......`.        .;%%;`''''';|||!;:''::;;' ..``......``````````````````:\n   .```````````````````````!%:````````'':;:'```'':''````.. ............'|&@&&&&&&&&&&&&&&&$$|;!!!!!;:'``'`....``...````..      `:;;:'''!%;::::::::;;`. .````````'''````````````````:\n   .```````````````````:%!'``````````'::::'````'''''````.  .............```;$&@&&&&&&&&&&$|;;!!!!!!!!;```::`  ...``.';;'```.    `:::'';$$|;:::::!;'`....``````''''''''````''''`````:\n   .```````````````:%|'`````````````'::::'`````'''''''``.  .....  ....`````````;$&&&&@&|::!!;!!!!!!!!|!'```';'..  ....'!%%|!::``'':'':|$&&$|!!;:;:'`. .```````':::::''''''''''''''':\n   .``````````;||:```````````````''::'::'````.`'''''''`.. .......  ..`````````````';:`````';!!!!!!!||||!;'```';!:`... ..`:|%%!'''''`:!%$&&&$$$!:;;;:'``'```''::::::::''''':::::'''';\n   ..``';;:'```````````````````'''::'':'```````'''::''`..  .......   ..``````````````````. '||!!!|||||||!!;'````'!|;'``````````'''`';:'`'%&&&&&&|;!;:;!!!;;::;;::::::''''::::::::::;\n``...``````````````````````''''''::''''`````````':::''``. .........  ....```````````...   .:!||||||%%%|||!!!!;'````'!||;'```.`'''`.`.`''`.;$&&&$:  .``'::::;!|%$$%|;:''':::::::::::;\n    .````````````````````'''''''::```'````````.`:::'''```. .......... .............    `!%|!!||||%%||||!!!!!|%%%!:````````..`'''..``''`.....':. .   ..`':;;;;;;;::::;!%&%!;;;;:::::;\n    .`````````````````''''''''''''''::'''````..`::''''`````. ........``............ .;%%%|!!!||%%%%%%%|!!!|%%%%%%||%%%%%%!'`'''`````....``.....       ..  .`':;;;;;;:::::;!%%!;;;;;;\n    .`````````````'''''''''''```''''::'''''``..`''''''```````........````````.....:%%%$%||!|||%%%%%%%||!|%%%%%%%%%%%%|||!'`'''';%%|;`````......'`.      ..      `':::::::;;;;;|%!;;;\n    .``````````''''''''''```````'```''''````..`.`'''''````````....  ..```....  `|%%%%$%|||!|%%%%%%%%%|!|%%%%%%%%%%%%%%%|:`'''`;%%%%!:.:!|%$$$$|;:'`...   .``..  .`.  '::::;;;;;;!%!;\n%!'..```````''''''''''``````````'```'````````.``.`'''''```````.......       .;%%%%%%%|!!!||%%%%%|!!!!!|%%%%%%%%%%%%%%%%:`''''!%%%!!!:`:!|%$$$$$$$$$%|'`.  .```'`.``.  ..     .':::|%\n%%%%%%;```''''''''```````````````'``''``````.````.`''''`..'````.......`'''';|%%%%%%%%||%%%%%%%%%%%|!!%%%%%%%%%%%%%%%%%:`'''';%%||||:`:!|%$$$$$$$$$$$$$%;``. .``''`.                '\n$$$%%%%%$$|:''````````````````````''''``````.`````.`'''''`...      .`':|%$$%%%%%%%%%|!|%%%%%%%%%%|||%%$$%%%%%%%%%%%%%:`'''';%||%%%;.:||%$$$$$$$$$$$$$$&&&%:...````''`              '\n$$$$$$$$$$%%%%%;`.``````````````````':'``````.`````.`'''''`......`''':!%%%%%%%%%%%%|!!%%%%|||%%|!|%%%%%%%%%%%%%%%%%%:`'''';||%%%|:`;||%$$$$$$$$$$$$&&&&&&&$|'...```'''`            '\n|%%$$%%$$$$$%%%%%%%;`..`.`````````````':'````.``.```..`''````''''':|!:|%%%%%%%%%%%%|!!|%|||%||!!%%%%%%%%%%%%%%%%%%%:`'''':|%%%%;``;|%%$$$$$$$$$$&&&&&&&&&&&$$;...`````''`          '\n@$|||||%%%%%%%%%%%%%%%%|:`....```````.`''``'''`````````.````''':;|%|;:|%%%%%%%%%%||!!|||||||!!|%%%%%%%%%%%%%%%%%%%:`'''';|%%%%:.'!|%$$$$$$$$$$$$$&&&&&&&&&&&&$!`..``````''`        '\n||||&@&%|!|||%%%%%%%%%%%%%%|:.....```````'````.........`!%%%%%%%%|||;:|%%%%%%%%%%||!!|%|%|!!||%%%%%%%%%%%%%%%%%%%:`'''';|%%%!'`;||%$$$$$$$&&$$$$$&&&&&&@&&&&&$$!`..``````````.     '\n|||||!|!|$@&%|!|||%%%%%%%%%%%%%:. ...`````''``........:|%%%%%%%%%||%;:|%%%%%%%$%%%%!;|||!!||||%%%%%%%%%%%%%%%%%%:`'''';||%|:`:||%%$$$&&&&&$$%%$$&&&&@######&&$$$!`..``..```````.   '\n||||||||!|!!!!|%$%|||||%$%%%%%%%%%!`.....````'`......'|%%%%%%%%%%|%$|;%&&&&&&&&$$$$|!|!!%$$$$&&&&&&&&&$$$$$$$$%;`''':;|||;``;||%$$&&&&&&&$$%%$$&&&&&@######&$$$$%:.....``````````. '\n||%%||||||!!|!!|||!|%$%|||%%%%%%%%%%%|:.....`.`'`...'|%%%%%%%%%$$$$&|:|&&&&&&&&$$$$|;!|$$$$&&&&&&&&&&&&&&&&@&$;`''':;||;``!||%$&$$$&&&&$%%%%%$&#####@@###@&$$&$$$!`.......`````````:\n   .:!|%%|||||||||||||||!|||||%%%%$%%%%%;`.......``:%&&&&&&&&&&&&$$$%;;$&&&&&&&&&&$||$$$&&@@@@@@@@@@@@@@@@@@&!'''':;!:`'!||%$&$$$$$&&&$%%|%%$@######@&&&&&$$$$$$$%;..`...`...`````':\n    .....`;|%%%%%|||!|||!|||!!!||%%%%%%%%%%;`.....:%&&&&&&&&&&&&$$$&$|'!$&&&&&&&$$%$$$&&@@@@@@@@@@@@@@@@@@@@!'::':'`.'|||%$$&&$$$$$&&$%%||%$@#########@@&&$$$$&$%$!`..`...```..````:\n    ..........'!|%|%|||||!||||||||||%%%%%%%%%:...'|&&&&&&&&&&&&&$$&&&$;'|&&&&&$%%$$$&&@@@@@@@@@@@@@@@@@##@@!'::::'`:|%%%$$$&&&$$$$$$$%%|%&@@##########@@@@&&&$$$$$%;..``....````.``:\n    .....```......`;|%|%%||||||||||||||%%%%%%|!:`!&&&&&&&&&&&&&&$$$&&$%::%&$$%%$$&&&@@@@@@@@@@@@@@@@@@@#@&|::::::;|%%$$$$&&&&&$$$$$$%%%%&@@@###########@@@@&&&&&$$$!`..`.....`````.'\n    ..................`;|%%%|%%|||!|||||||%%%|||$&&&&&&&&&&&@&&&$$$&&&$%;;%%%$$&&@@@@@@@@@@@@@@@@@##@#@&$;':::::!%%$$$$&&&&&&&$$$%%%%%|$@@@@##@#########@@@@@&&&&$$|:...`.....`````:\n    ............``..```...`;|%|||%||!!|||||||||%&&&&&&&&&&@@@@&&$$$&&&&$%;;%$$&@@@@@@@@@@@@@@@@@@#@@&$!`.`:::::!%$$$&&&&&&&&$$$$$$%%%||&@@@@##@@@@########@@@@&&&&$$!`...`.....````:\n    ...................```...`:|%||||||||!||||%&&&&&&&&&&&@@@@@&$%&&$$$%%%;:!$&@@@@@@@@@@@@@@#@@&&%;``;|;:::::!$$$&&&&&&&&&&$$$$$%%%%||&@@@@@@@@@@##@#####@@@@@&&&&&$:..```.....```:\n    .....................``.`...`;|%|||||||||%&&&&&&&&&&&&@@@@@@$$&$$%%$$$%!::|&@@@@@####@@@&$%;'':|%|!::::::!$$&&&&&@&&&&&&$$$$$$%%|||$@@@@@@@@@@@@@@@####@@@@@&&&&&%'.```..`...``:\n    ...........................``..'!%|||||!%$&&&&&&&&&&&&@@@@@&$$$%%$$@@@&$%!::|&&&&&&&&$|;::;||||%%|::::::!$$&&&&@@@&&&&&&$$$$$$%%|||$@@@@&&&&&&&@@@@@@@@@@@@@@&&&$$|'.```.......:\n    ...........................```...`;||||%$&&&&&&&&&&&&@@@@@&$%%$$&@@@@&&&&$|!!;;!||;:;!|%%||%$&&$|;:::::!$$&&&@@@@@@@&&&&$$$$$$%%%%|%&@@@&&&&&&&&&&&&&&&&&@@@&&&&$$$!`.``.......:\n*/\n\nint n;\nchar s[6005];\nint a[6005],b[6005],pos[6005],cnta,cntb;\nstring dp[6005];\n\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\ta[++cnta]=i;\n\t\t\tpos[i]=cnta;\n\t\t}else{\n\t\t\tb[++cntb]=i;\n\t\t\tpos[i]=cntb;\n\t\t}\n\t}\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint to=0;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tto=max(to,pos[j]);\n\t\t\t}\n\t\t\tdp[i]=\"ab\"+dp[to+1];\n\t\t}else{\n\t\t\tint fk=i;\n\t\t\twhile(fk<=n&&b[fk+1]<a[fk]){\n\t\t\t\tfk++;\n\t\t\t}\n\t\t\tfor(int j=1;j<=2*n;j++){\n\t\t\t\tif(pos[j]>=i&&pos[j]<=fk){\n\t\t\t\t\tdp[i]+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i]+=dp[fk+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <cassert>\n#include <random>\n#include <iomanip>\n#define FOR(i, n, m) for(ll i = n; i < (int)m; i++)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll, ll>;\nconstexpr ll inf = 1000000000;\nconstexpr ll mod = 1000000007;\nconstexpr long double eps = 1e-15;\n \ntemplate<typename T1, typename T2>\nostream& operator<<(ostream& os, pair<T1, T2> p) {\n    os << to_string(p.first) << \" \" << to_string(p.second);\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& v) {\n    REP(i, v.size()) {\n        if(i) os << \" \";\n        os << to_string(v[i]);\n    }\n    return os;\n}\n \nstruct modint {\n    ll n;\npublic:\n    modint(const ll n = 0) : n((n % mod + mod) % mod) {}\n    static modint pow(modint a, int m) {\n        modint r = 1;\n        while(m > 0) {\n            if(m & 1) { r *= a; }\n            a = (a * a); m /= 2;\n        }\n        return r;\n    }\n    modint &operator++() { *this += 1; return *this; }\n    modint &operator--() { *this -= 1; return *this; }\n    modint operator++(int) { modint ret = *this; *this += 1; return ret; }\n    modint operator--(int) { modint ret = *this; *this -= 1; return ret; }\n    modint operator~() const { return (this -> pow(n, mod - 2)); } // inverse\n    friend bool operator==(const modint& lhs, const modint& rhs) {\n        return lhs.n == rhs.n;\n    }\n    friend bool operator<(const modint& lhs, const modint& rhs) {\n        return lhs.n < rhs.n;\n    }\n    friend bool operator>(const modint& lhs, const modint& rhs) {\n        return lhs.n > rhs.n;\n    }\n    friend modint &operator+=(modint& lhs, const modint& rhs) {\n        lhs.n += rhs.n;\n        if (lhs.n >= mod) lhs.n -= mod;\n        return lhs;\n    }\n    friend modint &operator-=(modint& lhs, const modint& rhs) {\n        lhs.n -= rhs.n;\n        if (lhs.n < 0) lhs.n += mod;\n        return lhs;\n    }\n    friend modint &operator*=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * rhs.n) % mod;\n        return lhs;\n    }\n    friend modint &operator/=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * (~rhs).n) % mod;\n        return lhs;\n    }\n    friend modint operator+(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n + rhs.n);\n    }\n    friend modint operator-(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n - rhs.n);\n    }\n    friend modint operator*(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * rhs.n);\n    }\n    friend modint operator/(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * (~rhs).n);\n    }\n};\nistream& operator>>(istream& is, modint m) { is >> m.n; return is; }\nostream& operator<<(ostream& os, modint m) { os << m.n; return os; }\n \n#define MAX_N 3030303\nlong long extgcd(long long a, long long b, long long& x, long long& y) {\n    long long d = a;\n    if (b != 0) {\n        d = extgcd(b, a % b, y, x);\n        y -= (a / b) * x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nlong long mod_inverse(long long a, long long m) {\n    long long x, y;\n    if(extgcd(a, m, x, y) == 1) return (m + x % m) % m;\n    else return -1;\n}\nvector<long long> fact(MAX_N+1, inf);\nlong long mod_fact(long long n, long long& e) {\n    if(fact[0] == inf) {\n        fact[0]=1;\n        if(MAX_N != 0) fact[1]=1;\n        for(ll i = 2; i <= MAX_N; ++i) {\n            fact[i] = (fact[i-1] * i) % mod;\n        }\n    }\n    e = 0;\n    if(n == 0) return 1;\n    long long res = mod_fact(n / mod, e);\n    e += n / mod;\n    if((n / mod) % 2 != 0) return (res * (mod - fact[n % mod])) % mod;\n    return (res * fact[n % mod]) % mod;\n}\n// return nCk\nlong long mod_comb(long long n, long long k) {\n    if(n < 0 || k < 0 || n < k) return 0;\n    long long e1, e2, e3;\n    long long a1 = mod_fact(n, e1), a2 = mod_fact(k, e2), a3 = mod_fact(n - k, e3);\n    if(e1 > e2 + e3) return 0;\n    return (a1 * mod_inverse((a2 * a3) % mod, mod)) % mod;\n}\n \nusing mi = modint;\n \nmi mod_pow(mi a, ll n) {\n    mi ret = 1;\n    mi tmp = a;\n    while(n > 0) {\n        if(n % 2) ret *= tmp;\n        tmp = tmp * tmp;\n        n /= 2;\n    }\n    return ret;\n}\n \nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n \nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<pair<int, int>> idx(n);\n    vector<int> v(2 * n, -1);\n    int ca = 0, cb = 0;\n    REP(i, 2 * n) {\n        if(s[i] == 'a') {\n            idx[ca].first = i;\n            v[i] = ca;\n            ca++;\n        } else {\n            idx[cb].second = i;\n            v[i] = cb;\n            cb++;\n        }\n    }\n    vector<string> mx(n, \"\");\n    for(int i = n - 1; i >= 0; i--) {\n        if(idx[i].first < idx[i].second) {\n            mx[i] = \"ab\";\n            if(idx[i].second != 2 * n - 1) mx[i] += mx[v[idx[i].second + 1]];\n        } else {\n            int tmp = i;\n            for(int j = idx[i].second; j < 2 * n; j++) {\n                if(s[j] == 'b') {\n                    mx[i] += 'b';\n                    tmp = v[j];\n                } else {\n                    if(v[j] < i) continue;\n                    if(v[j] > tmp) {\n                        mx[i] += mx[v[j]];\n                        break;\n                    } else mx[i] += 'a';\n                }\n            }\n        }\n        if(i < n - 1) mx[i] = max(mx[i], mx[i + 1]);\n    }\n    string ans = mx[0];\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define F first\n#define S second\n#define int long long\n#define ll long long\n//#define int  unsigned long long\n#define pb push_back\n//#define double long double\n\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef  tree< int , null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> ordered_set;\nconst int mod = 1e9 + 7;\nconst int N = 650055;\nconst int K = 700 ;\nint a[N], p1[N], p2[N], d[N], n;\nvector < pair < int, int > > t;\nstring calc(string s){\n        string ans = \"\";\n        int cnt1 = 0;\n        int cnt2 = 0;\n        int n = s.length() / 2;\n        for (int i = 1; i <= n + n; i++){\n            if (s[i - 1] == 'a'){\n                cnt1++;\n                cnt2 = 0;\n                for (int j = 1; j <= n + n; j++){\n                    if (s[j - 1] == 'b') cnt2++;\n                    if (cnt2 == cnt1){\n                        d[i] = j;\n                        break;\n                    }\n                }\n            }\n        }\n        int c = 1;\n        while (c <= n + n){\n            ans += \"ab\";\n            c = d[c];\n            while(a[c] == 1) c++;\n        }\n    return ans;\n}\nmain(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    //freopen(\"input.txt\", \"r\", stdin);\n    cin >> n;\n    string s;\n    cin >> s;\n    for (int i = 1; i <= n + n; i++){\n        if (s[i - 1] == 'a') a[i] = -1; else a[i] = 1;\n    }\n    int x = 0;\n    int l = 1;\n    int q = 0;\n    for (int i = 1; i <= n + n; i++){\n        x += a[i];\n        if (x == 0){\n            if (a[l] == 1) q = 1;\n            t.pb({l, i});\n            l = i + 1;\n        }\n    }\n    int c = 0;\n    if (q == 0){\n        cout << calc(s);\n        return 0;\n    }\n    vector < string > v;\n    for (auto i: t){\n        string res = \"\";\n        string cur = s.substr(i.F - 1, i.S - i.F + 1);\n        if (a[i.F] == -1){\n            res = calc(cur);\n            v.pb(res);\n            continue;\n        }\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a'){\n                cnt2++;\n                p2[j] = p1[cnt2];\n            } else{\n                cnt1++;\n                p1[cnt1] = j;\n            }\n        }\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a') continue;\n            string x = \"\";\n            for (int l = j; l < cur.length(); l++){\n                if (cur[l] == 'b') x += \"b\"; else\n                if (cur[l] == 'a' && p2[l] >= j) x += \"a\";\n            }\n            res = max(res, x);\n        }\n        v.pb(res);\n    }\n    string ans = \"\";\n    for (int j = v.size() - 1; j >= 0; j--){\n        ans = max(ans, v[j] + ans);\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define fo(a,b,c) for (a=b; a<=c; a++)\n#define fd(a,b,c) for (a=b; a>=c; a--)\n#define min(a,b) (a<b?a:b)\n#define ll long long\n//#define file\nusing namespace std;\n\nstruct type{\n\tchar a[6001];\n\tint n;\n\tvoid add(char ch) {a[++n]=ch;}\n} ans,s,Ans;\nint a[6001][3],c[6001][2],n,i,j,k,l,sum,tot,s1,s2;\nchar st[6001];\nbool bz;\n\nbool pd(type a,type b)\n{\n\tint i;\n\t\n\tfo(i,1,min(a.n,b.n))\n\tif (a.a[a.n-i+1]!=b.a[b.n-i+1])\n\treturn a.a[a.n-i+1]<b.a[b.n-i+1];\n\treturn a.n<b.n;\n}\n\nint main()\n{\n\t#ifdef file\n\tfreopen(\"agc026e.in\",\"r\",stdin);\n\t#endif\n\t\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",st+1);\n\t\n\tfo(i,1,n+n)\n\t{\n\t\tif (!sum)\n\t\t{\n\t\t\t++tot;\n\t\t\ta[tot][0]=i;\n\t\t\ta[tot][2]=st[i]=='b';\n\t\t}\n\t\tsum+=(st[i]=='a')?1:-1;\n\t\tif (!sum) a[tot][1]=i;\n\t}\n\t\n\tfd(l,tot,1)\n\tif (!a[l][2])\n\t{\n\t\tif (!bz)\n\t\t{\n\t\t\ts1=s2=0;\n\t\t\tfo(i,a[l][0],a[l][1])\n\t\t\t{\n\t\t\t\tif (st[i]=='a')\n\t\t\t\t++s1,c[s1][0]=i;\n\t\t\t\telse\n\t\t\t\t++s2,c[s2][1]=i;\n\t\t\t}\n\t\t\t\n\t\t\tk=(a[l][1]-a[l][0]+1)/2,l=0;\n\t\t\tfo(i,1,k)\n\t\t\tif (l<c[i][0])\n\t\t\tans.add('b'),ans.add('a'),l=c[i][1];\n\t\t}\n\t}\n\telse\n\t{\n\t\tbz=1;Ans=ans;\n\t\tfd(i,(a[l][1]-a[l][0]+1)/2,0)\n\t\t{\n\t\t\ts=ans;\n\t\t\ts1=s2=0;\n\t\t\tfd(j,a[l][1],a[l][0])\n\t\t\t{\n\t\t\t\tif (st[j]=='a')\n\t\t\t\t{++s1;if (s1<=i) s.add('a');}\n\t\t\t\telse\n\t\t\t\t{++s2;if (s2<=i) s.add('b');}\n\t\t\t}\n\t\t\tif (pd(Ans,s)) Ans=s;\n\t\t}\n\t\tans=Ans;\n\t}\n\t\n\tfd(i,ans.n,1) putchar(ans.a[i]);\n\tputchar('\\n');\n\t\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 97];\n    }\n    for (int i = n; i >= 1; --i) {\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n        dp[i] = max(dp[i], dp[i + 1]);\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring chop(string& s, int i, int j) {\n    assert(i <= j);\n    return s.substr(i, j - i);\n}\n\nstring _solve(string s) {\n    if (s[0] == 'a') {\n        vector<int> ap, bp;\n        for (int i = 0; i < s.size(); i++) {\n            (s[i] == 'a' ? ap : bp).push_back(i);\n        }\n        string t;\n        for (int i = 0; i < ap.size();) {\n            t.push_back('a');\n            t.push_back('b');\n            for (int targ = bp[i]; i < ap.size() && ap[i] <= targ; i++);\n        }\n        return t;\n    } else {\n        string t = s;\n        for (string u = s; !u.empty();) {\n            int i = 0, j = 0;\n            while (u[i] != 'a') i++;\n            while (u[j] != 'b') j++;\n            u = chop(u, 0, min(i, j)) + chop(u, min(i, j) + 1, max(i, j)) + chop(u, max(i, j) + 1, u.size());\n            t = max(t, u);\n        }\n        return t;\n    }\n}\n\nint main() {\n    int n;\n    vector<string> parts;\n    string s;\n    cin >> n >> s;\n    for (int i = 0; i < s.size();) {\n        int t = 0, j = i;\n        while (j < s.size()) {\n            if (!(t += s[j++] == 'b' ? 1 : -1)) break;\n        }\n        parts.push_back(_solve(chop(s, i, j)));\n        i = j;\n    }\n    string t = \"\";\n    reverse(parts.begin(), parts.end());\n    for (string& u: parts) {\n        t = max(t, u + t);\n    }\n    cout << t << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[MAX];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=A)\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\t//print the maximum\n\tstring maximum=\"\",tot=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\t//reverse(res[A].begin(),res[A].end());\n\t\t//cout<<res[A]<<\" \";\n\t\tif(res[A]==maximum)\n\t\t{\n\t\t\treverse(res[A].begin(),res[A].end());\n\t\t\ttot+=res[A];\n\t\t}\n\t}\n\treverse(tot.begin(),tot.end());\n\tcout<<tot;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n \ntypedef long long ll;\ntypedef long double ld;\ntypedef complex<ld> cd;\n\ntypedef pair<int, int> pi;\ntypedef pair<ll,ll> pl;\ntypedef pair<ld,ld> pd;\n\ntypedef vector<int> vi;\ntypedef vector<ld> vd;\ntypedef vector<ll> vl;\ntypedef vector<pi> vpi;\ntypedef vector<pl> vpl;\ntypedef vector<cd> vcd;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\n\n#define FOR(i, a, b) for (int i=a; i<(b); i++)\n#define F0R(i, a) for (int i=0; i<(a); i++)\n#define FORd(i,a,b) for (int i = (b)-1; i >= a; i--)\n#define F0Rd(i,a) for (int i = (a)-1; i >= 0; i--)\n\n#define sz(x) (int)(x).size()\n#define mp make_pair\n#define pb push_back\n#define f first\n#define s second\n#define lb lower_bound\n#define ub upper_bound\n#define all(x) x.begin(), x.end()\n\nconst int MOD = 1000000007;\nconst ll INF = 1e18;\nconst int MX = 6010;\n\nint N;\nstring S;\npair<vi,vi> oc;\nstring ans[MX];\nint lst = -1;\n\npair<vi,vi> genOc(string tmp) {\n    pair<vi,vi> z;\n    F0R(i,sz(tmp)) {\n        if (tmp[i] == 'a') z.f.pb(i);\n        else z.s.pb(i);\n    }\n    return z;\n}\n\nstring get(string tmp, bitset<MX> selec) {\n    int a = -1, b = -1;\n    string ans;\n    F0R(i,sz(tmp)) {\n        if (tmp[i] == 'a') {\n            a ++;\n            if (selec[a]) ans += 'a';\n        } else {\n            b ++;\n            if (selec[b]) ans += 'b';\n        }\n    }\n    return ans;\n}\n\nvoid solve(int x) {\n    ans[x] = ans[x+1];\n    bitset<MX> ok;\n    FOR(i,x,N) ok[oc.f[i]] = ok[oc.s[i]] = 1;\n    string tmp;\n    F0R(i,2*N) if (ok[i]) tmp += S[i];\n    \n    pair<vi,vi> t = genOc(tmp);\n    vi ab, ba;\n    F0R(i,sz(t.f)) {\n        if (t.f[i] < t.s[i]) ab.pb(i);\n        else ba.pb(i);\n    }\n    \n    pi nex = {0,0};\n    bitset<MX> selec; selec[0] = 1;\n    \n    int cmx = 0;\n    if (tmp[0] == 'a') nex.f ++;\n    else nex.s ++;\n    \n    int lastB = t.s[0];\n    while (nex.s < sz(ba)) {\n        int cur = ba[nex.s];\n        if (t.s[cur] < max(t.f[cmx],t.s[cmx])) {\n            selec[cur] = 1;\n            cmx = cur;\n            nex.s ++;\n            lastB = t.s[cur];\n        } else break;\n    }\n    \n    cmx ++;\n    while (cmx < sz(t.f) && t.f[cmx] < t.s[cmx] && t.f[cmx] < lastB) cmx ++;\n    ans[x] = max(ans[x],get(tmp,selec)+ans[x+cmx]);\n}\n\nint main() {\n    ios_base::sync_with_stdio(0); cin.tie(0);\n    cin >> N >> S;\n    oc = genOc(S);\n    F0Rd(i,N) solve(i);\n    cout << ans[0];\n}\n\n/* Look for:\n* the exact constraints (multiple sets are too slow for n=10^6 :( ) \n* special cases (n=1?)\n* overflow (ll vs int?)\n* array bounds\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    for(LL i=1;i<=10;++i) a[i]=1;\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//Author:xht37\n#include <bits/stdc++.h>\n\n#define ui unsigned int\n#define ll long long\n#define ul unsigned ll\n#define ld long double\n\n#define pi pair <int, int>\n#define fi first\n#define se second\n#define mp make_pair\n\n#define ls (p << 1)\n#define rs (ls | 1)\n#define md ((t[p].l + t[p].r) >> 1)\n\n#define vi vector <int>\n#define pb push_back\n#define pq priority_queue\n\n#define dbg(x) cerr << #x\" = \" << x << endl\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\n#define fl(x) freopen(x\".in\", \"r\", stdin), freopen(x\".out\", \"w\", stdout)\n\nusing namespace std;\n\nnamespace io {\n\tconst int SI = 1 << 21 | 1;\n\tchar IB[SI], *IS, *IT, OB[SI], *OS = OB, *OT = OS + SI - 1, c, ch[100];\n\tint f, t;\n\t#define gc() (IS == IT ? (IT = (IS = IB) + fread(IB, 1, SI, stdin), IS == IT ? EOF : *IS++) : *IS++)\n\tinline void flush() {\n\t\tfwrite(OB, 1, OS - OB, stdout), OS = OB;\n\t}\n\tinline void pc(char x) {\n\t\t*OS++ = x;\n\t\tif (OS == OT) flush();\n\t}\n\n\ttemplate <class I>\n\tinline void rd(I &x) {\n\t\tfor (f = 1, c = gc(); c < '0' || c > '9'; c = gc()) if (c == '-') f = -1;\n\t\tfor (x = 0; c >= '0' && c <= '9'; x = (x << 3) + (x << 1) + (c & 15), c = gc());\n\t\tx *= f;\n\t}\n\ttemplate <class I>\n\tinline void rd(I &x, I &y) {\n\t\trd(x), rd(y);\n\t}\n\ttemplate <class I>\n\tinline void rd(I &x, I &y, I &z) {\n\t\trd(x), rd(y), rd(z);\n\t}\n\ttemplate <class I>\n\tinline void rda(I *a, int n) {\n\t\tfor (int i = 1; i <= n; i++) rd(a[i]);\n\t}\n\tinline void rdc(char &c) {\n\t\tfor (c = gc(); c < 33 || c > 126; c = gc());\n\t}\n\tinline void rds(char *s, int &n) {\n\t\tfor (c = gc(); c < 33 || c > 126; c = gc());\n\t\tfor (n = 0; c >= 33 && c <= 126; s[++n] = c, c = gc());\n\t\ts[n+1] = '\\0';\n\t}\n\tinline void rds(string &s) {\n\t\tfor (c = gc(); c < 33 || c > 126; c = gc());\n\t\tfor (s.clear(); c >= 33 && c <= 126; s.pb(c), c = gc());\n\t}\n\n\ttemplate <class I>\n\tinline void print(I x, char k = '\\n') {\n\t\tif (!x) pc('0');\n\t\tif (x < 0) pc('-'), x = -x;\n\t\twhile (x) ch[++t] = x % 10 + '0', x /= 10;\n\t\twhile (t) pc(ch[t--]);\n\t\tpc(k);\n\t}\n\ttemplate <class I>\n\tinline void print(I x, I y) {\n\t\tprint(x, ' '), print(y);\n\t}\n\ttemplate <class I>\n\tinline void print(I x, I y, I z) {\n\t\tprint(x, ' '), print(y, ' '), print(z);\n\t}\n\ttemplate <class I>\n\tinline void printa(I *a, int n) {\n\t\tfor (int i = 1; i <= n; i++) print(a[i], \" \\n\"[i==n]);\n\t}\n\tinline void printc(char c) {\n\t\tpc(c);\n\t}\n\tinline void prints(char *s, int n) {\n\t\tfor (int i = 1; i <= n; i++) pc(s[i]);\n\t\tpc('\\n');\n\t}\n\tinline void prints(string s) {\n\t\tint n = s.length();\n\t\twhile (t < n) pc(s[t++]);\n\t\tpc('\\n'), t = 0;\n\t}\n\tstruct Flush {\n\t\t~Flush() {\n\t\t\tflush();\n\t\t}\n\t} flusher;\n}\nusing io::rd;\nusing io::rda;\nusing io::rdc;\nusing io::rds;\nusing io::print;\nusing io::printa;\nusing io::printc;\nusing io::prints;\n\nconst int N = 6e3 + 7;\nint n, a[N], b[N], d[N], p[N];\nchar s[N];\nstring f[N];\n\nint main() {\n\trd(n), rds(s, n);\n\tfor (int i = 1, j = 0, k = 0; i <= n; i++)\n\t\tif (s[i] == 'a') a[d[i]=++j] = i;\n\t\telse b[d[i]=++k] = i;\n\ta[n+1] = b[n+1] = n + 1, d[n+1] = (n >> 1) + 1, n >>= 1;\n\tfor (int i = 1, j = 0; i <= n + 1; i++)\n\t\twhile (j < min(a[i], b[i])) p[++j] = i;\n\tfor (int i = n; i; i--) {\n\t\tif (a[i] > b[i]) {\n\t\t\tint j = b[i];\n\t\t\twhile (b[d[j]] < a[d[j]] && (d[j] <= i || b[d[j]] < a[d[j]-1])) {\n\t\t\t\tif (d[j] >= i) f[i] += s[j];\n\t\t\t\t++j;\n\t\t\t}\n\t\t\tf[i] += f[d[j]];\n\t\t} else f[i] = \"ab\" + f[p[b[i]+1]];\n\t\tf[i] = max(f[i], f[i + 1]);\n\t}\n\tprints(f[1]);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> vs;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      vs.push_back(naive(string(s.begin() + i, s.begin() + last)));\n      i = r - 1;\n    }\n  }\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  reverse(vs.begin(), vs.end());\n  for (const auto& str : vs)\n    ans = max(ans, str + ans);\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <assert.h>\n#include <sys/time.h>\n#include <fstream>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  FOR(i,0,n)\n#define REP(i,n)  FOR(i,0,n)\n#define each(i,c) for(auto i=(c).begin(); i!=(c).end(); ++i)\n#define EACH(i,c) for(auto i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n#define deb(x) cerr << #x << \" = \" << (x) << \" , \";\n#define debl cerr << \" (L\" << __LINE__ << \")\"<< endl;\n#define sz(s) (int)((s).size())\n\n\n#define clr(a) memset((a),0,sizeof(a))\n#define nclr(a) memset((a),-1,sizeof(a))\n#define pb push_back\n#define INRANGE(x,s,e) ((s)<=(x) && (x)<(e))\n#define MP(x,y) make_pair((x),(y))\n\ndouble pi=3.14159265358979323846;\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\ntemplate<typename T> std::ostream& operator<<(std::ostream& os, const vector<T>& z){\n\tos << \"[ \";\n\tREP(i,z.size())os << z[i] << \", \" ;\n\treturn ( os << \"]\" << endl);\n}\n\ntemplate<typename T> std::ostream& operator<<(std::ostream& os, const set<T>& z){\n\tos << \"set( \";\n\tEACH(p,z)os << (*p) << \", \" ;\n\treturn ( os << \")\" << endl);\n}\n\ntemplate<typename T,typename U> std::ostream& operator<<(std::ostream& os, const map<T,U>& z){\n\tos << \"{ \";\n\tEACH(p,z)os << (p->first) << \": \" << (p->second) << \", \" ;\n\treturn ( os << \"}\" << endl);\n}\n\ntemplate<typename T,typename U> std::ostream& operator<<(std::ostream& os, const pair<T,U>& z){\n\treturn ( os << \"(\" << z.first << \", \" << z.second << \",)\" );\n}\n\ndouble get_time(){\n\tstruct timeval tv;\n\tgettimeofday(&tv, NULL);\n\treturn tv.tv_sec + tv.tv_usec*1e-6;\n}\n\ntypedef unsigned int uint32_t;\nstruct RND{\n\tuint32_t x;\n\tuint32_t y;\n\tuint32_t z;\n\tuint32_t w;\n\tRND(){\n\t\tx=123456789;\n\t\ty=362436069;\n\t\tz=521288629;\n\t\tw=88675123;\n\t}\n\tvoid init(int seed){\n\t\tx=123456789;\n\t\ty=362436069;\n\t\tz=521288629;\n\t\tw=seed+100;\n\t\tREP(i,10)get();\n\t}\n\tuint32_t get(){\n\t\tuint32_t t;\n\t\tt=x^(x<<11);\n\t\tx=y;y=z;z=w;\n\t\tw=(w^(w>>19))^(t^(t>>8));\n\t\treturn w;\n\t}\n};\nRND rnd;\n\nstring s;\nvector<string> ss;\nchar a = 'a';\nchar b = 'b';\n\nvector<int> make_jump(string s){\n\tint n = s.size()/2;\n\tvi jump(s.size(), -1);\n\tint ia = -1, ib=-1;\n\trep(k,n){\n\t\tia++;\n\t\tib++;\n\t\twhile(s[ia]==b)ia++;\n\t\twhile(s[ib]==a)ib++;\n\t\tjump[ia] = ib;\n\t\tjump[ib] = ia;\n\t}\n\treturn jump;\n\n}\n\nvector<string> find_kouho(string s){\n\tvector<string> ret;\n\tvi jump = make_jump(s);\n\tif(s[0]==a){\n\t\tint n = s.size()/2;\n\t\tint i=0;\n\t\tint cnt = 0;\n\t\twhile(i<s.size()){\n\t\t\tassert(s[i]==a);\n\t\t\tcnt++;\n\t\t\ti = jump[i]+1;\n\t\t\twhile(i<s.size() && s[i]==b )i++;\n\t\t}\n\t\tstring ret_s;\n\t\trep(j,cnt){\n\t\t\tret_s.push_back(a);\n\t\t\tret_s.push_back(b);\n\t\t}\n\t\tret.push_back(ret_s);\n\t}\n\tif(s[0]==b){\n\t\trep(start,s.size()) if(s[start]==b){\n\t\t\tstring ret_s;\n\t\t\tFOR(i,start, s.size()){\n\t\t\t\tif(s[i]==b || (s[i]==a && i>=jump[start])  )ret_s.push_back(s[i]);\n\t\t\t}\n\t\t\tret.push_back(ret_s);\n\t\t}\n\t}\n\treturn ret;\n}\n\nvoid _main(istream &inp){\n\n\tint si;\n\tinp >> si >> s;\n\tassert(s.size()==2*si);\n\tint start = 0;\n\tint cnt = 0;\n\tfor(int i=0; i<=s.size(); i++){\n\t\tif(i>0 && cnt==0){\n\t\t\tss.push_back(string(s.begin()+start, s.begin()+i));\n\t\t\tstart = i;\n\t\t}\n\t\tif(i<s.size()){\n\t\t\tif(s[i]==b)cnt++;\n\t\t\telse cnt--;\n\t\t}\n\t}\n\t//debug(ss);\n\tstring cur;\n\tfor(int k=ss.size()-1; k>=0; k--){\n\t\tstring best = cur;\n\t\tfor(string u:find_kouho(ss[k]) ){\n\t\t\tif(u+cur >= best){\n\t\t\t\tbest = u+cur;\n\t\t\t}\n\t\t}\n\t\tcur = best;\n\t}\n\tcout << cur << endl;\n}\n\nint main(){\n\tif(0){\n\t\tifstream ifs(\"test.txt\");\n\t\t_main(ifs);\n\t}\n\telse{\n\t\t_main(cin);\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n// Problem : E - Synchronized Subsequence\n// Contest : AtCoder - AtCoder Grand Contest 026\n// URL : https://atcoder.jp/contests/agc026/tasks/agc026_e\n// Memory Limit : 1024 MB\n// Time Limit : 2000 ms\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\n\n//Code written by IMALYD\n//LK AK IOI Orz\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<int,ll > pil;\ntypedef pair<ll ,int> pli;\ntypedef pair<ll ,ll > pll;\n#define rep(i,l,r) for(i=(l);i<=(r);++i)\n#define per(i,l,r) for(i=(l);i>=(r);--i)\n#define REP(i,l,r) for(i=(l);i< (r);++i)\n#define PER(i,l,r) for(i=(l);i> (r);--i)\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define pob pop_back\n#define pof pop_front\n#define fi first\n#define se second\n#define it iterator\ntemplate<class IT>inline void cmx(IT &a,IT b){if(a<b)a=b;}\ntemplate<class IT>inline void cmn(IT &a,IT b){if(b<a)a=b;}\ntemplate<class IT>inline bool bmx(IT &a,IT b){if(a<b){a=b;return true;}else return false;}\ntemplate<class IT>inline bool bmn(IT &a,IT b){if(b<a){a=b;return true;}else return false;}\nconst int N=6005;\nchar S[N],T[N];\ninline void ac(){\n\tint n,i,j,c=0,a,b,k;string s,t,u;\n\tscanf(\"%d%s\",&n,S+1);\n\tfor(i=n<<1;i;i=j-1){\n\t\tfor(j=i;;--j)if(!((S[j]=='a')?(++c):(--c)))break;\n\t\t//printf(\"j=%d i=%d\\n\",j,i);\n\t\tt=\"\";\n\t\tif(S[j]=='a'){\n\t\t\ta=b=j;k=0;\n\t\t\tdo{\n\t\t\t\twhile(S[a]=='b'&&a<=i)++a;if(a>i)break;\n\t\t\t\twhile(S[b]=='a'      )++b;\n\t\t\t\t//printf(\"a=%d b=%d\\n\",a,b);\n\t\t\t\tif(a<k){++a;++b;continue;}\n\t\t\t\tt+=\"ab\";\n\t\t\t\tk=b;\n\t\t\t\t++a;++b;\n\t\t\t}while(true);\n\t\t}else{\n\t\t\ta=b=i;\n\t\t\tdo{\n\t\t\t\twhile(S[a]=='b'&&a>=j)--a;if(a<j)break;\n\t\t\t\twhile(S[b]=='a'      )--b;\n\t\t\t\tT[a]='a';\n\t\t\t\tT[b]='b';\n\t\t\t\tu=\"\";\n\t\t\t\trep(k,j,i)if(T[k])u+=T[k];\n\t\t\t\tcmx(t,u);\n\t\t\t\t--a;--b;\n\t\t\t}while(true);\n\t\t}\n\t\t//cout<<t<<endl;\n\t\tcmx(s,t+s);\n\t}\n\tcout<<s;\n}\nint main(){\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"a.out\",\"w\",stdout);\n\t\n\tac();\n\treturn 0;\n}\n#undef rep\n#undef per\n#undef REP\n#undef PER\n#undef mp\n#undef pb\n#undef pf\n#undef pob\n#undef pof\n#undef fi\n#undef se\n#undef it"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#ifdef DEBUG\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define debug(...)\n#endif\n\n#ifdef __WIN32\n#define LLFORMAT \"I64\"\n#define Rand() ((rand() << 15) + rand())\n#else\n#define LLFORMAT \"ll\"\n#define Rand() (rand())\n#endif\n\nusing namespace std;\n\nconst int maxn = 3030;\n\nint n, sb[maxn];\nstring s, dp[maxn];\nset<pair<int, int> > ab, ba;\n\nint cntb(int l, int r) { return sb[r] - (l ? sb[l - 1] : 0); }\n\nvoid upd(string &s, const string &t) {\n\tfor (int i = 0; i < s.size() && i < t.size(); ++i) if(s[i] != t[i]) { if(s[i] < t[i]) s = t; return; }\n\tif(s.size() < t.size()) s = t;\n\treturn;\n}\n\nstring DP(int beg) {\n\tif(beg == n) return \"\";\n\tauto &dp = ::dp[beg]; if(dp.size() != 0) return dp;\n\tauto it = ba.lower_bound(make_pair(beg, -1));\n\tif(it == ba.end()) {\n\t\tint lst = beg - 1;\n\t\tit = ab.lower_bound(make_pair(beg, -1));\n\t\twhile(it != ab.end()) {\n\t\t\tif(it->first > lst) dp += \"ab\", lst = it->second;\n\t\t\t++it;\n\t\t}\n\t\treturn dp;\n\t}\n\tint mx = -1;\n\tvector<int> nxt;\n\twhile(it != ba.end()) {\n\t\tint foo = cntb(it->first, it->second);\n\t\tif(foo > mx) mx = foo, nxt.clear();\n\t\tif(foo == mx) nxt.push_back(it->first);\n\t\t++it;\n\t}\n\tif(nxt[0] == beg) {\n\t\tit = ba.lower_bound(make_pair(beg, -1));\n\t\tvector<int> tmp; int lst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t++it;\n\t\twhile(it != ba.end()) {\n\t\t\tif(it->first > lst) break;\n\t\t\tlst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t\t++it;\n\t\t}\n\t\tsort(tmp.begin(), tmp.end());\n\t\tfor (int i: tmp) dp += s[i];\n\t\tdp += DP(tmp.back() + 1);\n\t\tupd(dp, DP(beg + 1));\n\t\treturn dp;\n\t}\n\treturn dp = DP(beg + 1);\n}\n\nint main() {\n\tcin >> n >> s; n *= 2;\n\tfor (int i = 0; i < n; ++i) sb[i] = (s[i] == 'b');\n\tfor (int i = 1; i < n; ++i) sb[i] += sb[i - 1];\n\tfor (int pb = -1, pa = 0; pa < n; ++pa) if(s[pa] == 'a') {\n\t\t++pb; while(s[pb] != 'b') ++pb;\n\t\tif(pa < pb) ab.insert(make_pair(pa, pb));\n\t\telse ba.insert(make_pair(pb, pa));\n\t}\n\tcout << DP(0) << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    n=Read();\n    for(LL i=1;i<=2*n;++i) a[i]=1;\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll=int64_t;\n#define int ll\n\n#define FOR(i,a,b) for(int i=int(a);i<int(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define MP make_pair\n#define PB push_back\n#define ALL(x) x.begin(),x.end()\n#ifdef MAROON_LOCAL\n#define cerr (cerr<<\"-- line \"<<__LINE__<<\" -- \")\n#else\nclass CerrDummy{}cerrDummy;\ntemplate<class T>\nCerrDummy& operator<<(CerrDummy&cd,const T&){\n\treturn cd;\n}\nusing charTDummy=char;\nusing traitsDummy=char_traits<charTDummy>;\nCerrDummy& operator<<(CerrDummy&cd,basic_ostream<charTDummy,traitsDummy>&(basic_ostream<charTDummy,traitsDummy>&)){\n\treturn cd;\n}\n#define cerr cerrDummy\n#endif\n#define REACH cerr<<\"reached\"<<endl\n#define DMP(x) cerr<<#x<<\":\"<<x<<endl\n#define ZERO(x) memset(x,0,sizeof(x))\n#define ONE(x) memset(x,-1,sizeof(x))\n\nusing pi=pair<int,int>;\nusing vi=vector<int>;\nusing ld=long double;\n\ntemplate<class T,class U>\nostream& operator<<(ostream& os,const pair<T,U>& p){\n\tos<<\"(\"<<p.first<<\",\"<<p.second<<\")\";\n\treturn os;\n}\n\ntemplate<class T>\nostream& operator <<(ostream& os,const vector<T>& v){\n\tos<<\"{\";\n\tREP(i,(int)v.size()){\n\t\tif(i)os<<\",\";\n\t\tos<<v[i];\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nll read(){\n\tll i;\n\tscanf(\"%\" SCNd64,&i);\n\treturn i;\n}\n\nvoid printSpace(){\n\tprintf(\" \");\n}\n\nvoid printEoln(){\n\tprintf(\"\\n\");\n}\n\nvoid print(ll x,int suc=1){\n\tprintf(\"%\" PRId64,x);\n\tif(suc==1)\n\t\tprintEoln();\n\tif(suc==2)\n\t\tprintSpace();\n}\n\nstring readString(){\n\tstatic char buf[3341000];\n\tscanf(\"%s\",buf);\n\treturn string(buf);\n}\n\nchar* readCharArray(){\n\tstatic char buf[3341000];\n\tstatic int bufUsed=0;\n\tchar* ret=buf+bufUsed;\n\tscanf(\"%s\",ret);\n\tbufUsed+=strlen(ret)+1;\n\treturn ret;\n}\n\ntemplate<class T,class U>\nvoid chmax(T& a,U b){\n\tif(a<b)\n\t\ta=b;\n}\n\ntemplate<class T,class U>\nvoid chmin(T& a,U b){\n\tif(b<a)\n\t\ta=b;\n}\n\ntemplate<class T>\nT Sq(const T& t){\n\treturn t*t;\n}\n\n#define CAPITAL\nvoid Yes(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"YES\"<<endl;\n\t#else\n\tcout<<\"Yes\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\nvoid No(bool ex=true){\n\t#ifdef CAPITAL\n\tcout<<\"NO\"<<endl;\n\t#else\n\tcout<<\"No\"<<endl;\n\t#endif\n\tif(ex)exit(0);\n}\n\nconst ll infLL=LLONG_MAX/3;\n\n#ifdef int\nconst int inf=infLL;\n#else\nconst int inf=INT_MAX/2-100;\n#endif\n\n/*\nsigned main(){\n\tint n=read();\n\tstring s=readString();\n\tvi pos(n,-1);\n\tint cnt[2]{};\n\tvi cor(n*2,-1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tint j=cnt[s[i]-'a']++;\n\t\tif(pos[j]==-1)\n\t\t\tpos[j]=i;\n\t\telse\n\t\t\tcor[i]=pos[j];\n\t}\n\tcerr<<cor<<endl;\n\tvector<string> ans(n*2+1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\t\n\t}\n}*/\n\nsigned main(){\n\tint n=read();\n\tstring s=readString();\n\tvi pos(n,-1);\n\tint cnt[2]{};\n\tvi cor(n*2,-1);\n\tfor(int i=n*2-1;i>=0;i--){\n\t\tint j=cnt[s[i]-'a']++;\n\t\tif(pos[j]==-1)\n\t\t\tpos[j]=i;\n\t\telse\n\t\t\tcor[i]=pos[j];\n\t}\n\tcerr<<cor<<endl;\n\tstring ans;\n\tint t=n*2;\n\tfor(int i=n*2-1;i>=0;){\n\t\tif(s[i]=='b'){\n\t\t\tint j=i,cur=0;\n\t\t\twhile(1){\n\t\t\t\tcur+=(s[j--]-'a')*2-1;\n\t\t\t\tif(cur==0)break;\n\t\t\t}\n\t\t\ti=j;\n\t\t\tt=i+1;\n\t\t}else\n\t\t\tbreak;\n\t}\n\tcerr<<t<<endl;\n\tvector<string> dp(t+1);\n\tfor(int head=t-1;head>=0;head--){\n\t\tif(s[head]=='b'&&cor[head]!=-1){\n\t\t\tvi use(n*2,0);\n\t\t\tstring w;\n\t\t\tint right=cor[head],i=head;\n\t\t\twhile(i<=right){\n\t\t\t\tif(s[i]=='b'){\n\t\t\t\t\tif(cor[i]!=-1){\n\t\t\t\t\t\tw+=s[i];\n\t\t\t\t\t\tuse[cor[i]]=1;\n\t\t\t\t\t\tright=cor[i];\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(use[i])\n\t\t\t\t\t\tw+=s[i];\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tcerr<<i<<\" \"<<w<<endl;\n\t\t\tw+=dp[i];\n\t\t\tchmax(ans,w);\n\t\t}\n\t\tdp[head]=ans;\n\t}\n\tcerr<<dp<<endl;\n\tfor(int i=t;i<n*2;){\n\t\tif(s[i]=='a'){\n\t\t\tans+=\"ab\";\n\t\t\ti=cor[i];\n\t\t}else{\n\t\t\ti++;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define finish(x) return cout << x << endl, 0\n#define ll long long\n\nint n;\nstring s;\n\nstring solve(string s){\n    int n = s.size();\n    string ret;\n    if(s[0] == 'a'){\n        vector <int> as, bs;\n        for(int i = 0 ; i < n ; i++){\n            if(s[i] == 'a') as.push_back(i);\n            else bs.push_back(i);\n        }\n        int lasb = -1;\n        for(int i = 0 ; i < n / 2 ; i++){\n            if(as[i] > lasb){\n                ret += \"ab\";\n                lasb = bs[i];\n            }\n        }\n    }\n    else{\n        ret = s;\n        while(s.size()){\n            int x = 0;\n            while(s[x] != 'a') x++;\n            int y = 0;\n            while(s[y] != 'b') y++;\n            if(y < x) swap(x, y);\n            s.erase(s.begin() + y);\n            s.erase(s.begin() + x);\n            ret = max(ret, s);\n        }\n    }\n    return ret;\n}\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    cin >> n >> s;\n    vector <string> a;\n    for(int i = 0 ; i < 2 * n ;){\n        int cur = s[i] == 'a' ? -1 : 1;\n        int j = i + 1;\n        string cur_s;\n        cur_s += s[i];\n        while(j < 2 * n){\n            cur += s[j] == 'a' ? -1 : 1;\n            cur_s += s[j];\n            j++;\n            if(cur == 0) break;\n        }\n        a.push_back(cur_s);\n        i = j;\n    }\n    for(auto &i : a) i = solve(i);\n    n = a.size();\n    vector <string> dp(n);\n    for(int i = n - 1 ; i >= 0 ; i--){\n        dp[i] = a[i];\n        if(i + 1 < n){\n            dp[i] = max(dp[i], dp[i + 1]);\n        }\n        for(int j = i + 1 ; j < n ; j++){\n            dp[i] = max(dp[i], a[i] + dp[j]);\n        }\n    }\n    cout << dp[0] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define x first\n#define y second\n\nusing namespace std;\n\nconst int INF=1e+7;\nconst int MAX=6005;\nchar s[MAX];\nint n,chk[MAX],lim;\nvector<int> p[2],cut;\nstruct group{\n    int idx;\n    string part;\n    bool operator<(const group &x){\n        if(part!=x.part&&(part[0]=='b'||x.part[0]=='b')) return part>x.part;\n        return idx<x.idx;\n    }\n};\ngroup wtf[MAX];\nint main(){\n    scanf(\" %d %s\",&n,s);\n    for(int i=0;i<2*n;i++) p[s[i]-'a'].push_back(i);\n    cut.push_back(0);\n    for(int i=0;i<n;i++) {\n        chk[p[0][i]]=1,chk[p[1][i]]=1;\n        lim=max(lim,max(p[0][i],p[1][i]));\n        if(lim==2*i+1) cut.push_back(i+1);\n    }\n    for(int i=0;i<2*n;i++) chk[i]=0;\n    for(int i=0;i<cut.size()-1;i++){\n        wtf[i].idx=i;\n        if(p[0][cut[i]]>p[1][cut[i]]){\n            for(int j=cut[i+1]-1;j>=cut[i];j--){\n                chk[p[0][j]]=1,chk[p[1][j]]=1;\n                string tmp;\n                for(int k=0;k<2*n;k++) if(chk[k]) tmp.push_back(s[k]);\n                wtf[i].part=max(wtf[i].part,tmp);\n            }\n        }\n        else{\n            int pt=-1;\n            for(int j=cut[i];j<cut[i+1];j++){\n                if(pt<p[0][j]) pt=p[1][j], wtf[i].part.append(\"ab\");\n            }\n        }\n        for(int j=cut[i];j<cut[i+1];j++) chk[p[0][j]]=0,chk[p[1][j]]=0;\n    }\n    sort(wtf,wtf+(cut.size()-1));\n    lim=-1;\n    for(int i=0;i<cut.size()-1;i++) if(lim<wtf[i].idx) lim=wtf[i].idx, cout<<wtf[i].part;\n    cout<<'\\n';\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\nint PAIR[6050];\nstring dp[6050];\n\nint main() {\n    //cout.precision(10);\n    int N;\n    string S;\n    cin >> N >> S;\n    S = \"#\" + S;\n    queue<int> a, b;\n    for(int i = 1; i <= 2*N; i++) {\n        if(S[i] == 'a') a.push(i);\n        else b.push(i);\n    }\n    for(int i = 1; i <= N; i++) {\n        int A = a.front();\n        int B = b.front();\n        a.pop();\n        b.pop();\n        PAIR[A] = B;\n        PAIR[B] = A;\n    }\n    for(int i = 1; i <= 2*N; i++) {\n        //cerr << PAIR[i] << endl;\n    }\n    for(int index = 2*N; index >= 1; index--) {\n        dp[index] = dp[index + 1];\n        if(PAIR[index] < index) continue;\n        if(S[index] == 'a') {\n            string sub = \"ab\" + dp[PAIR[index] + 1];\n            dp[index] = max(dp[index], sub);\n            continue;\n        }\n        if(S[index] == 'b') {\n            string sub = \"b\";\n            int plus = 1;\n            int sub_index = index + 1;\n            for(; plus > 0; sub_index++) {\n                if(S[sub_index] == 'b') {\n                    sub = sub + \"b\";\n                    plus++;\n                    continue;\n                }\n                if(sub_index < PAIR[index]) continue;\n                sub = sub + \"a\";\n                plus--;\n            }\n            sub = sub + dp[sub_index];\n            dp[index] = max(dp[index], sub);\n        }\n    }\n    cout << dp[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\n    _____\n  .'     '.\n /  0   0  \\\n|     ^     |\n|  \\     /  |\n \\  '---'  /\n  '._____.'\n*/\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\nstruct chash\n{\n\tint operator()(int x) const\n\t{\n\t\tx ^= (x >> 20) ^ (x >> 12);\n\t\treturn x ^ (x >> 7) ^ (x >> 4);\n\t}\n};\n\ntemplate<typename T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename U> using hashtable = gp_hash_table<T, U, chash>;\nrandom_device(rd);\nmt19937 rng(rd());\n\ntemplate<class T>\nvoid readi(T &x)\n{\n\tT input = 0;\n\tbool negative = false;\n\tchar c = ' ';\n\twhile (c < '-')\n\t{\n\t\tc = getchar();\n\t}\n\tif (c == '-')\n\t{\n\t\tnegative = true;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0')\n\t{\n\t\tinput = input * 10 + (c - '0');\n\t\tc = getchar();\n\t}\n\tif (negative)\n\t{\n\t\tinput = -input;\n\t}\n\tx = input;\n}\ntemplate<class T>\nvoid printi(T output)\n{\n\tif (output == 0)\n\t{\n\t\tputchar('0');\n\t\treturn;\n\t}\n\tif (output < 0)\n\t{\n\t\tputchar('-');\n\t\toutput = -output;\n\t}\n\tint aout[20];\n\tint ilen = 0;\n\twhile(output)\n\t{\n\t\taout[ilen] = ((output % 10));\n\t\toutput /= 10;\n\t\tilen++;\n\t}\n\tfor (int i = ilen - 1; i >= 0; i--)\n\t{\n\t\tputchar(aout[i] + '0');\n\t}\n\treturn;\n}\ntemplate<class T>\nvoid ckmin(T &a, T b)\n{\n\ta = min(a, b);\n}\ntemplate<class T>\nvoid ckmax(T &a, T b)\n{\n\ta = max(a, b);\n}\ntemplate<class T, class U>\nT nmod(T &x, U mod)\n{\n\tif (x >= mod) x -= mod;\n}\ntemplate<class T>\nT randomize(T mod)\n{\n\treturn (uniform_int_distribution<T>(0, mod - 1))(rng);\n}\n\n#define y0 ___y0\n#define y1 ___y1\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define PF push_front\n#define LB lower_bound\n#define UB upper_bound\n#define fi first\n#define se second\n#define debug(x) cerr << #x << \" = \" << x << endl;\n\nconst long double PI = 4.0 * atan(1.0);\nconst long double EPS = 1e-10;\n\n#define MAGIC 347\n#define SINF 10007\n#define CO 1000007\n#define INF 1000000007\n#define BIG 1000000931\n#define LARGE 1696969696967ll\n#define GIANT 2564008813937411ll\n#define LLINF 2696969696969696969ll\n#define MAXN 6013\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ld, ld> pdd;\n\nint N, K;\nint arr[MAXN], pref[MAXN];\nint blocks[MAXN];\nint partner[MAXN];\nbitset<MAXN> typ;\nvector<pii> idx[MAXN];\nvector<bool> dp[MAXN];\nvector<bool> ans;\nbitset<MAXN> flag;\n\nbool operator < (const vector<bool> &a, const vector<bool> &b)\n{\n\tfor (int i = 0; i < min(a.size(), b.size()); i++)\n\t{\n\t\tif (a[i] != b[i])\n\t\t{\n\t\t\treturn a[i] < b[i];\n\t\t}\n\t}\n\treturn (a.size() < b.size());\n}\nbool operator > (const vector<bool> &a, const vector<bool> &b)\n{\n\treturn b < a;\n}\n\nint32_t main()\n{\n\tios_base::sync_with_stdio(0);\n\t// cout << fixed << setprecision(10);\n\t// cerr << fixed << setprecision(10);\n\t// freopen (\"file.in\", \"r\", stdin);\n\t// freopen (\"file.out\", \"w\", stdout);\n\tcin >> N;\n\tN *= 2;\n\tstring temps;\n\tcin >> temps;\n\tfor (int i = 0; i < N; i++)\n\t{\n\t\tarr[i] = (temps[i] == 'a' ? 1 : -1);\n\t\tpref[i + 1] = pref[i] + arr[i];\n\t}\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tif (pref[i] == 0)\n\t\t{\n\t\t\tK++;\n\t\t\tblocks[K] = i - 1;\n\t\t}\n\t}\n\tblocks[0] = -1;\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tidx[i].resize((rt - lt + 1) / 2);\n\t\tint iter = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == 1)\n\t\t\t{\n\t\t\t\tidx[i][iter].fi = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\titer = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == -1)\n\t\t\t{\n\t\t\t\tidx[i][iter].se = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\t// cerr << \"block \" << i << endl;\n\t\tfor (pii p : idx[i])\n\t\t{\n\t\t\tpartner[p.fi] = p.se;\n\t\t\tpartner[p.se] = p.fi;\n\t\t\t// cerr << p.fi << ' ' << p.se << endl;\n\t\t}\n\t\ttyp[i] = (bool) (idx[i][0].fi > idx[i][0].se);\n\t}\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t//if typ[i] is true, it's abababababab\n\t\t//if typ[i] is false, it's babababababa\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tif (typ[i])\n\t\t{\n\t\t\t//babababa\n\t\t\tvector<bool> temp;\n\t\t\tfor (int j = idx[i].size() - 1; j >= 0; j--)\n\t\t\t{\n\t\t\t\tflag[idx[i][j].fi] = true;\n\t\t\t\tflag[idx[i][j].se] = true;\n\t\t\t\ttemp.clear();\n\t\t\t\tfor (int k = lt; k <= rt; k++)\n\t\t\t\t{\n\t\t\t\t\tif (flag[k])\n\t\t\t\t\t{\n\t\t\t\t\t\ttemp.PB(arr[k] - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (temp > dp[i])\n\t\t\t\t{\n\t\t\t\t\tdp[i] = temp;\n\t\t\t\t}\n\t\t\t\t// for (bool b : dp[i])\n\t\t\t\t// {\n\t\t\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t\t\t// }\n\t\t\t\t// cerr << endl;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//ababababab\n\t\t\tfor (int j = lt; j <= rt;)\n\t\t\t{\n\t\t\t\tdp[i].PB(0);\n\t\t\t\tdp[i].PB(1);\n\t\t\t\tj = partner[j];\n\t\t\t\tauto it = UB(idx[i].begin(), idx[i].end(), MP(j + 1, -INF));\n\t\t\t\tif (it == idx[i].end()) break;\n\t\t\t\tj = it -> fi;\n\t\t\t}\n\t\t}\n\t}\n\t// cerr << \"our dps\\n\";\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t// for (bool b : dp[i])\n\t\t// {\n\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t// }\n\t\t// cerr << endl;\n\t\tbool used = true;\n\t\tfor (int j = i + 1; j <= K; j++)\n\t\t{\n\t\t\tfor (int k = 0; k < dp[j].size() && k < dp[i].size(); k++)\n\t\t\t{\n\t\t\t\tif (dp[j][k] == 1 && dp[i][k] == 0)\n\t\t\t\t{\n\t\t\t\t\tused = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (dp[j][k] == 0 && dp[i][k] == 1)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if (dp[j] > dp[i]) used = false;\n\t\t\tif (!used)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (used)\n\t\t{\n\t\t\tfor (bool b : dp[i])\n\t\t\t{\n\t\t\t\tans.PB(b);\n\t\t\t}\n\t\t}\n\t}\n\tfor (bool b : ans)\n\t{\n\t\tcout << (b ? 'b' : 'a');\n\t}\n\tcout << '\\n';\n\t// cerr << \"time elapsed = \" << (clock() / (CLOCKS_PER_SEC / 1000)) << \" ms\" << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int MX = 3000;\n\nchar s[2 * MX + 1];\nint id[2 * MX];\nbool used[MX];\n\nint main() {\n\tint n;\n\tignore = scanf(\"%d %s\", &n, s);\n\t\n\t// do {\n\t\tmemset(used, 0, sizeof used);\n\t\t\n\t\tfor (int i = 0, p = 0, q = 0; i < 2 * n; i++) {\n\t\t\tid[i] = s[i] == 'a' ? p++ : q++;\n\t\t}\n\t\t\n\t\tauto get = [&]() {\n\t\t\tstring res;\n\t\t\tfor (int i = 0; i < 2 * n; i++) if (used[id[i]]) res += s[i];\n\t\t\treturn res;\n\t\t};\n\t\t\n\t\tstring best;\n\t\tint bestPref = n;\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tint j = 0;\n\t\t\twhile (id[j] != i) j++;\n\t\t\tused[i] = s[j] == 'b';\n\t\t\t\n\t\t\tauto s = get();\n\t\t\tif (s > best) {\n\t\t\t\tbest = s;\n\t\t\t\tbestPref = i;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < bestPref; i++) used[i] = false;\n\t\t\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tused[i] = false;\n\t\t\tauto s = get();\n\t\t\tused[i] = true;\n\t\t\tauto t = get();\n\t\t\tused[i] = t > s;\n\t\t}\n\t\t\n\t\tprintf(\"%s\\n\", get().c_str());\n\t/*\n\t\tauto my = get();\n\t\t\n\t\tstring ans = get();\n\t\tfor (int msk = 0; msk < (1 << n); msk++) {\n\t\t\tfor (int i = 0; i < n; i++) used[i] = ((msk >> i) & 1) == 1;\n\t\t\tans = max(ans, get());\n\t\t}\n\t\t\n\t\tif (my != ans) printf(\"\\t%s\\n%s\\n%s\\n\", s, my.c_str(), ans.c_str());\n\t} while (next_permutation(s, s + 2 * n));\n\t*/\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<string>\nusing namespace std;\nchar p[6010];\nint n;\nstruct point {\n\tint a, b;\n}w[3010];\nint A[6010], Num[6010], cA, cB;\nstring D[6010];\nchar q[6010];\nint main() {\n\tint i, j;\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", p + 1);\n\tfor (i = 1; i <= n+n; i++) {\n\t\tif (p[i] == 'a')w[++cA].a = i;\n\t\tif (p[i] == 'b')w[++cB].b = i;\n\t}\n\tfor (i = 1; i <= n; i++) {\n\t\tNum[w[i].a] = Num[w[i].b] = i;\n\t}\n\tfor (i = n+n - 1; i >= 1; i--) {\n\t\tint pv = Num[i];\n\t\tD[i] = D[i + 1];\n\t\tif (p[i] == 'a') {\n\t\t\tif (w[pv].b < w[pv].a)continue;\n\t\t\tif (!D[i + 1].size() || D[i + 1][0] == 'a') {\n\t\t\t\tD[i] = \"ab\" + D[w[pv].b + 1];\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\telse {\n\t\t\tif (w[pv].a < w[pv].b)continue;\n\t\t\tint c = 0;\n\t\t\tfor (j = pv; j <= n; j++) {\n\t\t\t\tif (w[j].a < w[j].b)break;\n\t\t\t}\n\t\t\tint ed = j - 1, last = 0;\n\t\t\tfor (j = i; j <= n + n; j++) {\n\t\t\t\tif (Num[j] >= pv && Num[j] <= ed) q[c++] = p[j], last = j;\n\t\t\t}\n\t\t\tq[c] = 0;\n\t\t\tD[i] = max(D[i+1], q + D[last + 1]);\n\t\t}\n\t}\n\tprintf(\"%s\\n\", D[1].c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n\nstring solve(string s){\n\tvector<int> a;\n\tvector<int> b;\n\tfor(int i = 0; i < s.size(); i++){\n\t\tif(s[i] == 'a'){\n\t\t\ta.push_back(i);\n\t\t} else {\n\t\t\tb.push_back(i);\n\t\t}\n\t}\n\tstring dp[s.size() + 1];\n\tfor(int j = a.size() - 1; j >= 0; j--){\n\t\tint ok = 0;\n\t\tfor(int i = j; i < a.size(); i++){\n\t\t\tif(b[i] < a[i]) ok = 1;\n\t\t}\n\t\tif(!ok){\n\t\t\tdp[j] = \"\";\n\t\t\tint lastb = 0;\n\t\t\tfor(int i = j; i < a.size(); i++){\n\t\t\t\tif(a[i] >= lastb){\n\t\t\t\t\tlastb = b[i];\n\t\t\t\t\tdp[j] += \"ab\";\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint lasta = j;\n\t\t\tvector<pair<int, string> > z;\n\t\t\tstring addon;\n\t\t\tfor(int i = j; i < a.size(); i++){\n\t\t\t\tif(i == j || b[i] < lasta){\n\t\t\t\t\tif(b[i] < a[i]){\n\t\t\t\t\t\tlasta = a[i];\n\t\t\t\t\t\tz.push_back({a[i], \"a\"});\n\t\t\t\t\t\tz.push_back({b[i], \"b\"});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\taddon = dp[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring f;\n\t\t\tsort(z.begin(), z.end());\n\t\t\tfor(int i = 0; i < z.size(); i++){\n\t\t\t\tf += z[i].second;\n\t\t\t}\n\t\t\tdp[j] = f + addon;\n\t\t\tif(dp[j+1] > dp[j]){\n\t\t\t\tdp[j] = dp[j+1];\n\t\t\t}\n\t\t}\n\t}\n\treturn dp[0];\n}\nint main(){\n\tint n;\n\tstring s;\n\tcin >> n >> s;\n\tcout << solve(s) << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nint n;\ninline std::string calc(std::string s,int ok) {\n\tif(s.front() == 'a') {\n\t\tif(ok) return \"\";\n\t\tstd::string ret;\n\t\tint i0 = 0,i1 = 0, max = 0;\n\t\tfor(;i1 < s.size();) {\n\t\t\tfor(;i0 < s.size() && s[i0] != 'a';++i0);\n\t\t\tfor(;i1 < s.size() && s[i1] != 'b';++i1);\n\t\t\tif(i0 < s.size() && i0 >= max) max = i1, ret += \"ab\";\n\t\t\t++ i0, ++ i1;\n\t\t}\n\t\treturn ret;\n\t} else {\n\t\tstd::string max;\n\t\tfor(int i = 0;i + i < s.size();++i) {\n\t\t\tstd::string now; int ca = i, cb = i;\n\t\t\tfor(auto c : s) if(--(c == 'a' ? ca : cb) < 0)\n\t\t\t\tnow += c;\n\t\t\tif(now > max) max = now;\n\t\t}\n\t\treturn max;\n\t}\n}\nint main() {\n\tstd::cin >> n, n <<= 1; std::string str, ans; char ch; int cnt = 0;\n\twhile(std::cin >> ch) {\n\t\tstr += ch; cnt += ch & 1 ? 1 : -1; -- n;\n\t\tif(cnt == 0)\n\t\t\tans += calc(str, n != 0), str = \"\";\n\t}\n\tstd::cout << ans << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define N 10010\n#define mr make_pair\nusing namespace std;\nint n,g[2],s[N][2],w[N];\nstring dp[N];\nchar ch[N];\nstring que(int l,int r){string no=\"\";for (int i=0;i<2*n;i++)if (w[i]>=l&&w[i]<=r)no+=ch[i];return no;}\nstring ma(string x,string y){\n\tfor (int i=0;i<min(x.length(),y.length());i++){if (x[i]<y[i])return y;if (y[i]<x[i])return x;}\n\tif (x.length()>y.length())return x;return y;\n}\nint main(){\n//\tfreopen(\"d.in\",\"r\",stdin);\n\tcin>>n;\n\tfor (int i=0;i<2*n;i++){\n\t\tch[i]=getchar();while (ch[i]!='a'&&ch[i]!='b')ch[i]=getchar();\n\t\tg[ch[i]-'a']++;s[g[ch[i]-'a']][ch[i]-'a']=i;w[i]=g[ch[i]-'a'];\n\t}\n\tfor (int i=n;i>=1;i--){\n\t\tdp[i]=dp[i+1];\n\t\tif (s[i][0]<s[i][1]){\n\t\t\tint x=i+1;\n\t\t\twhile (x<=n&&s[x][0]<s[i][1])x++;\n\t\t\tdp[i]=ma(dp[i],\"ab\"+dp[x]);\n\t\t}else{\n\t\t\tint x=i+1,y=s[i][0];\n\t\t\twhile (x<=n&&s[x][1]<y)x++,y=s[x][0];\n\t\t\tdp[i]=ma(dp[i],que(i,x-1)+dp[x]);\n\t\t}\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (true || pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first,pos[b].second)){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < max(pos[b].first, pos[b].second)){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = pos[b].first;\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (pos[j].first> maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].second;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].first> maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].second;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].second > maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].first;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (pos[j].second > maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\n\npair<string,int> solve(int l){\n\tint i=l+1;\n\tvector<string> ss;\n\twhile(abs(s[l]-s[i])!=1){\n\t\tauto p=solve(i);\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\tvector<string> re;\n\trrep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret;\n\trrep(i,re.size()) ret+=re[i];\n\tMX(ret,string(1,s[l])+ret+string(1,s[i]));\n\t++i;\n\tout(l,i,ret,1);\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\ts=\"e\"+s+\"f\";\n\tauto re=solve(0).X;\n\tint m=re.size();\n\tcout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<=k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<=k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int mxn=3333;\nstring f[mxn];\nchar s[mxn<<1];\nint s1[mxn],s2[mxn],n,pos[mxn<<1],t1,t2;\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n<<1;++i){\n\t\tif(s[i]=='a')s1[++t1]=i,pos[i]=t1;\n\t\telse s2[++t2]=i,pos[i]=t2;\n\t}\n\tstring ans=\"\";\n\tfor(int i=n;i;--i){\n\t\tif(s1[i]<s2[i]){\n\t\t\tint k=i;\n\t\t\tfor(int j=s1[i]+1;j<s2[i];++j)k=max(k,pos[j]);\n\t\t\tf[i]=\"ab\"+f[k+1];\n\t\t}else{\n\t\t\tint k=i;\n\t\t\twhile(k<n and s2[k+1]<s1[k])++k;\n\t\t\tfor(int j=s2[i];j<=n<<1;++j)if(i<=pos[j] and pos[j]<=k)f[i]+=s[j];\n\t\t\tf[i]+=f[k+1];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%s\\n\",ans.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nint n,p[N],pp[N],t[N];\nint q[N],head,tail;\nstring res[N],now;\nchar s[N];\nvector <int> a,b;\nint main(){\n\tscanf(\"%d\",&n);\n\tn<<=1;\n\tscanf(\"%s\",s+1);\n\ta.clear(),b.clear();\n\tfor (int i=1;i<=n;i++)\n\t\tif (s[i]=='a')\n\t\t\ta.push_back(i);\n\t\telse\n\t\t\tb.push_back(i);\n\tfor (int i=1;i<=n/2;i++)\n\t\tp[b[i-1]]=a[i-1],pp[a[i-1]]=b[i-1];\n\tfor (int i=1;i<=n+1;i++)\n\t\tres[i]=\"\";\n\tint tot=0;\n\tint nxt=n+1;\n\tfor (int i=n;i>=1;i--){\n\t\tif (s[i]=='a')\n\t\t\ttot++;\n\t\telse\n\t\t\ttot--;\n\t\tif (tot)\n\t\t\tcontinue;\n\t\tmemset(t,0,sizeof t);\n\t\thead=1,tail=0;\n\t\tres[i]=res[nxt];\n\t\tfor (int j=i;j<nxt;j++){\n\t\t\tif (s[j]=='a'){\n\t\t\t\tif (t[j]){\n\t\t\t\t\tnow=\"\";\n\t\t\t\t\tfor (int k=i;k<nxt;k++)\n\t\t\t\t\t\tif (s[k]=='b'){\n\t\t\t\t\t\t\tif (t[k]||k>j)\n\t\t\t\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (t[k]||k>p[q[tail]])\n\t\t\t\t\t\t\tnow+=\"a\";\n\t\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\t\thead++;\n\t\t\t\t\tt[j]=t[pp[j]]=0;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (p[j]<j)\n\t\t\t\tcontinue;\n\t\t\tq[++tail]=j;\n\t\t\tt[j]=t[p[j]]=1;\n\t\t}\n\t\tmemset(t,0,sizeof t);\n\t\tif (tail==0){\n\t\t\tfor (int j=i;j<nxt;j++){\n\t\t\t\tif (s[j]=='b')\n\t\t\t\t\tcontinue;\n\t\t\t\tt[j]=t[pp[j]]=1;\n\t\t\t\tnow=\"\";\n\t\t\t\tfor (int k=i;k<=pp[j];k++)\n\t\t\t\t\tif (t[k])\n\t\t\t\t\t\tnow+=s[k];\n\t\t\t\tres[i]=max(res[i],now+res[nxt]);\n\t\t\t\tj=pp[j];\n\t\t\t}\n\t\t}\n\t\tnxt=i;\n\t}\n\tcout << res[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nconst int MAX = 3000;\n\nstring greedA(string S, int l, int r) { // 先頭がaだった時の貪欲取得(abab…系)\n\tstring ret(S.begin() + l, S.begin() + r);\n\tfor (int i = 1, ma = r - l, j, k;i < ma;++ i) {\n\t\tif (ret[i] == 'a') { // 連続した'a'を発見\n\t\t\tfor (j = i + 1;ret[j] == 'a';j ++); // 最初に出てくるb(消さない)\n\t\t\tfor (k = j + 1;ret[k] == 'a';k ++); // 次に出てくるb(消す)\n\t\t\tret.erase(ret.begin() + k);\n\t\t\tret.erase(ret.begin() + i);\n\t\t\t-- i;\n\t\t} else ++ i;\n\t}\n\treturn ret;\n}\n\nstring greedB(string S, int l, int r) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring ret(S.begin() + l, S.begin() + r), comp = ret;\n\tfor (int i = 0, ma = ((r - l) >> 1), j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tret = ret > comp ? ret : comp;\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstring greed[MAX];\n\tint use = 0;\n\t\n\tfor (int l = 0, r = 0;l < N;l = r + 1, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\tif (isA[l]) greed[use] = greedA(S, l, r + 1);\n\t\telse greed[use] = greedB(S, l, r + 1);\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "// #pragma GCC optimize(2)\n// #pragma G++ optimize(2)\n// #pragma comment(linker,\"/STACK:102400000,102400000\")\n\n//#include <bits/stdc++.h>\n#include <map>\n#include <set>\n#include <list>\n#include <array>\n#include <cfenv>\n#include <cmath>\n#include <ctime>\n#include <deque>\n#include <mutex>\n#include <queue>\n#include <ratio>\n#include <regex>\n#include <stack>\n#include <tuple>\n#include <atomic>\n#include <bitset>\n#include <cctype>\n#include <cerrno>\n#include <cfloat>\n#include <chrono>\n#include <cstdio>\n#include <cwchar>\n#include <future>\n#include <limits>\n#include <locale>\n#include <memory>\n#include <random>\n#include <string>\n#include <thread>\n#include <vector>\n#include <cassert>\n#include <climits>\n#include <clocale>\n#include <complex>\n#include <csetjmp>\n#include <csignal>\n#include <cstdarg>\n#include <cstddef>\n#include <cstdint>\n#include <cstdlib>\n#include <cstring>\n#include <ctgmath>\n#include <cwctype>\n#include <fstream>\n#include <iomanip>\n#include <numeric>\n#include <sstream>\n#include <ccomplex>\n#include <cstdbool>\n#include <iostream>\n#include <typeinfo>\n#include <valarray>\n#include <algorithm>\n#include <cinttypes>\n#include <cstdalign>\n#include <stdexcept>\n#include <typeindex>\n#include <functional>\n#include <forward_list>\n#include <system_error>\n#include <unordered_map>\n#include <unordered_set>\n#include <scoped_allocator>\n#include <condition_variable>\n//#include <conio.h>\n//#include <windows.h>\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned int ui;\ntypedef unsigned long long ull;\ntypedef float fl;\ntypedef double ld;\ntypedef long double LD;\ntypedef pair<int,int> pii;\n#if (WIN32) || (WIN64) || (__WIN32) || (__WIN64) || (_WIN32) || (_WIN64) || (WINDOWS)\n#define lld \"%I64d\"\n#define llu \"%I64u\"\n#else\n#define lld \"%lld\"\n#define llu \"%llu\"\n#endif\n#define ui(n) ((unsigned int)(n))\n#define LL(n) ((long long)(n))\n#define ull(n) ((unsigned long long)(n))\n#define fl(n) ((float)(n))\n#define ld(n) ((double)(n))\n#define LD(n) ((long double)(n))\n#define char(n) ((char)(n))\n#define Bool(n) ((bool)(n))\n#define fixpoint(n) fixed<<setprecision(n)\n\nconst int INF=1061109567;\nconst LL LINF=4557430888798830399;\nconst ld eps=1e-15;\n#define MOD (1000000007)\n#define PI (3.1415926535897932384626433832795028841971)\n\n/*\n#define MB_LEN_MAX 5\n#define SHRT_MIN (-32768)\n#define SHRT_MAX 32767\n#define USHRT_MAX 0xffffU\n#define INT_MIN (-2147483647 - 1)\n#define INT_MAX 2147483647\n#define UINT_MAX 0xffffffffU\n#define LONG_MIN (-2147483647L - 1)\n#define LONG_MAX 2147483647L\n#define ULONG_MAX 0xffffffffUL\n#define LLONG_MAX 9223372036854775807ll\n#define LLONG_MIN (-9223372036854775807ll - 1)\n#define ULLONG_MAX 0xffffffffffffffffull\n*/\n\n#define MP make_pair\n#define MT make_tuple\n#define All(a) (a).begin(),(a).end()\n#define pall(a) (a).rbegin(),(a).rend()\n#define log2(x) log(x)/log(2)\n#define Log(x,y) log(x)/log(y)\n#define sz(a) ((int)(a).size())\n#define rep(i,n) for(int i=0;i<((int)(n));i++)\n#define rep1(i,n) for(int i=1;i<=((int)(n));i++)\n#define repa(i,a,n) for(int i=((int)(a));i<((int)(n));i++)\n#define repa1(i,a,n) for(int i=((int)(a));i<=((int)(n));i++)\n#define repd(i,n) for(int i=((int)(n))-1;i>=0;i--)\n#define repd1(i,n) for(int i=((int)(n));i>=1;i--)\n#define repda(i,n,a) for(int i=((int)(n));i>((int)(a));i--)\n#define repda1(i,n,a) for(int i=((int)(n));i>=((int)(a));i--)\n#define FOR(i,a,n,step) for(int i=((int)(a));i<((int)(n));i+=((int)(step)))\n#define repv(itr,v) for(__typeof((v).begin()) itr=(v).begin();itr!=(v).end();itr++)\n#define repV(i,v) for(auto i:v)\n#define repE(i,v) for(auto &i:v)\n#define MS(x,y) memset(x,y,sizeof(x))\n#define MC(x) MS(x,0)\n#define MINF(x) MS(x,63)\n#define MCP(x,y) memcpy(x,y,sizeof(y))\n#define sqr(x) ((x)*(x))\n#define UN(v) sort(All(v)),v.erase(unique(All(v)),v.end())\n#define filein(x) freopen(x,\"r\",stdin)\n#define fileout(x) freopen(x,\"w\",stdout)\n#define fileio(x)\\\n\tfreopen(x\".in\",\"r\",stdin);\\\n\tfreopen(x\".out\",\"w\",stdout)\n#define filein2(filename,name) ifstream name(filename,ios::in)\n#define fileout2(filename,name) ofstream name(filename,ios::out)\n#define file(filename,name) fstream name(filename,ios::in|ios::out)\n#define Pause system(\"pause\")\n#define Cls system(\"cls\")\n#define fs first\n#define sc second\n#define PC(x) putchar(x)\n#define GC(x) x=getchar()\n#define Endl PC('\\n')\n#define SF scanf\n#define PF printf\n\ninline int Read()\n{\n    int X=0,w=0;char ch=0;while(!isdigit(ch)){w|=ch=='-';ch=getchar();}while(isdigit(ch))X=(X<<3)+(X<<1)+(ch^48),ch=getchar();\n\treturn w?-X:X;\n}\ninline void Write(int x){if(x<0)putchar('-'),x=-x;if(x>9)Write(x/10);putchar(x%10+'0');}\n\ninline LL powmod(LL a,LL b){LL RES=1;a%=MOD;assert(b>=0);for(;b;b>>=1){if(b&1)RES=RES*a%MOD;a=a*a%MOD;}return RES%MOD;}\ninline LL gcdll(LL a,LL b){return b?gcdll(b,a%b):a;}\nconst int dx[]={0,1,0,-1,1,-1,-1,1};\nconst int dy[]={1,0,-1,0,-1,-1,1,1};\n/************************************************************Begin************************************************************/\nconst int maxn=3010;\n\nint n,pos[maxn];\nstring s,dp[maxn];\nvector<int> a,b;\n\nint main()\n{\n\tcin>>n>>s;s=\" \"+s;\n\n\ta.push_back(0);b.push_back(0);\n\trep1(i,n*2) if(s[i]=='a') a.push_back(i),pos[i]=a.size()-1; else b.push_back(i),pos[i]=b.size()-1;\n\n\trepd1(i,n)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tint mx=0;\n\t\t\trepa1(j,a[i],b[i]) mx=max(mx,pos[j]);\n\t\t\tdp[i]=\"ab\"+dp[mx+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile(k<=n&&b[k+1]<a[k]) k++;\n\t\t\trep1(j,n*2) if(pos[j]>=i&&pos[j]<=k) dp[i]+=s[j];\n\t\t\tdp[i]+=dp[k+1];\n\t\t}\n\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\n\t// rep1(i,n) cout<<dp[i]<<endl;\n\t\n\tcout<<dp[1];\n\n\treturn 0;\n}\n/*************************************************************End**************************************************************/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll int\n#define pb push_back\n#define mp make_pair\n#define ld long double\n#define F first\n#define S second\n#define pii pair<ll,ll>\n#define pie pair<pii,ll>\nusing namespace :: std;\n\nconst ll maxn=6100;\nll dp[maxn];\nll a[maxn];\nll b[maxn];\nll o[maxn];\nstring fa(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n\n    fill(dp,dp+maxn,0);\n    for(ll i=n-2;i>=0;i--){\n        dp[i]=dp[i+1];\n        if(s[i]=='a'){\n            dp[i]=max(dp[i],1+dp[b[o[i]]]);\n        }\n    }\n    string ans;\n    for(ll i=0;i<dp[0];i++){\n        ans+=\"ab\";\n    }\n    return ans;\n}\nstring fb(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n    string maxx;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='b'){\n            string res=\"\";\n            for(ll j=i;j<n;j++){\n                if(o[j]>=o[i]){\n                    res+=s[j];\n                }\n            }\n            maxx=max(maxx,res);\n        }\n    }\n    return maxx;\n\n}\nint main()\n{\n    ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n    string s;\n    ll n;\n    cin>>n>>s;\n    n*=2;\n    string last;\n    ll sum=0;\n    vector<string> vec;\n    for(ll i=0;i<n;i++){\n        last+=s[i];\n        if(s[i]=='a'){\n            sum++;\n        }else{\n            sum--;\n        }\n        if(sum==0){\n            vec.pb(last);\n            last=\"\";\n        }\n    }\n    if(last.size()>0)\n        vec.pb(last);\n    string sara;\n    vector<string> sarb;\n    for(ll i=vec.size()-1;i>=0;i--){\n        if(sarb.empty()){\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }else{\n                sara=vec[i]+sara;\n            }\n        }else{\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }\n        }\n    }\n    reverse(sarb.begin(),sarb.end());\n    for(auto r:sarb){\n        cout<<fb(r);\n    }\n    cout<<fa(sara);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n//string ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tvector<string>vs;\n\tfor(int i=0;i<vec.size();i++){\n\t\tstring str = dp[vec[i]];\n\t\tif(i == vec.size()-1){\n\t\t    assert(vec[i] == pos.size()-1);\n\t\t\tint nxt = a[pos[vec[i]]]+1;\n\t\t\twhile(nxt<2*n){\n\t\t\t\tint p = POSL(a,nxt);\n\t\t\t\tif(p == a.size()) break;\n\t\t\t\tassert(a[p]<b[p]);\n\t\t\t\tstr.pb('a'); str.pb('b');\n\t\t\t\tnxt = b[p]+1;\n\t\t\t}\n\t\t}\n\t\tvs.pb(str);\n\t}\n\tvector<string>dp;\n\tfor(int i=0;i<vs.size();i++){\n\t\tstring hoge = vs[i];\n\t\tfor(int j=0;j<i;j++){\n\t\t\thoge = max(hoge,dp[j]+vs[i]);\n\t\t}\n\t\tdp.pb(hoge);\n\t}\n\tcout<<dp[dp.size()-1]<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MAXN = 3000;\nchar S[2*MAXN + 5];\nint a[MAXN + 5], b[MAXN + 5], c[2*MAXN + 5];\nstring dp[MAXN + 5];\nint main() {\n\tint N, A = 0, B = 0;\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S+1);\n\tfor(int i=1;i<=2*N;i++) {\n\t\tif( S[i] == 'a' ) a[++A] = i, c[i] = A;\n\t\telse b[++B] = i, c[i] = B;\n\t}\n\tdp[N] = char(1);\n\tfor(int i=N-1;i>=1;i--) {\n\t\tdp[i] = char(1);\n\t\tstring s1 = \"\", s2 = \"\";\n\t\tif( a[i] < b[i] ) {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=a[i];j<=b[i];j++)\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\tfor(int j=i+1;j<=Max;j++)\n\t\t\t\tdp[i] = dp[i] + char(0);\n\t\t\ts1 = \"ab\";\n\t\t\tfor(int j=b[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] <= Max ) continue;\n\t\t\t\telse {\n\t\t\t\t\tif( dp[Max+1][c[j]-Max-1] == 1 )\n\t\t\t\t\t\ts1 = s1 + S[j];\n\t\t\t\t}\n\t\t\tfor(int j=Max+1;j<=N;j++)\n\t\t\t\tdp[i] = dp[i] + dp[Max+1][j-Max-1];\t\n\t\t\tfor(int j=a[i]+1;j<=2*N;j++) {\n\t\t\t\tif( c[j] > i && dp[i+1][c[j]-i-1] == 1 )\n\t\t\t\t\ts2 = s2 + S[j];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=b[i];j<=a[i];j++) {\n\t\t\t\tif( c[j] >= i ) s1 = s1 + S[j];\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\t}\n\t\t\tfor(int j=i+1;j<=Max;j++)\n\t\t\t\tdp[i] = dp[i] + char(1);\n\t\t\tfor(int j=a[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] <= Max ) s1 = s1 + S[j];\n\t\t\t\telse {\n\t\t\t\t\tif( dp[Max+1][c[j]-Max-1] == 1 )\n\t\t\t\t\t\ts1 = s1 + S[j];\n\t\t\t\t}\n\t\t\tfor(int j=Max+1;j<=N;j++)\n\t\t\t\tdp[i] = dp[i] + dp[Max+1][j-Max-1];\n\t\t\tfor(int j=b[i]+1;j<=2*N;j++) {\n\t\t\t\tif( c[j] > i && dp[i+1][c[j]-i-1] == 1 )\n\t\t\t\t\ts2 = s2 + S[j];\n\t\t\t}\n\t\t}\n\t\tif( s1 < s2 )\n\t\t\tdp[i] = char(0) + dp[i+1];\n\t}\n\tstring ans;\n\tfor(int i=1;i<=2*N;i++)\n\t\tif( dp[1][c[i]-1] == 1 )\n\t\t\tans = ans + S[i];\n\tcout << ans;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/**\n * code generated by JHelper\n * More info: https://github.com/AlexeyDmitriev/JHelper\n * @author majk\n */\n\n#ifndef MAJK_LIB\n#define MAJK_LIB\n\n#include <vector>\n#include <stack>\n#include <iostream>\n#include <fstream>\n#include <unordered_map>\n#include <unordered_set>\n#include <map>\n#include <iomanip>\n#include <set>\n#include <functional>\n#include <algorithm>\n#include <numeric>\n#include <cassert>\n#include <cmath>\n#include <string>\n#include <queue>\n#include <array>\n#include <bitset>\nusing namespace std;\n\n#define x first\n#define y second\ntypedef std::pair<int,int> pii; typedef long long ll; typedef unsigned long long ull; typedef unsigned int ui; typedef pair<ui,ui> puu;\n\ntemplate <typename T, typename U> std::istream&operator>>(std::istream&i, pair<T,U>&p) {i >> p.x >> p.y; return i;}\ntemplate<typename T>std::istream&operator>>(std::istream&i,vector<T>&t) {for(auto&v:t){i>>v;}return i;}\ntemplate <typename T, typename U> std::ostream&operator<<(std::ostream&o, const pair<T,U>&p) {o << p.x << ' ' << p.y; return o;}\ntemplate<typename T>std::ostream&operator<<(std::ostream&o,const vector<T>&t) {if(t.empty())o<<'\\n';for(size_t i=0;i<t.size();++i){o<<t[i]<<\" \\n\"[i == t.size()-1];}return o;}\ntemplate<typename T> using minheap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T> using maxheap = priority_queue<T, vector<T>, less<T>>;\nui logceil(ll x) { return x?8*sizeof(ll)-__builtin_clzll(x):0; }\n\nnamespace std { template<typename T,typename U>struct hash<pair<T,U>>{hash<T>t;hash<U>u;size_t operator()(const pair<T,U>&p)const{return t(p.x)^(u(p.y)<<7);}}; }\ntemplate<typename T,typename F>T bsh(T l,T h,const F&f){T r=-1,m;while(l<=h){m=(l+h)/2;if(f(m)){l=m+1;r=m;}else{h=m-1;}}return r;}\ntemplate<typename F> double bshd(double l,double h,const F&f,double p=1e-9){ui r=3+(ui)log2((h-l)/p);while(r--){double m=(l+h)/2;if(f(m)){l=m;}else{h=m;}}return (l+h)/2;}\ntemplate<typename T,typename F>T bsl(T l,T h,const F&f){T r=-1,m;while(l<=h){m=(l+h)/2;if(f(m)){h=m-1;r=m;}else{l=m+1;}}return r;}\ntemplate<typename F> double bsld(double l,double h,const F&f){ui r=200;while(r--){double m=(l+h)/2;if(f(m)){h=m;}else{l=m;}}return (l+h)/2;}\ntemplate<typename T> T gcd(T a,T b) { if (a<b) swap(a,b); return b?gcd(b,a%b):a; }\n\n\ntemplate<typename T>class vector2:public vector<vector<T>>{public:vector2(){} vector2(size_t a,size_t b,T t=T()):vector<vector<T>>(a,vector<T>(b,t)){}};\ntemplate<typename T>class vector3:public vector<vector2<T>>{public:vector3(){} vector3(size_t a,size_t b,size_t c,T t=T()):vector<vector2<T>>(a,vector2<T>(b,c,t)){}};\ntemplate<typename T>class vector4:public vector<vector3<T>>{public:vector4(){} vector4(size_t a,size_t b,size_t c,size_t d,T t=T()):vector<vector3<T>>(a,vector3<T>(b,c,d,t)){}};\ntemplate<typename T>class vector5:public vector<vector4<T>>{public:vector5(){} vector5(size_t a,size_t b,size_t c,size_t d,size_t e,T t=T()):vector<vector4<T>>(a,vector4<T>(b,c,d,e,t)){}};\n\n\n#endif\n\nclass ESynchronizedSubsequence {\npublic:\n    void solve(istream& cin, ostream& cout) {\n        int N; cin >> N;\n        string S; cin >> S;\n        vector<int> A, B;\n        int bal = 0;\n        int last = 0;\n        auto solve = [&](int x, int y) {\n            if (A[x] < B[x]) {\n                int j = -1;\n                string ans;\n                for (int i = x; i <= y; ++i) {\n                    if (A[i] > j) { ans += \"ab\"; j = B[i]; }\n                }\n                return ans;\n            } else {\n                string ans = \"\";\n                for (int i = x; i <= y; ++i) {\n                    int j = i, k = i;\n                    string cur = \"\";\n                    while (j <= y || k <= y) {\n                        if (j > y) {\n                            cur += \"b\";\n                            k++;\n                        } else if (k > y) {\n                            cur += \"a\";\n                            j++;\n                        } else if (A[j] < B[k]) {\n                            cur += \"a\";\n                            j++;\n                        } else {\n                            cur += \"b\";\n                            k++;\n                        }\n                    }\n                    ans = max(ans, cur);\n                }\n                return ans;\n            }\n        };\n        vector<string> O;\n        for (int i = 0; i < 2*N; ++i) {\n            if (S[i] == 'a') {\n                A.push_back(i);\n                ++bal;\n            } else {\n                B.push_back(i);\n                --bal;\n            }\n            if (bal == 0) {\n                O.push_back(solve(last, B.size()-1));\n                last = B.size();\n            }\n        }\n\n        O.push_back(solve(last, B.size()-1));\n        string Ans;\n        for (int i = 0; i < O.size(); ++i) {\n            bool ok = true;\n            for (int j = i+1; j < O.size(); ++j) {\n                if (O[i][0] == 'a') {\n                    if (O[j][0] == 'b') ok = false;\n                } else ok &= O[j] <= O[i];\n            }\n            if (ok) Ans += O[i];\n        }\n        cout << Ans << endl;\n    }\n};\n\n\n\nint main() {\n\tios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr);\n\tESynchronizedSubsequence solver;\n\tstd::istream& in(std::cin);\n\tstd::ostream& out(std::cout);\n\tsolver.solve(in, out);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n\nusing namespace std;\nconst int maxn = 6e3+5;\nstring ans,a,orz,now;\nint sm[maxn],aw[maxn],bw[maxn],ac,bc;\nint dy[maxn];\nint n;\nbool mark[maxn];\nvoid solve(int l,int r) {\n\torz = \"\";\n\tif(a[l]=='a') {\n\t\tfor(int j=l;j<=r;j++) {\n\t\t\tif(a[j]=='a') orz += \"ab\" , j = dy[j];\n\t\t}\n\t\treturn;\n\t} else {\n\n\t\tfor(int cd=(r-l+1)/2;cd>=1;cd--) {\n\t\t\tnow = \"\";\n\t\t\tint yo = cd;\n\t\t\tfor(int i=r;i>=l&&yo;i--) {\n\t\t\t\tif(a[i]=='b') {\n\t\t\t\t\tmark[i] = mark[dy[i]] = 1; yo--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=l;i<=r;i++) {\n\t\t\t\tif(mark[i]) {\n\t\t\t\t\tnow += a[i];\n\t\t\t\t\tmark[i] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\torz = max(orz,now);\n\t\t}\n\t}\n}\nint main() {\n\tcin>>n>>a;\n\ta = \" \"+a;\n\tfor(int i=1;i<=n*2;i++) {\n\t\tsm[i] = (a[i]=='a'?1:-1);\n\t\tsm[i] += sm[i-1];\n\t\tif(a[i]=='a') aw[++ac] = i;\n\t\telse bw[++bc] = i;\n\t}\n\tfor(int i=1;i<=n;i++) dy[aw[i]] = bw[i] , dy[bw[i]] = aw[i];\n\tint lst = 2*n;\n\tfor(int i=2*n-1;i>=0;i--) {\n\t\tif(sm[i]==0) {\n\t\t\tsolve(i+1,lst);\n\t\t\tlst = i;\n\t\t\tans = max(ans,orz+ans);\n\t\t}\n\t}\n\tcout<<ans;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define FOR(i,a,b) for (register int i=(a);i<=(b);i++)\n#define For(i,a,b) for (register int i=(a);i>=(b);i--)\n#define MP make_pair\n#define pb push_back\n#define fi first\n#define se second\nusing namespace std;\nconst int N=3005;\nint n,a[N],b[N],cnt=0,vis[N],balance=0;\nstring s,ans=\"\";\nvector < pair<string,int> > vec;\nbool cmp(const pair<string,int> x,const pair<string,int> y) \n{\n\tif (x.fi==y.fi) return x.se<y.se;\n\treturn x.fi>y.fi;\n}\ninline string sub(int l,int r)\n{\n\tstring str=\"\";\n\tFOR(i,l,r) if (!vis[i]) str+=s[i];\n\treturn str;\n}\ninline void solve(int l,int r)\n{\n\ta[0]=b[0]=0;\n\tFOR(i,l,r)\n\t\tif (s[i]=='a') a[++a[0]]=i;\n\t\telse b[++b[0]]=i;\n\tint last,tmp,mx=0;\n\tstring str=\"\";\n\tif (s[l]=='a')\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tlast=i,tmp=1;\n\t\t\tFOR(j,i+1,a[0]) if (a[j]>b[last]) last=j,tmp++;\n\t\t\tmx=max(mx,tmp);\n\t\t}\n\t\tFOR(i,1,mx) str+=\"ab\";\n\t}\n\telse\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tstr=max(str,sub(l,r));\n\t\t\tvis[a[i]]=vis[b[i]]=1;\n\t\t}\n\t\tFOR(i,1,a[0]) vis[a[i]]=vis[b[i]]=0;\n\t}\n\tvec.pb(MP(str,++cnt));\n\treturn;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tcin>>s;\n\tfor (register int l=0,r=0;l<=2*n&&r<=2*n;r++)\n\t{\n\t\tbalance+=(s[r]=='a')?1:-1;\n\t\tif (!balance) solve(l,r),l=r+1;\n\t}\n\tsort(vec.begin(),vec.end(),cmp);\n\tFOR(i,0,vec.size()-1)\n\t{\n\t\tif (!vis[vec[i].se]) \n\t\t{\n\t\t\tans+=vec[i].fi;\n\t\t\tFOR(j,1,vec[i].se-1) vis[j]=1;\n\t\t}\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tnode Tmp;\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nconst int MAX = 6000;\n\nstring greedA(string S, int l) { // 先頭がaだった時の貪欲取得(abab…系)\n\tfor (int i = 1, j, k;i < l;++ i) {\n\t\tif (S[i] == 'a') { // 連続した'a'を発見\n\t\t\tfor (j = i + 1;S[j] == 'a';++ j); // 最初に出てくるb(消さない)\n\t\t\tfor (k = j + 1;S[k] == 'a';++ k); // 次に出てくるb(消す)\n\t\t\tS.erase(S.begin() + k);\n\t\t\tS.erase(S.begin() + i);\n\t\t\t-- i;\n\t\t} else ++ i;\n\t}\n\treturn S;\n}\n\nstring greedB(string S, int l) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring comp = S;\n\tfor (int i = 0, ma = l >> 1, j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tS = S > comp ? S : comp;\n\t}\n\treturn S;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstatic string greed[MAX];\n\tint use = 0;\n\t\n\tstring subst;\n\tfor (int l = 0, r = 0;l < N;l = r, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\t++ r;\n\t\tsubst = S.substr(l, r - l);\n\t\tif (isA[l]) greed[use] = greedA(subst, r - l);\n\t\telse greed[use] = greedB(subst, r - l);\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstring>\n#include <set>\n#include <utility>\n#include <cstdlib>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <string>\n#include <map>\n#include <unordered_map>\n#pragma GCC optimize(\"O3\")\n#pragma GCC target(\"sse4\")\n#define ll long long\n#define read(x) scanf(\"%d\",&x);\n#define readll(x) cin>>x;\n#define FOR(x,a,b) for(int x=a;x<b;x++)\n#define MP make_pair\n#define PB push_back\n#define pii pair<int,int>\n#define readN(N,X) for(int i=0;i<N;i++) cin>>X[i];\n#define pff pair<double,double>\nusing namespace std;\n\nvoid no(){\n\tcout<<\"NO\"<<endl;\n\texit(0);\n}\n\n\nvoid yes(){\n\tcout<<\"YES\"<<endl;\n\texit(0);\n}\n\nstring hajar[6100];\nint jumps[9999];\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tint N;\n\tstring S;\n\tstring ret = \"\";\n\n\tcin>>N;\n\tcin>>S;\n\tint ca = 0;\n    int cb = 0;\n\n    for (int i=0;i<N*2;i++){\n      \n      if (S[i] == 'a') ca++; else cb++;\n      if ((S[i] == 'b' && cb > ca) || (S[i] == 'a' && ca > cb)) {\n      \tstring cur = \"\";\n      \tint tmpa = ca;\n      \tint tmpb = cb;\n      \tint jumpz = 0;\n      \tint j=i;\n      \tif (S[j] == 'a') tmpa--; else tmpb--;\n\n      \tbool lookA = true;\n      \twhile (true) {\n      \t\tjumpz++;\n      \t\tif (j == 2*N) break;\n      \t\tbool gagal = 0;\n      \t\tif (S[j] == 'a' && tmpa + 1 < cb) gagal = 1;\n      \t\tif (S[j] == 'b' && tmpb + 1 < ca) gagal = 1;\n\n      \t\tif (!gagal && S[i] == 'b') {\n      \t\t\tcur += S[j];\n      \t\t} else if (!gagal) {\n      \t\t\tif (S[j] == 'b' && !lookA) {\n      \t\t\t\tlookA = true;\n      \t\t\t\tcur += 'b';\n      \t\t\t}\n      \t\t\tif (S[j] == 'a' && lookA) {\n      \t\t\t\tcur += 'a';\n      \t\t\t\tlookA = false;\n      \t\t\t}\n      \t\t}\n      \t\tif (S[j] == 'a') tmpa++; else tmpb++;\n      \t\tif (tmpa == tmpb) break;\n      \t\tj++;\n      \t}\n      \thajar[i] = cur;\n      \tjumps[i] = i + jumpz;\n      }\n    }\n    \n    for (int i=0;i<2*N;i++){\n    \t//cout<<S[i]<<\": \"<<hajar[i]<<endl;\n    }\n\n\tint pos = 0;\n\twhile (pos < 2*N){\n\t\t//cout<<pos<<endl;\n\t\tif (S[pos] == 'M') {\n\t\t  ret += 'a';\n\t\t  ret += 'b';\n\t\t  int ca = 1;\n\t\t  int cb = 0;\n\t\t  while (ca > cb) {\n\t\t  \tpos++;\n\t\t  \tif (pos == 2*N) break;\n\t\t  \tif (S[pos] == 'a') ca++; else cb++;\n\t\t  }\n\t\t} else {\n\t\t\tstring best = \"\";\n\t\t\tint jumpto = pos;\n\t\t\tfor (int j=pos;j<2*N;j++) {\n\t\t\t\tif (hajar[j] > best) {\n\t\t\t\t\tbest = hajar[j];\n\t\t\t\t\tjumpto = jumps[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tret += best;\n\t\t\tpos = jumpto - 1;\n\t\t}\n\t\tpos++;\n\t}\n\tcout<<ret<<endl;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(i,l,r){\n        if(S[i]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  vector<string> dp(s.size()+1);\n  RREP(i,s.size()){\n    dp[i] = s[i];\n    FOR(j,i+1,s.size()+1){\n      chmax(dp[i],s[i]+dp[j]);\n    }\n  }\n\n  cout << dp[0] << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#ifdef DEBUG\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define debug(...)\n#endif\n\n#ifdef __WIN32\n#define LLFORMAT \"I64\"\n#define Rand() ((rand() << 15) + rand())\n#else\n#define LLFORMAT \"ll\"\n#define Rand() (rand())\n#endif\n\nusing namespace std;\n\nconst int maxn = 6060;\n\nint n, sb[maxn];\nstring s, dp[maxn];\nset<pair<int, int> > ab, ba;\n\nint cntb(int l, int r) { return sb[r] - (l ? sb[l - 1] : 0); }\n\nvoid upd(string &s, const string &t) {\n\tfor (int i = 0; i < s.size() && i < t.size(); ++i) if(s[i] != t[i]) { if(s[i] < t[i]) s = t; return; }\n\tif(s.size() < t.size()) s = t;\n\treturn;\n}\n\nstring DP(int beg) {\n\tif(beg >= n) return \"\";\n\tauto &dp = ::dp[beg]; if(dp.size() != 0) return dp;\n\tauto it = ba.lower_bound(make_pair(beg, -1));\n\tif(it == ba.end()) {\n\t\tint lst = beg - 1;\n\t\tit = ab.lower_bound(make_pair(beg, -1));\n\t\twhile(it != ab.end()) {\n\t\t\tif(it->first > lst) dp += \"ab\", lst = it->second;\n\t\t\t++it;\n\t\t}\n\t\tupd(dp, DP(beg + 1));\n\t\treturn dp;\n\t}\n\tif(it->first > beg) return dp = DP(beg + 1);\n\tvector<int> tmp;\n\tint lst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t++it;\n\twhile(it != ba.end()) {\n\t\tif(it->first > lst) break;\n\t\tlst = it->second; tmp.push_back(it->first); tmp.push_back(it->second);\n\t\t++it;\n\t}\n\tsort(tmp.begin(), tmp.end());\n\tfor (int i: tmp) dp += s[i];\n\tdp += DP(tmp.back() + 1);\n\tupd(dp, DP(beg + 1));\n\treturn dp;\n}\n\nint main() {\n\tcin >> n >> s; n *= 2;\n\tfor (int pb = -1, pa = 0; pa < n; ++pa) if(s[pa] == 'a') {\n\t\t++pb; while(s[pb] != 'b') ++pb;\n\t\tif(pa < pb) ab.insert(make_pair(pa, pb));\n\t\telse ba.insert(make_pair(pb, pa));\n\t}\n\tcout << DP(0) << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define mod 1000000007\n#define sp ' '\n#define intmax 2147483647\n#define llmax 9223372036854775807\n#define mkp make_pair\n#define lP pair<ll, ll>\n#define iP pair<int,int>\ntypedef long long ll;\nusing namespace std;\n\nstruct T {\n\tint l, r;\n\tstring s;\n};\n\nint N, r[3000], b[3000], cr, cb, R;\nstring S;\nvector<T>v;\ndeque<string>q;\n\nint main() {\n\tcin >> N >> S;\n\tfor (int i = 0; i < N * 2; ++i) {\n\t\tif (S[i] == 'a') {\n\t\t\tr[cr] = i;\n\t\t\t++cr;\n\t\t}\n\t\telse {\n\t\t\tb[cb] = i;\n\t\t\t++cb;\n\t\t}\n\t}\n\tv.push_back({ 0,0,\"\" });\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (b[i] < r[i]) {\n\t\t\tif (r[v.back().r] < b[i]) {\n\t\t\t\tv.push_back({ i,i,\"\" });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tv.back().r = i;\n\t\t\t}\n\t\t}\n\t}\n\tif (r[0] < b[0]) {\n\t\tv.erase(v.begin());\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\tvector<bool>B(N, false);\n\t\tfor (int j = v[i].r; j >= v[i].l; --j) {\n\t\t\tB[b[j]] = B[r[j]] = true;\n\t\t\tstring s;\n\t\t\tfor (int k = b[j]; k <= r[v[i].r]; ++k) {\n\t\t\t\tif (B[k]) {\n\t\t\t\t\ts.push_back(S[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tv[i].s = max(v[i].s, s);\n\t\t}\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\twhile (!q.empty() && q.back() < v[i].s) {\n\t\t\tq.pop_back();\n\t\t}\n\t\tq.push_back(v[i].s);\n\t\tR = r[v[i].r] + 1;\n\t}\n\twhile (!q.empty()) {\n\t\tcout << q.front();\n\t\tq.pop_front();\n\t}\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (r[i] < b[i] && r[i] >= R) {\n\t\t\tcout << \"ab\";\n\t\t\tR = b[i];\n\t\t}\n\t}\n\tcout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define qwq(x) cout<<\"# \"<<#x<<\" = \"<<x<<endl;\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef long long ll;\n \ntemplate<class T> inline void read(T &x){\n\tint f=0;x=0;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())f|=(ch=='-');\n\tfor(;isdigit(ch);ch=getchar())x=x*10+ch-'0';\n\tif(f)x=-x;\n}\n\nconst int N=6005;\nint l[N],r[N],id[N],n,cnt,ia,ib;\nstring f[N],g[N];\nchar s[N];\n\nstring calc(int l,int r){\n\tif(s[l]=='a'){\n\t\tstring res;\n\t\tint flag=0;\n\t\trep(i,l,r)\n\t\t\tif(s[i]=='a'){\n\t\t\t\tflag=id[i];\n\t\t\t}\n\t\t\telse if(s[i]=='b'&&flag&&flag<id[i]){\n\t\t\t\tres+=\"ab\";\n\t\t\t\tflag=0;\n\t\t\t}\n\t\treturn res;\n\t}\n\tstring best,now;\n\trep(i,l,r)\n\t\tif(s[i]=='b'){\n\t\t\tnow=\"\";\n\t\t\trep(j,i,r)\n\t\t\t\tif(id[j]>=id[i])\n\t\t\t\t\tnow+=s[j];\n\t\t\tbest=max(best,now);\n\t\t}\n\treturn best;\n}\n\nint main(){\n\tread(n);\n\tscanf(\"%s\",s+1);\n\tint t=0,las=0;\n\trep(i,1,n*2){\n\t\tif(s[i]=='a'){\n\t\t\tt++;\n\t\t\tid[i]=++ia;\n\t\t}\n\t\telse{\n\t\t\tt--;\n\t\t\tid[i]=++ib;\n\t\t}\n\t\tif(t==0){\n\t\t\tl[++cnt]=las+1;\n\t\t\tr[cnt]=i;\n\t\t\tlas=i;\n\t\t}\n\t}\n\trep(i,1,cnt){\n\t\tg[i]=calc(l[i],r[i]);\n\t}\n\tper(i,cnt,1){\n\t\tf[i]=max(f[i+1],g[i]+f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "    #include<bits/stdc++.h>\n    using namespace std;\n     \n    #define MAX 6012\n     \n    int n;\n     \n    vector<bool> dp[MAX];\n     \n    vector<pair<int, int> > pos;  //b , a\n    int mode[MAX];\n    bool us[MAX];\n     \n    bool use[MAX];\n    char buf[MAX];\n    string s;\n    vector<int> v1;\n    vector<int> v2;\n    bool cmp(vector<bool> a, vector<bool> b){\n    \tint lef = 0;\n    \tint rig = 0;\n    \twhile (1){\n    \t\twhile (lef < a.size() && a[lef] == false){\n    \t\t\tlef++;\n    \t\t}\n    \t\twhile (rig < b.size() && b[rig] == false){\n    \t\t\trig++;\n    \t\t}\n    \t\tif (rig == b.size())return true;\n    \t\tif (lef == a.size())return false;\n    \t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n    \t\tlef++;\n    \t\trig++;\n    \t}\n    \treturn false;\n    }\n    vector<bool> dfs(int b){\n    \tif (b == n)return vector<bool>(2 * n, 0);\n    \tif (us[b])return dp[b];\n    \tus[b] = true;\n    \tdp[b] = dfs(b + 1);  //choose nothing\n    \tif(pos[b].first<pos[b].second){\n\t\t\tint til;\n\t\t\tvector<bool> flag(2*n,0);\n\t\t\tfor(int j=b;j<pos.size();j++){\n\t\t\t\tif(pos[j].first>pos[b].second){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttil=j;\n\t\t\t\tflag[pos[j].first]=flag[pos[j].second]=true;\n\t\t\t}\n\t\t\tfor(int j=til+1;j<pos.size();j++){\n\t\t\t\tif(pos[j].first>pos[j-1].second)break;\n\t\t\t\tflag[pos[j].first]=flag[pos[j].second]=true;\n\t\t\t\ttil=j;\n\t\t\t}\n\t\t\tauto nex=dfs(til+1);\n\t\t\tfor(int i=0;i<2*n;i++){\n\t\t\t\tflag[i]=(flag[i]||nex[i]);\n\t\t\t}\n\t\t\tif(cmp(flag,dp[b])){\n\t\t\t\tdp[b]=flag;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tfor(int j=b+1;j<pos.size();j++){\n\t\t\t\tif(min(pos[j].first,pos[j].second)>pos[b].first){\n\t\t\t\t\tauto nex=dfs(j);\n\t\t\t\t\tnex[pos[b].first]=nex[pos[b].second]=true;\n\t\t\t\t\tstring ss;\n\t\t\t\t\tfor(int i=0;i<nex.size();i++){\n\t\t\t\t\t\tif(nex[i])ss.push_back(s[i]);\n\t\t\t\t\t}\n\t\t\t\t\tif(cmp(nex,dp[b])){\n\t\t\t\t\t\tdp[b]=nex;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvector<bool> fl(2*n,false);\n\t\t\tfl[pos[b].first]=fl[pos[b].second]=true;\n\t\t\tif(cmp(fl,dp[b])){\n\t\t\t\tdp[b]=fl;\n\t\t\t}\n\t\t}\n    \treturn dp[b];\n    }\n     \n    int main(){\n    \tcin >> n;\n    \tscanf(\"%s\", buf);\n    \ts = buf;\n    \tfor (int i = 0; i < s.size(); i++){\n    \t\tif (s[i] == 'a'){\n    \t\t\tv1.push_back(i);\n    \t\t}\n    \t\tif (s[i] == 'b'){\n    \t\t\tv2.push_back(i);\n    \t\t}\n    \t}\n    \tfor (int i = 0; i < v1.size(); i++){\n    \t\tpos.push_back(make_pair(v2[i], v1[i]));\n    \t}\n    \tvector<bool> uss = dfs(0);\n    \t//dfs2(0);\n    \tfor (int i = 0; i < s.size(); i++){\n    \t\tif (uss[i]){\n    \t\t\tputchar(s[i]);\n    \t\t}\n    \t}\n    \tputs(\"\");\n    \treturn 0;\n    }\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3005;\n\nint n, dp[maxn][maxn], pa[maxn], pb[maxn];\nchar s[maxn<<1], a[maxn<<1], b[maxn<<1];\nbool used[maxn<<1];\n\nbool check(int x)\n{\n\tint cnta = 0, cntb = 0;\n\tfor(int i = x; i <= n; ++i)\n\t\tif(dp[x][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x], pb[x]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\ta[++cnta] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = x + 1; i <= n; ++i)\n\t\tif(dp[x+1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x+1], pb[x+1]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\tb[++cntb] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = 1; i <= min(cnta, cntb); ++i)\n\t\tif(a[i] != b[i])\n\t\t\treturn b[i] > a[i];\n\treturn cntb > cnta;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\tint cnta = 0, cntb = 0;\n\tfor(int i = 1; i <= (n << 1); ++i)\t\n\t{\n\t\tif(s[i] == 'a')\n\t\t\tpa[++cnta] = i;\n\t\telse\n\t\t\tpb[++cntb] = i;\n\t}\n\tfor(int i = n; i >= 1; --i)\n\t{\n\t\tdp[i][i] = 1;\n\t\tif(pa[i] > pb[i])\n\t\t{\n\t\t\tint p = n + 1;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t{\n\t\t\t\tif(pb[j] > pa[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdp[i][j] = 1;\n\t\t\t}\n\t\t\tfor(int j = p; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[p][j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint p = n + 1;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t\tif(pa[j] > pb[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tfor(int j = p; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[p][j];\n\t\t}\n\t\tif(check(i))\n\t\t{\n\t\t\tfor(int j = i; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[i+1][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(dp[1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\t\n\t\t}\n\tfor(int i = 1; i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t\tprintf(\"%c\", s[i]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <random>\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef double ld;\n//#define ll __int128\n//#define int ll\n//#define int ll\n//#define char ll\ntypedef vector<char> vc;\ntypedef vector<vc> vvc;\ntypedef vector<vvc> vvvc;\ntypedef pair<int, int> pii;\ntypedef pair<pii, pii> piii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\ntypedef vector<pii> vpi;\ntypedef vector< vi > vvi;\ntypedef vector< vvi > vvvi;\ntypedef vector<short> vs;\ntypedef vector<vs> vvs;\ntypedef vector<vvs> vvvs;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<vvl> vvvl;\ntypedef vector<ld> vld;\ntypedef vector<vld> vvld;\ntypedef vector<vvld> vvvld;\ntypedef vector<string> vst;\ntypedef vector<vst> vvst;\ntypedef pair<ld, ld> pld;\n\n#define inmin(a, b) a = min(a, (b))\n#define inmax(a, b) a = max(a, (b))\n#define ALL(a) a.begin(),a.end()\n#define RALL(a) a.rbegin(),a.rend()\n#define sqr(x) ((x) * (x))\n#define fori(i, n) for(int i = 0; i < int(n); ++i)\n#define SZ(a) ((int)((a).size()))\n#define triple(T) tuple<T, T, T>\n#define quad(T) tuple<T, T, T, T>\n#define watch(x) cerr << (#x) << \" = \" << (x) << endl;\n\n#ifdef MAX_HOME\n#define cerr cout\n#else\n#define cerr if (false) cerr\n#endif\n\nconst double PI = 2 * acos(0.0);\n#define rand shittttty_shit\nmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\nmt19937_64 rng_64(chrono::steady_clock::now().time_since_epoch().count());\n\nconst string DIGITS = \"0123456789\";\nconst string ALPH = \"abcdefghijklmnopqrstuvwxyz\";\n\n\ntemplate <class T0, class T1>\ninline ostream & operator << (ostream &out, pair<T0, T1> &a) {\n    return out << \"{\" << a.first << \", \" << a.second << \"}\";\n}\n\ntemplate <class T0, class T1>\ninline istream & operator >> (istream &in, pair<T0, T1> &a) {\n    return in >> a.first >> a.second;\n}\n\ntemplate <class T0, class T1, class T2>\ninline ostream & operator << (ostream &out, tuple<T0, T1, T2> &a) {\n    return out << \"{\" << get<0>(a) << \", \" << get<1>(a) << \", \" << get<2>(a) << \"}\";\n}\n\ntemplate <class T0, class T1, class T2, class T3>\ninline ostream & operator << (ostream &out, tuple<T0, T1, T2, T3> &a) {\n    return out << \"{\" << get<0>(a) << \", \" << get<1>(a) << \", \" << get<2>(a) << \", \" <<  get<3>(a) << \"}\";\n}\n\ntemplate<class T>\ninline ostream & operator << (ostream &out, vector<T> &a) {\n    out << \"[\";\n    fori (i, a.size())\n        out << a[i] << vector<string>{\", \", \"]  \"}[i + 1 == a.size()];\n    return out;\n}\n\n\nvoid smain();\n\n\n\nsigned main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n#ifdef MAX_HOME\n    freopen(\"input.txt\", \"r\", stdin);\n    clock_t start = clock();\n#endif\n    cout << setprecision(12) << fixed;\n    smain();\n#ifdef MAX_HOME\n    cout << \"\\n\\n\\n\\nTOTAL EXECUTION TIME: \" << float( clock () - start ) /  CLOCKS_PER_SEC << endl;\n#endif\n    return 0;\n}\n\nvoid smain() {\n    int n;\n    cin >> n;\n    n <<= 1;\n    string s;\n    cin >> s;\n    vector<string> dp(n + 1, \"\");\n    vi a, b;\n    vi ind(n);\n    fori (i, n) {\n        if (s[i] == 'a') {\n            ind[i] = a.size();\n            a.push_back(i);\n        } else {\n            ind[i] = b.size();\n            b.push_back(i);\n        }\n    }\n    for (int i = n - 1; i >= 0; --i) {\n        int j = ind[i];\n        dp[i] = dp[i + 1];\n        if (s[i] == 'a') {\n            if (b[j] > i) {\n                string cur = \"ab\" + dp[b[j] + 1];\n                inmax(dp[i], cur);\n            }\n        } else {\n            vi used(n, false);\n            int r = a[j];\n            for (int k = i; k <= r; ++k) {\n                if (s[k] == 'b') {\n                    used[k] = true;\n                    used[a[ind[k]]] = true;\n                    inmax(r, a[ind[k]]);\n                }\n            }\n            string cur = \"\";\n            for (int k = i; k <= r; ++k) {\n                if (used[k])\n                    cur += s[k];\n            }\n            cur += dp[r + 1];\n            inmax(dp[i], cur);\n        }\n    }\n    cout << dp[0];\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <map>\n#include <set>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <cmath>\nusing namespace std;\n\nint main() {\n        int n;\n        scanf(\"%d\", &n);\n        string s;\n        cin >> s;\n        int acc = 0;\n        vector<string> hoge;\n        string cur = \"\";\n        for (int i = 0; i < 2 * n; i ++) {\n                if (s[i] == 'a') {\n                        acc ++;\n                } else {\n                        acc --;\n                }\n                cur += s[i];\n                if (acc == 0) {\n                        hoge.push_back(cur);\n                        cur = \"\";\n                }\n        }\n        vector<string> best;\n        for (int f = 0; f < (int) hoge.size(); f ++) {\n                string t = hoge[f];\n                int N = (int) t.size();\n                int ac = 0, bc = 0;\n                vector<int> p(N);\n                for (int i = 0; i < N; i ++) {\n                        if (t[i] == 'a') {\n                                p[i] = ac ++;\n                        } else {\n                                p[i] = bc ++;\n                        }\n                }\n                vector<int> pos(N);\n                for (int i = 0; i < N; i ++) {\n                        for (int j = i + 1; j < N; j ++) {\n                                if (p[i] == p[j] && t[i] != t[j]) {\n                                        pos[i] = j;\n                                        pos[j] = i;\n                                }\n                        }\n                }\n                string ma = \"\";\n                if (t[0] == 'b') { \n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        continue;\n                                }\n                                string now = \"\";\n                                for (int j = i; j < N; j ++) {\n                                        if (pos[j] >= i) {\n                                                now += t[j];\n                                        }\n                                }\n                                ma = max(ma, now);\n                        }\n                } else {\n                        bool last = true;\n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        ma += t[i];\n                                        i = pos[i] - 1;\n                                        last = false;\n                                } else if (!last) {\n                                        ma += t[i];\n                                        last = true;\n                                }\n                        }\n                }\n                best.push_back(ma);\n        }\n        vector<string> now(2 * n + 1), next(2 * n + 1);\n        now[0] = \"\";\n        now[(int) best[0].size()] = best[0];\n        int sum = (int) best[0].size();\n        for (int i = 1; i < (int) best.size(); i ++) {\n                int len = (int) best[i].size();\n                sum += len;\n                for (int j = 0; j <= sum - len; j ++) {\n                        if (j != 0 && now[j] == \"\") continue;\n                        next[j + len] = max(next[j + len], now[j] + best[i]);\n                        next[j] = max(next[j], now[j]);\n                }\n                swap(now, next);\n        }\n        string ans = \"\";\n        for (int j = 0; j <= 2 * n; j ++) {\n                ans = max(ans, now[j]);\n        }\n        cout << ans << endl;\n        return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 6006;\nint n;\nstring A;\nint main()\n{\n    cin >> n >> A;\n    string S;\n    for (int l = n + n - 1, r = n + n, s = 0; ~ l; l--)\n    {\n        s += (A[l] == 'a') - (A[l] == 'b');\n        if (!s)\n        {\n            string T;\n            if (A[l] == 'a')\n            {\n                for (int i = l; i < r; i++)\n                    if (A[i] == 'a')\n                    {\n                        T += \"ab\";\n                        while (A[i] != 'b')\n                            i ++;\n                    }\n            }\n            else\n            {\n                int a = 0, b = 0;\n                for (int i = l; i < r; i++)\n                {\n                    a += A[i] == 'a';\n                    b += A[i] == 'b';\n                    if (A[i] == 'b')\n                    {\n                        string R;\n                        for (int j = i, c = a; j < r; j++)\n                        {\n                            c += A[j] == 'a';\n                            if (A[j] == 'b' || b <= c)\n                                R += A[j];\n                        }\n                        T = max(T, R);\n                    }\n                }\n            }\n            if (T + S > S)\n                S = T + S;\n            r = l;\n        }\n    }\n    cout << S << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n  int n;\n  scanf(\"%d\",&n);\n  static char s[10000];\n  scanf(\"%s\",s);\n  static int a[3000],b[3000],c[10000];\n  int na=0,nb=0;\n  for(int i=0;i<2*n;i++){\n    if(s[i]=='a'){\n      a[na]=i;\n      c[i]=na++;\n    }\n    else{\n      b[nb]=i;\n      c[i]=nb++;\n    }\n  }\n  vector<int> bg;\n  for(int i=0;i<n;i++){\n    if((i==0||a[i-1]<b[i-1])&&a[i]>b[i]){\n      bg.push_back(i);\n    }\n  }\n  string ans;\n  for(int t=bg.size()-1;t>=0;t--){\n    int x=bg[t],y=x;\n    while(y<n&&a[y]>b[y])y++;\n    string p=\"\";\n    for(int i=x;i<y;i++){\n      string q;\n      for(int j=0;j<2*n;j++){\n\tif(c[j]>=i&&c[j]<y){\n\t  q+=s[j];\n\t}\n      }\n      if(p<q){\n\tp=q;\n      }\n    }\n    if(p+ans>ans){\n      ans=p+ans;\n    }\n  }\n  for(int i=n-1;i>=0&&a[i]<b[i];){\n    ans+=\"ab\";\n    int t=a[i];\n    while(i>=0&&b[i]>t)i--;\n  }\n  printf(\"%s\\n\",ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define FOR(i,a,b) for (register int i=(a);i<=(b);i++)\n#define For(i,a,b) for (register int i=(a);i>=(b);i--)\n#define MP make_pair\n#define pb push_back\n#define fi first\n#define se second\nusing namespace std;\nconst int N=3005;\nint n,a[N],b[N],vis[N],balance=0;\nstring s,ans=\"\";\nvector <string> vec;\ninline string sub(int l,int r)\n{\n\tstring str=\"\";\n\tFOR(i,l,r) if (!vis[i]) str+=s[i];\n\treturn str;\n}\ninline void solve(int l,int r)\n{\n\ta[0]=b[0]=0;\n\tFOR(i,l,r)\n\t\tif (s[i]=='a') a[++a[0]]=i;\n\t\telse b[++b[0]]=i;\n\tint last,tmp,mx=0;\n\tstring str=\"\";\n\tif (s[l]=='a')\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tlast=i,tmp=1;\n\t\t\tFOR(j,i+1,a[0]) if (a[j]>b[last]) last=j,tmp++;\n\t\t\tmx=max(mx,tmp);\n\t\t}\n\t\tFOR(i,1,mx) str+=\"ab\";\n\t}\n\telse\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tstr=max(str,sub(l,r));\n\t\t\tvis[a[i]]=vis[b[i]]=1;\n\t\t}\n\t\tFOR(i,1,a[0]) vis[a[i]]=vis[b[i]]=0;\n\t}\n\tvec.pb(str);\n\treturn;\n}\ninline int check(string s1,string s2)\n{\n\tint l1=s1.length(),l2=s2.length(),len=min(l1,l2);\n\tFOR(i,0,len-1)\n\t{\n\t\tif (s1[i]<s2[i]) return 1;\n\t\tif (s1[i]>s2[i]) return 0;\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tcin>>s;\n\tfor (register int l=0,r=0;l<2*n&&r<2*n;r++)\n\t{\n\t\tbalance+=(s[r]=='a')?1:-1;\n\t\tif (!balance) solve(l,r),l=r+1;\n\t}\n\tFOR(i,0,(int)vec.size()-1)\n\t{\n\t\tint tag=1;\n\t\tFOR(j,i+1,(int)vec.size()-1)\n\t\t\tif (check(vec[i],vec[j])) {tag=0;break;}\n\t\tif (tag) ans+=vec[i];\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define M 3005\nint n;\nint a[M],tot;\nbool biao[M];\nchar s[M],now[M],to[M];\n\ninline bool check(int x) {\n\tif(x>n) return 0;\n\tint cnt=0;\n\tfor1(1,2*n,i) if(biao[a[i]]||a[i]==x) to[++cnt]=s[i];\n\tfor1(1,cnt,i) if(to[i]!=now[i]) return to[i]>now[i];\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\tn=read();\n\tscanf(\"%s\",s+1);\n\tint x[2]={0};\n\tfor1(1,2*n,i) \n\t\tif(s[i]=='a') a[i]=++x[0];\n\t\telse a[i]=++x[1];\n\tfor1(1,n,i) biao[i]=1;\n\t\n\t//cout<<check(1)<<endl;\n\t//return 0;\n\t\n\tint h=0;\n\twhile (1) {\n\t\twhile (h<n&&!check(h+1)) ++h;\n\t\t++h;\n\t\tif(h>n) break;\n\t\tbiao[h++]=tot=0;\n\t\tfor1(1,2*n,i) if(biao[a[i]]) now[++tot]=s[i];\n\t}\n\tfor1(1,tot,i) putchar(now[i]);\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n\nusing namespace std;\n\n#define mp make_pair\n#define pb push_back\n#define ll long long\n\nconst int maxN = 6011;\n\nint n, i, last, act;\nchar s[maxN];\nvector<string> data;\nvector<int> a, b;\nint id[maxN];\nstring ans, aux;\n\nstring solve(int bg, int en) {\n    string ans = \"\";\n    string aux;\n    int i, j, last;\n\n    a.clear();\n    b.clear();\n    for (i = bg; i <= en; i++) {\n        if (s[i] == 'a')\n            a.pb(i), id[i] = a.size() - 1;\n        else\n            b.pb(i), id[i] = b.size() - 1;\n    }\n\n    if (s[bg] == 'a') {\n        last = 0;\n        for (i = 0; i < a.size(); i++) {\n            if (a[i] <= last) continue;\n            ans += \"ab\";\n            last = b[i];\n        }\n    } else {\n        for (i = 0; i < a.size(); i++) {\n            aux.clear();\n            for (j = bg; j <= en; j++)\n                if (id[j] >= i)\n                    aux.pb(s[j]);\n\n\n            if (aux > ans) ans = aux;\n        }\n    }\n\n    return ans;\n}\n\nint main()\n{\n    //freopen(\"test.in\",\"r\",stdin);\n\n    scanf(\"%d\\n%s\", &n, s + 1);\n    for (i = 1; i <= 2 * n; i++) {\n        if (s[i] == 'a')\n            act++;\n        else\n            act--;\n\n        if (act == 0) {\n            data.pb(solve(last + 1, i));\n            last = i;\n        }\n    }\n\n    ans = \"\";\n    for (i = data.size() - 1; i >= 0; i--) {\n        aux = data[i] + ans;\n        if (aux > ans) ans = aux;\n    }\n\n    cout << ans;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int MAXN = 3e3 + 10;\n\nint n, cntA, cntB;\nint posA[MAXN], posB[MAXN], nxt[MAXN << 1], id[MAXN << 1];\nchar s[MAXN << 1];\nstd::string dp[MAXN];\n\nint main() {\n\t// freopen(\"in.txt\", \"r\", stdin);\n\t// freopen(\"now.out\", \"w\", stdout);\n\tscanf(\"%d %s\", &n, s + 1);\n\tfor (int i = 1; i <= n << 1; ++i) s[i] == 'a' ? posA[id[i] = ++cntA] = i: posB[id[i] = ++cntB] = i;\n\tid[posA[n + 1] = posB[n + 1] = n * 2 + 1] = n + 1;\n\tfor (int i = 1, j = 0; i <= n + 1; ++i) while (j < posA[i] && j < posB[i]) nxt[++j] = i;\n\tfor (int i = n; i; --i) {\n\t\tif (posA[i] > posB[i]) {\n\t\t\tint j = posB[i];\n\t\t\twhile (posB[id[j]] < posA[id[j]] && (id[j] <= i || posB[id[j]] < posA[id[j] - 1])) { if (id[j] >= i) dp[i] += s[j]; ++j; }\n\t\t\tdp[i] += dp[id[j]];\n\t\t} else dp[i] = \"ab\" + dp[nxt[posB[i] + 1]];\n\t\tdp[i] = std::max(dp[i], dp[i + 1]);\n\t}\n\tstd::cout << dp[1] << '\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i, j, k) for(int i=(j); i<=(k); i++)\n#define FFOR(i, j, k) for(int i=(j); i<(k); i++)\n#define DFOR(i, j, k) for(int i=(j); i>=(k); i--)\n#define bug(x) cerr<<#x<<\" = \"<<(x)<<'\\n'\n#define pb push_back\n#define mp make_pair\n#define bit(s, i) (((s)>>(i))&1LL)\n#define mask(i) ((1LL<<(i)))\n#define builtin_popcount __builtin_popcountll\n#define __builtin_popcount __builtin_popcountll\nusing ll=long long; using ld=long double;\nmt19937_64 rng(chrono::high_resolution_clock::now().time_since_epoch().count()); const ld pi=acos(0)*2;\ntemplate <typename T> inline void read(T &x){char c; bool nega=0; while((!isdigit(c=getchar()))&&(c!='-')); if(c=='-'){nega=1; c=getchar();} x=c-48; while(isdigit(c=getchar())) x=x*10+c-48; if(nega) x=-x;}\ntemplate <typename T> inline void writep(T x){if(x>9) writep(x/10); putchar(x%10+48);}\ntemplate <typename T> inline void write(T x){if(x<0){ putchar('-'); x=-x;} writep(x);}\ntemplate <typename T> inline void writeln(T x){write(x); putchar('\\n');}\ntemplate <typename CT, typename T> inline void reset_container(CT &c, int sz, T v){c.resize(sz); for(auto &x: c) x=v;}\n#define taskname \"agc026_e\"\nstring s;\nvector <int> pa;\nvector <int> pb;\nint n;\nvector <string> res;\nvoid solve(int i, int j){\n    if(pa[i]<pb[i]){\n        ///ababababababab\n        string r=\"\";\n        int nx=0;\n        FOR(k, i, j) if(pa[k]>=nx){\n            r+=\"ab\";\n            nx=pb[k];\n        }\n        res.pb(r);\n    }\n    else{\n        string r=\"\";\n        FOR(k, i, j){\n            string t=\"\";\n            int a=k;\n            int b=k;\n            while((a<=j)&&(b<=j)){\n                if(pa[a]<pb[b]){\n                    t+='a';\n                    a++;\n                }\n                else{\n                    t+='b';\n                    b++;\n                }\n            }\n            while(a<=j){\n                t+='a';\n                a++;\n            }\n            while(b<=j){\n                t+='b';\n                b++;\n            }\n            r=max(r, t);\n        }\n        res.pb(r);\n    }\n}\nint main(){\n    #ifdef Aria\n        if(fopen(taskname\".in\", \"r\"))\n            freopen(taskname\".in\", \"r\", stdin);\n    #endif // Aria\n    cin>>n>>s;\n    FFOR(i, 0, s.size()) if(s[i]=='a') pa.pb(i); else pb.pb(i);\n    FFOR(i, 0, n){\n        int start=min(pa[i], pb[i]);\n        int mx=0;\n        FFOR(j, i, n){\n            mx=max(mx, pa[j]);\n            mx=max(mx, pb[j]);\n            if((mx-start+1)==(j-i+1)*2){\n                solve(i, j);\n                i=j;\n                break;\n            }\n        }\n    }\n    string ans=\"\";\n    reverse(res.begin(), res.end());\n    for(auto s: res) ans=max(ans, s+ans);\n    cout<<ans<<'\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h> \nusing namespace std;\n\n#define sz(x) (int)x.size() \n#define pb push_back \n#define mp make_pair \n#define fi(a, b) for(int i=a; i<=b; i++) \n#define fj(a, b) for(int j=a; j<=b; j++) \n#define fo(a, b) for(int o=a; o<=b; o++) \n#define fdi(a, b) for(int i=a; i>=b; i--) \n#define fdj(a, b) for(int j=a; j>=b; j--) \n#define fdo(a, b) for(int o=a; o>=b; o--) \n\n#ifdef LOCAL\n#define err(...) fprintf(stderr, __VA_ARGS__)\n#else\n#define err(...) while(false) {}\n#endif\n\ntypedef long long ll; \ntypedef pair<int, int> pii; \ntypedef pair<ll, ll> pll; \ntypedef vector<int> vi; \ntypedef vector<ll> vll;\ntypedef vector<pii> vpii; \ntypedef vector<pll> vpll; \ntypedef long double ld;\ntypedef unsigned long long ull;\n\n/////////////////////////////////\n\nint const MAX = 6e3 + 41;\n\nint n;\nchar s[MAX];\n\nvector<string> vs;\nvector<string> vb;\n\nstring getbesta(string s) {\n\tvi va, vb;\n\tfi(0, sz(s) - 1) {\n\t\tif (s[i] == 'a') {\n\t\t\tva.pb(i);\n\t\t} else {\n\t\t\tvb.pb(i);\n\t\t}\n\t}\n\tassert(sz(va) == sz(vb));\n\tvi d(sz(va), 0);\n\tfdi(sz(va) - 1, 0) {\n\t\td[i] = 1;\n\t\tfj(i + 1, sz(va) - 1) {\n\t\t\tif (vb[i] > va[j]) continue;\n\t\t\td[i] = max(d[i], d[j] + 1);\n\t\t} \n\t}\n\tint q = (*max_element(d.begin(), d.end()));\n\tstring res;\n\tfi(1, q) {\n\t\tres += \"ab\";\n\t}\n\treturn res;\n}\n\nstring getbestb(string s) {\n\tvi va, vb;\n\tfi(0, sz(s) - 1) {\n\t\tif (s[i] == 'a') {\n\t\t\tva.pb(i);\n\t\t} else {\n\t\t\tvb.pb(i);\n\t\t}\n\t}\n\tassert(sz(va) == sz(vb));\n\tint x = vb[0];\n\tfi(0, sz(va) - 1) {\n\t\tva[i] -= x;\n\t\tvb[i] -= x;\n\t}\n\tvi c(sz(s), -1);\n\tstring res = \"\";\n\tfdi(sz(vb) - 1, 0) {\n\t\tc[vb[i]] = 'b';\n\t\tc[va[i]] = 'a';\n\t\tstring cur = \"\";\n\t\tfj(0, sz(c) - 1) {\n\t\t\tif (c[j] != -1) {\n\t\t\t\tcur += (char) c[j];\n\t\t\t}\n\t\t}\n\t\tres = max(res, cur);\n\t}\t\n\treturn res;\n}\n\nvoid solve() {\n\tint b = 0;\n\tstring cur;\n\tfi(1, n * 2) {\n\t\tif (s[i] == 'a') {\n\t\t\tb++;\n\t\t} else {\n\t\t\tb--;\n\t\t}\n\t\tcur += s[i];\n\t\tif (b == 0) {\n\t\t\tvs.pb(cur);\n\t\t\tcur = \"\";\n\t\t}\n\t}\n\n\tfi(0, sz(vs) - 1) {\n\t\tif (vs[i][0] == 'a') {\n\t\t\tvb.pb(getbesta(vs[i]));\n\t\t} else {\n\t\t\tvb.pb(getbestb(vs[i]));\n\t\t}\n\t}\t\n\n/*\n  fi(0, sz(vs) - 1) {\n  \terr(\"%s = %s\\n\", vs[i].c_str(), vb[i].c_str());\n  }\n*/\n\n\tint p = -1;\n\tfdi(sz(vb) - 1, 0) {\n\t\tif (vb[i][0] == 'b') {\n\t\t\tp = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tstring ans = \"\";\n\tfdi(p, 0) {\n\t\tstring v1 = vb[i];\n\t\tstring v2 = vb[i] + ans;\n\t\tans = max(ans, max(v1, v2));\n\t}\n\tfi(p + 1, sz(vb) - 1) {\n\t\tans += vb[i];\n\t}\n\tprintf(\"%s\\n\", ans.c_str());\n}\n\nint main() {\n#ifdef LOCAL\n\tfreopen(\"input.txt\", \"r\", stdin);\n\tfreopen(\"output.txt\", \"w\", stdout);\n#endif\n\n  scanf(\"%d\", &n);\n  scanf(\" %s\", s + 1);\n\tsolve();\t\t\n\n\t\n#ifdef LOCAL\n\terr(\"ELAPSED TIME: %.3Lf\\n\", (ld) clock() / CLOCKS_PER_SEC);\n#endif\t\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef int sign;\ntypedef long long ll;\n#define For(i,a,b) for(register sign i=(sign)(a);i<=(sign)(b);++i)\n#define Fordown(i,a,b) for(register sign i=(sign)(a);i>=(sign)(b);--i)\nconst int N=6e3+5;\ntemplate<typename T>bool cmax(T &a,T b){return (a<b)?a=b,1:0;}\ntemplate<typename T>bool cmin(T &a,T b){return (a>b)?a=b,1:0;}\ntemplate<typename T>T read()\n{\n\tT ans=0,f=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)&&ch!='-')ch=getchar();\n\tif(ch=='-')f=-1,ch=getchar();\n\twhile(isdigit(ch))ans=(ans<<3)+(ans<<1)+(ch-'0'),ch=getchar();\n\treturn ans*f;\n}\ntemplate<typename T>void write(T x,char y)\n{\n\tif(x==0)\n\t{\n\t\tputchar('0'),putchar(y);\n\t\treturn;\n\t}\n\tif(x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tstatic char wr[20];\n\tint top=0;\n\tfor(;x;x/=10)wr[++top]=x%10+'0';\n\twhile(top)putchar(wr[top--]);\n\tputchar(y);\n}\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in\",\"r\",stdin);\n\tfreopen(\"out\",\"w\",stdout);\n#endif\n}\nint n;\nchar s[N];\nvoid input()\n{\n\tn=read<int>();\n\tscanf(\"%s\",s+1);\n}\nvector<string>E;\n#define pb push_back\nint a[N],b[N];\nint sum[N];\nstring get1(int l,int r)\n{\n\tstring res;\n\tint last=0;\n\tFor(i,l,r)if(a[i]>last)res+=\"ab\",last=b[i];\n\treturn res;\n}\nbool vis[N];\nstring get2(int l,int r)\n{\n\tstring res,now;\n\tFor(i,l,r)vis[a[i]]=vis[b[i]]=1;\n\tFor(i,l,r)\n\t{\n\t\tnow.clear();\n\t\tFor(j,1,n*2)if(vis[j])now+=s[j];\n\t\tcmax(res,now);\n\t\tvis[a[i]]=vis[b[i]]=0;\n\t}\n\treturn res;\n}\nvoid work()\n{\n\tFor(i,1,n*2)\n\t{\n\t\tif(s[i]=='a')a[++a[0]]=i,sum[i]++;\n\t\telse b[++b[0]]=i,sum[i]--;\n\t\tsum[i+1]=sum[i];\n\t}\n\tint j;\n\tstring now;\n\tFor(i,1,n)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[b[j]]&&a[j+1]<b[j+1];j++);\n\t\t\tnow=get1(i,j);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[a[j]]&&a[j+1]>b[j+1];j++);\n\t\t\tnow=get2(i,j);\n\t\t}\n\t\t//cout<<now<<endl;\n\t\tE.pb(now);\n\t\ti=j;\n\t}\n\treverse(E.begin(),E.end());\n\tstring ans;\n\tfor(auto now:E)ans=max(ans,now+ans);\n\tcout<<ans<<endl;\n}\nint main()\n{\n\n\tinput();\n\twork();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nusing int64 = long long;\nconst int INF = 1 << 30;\n\ntemplate< class T >\nstruct BinaryIndexedTree {\n  vector< T > data;\n\n  BinaryIndexedTree(int sz) {\n    data.assign(++sz, 0);\n  }\n\n  T sum(int k) {\n    T ret = 0;\n    for(++k; k > 0; k -= k & -k) ret = max(ret, data[k]);\n    return (ret);\n  }\n\n  void add(int k, T x) {\n    for(++k; k < data.size(); k += k & -k) data[k] = max(data[k], x);\n  }\n};\n\nint main() {\n  int N;\n  string S;\n\n  cin >> N;\n  cin >> S;\n  vector< int > latte, malta;\n  for(int i = 0; i < 2 * N; i++) {\n    if(S[i] == 'a') latte.push_back(i);\n    else malta.push_back(i);\n  }\n  int type = 0, pre = 0;\n  vector< string > myon;\n\n  auto get_beet = [&](int l, int r) {\n\n/*\n    cout << l << \" \" << r << endl;\n    for(int i = l; i < r; i++) {\n      cout << latte[i] << \" \" << malta[i] << endl;\n    }\n    cout << \"---\" << endl;\n*/\n    if(latte[l] < malta[l]) {\n      BinaryIndexedTree< int > bit(2 * N);\n      for(int i = l; i < r; i++) {\n        bit.add(malta[i], bit.sum(latte[i]) + 1);\n      }\n      int ans = bit.sum(2 * N - 1);\n      string s;\n      for(int i = 0; i < ans; i++) s += \"ab\";\n      return s;\n    } else {\n      string s;\n      for(int i = l; i < r; i++) {\n        vector< int > vx;\n        for(int j = i; j < r; j++) {\n          vx.push_back(latte[j]);\n          vx.push_back(malta[j]);\n        }\n        sort(begin(vx), end(vx));\n        string t;\n        for(int j = 0; j < vx.size(); j++) t += S[vx[j]];\n        s = max(s, t);\n      }\n      return s;\n    }\n  };\n\n  for(int i = 1; i <= N; i++) {\n    bool u = latte[i - 1] < malta[i - 1];\n    bool v = i == N ? !u : latte[i] < malta[i];\n    if(u != v) {\n      myon.push_back(get_beet(pre, i));\n      pre = i;\n    }\n  }\n\n  vector< string > dp(myon.size());\n  for(int i = 0; i < myon.size(); i++) {\n    dp[i] = max(dp[i], myon[i]);\n    for(int j = 0; j < i; j++) {\n      dp[i] = max(dp[i], dp[j] + myon[i]);\n    }\n  }\n  cout << *max_element(begin(dp), end(dp)) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#define rep(i,l,r) for(int i=(l);i<=(r);++i)\n#define per(i,r,l) for(int i=(r);i>=(l);--i)\nusing namespace std;\nconst int N=3010;\nstring s,ans;int n,a[N],b[N],lst,tot,cnt;\nbool check(int x,int y){return !x||!y||(a[x]<b[x])^(a[y]<b[y]);}\nint main(){\n    cin>>n>>s;\n    rep(i,0,2*n-1){\n        if(s[i]=='a') a[++cnt]=i;\n        else b[++tot]=i;\n    }lst=n+1;\n    per(i,n,1) if(check(i-1,i)){\n        if(a[i]<b[i]){\n            int tt=a[i]-1;\n            rep(j,i,lst-1)\n                if(a[j]>tt) ans=max(ans,\"ab\"+ans),tt=b[j];\n        }\n        else{\n            int cnt=0,L=b[i],R=a[lst-1];string str=ans;\n            per(j,R,L){\n                cnt+=s[j]=='a'?1:-1;\n                cnt==1?ans=max(ans,\"b\"+s.substr(j,R+1-j)+str):\"\";\n            }\n        }\n        lst=i;\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 6005;\n\nint A[N], B[N], n, tA, tB, l[N], r[N], tot;\n\nstring s, dp[N];\n\nvoid solve(int x) {\n  if(A[l[x]] < B[l[x]]) {\n    int L = 0;\n    for(int i = l[x]; i <= r[x]; ++ i) {\n      if(A[i] > L) {\n        dp[x] += \"ab\";\n        L = B[i];\n      }\n    }\n  }\n  else {\n    dp[x] = \"\";\n    vector < pair < int, char> > it;\n    for(int i = r[x]; i >= l[x]; -- i) {\n      string now = \"\";\n      it.clear();\n      for(int j = i; j <= r[x]; ++ j)\n        it.push_back(make_pair(B[j], 'b')),\n          it.push_back(make_pair(A[j], 'a'));\n      sort(it.begin(), it.end());\n      for(int j = 0; j < (int) it.size(); ++ j)\n        now += it[j].second;\n      dp[x] = max(dp[x], now);\n    }\n  }\n}\n\nmain(void) {\n  cin >> n;\n  cin >> s;\n  for(int i = 0; i < n * 2; ++ i) {\n    if(s[i] == 'a') A[++ tA] = i + 1;\n    else B[++ tB] = i + 1;\n  }\n  int L = 1;\n  for(int i = 2; i <= n; ++ i) {\n    if(((A[i] < B[i]) ^ (A[i - 1] < B[i - 1]))) {\n      //[L, i - 1]\n      l[++ tot] = L;\n      r[tot] = i - 1;\n      L = i;\n    }\n  }\n  l[++ tot] = L;\n  r[tot] = n;\n  for(int i = 1; i <= tot; ++ i) solve(i);\n  for(int i = tot; i >= 1; -- i) {\n    dp[i] = max(dp[i] + dp[i + 1], dp[i + 1]);\n  }\n  cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h> \nusing namespace std; \n  \nstring LexicographicalMaxString(string str) \n{ \n    string mx = \"\"; \n    for (int i = 0; i < str.length(); ++i) \n        mx = max(mx, str.substr(i)); \n  \n    return mx; \n} \n\nint main() \n{ \n\tint n;\n\tcin >> n;\n    string str; \n    cin >> str;\n    cout << LexicographicalMaxString(str); \n    return 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nconst int MAX = 3000;\n\nstring greedA(string S, int l, int r) { // 先頭がaだった時の貪欲取得(abab…系)\n\tstring ret = S.substr(l, (r - l));\n\tfor (int i = 1, ma = r - l, j, k;i < ma;++ i) {\n\t\tif (ret[i] == 'a') { // 連続した'a'を発見\n\t\t\tfor (j = i + 1;ret[j] == 'a';j ++); // 最初に出てくるb(消さない)\n\t\t\tfor (k = j + 1;ret[k] == 'a';k ++); // 次に出てくるb(消す)\n\t\t\tret.erase(ret.begin() + k);\n\t\t\tret.erase(ret.begin() + i);\n\t\t\t-- i;\n\t\t} else ++ i;\n\t}\n\treturn ret;\n}\n\nstring greedB(string S, int l, int r) { // 先頭がbだった時の探索(i決め打ち、i番目以降取る)\n\tstring ret = S.substr(l, (r - l)), comp = ret;\n\tfor (int i = 0, ma = ((r - l) >> 1), j;i < ma;i ++) {\n\t\tfor (j = 1;comp[j] == comp[0];j ++);\n\t\tcomp.erase(comp.begin() + j);\n\t\tcomp.erase(comp.begin());\n\t\tret = ret > comp ? ret : comp;\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint N;\n\tstring S;\n\tcin >> N >> S;\n\tN = S.length();\n\t\n\tbool isA[MAX]; // isA[i] = S[i] == 'a'\n\tfor (int i = 0;i < N;++ i) isA[i] = S[i] == 'a';\n\t\n\tint sum[MAX]; // 累積和、sum[i]は[0, i)までに出てきた'b'の数-出てきた'a'の数\n\tsum[0] = isA[0] ? -1 : 1;\n\tfor (int i = 1;i < N;++ i) sum[i] = sum[i - 1] + (isA[i] ? -1 : 1);\n\t\n\tstring greed[MAX];\n\tint use = 0;\n\t\n\tfor (int l = 0, r = 0;l < N;l = r + 1, ++ r) {\n\t\twhile(sum[r] != 0) ++ r; // ここまでで区間[l, r)の累積和は0、よって独立に解ける\n\t\tif (isA[l]) greed[use] = greedA(S, l, r + 1);\n\t\telse greed[use] = greedB(S, l, r + 1);\n\t\tuse ++;\n\t}\n\t\n\tstring ret = \"\";\n\tfor (int i = use - 1;i >= 0;i --) { // 後は貪欲に構成\n\t\tret = greed[i] + ret > ret ? greed[i] + ret : ret;\n\t}\n\tcout << ret;\n\treturn 0;\n}\n/*\n31536000のコメント解説欄\nここテンプレで用意してるから、A問題とかだとこの先空欄の危険あり\nまた、コンテスト後に https://31536000.hatenablog.com/ で解説していると思うので、良かったら読んでねー\n\n解説ACなので何も無いです、解説読んでね\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[MAX];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=A)\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\t//print the maximum\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tif(res[A].size()==0)\n\t\t{\n\t\t\twhile(true)\n\t\t\t{\n\t\t\t\tcout<<\"ha ha\\n\";\n\t\t\t}\n\t\t}\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll int\n#define pb push_back\n#define mp make_pair\n#define ld long double\n#define F first\n#define S second\n#define pii pair<ll,ll>\n#define pie pair<pii,ll>\nusing namespace :: std;\n\nconst ll maxn=6100;\nll dp[maxn];\nll a[maxn];\nll b[maxn];\nll o[maxn];\nstring fa(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n\n    fill(dp,dp+maxn,0);\n    for(ll i=n-2;i>=0;i--){\n        dp[i]=dp[i+1];\n        if(s[i]=='a'){\n            dp[i]=max(dp[i],1+dp[b[o[i]]]);\n        }\n    }\n    string ans;\n    for(ll i=0;i<dp[0];i++){\n        ans+=\"ab\";\n    }\n    return ans;\n}\nstring fb(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n    string maxx;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='b'){\n            string res=\"\";\n            for(ll j=i;j<n;j++){\n                if(o[j]>=o[i]){\n                    res+=s[j];\n                }\n            }\n            maxx=max(maxx,res);\n        }\n    }\n    return maxx;\n\n}\nstring dps[maxn];\nint main()\n{\n    ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n    string s;\n    ll n;\n    cin>>n>>s;\n    n*=2;\n    string last;\n    ll sum=0;\n    vector<string> vec;\n    for(ll i=0;i<n;i++){\n        last+=s[i];\n        if(s[i]=='a'){\n            sum++;\n        }else{\n            sum--;\n        }\n        if(sum==0){\n            vec.pb(last);\n            last=\"\";\n        }\n    }\n    if(last.size()>0)\n        vec.pb(last);\n    string sara;\n    vector<string> sarb;\n    for(ll i=vec.size()-1;i>=0;i--){\n        if(sarb.empty()){\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }else{\n                sara=vec[i]+sara;\n            }\n        }else{\n            if(vec[i][0]=='b'){\n                sarb.pb(vec[i]);\n            }\n        }\n    }\n    reverse(sarb.begin(),sarb.end());\n    for(ll i=0;i<sarb.size();i++){\n        sarb[i]=fb(sarb[i]);\n    }\n    if(sarb.size()==0){\n        cout<<fa(sara);\n        return 0;\n    }\n    dps[sarb.size()-1]=sarb.back();\n    for(ll i=(ll)sarb.size()-2;i>=0;i--){\n        dps[i]=max(sarb[i],max(dps[i+1],sarb[i]+dps[i+1]));\n    }\n    cout<<dps[0]<<fa(sara);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nstring slow(string s) {\n    vi id(s.size());\n    int ca = 0, cb = 0;\n    forn(i, 0, s.size() - 1) {\n        if (s[i] == 'a') id[i] = ca++;\n        if (s[i] == 'b') id[i] = cb++;\n    }\n    string ans;\n    forn(mask, 0, (1 << s.size()) - 1) {\n        vi cnt(s.size() / 2, 0);\n        string cur;\n        forn(i, 0, s.size() - 1)\n            if (mask & (1 << i))\n                ++cnt[id[i]], cur.pb(s[i]);\n        bool shit = 0;\n        for (auto x : cnt)\n            if (x == 1) shit = 1;\n        if (shit) continue;\n        ans = max(ans, cur);\n    }\n    cerr << \"opt = \" << ans << \"\\n\";\n    return ans;\n}\n\nint n, a[N];\nint bal[N];\nstring str[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    //forn(it, 1, 100) {\n    forn(i, 1, n * 2)\n        bal[i] = 0, str[i] = sx[i] = \"\";\n    string given;\n    int ga = n, gb = n;\n    forn(i, 1, n * 2) {\n        char c;\n//        c = rand() % 2 + 'a';\n//        if (ga == 0) c = 'b';\n//        if (gb == 0) c = 'a';\n//        if (c == 'a') --ga;\n//        if (c == 'b') --gb;\n        cin >> c;\n        given.pb(c);\n        a[i] = c - 'a';\n    }\n    //cerr << \"test \" << it << \" \" << given << \"\\n\";\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            str[i] = cans;\n        }\n        else {\n            int cnt = 0;\n            string cur;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    cur.pb('a'), cur.pb('b');\n                    cnt = 0;\n                }\n            }\n            str[i] = cur;\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    for1(i, p.size() - 2, 0)\n        sx[i] = max(sx[i + 1], str[i]);\n    forn(i, 0, p.size() - 2)\n        if (s[i] == 1 && str[i] == sx[i])\n            ans = ans + str[i];\n    forn(i, 0, p.size() - 2)\n        if (i > lst && s[i] == -1)\n            ans = ans + str[i];\n    //cerr << ans << \"\\n\";\n    //assert(ans == slow(given));\n    cout << ans << \"\\n\";\n    //}\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\ntypedef long long LL;\nusing namespace std;\nconst int N = 3e3 + 5;\n\nchar seq[N * 2];\nint locAll[N * 2];\nint locA[N];\nint locB[N];\nint dp[N][N];\nint n;\nstring toString(int num[]) {\n    string tmp;\n    for(int i = 1; i <= 2*n; ++i) {\n        if(num[locAll[i]]) \n            tmp += seq[i];\n    }\n    return tmp;\n}\n\nint main() {\n    while(~scanf(\"%d\", &n)) {\n        memset(dp, 0, sizeof(dp));\n        scanf(\"%s\", seq + 1);\n        for(int i = 1, cntA = 0, cntB = 0; i <= 2*n; ++i) {\n            if(seq[i] == 'a') {\n                locA[++cntA] = i;\n                locAll[i] = cntA;\n            } else {\n                locB[++cntB] = i;\n                locAll[i] = cntB;\n            }\n        }\n        dp[n][n] = 1;\n\n        for(int i = n-1; i >= 1; --i) {\n            dp[i][i] = 1;\n            if(locA[i] < locB[i]) {\n                int Max = 0;\n                for(int j = locA[i]; j <= locB[i]; ++j) {\n                    if(locAll[j] < i)\n                        continue;\n                    Max = max(Max, locAll[j]);\n                }\n                for(int j = locB[i]+1; j <= 2*n; ++j) {\n                    if(locAll[j] > Max)\n                        dp[i][locAll[j]] = dp[Max + 1][locAll[j]];\n                }\n            } else {\n                int tot = 0, Max = 0;\n                for(int j = locB[i]; j <= locA[i]; ++j) {\n                    if(locAll[j] < i)\n                        continue;\n                    if(locAll[j] != i) tot ++;\n                    Max = max(Max, locAll[j]);\n                    dp[i][locAll[j]] = 1;\n                }    \n\n                for(int j = locA[i]+1; j <= 2*n; ++j) {\n                    if(seq[j] == 'b') {\n                        if(tot == 0) {\n                            dp[i][locAll[j]] = dp[Max+1][locAll[j]];\n                        } else {\n                            dp[i][locAll[j]] = 1;\n                            tot ++;\n                        }\n                    } else {\n                        if(tot == 0) {\n                            dp[i][locAll[j]] = dp[Max+1][locAll[j]];\n                        } else {\n                            dp[i][locAll[j]] = 1;\n                            Max = max(Max, locAll[j]);\n                            tot --;\n                        }\n                    }\n                }\n                \n            }\n            if(toString(dp[i]) < toString(dp[i + 1])) {\n                memcpy(dp[i], dp[i + 1], sizeof(dp[i + 1]));\n            }\n        }\n\n        printf(\"%s\\n\", toString(dp[1]).c_str());\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define mod 1000000007\n#define sp ' '\n#define intmax 2147483647\n#define llmax 9223372036854775807\n#define mkp make_pair\n#define lP pair<ll, ll>\n#define iP pair<int,int>\ntypedef long long ll;\nusing namespace std;\n\nstruct T {\n\tint l, r;\n\tstring s;\n};\n\nint N, r[3000], b[3000], cr, cb, R;\nstring S;\nvector<T>v;\ndeque<string>q;\n\nint main() {\n\tcin >> N >> S;\n\tfor (int i = 0; i < N * 2; ++i) {\n\t\tif (S[i] == 'a') {\n\t\t\tr[cr] = i;\n\t\t\t++cr;\n\t\t}\n\t\telse {\n\t\t\tb[cb] = i;\n\t\t\t++cb;\n\t\t}\n\t}\n\tv.push_back({ 0,0 });\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (b[i] < r[i]) {\n\t\t\tif (r[v.back().r] < b[i]) {\n\t\t\t\tv.push_back({ i,i });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tv.back().r = i;\n\t\t\t}\n\t\t}\n\t}\n\tif (r[0] < b[0]) {\n\t\tv.erase(v.begin());\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\tvector<bool>B(N, false);\n\t\tfor (int j = v[i].r; j >= v[i].l; --j) {\n\t\t\tB[b[j]] = B[r[j]] = true;\n\t\t\tstring s;\n\t\t\tfor (int k = b[j]; k <= r[v[i].r]; ++k) {\n\t\t\t\tif (B[k]) {\n\t\t\t\t\ts.push_back(S[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tv[i].s = max(v[i].s, s);\n\t\t}\n\t}\n\tfor (int i = 0; i < v.size(); ++i) {\n\t\twhile (!q.empty() && q.back() < v[i].s) {\n\t\t\tq.pop_back();\n\t\t}\n\t\tq.push_back(v[i].s);\n\t\tR = r[v[i].r] + 1;\n\t}\n\twhile (!q.empty()) {\n\t\tcout << q.front();\n\t\tq.pop_front();\n\t}\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (r[i] < b[i] && r[i] >= R) {\n\t\t\tcout << \"ab\";\n\t\t\tR = b[i];\n\t\t}\n\t}\n\tcout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define N 3010\nstring Beta(string s){\n    if(s.size()==0)return \"#\";\n    if(s[0]=='a')return \"#\";\n    string res=\"\";\n    for(int i=0;i<s.size()-1;i++){\n        ll a=0,b=0;\n        string cur=\"\";\n        for(int j=0;j<s.size();j++){\n         if(s[j]=='a'){\n             if(a>=i)cur.push_back(s[j]);\n             a++;\n         }\n         if(s[j]=='b'){\n             if(b>=i)cur.push_back(s[j]);\n             b++;\n         }\n        }\n        //cout<<\"#\"<<cur<<endl;\n     res=max(res,cur);\n    }\n    //cout<<s<<\" \"<<res<<endl;\n    return res;\n}\nll n;\nstring s;\nll A[N],B[N],C[N];;\nint main(){\n    cin>>n>>s;\n    ll a=0,b=0;\n    string q=\"\";\n    typedef pair<string,ll> P;\n    vector<P> v;\n    for(int i=0;i<2*n;i++){\n     q.push_back(s[i]);\n     if(s[i]=='a'){A[a]=i;a++;}\n     if(s[i]=='b'){B[b]=i;b++;}\n     if(a==b){\n      string res=Beta(q);\n      if(res!=\"#\"){\n       v.push_back(make_pair(res,i));   \n      }\n      q=\"\";   \n     }\n    }//cout<<\"initend\"<<endl;\n    sort(v.begin(),v.end(),greater<P>());\n    for(int i=0;i<n;i++){\n     C[A[i]]=B[i];\n     C[B[i]]=A[i];\n    }\n    ll cur=-1;\n    string ans=\"\";\n    for(auto x:v){\n     string str=x.first;\n     ll p=x.second;\n     if(p<cur)continue;\n     ans+=str;\n    }cur++;\n    if(cur==0)cur=1e9;\n    for(;cur<2*n;){\n        for(;cur<2*n;cur++){\n         if(s[cur]=='a')break;   \n        }\n        if(cur==2*n)break;\n        ans+=\"ab\";\n        cur=C[cur]+1;\n    }\n    cout<<ans<<endl;\n return  0;   \n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nint N;\nchar sir[6009];\n\nstring takeString (vector < int > p)\n{\n    string curr;\n    for (auto i : p)\n        curr.push_back (sir[i]);\n    return curr;\n}\n\nvector < int > operator + (vector < int > a, vector < int > b)\n{\n    for (auto i : b)\n        a.push_back (i);\n    return a;\n}\n\nvoid updateAns (vector < int > &ans, vector < int > potentialAns)\n{\n    if (takeString (potentialAns) > takeString (ans))\n        ans = potentialAns;\n}\n\nvector < int > solve (int l, int r)\n{\n    vector < int > pa, pb;\n    for (int i=l; i<=r; i++)\n        if (sir[i] == 'a') pa.push_back (i);\n        else pb.push_back (i);\n    if (pa[0] < pb[0])\n    {\n        vector < int > ans;\n        ans.push_back (pa[0]), ans.push_back (pb[0]);\n        int lastB = pb[0];\n        for (int i=1; i<pa.size (); i++)\n            if (pa[i] > lastB)\n                ans.push_back (pa[i]),\n                ans.push_back (pb[i]),\n                lastB = pb[i];\n        return ans;\n    }\n    vector < int > ans, curr;\n    for (int i=pa.size () - 1; i>=0; i--)\n    {\n        curr.push_back (pa[i]);\n        curr.push_back (pb[i]);\n        sort (curr.begin (), curr.end ());\n        updateAns (ans, curr);\n    }\n    return ans;\n}\n\nint main ()\n{\n//freopen (\"input\", \"r\", stdin);\n//freopen (\"output\", \"w\", stdout);\n\nscanf (\"%d\\n\", &N);\nscanf (\"%s\", sir + 1);\nint balance = 0, lst = 0;\nvector < string > ans;\nfor (int i=1; i<=2 * N; i++)\n{\n    if (sir[i] == 'a') balance ++;\n    else balance --;\n    if (balance == 0)\n    {\n        ans.push_back (takeString (solve (lst + 1, i)));\n        lst = i;\n    }\n}\nreverse (ans.begin (), ans.end ());\nstring finalAns;\nfor (auto s : ans)\n    if (s + finalAns > finalAns)\n        finalAns = s + finalAns;\nprintf (\"%s\\n\", finalAns.c_str ());\nreturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn = 6000;\nint n;\nchar s[maxn + 10];\nint a[maxn + 10], b[maxn + 10], bel[maxn + 10];\nbool mk[maxn + 10];\nstring v[maxn + 10], f[maxn + 10];\nint m;\n\nvoid build(char c, int *x) {\n\tfor (int i = 1, p = 1; i <= n; ++i) {\n\t\twhile (s[p] != c) ++p;\n\t\tx[i] = p; bel[p] = i;\n\t\t++p;\n\t}\n}\n\nvoid addin(int l, int r) {\n\tstring str = \"\";\n\tint mn = 1e9, mx = 0;\n\tfor (int i = l; i <= r; ++i) {\n\t\tmn = min(mn, bel[i]);\n\t\tmx = max(mx, bel[i]);\n\t}\n\tif (a[mn] < b[mn]) {\n\t\tint pos = 0;\n\t\tfor (int i = mn; i <= mx; ++i)\n\t\t\tif (a[i] > pos) {\n\t\t\t\tstr += \"ab\"; pos = b[i];\n\t\t\t}\n\t} else {\n\t\tmemset(mk, 0, sizeof mk);\n\t\tstr = \"A\";\n\t\tfor (int i = mx; i >= mn; --i) {\n\t\t\tmk[a[i]] = mk[b[i]] = 1;\n\t\t\tstring tmp;\n\t\t\tfor (int j = 1; j <= n * 2; ++j)\n\t\t\t\tif (mk[j]) tmp += s[j];\n\t\t\tstr = max(str, tmp);\n\t\t}\n\t}\n\tv[++m] = str;\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\tbuild('a', a); build('b', b);\n\tfor (int i = 1, lst; i <= n * 2; i = lst) {\n\t\tint r = max(a[bel[i]], b[bel[i]]);\n\t\tfor (lst = i; lst <= r; ++lst)\n\t\t\tr = max(r, max(a[bel[lst]], b[bel[lst]]));\n\t\taddin(i, lst - 1);\n\t}\n\tfor (int i = m; i >= 1; --i)\n\t\tf[i] = max(f[i + 1], v[i] + f[i + 1]);\n\tcout << f[1];\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\n\npair<string,int> solve(int l){\n\tint i=l+1;\n\tvector<string> ss;\n\twhile(abs(s[l]-s[i])!=1){\n\t\tauto p=solve(i);\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\tvector<string> re;\n\trrep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret,reb;\n\trrep(i,re.size()) ret+=re[i];\n\trrep(i,re.size())if(re[i][0]=='b') reb+=re[i];\n\tif(l) MX(ret,string(1,s[l])+ret+string(1,s[i]));\n\tif(l && re.size()) MX(ret,string(1,s[l])+re.front()+string(1,s[i]));\n\tif(re.size()) MX(ret,re.front());\n\tMX(ret,reb);\n\tif(l) MX(ret,string(1,s[l])+reb+string(1,s[i]));\n\t++i;\n\tout(l,i,ret,1);\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\ts=\"e\"+s+\"f\";\n\tauto re=solve(0);\n\tcout<<re.X<<endl;\n\tout(re,1);\n\tassert(re.Y==2*n+2);\n\t// assert(re[0]=='e');\n\t// assert(re[m-1]=='f');\n\t// cout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<string>\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> P;\n\n#define fr first\n#define sc second\n\nint N;\nstring S;\n\nbool comp(string x,string y){\n\tfor(int i = 0 ; i < min(x.size(),y.size()) ; i ++){\n\t\tif(x[i] != y[i]){\n\t\t\treturn x[i] > y[i];\n\t\t}\n\t}\n\treturn x.size() > y.size();\n}\n\nbool eq(string x,string y){\n\tif(x.size() != y.size())return false;\n\tfor(int i = 0 ; i < x.size() ; i ++){\n\t\tif(x[i] != y[i])return false;\n\t}\n\treturn true;\n}\n\nbool comp2(pair<string,int> x,pair<string,int> y){\n\tif(eq(x.fr,y.fr))return x.sc < y.sc;\n\treturn comp(x.fr,y.fr);\n}\n\nstring solve(int s,int t){\n\tif(S[s] == 'a'){\n\t\tint pre = 0;\n\t\tint cnt[2] = {};\n\t\tstring ret = \"\";\n\t\tfor(int i = s ; i <= t ; i ++){\n\t\t\tcnt[S[i]-'a'] ++;\n\t\t\tif(S[i] == 'a'){\n\t\t\t\tif(cnt[1] >= pre){\n\t\t\t\t\tpre = cnt[0];\n\t\t\t\t\tret += \"a\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(cnt[1] == pre){\n\t\t\t\t\tret += \"b\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\tvector<string> vec;\n\tfor(int k = 0 ; k <= (t-s)/2 ; k ++){\n\t\tint cnt[2] = {};\n\t\tstring ret;\n\t\tfor(int i = s ; i <= t ; i ++){\n\t\t\tif(cnt[S[i]-'a'] == k)ret += S[i];\n\t\t\telse cnt[S[i]-'a'] ++;\n\t\t}\n\t\tvec.push_back(ret);\n\t}\n\tsort(vec.begin(),vec.end(),comp);\n\treturn vec[0];\n}\n\nint main(){\n\tcin >> N >> S;\n\t\n\tint cnt[6002] = {};\n\tfor(int i = 0 ; i < S.size() ; i++){\n\t\tcnt[i+1] = cnt[i]+1-2*(S[i]=='b'?1:0);\n\t}\n\tvector<pair<string,int>> vec;\n\tint l = 0;\n\tfor(int i = 0 ; i < S.size() ; i ++){\n\t\tif(cnt[i+1] == 0){\n\t\t\tstring s = solve(l,i);\n\t\t\tif(s[0] == 'a'){\n\t\t\t\tfor(int j = 0 ; j < s.size() ; j += 2){\n\t\t\t\t\tvec.push_back(pair<string,int>(\"ab\",(int)vec.size()));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse vec.push_back(pair<string,int>(s,(int)vec.size()));\n\t\t\tl = i+1;\n\t\t}\n\t}\n\t\n\tsort(vec.begin(),vec.end(),comp2);\n\tstring ret = \"\";\n\tint Max = -1;\n\tfor(int i = 0 ; i < vec.size() ; i ++){\n\t\tif(vec[i].sc > Max){\n\t\t\tMax = vec[i].sc;\n\t\t\tret += vec[i].fr;\n\t\t}\n\t}\n\tcout << ret << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//by yjz\n#include<bits/stdc++.h>\nusing namespace std;\n#define FF first\n#define SS second\n#define PB push_back\n#define MP make_pair\n#define foreach(it,s) for(__typeof((s).begin()) it=(s).begin();it!=(s).end();it++)\n#ifndef LOCAL\n#define cerr if(0)cout\n#endif\ntypedef long long ll;\nconst int mod=1e9+7;\n//My i/o stream\nstruct fastio\n{\n\tchar s[100000];\n\tint it,len;\n\tfastio(){it=len=0;}\n\tinline char get()\n\t{\n\t\tif(it<len)return s[it++];it=0;\n\t\tlen=fread(s,1,100000,stdin);\n\t\tif(len==0)return EOF;else return s[it++];\n\t}\n\tbool notend()\n\t{\n\t\tchar c=get();\n\t\twhile(c==' '||c=='\\n')c=get();\n\t\tif(it>0)it--;\n\t\treturn c!=EOF;\n\t}\n}_buff;\n#define geti(x) x=getnum()\n#define getii(x,y) geti(x),geti(y)\n#define getiii(x,y,z) getii(x,y),geti(z)\n#define puti(x) putnum(x),putchar(' ')\n#define putii(x,y) puti(x),puti(y)\n#define putiii(x,y,z) putii(x,y),puti(z)\n#define putsi(x) putnum(x),putchar('\\n')\n#define putsii(x,y) puti(x),putsi(y)\n#define putsiii(x,y,z) putii(x,y),putsi(z)\ninline ll getnum()\n{\n\tll r=0;bool ng=0;char c;c=_buff.get();\n\twhile(c!='-'&&(c<'0'||c>'9'))c=_buff.get();\n\tif(c=='-')ng=1,c=_buff.get();\n\twhile(c>='0'&&c<='9')r=r*10+c-'0',c=_buff.get();\n\treturn ng?-r:r;\n}\ntemplate<class T> inline void putnum(T x)\n{\n\tif(x<0)putchar('-'),x=-x;\n\tregister short a[20]={},sz=0;\n\twhile(x)a[sz++]=x%10,x/=10;\n\tif(sz==0)putchar('0');\n\tfor(int i=sz-1;i>=0;i--)putchar('0'+a[i]);\n}\ninline char getreal(){char c=_buff.get();while(c<=32)c=_buff.get();return c;}\nll qpow(ll x,ll k){return k==0?1:1ll*qpow(1ll*x*x%mod,k>>1)*(k&1?x:1)%mod;}\nchar s[6011];\nint n,rk[6011];\nvector<int> pa,pb;\nconst int maxn=3011*6011;\nint go[maxn][2],tot=1;\nint head[maxn],nxt[3011];\npair<int,int> seg[3011];\nvoid add(int il,int ir)\n{\n//\tcerr<<\"add:\"<<il<<\" \"<<ir<<endl;\n\tint p=1;\n\tint l=n+n,r=0;\n\tfor(int i=0;i<n+n;i++)\n\t{\n\t\tif(rk[i]>=il&&rk[i]<=ir)\n\t\t{\n\t\t\tint &q=go[p][s[i]-'a'];\n\t\t\tif(!q)\n\t\t\t{\n\t\t\t\tq=++tot;\n\t\t\t\thead[q]=-1;\n\t\t\t}\n\t\t\tp=q;\n\t\t\tl=min(l,i);\n\t\t\tr=max(r,i);\n\t\t}\n\t}\n\tnxt[il]=head[p];\n\thead[p]=il;\n\tseg[il]=MP(l,r);\n}\nvector<int> ANS;\nchar st[6011];\nint stn;\nvoid dfs(int p)\n{\n\tfor(int i=1;i>=0;i--)\n\t{\n\t\tif(go[p][i])\n\t\t{\n\t\t\tst[stn++]='a'+i;\n\t\t\tdfs(go[p][i]);\n\t\t\tstn--;\n\t\t}\n\t}\n\tif(p==1)return;\n//\tcerr<<\"dfs:\"<<p<<\" \"<<head[p]<<endl;\n\tfor(int i=head[p];i!=-1;i=nxt[i])\n\t{\n\t\tif(ANS.size()==0||seg[ANS[ANS.size()-1]].SS<seg[i].FF)\n\t\t{\n\t\t\tANS.PB(i);\n\t\t\tfor(int j=0;j<stn;j++)putchar(st[j]);\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s);\n\tfor(int i=0;i<n+n;i++)\n\t{\n\t\tif(s[i]=='a')rk[i]=pa.size(),pa.PB(i);\n\t\telse rk[i]=pb.size(),pb.PB(i);\n\t}\n\tfor(int i=n-1;i>=0;i--)\n\t{\n\t\tif(pa[i]<pb[i])\n\t\t{\n\t\t\tadd(i,i);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint j=i;\n\t\t\twhile(j+1<n&&pb[j+1]<pa[j])j++;\n\t\t\tadd(i,j);\n\t\t}\n\t}\n\tdfs(1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntemplate<typename T> void cmax(T &x, const T &y)\n{\n\tif(y > x) x = y;\n}\n\ntemplate<typename T> void read(T &x)\n{\n\tx = 0;\n\tchar c = getchar();\n\tbool f = 0;\n\twhile(!isdigit(c) && c!='-') c = getchar();\n\tif(c == '-') f = 1, c = getchar();\n\twhile(isdigit(c)) x = x*10+c-'0', c = getchar();\n\tif(f) x = -x;\n}\n\nstring calca(string s)\n{\n\tvector<int> pa, pb;\n\tstring ret;\n\tfor(int i=0; i<s.length(); i++)\n\t\tif(s[i] == 'a') pa.push_back(i);\n\t\telse pb.push_back(i);\n\tint lst = -1;\n\tfor(int i=0; i<pa.size(); i++)\n\t\tif(pa[i] > lst) ret += \"ab\", lst = pb[i];\n\treturn ret;\n}\n\nstring calcb(string s)\n{\n\tvector<int> pa, pb;\n\tstring ret;\n\tfor(int i=0; i<s.length(); i++)\n\t\tif(s[i] == 'a') pa.push_back(i);\n\t\telse pb.push_back(i);\n\tfor(int i=0; i<pa.size(); i++)\n\t{\n\t\tstring cur;\n\t\tauto ia = pa.begin()+i, ib = pb.begin()+i;\n\t\twhile(ia!=pa.end() && ib!=pb.end())\n\t\t\tif(*ia < *ib) cur.push_back('a'), ia++;\n\t\t\telse cur.push_back('b'), ib++;\n\t\twhile(ia != pa.end()) cur.push_back('a'), ia++;\n\t\twhile(ib != pb.end()) cur.push_back('b'), ib++;\n\t\tcmax(ret, cur);\n\t}\n\treturn ret;\n}\n\nint main()\n{\n\tint n;\n\tstring str;\n\tread(n);\n\tcin >> str;\n\tint sum = 0;\n\tstring cur, nxt;\n\tvector<string> ans;\n\tfor(auto c : str)\n\t{\n\t\tif(c == 'a') sum--;\n\t\telse sum++;\n\t\tcur.push_back(c);\n\t\tif(sum == 0)\n\t\t{\n\t\t\tif(*cur.begin() == 'a') nxt = calca(cur);\n\t\t\telse nxt = calcb(cur);\n\t\t\twhile(!ans.empty() && nxt>ans.back()) ans.pop_back();\n\t\t\tans.push_back(nxt);\n\t\t\tcur.clear();\n\t\t}\n\t}\n\tfor(auto i : ans) cout << i;\n\tcout << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<string> t;\n    vector<int> a, b, pos(2 * n);\n    for (int i = 0; i < 2 * n; ++i) {\n        if (s[i] == 'a') {\n            pos[i] = a.size();\n            a.push_back(i);\n        } else {\n            pos[i] = b.size();\n            b.push_back(i);\n        }\n        if (a.size() == b.size()) {\n            string f;\n            if (a.back() < b.back()) {\n                int lst = -1;\n                for (int j = 0; j < a.size(); ++j) {\n                    if (a[j] > lst) {\n                        f += \"ab\";\n                        lst = b[j];\n                    }\n                }\n            } else {\n                int l = i - 2 * a.size() + 1;\n                for (int j = 0; j < a.size(); ++j) {\n                    string g;\n                    for (int k = l; k <= i; ++k)\n                        if (pos[k] >= j)\n                            g += s[k];\n                    f = max(f, g);\n                }\n            }\n            t.push_back(f);\n            a.clear();\n            b.clear();\n        }\n    }\n    s.clear();\n    reverse(t.begin(), t.end());\n    for (auto &f : t)\n        s = max(s, f + s);\n    cout << s << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tif ((s[i]-'a')!=f)\n\t\t\t{\n\t\t\t\ti++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor (int i=l-1;i<=r;i++)\n\t\t{\n\t\t\tc[i]=0;\n\t\t}\n\t\tfor (int i=l;i<=r;i++)\n\t\t{\n\t\t\tif ((s[i]-'a')==f)\n\t\t\t{\n\t\t\t\tc[i]=c[i-1]+1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tc[i]=c[i-1];\n\t\t\t}\n\t\t}\n\t\tvector<int> v;\n\t\tv.clear();\n\t\tint mx=l;\n\t\tv.push_back(l);\n\t\tfor (int i=l+1;i<=r;i++)\n\t\t{\n\t\t\tif (c[b[i]]-c[i]>c[b[mx]]-c[mx])\n\t\t\t{\n\t\t\t\tv.clear();\n\t\t\t\tmx=i;\n\t\t\t\tv.push_back(i);\n\t\t\t}\n\t\t\telse if (c[b[i]]-c[i]==c[b[mx]]-c[mx])\n\t\t\t{\n\t\t\t\tv.push_back(i);\n\t\t\t}\n\t\t}\n\t\tfor (int j=0;j<v.size();j++)\n\t\t{\n\t\t\tstring now=\"\";\n\t\t\tfor (int i=v[j];i<=r;i++)\n\t\t\t{\n\t\t\t\tif ((s[i]-'a')==f)\n\t\t\t\t{\n\t\t\t\t\tnow.push_back(s[i]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (i>=b[v[j]])\n\t\t\t\t\t{\n\t\t\t\t\t\tnow.push_back(s[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tres=max(res,now);\n\t\t}\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=2*n-1;\n\tstring ans=\"\";\n\tfor (int i=2*n-1;i>=0;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa!=sb)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tif (s[i-1]=='b')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (lst==2*n-1)\n\t\t\t{\n\t\t\t\tans=work(0,i,lst)+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring str=work(1,i,lst);\n\t\t\tif ((str+ans)>ans)\n\t\t\t{\n\t\t\t\tans=str+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint A[3010],B[3010];\nstring getans(int l,int r)\n{\n\tstring ans=\"\";\n\tif(A[l]<B[l])\n\t{\n\t\tint now=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(A[i]>now){\n\t\t\t\tnow=B[i];\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t}\n\telse{\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tstring cur=\"\";\n\t\t\tint nowa=i,nowb=i;\n\t\t\twhile(nowa<=r||nowb<=r)\n\t\t\t{\n\t\t\t\tif((nowa<=r&&A[nowa]<B[nowb])||nowb>r)\n\t\t\t\t\tcur+='a',nowa++;\n\t\t\t\telse cur+='b',nowb++;\n\t\t\t}\n\t\t\tans=max(ans,cur);\n\t\t}\n\t}\n\treturn ans;\n}\nchar str[6010];\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint nowa=0,nowb=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')A[++nowa]=i;\n\t\telse B[++nowb]=i;\n\tstring ans=\"\";\n\tfor(int i=n;i>=1;)\n\t{\n\t\tint j=i;\n\t\tif(A[i]<B[i])while(j>0&&A[j]<B[j])j--;\n\t\telse while(j>0&&A[j]>B[j])j--;\n\t\tstring tmp=getans(j+1,i);\n\t\tif(tmp+ans>ans)ans=tmp+ans;\n\t\ti=j;\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//実装が重そうな問題はある程度考えてから書く\n//初期化を忘れずに（特に二分探索とか）\n//コーナーケースを考えて（特に場合分けとか）\n//不可解すぎるバグは配列外参照（配列の長さ）を検討\n#include <bits/stdc++.h>\n#define YES \"YES\"\n#define NO \"NO\"\n#define YESNO OUT(three(solve(),YES,NO))\n#define ECHO OUT(solve())\n#define three(A,B,C) ((A)?(B):(C))\n#define FOR(i,a,b)  for(LL i=(a);i< (LL)(b);i++)\n#define EFOR(i,a,b) for(LL i=(a);i<=(LL)(b);i++)\n#define RFOR(i,a,b) for(LL i=(a);i>=(LL)(b);i--)\n#define REP(i,b) FOR(i,zero,b)\n#define EREP(i,b) EFOR(i,zero,b)\n#define RREP(i,b) RFOR(i,b,zero)\n#define ALL(c) c.begin(),c.end()\n#define UNIQUE(c) sort(ALL(c));c.erase(unique(ALL(c)),c.end())\n#define MAX(c) (*max_element(ALL(c)))\n#define MIN(c) (*min_element(ALL(c)))\n#define MP make_pair\n#define FI first\n#define SE second\n#define SI(x) (LL(x.size()))\n#define PB push_back\n#define DEBUG(a) OUT(a)\n#define DEBUG2(a,b) OUT2(a,b)\n#define cat cout << __LINE__ << endl\n#define OUT(a) cout << (a) << endl\n#define OUT2(a,b) cout << (a) <<\" \"<<(b) << endl\n#define int LL\n#define zero 0LL\nusing namespace std;\ntemplate<typename T> inline void maximize(T &a,T b){a=max(a,b);}\ntemplate<typename T> inline void minimize(T &a,T b){a=min(a,b);}\ntemplate<typename T> inline bool middle(T a,T b,T c){return b<=a && a<=c;}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\ntypedef long long LL;\ntypedef double ld;\ntypedef LL ut;\ntypedef vector<ut> VI;\ntypedef vector<VI> VII;\ntypedef pair<ut,ut> pr;\ntypedef pair<ut,pr> ppr;\ntypedef vector<pr> Vpr;\ntypedef vector<ppr> Vppr;\ntypedef priority_queue<pr,Vpr,greater<pr> > PQ;\ninline void outputVI(VI x){REP(i,SI(x)){cout << three(i,\" \",\"\") << x[i];}OUT(\"\");}\nconst int SIZE1=5*1e5+1000;\nconst int SIZE2=5010;\nconst int SIZE3=400;\nconst int SIZE=6050;\nconst LL p=7+1e9;\nconst LL INF=1LL<<60;\nconst long double EPS=1e-7;\nstring s;\nut N,M,K,X,L,Y;\n// ut A,B,C,D,E,F,G,H,I,J,O,P,Q,R,T,U;\nVI edges[SIZE];\nLL vals[SIZE],nums[SIZE],maps[SIZE2][SIZE2],answer=zero;\n\n////////////////////////////////////////////////////////////////////////////////////////////\n\n////////////////////////////////////////////////////////////////////////////////////////////\nvoid init(){\n\t\n}\nint A[SIZE];\nstring DP[SIZE];\nint ind[SIZE];\nint B[SIZE];\nint ps(int x){\n\tif(s[x]=='a') return B[ind[x]];\n\telse return A[ind[x]];\n}\nvoid greedy(int now,string & ans,int& next){\n\tnext=now+2;\n\tif(ps(now)<now){\n\t\tnext=now+1;\n\t\treturn;\n\t}\n\tFOR(i,now,2*N){\n\t\tif(next==i) return;\n\t\tif(now<=ps(i) && ps(i)<i && s[i]=='a') ans+='a'; \n\t\tif(ps(i)<i) continue;\n\t\tif(s[i]=='a'){\n\t\t\tif(now==i) {\n\t\t\t\tans=\"ab\";\t\n\t\t\t\tnext=ps(i);\n\t\t\t\treturn;\n\t\t\t}\n\t\t//\tcout << now <<\" \" << next <<\" \" << i << endl;\n\t\t//\tcout <<\"OUT\" << endl;\n\t\t\tassert(0);\n\t\t}else{\n\t\t\tans+='b';\n\t\t\tnext=ps(i)+1;\n\t\t}\n\t}\n\t\n//\treturn ans;\n}\nstring solve2(int now){\n\tif(now==2*N) return \"\";\n\tif(DP[now]!=\"\") return DP[now];\n\tint next;\n\tstring ans;\n\tgreedy(now,ans,next);\n\treturn DP[now]=max(solve2(now+1),ans+solve2(next));\n}\nLL solve(){\n\tcin >> N;\n\tcin >> s;\n\tint a=0,b=0;\n\tREP(i,s.size()){\n\t\tif(s[i]=='a'){\n\t\t\tind[i]=a;\n\t\t\tA[a++]=i;\n\t\t}else{\n\t\t\tind[i]=b;\n\t\t\tB[b++]=i;\n\t\t}\n\t}\n\tcout << solve2(0) << endl;\n\treturn 0;\n}\nsigned main(){\n\tsolve();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define finish(x) return cout << x << endl, 0\n#define ll long long\n\nint n;\nstring s;\n\nstring solve(string s){\n    int n = s.size();\n    string ret;\n    if(s[0] == 'a'){\n        for(int i = 0 ; i < n ; i++){\n            if(s[i] == 'b') continue;\n            int j = i + 1;\n            while(j < n && s[j] == 'a') j++;\n            ret += \"ab\";\n            i = j;\n        }\n    }\n    else{\n        ret = s;\n        while(s.size()){\n            int x = 0;\n            while(s[x] != 'a') x++;\n            int y = 0;\n            while(s[y] != 'b') y++;\n            if(y < x) swap(x, y);\n            s.erase(s.begin() + y);\n            s.erase(s.begin() + x);\n            ret = max(ret, s);\n        }\n    }\n    return ret;\n}\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    cin >> n >> s;\n    vector <string> a;\n    for(int i = 0 ; i < 2 * n ;){\n        int cur = s[i] == 'a' ? -1 : 1;\n        int j = i + 1;\n        string cur_s;\n        cur_s += s[i];\n        while(j < 2 * n){\n            cur += s[j] == 'a' ? -1 : 1;\n            cur_s += s[j];\n            j++;\n            if(cur == 0) break;\n        }\n        a.push_back(cur_s);\n        i = j;\n    }\n    for(auto &i : a) i = solve(i);\n    n = a.size();\n    vector <string> dp(n);\n    for(int i = n - 1 ; i >= 0 ; i--){\n        dp[i] = a[i];\n        if(i + 1 < n){\n            dp[i] = max(dp[i], dp[i + 1]);\n        }\n        for(int j = i + 1 ; j < n ; j++){\n            dp[i] = max(dp[i], a[i] + dp[j]);\n        }\n    }\n    cout << dp[0] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<unordered_set>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#include<cassert>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define reps(X,S,Y) for (int (X) = S;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y)-1;(X) >=0;--(X))\n#define rreps(X,S,Y) for (int (X) = (Y)-1;(X) >= (S);--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n#define eb emplace_back\n#define UNIQUE(X) (X).erase(unique(all(X)),(X).end())\n#define Endl endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> using vv=vector<vector<T>>;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class T,size_t n> ostream& operator<<(ostream &os, const array<T,n> &t) {\n\tos<<\"{\"; rep(i,n) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T,class U> ostream& operator<<(ostream &os, const tuple<S,T,U> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class S, class T,class U,class V> ostream& operator<<(ostream &os, const tuple<S,T,U,V> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\")\";}\ntemplate<class S, class T,class U,class V,class W> ostream& operator<<(ostream &os, const tuple<S,T,U,V,W> &t) { return os<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\",\"<<get<3>(t)<<\",\"<<get<4>(t)<<\")\";}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\n//#undef NUIP\n#ifdef NUIP\n#define out(args...){vector<string> a_r_g_s=s_p_l_i_t(#args, ','); e_r_r(a_r_g_s.begin(), args); }\nvector<string> s_p_l_i_t(const string &s, char c){vector<string> v;int d=0,f=0;string t;for(char c:s){if(!d&&c==',')v.pb(t),t=\"\";else t+=c;if(c=='\\\"'||c=='\\'')f^=1;if(!f&&c=='(')++d;if(!f&&c==')')--d;}v.pb(t);return move(v);}\nvoid e_r_r(vector<string>::iterator it) {}\ntemplate<typename T, typename... Args> void e_r_r(vector<string>::iterator it, T a, Args... args){ if(*it==\" 1\"||*it==\"1\") cerr<<endl; else cerr << it -> substr((*it)[0] == ' ', it -> length()) << \" = \" << a << \", \"; e_r_r(++it, args...);}\n#else\n#define out\n#endif\n#ifdef __cpp_init_captures\ntemplate<typename T>vector<T> table(int n, T v){ return vector<T>(n, v);}\ntemplate <class... Args> auto table(int n, Args... args){auto val = table(args...); return vector<decltype(val)>(n, move(val));}\n#endif\nconst ll MOD=1e9+7;\nint n;\nstring s;\nstring re;\n\npair<string,int> solve(int r,string hint=\"\"){\n\tint i=r-1;\n\tout(r,i,1);\n\tvector<string> ss(1,hint);\n\twhile(abs(s[r-1]-s[i-1])!=1){\n\t\tauto p=solve(i,ss.back());\n\t\tss.pb(p.X);\n\t\ti=p.Y;\n\t}\n\tvector<string> re;\n\trrep(i,ss.size()){\n\t\tif(re.empty() || re.back()<=ss[i]) re.pb(ss[i]);\n\t}\n\tstring ret,reb;\n\trrep(i,re.size()) ret+=re[i];\n\trrep(i,re.size())if(re[i][0]=='b') reb+=re[i];\n\tif(i) MX(ret,string(1,s[i])+ret+string(1,s[r-1]));\n\tif(i && re.size()) MX(ret,string(1,s[i])+re.front()+string(1,s[r-1]));\n\tif(re.size()) MX(ret,re.front());\n\tMX(ret,reb);\n\tif(i) MX(ret,string(1,s[i])+reb+string(1,s[r-1]));\n\tout(i,r,ret,1);\n\treturn make_pair(ret,i);\n}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(0);\n\tcin>>n>>s;\n\t//n=3000; s=string(n,'b')+string(n,'a');\n\t//n=3000; rep(i,n) s+=\"ba\";\n\ts=\"e\"+s+\"f\";\n\tsolve(2*n+2);\n\tauto re=solve(0);\n\tcout<<re.X<<endl;\n\tout(re,1);\n\t// assert(re[0]=='e');\n\t// assert(re[m-1]=='f');\n\t// cout<<re.substr(1,m-2)<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nchar s[6001];\nint a[6000];\nint b[6000];\nint h[6001];\nint m[6001];\nint z[6001];\n\nstring solvea(int l, int r) {\n    int i;\n    string ans = \"\";\n    \n    for (i = l; i < r; i++) {\n        if (s[i] == 'a') {\n            ans += \"ab\";\n            i = b[a[i]];\n        }\n    }\n    \n    return ans;\n}\n\nstring solveb(int l, int r) {\n    int i, j;\n    string ans = \"\";\n    \n    for (i = 0; i < (r - l) / 2; i++) {\n        int c[2] = {};\n        string tmp = \"\";\n        \n        for (j = l; j < r; j++) {\n            if (c[s[j] - 'a']++ >= i) tmp += s[j];\n        }\n        \n        if (tmp > ans) ans = tmp;\n    }\n    \n    return ans;\n}\n\nint main() {\n    int n, ca = 0, cb = 0, i;\n    vector <string> v;\n    string ans = \"\";\n    \n    scanf(\"%d\", &n);\n    scanf(\"%s\", s);\n    \n    for (i = 0; i < n * 2; i++) {\n        if (s[i] == 'a') {\n            a[i] = ca++;\n            h[i + 1] = h[i] - 1;\n        } else {\n            b[cb++] = i;\n            h[i + 1] = h[i] + 1;\n        }\n    }\n    \n    m[n * 2] = z[n * 2] = n * 2;\n    \n    for (i = n * 2 - 1; i >= 0; i--) {\n        m[i] = m[i + 1];\n        z[i] = z[i + 1];\n        if (h[i] >= h[m[i]]) m[i] = i;\n        if (h[i] == 0) z[i] = i;\n    }\n    \n    for (i = 0; i < n * 2; ) {\n        if (s[i] == 'a') {\n            v.push_back(solvea(i, z[i + 1]));\n        } else {\n            v.push_back(solveb(i, z[i + 1]));\n        }\n        \n        i = z[i + 1];\n    }\n    \n    for (i = v.size() - 1; i >= 0; i--) {\n        if (v[i] + ans > ans) ans = v[i] + ans;\n    }\n    \n    printf(\"%s\\n\", ans.c_str());\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main() {\n\tint n; string s;\n\tcin >> n >> s;\n\tvector<int> a(n), b(n);\n\tint ca = 0, cb = 0;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tif (s[i] == 'a') a[ca++] = i;\n\t\tif (s[i] == 'b') b[cb++] = i;\n\t}\n\tstring ans;\n\tfor (int i = 0; i < 2 * n; ++i) {\n\t\tvector<int> st;\n\t\tfor (int j = 0; j < n; ++j) {\n\t\t\tif (b[j] >= i && a[j] > b[j]) {\n\t\t\t\tst.push_back(a[j]);\n\t\t\t\tst.push_back(b[j]);\n\t\t\t}\n\t\t}\n\t\tsort(st.begin(), st.end());\n\t\tstring sub;\n\t\tfor (int j : st) {\n\t\t\tsub += s[j];\n\t\t}\n\t\tint ptr = (st.empty() ? i : st.back() + 1);\n\t\tfor (int j = ptr; j < n; ++j) {\n\t\t\tif (a[j] >= ptr) {\n\t\t\t\tsub += \"ab\";\n\t\t\t\tptr = b[j] + 1;\n\t\t\t}\n\t\t}\n\t\tans = max(ans, sub);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nconst int MAX_N = 6e3 + 5;\n\nstring s;\nint posa [MAX_N];\nint posb [MAX_N];\nint idx [MAX_N];\nint dead [MAX_N];\nint dp [MAX_N];\n\nstring sol;\n\nstring sfr (int sta) {\n  string ans;\n\n  int bal = 0;\n  for (int i = sta; true; i++) {\n    if (!dead[i]) {\n      if (s[i] == 'b') {\n        bal++;\n        ans += 'b';\n      } else {\n        if (posb[idx[i]] >= sta) {\n          bal--;\n          ans += 'a';\n        }\n      }\n    }\n    \n    if (bal == 0) break;\n  }\n\n  return ans;\n}\n\nint process (int sta) {\n  string ans;\n\n  int bal = 0;\n  for (int i = sta; true; i++) {\n    if (!dead[i]) {\n      if (s[i] == 'b') {\n        bal++;\n        ans = max(ans, sfr(i));\n      } else {\n        bal--;\n      }\n    }\n    \n    if (bal == 0) {\n      sol += ans;\n      return i + 1;\n    }\n  }\n}\n\nint main () {\n  int n;\n  cin >> n;\n\n  cin >> s;\n\n  int ca = 0, cb = 0;\n  for (int i = 0; i < 2 * n; i++) {\n    if (s[i] == 'a') {\n      posa[ca] = i;\n      idx[i] = ca;\n      ca++;\n    } else {\n      posb[cb] = i;\n      idx[i] = cb;\n      cb++;\n    }\n  }\n\n  int m = 0; // the length of the first half\n  for (int i = 0; i < n; i++) {\n    if (posb[i] < posa[i]) {\n      m = max(m, posa[i] + 1);\n    }\n  }\n\n  for (int i = 0; i < n; i++) {\n    if (posa[i] < posb[i] && posb[i] < m) {\n      dead[posa[i]] = 1;\n      dead[posb[i]] = 1;\n    }\n  }\n\n  int curp = 0;\n  while (curp < m) {\n    curp = process(curp);\n  }\n\n  cout << sol;\n\n  // second half with dp\n  // number of independent pairs 'ab'\n  int sc = 0;\n  for (int i = m + 1; i < 2 * n; i++) {\n    if (s[i] == 'b') {\n      dp[i] = max(1 + dp[posa[idx[i]]], dp[i - 1]);\n    } else {\n      dp[i] = dp[i - 1];\n    }\n    sc = max(sc, dp[i]);\n  }\n\n  for (int i = 0; i < sc; i++) {\n    cout << \"ab\";\n  }\n  cout << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6010;\nint n,a[N],b[N],f[N],ans[N][N],top[N]; char s[N];\nstring tmp[N],dp[N],mx[N]; bool vis[N];\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    for(int i=1; i<=2*n; ++i)\n        if(s[i]=='a')a[++a[0]]=i;\n        else b[++b[0]]=i;\n    a[0]=b[0]=0;\n    bool flag=0;\n    for(int i=1; i<=n; ++i)\n        if(b[i]<a[i])flag=1;\n    if(!flag){\n        for(int i=1; i<=n; ++i)f[i]=1;\n        for(int i=1; i<=n; ++i)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i])f[i]=max(f[i],f[j]+1);\n        int ans=0;\n        for(int i=1; i<=n; ++i)ans=max(ans,f[i]);\n        for(int i=1; i<=ans; ++i)printf(\"ab\");\n        return 0;\n    }\n    for(int i=1; i<=n; ++i)if(b[i]<a[i]){\n        int t=a[i]; ans[i][top[i]=1]=i;\n        for(int j=i+1; j<=n; ++j){\n            if(b[j]>t)break;\n            if(b[j]<a[j]){\n                t=max(t,a[j]);\n                ans[i][++top[i]]=j;\n            }\n        }\n    }\n    for(int i=1; i<=n; ++i){\n        memset(vis,0,sizeof(vis));\n        for(int j=1; j<=top[i]; ++j)\n            vis[a[ans[i][j]]]=vis[b[ans[i][j]]]=1;\n        for(int j=1; j<=2*n; ++j)\n            if(vis[j])tmp[i]=tmp[i]+s[j];\n    }\n    for(int i=1,t=1; i<=n; ++i)if(b[i]<a[i]){\n        while(t<=n&&a[ans[t][top[t]]]<b[i])++t; --t;\n        dp[i]=mx[t]+tmp[i];\n        mx[i]=max(mx[i-1],dp[i]); ++t;\n    }else mx[i]=mx[i-1];\n    int pos=0;\n    for(int i=1; i<=n; ++i)\n        if(dp[i]==mx[n]){\n            pos=i; break;\n        }\n    int R=a[ans[pos][top[pos]]];\n    for(int i=1; i<=n; ++i)if(a[i]>R)f[i]=1;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>R)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i]&&a[j]>R)f[i]=max(f[i],f[j]+1);\n    int res=0;\n    for(int i=1; i<=n; ++i)res=max(res,f[i]);\n    cout << mx[n]; for(int i=1; i<=res; ++i)printf(\"ab\");\n    return 0;\n}\n/*\n11\nabbbaababaababbabaabaabb\n*/"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\nint c[6011];\nint begin0;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nstring best=\"\";\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin0=2*n;\n\tmemset(c,0,sizeof(c));\n\tint lab=2*n;\n\tint laa=2*n;\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin0 && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbegin0=a[i];\n\t\t\t\tlaa=begin0;\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(a[i]<lab)\n\t\t\t{\n\t\t\t\tif(best+ans>ans)\n\t\t\t\t{\n\t\t\t\t     ans=best+ans;\n\t\t\t    }\n\t\t\t\tlaa=lab;\n\t\t\t\tbest=\"\";\n\t\t\t}\n\t\t\t\n\t\t\tc[a[i]]=c[b[i]]=1;\n\t\t\ttmp=\"\";\n\t\t\tfor(j=b[i];j<laa;j++)\n\t\t\t{\n\t\t\t\tif(c[j]==1)\n\t\t\t\t{\n\t\t\t\t\ttmp+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(tmp>best)\n\t\t\t{\n\t\t\t\tbest=tmp;\n\t\t\t}\n\t\t\tlab=b[i];\n\t\t\t\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tif(best+ans>ans)\n\t{\n\t\tans=best+ans;\n\t}\n\t\n\tcout<<ans<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int MAX_N = 6080;\n\nint N, match[MAX_N];\nstring S, F[MAX_N];\n\nvoid init() {\n    cin >> N;\n    cin >> S;\n    queue<int> que;\n    for (int i = 0; i < 2 * N; i++) {\n        if (que.empty() || S[que.front()] == S[i]) que.push(i);\n        else {\n            int j = que.front(); que.pop();\n            match[j] = i; match[i] = j;\n        }\n    }\n}\n\nvoid solve() {\n    static bool sel[MAX_N];\n    for (int i = 2 * N - 1; i >= 0; i--) {\n        if (match[i] > i) {\n            if (S[i] == 'a') F[i] = \"ab\" + F[match[i] + 1];\n            else {\n                fill_n(sel, 2 * N, false);\n                int lvl = 0, j = i;\n                for (j = i; j < 2 * N && (j == i || lvl); j++) {\n                    if (S[j] == 'b') {\n                        lvl++;\n                        sel[match[j]] = true;\n                        F[i].push_back('b');\n                    } else if(sel[j]) {\n                        F[i].push_back('a');\n                        lvl--;\n                    }\n                }\n                F[i] += F[j];\n            }\n        }\n        F[i] = max(F[i], F[i + 1]);\n    }\n    cout << F[0] << endl;\n}\n\nint main() {\n    init();\n    solve();\n}\n"
  },
  {
    "language": "C++",
    "code": "//#pragma GCC optimize(\"Ofast,no-stack-protector\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx\")\n//#pragma GCC target(\"avx,tune=native\")\n#include<bits/stdc++.h>\n//#include<ext/pb_ds/assoc_container.hpp>\nusing namespace std;\n//using namespace __gnu_pbds;\nconst int inf=0x3f3f3f3f;\nconst double eps=1e-6;\nconst int mod=1000000007;\ntypedef long long ll;\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\ninline string getstr(string &s,int l,int r){string ret=\"\";for(int i=l;i<=r;i++)ret.push_back(s[i]);return ret;}\nint modpow(int x,int y,int md=mod){if(y==0)return 1;int ret=modpow(x,y>>1,md);ret=(ll)ret*ret%md;if(y&1)ret=(ll)ret*x%md;return ret;}\nint n;\nstring s;\nstring dp[3003];\nstring suf[3003];\nint pos[6003];\nvector<int>a,b;\nint main(){\n\tcin>>n>>s;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(s[i]=='a')pos[i]=a.size(),a.push_back(i);\n\t\telse pos[i]=b.size(),b.push_back(i);\n\t}\n\tdp[n]=\"\";\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(a[i]<b[i]){\n\t\t\t//ab\n\t\t\tint mx=-inf;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tmx=max(mx,pos[j]);\n\t\t\t}\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[mx+1]);\n\t\t}else{\n\t\t\t//ba\n\t\t\tint tmp=i;\n\t\t\twhile(tmp<n-1&&b[tmp+1]<a[tmp])tmp++;\n\t\t\tfor(int j=b[i];j<s.size();j++)if(i<=pos[j]&&pos[j]<=tmp)dp[i].push_back(s[j]);\n\t\t\tdp[i]+=dp[tmp+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<*max_element(dp,dp+n)<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 'a'];\n    }\n    for (int i = n; i >= 1; --i) {\n        dp[i] = dp[i + 1];\n        string cur;\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            cur = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    cur += s[j];\n                }\n            }\n            cur += dp[to + 1];\n        }\n        dp[i] = max(dp[i], cur);\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 'a'];\n    }\n    for (int i = n; i >= 1; --i) {\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <cassert>\n#include <random>\n#include <iomanip>\n#define FOR(i, n, m) for(ll i = n; i < (int)m; i++)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll, ll>;\nconstexpr ll inf = 1000000000;\nconstexpr ll mod = 1000000007;\nconstexpr long double eps = 1e-15;\n \ntemplate<typename T1, typename T2>\nostream& operator<<(ostream& os, pair<T1, T2> p) {\n    os << to_string(p.first) << \" \" << to_string(p.second);\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& v) {\n    REP(i, v.size()) {\n        if(i) os << \" \";\n        os << to_string(v[i]);\n    }\n    return os;\n}\n \nstruct modint {\n    ll n;\npublic:\n    modint(const ll n = 0) : n((n % mod + mod) % mod) {}\n    static modint pow(modint a, int m) {\n        modint r = 1;\n        while(m > 0) {\n            if(m & 1) { r *= a; }\n            a = (a * a); m /= 2;\n        }\n        return r;\n    }\n    modint &operator++() { *this += 1; return *this; }\n    modint &operator--() { *this -= 1; return *this; }\n    modint operator++(int) { modint ret = *this; *this += 1; return ret; }\n    modint operator--(int) { modint ret = *this; *this -= 1; return ret; }\n    modint operator~() const { return (this -> pow(n, mod - 2)); } // inverse\n    friend bool operator==(const modint& lhs, const modint& rhs) {\n        return lhs.n == rhs.n;\n    }\n    friend bool operator<(const modint& lhs, const modint& rhs) {\n        return lhs.n < rhs.n;\n    }\n    friend bool operator>(const modint& lhs, const modint& rhs) {\n        return lhs.n > rhs.n;\n    }\n    friend modint &operator+=(modint& lhs, const modint& rhs) {\n        lhs.n += rhs.n;\n        if (lhs.n >= mod) lhs.n -= mod;\n        return lhs;\n    }\n    friend modint &operator-=(modint& lhs, const modint& rhs) {\n        lhs.n -= rhs.n;\n        if (lhs.n < 0) lhs.n += mod;\n        return lhs;\n    }\n    friend modint &operator*=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * rhs.n) % mod;\n        return lhs;\n    }\n    friend modint &operator/=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * (~rhs).n) % mod;\n        return lhs;\n    }\n    friend modint operator+(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n + rhs.n);\n    }\n    friend modint operator-(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n - rhs.n);\n    }\n    friend modint operator*(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * rhs.n);\n    }\n    friend modint operator/(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * (~rhs).n);\n    }\n};\nistream& operator>>(istream& is, modint m) { is >> m.n; return is; }\nostream& operator<<(ostream& os, modint m) { os << m.n; return os; }\n \n#define MAX_N 3030303\nlong long extgcd(long long a, long long b, long long& x, long long& y) {\n    long long d = a;\n    if (b != 0) {\n        d = extgcd(b, a % b, y, x);\n        y -= (a / b) * x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nlong long mod_inverse(long long a, long long m) {\n    long long x, y;\n    if(extgcd(a, m, x, y) == 1) return (m + x % m) % m;\n    else return -1;\n}\nvector<long long> fact(MAX_N+1, inf);\nlong long mod_fact(long long n, long long& e) {\n    if(fact[0] == inf) {\n        fact[0]=1;\n        if(MAX_N != 0) fact[1]=1;\n        for(ll i = 2; i <= MAX_N; ++i) {\n            fact[i] = (fact[i-1] * i) % mod;\n        }\n    }\n    e = 0;\n    if(n == 0) return 1;\n    long long res = mod_fact(n / mod, e);\n    e += n / mod;\n    if((n / mod) % 2 != 0) return (res * (mod - fact[n % mod])) % mod;\n    return (res * fact[n % mod]) % mod;\n}\n// return nCk\nlong long mod_comb(long long n, long long k) {\n    if(n < 0 || k < 0 || n < k) return 0;\n    long long e1, e2, e3;\n    long long a1 = mod_fact(n, e1), a2 = mod_fact(k, e2), a3 = mod_fact(n - k, e3);\n    if(e1 > e2 + e3) return 0;\n    return (a1 * mod_inverse((a2 * a3) % mod, mod)) % mod;\n}\n \nusing mi = modint;\n \nmi mod_pow(mi a, ll n) {\n    mi ret = 1;\n    mi tmp = a;\n    while(n > 0) {\n        if(n % 2) ret *= tmp;\n        tmp = tmp * tmp;\n        n /= 2;\n    }\n    return ret;\n}\n \nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n \nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<pair<int, int>> idx(n);\n    vector<int> v(2 * n, -1);\n    int ca = 0, cb = 0;\n    REP(i, 2 * n) {\n        if(s[i] == 'a') {\n            idx[ca].first = i;\n            v[i] = ca;\n            ca++;\n        } else {\n            idx[cb].second = i;\n            v[i] = cb;\n            cb++;\n        }\n    }\n    vector<string> mx(n, \"\");\n    for(int i = n - 1; i >= 0; i--) {\n        if(idx[i].first < idx[i].second) {\n            mx[i] = \"ab\";\n            int tmp = i;\n            for(int j = idx[i].first; j < idx[i].second; j++) if(s[j] == 'a') tmp++;\n            if(tmp + 1 < n) mx[i] += mx[tmp + 1];\n        } else {\n            int tmp = i;\n            for(int j = idx[i].second; j < 2 * n; j++) {\n                if(s[j] == 'b') {\n                    mx[i] += 'b';\n                    tmp = v[j];\n                } else {\n                    if(v[j] < i) continue;\n                    if(v[j] > tmp) {\n                        mx[i] += mx[v[j]];\n                        break;\n                    } else mx[i] += 'a';\n                }\n            }\n        }\n        if(i < n - 1) mx[i] = max(mx[i], mx[i + 1]);\n    }\n    string ans = mx[0];\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\n                     .:*+=%@@@@@@=-.\n                 .:=@#@@@#@@#######%==*.\n              .-=####@######%*-.....:%##%.\n            .*@###########%+:--........-%@-\n          .*@##############@+--.........-:%-\n        .+##################@==%%%%=+*:----+.\n      .-@####################%++%@@@@@=+**%@@*\n      .%###################@%%@@@###@%+:--%@@%.\n     -@###################@%%%%*::*%++:-----=@+.\n    -#####################@%=++++++*:-------.-=:\n   .+####################@%++*::-:::--::*:::***=:\n   .@#####################%=++*::::-:::++*=##@@#@-\n  ..#####################@%%=++**:::::**+%@#@%%##-..\n   .%####################@@%=+++*+****::*=@######@.\n  .=######################@%%==+==++**+=@%@##@###+:...\n  -#######################@@@%%%===++=@@@%=++===*::--...\n  -########################@@@@@@@%==%%=++==@@:::::*:--.\n..:#########################@@@@@@%%======++++::-..:-.--...\n%#############################@###@%%@@%==%=%*----.--.::---.\n#############################################*-:*:-:---*---- .\n#############################################*--*--:---*---:-.\n#############################################+--::--::-*::-::.\n###########################################+:*-.---.---.:---*-..\n###########################################**:-----------------.\n##########################################@::**:--::::::--:::::-\n###########################################:--:*:::::::::**::*+*\n###########################################=:::***::::::**:::*+*\n############################@@@@@@#########@+****::::********+++\n############################@%%%%%@@@@@@@###%+***::::::::***+==+\n############################@%%%%%%%%%%%@####=+:::-::::-::*+=%%+\n#############################@%%%%%%%%%%@#####=::--------:*=%@%+\n%###########################@%%%%==%%%%%%@##@#=:------..-:+%@@%=\n----------------------------------------------\n--------------------------------------------\n----------------------------------------------\n--------------------------------------------\n----------------------------------------------\n\n         o###########oo\n      o##\"          \"\"##o\n    o#\"                \"##\n  o#\"                    \"#o\n #\"  ##              ##   \"##\n#\"                          ##\n#  ###################       #\n#                            #\n#                            #\n#                            #\n#                            #\n#                            #\n#                            #\n#o                           #\n\"#o                         ##\n \"#o                       ##\n  \"#o                    o#\"\n   \"#o                  ##\n     \"#o              o#\"\n       \"#ooo      ooo#######oo\n        ###############   \"######o\n     o###\"\"        \"###o      # ###\n   o###o     oooo    ###    oo####\"\n o###**#     #**#   ############\"\n \"\"##\"\"\"\"\"\"\"\"\"\"###########    #\n    # oooooooo#\"#**     ##    #\n    # #       # # **    ##    #\n    #o#       #o#  *****###ooo#\n                        ##\n                        ##   o###o\n                        ## o##***##\n               o########## #***#**##o\n             o##\"   \"\"###  #***##***#\n o#######o  ###   oo####   ##**####*#\no##\"  \"\"#############\"\"     ##****###\n##\"         ##              ##*##*###\n##          ###              ##### ##\n##           ###              # ##  #\n##            ##                 #\n##             ##\n##             ###\n##              ###oo\n###              \"\"###\n ###\n  ###\n*/\n\n///YEAH IM THE BEST I'VE EVER WAS\n\n///SO HAPPY\n\n#include <bits/stdc++.h>\n\n//#pragma GCC optimize(\"O3\")\n//#pragma GCC optimize(\"Ofast,no-stack-protector\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx\")\n//#pragma GCC target(\"avx,tune=native\")\n//float __attribute__((aligned(32)))\n\n/*char memory[(int)1e8];\n\nchar memorypos;\n\ninline void * operator new(size_t n){\n    char * ret = memory + memorypos;\n    memorypos += n;\n    return (void *)ret;\n}\n\ninline void operator delete(void *){}\n*/\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef unsigned long long ull;\n\ntypedef long double ld;\n\ntypedef unsigned int uint;\n\nll sqr(ll x){\n    return x * x;\n}\n\nint mysqrt(ll x){\n    int l = 0, r = 1e9 + 1;\n    while (r - l > 1){\n        int m = (l + r) / 2;\n        if (m * (ll)m <= x)\n            l = m;\n        else\n            r = m;\n    }\n    return l;\n}\n\nmt19937 rnd(1227);\n\nmt19937_64 rndll(12365);\n\nll AR = 19, BR = 13, CR = 23, XR = 228, YR = 322, MODR = 1e9 + 993;\n\nll myrand(){\n    ll ZR = (XR * AR + YR * BR + CR) % MODR;\n    XR = YR;\n    YR = ZR;\n    return ZR;\n}\n\nconst int Mod = 1e9 + 7;\n\nint Bpow(int x, int y){\n    if (y == 0)\n        return 1;\n    if (y == 1)\n        return x;\n    int ret = Bpow(x, y >> 1);\n    ret = (ret * (ll)ret) % Mod;\n    if (y & 1)\n        ret = (ret * (ll)x) % Mod;\n    return ret;\n}\n\nint Bdiv(int x, int y){\n    return (x * (ll)Bpow(y, Mod - 2)) % Mod;\n}\n\nvoid setmin(int &x, int y){\n    x = min(x, y);\n}\n\nvoid setmax(int &x, int y){\n    x = max(x, y);\n}\n\nvoid setmin(ll &x, ll y){\n    x = min(x, y);\n}\n\nvoid setmax(ll &x, ll y){\n    x = max(x, y);\n}\n\nint gcd(int a, int b){\n    return a ? gcd(b % a, a) : b;\n}\n\nconst ll llinf = 2e18 + 100;\n\nconst double eps = 1e-9;\n\nconst int maxn = 6e3 + 5, maxw = 1e6 + 10, inf = 1e9 + 100, sq = 300, mod = 1e9 + 7, LG = 17;\n\nint n;\n\nint arr[maxn];\n\nint mas[maxn];\n\nint pos[maxn];\n\nbitset<maxn> q[maxn];\n\nint sz[maxn];\n\nbitset<maxn> ans[maxn];\n\nint asz[maxn];\n\nint max(bitset<maxn> x, bitset<maxn> y, int szx, int szy){\n    for (int j = 0; j < min(szx, szy); j++)\n    if (x[j] != y[j])\n        return y[j];\n    return szx < szy;\n}\n\nint cnt;\n\nbool good[maxn];\n\nint main()\n{\n    #ifdef ONPC\n    //ifstream cin(\"a.in\");\n    //ofstream cout(\"a.out\");\n    freopen(\"a.in\", \"r\", stdin);\n    freopen(\"a.out\", \"w\", stdout);\n    #else\n    //ifstream cin(\"gymnasts.in\");\n    //ofstream cout(\"gymnasts.out\");\n    //freopen(\"sort.in\", \"r\", stdin);\n    //freopen(\"sort.out\", \"w\", stdout);\n    #endif // ONPC\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n    cout.tie(0);\n    cin >> n;\n    n *= 2;\n    for (int i = 0; i < n; i++){\n        char c;\n        cin >> c;\n        arr[i] = c - 'a';\n    }\n    for (int i = 0; i < n; i++)\n    if (arr[i] == 0)\n        mas[cnt++] = i;\n    cnt = 0;\n    for (int i = 0; i < n; i++)\n    if (arr[i] == 1)\n        pos[i] = mas[cnt], pos[mas[cnt]] = i, cnt++;\n    for (int i = n - 1; i >= 0; i--){\n        ans[i] = ans[i + 1];\n        asz[i] = asz[i + 1];\n        if (pos[i] < i)\n            continue;\n        if (arr[i] == 0){\n            q[i][0] = 0;\n            q[i][1] = 1;\n            int last = pos[i];\n            for (int j = 0; j < asz[last + 1]; j++)\n                q[i][j + 2] = ans[last + 1][j];\n            sz[i] = asz[last + 1] + 2;\n        }\n        else{\n            memset(good, 0, sizeof(good));\n            int last = i;\n            for (int j = i; j <= last; j++)\n            if (arr[j] == 0){\n                if (good[j])\n                    q[i][sz[i]++] = 0;\n            }\n            else{\n                good[pos[j]] = 1;\n                q[i][sz[i]++] = 1;\n                last = pos[j];\n            }\n            for (int j = 0; j < asz[last + 1]; j++)\n                q[i][j + sz[i]] = ans[last + 1][j];\n            sz[i] += asz[last + 1];\n        }\n        if (max(q[i], ans[i], sz[i], asz[i]) == 0)\n            ans[i] = q[i], asz[i] = sz[i];\n    }\n    for (int i = 0; i < asz[0]; i++)\n    if (ans[0][i] == 0)\n        cout << 'a';\n    else\n        cout << 'b';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\t\t{\n\t\t\t\tint til = 0;\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\ttil = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvector<bool> nex = dfs(til + 1);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\t\tauto nex = dfs(j3);\n\t\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first < pos[b].second){\n\t\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\t\tdp[b] = nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\t//a     b\n\t\t\t{\n\t\t\t\tvector<bool> ne(2 * n, false);\n\t\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\t\tint maxt = pos[b].first;\n\t\t\t\tfor (int j = b + 1; j < n; j++){\n\t\t\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\t\tdp[b] = ne;\n\t\t\t\t}\n\t\t\t}\n\t\t{\n\t\t\tauto ne = vector<bool>(2 * n, false);\n\t\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\t\tauto k2 = dfs(b + 1);\n\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t}\n\t\t\tif (cmp(ne, dp[b])){\n\t\t\t\tdp[b] = ne;\n\t\t\t}\n\t\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <limits>\n#include <ctime>\n#include <cassert>\n#include <map>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <iterator>\n#include <bitset>\n#include <unordered_map>\n#include <unordered_set>\n\nusing namespace std;\n#define FOR(i,n) for(int i = 0; i < (n); i++)\n#define sz(c) ((int)c.size())\n#define ten(n) ((int)1e##n)\nusing ll = long long;\nusing Pii = pair<int, int>;\nusing Pll = pair<ll, ll>;\n\ntemplate<typename ...> static inline int getchar_unlocked(void) { return getchar(); }\ntemplate<typename ...> static inline void putchar_unlocked(int c) { putchar(c); }\n#define mygc(c) (c)=getchar_unlocked()\n#define mypc(c) putchar_unlocked(c)\nvoid reader(int& x) { int k, m = 0; x = 0; for (;;) { mygc(k); if (k == '-') { m = 1; break; }if ('0' <= k&&k <= '9') { x = k - '0'; break; } }for (;;) { mygc(k); if (k<'0' || k>'9')break; x = x * 10 + k - '0'; }if (m) x = -x; }\nvoid reader(ll& x) { int k, m = 0; x = 0; for (;;) { mygc(k); if (k == '-') { m = 1; break; }if ('0' <= k&&k <= '9') { x = k - '0'; break; } }for (;;) { mygc(k); if (k<'0' || k>'9')break; x = x * 10 + k - '0'; }if (m) x = -x; }\nint reader(char c[]) { int i, s = 0; for (;;) { mygc(i); if (i != ' '&&i != '\\n'&&i != '\\r'&&i != '\\t'&&i != EOF) break; }c[s++] = i; for (;;) { mygc(i); if (i == ' ' || i == '\\n' || i == '\\r' || i == '\\t' || i == EOF) break; c[s++] = i; }c[s] = '\\0'; return s; }\nint reader(string& c) { int i; for (;;) { mygc(i); if (i != ' '&&i != '\\n'&&i != '\\r'&&i != '\\t'&&i != EOF) break; }c.push_back(i); for (;;) { mygc(i); if (i == ' ' || i == '\\n' || i == '\\r' || i == '\\t' || i == EOF) break; c.push_back(i); }; return sz(c); }\ntemplate <class T, class S> void reader(T& x, S& y) { reader(x); reader(y); }\ntemplate <class T, class S, class U> void reader(T& x, S& y, U& z) { reader(x); reader(y); reader(z); }\ntemplate <class T, class S, class U, class V> void reader(T& x, S& y, U& z, V & w) { reader(x); reader(y); reader(z); reader(w); }\nvoid writer(int x, char c) { int s = 0, m = 0; char f[10]; if (x<0)m = 1, x = -x; while (x)f[s++] = x % 10, x /= 10; if (!s)f[s++] = 0; if (m)mypc('-'); while (s--)mypc(f[s] + '0'); mypc(c); }\nvoid writer(ll x, char c) { int s = 0, m = 0; char f[20]; if (x<0)m = 1, x = -x; while (x)f[s++] = x % 10, x /= 10; if (!s)f[s++] = 0; if (m)mypc('-'); while (s--)mypc(f[s] + '0'); mypc(c); }\nvoid writer(const char c[]) { int i; for (i = 0; c[i] != '\\0'; i++)mypc(c[i]); }\nvoid writer(const string& x, char c) { int i; for (i = 0; x[i] != '\\0'; i++)mypc(x[i]); mypc(c); }\nvoid writer(const char x[], char c) { int i; for (i = 0; x[i] != '\\0'; i++)mypc(x[i]); mypc(c); }\ntemplate<class T> void writerLn(T x) { writer(x, '\\n'); }\ntemplate<class T, class S> void writerLn(T x, S y) { writer(x, ' '); writer(y, '\\n'); }\ntemplate<class T, class S, class U> void writerLn(T x, S y, U z) { writer(x, ' '); writer(y, ' '); writer(z, '\\n'); }\ntemplate<class T, class S, class U, class V> void writerLn(T x, S y, U z, V v) { writer(x, ' '); writer(y, ' '); writer(z, ' '); writer(v, '\\n'); }\ntemplate<class T> void writerArr(T x[], int n) { if (!n) { mypc('\\n'); return; }FOR(i, n - 1)writer(x[i], ' '); writer(x[n - 1], '\\n'); }\ntemplate<class T> void writerArr(vector<T>& x) { writerArr(x.data(), (int)x.size()); }\n\ntemplate<class T> void chmin(T& a, const T& b) { if (a > b) a = b; }\ntemplate<class T> void chmax(T& a, const T& b) { if (a < b) a = b; }\n\ntemplate<class T> T gcd(T a, T b) { return b ? gcd(b, a % b) : a; }\ntemplate<class T> T lcm(T a, T b) { return a / gcd(a, b) * b; }\nll mod_pow(ll a, ll n, ll mod) {\n\tll ret = 1;\n\tll p = a % mod;\n\twhile (n) {\n\t\tif (n & 1) ret = ret * p % mod;\n\t\tp = p * p % mod;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\ntemplate<class T> T extgcd(T a, T b, T& x, T& y) { for (T u = y = 1, v = x = 0; a;) { T q = b / a; swap(x -= q * u, u); swap(y -= q * v, v); swap(b -= q * a, a); } return b; }\nll mod_inv(ll a, ll m) { ll x, y; extgcd<ll>(a, m, x, y); return (m + x % m) % m; }\n\nvector<int> fidx(string s) {\n\tconst int n = sz(s);\n\tvector<int> idx;\n\tint ac = 0, bc = 0;\n\tFOR(i, n) {\n\t\tif (s[i] == 'a') {\n\t\t\tidx.push_back(ac++);\n\t\t} else {\n\t\t\tidx.push_back(bc++);\n\t\t}\n\t}\n\n\treturn idx;\n}\n\nstring naive(string s) {\n\tstring ret;\n\tconst int n = sz(s);\n\tvector<int> idx = fidx(s);\n\n\tstring ans;\n\tint binary = -1;\n\tFOR(F, (1 << (n - 1))) {\n\t\tstring cur;\n\t\tFOR(i, n) {\n\t\t\tif ((1 << idx[i]) & F) {\n\t\t\t\tcur.push_back(s[i]);\n\t\t\t}\n\t\t}\n\t\tif (ans < cur) {\n\t\t\tbinary = F;\n\t\t\tans = cur;\n\t\t}\n\t}\n\treturn ans;\n\n}\n\n\nstring solvePlus(string s) {\n\tvector<int> idx = fidx(s);\n\tstring ret = \"ba\";\n\tFOR(i, sz(s) / 2) {\n\t\tstring cur;\n\t\tFOR(j, sz(s)) {\n\t\t\tif (idx[j] >= i)  cur.push_back(s[j]);\n\t\t}\n\t\tif (ret < cur) {\n\t\t\tret = cur;\n\t\t}\n\t}\n\n\treturn ret;\n}\n\nstring solveMinus(string s) {\n\tvector<int> idx = fidx(s);\n\tstring ret;\n\tFOR(i, sz(s)) {\n\t\twhile (i < sz(s) && s[i] != 'a') i++;\n\t\tif (i == sz(s)) break;\n\t\tret.push_back(s[i]);\n\t\tint cidx = idx[i];\n\t\ti++;\n\t\twhile (idx[i] != cidx) i++;\n\t\tret.push_back(s[i]);\n\t}\n\n\treturn ret;\n}\n\nstring solve(string s) {\n\tvector<string> vs;\n\tint cnt = 0;\n\tFOR(i, sz(s)) {\n\t\tif (cnt == 0) {\n\t\t\tvs.emplace_back();\n\t\t}\n\t\tif (s[i] == 'a') {\n\t\t\tcnt--;\n\t\t}\n\t\tif (s[i] == 'b') {\n\t\t\tcnt++;\n\t\t}\n\t\tvs.back().push_back(s[i]);\n\t}\n\n\tvector<string> vs2;\n\tFOR(i, sz(vs)) {\n\t\tbool strong = vs[i][0] == 'b';\n\t\twhile (sz(vs2) && vs2.back()[0] == 'a' && strong) {\n\t\t\tvs2.pop_back();\n\t\t}\n\t\tvs2.push_back(vs[i]);\n\t}\n\n\tvector<string> vs3;\n\tstring suffix;\n\tfor (auto s : vs2) {\n\t\tstring cur;\n\t\tif (s[0] == 'a') {\n\t\t\tcur = solveMinus(s);\n\t\t\tsuffix += cur;\n\t\t} else {\n\t\t\tcur = solvePlus(s);\n\t\t\twhile (sz(vs3) && vs3.back() < cur) {\n\t\t\t\tvs3.pop_back();\n\t\t\t}\n\t\t\tvs3.push_back(cur);\n\t\t}\n\t}\n\n\tstring ans;\n\tfor (auto s : vs3) ans += s;\n\n\treturn ans + suffix;\n}\n\nvoid test() {\n\tint n = 16;\n\tstring cur;\n\tFOR(i, n / 2) cur.push_back('a');\n\tFOR(i, n / 2) cur.push_back('b');\n\tdo {\n\t\tstring a1 = naive(cur);\n\t\tstring a2 = solve(cur);\n\t\tif (a1 != a2) {\n\t\t\tcout << \"?\";\n\t\t}\n\t}\n\twhile (next_permutation(cur.begin(), cur.end()));\n}\n\nint main() {\n\t// test();\n\n\tint n; reader(n);\n\tstring s; reader(s);\n\n\tcout << solve(s) << endl;\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nchar s[6010];\nbasic_string <char> ans[6010];\nint q[6010], head, tail, n;\nbasic_string <int> a, b;\nint pos[6010], choose[6010];\nint main() {\n    scanf(\"%d%s\", &n, s + 1);\n    n <<= 1;\n    for (int i = 1; i <= n; i++) (s[i] == 'a' ? a : b).push_back(i);\n    for (int i = 0; i < n / 2; i++) pos[a[i]] = b[i], pos[b[i]] = a[i];\n    int cnt = 0, nxt = n + 1;\n    for (int i = n; i > 0; i--) {\n        cnt += s[i] == 'a' ? 1 : -1;\n        if (cnt) continue;\n        ans[i] = ans[nxt];\n        memset(choose, 0, sizeof choose);\n        head = 1, tail = 0;\n        for (int j = i; j < nxt; j++) {\n            if (s[j] == 'a') {\n                if (choose[j]) {\n                    basic_string <char> now = \"\";\n                    for (int k = i; k < nxt; k++) {\n                        if(s[k] == 'a' && (choose[k] || k > pos[q[tail]])) now += \"a\";\n                        if(s[k] == 'b' && (choose[k] || k > j)) now += \"b\";\n                    }\n                    // cerr << now << endl;\n                    ans[i] = max(ans[i], now + ans[nxt]);\n                    head++;\n                    choose[j] = choose[pos[j]] = 0;\n                }\n                continue;\n            }\n            if(pos[j] < j) continue;\n            q[++tail] = j, choose[j] = choose[pos[j]] = 1;\n        }\n        if (tail == 0) {\n            memset(choose, 0, sizeof choose);\n            for (int j = i; j < nxt; j++) {\n                if (s[j] == 'a') {\n                    choose[j] = choose[pos[j]] = 1;\n                    basic_string <char> now = \"\";\n                    for (int k = i; k <= pos[j]; k++) if(choose[k]) now += s[k];\n                    ans[i] = max(ans[i], now + ans[nxt]);\n                    j = pos[j];\n                }\n            }\n        }\n        nxt = i;\n    }\n    return cout << ans[1] << endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=4e3+5;\nstring dp[maxn<<1];\nchar s[maxn<<1];\nint a[maxn],b[maxn],n,A,B,t[maxn<<1],p,fi[maxn<<1];\nint cnt,group[maxn<<1];\nstring ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=2*n;i++){\n\t\tif (s[i]=='a'){\n\t\t\ta[++A]=i;\n\t\t\tt[i]=A;\n\t\t\tcnt++;\n\t\t}else{\n\t\t\tb[++B]=i;\n\t\t\tt[i]=B;\n\t\t\tcnt--;\n\t\t}\n\t\tgroup[i]=p;\n\t\tif (cnt==0)\n\t\t\tfi[++p]=i+1;\n\t}\n\tfi[++p]=n*2+1;\n\tfor (int i=2*n;i>=1;i--){\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi != i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tstring S=\"\";\n\t\t\tfor (int j = i;group[j] == group[i];j++){\n\t\t\t\tif (b[t[j]] >= i)\n\t\t\t\t\tS+=s[j];\n\t\t\t}\n\t\t\tS+=dp[fi[group[i]+1]];\n\t\t\tdp[i]=max(S,ans);\n\t\t}else{\n\t\t\tdp[i]=max(\"ab\"+dp[b[t[i]]+1],ans);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout << ans ;\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nbool compare(string s1, string s2){\n    int l1 = s1.length();\n    int l2 = s2.length();\n    for(int i=0; i<min(l1,l2); i++){\n        if(s1[i] -'a' > s2[i]-'a')\n            return true;\n        else if(s1[i] -'a' < s2[i] -'a')\n            return false;\n    }\n    if(l1 >= l2)\n        return true;\n    else\n        return false;\n}\n\nstring solve(string s){\n    int l = s.length();\n    int n = l/2;\n    int a[n],b[n];\n    int acount = 0, bcount = 0;\n    for(int i=0; i<l; i++){\n        if(s[i] =='a'){\n            a[acount] = i;\n            acount++;\n        }\n        else{\n            b[bcount] = i;\n            bcount++;\n        }\n    }\n    vector<string> all;\n    for(int i=0; i<n; i++){\n        string t = \"\";\n        for(int j=b[i]; j<a[i]; j++){\n            if(s[j] =='b')\n                t+=\"b\";\n        }\n        t += s.substr(a[i], l - a[i]);\n        all.push_back(t);\n    }\n    string ans = all[0];\n    for(int i=0; i<n; i++){\n        if(!compare(ans,all[i]))\n            ans = all[i];\n    }\n    return ans;\n}\n\n\nint main()\n{\n\n    int N;\n    string S;\n    cin>>N;\n    cin>>S;\n    vector<pair<int,int> > segments;\n    int partials = 0;\n    int prev = 0;\n    bool check = false;\n    for(int i=0; i<2*N; i++){\n        if(S[i] == 'a')\n            partials++;\n        else\n            partials--;\n        if(partials == 0){\n            if(S[i] == 'a'){\n                segments.push_back(make_pair(prev, i));\n                check = true;\n            }\n            prev = i+1;\n        }\n    }\n\n\n\n    int l = segments.size();\n    vector<string> subanswers;\n    for(int i=0; i<l; i++){\n        subanswers.push_back(solve(S.substr(segments[i].first, segments[i].second - segments[i].first + 1)));\n    }\n\n\n    if(check){\n        string output = \"\";\n        for(int i=0; i<l; i++){\n            bool use = true;\n            string s1 = subanswers[i];\n            for(int j=i; j<l; j++){\n                string s2 = subanswers[j];\n                if(!compare(s1,s2))\n                    use = false;\n\n            }\n            if(use){\n                output += s1;\n            }\n\n\n        }\n        cout<<output;\n        int last = segments[l-1].second;\n        int acount =0;\n        int bcount = 0;\n        int current = 0;\n        int repeats = 0;\n        for(int i= last +1; i<2*N ; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    acount++;\n                    current = acount;\n                    repeats += 1;\n                }\n                else\n                    bcount++;\n            }\n            else{\n                if(S[i]=='b'){\n                    bcount++;\n                    if(bcount ==current)\n                        current = 0;\n                }\n                else\n                    acount++;\n            }\n\n        }\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n    else{\n        int acount =0;\n        int bcount = 0;\n        int current = 0;\n        int repeats = 0;\n        for(int i= 0; i<2*N ; i++){\n            if(current==0){\n                if(S[i]=='a'){\n                    acount++;\n                    current = acount;\n                    repeats += 1;\n                }\n                else\n                    bcount++;\n            }\n            else{\n                if(S[i]=='b'){\n                    bcount++;\n                    if(bcount ==current)\n                        current = 0;\n                }\n                else\n                    acount++;\n            }\n\n        }\n\n        for(int i=0; i<repeats; i++){\n            cout<<\"ab\";\n        }\n        cout<<endl;\n\n    }\n\n\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//                             In The Name Of Allah                                           \n#include <bits/stdc++.h>\n#define\tss second\n#define ff first\n#define use_fast ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)\n#define se(n) cout << setprecision(n) << fixed\n#define pb push_back\n#define ll long long\n#define int long long\n#define ld long double\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops\")\n#pragma GCC optimize(\"no-stack-protector,fast-math\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\nusing namespace std; \n\nconst int N = 1e5 + 100, OO = 1e9 + 7, K = 3e5 + 100, T = 5, M = 1e9 + 7, P = 6151, SQ = 450, lg = 20;\ntypedef pair <int, int> pii;\nint p[N], it[N], pw[N], hs[N], en[N], n;\nstring s, st, ans[N];\nint mark[N];\n\nint get(int r, int l) {\n\tif(r < l)\n\t\treturn 0;\n\tint cnt = (hs[r] - (hs[l - 1] * pw[r - l + 1] % M) + M) % M;\n\treturn cnt;\n}\n\nbool cmp(int x, int y) {\n\tint l = 0, r = min(en[x] - x, en[y] - y) + 1;\n//\tcout << x << \" \" << y << \" BEGIN\" << endl;\n\twhile(l < r) {\n\t\tint mid = (l + r) >> 1;\n//\t\tcout << mid << \" \" << x + mid - 1 << \" \" << y + mid - 1 << \" \" << get(x + mid - 1, x) << \" \" << get(y + mid - 1, y) << endl;\n\t\tif(get(x + mid - 1, x) == get(y + mid - 1, y))\n\t\t\tl = mid + 1;\n\t\telse\n\t\t\tr = mid;\n\t}\n\tif(l == min(en[x] - x, en[y] - y) + 1)\n\t\treturn x < y;\n\treturn s[x + l - 1] < s[y + l - 1];\n}\n\nvoid solve(int x) {\n\tint mx = 0;\n\tfor(int i = 1; i < x; i++) \n\t\tmx = max(mx, mark[i]);\n\tif(mark[x] <= mx)\n\t\treturn;\n//\tcout << x << \" \" << mx << \" \" << mark[x] << endl;\n\tif(s[x - 1] == 'a') {\n\t\tans[x] = \"ab\";\n\t\tfor(int i = x + 1; i <= n; i++) {\n\t\t\tif(mark[i] == mark[x]) {\n\t\t\t\tans[x] += ans[i + 1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tint cnt = 1;\n\t\tans[x] = \"b\";\n\t\tfor(int i = x + 1; i <= n; i++) {\n\t\t//\tcout << x << \" \" << i << \" ** \" << mark[i] << endl;\n\t\t\tif(mark[i] <= mx)\n\t\t\t\tcontinue;\n\t\t//\tcout << x << \" \" << i << \" \" << s[i - 1] << endl;\n\t\t\tans[x] += s[i - 1];\n\t\t\tif(s[i - 1] == 'a')\n\t\t\t\tcnt--;\n\t\t\telse\n\t\t\t\tcnt++;\n\t\t\tif(cnt == 0) {\n\t\t//\t\tcout << x << \" \" << ans[x] << endl;\n\t\t\t\tans[x] += ans[i + 1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint32_t main() {\n\tuse_fast;\n\tcin >> n >> s;\n\tn *= 2;\n\tint a0 = 0, a1 = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tif(s[i - 1] == 'a')\n\t\t\ta0++, mark[i] = a0;\n\t\telse\n\t\t\ta1++, mark[i] = a1;\n//\t\tcout << i << \" \" << mark[i] << endl;\n\t}\n\tfor(int i = n; i; i--) {\n\t\tsolve(i), ans[i] = max(ans[i], ans[i + 1]);\n//\t\tcout << i << \" \" << ans[i] << endl;\n\t}\n\tcout << ans[1] << endl;\n\treturn 0;\n\tvector <int> v, t;\n\tpw[0] = 1;\n\tfor(int i = 1; i <= n; i++) {\n\t\tp[i] = p[i - 1] + (s[i - 1] == 'a') - (s[i - 1] == 'b');\n\t\ths[i] = (hs[i - 1] * P + (int)(s[i - 1] - 'a' + 1)) % M;\n\t\tpw[i] = (pw[i - 1] * P) % M;\n\t\tif(p[i - 1] == 0)\n\t\t\tv.pb(i);\n\t}\n\tv.pb(n + 1);\n\tfor(int i = 0; i < (int)v.size() - 1; i++) \n\t\tif(s[v[i] - 1] == 'b')\n\t\t\tt.pb(v[i]), en[v[i]] = v[i + 1];\n\tsort(t.begin(), t.end(), cmp);\n\tint pre = 0;\n\tstring ans = \"\";\n\tfor(auto u : t) {\n\t\tif(u <= pre)\n\t\t\tcontinue;\n\t\tfor(int i = u; i < en[u]; i++)\n\t\t\tans += s[i - 1];\n\t\tpre = en[u] - 1;\n\t}\n\tint n0 = 0, n1 = 0;\n\tbool is = false;\n\tfor(int i = pre + 1; i <= n; i++) {\n\t\tif(s[i - 1] == 'a') {\n\t\t\tn0++;\n\t\t\tif(is)\n\t\t\t\tmark[n0] = true;\n\t\t\telse\n\t\t\t\tans += \"ab\", is = true;\n\t\t}\n\t\telse {\n\t\t\tn1++;\n\t\t\tif(mark[n1])\n\t\t\t\tcontinue;\n\t\t\tif(is == true)\n\t\t\t\tis = false;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*{{{*/\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<set>\n#include<map>\n#include<queue>\n#include<bitset>\n#include<vector>\n#include<limits.h>\n#include<assert.h>\n#define SZ(X) ((int)(X).size())\n#define ALL(X) (X).begin(), (X).end()\n#define REP(I, N) for (int I = 0; I < (N); ++I)\n#define REPP(I, A, B) for (int I = (A); I < (B); ++I)\n#define FOR(I, A, B) for (int I = (A); I <= (B); ++I)\n#define FORS(I, S) for (int I = 0; S[I]; ++I)\n#define RS(X) scanf(\"%s\", (X))\n#define SORT_UNIQUE(c) (sort(c.begin(),c.end()), c.resize(distance(c.begin(),unique(c.begin(),c.end()))))\n#define GET_POS(c,x) (lower_bound(c.begin(),c.end(),x)-c.begin())\n#define CASET int ___T; scanf(\"%d\", &___T); for(int cs=1;cs<=___T;cs++)\n#define MP make_pair\n#define PB push_back\n#define MS0(X) memset((X), 0, sizeof((X)))\n#define MS1(X) memset((X), -1, sizeof((X)))\n#define LEN(X) strlen(X)\n#define F first\n#define S second\nusing namespace std;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef long double LD;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<LL> VL;\ntypedef vector<PII> VPII;\ntypedef pair<LL,LL> PLL;\ntypedef vector<PLL> VPLL;\ntemplate<class T> void _R(T &x) { cin >> x; }\nvoid _R(int &x) { scanf(\"%d\", &x); }\nvoid _R(LL &x) { scanf(\"%lld\", &x); }\nvoid _R(double &x) { scanf(\"%lf\", &x); }\nvoid _R(char &x) { scanf(\" %c\", &x); }\nvoid _R(char *x) { scanf(\"%s\", x); }\nvoid R() {}\ntemplate<class T, class... U> void R(T &head, U &... tail) { _R(head); R(tail...); }\ntemplate<class T> void _W(const T &x) { cout << x; }\nvoid _W(const int &x) { printf(\"%d\", x); }\nvoid _W(const LL &x) { printf(\"%lld\", x); }\nvoid _W(const double &x) { printf(\"%.16f\", x); }\nvoid _W(const char &x) { putchar(x); }\nvoid _W(const char *x) { printf(\"%s\", x); }\ntemplate<class T,class U> void _W(const pair<T,U> &x) {_W(x.F); putchar(' '); _W(x.S);}\ntemplate<class T> void _W(const vector<T> &x) { for (auto i = x.begin(); i != x.end(); _W(*i++)) if (i != x.cbegin()) putchar(' '); }\nvoid W() {}\ntemplate<class T, class... U> void W(const T &head, const U &... tail) { _W(head); putchar(sizeof...(tail) ? ' ' : '\\n'); W(tail...); }\n#ifdef HOME\n #define DEBUG(...) {printf(\"# \");printf(__VA_ARGS__);puts(\"\");}\n#else\n #define DEBUG(...)\n#endif\nint MOD = 1e9+7;\nvoid ADD(LL& x,LL v){x=(x+v)%MOD;if(x<0)x+=MOD;}\n/*}}}*/\nconst int SIZE = 1e6+10;\nchar s[SIZE];\nPII d[SIZE];\nint main(){\n    int N; R(N);\n    RS(s);\n    int AA[2]={};\n    REP(i,2*N){\n        if(s[i]=='a'){\n            d[AA[0]++].F=i;\n        }\n        else{\n            d[AA[1]++].S=i;\n        }\n    }\n    bool a_start=1;\n    REP(i,N){\n        if(d[i].F>d[i].S){\n            a_start=0;\n        }\n    }\n    if(a_start){\n        VI dp(N);\n        dp[0]=1;\n        int ma=1;\n        REPP(i,1,N){\n            REP(j,i){\n                if(d[j].S<d[i].F)dp[i]=max(dp[i],dp[j]+1);\n            }\n            ma=max(ma,dp[i]);\n        }\n        REP(i,ma)printf(\"ab\");\n        W(\"\");\n    }\n    else{\n        string dp0[3001];\n        for(int i=N-1;i>=0;i--){\n            if(d[i].F>=d[i].S)continue;\n            dp0[i]=\"ab\";\n            REPP(j,i+1,N){\n                if(d[i].S<d[j].F){\n                    dp0[i]=\"ab\"+dp0[j];\n                    break;\n                }\n            }\n        }\n        string an=\"\";\n        REP(i,N){\n            if(d[i].S<d[i].F){\n                VI u(N*2);\n                REPP(j,i,N){\n                    if(d[j].S<d[j].F){\n                        u[d[j].S]=u[d[j].F]=1;\n                    }\n                }\n                string tmp=\"\";\n                int lt=0;\n                REPP(j,d[i].S,2*N){\n                    if(u[j]){\n                        tmp+=s[j];\n                        lt=j;\n                    }\n                }\n                string tail=\"\";\n                REP(j,N){\n                    if(d[j].F>lt){\n                        tail=max(tail,dp0[j]);\n                    }\n                }\n                an=max(an,tmp+tail);\n            }\n        }\n        W(an);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n; string s; cin >> n >> s; n *= 2; assert(n > 6);\n\tvector<string> v;\n\tfor(int i = 0, k = 0, p = 0; i < n; i++){\n\t\tif(s[i] == 'a') k++;\n\t\telse k--;\n\t\tif(k == 0){\n\t\t\tv.pb(s.substr(p, i + 1 - p));\n\t\t\tp = i + 1;\n\t\t}\n\t}\n\treverse(all(v));\n\t\n\tstring ans;\n\tbool b = 0;\n\t\n\tfor(string i : v){\n\t\tvi ord(i.size());\n\t\tint x = 0, y = 0;\n\t\tstring tmp;\n\t\trep(j, i.size()){\n\t\t\tif(i[j] == 'a') ord[j] = x++;\n\t\t\telse ord[j] = y++;\n\t\t}\n\t\tif(i[0] == 'a'){\n\t\t\tif(b) continue;\n\t\t\t\n\t\t\tint cnt = 0;\n\t\t\trep(j, i.size()) if(i[j] == 'a'){\n\t\t\t\tcnt++;\n\t\t\t\tint o = ord[j];\n\t\t\t\twhile(j < i.size() && !(i[j] == 'b' && ord[j] == o)) j++;\n\t\t\t}\n\t\t\trep(it, cnt) tmp += \"ab\";\n\t\t\tans = tmp + ans;\n\t\t}\n\t\telse{\n\t\t\tb = 1;\n\t\t\ttmp = ans;\n\t\t\trep(j, x + 1){\n\t\t\t\tstring t;\n\t\t\t\trep(k, i.size()) if(ord[k] >= j) t += i[k];\n\t\t\t\ttmp = max(tmp, t + ans);\n\t\t\t}\n\t\t\tans = tmp;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=3e3+5;\nint n;\nchar s[maxn<<1];\nint t[maxn<<1];\nint a[maxn],b[maxn];\nint A,B;\nstring Ans;\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\t//n=3;\n\tfor (int i=1;i<=n*2;i++){\n\t\tif (s[i]=='a'){\n\t\t\tA++;\n\t\t\ta[A]=i;\n\t\t\tt[i]=A;\n\t\t}\n\t\telse{\n\t\t\tB++;\n\t\t\tb[B]=i;\n\t\t\tt[i]=B;\n\t\t}\n\t}\n\tfor (int i=1;i<=n*2;i++){\n\t\tstring S=\"\";\n\t\tint pos=i-1;\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi!=i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tfor (int j=i;j<=n*2;j++){\n\t\t\t\tif (a[t[j]]>b[t[j]]&&b[t[j]]>=i){\n\t\t\t\t\tS.push_back(s[j]);\n\t\t\t\t\tpos=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int j=pos+1;j<=n*2;j++){\n\t\t\tif (a[t[j]]<b[t[j]]){\n\t\t\t\tS+=\"ab\";\n\t\t\t\tj=b[t[j]];\n\t\t\t}\n\t\t}\n\t//\tcout << i << ' ' << S << '\\n';\n\t\tAns=max(Ans,S);\n\t}\n\tcout << Ans << '\\n';\n}"
  },
  {
    "language": "C++",
    "code": "// Hacheylight\n#include <map>\n#include <set>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <vector>\n#include <bitset>\n#include <cstdio>\n#include <cctype>\n#include <string>\n#include <numeric>\n#include <cstring>\n#include <cassert>\n#include <climits>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std ;\n//#define int long long\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n#define per(i, a, b) for (int i = (a); i >= (b); i--)\n#define loop(it, v) for (auto it = v.begin(); it != v.end(); it++)\n#define cont(i, x) for (int i = head[x]; i; i = e[i].nxt)\n#define clr(a) memset(a, 0, sizeof(a))\n#define ass(a, sum) memset(a, sum, sizeof(a))\n#define lowbit(x) (x & -x)\n#define all(x) x.begin(), x.end()\n#define SC(t, x) static_cast <t> (x)\n#define ub upper_bound\n#define lb lower_bound\n#define pqueue priority_queue\n#define mp make_pair\n#define pb push_back\n#define pof pop_front\n#define pob pop_back\n#define fi first\n#define se second\n#define y1 y1_\n#define Pi acos(-1.0)\n#define iv inline void\n#define enter cout << endl\n#define siz(x) ((int)x.size())\n#define file(x) freopen(x\".in\", \"r\", stdin),freopen(x\".out\", \"w\", stdout)\ntypedef double db ;\ntypedef long long ll ;\ntypedef unsigned long long ull ;\ntypedef pair <int, int> pii ;\ntypedef vector <int> vi ;\ntypedef vector <pii> vii ;\ntypedef queue <int> qi ;\ntypedef queue <pii> qii ;\ntypedef set <int> si ;\ntypedef map <int, int> mii ;\ntypedef map <string, int> msi ;\nconst int N = 6010 ;\nconst int INF = 0x3f3f3f3f ;\nconst int iinf = 1 << 30 ;\nconst ll linf = 2e18 ;\nconst int MOD = 1000000007 ;\nconst double eps = 1e-7 ;\nvoid douout(double x){ printf(\"%lf\\n\", x + 0.0000000001) ; }\ntemplate <class T> void print(T a) { cout << a << endl ; exit(0) ; }\ntemplate <class T> void chmin(T &a, T b) { if (a > b) a = b ; }\ntemplate <class T> void chmax(T &a, T b) { if (a < b) a = b ; }\ntemplate <class T> void add(T &a, T b) { a = (1ll * a + b) % MOD ; }\ntemplate <class T> void mul(T &a, T b) { a = (ll) a * b % MOD ; }\ntemplate <class T> T read() {\n    int f = 1 ; T x = 0 ;\n    char ch = getchar() ;\n    while (!isdigit(ch)) { if (ch == '-') f = -1 ; ch = getchar() ; }\n    while (isdigit(ch)) { x = x * 10 + ch -'0' ; ch = getchar() ; }\n    return x * f ;\n}\n\nstring dp[N] ;\nchar s[N] ;\nint pa[N], pb[N] ;\nint pos[N] ;\nint n, sza, szb ;\n\nsigned main() {\n\tscanf(\"%d\", &n) ;\n\tscanf(\"%s\", s) ;\n\trep(i, 0, 2 * n - 1)\n\tif (s[i] == 'a') pa[sza++] = i ;\n\telse pb[szb++] = i ;\n\trep(i, 0, n - 1) {\n\t\tpos[pa[i]] = pb[i] ;\n\t\tpos[pb[i]] = pa[i] ;\n\t}\n\tdp[2 * n] = \"\" ;\n\tper(i, 2 * n - 1, 0) {\n\t\tdp[i] = dp[i + 1] ;\n\t\tif (i < pos[i]) {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\tstring to = \"ab\" ;\n\t\t\t\tto += dp[pos[i] + 1] ;\n\t\t\t\tchmax(dp[i], to) ;\n\t\t\t} else {\n\t\t\t\tint cnt = 0 ;\n\t\t\t\tstring now = \"\" ;\n\t\t\t\trep(j, i, 2 * n - 1) {\n\t\t\t\t\tif (pos[j] < i) continue ;\n\t\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\t\tif (pos[j] < j) {\n\t\t\t\t\t\t\tnow += \"a\" ;\n\t\t\t\t\t\t\tcnt-- ;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (pos[j] > j) {\n\t\t\t\t\t\t\tnow += \"b\" ;\n\t\t\t\t\t\t\tcnt++ ;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!cnt) {\n\t\t\t\t\t\tnow += dp[j + 1] ;\n\t\t\t\t\t\tchmax(dp[i], now) ;\n\t\t\t\t\t\tbreak ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << dp[0] << endl ;\n\treturn 0 ;\n}\n\n/*\n写代码时请注意：\n\t1.ll？数组大小，边界？数据范围？\n\t2.精度？\n\t3.特判？\n\t4.至少做一些\n思考提醒：\n\t1.最大值最小->二分？\n\t2.可以贪心么？不行dp可以么\n\t3.可以优化么\n\t4.维护区间用什么数据结构？\n\t5.统计方案是用dp？模了么？\n\t6.逆向思维？\n*/\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n\n \n \n  bool t=true;int x=0;\n string sx;\n   vector<string> ss;\n  for(int i=2*n-1;i>=0;i--){\n\n    if(x==0){\n      if(s[i]=='a'){\n        t=false;\n        string ns;\n        ss.push_back(ns);\n        ss[ss.size()-1].push_back(s[i]);\n        x++;\n        }\n      else{\n        if(t)sx.push_back(s[i]);\n        x--;\n      } \n   \n      continue;\n    }\n    if(x>0)ss[ss.size()-1].push_back(s[i]);\n    if(x<0&&t)sx.push_back(s[i]);\n      if(s[i]=='a')x++;\n      else x--;\n  }\n     \nreverse(sx.begin(),sx.end());\nfor(int i=0;i<ss.size();i++)reverse(ss[i].begin(),ss[i].end());\n\n  string ans[ss.size()],ans2=sx;\n\n  for(int ii=0;ii<ss.size();ii++){\n    ans[ii]=ss[ii];\n    while(!ss[ii].empty()){\n    int i=0;\n    while(ss[ii][i]=='b')i++;\n    ss[ii].erase(ss[ii].begin()+i);\n    ss[ii].erase(ss[ii].begin());\n    ans[ii]=max(ans[ii],ss[ii]);\n  }\n  }\n  \nstring sxx[sx.size()];\nbool b[sx.size()]={};\nfor(int i=sx.size()-1;i>=0;i--){\n  if(sx[i]=='b'){\n   if(i!=sx.size()-1) sxx[i]=sxx[i+1];\n  \n    continue;\n  }\n  for(int j=sx.size()-1;j>i;j--)if(sx[j]=='b'&&b[j]==false){\n    b[j]=true;\n    sxx[i]=\"ab\"+sxx[j];\n    break;\n  }\n\n  ans2=max(ans2,sxx[i]);\n}\n  \nfor(int i=ss.size()-1;i>=0;i--){\n\n  ans2=max(ans2,ans2+ans[i]);\n}\ncout<<ans2<<endl;\n\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, A[6003], B[6003];\nint id[6003], nx[6003];\nstring s, res[6003];\n\nint main() {\n    cin >> n >> s, s = \" \" + s;\n    for (int i = 1, ca = 0, cb = 0; i <= n * 2; ++i)\n        (s[i] ^ 'a') ? B[id[i] = ++cb] = i : A[id[i] = ++ca] = i;\n    A[n + 1] = B[n + 1] = n * 2 + 1;\n\n    for (int i = 1, p = 1; i <= n + 1; ++i)\n        while (p < min(A[i], B[i])) nx[p++] = i;\n\n    for (int i = n, p, mx; i >= 1; --i) {\n        if (B[i] < A[i]) {\n            for (p = B[i], mx = A[i]; p <= mx; ++p)\n                if (id[p] >= i) res[i] += s[p], mx = max(mx, A[id[p]]);\n            res[i] += res[id[p]];\n        } else {\n            res[i] = \"ab\" + res[nx[B[i]]];\n        }\n        res[i] = max(res[i], res[i + 1]);\n    }\n    cout << res[1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\t/*\n\t\ts0=s1=0;\n\t\tint lst=r;\n\t\tfor (int j=r;j>=l;j--)\n\t\t{\n\t\t\tif ((s[j]-'a')==f)\n\t\t\t{\n\t\t\t\ts0++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ts1++;\n\t\t\t}\n\t\t\tif (s0==s1)\n\t\t\t{\n\t\t\t\tnode now;\n\t\t\t\tfor (int i=lst;i>=j;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tif ((now.s+res)>res)\n\t\t\t\t{\n\t\t\t\t\tres=now.s+res;\n\t\t\t\t}\n\t\t\t\tlst=j-1;\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tnode now;\n\t\t\t\tfor (int i=r;i>=l;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tres=now.s;\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=2*n-1;\n\tstring ans=\"\";\n\tfor (int i=2*n-1;i>=0;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa!=sb)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tif (s[i-1]=='b')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (lst==2*n-1)\n\t\t\t{\n\t\t\t\tans=work(0,i,lst)+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring str=work(1,i,lst);\n\t\t\t/*\n\t\t\tfor (int j=i;j<=lst;j++)\n\t\t\t{\n\t\t\t\tstr.push_back(s[j]);\n\t\t\t}\n\t\t\t*/\n\t\t\tif ((str+ans)>ans)\n\t\t\t{\n\t\t\t\tans=str+ans;\n\t\t\t}\n\t\t\t//cout<<ans<<endl;\n\t\t\tlst=i-1;\n\t\t}\n\t}\n\t/*\n\tfor (int i=0;i<2*n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa==sb)\n\t\t{\n\t\t\tif (i==2*n-1 || s[i+1]!=s[lst])\n\t\t\t{\n\t\t\t\tif (i==2*n-1 || (s[i+1]!=s[lst] && s[lst]!='a'))\n\t\t\t\t{\n\t\t\t\t\tans=ans+work(s[lst]-'a',lst,i);\n\t\t\t\t}\n\t\t\t\tsa=sb=0;\n\t\t\t\tlst=i+1;\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tint ret=0; char c=getchar();\n\twhile(c<48||c>57)c=getchar();\n\twhile(c>=48&&c<=57)ret=ret*10+c-48,c=getchar();\n\treturn ret;\n}\n#define N 6099\nint n,nn;\nchar s[6159];\nint g[N],a[N],b[N],a1,b1,f[N],ma,vi[N],t[N];\nint main()\n{\n\tn=read();nn=n*2;\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=nn;++i)if(s[i]=='a')a[++a1]=i;else b[++b1]=i;\n\tfor(int i=1;i<=n;++i){\n\t\tif(b[i]<a[i]){\n\t\t\tf[i]=lower_bound(b+1,b+n+1,a[i])-b-i;\n\t\t\tma=max(ma,f[i]);\n\t\t}\n\t}\n\t\n\tif(!ma){\n\t\tint u=0;\n\t\tfor(int i=1;i<=n;++i)if(a[i]>u&&b[i]>u)printf(\"ab\"),u=max(u,a[i]),u=max(u,b[i]);\n\t\texit(0);\n\t}\n\tg[n]=f[n];\n\tfor(int i=n-1;i;--i)g[i]=max(g[i+1],f[i]);\n\tfor(int i=1;i<=n;++i)if(f[i]==g[i]){\n\t\tif(!g[i])break;\n\t\tfor(int j=i;j<=i+f[i];++j)vi[j]=1;\n\t\ti+=f[i];\n\t}\n\tfor(int i=1;i<=n;++i)if(vi[i])t[a[i]]=t[b[i]]=1;\n\tfor(int i=1;i<=nn;++i)if(t[i])printf(\"%c\",s[i]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#define SF scanf\n#define PF printf\n#define MAXN 6010\nusing namespace std;\nint n;\nchar s[MAXN];\nchar dp[MAXN][MAXN];\nint a[MAXN],b[MAXN],cnta,cntb,mat[MAXN];\nint main(){\n\tSF(\"%d\",&n);\n\tn<<=1;\n\tSF(\"%s\",s);\n\tfor(int i=0;i<n;i++){\n\t\tif(s[i]=='a')\n\t\t\ta[cnta++]=i;\n\t\telse\n\t\t\tb[cntb++]=i;\n\t}\n\tfor(int i=0;i<n/2;i++){\n\t\tmat[a[i]]=b[i];\n\t\tmat[b[i]]=a[i];\t\n\t}\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(mat[i]<i){\n\t\t\tstrcpy(dp[i],dp[i+1]);\n\t\t\tcontinue;\n\t\t}\n\t\telse{\n\t\t\tif(s[i]=='a'){\n\t\t\t\tdp[i][0]='a';\n\t\t\t\tdp[i][1]='b';\n\t\t\t\tstrcpy(dp[i]+2,dp[mat[i]+1]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint end=mat[i];\n\t\t\t\tint siz=0;\n\t\t\t\tfor(int j=i;j<=end;j++)\n\t\t\t\t\tif(mat[j]>=i){\n\t\t\t\t\t\tdp[i][siz++]=s[j];\n\t\t\t\t\t\tend=max(end,mat[j]);\t\n\t\t\t\t\t}\n\t\t\t\tstrcpy(dp[i]+siz,dp[end+1]);\n\t\t\t}\n\t\t}\n\t\tif(strcmp(dp[i],dp[i+1])<0)\n\t\t\tstrcpy(dp[i],dp[i+1]);\n\t}\n\tPF(\"%s\",dp[0]);\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][2 * nsz + 5], id[2 * nsz + 5];\nstring s, dp[2 * nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 97];\n    }\n    for (int i = n; i >= 1; --i) {\n        dp[i] = dp[i + 1];\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n        dp[i] = max(dp[i], dp[i + 1]);\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 1) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            ans = ans + cans;\n        }\n        else {\n            if (i < lst) continue;\n            forn(j, p[i], p[i + 1] - 1)\n                if (a[j] == 1 && a[j - 1] == 0)\n                    ans.pb('a'), ans.pb('b');\n        }\n    }\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstring ANS = \"\",s;\nvector<int> ans,ans1;\nbool ch(){\n    string X = \"\",Y;\n    sort(ans.begin(),ans.end());\n    for(int i = 0; i < ans.size(); i++)\n        X += s[ans[i]];\n    Y = ANS + \"00\";\n    if(X > Y) ANS = X;\n    else return 0;\n    return 1;\n}\nvector<pair<int,int> > v;\nmain(){\n    int n;\n    cin >> n;\n    cin >> s;\n    vector<int> a,b;\n    for(int i = 0; i < s.size(); i++){\n        if(s[i] == 'a') a.push_back(i);\n            else b.push_back(i);\n    }\n    for(int i = 0; i < n; i++){\n        int A = a[i], B = b[i];\n        if(A > B) swap(A,B);\n        v.push_back({B,A});\n    }\n    sort(v.rbegin(),v.rend());\n    for(int i = 0; i < v.size(); i++){\n        ans1 = ans;\n        ans.push_back(v[i].first);\n        ans.push_back(v[i].second);\n        if(!ch()) ans = ans1;\n    }\n    cout << ANS << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\ntemplate<typename ty> bool Chkmax(ty &x, const ty &y) { return x < y ? x = y, 1 : 0; }\ntemplate<typename ty> bool Chkmin(ty &x, const ty &y) { return x > y ? x = y, 1 : 0; }\n\nconst int maxn = 3e3 + 10;\n\nstring Solve(string s)\n{\n\tvector<int> ida, idb, pos, id;\n\tfor (int i = 0; i < s.size(); ++ i)\n\t{\n\t\tif (s[i] == 'a') ida.push_back(i);\n\t\telse idb.push_back(i);\n\t}\n\tfor (int i = 0, ta = 0, tb = 0; i < s.size(); ++ i)\n\t{\n\t\tif (s[i] == 'a')\n\t\t{\n\t\t\tid.push_back(ta);\n\t\t\tpos.push_back(idb[ta ++]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tid.push_back(tb);\n\t\t\tpos.push_back(ida[tb ++]);\n\t\t}\n\t}\n\tstring res = \"\";\n\tif (s[0] == 'a')\n\t{\n\t\tfor (int i = 0; i < s.size(); ++ i)\n\t\t{\n\t\t\tif (s[i] == 'a')\n\t\t\t{\n\t\t\t\tres += \"ab\";\n\t\t\t\ti = pos[i];\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor (int i = ida.size() - 1; ~ i; -- i)\n\t\t{\n\t\t\tstring t;\n\t\t\tfor (int j = 0; j < s.size(); ++ j)\n\t\t\t{\n\t\t\t\tif (id[j] >= i) t.push_back(s[j]);\n\t\t\t}\n\t\t\tif (t > res) res = t;\n\t\t}\n\t}\n\treturn res;\n}\n\nstring f[maxn];\n\nint main()\n{\n\tint n;\n\tcin >> n;\n\tstring s, t;\n\tcin >> s;\n\tvector<string> a;\n\tfor (int i = 0, j = 0; i < s.size(); ++ i)\n\t{\n\t\tt.push_back(s[i]);\n\t\tif (s[i] == 'a') ++ j; else -- j;\n\t\tif (!j)\n\t\t{\n\t\t\ta.push_back(Solve(t));\n\t\t\tt.clear();\n\t\t}\n\t}\n\tstring ans = \"\";\n\tfor (int i = a.size() - 1; ~ i; -- i)\n\t{\n\t\tf[i] = a[i];\n\t\tfor (int j = i + 1; j < a.size(); ++ j)\n\t\t{\n\t\t\tChkmax(f[i], a[i] + f[j]);\n\t\t}\n\t\tChkmax(ans, f[i]);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tif(to.empty() || to.back() != o[k]) to += o[k];\n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tcnt++;\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define F first\n#define S second\n#define int long long\n#define ll long long\n//#define int  unsigned long long\n#define pb push_back\n//#define double long double\n\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef  tree< int , null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> ordered_set;\nconst int mod = 1e9 + 7;\nconst int N = 650055;\nconst int K = 700 ;\nint a[N], p1[N], p2[N], d[N], n;\nvector < pair < int, int > > t;\nstring calc(string s){\n        string ans = \"\";\n        int cnt1 = 0;\n        int cnt2 = 0;\n        int n = s.length() / 2;\n        for (int i = 1; i <= n + n; i++){\n            if (a[i] == -1){\n                cnt1++;\n                cnt2 = 0;\n                for (int j = 1; j <= n + n; j++){\n                    if (a[j] == 1) cnt2++;\n                    if (cnt2 == cnt1){\n                        d[i] = j;\n                        break;\n                    }\n                }\n            }\n        }\n        int c = 1;\n        while (c <= n + n){\n            ans += \"ab\";\n            c = d[c];\n            while(a[c] == 1) c++;\n        }\n    return ans;\n}\nmain(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n   // freopen(\"input.txt\", \"r\", stdin);\n    cin >> n;\n    string s;\n    cin >> s;\n    for (int i = 1; i <= n + n; i++){\n        if (s[i - 1] == 'a') a[i] = -1; else a[i] = 1;\n    }\n    int x = 0;\n    int l = 1;\n    int q = 0;\n    for (int i = 1; i <= n + n; i++){\n        x += a[i];\n        if (x == 0){\n            if (a[l] == 1) q = 1;\n            t.pb({l, i});\n            l = i + 1;\n        }\n    }\n    int c = 0;\n    if (q == 0){\n        cout << calc(s);\n        return 0;\n    }\n    vector < string > v;\n    for (auto i: t){\n        string res = \"\";\n        string cur = s.substr(i.F - 1, i.S - i.F + 1);\n        if (a[i.F] == -1){\n            res = calc(cur);\n            v.pb(res);\n            continue;\n        }\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a'){\n                cnt2++;\n                p2[j] = p1[cnt2];\n            } else{\n                cnt1++;\n                p1[cnt1] = j;\n            }\n        }\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a') continue;\n            string x = \"\";\n            for (int l = j; l < cur.length(); l++){\n                if (cur[l] == 'b') x += \"b\"; else\n                if (cur[l] == 'a' && p2[l] >= j) x += \"a\";\n            }\n            res = max(res, x);\n        }\n        v.pb(res);\n    }\n    string ans = \"\";\n    for (int j = v.size() - 1; j >= 0; j--){\n        ans = max(ans, v[j] + ans);\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::cerr; \n\ntemplate <class T>\ninline void relax(T &x, const T &y) {\n\tif (x < y) x = y; \n}\n\nconst int MaxM = 6e3 + 5; \nconst int MaxN = 3e3 + 5; \n\nint n; \nchar s[MaxM]; \nstd::string f[MaxN]; \n\nint idx[MaxN]; \nint a[MaxN], b[MaxN]; \n\nint main() {\n#ifdef orzczk\n\tfreopen(\"subsequnce.in\", \"r\", stdin); \n#endif\n\n\tscanf(\"%d%s\", &n, s + 1); \n\tfor (int i = 1, cA = 0, cB = 0; i <= (n << 1); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[idx[i] = ++cA] = i; \n\t\t} else {\n\t\t\tb[idx[i] = ++cB] = i; \n\t\t}\n\t}\n\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint nxt = i + 1; \n\t\t\tfor (int j = b[i] - 1; j > a[i]; --j)\n\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\tnxt = idx[j] + 1; \n\t\t\t\t\tbreak; \n\t\t\t\t}\n\t\t\t\n\t\t\tf[i] = \"ab\" + f[nxt]; \n\t\t} else {\n\t\t\tint border = a[i], maxIdx = i; \n\t\t\tfor (int j = b[i] + 1; j <= border; ++j)\n\t\t\t\tif (s[i] == 'b') {\n\t\t\t\t\trelax(border, a[idx[j]]); \n\t\t\t\t}\n\t\t\t\n\t\t\tfor (int j = b[i]; j <= border; ++j)\n\t\t\t\tif (idx[j] >= i) {\n\t\t\t\t\tf[i] += s[j]; \n\t\t\t\t\trelax(maxIdx, idx[j]); \n\t\t\t\t}\n\t\t\t\n\t\t\tf[i] += f[maxIdx + 1]; \n\t\t}\n\n\t\t// cerr << i << ' ' << f[i] << '\\n'; \n\t\trelax(f[i], f[i + 1]); \n\t}\n\n\tstd::cout << f[1] << '\\n'; \n\n\treturn 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define FOR(i,a,b) for (register int i=(a);i<=(b);i++)\n#define For(i,a,b) for (register int i=(a);i>=(b);i--)\n#define MP make_pair\n#define pb push_back\n#define fi first\n#define se second\nusing namespace std;\nconst int N=3005;\nint n,a[N],b[N],vis[N],balance=0;\nstring s,ans=\"\";\nvector <string> vec;\ninline string sub(int l,int r)\n{\n\tstring str=\"\";\n\tFOR(i,l,r) if (!vis[i]) str+=s[i];\n\treturn str;\n}\ninline void solve(int l,int r)\n{\n\ta[0]=b[0]=0;\n\tFOR(i,l,r)\n\t\tif (s[i]=='a') a[++a[0]]=i;\n\t\telse b[++b[0]]=i;\n\tint last,tmp,mx=0;\n\tstring str=\"\";\n\tif (s[l]=='a')\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tlast=i,tmp=1;\n\t\t\tFOR(j,i+1,a[0]) if (a[j]>b[last]) last=j,tmp++;\n\t\t\tmx=max(mx,tmp);\n\t\t}\n\t\tFOR(i,1,mx) str+=\"ab\";\n\t}\n\telse\n\t{\n\t\tFOR(i,1,a[0])\n\t\t{\n\t\t\tstr=max(str,sub(l,r));\n\t\t\tvis[a[i]]=vis[b[i]]=1;\n\t\t}\n\t\tFOR(i,1,a[0]) vis[a[i]]=vis[b[i]]=0;\n\t}\n\tvec.pb(str);\n\treturn;\n}\ninline int check(string s1,string s2)\n{\n\tint l1=s1.length(),l2=s2.length(),len=min(l1,l2);\n\tFOR(i,0,l1-1)\n\t{\n\t\tif (s1[i]<s2[i]) return 1;\n\t\tif (s1[i]>s2[i]) return 0;\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tcin>>s;\n\tfor (register int l=0,r=0;l<2*n&&r<2*n;r++)\n\t{\n\t\tbalance+=(s[r]=='a')?1:-1;\n\t\tif (!balance) solve(l,r),l=r+1;\n\t}\n\tFOR(i,0,(int)vec.size()-1)\n\t{\n\t\tint tag=1;\n\t\tFOR(j,i+1,(int)vec.size()-1)\n\t\t\tif (check(vec[i],vec[j])) {tag=0;break;}\n\t\tif (tag) ans+=vec[i];\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tint cnta = 0,cntb = 0;\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tcnta += o[k] == 'a';\n\t\t\t\tcntb += o[k] == 'b';\n\t\t\t\tif(cnta == cntb) to += 'b';\n\t\t\t\tif(cnta == cntb + 1) to += 'a'; \n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"O2,unroll-loops\")\n#pragma GCC target(\"avx,avx2,sse,sse2,ssse3\")\n#include<bits/stdc++.h>\n#define all(x) x.begin(), x.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing vi = vector<ll>;\nusing pi = pair<ll, ll>;\nconst int maxn = 1<<17, mlg = 17, mod = 1e9 + 7;\nmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\nvoid generate(int &n, string &s) {\n\tn = 20;\n\tfor(int i = 0; i < n; i += 2) s += \"ab\";\n\tshuffle(all(s), rng);\n}\nstring brute(string s) {\n\tint n = s.size()/2;\n\tstring ans = \"\";\n\tfor(int msk = 0; msk < 1<<n; msk++) {\n\t\tint ca = 0, cb = 0;\n\t\tstring cur;\n\t\tfor(auto i : s) {\n\t\t\tif(i == 'b') swap(ca, cb);\n\t\t\tif((msk>>ca)&1) cur += i;\n\t\t\tca++;\n\t\t\tif(i == 'b') swap(ca, cb);\n\t\t}\n\t\tans = max(ans, cur);\n\t}\n\treturn ans;\n}\n\nstring process(string s) {\n\tstring ans;\n\t//cout << s << '\\n';\n\tif(s[0] == 'a') {\n\t\tchar p = '0';\n\t\tset<int> rem;\n\t\tint ca = 0, cb = 0;\n\t\tfor(auto i : s) {\n\t\t\tif(i == 'a') {\n\t\t\t\tif(ans.empty() || ans.back() != i) ans += i;\n\t\t\t\telse rem.insert(ca);\n\t\t\t\tca++;\n\t\t\t} else {\n\t\t\t\tif(!rem.count(cb)) ans += i;\n\t\t\t\tcb++;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n//\tcout << s.size()/2 << \" dsjfkas\\n\";\n\tfor(int i = 0; i < s.size()/2; i++) {\n\t\tstring cur;\n\t\tint ca = 0, cb = 0;\n\t\tfor(auto c : s) {\n\t\t\tif((c == 'a' ? ca++ : cb++) >= i) cur.pb(c);\n\t\t}\n\t\t//cout << i << \" to \" << cur << '\\n';\n\t\tans = max(ans, cur);\n\t}\n\treturn ans;\n}\nbool better(string a, string b) {\n\tint n = min(a.size(), b.size());\n\ta = a.substr(0, n);\n\tb = b.substr(0, n);\n\treturn a < b;\n}\nint main() {\n\tcin.tie(0)->sync_with_stdio(0);\n\tint n;\n\tstring _s, _cur;\n\tvector<string> blocks;\n\tcin >> n >> _s;\n\t//generate(n, _s);\n\tint ca = 0, cb = 0;\n\tfor(auto i : _s) {\n\t\t(i == 'a' ? ca : cb)++;\n\t\t_cur.pb(i);\n\t\tif(ca == cb) blocks.pb(_cur), _cur = \"\";\n\t}\n\tvector<string> ans;\n\tfor(int i = 0; i < blocks.size(); i++) {\n\t\tstring r = process(blocks[i]);\n\t\t//cout << blocks[i] << \" => \" << r << '\\n';\n\t\twhile(!ans.empty() && better(ans.back(), r)) ans.pop_back();\n\t\tans.pb(r);\n\t}\n\tstring rans;\n\tfor(auto i : ans) rans += i;\n\tcout << rans << '\\n';\n\t\n\t//string v = brute(_s);\n\t//if(rans != v) {\n\t//\tcout << v << '\\n';\n\t//\tcout << \"WA: \" << _s << '\\n';\n\t//}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[MAX];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=A)\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\t//print the maximum\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tif(res[A].size()==0)\n\t\t{\n\t\t\twhile(true)\n\t\t\t{\n\t\t\t\tcout<<\"ha ha\\n\";\n\t\t\t}\n\t\t}\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    for(LL i=1;i<=5;++i) a[i]=1;\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint a[3010], b[3010], be[6010];\nstring dp[3010];\nint n;\nstring s;\n\nint main(){\n\tcin >> n >> s;\n\tint cnt1 = 0, cnt2 = 0;\n\tfor (int i = 0; i < s.length(); i++){\n\t\tif (s[i] == 'a') a[cnt1++] = i, be[i] = cnt1 - 1;\n\t\telse if (s[i] == 'b') b[cnt2++] = i, be[i] = cnt2 - 1;\n\t}\n\tfor (int i = n - 1; i >= 0; i--){\n\t\tif (a[i] < b[i]){\n\t\t\tint maxj = -1;\n\t\t\tfor (int j = a[i]; j <= b[i]; j++){\n\t\t\t\tmaxj = max(maxj, be[j] + 1);\n\t\t\t}\n\t\t\tdp[i] = \"ab\" + dp[maxj];\n\t\t} else {\n\t\t\tint now = i;\n\t\t\twhile (now < n - 1 && b[now + 1] < a[now]) now++;\n\t\t\tfor (int j = 0; j < s.size(); j++){\n\t\t\t\tif (be[j] >= i && be[j] <= now) dp[i] += s[j];\n\t\t\t}\n\t\t\tdp[i] += dp[now + 1];\n\t\t}\n\t\tdp[i] = max(dp[i], dp[i + 1]);\n\t}\n\tcout << dp[0] << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 3002\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (lef < a.size() || rig < b.size()){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] > s[rig])return true;\n\t\tif (s[lef] < s[rig])return false;\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2*n,0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tmode[b] = 0;\n\tif (pos[b].first <= pos[b].second){\n\t\tint til = 0;\n\t\tint cnt = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (pos[j].first > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttil = j;\n\t\t\tcnt++;\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (min(pos[j].second,pos[j].first) > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnex[pos[j].first] = true;\n\t\t\tnex[pos[j].second] = true;\n\t\t}\n\t\tif (cmp(nex,dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t}\n\telse{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = max(pos[b].first, pos[b].second);\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i]|k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss=dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> stk;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      string res = naive(string(s.begin() + i, s.begin() + last));\n      while (!stk.empty()) {\n        if (stk.back().size() > res && res > stk.back())\n          stk.pop_back();\n        else if (res.substr(0, res.size()) > stk.back())\n          stk.pop_back();\n        else\n          break;\n      }\n      stk.push_back(res);\n      i = r - 1;\n    }\n  }\n  for (const auto& str : stk)\n    ans += str;\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i];\n    return 0;\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define N 3010\n#define mr make_pair\nusing namespace std;\nint n,g[2],s[N][2],w[N];\nstring dp[N];\nchar ch[N];\nstring que(int l,int r){string no=\"\";for (int i=0;i<2*n;i++)if (w[i]>=l&&w[i]<=r)no+=ch[i];return no;}\nint main(){\n\tcin>>n;\n\tfor (int i=0;i<2*n;i++){\n\t\tch[i]=getchar();while (ch[i]!='a'&&ch[i]!='b')ch[i]=getchar();\n\t\tg[ch[i]-'a']++;s[g[ch[i]-'a']][ch[i]-'a']=i;w[i]=g[ch[i]-'a'];\n\t}\n\tfor (int i=n;i>=1;i--){\n\t\tdp[i]=dp[i+1];\n\t\tif (s[i][0]<s[i][1]){\n\t\t\tint x=i+1;\n\t\t\twhile (x<=n&&s[x][0]<=s[i][1])x++;\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[x]);\n\t\t}else{\n\t\t\tint x=i+1,y=s[i][0];\n\t\t\twhile (x<=n&&s[x][1]<=y)x++,y=max(y,s[x][0]);\n\t\t\tdp[i]=max(dp[i],que(i,x-1)+dp[x]);\n\t\t}\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define F first\n#define S second\n#define int long long\n#define ll long long\n//#define int  unsigned long long\n#define pb push_back\n//#define double long double\n\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef  tree< int , null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> ordered_set;\nconst int mod = 1e9 + 7;\nconst int N = 650055;\nconst int K = 700 ;\nint a[N], p1[N], p2[N];\nvector < pair < int, int > > t;\nmain(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    //freopen(\"input.txt\", \"r\", stdin);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    for (int i = 1; i <= n + n; i++){\n        if (s[i - 1] == 'a') a[i] = -1; else a[i] = 1;\n    }\n    int x = 0;\n    int l = 1;\n    int q = 0;\n    for (int i = 1; i <= n + n; i++){\n        x += a[i];\n        if (x == 0){\n            if (a[l] == 1) q = 1;\n            t.pb({l, i});\n            l = i + 1;\n        }\n    }\n    int c = 0;\n    if (q == 0){\n        string ans = \"\";\n        while (c <= n + n){\n            if (a[c] == -1){\n                ans += \"a\";\n                while(a[c] == -1) c++;\n                ans += \"b\";\n            }\n            c++;\n        }\n        cout << ans;\n        return 0;\n    }\n    vector < string > v;\n    for (auto i: t){\n        if (a[i.F] == -1) continue;\n        string res = \"\";\n        string cur = s.substr(i.F - 1, i.S - i.F + 1);\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a'){\n                cnt2++;\n                p2[j] = p1[cnt2];\n            } else{\n                cnt1++;\n                p1[cnt1] = j;\n            }\n        }\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a') continue;\n            string x = \"\";\n            for (int l = j; l < cur.length(); l++){\n                if (cur[l] == 'b') x += \"b\"; else\n                if (cur[l] == 'a' && p2[l] >= j) x += \"a\";\n            }\n            res = max(res, x);\n        }\n        v.pb(res);\n    }\n    string ans = \"\";\n    for (int j = v.size() - 1; j >= 0; j--){\n        ans = max(ans, v[j] + ans);\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nint n,tot,p1[6005],p2[6005],num[6005];\nchar s[6005],ans[6005];\nvoid solve(int l,int r)\n{\n\tif(l>r)return;\n\tint now1=0,now2=0;\n\tfor(int i=l;i<=r;i++)\n\t{\n\t\tif(s[i]=='a')p1[++now1]=i;\n\t\telse p2[++now2]=i;\n\t}\n\tint maxx=-1;\n\tfor(int i=1;i<=now1;i++)\n\t{\n\t\tnum[i]=0;\n\t\tif(p1[i]>p2[i])\n\t\t{\n\t\t\tfor(int j=p2[i]+1;j<p1[i];j++)\n\t\t\t  if(s[j]=='b')num[i]++;\n\t\t\tmaxx=max(maxx,num[i]);\n\t\t}\n\t\telse num[i]=-1;\n\t}\n\tif(maxx==-1)\n\t{\n\t\tint nowr=l-1;\n\t\tfor(int i=1;i<=now1;i++)\n\t\t{\n\t\t\tif(p1[i]<nowr)continue;\n\t\t\tans[++tot]='a';\n\t\t\tans[++tot]='b';\n\t\t\tnowr=p2[i];\n\t\t}\n\t\treturn;\n\t}\n\tint pos=0;\n\tfor(int i=1;i<=now1;i++)\n\t{\n\t\tif(num[i]<0)continue;\n\t\tif(!pos)pos=i;\n\t\telse\n\t\t{\n\t\t\tint p=pos,j=i;\n\t\t\twhile(num[p]&&num[j]&&num[p]==num[j])p++,j++;\n\t\t\tif(num[p]&&num[j]&&num[p]<num[j])pos=i;\n\t\t}\n\t}\n\tint c=0,i=p2[pos];\n\tfor(;;i++)\n\t{\n\t\tif(i>p2[pos]&&i<p1[pos]&&s[i]=='a')continue;\n\t\tans[++tot]=s[i];\n\t\tif(s[i]=='b')c++;\n\t\telse c--;\n\t\tif(c==0)break;\n\t}\n\tsolve(i+1,r);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tsolve(1,2*n);\n\tfor(int i=1;i<=tot;i++)putchar(ans[i]);\n\tputchar('\\n');\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nostream &operator<<(ostream &os, const vector<int> &a) {\n\tos<<\"[\";\n\trep(i,a.size()){\n\t\tos<<a[i];\n\t\tif(i<a.size()-1) os<<\",\";\n\t}\n\tos<<\"]\";\n\treturn os; \n}\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num){\n\t\tv[i]=bs(i);\n\t\tnum+=v[i];\n\t\trep(j,v[i]) v.pb(0);\n\t}\n\tint p=ok();\n\tassert(p>=0);\n\t//cout<<v<<endl;\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <set>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tint n;\n\tstring s;\n\tcin >> n >> s;\n\tconst int m = n * 2;\n\tvector<int> pos(m), inv(m), a(n), b(n);\n\tfor(int i = 0, j = 0, k = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\ta[j] = i;\n\t\t\tpos[i] = j++;\n\t\t}else{\n\t\t\tb[k] = i;\n\t\t\tpos[i] = k++;\n\t\t}\n\t}\n\tfor(int i = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\tinv[i] = b[pos[i]];\n\t\t}else{\n\t\t\tinv[i] = a[pos[i]];\n\t\t}\n\t}\n\tset<int> current_marks;\n\tvector<char> current_string;\n\tfor(int current_state = 0; current_state < m; ){\n\t\tbool accept = false;\n\t\tfor(int c = 'b'; c >= 'a'; --c){\n\t\t\tauto marks = current_marks;\n\t\t\tauto target = current_string;\n\t\t\tint state = current_state, done = target.size();\n\t\t\ttarget.push_back(c);\n\t\t\twhile(state < m && done < target.size()){\n\t\t\t\tif(inv[state] > state){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}\n\t\t\t\t\t++state;\n\t\t\t\t}else if(marks.find(inv[state]) != marks.end()){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint rollback = inv[state];\n\t\t\t\t\t\tauto it = marks.end();\n\t\t\t\t\t\twhile(it != marks.begin() && *prev(it) >= rollback){\n\t\t\t\t\t\t\tconst int p = *(--it);\n\t\t\t\t\t\t\tif(inv[p] < p){ rollback = min(rollback, inv[p]); }\n\t\t\t\t\t\t\tif(inv[p] <= state){ marks.erase(it++); }\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\tdone = marks.size();\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t++state;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(done == target.size()){\n\t\t\t\tcurrent_state = state;\n\t\t\t\tcurrent_marks = move(marks);\n\t\t\t\tcurrent_string = move(target);\n\t\t\t\taccept = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!accept){ break; }\n\t}\n\tcurrent_string.push_back('\\0');\n\tcout << current_string.data() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\ts0=s1=0;\n\t\tint lst=r;\n\t\tfor (int j=r;j>=l;j--)\n\t\t{\n\t\t\tif ((s[j]-'a')==f)\n\t\t\t{\n\t\t\t\ts0++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ts1++;\n\t\t\t}\n\t\t\tif (s0==s1)\n\t\t\t{\n\t\t\t\tnode now;\n\t\t\t\tfor (int i=lst;i>=j;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tif ((now.s+res)>res)\n\t\t\t\t{\n\t\t\t\t\tres=now.s+res;\n\t\t\t\t}\n\t\t\t\tlst=j-1;\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=0;\n\tstring ans=\"\";\n\tfor (int i=0;i<2*n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa==sb)\n\t\t{\n\t\t\tif (i==2*n-1 || s[i+1]!=s[lst])\n\t\t\t{\n\t\t\t\tif (i==2*n-1 || (s[i+1]!=s[lst] && s[lst]!='a'))\n\t\t\t\t{\n\t\t\t\t\tans=ans+work(s[lst]-'a',lst,i);\n\t\t\t\t}\n\t\t\t\tsa=sb=0;\n\t\t\t\tlst=i+1;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Created by Alphagocc\n#include<bits/stdc++.h>\n\n#define likely(x) __builtin_expect(!!(x), 1)\n#define unlikely(x) __builtin_expect(!!(x), 0)\n// namespace IO \nnamespace IO\n{\ntemplate <typename T>\nvoid __RI(T &x)\n{\n    int ch = getchar(), neg = 1;\n    x = 0;\n    for (; !(isdigit(ch) || ch == '-' || ch == EOF); ch = getchar())\n        ;\n    if (unlikely(ch == EOF)) return;\n    if (ch == '-') neg = -1;\n    for (; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    x *= neg;\n}\nvoid R(int &x) { __RI(x); }\nvoid R(int64_t &x) { __RI(x); }\nvoid R(double &x) { scanf(\"%lf\", &x); }\nvoid R(char &x) { scanf(\"%c\", &x); }\nvoid R(char *x) { scanf(\"%s\", x); }\nvoid R(std::string &x) { std::cin >> x; }\ntemplate <typename T1, typename T2>\nvoid R(std::pair<T1, T2> &x)\n{\n    R(x.first);\n    R(x.second);\n}\ntemplate <typename T>\nvoid R(std::vector<T> &x)\n{\n    for (auto &i : x) { R(i); }\n}\ntemplate <typename T>\nvoid R(T &x)\n{\n    std::cin >> x;\n}\ntemplate <typename T, typename... Args>\nvoid R(T &x, Args &... args)\n{\n    R(x), R(args...);\n}\nchar space = ' ';\ntemplate <typename T>\nvoid __WI(T x)\n{\n    if (unlikely(x == 0)) putchar('0');\n    if (x < 0) putchar('-'), x = -x;\n    char ch[ 64 ];\n    int  pos = 0;\n    while (x) ch[ pos++ ] = x % 10 + 48, x /= 10;\n    while (pos) putchar(ch[ --pos ]);\n}\nvoid W() {}\nvoid W(const int &x) { __WI(x); }\nvoid W(const int64_t &x) { __WI(x); }\nvoid W(const double &x) { printf(\"%lf\",static_cast<double>(x)); }\nvoid W(const char &x) { putchar(x); }\nvoid W(const std::string &x) { printf(\"%s\", x.c_str()); }\ntemplate <typename T1, typename T2>\nvoid W(const std::pair<T1, T2> &x)\n{\n    W(x.first);\n    W(space);\n    W(x.second);\n}\ntemplate <typename T>\nvoid W(const std::vector<T> &x)\n{\n    for (auto it = x.cbegin();it != x.cend(); it++)\n    {\n        W(*it);\n        W(space);\n    }\n    W('\\n');\n}\ntemplate <typename T>\nvoid W(const T &x)\n{\n    std::cout << x;\n}\ntemplate <typename T, typename... Args>\nvoid W(const T &x,const Args &... args)\n{\n    W(x), W(space), W(args...);\n}\ntemplate <typename... Args>\nvoid WL(const Args &... args)\n{\n    W(args...), W('\\n');\n}\n}; // namespace IO\n\nusing namespace std;\n\n#define REP(i, x, y) for (int i = x;i < y; i++)\n\nconst int8_t  INFC = 0x3f;\nconst int16_t INFS = 0x3f3f;\nconst int32_t INF  = 0x3f3f3f3f;\nconst int64_t INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst int MAXN = 6.1e3;\n\nint    pos[ 6010 ], a[ 3010 ], b[ 3010 ];\nstring dp[ 6010 ];\n\nint main()\n{\n    int    n;\n    string s, ans;\n    IO::R(n, s);\n    for (int i = 1; i <= n * 2; i++)\n        if (s[ i ] == 'a')\n            a[ ++a[ 0 ] ] = i, pos[ i ] = a[ 0 ];\n        else\n            b[ ++b[ 0 ] ] = i, pos[ i ] = b[ 0 ];\n    for (int i = n; i >= 1; i--)\n    {\n        if (a[ i ] < b[ i ])\n        {\n            int k = i;\n            for (int j = a[ i ] + 1; j < b[ i ]; j++) k = max(k, pos[ j ]);\n            dp[ i ] = \"ab\" + dp[ k + 1 ];\n        }\n        else\n        {\n            int k = i;\n            while (k < n && b[ k + 1 ] < a[ k ]) k++;\n            for (int j = b[ i ]; j <= n * 2; j++)\n                if (i <= pos[ j ] && pos[ j ] <= k) dp[ i ] += s[ j ];\n            dp[ i ] += dp[ k + 1 ];\n        }\n        dp[ i ] = max(dp[ i ], dp[ i + 1 ]);\n        ans     = max(ans, dp[ i ]);\n    }\n    IO::W(ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#pragma GCC optimize (\"O2,unroll-loops\")\n//#pragma GCC optimize(\"no-stack-protector,fast-math\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<pii, int> piii;\ntypedef pair<ll, ll> pll;\n#define debug(x) cerr<<#x<<'='<<(x)<<endl;\n#define debugp(x) cerr<<#x<<\"= {\"<<(x.first)<<\", \"<<(x.second)<<\"}\"<<endl;\n#define debug2(x, y) cerr<<\"{\"<<#x<<\", \"<<#y<<\"} = {\"<<(x)<<\", \"<<(y)<<\"}\"<<endl;\n#define debugv(v) {cerr<<#v<<\" : \";for (auto x:v) cerr<<x<<' ';cerr<<endl;}\n#define all(x) x.begin(), x.end()\n#define pb push_back\n#define kill(x) return cout<<x<<'\\n', 0;\n\nconst ld eps=1e-7;\nconst int inf=1000000010;\nconst ll INF=10000000000000010LL;\nconst int mod=1000000007;\nconst int MAXN=6010, LOG=20;\n\nint n, m, k, u, v, x, y, t, a, b, sum;\nint A[2][MAXN];\nbool mark[MAXN];\nstring ans, S, T;\n\nstring Solve(string T){\n\tstring res;\n\tif (T[0]=='a'){\n\t\tfor (char ch:T) if (res.empty() || res.back()!=ch) res+=ch;\n\t\treturn res;\n\t}\n\tint a=0, b=0;\n\tfor (int i=T.size()-1; ~i; i--){\n\t\tif (T[i]=='a') A[0][a++]=i;\n\t\tif (T[i]=='b') A[1][b++]=i;\n\t\tmark[i]=0;\n\t}\n\tfor (int i=0; 2*i<T.size(); i++){\n\t\tmark[A[0][i]]=mark[A[1][i]]=1;\n\t\tstring s;\n\t\tfor (int j=0; j<T.size(); j++) if (mark[j]) s+=T[j];\n\t\tres=max(res, s);\n\t}\n\treturn res;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\t//freopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\tcin>>n>>S;\n\tfor (int i=2*n-1; ~i; i--){\n\t\tif (S[i]=='a') sum++;\n\t\telse sum--;\n\t\tT=S[i]+T;\n\t\tif (sum==0){\n\t\t\tT=Solve(T);\n\t\t\tans=max(ans, T+ans);\n\t\t\tT=\"\";\n\t\t}\n\t}\n\tcout<<ans<<\"\\n\";\n\t\n\treturn 0;\n}\n/*\n3\nbbabaa\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define pb push_back\n\nconst int N = 3005;\nint n, order[N << 1];\nstring s, ans = \"\";\nvector<string> a, dp;\n\nint main () {\n    ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n\n    cin >> n >> s;\n\n    int cnta = 0, cntb = 0;\n    for (int r = 0, l = 0; r < (int)s.size(); ++r) {\n        if (s[r] == 'a') {\n            ++cnta;\n            order[r] = cnta;\n        }\n        else {\n            ++cntb;\n            order[r] = cntb;\n        }\n        if (cnta == cntb) {\n            string t = \"\";\n            if (s[l] == 'a') {\n                for (int i = l, lim = 0; i <= r; ++i) {\n                    if (lim == order[i]) lim = 0;\n                    if (!lim && s[i] == 'a') {\n                        t += \"ab\";\n                        lim = order[i];\n                    }\n                }\n            }\n            else {\n                for (int i = order[l]; i <= order[r]; ++i) {\n                    string str = \"\";\n                    for (int j = l; j <= r; ++j) if (order[j] >= i) str += s[j];\n                    t = max(t, str);\n                }\n            }\n            a.pb(t);\n            l = r + 1;\n        }\n    }\n\n    dp.assign(a.size(), \"\");\n\n    for (int i = 0; i < (int)a.size(); ++i) {\n        dp[i] = a[i];\n        for (int j = 0; j < i; ++j) dp[i] = max(dp[i], dp[j] + a[i]);\n        ans = max(ans, dp[i]);\n    }\n\n    cout << ans;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nint n;\nint wza[8192],wzb[8192];\nint nxt[8192],mx[8192];\nchar s[8192];\nbool vis[8192];\nvoid build(int wz,char* t)\n{\n\tfor(int i=0;i<(n<<1);i++)\n\t{\n\t\tvis[i]=false;\n\t}\n\tfor(int i=wz;i<n;i=nxt[i])\n\t{\n\t\tvis[wza[i]]=true;\n\t\tvis[wzb[i]]=true;\n\t}\n\tint m=0;\n\tfor(int i=0;i<(n<<1);i++)\n\t{\n\t\tif(vis[i])\n\t\t{\n\t\t\tt[m]=s[i];\n\t\t\tm++;\n\t\t}\n\t}\n\tt[m]='\\0';\n}\nchar s1[8192],s2[8192];\nint main()\n{\n\tscanf(\"%d%s\",&n,s);\n\tint numa=0,numb=0;\n\tfor(int i=0;i<(n<<1);i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\twza[numa]=i;\n\t\t\tnuma++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twzb[numb]=i;\n\t\t\tnumb++;\n\t\t}\n\t}\n\twza[n]=1000000;\n\twzb[n]=1000000;\n\tmx[n]=n;\n\tfor(int i=n-1;i>=0;i--)\n\t{\n\t\tif(wza[i]<wzb[i])\n\t\t{\n\t\t\tfor(int j=i+1;;j++)\n\t\t\t{\n\t\t\t\tif(wza[j]>wzb[i])\n\t\t\t\t{\n\t\t\t\t\tnxt[i]=mx[j];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(wzb[i+1]<wza[i])\n\t\t\t{\n\t\t\t\tnxt[i]=i+1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnxt[i]=mx[i+1];\n\t\t\t}\n\t\t}\n\t\tbuild(i,s1);\n\t\tbuild(mx[i+1],s2);\n\t\tmx[i]=mx[i+1];\n\t\tfor(int j=0;;j++)\n\t\t{\n\t\t\tif(s1[j]>s2[j])\n\t\t\t{\n\t\t\t\tmx[i]=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(s1[j]<s2[j])\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(s1[j]=='\\0')\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tbuild(mx[0],s1);\n\tprintf(\"%s\\n\",s1);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n// #define int long long\n// #define double long double\n#define rep(i,n) for (int i=0; i<(int)(n); ++i)\n#define rep1(i,n) for (int i=1; i<(int)(n); ++i)\n#define repeq(i,n) for (int i=0; i<=(int)(n); ++i)\n#define rep1eq(i,n) for (int i=1; i<=(int)(n); ++i)\n#define rrep(i,n) for (int i=(int)(n)-1; i>=0; --i)\n#define rrep1(i,n) for (int i=(int)(n)-1; i>0; --i)\n#define rrepeq(i,n) for (int i=(int)(n); i>=0; --i)\n#define rrep1eq(i,n) for (int i=(int)(n); i>0; --i)\n#define REP(i,a,b) for (int i=(int)(a); i<=(int)(b); ++i)\n#define RREP(i,a,b) for (int i=(int)(a); i>=(int)(b); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\nusing ll = long long;\nusing vi = vector<int>;\nusing vl = vector<ll>;\nusing vb = vector<bool>;\ntemplate<typename T> using Graph = vector<vector<T>>;\ntemplate<typename T> using Spacial = vector<vector<vector<T>>>;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\ntemplate<typename T> using greater_priority_queue = priority_queue<T, vector<T>, greater<T>>;\nconst int MOD = 1e9+7;\nconst int MOD2 = 998244353;\n// const double EPS = 1e-9;\nconst int dx[4] = {1, 0, -1, 0};\nconst int dy[4] = {0, 1, 0, -1};\nstring interval[2] = {\" \", \"\\n\"}; // {\" \", \"\\n\"}\n\ntemplate<typename T> struct is_plural : false_type{};\ntemplate<typename T1, typename T2> struct is_plural<pair<T1, T2>> : true_type{};\ntemplate<typename T> struct is_plural<vector<T>> : true_type{};\ntemplate<typename T> struct is_plural<complex<T>> : true_type{};\n \ntemplate<typename T1, typename T2> istream &operator>>(istream &is, pair<T1, T2> &p) { return is >> p.first >> p.second; }\ntemplate<typename T1, typename T2> ostream &operator<<(ostream &os, const pair<T1, T2> &p) { return os << p.first << \" \" << p.second; }\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &vec) { for (auto itr = vec.begin(); itr != vec.end(); ++itr) is >> *itr; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, const vector<T> &vec) { if (vec.empty()) return os; bool pl = is_plural<T>(); os << vec.front(); for (auto itr = ++vec.begin(); itr != vec.end(); ++itr) os << interval[pl] << *itr; return os; }\n \nbool CoutYN(bool a, string y = \"Yes\", string n = \"No\") { cout << (a ? y : n) << \"\\n\"; return a; }\n\ntemplate<typename T1, typename T2> inline bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\ntemplate<typename T1, typename T2> inline bool chmin(T1 &a, T2 b) { return a > b && (a = b, true); }\n\nlong long modpow(int a, long long n, int mod = MOD) { long long ret = 1; do { if (n & 1) ret = ret * a % mod; a = 1LL * a * a % mod; } while (n >>= 1); return ret; }\n\ntemplate<typename T> T GCD(T a, T b) { return b ? GCD(b, a%b) : a; }\ntemplate<typename T> T LCM(T a, T b) { return a / GCD(a, b) * b; }\n\ntemplate<typename T1, typename T2> bool CompareBySecond(pair<T1, T2> a, pair<T1, T2> b) { return a.second != b.second ? a.second < b.second : a.first < b.first; }\ntemplate<typename T1, typename T2> bool CompareByInverse(pair<T1, T2> a, pair<T1, T2> b) { return a.first != b.first ? a.first < b.first : a.second > b.second; }\n\n\n/* -------- <templates end> -------- */\n\n\nvoid solve() {\n  int n; cin >> n;\n  string s; cin >> s;\n\n  Graph<int> pos(2);\n  rep(i,2*n) pos[s[i] - 'a'].emplace_back(i);\n\n  int last = n;\n  while (last-- > 0 && pos[0][last] < pos[1][last]);\n\n  vector<string> dp(last + 1);\n  int suffix = 0;\n  int idx = -1;\n\n  while (++last < n) {\n    if (idx < pos[0][last]) {\n      ++suffix;\n      idx = pos[1][last];\n    }\n  }\n\n  last = dp.size();\n  string MAX;\n  queue<int> nxt;\n\n  rrep(i,last) {\n    if (pos[0][i] < pos[1][i]) {\n      dp[i] = MAX;\n      continue;\n    }\n\n    nxt.emplace(pos[0][i]);\n    dp[i].push_back('b');\n\n    REP(j,i+1,last-1) {\n      while (!nxt.empty() && nxt.front() < pos[1][j]) {\n        nxt.pop();\n        dp[i].push_back('a');\n      }\n\n      if (nxt.empty()) {\n        dp[i] += dp[j];\n        break;\n      }\n\n      dp[i].push_back('b');\n      nxt.emplace(pos[0][j]);\n    }\n\n    while (!nxt.empty()) {\n      nxt.pop();\n      dp[i].push_back('a');\n    }\n\n    if (!chmax(MAX, dp[i])) dp[i] = MAX;\n  }\n\n  cout << MAX;\n  while (suffix--) cout << \"ab\";\n}\n\n\n/* -------- <programs end> -------- */\n\n\nsigned main() {\n  cin.tie(nullptr);\n  ios::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  solve();\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define range(i, m, n) for(int i = m; i < n; i++)\n#define husk(i, m, n) for(int i = m; i > n; i--)\n\nint n;\nstring s;\n\nint main() {\n  cin >> n >> s;\n  vector<int> a, b;\n  range(i, 0, 2 * n) {\n    if(s[i] == 'a') a.push_back(i);\n    else b.push_back(i);\n  }\n  vector<string> dp(n + 1);\n  husk(i, n - 1, -1) {\n    dp[i] = dp[i + 1];\n    if(b[i] < a[i]) {\n      int pos = i;\n      string c;\n      vector<int> id;\n      while(pos < n && b[pos] < a[pos]) {\n        id.push_back(b[pos]);\n        id.push_back(a[pos]);\n        pos++;\n      }\n      sort(id.begin(), id.end());\n      for(int j : id) c += s[j];\n      dp[i] = max(dp[i], c + dp[pos]);\n    } else {\n      int pos = i;\n      string c;\n      while(pos < n && a[pos] < b[pos]) {\n        c += \"ab\";\n        int cur = pos;\n        while(pos < n && a[pos] < b[cur]) pos++;\n      }\n      dp[i] = max(dp[i], c + dp[pos]);\n    }\n  }\n  cout << dp[0];\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#define FOR(i,a,b) for(int i=a;i<=b;i++)\n#define ROF(i,a,b) for(int i=a;i>=b;i--)\nusing namespace std;\nconst int N=6000;\nint n,A,B,cnt,x,y,m,sum,id[N],p[N],q[N];\nchar s[N];\nstring S,P,T; \nvoid work(int l,int r){\n\tA=B=0;\n\tFOR(i,l,r) s[i]=='a'?id[p[++A]=i]=A:id[q[++B]=i]=B;\n\tif(p[1]==l){\n\t\tfor(cnt=1,x=1,y=2;y<=A;y++)\n\t\t\tif(q[x]<p[y]) x=y,cnt++;\n\t\tP=\"\";\n\t\tFOR(i,0,cnt) S=max(S,P+T),P=P+\"ab\";\n\t\tT=S;\n\t}\n\tif(q[1]==l){\n\t\tcnt=(r-l+1)>>1;\n\t\tFOR(i,0,cnt){\n\t\t\tP=\"\";\n\t\t\tFOR(j,l,r)if(id[j]>i) P=P+s[j];\n\t\t\tS=max(S,P+T);\n\t\t}\n\t\tT=S;\n\t}\n}\nint main(){\n\t//freopen(\"1.in\",\"r\",stdin);\n\tscanf(\"%d%s\",&n,s+1);m=n<<1;\n\tROF(i,m,1){\n\t\tsum+=s[i]=='a'?-1:1;\n\t\tif(!sum) work(i,m),m=i-1;\n\t}\n\tcout<<S<<'\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring calc(string S){\n    int N = S.size()/2;\n    vector<int> as, bs, order(2*N), mxi;\n    int sum = 0, mx = 0;\n    for(int i=0; i<2*N; i++){\n        order[i] = (S[i] == 'a' ? as : bs).size();\n        (S[i] == 'a' ? as : bs).push_back(i);\n        sum += (S[i] == 'a' ? -1 : 1);\n        if(sum == mx){\n            mxi.push_back(i);\n        }else if(sum > mx){\n            mx = sum;\n            mxi = {i};\n        }\n    }\n\n    if(mx == 0){\n        string ans, ab = \"ab\";\n        int i = 0;\n        while(i < 2*N){\n            if(S[i] == 'a'){\n                ans.append(ab);\n                i = bs[order[i]];\n            }else{\n                i++;\n            }\n        }\n        return ans;\n    }\n\n    string ans;\n    for(int s : mxi){\n        vector<bool> use(2*N);\n        for(int i=order[s]-mx+1; i<=order[s]; i++) use[as[i]] = use[bs[i]] = 1;\n        string res;\n        for(int i=0; i<2*N; i++){\n            if(s < i && S[i] == 'b' && i < as[order[i]]){\n                use[i] = use[as[order[i]]] = 1;\n            }\n            if(use[i]){\n                res.push_back(S[i]);\n            }\n        }\n        ans = max(res, ans);\n    }\n    return ans;\n}\n\nint main(){\n    int N;\n    string S;\n    cin >> N >> S;\n    vector<int> zeros;\n    int sum = 0;\n    for(int i=0; i<2*N; i++){\n        if(sum == 0) zeros.push_back(i);\n        sum += (S[i] == 'a' ? -1 : 1);\n    }\n    zeros.push_back(2*N);\n    int sz = zeros.size();\n    vector<string> parts;\n    for(int k=0; k<sz-1; k++) parts.push_back(calc(S.substr(zeros[k], zeros[k+1]-zeros[k])));\n    reverse(parts.begin(), parts.end());\n    string ans;\n    for(auto s : parts) ans = max(ans, s + ans);\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define REP(i,a,b) for(int i=(a),_end_=(b);i<=_end_;i++)\n#define DREP(i,a,b) for(int i=(a),_end_=(b);i>=_end_;i--)\n#define EREP(i,u) for(int i=start[u];i;i=e[i].next)\n#define fi first\n#define se second\n#define mkr(a,b) make_pair(a,b)\n#define SZ(A) ((int)A.size())\ntemplate<class T>inline void chkmin(T &a,T b){ if(a>b)a=b;}\ntemplate<class T>inline void chkmax(T &a,T b){ if(a<b)a=b;}\ninline int read()\n{\n\tint s=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch) && ch!='-')ch=getchar();\n\tif(ch=='-')ch=getchar(),f=-1;\n\twhile(isdigit(ch))s=s*10+ch-'0',ch=getchar();\n\treturn ~f?s:-s;\n}\n\nconst int maxn=3e3+20;\n\nchar str[maxn];\nint s[maxn<<1];\nint a[maxn],b[maxn];\nint n;\n\nbitset<3020>f[maxn];\n\ninline void init()\n{\n\tn=read();\n\tint an=0,bn=0;\n\tscanf(\"%s\",str+1);\n\tREP(i,1,2*n)\n\t{\n\t\tif(str[i]=='a')a[++an]=i,s[i]=an;\n\t\telse b[++bn]=i,s[i]=bn+n;\n\t}\n}\n\ninline string GetString(bitset<3020>f)\n{\n\tstatic int vis[6020];\n\tmemset(vis,0,sizeof(int)*(2*n+1));\n\tREP(i,1,n)if(f[i])vis[a[i]]=1,vis[b[i]]=1;\n\tstring S;\n\tREP(i,1,2*n)if(vis[i])S+=str[i];\n\treturn S;\n}\n\ninline int ID(int x){ return s[x]>n?s[x]-n:s[x];}\n\ninline void doing()\n{\n\tDREP(i,n,1)\n\t{\n\t\tf[i]=f[i+1];\n\t\tbitset<3020>tmp;\n\t\ttmp.set(i);\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\t//tmp|=f[i+b[i]-a[i]];\n\t\t\tint far=i;\n\t\t\tREP(j,a[i]+1,b[i]-1)chkmax(far,ID(j));\n\t\t\ttmp|=f[far+1];\n\t\t}else {\n\t\t\tint far=a[i];\n\t\t\t//REP(j,b[i]+1,far)\n\t\t\tfor(int j=b[i]+1;j<=far;j++)\n\t\t\t\tif(ID(j)>i && s[j]>n)tmp.set(s[j]-n),chkmax(far,a[s[j]-n]);\n\t\t\tint to=far+1;\n\t\t\tif(to<=2*n)\n\t\t\t{\n\t\t\t\tto=s[to]>n?s[to]-n:s[to];\n\t\t\t\ttmp|=f[to];\n\t\t\t}\n\t\t}\n\t\tstring A=GetString(f[i]),B=GetString(tmp);\n\t\tf[i]=A>B?f[i]:tmp;\n\t}\n\tstring s=GetString(f[1]);\n\tcout<<s<<endl;\n\t\n}\n\nint main()\n{\n\tinit();\n\tdoing();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, n) for (rint i = 1; i <= int(n); i ++)\n#define re0(i, n) for (rint i = 0; i < (int) n; i ++)\n#define travel(i, u) for (rint i = head[u]; i; i = e[i].nxt)\n#define rint register int\nusing namespace std;\n\ntypedef long long lo;\n\ntemplate<typename tp> inline void read(tp &x) {\n    x = 0; char c = getchar(); int f = 0;\n    for (; c < '0' || c > '9'; f |= c == '-', c = getchar());\n    for (; c >= '0' && c <= '9'; x = (x << 3) + (x << 1) + c - '0', c = getchar());\n    if (f) x = -x;\n}\n\nconst int N = 6666;\nint B[N], B_cnt, A[N], A_cnt;\nchar str[N]; int m, n;\nstring dp[N];\n\nstring doit(int l) {\n\tif (l > n) return \"\";\n\tint cnt = 0;\n\tfor (int i = l; i <= n; i++) cnt += B[i] < A[i];\n\tstring ans = \"\";\n\tif (!cnt) {\n\t\tint la = 0;\n\t\tfor (int i = l; i <= n; i++) {\n\t\t\tif (A[i] > la) {\n\t\t\t\tans += \"ab\";\n\t\t\t\tla = B[i];\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tint la = -1, pa = -1;\n\tvector <int> vis(2 * n + 1, 0);\n\tfor (int i = l; i <= n; i++) {\n\t\tif (B[i] > la && la != -1) break;\n\t\tif (B[i] < A[i] && (la == -1 || B[i] < la)) {\n\t\t\tvis[B[i]] = true;\n\t\t\tvis[A[i]] = true;\n\t\t\tla = A[i];\n\t\t\tpa = i;\n\t\t}\n\t}\n\trep (i, 2 * n) if (vis[i]) ans += str[i];\n\treturn ans + dp[pa + 1];\n}\n\nint main(void) {\n\tread(n); m = 2 * n;\n\tscanf(\"%s\", str + 1);\n\trep (i, m) {\n\t\tif (str[i] == 'a') A[++A_cnt] = i;\n\t\telse B[++B_cnt] = i;\n\t}\n\tfor (int i = n; i >= 1; i--) {\n\t\tdp[i] = max(doit(i), dp[i + 1]);\n\t}\n\tcout << dp[1] << \"\\n\";\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<=k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<=k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int l=1;l<=len;l++)s1[l+len1]=ans[l];\n\t\tlen1+=len;\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 6010;\nint n;char s[N];\n\nbool kind[N];\nstring f[N];\nint cnt,pos[N];\nint bel[N];\n\nint main()\n{\n\tcin >> n;\n\tscanf(\"%s\",s);\n\tfor(int _s=0,i=0;i<2*n;i++){\n\t\t_s+=(s[i]=='b')?1:-1;\n\t\tif(!_s){\n\t\t\tpos[++cnt]=i;\n\t\t\tkind[cnt] = s[i]=='a'?0:1;\n\t\t}\n\t}\n\tpos[0]=-1;\n\tbool v=1;\n\tfor(int i=cnt;i;i--){\n\t\tif(!kind[i]){\n\t\t\tv=0;\n\t\t\tint s1=0,s2=0;\n\t\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++){\n\t\t\t\tif(s[j]=='b')bel[j]=++s1;\n\t\t\t\telse bel[j]=++s2;\n\t\t\t}\n\t\t\tf[i]=f[i+1];\n\t\t\tfor(int j=1;j<=s1;j++){\n\t\t\t\tstring c;\n\t\t\t\tfor(int k=pos[i-1]+1;k<=pos[i];k++){\n\t\t\t\t\tif(bel[k]>=j)c+=s[k];\n\t\t\t\t}\n\t\t\t\tf[i]=max(f[i], c+f[i+1]);\n\t\t\t}\n\t\t}\n\t\telse if(v){\n\t\t\tint s1=0,s2=0;\n\t\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++){\n\t\t\t\tif(s[j]=='a')bel[j]=++s1;else bel[j]=++s2;\n\t\t\t}\n\t\t\tint r = pos[i-1]+1;\n\t\t\tfor(;;){\n\t\t\t\twhile(r<=pos[i]&&s[r]=='b')++r;\n\t\t\t\tif(r>pos[i])break;\n\t\t\t\tf[i]+=\"ab\";\n\t\t\t\tint t=bel[r];\n\t\t\t\tr++;\n\t\t\t\twhile(bel[r]!=t)r++;\n\t\t\t\tr++;\n\t\t\t}\n\t\t\tf[i]+=f[i+1];\n\t\t}else f[i]=f[i+1];\n\t}\n\tcout << f[1] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define pw(x) (1LL << (x))\n#define db(x) cerr << #x << \" = \" << x << endl\n#define db2(x, y) cerr << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef double dbl;\nconst int INF = 1.01e9;\nconst int MOD = (int)1e9 + 7;\n\nstring fast1(int n, string s) {\n    vector<vector<int>> pos(2);\n    for (int i = 0; i < n * 2; i++) {\n        pos[s[i] - 'a'].push_back(i);\n    }\n    vector<pair<int, int>> b;\n    for (int i = 0; i < n; i++) {\n        b.push_back({pos[0][i], pos[1][i]});\n    }\n\n    string t;\n    vector<int> vct;\n    for (int i = n - 1; i >= 0; i--) {\n        int mn = min(b[i].first, b[i].second);\n        int mx = max(b[i].first, b[i].second);\n        int j = 0;\n        while (j < (int)vct.size() && vct[j] < mx) j++;\n\n        auto nt = t;\n        nt.insert(nt.begin() + j, s[mx]);\n        nt.insert(nt.begin(), s[mn]);\n        auto nvct = vct;\n        nvct.insert(nvct.begin() + j, mx);\n        nvct.insert(nvct.begin(), mn);\n\n        if (t < nt) {\n            t = nt;\n            vct = nvct;\n        }\n    }\n    return t;\n}\n\nstring fast(int n, string s) {\n    vector<vector<int>> pos(2);\n    for (int i = 0; i < n * 2; i++) {\n        pos[s[i] - 'a'].push_back(i);\n    }\n    vector<pair<int, int>> b;\n    for (int i = 0; i < n; i++) {\n        b.push_back({pos[0][i], pos[1][i]});\n    }\n\n    auto str = [&](const vector<int> &vct) {\n        string res;\n        for (int x : vct) res += s[x];\n        return res;\n    };\n\n    vector<vector<int>> vct;\n    for (int i = n - 1; i >= 0; i--) {\n        int mn = min(b[i].first, b[i].second);\n        int mx = max(b[i].first, b[i].second);\n        vct.push_back(vector<int>({mn, mx}));\n\n        while (1) {\n            if (vct.size() <= 1) break;\n            auto v1 = vct[vct.size() - 2];\n            auto v2 = v1;\n            for (int x : vct.back()) v2.push_back(x);\n            sort(v2.begin(), v2.end());\n\n            string o = str(v2);\n            /*if (o.length() >= 2 && o[1] == 'a' && o[0] == 'a') {\n                vct.pop_back();\n                break;\n            }*/\n            if (str(v1) < str(v2)) {\n                vct.pop_back();\n                vct.back() = v2;\n            } else break;\n        }\n    }\n    string t = \"\";\n    for (auto v : vct) t=  max(t, str(v));\n    return t;\n}\n\nstring slow(int n, string s) {\n    vector<vector<int>> pos(2);\n    for (int i = 0; i < n * 2; i++) {\n        pos[s[i] - 'a'].push_back(i);\n    }\n    vector<pair<int, int>> b;\n    for (int i = 0; i < n; i++) {\n        b.push_back({pos[0][i], pos[1][i]});\n    }\n\n    string ans;\n    for (int mask = 0; mask < (1 << n); mask++) {\n        vector<int> vct;\n        for (int i = 0; i < n; i++) if (mask & (1 << i)) {\n            vct.push_back(b[i].first);\n            vct.push_back(b[i].second);\n        }\n        sort(vct.begin(), vct.end());\n        string res = \"\";\n        for (int x : vct) res += s[x];\n        ans = max(ans, res);\n    }\n    return ans;\n}\n\nint main() {\n#ifdef HOME\n    assert(freopen(\"in\", \"r\", stdin));\n#endif\n\n    if (0) {\n        for (int it = 9;; it++) {\n            srand(it);\n\n            cout << it << endl;\n            int n = rand() % 4 + 1;\n            string s = \"\";\n            for (int i = 0; i < n; i++) s += \"ab\";\n            random_shuffle(s.begin(), s.end());\n\n            auto ans1 = fast(n, s);\n            auto ans2 = slow(n, s);\n            if (ans1 != ans2) {\n                cout << s << endl;\n                cout << ans1 << \" instead of \" << ans2 << endl;\n                return 0;\n            }\n        }\n    }\n\n    int n;\n    string s;\n    while (cin >> n >> s) {\n        cout << max(fast(n, s), fast1(n, s)) << endl;\n    }\n\n#ifdef HOME\n    cerr << \"time = \" << (clock() * 1. / CLOCKS_PER_SEC) << \"\\n\";\n#endif\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//https://atcoder.jp/contests/agc026/tasks/agc026_e\n#include<iostream>\n#include<string>\n#include<vector>\n\nint n;\nstd::string s;\nstd::vector<int> cor;\n\nstd::vector<int> match; // index in s => matching index in t\nbool check(std::string const& t){\n\tint constexpr DELETED=-1;\n\tmatch.assign(2*n,-2);\n\n\tint ti=0; // match index in t\n\tint si=0; // match index in s\n\twhile(t[ti]){\n\t\twhile(true){\n\t\t\tif(!t[ti])\n\t\t\t\treturn true;\n\t\t\telse if(si==(int)s.size())\n\t\t\t\treturn false;\n\t\t\telse if(match[si]==DELETED){\n\t\t\t\t++si;\n\t\t\t\tcontinue;\n\t\t\t}else if(s[si]!=t[ti]){\n\t\t\t\tmatch[si]=DELETED;\n\t\t\t\tif(cor[si]<si){\n\t\t\t\t\tsi=cor[si];\n\t\t\t\t\tti=match[si];\n\t\t\t\t\tmatch[si]=DELETED;\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tmatch[cor[si]]=DELETED;\n\t\t\t\t\t++si;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tmatch[si]=ti;\n\t\t\t\t++si;++ti;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nint main(){\n\tstd::ios::sync_with_stdio(0);std::cin.tie(0);\n\tstd::cin>>n;\n\ts.reserve(2*n);\n\tstd::cin>>s;\n\n\tcor.resize(2*n);\n\tfor(int a=-1,b=-1,_=n;_--;){\n\t\tdo ++a;while(s[a]!='a');\n\t\tdo ++b;while(s[b]!='b');\n\t\tcor[a]=b;cor[b]=a;\n\t}\n\n\tstd::string ans;ans.reserve(2*n);\n\twhile(true){\n\t\tans+='b';\n\t\tif(!check(ans)){\n\t\t\tans.back()='a';\n\t\t\tif(!check(ans)){\n\t\t\t\tans.pop_back();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tstd::cout<<ans<<'\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 6006;\nint n;\nstring A;\nint main()\n{\n    cin >> n >> A;\n    string S;\n    for (int l = n + n - 1, r = n + n, s = 0; ~ l; l--)\n    {\n        s += (A[l] == 'a') - (A[l] == 'b');\n        if (!s)\n        {\n            string T;\n            if (A[l] == 'a')\n            {\n                for (int i = l; i < r; i++)\n                    if (A[i] == 'a')\n                    {\n                        T += \"ab\";\n                        while (A[i] != 'b')\n                            i ++;\n                    }\n            }\n            else\n            {\n                int a = 0, b = 0;\n                for (int i = l; i < r; i++)\n                {\n                    a += (A[i] == 'a');\n                    b += (A[i] == 'b');\n                    if (A[i] == 'b')\n                    {\n                        string R;\n                        for (int j = i, c = a; j < r; j++)\n                        {\n                            c += (A[j] == 'a');\n                            if (A[j] == 'b' || b <= c)\n                                R += A[j];\n                        }\n                        T = max(T, R);\n                    }\n                }\n            }\n            S = max(S, T + S);\n            r = l;\n        }\n    }\n    cout << S << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/**\n * File    : E.cpp\n * Author  : Kazune Takahashi\n * Created : 2018-7-16 14:04:12\n * Powered by Visual Studio Code\n */\n\n#include <iostream>\n#include <iomanip>   // << fixed << setprecision(xxx)\n#include <algorithm> // do { } while ( next_permutation(A, A+xxx) ) ;\n#include <vector>\n#include <string> // to_string(nnn) // substr(m, n) // stoi(nnn)\n#include <complex>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <map> // if (M.find(key) != M.end()) { }\n#include <set>\n#include <functional>\n#include <random> // auto rd = bind(uniform_int_distribution<int>(0, 9), mt19937(19920725));\n#include <chrono> // std::chrono::system_clock::time_point start_time, end_time;\n// start = std::chrono::system_clock::now();\n// double elapsed = std::chrono::duration_cast<std::chrono::milliseconds>(end_time-start_time).count();\n#include <cctype>\n#include <cassert>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\nusing namespace std;\n\n#define DEBUG 0 // change 0 -> 1 if we need debug.\n\ntypedef long long ll;\n\n// const int dx[4] = {1, 0, -1, 0};\n// const int dy[4] = {0, 1, 0, -1};\n\n// const int C = 1e6+10;\n// const ll M = 1000000007;\n\nint N;\nint M;\nstring S;\nvector<string> V;\nvector<string> W;\n\nvoid make_V()\n{\n  int a = 0;\n  int b = 0;\n  int start = 0;\n  for (auto i = 0; i < M; i++)\n  {\n    if (S[i] == 'a')\n    {\n      a++;\n    }\n    else\n    {\n      b++;\n    }\n    if (a == b)\n    {\n      a = b = 0;\n      V.push_back(S.substr(start, i + 1 - start));\n      start = i + 1;\n    }\n  }\n}\n\nvector<int> make_num(string str)\n{\n  vector<int> num;\n  int a = 0;\n  int b = 0;\n  for (auto c : str)\n  {\n    if (c == 'a')\n    {\n      num.push_back(a);\n      a++;\n    }\n    else\n    {\n      num.push_back(b);\n      b++;\n    }\n  }\n  return num;\n}\n\nstring calc_a(string str)\n{\n  vector<int> num = make_num(str);\n  string res = \"\";\n  bool is_a = true;\n  int search = -1;\n  for (auto i = 0; i < (int)str.size(); i++)\n  {\n    if (is_a && str[i] == 'a')\n    {\n      res += \"a\";\n      search = num[i];\n      is_a = false;\n    }\n    else if ((!is_a) && str[i] == 'b')\n    {\n      if (num[i] == search)\n      {\n        res += \"b\";\n        is_a = true;\n      }\n    }\n  }\n  return res;\n}\n\nstring calc_b(string str)\n{\n  vector<int> num = make_num(str);\n  vector<string> X;\n  for (auto k = 0; k <= (int)str.size() / 2; k++)\n  {\n    string temp = \"\";\n    for (auto i = 0; i < (int)str.size(); i++)\n    {\n      if (num[i] >= k)\n      {\n        string s{str[i]};\n        temp += s;\n      }\n    }\n    X.push_back(temp);\n  }\n  return *max_element(X.begin(), X.end());\n}\n\nint main()\n{\n  cin >> N >> S;\n  M = 2 * N;\n  make_V();\n  for (auto str : V)\n  {\n    if (str[0] == 'a')\n    {\n      W.push_back(calc_a(str));\n    }\n    else\n    {\n      W.push_back(calc_b(str));\n    }\n  }\n  reverse(W.begin(), W.end());\n  string ans = \"\";\n  for (auto str : W)\n  {\n    if (ans < str + ans)\n    {\n      ans = str + ans;\n    }\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define fi first\n#define se second\n#define rep(i,n) for(int i = 0; i < (n); ++i)\n#define rrep(i,n) for(int i = 1; i <= (n); ++i)\n#define drep(i,n) for(int i = (n)-1; i >= 0; --i)\n#define srep(i,s,t) for (int i = s; i < t; ++i)\n#define rng(a) a.begin(),a.end()\n#define maxs(x,y) (x = max(x,y))\n#define mins(x,y) (x = min(x,y))\n#define limit(x,l,r) max(l,min(x,r))\n#define lims(x,l,r) (x = max(l,min(x,r)))\n#define pb push_back\n#define sz(x) (int)(x).size()\n#define pcnt __builtin_popcountll\n#define uni(x) x.erase(unique(rng(x)),x.end())\n#define snuke srand((unsigned)clock()+(unsigned)time(NULL));\n#define show(x) cout<<#x<<\" = \"<<x<<endl;\n#define PQ(T) priority_queue<T,v(T),greater<T> >\n#define bn(x) ((1<<x)-1)\n#define dup(x,y) (((x)+(y)-1)/(y))\n#define newline puts(\"\")\n#define v(T) vector<T>\n#define vv(T) v(v(T))\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<P> vp;\ninline int in() { int x; scanf(\"%d\",&x); return x;}\ntemplate<typename T>inline istream& operator>>(istream&i,v(T)&v)\n{rep(j,sz(v))i>>v[j];return i;}\ntemplate<typename T>string join(const v(T)&v)\n{stringstream s;rep(i,sz(v))s<<' '<<v[i];return s.str().substr(1);}\ntemplate<typename T>inline ostream& operator<<(ostream&o,const v(T)&v)\n{if(sz(v))o<<join(v);return o;}\ntemplate<typename T1,typename T2>inline istream& operator>>(istream&i,pair<T1,T2>&v)\n{return i>>v.fi>>v.se;}\ntemplate<typename T1,typename T2>inline ostream& operator<<(ostream&o,const pair<T1,T2>&v)\n{return o<<v.fi<<\",\"<<v.se;}\ntemplate<typename T>inline ll suma(const v(T)& a) { ll res(0); for (auto&& x : a) res += x; return res;}\nconst double eps = 1e-10;\nconst ll LINF = 1e18;\nconst int INF = 1001001001;\n#define dame { puts(\"-1\"); return 0;}\n#define yn {puts(\"YES\");}else{puts(\"NO\");}\nconst int MX = 200005;\ntypedef v(string) vs;\n\nstring fa(string s) {\n  int n = sz(s);\n  vi a, b;\n  rep(i,n) {\n    if (s[i] == 'a') a.pb(i);\n    else b.pb(i);\n  }\n  vi is(n);\n  rep(i,sz(a)) is[a[i]] = i;\n  rep(i,sz(b)) is[b[i]] = i;\n  string res;\n  rep(i,n) {\n    if (s[i] == 'b') continue;\n    res += \"ab\";\n    i = b[is[i]];\n  }\n  return res;\n}\nstring fb(string s) {\n  int n = sz(s);\n  vi a, b;\n  rep(i,n) {\n    if (s[i] == 'a') a.pb(i);\n    else b.pb(i);\n  }\n  vi is(n);\n  rep(i,sz(a)) is[a[i]] = i;\n  rep(i,sz(b)) is[b[i]] = i;\n  string res;\n  rep(si,sz(b)) {\n    string now;\n    rep(i,n) if (is[i] >= si) now += s[i];\n    maxs(res,now);\n  }\n  return res;\n}\nstring f(string s) {\n  if (s[0] == 'a') return fa(s);\n  return fb(s);\n}\n\nint main() {\n  int n;\n  scanf(\"%d\",&n);\n  n <<= 1;\n  string s;\n  cin>>s;\n  int cnt = 0;\n  string ns;\n  vs t;\n  rep(i,n) {\n    if (s[i] == 'a') ++cnt; else --cnt;\n    ns += s[i];\n    if (!cnt) t.pb(f(ns)), ns = \"\";\n  }\n  string ans;\n  drep(i,sz(t)) {\n    string now = t[i]+ans;\n    maxs(ans,now);\n  }\n  cout<<ans<<endl;\n  return 0;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define x first\n#define y second\n\nusing namespace std;\n\ntypedef pair<double,double> pdd;\nconst int INF=1e+7;\nconst int MAX=6005;\nchar s[MAX];\nint n,chk[MAX],lim;\nvector<int> p[2],cut;\nstruct group{\n    int idx;\n    string part;\n    bool operator<(const group &x){\n        if(part!=x.part) return part>x.part;\n        return idx<x.idx;\n    }\n};\ngroup wtf[MAX];\nint main(){\n    scanf(\" %d %s\",&n,s);\n    for(int i=0;i<2*n;i++) p[s[i]-'a'].push_back(i);\n    cut.push_back(0);\n    for(int i=0;i<n;i++) {\n        chk[p[0][i]]=1,chk[p[1][i]]=1;\n        lim=max(lim,max(p[0][i],p[1][i]));\n        if(lim==2*i+1) cut.push_back(i+1);\n    }\n    for(int i=0;i<2*n;i++) chk[i]=0;\n    for(int i=0;i<cut.size()-1;i++){\n        wtf[i].idx=i;\n        if(p[0][cut[i]]>p[1][cut[i]]){\n            for(int j=cut[i+1]-1;j>=cut[i];j--){\n                chk[p[0][j]]=1,chk[p[1][j]]=1;\n                string tmp;\n                for(int k=0;k<2*n;k++) if(chk[k]) tmp.push_back(s[k]);\n                wtf[i].part=max(wtf[i].part,tmp);\n            }\n        }\n        else{\n            int pt=-1;\n            for(int j=cut[i];j<cut[i+1];j++){\n                if(pt<p[0][j]) pt=p[1][j], wtf[i].part.append(\"ab\");\n            }\n        }\n        for(int j=cut[i];j<cut[i+1];j++) chk[p[0][j]]=0,chk[p[1][j]]=0;\n    }\n    sort(wtf,wtf+(cut.size()-1));\n    lim=-1;\n    for(int i=0;i<cut.size()-1;i++) if(lim<wtf[i].idx) lim=wtf[i].idx, cout<<wtf[i].part;\n    cout<<'\\n';\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define REP(i,a,b) for(int i=(a),_end_=(b);i<=_end_;i++)\n#define DREP(i,a,b) for(int i=(a),_end_=(b);i>=_end_;i--)\n#define EREP(i,u) for(int i=start[u];i;i=e[i].next)\n#define fi first\n#define se second\n#define mkr(a,b) make_pair(a,b)\n#define SZ(A) ((int)A.size())\ntemplate<class T>inline void chkmin(T &a,T b){ if(a>b)a=b;}\ntemplate<class T>inline void chkmax(T &a,T b){ if(a<b)a=b;}\ninline int read()\n{\n\tint s=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch) && ch!='-')ch=getchar();\n\tif(ch=='-')ch=getchar(),f=-1;\n\twhile(isdigit(ch))s=s*10+ch-'0',ch=getchar();\n\treturn ~f?s:-s;\n}\n\nconst int maxn=3e3+20;\n\nchar str[maxn<<1];\nint s[maxn<<1];\nint a[maxn],b[maxn];\nint n;\n\nbitset<3020>f[maxn];\n\ninline void init()\n{\n\tn=read();\n\tint an=0,bn=0;\n\tscanf(\"%s\",str+1);\n\tREP(i,1,2*n)\n\t{\n\t\tif(str[i]=='a')a[++an]=i,s[i]=an;\n\t\telse b[++bn]=i,s[i]=bn+n;\n\t}\n}\n\ninline string GetString(bitset<3020>f)\n{\n\tstatic int vis[6020];\n\tmemset(vis,0,sizeof(int)*(2*n+1));\n\tREP(i,1,n)if(f[i])vis[a[i]]=1,vis[b[i]]=1;\n\tstring S;\n\tREP(i,1,2*n)if(vis[i])S+=str[i];\n\treturn S;\n}\n\ninline int ID(int x){ return s[x]>n?s[x]-n:s[x];}\n\ninline void doing()\n{\n\tDREP(i,n,1)\n\t{\n\t\tf[i]=f[i+1];\n\t\tbitset<3020>tmp;\n\t\ttmp.set(i);\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\t//tmp|=f[i+b[i]-a[i]];\n\t\t\tint far=i;\n\t\t\tREP(j,a[i]+1,b[i]-1)chkmax(far,ID(j));\n\t\t\ttmp|=f[far+1];\n\t\t}else {\n\t\t\tint far=a[i];\n\t\t\t//REP(j,b[i]+1,far)\n\t\t\tfor(int j=b[i]+1;j<=far;j++)\n\t\t\t\tif(ID(j)>i && s[j]>n)tmp.set(s[j]-n),chkmax(far,a[s[j]-n]);\n\t\t\tint to=far+1;\n\t\t\tif(to<=2*n)\n\t\t\t{\n\t\t\t\tto=s[to]>n?s[to]-n:s[to];\n\t\t\t\ttmp|=f[to];\n\t\t\t}\n\t\t}\n\t\tstring A=GetString(f[i]),B=GetString(tmp);\n\t\tf[i]=A>B?f[i]:tmp;\n\t}\n\tstring s=GetString(f[1]);\n\tcout<<s<<endl;\n\t\n}\n\nint main()\n{\n\tinit();\n\tdoing();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n\nusing namespace std;\nconst int maxn = 6e3+5;\nstring ans,a,orz,now;\nint sm[maxn],aw[maxn],bw[maxn],ac,bc;\nint dy[maxn];\nint n;\nbool mark[maxn];\nvoid solve(int l,int r) {\n\torz = \"\";\n\tif(a[l]=='a') {\n\t\tfor(int j=l;j<=r;j++) {\n\t\t\tif(a[j]=='a') orz += \"ab\" , j = dy[j];\n\t\t}\n\t\treturn;\n\t} else {\n\t\tnow = \"\";\n\t\tfor(int cd=(r-l+1)/2;cd>=1;cd--) {\n\t\t\tint yo = cd;\n\t\t\tfor(int i=r;i>=l&&yo;i--) {\n\t\t\t\tif(a[i]=='b') {\n\t\t\t\t\tmark[i] = mark[dy[i]] = 1; yo--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=l;i<=r;i++) {\n\t\t\t\tif(mark[i]) {\n\t\t\t\t\tnow += a[i];\n\t\t\t\t\tmark[i] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\torz = max(orz,now);\n\t}\n}\nint main() {\n\tcin>>n>>a;\n\ta = \" \"+a;\n\tfor(int i=1;i<=n*2;i++) {\n\t\tsm[i] = (a[i]=='a'?1:-1);\n\t\tsm[i] += sm[i-1];\n\t\tif(a[i]=='a') aw[++ac] = i;\n\t\telse bw[++bc] = i;\n\t}\n\tfor(int i=1;i<=n;i++) dy[aw[i]] = bw[i] , dy[bw[i]] = aw[i];\n\tint lst = 2*n;\n\tfor(int i=2*n-1;i>=0;i--) {\n\t\tif(sm[i]==0) {\n\t\t\tsolve(i+1,lst);\n\t\t\tlst = i;\n\t\t\tans = max(ans,orz+ans);\n\t\t}\n\t}\n\tcout<<ans;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n\nconst int MN = 3005;\n\nint N, pa[MN], pb[MN], id[MN * 2], nx[MN * 2];\nstd::string str, f[MN];\n\nint main() {\n\tstd::cin >> N >> str;\n\tstr = \" \" + str;\n\tfor (int i = 1, a = 0, b = 0; i <= N * 2; ++i)\n\t\tif (str[i] == 'a') pa[id[i] = ++a] = i;\n\t\telse pb[id[i] = ++b] = i;\n\tpa[N + 1] = pb[N + 1] = N * 2 + 1, id[N * 2 + 1] = N + 1;\n\tfor (int i = 1, j = 0; i <= N + 1; ++i)\n\t\twhile (j < std::min(pa[i], pb[i]))\n\t\t\tnx[++j] = i;\n\tfor (int i = N; i >= 1; --i) {\n\t\tif (pa[i] > pb[i]) {\n\t\t\tint j = pb[i];\n\t\t\tfor (; pb[id[j]] < pa[id[j]] && (id[j] <= i || pb[id[j]] < pa[id[j] - 1]); ++j)\n\t\t\t\tif (id[j] >= i) f[i] += str[j];\n\t\t\tf[i] += f[id[j]];\n\t\t} else f[i] = \"ab\" + f[nx[pb[i] + 1]];\n\t\tf[i] = std::max(f[i], f[i + 1]);\n\t}\n\tstd::cout << f[1];\n\treturn 0;\n}\n\n// Luogu : PinkRabbit"
  },
  {
    "language": "C++",
    "code": "//problem:agc026_e\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fst first\n#define scd second\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\ninline int read(){\n\tint f=1,x=0;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\ninline ll readll(){\n\tll f=1,x=0;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\n\nconst int MAXN=6005;\nchar s[MAXN];\nstring res[MAXN],dp;\nint n,ca,cb,tot,a[MAXN],b[MAXN],rk[MAXN];\nint main() {\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n*2;++i)if(s[i]=='a')a[++ca]=i,rk[i]=ca;else b[++cb]=i,rk[i]=cb;\n\tfor(int i=1,lst=0;i<=n;++i)if(i==n||max(a[i],b[i])<min(a[i+1],b[i+1])){\n\t\tif(a[i]<b[i]){\n\t\t\tres[++tot]=\"\";\n\t\t\tint pre=0;\n\t\t\tfor(int j=lst+1;j<=i;++j)if(a[j]>b[pre])res[tot]+=\"ab\",pre=j;\n\t\t}else{\n\t\t\tres[++tot]=\"\";\n\t\t\tfor(int j=lst+1;j<=i;++j){\n\t\t\t\tstring tmp=\"\";\n\t\t\t\tfor(int k=b[j];k<=a[i];++k)if(rk[k]>=j)tmp+=s[k];\n\t\t\t\tres[tot]=max(res[tot],tmp);\n\t\t\t}\n\t\t}\n\t\tlst=i;\n\t}\n\tfor(int i=tot;i>=1;--i)dp=max(dp,res[i]+dp);\n\tcout<<dp<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n//    ios_base::sync_with_stdio(0); cin.tie(0);\n    int n; string s;\n    cin >> n >> s;\n    vector<pair<int, int>> vals;\n    vector<string> mx(n + 1);\n    vector<int> go(2 * n);\n    vector<int> label(2 * n);\n    int it1 = 0, it2 = 0;\n    while(it1 != 2 * n && it2 != 2 * n){\n        while(s[it1] != 'a') it1++;\n        while(s[it2] != 'b') it2++;\n        vals.emplace_back(min(it1, it2), max(it1, it2));\n        go[it1] = it2, go[it2] = it1;\n        it1++, it2++;\n    }\n    sort(vals.begin(), vals.end());\n    for(int i = 0; i < n; i++){\n        label[vals[i].first] = i;\n        label[vals[i].second] = i;\n    }\n    for(int loc = n - 1; loc >= 0; loc--){\n        int st = vals[loc].first, ed = vals[loc].second;\n        int last = st;\n        if(s[st] == 'b'){\n            int cut = ed;\n            while(last != cut){\n                cut = max(cut, go[last]);\n                last++;\n            }\n            if(go[last] > last) last--;\n        }\n        else{\n            last = ed;\n        }\n        string fin = \"\";\n        if(s[st] == 'a'){\n            fin = \"ab\";\n        }\n        else{\n            for(int i = st; i <= last; i++){\n                if(s[i] == 'a' && go[i] < st) continue;\n                fin += s[i];\n            }\n        }\n        int nxt = -1;\n        for(int i = last + 1; i < 2 * n; i++){\n            if(go[i] > i){\n                nxt = i;\n                break;\n            }\n        }\n        if(nxt != -1) fin += mx[label[nxt]];\n        mx[loc] = max(mx[loc + 1], fin);\n    }\n    cout << mx[0] << '\\n';\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n,la[N];\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint check2(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn 1;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=1,j=1;i<=n;i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj++;\n\t\t}\n\t\tla[j-1]=i-1;\n\t}\n\tfor (int i=n,j=n;i;i=j){\n\t\tint cnt=0;\n\t\tj=la[i];\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check2(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int, int> pii;\n\nconst int MN = 3010;\n\nint N;\nstring S;\nint chk[MN << 1], inva[MN << 1], invb[MN << 1];\nvector<pii> seg;\n\nbool cmp(string &a, string &b) {\n    int n = a.size();\n    for(int i = 0; i < b.size(); i++) {\n        if(a[i % n] != b[i]) return a[i % n] > b[i];\n    }\n    return true;\n}\n\nint main() {\n    std::ios::sync_with_stdio(false);\n\n    cin >> N >> S;\n\n    int cnt1 = 0;\n    int cnt2 = 0;\n    for(int i = 0; i < 2 * N; i++) {\n        if(S[i] == 'a') chk[i] = cnt1++, inva[ chk[i] ] = i;\n        else chk[i] = cnt2++, invb[ chk[i] ] = i;\n    }\n\n    int sum = 0, st = 0;\n    for(int i = 0; i < 2 * N; i++) {\n        if(S[i] == 'a') sum++;\n        else sum--;\n        if(sum == 0) {\n            seg.push_back({st, i});\n            st = i + 1;\n        }\n    }\n    seg.push_back({st, 2 * N - 1});\n\n    string ans;\n    for(int i = (int)seg.size() - 1; i >= 0; i--) {\n        int l = seg[i].first;\n        int r = seg[i].second;\n\n        if(S[l] == 'a') {\n            string tmp;\n            for(int j = l; j <= r; j++) {\n                if(S[j] == 'a') {\n                    tmp.push_back('a');\n                    tmp.push_back('b');\n                    j = invb[ chk[j] ];\n                }\n            }\n            if(cmp(tmp, ans)) ans = tmp + ans;\n        }\n        else {\n            int ll = chk[l];\n            int rr = chk[r];\n\n            string mx;\n            for(int j = rr; j >= ll; j--) {\n                string tmp;\n                for(int k = l; k <= r; k++) {\n                    if(chk[k] >= j) tmp.push_back(S[k]);\n                }\n                if(mx < tmp) mx = tmp;\n            }\n            if(cmp(mx, ans)) ans = mx + ans;\n        }\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <cmath>\n#include <iomanip>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <iterator>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define x first\n#define y second\n#define mp make_pair\n#define up_b upper_bound\n#define low_b lower_bound\n#define sz(x) (int)x.size()\n#define bit __builtin_popcount\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,int> pii;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\ntypedef tree<int,null_type,less<int>,rb_tree_tag,tree_order_statistics_node_update> indexed_set;\n\nconst ll INF=1e18+123;\nconst ld EPS=1e-9;\nconst int inf=1e9+123;\nconst int MOD=1e9+7;\nconst int N=1e5+123;\nconst int dx[]={0,0,1,-1};\nconst int dy[]={1,-1,0,0};\n\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    int n;\n    string s;\n    cin>>n;\n    cin>>s;\n    n+=n;\n    string ans=\"\",l=\"\",q=\"\";\n    int ca=0,cb=0;\n    for(int i=0;i<n;i++){\n        if(s[i]=='a'){\n            ca++;\n        }\n        else{\n            cb++;\n        }\n        q+=s[i];\n        if(ca==cb){\n            if(q[0]=='a'){\n                for(int j=0;j<sz(q);j++){\n                    if(q[j]=='a' && ca==cb){\n                        l+='a';\n                        ca++;\n                    }\n                    if(q[j]=='b' && ca!=cb){\n                        l+='b';\n                        cb++;\n                    }\n                }\n            }\n            else{\n                l.clear();\n                string mx=q;\n                for(;sz(q);){\n                    bool da=0,db=0;\n                    for(int j=0;j<sz(q) && (!da || !db);j++){\n                        if(q[j]=='a' && !da){\n                            da=1;\n                            q.erase(q.begin()+j);\n                            j--;\n                        }\n                        else if(q[j]=='b' && !db){\n                            db=1;\n                            q.erase(q.begin()+j);\n                            j--;\n                        }\n                    }\n                    mx=max(q,mx);\n                }\n                ans+=mx;\n            }\n            ca=0;\n            cb=0;\n            q.clear();\n        }\n    }\n    ans+=l;\n    cout<<ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cctype>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\n#define rep(i,n) for (int i=0;i<n;++i)\n#define REP(i,n) for (int i=1;i<=n;++i)\n#define all(x) x.begin(),x.end()\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define F first\n#define S second\n#define read(x) scanf(\"%d\",&x)\nbool operator < (const string &s1,const string &s2){\n\tint sZ=min(s1.size(),s2.size());\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]<s2[i]) return 1;\n\t\telse if (s1[i]>s2[i]) return 0;\n\treturn s1.size()<s2.size();\n}\nbool operator > (const string &s1,const string &s2){\n\tint sZ=min(s1.size(),s2.size());\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]>s2[i]) return 1;\n\t\telse if (s1[i]<s2[i]) return 0;\n\treturn s1.size()>s2.size();\n}\nbool operator == (const string &s1,const string &s2){\n\tint sZ=s1.size();if (sZ!=s2.size()) return 0;\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]!=s2[i]) return 0;\n\treturn 1;\n}\nint n;\nstring s;\nstruct segment{\n\tint l,r;bool type;\n\tsegment(int L=0,int R=0,bool TYPE=0):l(L),r(R),type(TYPE){}\n\tsegment operator = (const segment &sg){\n\t\tl=sg.l;r=sg.r;type=sg.type;return *this;\n\t}\n};\nsegment seg[6005];int cntseg=0;\nint rank_to_a[6005],rank_to_b[6005],a_to_rank[6005],b_to_rank[6005];\nbool used_rank[6005];\npair<string,int> material_string[6005];\nstruct info{\n\tstring s;int ptr,verdict;\n\tbitset<6005> must;\n\tinfo(int i=0):ptr(i),verdict(1){must.reset();must.set(rank_to_a[b_to_rank[i]]);s.clear();s.pb('b');}\n};\nvector<info> tmp;\ninline string segProcess(segment sg){\n\tbool tp=sg.type;\n\tstring ret;\n\tint l=sg.l,r=sg.r;\n\tif (tp==0){\n\t\tfor (int i=l;i<=r;++i){\n\t\t\tret.pb('a');ret.pb('b');\n\t\t\ti=rank_to_b[a_to_rank[i]];\n\t\t}\n\t\treturn ret;\n\t}\n\tif (tp==1){\n\t\tint best_next=11;// 0:a  1:b  -1:end\n\t\ttmp.clear();\n\t\tfor (int i=l;i<=r;++i){\n\t\t\tif (s[i]=='b') tmp.pb(info(i));\n\t\t}\n\t\twhile(best_next!=-1){\n\t\t\tbest_next=-1;\n\t\t\tfor (int i=0;i<tmp.size();++i){\n\t\t\t\tinfo &temp=tmp[i];\n\t\t\t\ttemp.ptr++;\n\t\t\t\tif (temp.ptr>r){\n\t\t\t\t\ttemp.verdict=-1;continue;\n\t\t\t\t}\n\t\t\t\twhile(temp.ptr<=r&&s[temp.ptr]=='a'&&temp.must[temp.ptr]==0) ++temp.ptr;\n\t\t\t\tif (temp.ptr>r){\n\t\t\t\t\ttemp.verdict=-1;continue;\n\t\t\t\t}\n\t\t\t\tif (s[temp.ptr]=='a') temp.s+='a',temp.verdict=0,best_next=max(best_next,0);\n\t\t\t\telse temp.s+='b',temp.verdict=1,temp.must[rank_to_a[b_to_rank[temp.ptr]]]=1,best_next=1;\n\t\t\t}\n\t\t\tfor (vector<info>::iterator it=tmp.begin();it!=tmp.end();){\n\t\t\t\tif (it->verdict < best_next) it=tmp.erase(it);\n\t\t\t\telse ++it;\n\t\t\t}\n\t\t}\n\t\treturn tmp[0].s;\n\t}\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>n>>s;s='*'+s;n*=2;\n\tint cnta=0,cntb=0;\n\tfor (int i=1;i<=n;++i){\n\t\tif (s[i]=='a'){\n\t\t\trank_to_a[++cnta]=i;\n\t\t\ta_to_rank[i]=cnta;\n\t\t}\n\t\telse{\n\t\t\trank_to_b[++cntb]=i;\n\t\t\tb_to_rank[i]=cntb;\n\t\t}\n\t}\n\tint l=1,r;bool type;\n\tif (s[1]=='a') r=rank_to_b[1],type=0;\n\telse r=rank_to_a[1],type=1;\n\tused_rank[1]=1;\n\tfor (int i=2;i<=n;++i){\n\t\tif (i>r){\n\t\t\tseg[++cntseg]=segment(l,r,type);\n\t\t\tl=i;\n\t\t\tif (s[i]=='a') r=rank_to_b[a_to_rank[i]],type=0;\n\t\t\telse r=rank_to_a[b_to_rank[i]],type=1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a'&&type==0){\n\t\t\tr=max(r,rank_to_b[a_to_rank[i]]);\n\t\t}\n\t\tif (s[i]=='b'&&type==1){\n\t\t\tr=max(r,rank_to_a[b_to_rank[i]]);\n\t\t}\n\t}\n\tseg[++cntseg]=segment(l,r,type);\n\tfor (int i=1;i<=cntseg;++i) material_string[i]=mp(segProcess(seg[i]),-i);\n\tsort(material_string+1,material_string+cntseg+1);\n\treverse(material_string+1,material_string+cntseg+1);\n\tint begin=0;\n\tfor (int i=1;i<=cntseg;++i){\n\t\tif (material_string[i].F[0]=='a') break;\n\t\telse if (-material_string[i].S>begin){\n\t\t\tbegin=-material_string[i].S;\n\t\t\tcout<<material_string[i].F;\n\t\t}\n\t}\n\tfor (int i=1;i<=cntseg;++i){\n\t\tif (material_string[i].F[0]=='a'&&-material_string[i].S>begin) cout<<material_string[i].F;\n\t}\n\tcout<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string ans;\n  vector<int> bestind;\n  vector<string> bestsave(n+1);\n  vector<vector<int>> bestsave_ind(n+1);\n  for (int x = n; x >= 0; x--) {\n    if (ans < bestsave[x]) {\n      ans = move(bestsave[x]);\n      bestind = move(bestsave_ind[x]);\n    }\n    string cur = ans;\n    vector<int> ind = bestind;\n    for (int i = x - 1; i >= 0; i--) {\n      {\n        int p1 = lower_bound(ind.begin(), ind.end(), a[i]) - ind.begin();\n        ind.insert(ind.begin() + p1, a[i]);\n        cur.insert(cur.begin() + p1, 'a');\n      }\n      {\n        int p2 = lower_bound(ind.begin(), ind.end(), b[i]) - ind.begin();\n        ind.insert(ind.begin() + p2, b[i]);\n        cur.insert(cur.begin() + p2, 'b');\n      }\n      if (cur > bestsave[i]) {\n        bestsave[i] = cur;\n        bestsave_ind[i] = ind;\n      }\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\nconst int MAX_N = 6e3 + 5;\n\nstring s;\nint posa [MAX_N];\nint posb [MAX_N];\nint idx [MAX_N];\nint dead [MAX_N];\nint dp [MAX_N];\n\nvector<string> sol;\n\nstring sfr (int sta) {\n  string ans;\n\n  int bal = 0;\n  for (int i = sta; true; i++) {\n    if (!dead[i]) {\n      if (s[i] == 'b') {\n        bal++;\n        ans += 'b';\n      } else {\n        if (posb[idx[i]] >= sta) {\n          bal--;\n          ans += 'a';\n        }\n      }\n    }\n    \n    if (bal == 0) break;\n  }\n\n  return ans;\n}\n\nint process (int sta) {\n  string ans;\n\n  int bal = 0;\n  for (int i = sta; true; i++) {\n    if (!dead[i]) {\n      if (s[i] == 'b') {\n        bal++;\n        ans = max(ans, sfr(i));\n      } else {\n        bal--;\n      }\n    }\n    \n    if (bal == 0) {\n      sol.push_back(ans);\n      return i + 1;\n    }\n  }\n}\n\nint main () {\n  int n;\n  cin >> n;\n\n  cin >> s;\n\n  int ca = 0, cb = 0;\n  for (int i = 0; i < 2 * n; i++) {\n    if (s[i] == 'a') {\n      posa[ca] = i;\n      idx[i] = ca;\n      ca++;\n    } else {\n      posb[cb] = i;\n      idx[i] = cb;\n      cb++;\n    }\n  }\n\n  int m = 0; // the length of the first half\n  for (int i = 0; i < n; i++) {\n    if (posb[i] < posa[i]) {\n      m = max(m, posa[i] + 1);\n    }\n  }\n\n  for (int i = 0; i < n; i++) {\n    if (posa[i] < posb[i] && posb[i] < m) {\n      dead[posa[i]] = 1;\n      dead[posb[i]] = 1;\n    }\n  }\n\n  int curp = 0;\n  while (curp < m) {\n    curp = process(curp);\n  }\n\n  string suffmx;\n  for (int i = (int) sol.size() - 1; i >= 0; i--) {\n    if (sol[i] >= suffmx) {\n      suffmx = sol[i];\n    } else {\n      sol[i].clear();\n    }\n  }\n\n  for (int i = 0; i < (int) sol.size(); i++) {\n    cout << sol[i];\n  }\n  \n  // second half with dp\n  // number of independent pairs 'ab'\n  int sc = 0;\n  for (int i = m + 1; i < 2 * n; i++) {\n    if (s[i] == 'b') {\n      dp[i] = max(1 + dp[posa[idx[i]]], dp[i - 1]);\n    } else {\n      dp[i] = dp[i - 1];\n    }\n    sc = max(sc, dp[i]);\n  }\n\n  for (int i = 0; i < sc; i++) {\n    cout << \"ab\";\n  }\n  cout << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int MX = 3000;\n\nchar s[2 * MX + 1];\nint id[2 * MX];\nbool used[MX];\n\nint main() {\n\tint n;\n\tignore = scanf(\"%d %s\", &n, s);\n\t\n\tfor (int i = 0, p = 0, q = 0; i < 2 * n; i++) {\n\t\tid[i] = s[i] == 'a' ? p++ : q++;\n\t}\n\t\n\tauto get = [&]() {\n\t\tstring res;\n\t\tfor (int i = 0; i < 2 * n; i++) if (used[id[i]]) res += s[i];\n\t\treturn res;\n\t};\n\t\n\tfor (int i = n - 1; i >= 0; i--) {\n\t\tauto s = get();\n\t\tused[i] = true;\n\t\tauto t = get();\n\t\tused[i] = t > s;\n\t}\n\t\n\tprintf(\"%s\\n\", get().c_str());\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define N 3010\nstring Beta(string s){\n    if(s.size()==0)return \"#\";\n    if(s[0]=='a')return \"#\";\n    string res=\"\";\n    for(int i=0;i<s.size();i++){\n        ll a=0,b=0;\n        string cur=\"\";\n        for(int j=0;j<s.size();j++){\n         if(s[j]=='a'){\n             if(a>=i)cur.push_back(s[j]);\n             a++;\n         }\n         if(s[j]=='b'){\n             if(b>=i)cur.push_back(s[j]);\n             b++;\n         }\n        }\n        //cout<<\"#\"<<cur<<endl;\n     res=max(res,cur);\n    }\n    //cout<<s<<\" \"<<res<<endl;\n    return res;\n}\nll n;\nstring s;\nll A[N],B[N],C[N];;\nint main(){\n    cin>>n>>s;\n    ll a=0,b=0;\n    string q=\"\";\n    typedef pair<string,ll> P;\n    vector<P> v;\n    for(int i=0;i<2*n;i++){\n     q.push_back(s[i]);\n     if(s[i]=='a'){A[a]=i;a++;}\n     if(s[i]=='b'){B[b]=i;b++;}\n     if(a==b){\n      string res=Beta(q);\n      if(res!=\"#\"){\n       v.push_back(make_pair(res,-i));   \n      }\n      q=\"\";   \n     }\n    }//cout<<\"initend\"<<endl;\n    sort(v.begin(),v.end(),greater<P>());\n    for(int i=0;i<n;i++){\n     C[A[i]]=B[i];\n     C[B[i]]=A[i];\n    }\n    ll cur=-1;\n    string ans=\"\";\n    for(auto x:v){\n     string str=x.first;\n     ll p=-x.second;\n     if(p<cur)continue;\n      cur=p;\n     ans+=str;\n    }cur++;\n    for(;cur<2*n;){\n        for(;cur<2*n;cur++){\n         if(s[cur]=='a')break;   \n        }\n        if(cur==2*n)break;\n        ans+=\"ab\";\n        cur=C[cur]+1;\n    }\n    cout<<ans<<endl;\n return  0;   \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[3005];\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#ifdef LOCAL\n#include \"debug.h\"\n#else\n#define DEBUG(...)\n#endif\n\nint main() {\n  cin.tie(nullptr);\n  ios::sync_with_stdio(false);\n  int n;\n  cin >> n;\n  string s;\n  cin >> s;\n  int ta = 0, tb = 0;\n  vector<int> id(2 * n);\n  vector<int> posa(n), posb(n);\n  for (int i = 0; i < 2 * n; ++i) {\n    if (s[i] == 'a') {\n      id[i] = ta++;\n      posa[id[i]] = i;\n    } else {\n      id[i] = tb++;\n      posb[id[i]] = i;\n    }\n  }\n  vector<string> dp(2 * n + 1);\n  for (int i = 2 * n; i--; ) {\n    if (s[i] == 'a' and posb[id[i]] > i) {\n      dp[i] = \"ab\" + dp[posb[id[i]] + 1];\n    } else if (s[i] == 'b' and posa[id[i]] > i) {\n      vector<int> v;\n      int p = i;\n      while (true) {\n        int q = posa[id[p]];\n        v.push_back(p);\n        v.push_back(q);\n        ++p;\n        while (p < q and s[p] != 'b') {\n          p++;\n        }\n        if (s[p] != 'b') break;\n      }\n      sort(begin(v), end(v));\n      for (int e : v) {\n        dp[i] += s[e];\n      }\n      dp[i] += dp[v.back() + 1];\n    }\n    dp[i] = max(dp[i], dp[i + 1]);\n  }\n  cout << dp[0] << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] < s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\tint til = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t/*if (min(pos[j].second, pos[j].first) > pos[b].second){\n\t\t\t\tngg=true;\n\t\t\t}*/\n\t\t\tif (pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\t/*if (ngg){\n\t\t\t\t\tputs(\"YEA\");\n\t\t\t\t}*/\n\t\t\t\ttil = j;\n\t\t\t}\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t/*if (min(pos[j].second, pos[j].first)> pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}*/\n\t\t\tif(pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t}\n\t\t}\n\t\tif (cmp(nex, dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\tnex=dfs(j3);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\t//a     b\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].first;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\nstring solve(string s){\n\tint n = s.size();\n\tstring res;\n\tvi idx(n);\n\tint a = 0, b = 0;\n\trep(i, n){\n\t\tif(s[i] == 'a') idx[i] = a++;\n\t\telse idx[i] = b++;\n\t}\n\t\n\tif(s[0] == 'a'){\n\t\tfor(int i = 0; i < n; ){\n\t\t\tres += \"ab\";\n\t\t\tfor(int k = idx[i++]; i < n && idx[i] != k; i++);\n\t\t}\n\t\treturn res;\n\t}\n\t\n\trep(k, n / 2){\n\t\tstring tmp;\n\t\trep(i, n) if(idx[i] >= k) tmp += s[i];\n\t\tres = max(res, tmp);\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n, k = 0; string s, ans, tmp;\n\tcin >> n >> s;\n\tvector<string> v;\n\tfor(char c : s){\n\t\ttmp += c;\n\t\tk += c == 'a' ? 1 : -1;\n\t\tif(k == 0){\n\t\t\tv.pb(solve(tmp)); tmp.clear();\n\t\t}\n\t}\n\tfor(int i = v.size() - 1; i >= 0; i--){\n\t\tif(ans < v[i] + ans) ans = v[i] + ans;\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 6e3 + 5;\n\nint N;\nstring s;\nstring dp[MAXN];\nbool good[MAXN];\nvector <int> a, b;\nint idx[MAXN];\nbool taken[MAXN];\n\nvoid load() {\n\tcin >> N >> s;\n}\n\nstring get(int x) {\n\tstring res = \"\";\n\twhile (x <= N) {\n\t\tif (s[x] == 'a' && b[idx[x]] > x) {\n\t\t\tres += \"ab\";\n\t\t\tx = b[idx[x]];\n\t\t}\n\t\tx++;\n\t}\n\treturn res;\n}\n\nstring greedy(int pos) {\n\tmemset(taken, false, sizeof taken);\n\t\n\tvector <int> v;\n\tfor (; pos <= N; pos++) {\n\t\tif (!v.empty() && pos > v.back())\n\t\t\tbreak;\n\t\tif (good[pos]) {\n\t\t\tv.push_back(a[idx[pos]]);\n\t\t\ttaken[pos] = taken[v.back()] = true;\n\t\t}\n\t}\n\t\n\tstring res = \"\";\n\tfor (int i = 1; i <= N; i++)\n\t\tif (taken[i])\n\t\t\tres += s[i];\n\t\n\tif (!dp[pos].empty())\n\t\treturn res + dp[pos];\n\t\n\treturn res + get(pos);\n}\n\nstring solve() {\n\tN *= 2;\n\ts = ' ' + s;\n\tfor (int i = 1; i <= N; i++)\n\t\tif (s[i] == 'a')\n\t\t\ta.push_back(i);\n\t\telse\n\t\t\tb.push_back(i);\n\t\n\tfor (int i = 0; i < b.size(); i++) {\n\t\tif (a[i] > b[i]) \n\t\t\tgood[b[i]] = true;\n\t\tidx[a[i]] = i;\n\t\tidx[b[i]] = i;\n\t}\n\t\n\tfor (int i = N; i >= 0; i--) {\n\t\tdp[i] = dp[i + 1];\n\t\tif (good[i]) {\n\t\t\tstring tmp = greedy(i);\n\t\t\tif (tmp > dp[i])\n\t\t\t\tdp[i] = tmp;\n\t\t}\n\t}\n\t\n\treturn dp[0].empty() ? get(1) : dp[0];\n}\n\nint main() {\n\tload();\n\tcout << solve() << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint n, a[3005], b[3005], mat[6005];\nchar dp[6005][6005], s[6005];\nint main() {\n    scanf(\"%d%s\", &n, s);\n    for (int i = 0, ai = 0, bi = 0; i < 2 * n; i++)\n        if (s[i] == 'a')\n            a[ai++] = i;\n        else\n            b[bi++] = i;\n    for (int i = 0; i < n; i++)\n        mat[a[i]] = b[i], mat[b[i]] = a[i];\n    n *= 2;\n    for (int i = n - 1; i >= 0; i--) {\n        if (mat[i] < i) {\n            strcpy(dp[i], dp[i + 1]);\n        } else {\n            if (s[i] == 'a') {\n                dp[i][0] = 'a';\n                dp[i][1] = 'b';\n                strcpy(dp[i] + 2, dp[mat[i] + 1]);\n            } else {\n                int si = 0, ed = mat[i];\n                for (int j = i; j <= ed; j++)\n                    if (i <= mat[j]) {\n                        dp[i][si++] = s[j];\n                        ed = max(ed, mat[j]);\n                    }\n                strcpy(dp[i] + si, dp[ed + 1]);\n            }\n            if (strcmp(dp[i], dp[i + 1]) < 0)\n                strcpy(dp[i], dp[i + 1]);\n        }\n    }\n    puts(dp[0]);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> stk;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      string res = naive(string(s.begin() + i, s.begin() + last));\n      while (!stk.empty() && (stk.back() + res) < res) stk.pop_back();\n      stk.push_back(res);\n      i = r - 1;\n    }\n  }\n  for (const auto& str : stk)\n    ans += str;\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      ans += naive(string(s.begin() + i, s.begin() + last));\n      i = r - 1;\n    }\n  }\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\t\n\tint lenx=strlen(x+1),leny=strlen(y+1),ans=0; \n\tbool flag=1;\n\tfor (int i=3;i<=lenx;i++)\n\t\tif (x[i]!=x[i-2]) { flag=0; break; }\n\tfor (int i=3;i<=leny;i++)\n\t\tif (y[i]!=y[i-2]) { flag=0; break; }\n\tif (flag)\n\t{\n\t\tif (x[1]==y[1]&&x[2]==y[2]) return 2;\n\t}\n\t\n\tint len=max(lenx,leny);\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return ans^1;\n\t\telse if (x[i]<y[i]) return ans;\n\treturn 2;\n}\n\nint compare(char *x,char *y,int len)\n{\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t],len)==1)\n\t\t\t{\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=NULL;\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n20\nba ab bbabaa bbbabbabbabbaaaaaa aabb aabababb\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n// #include <cstdlib>\n#include <cstring>\n#include <cstdio>\n#include <string>\n#include <queue>\n#include <cmath>\n#include <set>\n#include <map>\n#include <bitset>\n#include <iostream>\nusing namespace std;\ntypedef long long LL;\ntypedef double db;\nconst int oo=2139063143;\nconst int N=6010;\nconst int P=1000000007;\nconst db eps=1e-7;\n#define pritnf printf\n//char buf[1<<22],*p1=buf,*p2=buf,obuf[1<<22],*O=obuf;\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\ntemplate <typename T>\ninline void sc (T &x)\n{\n    x=0; static int p; p=1; static char c; c=getchar();\n    while (!isdigit(c)) { if (c=='-') p=-1; c=getchar(); }\n    while ( isdigit(c)) { x=(x<<1)+(x<<3)+(c-48); c=getchar(); }\n    x*=p;\n}\ntemplate <typename T>\ninline void print (T x)\n{\n    if (x< 0) putchar('-'),x=-x;\n    if (x>=10) print(x/10);\n    putchar(x%10+'0');\n}\ntemplate <typename T>\ninline void pr (T x) { print(x),putchar('\\n'); }\ntemplate <typename T1,typename T2>\nvoid chkmax (T1 &A,T2 B) { A=A>=B?A:B; }\ntemplate <typename T1,typename T2>\nvoid chkmin (T1 &A,T2 B) { A=A<=B?A:B; }\n\nstring f[N],s,ans;\nint n,a[N],b[N],id[N],p[N];\nint find (int x)\n{\n\tfor (int i=1; i<=n>>1; i++)\n\t\tif (min (a[i],b[i])> x) return i;\n\treturn n/2+1;\n}\nstring get (int l,int r)\n{\n\tstring g=\"\";\n\tfor (int i=l; i<=r; i++)\n\t\tif (id[i]>=id[l]) g+=s[i];\n\treturn g;\n}\nint main ()\n{\n    // freopen (\".in\",\"r\",stdin);\n    // freopen (\".out\",\"w\",stdout);\n    sc(n); n<<=1;\n\tcin>>s;\n\tfor (int i=0; i< n; i++)\n\t\tif (s[i]=='a') a[++a[0]]=i,id[i]=a[0];\n\t\telse b[++b[0]]=i,id[i]=b[0];\n\tfor (int i=n>>1; i>=1; i--)\n\t{\n\t\tf[i]=f[i+1];\n\t\tif (a[i]< b[i])\n\t\t{\n\t\t\tchkmax (f[i],\"ab\"+f[find (b[i])]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint nx=a[i];\n\t\t\tfor (int j=b[i]; j<=nx; j++)\n\t\t\t\tif (s[j]=='b') chkmax (nx,a[id[j]]);\n\t\t\tchkmax (f[i],get (b[i],nx)+f[find (nx)]);\n\t\t}\n\t\tchkmax (ans,f[i]);\n\t\t//cout<<i<<' '<<f[i]<<endl;\n\t}\n\tcout<<ans;\n\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <vector>\n#define PB push_back\n#define ll long long\nusing namespace std;\ntemplate <class T>\ninline void rd(T &x) {\n\tx=0; char c=getchar(); int f=1;\n\twhile(!isdigit(c)) { if(c=='-') f=-1; c=getchar(); }\n\twhile(isdigit(c)) x=x*10-'0'+c,c=getchar(); x*=f;\n}\nvector<string> s;\nstring S,ans,cur;\nint n,m;\n\nvoid sol(string &s) {\n\tvector<int> p1,p2;\n\tstring t=\"\";\n\tfor(int i=0;i<s.length();++i)\n\t\tif(s[i]=='a') p1.PB(i);\n\t\telse p2.PB(i);\n\tif(s[0]=='a') {\n\t\tint last=-1;\n\t\tfor(int i=0;i<p1.size();++i)\n\t\t\tif(p1[i]>last) last=p2[i],t+=\"ab\";\n\t}\n\telse {\n\t\tfor(int i=0;i<p1.size();++i) {\n\t\t\tstring p=\"\";\n\t\t\tint x=i,y=i;\n\t\t\twhile(1)\n\t\t\t\tif(x<p1.size()&&(y==p2.size()||p1[x]<p2[y]))\n\t\t\t\t\tp+='a',x++;\n\t\t\t\telse if(y<p2.size())\n\t\t\t\t\tp+='b',y++;\n\t\t\t\telse break;\n\t\t\tif(p>t) t=p;\n\t\t}\n\t}\n\ts=t;\n}\n\n\nint main() {\n\trd(n);\n\tcin>>S;\n\tint cnt=0;\t\n\tfor(int i=0;i<n*2;++i) {\n\t\tif(S[i]=='a') cnt++;\n\t\telse cnt--;\n\t\tcur+=S[i];\n\t\tif(cnt==0) {\n\t\t\ts.PB(cur);\n\t\t\tcur=\"\";\n\t\t}\n\t}\n\tfor(int i=0;i<s.size();++i) sol(s[i]);\n\tans=s.back();\n\tfor(int i=(int)s.size()-2;i>=0;--i) {\n\t\tint flg=1;\n\t\tfor(int j=0;j<min(s[i].length(),ans.length());++j)\n\t\t\tif(s[i][j]!=ans[j]) {\n\t\t\t\tif(s[i][j]<ans[j]) flg=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif(flg) ans=s[i]+ans;\n\t}\n\tcout<<ans;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\nusing namespace std;\n#define MOD @\n#define ADD(X,Y) ((X) = ((X) + (Y)%MOD) % MOD)\ntypedef long long i64; typedef vector<int> ivec; typedef vector<string> svec;\n\nint N;\nchar S[6060];\n\nstring dp[6060];\nvector<int> loca, locb;\nint ord[6060];\n\nint main()\n{\n\tscanf(\"%d%s\", &N, S);\n\n\tfor (int i = 0; i < 2 * N; ++i) {\n\t\tif (S[i] == 'a') {\n\t\t\tord[i] = loca.size();\n\t\t\tloca.push_back(i);\n\t\t} else {\n\t\t\tord[i] = locb.size();\n\t\t\tlocb.push_back(i);\n\t\t}\n\t}\n\n\tfor (int i = 2 * N - 1; i >= 0; --i) {\n\t\tdp[i] = dp[i + 1];\n\n\t\tint p = ord[i];\n\t\tint i2 = loca[p] + locb[p] - i;\n\t\tif (!(i < i2)) continue;\n\n\t\tif (S[i] == 'a') {\n\t\t\tdp[i] = max(dp[i], string(\"ab\") + dp[i2 + 1]);\n\t\t} else {\n\t\t\tstring tmp;\n\n\t\t\tint q = p;\n\t\t\tfor (;;) {\n\t\t\t\tif (max(loca[q], locb[q]) == q * 2 + 1) break;\n\t\t\t\t++q;\n\t\t\t}\n\n\t\t\tfor (int j = 0; j < 2 * N; ++j) {\n\t\t\t\tif (p <= ord[j] && ord[j] <= q) {\n\t\t\t\t\ttmp.push_back(S[j]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttmp += dp[q * 2 + 2];\n\n\t\t\tdp[i] = max(dp[i], tmp);\n\t\t}\n\t}\n\n\tprintf(\"%s\\n\", dp[0].c_str());\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \n// Shortcut\n \n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n \n// I/O & Debug\n \n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n \n// Functions\n \n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n \n// Data Structure\n \n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n \nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n \nint n;\nint a[2 * N];\nstring s, ans = \"\";\nvs b, c;\n \nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.assign(b.size(), \"\");\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans, c[i]);\n    }\n    cout << ans;\n}\n \n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n \n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n \n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 6020\n#define rep(i,l,r) for(register int i = l ; i <= r ; i++)\n#define repd(i,r,l) for(register int i = r ; i >= l ; i--)\n#define rvc(i,S) for(register int i = 0 ; i < (int)S.size() ; i++)\n#define rvcd(i,S) for(register int i = ((int)S.size()) - 1 ; i >= 0 ; i--)\n#define fore(i,x)for (register int i = head[x] ; i ; i = e[i].next)\n#define pb push_back\n#define prev prev_\n#define stack stack_\n#define mp make_pair\n#define fi first\n#define se second\n#define inf 0x3f3f3f3f\ntypedef long long ll;\ntypedef pair<int,int> pr;\n\nchar ch[maxn],ans[maxn],tmp[maxn],cur[maxn];\nint n,a[maxn],b[maxn],tota,totb,tot,len,len2,clen[maxn],tag[maxn],flen[maxn];\nchar vec[maxn / 2][maxn],f[maxn / 2][maxn];\n\nvoid getmx1(int x,int l,int r){\n\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\tint lastb = b[l];\n\trep(i,l + 1,r){\n\t\tif ( a[i] > lastb ){\n\t\t\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\t\t\tlastb = b[i];\n\t\t}\n\t}\n}\ninline int cmp(char s[],int l1,char t[],int l2){\n\trep(i,1,min(l1,l2)){\n\t\tif ( s[i] != t[i] ) return s[i] > t[i];\n\t}\n\treturn l1 >= l2;\n}\nvoid getmx2(int x,int l,int r){\n\tlen = 2;\n\ttmp[1] = 'b' , tmp[2] = 'a';\n\trep(i,l,r - 1){\n\t\tlen2 = 0;\n\t\tint pa = i , pb = i;\n\t\twhile ( pa <= r && pb <= r ){\n\t\t\tif ( a[pa] < b[pb] ) cur[++len2] = 'a' , pa++;\n\t\t\telse cur[++len2] = 'b' , pb++;\n\t\t}\n\t\twhile ( pa <= r ) cur[++len2] = 'a' , pa++;\n\t\twhile ( pb <= r ) cur[++len2] = 'b' , pb++;\n\t\tif ( !cmp(tmp,len,cur,len2) ){\n\t\t\trep(j,1,len2) tmp[j] = cur[j];\n\t\t\tlen = len2;\n\t\t}\n\t}\n\trep(i,1,len) vec[x][i] = tmp[i];\n\tclen[x] = len;\n}\nvoid getans(){\n\tlen = 0;\n\trepd(i,tot,1){\n\t\trep(j,1,clen[i]) f[i][j] = vec[i][j];\n\t\trep(j,1,len) f[i][j + clen[i]] = tmp[j];\n\t\tflen[i] = clen[i] + len;\t\n\t\tif ( cmp(f[i],flen[i],tmp,len) ){\n\t\t\trep(j,1,flen[i]) tmp[j] = f[i][j];\n\t\t\tlen = flen[i];\n\t\t}\n\t}\n\trep(i,1,len) putchar(tmp[i]);\n\tputs(\"\");\n}\nint main(){\n\t//freopen(\"input.txt\",\"r\",stdin);\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",ch + 1);\n\trep(i,1,n * 2){\n\t\tif ( ch[i] == 'a' ) a[++tota] = i;\n\t\telse b[++totb] = i;\n\t}\n\tint last = 1 , mx = 0;\n\trep(i,1,n){\n\t\tmx = max(mx,max(a[i],b[i]));\n\t\tif ( mx == i * 2 ){\n\t\t\t++tot;\n\t\t\tif ( a[i] < b[i] ) getmx1(tot,last,i);\n\t\t\telse getmx2(tot,last,i);\n\t\t\tlast = i + 1 , mx = 0;\n\t\t}\n\t}\n\tgetans();\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<vector>\nusing namespace std;\nvector<string> str,damn;\nvector<string> lis;\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tint n,i,j,k,l,lst=0,numa=0,numb=0,ite,nowa=0,nowb=0;\n\tstring s,t,hix;\n\tcin>>n>>s;\n\tfor(i=0;i<2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tnuma++;\n\t\t}\n\t\telse{\n\t\t\tnumb++;\n\t\t}\n\t\tif(numa==numb){\n\t\t\tstr.push_back(s.substr(lst,i-lst+1));\n\t\t\tlst=i+1;\n\t\t}\n\t}\n\tfor(i=0;i<str.size();i++){\n\t\tt=str[i];\n\t\thix=\"\";\n\t\tif(t[0]=='a'){\n\t\t\tite=0;\n\t\t\tnowa=0;\n\t\t\tnowb=0;\n\t\t\twhile(ite<t.size()){\n\t\t\t\t//cout<<ite<<endl;\n\t\t\t\twhile(ite<t.size()&&t[ite]=='b'){\n\t\t\t\t\tite++;\n\t\t\t\t\tnowb++;\n\t\t\t\t}\n\t\t\t\tif(ite==t.size()){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\thix+=\"ab\";\n\t\t\t\tj=nowa+1;\n\t\t\t\twhile(j>nowb){\n\t\t\t\t\tif(t[ite]=='b'){\n\t\t\t\t\t\tnowb++;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tnowa++;\n\t\t\t\t\t}\n\t\t\t\t\tite++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tnowb=0;\n\t\t\tfor(j=0;j<t.size();j++){\n\t\t\t\tif(t[j]=='b'){\n\t\t\t\t\tnowb++;\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnowb--;\n\t\t\t\t}\n\t\t\t\thix=max(hix,string(nowb,'b')+t.substr(j+1,t.size()-j-1));\n\t\t\t}\n\t\t}\n\t\tdamn.push_back(hix);\n\t}\n\tfor(i=0;i<damn.size();i++){\n\t\twhile(lis.size()&&lis.back()<damn[i]){\n\t\t\tlis.pop_back();\n\t\t}\n\t\tlis.push_back(damn[i]);\n\t}\n\tfor(i=0;i<lis.size();i++){\n\t\tcout<<lis[i];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define maxn 1000000001\nusing namespace std;\nlong long read(){\n    long long xx=0,flagg=1;\n    char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-')\n        ch=getchar();\n    if(ch=='-'){\n        flagg=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9'){\n        xx=xx*10+ch-'0';\n        ch=getchar();\n    }\n    return xx*flagg;\n}\nvoid pus(long long xx,long long flagg){\n    if(xx<0){\n        putchar('-');\n        xx=-xx;\n    }\n    if(xx>=10)\n        pus(xx/10,0);\n    putchar(xx%10+'0');\n    if(flagg==1)\n        putchar(' ');\n    if(flagg==2)\n        putchar('\\n');\n    return;\n}\nint n,m,i,j,k,sum[2][6005],top,zhan[6005],st,ed,sum2;\nint topa,topb,book[6005],booka[6005],bookb[6005];\nstring c[6005],p,ans;\nchar s[6005];\nint main(){\n    n=read();m=n*2;\n    scanf(\"%s\",s+1);\n    for(i=1;i<=m;i++){\n    \tsum[0][i]=sum[0][i-1];\n    \tsum[1][i]=sum[1][i-1];\n    \tsum[s[i]-'a'][i]++;\n    \tif(s[i]=='a'){\n    \t\ttopa++;\n    \t\tbook[i]=topa;\n    \t\tbooka[topa]=i;\n    \t}\n    \telse{\n\t\t\ttopb++;\n\t\t\tbook[i]=topb;\n\t\t\tbookb[topb]=i;\n\t\t}\n    }\n   \tfor(i=1;i<=m;i++)\n   \t\tif(sum[0][i]==sum[1][i]){\n   \t\t\ttop++;\n   \t\t\tzhan[top]=i;\n   \t\t}\n   \tfor(i=1;i<=top;i++){\n   \t\tst=zhan[i-1]+1;ed=zhan[i];sum2=0;\n   \t\tif(s[st]=='a'){\n\t   \t\tfor(j=st;j<=ed;j++){\n\t   \t\t\tif(s[j]=='a'){\n\t   \t\t\t\tj=bookb[book[j]];\n\t   \t\t\t\tsum2++;\n\t   \t\t\t}\n\t   \t\t}\n\t   \t\twhile(sum2--){\n\t\t\t\tc[i]+='a';\n\t\t\t\tc[i]+='b';\n\t\t\t}\n   \t\t}\n   \t\telse{\n   \t\t\tfor(j=ed;j>=st;j--)\n   \t\t\t\tif(s[j]=='a'){\n   \t\t\t\t\tfor(k=st;k<=ed;k++)\n   \t\t\t\t\t\tif(book[k]>=book[j]&&book[k]<=book[ed])\n   \t\t\t\t\t\t\tp+=s[k];\n   \t\t\t\t\tif(j==ed)\n   \t\t\t\t\t\tc[i]=p;\n   \t\t\t\t\telse if(p>c[i])\n   \t\t\t\t\t\tc[i]=p;\n   \t\t\t\t\tp=\"\";\n   \t\t\t\t}\n   \t\t}\n   \t}\n   \tfor(i=top;i>=1;i--)\n   \t\tif(c[i]+ans>=ans)\n   \t\t \tans=c[i]+ans;\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define fo(a,b,c) for (a=b; a<=c; a++)\n#define fd(a,b,c) for (a=b; a>=c; a--)\n#define min(a,b) (a<b?a:b)\n#define ll long long\n//#define file\nusing namespace std;\n\nstruct St{\n\tchar a[6001];\n\tbool bz[6001];\n\tint n;\n\t\n\tvoid turn()\n\t{\n\t\tint i,j=0;\n\t\t\n\t\tfo(i,1,n)\n\t\tif (!bz[i])\n\t\ta[++j]=a[i];\n\t\tn=j;\n\t\tmemset(bz,0,sizeof(bz));\n\t}\n} s;\nint a[6001],b[6001],i,j,k,l,n1,n2,sum;\nbool bz[3001];\nchar st[6001];\n\nint main()\n{\n\t#ifdef file\n\tfreopen(\"agc026e.in\",\"r\",stdin);\n\t#endif\n\t\n\tscanf(\"%d\",&s.n);s.n*=2;\n\tscanf(\"%s\",s.a+1);\n\t\n\tfo(l,1,s.n)\n\tif (s.a[l]=='a')\n\t{\n\t\tfo(i,1,s.n)\n\t\ta[i]=a[i-1]+(s.a[i]=='a'),b[i]=b[i-1]+(s.a[i]=='b');\n\t\t\n\t\tif (a[l]<=b[l]) //before\n\t\t{\n\t\t\tfo(k,1,l) if (b[k]==a[l]) break;\n\t\t\tif ((b[l-1]-b[k-1])!=(l-k)) continue;\n\t\t\t\n\t\t\tsum=0;\n\t\t\tfo(i,l,s.n)\n\t\t\t{\n\t\t\t\tsum+=(s.a[i]=='a')?1:-1;\n\t\t\t\tif (sum<0) break;\n\t\t\t}\n\t\t\tif (sum<0)\n\t\t\t{\n\t\t\t\tfo(j,k,i-1) s.bz[j]=1;\n\t\t\t\ts.turn();\n\t\t\t}\n\t\t}\n\t\telse //after\n\t\t{\n\t\t\tif (a[l]==b[l]+1)\n\t\t\t{\n\t\t\t\tsum=0;\n\t\t\t\tfo(i,l,s.n)\n\t\t\t\t{\n\t\t\t\t\tsum+=(s.a[i]=='a')?1:-1;\n\t\t\t\t\tif (sum<0) break;\n\t\t\t\t}\n\t\t\t\tif (sum<0)\n\t\t\t\t{\n\t\t\t\t\tfo(j,l,i-1) s.bz[j]=1;\n\t\t\t\t\ts.turn();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tk=l;\n\t\t\t\twhile (k<=s.n && s.a[k]=='a') ++k;\n\t\t\t\t\n\t\t\t\tif (k>s.n) continue;\n\t\t\t\tif ((k-l)<=(s.n/2-a[l]+1))\n\t\t\t\t{\n\t\t\t\t\tfo(j,l,k-1) s.bz[j]=1;\n\t\t\t\t\tj=k;\n\t\t\t\t\twhile (b[j]<a[l]) ++j;\n\t\t\t\t\twhile (j<=s.n)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (s.a[j]=='b' && b[j]<=a[k-1])\n\t\t\t\t\t\ts.bz[j]=1;\n\t\t\t\t\t\t++j;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ts.turn();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfo(i,1,s.n) putchar(s.a[i]);\n\tputchar('\\n');\n\t\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6050;\nint f[N][N],a[N],b[N],c[N],na,nb,n;\nchar s[N*2];\nstring func(int *g){\n  string ans=\"\";\n  for (int i=1; i<=2*n; ++i)\n    if (g[c[i]])\n      ans+=s[i];\n  return ans;\n}\nint main(){\n  cin>>n;\n  scanf(\"%s\",s+1);\n  for (int i=1; i<=2*n; ++i)\n    if (s[i]=='a')\n      a[++na]=i,c[i]=na;\n    else\n      b[++nb]=i,c[i]=nb;\n  f[n][n]=1;\n  for (int i=n-1; i>=1; --i){\n    f[i][i]=1;\n    int mx=0;\n    if (a[i]<b[i]){\n      for (int j=a[i]; j<=b[i]; ++j)\n\tmx=max(mx,c[j]);\n      for (int j=mx+1; j<=n; ++j)\n\tf[i][j]=f[mx+1][j];\n    }\n    else{\n      int tot=0;\n      for (int j=b[i]; j<=a[i]; ++j){\n\tif (c[j]<i) continue;\n\tif (c[j]!=i) ++tot;\n\tmx=max(mx,c[j]),f[i][c[j]]=1;\n      }\n      for (int j=a[i]+1; j<=2*n; ++j)\n\tif (s[j]=='b'){\n\t  if (tot==0)\n\t    f[i][c[j]]=f[mx+1][c[j]];\n\t  else\n\t    f[i][c[j]]=1,++tot;\n\t}\n\telse{\n\t  if (tot==0)\n\t    f[i][c[j]]=f[mx+1][c[j]];\n\t  else\n\t    f[i][c[j]]=1,mx=max(mx,c[j]),--tot;\n\t}\n    }\n    if (func(f[i])<func(f[i+1]))\n      memcpy(f[i],f[i+1],sizeof f[i]);\n  }\n  cout<<func(f[1]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define all(x) (x).begin (),(x).end()\n#define sqrt(x) sqrt(abs(x))\n#define re return\n#define sz(x) ((int)(x).size ())\n#define prev PREV\n#define next NEXT\n\nusing ll = long long;\nusing ii = pair<int, int>;\nusing ld = long double;\nusing D = double;\nusing vi = vector<int>;\nusing vii = vector<ii>;\nusing vvi = vector<vi>;\nusing vs = vector<string>;\n\ntemplate<typename T> T abs (T x) { re x < 0 ? -x : x; }\ntemplate<typename T> T sgn (T x) { re x < 0 ? -1 : (x > 0 ? 1 : 0); }\ntemplate<typename T> T sqr (T x) { re x * x; }\ntemplate<typename T> T gcd (T a, T b) { re a ? gcd (b % a, a) : b; }\n\nint n;\nint m;\nstring s;\nvi a, b;\nint p[6001];\nint was[6001];\nint ct;\nstring res[6001];\n\nint main () {\n\tcin >> n >> s;\n\tfor (int i = 0; i < 2 * n; i++)\n\t\tif (s[i] == 'a') {\n\t\t\tp[i] = sz (a);\n\t\t\ta.pb (i);\n\t\t} else {\n\t\t\tp[i] = sz (b);\n\t\t\tb.pb (i);\n\t\t}\t\n\tstring ans = \"\";\n\tint ok = 1;\n\tfor (int i = 0; i < n; i++)\n\t\tif (a[i] > b[i]) {\n\t\t\tok = 0;\n\t\t\tbreak;\n\t\t}\n\tif (ok) {\n\t\tint last = 0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tif (a[i] >= last) {\n\t\t\t\tprintf (\"ab\");\n\t\t\t\tlast = b[i];\n\t\t\t}\n\t\tprintf (\"\\n\");\n\t} else {\n\t\tres[2 * n] = \"\";\n\t\tfor (int i = 2 * n - 1; i >= 0; i--) {\n\t\t\tres[i] = res[i + 1];\n\t\t\tint t = p[i];\n\t\t\tif (min (a[t], b[t]) != i) continue;\n\t\t\tif (s[i] == 'a') {\n\t\t\t\tres[i] = max (res[i], \"ab\" + res[b[t] + 1]);\n\t\t\t} else {\n\t\t\t\tct++;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint op = 0;\n\t\t\t\tfor (int j = i; j < 2 * n; j++)\n\t\t\t\t\tif (was[j] == ct || (s[j] == 'b' && b[p[j]] < a[p[j]])) {\n\t\t\t\t\t\tcur += s[j];\n\t\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\t\twas[a[p[j]]] = ct;\n\t\t\t\t\t\t\top++;\n\t\t\t\t\t\t} else op--;\n\t\t\t\t\t\tif (op == 0) {\n\t\t\t\t\t\t\tcur += res[j + 1];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tres[i] = max (res[i + 1], cur);\n\t\t\t}\n\t\t}\n\t\tprintf (\"%s\\n\", res[0].c_str ());\n\t}\n//\tcerr << clock () << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint N;\nstring S;\nvector<int> v;\nvector<string> all;\n\nstring getmax(bool type, const string &p) {\n\tif (p.empty())\n\t\treturn \"\";\n\tstring res;\n\tvector<int> posa, posb;\n\tfor (int i = 0; i < (int)p.size(); ++i)\n\t\tif (p[i] == 'a') posa.push_back(i);\n\t\telse posb.push_back(i);\n\tif (type) {\n\t\tint lst = posb[0];\n\t\tres = \"ab\";\n\t\tfor (int i = 1; i < (int)posa.size(); ++i)\n\t\t\tif (posa[i] > lst) {\n\t\t\t\tlst = posb[i];\n\t\t\t\tres += \"ab\";\n\t\t\t}\n\t\treturn res;\n\t}\n\tvector<int> pos;\n\tfor (int suf = (int)posa.size() - 1; suf >= 0; --suf) {\n\t\tpos.insert(upper_bound(pos.begin(), pos.end(), posa[suf]), posa[suf]);\n\t\tpos.insert(upper_bound(pos.begin(), pos.end(), posb[suf]), posb[suf]);\n\t\tstring tmp;\n\t\tfor (int x : pos) tmp += p[x];\n\t\tres = max(res, tmp);\n\t}\n\treturn res;\n}\n\nint main() {\n\tcin >> N >> S;\n\tbool type;\n\tint b = 0;\n\tstring now;\n\tfor (int i = 0; i < 2 * N; ++i) {\n\t\ttype = b > 0;\n\t\tb += S[i] == 'a' ? 1 : -1;\n\t\tnow += S[i];\n\t\tif (!b) {\n\t\t\tall.push_back(getmax(type, now));\n\t\t\tnow.clear();\n\t\t}\n\t}\n\tstring s;\n\tfor (int i = (int)all.size() - 1; i >= 0; --i)\n\t\ts = max(s, all[i] + s);\n\tcout << s << '\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbool cmp(pair<string, int> &a, pair<string, int> &b){\n    if (a.first != b.first) return (a.first > b.first);\n    return (a.second < b.second);\n}\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(NULL);\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<pair<int, int> > g;\n    vector<bool> good;\n    int i = 0;\n    while (i < s.size()){\n        int b = 2*(s[i] == 'a') - 1;\n        int B = b;\n        int S = g.size();\n        for (int j=i+1; j < s.size(); j++){\n            B += (2*(s[j] == 'a') - 1);\n            if (B==0){\n                g.push_back({i, j});\n                good.push_back(b < 0);\n                i = j+1;\n                break;\n            }\n        }\n        if (g.size() == S){\n            g.push_back({i, s.size()-1});\n            good.push_back(b < 0);\n            break;\n        }\n    }\n    vector<string> choose;\n    for (int i=0; i < g.size(); i++){\n        if (!good[i]){\n            int L = g[i].first, R = g[i].second;\n            vector<int> as, bs;\n            for (int j=L; j <= R; j++){\n                if (s[j] == 'a') as.push_back(j);\n                else bs.push_back(j);\n            }\n            map<int, int> ft;\n            for (int j=0; j < as.size(); j++) ft[as[j]] = bs[j];\n            int dp[R-L+2];\n            dp[R-L+1] = 0;\n            for (int j=R; j >= L; j--){\n                dp[j-L] = dp[j-L+1];\n                if (s[j] == 'b') continue;\n                else dp[j-L] = max(dp[j-L], dp[ft[j]+1-L] + 1);\n            }\n            string ss = \"\";\n            for (int j=0; j < dp[0]; j++) ss += \"ab\";\n            choose.push_back(ss);\n        }\n        else{\n            vector<string> vv;\n            int L = g[i].first, R = g[i].second;\n            int B = 0;\n            for (int j=L; j <= R; j++){\n                string pp = \"\";\n                int b = 0;\n                int ed = 0;\n                for (int p=j; p <= R; p++){\n                    if (s[p] == 'a' && ed < B){\n                        ed++;\n                        continue;\n                    }\n                    b += (2*(s[p] == 'a') - 1);\n                    if (s[p] == 'a') ed++;\n                    pp += s[p];\n                }\n                vv.push_back(pp);\n                //cout << pp << endl;\n                B += (2*(s[j] == 'b') - 1);\n            }\n            sort(vv.begin(), vv.end());\n            choose.push_back(vv.back());\n        }\n    }\n    vector<pair<string, int> > ppp;\n    for (int i=0; i < choose.size(); i++){\n        if (choose[i] == \"\") continue;\n        ppp.push_back({choose[i], i});\n    }\n    sort(ppp.begin(), ppp.end(), cmp);\n    int nw = -1;\n    string ans = \"\";\n    for (int i=0; i < ppp.size(); i++){\n        if (ppp[i].second < nw) continue;\n        ans += ppp[i].first;\n        nw = ppp[i].second;\n    }\n    cout << ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n//#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[2 * N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    For(i, 0, b.size()){\n        c.pb(b[i]);\n        For(j, 0, i){\n            if (c[j] + b[i] > c[i]){\n                c[i] = c[j] + b[i];\n            }\n        }\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<string> t;\n    vector<int> a, b, pos(2 * n);\n    for (int i = 0; i < 2 * n; ++i) {\n        if (s[i] == 'a') {\n            pos[i] = a.size();\n            a.push_back(i);\n        } else {\n            pos[i] = b.size();\n            b.push_back(i);\n        }\n        if (a.size() == b.size()) {\n            string f;\n            if (a.back() < b.back()) {\n                int lst = -1;\n                for (int j = 0; j < a.size(); ++j) {\n                    if (a[j] > lst) {\n                        f += \"ab\";\n                        lst = b[j];\n                    }\n                }\n            } else {\n                int l = i - 2 * a.size() + 1;\n                for (int j = 0; j < a.size(); ++j) {\n                    string g;\n                    for (int k = l; k <= i; ++k)\n                        if (pos[k] >= j)\n                            g += s[k];\n                    f = max(f, g);\n                }\n            }\n            t.push_back(f);\n            a.clear();\n            b.clear();\n        }\n    }\n    s.clear();\n    reverse(t.begin(), t.end());\n    for (auto &f : t)\n        s = max(s, f + s);\n    cout << s << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) s[i];\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <set>\n#include <map>\n#include <cstring>\n#include <string>\n#include <cmath>\n#include <cassert>\n#include <ctime>\n#include <algorithm>\n#include <sstream>\n#include <list>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <cstdlib>\n#include <cstdio>\n#include <iterator>\n#include <functional>\n#include <bitset>\n\n#ifdef LOCAL\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\nclock_t __my_start_clock = clock();\n#else\n#define eprintf(...)\n#endif\n\n#define TIMESTAMP(x) eprintf(\"[\"#x\"] Time : %.3lf s.\\n\", (clock() - __my_start_clock)*1.0/CLOCKS_PER_SEC)\n#define TIMESTAMPf(x,...) eprintf(\"[\" x \"] Time : %.3lf s.\\n\", __VA_ARGS__, (clock() - __my_start_clock)*1.0/CLOCKS_PER_SEC)\n\nusing namespace std;\n\n#ifdef LOCAL\nstatic struct __timestamper {\n  string what;\n  __timestamper(const char* what) : what(what){};\n  __timestamper(const string& what) : what(what){};\n  ~__timestamper(){\n    TIMESTAMPf(\"%s\", what.data());\n\t}\n} __TIMESTAMPER(\"end\");\n#else \nstruct __timestamper {};\n#endif\n\ntypedef long long ll;\ntypedef long double ld;\n\nstring solve_slow(string s, int n) {\n  string t = \"\";\n  for (int i = 0; i < (1 << n); i++) {\n    int cnt[2];\n    cnt[0] = cnt[1] = 0;\n    string r = \"\";\n    for (int j = 0; j < (int)s.size(); j++) {\n      if (i & (1 << cnt[s[j] - 'a'])) {\n        r += s[j];\n      }\n      cnt[s[j] - 'a']++;\n    }\n    t = max(t, r);\n  }\n  return t;\n}\n\nstring solve_bbig(string s, int n) {\n  string t;\n  for (int pos = 0; pos <= n; pos++){\n    int cnt[2];\n    cnt[0] = cnt[1] = 0;\n    string r = \"\";\n    for (int j = 0; j < (int) s.size(); j++) {\n      if (cnt[s[j] - 'a'] >= pos) {\n        r += s[j];\n      }\n      cnt[s[j] - 'a']++;\n    }\n    t = max(t, r);\n  }\n\n  return t;\n}\n\nstring solve_abig(string s, int n) {\n  string t;\n  int cnt[2];\n  cnt[0] = cnt[1] = 0;\n  int next_id = 0;\n  char now = 'a';\n\n  for (int i = 0; i < 2 * n; i++) {\n    if (s[i] == now && cnt[s[i] - 'a'] == next_id) {\n      t += now;\n      now = 'a' + 'b' - now;\n      next_id = max(next_id, cnt[now - 'a']);\n    }\n    cnt[s[i] - 'a']++;\n  }\n  return t;\n}\n\nstring solve_big(string s) {\n  assert(s.size() % 2 == 0);\n  int bal = 0;\n  for (int i = 0; i < (int)s.size(); i++) {\n    if (s[i] == 'a') {\n      bal++;\n    }\n    if (s[i] == 'b') {\n      bal--;\n    }\n    assert(i == (int)s.size() - 1 || bal != 0);\n  }\n  assert(bal == 0);\n  if (s[0] == 'a') {\n    return solve_abig(s, s.size() / 2);\n  } else {\n    return solve_bbig(s, s.size() / 2);\n  }\n}\n\nstring solve_common(string s, int n) {\n  vector<string> v;\n  int bal = 0;\n  string cur;\n  for (int i = 0; i < 2 * n; i++) {\n    cur += s[i];\n    if (s[i] == 'a') {\n      bal++;\n    } else {\n      bal--;\n    }\n    if (bal == 0) {\n      v.push_back(solve_big(cur));\n      cur = \"\";\n    }\n  }\n  v.push_back(solve_big(cur));\n  string res;\n  for (int i = (int)v.size() - 1; i >= 0; i--) {\n    res = max(res, v[i] + res);\n  }\n  return res;\n}\n\nint main() {\n#ifdef LOCAL\n  freopen(\"e.in\", \"r\", stdin);\n  freopen(\"e.out\", \"w\", stdout);\n#endif\n\n  {\n    int n;\n    string s;\n    while (cin >> n >> s) {\n      printf(\"%s\\n\", solve_common(s, n).c_str());\n    }\n    return 0;\n  }\n\n  string v;\n  int n = 8;\n  for (int i = 0; i < n; i++) {\n    v += 'a';\n  }\n  for (int i = 0; i < n; i++) {\n    v += 'b';\n  }\n\n  do {\n    int bal = 0;\n    bool ok = true;\n    for (int i = 0; i < 2 * n; i++) {\n      if (v[i] == 'a') {\n        bal++;\n      }\n      if (v[i] == 'b') {\n        bal--;\n      }\n      if (i != 2 * n - 1 && bal == 0) {\n        ok = false;\n        break;\n      }\n    }\n    if (1 || ok) {\n      string s1 = solve_slow(v, n);\n      string s2 = solve_common(v, n);\n      eprintf(\"%s %s %s\\n\", v.c_str(), s1.c_str(), s2.c_str());\n      assert(s1 == s2);\n    }\n  } while (next_permutation(v.begin(), v.end()));\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <map>\n#include <list>\n#include <iterator>\n#include <set>\n#include <queue>\n#include <iostream>\n#include <sstream>\n#include <stack>\n#include <deque>\n#include <cmath>\n#include <memory.h>\n#include <cstdlib>\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#include <utility>\n#include <time.h>\n#include <bitset>\n#include <assert.h>\n#include <complex.h>\nusing namespace std;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i=(a)-1;i>=(b);--i)\n#define FILL(A,val) memset(A,val,sizeof(A))\n\n#define ALL(V) V.begin(),V.end()\n#define SZ(V) (int)V.size()\n#define PB push_back\n#define MP make_pair\n\ntypedef long long Int;\ntypedef unsigned long long UInt;\ntypedef vector<int> VI;\ntypedef pair<int, int> PII;\n\nconst double Pi = acos(-1.0);\nconst int INF = 1000000000;\nconst Int INF2 = Int(INF) * 5000;\nconst Int INF3 = Int(INF) * INF;\nconst int MAX = 100007;\nconst int MAXE = 2007000;\nconst int MAXV = 5000;\nconst int BASE = 1000000000;\nconst int ST = 1000000007;\n\nconst int MOD = 1000000007;\n\nstring solve(string s)\n{\n    if (s[0] == 'a')\n    {\n        VI A;\n        VI B;\n        FOR(i,0,SZ(s))\n        {\n            if (s[i] == 'a')\n            {\n                A.push_back(i);\n            } else\n            {\n                B.push_back(i);\n            }\n        }\n\n        string res = \"\";\n        int last = -1;\n        FOR(i,0,SZ(A))\n        {\n            if (A[i] > last)\n            {\n                last = B[i];\n                res += \"ab\";\n            }\n        }\n        return res;\n    }\n\n    string res = \"\";\n\n    int n = SZ(s) / 2;\n\n    FOR(j,0,n)\n    {\n        int cntA = 0;\n        int cntB = 0;\n        string r = \"\";\n        FOR(i,0,SZ(s))\n        {\n            if (s[i] == 'a')\n            {\n                ++ cntA;\n                if (cntA > j) r += 'a';\n            }\n            if (s[i] == 'b')\n            {\n                ++ cntB;\n                if (cntB > j) r += 'b';\n            }\n        }\n        res = max(res , r);\n    }\n\n    return res;\n}\n\nint main()\n{\n//    freopen(\"in.txt\", \"r\", stdin);\n//    freopen(\"out.txt\" , \"w\", stdout);\n\n\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n\n    int L = 0;\n\n    vector<string> A;\n\n    int bal = 0;\n\n    FOR(i,0,SZ(s))\n    {\n        if (s[i] == 'a')\n        {\n            bal ++;\n        } else\n        {\n            bal --;\n        }\n        if (bal == 0) {\n            A.push_back(solve(s.substr(L, i - L + 1)));\n            L = i + 1;\n        }\n    }\n\n    string res = \"\";\n    RFOR(i,SZ(A) , 0)\n    {\n        if (A[i] + res > res)\n            res = A[i] + res;\n    }\n\n    cout << res << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::cerr; \n\ntemplate <class T>\ninline void relax(T &x, const T &y) {\n\tif (x < y) x = y; \n}\n\nconst int MaxM = 6e3 + 5; \nconst int MaxN = 3e3 + 5; \n\nint n; \nchar s[MaxM]; \nstd::string f[MaxN]; \n\nint idx[MaxM]; \nint a[MaxN], b[MaxN]; \n\nint main() {\n#ifdef orzczk\n\tfreopen(\"subsequnce.in\", \"r\", stdin); \n#endif\n\n\tscanf(\"%d%s\", &n, s + 1); \n\tfor (int i = 1, cA = 0, cB = 0; i <= (n << 1); ++i) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[idx[i] = ++cA] = i; \n\t\t} else {\n\t\t\tb[idx[i] = ++cB] = i; \n\t\t}\n\t}\n\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint j = i; \n\t\t\twhile (j <= n && a[j] <= b[i])\n\t\t\t\t++j; \n\t\t\tf[i] = \"ab\" + f[j]; \n\t\t} else {\n\t\t\tint border = a[i], maxIdx = i; \n\t\t\tfor (int j = b[i] + 1; j <= border; ++j)\n\t\t\t\tif (s[i] == 'b') {\n\t\t\t\t\trelax(border, a[idx[j]]); \n\t\t\t\t}\n\t\t\t\n\t\t\tfor (int j = b[i]; j <= border; ++j)\n\t\t\t\tif (idx[j] >= i) {\n\t\t\t\t\tf[i] += s[j]; \n\t\t\t\t\trelax(maxIdx, idx[j]); \n\t\t\t\t}\n\t\t\t\n\t\t\tf[i] += f[maxIdx + 1]; \n\t\t}\n\n\t\t// cerr << i << ' ' << f[i] << '\\n'; \n\t\trelax(f[i], f[i + 1]); \n\t}\n\n\tstd::cout << f[1] << '\\n'; \n\n\treturn 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=3e3+5;\nint n;\nchar s[maxn<<1];\nint t[maxn<<1];\nint a[maxn],b[maxn];\nint A,B;\nstring Ans;\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\t//n=3;\n\tfor (int i=1;i<=n*2;i++){\n\t\tif (s[i]=='a'){\n\t\t\tA++;\n\t\t\ta[A]=i;\n\t\t\tt[i]=A;\n\t\t}\n\t\telse{\n\t\t\tB++;\n\t\t\tb[B]=i;\n\t\t\tt[i]=B;\n\t\t}\n\t}\n\tfor (int i=1;i<=n*2;i++){\n\t\tstring S=\"\";\n\t\tint pos=i-1;\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi!=i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tfor (int j=i;j<=n*2;j++){\n\t\t\t\tif (a[t[j]]>b[t[j]]&&b[t[j]]>=i){\n\t\t\t\t\tS.push_back(s[j]);\n\t\t\t\t\tpos=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int j=pos+1;j<=n*2;j++){\n\t\t\tif (a[t[j]]<b[t[j]]&&s[j]=='a'){\n\t\t\t\tS+=\"ab\";\n\t\t\t\tj=b[t[j]];\n\t\t\t}\n\t\t}\n\t//\tcout << i << ' ' << S << '\\n';\n\t\tAns=max(Ans,S);\n\t}\n\tcout << Ans << '\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int N=6005;\nint n,p[N],pp[N],t[N];\nint q[N],head,tail;\nstring res[N],now;\nchar s[N];\nvector <int> a,b;\nint main(){\n    scanf(\"%d\",&n);\n    n<<=1;\n    scanf(\"%s\",s+1);\n    a.clear(),b.clear();\n    for (int i=1;i<=n;i++)\n        if (s[i]=='a')\n            a.push_back(i);\n        else\n            b.push_back(i);\n    for (int i=1;i<=n/2;i++)\n        p[b[i-1]]=a[i-1],pp[a[i-1]]=b[i-1];\n    for (int i=1;i<=n+1;i++)\n        res[i]=\"\";\n    int tot=0;\n    int nxt=n+1;\n    for (int i=n;i>=1;i--){\n        if (s[i]=='a')\n            tot++;\n        else\n            tot--;\n        if (tot)\n            continue;\n        memset(t,0,sizeof t);\n        head=1,tail=0;\n        res[i]=res[nxt];\n        for (int j=i;j<nxt;j++){\n            if (s[j]=='a'){\n                if (t[j]){\n                    now=\"\";\n                    for (int k=i;k<nxt;k++)\n                        if (s[k]=='b'){\n                            if (t[k]||k>j)\n                                now+=\"b\";\n                        }\n                        else if (t[k]||k>p[q[tail]])\n                            now+=\"a\";\n                    res[i]=max(res[i],now+res[nxt]);\n                    head++;\n                    t[j]=t[pp[j]]=0;\n                }\n                continue;\n            }\n            if (p[j]<j)\n                continue;\n            q[++tail]=j;\n            t[j]=t[p[j]]=1;\n        }\n        memset(t,0,sizeof t);\n        if (tail==0){\n            for (int j=i;j<nxt;j++){\n                if (s[j]=='b')\n                    continue;\n                t[j]=t[pp[j]]=1;\n                now=\"\";\n                for (int k=i;k<=pp[j];k++)\n                    if (t[k])\n                        now+=s[k];\n                res[i]=max(res[i],now+res[nxt]);\n                j=pp[j];\n            }\n        }\n        nxt=i;\n    }\n    cout << res[1];\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint n,sa[3010],sb[3010],ta=0,tb=0,pos[6010];\nchar s[6010];\nstring f[3010];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++)\n\t{\n\t\tif(s[i]=='a') sa[++ta]=i,pos[i]=ta;\n\t\telse sb[++tb]=i,pos[i]=tb;\n\t}\n\tstring ans;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(sa[i]<sb[i])\n\t\t{\n\t\t\tint k=i;\n\t\t\tfor(int j=sa[i]+1;j<sb[i];j++) k=max(k,pos[j]);\n\t\t\tf[i]=\"ab\"+f[k+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile(k<n&&sb[k+1]<sa[k]) k++;\n\t\t\tfor(int j=sb[i];j<=2*n;j++) if(pos[j]>=i&&pos[j]<=k) f[i]+=s[j];\n\t\t\tf[i]+=f[k+1];\n\t\t}\n\t\tf[i]=max(f[i],f[i+1]);\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%s\",ans.c_str());\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cassert>\n#include<cmath>\n#include<map>\n#include<set>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<bitset>\n#include<vector>\n#include<time.h>\n#include<algorithm>\nusing namespace std;\n#define REP(i,x,y) for(int i=x;i<=y;i++)\n#define rep(i,n) REP(i,1,n)\n#define rep0(i,n) REP(i,0,n-1)\n#define repG(i,x) for(int i=pos[x];~i;i=e[i].next)\n#define ll long long\n#define db double\nconst int N=6007;\nconst int INF=1e9+7;\nint n;\nchar s[N];\nint ad[N],bd[N],f[N][N],a[N],va[N],vb[N],g[N];\nvoid solve(){\n\tg[0]=0;\n\trep(i,n*2){\n\t\tg[i]=g[i-1];\n\t\tif(a[i]==1)g[i]=max(g[i],g[va[bd[i]]-1]+1);\n\t}\n\trep(i,g[n*2])putchar('a'),putchar('b');\n\tputs(\"\");\n}\nbool vis[N];\nbool cp(int *a,int *b,int o1,int o2){\n\trep(i,min(o1,o2)){\n\t\tif(a[i]>b[i])return 1;\n\t\tif(a[i]<b[i])return 0;\n\t}\n\treturn o1>o2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\trep(i,2*n)a[i]=s[i]-'a';\n\tint c1=0,c2=0;\n\trep(i,2*n){\n\t\tif(a[i]==1){\n\t\t\tvb[++c2]=i;\n\t\t\tbd[i]=c2;\n\t\t}\n\t\telse{\n\t\t\tva[++c1]=i;\n\t\t\tad[i]=c1;\n\t\t}\n\t}\n\tbool fl=0;\n\trep(i,n)if(va[i]>vb[i])fl=1;\n\tif(!fl){\n\t\tsolve();\n\t\treturn 0;\n\t}\n\tfor(int i=n;i;i--){\n\t\tif(va[i]<vb[i]){\n\t\t\tf[i][0]=f[i+1][0];\n\t\t\trep(j,f[i][0])f[i][j]=f[i+1][j];\n\t\t\tcontinue;\n\t\t}\n\t\tint cnt=0,mx=va[i];\n\t\trep(j,n*2)vis[j]=0;\n\t\tvis[va[i]]=1;\n\t\tREP(j,vb[i],mx){\n\t\t\tif(a[j]==1){\n\t\t\t\tg[++cnt]=1;\n\t\t\t\tvis[va[bd[j]]]=1;\n\t\t\t\tmx=max(mx,va[bd[j]]);\n\t\t\t}\n\t\t\telse if(vis[j])g[++cnt]=0;\n\t\t}\n\t\tint md=n+1;\n\t\tfor(int j=n;j;j--)if(vb[j]>mx)md=j;\n\t\trep(k,f[md][0])g[++cnt]=f[md][k];\n\t\tf[i][0]=f[i+1][0];\n\t\trep(j,f[i][0])f[i][j]=f[i+1][j];\n\t\tif(cp(g,f[i],cnt,f[i][0])){\n\t\t\tf[i][0]=cnt;\n\t\t\trep(j,cnt)f[i][j]=g[j];\n\t\t}\n\t}\n\trep(i,f[1][0])putchar('a'+f[1][i]);\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\t/*\n\t\ts0=s1=0;\n\t\tint lst=r;\n\t\tfor (int j=r;j>=l;j--)\n\t\t{\n\t\t\tif ((s[j]-'a')==f)\n\t\t\t{\n\t\t\t\ts0++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ts1++;\n\t\t\t}\n\t\t\tif (s0==s1)\n\t\t\t{\n\t\t\t\tnode now;\n\t\t\t\tfor (int i=lst;i>=j;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tif ((now.s+res)>res)\n\t\t\t\t{\n\t\t\t\t\tres=now.s+res;\n\t\t\t\t}\n\t\t\t\tlst=j-1;\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tnode now;\n\t\t\t\tfor (int i=r;i>=l;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tres=now.s;\n\t}\n\treturn res;\n}\nint main()\n{\n\tfreopen(\"f.in\",\"r\",stdin);\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=2*n-1;\n\tstring ans=\"\";\n\tfor (int i=2*n-1;i>=0;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa!=sb)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tif (s[i-1]=='b')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (lst==2*n-1)\n\t\t\t{\n\t\t\t\tans=work(0,i,lst)+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring str=work(1,i,lst);\n\t\t\t/*\n\t\t\tfor (int j=i;j<=lst;j++)\n\t\t\t{\n\t\t\t\tstr.push_back(s[j]);\n\t\t\t}\n\t\t\t*/\n\t\t\tif ((str+ans)>ans)\n\t\t\t{\n\t\t\t\tans=str+ans;\n\t\t\t}\n\t\t\t//cout<<ans<<endl;\n\t\t\tlst=i-1;\n\t\t}\n\t}\n\t/*\n\tfor (int i=0;i<2*n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa==sb)\n\t\t{\n\t\t\tif (i==2*n-1 || s[i+1]!=s[lst])\n\t\t\t{\n\t\t\t\tif (i==2*n-1 || (s[i+1]!=s[lst] && s[lst]!='a'))\n\t\t\t\t{\n\t\t\t\t\tans=ans+work(s[lst]-'a',lst,i);\n\t\t\t\t}\n\t\t\t\tsa=sb=0;\n\t\t\t\tlst=i+1;\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef int sign;\ntypedef long long ll;\n#define For(i,a,b) for(register sign i=(sign)(a);i<=(sign)(b);++i)\n#define Fordown(i,a,b) for(register sign i=(sign)(a);i>=(sign)(b);--i)\nconst int N=6e3+5;\ntemplate<typename T>bool cmax(T &a,T b){return (a<b)?a=b,1:0;}\ntemplate<typename T>bool cmin(T &a,T b){return (a>b)?a=b,1:0;}\ntemplate<typename T>T read()\n{\n\tT ans=0,f=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)&&ch!='-')ch=getchar();\n\tif(ch=='-')f=-1,ch=getchar();\n\twhile(isdigit(ch))ans=(ans<<3)+(ans<<1)+(ch-'0'),ch=getchar();\n\treturn ans*f;\n}\ntemplate<typename T>void write(T x,char y)\n{\n\tif(x==0)\n\t{\n\t\tputchar('0'),putchar(y);\n\t\treturn;\n\t}\n\tif(x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tstatic char wr[20];\n\tint top=0;\n\tfor(;x;x/=10)wr[++top]=x%10+'0';\n\twhile(top)putchar(wr[top--]);\n\tputchar(y);\n}\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in\",\"r\",stdin);\n\tfreopen(\"out\",\"w\",stdout);\n#endif\n}\nint n;\nchar s[N];\nvoid input()\n{\n\tn=read<int>();\n\tscanf(\"%s\",s+1);\n}\nvector<string>E;\n#define pb push_back\nint a[N],b[N];\nint sum[N];\nstring get1(int l,int r)\n{\n\tstring res;\n\tint last=0;\n\tFor(i,l,r)if(a[i]>last)res+=\"ab\",last=b[i]+1;\n\treturn res;\n}\nbool vis[N];\nstring get2(int l,int r)\n{\n\tstring res,now;\n\tFor(i,l,r)vis[a[i]]=vis[b[i]]=1;\n\tFor(i,l,r)\n\t{\n\t\tnow.clear();\n\t\tFor(j,1,n*2)if(vis[j])now+=s[j];\n\t\tcmax(res,now);\n\t\tvis[a[i]]=vis[b[i]]=0;\n\t}\n\treturn res;\n}\nvoid work()\n{\n\tFor(i,1,n*2)\n\t{\n\t\tif(s[i]=='a')a[++a[0]]=i,sum[i]++;\n\t\telse b[++b[0]]=i,sum[i]--;\n\t\tsum[i+1]=sum[i];\n\t}\n\tint j;\n\tstring now;\n\tFor(i,1,n)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[b[j]]&&a[j+1]<b[j+1];j++);\n\t\t\tnow=get1(i,j);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(j=i;j<n&&sum[a[j]]&&a[j+1]>b[j+1];j++);\n\t\t\tnow=get2(i,j);\n\t\t}\n\t\t//cout<<now<<endl;\n\t\tE.pb(now);\n\t\ti=j;\n\t}\n\treverse(E.begin(),E.end());\n\tstring ans;\n\tfor(auto now:E)ans=max(ans,now+ans);\n\tcout<<ans<<endl;\n}\nint main()\n{\n\n\tinput();\n\twork();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\n\nint main() {\n  int n;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  vector<int> a, b;\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  vector<int> ba;\n  for (int i = 0; i < n; i++) {\n    if (a[i] > b[i]) {\n      ba.push_back(i);\n    }\n  }\n  int bacnt = ba.size();\n  a.push_back(INT_MAX); b.push_back(INT_MAX);\n  ba.push_back(n);\n  vector<string> best(bacnt + 1);\n  vector<int> best_end(bacnt + 1); // exclusive\n  for (int i = bacnt - 1; i >= 0; i--) {\n    string cur;\n    int ap = i, bp = i;\n    int last_insert = -1;\n    do {\n      if (a[ba[ap]] < b[ba[bp]]) {\n        cur.push_back('a');\n        last_insert = a[ba[ap]];\n        ap++;\n      }\n      else {\n        cur.push_back('b');\n        last_insert = b[ba[bp]];\n        bp++;\n      }\n    } while (ap != bp);\n    cur += best[ap];\n    if (cur > best[i + 1]) {\n      best_end[i] = max(last_insert + 1, best_end[ap]);\n      best[i] = cur;\n    }\n    else {\n      best_end[i] = best_end[i + 1];\n      best[i] = best[i + 1];\n    }\n  }\n  string ans = best[0];\n  int last_ind = -1;\n  for (int i = best_end[0]; i < n; i++) {\n    if (a[i] < b[i]) {\n      if (last_ind < a[i]) {\n        ans += \"ab\";\n        last_ind = b[i];\n      }\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3005;\nchar s[N],s1[N],s2[N],ans[N];\nint flag[N],n;\nint check(char s1[],int len1,char s2[],int len2){\n\tfor (int i=1;i<=len1&&i<=len2;i++)\n\t\tif (s1[i]!=s2[i])return s1[i]>s2[i];\n\treturn len1>=len2;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",s+1);\n\tint len=0;\n\tfor (int i=n,j=n;s[i];i=j){\n\t\tint cnt=0;\n\t\twhile (j==i||cnt!=0){\n\t\t\tif (s[j]=='a')cnt++;\n\t\t\telse cnt--;\n\t\t\tj--;\n\t\t}\n\t\tint len1=0;\n\t\tmemset(s1,0,sizeof s1);\n\t\tif (s[j+1]=='a'){\n\t\t\tint now=j+1;\n\t\t\twhile (now<=i){\n\t\t\t\ts1[++len1]='a';\n\t\t\t\twhile (s[now]=='a')now++;\n\t\t\t\ts1[++len1]='b';\n\t\t\t\twhile (now<=i&&s[now]=='b')now++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int k=1;k<=(i-j)/2;k++){\n\t\t\t\tmemset(flag,0,sizeof flag);\n\t\t\t\tint cnta=0,cntb=0;\n\t\t\t\tfor (int l=i;l>j;l--)\n\t\t\t\t\tif (s[l]=='a'){\n\t\t\t\t\t\tif (cnta<=k)flag[l]=1;\n\t\t\t\t\t\tcnta++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (cntb<=k)flag[l]=1;\n\t\t\t\t\t\tcntb++;\n\t\t\t\t\t}\n\t\t\t\tint len2=0;\n\t\t\t\tfor (int l=j+1;l<=i;l++)\n\t\t\t\t\tif (flag[l])s2[++len2]=s[l];\n\t\t\t\tif (check(s2,len2,s1,len1)){\n\t\t\t\t\tfor (int l=1;l<=len2;l++)s1[l]=s2[l];\n\t\t\t\t\tlen1=len2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (check(s1,len1,ans,len)){\n\t\t\tfor (int l=len;l;l--)ans[l+len1]=ans[l];\n\t\t\tfor (int l=1;l<=len1;l++)ans[l]=s1[l];\n\t\t\tlen+=len1;\n\t\t}\n\t}\n\tputs(ans+1);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\nstring solve(const string &s){\n\tint n = s.size();\n\tstring res;\n\tvi idx(n);\n\tint a = 0, b = 0;\n\trep(i, n){\n\t\tif(s[i] == 'a') idx[i] = a++;\n\t\telse idx[i] = b++;\n\t}\n\t\n\tif(s[0] == 'a'){\n\t\trep(i, n) if(s[i] == 'a'){\n\t\t\tres += \"ab\";\n\t\t\tfor(int k = idx[i++]; i < n && idx[i] != k; i++);\n\t\t}\n\t\treturn res;\n\t}\n\t\n\trep(k, a){\n\t\tstring tmp;\n\t\trep(i, n) if(idx[i] >= k) tmp += s[i];\n\t\tres = max(res, tmp);\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n, k = 0; string s, ans, tmp;\n\tcin >> n >> s;\n\tvector<string> v;\n\tfor(char c : s){\n\t\ttmp += c;\n\t\tk += c == 'a' ? 1 : -1;\n\t\tif(k == 0){\n\t\t\tv.pb(solve(tmp)); tmp.clear();\n\t\t}\n\t}\n\tfor(int i = v.size() - 1; i >= 0; i--){\n\t\tif(ans < v[i] + ans) ans = v[i] + ans;\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "    #include<bits/stdc++.h>\n    using namespace std;\n     \n    #define MAX 6012\n     \n    int n;\n     \n    vector<bool> dp[MAX];\n     \n    vector<pair<int, int> > pos;  //b , a\n    int mode[MAX];\n    bool us[MAX];\n     \n    bool use[MAX];\n    char buf[MAX];\n    string s;\n    vector<int> v1;\n    vector<int> v2;\n    bool cmp(vector<bool> a, vector<bool> b){\n    \tint lef = 0;\n    \tint rig = 0;\n    \twhile (1){\n    \t\twhile (lef < a.size() && a[lef] == false){\n    \t\t\tlef++;\n    \t\t}\n    \t\twhile (rig < b.size() && b[rig] == false){\n    \t\t\trig++;\n    \t\t}\n    \t\tif (rig == b.size())return true;\n    \t\tif (lef == a.size())return false;\n    \t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n    \t\tlef++;\n    \t\trig++;\n    \t}\n    \treturn false;\n    }\n    vector<bool> dfs(int b){\n    \tif (b == n)return vector<bool>(2 * n, 0);\n    \tif (us[b])return dp[b];\n    \tus[b] = true;\n    \tdp[b] = dfs(b + 1);  //choose nothing\n    \tif(pos[b].first<pos[b].second){\n\t\t\tint til;\n\t\t\tvector<bool> flag(2*n,0);\n\t\t\tfor(int j=b;j<pos.size();j++){\n\t\t\t\tif(pos[j].first>pos[b].second){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttil=j;\n\t\t\t\tflag[pos[j].first]=flag[pos[j].second]=true;\n\t\t\t}\n\t\t\tfor(int j=til+1;j<pos.size();j++){\n\t\t\t\tif(pos[j].first>pos[j-1].second)break;\n\t\t\t\tflag[pos[j].first]=flag[pos[j].second]=true;\n\t\t\t\ttil=j;\n\t\t\t}\n\t\t\tauto nex=dfs(til+1);\n\t\t\tfor(int i=0;i<2*n;i++){\n\t\t\t\tflag[i]=(flag[i]||nex[i]);\n\t\t\t}\n\t\t\tif(cmp(flag,dp[b])){\n\t\t\t\tdp[b]=flag;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tfor(int j=b+1;j<pos.size();j++){\n\t\t\t\tif(min(pos[j].first,pos[j].second)>pos[b].first){\n\t\t\t\t\tauto nex=dfs(j);\n\t\t\t\t\tnex[pos[b].first]=nex[pos[b].second]=true;\n\t\t\t\t\tstring ss;\n\t\t\t\t\tfor(int i=0;i<nex.size();i++){\n\t\t\t\t\t\tif(nex[i])ss.push_back(s[i]);\n\t\t\t\t\t}\n\t\t\t\t\tif(cmp(nex,dp[b])){\n\t\t\t\t\t\tdp[b]=nex;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvector<bool> fl(2*n,false);\n\t\t\tfl[pos[b].first]=fl[pos[b].second]=true;\n\t\t\tif(cmp(fl,dp[b])){\n\t\t\t\tdp[b]=fl;\n\t\t\t}\n\t\t}\n    \treturn dp[b];\n    }\n     \n    int main(){\n    \tcin >> n;\n    \tscanf(\"%s\", buf);\n    \ts = buf;\n    \tfor (int i = 0; i < s.size(); i++){\n    \t\tif (s[i] == 'a'){\n    \t\t\tv1.push_back(i);\n    \t\t}\n    \t\tif (s[i] == 'b'){\n    \t\t\tv2.push_back(i);\n    \t\t}\n    \t}\n    \tfor (int i = 0; i < v1.size(); i++){\n    \t\tpos.push_back(make_pair(v2[i], v1[i]));\n    \t}\n    \tvector<bool> uss = dfs(0);\n    \t//dfs2(0);\n    \tfor (int i = 0; i < s.size(); i++){\n    \t\tif (uss[i]){\n    \t\t\tputchar(s[i]);\n    \t\t}\n    \t}\n    \tputs(\"\");\n    \treturn 0;\n    }\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(j,l,r){\n        if(S[j]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  string ans;\n  RREP(i,s.size()){\n    chmax(ans,s[i]+ans);\n  }\n\n  cout << ans << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n    _____\n  .'     '.\n /  0   0  \\\n|     ^     |\n|  \\     /  |\n \\  '---'  /\n  '._____.'\n*/\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\nstruct chash\n{\n\tint operator()(int x) const\n\t{\n\t\tx ^= (x >> 20) ^ (x >> 12);\n\t\treturn x ^ (x >> 7) ^ (x >> 4);\n\t}\n};\n\ntemplate<typename T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename U> using hashtable = gp_hash_table<T, U, chash>;\nrandom_device(rd);\nmt19937 rng(rd());\n\ntemplate<class T>\nvoid readi(T &x)\n{\n\tT input = 0;\n\tbool negative = false;\n\tchar c = ' ';\n\twhile (c < '-')\n\t{\n\t\tc = getchar();\n\t}\n\tif (c == '-')\n\t{\n\t\tnegative = true;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0')\n\t{\n\t\tinput = input * 10 + (c - '0');\n\t\tc = getchar();\n\t}\n\tif (negative)\n\t{\n\t\tinput = -input;\n\t}\n\tx = input;\n}\ntemplate<class T>\nvoid printi(T output)\n{\n\tif (output == 0)\n\t{\n\t\tputchar('0');\n\t\treturn;\n\t}\n\tif (output < 0)\n\t{\n\t\tputchar('-');\n\t\toutput = -output;\n\t}\n\tint aout[20];\n\tint ilen = 0;\n\twhile(output)\n\t{\n\t\taout[ilen] = ((output % 10));\n\t\toutput /= 10;\n\t\tilen++;\n\t}\n\tfor (int i = ilen - 1; i >= 0; i--)\n\t{\n\t\tputchar(aout[i] + '0');\n\t}\n\treturn;\n}\ntemplate<class T>\nvoid ckmin(T &a, T b)\n{\n\ta = min(a, b);\n}\ntemplate<class T>\nvoid ckmax(T &a, T b)\n{\n\ta = max(a, b);\n}\ntemplate<class T, class U>\nT nmod(T &x, U mod)\n{\n\tif (x >= mod) x -= mod;\n}\ntemplate<class T>\nT randomize(T mod)\n{\n\treturn (uniform_int_distribution<T>(0, mod - 1))(rng);\n}\n\n#define y0 ___y0\n#define y1 ___y1\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define PF push_front\n#define LB lower_bound\n#define UB upper_bound\n#define fi first\n#define se second\n#define debug(x) cerr << #x << \" = \" << x << endl;\n\nconst long double PI = 4.0 * atan(1.0);\nconst long double EPS = 1e-10;\n\n#define MAGIC 347\n#define SINF 10007\n#define CO 1000007\n#define INF 1000000007\n#define BIG 1000000931\n#define LARGE 1696969696967ll\n#define GIANT 2564008813937411ll\n#define LLINF 2696969696969696969ll\n#define MAXN 6013\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ld, ld> pdd;\n\nint N, K;\nint arr[MAXN], pref[MAXN];\nint blocks[MAXN];\nint partner[MAXN];\nbitset<MAXN> typ;\nvector<pii> idx[MAXN];\nvector<bool> dp[MAXN];\nvector<bool> ans;\nbitset<MAXN> flag;\n\nbool operator < (const vector<bool> &a, const vector<bool> &b)\n{\n\tfor (int i = 0; i < min(a.size(), b.size()); i++)\n\t{\n\t\tif (a[i] != b[i])\n\t\t{\n\t\t\treturn a[i] < b[i];\n\t\t}\n\t}\n\treturn (a.size() < b.size());\n}\nbool operator > (const vector<bool> &a, const vector<bool> &b)\n{\n\treturn b < a;\n}\n\nint32_t main()\n{\n\tios_base::sync_with_stdio(0);\n\t// cout << fixed << setprecision(10);\n\t// cerr << fixed << setprecision(10);\n\t// freopen (\"file.in\", \"r\", stdin);\n\t// freopen (\"file.out\", \"w\", stdout);\n\tcin >> N;\n\tN *= 2;\n\tstring temps;\n\tcin >> temps;\n\tfor (int i = 0; i < N; i++)\n\t{\n\t\tarr[i] = (temps[i] == 'a' ? 1 : -1);\n\t\tpref[i + 1] = pref[i] + arr[i];\n\t}\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tif (pref[i] == 0)\n\t\t{\n\t\t\tK++;\n\t\t\tblocks[K] = i - 1;\n\t\t}\n\t}\n\tblocks[0] = -1;\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tidx[i].resize((rt - lt + 1) / 2);\n\t\tint iter = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == 1)\n\t\t\t{\n\t\t\t\tidx[i][iter].fi = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\titer = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == -1)\n\t\t\t{\n\t\t\t\tidx[i][iter].se = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\t// cerr << \"block \" << i << endl;\n\t\tfor (pii p : idx[i])\n\t\t{\n\t\t\tpartner[p.fi] = p.se;\n\t\t\tpartner[p.se] = p.fi;\n\t\t\t// cerr << p.fi << ' ' << p.se << endl;\n\t\t}\n\t\ttyp[i] = (bool) (idx[i][0].fi > idx[i][0].se);\n\t}\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t//if typ[i] is true, it's abababababab\n\t\t//if typ[i] is false, it's babababababa\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tif (typ[i])\n\t\t{\n\t\t\t//babababa\n\t\t\tvector<bool> temp;\n\t\t\tfor (int j = idx[i].size() - 1; j >= 0; j--)\n\t\t\t{\n\t\t\t\tflag[idx[i][j].fi] = true;\n\t\t\t\tflag[idx[i][j].se] = true;\n\t\t\t\ttemp.clear();\n\t\t\t\tfor (int k = lt; k <= rt; k++)\n\t\t\t\t{\n\t\t\t\t\tif (flag[k])\n\t\t\t\t\t{\n\t\t\t\t\t\ttemp.PB(arr[k] - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (temp > dp[i])\n\t\t\t\t{\n\t\t\t\t\tdp[i] = temp;\n\t\t\t\t}\n\t\t\t\t// for (bool b : dp[i])\n\t\t\t\t// {\n\t\t\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t\t\t// }\n\t\t\t\t// cerr << endl;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//ababababab\n\t\t\tfor (int j = lt; j <= rt;)\n\t\t\t{\n\t\t\t\tdp[i].PB(0);\n\t\t\t\tdp[i].PB(1);\n\t\t\t\tj = partner[j];\n\t\t\t\tauto it = UB(idx[i].begin(), idx[i].end(), MP(j + 1, -INF));\n\t\t\t\tif (it == idx[i].end()) break;\n\t\t\t\tj = it -> fi;\n\t\t\t}\n\t\t}\n\t}\n\t// cerr << \"our dps\\n\";\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t// for (bool b : dp[i])\n\t\t// {\n\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t// }\n\t\t// cerr << endl;\n\t\tbool used = true;\n\t\tfor (int j = i + 1; j <= K; j++)\n\t\t{\n\t\t\tfor (int k = 0; k < dp[j].size() && k < dp[i].size(); k++)\n\t\t\t{\n\t\t\t\tif (dp[j][k] == 1 && dp[i][k] == 0)\n\t\t\t\t{\n\t\t\t\t\tused = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!used)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (used)\n\t\t{\n\t\t\tfor (bool b : dp[i])\n\t\t\t{\n\t\t\t\tans.PB(b);\n\t\t\t}\n\t\t}\n\t}\n\tfor (bool b : ans)\n\t{\n\t\tcout << (b ? 'b' : 'a');\n\t}\n\tcout << '\\n';\n\t// cerr << \"time elapsed = \" << (clock() / (CLOCKS_PER_SEC / 1000)) << \" ms\" << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define meow(args...) fprintf(stderr, args)\ntemplate<class T1, class T2> inline bool cmin(T1 &a, const T2 &b) {return b<a?(a=b, true):false;}\ntemplate<class T1, class T2> inline bool cmax(T1 &a, const T2 &b) {return a<b?(a=b, true):false;}\ntemplate<class Type> Type read() {\n\tType a;\n\tbool b;\n\tunsigned char c;\n\twhile(c=getchar()-48, (c>9)&(c!=253));\n\tfor(a=(b=c==253)?0:c; (c=getchar()-48)<=9; a=a*10+c);\n\treturn b?-a:a;\n}\nint (*rd)()=read<int>;\ntypedef unsigned u32;\ntypedef long long s64;\ntypedef unsigned long long u64;\n\nconst int N=6005;\nint a[N], b[N];\nchar s[N], cur[N], f[N][N];\nint main() {\n\tint n, m=0;\n\tassert(scanf(\"%d%s\", &n, s)==2);\n\tfor(int l=0, r; l<2*n; l=r, ++m) {\n\t\tint na=0, nb=0;\n\t\tfor(r=l; r==l||na!=nb; ++r) (s[r]=='a'?a[na++]:b[nb++])=r;\n\t\tif(s[l]=='a') {\n\t\t\tchar *p=f[m];\n\t\t\tfor(int i=0, j=l-1, len=0; i<na; ++i) if(a[i]>j) *p++='a', *p++='b', j=b[i];\n\t\t} else {\n\t\t\tfor(int i=na; i--; ) {\n\t\t\t\tmemset(cur, 0, r-l);\n\t\t\t\tfor(int j=i; j<na; ++j) cur[a[j]-l]='a', cur[b[j]-l]='b';\n\t\t\t\t*std::remove(cur, cur+r-l, 0)=0;\n\t\t\t\tif(strcmp(cur, f[m])>0) strcpy(f[m], cur);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=m; i--; ) {\n\t\tstrcat(f[i], f[i+1]);\n\t\tif(strcmp(f[i+1], f[i])>0) strcpy(f[i], f[i+1]);\n\t}\n\tputs(f[0]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\n#define N 10010\n#define mr make_pair\nusing namespace std;\nint n,g[2],s[N][2],w[N];\nstring dp[N];\nchar ch[N];\nstring que(int l,int r){string no=\"\";for (int i=0;i<2*n;i++)if (w[i]>=l&&w[i]<=r)no+=ch[i];return no;}\nint main(){\n\tcin>>n;\n\tfor (int i=0;i<2*n;i++){\n\t\tch[i]=getchar();while (ch[i]!='a'&&ch[i]!='b')ch[i]=getchar();\n\t\tg[ch[i]-'a']++;s[g[ch[i]-'a']][ch[i]-'a']=i;w[i]=g[ch[i]-'a'];\n\t}\n\tfor (int i=n;i>=1;i--){\n\t\tdp[i]=dp[i+1];\n\t\tif (s[i][0]<s[i][1]){\n\t\t\tint x=i+1;\n\t\t\twhile (x<=n&&s[x][0]<s[i][1])x++;\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[x]);\n\t\t}else{\n\t\t\tint x=i+1,y=s[i][0];\n\t\t\twhile (x<=n&&s[x][1]<y)y=s[x][0],x++;\n\t\t\tdp[i]=max(dp[i],que(i,x-1)+dp[x]);\n\t\t}\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <list>\n#include <stack>\n#include <queue>\n#include <bitset>\n#include <numeric>\n#include <cassert>\n#include <array>\n#include <memory>\n#include <random>\n#ifdef DEBUG\n#include \"./Lib/debug.hpp\"\n#include \"./Lib/Timer.hpp\"\n#include \"./Lib/sample.hpp\"\n#else\n#define dump(...)\n#endif\n\n/* (=＾o＾=) */\n#define int ll\n\n/* macro */\n#define FOR(i, b, e) for(ll i = (ll)(b); i < (ll)(e); ++i)\n#define RFOR(i, b, e) for(ll i = (ll)(e-1); i >= (ll)(b); --i)\n#define REP(i, n) FOR(i, 0, n)\n#define RREP(i, n) RFOR(i, 0, n)\n#define REPC(x,c) for(const auto& x:(c))\n#define REPI2(it,b,e) for(auto it = (b); it != (e); ++it)\n#define REPI(it,c) REPI2(it, (c).begin(), (c).end())\n#define RREPI(it,c) REPI2(it, (c).rbegin(), (c).rend())\n#define REPI_ERACE2(it, b, e) for(auto it = (b); it != (e);)\n#define REPI_ERACE(it, c) REPI_ERACE2(it, (c).begin(), (c).end())\n#define ALL(x) (x).begin(),(x).end()\n#define cauto const auto&\n/* macro func */\ntemplate<class T>\ninline auto sort(T& t) { std::sort(ALL(t)); }\ntemplate<class T>\ninline auto rsort(T& t) { std::sort((t).rbegin(), (t).rend()); }\ntemplate<class T>\ninline auto unique(T& t) { (t).erase(unique((t).begin(), (t).end()), (t).end()); }\ntemplate<class T, class S>\ninline auto chmax(T& t, const S& s) { if (s > t) { t = s; return true; } return false; }\ntemplate<class T, class S>\ninline auto chmaxE(T& t, const S& s) { if (s >= t) { t = s; return true; } return false; }\ntemplate<class T, class S>\ninline auto chmin(T& t, const S& s) { if (s < t) { t = s; return true; } return false; }\ninline auto BR() { std::cout << \"\\n\"; }\n\n/* type define */\nusing ll = long long;\nusing PAIR = std::pair<ll, ll>;\nusing VS = std::vector<std::string>;\nusing VL = std::vector<long long>;\nusing VVL = std::vector<VL>;\nusing VVVL = std::vector<VVL>;\nusing VD = std::vector<double>;\ntemplate<class T>\nusing V = std::vector<T>;\n\n/* using std */\nusing std::cout;\nconstexpr char endl = '\\n';\nusing std::cin;\nusing std::pair;\nusing std::string;\nusing std::stack;\nusing std::queue;\nusing std::vector;\nusing std::list;\nusing std::map;\nusing std::unordered_map;\nusing std::multimap;\nusing std::unordered_multimap;\nusing std::set;\nusing std::unordered_set;\nusing std::unordered_multiset;\nusing std::multiset;\nusing std::bitset;\nusing std::priority_queue;\nusing std::tuple;\n\n/* constant value */\nconstexpr ll MOD = 1000000007;\n//constexpr ll MOD = 998244353;\n\n/* Initial processing  */\nstruct Preprocessing { Preprocessing() { std::cin.tie(0); std::ios::sync_with_stdio(0); }; }_Preprocessing;\n\n/* Remove the source of the bug */\ninline signed pow(signed, signed) { assert(false); return -1; }\n\n/* define hash */\nnamespace std {\ntemplate <>\tclass hash<std::pair<ll, ll>> { public:\tsize_t operator()(const std::pair<ll, ll>& x) const { return hash<ll>()(1000000000 * x.first + x.second); } };\n}\n\n/* input */\ntemplate<class T> std::istream& operator >> (std::istream& is, vector<T>& vec) { for (T& x : vec) is >> x; return is; }\n\n//=============================================================================================\n\n/**\n * SuffixArrayを構築する\n * O(N)\n * 文字列の全てのsuffixをソートした配列が得られる\n * ex) abadc -> [0, 2, 1, 4, 3]([abadc, adc, badc, c, dc])\n *\n * SA-IS(Suffix Array - Induced Sort)で実装\n */\nclass SuffixArray {\n\tenum class TYPE {\n\t\tL, S, LMS\n\t};\n\n\tconst std::string m_str;\n\tconst std::vector<int> m_suffixArray;\n\n\t/* string to vector<int> */\n\tstatic std::vector<int> toIntVec(const std::string& str) {\n\t\tstd::vector<int> vec;\n\t\tvec.reserve(str.size() + 1);\n\t\tfor (const auto& c : str) {\n\t\t\tvec.emplace_back(c - '0' + 1);\n\t\t}\n\t\tvec.emplace_back(0);\n\t\treturn vec;\n\t}\n\n\t/* classify { L, S, LMS } */\n\tstatic std::vector<TYPE> classifying(const std::vector<int>& str) {\n\t\tauto sz = str.size();\n\t\tauto typeArray = std::vector<TYPE>(sz);\n\t\ttypeArray[sz - 1] = TYPE::S;\n\t\tfor (int i = sz - 2; i >= 0; --i) {\n\t\t\tif (str[i] == str[i + 1]) {\n\t\t\t\ttypeArray[i] = typeArray[i + 1];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttypeArray[i] = (str[i] < str[i + 1]) ? TYPE::S : TYPE::L;\n\t\t}\n\t\tfor (int i = 1; i < sz; ++i) {\n\t\t\tif (typeArray[i - 1] == TYPE::L && typeArray[i] == TYPE::S) {\n\t\t\t\ttypeArray[i] = TYPE::LMS;\n\t\t\t}\n\t\t}\n\t\treturn typeArray;\n\t}\n\n\t/* induced sort */\n\tstatic std::vector<int> inducedSort(const std::vector<int>& str, const std::vector<TYPE>& type, std::list<int>& lmsList) {\n\t\tauto sz = str.size();\n\t\tauto nList = std::set<int>();\n\t\tfor (const auto& c : str) { nList.emplace(c); }\n\n\t\tauto befCheck = [&](int k, auto& addList, bool rev) {\n\t\t\tif (k == 0) { return; }\n\t\t\tif (!rev && type[k - 1] == TYPE::L) {\n\t\t\t\taddList[str[k - 1]].emplace_back(k - 1);\n\t\t\t}\n\t\t\tif (rev && type[k - 1] != TYPE::L) {\n\t\t\t\taddList[str[k - 1]].emplace_front(k - 1);\n\t\t\t}\n\t\t};\n\n\t\tauto checkAndUpdate = [&](int n, auto& checkList, auto& addList, bool rev) {\n\t\t\tauto& lst = checkList[n];\n\t\t\tif (rev) {\n\t\t\t\tfor (auto itr = lst.rbegin(); itr != lst.rend(); ++itr) { befCheck(*itr, addList, rev); }\n\t\t\t} else {\n\t\t\t\tfor (const auto& k : lst) { befCheck(k, addList, rev); }\n\t\t\t}\n\t\t};\n\n\t\t/* set LMS */\n\t\tauto tailList = std::unordered_map<int, std::list<int>>();\n\t\tfor (const auto& i : lmsList) { tailList[str[i]].emplace_back(i); }\n\n\t\t/* set L-type */\n\t\tauto headList = std::unordered_map<int, std::list<int>>();\n\t\tfor (const auto& n : nList) {\n\t\t\tcheckAndUpdate(n, headList, headList, false);\n\t\t\tcheckAndUpdate(n, tailList, headList, false);\n\t\t}\n\n\t\t/* set S-type*/\n\t\ttailList = std::unordered_map<int, std::list<int>>();\n\t\tfor (auto itr_n = nList.rbegin(); itr_n != nList.rend(); ++itr_n) {\n\t\t\tauto n = *itr_n;\n\t\t\tcheckAndUpdate(n, tailList, tailList, true);\n\t\t\tcheckAndUpdate(n, headList, tailList, true);\n\t\t}\n\n\t\t/* merge */\n\t\tauto suffixArray = std::vector<int>();\n\t\tsuffixArray.reserve(sz);\n\t\tfor (const auto& n : nList) {\n\t\t\tfor (const auto& c : headList[n]) { suffixArray.emplace_back(c); }\n\t\t\tfor (const auto& c : tailList[n]) { suffixArray.emplace_back(c); }\n\t\t}\n\n\t\treturn suffixArray;\n\t}\n\n\t/* order lms -> sorted lms */\n\tstatic std::unordered_map<int, int> getLmsChanger(const std::vector<int>& str, const std::vector<TYPE>& type, const std::list<int>& lms) {\n\t\tif (lms.size() == 1) { return std::unordered_map<int, int>{ { str.size() - 1, 0 }}; }\n\t\tstd::unordered_map<int, int> changer{{static_cast<int>(str.size()) - 1,0},{*++lms.begin(),1}};\n\t\tint num = 1;\n\t\tfor (auto itr = ++lms.begin(); itr != (--lms.end());) {\n\t\t\tauto f1 = *itr;\n\t\t\tauto f2 = *(++itr);\n\n\t\t\tbool isSame = false;\n\t\t\tfor (int i = 0;; ++i) {\n\t\t\t\tif (str[f1 + i] != str[f2 + i]) { break; }\n\t\t\t\tauto b1 = (type[f1 + i] == TYPE::LMS);\n\t\t\t\tauto b2 = (type[f2 + i] == TYPE::LMS);\n\t\t\t\tif (b1 | b2 && i > 0) {\n\t\t\t\t\tif (b1 & b2) { isSame = true; break; }\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!isSame) { ++num; }\n\t\t\tchanger.emplace(f2, num);\n\t\t}\n\t\treturn changer;\n\t}\n\n\t/* calc Suffix Array*/\n\tstatic std::vector<int> constructSuffixArray(const std::vector<int>& str) {\n\t\tauto type = classifying(str);\n\n\t\t/* calc fake Suffix Array using order seed*/\n\t\tauto lmsOrder = [&type]() {\n\t\t\tauto lms = std::list<int>();\n\t\t\tfor (int i = 0; i < type.size(); ++i) if (type[i] == TYPE::LMS) { lms.emplace_back(i); }\n\t\t\treturn lms;\n\t\t}();\n\t\tauto fakeArray = inducedSort(str, type, lmsOrder);\n\n\t\t/* calc true seed */\n\t\tauto lmsFakeOrder = [&fakeArray, &type]() {\n\t\t\tauto lms = std::list<int>();\n\t\t\tlms.emplace_back(static_cast<int>(type.size()) - 1);\n\t\t\tfor (const auto& i : fakeArray) if (type[i] == TYPE::LMS) { lms.emplace_back(i); }\n\t\t\treturn lms;\n\t\t}();\n\t\tauto changer = getLmsChanger(str, type, lmsFakeOrder);\n\t\tauto& lmsTrueOrder = lmsFakeOrder;\n\t\tif (changer[*lmsFakeOrder.rbegin()] + 1 < lmsFakeOrder.size()) {\n\t\t\t/* exist same lms-substring */\n\t\t\tauto str = std::vector<int>();\n\t\t\tauto def = std::vector<int>();\n\t\t\tstr.reserve(lmsOrder.size());\n\t\t\tdef.reserve(lmsOrder.size());\n\t\t\tfor (const auto& c : lmsOrder) {\n\t\t\t\tstr.emplace_back(changer[c]);\n\t\t\t\tdef.emplace_back(c);\n\t\t\t}\n\t\t\tauto lmsSuffixArray = constructSuffixArray(str);\n\t\t\tlmsTrueOrder = std::list<int>{static_cast<int>(type.size()) - 1};\n\t\t\tfor (const auto& c : lmsSuffixArray) {\n\t\t\t\tlmsTrueOrder.emplace_back(def[c]);\n\t\t\t}\n\t\t}\n\n\t\t/* calc true Suffix Array using true seed */\n\t\tauto suffixArray = inducedSort(str, type, lmsTrueOrder);\n\n\t\treturn suffixArray;\n\t}\n\npublic:\n\tSuffixArray(const std::string& str) :m_str(str), m_suffixArray(constructSuffixArray(toIntVec(str))) {}\n\n\t/**\n\t * 引数として与えられたpatternの出現位置リストを返す\n\t */\n\tstd::list<int> findPattern(const std::string& pattern) const {\n\n\t\tauto find = [&](const std::string& ptn) {\n\t\t\tint end = m_suffixArray.size();\n\t\t\tint ok = end;\n\t\t\tint ng = -1;\n\t\t\twhile (ok - ng > 1) {\n\t\t\t\tint mid = (ok + ng) / 2;\n\t\t\t\tauto sub = m_str.substr(m_suffixArray[mid], end);\n\t\t\t\tint isOk = (ptn <= sub);\n\t\t\t\tif (isOk) { ok = mid; } else { ng = mid; }\n\t\t\t}\n\t\t\treturn ok;\n\t\t};\n\t\tauto patternUpper = [&pattern]() {\n\t\t\tauto ptn = pattern;\n\t\t\t++* ptn.rbegin();\n\t\t\treturn ptn;\n\t\t}();\n\t\tauto fl = find(pattern);\n\t\tauto fu = find(patternUpper);\n\t\tstd::list<int> lst;\n\t\tfor (int i = fl; i < fu; ++i) {\n\t\t\tlst.emplace_back(m_suffixArray[i]);\n\t\t}\n\t\treturn lst;\n\t}\n\n\tauto getSuffixArray() const {\n\t\treturn m_suffixArray;\n\t}\n\n\t/* output fot debug */\n\tvoid debugOutput() const {\n\t\tdump(m_suffixArray);\n\t\tauto end = m_str.size();\n\t\tREPC(x, m_suffixArray) {\n\t\t\tcout << m_str.substr(x, end) << endl;\n\t\t}\n\t}\n};\n\n\nclass CumulativeSum {\n\tconst ll size;\n\tstd::vector<ll> sumList;\npublic:\n\n\tCumulativeSum() = delete;\n\tCumulativeSum(const std::vector<ll>& v) :size(v.size()), sumList(size + 1) {\n\t\tfor (ll i = 0; i < size; ++i) {\n\t\t\tsumList[i + 1] = sumList[i] + v[i];\n\t\t}\n\t}\n\tll get(ll n) {\n\t\treturn sumList[n + 1];\n\t}\n\tll get(ll l, ll r) {\n\t\tif (r < l) { return 0LL; }\n\t\tl = std::max(l, 0LL); r = std::min(r, size - 1);\n\t\treturn sumList[r + 1] - sumList[l];\n\t}\n};\n\n\nsigned main() {\n\tll n;\n\tstring s;\n\tcin >> n >> s;\n\tn *= 2;\n\tauto sa = SuffixArray(s).getSuffixArray();\n\n\tVL toA(n / 2 + 1, -1);\n\tVL toB(n / 2 + 1, -1);\n\tVL v; v.reserve(n);\n\tV<bool> w; w.reserve(n);\n\t{\n\t\tll a = 0, b = 0;\n\t\tREPC(c, s) {\n\t\t\tauto& t = (c == 'a') ? a : b;\n\t\t\t++t;\n\t\t\tv.emplace_back(t);\n\n\t\t\tauto& nt = (c == 'a') ? b : a;\n\t\t\tw.emplace_back((t > nt) ? true : false);\n\n\t\t\t((c == 'a') ? toA : toB)[t] = v.size() - 1;\n\t\t}\n\t}\n\n\tV<string> dp(n);\n\tstring lt = \"\";\n\tRREP(i, n) if (w[i]) {\n\t\tll p = v[i];\n\t\tif (s[i] == 'a') {\n\t\t\tstring ans = \"ab\";\n\t\t\tif (toB[p] + 1 < n) { ans += dp[toB[p] + 1]; }\n\t\t\tif (ans > lt) { lt = ans; }\n\t\t\tdp[i] = lt;\n\t\t} else {\n\t\t\tstring ans = \"\";\n\t\t\tll end = toA[p];\n\t\t\tll e = p - 1;\n\t\t\tFOR(j, i, end + 1) {\n\t\t\t\tif (s[j] == 'b') { ++e; }\n\t\t\t\tif (s[j] == 'b' || (p <= v[j] && v[j] <= e)) {\n\t\t\t\t\tans += s[j];\n\t\t\t\t\tchmax(end, toA[v[j]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (end + 1 < n) { ans += dp[end + 1]; }\n\t\t\tif (ans > lt) { lt = ans; }\n\t\t\tdp[i] = lt;\n\n\t\t}\n\t}\n\tcout << dp[0] << endl;\n\tdump(dp);\n\tdump(v, w);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <set>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tint n;\n\tstring s;\n\tcin >> n >> s;\n\tconst int m = n * 2;\n\tvector<int> pos(m), inv(m), a(n), b(n);\n\tfor(int i = 0, j = 0, k = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\ta[j] = i;\n\t\t\tpos[i] = j++;\n\t\t}else{\n\t\t\tb[k] = i;\n\t\t\tpos[i] = k++;\n\t\t}\n\t}\n\tfor(int i = 0; i < m; ++i){\n\t\tif(s[i] == 'a'){\n\t\t\tinv[i] = b[pos[i]];\n\t\t}else{\n\t\t\tinv[i] = a[pos[i]];\n\t\t}\n\t}\n\tset<int> current_marks;\n\tvector<char> current_string;\n\tfor(int current_state = 0; current_state < m; ){\n\t\t{\t// append 'b'\n\t\t\tauto marks = current_marks;\n\t\t\tauto target = current_string;\n\t\t\tint state = current_state, done = target.size();\n\t\t\ttarget.push_back('b');\n\t\t\twhile(state < m && done < target.size()){\n\t\t\t\tif(inv[state] > state){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}\n\t\t\t\t\t++state;\n\t\t\t\t}else if(marks.find(inv[state]) != marks.end()){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint rollback = inv[state];\n\t\t\t\t\t\tauto it = marks.end();\n\t\t\t\t\t\twhile(it != marks.begin() && *prev(it) >= rollback){\n\t\t\t\t\t\t\tconst int p = *(--it);\n\t\t\t\t\t\t\tif(inv[p] < p){ rollback = min(rollback, inv[p]); }\n\t\t\t\t\t\t\tif(inv[p] <= state){ marks.erase(it++); }\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\tdone = marks.size();\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t++state;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(done == target.size()){\n\t\t\t\tcurrent_state = state;\n\t\t\t\tcurrent_marks = move(marks);\n\t\t\t\tcurrent_string = move(target);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\t{\t// append 'a'\n\t\t\tauto marks = current_marks;\n\t\t\tauto target = current_string;\n\t\t\tint state = current_state, done = target.size();\n\t\t\ttarget.push_back('a');\n\t\t\twhile(state < m && done < target.size()){\n\t\t\t\tif(inv[state] > state){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}\n\t\t\t\t\t++state;\n\t\t\t\t}else if(marks.find(inv[state]) != marks.end()){\n\t\t\t\t\tif(s[state] == target[done]){\n\t\t\t\t\t\tmarks.insert(state);\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\t++done;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint rollback = inv[state];\n\t\t\t\t\t\tauto it = marks.end();\n\t\t\t\t\t\twhile(it != marks.begin() && *prev(it) >= rollback){\n\t\t\t\t\t\t\tconst int p = *(--it);\n\t\t\t\t\t\t\tif(inv[p] < p){ rollback = min(rollback, inv[p]); }\n\t\t\t\t\t\t\tif(inv[p] <= state){ marks.erase(it++); }\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++state;\n\t\t\t\t\t\tdone = marks.size();\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t++state;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(done == target.size()){\n\t\t\t\tcurrent_state = state;\n\t\t\t\tcurrent_marks = move(marks);\n\t\t\t\tcurrent_string = move(target);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\tcurrent_string.push_back('\\0');\n\tcout << current_string.data() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define cs const\n#define re register\n#define pb push_back\n#define pii pair<int,int>\n#define ll long long\n#define y1 shinkle\n#define fi first\n#define se second\n#define bg begin\nnamespace IO{\n\ncs int RLEN=1<<20|1;\ninline char gc(){\n    static char ibuf[RLEN],*ib,*ob;\n    (ib==ob)&&(ob=(ib=ibuf)+fread(ibuf,1,RLEN,stdin));\n    return (ib==ob)?EOF:*ib++;\n}\ninline int read(){\n    char ch=gc();\n    int res=0;bool f=1;\n    while(!isdigit(ch))f^=ch=='-',ch=gc();\n    while(isdigit(ch))res=(res*10)+(ch^48),ch=gc();\n    return f?res:-res;\n}\ninline ll readll(){\n    char ch=gc();\n    ll res=0;bool f=1;\n    while(!isdigit(ch))f^=ch=='-',ch=gc();\n    while(isdigit(ch))res=(res*10)+(ch^48),ch=gc();\n    return f?res:-res;\n}\ninline char readchar(){\n\tchar ch=gc();\n\twhile(isspace(ch))ch=gc();\n\treturn ch;\n}\ninline int readstring(char *s){\n\tint top=0;char ch=gc();\n\twhile(isspace(ch))ch=gc();\n\twhile(!isspace(ch)&&ch!=EOF)s[++top]=ch,ch=gc();\n\ts[top+1]='\\0';return top;\n}\n\n}\nusing IO::read;\nusing IO::readll;\nusing IO::readstring;\nusing IO::readchar; \ntemplate<typename tp>inline void chemx(tp &a,tp b){(a<b)?(a=b):0;}\ntemplate<typename tp>inline void chemn(tp &a,tp b){(a>b)?(a=b):0;}\ncs int N=6005;\nstring f[N];\nint bel[N],pos[N],kd[N],n,cnt;\nchar str[N];\nint main(){\n\t#ifdef Stargazer\n\tfreopen(\"lx.in\",\"r\",stdin);\n\t#endif\n\tn=read();readstring(str);\n\tfor(int i=1,s=0;i<=2*n;i++){\n\t\ts+=(str[i]=='a'?1:-1);\n\t\tif(!s){\n\t\t\tpos[++cnt]=i,kd[cnt]=(str[i]=='a');\n\t\t}\n\t}\n\tbool vt=0;\n\tfor(int i=cnt;i;i--)\n\tif(kd[i]){\n\t\tvt=1;\n\t\tint c1=0,c2=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n\t\tif(str[j]=='a')bel[j]=++c1;else bel[j]=++c2;\n\t\tf[i]=f[i+1];\n\t\tfor(int j=1;j<=c1;j++){\n\t\t\tstring now;\n\t\t\tfor(int k=pos[i-1]+1;k<=pos[i];k++)\n\t\t\tif(bel[k]>=j)now=now+str[k];\n\t\t\tf[i]=max(f[i],now+f[i+1]);\n\t\t}\n\t}\n\telse if(!vt){\n\t\tint c1=0,c2=0;\n\t\tfor(int j=pos[i-1]+1;j<=pos[i];j++)\n\t\tif(str[j]=='a')bel[j]=++c1;else bel[j]=++c2;\n\t\tfor(int r=pos[i-1]+1;;){\n\t\t\twhile(r<=pos[i]&&str[r]=='b')r++;\n\t\t\tif(r>pos[i])break;\n\t\t\tf[i]+=\"ab\";\n\t\t\tint t=bel[r];r++;\n\t\t\twhile(bel[r]!=t)r++;\n\t\t\tr++;\n\t\t}f[i]+=f[i+1];\n\t}\n\telse f[i]=f[i+1];\n\tcout<<f[1];return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <random>\n#include <set>\n#include <sstream>\n#include <string>\n#include <utility>\n#include <vector>\n\nconst int DEBUG = 0;\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n#define DEBUGP(val) cerr << #val << \"=\" << val << \"\\n\"\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\nconst ll mod = 1e9 + 7;\n\n\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> cand;\n  string ma = \"TAPRIS\";\n  string cur;\n  string aux;\n  int delta = 0;\n  VI zeros(1, 0);\n  REP(i, 0, 2 * n) {\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) zeros.push_back(i + 1);\n  }\n  bool ba = 0;\n  REP(i, 0, 2 * n + 1) {\n    int nxt = *lower_bound(zeros.begin(), zeros.end(), i + 1);\n    ma = max(ma, cur + s.substr(i, nxt - i));\n    if (i == 2 * n) break;\n    if (cur.size() > 0){\n      if (ba) {\n\tif (cur[cur.size() - 1] == 'a' && s[i] == 'b') {\n\t  assert (delta > 0);\n\t  cur = string(delta, 'b');\n\t}\n      } else {\n\tif (cur[cur.size() - 1] == 'a' && s[i] == 'b') {\n\t  assert (delta < 0);\n\t  aux += \"ab\";\n\t  cur = aux;\n\t}\n      }\n    }\n    cur += s[i];\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) {\n      cand.push_back(ba ? ma : aux);\n      ma = \"TAPRIS\";\n      cur=\"\";\n      aux = \"\";\n      ba = 0;\n    }\n    if (delta > 0) ba = 1;\n  }\n  if (DEBUG) {\n    REP(i, 0, cand.size()) {\n      DEBUGP(cand[i]);\n    }\n  }\n  ma = \"\";\n  for (int i = (int)cand.size() - 1; i >= 0; --i) {\n    ma = max(ma, cand[i] + ma);\n  }\n  cout << ma << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\n \nusing namespace std;\nusing namespace __gnu_pbds;\n \n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n \ntypedef long long ll;\ntypedef pair<int,int> ii;\ntypedef vector<int> vi;\ntypedef long double ld; \ntypedef tree<ii, null_type, less<ii>, rb_tree_tag, tree_order_statistics_node_update> pbds;\n\nint a[3333];\nint b[3333];\nint iv[6666];\n\nbool notprefix(string a, string b) //a is not a prefix of b\n{\n\tif(a.length()>b.length()) return true;\n\tfor(int i=0;i<a.length();i++)\n\t{\n\t\tif(a[i]!=b[i]) return true;\n\t}\n\treturn false;\n}\n\nstring solve(string s)\n{\n\tint n = s.length(); n>>=1;\n\tint acnt = 0; int bcnt = 0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a') {iv[i] = acnt; a[acnt++] = i;}\n\t\telse {iv[i] = bcnt; b[bcnt++] = i;}\n\t}\n\tvector<ii> groups;\n\tint l=0; \n\tfor(int i=0;i<n;i++)\n\t{\n\t\tif(i>0&&min(a[i],b[i])>max(a[i-1],b[i-1]))\n\t\t{\n\t\t\tgroups.pb(mp(l,i-1));\n\t\t\tl=i;\n\t\t}\n\t}\n\tgroups.pb(mp(l,n-1));\n\tvector<string> bestg;\n\tfor(int z=0;z<groups.size();z++)\n\t{\n\t\tint l = groups[z].fi; int r = groups[z].se;\n\t\tif(a[l]>b[l])\n\t\t{\n\t\t\tset<int> S;\n\t\t\tstring best = \"\"; \n\t\t\tfor(int i=r;i>=l;i--)\n\t\t\t{\n\t\t\t\tstring cur=\"\";\n\t\t\t\tS.insert(a[i]); S.insert(b[i]);\n\t\t\t\tfor(int v:S) cur+=s[v];\n\t\t\t\tif(cur>best) best=cur;\n\t\t\t}\n\t\t\tbestg.pb(best);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring cur = \"\";\n\t\t\tint i=a[l];\n\t\t\twhile(i<=b[r])\n\t\t\t{\n\t\t\t\tif(s[i]=='a')\n\t\t\t\t{\n\t\t\t\t\tcur+=\"ab\";\n\t\t\t\t\ti = b[iv[i]]+1;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbestg.pb(cur);\n\t\t}\n\t}\n\tstack<string> S;\n\tfor(string x:bestg)\n\t{\n\t\twhile(!S.empty()&&x>S.top()&&notprefix(S.top(),x)) S.pop();\n\t\tS.push(x);\n\t}\n\tstring ans;\n\tvector<string> V; while(!S.empty()) {V.pb(S.top()); S.pop();}\n\tfor(int i=int(V.size())-1;i>=0;i--) ans+=V[i];\n\treturn ans;\n}\n\nvoid run()\n{\n\tint n; cin>>n;\n\tstring s; cin>>s;\n\tcout<<solve(s)<<'\\n'; exit(0);\n}\n\nstring naive(string s)\n{\n\tint n = s.length(); n>>=1;\n\tstring best = \"\";\n\tint acnt = 0; int bcnt = 0;\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a') {iv[i] = acnt; a[acnt++] = i;}\n\t\telse {iv[i] = bcnt; b[bcnt++] = i;}\n\t}\n\tfor(int i=1;i<(1<<n);i++)\n\t{\n\t\tvi v;\n\t\tfor(int j=0;j<n;j++)\n\t\t{\n\t\t\tif(i&(1<<j))\n\t\t\t{\n\t\t\t\tv.pb(a[j]); v.pb(b[j]);\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(),v.end());\n\t\tstring cur;\n\t\tfor(int j=0;j<v.size();j++) cur+=s[v[j]];\n\t\tif(cur>best) best=cur;\n\t}\n\treturn best;\n}\n\nvoid test(string s)\n{\n\tstring na = naive(s);\n\tstring so = solve(s);\n\tif(na!=so)\n\t{\n\t\tcerr<<\"FAIL ON STRING \"<<s<<'\\n';\n\t\tcerr<<\"NAIVE : \"<<na<<'\\n';\n\t\tcerr<<\"MY SOL : \"<<so<<'\\n';\n\t\texit(0);\n\t}\n}\n\nstring gen()\n{\n\tint n = rand()%5+1;\n\tvector<char> v;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tv.pb('a'); v.pb('b');\n\t}\n\trandom_shuffle(v.begin(),v.end());\n\tstring s=\"\";\n\tfor(char c:v) s+=c;\n\treturn s;\n}\n\nint main()\n{\n\tios_base::sync_with_stdio(0); cin.tie(0);\n\tsrand(1729);\n\t/*\n\tfor(int cc=1;;cc++)\n\t{\n\t\tstring s = gen();\n\t\ttest(s);\n\t\tcerr<<\"Case #\"<<cc<<\" complete\\n\";\n\t}\n\t*/\n\trun();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t\tcontinue;\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=cur+1;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<math.h>\n#include<vector>\n#include<queue>\n#include<map>\n#include<stack>\n#include<fstream>\n#include<stdlib.h>\n#include<set>\n#include<climits>\n#include<cmath>  \n#include<memory.h> \n#include<sstream>\n#include<time.h>\n#include<iomanip>\nusing namespace std;\nconst unsigned long long BIGEST=1000000000000000000+1000000000000000000;\nconst long long BIGER=1000000000000000000;\nconst int BIG=1000000000;\nconst int MOD=1000000007;\nconst long long LMOD=998244353;\n//const long long LMOD=1000000007;\n#define Fi first\n#define Se second\n#define P2 pair\n#define Pii pair<int,int>\n#define Cb make_pair\n#define ll long long\n#define Ull unsigned long long\n#define Sf scanf\n#define Pf printf\n#define Pb push_back\n#define Psh push\n#define Stc stack\n#define Vct vector\n#define Ret return\n#define Sz size\n#define Ins insert\n#define Que queue\n#define Emp empty\n#define Fro front\n#define Rv reverse\n#define Er eras\nP2<string,Vct<int> > f[6005];\nint id[6005];\nstring st;\nint pos[2][6005];\nVct<int>t;\nint cmp(int a,int b)\n{\n\tt.clear();\n\tt=f[b].Se;\n\tt.Pb(a);\n\tt.Pb(id[a]-1);\n\tsort(t.begin(),t.end());\n\tstring st2=\"\";\n\t//cout<<\"!\";\n\tfor(int i=0;i<t.size();i++)\n\t{\n\t\tst2+=st[t[i]];\n\t\t//cout<<t[i]<<\" \";\n\t}\n\t//cout<<st2<<\" \"<<a<<\"-\"<<b<<\" \"<<(bool)(st2>f[a].Fi)<<endl;\n\tif(f[a].Fi<st2)\n\t{\n\t\tf[a].Se=t;\n\t\tf[a].Fi=st2;\n\t}\n\treturn 0;\n}\nint n;\nint main()\n{\n\tcin>>n>>st;\n\t//int n=st.Sz();\n\tfor(int i=0;i<2*n;i++)\n\t{\n\t\tf[i].Fi=\"0\";\n\t\tif(st[i]=='a')pos[0][++pos[0][0]]=i;\n\t\telse pos[1][++pos[1][0]]=i;\n\t}\n\t/*\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tcout<<pos[0][i]<<\" \"<<pos[1][i]<<endl;\n\t}\n\t*/\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(pos[0][i]<pos[1][i])id[pos[0][i]]=pos[1][i]+1;\n\t\telse id[pos[1][i]]=pos[0][i]+1;\n\t}\n\tstring mx;\n\tfor(int i=2*n-1;i>=0;i--)\n\t{\n\t\t//cout<<i<<\" \"<<id[i]<<endl;\n\t\tif(!id[i])continue;\n\t\tf[i].Fi=\"\";\n\t\tf[i].Fi+=st[i];\n\t\tf[i].Fi+=st[id[i]-1];\n\t\tf[i].Se.Pb(i);\n\t\tf[i].Se.Pb(id[i]-1);\n\t\t//cout<<\"!\"<<i<<\" \"<<id[i]-1<<\" \"<<f[i].Fi<<\"!\"<<endl;\n\t\tfor(int j=i+1;j<st.Sz();j++)\n\t\t{\n\t\t\t//cout<<\"!\"<<j<<endl;\n\t\t\t//cout<<i/*<<\" \"<<f[i].Fi*/<<\":\"<<j<<\" \";\n\t\t\tcmp(i,j);\n\t\t\t//cout<<endl;\n\t\t}\n\t\t//cout<<\">\"<<i<<\" \"<<f[i].Fi<<endl;\n\t\tmx=max(mx,f[i].Fi);\n\t}\n\tcout<<mx;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,a,b) for (int i = (a); i <= (b); ++ i)\n#define rrp(i,a,b) for (int i = (a); i >= (b); -- i)\n#define gc() getchar()\n#define fir first\n#define sec second\ntypedef pair<int,int> pii;\ntypedef double db;\ntypedef long long ll;\ntemplate <typename tp>\ninline void read(tp& x) {\n  x = 0; char tmp; bool key = 0;\n  for (tmp = gc(); !isdigit(tmp); tmp = gc())\n    key = (tmp == '-');\n  for (; isdigit(tmp); tmp = gc()) \n    x = (x << 3) + (x << 1) + (tmp ^ '0');\n  if (key) x = -x;\n}\ntemplate <typename tp>\ninline void ckmn(tp& x,tp y) {\n  x = x < y ? x : y;\n}\ntemplate <typename tp>\ninline void ckmx(tp& x,tp y) {\n  x = x < y ? y : x;\n}\n\nconst int N = 3010;\nint n;\nchar str[N << 1];\nstruct data {\n  int lp,rp,tp;\n  bool operator < (const data& a) const {\n    return lp < a.lp;\n  }\n} dat[N];\nstring dp[N];\nint cnt, vis[N];\nstring doit(int l,int r) {\n  string ret = \"\";\n  if (dat[l].tp == 0) {\n    int cur = 0;\n    rep (i, l, r) {\n      if (dat[i].lp > cur) {\n\tcur = dat[i].rp;\n\tret += \"ab\";\n      }\n    }\n  } else {\n    rep (i, l, r) {\n      rep (j, i, r) vis[dat[j].lp] = vis[dat[j].rp] = 1;\n      string tmp = \"\";\n      rep (j, 1, 2*n) if (vis[j]) tmp += str[j];\n      ret = max(ret, tmp);\n      rep (j, i, r) vis[dat[j].lp] = vis[dat[j].rp] = 0;      \n    }\n  }\n  return ret;\n}\nint main() {\n  read(n);\n  scanf(\"%s\", str + 1);\n  for (int i = 1, j = 1; i <= 2 * n; ++ i)\n    if (str[i] == 'a') dat[j++].lp = i;\n  for (int i = 1, j = 1; i <= 2 * n; ++ i)\n    if (str[i] == 'b') dat[j++].rp = i;\n  rep (i, 1, n) if (dat[i].lp > dat[i].rp) {\n    dat[i].tp = 1;\n    swap(dat[i].lp, dat[i].rp);\n  }\n  sort(dat + 1, dat + n + 1);\n  dp[0] = \"\";\n  for (int i = 1, j = 1; i <= n; ++ i) {\n    j = i;\n    while (j < n && dat[j+1].lp < dat[j].rp) ++ j;\n    string tmp = doit(i, j);\n    ++ cnt;\n    rep (k, 0, cnt-1) dp[cnt] = max(dp[k] + tmp, dp[cnt]);\n    i = j;\n  }\n  string ans = \"\";\n  rep (i, 1, cnt) ans = max(ans, dp[i]);\n  cout << ans << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#ifndef LOCAL\n#pragma GCC optimize (\"O3\")\n#endif\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define sim template < class c\n#define ris return * this\n#define dor > debug & operator <<\n#define eni(x) sim > typename \\\nenable_if<sizeof dud<c>(0) x 1, debug&>::type operator<<(c i) {\nsim > struct rge { c b, e; };\nsim > rge<c> range(c i, c j) { return {i, j}; }\nsim > auto dud(c* x) -> decltype(cerr << *x, 0);\nsim > char dud(...);\nstruct debug {\n#ifdef LOCAL\n~debug() { cerr << endl; }\neni(!=) cerr << boolalpha << i; ris; }\neni(==) ris << range(begin(i), end(i)); }\nsim, class b dor(pair < b, c > d) {\n  ris << \"(\" << d.first << \", \" << d.second << \")\";\n}\nsim dor(rge<c> d) {\n  *this << \"[\";\n  for (c it = d.b; it != d.e; ++it)\n    *this << \", \" + 2 * (it == d.b) << *it;\n  ris << \"]\";\n}\n#else\nsim dor(const c&) { ris; }\n#endif\n};\n#define imie(x...) \" [\" #x \": \" << (x) << \"] \"\n\nusing ld = long double;\nusing ll = long long;\n\nconstexpr int mod = 1000 * 1000 * 1000 + 7;\nconstexpr int odw2 = (mod + 1) / 2;\n\nvoid OdejmijOd(int& a, int b) { a -= b; if (a < 0) a += mod; }\nint Odejmij(int a, int b) { OdejmijOd(a, b); return a; }\nvoid DodajDo(int& a, int b) { a += b; if (a >= mod) a -= mod; }\nint Dodaj(int a, int b) { DodajDo(a, b); return a; }\nint Mnoz(int a, int b) { return (ll) a * b % mod; }\nvoid MnozDo(int& a, int b) { a = Mnoz(a, b); }\nint Pot(int a, int b) { int res = 1; while (b) { if (b % 2 == 1) MnozDo(res, a); a = Mnoz(a, a); b /= 2; } return res; }\nint Odw(int a) { return Pot(a, mod - 2); }\nvoid PodzielDo(int& a, int b) { MnozDo(a, Odw(b)); }\nint Podziel(int a, int b) { return Mnoz(a, Odw(b)); }\nint Moduluj(ll x) { x %= mod; if (x < 0) x += mod; return x; }\n\ntemplate <typename T> T Maxi(T& a, T b) { return a = max(a, b); }\ntemplate <typename T> T Mini(T& a, T b) { return a = min(a, b); }\n\nint main() {\n  ios_base::sync_with_stdio(0);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> parts;\n  int bal = 0;\n  string last_part;\n  for (char c : s) {\n    if (c == 'a') bal++;\n    else if (c == 'b') bal--;\n    else assert(false);\n    last_part.push_back(c);\n    if (bal == 0) {\n      parts.push_back(last_part);\n      last_part.clear();\n    }\n  }\n  assert(last_part.empty());\n  debug() << imie(parts);\n\n  for (string& p : parts) {\n    assert((int) p.size() % 2 == 0);\n    string res;\n    if (p[0] == 'a') {\n      for (int i = 0; i < (int) p.size(); i++) {\n        if (p[i] == 'a') {\n          res.push_back('a');\n          res.push_back('b');\n          while (p[i] != 'b') i++;\n        }\n      }\n    } else {\n      for (int i = 0; i < (int) p.size() / 2; i++) {\n        string st;\n        int zost[2] = {i, i};\n        for (char c : p) {\n          int idx = 0;\n          if (c == 'b') idx = 1;\n          if (zost[idx] > 0) {\n            zost[idx]--;\n          } else {\n            st.push_back(c);\n          }\n        }\n        Maxi(res, st);\n      }\n    }\n    swap(res, p);\n  }\n  debug() << imie(parts);\n  string wyn;\n  for (int i = 0; i < (int) parts.size(); i++) {\n    string resz;\n    for (int j = i + 1; j < (int) parts.size(); j++) {\n      resz += parts[j];\n    }\n    if (parts[i] >= resz) {\n      wyn += parts[i];\n    }\n  }\n  cout << wyn << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//              +-- -- --++-- +-In the name of ALLAH-+ --++-- -- --+              \\\\\n\n#include <bits/stdc++.h>\n\n#define F first\n#define S second\n#define _sz(x) (int)x.size()\n\nusing namespace std ;\nusing ll = long long ;\nusing ld = long double ;\nusing pii = pair <int , int> ;\n\nint const N = 6000 + 20 ;\nint n ;\nstring s ;\n\nint match[N] ;\nstring res[N] , mx[N] ;\n\nint main(){\n\tios::sync_with_stdio(false) , cin.tie(0) , cout.tie(0) ;\n\n\tcin >> n ;\n\tcin >> s ;\n\n\tn *= 2 ;\n\tqueue <int> que ;\n\tfor (int i = 0 ; i < n ; i ++) {\n\t\tif (!que.size() || s[que.front()] == s[i]) que.push(i) ;\n\t\telse match[i] = que.front() , match[que.front()] = i , que.pop() ;\n\t}\n\n\tfor (int i = n - 1 ; i >= 0 ; i --) {\n\t\tif (match[i] > i) {\n\t\t\tif (s[i] == 'a') res[i] = \"ab\" + mx[match[i] + 1] ;\n\t\t\telse {\n\t\t\t\tstring tmp = \"\" ;\n\t\t\t\tint l = i , r = match[i] ;\n\n\t\t\t\tfor (int j = l ; j <= r ; j ++) {\n\t\t\t\t\tif (s[j] == 'b') tmp += \"b\" , r = match[j] ;\n\t\t\t\t\telse if (match[j] >= l) tmp += \"a\" ;\n\t\t\t\t}\n\n\t\t\t\ttmp += mx[r + 1] ;\n\n\t\t\t\tres[i] = tmp ;\n\t\t\t}\n\t\t}\n\t\n\t\tmx[i] = max(mx[i + 1] , res[i]) ;\n\t}\n\n\tcout << mx[0] << '\\n' ;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 3005;\n\nint n;\nint p[2][N], sz[2];\nint nxt[N * 2];\nbool vis[N * 2];\nstring s;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> n >> s;\n\tfor (int i = 0; i < n * 2; ++i) {\n\t\tint x = s[i] - 'a'; p[x][sz[x]++] = i;\n\t}\n\tfor (int i = 0; i < n; ++i) {\n\t\tnxt[p[0][i]] = p[1][i], nxt[p[1][i]] = p[0][i];\n\t}\n\tstring res;\n\tfor (int i = 0; i < n * 2; ++i) {\n\t\tstring tmp;\n\t\tint cur = i;\n\t\tfor (int j = i; j < n * 2; ++j) {\n\t\t\tif (j < nxt[j] && s[j] == 'b') vis[j] = vis[nxt[j]] = 1, cur = j + 1;\n\t\t}\n\t\tfor (int j = cur; j < n * 2; ++j) {\n\t\t\tif (j < nxt[j] && s[j] == 'a') vis[j] = vis[nxt[j]] = 1, j = nxt[j];\n\t\t}\n\t\tfor (int j = i; j < n * 2; ++j) {\n\t\t\tif (vis[j]) tmp.push_back(s[j]), vis[j] = 0;\n\t\t}\n\t\tres = max(res, tmp);\n\t}\n\tcout << res;\n}"
  },
  {
    "language": "C++",
    "code": "// i really hope this weird dp thing works\n\n#include <stdio.h>\n#include <string>\n#include <string.h>\n\nconst int SZ=3005;\n\nint t1,t2;\n\nint n;\nstd::string dp[SZ*2];\n\nchar s[SZ*2];\nint pos[SZ*2];\nint pa[SZ];\nint pb[SZ];\n\nint wants=0;\nbool want[SZ*2];\n\nint main()\n{\n    #ifdef NOT_DMOJ\n    freopen(\"data.txt\",\"r\",stdin);\n    #endif // NOT_DMOJ\n    scanf(\"%d %s\",&n,s);\n    t1=t2=0;\n    for (int i=0; i<n*2; i++) {\n        if (s[i]=='a') {\n            pos[i]=t1;\n            pa[t1]=i;\n            t1++;\n        }\n        else {\n            pos[i]=t2;\n            pb[t2]=i;\n            t2++;\n        }\n        //printf(\"what %d %d %c\\n\",i,pos[i],s[i]);\n    }\n    dp[2*n]=\"\";\n    for (int i=n*2-1; i>=0; i--) {\n        //printf(\"what %d %d %d\\n\",i,pa[pos[i]],pb[pos[i]]);\n        if (pa[pos[i]]<i || pb[pos[i]]<i) {\n            dp[i]=dp[i+1];\n        }\n        // get the best string starting here\n        else if (s[i]=='a') {\n            // don't include anything in this ab interval\n            dp[i]=\"ab\"+dp[pb[pos[i]]];\n        }\n        else {\n            // include as many things as possible?\n            // because everything is in the form ba\n            wants=0;\n            memset(want,0,sizeof want);\n            t1=i;\n            for (int j=i; j<=t1; j++) {\n                if (s[j]=='a') continue;\n                want[j]=1;\n                t1=pa[pos[j]];\n                want[t1]=1;\n                wants+=2;\n            }\n            // get the string\n            std::string temp(wants,'a');\n            //printf(\"B %d %d %s\\n\",i,t1,temp.c_str());\n            t2=0;\n            for (int j=i; j<=t1; j++) {\n                if (want[j]) temp[t2++]=s[j];\n            }\n            dp[i]=temp+dp[t1];\n        }\n        if (dp[i]<dp[i+1]) {\n            dp[i]=dp[i+1];\n        }\n        //printf(\"%d %s\\n\",i,dp[i].c_str());\n    }\n    //printf(\"\\n\\n\\n\");\n    printf(\"%s\\n\",dp[0].c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cctype>\n \n#include <algorithm>\n#include <tuple>\n#include <random>\n#include <bitset>\n#include <queue>\n#include <functional>\n#include <set>\n#include <map>\n#include <vector>\n#include <chrono>\n#include <iostream>\n#include <limits>\n#include <numeric>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> stk;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      string res = naive(string(s.begin() + i, s.begin() + last));\n      while (!stk.empty()) {\n        if (stk.back().size() > res.size() && res > stk.back())\n          stk.pop_back();\n        else if (res.substr(0, stk.back().size()) > stk.back())\n          stk.pop_back();\n        else\n          break;\n      }\n      stk.push_back(res);\n      i = r - 1;\n    }\n  }\n  for (const auto& str : stk)\n    ans += str;\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n    for(LL i=1;i<=5;++i) a[i]=1;\n    return 0;\n    n=Read();\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n//    for(LL i=1;i<=2*n;++i) a[i]=(s[i]-'a');\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <map>\n#include <set>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <cmath>\nusing namespace std;\n\nint main() {\n        int n;\n        scanf(\"%d\", &n);\n        string s;\n        cin >> s;\n        int acc = 0;\n        vector<string> hoge;\n        string cur = \"\";\n        for (int i = 0; i < 2 * n; i ++) {\n                if (s[i] == 'a') {\n                        acc ++;\n                } else {\n                        acc --;\n                }\n                cur += s[i];\n                if (acc == 0) {\n                        hoge.push_back(cur);\n                        cur = \"\";\n                }\n        }\n        /*\n        for (auto it : hoge) {\n                cerr << it << endl;\n        }\n        */\n        vector<string> best;\n        for (int f = 0; f < (int) hoge.size(); f ++) {\n                string t = hoge[f];\n                int N = (int) t.size();\n                int ac = 0, bc = 0;\n                vector<int> p(N);\n                for (int i = 0; i < N; i ++) {\n                        if (t[i] == 'a') {\n                                p[i] = ac ++;\n                        } else {\n                                p[i] = bc ++;\n                        }\n                }\n                vector<int> pos(N);\n                for (int i = 0; i < N; i ++) {\n                        for (int j = i + 1; j < N; j ++) {\n                                if (p[i] == p[j] && t[i] != t[j]) {\n                                        pos[i] = j;\n                                        pos[j] = i;\n                                }\n                        }\n                }\n                string ma = \"\";\n                if (t[0] == 'b') { \n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        continue;\n                                }\n                                string now = \"\";\n                                for (int j = i; j < N; j ++) {\n                                        if (pos[j] >= i) {\n                                                now += t[j];\n                                        }\n                                }\n                                ma = max(ma, now);\n                        }\n                } else {\n                        char last = 'b';\n                        for (int i = 0; i < N; i ++) {\n                                if (s[i] != last) {\n                                        ma += s[i];\n                                }\n                                last = s[i];\n                        }\n                }\n                best.push_back(ma);\n        }\n        vector<vector<string>> dp(best.size(), vector<string> (2 * n + 1, \"\"));\n        dp[0][0] = \"\";\n        dp[0][(int) best[0].size()] = best[0];\n        int sum = (int) best[0].size();\n        for (int i = 1; i < (int) best.size(); i ++) {\n                int len = (int) best[i].size();\n                sum += len;\n                for (int j = 0; j <= sum - len; j ++) {\n                        if (j != 0 && dp[i - 1][j] == \"\") continue;\n                        dp[i][j + len] = max(dp[i][j + len], dp[i - 1][j] + best[i]);\n                        dp[i][j] = max(dp[i][j], dp[i - 1][j]);\n                }\n                /*\n                cerr << i << endl;\n                for (int j = 0; j < 2 * n; j ++) {\n                        cerr << dp[i][j] << '.';\n                }\n                cerr << endl;\n                */\n        }\n        string ans = \"\";\n        for (int j = 0; j <= 2 * n; j ++) {\n                ans = max(ans, dp[(int) best.size() - 1][j]);\n        }\n        cout << ans << endl;\n        return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\nchar str[6010];\nint aloc[3010], bloc[3010];\nint loc[6010];\nvector<int> ran;\n\nvector<string> vs;\nvoid print(int s, int e) {\n    if (str[s]=='a') {\n        int i;\n        for (i=s;i<e;i++) {\n            if (str[i]=='a') {\n                printf(\"ab\");\n                i = bloc[loc[i]];\n            }\n        }\n        return;\n    }\n    int i, j;\n    for (i=loc[s];i<loc[e];i++) {\n        string tmp;\n        for (j=s;j<e;j++) {\n            if (loc[j]>=i) tmp.push_back(str[j]);\n        }\n        vs.push_back(tmp);\n    }\n    sort(vs.begin(),vs.end());\n    for (char &ch : vs.back()) printf(\"%c\",ch);\n    vs.clear();\n}\n\ntypedef pair<string,int> psi;\n\nvector<psi> vec;\nvoid add(int s, int e) {\n    int i, j;\n    for (i=loc[s];i<loc[e];i++) {\n        string tmp;\n        for (j=s;j<e;j++) {\n            if (loc[j]>=i) tmp.push_back(str[j]);\n        }\n        vs.push_back(tmp);\n    }\n    sort(vs.begin(),vs.end());\n    vec.push_back(psi(vs.back(),-s));\n    vs.clear();\n}\n\nint main() {\n    int i, j;\n\n    scanf(\"%d\",&n);\n    scanf(\"%s\",str);\n    int a = 0, b = 0;\n    for (i=0;i<2*n;i++) {\n        if (str[i]=='a') {loc[i] = a; aloc[a] = i; a++;}\n        else {loc[i] = b; bloc[b] = i; b++;}\n    }\n    loc[2*n] = n;\n    int ps = 0;\n    ran.push_back(0);\n    for (i=0;i<2*n;i++) {\n        ps += ((str[i]=='a')?1:-1);\n        if (!ps) {\n            ran.push_back(i+1);\n        }\n    }\n    int p = -1;\n    for (i=(int)ran.size()-2;i>=0;i--) {\n        if (str[ran[i]]=='b') {\n            p = i;\n            break;\n        }\n    }\n    for (i=0;i<=p;i++) {\n        if (str[ran[i]]=='a') continue;\n        add(ran[i],ran[i+1]);\n    }\n    sort(vec.begin(),vec.end());\n    reverse(vec.begin(),vec.end());\n    int cur = -1;\n    for (psi &tmp : vec) {\n        if (cur>-tmp.second) continue;\n        for (char &ch : tmp.first) printf(\"%c\",ch);\n        cur = -tmp.second;\n    }\n    for (i=p+1;i+1<ran.size();i++) {\n        print(ran[i],ran[i+1]);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define LL long long\n#define fgx cerr<<\"--------------\"<<endl;\n#define dgx cerr<<\"==============\"<<endl;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nconst int MAXN = 100010;\nconst int INF = 2147483600;\n\nint N; char s[MAXN+1]; \nint vis[MAXN+1]; int pos[MAXN+1]; int p[MAXN+1];\n\ninline void prt(vector<int> &x){\n\tcout<<\"Prt:\";\n\tfor(int i=x.size()-1;i>=0;i--){\n\t\tcout<<(char)('a'+x[i]);\n\t} cout<<endl;\n}\ninline int Link(int x){ x=p[x]; return pos[(x>N/2?x-N/2:x+N/2)]; }\ninline int Cmp(vector<int> &A1,vector<int> &A2){\n\tint flag=-1;\n\tint sz1=A1.size(),sz2=A2.size();\n\tfor(int l=1;l<=min(sz1,sz2);l++){\n\t\tif(A1[sz1-l]>A2[sz2-l]) {flag=0; break;}\n\t\tif(A1[sz1-l]<A2[sz2-l]) {flag=1; break;}\n\t} return flag;\n}vector<int> Ans,Ans2;\ninline void Update(int &l1,int &r1,vector<int>& A1,int l2,int r2,vector<int>& A2,bool opr){\n\tif(!A1.size()){ A1.clear(); for(int l=0;l<(int)A2.size();l++) A1.push_back(A2[l]); l1=l2; r1=r2; return ; } \n\tint flag=Cmp(A1,A2);\n\tif(flag==-1){\n\t\tif(opr) flag=1;\n\t\telse{\n\t\t\tvector<int> n; n.clear();\n\t\t\tif(A2.size()<A1.size()) fgx;\n\t\t\tfor(int i=0;i<A2.size()-A1.size();i++){\n\t\t\t\tn.push_back(A2[i]);\n\t\t\t} flag=Cmp(Ans,n);\n\t\t\tif(flag) flag=1;\n\t\t}\n\t} \n\tif(flag==1){\n\t\tl1=l2; r1=r2;\n\t\tif(!opr) A1.clear();\n\t\tfor(int l=0;l<(int)A2.size();l++)\t\n\t\t\tA1.push_back(A2[l]);\n\t} return ;\n} \n\nint main(){\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tN=read()*2; scanf(\"%s\",s+1); int nowa=0,nowb=0;\n\tfor(int i=1;i<=N;i++){\n\t\tif(s[i]=='a') p[i]=nowa+1,++nowa;\n\t\telse p[i]=nowb+N/2+1,++nowb;\n\t\tpos[p[i]]=i;\n\t} int l1=INF,r1=INF,l2=0,r2=0; int tim=0,lastk=0;\n\tfor(int i=N;i>=1;i--){\n\t\tint k=Link(i);\n\t\tif(k<i) continue;\n\t\tvector<int> n;n.clear();\n\t\tif(s[i]=='b'){  ++tim;\n\t\t\tint j=i; n.push_back((int)s[i]-'a'); vis[k]=tim;\n\t\t\twhile(j<k){\n\t\t\t\t++j; if(vis[j]==tim) n.push_back(0); int to=Link(j);\n\t\t\t\tif(s[j]=='b'&&to>j) k=to,vis[to]=tim,n.push_back(1);\n\t\t\t}\n\t\t}\n\t\tif(k!=lastk&&lastk){\n\t\t\tif(r2>l1) fgx;\n\t\t\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\t\t\tAns2.clear(); l2=0,r2=0;\n\t\t} if(n.size()){\n\t\t\treverse(n.begin(),n.end());\n\t\t\tUpdate(l2,r2,Ans2,i,k,n,0);\n\t\t} else{\n\t\t\tn.push_back(1); n.push_back(0);\n\t\t\tif(k<l1) Update(l1,r1,Ans,i,k,n,1);\n\t\t}lastk=k;\n\t} \n\tif(r2<l1&&Ans2.size()) Update(l1,r1,Ans,l2,r2,Ans2,1);\n\tfor(int i=Ans.size()-1;i>=0;i--) printf(\"%c\",(char)(Ans[i]+'a'));\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "// Hacheylight\n#include <map>\n#include <set>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <vector>\n#include <bitset>\n#include <cstdio>\n#include <cctype>\n#include <string>\n#include <numeric>\n#include <cstring>\n#include <cassert>\n#include <climits>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std ;\n//#define int long long\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n#define per(i, a, b) for (int i = (a); i >= (b); i--)\n#define loop(it, v) for (auto it = v.begin(); it != v.end(); it++)\n#define cont(i, x) for (int i = head[x]; i; i = e[i].nxt)\n#define clr(a) memset(a, 0, sizeof(a))\n#define ass(a, sum) memset(a, sum, sizeof(a))\n#define lowbit(x) (x & -x)\n#define all(x) x.begin(), x.end()\n#define SC(t, x) static_cast <t> (x)\n#define ub upper_bound\n#define lb lower_bound\n#define pqueue priority_queue\n#define mp make_pair\n#define pb push_back\n#define pof pop_front\n#define pob pop_back\n#define fi first\n#define se second\n#define y1 y1_\n#define Pi acos(-1.0)\n#define iv inline void\n#define enter cout << endl\n#define siz(x) ((int)x.size())\n#define file(x) freopen(x\".in\", \"r\", stdin),freopen(x\".out\", \"w\", stdout)\ntypedef double db ;\ntypedef long long ll ;\ntypedef unsigned long long ull ;\ntypedef pair <int, int> pii ;\ntypedef vector <int> vi ;\ntypedef vector <pii> vii ;\ntypedef queue <int> qi ;\ntypedef queue <pii> qii ;\ntypedef set <int> si ;\ntypedef map <int, int> mii ;\ntypedef map <string, int> msi ;\nconst int N = 6010 ;\nconst int INF = 0x3f3f3f3f ;\nconst int iinf = 1 << 30 ;\nconst ll linf = 2e18 ;\nconst int MOD = 1000000007 ;\nconst double eps = 1e-7 ;\nvoid douout(double x){ printf(\"%lf\\n\", x + 0.0000000001) ; }\ntemplate <class T> void print(T a) { cout << a << endl ; exit(0) ; }\ntemplate <class T> void chmin(T &a, T b) { if (a > b) a = b ; }\ntemplate <class T> void chmax(T &a, T b) { if (a < b) a = b ; }\ntemplate <class T> void add(T &a, T b) { a = (1ll * a + b) % MOD ; }\ntemplate <class T> void mul(T &a, T b) { a = (ll) a * b % MOD ; }\ntemplate <class T> T read() {\n    int f = 1 ; T x = 0 ;\n    char ch = getchar() ;\n    while (!isdigit(ch)) { if (ch == '-') f = -1 ; ch = getchar() ; }\n    while (isdigit(ch)) { x = x * 10 + ch -'0' ; ch = getchar() ; }\n    return x * f ;\n}\n\nstring dp[N] ;\nchar s[N] ;\nint pa[N], pb[N] ;\nint pos[N] ;\nint n, sza, szb ;\n\nsigned main() {\n\tscanf(\"%d\", &n) ;\n\tcin >> s ;\n\trep(i, 0, n - 1)\n\tif (s[i] == 'a') {\n\t\tpa[++sza] = i ;\n\t} else {\n\t\tpb[++szb] = i ;\n\t}\n\trep(i, 0, n - 1) {\n\t\tpos[pa[i]] = pb[i] ;\n\t\tpos[pb[i]] = pa[i] ;\n\t}\n\tdp[2 * n] = \"\" ;\n\tper(i, 2 * n - 1, 0) {\n\t\tdp[i] = dp[i + 1] ;\n\t\tif (pos[i] <= i) continue ;\n\t\tif (i < pos[i]) {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\tstring to = \"ab\" ;\n\t\t\t\tto += dp[pos[i] + 1] ;\n\t\t\t\tchmax(dp[i], to) ;\n\t\t\t} else {\n\t\t\t\tint cnt = 0 ;\n\t\t\t\tstring now = \"\" ;\n\t\t\t\trep(j, i, 2 * n - 1) {\n\t\t\t\t\tif (pos[j] < i) continue ;\n\t\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\t\tif (pos[j] < j) {\n\t\t\t\t\t\t\tnow += \"a\" ;\n\t\t\t\t\t\t\tcnt-- ;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (pos[j] > j) {\n\t\t\t\t\t\t\tnow += \"b\" ;\n\t\t\t\t\t\t\tcnt++ ;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!cnt) {\n\t\t\t\t\t\tnow += dp[j + 1] ;\n\t\t\t\t\t\tchmax(dp[i], now) ;\n\t\t\t\t\t\tbreak ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << dp[0] << endl ;\n\treturn 0 ;\n}\n\n/*\n写代码时请注意：\n\t1.ll？数组大小，边界？数据范围？\n\t2.精度？\n\t3.特判？\n\t4.至少做一些\n思考提醒：\n\t1.最大值最小->二分？\n\t2.可以贪心么？不行dp可以么\n\t3.可以优化么\n\t4.维护区间用什么数据结构？\n\t5.统计方案是用dp？模了么？\n\t6.逆向思维？\n*/\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nchar s[6010];\nbasic_string <char> ans[6010];\nint q[6010], head, tail, n;\nbasic_string <int> a, b;\nint pos[6010], choose[6010];\nint main() {\n    scanf(\"%d%s\", &n, s + 1);\n    n <<= 1;\n    for (int i = 1; i <= n; i++) (s[i] == 'a' ? a : b).push_back(i);\n    for (int i = 0; i < n / 2; i++) pos[a[i]] = b[i], pos[b[i]] = a[i];\n    int cnt = 0, nxt = n + 1;\n    for (int i = n; i > 0; i--) {\n        cnt += s[i] == 'a' ? 1 : -1;\n        if (cnt) continue;\n        ans[i] = ans[nxt];\n        memset(choose, 0, sizeof choose);\n        head = 1, tail = 0;\n        for (int j = i; j < nxt; j++) {\n            if (s[j] == 'a') {\n                if (choose[j]) {\n                    basic_string <char> now = \"\";\n                    for (int k = i; k < nxt; k++) {\n                        if(s[k] == 'a' && (choose[k] || k > pos[q[tail]])) now += \"a\";\n                        if(s[k] == 'b' && (choose[k] || k > j)) now += \"b\";\n                    }\n                    // cerr << now << endl;\n                    ans[i] = max(ans[i], now + ans[nxt]);\n                    head++;\n                    choose[j] = choose[pos[j]] = 0;\n                }\n                continue;\n            }\n            if (pos[j] > j) q[++tail] = j, choose[j] = choose[pos[j]] = 1;\n        }\n        if (tail == 0) {\n            memset(choose, 0, sizeof choose);\n            for (int j = i; j < nxt; j++) {\n                if (s[j] == 'a') {\n                    choose[j] = choose[pos[j]] = 1;\n                    basic_string <char> now = \"\";\n                    for (int k = i; k <= pos[j]; k++) if(choose[k]) now += s[k];\n                    ans[i] = max(ans[i], now + ans[j]);\n                    j = pos[j];\n                }\n            }\n        }\n        nxt = i;\n    }\n    return cout << ans[1] << endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <memory.h>\n#include <math.h>\n#include <assert.h>\n#include <queue>\n#include <map>\n#include <set>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <functional>\n#include <unordered_map>\n\nusing namespace std;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define Fi first\n#define Se second\n#define pb(x) push_back(x)\n#define szz(x) (int)x.size()\n#define rep(i, n) for(int i=0;i<n;i++)\n#define all(x) x.begin(), x.end()\ntypedef tuple<int, int, int> t3;\n\nchar S[6060];\nint pl[3030], pr[3030];\nint mat[6060];\nint N;\n\nstring Do2(int l, int r) {\n\tstring res = \"\";\n\tfor(int i=l;i<=r;) {\n\t\tif(S[i] == 'a') i = mat[i] + 1, res.pb('a'), res.pb('b');\n\t\telse ++i;\n\t}\n\treturn res;\n}\n\nstring Do(string X) {\n\tint max_val = 0, n = szz(X), now = 0;\n\tvector <int> pv;\n\trep(i, n) {\n\t\tif(X[i] == 'b') ++now;\n\t\telse --now;\n\t\tif(max_val < now) {\n\t\t\tmax_val = now;\n\t\t\tpv.clear();\n\t\t\tpv.pb(i);\n\t\t}\n\t\telse if(max_val == now) pv.pb(i);\n\t}\n\tstring res = \"\";\n\tfor(int e : pv) {\n\t\tstring tt = \"\";\n\t\trep(j, max_val) tt.pb('b');\n\t\tfor(int j=e+1;j<n;j++) tt.pb(X[j]);\n\t\tif(res < tt) res = tt;\n\t}\n\treturn res;\n}\n\nvoid solve(){\n\tscanf(\"%d%s\", &N, S + 1);\n\tN *= 2;\n\tint ca = 0, cb = 0;\n\tfor(int i=1;i<=N;i++) {\n\t\tif(S[i] == 'a') pl[++ca] = i;\n\t\telse pr[++cb] = i;\n\t}\n\tfor(int i=1;i<=N/2;i++) mat[pl[i]] = pr[i], mat[pr[i]] = pl[i];\n\tint val[6060] = {};\n\tfor(int i=1;i<=N;i++) val[i] = val[i-1] + (S[i] == 'b' ? 1 : -1);\n\tint md = 0, p = -1;\n\tstring res = \"\";\n\tvector <string> V;\n\tstring last = \"\";\n\tfor(int i=1;i<=N;i++) {\n\t\tif(md == 0) md = val[i], p = i;\n\t\tif(i == N || (val[i] == 0 && !(md == -1 && val[i+1] == -1))) {\n\t\t\tstring tt = \"\";\n\t\t\tfor(int j=p;j<=i;j++) tt.pb(S[j]);\n\t\t\tif(md == 1) V.pb(Do(tt));\n\t\t\telse {\n\t\t\t\tif(i == N) last = Do2(p, i);\n\t\t\t}\n\t\t\tmd = 0;\n\t\t}\n\t}\n\tint n = szz(V);\n\tfor(int i=0;i<n;) {\n\t\tint mp = i;\n\t\tfor(int j=i+1;j<n;j++) if(V[j] > V[i]) mp = j;\n\t\tres = res + V[mp];\n\t\ti = mp + 1;\n\t}\n\tres = res + last;\n\tprintf(\"%s\\n\", res.c_str());\n}\n\nint main(){\n\tint Tc = 1; //scanf(\"%d\", &Tc);\n\tfor(int tc=1;tc<=Tc;tc++){\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MAXN = 3000;\nchar S[2*MAXN + 5];\nint a[MAXN + 5], b[MAXN + 5], c[2*MAXN + 5];\nint dp[MAXN + 5][MAXN + 5];\nint N, A, B;\nstring fun(int num[]) {\n\tstring ret = \"\";\n\tfor(int i=1;i<=2*N;i++)\n\t\tif( num[c[i]] ) ret.insert(ret.end(), S[i]);\n\treturn ret;\n}\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S+1);\n\tfor(int i=1;i<=2*N;i++) {\n\t\tif( S[i] == 'a' ) a[++A] = i, c[i] = A;\n\t\telse b[++B] = i, c[i] = B;\n\t}\n\tdp[N][N] = 1;\n\tfor(int i=N-1;i>=1;i--) {\n\t\tdp[i][i] = 1;\n\t\tif( a[i] < b[i] ) {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=a[i];j<=b[i];j++)\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\tfor(int j=b[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] > Max )\n\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t}\n\t\telse {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=b[i];j<=a[i];j++) {\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t}\n\t\t\tfor(int j=a[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] > Max )\n\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t}\n\t\tif( fun(dp[i]) < fun(dp[i+1]) )\n\t\t\tmemcpy(dp[i], dp[i+1], sizeof dp[i+1]);\n\t}\n\tcout << fun(dp[1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n;\nconst int N=3010;\nint posa[N],posb[N],id[N<<1],nt[N<<1];\nstring s,f[N];\nint main()\n{\n\tcin>>n>>s;\n\tfor(int i=1,a=0,b=0;i<=n*2;++i)\n\t\tif(s[i]=='a')posa[id[i]=++a]=i;\n\t\telse posb[id[i]=++b]=i;\n\tposa[n+1]=posb[n+1]=2*n+1;id[2*n+1]=n+1;\n\tfor(int i=1,j=0;i<=n+1;++i)\n\t\twhile(j<min(posa[i],posb[i]))nt[++j]=i;\n    for(int i=n;i>=1;--i)\n    {\n    \tif(posa[i]>posb[i])\n    \t{\n    \t\tint j=posb[i];\n    \t\tfor(;posb[id[j]]<posa[id[j]]&&(id[j]<=i||posb[id[j]]<posa[id[j]-1]);++j)\n    \t\t\tif(id[j]>=i)f[i]+=s[j];\n    \t\tf[i]+=f[id[j]];\n\t\t}\n\t\telse f[i]=\"ab\"+f[nt[posb[i]+1]];\n    \tf[i]=max(f[i],f[i+1]);\n\t}\n\tcout<<f[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define title \"title\"\n#define ll long long\n#define ull unsigned ll\n#define fix(x) fixed<<setprecision(x)\n#define pii pair<int,int>\n#define vint vector<int>\n#define pb push_back\nusing namespace std;\nvoid Freopen(){\n\tfreopen(title\".in\",\"r\",stdin);\n\tfreopen(title\".out\",\"w\",stdout);\n}\nint read(){\n\tint g=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||'9'<ch){if(ch=='-')f=-1;ch=getchar();}\n\twhile('0'<=ch&&ch<='9'){g=g*10+ch-'0';ch=getchar();}\n\treturn g*f;\n}\nconst int N=3e3+5;\nstring s,f[N];\nint n,a[N],b[N],id[N<<1],ne[N];\nsigned main(){\n\tn=read();cin>>s;s=' '+s;\n\tfor(int i=1,ta=0,tb=0;i<=n<<1;i++){\n\t\tif(s[i]=='a')ta++,id[i]=ta,a[ta]=i;\n\t\telse tb++,id[i]=tb,b[tb]=i;\n\t}a[n+1]=b[n+1]=(n<<1|1),id[n<<1|1]=n+1;\n\tfor(int i=0,j=0;i<=n+1;i++)while(j<min(a[i],b[i]))ne[++j]=i;\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]>b[i]){\n\t\t\tint j=b[i];\n\t\t\tfor(;b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1]);j++)if(id[j]>=i)f[i]+=s[j];\n\t\t\tf[i]+=f[id[j]];\n\t\t}else f[i]=\"ab\"+f[ne[b[i]+1]];\n\t\tf[i]=max(f[i],f[i+1]);\n\t}return cout<<f[1],signed();\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#define PB push_back\n#define MP make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long LL;\nconst int N=7000 +10;\n\nstring f[N];\nchar s[N];\nint  tk[N], od[N], a[N], b[N],n;\nvoid DP();\n\nint main(){\n\t#ifdef che \n\tfreopen(\"input.txt\",\"rt\",stdin);\n\t#endif\n\tscanf(\"%d%s\", &n, s);\n\tint an=0, bn= 0;\n\tfor (int i=0; i<2*n; ++i)\n\t\tif ( s[i]=='a' ){\n\t\t\tod[i] = an;a[an++] = i;\n\t\t}else{\n\t\t\tod[i] = bn;b[bn++] = i;\n\t\t}\n\t#ifdef che\n\tfor (int i=0; i<2*n; ++i) debug(\"od[%d] = %d\\n\", i, od[i]);\n\tfor (int i=0; i<n; ++i) debug(\"a[%d]= %d\\tb[%d]=%d\\n\", i, a[i], i, b[i]);\n\t#endif\n\tDP();\n\treturn 0;\n}\n\nvoid DP(){\n\tfor  (int i=0; i<2*n; ++i )  f[i]=\"\";\n\tfor (int i=2*n-1; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='b'){\n\t\t\tstring t=\"\";\n\t\t\tfor (int j=0; j<=n; ++j) tk[j] = false;\n\t\t\tint ri=  a[od[i]];\n\t\t\tfor (int j=i;j<=ri; ++j){\n\t\t\t\tif ( s[j]=='b') tk[ od[j]]= true, ri= a[od[j]];\n\t\t\t\tif ( tk[od[j]]) t+=s[j];\n\t\t\t}\n\t\t\tif ( t.size()) f[i] = max(f[i], t+f[ri+1]);\n\t\t}else\n\t\t\tif ( a[od[i]] < b[od[i]]) f[i] = max(\"ab\"+f[b[od[i]]+1], f[i]);\n\t}\n\tcout<<f[0]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define cs const\n#define pb push_back\nusing namespace std;\ncs int N = 6e3 + 50;\nint n, A[N], B[N], c[N], tr[N]; \nchar S[N]; string f[N];\nint main(){\n\t#ifdef FSYolanda\n\tfreopen(\"1.in\",\"r\",stdin);\n\t#endif\n\tfreopen(\"1.in\",\"r\",stdin);\n\tscanf(\"%d%s\",&n,S+1);\n\tfor(int i=1,a=0,b=0; i<=n+n; i++)\n\tif(S[i]=='a') A[c[i]=++a]=i;\n\telse B[c[i]=++b]=i;\n\tfor(int i=1; i<=n; i++) tr[min(A[i],B[i])]=i;\n\tfor(int i=n; i>=1; i--){\n\t\tif(A[i]>B[i]){\n\t\t\tint j=B[i];\n\t\t\twhile(A[c[j]]>B[c[j]]){\n\t\t\t\tif(c[j]>i&&B[c[j]]>A[c[j]-1]) break;\n\t\t\t\tif(c[j]>=i) f[i]+=S[j]; ++j;\n\t\t\t} f[i]+=f[c[j]];\n\t\t} else f[i] = \"ab\" + f[tr[B[i]+1]];\n\t\tf[i] = max(f[i], f[i+1]);\n\t} cout << f[1]; return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int N = 1024;\ntypedef vector<int> vec;\ntypedef vec::iterator it;\n\nchar s[N*2];\nint d[N], c[N], *L[N], *R[N];\n\nint Lyndon(int i) {\n\twhile (d[i]) {\n\t\tint j = i, k = i + 1;\n\t\tfor (; d[k] && d[j] >= d[k]; k++)\n\t\t\tif (d[j] > d[k]) j = i;\n\t\t\telse j++;\n\t\tif (!d[k]) return i;\n\t\tk -= j;\n\t\twhile (i <= j) i += k;\n\t}\n\treturn i;\n}\n\nvoid out(int *l, int *r) {\n\tint *t = c;\n\twhile (l < r) {\n\t\tputchar('b');\n\t\tt[*l]++;\n\t\twhile (*t--) putchar('a');\n\t\t*t = 0;\n\t}\n}\n\nint main() {\n\tint T;\n\tscanf(\"%d\",&T);\n\twhile (T--) {\n\t\tscanf(\"%s\",s);\n\t\tint a = 0, b = 0, n = 0;\n\t\tfor (int i = 0; s[i]; i++) {\n\t\t\tif (s[i] == 'b') b++;\n\t\t\telse d[a++] = b;\n\t\t\tif (a < b) n = b;\n\t\t}\n\t\tint l = 0, top = -1;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tif (!(d[i] -= i + 1)) {\n\t\t\t\tint t = Lyndon(l); l = i + 1;\n\t\t\t\twhile (~top && lexicographical_compare(L[top], R[top], d+t, d+l)) top--;\n\t\t\t\tL[++top] = d+t; R[top] = d+l;\n\t\t\t}\n\t\t\telse if (d[i] < 0) l = i + 1;\n\t\tfor (int i = 0; i <= top; i++)\n\t\t\tout(L[i], R[i]);\n\t\tfor (int i = n; i < b; i++)\n\t\t\tif (d[i] >= n) n = i+1, printf(\"ab\");\n\t\tputchar(10);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <map>\n#include <set>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <cmath>\nusing namespace std;\n\nint main() {\n        int n;\n        scanf(\"%d\", &n);\n        string s;\n        cin >> s;\n        int acc = 0;\n        vector<string> hoge;\n        string cur = \"\";\n        for (int i = 0; i < 2 * n; i ++) {\n                if (s[i] == 'a') {\n                        acc ++;\n                } else {\n                        acc --;\n                }\n                cur += s[i];\n                if (acc == 0) {\n                        hoge.push_back(cur);\n                        cur = \"\";\n                }\n        }\n        /*\n        for (auto it : hoge) {\n                cerr << it << endl;\n        }\n        */\n        vector<string> best;\n        for (int f = 0; f < (int) hoge.size(); f ++) {\n                string t = hoge[f];\n                int N = (int) t.size();\n                int ac = 0, bc = 0;\n                vector<int> p(N);\n                for (int i = 0; i < N; i ++) {\n                        if (t[i] == 'a') {\n                                p[i] = ac ++;\n                        } else {\n                                p[i] = bc ++;\n                        }\n                }\n                vector<int> pos(N);\n                for (int i = 0; i < N; i ++) {\n                        for (int j = i + 1; j < N; j ++) {\n                                if (p[i] == p[j] && t[i] != t[j]) {\n                                        pos[i] = j;\n                                        pos[j] = i;\n                                }\n                        }\n                }\n                string ma = \"\";\n                if (t[0] == 'b') { \n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        continue;\n                                }\n                                string now = \"\";\n                                for (int j = i; j < N; j ++) {\n                                        if (pos[j] >= i) {\n                                                now += t[j];\n                                        }\n                                }\n                                ma = max(ma, now);\n                        }\n                } else {\n                        bool last = true;\n                        for (int i = 0; i < N; i ++) {\n                                if (t[i] == 'a') {\n                                        ma += t[i];\n                                        i = pos[i] - 1;\n                                        last = false;\n                                } else if (!last) {\n                                        ma += t[i];\n                                        last = true;\n                                }\n                        }\n                }\n                best.push_back(ma);\n        }\n        vector<vector<string>> dp(best.size(), vector<string> (2 * n + 1, \"\"));\n        dp[0][0] = \"\";\n        dp[0][(int) best[0].size()] = best[0];\n        int sum = (int) best[0].size();\n        for (int i = 1; i < (int) best.size(); i ++) {\n                int len = (int) best[i].size();\n                sum += len;\n                for (int j = 0; j <= sum - len; j ++) {\n                        if (j != 0 && dp[i - 1][j] == \"\") continue;\n                        dp[i][j + len] = max(dp[i][j + len], dp[i - 1][j] + best[i]);\n                        dp[i][j] = max(dp[i][j], dp[i - 1][j]);\n                }\n                /*\n                cerr << i << endl;\n                for (int j = 0; j < 2 * n; j ++) {\n                        cerr << dp[i][j] << '.';\n                }\n                cerr << endl;\n                */\n        }\n        string ans = \"\";\n        for (int j = 0; j <= 2 * n; j ++) {\n                ans = max(ans, dp[(int) best.size() - 1][j]);\n        }\n        cout << ans << endl;\n        return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define N 10000\n#define M 1000005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Max[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Max(int x,int y) {\n\tif(f[x]<N&&f[y]>N) return 0;\n\tif(f[x]>N&&f[y]<N) return 1;\n\tif(f[x]<N) return f[x]>=f[y];\n\tif(f[x]/N>f[y]/N||(f[x]/N==f[y]/N&&check(f[y]%N,R[y],f[x]%N,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\t//cout<<\"-_-\"<<l<<\" \"<<r<<endl;\n\t\tif(s[l]=='a') {\n\t\t\tshu=0;\n\t\t\tfor1(l,r,i) {\n\t\t\t\t/*\n\t\t\t\t这么低级的错误，你会c++吗！！！\n\t\t\t\tif(s[i]=='a'&&!shu) ++f[be[l]],shu=1;\n\t\t\t\telse shu=0;\n\t\t\t\t*/\n\t\t\t\tif(s[i]=='a') f[be[l]]+=!shu,shu=1;\n\t\t\t\telse shu=0;\n\t\t\t//\tcout<<s[i]<<\" \"<<shu<<\" \"<<f[be[l]]<<endl;\n\t\t\t}\n\t\t\t//cout<<f[be[l]]<<endl;\n\t\t\t//while (1);\n\t\t} \n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r-1,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*N+id;\n\t\t}\n\t}\n\t\n\t\n\tMax[be[0]]=be[0];\n\tFOR2(be[0]-1,1,i) {\n\t\tMax[i]=Max[i+1];\n\t\tif(check_Max(i,Max[i])) Max[i]=i;\n\t}\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Max[pos+1];\n\t\tif(f[pos]>N) {\n\t\t\tFOR2(f[pos]/N,1,i) putchar('b');\n\t\t\tfor1(f[pos]%N,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n\n#include<bits/stdc++.h>\nusing namespace std;\n\n#define endl '\\n'\n#define lfs cout<<fixed<<setprecision(10)\n#define ALL(a)  (a).begin(),(a).end()\n#define ALLR(a)  (a).rbegin(),(a).rend()\n#define spa << \" \" <<\n#define fi first\n#define se second\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define EB emplace_back\n#define rep(i,n,m) for(ll i = (n); i < (ll)(m); i++)\n#define rrep(i,n,m) for(ll i = (ll)(m) - 1; i >= (ll)(n); i--)\nusing ll = long long;\nusing ld = long double;\nconst ll MOD1 = 1e9+7;\nconst ll MOD9 = 998244353;\nconst ll INF = 1e18;\nusing P = pair<ll, ll>;\ntemplate<typename T1, typename T2>\nbool chmin(T1 &a,T2 b){if(a>b){a=b;return true;}else return false;}\ntemplate<typename T1, typename T2>\nbool chmax(T1 &a,T2 b){if(a<b){a=b;return true;}else return false;}\nll median(ll a,ll b, ll c){return a+b+c-max({a,b,c})-min({a,b,c});}\nvoid ans1(bool x){if(x) cout<<\"Yes\"<<endl;else cout<<\"No\"<<endl;}\nvoid ans2(bool x){if(x) cout<<\"YES\"<<endl;else cout<<\"NO\"<<endl;}\nvoid ans3(bool x){if(x) cout<<\"Yay!\"<<endl;else cout<<\":(\"<<endl;}\ntemplate<typename T1,typename T2>\nvoid ans(bool x,T1 y,T2 z){if(x)cout<<y<<endl;else cout<<z<<endl;}  \ntemplate<typename T>\nvoid debug(vector<vector<T>>&v,ll h,ll w){for(ll i=0;i<h;i++)\n{cout<<v[i][0];for(ll j=1;j<w;j++)cout spa v[i][j];cout<<endl;}};\nvoid debug(vector<string>&v,ll h,ll w){for(ll i=0;i<h;i++)\n{for(ll j=0;j<w;j++)cout<<v[i][j];cout<<endl;}};\ntemplate<typename T>\nvoid debug(vector<T>&v,ll n){if(n!=0)cout<<v[0];\nfor(ll i=1;i<n;i++)cout spa v[i];cout<<endl;};\ntemplate<typename T>\nvector<vector<T>>vec(ll x, ll y, T w){\n  vector<vector<T>>v(x,vector<T>(y,w));return v;}\nll gcd(ll x,ll y){ll r;while(y!=0&&(r=x%y)!=0){x=y;y=r;}return y==0?x:y;}\nvector<ll>dx={1,-1,0,0,1,1,-1,-1};\nvector<ll>dy={0,0,1,-1,1,-1,1,-1};\ntemplate<typename T>\nvector<T> make_v(size_t a,T b){return vector<T>(a,b);}\ntemplate<typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v(ts...))>(a,make_v(ts...));\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2>&p){\n  return os << p.first << \" \" << p.second;\n}\n//mt19937 mt(chrono::steady_clock::now().time_since_epoch().count());\n\nint main(){\n  cin.tie(nullptr);\n  ios_base::sync_with_stdio(false);\n  ll res=0,buf=0;\n  bool judge = true;\n  ll n;cin>>n;\n  string s;cin>>s;\n  vector<ll>a,b,c;\n  rep(i,0,2*n){\n    if(s[i]=='a'){\n      c.PB(a.size());\n      a.PB(i);\n    }\n    else{\n      c.PB(b.size());\n      b.PB(i);\n    }\n  }\n  auto f=[&](string t){\n    ll nxt=0;\n    queue<ll>ch;\n    stack<ll>st;\n    rep(i,0,2*n){\n      if(nxt==t.size())break;\n      if(ch.front()==i){\n        ch.pop();\n        if(s[i]==t[nxt]){\n          st.push(c[i]);\n          nxt++;\n        }\n        else{\n          ll mi=min(a[c[i]],b[c[i]]);\n          while(!st.empty()){\n            ll p=st.top();\n            if(max(a[p],b[p])>mi){\n              chmin(mi,min(a[p],b[p]));\n              nxt-=2;\n              st.pop();\n            }\n            else break;\n          }\n          nxt--;\n        }\n      }\n      else if(min(a[c[i]],b[c[i]])==i&&s[i]==t[nxt]){\n        nxt++;\n        ch.push(max(a[c[i]],b[c[i]]));\n      }\n    }\n    //cout<<t spa nxt<<endl;\n    return nxt==t.size();\n  };\n  string ret;\n  while(1){\n    if(f(ret+'b')){\n      ret+='b';\n    }\n    else if(f(ret+'a')){\n      ret+='a';\n    }\n    else break;\n  }\n  cout<<ret<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define MN 3000\nusing namespace std;\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n    return x*f;\n}\nchar s[MN*2+5];\nint n,posb[MN+5],posa[MN+5],anum,bnum,match[MN*2+5],no[MN*2+5];\nstring f[MN*2+5];\nstring Max(string a,string b)\n{\n    int n=a.length(),m=b.length();\n    for(int j=0;j<min(n,m);++j)\n    {\n        if(a[j]<b[j]) return b;\n        if(a[j]>b[j]) return a;\n    }\n    return n<=m?b:a;\n}\nint main()\n{   \n    n=read();scanf(\"%s\",s+1);\n    for(int i=1;i<=n<<1;++i)\n        if(s[i]=='a') posa[++anum]=i;\n        else posb[++bnum]=i;\n    for(int i=1;i<=n;++i) match[posa[i]]=posb[i],match[posb[i]]=posa[i],no[posb[i]]=no[posa[i]]=i;\n    for(int i=n<<1;i;--i)\n        if(match[i]<i) f[i]=f[i+1];\n        else if(s[i]=='a') f[i]=Max(f[i+1],string(\"ab\")+f[match[i]+1]);\n        else\n        {\n            int j=no[i],k=no[i];\n            while(k<n&&posb[k+1]<posa[k]) ++k;\n            for(int l=i;l<=posa[k];++l)\n                if(no[l]>=j&&no[l]<=k) f[i]+=s[l];\n            f[i]=Max(f[i]+f[posa[k]+1],f[i+1]);\n            //cout<<i<<\" \"<<j<<\" \"<<k<<\" \"<<f[i]<<endl;\n        }\n    cout<<f[1];\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ff first\n#define ss second\n#define pb push_back\n#define mp make_pair\ntypedef long long LL;\ntypedef unsigned long long uLL;\ntypedef pair<int,int> pii;\n\nconst int maxn=6111;\nint n,a[maxn],b[maxn],ps[maxn];\nchar s[maxn];\n\nvector<string> vs;\nvoid check(int l,int r)\n{\n\tif(a[l]<b[l])\n\t{\n\t\tstring ans=\"\";\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tans=ans+\"ab\";\n\t\t\tint tmp=i;\n\t\t\twhile(i<=r&&a[i]<b[tmp])i++;\n\t\t\ti--;\n\t\t}\n\t\tvs.pb(ans);\n\t}\n\telse\n\t{\n\t\tstring opt=\"\";\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tstring now=\"\";\n\t\t\tfor(int j=b[l];j<=a[r];j++)if(ps[j]>=i)now=now+s[j];\n\t\t\topt=max(opt,now);\n\t\t}\n\t\tvs.pb(opt);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\t\n\tint cnta=0,cntb=0,last=0;\n\tfor(int i=1;i<=n+n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[++cnta]=i;\n\t\t\tps[i]=cnta;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[++cntb]=i;\n\t\t\tps[i]=cntb;\n\t\t}\n\t\tif(cnta==cntb)\n\t\t{\n\t\t\tcheck(last+1,cnta);\n\t\t\tlast=cnta;\n\t\t}\n\t}\n\t\n\tstring ans=\"\",lastv=\"\";\n\tfor(int i=(int)vs.size()-1;i>=0;i--)\n\t{\n\t\tif(vs[i]>=lastv)\n\t\t{\n\t\t\tans=vs[i]+ans;\n\t\t\tlastv=vs[i];\n\t\t}\n\t}\n\tprintf(\"%s\\n\",ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstring>\n#include <cstdio>\n#include <string>\n#include <vector>\nusing namespace std;\n\nconst int Maxn = 6005;\nint n, sza, szb;\nchar str[Maxn];\nint a[Maxn], b[Maxn], pos[Maxn];\nstring dp[Maxn];\n\ninline string Max(string a, string b) {\n\tif (a == \"\") return b;\n\telse if (b == \"\") return a;\n\tfor (int i = 0; i < (int)min(a.size(), b.size()); ++ i)\n\t\tif (a[i] != b[i]) return a[i] > b[i] ? a : b;\n\treturn a.size() > b.size() ? a : b;\n}\n\nint main() {\n\tscanf(\"%d\\n%s\", &n, str + 1);\n\tfor (int i = 1; i <= (n << 1); ++ i)\n\t\tif (str[i] == 'a') a[++ sza] = i, pos[i] = sza;\n\t\telse b[++ szb] = i, pos[i] = szb;\n\tfor (int i = n; i; -- i) {\n\t\tif (a[i] < b[i]) {\n\t\t\tint k = 0;\n\t\t\tfor (int j = b[i] - 1; j > a[i]; -- j)\n\t\t\t\tif (str[j] == 'a') {\n\t\t\t\t\tk = pos[j];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tdp[i] = \"ab\"s + dp[k + 1];\n\t\t}\n\t\telse {\n\t\t\tint k = i;\n\t\t\twhile (k < n && b[k + 1] < a[k]) ++ k;\n\t\t\tfor (int j = b[i]; j <= (n << 1); ++ j)\n\t\t\t\tif (i <= pos[j] && pos[j] <= k) dp[i] += str[j];\n\t\t\tdp[i] += dp[k + 1];\n\t\t}\n\t\tdp[i] = Max(dp[i], dp[i + 1]);\n\t}\n\tstring ans = \"\";\n\tfor (int i = 1; i <= n; ++ i)\n\t\tans = Max(ans, dp[i]);\n\tprintf(\"%s\\n\", ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define qwq(x) cout<<\"# \"<<#x<<\" = \"<<x<<endl;\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef long long ll;\n \ntemplate<class T> inline void read(T &x){\n\tint f=0;x=0;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())f|=(ch=='-');\n\tfor(;isdigit(ch);ch=getchar())x=x*10+ch-'0';\n\tif(f)x=-x;\n}\n\nconst int N=6005;\nint l[N],r[N],id[N],n,cnt,ia,ib;\nstring f[N],g[N];\nchar s[N];\n\nstring calc(int l,int r){\n\tif(s[l]=='a'){\n\t\tstring res;\n\t\tint flag=0;\n\t\trep(i,l,r)\n\t\t\tif(s[i]=='a'){\n\t\t\t\tif(!flag)flag=id[i];\n\t\t\t}\n\t\t\telse if(s[i]=='b'&&flag&&flag<id[i]){\n\t\t\t\tres+=\"ab\";\n\t\t\t\tflag=0;\n\t\t\t}\n\t\treturn res;\n\t}\n\tstring best,now;\n\trep(i,l,r)\n\t\tif(s[i]=='b'){\n\t\t\tnow=\"\";\n\t\t\trep(j,i,r)\n\t\t\t\tif(id[j]>=id[i])\n\t\t\t\t\tnow+=s[j];\n\t\t\tbest=max(best,now);\n\t\t}\n\treturn best;\n}\n\nint main(){\n\tread(n);\n\tscanf(\"%s\",s+1);\n\tint t=0,las=0;\n\trep(i,1,n*2){\n\t\tif(s[i]=='a'){\n\t\t\tt++;\n\t\t\tid[i]=++ia;\n\t\t}\n\t\telse{\n\t\t\tt--;\n\t\t\tid[i]=++ib;\n\t\t}\n\t\tif(t==0){\n\t\t\tl[++cnt]=las+1;\n\t\t\tr[cnt]=i;\n\t\t\tlas=i;\n\t\t}\n\t}\n\trep(i,1,cnt){\n\t\tg[i]=calc(l[i],r[i]);\n\t}\n\tper(i,cnt,1){\n\t\tf[i]=max(f[i+1],g[i]+f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\nstring solve(const string &s){\n\tint n = s.size();\n\tstring res;\n\tvi idx(n);\n\tint a = 0, b = 0;\n\trep(i, n){\n\t\tif(s[i] == 'a') idx[i] = a++;\n\t\telse idx[i] = b++;\n\t}\n\t\n\tif(s[0] == 'a'){\n\t\tfor(int i = 0; i < n; ) if(s[i] == 'a'){\n\t\t\tres += \"ab\";\n\t\t\tfor(int k = idx[i++]; i < n && idx[i] != k; i++);\n\t\t}\n\t\treturn res;\n\t}\n\t\n\trep(k, a){\n\t\tstring tmp;\n\t\trep(i, n) if(idx[i] >= k) tmp += s[i];\n\t\tres = max(res, tmp);\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\t\n\tint n, k = 0; string s, ans, tmp;\n\tcin >> n >> s;\n\tvector<string> v;\n\tfor(char c : s){\n\t\ttmp += c;\n\t\tk += c == 'a' ? 1 : -1;\n\t\tif(k == 0){\n\t\t\tv.pb(solve(tmp)); tmp.clear();\n\t\t}\n\t}\n\tfor(int i = v.size() - 1; i >= 0; i--){\n\t\tif(ans < v[i] + ans) ans = v[i] + ans;\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nint compare(char *x,char *y)\n{\n\tint len=max(strlen(x+1),strlen(y+1));\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 2;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t])==1)\n\t\t\t{\t\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=NULL;\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<ST[t]+1<<endl;\n}\nint compareid(int x,int y) { int t=compare(ST[x],ST[y]); return (t==1||t==2&&x<y); } \nint main()\n{\n//\tfreopen(\"a.in\",\"r\",stdin);\n//\tfreopen(\"a.out\",\"w\",stdout);\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n/*\n10\nba ab ba ba bbabbbaaaa ab\n\n*/ \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=6e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    scanf(\" %s\",s+1);\n//    LL N(2*n);\n//    for(LL i=1;i<=2000;++i) a[i]=(s[i]-'a')^1;\n//    return 0;\n    \n    /*for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;*/\n//    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define llong long long\n#define mkpr make_pair\n#define x first\n#define y second\n#define iter iterator\n#define riter reversed_iterator\n#define y1 Lorem_ipsum_\n#define tm dolor_sit_amet_\nusing namespace std;\n\ninline int read()\n{\n\tint x = 0,f = 1; char ch = getchar();\n\tfor(;!isdigit(ch);ch=getchar()) {if(ch=='-') f = -1;}\n\tfor(; isdigit(ch);ch=getchar()) {x = x*10+ch-48;}\n\treturn x*f;\n}\n\nconst int mxN = 6e3;\nchar a[mxN+3];\nint pos1[mxN+3],pos2[mxN+3],id[mxN+3];\nstring f[mxN+3];\nint n;\n\nint main()\n{\n\tn = read(); scanf(\"%s\",a+1);\n\tfor(int i=1,x=0,y=0; i<=2*n; i++)\n\t{\n\t\tif(a[i]=='a') {pos1[++x] = i; id[i] = x;} else {pos2[++y] = i; id[i] = y;}\n\t}\n\tfor(int i=1; i<=n; i++) if(pos1[i]>pos2[i]) {swap(pos1[i],pos2[i]);}\n\tfor(int i=n; i>=1; i--)\n\t{\n\t\tif(a[pos1[i]]=='a')\n\t\t{\n\t\t\tint j = i; while(j<n&&pos1[j+1]<pos2[i]) {j++;}\n\t\t\tf[i] = \"ab\"+f[j+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint j = i; while(j<n&&pos1[j+1]<pos2[j]) {j++;}\n\t\t\tfor(int k=pos1[i]; k<=pos2[j]; k++) if(id[k]>=i&&id[k]<=j) {f[i] += a[k];}\n\t\t\tf[i] += f[j+1];\n\t\t}\n\t\tif(f[i+1]>f[i]) {f[i] = f[i+1];}\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define ri register int\nconst int N=3e3+5;\nchar s[N<<1];\nstruct node{\n\tstring s;\n\tvector<int> v;\n\tinline bool operator <(const node &rhs)const{\n\t\treturn s<rhs.s; \n\t} \n}suf[N],f[N];\ninline node merge(node a,node b){\n\tri n=a.v.size(),m=b.v.size(),i,j;\n\tnode ans;\n\ti=j=0;\n\twhile(i<n&&j<m){\n\t\tif(a.v[i]<b.v[j])\n\t\t\tans.v.push_back(a.v[i]),\n\t\t\tans.s+=a.s[i],\n\t\t\t++i;\n\t\telse\n\t\t\tans.v.push_back(b.v[j]),\n\t\t\tans.s+=b.s[j],\n\t\t\t++j;\n\t}\n\twhile(i<n)\n\t\tans.v.push_back(a.v[i]),\n\t\tans.s+=a.s[i],\n\t\t++i;\n\twhile(j<m)\n\t\tans.v.push_back(b.v[j]),\n\t\tans.s+=b.s[j],\n\t\t++j;\n\treturn ans;\n}\nint posa[N],posb[N];\nint main(){\n\tri n,len,i,j,k,cnta,cntb;\n\tscanf(\"%d%s\",&n,s+1);\n\tcnta=cntb=0;\n\tlen=n<<1;\n\tfor(i=1;i<=len;++i)\n\t\tif(s[i]=='a')\n\t\t\tposa[++cnta]=i;\n\t\telse\n\t\t\tposb[++cntb]=i;\n\tfor(i=n;i;--i){\n\t\tif(posa[i]<posb[i]){\n\t\t\tfor(j=i+1;j<=n&&posa[j]<posb[i];++j);\n\t\t\tf[i].s=string(\"a\")+string(\"b\");\n\t\t\tf[i].v.push_back(posa[i]);\n\t\t\tf[i].v.push_back(posb[i]);\t\n\t\t\tf[i]=merge(f[i],suf[j]);\n\t\t}\n\t\telse{\n\t\t\tj=i+1;\t\n\t\t\tfor(j=i+1;j<=n&&posb[j]<posa[i];++j);\n\t\t\tfor(k=i;k^j;++k) f[i].s+='b',f[i].v.push_back(posb[k]);\n\t\t\tfor(k=i;k^j;++k) f[i].s+='a',f[i].v.push_back(posa[k]);\n\t\t\tif(posb[j]<posa[j]&&posb[j]<f[i].v.back())\n\t\t\t\tf[i]=merge(f[i],f[j]);\n\t\t\telse\n\t\t\t\tf[i]=merge(f[i],suf[j]);\n\t\t}\n\t\tsuf[i]=max(suf[i+1],f[i]);\n\t}\n\tcout<<suf[1].s<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nstring calc(string s){\n  //cout<<s<<endl;\n  string res;\n  Int n=s.size();\n  if(s[0]=='a'){\n    Int i=0,j=0;\n    while(s[j]=='a') j++;\n    while(j<n){\n      res+=\"ab\";\n      Int k=j;\n      while(i<k){\n\tif(s[i]=='x'){\n\t  i++;\n\t  continue;\n\t}\n\tif(s[i]=='a'){\n\t  i++;\n\t  while(s[j]=='a') j++;\n\t  assert(s[j]=='b');\n\t  s[j++]='x';\n\t}else{\n\t  break;\n\t}\n      }\n      //cout<<i<<\" \"<<j<<endl;\n    }\n  }else{\n    for(Int k=0;k<n;k++){\n      Int a=0,b=0;\n      string tmp;\n      for(Int i=0;i<n;i++){\n\tif(s[i]=='a'){\n\t  if(a>=k) tmp+=s[i];\n\t  a++;\n\t}else{\n\t  if(b>=k) tmp+=s[i];\n\t  b++;\n\t}\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nsigned main(){\n  Int n;\n  string s;\n  cin>>n>>s;\n  n*=2;\n  vector<string> v;\n  Int x[2]={1,-1};\n  for(Int i=0;i<n;){\n    Int j=i,k=x[s[j++]-'a'];\n    while(j<n&&k!=0) k+=x[s[j++]-'a'];\n    v.emplace_back(calc(s.substr(i,j-i)));\n    i=j;\n  }\n  reverse(v.begin(),v.end());\n  string ans;\n  for(string t:v) chmax(ans,t+ans);\n  cout<<ans<<endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define F first\n#define S second\n#define int long long\n#define ll long long\n//#define int  unsigned long long\n#define pb push_back\n//#define double long double\n\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef  tree< int , null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> ordered_set;\nconst int mod = 1e9 + 7;\nconst int N = 650055;\nconst int K = 700 ;\nint a[N], p1[N], p2[N], d[N], n;\nvector < pair < int, int > > t;\nstring calc(string s){\n        string ans = \"\";\n        int cnt1 = 0;\n        int cnt2 = 0;\n        int n = s.length() / 2;\n        for (int i = 1; i <= n + n; i++){\n            if (s[i - 1] == 'a'){\n                cnt1++;\n                cnt2 = 0;\n                for (int j = 1; j <= n + n; j++){\n                    if (s[j - 1] == 'b') cnt2++;\n                    if (cnt2 == cnt1){\n                        d[i] = j;\n                        break;\n                    }\n                }\n            }\n        }\n        int c = 1;\n        while (c <= n + n){\n            ans += \"ab\";\n            c = d[c];\n            while(s[c - 1] == 'b') c++;\n        }\n    return ans;\n}\nmain(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    //freopen(\"input.txt\", \"r\", stdin);\n    cin >> n;\n    string s;\n    cin >> s;\n    for (int i = 1; i <= n + n; i++){\n        if (s[i - 1] == 'a') a[i] = -1; else a[i] = 1;\n    }\n    int x = 0;\n    int l = 1;\n    int q = 0;\n    for (int i = 1; i <= n + n; i++){\n        x += a[i];\n        if (x == 0){\n            if (a[l] == 1) q = 1;\n            t.pb({l, i});\n            l = i + 1;\n        }\n    }\n    int c = 0;\n    if (q == 0){\n        cout << calc(s);\n        return 0;\n    }\n    vector < string > v;\n    for (auto i: t){\n        string res = \"\";\n        string cur = s.substr(i.F - 1, i.S - i.F + 1);\n        if (a[i.F] == -1){\n            res = calc(cur);\n            v.pb(res);\n            continue;\n        }\n        int cnt1 = 0;\n        int cnt2 = 0;\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a'){\n                cnt2++;\n                p2[j] = p1[cnt2];\n            } else{\n                cnt1++;\n                p1[cnt1] = j;\n            }\n        }\n        for (int j = 0; j < cur.length(); j++){\n            if (cur[j] == 'a') continue;\n            string x = \"\";\n            for (int l = j; l < cur.length(); l++){\n                if (cur[l] == 'b') x += \"b\"; else\n                if (cur[l] == 'a' && p2[l] >= j) x += \"a\";\n            }\n            res = max(res, x);\n        }\n        v.pb(res);\n    }\n    string ans = \"\";\n    for (int j = v.size() - 1; j >= 0; j--){\n        ans = max(ans, v[j] + ans);\n    }\n    cout << ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr long  double EPS = 1e-8;\n\n//int N, M, K, H, W, L, R;\nlong long int N, M, K, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tcin >> N;\n\tstring s;\n\tcin >> s;\n\tvector<int>sum(N*2);\n\tfor (int i = 0; i < N * 2; i++) {\n\t\tif (s[i] == 'a')sum[i]++;\n\t\telse sum[i]--;\n\t\tif (i)sum[i] += sum[i - 1];\n\t}\n\tvector<string>st;\n\tint bef = 0;\n\tfor (int i = 0; i < N*2; i++) {\n\t\tstring nx;\n\t\tif (sum[i] == 0) {\n\t\t\tif (s[bef] == 'a') {\n\t\t\t\tint anum = 0;\n\t\t\t\tint bnum = 0;\n\t\t\t\tint abef = -1;\n\t\t\t\tfor (int j = bef; j <= i; j++) {\n\t\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\t\tanum++;\n\t\t\t\t\t\tif (bnum >= abef) {\n\t\t\t\t\t\t\tnx.push_back(s[j]);\n\t\t\t\t\t\t\tabef = anum;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tbnum++;\n\t\t\t\t\t\tif (bnum == abef) {\n\t\t\t\t\t\t\tnx.push_back(s[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tint num = i - bef + 1;\n\t\t\t\tnum >>= 1;\n\t\t\t\tfor (int j = 0; j < num; j++) {\n\t\t\t\t\tint a = j, b = j;\n\t\t\t\t\tstring box;\n\t\t\t\t\tfor (int k = bef; k <= i; k++) {\n\t\t\t\t\t\tif (s[k] == 'a') {\n\t\t\t\t\t\t\tif (a)a--;\n\t\t\t\t\t\t\telse box.push_back('a');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (b)b--;\n\t\t\t\t\t\t\telse box.push_back('b');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnx = max(nx, box);\n\t\t\t\t}\n\t\t\t}\n\t\t\tst.push_back(nx);\n\t\t\tbef = i + 1;\n\t\t}\n\t}\n\tstring ans;\n\treverse(st.begin(), st.end());\n\tfor (auto i : st) {\n\t\tans = max(ans, i + ans);\n\t}\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "// need\n#include <iostream>\n#include <algorithm>\n\n// data structure\n#include <bitset>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#include <complex>\n//#include <deque>\n#include <valarray>\n#include <array>\n#include <unordered_map>\n\n// stream\n//#include <istream>\n//#include <sstream>\n//#include <ostream>\n#include <fstream>\n\n// etc\n#include <cassert>\n#include <cmath>\n#include <functional>\n#include <iomanip>\n#include <chrono>\n#include <random>\n#include <numeric>\n\n// input\n#define INIT std::ios::sync_with_stdio(false);std::cin.tie(0);\n#define VAR(type, ...)type __VA_ARGS__;MACRO_VAR_Scan(__VA_ARGS__);\ntemplate<typename T> void MACRO_VAR_Scan(T& t) { std::cin >> t; }\ntemplate<typename First, typename...Rest>void MACRO_VAR_Scan(First& first, Rest&...rest) { std::cin >> first; MACRO_VAR_Scan(rest...); }\n#define VEC_ROW(type, n, ...)std::vector<type> __VA_ARGS__;MACRO_VEC_ROW_Init(n, __VA_ARGS__); for(int i=0; i<n; ++i){MACRO_VEC_ROW_Scan(i, __VA_ARGS__);}\ntemplate<typename T> void MACRO_VEC_ROW_Init(int n, T& t) { t.resize(n); }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Init(int n, First& first, Rest&...rest) { first.resize(n); MACRO_VEC_ROW_Init(n, rest...); }\ntemplate<typename T> void MACRO_VEC_ROW_Scan(int p, T& t) { std::cin >> t[p]; }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Scan(int p, First& first, Rest&...rest) { std::cin >> first[p]; MACRO_VEC_ROW_Scan(p, rest...); }\n#define VEC(type, c, n) std::vector<type> c(n);for(auto& i:c)std::cin>>i;\n#define MAT(type, c, m, n) std::vector<std::vector<type>> c(m, std::vector<type>(n));for(auto& r:c)for(auto& i:r)std::cin>>i;\n\n// output\n#define OUT(d) std::cout<<(d);\n#define FOUT(n, d) std::cout<<std::fixed<<std::setprecision(n)<<(d);\n#define SOUT(n, c, d) std::cout<<std::setw(n)<<std::setfill(c)<<(d);\n#define SP std::cout<<\" \";\n#define TAB std::cout<<\"\\t\";\n#define BR std::cout<<\"\\n\";\n#define SPBR(i, n) std::cout<<(i + 1 == n ? '\\n' : ' ');\n#define ENDL std::cout<<std::endl;\n#define FLUSH std::cout<<std::flush;\n#define SHOW(d) {std::cerr << #d << \"\\t:\" << (d) << \"\\n\";}\n#define SHOWVECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOWVECTOR2(v) {std::cerr << #v << \"\\t:\\n\";for(const auto& xxx : v){for(const auto& yyy : xxx){std::cerr << yyy << \" \";}std::cerr << \"\\n\";}}\n#define SHOWQUEUE(a) {auto tmp(a);std::cerr << #a << \"\\t:\";while(!tmp.empty()){std::cerr << tmp.front() << \" \";tmp.pop();}std::cerr << \"\\n\";}\n\n// utility\n#define ALL(a) (a).begin(),(a).end()\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RFOR(i, a, b) for(int i=(b)-1;i>=(a);--i)\n#define REP(i, n) for(int i=0;i<int(n);++i)\n#define RREP(i, n) for(int i=int(n)-1;i>=0;--i)\n#define FORLL(i, a, b) for(ll i=ll(a);i<ll(b);++i)\n#define RFORLL(i, a, b) for(ll i=ll(b)-1;i>=ll(a);--i)\n#define REPLL(i, n) for(ll i=0;i<ll(n);++i)\n#define RREPLL(i, n) for(ll i=ll(n)-1;i>=0;--i)\n#define IN(a, x, b) (a<=x && x<b)\ntemplate<typename T> inline T CHMAX(T& a, const T b) { return a = (a < b) ? b : a; }\ntemplate<typename T> inline T CHMIN(T& a, const T b) { return a = (a > b) ? b : a; }\n#define EXCEPTION(msg) throw std::string(\"Exception : \" msg \" [ in \") + __func__ + \" : \" + std::to_string(__LINE__) + \" lines ]\"\n#define TRY(cond, msg) try {if (cond) EXCEPTION(msg);}catch (std::string s) {std::cerr << s << std::endl;}\nvoid CHECKTIME(std::function<void()> f) { auto start = std::chrono::system_clock::now(); f(); auto end = std::chrono::system_clock::now(); auto res = std::chrono::duration_cast<std::chrono::nanoseconds>((end - start)).count(); std::cerr << \"[Time:\" << res << \"ns  (\" << res / (1.0e9) << \"s)]\\n\"; }\n\n// test\ntemplate<class T> std::vector<std::vector<T>> VV(int n, int m, T init = T()) {\n\treturn std::vector<std::vector<T>>(n, std::vector<T>(m, init));\n}\ntemplate<typename S, typename T>\nstd::ostream& operator<<(std::ostream& os, std::pair<S, T> p) {\n\tos << \"(\" << p.first << \", \" << p.second << \")\"; return os;\n}\n\n// type/const\n//#define int ll\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\nusing PAIR = std::pair<int, int>;\nusing PAIRLL = std::pair<ll, ll>;\nconstexpr int INFINT = 1 << 30;                          // 1.07x10^ 9\nconstexpr int INFINT_LIM = (1LL << 31) - 1;              // 2.15x10^ 9\nconstexpr ll INFLL = 1LL << 60;                          // 1.15x10^18\nconstexpr ll INFLL_LIM = (1LL << 62) - 1 + (1LL << 62);  // 9.22x10^18\nconstexpr double EPS = 1e-9;\nconstexpr int MOD = 1000000007;\nconstexpr double PI = 3.141592653589793238462643383279;\n\ntemplate<class T, size_t N> void FILL(T(&a)[N], const T& val) { for (auto& x : a) x = val; }\ntemplate<class ARY, size_t N, size_t M, class T> void FILL(ARY(&a)[N][M], const T& val) { for (auto& b : a) FILL(b, val); }\ntemplate<class T> void FILL(std::vector<T>& a, const T& val) { for (auto& x : a) x = val; }\ntemplate<class ARY, class T> void FILL(std::vector<std::vector<ARY>>& a, const T& val) { for (auto& b : a) FILL(b, val); }\n\n// ------------>8------------------------------------->8------------\n\n\n\nsigned main() {\n\tINIT;\n\n\tVAR(int, n);\n\tVAR(std::string, s);\n\n\tstruct D {\n\t\tstd::string s;\n\t\tstd::set<int> set;\n\t\tbool operator<(const D& r) const {\n\t\t\tif (s == r.s) return *set.begin() < *r.set.begin();\n\t\t\treturn s > r.s;\n\t\t}\n\t};\n\n\tstd::vector<int> a, b;\n\tstd::vector<int> inv(2 * n);\n\tREP(i, 2 * n) {\n\t\tif (s[i] == 'a') inv[i] = a.size(), a.emplace_back(i);\n\t\telse inv[i] = b.size(), b.emplace_back(i);\n\t}\n\n\tstd::vector<D> v;\n\n\tREP(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tif (i < b[inv[i]]) {\n\t\t\t\tstd::set<int> set({i, b[inv[i]]});\n\t\t\t\tv.emplace_back(D{ \"ab\", set });\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (i < a[inv[i]]) {\n\t\t\t\tstd::set<int> set({ i, a[inv[i]] });\n\t\t\t\tint lim = a[inv[i]];\n\t\t\t\tFOR(j, i + 1, lim + 1) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tif (j < a[inv[j]]) {\n\t\t\t\t\t\t\tset.insert(j);\n\t\t\t\t\t\t\tset.insert(a[inv[j]]);\n\t\t\t\t\t\t\tCHMAX(lim, a[inv[j]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstd::string t;\n\t\t\t\tfor (auto& x : set) t += s[x];\n\t\t\t\tv.emplace_back(D{ t, set });\n\t\t\t}\n\t\t}\n\t}\n\n\tstd::sort(ALL(v));\n\n\tstd::string ans;\n\tint r = -1;\n\tfor(auto& d : v) {\n\t\tif (r < *d.set.begin()) {\n\t\t\tans += d.s;\n\t\t\tr = *d.set.rbegin();\n\t\t}\n\t}\n\tOUT(ans)BR;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nusing namespace std;\ntemplate<class T> void read(T &x)\n{\n    x=0; int f=1,ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=x*10-'0'+ch;ch=getchar();}\n    x*=f;\n}\ntemplate<class T> inline bool Cmax(T &x,T y) {return x<y?x=y,1:0;}\nconst int maxn=3000+50;\nint n;\nint a[maxn],b[maxn],bel[maxn<<1];\nchar s[maxn<<1];\nvector<string> an;\nvoid sol(int L,int R)\n{\n    string re;\n    int l=1; while(a[l]<L) ++l;\n    int r=n; while(a[r]>R) --r;\n    if(s[L]=='a')\n    {\n        int cnt=1,k=l;\n        for(int i=l;i<=r;++i)\n        {\n            if(a[i]>b[k]) ++cnt,k=i;\n        }\n        while(cnt--) re.push_back('a'),re.push_back('b');\n    }\n    else\n    {\n        for(int i=l;i<=r;++i)\n        {\n            string now; \n            for(int j=b[i];j<=R;++j) if(bel[j]>=i) now.push_back(s[j]);\n            Cmax(re,now);\n        }\n    }\n    // cerr<<L<<' '<<R<<' '<<l<<' '<<r<<' '<<re<<endl;\n    if(an.size()&&an.back()>re) return;\n    an.push_back(re);\n}\nint main()\n{\n    read(n);\n    scanf(\"%s\",s+1);\n    for(int i=1,x=0,y=0;i<=(n<<1);++i)\n    {\n        if(s[i]=='a') a[++x]=i,bel[i]=x;\n        else b[++y]=i,bel[i]=y;\n    }\n    for(int i=(n<<1),cnt=0,las=(n<<1);i>=1;--i)\n    {\n        if(s[i]=='a') ++cnt; else --cnt;\n        if(cnt==0)\n        {\n            sol(i,las);\n            las=i-1;\n        }\n    }\n    for(int i=an.size()-1;~i;--i) cout<<an[i];\n    debug(\"\\n\");\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 6012\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (1){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] != s[rig])return s[lef] > s[rig];\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2 * n, 0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first < pos[b].second){  ///(b    b <>  a    a<>    )\n\t\tint til = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\ttil = j;\n\t\t\t}\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif(pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t}\n\t\t}\n\t\tif (cmp(nex, dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t\tfor (int j3 = b; j3 < pos.size(); j3++){\n\t\t\tif (pos[b].second < min(pos[j3].first, pos[j3].second)){\n\t\t\t\tnex=dfs(j3);\n\t\t\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\t\t\tif (pos[j].first < pos[j].second&&pos[j].first<pos[b].second){\n\t\t\t\t\t\tnex[pos[j].first] = nex[pos[j].second] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cmp(nex, dp[b])){\n\t\t\t\t\tdp[b] = nex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\t//a     b\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = pos[b].first;\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t\tne = vector<bool>(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tauto k2 = dfs(b + 1);\n\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\tne[i] = (ne[i] | k2[i]);\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss = dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n\treturn lo;\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\t//cout<<nb<<endl;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num) v[i]=bs(i);\n\tint p=ok();\n\tassert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\n * Since g++10 is released, some characters is not valid inside #if 0 :(\n * So, why not using clang++? :D\n\n * Date:\n  echo -n '  ' && date +%Y.%m.%d\n\n * Solution:\n  To be updated.\n\n * Digression:\n\n * CopyRight:\n          ▁▃▄▄▄▃▃▃▃▄▶\n        ▗▇▀▔    ▔▔▔▔\n       ▄▛   ▃▅━━■▄▂\n      ▟▊   ▐▘     ▀▙\n     ▟▜▌   ▐▖   ▋  ▐▍\n    ▟▘ ▜   ▝▀▇▆●▘  ▐▌\n  ▗▟▘   ▜▃       ▁▅▛\n  ▔▀▼▅▄▃▃██▅▄▄▄▅■▀▔\n        ▔▔▔▔▔▔\n */\n\n#include <cstdio>\n#include <algorithm>\n#include <string>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long ll;\ntypedef std::string str;\n\nstruct _{\n\tinline operator int () { int x; return scanf(\"%d\", &x), x; }\n\tinline operator ll () { ll x; return scanf(\"%lld\", &x), x; }\n} read;\n\nconst int maxn = 3000;\nchar s[maxn * 2 + 5];\nint apos[maxn + 5], bpos[maxn + 5];\nstr f[maxn + 5], g[maxn + 5];\n\nint main () {\n\tint n = read;\n\tscanf(\"%s\", s + 1);\n\n\tfor (int i = 1, ap = 0, bp = 0; i <= n * 2; i ++) {\n\t\tif (s[i] == 'a') apos[++ ap] = i;\n\t\tif (s[i] == 'b') bpos[++ bp] = i;\n\t}\n\n\tfor (int i = n; i; i --) {\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and apos[j] < bpos[i]) ++ j;\n\t\t\tf[i] = \"ab\" + g[j];\n\t\t}\n\t\tif (apos[i] > bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= n and bpos[j] < apos[i]) ++ j;\n\t\t\tfor (int k = 0; k < j - i; k ++) f[i] += 'b';\n\t\t\tf[i] += 'a' + (i + 1 == j ? g[i + 1] : f[i + 1]).substr(\n\t\t\t\t\tsize_t(j - i - 1), str::npos);\n\t\t}\n\t\tg[i] = std::max(f[i], g[i + 1]);\n\t}\n\n\tputs(g[1].c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define title \"title\"\n#define ll long long\n#define ull unsigned ll\n#define fix(x) fixed<<setprecision(x)\n#define pii pair<int,int>\n#define vint vector<int>\n#define pb push_back\nusing namespace std;\nvoid Freopen(){\n\tfreopen(title\".in\",\"r\",stdin);\n\tfreopen(title\".out\",\"w\",stdout);\n}\nint read(){\n\tint g=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||'9'<ch){if(ch=='-')f=-1;ch=getchar();}\n\twhile('0'<=ch&&ch<='9'){g=g*10+ch-'0';ch=getchar();}\n\treturn g*f;\n}\nconst int N=3e3+5;\nstring s,f[N];\nint n,a[N],b[N],id[N<<1],ne[N<<1];\nsigned main(){\n\tn=read();cin>>s;s=' '+s;\n\tfor(int i=1,ta=0,tb=0;i<=n<<1;i++){\n\t\tif(s[i]=='a')ta++,id[i]=ta,a[ta]=i;\n\t\telse tb++,id[i]=tb,b[tb]=i;\n\t}a[n+1]=b[n+1]=(n<<1|1),id[n<<1|1]=n+1;\n\tfor(int i=0,j=0;i<=n+1;i++)while(j<min(a[i],b[i]))ne[++j]=i;\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]>b[i]){\n\t\t\tint j=b[i];\n\t\t\tfor(;b[id[j]]<a[id[j]]&&(id[j]<=i||b[id[j]]<a[id[j]-1]);j++)if(id[j]>=i)f[i]+=s[j];\n\t\t\tf[i]+=f[id[j]];\n\t\t}else f[i]=\"ab\"+f[ne[b[i]+1]];\n\t\tf[i]=max(f[i],f[i+1]);\n\t}return cout<<f[1],signed();\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 6020\n#define rep(i,l,r) for(register int i = l ; i <= r ; i++)\n#define repd(i,r,l) for(register int i = r ; i >= l ; i--)\n#define rvc(i,S) for(register int i = 0 ; i < (int)S.size() ; i++)\n#define rvcd(i,S) for(register int i = ((int)S.size()) - 1 ; i >= 0 ; i--)\n#define fore(i,x)for (register int i = head[x] ; i ; i = e[i].next)\n#define pb push_back\n#define prev prev_\n#define stack stack_\n#define mp make_pair\n#define fi first\n#define se second\n#define inf 0x3f3f3f3f\ntypedef long long ll;\ntypedef pair<int,int> pr;\n\nchar ch[maxn],ans[maxn],tmp[maxn],cur[maxn];\nint n,a[maxn],b[maxn],tota,totb,tot,len,len2,clen[maxn],tag[maxn];\nchar vec[maxn / 2][maxn];\n\nvoid getmx1(int x,int l,int r){\n\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\tint lastb = b[l];\n\trep(i,l + 1,r){\n\t\tif ( a[i] > lastb ){\n\t\t\tvec[x][++clen[x]] = 'a' , vec[x][++clen[x]] = 'b';\n\t\t\tlastb = b[i];\n\t\t}\n\t}\n}\ninline int cmp(char s[],int l1,char t[],int l2){\n\trep(i,1,min(l1,l2)){\n\t\tif ( s[i] != t[i] ) return s[i] > t[i];\n\t}\n\treturn l1 >= l2;\n}\nvoid getmx2(int x,int l,int r){\n\tlen = 2;\n\ttmp[1] = 'b' , tmp[2] = 'a';\n\trep(i,l,r - 1){\n\t\tlen2 = 0;\n\t\tint pa = i , pb = i;\n\t\twhile ( pa <= r && pb <= r ){\n\t\t\tif ( a[pa] < b[pb] ) cur[++len2] = 'a' , pa++;\n\t\t\telse cur[++len2] = 'b' , pb++;\n\t\t}\n\t\twhile ( pa <= r ) cur[++len2] = 'a' , pa++;\n\t\twhile ( pb <= r ) cur[++len2] = 'b' , pb++;\n\t\tif ( !cmp(tmp,len,cur,len2) ){\n\t\t\trep(j,1,len2) tmp[j] = cur[j];\n\t\t\tlen = len2;\n\t\t}\n\t}\n\trep(i,1,len) vec[x][i] = tmp[i];\n\tclen[x] = len;\n}\nvoid getans(){\n\tlen = 0;\n\trepd(i,tot,1){\n\t\tif ( cmp(vec[i],clen[i],tmp,len) ){\n\t\t\ttag[i] = 1;\n\t\t\trep(j,1,clen[i]) tmp[j] = vec[i][j];\n\t\t\tlen = clen[i];\n\t\t}\n\t}\n\trep(i,1,tot) if ( tag[i] ){\n\t\trep(j,1,clen[i]) putchar(vec[i][j]);\n\t}\n\tputs(\"\");\n}\nint main(){\n\t\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",ch + 1);\n\trep(i,1,n * 2){\n\t\tif ( ch[i] == 'a' ) a[++tota] = i;\n\t\telse b[++totb] = i;\n\t}\n\tint last = 1 , mx = 0;\n\trep(i,1,n){\n\t\tmx = max(mx,max(a[i],b[i]));\n\t\tif ( mx == i * 2 ){\n\t\t\t++tot;\n\t\t\tif ( a[i] < b[i] ) getmx1(tot,last,i);\n\t\t\telse getmx2(tot,last,i);\n\t\t\tlast = i + 1 , mx = 0;\n\t\t}\n\t}\n\tgetans();\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <map>\n#include <set>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <vector>\n#include <bitset>\n#include <cstdio>\n#include <cctype>\n#include <string>\n#include <numeric>\n#include <cstring>\n#include <cassert>\n#include <climits>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std ;\n#define rep(i, a, b) for (register int i = (a); i <= (b); ++i)\n#define per(i, a, b) for (register int i = (a); i >= (b); --i)\n#define loop(it, v) for (auto it = v.begin(); it != v.end(); it++)\n#define cont(i, x) for (register int i = head[x]; i; i = edge[i].nex)\n#define clr(a) memset(a, 0, sizeof(a))\n#define ass(a, cnt) memset(a, cnt, sizeof(a))\n#define cop(a, b) memcpy(a, b, sizeof(a))\n#define lowbit(x) (x & -x)\n#define all(x) x.begin(), x.end()\n#define SC(t, x) static_cast <t> (x)\n#define ub upper_bound\n#define lb lower_bound\n#define pqueue priority_queue\n#define mp make_pair\n#define pb push_back\n#define pof pop_front\n#define pob pop_back\n#define fi first\n#define se second\n#define y1 y1_\n#define Pi acos(-1.0)\n#define iv inline void\n#define enter putchar('\\n')\n#define siz(x) ((int)x.size())\n#define file(x) freopen(x\".in\", \"r\", stdin),freopen(x\".out\", \"w\", stdout)\ntypedef double db ;\ntypedef long long ll ;\ntypedef unsigned long long ull ;\ntypedef pair <int, int> pii ;\ntypedef vector <int> vi ;\ntypedef vector <pii> vii ;\ntypedef queue <int> qi ;\ntypedef queue <pii> qii ;\ntypedef set <int> si ;\ntypedef map <int, int> mii ;\ntypedef map <string, int> msi ;\nconst int maxn = 4e3 + 100 ;\nconst int inf = 0x3f3f3f3f ;\nconst int iinf = 1 << 30 ;\nconst ll linf = 2e18 ;\nconst ll mod = 998244353 ;\nconst double eps = 1e-7 ;\ntemplate <class T = int> T read()\n{\n\tT f = 1, a = 0;\n\tchar ch = getchar() ;\n\twhile (!isdigit(ch)) { if (ch == '-') f = -1 ; ch = getchar() ; }\n\twhile (isdigit(ch)) { a =  (a << 3) + (a << 1) + ch - '0' ; ch = getchar() ; }\n\treturn a * f ;\n}\n\nint n, last = 1, lpos = 1;\n\nchar s[maxn];\n\nint posa[maxn], posb[maxn], suma, sumb, rnk[maxn];\n\npair <string, int> c[maxn];\n\nstring ans;\n\nint tot;\n\nvoid solve(int l, int r)\n{\n\t++ tot;\n\tc[tot].se = tot;\n\tif(s[l] == 'a')\n\t{\n\t\tint pos = l;\n\t\twhile(pos < r)\n\t\t{\n\t\t\tc[tot].fi += \"ab\";\n\t\t\tpos = posb[rnk[pos]] + 1;\n\t\t\twhile(s[pos] == 'b' && pos <= r) pos ++;\n\t\t}\n\t}\n\telse\n\t{\n\t\trep(i, lpos, rnk[r])\n\t\t{\n\t\t\tstring tmp = \"\";\n\t\t\trep(j, l, r) if(rnk[j] >= i) tmp += s[j];\n\t\t\tc[tot].fi = max(c[tot].fi, tmp);\n\t\t}\n\t}\n}\n\nsigned main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\trep(i, 1, 2 * n)\n\t{\n\t\tif(s[i] == 'a') posa[++ suma] = i, rnk[i] = suma;\n\t\telse posb[++ sumb] = i, rnk[i] = sumb;\n\t\tif(suma == sumb) solve(last, i), last = i + 1, lpos = suma + 1;\n\t}\n\tper(i, n, 1) ans = max(ans, c[i].fi + ans);\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<cmath>\n#include<cstdlib>\n#define LL long long\n#define LD long double\nusing namespace std;\nconst int NN=3000 +117;\nconst int MM=3000 +117;\nint read(){\n\tint fl=1,x;char c;\n\tfor(c=getchar();(c<'0'||c>'9')&&c!='-';c=getchar());\n\tif(c=='-'){fl=-1;c=getchar();}\n\tfor(x=0;c>='0'&&c<='9';c=getchar())\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\treturn x*fl;\n}\nvoid open(){\n\tfreopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"a.out\",\"w\",stdout);\n}\nvoid close(){\n\tfclose(stdin);\n\tfclose(stdout);\n}\n\n\nint m,n;\nstring ans,tp;\nint a[NN]={};\nint b[NN]={};\nstring s;\nbool vis[2*NN]={};\nvoid update(string &s,string x){\n\tif(s<x)s=x;\n}\nvoid solve(int l,int r){\n\ttp.clear();\n\tif(a[l]<b[l]){\n\t\tstring pre;\n\t\tint bef=-1;\n\t\tfor(int i=l;i<=r;++i){\n\t\t\tif(a[i]>bef){\n\t\t\t\tpre+=\"ab\";\n\t\t\t\tupdate(tp,pre+ans);\n\t\t\t\tbef=b[i];\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\tint ll=min(a[l],b[l]);\n\t\tint rr=max(a[r],b[r]);\n\t\tfor(int i=ll;i<=rr;++i)vis[i]=1;\n\t\tfor(int i=l;i<=r;++i){\n\t\t\tstring pre;\n\t\t\tfor(int j=ll;j<=rr;++j){\n\t\t\t\tif(vis[j])pre+=s[j];\n\t\t\t}\n\t\t\tupdate(tp,pre+ans);\n\t\t\tvis[a[i]]=0,vis[b[i]]=0;\n\t\t}\n\t}\n\tupdate(ans,tp);\n\t//cerr<<ans<<endl;\n}\nint main(){\n\t//open();\n\tn=read();\n\tcin>>s;\n\tint ac=0,bc=0;\n\tfor(int i=0;i<2*n;++i){\n\t\tif(s[i]=='a')a[++ac]=i;\n\t\telse b[++bc]=i;\n\t}\n\ta[0]=-1,b[0]=-1;\n\tint pos=n;\n\tint left=min(a[n],b[n]);\n\tfor(int i=n-1;i>=0;--i){\n\t\tif(max(a[i],b[i])<left){\n\t\t\tsolve(i+1,pos);\n\t\t\tpos=i;\n\t\t\tleft=min(a[i],b[i]);\n\t\t}\n\t\telse{\n\t\t\tleft=min(left,min(a[i],b[i]));\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\tclose();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int maxn = 6000;\nint n, sum[maxn + 3], tot, m[maxn + 3], k, l, a[maxn + 3], b[maxn + 3], p[maxn + 3], sz[maxn + 3];\nchar str[maxn + 3], s[maxn + 3][maxn + 3], res[maxn + 3][maxn + 3], tmp[maxn + 3];\nbool vis[maxn + 3];\n\nbool check(char s[], int n, char t[], int m) {\n\tfor (int i = 1; i <= min(n, m); i++) {\n\t\tif (s[i] > t[i]) return true;\n\t\tif (s[i] < t[i]) return false;\n\t}\n\treturn n > m;\n}\n\nvoid solve(char s[], char ret[], int n, int &m) {\n\tk = l = m = 0;\n\tfor (int i = 1; i <= n; i++) {\n\t\tvis[i] = false;\n\t\tif (s[i] == 'a') {\n\t\t\ta[++k] = i, p[i] = k;\n\t\t} else {\n\t\t\tb[++l] = i, p[i] = l;\n\t\t}\n\t}\n\tif (s[1] == 'a') {\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tif (vis[i]) continue;\n\t\t\tfor (int j = a[p[i]]; j < b[p[i]]; j++) {\n\t\t\t\tvis[b[p[j]]] = true;\n\t\t\t}\n\t\t\tret[++m] = 'a';\n\t\t\tret[++m] = 'b';\n\t\t\ti = b[p[i]];\n\t\t}\n\t} else {\n\t\tfor (int i = 1; i <= k; i++) {\n\t\t\tint c = 0;\n\t\t\tfor (int j = 1; j <= n; j++) {\n\t\t\t\tif (p[j] >= i) tmp[++c] = s[j];\n\t\t\t}\n\t\t\tif (check(tmp, c, ret, m)) {\n\t\t\t\tm = c;\n\t\t\t\tfor (int j = 1; j <= c; j++) {\n\t\t\t\t\tret[j] = tmp[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main() {\n\tscanf(\"%d %s\", &n, str + 1);\n\tfor (int i = 1; i <= n * 2; i++) {\n\t\tsum[i] = sum[i - 1] + (str[i] == 'a' ? 1 : -1);\n\t}\n\tint lst = 1;\n\tfor (int i = 1; i <= n * 2; i++) {\n\t\tif (sum[i] == 0) {\n\t\t\t++tot;\n\t\t\tfor (int j = lst; j <= i; j++) {\n\t\t\t\ts[tot][++m[tot]] = str[j];\n\t\t\t}\n\t\t\tlst = i + 1;\n\t\t}\n\t}\n\tfor (int i = 1; i <= tot; i++) {\n\t\tsolve(s[i], res[i], m[i], sz[i]);\n\t}\n\tstring s = \"\";\n\tfor (int i = tot; i; i--) {\n\t\tstring t = \"\";\n\t\tfor (int j = 1; j <= sz[i]; j++) {\n\t\t\tt += res[i][j];\n\t\t}\n\t\tt += s;\n\t\tif (t > s) {\n\t\t\ts = t;\n\t\t}\n\t}\n\tcout << s << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n\n  int ctr = 0, lp = -1;\n  rep(i, pos_a.size()) if (lp < pos_a[i]) {\n    ctr++;\n    lp = pos_b[i];\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (a < num && (b == num || pos_a[a] < pos_b[b])) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<string> list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(solve_ba(s));\n    }\n  }\n  string out = \"\";\n  for (int i=list2.size()-1; i>=0; i--) out = max(out, list2[i]+out);\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#pragma comment(linker, \"/STACK:256000000\")\n#define _USE_MATH_DEFINES\n#include<iostream>\n#include<vector>\n#include<string>\n#include<stack>\n#include<algorithm>\n#include<cmath>\n#include<set>\n#include<queue>\n#include<sstream>\n#include<utility>\n#include<map>\n#include<ctime>\n#include<cstdio>\n#include<cassert>\n#include<functional>\n\n\n\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> pll;\ntypedef pair<int, int> pii;\ntypedef pair<char, char> pcc;\ntypedef pair<double, double> pdd;\n\n#define show(x) cerr << x\n#define debug(x) show(#x << \": \" << (x) << endl)\n\nconst long double PI = 3.14159265358979323846;\nconst long double eps = 1e-5;\nconst int INF = numeric_limits<int>::max();\nconst ll LINF = numeric_limits<ll>::max();\nconst ll mod = 1000 * 1000 * 1000 + 7;\n\n\n\nvoid solve() {\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<int> a, b;\n    for (int i = 0; i < 2 * n; ++i) {\n        if (s[i] == 'a')\n            a.push_back(i);\n        else\n            b.push_back(i);\n    }\n    vector<string> v(n);\n    vector<int> lst(n);\n    vector<int> ids;\n    int st = 1;\n    for (int i = 0; i < n; ++i) {\n        ids.push_back(b[i]);\n        ids.push_back(a[i]);\n        for (int j = i; j < n; ) {\n            \n            if (max(a[j], b[j]) == 2 * j + 1) {\n                sort(ids.begin(), ids.end());\n                string str = \"\";\n                for (int j = 0; j < ids.size(); ++j) \n                    str.push_back(s[ids[j]]);\n                \n                v[i] = str;\n                lst[i] = ids.back();\n                ids.resize(0);\n                break;\n            }\n            ++j;\n            if (b[j] < a[j]) {\n                ids.push_back(b[j]);\n                ids.push_back(a[j]);\n            }\n        }\n    }\n    \n    vector<string> res;\n    vector<int> id;\n    for (int i = 0; i < v.size(); ++i) {\n        while (!res.empty()) {\n            if (res.back() + v[i] < v[i]) {\n                res.pop_back();\n                id.pop_back();\n            }\n            else\n                break;\n        }\n        if ((id.empty()) || (lst[id.back()] < min(a[i], b[i]))) {\n            res.push_back(v[i]);\n            id.push_back(i);\n        }\n    }\n    for (int i = 0; i < res.size(); ++i) {\n        cout << res[i];\n    }\n    cout << endl;\n\n}\n\n//#define LOCAL\n\nint main() {\n    ios_base::sync_with_stdio(0);\n#ifdef LOCAL\n    freopen(\"input.txt\", \"r\", stdin);\n    //freopen(\"output.txt\", \"w\", stdout);\n#endif\n    solve();\n\n\n#ifdef LOCAL\n    cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \" s.\\n\";\n#endif\t\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define fo(a,b,c) for (a=b; a<=c; a++)\n#define fd(a,b,c) for (a=b; a>=c; a--)\n#define min(a,b) (a<b?a:b)\n#define ll long long\n//#define file\nusing namespace std;\n\nstruct type{\n\tchar a[6001];\n\tint n;\n\tvoid add(char ch) {a[++n]=ch;}\n} ans,s,Ans;\nint a[6001][3],c[6001][2],n,i,j,k,l,sum,tot,s1,s2;\nchar st[6001];\nbool bz;\n\nbool pd(type a,type b)\n{\n\tint i;\n\t\n\tfo(i,1,min(a.n,b.n))\n\tif (a.a[a.n-i+1]!=b.a[b.n-i+1])\n\treturn a.a[a.n-i+1]<b.a[b.n-i+1];\n\treturn a.n<b.n;\n}\n\nint main()\n{\n\t#ifdef file\n\tfreopen(\"agc026e.in\",\"r\",stdin);\n\t#endif\n\t\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",st+1);\n\t\n\tfo(i,1,n+n)\n\t{\n\t\tif (!sum)\n\t\t{\n\t\t\t++tot;\n\t\t\ta[tot][0]=i;\n\t\t\ta[tot][2]=st[i]=='b';\n\t\t}\n\t\tsum+=(st[i]=='a')?1:-1;\n\t\tif (!sum) a[tot][1]=i;\n\t}\n\t\n\tfd(l,tot,1)\n\tif (!a[l][2])\n\t{\n\t\tif (!bz)\n\t\t{\n\t\t\ts1=s2=0;\n\t\t\tfo(i,a[l][0],a[l][1])\n\t\t\t{\n\t\t\t\tif (st[i]=='a')\n\t\t\t\t++s1,c[s1][0]=i;\n\t\t\t\telse\n\t\t\t\t++s2,c[s2][1]=i;\n\t\t\t}\n\t\t\t\n\t\t\tk=(a[l][1]-a[l][0]+1)/2,j=0;\n\t\t\tfo(i,1,k)\n\t\t\tif (j<c[i][0])\n\t\t\tans.add('b'),ans.add('a'),j=c[i][1];\n\t\t}\n\t}\n\telse\n\t{\n\t\tbz=1;Ans=ans;\n\t\tfd(i,(a[l][1]-a[l][0]+1)/2,0)\n\t\t{\n\t\t\ts=ans;\n\t\t\ts1=s2=0;\n\t\t\tfd(j,a[l][1],a[l][0])\n\t\t\t{\n\t\t\t\tif (st[j]=='a')\n\t\t\t\t{++s1;if (s1<=i) s.add('a');}\n\t\t\t\telse\n\t\t\t\t{++s2;if (s2<=i) s.add('b');}\n\t\t\t}\n\t\t\tif (pd(Ans,s)) Ans=s;\n\t\t}\n\t\tans=Ans;\n\t}\n\t\n\tfd(i,ans.n,1) putchar(ans.a[i]);\n\tputchar('\\n');\n\t\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n    _____\n  .'     '.\n /  0   0  \\\n|     ^     |\n|  \\     /  |\n \\  '---'  /\n  '._____.'\n*/\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\nstruct chash\n{\n\tint operator()(int x) const\n\t{\n\t\tx ^= (x >> 20) ^ (x >> 12);\n\t\treturn x ^ (x >> 7) ^ (x >> 4);\n\t}\n};\n\ntemplate<typename T> using ordered_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename U> using hashtable = gp_hash_table<T, U, chash>;\nrandom_device(rd);\nmt19937 rng(rd());\n\ntemplate<class T>\nvoid readi(T &x)\n{\n\tT input = 0;\n\tbool negative = false;\n\tchar c = ' ';\n\twhile (c < '-')\n\t{\n\t\tc = getchar();\n\t}\n\tif (c == '-')\n\t{\n\t\tnegative = true;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0')\n\t{\n\t\tinput = input * 10 + (c - '0');\n\t\tc = getchar();\n\t}\n\tif (negative)\n\t{\n\t\tinput = -input;\n\t}\n\tx = input;\n}\ntemplate<class T>\nvoid printi(T output)\n{\n\tif (output == 0)\n\t{\n\t\tputchar('0');\n\t\treturn;\n\t}\n\tif (output < 0)\n\t{\n\t\tputchar('-');\n\t\toutput = -output;\n\t}\n\tint aout[20];\n\tint ilen = 0;\n\twhile(output)\n\t{\n\t\taout[ilen] = ((output % 10));\n\t\toutput /= 10;\n\t\tilen++;\n\t}\n\tfor (int i = ilen - 1; i >= 0; i--)\n\t{\n\t\tputchar(aout[i] + '0');\n\t}\n\treturn;\n}\ntemplate<class T>\nvoid ckmin(T &a, T b)\n{\n\ta = min(a, b);\n}\ntemplate<class T>\nvoid ckmax(T &a, T b)\n{\n\ta = max(a, b);\n}\ntemplate<class T, class U>\nT nmod(T &x, U mod)\n{\n\tif (x >= mod) x -= mod;\n}\ntemplate<class T>\nT randomize(T mod)\n{\n\treturn (uniform_int_distribution<T>(0, mod - 1))(rng);\n}\n\n#define y0 ___y0\n#define y1 ___y1\n#define MP make_pair\n#define MT make_tuple\n#define PB push_back\n#define PF push_front\n#define LB lower_bound\n#define UB upper_bound\n#define fi first\n#define se second\n#define debug(x) cerr << #x << \" = \" << x << endl;\n\nconst long double PI = 4.0 * atan(1.0);\nconst long double EPS = 1e-10;\n\n#define MAGIC 347\n#define SINF 10007\n#define CO 1000007\n#define INF 1000000007\n#define BIG 1000000931\n#define LARGE 1696969696967ll\n#define GIANT 2564008813937411ll\n#define LLINF 2696969696969696969ll\n#define MAXN 6013\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ld, ld> pdd;\n\nint N, K;\nint arr[MAXN], pref[MAXN];\nint blocks[MAXN];\nint partner[MAXN];\nbitset<MAXN> typ;\nvector<pii> idx[MAXN];\nvector<bool> dp[MAXN];\nvector<bool> ans;\nbitset<MAXN> flag;\n\nbool operator < (const vector<bool> &a, const vector<bool> &b)\n{\n\tfor (int i = 0; i < min(a.size(), b.size()); i++)\n\t{\n\t\tif (a[i] != b[i])\n\t\t{\n\t\t\treturn a[i] < b[i];\n\t\t}\n\t}\n\treturn (a.size() < b.size());\n}\nbool operator > (const vector<bool> &a, const vector<bool> &b)\n{\n\treturn b < a;\n}\n\nint32_t main()\n{\n\tios_base::sync_with_stdio(0);\n\t// cout << fixed << setprecision(10);\n\t// cerr << fixed << setprecision(10);\n\t// freopen (\"file.in\", \"r\", stdin);\n\t// freopen (\"file.out\", \"w\", stdout);\n\tcin >> N;\n\tN *= 2;\n\tstring temps;\n\tcin >> temps;\n\tfor (int i = 0; i < N; i++)\n\t{\n\t\tarr[i] = (temps[i] == 'a' ? 1 : -1);\n\t\tpref[i + 1] = pref[i] + arr[i];\n\t}\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tif (pref[i] == 0)\n\t\t{\n\t\t\tK++;\n\t\t\tblocks[K] = i - 1;\n\t\t}\n\t}\n\tblocks[0] = -1;\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tidx[i].resize((rt - lt + 1) / 2);\n\t\tint iter = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == 1)\n\t\t\t{\n\t\t\t\tidx[i][iter].fi = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\titer = 0;\n\t\tfor (int j = lt; j <= rt; j++)\n\t\t{\n\t\t\tif (arr[j] == -1)\n\t\t\t{\n\t\t\t\tidx[i][iter].se = j;\n\t\t\t\titer++;\n\t\t\t}\n\t\t}\n\t\t// cerr << \"block \" << i << endl;\n\t\tfor (pii p : idx[i])\n\t\t{\n\t\t\tpartner[p.fi] = p.se;\n\t\t\tpartner[p.se] = p.fi;\n\t\t\t// cerr << p.fi << ' ' << p.se << endl;\n\t\t}\n\t\ttyp[i] = (bool) (idx[i][0].fi > idx[i][0].se);\n\t}\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t//if typ[i] is true, it's abababababab\n\t\t//if typ[i] is false, it's babababababa\n\t\tint lt = blocks[i - 1] + 1, rt = blocks[i];\n\t\tif (typ[i])\n\t\t{\n\t\t\t//babababa\n\t\t\tvector<bool> temp;\n\t\t\tfor (int j = idx[i].size() - 1; j >= 0; j--)\n\t\t\t{\n\t\t\t\tflag[idx[i][j].fi] = true;\n\t\t\t\tflag[idx[i][j].se] = true;\n\t\t\t\ttemp.clear();\n\t\t\t\tfor (int k = lt; k <= rt; k++)\n\t\t\t\t{\n\t\t\t\t\tif (flag[k])\n\t\t\t\t\t{\n\t\t\t\t\t\ttemp.PB(arr[k] - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (temp > dp[i])\n\t\t\t\t{\n\t\t\t\t\tdp[i] = temp;\n\t\t\t\t}\n\t\t\t\t// for (bool b : dp[i])\n\t\t\t\t// {\n\t\t\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t\t\t// }\n\t\t\t\t// cerr << endl;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//ababababab\n\t\t\tfor (int j = lt; j <= rt; j = partner[j] + 1)\n\t\t\t{\n\t\t\t\tdp[i].PB(0);\n\t\t\t\tdp[i].PB(1);\n\t\t\t}\n\t\t}\n\t}\n\t// cerr << \"our dps\\n\";\n\tfor (int i = 1; i <= K; i++)\n\t{\n\t\t// for (bool b : dp[i])\n\t\t// {\n\t\t// \tcerr << (b ? 'b' : 'a');\n\t\t// }\n\t\t// cerr << endl;\n\t\tbool used = true;\n\t\tfor (int j = i + 1; j <= K; j++)\n\t\t{\n\t\t\tif (dp[j] > dp[i])\n\t\t\t{\n\t\t\t\tused = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (used)\n\t\t{\n\t\t\tfor (bool b : dp[i])\n\t\t\t{\n\t\t\t\tans.PB(b);\n\t\t\t}\n\t\t}\n\t}\n\tfor (bool b : ans)\n\t{\n\t\tcout << (b ? 'b' : 'a');\n\t}\n\tcout << '\\n';\n\t// cerr << \"time elapsed = \" << (clock() / (CLOCKS_PER_SEC / 1000)) << \" ms\" << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "    #include<bits/stdc++.h>\n    using namespace std;\n    #define vi vector<int>\n    #define pii pair<int,int>\n    #define vp  vector<pii>\n    #define fi first\n    #define se second\n    #define mp make_pair\n    #define pb push_back\n    #define ls l,mid,rt<<1\n    #define rs mid+1,r,rt<<1|1\n    #define de(x) cout<< #x<<\" = \"<<x<<endl\n    #define dd(x) cout<< #x<<\" = \"<<x<<\" \"\n    #define sf scanf\n    #define pf printf\n    #define all(x) (x).begin(),(x).end()\n    #define SZ(x) ((int)(x).size())\n    #define rep(i,a,n) for (int i=a;i<n;i++)\n    #define per(i,a,n) for (int i=n-1;i>=a;i--)\n    typedef long long ll;\n    typedef unsigned long long ull;\n    //typedef __int128 INT128;\n    //INT128 read(){\n    //    INT128 x=0,f=1;\n    //    char ch=getchar();\n    //    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    //    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n    //    return x*f;\n    //}\n    //void write(INT128 x){\n    //    if(x<0){putchar('-');x=-x;}\n    //    if(x<10){putchar(x+'0'); return;}\n    //    write(x/10);putchar(x%10+'0');\n    //}\n    typedef long double ld;\n    const int INF=0x3f3f3f3f;\n    const double eps=1e-8;\n    const double PI=acos(-1.0);\n    const int MAXN=1e5+5;\n    const int MAXM=2e6+5;\n    const int MOD=1e9+7;\n    int sgn(double x){if(fabs(x)<eps)return 0;if(x<0)return -1;else return 1;}\n    ll pw(ll a,ll n,ll mod){ll ret=1;while(n){if(n&1)ret=ret*a%mod;a=a*a%mod;n>>=1;}return ret;}\n    ll gcd(ll a,ll b){return b==0?a:gcd(b,a%b);}\n    ll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n    void inc(ll &a,ll b){a+=b;if(a>=MOD)a-=MOD;}\n    void dec(ll &a,ll b){a-=b;if(a<0)a+=MOD;}\n    int mul(int x, int y){ll z=1ll*x*y;return z-z/MOD*MOD;}\n    //head\n     \n    int n,ta,tb,pos_a[MAXN],pos_b[MAXN],pos[MAXN];\n    string s,ans,dp[MAXN];\n    int main(){\n        cin>>n>>s; ta=tb=0;\n        rep(i,0,2*n){\n            if(s[i]=='a')pos_a[++ta]=i,pos[i]=ta;\n            else pos_b[++tb]=i,pos[i]=tb;\n        }\n        per(i,1,n+1){\n            if(pos_a[i]<pos_b[i]){\n                int k=i;\n                rep(j,pos_a[i]+1,pos_b[i])k=max(k,pos[j]);\n                dp[i]=\"ab\"+dp[k+1];\n            }else{\n                int k=i;\n                while(k<n&&pos_b[k+1]<pos_a[k])k++;\n                rep(j,pos_b[i],2*n)if(pos[j]>=i&&pos[j]<=k)dp[i]+=s[j];\n                //de(k);\n                dp[i]+=dp[k+1];\n            }\n            //dd(i); de(dp[i]);\n            dp[i]=max(dp[i],dp[i+1]);\n            ans=max(ans,dp[i]);\n        }\n        cout<<ans<<endl;\n    }"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n//#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[2 * N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    For(i, 0, b.size()){\n        c.pb(b[i]);\n        For(j, 0, i){\n            if (c[j] + b[i] > c[i]){\n                c[i] = c[j] + b[i];\n            }\n        }\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\ntypedef long long LL;\nusing namespace std;\nconst int N = 1e3 + 5;\n\nchar seq[N * 2];\nint locAll[N * 2];\nint locA[N];\nint locB[N];\nint dp[N][N];\nint n;\nstring toString(int num[]) {\n    string tmp;\n    for(int i = 1; i <= 2*n; ++i) {\n        if(num[locAll[i]]) \n            tmp += seq[i];\n    }\n    return tmp;\n}\n\nint main() {\n    while(~scanf(\"%d\", &n)) {\n        memset(dp, 0, sizeof(dp));\n        scanf(\"%s\", seq + 1);\n        for(int i = 1, cntA = 0, cntB = 0; i <= 2*n; ++i) {\n            if(seq[i] == 'a') {\n                locA[++cntA] = i;\n                locAll[i] = cntA;\n            } else {\n                locB[++cntB] = i;\n                locAll[i] = cntB;\n            }\n        }\n        dp[n][n] = 1;\n\n        for(int i = n-1; i >= 1; --i) {\n            dp[i][i] = 1;\n            if(locA[i] < locB[i]) {\n                int Max = 0;\n                for(int j = locA[i]; j <= locB[i]; ++j) {\n                    if(locAll[j] < i)\n                        continue;\n                    Max = max(Max, locAll[j]);\n                }\n                for(int j = locB[i]+1; j <= 2*n; ++j) {\n                    if(locAll[j] > Max)\n                        dp[i][locAll[j]] = dp[Max + 1][locAll[j]];\n                }\n            } else {\n                int tot = 0, Max = 0;\n                for(int j = locB[i]; j <= locA[i]; ++j) {\n                    if(locAll[j] < i)\n                        continue;\n                    if(locAll[j] != i) tot ++;\n                    Max = max(Max, locAll[j]);\n                    dp[i][locAll[j]] = 1;\n                }    \n\n                for(int j = locA[i]+1; j <= 2*n; ++j) {\n                    if(seq[j] == 'b') {\n                        if(tot == 0) {\n                            dp[i][locAll[j]] = dp[Max+1][locAll[j]];\n                        } else {\n                            dp[i][locAll[j]] = 1;\n                            tot ++;\n                        }\n                    } else {\n                        if(tot == 0) {\n                            dp[i][locAll[j]] = dp[Max+1][locAll[j]];\n                        } else {\n                            dp[i][locAll[j]] = 1;\n                            Max = max(Max, locAll[j]);\n                            tot --;\n                        }\n                    }\n                }\n                \n            }\n            if(toString(dp[i]) < toString(dp[i + 1])) {\n                memcpy(dp[i], dp[i + 1], sizeof(dp[i + 1]));\n            }\n        }\n\n        printf(\"%s\\n\", toString(dp[1]).c_str());\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nchar s[6005];\nint num[6005];\nint pa[3005],tot;\nint pb[3005];\nstruct str{\n\tchar v[6005];\n\tint l;\n\tvoid pb(char x){\n\t\tv[l++]=x;\n\t\tv[l]=0;\n\t}\n\tstr operator +(str b){\n\t\tstr c=*this;\n\t\tfor(int i=0;i<=b.l;i++)c.v[l+i]=b.v[i];\n\t\tc.l=l+b.l;\n\t\treturn c;\n\t}\n\tbool operator >(str b){\n\t\tfor(int i=0;i<=min(l,b.l);i++)if(v[i]!=b.v[i])return v[i]>b.v[i];\n\t\treturn false;\n\t}\n};\nstr f[3005];\nstr v[3005];\nint t[3005];\nint main(){\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++)if(s[i]=='a')pa[++tot]=i,num[i]=tot;\n\ttot=0;\n\tbool ok=0;\n\tfor(int i=1;i<=2*n;i++)if(s[i]=='b'){\n\t\tpb[++tot]=i;\n\t\tnum[i]=tot;\n\t\tif(pa[tot]>i)ok=1;\n\t}\n\tpa[n+1]=2*n+2;pb[n+1]=2*n+1;\n\tif(ok){\n\t\tfor(int i=1;i<=n;i++)if(pa[i]>pb[i]){\n\t\t\tint cnt=1,j=pb[i];\n\t\t\tv[i].pb(s[j]);\n\t\t\twhile(cnt!=0){\n\t\t\t\tj++;\n\t\t\t\twhile(s[j]=='a'&&num[j]<i)j++;\n\t\t\t\tif(s[j]=='a')cnt--;\n\t\t\t\telse cnt++;\n\t\t\t\tv[i].pb(s[j]);\n\t\t\t}\n\t\t\tt[i]=j;\n\t\t\t/*\n\t\t\tprintf(\"%d\\n\",v[i].l);\n\t\t\tputs(v[i].v);\n\t\t\t*/\n\t\t}\n\t\tfor(int i=n;i>=1;i--){\n\t\t\tf[i]=f[i+1];\n\t\t\tif(pa[i]>pb[i])\n\t\t\tfor(int j=i+1;j<=n+1;j++)if(pa[j]>pb[j]){\n\t\t\t\tif(pb[j]>t[i]){\n\t\t\t\t\t// printf(\"%d %d\\n\",i,j);\n\t\t\t\t\tif(v[i]+f[j]>f[i])f[i]=v[i]+f[j];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// printf(\"%d\\n\",f[i].l);\n\t\t\t// puts(f[i].v);\n\t\t}\n\t\tputs(f[1].v);\n\t}else{\n\t\tprintf(\"ab\");\n\t\tfor(int i=1,p=pb[1];i<=n;i++)if(pa[i]>p){p=pb[i]; printf(\"ab\");}\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#ifndef LOCAL\n#pragma GCC optimize (\"O3\")\n#endif\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define sim template < class c\n#define ris return * this\n#define dor > debug & operator <<\n#define eni(x) sim > typename \\\nenable_if<sizeof dud<c>(0) x 1, debug&>::type operator<<(c i) {\nsim > struct rge { c b, e; };\nsim > rge<c> range(c i, c j) { return {i, j}; }\nsim > auto dud(c* x) -> decltype(cerr << *x, 0);\nsim > char dud(...);\nstruct debug {\n#ifdef LOCAL\n~debug() { cerr << endl; }\neni(!=) cerr << boolalpha << i; ris; }\neni(==) ris << range(begin(i), end(i)); }\nsim, class b dor(pair < b, c > d) {\n  ris << \"(\" << d.first << \", \" << d.second << \")\";\n}\nsim dor(rge<c> d) {\n  *this << \"[\";\n  for (c it = d.b; it != d.e; ++it)\n    *this << \", \" + 2 * (it == d.b) << *it;\n  ris << \"]\";\n}\n#else\nsim dor(const c&) { ris; }\n#endif\n};\n#define imie(x...) \" [\" #x \": \" << (x) << \"] \"\n\nusing ld = long double;\nusing ll = long long;\n\nconstexpr int mod = 1000 * 1000 * 1000 + 7;\nconstexpr int odw2 = (mod + 1) / 2;\n\nvoid OdejmijOd(int& a, int b) { a -= b; if (a < 0) a += mod; }\nint Odejmij(int a, int b) { OdejmijOd(a, b); return a; }\nvoid DodajDo(int& a, int b) { a += b; if (a >= mod) a -= mod; }\nint Dodaj(int a, int b) { DodajDo(a, b); return a; }\nint Mnoz(int a, int b) { return (ll) a * b % mod; }\nvoid MnozDo(int& a, int b) { a = Mnoz(a, b); }\nint Pot(int a, int b) { int res = 1; while (b) { if (b % 2 == 1) MnozDo(res, a); a = Mnoz(a, a); b /= 2; } return res; }\nint Odw(int a) { return Pot(a, mod - 2); }\nvoid PodzielDo(int& a, int b) { MnozDo(a, Odw(b)); }\nint Podziel(int a, int b) { return Mnoz(a, Odw(b)); }\nint Moduluj(ll x) { x %= mod; if (x < 0) x += mod; return x; }\n\ntemplate <typename T> T Maxi(T& a, T b) { return a = max(a, b); }\ntemplate <typename T> T Mini(T& a, T b) { return a = min(a, b); }\n\nint main() {\n  ios_base::sync_with_stdio(0);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> parts;\n  int bal = 0;\n  string last_part;\n  for (char c : s) {\n    if (c == 'a') bal++;\n    else if (c == 'b') bal--;\n    else assert(false);\n    last_part.push_back(c);\n    if (bal == 0) {\n      parts.push_back(last_part);\n      last_part.clear();\n    }\n  }\n  assert(last_part.empty());\n  debug() << imie(parts);\n\n  for (string& p : parts) {\n    assert((int) p.size() % 2 == 0);\n    string res;\n    if (p[0] == 'a') {\n      vector<pair<int, int>> v;\n      for (int i = 0; i < (int) p.size(); i++) {\n        if (p[i] == 'a') {\n          p[i] = 'o';\n          for (int j = i + 1; j < (int) p.size(); j++) {\n            if (p[j] == 'b') {\n              p[j] = 'o';\n              v.emplace_back(i, j);\n              break;\n            }\n          }\n        }\n      }\n      int cnt = 0;\n      int last_b = -1;\n      for (auto& q : v) {\n        if (last_b < q.first) {\n          cnt++;\n          last_b = q.second;\n        }\n      }\n      while (cnt--) {\n        res += \"ab\";\n      }\n    } else {\n      for (int i = 0; i < (int) p.size() / 2; i++) {\n        string st;\n        int zost[2] = {i, i};\n        for (char c : p) {\n          int idx = 0;\n          if (c == 'b') idx = 1;\n          if (zost[idx] > 0) {\n            zost[idx]--;\n          } else {\n            st.push_back(c);\n          }\n        }\n        Maxi(res, st);\n      }\n    }\n    swap(res, p);\n  }\n  debug() << imie(parts);\n  string wyn;\n  for (int i = (int) parts.size() - 1; i >= 0; i--) {\n    if (parts[i] + wyn > wyn) {\n      wyn = parts[i] + wyn;\n    }\n  }\n  cout << wyn << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\nMain AC Solution, O(N)\n*/\n\n//#define _GLIBCXX_DEBUG\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing uint = unsigned int;\nusing ll = long long;\nusing ull = unsigned long long;\nconstexpr ll TEN(int n) { return (n==0) ? 1 : 10*TEN(n-1); }\ntemplate<class T> using V = vector<T>;\ntemplate<class T> using VV = V<V<T>>;\n\nconst int MN = 5*TEN(5);\n\nstring input() {\n    int n;\n    assert(scanf(\"%d\", &n));\n    static char buf[2*MN + 10];\n    assert(scanf(\"%s\", buf));\n    return string(buf);\n}\n\nV<string> split(string s) {\n    int n = int(s.size());\n    V<int> idxs;\n    int he = 0;\n    for (int i = 0; i < n; i++) {\n        if (s[i] == 'a') he++;\n        else he--;\n        if (he == 0) idxs.push_back(i+1);\n    }\n    V<string> res;\n    int bk = 0;\n    for (auto d: idxs) {\n        res.push_back(s.substr(bk, d-bk));\n        bk = d;\n    }\n//    cerr << \"SPLITTED: \" << res.size() << endl;\n    return res;\n}\n\nmt19937 gen;\nvoid reseed(ll seed) {\n    gen = mt19937(seed);\n    for (int i = 0; i < 10000; i++) {\n        gen(); // skip\n    }\n}\n\nll rand_int(ll l, ll r) { //[l, r]\n    using D = uniform_int_distribution<ll>;\n    assert(l <= r);\n    return D(l, r)(gen);\n}\n\nstring rand_lower_string(int n, int up = 26) {\n    string s = \"\";\n    for (int i = 0; i < n; i++) {\n        s += 'a' + rand_int(0, up-1);\n    }\n    return s;\n}\n\ntemplate<class T> void myshuffle(T &v) {\n    shuffle(begin(v), end(v), gen);\n}\n\nstring to_non_neg(string s) {\n    string t;\n    bool neg = false;\n    int he = 0;\n    for (char c: s) {        \n        if (neg) {\n            if (c == 'a') c = 'b';\n            else c = 'a';\n        }\n        if (he == 0 && c == 'a') {\n            c = 'b';\n            neg = !neg;\n        }\n        if (c == 'b') he++;\n        else he--;\n        t += c;\n    }\n    return t;\n}\n\nstring rand_ab(int n) {\n    string s = string(n-1, 'a') + string(n-1, 'b');\n    myshuffle(s);\n    s = to_non_neg(s);\n    reverse(begin(s), end(s));\n    return \"a\" + s + \"b\";\n}\n\nstring rand_ba(int n) {\n    string s = string(n-1, 'a') + string(n-1, 'b');\n    myshuffle(s);\n    s = to_non_neg(s);\n    return \"b\" + s + \"a\";\n}\n\n\ntemplate<class Str>\nstruct SA {\n    Str s;\n    V<int> sa, rsa, lcp;\n    SA() {}\n    SA(Str _s, V<int> _sa) : s(_s), sa(_sa) {\n        int n = int(s.size());\n        // make rsa\n        rsa = V<int>(n + 1);\n        for (int i = 0; i <= n; i++) {\n            rsa[sa[i]] = i;\n        }\n        // make lcp\n        lcp = V<int>(n);\n        int h = 0;\n        for (int i = 0; i < n; i++) {\n            int j = sa[rsa[i] - 1];\n            if (h > 0) h--;\n            for (; j + h < n && i + h < n; h++) {\n                if (s[j + h] != s[i + h]) break;\n            }\n            lcp[rsa[i] - 1] = h;\n        }\n    }\n};\n\ntemplate<class Str>\nV<int> doublingSA(Str s) {\n    int n = (int)s.size();\n    V<int> sa(n + 1);\n    V<int> rsa(n + 1);\n    iota(begin(sa), end(sa), 0);\n    for (int i = 0; i <= n; i++) {\n        rsa[i] = i < n ? s[i] : -1;\n    }\n    vector<int> tmp(n + 1);\n    for (int k = 1; k <= n; k *= 2) {\n        auto cmp = [&](int x, int y) {\n            if (rsa[x] != rsa[y]) return rsa[x] < rsa[y];\n            int rx = x + k <= n ? rsa[x + k] : -1;\n            int ry = y + k <= n ? rsa[y + k] : -1;\n            return rx < ry;\n        };\n        sort(begin(sa), end(sa), cmp);\n        tmp[sa[0]] = 0;\n        for (int i = 1; i <= n; i++) {\n            tmp[sa[i]] = tmp[sa[i - 1]] + (cmp(sa[i - 1], sa[i]) ? 1 : 0);\n        }\n        copy(begin(tmp), end(tmp), begin(rsa));\n    }\n    return sa;\n}\n\nstring solve(string s) {\n    int n = int(s.size()) / 2; assert(s.size() % 2 == 0);\n    \n    V<int> aidx(n), bidx(n);\n    {\n        int ac = 0, bc = 0;\n        for (int i = 0; i < 2*n; i++) {\n            if (s[i] == 'a') {\n                aidx[ac++] = i;\n            } else {\n                bidx[bc++] = i;\n            }\n        }\n    }\n\n    if (s[0] == 'a') {\n        string ans;\n        int idx = 0;\n        while (idx < n) {\n            ans += \"ab\";\n            int pos = bidx[idx];\n            while (idx < n && aidx[idx] < pos) idx++;\n        }\n        return ans;\n    }\n\n    auto sa = SA<string>(s, doublingSA(s));\n\n    V<int> bc(2*n+1);\n    bc[0] = 0;\n    for (int i = 0; i < 2*n; i++) bc[i+1] = bc[i] + (s[i] == 'b' ? 1 : 0);\n\n    using P = pair<int, int>; // prefix b, sa\n    P ans = P(-1, -1);\n    for (int i = 0; i < n; i++) {\n        int l = bidx[i], r = aidx[i];\n        int bx = bc[r] - bc[l];\n        P res = P(bx, sa.rsa[r]);\n        ans = max(ans, res);\n    }\n    assert(ans.first >= 0);\n    return string(ans.first, 'b') + s.substr(sa.sa[ans.second]);\n}\n\n\nint main() {\n    string s = input();\n    auto v = split(s);\n\n    V<string> ans;\n    for (auto t: v) {\n        t = solve(t);\n        while (ans.size()) {\n            if (ans.back()[0] == 'a' && t[0] == 'a') break;\n            if (ans.back() >= t) break;\n            ans.pop_back();\n        }\n        ans.push_back(t);\n    }\n    string res;\n    for (auto t: ans) res += t;\n    cout << res << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\n\nint main() {\n  int n;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  vector<int> a, b;\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  vector<int> ba;\n  for (int i = 0; i < n; i++) {\n    if (a[i] > b[i]) {\n      ba.push_back(i);\n    }\n  }\n  int bacnt = ba.size();\n  a.push_back(INT_MAX); b.push_back(INT_MAX);\n  ba.push_back(n);\n  vector<string> best(bacnt + 1);\n  vector<int> best_end(bacnt + 1); // exclusive\n  for (int i = bacnt - 1; i >= 0; i--) {\n    string cur;\n    int ap = i, bp = i;\n    int last_insert = -1;\n    do {\n      if (a[ba[ap]] < b[ba[bp]]) {\n        cur.push_back('a');\n        last_insert = a[ba[ap]];\n        ap++;\n      }\n      else {\n        cur.push_back('b');\n        last_insert = b[ba[bp]];\n        bp++;\n      }\n    } while (ap != bp);\n    cur += best[ap];\n    if (cur > best[i + 1]) {\n      best_end[i] = max(last_insert + 1, best_end[ap]);\n      best[i] = cur;\n    }\n    else {\n      best_end[i] = best_end[i + 1];\n      best[i] = best[i + 1];\n    }\n  }\n  string ans = best[0];\n  int last_ind = -1;\n  for (int i = 0; i < n; i++) {\n    if (a[i] < best_end[0]) continue;\n    if (a[i] > b[i]) continue;\n    if (last_ind < a[i]) {\n      ans += \"ab\";\n      last_ind = b[i];\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n// #define int long long\n// #define double long double\n#define rep(i,n) for (int i=0; i<(int)(n); ++i)\n#define rep1(i,n) for (int i=1; i<(int)(n); ++i)\n#define repeq(i,n) for (int i=0; i<=(int)(n); ++i)\n#define rep1eq(i,n) for (int i=1; i<=(int)(n); ++i)\n#define rrep(i,n) for (int i=(int)(n)-1; i>=0; --i)\n#define rrep1(i,n) for (int i=(int)(n)-1; i>0; --i)\n#define rrepeq(i,n) for (int i=(int)(n); i>=0; --i)\n#define rrep1eq(i,n) for (int i=(int)(n); i>0; --i)\n#define REP(i,a,b) for (int i=(int)(a); i<=(int)(b); ++i)\n#define RREP(i,a,b) for (int i=(int)(a); i>=(int)(b); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\nusing ll = long long;\nusing vi = vector<int>;\nusing vl = vector<ll>;\nusing vb = vector<bool>;\ntemplate<typename T> using Graph = vector<vector<T>>;\ntemplate<typename T> using Spacial = vector<vector<vector<T>>>;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\ntemplate<typename T> using greater_priority_queue = priority_queue<T, vector<T>, greater<T>>;\nconst int MOD = 1e9+7;\nconst int MOD2 = 998244353;\n// const double EPS = 1e-9;\nconst int dx[4] = {1, 0, -1, 0};\nconst int dy[4] = {0, 1, 0, -1};\nstring interval[2] = {\" \", \"\\n\"}; // {\" \", \"\\n\"}\n\ntemplate<typename T> struct is_plural : false_type{};\ntemplate<typename T1, typename T2> struct is_plural<pair<T1, T2>> : true_type{};\ntemplate<typename T> struct is_plural<vector<T>> : true_type{};\ntemplate<typename T> struct is_plural<complex<T>> : true_type{};\n \ntemplate<typename T1, typename T2> istream &operator>>(istream &is, pair<T1, T2> &p) { return is >> p.first >> p.second; }\ntemplate<typename T1, typename T2> ostream &operator<<(ostream &os, const pair<T1, T2> &p) { return os << p.first << \" \" << p.second; }\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &vec) { for (auto itr = vec.begin(); itr != vec.end(); ++itr) is >> *itr; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, const vector<T> &vec) { if (vec.empty()) return os; bool pl = is_plural<T>(); os << vec.front(); for (auto itr = ++vec.begin(); itr != vec.end(); ++itr) os << interval[pl] << *itr; return os; }\n \nbool CoutYN(bool a, string y = \"Yes\", string n = \"No\") { cout << (a ? y : n) << \"\\n\"; return a; }\n\ntemplate<typename T1, typename T2> inline bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\ntemplate<typename T1, typename T2> inline bool chmin(T1 &a, T2 b) { return a > b && (a = b, true); }\n\nlong long modpow(int a, long long n, int mod = MOD) { long long ret = 1; do { if (n & 1) ret = ret * a % mod; a = 1LL * a * a % mod; } while (n >>= 1); return ret; }\n\ntemplate<typename T> T GCD(T a, T b) { return b ? GCD(b, a%b) : a; }\ntemplate<typename T> T LCM(T a, T b) { return a / GCD(a, b) * b; }\n\ntemplate<typename T1, typename T2> bool CompareBySecond(pair<T1, T2> a, pair<T1, T2> b) { return a.second != b.second ? a.second < b.second : a.first < b.first; }\ntemplate<typename T1, typename T2> bool CompareByInverse(pair<T1, T2> a, pair<T1, T2> b) { return a.first != b.first ? a.first < b.first : a.second > b.second; }\n\n\n/* -------- <templates end> -------- */\n\n\nvoid solve() {\n  int n; cin >> n;\n  string s; cin >> s;\n\n  Graph<int> pos(2);\n  rep(i,2*n) pos[s[i] - 'a'].emplace_back(i);\n\n  int last = n;\n  while (last-- > 0 && pos[0][last] < pos[1][last]);\n\n  vector<string> dp(last + 1);\n  int suffix = 0;\n  int idx = -1;\n\n  while (++last < n) {\n    if (idx < pos[0][last]) {\n      ++suffix;\n      idx = pos[1][last];\n    }\n  }\n\n  last = dp.size();\n  string MAX;\n  queue<int> nxt;\n\n  rrep(i,last) {\n    if (pos[0][i] < pos[1][i]) {\n      dp[i] = MAX;\n      continue;\n    }\n\n    nxt.emplace(pos[0][i]);\n    dp[i].push_back('b');\n\n    REP(j,i+1,last-1) {\n      while (!nxt.empty() && nxt.front() < pos[1][j]) {\n        nxt.pop();\n        dp[i].push_back('a');\n      }\n\n      if (nxt.empty()) {\n        dp[i] += dp[j];\n        break;\n      }\n\n      dp[i].push_back('b');\n      nxt.emplace(pos[0][j]);\n    }\n\n    while (!nxt.empty()) {\n      nxt.pop();\n      dp[i].push_back('a');\n    }\n\n    chmax(MAX, dp[i]);\n  }\n\n  cout << MAX;\n  while (suffix--) cout << \"ab\";\n}\n\n\n/* -------- <programs end> -------- */\n\n\nsigned main() {\n  cin.tie(nullptr);\n  ios::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  solve();\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint n;\nchar s[100100];\nint ap[100100],bp[100100];\nint ca,cb;\nstring f[3030];\nbool book[6060];\nint nxt[6060];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tn=strlen(s+1);\n\tfor(int i=1;i<=n;++i)\n\t\tif(s[i]=='a')ap[++ca]=i;\n\t\telse bp[++cb]=i;\n\tn/=2;\n\tfor(int i=1;i<=n;++i)nxt[min(ap[i],bp[i])]=i;\n\tfor(int i=n*2;i;--i)if(!nxt[i])nxt[i]=nxt[i+1];\n\tfor(int i=n;i;--i)\n\t{\n\t\tmemset(book,0,sizeof(book));\n\t\tbook[ap[i]]=book[bp[i]]=1;\n\t\tif(bp[i]<ap[i])\n\t\t{\n\t\t\tint mxa=ap[i];\n\t\t\tfor(int j=i+1;j<=n;++j)\n\t\t\t\tif(bp[j]<ap[j]&&bp[j]<mxa)\n\t\t\t\t{\n\t\t\t\t\tbook[ap[j]]=book[bp[j]]=1;\n\t\t\t\t\tmxa=max(mxa,ap[j]);\n\t\t\t\t}\n\t\t\tfor(int j=1;j<=n*2;++j)\n\t\t\t\tif(book[j])f[i]+=s[j];\n\t\t\tf[i]+=f[nxt[mxa+1]];\n\t\t}\n\t\telse f[i]=\"ab\"+f[nxt[bp[i]+1]];\n\t\tf[i]=max(f[i],f[i+1]);\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define pb push_back\nusing namespace std;\nconst int N = 3003;\nint n;\nstring S[N], MX[N];\nint main()\n{\n    cin >> n >> S[0];\n    for (int i = 1; i < n; i++)\n    {\n        int a = 0, b = 0;\n        for (int j = 0; j < (int)S[i - 1].size(); j++)\n        {\n            if (S[i - 1][j] == 'a') a ++;\n            if (S[i - 1][j] == 'b') b ++;\n            if (S[i - 1][j] == 'a' && a > 1) S[i] += 'a';\n            if (S[i - 1][j] == 'b' && b > 1) S[i] += 'b';\n        }\n    }\n    for (int i = n - 1; ~ i; i --)\n    {\n        int mb = -1;\n        for (int j = 0; j < n + n - i - i && !~mb; j++)\n            if (S[i][j] == 'b') mb = j;\n        MX[i] = MX[i + 1];\n        if (S[i][0] == 'a')\n            MX[i] = max(MX[i], \"ab\" + MX[i + mb]);\n        else\n        {\n            string str = \"\";\n            int a = 0, b = 0;\n            for (int j = 0; j < n + n - i - i; j++)\n            {\n                str += S[i][j];\n                if (S[i][j] == 'a') a ++;\n                if (S[i][j] == 'b') b ++;\n                if (a == b)\n                    MX[i] = max(MX[i], str + MX[i + 1 + (j >> 1)]);\n            }\n        }\n    }\n    return cout << MX[0], 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\n\nconst int N=3005;\n\nint n,occa[N],occb[N],pos[N*2];\nchar str[N*2];\nstd::string ans[N];\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint na=0,nb=0;\n\tfor (int i=1;i<=n*2;i++)\n\t\tif (str[i]=='a') occa[++na]=i,pos[i]=na;\n\t\telse occb[++nb]=i,pos[i]=nb;\n\tstd::string best;\n\tfor (int i=n;i>=1;i--)\n\t{\n\t\tif (occa[i]<occb[i])\n\t\t{\n\t\t\tint k=i;\n\t\t\tfor (int j=occa[i]+1;j<occb[i];j++) k=std::max(k,pos[j]);\n\t\t\tans[i]=\"ab\"+ans[k+1];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint k=i;\n\t\t\twhile (k<n&&occb[k+1]<occa[k]) k++;\n\t\t\tfor (int j=occb[i];j<=n*2;j++) if (pos[j]>=i&&pos[j]<=k) ans[i]+=str[j];\n\t\t\tans[i]+=ans[k+1];\n\t\t}\n\t\tans[i]=std::max(ans[i],ans[i+1]);\n\t\tbest=std::max(best,ans[i]);\n\t}\n\tprintf(\"%s\",best.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#ifndef LOCAL\n#pragma GCC optimize (\"O3\")\n#endif\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define sim template < class c\n#define ris return * this\n#define dor > debug & operator <<\n#define eni(x) sim > typename \\\nenable_if<sizeof dud<c>(0) x 1, debug&>::type operator<<(c i) {\nsim > struct rge { c b, e; };\nsim > rge<c> range(c i, c j) { return {i, j}; }\nsim > auto dud(c* x) -> decltype(cerr << *x, 0);\nsim > char dud(...);\nstruct debug {\n#ifdef LOCAL\n~debug() { cerr << endl; }\neni(!=) cerr << boolalpha << i; ris; }\neni(==) ris << range(begin(i), end(i)); }\nsim, class b dor(pair < b, c > d) {\n  ris << \"(\" << d.first << \", \" << d.second << \")\";\n}\nsim dor(rge<c> d) {\n  *this << \"[\";\n  for (c it = d.b; it != d.e; ++it)\n    *this << \", \" + 2 * (it == d.b) << *it;\n  ris << \"]\";\n}\n#else\nsim dor(const c&) { ris; }\n#endif\n};\n#define imie(x...) \" [\" #x \": \" << (x) << \"] \"\n\nusing ld = long double;\nusing ll = long long;\n\nconstexpr int mod = 1000 * 1000 * 1000 + 7;\nconstexpr int odw2 = (mod + 1) / 2;\n\nvoid OdejmijOd(int& a, int b) { a -= b; if (a < 0) a += mod; }\nint Odejmij(int a, int b) { OdejmijOd(a, b); return a; }\nvoid DodajDo(int& a, int b) { a += b; if (a >= mod) a -= mod; }\nint Dodaj(int a, int b) { DodajDo(a, b); return a; }\nint Mnoz(int a, int b) { return (ll) a * b % mod; }\nvoid MnozDo(int& a, int b) { a = Mnoz(a, b); }\nint Pot(int a, int b) { int res = 1; while (b) { if (b % 2 == 1) MnozDo(res, a); a = Mnoz(a, a); b /= 2; } return res; }\nint Odw(int a) { return Pot(a, mod - 2); }\nvoid PodzielDo(int& a, int b) { MnozDo(a, Odw(b)); }\nint Podziel(int a, int b) { return Mnoz(a, Odw(b)); }\nint Moduluj(ll x) { x %= mod; if (x < 0) x += mod; return x; }\n\ntemplate <typename T> T Maxi(T& a, T b) { return a = max(a, b); }\ntemplate <typename T> T Mini(T& a, T b) { return a = min(a, b); }\n\nint main() {\n  ios_base::sync_with_stdio(0);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> parts;\n  int bal = 0;\n  string last_part;\n  for (char c : s) {\n    if (c == 'a') bal++;\n    else if (c == 'b') bal--;\n    else assert(false);\n    last_part.push_back(c);\n    if (bal == 0) {\n      parts.push_back(last_part);\n      last_part.clear();\n    }\n  }\n  assert(last_part.empty());\n  debug() << imie(parts);\n\n  for (string& p : parts) {\n    assert((int) p.size() % 2 == 0);\n    string res;\n    if (p[0] == 'a') {\n      for (int i = 0; i < (int) p.size(); i++) {\n        if (p[i] == 'a') {\n          res.push_back('a');\n          res.push_back('b');\n          while (p[i] != 'b') i++;\n        }\n      }\n    } else {\n      for (int i = 0; i < (int) p.size() / 2; i++) {\n        string st;\n        int zost[2] = {i, i};\n        for (char c : p) {\n          int idx = 0;\n          if (c == 'b') idx = 1;\n          if (zost[idx] > 0) {\n            zost[idx]--;\n          } else {\n            st.push_back(c);\n          }\n        }\n        Maxi(res, st);\n      }\n    }\n    swap(res, p);\n  }\n  debug() << imie(parts);\n  string wyn;\n  for (int i = (int) parts.size() - 1; i >= 0; i--) {\n    if (parts[i] + wyn > wyn) {\n      wyn = parts[i] + wyn;\n    }\n  }\n  cout << wyn << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define MAXN 6010\nusing namespace std;\n\nint n,m;\nstring str;\nint p[MAXN][2],id[MAXN],cover[MAXN];\nstring f[MAXN],g[MAXN],s[MAXN];\n\nvoid init(){\n\tint na=0,nb=0;\n\tfor(int i=1;i<=m;i++){\n\t\tif(str[i]=='a') p[id[i]=++na][0]=i;\n\t\telse p[id[i]=++nb][1]=i;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(p[i][0]>p[i][1])\n\t\t\tswap(p[i][0],p[i][1]);\n\tfor(int i=1;i<=n;i++){\n\t\tif(str[p[i][0]]=='a'){\n\t\t\tfor(int j=i;j<=n && p[j][0]<=p[i][1];j++)\n\t\t\t\tcover[i]=j;\n\t\t}else{\n\t\t\tint cur=p[i][1];\n\t\t\tcover[i]=i;\n\t\t\tfor(int j=i+1;j<=n && p[j][0]<=cur;j++){\n\t\t\t\tcover[i]=j;\n\t\t\t\tcur=p[j][1];\n\t\t\t}\n\t\t\tfor(int j=p[i][0];j<=p[cover[i]][1];j++)\n\t\t\t\tif(id[j]>=i)\n\t\t\t\t\ts[i].push_back(str[j]);\n\t\t}\n\t}\n}\n\nvoid dp(){\n\tfor(int i=n;i>=1;i--){\n\t\tif(str[p[i][0]]=='a'){\n\t\t\tf[i]=\"ab\"+g[cover[i]+1];\n\t\t}else{\n\t\t\tf[i]=s[i]+g[cover[i]+1];\n\t\t}\n\t\tg[i]=max(f[i],g[i+1]);\n\t}\n}\n\nint main(){\n#ifdef DEBUG\n\tfreopen(\"C.in\",\"r\",stdin);\n#endif\n\tcin>>n;\n\tm=n<<1;\n\tcin>>str;\n\tstr=\" \"+str;\n\tinit();\n\tdp();\n\tcout<<g[1]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define ri register int\nconst int N=3e3+5;\nchar s[N<<1];\nstruct node{\n\tstring s;\n\tvector<int> v;\n\tinline bool operator <(const node &rhs)const{\n\t\treturn s<rhs.s; \n\t} \n}suf[N],f[N];\ninline node merge(node a,node b){\n\tri n=a.v.size(),m=b.v.size(),i,j;\n\tnode ans;\n\ti=j=0;\n\twhile(i<n&&j<m){\n\t\tif(a.v[i]<b.v[j])\n\t\t\tans.v.push_back(a.v[i]),\n\t\t\tans.s+=a.s[i],\n\t\t\t++i;\n\t\telse\n\t\t\tans.v.push_back(b.v[j]),\n\t\t\tans.s+=b.s[j],\n\t\t\t++j;\n\t}\n\twhile(i<n)\n\t\tans.v.push_back(a.v[i]),\n\t\tans.s+=a.s[i],\n\t\t++i;\n\twhile(j<m)\n\t\tans.v.push_back(b.v[j]),\n\t\tans.s+=b.s[j],\n\t\t++j;\n\treturn ans;\n}\nint posa[N],posb[N];\nint main(){\n\tri n,len,i,j,k,cnta,cntb;\n\tscanf(\"%d%s\",&n,s+1);\n\tcnta=cntb=0;\n\tlen=n<<1;\n\tfor(i=1;i<=len;++i)\n\t\tif(s[i]=='a')\n\t\t\tposa[++cnta]=i;\n\t\telse\n\t\t\tposb[++cntb]=i;\n\tfor(i=n;i;--i){\n\t\tif(posa[i]<posb[i]){\n\t\t\tfor(j=i+1;j<=n&&posa[j]<posb[i];++j);\n\t\t\tf[i].s=string(\"a\")+string(\"b\");\n\t\t\tf[i].v.push_back(posa[i]);\n\t\t\tf[i].v.push_back(posb[i]);\t\n\t\t}\n\t\telse{\n\t\t\tfor(j=i+1;j<=n&&posb[j]<posa[i];++j);\n\t\t\tfor(k=i;k^j;++k) f[i].s+='b',f[i].v.push_back(posb[k]);\n\t\t\tfor(k=i;k^j;++k) f[i].s+='a',f[i].v.push_back(posa[k]);\n\t\t}\n\t\tf[i]=merge(f[i],suf[j]);\n\t\tsuf[i]=max(suf[i+1],f[i]);\n\t}\n\tcout<<suf[1].s<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//実装が重そうな問題はある程度考えてから書く\n//初期化を忘れずに（特に二分探索とか）\n//コーナーケースを考えて（特に場合分けとか）\n//不可解すぎるバグは配列外参照（配列の長さ）を検討\n#include <bits/stdc++.h>\n#define YES \"YES\"\n#define NO \"NO\"\n#define YESNO OUT(three(solve(),YES,NO))\n#define ECHO OUT(solve())\n#define three(A,B,C) ((A)?(B):(C))\n#define FOR(i,a,b)  for(LL i=(a);i< (LL)(b);i++)\n#define EFOR(i,a,b) for(LL i=(a);i<=(LL)(b);i++)\n#define RFOR(i,a,b) for(LL i=(a);i>=(LL)(b);i--)\n#define REP(i,b) FOR(i,zero,b)\n#define EREP(i,b) EFOR(i,zero,b)\n#define RREP(i,b) RFOR(i,b,zero)\n#define ALL(c) c.begin(),c.end()\n#define UNIQUE(c) sort(ALL(c));c.erase(unique(ALL(c)),c.end())\n#define MAX(c) (*max_element(ALL(c)))\n#define MIN(c) (*min_element(ALL(c)))\n#define MP make_pair\n#define FI first\n#define SE second\n#define SI(x) (LL(x.size()))\n#define PB push_back\n#define DEBUG(a) OUT(a)\n#define DEBUG2(a,b) OUT2(a,b)\n#define cat cout << __LINE__ << endl\n#define OUT(a) cout << (a) << endl\n#define OUT2(a,b) cout << (a) <<\" \"<<(b) << endl\n#define int LL\n#define zero 0LL\nusing namespace std;\ntemplate<typename T> inline void maximize(T &a,T b){a=max(a,b);}\ntemplate<typename T> inline void minimize(T &a,T b){a=min(a,b);}\ntemplate<typename T> inline bool middle(T a,T b,T c){return b<=a && a<=c;}\ntemplate<class T> inline bool MX(T &l,const T &r){return l<r?l=r,1:0;}\ntemplate<class T> inline bool MN(T &l,const T &r){return l>r?l=r,1:0;}\ntypedef long long LL;\ntypedef double ld;\ntypedef LL ut;\ntypedef vector<ut> VI;\ntypedef vector<VI> VII;\ntypedef pair<ut,ut> pr;\ntypedef pair<ut,pr> ppr;\ntypedef vector<pr> Vpr;\ntypedef vector<ppr> Vppr;\ntypedef priority_queue<pr,Vpr,greater<pr> > PQ;\ninline void outputVI(VI x){REP(i,SI(x)){cout << three(i,\" \",\"\") << x[i];}OUT(\"\");}\nconst int SIZE1=5*1e5+1000;\nconst int SIZE2=5010;\nconst int SIZE3=400;\nconst int SIZE=6050;\nconst LL p=7+1e9;\nconst LL INF=1LL<<60;\nconst long double EPS=1e-7;\nstring s;\nut N,M,K,X,L,Y;\n// ut A,B,C,D,E,F,G,H,I,J,O,P,Q,R,T,U;\nVI edges[SIZE];\nLL vals[SIZE],nums[SIZE],maps[SIZE2][SIZE2],answer=zero;\n\n////////////////////////////////////////////////////////////////////////////////////////////\n\n////////////////////////////////////////////////////////////////////////////////////////////\nvoid init(){\n\t\n}\nint A[SIZE];\nstring DP[SIZE];\nint ind[SIZE];\nint B[SIZE];\nint ps(int x){\n\tif(s[x]=='a') return B[ind[x]];\n\telse return A[ind[x]];\n}\nvoid greedy(int now,string & ans,int& next){\n\tnext=now+2;\n\tif(ps(now)<now){\n\t\tnext=now+1;\n\t\treturn;\n\t}\n\tFOR(i,now,2*N){\n\t\tif(next==i) return;\n\t\tif(now<=ps(i) && ps(i)<i && s[i]=='a') ans+='a'; \n\t\tif(ps(i)<i) continue;\n\t\tif(s[i]=='a'){\n\t\t\tif(now==i) {\n\t\t\t\tans=\"ab\";\t\n\t\t\t\treturn;\n\t\t\t}\n\t\t//\tcout << now <<\" \" << next <<\" \" << i << endl;\n\t\t//\tcout <<\"OUT\" << endl;\n\t\t\tassert(0);\n\t\t}else{\n\t\t\tans+='b';\n\t\t\tnext=ps(i)+1;\n\t\t}\n\t}\n\t\n//\treturn ans;\n}\nstring solve2(int now){\n\tif(now==2*N) return \"\";\n\tif(DP[now]!=\"\") return DP[now];\n\tint next;\n\tstring ans;\n\tgreedy(now,ans,next);\n\treturn DP[now]=max(solve2(now+1),ans+solve2(next));\n}\nLL solve(){\n\tcin >> N;\n\tcin >> s;\n\tint a=0,b=0;\n\tREP(i,s.size()){\n\t\tif(s[i]=='a'){\n\t\t\tind[i]=a;\n\t\t\tA[a++]=i;\n\t\t}else{\n\t\t\tind[i]=b;\n\t\t\tB[b++]=i;\n\t\t}\n\t}\n\tcout << solve2(0) << endl;\n\treturn 0;\n}\nsigned main(){\n\tsolve();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main()\n{\n\tint N;\n\tcin>>N;\n\tstring s;\n\tcin>>s;\n\tfor(int i=0;i<2*N;i++)\n\t{\n\t\tif(s[i]=='a' && s[i+1]=='b')\n\t\t{\n\t\t\tcout<<\"a\"<<\"b\";\n\t\t}\n\t\tif(s[i]=='b' && s[i+1]=='a')\n\t\t{\n\t\t\tcout<<\"b\"<<\"a\";\n\t\t}\n\t}\n\treturn 0;\n } "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define forn(i, x, n) for (int i = int(x); i <= int(n); ++i)\n#define for1(i, n, x) for (int i = int(n); i >= int(x); --i)\n#define x first\n#define y second\n#define pb push_back\n\ntypedef long long ll;\ntypedef pair <int, int> pii;\ntypedef long double ld;\ntypedef vector <ll> vi;\n\nconst int N = 2e6 + 1;\nconst int INF = 1e9 + 9;\nconst int B = 1e9 + 7;\n\nint n, a[N];\nint bal[N];\nstring str[N], sx[N];\n\nint main() {\n    #ifdef black\n    freopen(\"in\", \"r\", stdin);\n    #endif // black\n    ios_base :: sync_with_stdio(0);\n    cin.tie(0);\n\n    cin >> n;\n    forn(i, 1, n * 2) {\n        char c;\n        cin >> c;\n        a[i] = c - 'a';\n    }\n\n    vi p, s;\n    int b = 0;\n    p.pb(1);\n    int lst = -1;\n    forn(i, 1, n * 2) {\n        bal[i] = bal[i - 1] + (a[i] ? 1 : -1);\n        if (bal[i] == 0) {\n            if (a[i] == 0) lst = s.size();\n            s.pb(a[i] ? -1 : 1);\n            p.pb(i + 1);\n        }\n    }\n\n    string ans;\n    forn(i, 0, p.size() - 2) {\n        if (s[i] == 1) {\n            string cans;\n            string cur;\n            for1(j, p[i + 1] - 1, p[i]) {\n                cur = string(1, 'a' + a[j]) + cur;\n                cans = max(cans, string(bal[j - 1], 'b') + cur);\n            }\n            str[i] = cans;\n        }\n        else {\n            int cnt = 0;\n            string cur;\n            forn(j, p[i], p[i + 1] - 1) {\n                if (cnt == 0 && a[j] == 0) cnt = 1;\n                if (cnt == 1 && a[j] == 1) {\n                    cur.pb('a'), cur.pb('b');\n                    cnt = 0;\n                }\n            }\n            str[i] = cur;\n            //    if (a[j] == 1 && a[j - 1] == 0)\n            //        ans.pb('a'), ans.pb('b');\n        }\n    }\n    for1(i, p.size() - 2, 0)\n        sx[i] = max(sx[i + 1], str[i]);\n    forn(i, 0, p.size() - 2)\n        if (str[i] == sx[i])\n            ans = ans + str[i];\n    cout << ans << \"\\n\";\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cstring>\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define FOR(i, a, b) for (int i = (a); i < (b); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define TRACE(x) cout << #x << \" = \" << x << endl\n#define _ << \" _ \" <<\n\ntypedef long long llint;\n\nconst int MAX = 6666;\n\nchar s[MAX];\nint w[MAX];\nstring f[MAX];\nstring g[MAX];\nint h[MAX];\nint bio[MAX];\nint cookie;\n\nint main(void) {\n  int N;\n  scanf(\"%d\", &N);\n  scanf(\"%s\", s);\n\n  vector<int> a, b;\n  REP(i, 2 * N) {\n    if (s[i] == 'a') {\n      w[i] = a.size();\n      a.push_back(i);\n    } else {\n      w[i] = b.size();\n      b.push_back(i);\n    }\n  }\n\n  REP(i, 2 * N) {\n    if (s[i] == 'b' && a[w[i]] > i) {\n      cookie++;\n\n      int e = i, j = i;\n      while (j <= e) {\n        if (s[j] == 'b' && a[w[j]] > j) {\n          if (a[w[j]] > j) {\n            bio[a[w[j]]] = cookie;\n            e = max(e, a[w[j]]);\n          }\n          g[i].push_back(s[j]);\n        } else if (bio[j] == cookie) {\n          g[i].push_back(s[j]);\n        }\n        j++;\n      }\n      h[i] = e;\n    }\n  }\n\n  f[N] = \"\";\n  for (int i = 2 * N - 1; i >= 0; --i) {\n    f[i] = f[i + 1];\n    if (s[i] == 'a') {\n      if (b[w[i]] > i) {\n        f[i] = max(f[i], \"ab\" + f[b[w[i]] + 1]);\n      }\n    } else {\n      if (a[w[i]] > i) {\n        f[i] = max(f[i], g[i] + f[h[i] + 1]);\n      }\n    }\n  }\n\n  puts(f[0].c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n// Shortcut\n\n//#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n\n// I/O & Debug\n\n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n\n// Functions\n\n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n\n// Data Structure\n\n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n\nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n\nint n;\nint a[N];\nstring s, ans;\nvs b, c;\n\nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    For(i, 0, b.size()){\n        c.pb(b[i]);\n        For(j, 0, i){\n            if (c[j] + b[i] > c[i]){\n                c[i] = c[j] + b[i];\n            }\n        }\n        if (c[i] > ans){\n            ans = c[i];\n        }\n    }\n    cout << ans;\n}\n\n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n\n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n\n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn];//,sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\n/*struct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n*/\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    for(LL i=1;i<=2000;++i) a[i]=(s[i]-'a');\n    return 0;\n    /*\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();*/\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <functional>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <memory>\n#include <thread>\n#include <tuple>\n\nusing namespace std;\n\nchar buff[6003];\n\nint main() {\n  int n;\n  vector<int> a, b;\n  scanf(\"%d\", &n);\n  scanf(\"%s\", buff);\n  for (int i = 0; i < 2 * n; i++) {\n    if (buff[i] == 'a') {\n      a.push_back(i);\n    }\n    else {\n      b.push_back(i);\n    }\n  }\n  string ans;\n  vector<int> bestind;\n  vector<string> bestsave(n + 1);\n  vector<vector<int>> bestsave_ind(n + 1);\n  for (int x = n; x >= 0; x--) {\n    if (ans < bestsave[x]) {\n      ans = move(bestsave[x]);\n      bestind = move(bestsave_ind[x]);\n    }\n    string cur = ans;\n    vector<int> ind = bestind;\n    int failcnt = 0;\n    for (int i = x - 1; i >= 0; i--) {\n      {\n        int p1 = lower_bound(ind.begin(), ind.end(), a[i]) - ind.begin();\n        ind.insert(ind.begin() + p1, a[i]);\n        cur.insert(cur.begin() + p1, 'a');\n      }\n      {\n        int p2 = lower_bound(ind.begin(), ind.end(), b[i]) - ind.begin();\n        ind.insert(ind.begin() + p2, b[i]);\n        cur.insert(cur.begin() + p2, 'b');\n      }\n      if (cur > bestsave[i]) {\n        bestsave[i] = cur;\n        bestsave_ind[i] = ind;\n        failcnt = 0;\n      }\n      else {\n        failcnt++;\n        if (failcnt > 10) break;\n      }\n    }\n  }\n  printf(\"%s\\n\", ans.c_str());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3333;\nbool is_ab[maxn];\nint a[maxn], b[maxn];\nbool active[maxn * 2];\nint main(){\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tvector<int> p[2];\n\tfor(int i = 0; i < 2 * n; i++){\n\t\tp[s[i] - 'a'].push_back(i);\n\t}\n\tfor(int i = 0; i < n; i++){\n\t\ta[i] = p[0][i];\n\t\tb[i] = p[1][i];\n\t\tis_ab[i] = a[i] < b[i];\n\t}\n\tvector<int> ab, ba;\n\tfor(int i = n - 1; i >= -1; i--){\n\t\tif(i == -1 || !is_ab[i]){\n\t\t\tfor(int j = 0; j <= i; j++) if(!is_ab[j]) ba.push_back(j);\n\t\t\tfor(int j = i + 1; j < n; j++) if(is_ab[j]) ab.push_back(j);\n\t\t\tbreak;\n\t\t}\n\t}\n\tvector<string> opts;\n\tint last = 2 * n;\n\twhile(!ba.empty()){\n\t\tint x = b[ba.back()], y = a[ba.back()]; ba.pop_back();\n\t\tint f = 0, g = 0;\n\t\tfor(int j = y - 1; j > x; j--){\n\t\t\tif(active[j]){\n\t\t\t\tif(s[j] == 'b') f++;\n\t\t\t\telse break;\n\t\t\t}\n\t\t}\n\t\tfor(int j = y + 1; j < 2 * n; j++){\n\t\t\tif(active[j]){\n\t\t\t\tif(s[j] == 'b') g++;\n\t\t\t\telse break;\n\t\t\t}\n\t\t}\n\t\tif(f > 0 && g <= 1){\n\t\t\tactive[x] = 1;\n\t\t\tactive[y] = 1;\n\t\t} else if(f == 0 && g <= 1){\n\t\t\tstring now;\n\t\t\tfor(int j = y + 1; j < last; j++){\n\t\t\t\tif(active[j]) now.push_back(s[j]);\n\t\t\t}\n\t\t\topts.push_back(now);\n\t\t\tlast = y + 1;\n\t\t\tactive[x] = 1;\n\t\t\tactive[y] = 1;\n\t\t}\n\t}\n\t{\n\t\tstring now;\n\t\tfor(int j = 0; j < last; j++){\n\t\t\tif(active[j]) now.push_back(s[j]);\n\t\t}\n\t\topts.push_back(now);\n\t}\n\treverse(opts.begin(), opts.end());\n\tstring ans;\n\tint ptr = 0, len = opts.size();\n\twhile(ptr < len){\n\t\tstring best = opts[ptr];\n\t\tfor(int j = ptr; j < len; j++) best = max(best, opts[j]);\n\t\tfor(int j = ptr; j < len; j++) if(opts[j] == best){\n\t\t\tptr = j + 1;\n\t\t\tbreak;\n\t\t}\n\t\tans += best;\n\t}\t\n\tint low = ab.empty() ? 2 * n : a[ab[0]];\n\twhile(!ab.empty()){\n\t\tint x = a[ab.back()], y = b[ab.back()]; ab.pop_back();\n\t\tint has_a = 0;\n\t\tfor(int j = y - 1; j > x; j--){\n\t\t\tif(active[j] && s[j] == 'a') has_a = 1;\n\t\t}\n\t\tif(!has_a){\n\t\t\tactive[x] = 1;\n\t\t\tactive[y] = 1;\n\t\t}\n\t}\n\tfor(int j = low; j < 2 * n; j++) if(active[j]) ans.push_back(s[j]);\t\n\tcout << ans << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define llong long long\n#define mkpr make_pair\n#define x first\n#define y second\n#define iter iterator\n#define riter reversed_iterator\n#define y1 Lorem_ipsum_\n#define tm dolor_sit_amet_\nusing namespace std;\n\ninline int read()\n{\n\tint x = 0,f = 1; char ch = getchar();\n\tfor(;!isdigit(ch);ch=getchar()) {if(ch=='-') f = -1;}\n\tfor(; isdigit(ch);ch=getchar()) {x = x*10+ch-48;}\n\treturn x*f;\n}\n\nconst int mxN = 6e3;\nchar a[mxN+3];\nint pos1[mxN+3],pos2[mxN+3],id[mxN+3];\nstring f[mxN+3];\nint n;\n\nint main()\n{\n\tn = read(); scanf(\"%s\",a+1);\n\tfor(int i=1,x=0,y=0; i<=2*n; i++)\n\t{\n\t\tif(a[i]=='a') {pos1[++x] = i; id[i] = x;} else {pos2[++y] = i; id[i] = y;}\n\t}\n\tfor(int i=1; i<=n; i++) if(pos1[i]>pos2[i]) {swap(pos1[i],pos2[i]);}\n\tfor(int i=n; i>=1; i--)\n\t{\n\t\tif(a[pos1[i]]=='a')\n\t\t{\n\t\t\tf[i] = \"ab\"+f[i+pos2[i]-pos1[i]];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint j = i; while(j<n&&a[pos1[j+1]]=='b') {j++;}\n//\t\t\tprintf(\"i=%d j=%d\\n\",i,j);\n\t\t\tfor(int k=pos1[i]; k<=pos2[j]; k++) if(id[k]>=i&&id[k]<=j) {f[i] += a[k];}\n\t\t\tf[i] += f[j+1];\n\t\t}\n\t\tif(f[i+1]>f[i]) {f[i] = f[i+1];}\n//\t\tcout<<f[i]<<endl;\n\t}\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define M 10005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Min[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Min(int x,int y) {\n\tif(f[x]<5000&&f[y]>5000) return 0;\n\tif(f[x]>5000&&f[y]<5000) return 1;\n\tif(f[x]<5000) return f[x]>=f[y];\n\tif(f[x]/5000>f[y]/5000||(f[x]/5000==f[y]/5000&&check(f[y]%5000,R[y],f[x]%5000,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\tif(s[l]=='a') {\n\t\t\tshu=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='a'&&!shu) ++f[be[l]],shu=1;\n\t\t\t\telse shu=0;\n\t\t} \n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*5000+id;\n\t\t}\n\t}\n\tMin[be[0]]=be[0];\n\tFOR2(be[0]-1,1,i) {\n\t\tMin[i]=Min[i+1];\n\t\tif(check_Min(i,Min[i])) Min[i]=i;\n\t}\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Min[pos+1];\n\t\tif(f[pos]>5000) {\n\t\t\tFOR2(f[pos]/5000,1,i) putchar('b');\n\t\t\tfor1(f[pos]%5000,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 3010;\n\nstring mx;\nint n, last;\nint vis[maxn<<1];\nchar str[maxn<<1];\nvector<string> ans;\nint sum;\n\nvoid solve1(int l, int r) {\n\tstring res;\n\tint cur_a = l, cur_b = l;\n\tint cnt_a = 0, cnt_b = 0;\n\tint lastp = l-1;\n\tfor (int i = 1; i <= (r-l+1)/2; i++) {\n\t\twhile (cnt_a < i) {\n\t\t\tif (str[cur_a] == 'a') ++ cnt_a;\n\t\t\t++ cur_a;\n\t\t}\n\t\twhile (cnt_b < i) {\n\t\t\tif (str[cur_b] == 'b') ++ cnt_b;\n\t\t\t++ cur_b;\n\t\t}\n\t\tif (cur_a - 1 > lastp) {\n\t\t\tlastp = cur_b - 1;\n\t\t\tres.push_back('a');\n\t\t\tres.push_back('b');\n\t\t}\n\t}\n\tif (mx.empty() || mx[0] == 'a') {\n\t\tmx = res;\n\t\tans.push_back(mx);\n\t}\n}\n\nvoid solve2(int l, int r) {\n\tstring t_mx;\n\tint cnt_a = 0, cnt_b = 0;\n\tint cur_a = r, cur_b = r;\n\tfor (int i = 1; i <= (r-l+1)/2; i++) {\n\t\twhile (cnt_a < i) {\n\t\t\tif (str[cur_a] == 'a') {\n\t\t\t\tvis[cur_a] = 1;\n\t\t\t\t++ cnt_a;\n\t\t\t}\n\t\t\t-- cur_a;\n\t\t}\n\t\twhile (cnt_b < i) {\n\t\t\tif (str[cur_b] == 'b') {\n\t\t\t\tvis[cur_b] = 1;\n\t\t\t\t++ cnt_b;\n\t\t\t}\n\t\t\t-- cur_b;\n\t\t}\n\t\tstring tmp;\n\t\tfor (int j = l; j <= r; j++) if (vis[j]) tmp.push_back(str[j]);\n\t\tt_mx = max(t_mx, tmp);\n\t}\n\tif (t_mx >= mx) {\n\t\tmx = t_mx;\n\t\tans.push_back(mx);\n\t}\n}\n\nvoid solve(int l, int r) {\n\tif (str[l] == 'a') solve1(l, r);\n\telse solve2(l, r);\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", str+1);\n\tlast = 2*n;\n\tfor (int i = 2*n; i >= 1; i--) {\n\t\tif (str[i] == 'a') ++ sum;\n\t\tif (str[i] == 'b') -- sum;\n\t\tif (sum == 0) {\n\t\t\tsolve(i, last);\n\t\t\tlast = i-1;\n\t\t}\n\t}\n\treverse(ans.begin(), ans.end());\n\tfor (int i = 0; i < ans.size(); i++) printf(\"%s\", ans[i].c_str());\t\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L;\n\t\t/*while(cur>=L and cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t\tcontinue;\n\t\t\tres+=\"ab\";\n\t\t\tcur=nxt[cur]+1;\n\t\t}*/\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=A;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tnxt[A]=-1;\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<X.size();A++)\n\t\tfor(int B=A+1;B<X.size();B++)\n\t\t\tif(occurence[A]==occurence[B])\n\t\t\t\tnxt[A]=B;\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\n#define N 6005\nint n,l1,l2,v[N][2],ct[N],dp2[N];\nchar s[N],dp[N][N];\nbool check(int i,int j){for(int k=1;k<=n*2;k++)if(dp[i][k]<dp[j][k])return 1;else if(dp[i][k]>dp[j][k])return 0;return 0;}\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n*2;i++)\n\tif(s[i]=='a')v[++l1][0]=i;\n\telse v[++l2][1]=i;\n\tfor(int i=n;i>=1;i--)\n\tif(v[i][0]<v[i][1])\n\t{\n\t\tct[i]=ct[i+1];\n\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t}\n\telse\n\t{\n\t\tint rb=i;\n\t\twhile(rb<n&&v[rb][0]>v[rb+1][1])rb++;\n\t\tint l1=i,l2=i;\n\t\tfor(ct[i]=1;ct[i]<=(rb-i+1)*2;ct[i]++)\n\t\tif(l1==rb+1)dp[i][ct[i]]='b',++l2;\n\t\telse if(l2==rb+1)dp[i][ct[i]]='a',++l1;\n\t\telse if(v[l1][0]<v[l2][1])dp[i][ct[i]]='a',++l1;\n\t\telse dp[i][ct[i]]='b',++l2;\n\t\tct[i]--;\n\t\tfor(int j=1;j<=ct[rb+1];j++)dp[i][j+ct[i]]=dp[rb+1][j];\n\t\tct[i]+=ct[rb+1];\n\t\tif(check(i,i+1))\n\t\t{\n\t\t\tct[i]=ct[i+1];\n\t\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t\t}\n\t}\n\tif(ct[1])printf(\"%s\\n\",dp[1]+1);\n\telse\n\t{\n\t\tfor(int i=2;i<=n;i++)\n\t\tfor(int j=1;j<i;j++)\n\t\tif(v[j][1]<v[i][0]&&dp2[i]<=dp2[j])dp2[i]=dp2[j]+1;\n\t\tfor(int i=1;i<=n;i++)if(dp2[i]>dp2[n])dp2[n]=dp2[i];\n\t\tfor(int i=1;i<=dp2[n]+1;i++)printf(\"ab\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define MAXN 6010\nusing namespace std;\n\nint n,m;\nstring str;\nint p[MAXN][2],id[MAXN],cover[MAXN];\nstring f[MAXN],g[MAXN],s[MAXN];\n\nvoid init(){\n\tint na=0,nb=0;\n\tfor(int i=1;i<=m;i++){\n\t\tif(str[i]=='a') p[id[i]=++na][0]=i;\n\t\telse p[id[i]=++nb][1]=i;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(p[i][0]>p[i][1])\n\t\t\tswap(p[i][0],p[i][1]);\n\tfor(int i=1;i<=n;i++){\n\t\tif(str[p[i][0]]=='a'){\n\t\t\tcover[i]=i+p[i][1]-p[i][0]-1;\n\t\t}else{\n\t\t\tint cur=p[i][1];\n\t\t\tcover[i]=i;\n\t\t\tfor(int j=i+1;j<=n && p[j][0]<=cur;j++){\n\t\t\t\tcover[i]=j;\n\t\t\t\tcur=p[j][1];\n\t\t\t}\n\t\t\tfor(int j=p[i][0];j<=p[cover[i]][1];j++)\n\t\t\t\tif(id[j]>=i)\n\t\t\t\t\ts[i].push_back(str[j]);\n\t\t}\n\t}\n}\n\nvoid dp(){\n\tfor(int i=n;i>=1;i--){\n\t\tif(str[p[i][0]]=='a'){\n\t\t\tf[i]=\"ab\"+g[cover[i]+1];\n\t\t}else{\n\t\t\tf[i]=s[i]+g[cover[i]+1];\n\t\t}\n\t\tg[i]=max(f[i],g[i+1]);\n\t}\n}\n\nint main(){\n#ifdef DEBUG\n\tfreopen(\"in\",\"r\",stdin);\n#endif\n\tcin>>n;\n\tm=n<<1;\n\tcin>>str;\n\tstr=\" \"+str;\n\tinit();\n\tdp();\n\tcout<<g[1]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#define PB push_back\n#define MP make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long LL;\nconst int N=6000 +10;\n\nstring f[N];\nchar s[N];\nint  tk[N], od[N], a[N], b[N],n;\nvoid DP1();\nvoid DP2();\n\nint main(){\n\t#ifdef che \n\tfreopen(\"input.txt\",\"rt\",stdin);\n\t#endif\n\tscanf(\"%d%s\", &n, s);\n\tint an=0, bn= 0;\n\tfor (int i=0; i<2*n; ++i)\n\t\tif ( s[i]=='a' ){\n\t\t\tod[i] = an;a[an++] = i;\n\t\t}else{\n\t\t\tod[i] = bn;b[bn++] = i;\n\t\t}\n\t#ifdef che\n\tfor (int i=0; i<2*n; ++i) debug(\"od[%d] = %d\\n\", i, od[i]);\n\tfor (int i=0; i<n; ++i) debug(\"a[%d]= %d\\tb[%d]=%d\\n\", i, a[i], i, b[i]);\n\t#endif\n\tbool flag= false;\n\tfor (int i=0; i<n ; ++i)\n\t\tif ( b[i] < a[i]) flag= true;\n\tif ( !flag) DP1();\n\t\telse DP2();\n\treturn 0;\n}\n\nvoid DP1(){\n\tfor  (int i=0; i<2*n; ++i )  f[i]=\"\";\n\tfor (int i=2*n-1; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='a')\n\t\t\tf[i]= max( \"ab\"+f[b[od[i]]+1],f[i]);\n\t}\n\tcout<<f[0]<<endl;\n}\nvoid DP2(){\n\tfor (int i=2*n-1; ~i; --i){\n\t\tf[i] = f[i+1];\n\t\tif ( s[i]=='b'){\n\t\t\tstring t=\"\";\n\t\t\tfor (int j=0; j<=n; ++j) tk[j] = false;\n\t\t\tint ri=  a[od[i]];\n\t\t\tfor (int j=i;j<=ri; ++j){\n\t\t\t\tif ( s[j]=='b') tk[ od[j]]= true, ri= a[od[j]];\n\t\t\t\tif ( tk[od[j]]) t+=s[j];\n\t\t\t}\n\t\t\tif ( t.size()) f[i] = max(f[i], t+f[ri+1]);\n\t\t}\n\t}\n\tcout<<f[0]<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define N 3010\nstring Beta(string s){\n    if(s.size()==0)return \"#\";\n    if(s[0]=='a')return \"#\";\n    string res=\"\";\n    for(int i=0;i<s.size()-1;i++){\n        ll a=0,b=0;\n        string cur=\"\";\n        for(int j=0;j<s.size();j++){\n         if(s[j]=='a'){\n             if(a>=i)cur.push_back(s[j]);\n             a++;\n         }\n         if(s[j]=='b'){\n             if(b>=i)cur.push_back(s[j]);\n             b++;\n         }\n        }\n        //cout<<\"#\"<<cur<<endl;\n     res=max(res,cur);\n    }\n    //cout<<s<<\" \"<<res<<endl;\n    return res;\n}\nll n;\nstring s;\nll A[N],B[N],C[N];;\nint main(){\n    cin>>n>>s;\n    ll a=0,b=0;\n    string q=\"\";\n    typedef pair<string,ll> P;\n    vector<P> v;\n    for(int i=0;i<2*n;i++){\n     q.push_back(s[i]);\n     if(s[i]=='a'){A[a]=i;a++;}\n     if(s[i]=='b'){B[b]=i;b++;}\n     if(a==b){\n      string res=Beta(q);\n      if(res!=\"#\"){\n       v.push_back(make_pair(res,i));   \n      }\n      q=\"\";   \n     }\n    }//cout<<\"initend\"<<endl;\n    sort(v.begin(),v.end(),greater<P>());\n    for(int i=0;i<n;i++){\n     C[A[i]]=B[i];\n     C[B[i]]=A[i];\n    }\n    ll cur=-1;\n    string ans=\"\";\n    for(auto x:v){\n     string str=x.first;\n     ll p=x.second;\n     if(p<cur)continue;\n      cur=p;\n     ans+=str;\n    }cur++;\n    for(;cur<2*n;){\n        for(;cur<2*n;cur++){\n         if(s[cur]=='a')break;   \n        }\n        if(cur==2*n)break;\n        ans+=\"ab\";\n        cur=C[cur]+1;\n    }\n    cout<<ans<<endl;\n return  0;   \n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nint n;\ninline std::string calc(std::string s) {\n\tif(s.front() == 'a') {\n\t\tstd::string ret;\n\t\tint i0 = 0,i1 = 0, max = 0;\n\t\tfor(;i1 < s.size();) {\n\t\t\tfor(;i0 < s.size() && s[i0] != 'a';++i0);\n\t\t\tfor(;i1 < s.size() && s[i1] != 'b';++i1);\n\t\t\tif(i0 < s.size() && i0 >= max) max = i1, ret += \"ab\";\n\t\t\t++ i0, ++ i1;\n\t\t}\n\t\treturn ret;\n\t} else {\n\t\tstd::string max;\n\t\tfor(int i = 0;i + i < s.size();++i) {\n\t\t\tstd::string now; int ca = i, cb = i;\n\t\t\tfor(auto c : s) if(--(c == 'a' ? ca : cb) < 0)\n\t\t\t\tnow += c;\n\t\t\tif(now > max) max = now;\n\t\t}\n\t\treturn max;\n\t}\n}\nint main() {\n\tstd::cin >> n, n <<= 1; std::string str; char ch; int cnt = 0;\n\tstd::vector<std::string> ans;\n\twhile(std::cin >> ch) {\n\t\tstr += ch; cnt += ch & 1 ? 1 : -1; -- n;\n\t\tif(cnt == 0) ans.push_back(calc(str)), str = \"\";\n\t}\n\tstd::reverse(ans.begin(), ans.end()); std::string a;\n\tfor(auto i : ans) {\n\t\tauto s = i + a;\n\t\tif(s > a) a = s;\n\t}\n\tstd::cout << a << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n  bool b[2*n][2*n];\n  for(int i=0;i<2*n;i++)fill(b[i],b[i]+2*n,false);\n  string ans[2*n];\n  int saki[2*n];\n  fill(saki,saki+2*n,-1);\n  bool t=true;int x=0;\n  queue<int> que;\n  for(int i=2*n-1;i>=0;i--){\n    if(x==0){\n      if(s[i]=='a'){t=false;x++;}\n      else x--;\n      que.push(i);\n      continue;\n    }\n    if(x>0){\n      if(s[i]=='a'){\n        que.push(i);\n        x++;\n        continue;\n      }\n      saki[i]=que.front();\n      que.pop();\n      x--;\n      continue;\n    }\n    if(s[i]=='b'){\n      que.push(i);\n      x--;\n      continue;\n    }\n    if(t)saki[i]=que.front();\n    que.pop();\n    x++;\n    continue;\n\n\n  }\n  for(int i=2*n-1;i>=0;i--){\n    if(saki[i]!=-1){\n      if(s[i]=='b'){\n        for(int j=i;j<saki[i];j++)if(s[j]=='b'){\n          b[i][j]=true;\n          b[i][saki[j]]=true;\n        }\n      }else{\n        b[i][i]=true;\n        b[i][saki[i]]=true;\n      }\n      for(int j=0;j<2*n;j++){\n        b[i][j]|=b[saki[i]][j];\n        if(b[i][j])ans[i].push_back(s[j]);\n      }\n    }\n    if(i!=2*n-1&&ans[i]<ans[i+1]){\n      ans[i]=ans[i+1];\n      for(int j=0;j<2*n;j++)b[i][j]=b[i+1][j];\n    }\n  }\n  string ans2=ans[0];\n  for(int i=1;i<2*n;i++)ans2=max(ans[i],ans2);\n    \n  cout<<ans2<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "/*\nThough leaves are many , the root is one.\nThrough all the lying days of my youth\nI swayed my leaves and flowers in the sun.\nNow I may wither into the truth.\n\t  \t  \t- William Butler Yeats\n*/\n//#pragma GCC optimize(\"Ofast,no-stack-protector\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx\")\n//#pragma GCC target(\"avx,tune=native\")\n#include<bits/stdc++.h>\n#pragma comment(\"-Wl,--stack=1024000000\")\n//#include<ext/pb_ds/assoc_container.hpp>\nusing namespace std;\n//using namespace __gnu_pbds;\nconst int inf=0x3f3f3f3f;\nconst double eps=1e-6;\nconst int mod=1000000007;\ntypedef long long ll;\n#ifndef LOCAL\n#define cerr if(0)cout\n#define eprintf(...) 0\n#else\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\n#endif\ninline string getstr(string &s,int l,int r){string ret=\"\";for(int i=l;i<=r;i++)ret.push_back(s[i]);return ret;}\nint modpow(int x,int y,int md=mod){int ret=1;do{if(y&1)ret=(ll)ret*x%md;x=(ll)x*x%md;}while(y>>=1);return ret;}\ninline int Rand(){return rand()*32768+rand();}\nint n;\nstring s;\nvector<int>a,b;\nstring dp[3005];\nint ind[6005];\nint main(){\n\tcin>>n>>s;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(s[i]=='a')ind[i]=a.size(),a.push_back(i);\n\t\telse ind[i]=b.size(),b.push_back(i);\n\t}\n\tdp[n]=\"\";\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint p=i;\n\t\t\twhile(p<n&&min(a[p],b[p])<=b[i])p++;\n\t\t\tdp[i]=\"ab\"+dp[p];\n\t\t}else{\n\t\t\tint p=i;\n\t\t\twhile(p+1<n&&b[p+1]<a[p])p++;\n\t\t\tfor(int j=b[i];j<s.size();j++){\n\t\t\t\tif(ind[j]>=i&&ind[j]<=p)dp[i].push_back(s[j]);\n\t\t\t}\n\t\t\tdp[i]+=dp[p+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// ███▓▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓╬╬╬╬╬╬▓█\n// ███▓███████▓▓╬╬╬╬╬╬╬╬╬╬╬╬▓███▓▓▓▓█▓╬╬╬▓█\n// ███████▓█████▓▓╬╬╬╬╬╬╬╬▓███▓╬╬╬╬╬╬╬▓╬╬▓█\n// ████▓▓▓▓╬╬▓█████╬╬╬╬╬╬███▓╬╬╬╬╬╬╬╬╬╬╬╬╬█\n// ███▓▓▓▓╬╬╬╬╬╬▓██╬╬╬╬╬╬▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// ████▓▓▓╬╬╬╬╬╬╬▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// ███▓█▓███████▓▓███▓╬╬╬╬╬╬▓███████▓╬╬╬╬▓█\n// ████████████████▓█▓╬╬╬╬╬▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬█\n// ███▓▓▓▓▓▓▓╬╬▓▓▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// ████▓▓▓╬╬╬╬▓▓▓▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// ███▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// █████▓▓▓▓▓▓▓▓█▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n// █████▓▓▓▓▓▓▓██▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n// █████▓▓▓▓▓████▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n// ████▓█▓▓▓▓██▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n// ████▓▓███▓▓▓▓▓▓▓██▓╬╬╬╬╬╬╬╬╬╬╬╬█▓╬▓╬╬▓██\n// █████▓███▓▓▓▓▓▓▓▓████▓▓╬╬╬╬╬╬╬█▓╬╬╬╬╬▓██\n// █████▓▓█▓███▓▓▓████╬▓█▓▓╬╬╬▓▓█▓╬╬╬╬╬╬███\n// ██████▓██▓███████▓╬╬╬▓▓╬▓▓██▓╬╬╬╬╬╬╬▓███\n// ███████▓██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬████\n// ███████▓▓██▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓████\n// ████████▓▓▓█████▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█████\n// █████████▓▓▓█▓▓▓▓▓███▓╬╬╬╬╬╬╬╬╬╬╬▓██████\n// ██████████▓▓▓█▓▓▓╬▓██╬╬╬╬╬╬╬╬╬╬╬▓███████\n// ███████████▓▓█▓▓▓▓███▓╬╬╬╬╬╬╬╬╬▓████████\n// ██████████████▓▓▓███▓▓╬╬╬╬╬╬╬╬██████████\n// ███████████████▓▓▓██▓▓╬╬╬╬╬╬▓███████████\n// #pragma GCC optimize(\"Ofast\")\n// #pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,tune=native\")\n// #pragma GCC optimize(\"unroll-loops\")    \n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <cstring>\n#include <ctime>\n#include <cstdlib>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <unordered_set>\n#include <list>\n#include <cmath>\n#include <bitset>\n#include <cassert>\n#include <queue>\n#include <deque>\n#include <cassert>\n#include <iomanip> \n#include <chrono>\n#define pb push_back\n#define x first\n#define y second\n#define mp make_pair\n#define files(FILENAME) read(FILENAME); write(FILENAME)\n#define read(FILENAME) freopen((string(FILENAME) + \".in\").c_str(), \"r\", stdin)\n#define write(FILENAME) freopen((string(FILENAME) + \".out\").c_str(), \"w\", stdout)\nusing namespace std;\n        \ntemplate<typename T1, typename T2>inline void chkmin(T1 &x, T2 y) { if (x > y) x = y; }\ntemplate<typename T1, typename T2>inline void chkmax(T1 &x, T2 y) { if (x < y) x = y; } \ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const pair<T, U> &_p) { _out << _p.first << ' ' << _p.second; return _out; }\ntemplate<typename T, typename U> inline istream &operator>> (istream &_in, pair<T, U> &_p) { _in >> _p.first >> _p.second; return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const vector<T> &_v) { if (_v.empty()) { return _out; } _out << _v.front(); for (auto _it = ++_v.begin(); _it != _v.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline istream &operator>> (istream &_in, vector<T> &_v) { for (auto &_i : _v) { _in >> _i; } return _in; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_set<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T> inline ostream &operator<< (ostream &_out, const unordered_multiset<T> &_s) { if (_s.empty()) { return _out; } _out << *_s.begin(); for (auto _it = ++_s.begin(); _it != _s.end(); ++_it) { _out << ' ' << *_it; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\ntemplate<typename T, typename U> inline ostream &operator<< (ostream &_out, const unordered_map<T, U> &_m) { if (_m.empty()) { return _out; } _out << '(' << _m.begin()->first << \": \" << _m.begin()->second << ')'; for (auto _it = ++_m.begin(); _it != _m.end(); ++_it) { _out << \", (\" << _it->first << \": \" << _it->second << ')'; } return _out; }\n \ntypedef long double base;        \ntypedef pair<int, int> point;\n\nint n;\nstring s;\nvector<string> rep;\n\nint main() {\n\tios::sync_with_stdio(0);\n\tsrand(time(0));\n\t//read(\"input\");\n\tcin >> n >> s;\n\tint balance = 0;\n\tstring suf;\n\tfor (auto c : s) {\n\t\tif (c == 'a') {\n\t\t\t++balance;\n\t\t} else {\n\t\t\t--balance;\n\t\t}\n\t\tsuf += c;\n\t\tif (balance == 0) {\n\t\t\tvector<int> a, b;\n\t\t\tfor (int i = 0; i < suf.size(); ++i) {\n\t\t\t\tif (suf[i] == 'a') {\n\t\t\t\t\ta.pb(i);\n\t\t\t\t} else {\n\t\t\t\t\tb.pb(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (suf[0] == 'a') {\n\t\t\t\tstring res;\n\t\t\t\tint lst = -1;\n\t\t\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\t\t\tif (lst < a[i]) {\n\t\t\t\t\t\tlst = b[i];\n\t\t\t\t\t\tres += \"ab\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep.pb(res);\n\t\t\t} else {\n\t\t\t\tstring need = \"\";\n\t\t\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\t\t\tvector<bool> used(suf.size());\n\t\t\t\t\tfor (int j = i; j < a.size(); ++j) {\n\t\t\t\t\t\tused[a[j]] = used[b[j]] = true;\n\t\t\t\t\t} \n\t\t\t\t\tstring res;\n\t\t\t\t\tfor (int j = 0; j < suf.size(); ++j) {\n\t\t\t\t\t\tif (used[j]) {\n\t\t\t\t\t\t\tres += suf[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tchkmax(need, res);\n\t\t\t\t}\n\t\t\t\trep.pb(need);\n\t\t\t}\n\t\t\tsuf = \"\";\n\t\t}\n\t}\n\treverse(rep.begin(), rep.end());\n\tstring ans = \"\";\n\tfor (auto s : rep) {\n\t\tstring nans = s + ans;\n\t\tif (ans < nans) {\n\t\t\tans = nans;\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <atcoder/all>\n#include <bits/stdc++.h>\nusing namespace std;\n//using namespace atcoder;\n#define int long long\n   template<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n    const int MAX =200005;\nconst int MOD =1000000007;\n\nsigned main(){\n  int n;\n  string s;\n  cin>>n>>s;\n  bool b[2*n][2*n];\n  for(int i=0;i<2*n;i++)fill(b[i],b[i]+2*n,false);\n  string ans[2*n];\n  int saki[2*n];\n  fill(saki,saki+2*n,-1);\n  bool t=true;int x=0;\n  queue<int> que;\n  for(int i=2*n-1;i>=0;i--){\n    if(x==0){\n      if(s[i]=='a'){t=false;x++;}\n      else x--;\n      que.push(i);\n      continue;\n    }\n    if(x>0){\n      if(s[i]=='a'){\n        que.push(i);\n        x++;\n        continue;\n      }\n      saki[i]=que.front();\n      que.pop();\n      x--;\n      continue;\n    }\n    if(s[i]=='b'){\n      que.push(i);\n      x--;\n      continue;\n    }\n    if(t)saki[i]=que.front();\n    que.pop();\n    x++;\n    continue;\n\n\n  }\n  for(int i=2*n-1;i>=0;i--){\n    if(saki[i]!=-1){\n      if(s[i]=='b'){\n        for(int j=i;j<saki[i];j++)if(s[j]=='b'){\n          b[i][j]=true;\n          b[i][saki[j]]=true;\n        }\n      }else{\n        b[i][i]=true;\n        b[i][saki[i]]=true;\n      }\n      for(int j=0;j<2*n;j++){\n        b[i][j]|=b[saki[i]][j];\n        if(b[i][j])ans[i].push_back(s[j]);\n      }\n    }\n    if(i!=2*n-1&&ans[i].empty()){\n      ans[i]=ans[i+1];\n      for(int j=0;j<2*n;j++)b[i][j]=b[i+1][j];\n    }\n  }\nstring ans2=ans[0];\nfor(int i=1;i<2*n;i++)ans2=max(ans2,ans[i]);\n    \n  cout<<ans2<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return true; } return false; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return true; } return false; }\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define mp make_pair\n#define si(x) int(x.size())\nconst int mod=1000000007,MAX=3005,INF=1<<30;\nint pos[MAX][2],cnt[MAX*2][2];\nstring ma[MAX];\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    int N;cin>>N;\n    string S;cin>>S;\n    \n    int a=0,b=0;\n    for(int i=0;i<2*N;i++){\n        if(S[i]=='a'){\n            pos[a][0]=i;\n            a++;\n        }else{\n            pos[b][1]=i;\n            b++;\n        }\n        \n        cnt[i][0]=a;\n        cnt[i][1]=b;\n    }\n    \n    pos[N][0]=INF;\n    pos[N][1]=INF;\n    \n    if(S.back()=='b') ma[N-1]=\"ab\";\n    else ma[N-1]=\"ba\";\n    \n    ma[N]=\"\";\n    \n    for(int s=N-2;s>=0;s--){\n        ma[s]=\"\";\n        if(pos[s][0]<pos[s][1]){\n            string U=ma[s+1],U2=\"\";\n            if(U[0]=='B') ma[s]=U;\n            else{\n                U2=\"ab\"+ma[cnt[pos[s][1]][0]];\n                ma[s]=max(U,U2);\n            }\n        }else{\n            int now=s;\n            while(now<N){\n                int bcnt=cnt[pos[now][0]][1];\n                int apos=pos[bcnt-1][0];\n                int bcnt2=cnt[apos][1];\n                \n                now=bcnt;\n                if(bcnt==bcnt2) break;\n            }\n            \n            int a=s,b=s;\n            while(a<now||b<now){\n                if(a==now){\n                    ma[s]+='b';\n                    b++;\n                    continue;\n                }\n                if(b==now){\n                    ma[s]+='a';\n                    a++;\n                    continue;\n                }\n                if(pos[a][0]<pos[b][1]){\n                    ma[s]+='a';\n                    a++;\n                }else{\n                    ma[s]+='b';\n                    b++;\n                }\n            }\n            \n            ma[s]+=ma[now];\n            \n            chmax(ma[s],ma[s+1]);\n        }\n    }\n    \n    string ans=\"\";\n    for(int i=0;i<N;i++) chmax(ans,ma[i]);\n    \n    cout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <memory.h>\n#include <math.h>\n#include <assert.h>\n#include <queue>\n#include <map>\n#include <set>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <functional>\n#include <unordered_map>\n\nusing namespace std;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define Fi first\n#define Se second\n#define pb(x) push_back(x)\n#define szz(x) (int)x.size()\n#define rep(i, n) for(int i=0;i<n;i++)\n#define all(x) x.begin(), x.end()\ntypedef tuple<int, int, int> t3;\n\nchar S[6060];\nint pl[3030], pr[3030];\nint mat[6060];\nint N;\n\nstring Do2(int l, int r) {\n\tstring res = \"\";\n\tfor(int i=l;i<=r;) {\n\t\tif(S[i] == 'a') i = mat[i] + 1, res.pb('a'), res.pb('b');\n\t\telse ++i;\n\t}\n\treturn res;\n}\n\nstring Do(string X, string append) {\n\tint max_val = 0, n = szz(X), now = 0;\n\tvector <int> pv;\n\trep(i, n) {\n\t\tif(X[i] == 'b') ++now;\n\t\telse --now;\n\t\tif(max_val < now) {\n\t\t\tmax_val = now;\n\t\t\tpv.clear();\n\t\t\tpv.pb(i);\n\t\t}\n\t\telse if(max_val == now) pv.pb(i);\n\t}\n\tstring res = append;\n\tfor(int e : pv) {\n\t\tstring tt = \"\";\n\t\trep(j, max_val) tt.pb('b');\n\t\tfor(int j=e+1;j<n;j++) tt.pb(X[j]);\n\t\ttt += append;\n\t\tif(res < tt) res = tt;\n\t}\n\treturn res;\n}\n\nstring get_ans(vector <string> &L) {\n\tint n = szz(L);\n\tstring res = \"\";\n\tfor(int i=n-1;i>=0;i--) {\n\t\tres = Do(L[i], res);\n\t}\n\treturn res;\n}\n\nvoid solve(){\n\tscanf(\"%d%s\", &N, S + 1);\n\tN *= 2;\n\tint ca = 0, cb = 0;\n\tfor(int i=1;i<=N;i++) {\n\t\tif(S[i] == 'a') pl[++ca] = i;\n\t\telse pr[++cb] = i;\n\t}\n\tfor(int i=1;i<=N/2;i++) mat[pl[i]] = pr[i], mat[pr[i]] = pl[i];\n\tint val[6060] = {};\n\tfor(int i=1;i<=N;i++) val[i] = val[i-1] + (S[i] == 'b' ? 1 : -1);\n\tint md = 0, p = -1;\n\tstring res = \"\";\n\tvector <string> V;\n\tstring last = \"\";\n\tfor(int i=1;i<=N;i++) {\n\t\tif(md == 0) md = val[i], p = i;\n\t\tif(i == N || (val[i] == 0 && !(md == -1 && val[i+1] == -1))) {\n\t\t\tstring tt = \"\";\n\t\t\tfor(int j=p;j<=i;j++) tt.pb(S[j]);\n\t\t\tif(md == 1) V.pb(tt);\n\t\t\telse {\n\t\t\t\tif(i == N) last = Do2(p, i);\n\t\t\t}\n\t\t\tmd = 0;\n\t\t}\n\t}\n\tres = get_ans(V);\n\tres = res + last;\n\tprintf(\"%s\\n\", res.c_str());\n}\n\nint main(){\n\tint Tc = 1; //scanf(\"%d\", &Tc);\n\tfor(int tc=1;tc<=Tc;tc++){\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <cmath>\n#include <iomanip>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <iterator>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define x first\n#define y second\n#define mp make_pair\n#define up_b upper_bound\n#define low_b lower_bound\n#define sz(x) (int)x.size()\n#define bit __builtin_popcount\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,int> pii;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\ntypedef tree<int,null_type,less<int>,rb_tree_tag,tree_order_statistics_node_update> indexed_set;\n\nconst ll INF=1e18+123;\nconst ld EPS=1e-9;\nconst int inf=1e9+123;\nconst int MOD=1e9+7;\nconst int N=1e5+123;\nconst int dx[]={0,0,1,-1};\nconst int dy[]={1,-1,0,0};\n\nint q[N],x[N];\n\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    int n;\n    string s;\n    cin>>n;\n    cin>>s;\n    n+=n;\n    string mx=\"\";\n    for(int k=0;n;k=1){\n        int ca=0,cb=0;\n        bool da=0,db=0;\n        for(int i=0;i<n;i++){\n            if(s[i]=='a'){\n                ca++;\n                if(ca==k && !da){\n                    s.erase(s.begin()+i);\n                    i--;\n                    n--;\n                    da=1;\n                    ca--;\n                    continue;\n                }\n                q[i]=ca;\n            }\n            else{\n                cb++;\n                if(cb==k && !db){\n                    s.erase(s.begin()+i);\n                    i--;\n                    n--;\n                    db=1;\n                    cb--;\n                    continue;\n                }\n                q[i]=cb;\n            }\n            x[i]=0;\n        }\n        string ans=\"\";\n        for(int i=0;i<n;){\n            bool z=0;\n            for(int j=i;j<n;j++){\n                x[q[j]]++;\n                if(s[j]=='b' && x[q[j]]==1){\n                    z=1;\n                    i=j;\n                    break;\n                }\n            }\n            if(!z){\n                bool w=0;\n                int l;\n                for(;i<n;i++){\n                    if(s[i]=='a' && !w){\n                        w=1;\n                        l=q[i];\n                        ans+='a';\n                    }\n                    if(s[i]=='b' && q[i]==l){\n                        ans+='b';\n                        w=0;\n                    }\n                }\n                break;\n            }\n            int l;\n            for(;i<n;i++){\n                if(s[i]=='b'){\n                    l=q[i];\n                    ans+='b';\n                }\n                else{\n                    if(l<q[i]){\n                        break;\n                    }\n                    ans+='a';\n                }\n                x[q[i]]++;\n            }\n        }\n        mx=max(ans,mx);\n    }\n    cout<<mx;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define ll long long\nusing namespace std;\ninline int read()\n{\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch < '0' || ch > '9') {if(ch == '-') f = -1; ch = getchar();}\n\twhile(ch >= '0' && ch <= '9') {x = (x << 3) + (x << 1) + (ch ^ 48); ch = getchar();}\n\treturn x * f;\n}\nconst int N = 3100;\nint n,a,b,pa[N],pb[N];\nint nex[N << 1],id[N << 1];\nstring s,f[N << 1];\nint main()\n{\n\tn = read(); cin >> s; s = \" \" + s;\n\tfor(int i = 1;i <= (n << 1);i ++)\n\t{\n\t\tif(s[i] == 'a') pa[id[i] = ++ a] = i;\n\t\telse pb[id[i] = ++ b] = i;\n\t}\n\tpa[n + 1] = pb[n + 1] = n * 2 + 1, id[n * 2 + 1] = n + 1;\n\tfor(int i = 1,j = 0;i <= n + 1;i ++) while(j < min(pa[i],pb[i])) nex[++ j] = i;\n\tfor(int i = n,j;i >= 1;i --)\n\t{\n\t\tif(pa[i] > pb[i])\n\t\t{\n\t\t\tj = pb[i];\n\t\t\twhile(pb[id[j]] < pa[id[j]] && (id[j] <= i || pb[id[j]] < pa[id[j] - 1])) {if(id[j] >= i) f[i] += s[j]; j ++;}\n\t\t\tf[i] += f[id[j]];\n\t\t}\n\t\telse f[i] = \"ab\" + f[nex[pb[i]]];\n\t\tf[i] = max(f[i],f[i + 1]);\n\t}\n\tcout << f[1] << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=4e3+5;\nstring dp[maxn<<1];\nchar s[maxn<<1];\nint a[maxn],b[maxn],n,A,B,t[maxn<<1],p,fi[maxn<<1];\nint cnt,group[maxn<<1];\nstring ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=2*n;i++){\n\t\tif (s[i]=='a'){\n\t\t\ta[++A]=i;\n\t\t\tt[i]=A;\n\t\t\tcnt++;\n\t\t}else{\n\t\t\tb[++B]=i;\n\t\t\tt[i]=B;\n\t\t\tcnt--;\n\t\t}\n\t\tgroup[i]=p;\n\t\tif (cnt==0)\n\t\t\tfi[++p]=i+1;\n\t}\n\tfi[++p]=n*2+1;\n\tfor (int i=2*n;i>=1;i--){\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi != i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tstring S;\n\t\t\tfor (int j = i;group[j] == group[i];j++){\n\t\t\t\tif (b[t[j]] >= i)\n\t\t\t\t\tS+=s[j];\n\t\t\t}\n\t\t\tS+=dp[fi[group[i]+1]];\n//\t\t\tcout << group[i] << ' ' << fi[group[i]+1] << '\\n';\n//\t\t\tcout << i << ' ' << S << ' ' << dp[fi[group[i]+1]] << '\\n';\n\t\t\tdp[i]=max(S,ans);\n\t\t}else{\n\t\t\tdp[i]=max(\"ab\"+dp[b[t[i]]+1],ans);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tcout << ans ;\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <set>\n\n#define MIN_INT -2147483648\n#define MAX_INT 2147483647\n#define MIN_LONG -9223372036854775808L\n#define MAX_LONG 9223372036854775807L\n#define PI 3.141592653589793238462643383279502884L\n\n#define long long long int\n\nusing std::vector;\nusing std::map;\nusing std::set;\nusing std::string;\nusing std::pair;\nusing std::cin;\nusing std::cout;\nusing std::cerr;\n\n// @author: pashka\n\nint main() {\n    std::ios::sync_with_stdio(false);\n\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n    vector<int> aa;\n    vector<int> bb;\n    for (int i = 0; i < 2 * n; i++) {\n        if (s[i] == 'a') aa.push_back(i); else bb.push_back(i);\n    }\n\n    vector<int> p(2 * n);\n    for (int i = 0; i < n; i++) {\n        p[aa[i]] = bb[i];\n        p[bb[i]] = aa[i];\n    }\n\n    vector<string> mx(2 * n + 1);\n    for (int i = 2 * n - 1; i >= 0; i--) {\n        mx[i] = mx[i + 1];\n        if (p[i] > i) {\n            if (s[i] == 'a') {\n                mx[i] = std::max(mx[i], \"ab\" + mx[p[i] + 1]);\n            } else {\n                int r = i;\n                string ss = \"\";\n                for (int j = i; j <= 2 * n; j++) {\n                    if (j > r) {\n                        break;\n                    }\n                    if (s[j] == 'b' && p[j] > j) {\n                        ss += 'b';\n                        r = std::max(r, p[j]);\n                    } else if (s[j] == 'a' && p[j] < j && p[j] >= i) {\n                        ss += 'a';\n                    }\n                }\n                mx[i] = std::max(mx[i], ss + mx[r]);\n            }\n        }\n//        cout << i << \" \" << mx[i] << \"\\n\";\n    }\n\n    cout << mx[0] << \"\\n\";\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<bitset>\n#include<stack>\nusing namespace std;\ntypedef long long int llint;\ntypedef long double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*\ncout<<setprecision(20)\ncin.tie(0);\nios::sync_with_stdio(false);\n*/\nconst llint mod=1e9+7;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint main(void){\n\tint i,j,n,m;cin>>n;\n\tm=n+n;\n\tstring s;cin>>s;\n\tvector<int>ban(m);\n\tint ac=0,bc=0;\n\tvector<int>Adco(n);\n\tvector<int>Bdco(n);\n\tfor(i=0;i<m;i++){\n\t\tif(s[i]=='a'){ban[i]=ac;Adco[ac]=i;ac++;}\n\t\telse{ban[i]=bc;Bdco[bc]=i;bc++;}\n\t}\n\tvector<tuple<string,int,int>>site(n);\n\t//string,始点b,終点絶\n\tfor(i=0;i<n;i++){\n\t\tget<1>(site[i])=-i;\n\t\tif(Adco[i]<Bdco[i]){continue;}\n\t\tint mde=i-1;//ここまでみた\n\t\tfor(j=Bdco[i];j<m;j++){\n\t\t\tif(s[j]=='b'){\n\t\t\t\tmde++;\n\t\t\t\tget<0>(site[i]).pub('b');\n\t\t\t}else{\n\t\t\t\tif(i<=ban[j]){get<0>(site[i]).pub('a');}\n\t\t\t\tif(mde<=ban[j]){get<2>(site[i])=j+1;break;}\n\t\t\t}\n\t\t}\n\t}\n\tSO(site);REV(site);\n\tfor(i=0;i<n;i++){get<1>(site[i])=-get<1>(site[i]);}\n\tint cut=0;//cut以降を見る\n\tstring ans;\n\tstring kara;\n\tfor(i=0;i<n;i++){\n\t\tif(get<0>(site[i])==kara){break;}\n\t\tif(Bdco[get<1>(site[i])]<cut){continue;}\n\t\tcut=get<2>(site[i]);\n\t\tans+=get<0>(site[i]);\n\t}\n\t//これ以降はaaabbabbみたいな状況 ba無理\n\tfor(;cut<m;cut++){\n\t\tif(s[cut]=='b'){continue;}//あるはずないので\n\t\tif(Bdco[ban[cut]]<cut){continue;}\n\t\tans.pub('a');\n\t\tans.pub('b');\n\t\tcut=Bdco[ban[cut]];\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <string>\nint a[3005], b[3005], n;\nchar str[6005];\nstd::string work(int l, int r)\n{\n\tint L = n, R = -1;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tif (l <= a[i] && a[i] <= r)\n\t\t{\n\t\t\tL = std::min(L, i);\n\t\t\tR = std::max(R, i);\n\t\t}\n\t}\n\tstd::string ans;\n\tif (a[L] < b[L])\n\t{\n\t\tint lst = l - 1;\n\t\tfor (int i = L; i <= R; i++)\n\t\t{\n\t\t\tif (a[i] > lst)\n\t\t\t{\n\t\t\t\tans += \"ab\";\n\t\t\t\tlst = b[i];\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tfor (int i = L; i <= R; i++)\n\t{\n\t\tauto res = ans;\n\t\tres = \"\";\n\t\tfor (int j = l; j <= r; j++)\n\t\t{\n\t\t\tif ((str[j] == 'a' && j >= a[i]) || (str[j] == 'b' && j >= b[i]))\n\t\t\t\tres += str[j];\n\t\t}\n\t\tans = std::max(ans, res);\n\t}\n\treturn ans;\n}\nstd::string part[3005];\nint main()\n{\n\t// freopen(\"AGC026-E.in\", \"r\", stdin);\n\tscanf(\"%d%s\", &n, str);\n\tint cur = 0, lst = 0, cnt = 0, cnta = 0, cntb = 0;\n\tfor (int i = 0; i < n << 1; i++)\n\t\t(str[i] == 'a' ? a[cnta++] : b[cntb++]) = i;\n\tfor (int i = 0; i < n << 1; i++)\n\t{\n\t\tcur += str[i] == 'a' ? -1 : 1;\n\t\tif (!cur)\n\t\t{\n\t\t\tpart[cnt++] = work(lst, i);\n\t\t\tlst = i + 1;\n\t\t}\n\t}\n\tstd::string ans;\n\tfor (int i = cnt - 1; i >= 0; i--)\n\t\tans = std::max(ans, part[i] + ans);\n\tputs(ans.c_str());\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define REPS(i,x) for(int i=1;i<=(int)(x);i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RREPS(i,x) for(int i=((int)(x));i>0;i--)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) (container).begin(), (container).end()\n#define RALL(container) (container).rbegin(), (container).rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define pb push_back\n#define eb emplace_back\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n#define __builtin_popcount __builtin_popcountll\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\n    os<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\n    os<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const map<S, T> &t) {\n    os<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\ntemplate<class S, class T> pair<S,T> operator+(const pair<S,T> &s, const pair<S,T> &t){ return pair<S,T>(s.first+t.first, s.second+t.second);}\ntemplate<class S, class T> pair<S,T> operator-(const pair<S,T> &s, const pair<S,T> &t){ return pair<S,T>(s.first-t.first, s.second-t.second);}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n\nint T, n, m;\nstring s;\n\nstring conv(string s) {\n    string t = \"\";\n    int c;\n    for(char ch : s) {\n        if (ch == 'a') c --;\n        if (0 <= c) t.push_back(ch);\n        if (ch == 'b') c ++;\n    }\n    return t;\n}\n\nstring solve2(string s) {\n    n = s.size() / 2;\n    vi a, b;\n    REP(i, 2 * n) {\n        if (s[i] == 'a') a.push_back(i);\n        if (s[i] == 'b') b.push_back(i);\n    }\n    string t = \"\";\n    int mi = -1;\n    REP(i, n) {\n        if (mi < a[i]) {\n            t += \"ab\";\n            mi = b[i];\n        }\n    }\n    return t;\n}\n\nstring solve(string s) {\n    n = s.size() / 2;\n    vi a, b;\n    REP(i, 2 * n) {\n        if (s[i] == 'a') a.push_back(i);\n        if (s[i] == 'b') b.push_back(i);\n    }\n    a.push_back(2 * n);\n    b.push_back(2 * n);\n    vector<string> dp(n + 1);\n    RREP(i, n) {\n        int c = 0, mx = 0;\n        string ans = \"\";\n        for (int ja = i, jb = i; ja < n || jb < n;) {\n            if (b[jb] < a[ja]) {\n                jb ++;\n                ans.push_back('b');\n            } else {\n                ja ++;\n                ans.push_back('a');\n            }\n            if (ja == jb) {\n                ans += *max_element(dp.begin() + ja, dp.end());\n                break;\n            }\n        }\n        dp[i] = ans;\n    }\n    return *max_element(ALL(dp));\n}\n\nint main(int argc, char *argv[]){\n    ios::sync_with_stdio(false);\n    string ss;\n    while(cin >> n >> ss){\n        string s = conv(ss);\n        cout << (s == \"\" ? solve2(ss) : solve(s)) << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<string.h>\n#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint n;\nstring s;\n\nint a[3011],b[3011];\n\nint begin;\nstring ans=\"\";\nvector<int>r;\nstring tmp;\nint main()\n{\n\tint i,j,k;\n\tcin>>n>>s;\n\tint xx,yy,zz;\n\t\n\txx=yy=0;\n\tfor(i=0;i<2*n;i++)\n\t{\n\t\tif(s[i]=='a')\n\t\t{\n\t\t\ta[xx++]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tb[yy++]=i;\n\t\t}\n\t}\n\t\n\tbool hasba=false;\n\tbegin=2*n;\n\tfor(i=n-1;i>=0;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tif(b[i]<begin && hasba==false)\n\t\t\t{\n\t\t\t\tans+=\"ab\";\n\t\t\t\tbegin=a[i];\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t\tr.insert(r.begin(),a[i]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttmp=ans;\n\t\t\t\n\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t{\n\t\t\t\tif(r[j]>a[i])\n\t\t\t\t{\n\t\t\t\t\ttmp.insert(tmp.begin()+j,'a');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(j==r.size())\n\t\t\t{\n\t\t\t\ttmp.insert(tmp.end(),'a');\n\t\t\t}\n\t\t\ttmp.insert(tmp.begin(),'b');\n\t\t\t/*\n\t\t\tcout<<i<<' '<<tmp<<endl;\n\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t{\n\t\t\t\tcout<<r[j]<<' ';\n\t\t\t}\n\t\t\tcout<<\" RRRR\"<<endl;\n\t\t\t*/\n\t\t\t\n\t\t\tif(tmp>ans)\n\t\t\t{\n\t\t\t\tans=tmp;\n\t\t\t\tfor(j=0;j<r.size();j++)\n\t\t\t\t{\n\t\t\t\t\tif(r[j]>a[i])\n\t\t\t\t\t{\n\t\t\t\t\t\tr.insert(r.begin()+j,a[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j==r.size())\n\t\t\t\t{\n\t\t\t\t\tr.insert(r.end(),a[i]);\n\t\t\t\t}\n\t\t\t\tr.insert(r.begin(),b[i]);\n\t\t\t}\n\t\t\thasba=true;\n\t\t}\n\t}\n\t\n\tcout<<ans<<endl;\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\n\n#define null               \"\"\n#define endl               '\\n'\n#define all(dat)           dat.begin(), dat.end()\n#define loop(i, to)        for (int i = 0; i < to; ++i)\n#define cont(i, to)        for (int i = 1; i <= to; ++i)\n#define circ(i, fr, to)    for (int i = fr; i <= to; ++i)\n#define foreach(i, dat)    for (__typeof(dat.begin()) i = dat.begin(); i != dat.end(); ++i)\n\ntypedef long long          num;\n\nusing namespace std;\n\nconst int nsz = 2e3;\nint n, pos[2][nsz + 5], id[nsz + 5];\nstring s, dp[nsz + 5];\n\nint main() {\n    cin >> n >> s;\n    s = ' ' + s;\n    int cnt[2] = {0, 0};\n    cont (i, 2 * n) {\n        pos[s[i] - 97][++cnt[s[i] - 97]] = i;\n        id[i] = cnt[s[i] - 'a'];\n    }\n    for (int i = n; i >= 1; --i) {\n        if (pos[0][i] < pos[1][i]) {\n            int to = 0;\n            for (int j = pos[0][i]; j <= pos[1][i]; ++j) {\n                to = max(to, id[j]);\n            }\n            dp[i] = \"ab\" + dp[to + 1];\n        } else {\n            int to = i;\n            while (to <= n && pos[1][to + 1] < pos[0][to]) {\n                ++to;\n            }\n            cont (j, 2 * n) {\n                if (id[j] >= i && id[j] <= to) {\n                    dp[i] += s[j];\n                }\n            }\n            dp[i] += dp[to + 1];\n        }\n//        cout << i << \": \" << dp[i] << endl;\n    }\n    cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ntemplate<typename tn> void read(tn &a){\n\ttn x=0,f=1; char c=' ';\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\ta=x*f;\n}\nint n,a[5010],b[5010],tot;\nchar s[10100];\nstring st[5010];\nint main(){\n\tread(n);\n\tcin>>s+1;\n\tint k1=0,k2=0;\n\tfor(int i=1;i<=2*n;i++)\n\t\tif(s[i]=='a') a[++k1]=i;\n\t\telse b[++k2]=i;\n\tfor(int i=1,lst=1;i<=n;i++)\n\t\tif(i==n||max(a[i],b[i])<min(a[i+1],b[i+1]))\n\t\tif(a[i]<b[i]){\n\t\t\tst[++tot]=\"ab\";\n\t\t\tfor(int j=lst,now=b[lst];j<=i;j++)\n\t\t\t\tif(a[j]>now) st[tot]+=\"ab\",now=b[j];\n\t\t\tlst=i+1;\n\t\t}\n\t\telse{\n\t\t\t++tot;\n\t\t\tfor(int j=lst;j<=i;j++){\n\t\t\t\tqueue<int> S;\n\t\t\t\tstring now;\n\t\t\t\tfor(int k=j;k<=i;k++){\n\t\t\t\t\twhile(S.size()&&S.front()<b[k]) now+=\"a\",S.pop();\n\t\t\t\t\tnow+=\"b\";\n\t\t\t\t\tS.push(a[k]);\n\t\t\t\t}\n\t\t\t\twhile(S.size()) now+='a',S.pop();\n\t\t\t\tst[tot]=max(st[tot],now);\n\t\t\t}\n\t\t\tlst=i+1;\n\t\t}\n\tfor(int i=tot-1;i;i--)\n\t\tst[i]=max(st[i]+st[i+1],st[i+1]);\n\tcout<<st[1]<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*====Corycle====*/\n#include<algorithm>\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cstdlib>\n#include<complex>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<ctime>\n#include<stack>\n#include<queue>\n#include<map>\n#define ll long long\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nconst int N=3005;\nint read(){\n\tint s=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){s=s*10+c-'0';c=getchar();}\n\treturn s*f;\n}\nstring S,F[N];\nint n,m,id[N],PosA[N],PosB[N],nxt[N];\nint main(){\n//\tfreopen(\"_.in\",\"r\",stdin);\n//\tfreopen(\"_.out\",\"w\",stdout);\n\tn=read();cin>>S;S=\" \"+S;\n\tfor(int i=1,n1=0,n2=0;i<=n*2;i++){\n\t\tif(S[i]=='a')PosA[id[i]=++n1]=i;\n\t\tif(S[i]=='b')PosB[id[i]=++n2]=i;\n\t}\n\tid[PosA[n+1]=PosB[n+1]=n*2+1]=n+1;\n\tfor(int i=1,j=1;i<=n+1;i++)while(j<min(PosA[i],PosB[i])){nxt[j]=i;j++;}\n\tfor(int i=n;i>=1;i--){\n\t\tif(PosA[i]<PosB[i])F[i]=\"ab\"+F[nxt[PosB[i]]];\n\t\telse{\n\t\t\tint j=PosB[i],k=PosA[i];\n\t\t\twhile(j<=k&&(id[j]<=i||PosB[id[j]]<=k)){\n\t\t\t\tif(id[j]>=i){F[i]+=S[j];k=max(k,PosA[id[j]]);}\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tF[i]+=F[id[j]];\n\t\t}\n\t\tF[i]=max(F[i],F[i+1]);\n\t}\n\tcout<<F[1]<<'\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define For(i, j, k) for (int i = j; i <= k; i++)\n#define Forr(i, j, k) for (int i = j; i >= k; i--)\n\nusing namespace std;\n\nconst int N = 6010;\n\nint n, c;\nchar S[N];\nint posa[N], to[N];\nbool vis[N];\nstring dp[N];\n\nint main() {\n\n\tscanf(\"%d%s\", &n, S + 1);\n\tFor(i, 1, 2 * n) if (S[i] == 'a') posa[++c] = i;\n\tc = 0;\n\tFor(i, 1, 2 * n) if (S[i] == 'b') to[i] = posa[++c], to[to[i]] = i;\n\n\tForr(i, 2 * n, 1) {\n\t\tif (to[i] > i) {\n\t\t\tif (S[i] == 'a') dp[i] = string(\"a\") + 'b' + dp[to[i]];\n\t\t\telse {\n\t\t\t\tint r = to[i];\n\t\t\t\tmemset(vis, 0, sizeof vis);\n\t\t\t\tvis[i] = vis[r] = true;\n\t\t\t\tFor(j, i + 1, r) if (S[j] == 'b') {\n\t\t\t\t\tvis[j] = vis[to[j]] = true;\n\t\t\t\t\tr = to[j];\n\t\t\t\t}\n\t\t\t\tFor(j, i, r) if (vis[j]) dp[i] += S[j];\n\t\t\t\tdp[i] += dp[r + 1];\n\t\t\t}\n\t\t}\n\t\tdp[i] = max(dp[i], dp[i + 1]);\n\t}\n\n\tcout << dp[1] << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 3005\n#define re register\nusing namespace std;\nint n,la[N<<1],lb[N<<1],loca[N<<1],locb[N<<1];\nchar a[N<<1];\nbool dp[N][N];\nstring ans = \"\";\n\nstring get(bool dp[])//对这个存在性的数组求对应的串 \n{\n\tstring ret = \"\";\n\tfor(re int i=0;i<n * 2;++i)\n\t{\n\t\tif(a[i] == 'a' && dp[la[i]]) ret += \"a\";\n\t\tif(a[i] == 'b' && dp[lb[i]]) ret += \"b\";\n\t}\n\treturn ret;\n}\nint main()\n{\n\tscanf(\"%d%s\",&n,a);\n\tfor(int i=0,ca=0,cb=0;i<n*2;++i)\n\t{\n\t\tif(a[i] == 'a') la[i] = ++ca,loca[ca] = i;\n\t\telse lb[i] = ++cb,locb[cb] = i;\n\t}\n\tdp[n][n] = 1;\n\tfor(int i=n - 1;i>=1;--i)\n\t{\n\t\tint mx = i;\n\t\tdp[i][i] = 1;\n\t\tif(loca[i] < locb[i])\n\t\t{\t\n\t\t\tfor(int j=loca[i] + 1;j<locb[i];++j) if(a[j] == 'a') mx = max(mx,la[j]);\n\t\t\tfor(int j=mx + 1;j<=n;++j) dp[i][j] = dp[mx + 1][j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint R = loca[i];\n\t\t\tfor(int j=locb[i] + 1;j<R;++j) \n\t\t\tif(a[j] == 'b')\n\t\t\t{\n\t\t\t\tR = max(R,loca[lb[j]]);\n\t\t\t\tmx = lb[j]; dp[i][lb[j]] = 1;\n\t\t\t}\n\t\t\tfor(int j=mx + 1;j<=n;++j) dp[i][j] = dp[mx + 1][j];\n\t\t}\n\t\tif(get(dp[i]) < get(dp[i + 1])) memcpy(dp[i],dp[i + 1],sizeof(dp[i]));\n\t}\n\tcout<<get(dp[1])<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#define rep(i,l,r) for(int i=(l);i<=(r);++i)\n#define per(i,r,l) for(int i=(r);i>=(l);--i)\nusing namespace std;\nconst int N=3010;\nstring s,ans;int n,a[N],b[N],lst,tot,cnt;\nbool check(int x,int y){return max(a[x],b[x])<min(a[y],b[y]);}\nint main(){\n    cin>>n>>s;a[0]=b[0]=-1;\n    rep(i,0,2*n-1){\n        if(s[i]=='a') a[++cnt]=i;\n        else b[++tot]=i;\n    }lst=n+1;\n    per(i,n,1) if(check(i-1,i)){\n        if(a[i]<b[i]){\n            int tt=a[i]-1;\n            rep(j,i,lst-1) if(a[j]>tt) ans=max(ans,\"ab\"+ans),tt=b[j];\n        }\n        else{\n            int cnt=0,L=b[i],R=a[lst-1];string str=ans;\n            per(j,R,L) cnt+=s[j]=='a'?1:-1,cnt>=0?ans=max(ans,string(cnt,'b')+s.substr(j,R+1-j)+str):\"\";\n        }\n        lst=i;\n    }\n    cout<<ans;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint a[300010], sum[300010], n;\ninline int check(int x) {\n    int _min = 0;\n    for (int i = 1; i <= n; i += 2) {\n        if (sum[i] - _min >= x) {\n            _min = min(_min, sum[i + 1]);\n            if (i == n) return 1;\n        }\n    }\n    return 0;\n}\nint main() {\n    scanf(\"%d\", &n);\n    int sum1 = 0, sum2 = 0;\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d\", a + i);\n        if (i % 2 == 0) a[i] = -a[i], sum1 -= a[i];\n        else sum2 += a[i];\n        sum[i] = sum[i - 1] + a[i];\n    }\n    if (n % 2 == 0) return printf(\"%d %d\\n\", max(sum1, sum2), min(sum1, sum2)), 0;\n    int ans, l = -1.5e9, r = 1.5e9;\n    while (l <= r) {\n        int mid = l + r >> 1;\n        if (check(mid)) l = mid + 1, ans = mid;\n        else r = mid - 1;\n    }\n    return printf(\"%d %d\\n\", sum1 + ans, sum2 - ans), 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nint n;\nchar s[6003];\nstd::string parts[3003];\nint main()\n{\n\tscanf(\"%d %s\",&n,s);\n\tint i = 0, j = 0;\n\twhile(i < 2 * n) {\n\t\tstd::string max;\n\t\tint sum = 0;\n\t\tint type = s[i] - 'a';\n\t\tstd::vector<int> va, vb;\n\t\tdo {\n\t\t\tif(s[i] == 'a') {\n\t\t\t\t++sum;\n\t\t\t\tva.push_back(i);\n\t\t\t} else {\n\t\t\t\t--sum;\n\t\t\t\tvb.push_back(i);\n\t\t\t}\n\t\t\t++i;\n\t\t} while(sum != 0);\n\t\tif(type == 0) {\n\t\t\twhile(!va.empty()) {\n\t\t\t\tmax += \"ab\";\n\t\t\t\tint j = vb[0];\n\t\t\t\twhile(!va.empty() && va[0] < j) {\n\t\t\t\t\tva.erase(va.begin());\n\t\t\t\t\tvb.erase(vb.begin());\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint s = va.size();\n\t\t\tfor(int k = 0;k < s;++k) {\n\t\t\t\tstd::string cur;\n\t\t\t\tint a = k, b = k;\n\t\t\t\twhile(a < s || b < s) {\n\t\t\t\t\tif(b == s || (a != s && va[a] < vb[b])) {\n\t\t\t\t\t\tcur.push_back('a');\n\t\t\t\t\t\t++a;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcur.push_back('b');\n\t\t\t\t\t\t++b;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(cur > max) max = cur;\n\t\t\t}\n\t\t}\n\t\tparts[j++] = max;\n\t}\n\tstd::string max, ans;\n\tfor(int k = j-1;k >= 0;--k) {\n\t\tif(parts[k] >= max) {\n\t\t\tmax = parts[k];\n\t\t\tans = max + ans;\n\t\t}\n\t}\n\tprintf(\"%s\\n\", ans.c_str());\n\t\t\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define ll int\n#define pb push_back\n#define mp make_pair\n#define ld long double\n#define F first\n#define S second\n#define pii pair<ll,ll>\n#define pie pair<pii,ll>\nusing namespace :: std;\n\nconst ll maxn=6100;\nll dp[maxn];\nll a[maxn];\nll b[maxn];\nll o[maxn];\nstring fa(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n\n    fill(dp,dp+maxn,0);\n    for(ll i=n-2;i>=0;i--){\n        dp[i]=dp[i+1];\n        if(s[i]=='a'){\n            dp[i]=max(dp[i],1+dp[b[o[i]]]);\n        }\n    }\n    string ans;\n    for(ll i=0;i<dp[0];i++){\n        ans+=\"ab\";\n    }\n    return ans;\n}\nstring fb(string s){\n    if(s==\"\")return \"\";\n    ll n=s.size();\n    ll cnta=0;\n    ll cntb=0;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='a'){\n            a[cnta]=i;\n            o[i]=cnta;\n            cnta++;\n        }else{\n            b[cntb]=i;\n            o[i]=cntb;\n            cntb++;\n        }\n    }\n    string maxx;\n    for(ll i=0;i<n;i++){\n        if(s[i]=='b'){\n            string res=\"\";\n            for(ll j=i;j<n;j++){\n                if(o[j]>=o[i]){\n                    res+=s[j];\n                }\n            }\n            maxx=max(maxx,res);\n        }\n    }\n    return maxx;\n\n}\nint main()\n{\n    ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n    string s;\n    ll n;\n    cin>>n>>s;\n    n*=2;\n    string last;\n    ll sum=0;\n    vector<string> vec;\n    for(ll i=0;i<n;i++){\n        last+=s[i];\n        if(s[i]=='a'){\n            sum++;\n        }else{\n            sum--;\n        }\n        if(sum==0){\n            vec.pb(last);\n            last=\"\";\n        }\n    }\n    if(last.size()>0)\n        vec.pb(last);\n    string sara;\n    string sarb;\n    for(ll i=vec.size()-1;i>=0;i--){\n        if(sarb==\"\"){\n            if(vec[i][0]=='b'){\n                sarb=vec[i];\n            }else{\n                sara=vec[i]+sara;\n            }\n        }else{\n            if(vec[i][0]=='b'){\n                sarb=vec[i]+sarb;\n            }\n        }\n    }\n    cout<<fb(sarb)+fa(sara);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\n#include<ctime>\n#include<utility>\n#include<functional>\n#include<cmath>\n#include<vector>\n//using namespace std;\nusing std::min;\nusing std::max;\nusing std::swap;\nusing std::sort;\nusing std::reverse;\nusing std::random_shuffle;\nusing std::lower_bound;\nusing std::upper_bound;\nusing std::unique;\nusing std::vector;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef double db;\ntypedef std::pair<int,int> pii;\ntypedef std::pair<ll,ll> pll;\nvoid open(const char *s){\n#ifndef ONLINE_JUDGE\n\tchar str[100];sprintf(str,\"%s.in\",s);freopen(str,\"r\",stdin);sprintf(str,\"%s.out\",s);freopen(str,\"w\",stdout);\n#endif\n}\nvoid open2(const char *s){\n#ifdef DEBUG\n\tchar str[100];sprintf(str,\"%s.in\",s);freopen(str,\"r\",stdin);sprintf(str,\"%s.out\",s);freopen(str,\"w\",stdout);\n#endif\n}\nint rd(){int s=0,c,b=0;while(((c=getchar())<'0'||c>'9')&&c!='-');if(c=='-'){c=getchar();b=1;}do{s=s*10+c-'0';}while((c=getchar())>='0'&&c<='9');return b?-s:s;}\nvoid put(int x){if(!x){putchar('0');return;}static int c[20];int t=0;while(x){c[++t]=x%10;x/=10;}while(t)putchar(c[t--]+'0');}\nint upmin(int &a,int b){if(b<a){a=b;return 1;}return 0;}\nint upmax(int &a,int b){if(b>a){a=b;return 1;}return 0;}\nconst int N=200010;\nint l[N],r[N];\nint cnt;\nchar str[N];\nint n;\nint t;\nint s[2*N];\nint t2;\nint m;\nint k;\nint st[N];\nvoid gao(int x)\n{\n\tif(str[l[x]]=='a')\n\t{\n\t\tfor(int i=l[x],b0=0,b1=0;i<=r[x];i++)\n\t\t{\n\t\t\tif(str[i]=='a')\n\t\t\t\tb0=1;\n\t\t\telse\n\t\t\t\tb1=1;\n\t\t\tif(b0&&b1)\n\t\t\t{\n\t\t\t\ts[++m]='a';\n\t\t\t\tst[++k]=m;\n\t\t\t\ts[++m]='b';\n\t\t\t\ts[++m]=-(++t2);\n\t\t\t\tb0=b1=0;\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tst[++k]=m+1;\n\t\tfor(int i=l[x];i<=r[x];i++)\n\t\t\ts[++m]=str[i];\n\t\ts[++m]=-(++t2);\n\t}\n}\nnamespace sa\n{\n\tint x[2*N];\n\tint y[2*N];\n\tint b[2*N];\n\tint sa[2*N];\n\tint rk[2*N];\n\tvoid buildsa()\n\t{\n\t\tint sz=26+t2;\n\t\tfor(int i=1;i<=sz;i++)\n\t\t\tb[i]=0;\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tb[x[i]=(s[i]<0?t2+s[i]+1:s[i]-'a'+t2+1)]++;\n\t\tfor(int i=2;i<=sz;i++)\n\t\t\tb[i]+=b[i-1];\n\t\tfor(int i=m;i>=1;i--)\n\t\t\tsa[b[x[i]]--]=i;\n\t\tfor(int j=1;j<=m;j<<=1)\n\t\t{\n\t\t\tint k=0;\n\t\t\tfor(int i=m-j+1;i<=m;i++)\n\t\t\t\ty[++k]=i;\n\t\t\tfor(int i=1;i<=m;i++)\n\t\t\t\tif(sa[i]>j)\n\t\t\t\t\ty[++k]=sa[i]-j;\n\t\t\tfor(int i=1;i<=sz;i++)\n\t\t\t\tb[i]=0;\n\t\t\tfor(int i=1;i<=m;i++)\n\t\t\t\tb[x[y[i]]]++;\n\t\t\tfor(int i=2;i<=sz;i++)\n\t\t\t\tb[i]+=b[i-1];\n\t\t\tfor(int i=m;i>=1;i--)\n\t\t\t\tsa[b[x[y[i]]]--]=y[i];\n\t\t\tswap(x,y);\n\t\t\tk=0;\n\t\t\tfor(int i=1;i<=m;i++)\n\t\t\t\tif(i!=1&&(y[sa[i]]==y[sa[i-1]]&&(sa[i]+j>m&&sa[i-1]+j>m||sa[i]+j<=m&&sa[i-1]+j<=m&&y[sa[i-1]+j]==y[sa[i]+j])))\n\t\t\t\t\tx[sa[i]]=k;\n\t\t\t\telse\n\t\t\t\t\tx[sa[i]]=++k;\n\t\t\tsz=k;\n\t\t\tif(sz>=m)\n\t\t\t\tbreak;\n\t\t}\n\t\tfor(int i=1;i<=m;i++)\n\t\t\trk[sa[i]]=i;\n\t}\n}\nusing sa::buildsa;\nint mx[N];\nvoid output(int x)\n{\n\tfor(;s[x]>=0;x++)\n\t\tputchar(s[x]);\n}\nint main()\n{\n\topen2(\"agc026e\");\n\tscanf(\"%d\",&n);\n\tn*=2;\n\tscanf(\"%s\",str+1);\n\tcnt=1;\n\tl[1]=1;\n\tint t=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(str[i]=='a')\n\t\t\tt++;\n\t\telse\n\t\t\tt--;\n\t\tif(!t)\n\t\t{\n\t\t\tr[cnt]=i;\n\t\t\tcnt++;\n\t\t\tl[cnt]=i+1;\n\t\t}\n\t}\n\tcnt--;\n\tfor(int i=1;i<=cnt;i++)\n\t\tgao(i);\n\tbuildsa();\n\tfor(int i=k;i>=1;i--)\n\t\tmx[i]=max(mx[i+1],sa::rk[st[i]]);\n\tfor(int i=1;i<=k;i++)\n\t\tif(mx[i]>mx[i+1])\n\t\t\toutput(st[i]);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define F first\n#define S second\n#define pii pair<int, int>\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\n\nconst int maxN = 6010;\n\nint ptr[maxN];\nstring s, best[maxN];\n\ninline void solve(int k, int L, int R)\n{\n\tif(s[L] == 'a')\n\t{\n\t\tvector <int> va, vb;\n\t\tfor (int i=L; i<R; i++)\n\t\t\tif(s[i] == 'a') va.pb(i);\n\t\t\telse vb.pb(i);\n\n\t\tint p = 0, len = (R - L)/2;\n\t\twhile(p < len)\n\t\t{\n\t\t\tbest[k] += \"ab\";\n\t\t\tint q = p;\n\t\t\twhile(q < len && va[q] < vb[p]) q++;\n\t\t\tp = q;\n\t\t}\n\t\treturn ;\n\t}else\n\t{\n\t\tfor (int i=L/2; i<R/2; i++)\n\t\t{\n\t\t\tstring curr = \"\";\n\t\t\tfor (int j=L; j<R; j++)\n\t\t\t\tif(ptr[j] >= i) curr += s[j];\n\t\t\tbest[k] = max(best[k], curr);\n\t\t}\n\t\treturn ;\n\t}\n}\n\nint main()\n{\n\tios_base::sync_with_stdio(0); cin.tie(0);\n\n\tint n; cin >> n;\n\tcin >> s;\n\n\tfor (int cnt1=0, cnt2=0, i=0; i<2*n; i++)\n\t\tif(s[i] == 'a') ptr[i] = cnt1 ++;\n\t\telse ptr[i] = cnt2 ++;\n\n\tint a = 0, b = 0, td = 0, L = 0;\n\tfor (int i=0; i<2*n; i++)\n\t{\n\t\tif(s[i] == 'a') a++;\n\t\telse b++;\n\n\t\tif(a == b)\n\t\t{\n\t\t\ta = b = 0;\n\t\t\tsolve(td, L, i + 1);\n\t\t\ttd ++;\n\t\t\tL = i + 1;\n\t\t}\n\t}\n\n\tstring ans = \"\";\n\tfor (int i=td-1; i>=0; i--)\n\t\tans = max(ans, best[i] + ans);\n\tcout << ans << endl;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "/*{{{*/\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<set>\n#include<map>\n#include<queue>\n#include<bitset>\n#include<vector>\n#include<limits.h>\n#include<assert.h>\n#define SZ(X) ((int)(X).size())\n#define ALL(X) (X).begin(), (X).end()\n#define REP(I, N) for (int I = 0; I < (N); ++I)\n#define REPP(I, A, B) for (int I = (A); I < (B); ++I)\n#define FOR(I, A, B) for (int I = (A); I <= (B); ++I)\n#define FORS(I, S) for (int I = 0; S[I]; ++I)\n#define RS(X) scanf(\"%s\", (X))\n#define SORT_UNIQUE(c) (sort(c.begin(),c.end()), c.resize(distance(c.begin(),unique(c.begin(),c.end()))))\n#define GET_POS(c,x) (lower_bound(c.begin(),c.end(),x)-c.begin())\n#define CASET int ___T; scanf(\"%d\", &___T); for(int cs=1;cs<=___T;cs++)\n#define MP make_pair\n#define PB push_back\n#define MS0(X) memset((X), 0, sizeof((X)))\n#define MS1(X) memset((X), -1, sizeof((X)))\n#define LEN(X) strlen(X)\n#define F first\n#define S second\nusing namespace std;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef long double LD;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<LL> VL;\ntypedef vector<PII> VPII;\ntypedef pair<LL,LL> PLL;\ntypedef vector<PLL> VPLL;\ntemplate<class T> void _R(T &x) { cin >> x; }\nvoid _R(int &x) { scanf(\"%d\", &x); }\nvoid _R(LL &x) { scanf(\"%lld\", &x); }\nvoid _R(double &x) { scanf(\"%lf\", &x); }\nvoid _R(char &x) { scanf(\" %c\", &x); }\nvoid _R(char *x) { scanf(\"%s\", x); }\nvoid R() {}\ntemplate<class T, class... U> void R(T &head, U &... tail) { _R(head); R(tail...); }\ntemplate<class T> void _W(const T &x) { cout << x; }\nvoid _W(const int &x) { printf(\"%d\", x); }\nvoid _W(const LL &x) { printf(\"%lld\", x); }\nvoid _W(const double &x) { printf(\"%.16f\", x); }\nvoid _W(const char &x) { putchar(x); }\nvoid _W(const char *x) { printf(\"%s\", x); }\ntemplate<class T,class U> void _W(const pair<T,U> &x) {_W(x.F); putchar(' '); _W(x.S);}\ntemplate<class T> void _W(const vector<T> &x) { for (auto i = x.begin(); i != x.end(); _W(*i++)) if (i != x.cbegin()) putchar(' '); }\nvoid W() {}\ntemplate<class T, class... U> void W(const T &head, const U &... tail) { _W(head); putchar(sizeof...(tail) ? ' ' : '\\n'); W(tail...); }\n#ifdef HOME\n #define DEBUG(...) {printf(\"# \");printf(__VA_ARGS__);puts(\"\");}\n#else\n #define DEBUG(...)\n#endif\nint MOD = 1e9+7;\nvoid ADD(LL& x,LL v){x=(x+v)%MOD;if(x<0)x+=MOD;}\n/*}}}*/\nconst int SIZE = 1e6+10;\nchar s[SIZE];\nPII d[SIZE];\nint main(){\n    int N; R(N);\n    RS(s);\n    int AA[2]={};\n    REP(i,2*N){\n        if(s[i]=='a'){\n            d[AA[0]++].F=i;\n        }\n        else{\n            d[AA[1]++].S=i;\n        }\n    }\n    bool a_start=1;\n    REP(i,N){\n        if(d[i].F>d[i].S){\n            a_start=0;\n        }\n    }\n    if(a_start){\n        VI dp(N);\n        dp[0]=1;\n        int ma=1;\n        REPP(i,1,N){\n            REP(j,i){\n                if(d[j].S<d[i].F)dp[i]=max(dp[i],dp[j]+1);\n            }\n            ma=max(ma,dp[i]);\n        }\n        REP(i,ma)printf(\"ab\");\n        W(\"\");\n    }\n    else{\n        string dp0[3001];\n        for(int i=N-1;i>=0;i--){\n            if(d[i].F>=d[i].S)continue;\n            dp0[i]=\"ab\";\n            REPP(j,i+1,N){\n                if(d[i].S<d[j].F){\n                    dp0[i]=max(dp0[i],\"ab\"+dp0[j]);\n                }\n            }\n        }\n        string an=\"\";\n        REP(i,N){\n            if(d[i].S<d[i].F){\n                VI u(N*2);\n                REPP(j,i,N){\n                    if(d[j].S<d[j].F){\n                        u[d[j].S]=u[d[j].F]=1;\n                    }\n                }\n                string tmp=\"\";\n                int lt=0;\n                REPP(j,d[i].S,2*N){\n                    if(u[j]){\n                        tmp+=s[j];\n                        lt=j;\n                    }\n                }\n                string tail=\"\";\n                REP(j,N){\n                    if(d[j].F>lt){\n                        tail=max(tail,dp0[j]);\n                    }\n                }\n                an=max(an,tmp+tail);\n            }\n        }\n        W(an);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\n\nint main(){\n//    for(LL i=1;i<=5;++i) a[i]=1;\n//    return 0;\n    scanf(\"%d\",&n);\n    scanf(\" %s\",s+1);\n    LL N(2*n);\n    for(LL i=1;i<=2000;++i) a[i]=(s[i]-'a');\n//    return 0;\n    \n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \ta[i]=0;\n\t}else a[i]=1;\n//    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define pw(x) (1LL << (x))\n#define db(x) cerr << #x << \" = \" << x << endl\n#define db2(x, y) cerr << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl\n\nusing namespace std;\ntypedef long long ll;\ntypedef double dbl;\nconst int INF = 1.01e9;\nconst int MOD = (int)1e9 + 7;\n\n\nint main() {\n#ifdef HOME\n    assert(freopen(\"in\", \"r\", stdin));\n#endif\n\n    int n;\n    string s;\n    while (cin >> n >> s) {\n        vector<vector<int>> pos(2);\n        for (int i = 0; i < n * 2; i++) {\n            pos[s[i] - 'a'].push_back(i);\n        }\n        vector<pair<int, int>> b;\n        for (int i = 0; i < n; i++) {\n            b.push_back({pos[0][i], pos[1][i]});\n        }\n        /*vector<int> b(2 * n);\n        for (int i = 0; i < n; i++) {\n            if (pos[0][i] > pos[1][i]) {\n                b[pos[0][i]]++;\n            }\n        }\n        */\n        string t;\n        vector<int> vct;\n        for (int i = n - 1; i >= 0; i--) {\n            int mn = min(b[i].first, b[i].second);\n            int mx = max(b[i].first, b[i].second);\n            int j = 0;\n            while (j < (int)vct.size() && vct[j] < mx) j++;\n\n            auto nt = t;\n            nt.insert(nt.begin() + j, s[mx]);\n            nt.insert(nt.begin(), s[mn]);\n            auto nvct = vct;\n            nvct.insert(nvct.begin() + j, mx);\n            nvct.insert(nvct.begin(), mn);\n\n            if (t < nt) {\n                t = nt;\n                vct = nvct;\n            }\n        }\n        cout << t << endl;\n    }\n\n#ifdef HOME\n    cerr << \"time = \" << (clock() * 1. / CLOCKS_PER_SEC) << \"\\n\";\n#endif\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/**\n * code generated by JHelper\n * More info: https://github.com/AlexeyDmitriev/JHelper\n * @author majk\n */\n\n#ifndef MAJK_LIB\n#define MAJK_LIB\n\n#include <vector>\n#include <stack>\n#include <iostream>\n#include <fstream>\n#include <unordered_map>\n#include <unordered_set>\n#include <map>\n#include <iomanip>\n#include <set>\n#include <functional>\n#include <algorithm>\n#include <numeric>\n#include <cassert>\n#include <cmath>\n#include <string>\n#include <queue>\n#include <array>\n#include <bitset>\nusing namespace std;\n\n#define x first\n#define y second\ntypedef std::pair<int,int> pii; typedef long long ll; typedef unsigned long long ull; typedef unsigned int ui; typedef pair<ui,ui> puu;\n\ntemplate <typename T, typename U> std::istream&operator>>(std::istream&i, pair<T,U>&p) {i >> p.x >> p.y; return i;}\ntemplate<typename T>std::istream&operator>>(std::istream&i,vector<T>&t) {for(auto&v:t){i>>v;}return i;}\ntemplate <typename T, typename U> std::ostream&operator<<(std::ostream&o, const pair<T,U>&p) {o << p.x << ' ' << p.y; return o;}\ntemplate<typename T>std::ostream&operator<<(std::ostream&o,const vector<T>&t) {if(t.empty())o<<'\\n';for(size_t i=0;i<t.size();++i){o<<t[i]<<\" \\n\"[i == t.size()-1];}return o;}\ntemplate<typename T> using minheap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T> using maxheap = priority_queue<T, vector<T>, less<T>>;\nui logceil(ll x) { return x?8*sizeof(ll)-__builtin_clzll(x):0; }\n\nnamespace std { template<typename T,typename U>struct hash<pair<T,U>>{hash<T>t;hash<U>u;size_t operator()(const pair<T,U>&p)const{return t(p.x)^(u(p.y)<<7);}}; }\ntemplate<typename T,typename F>T bsh(T l,T h,const F&f){T r=-1,m;while(l<=h){m=(l+h)/2;if(f(m)){l=m+1;r=m;}else{h=m-1;}}return r;}\ntemplate<typename F> double bshd(double l,double h,const F&f,double p=1e-9){ui r=3+(ui)log2((h-l)/p);while(r--){double m=(l+h)/2;if(f(m)){l=m;}else{h=m;}}return (l+h)/2;}\ntemplate<typename T,typename F>T bsl(T l,T h,const F&f){T r=-1,m;while(l<=h){m=(l+h)/2;if(f(m)){h=m-1;r=m;}else{l=m+1;}}return r;}\ntemplate<typename F> double bsld(double l,double h,const F&f){ui r=200;while(r--){double m=(l+h)/2;if(f(m)){h=m;}else{l=m;}}return (l+h)/2;}\ntemplate<typename T> T gcd(T a,T b) { if (a<b) swap(a,b); return b?gcd(b,a%b):a; }\n\n\ntemplate<typename T>class vector2:public vector<vector<T>>{public:vector2(){} vector2(size_t a,size_t b,T t=T()):vector<vector<T>>(a,vector<T>(b,t)){}};\ntemplate<typename T>class vector3:public vector<vector2<T>>{public:vector3(){} vector3(size_t a,size_t b,size_t c,T t=T()):vector<vector2<T>>(a,vector2<T>(b,c,t)){}};\ntemplate<typename T>class vector4:public vector<vector3<T>>{public:vector4(){} vector4(size_t a,size_t b,size_t c,size_t d,T t=T()):vector<vector3<T>>(a,vector3<T>(b,c,d,t)){}};\ntemplate<typename T>class vector5:public vector<vector4<T>>{public:vector5(){} vector5(size_t a,size_t b,size_t c,size_t d,size_t e,T t=T()):vector<vector4<T>>(a,vector4<T>(b,c,d,e,t)){}};\n\n\n#endif\n\nclass ESynchronizedSubsequence {\npublic:\n    void solve(istream& cin, ostream& cout) {\n        int N; cin >> N;\n        string S; cin >> S;\n        vector<int> A, B;\n        int bal = 0;\n        int last = 0;\n        auto solve = [&](int x, int y) {\n            if (A[x] < B[x]) {\n                int j = -1;\n                string ans;\n                for (int i = x; i <= y; ++i) {\n                    if (A[i] > j) { ans += \"ab\"; j = B[i]; }\n                }\n                return ans;\n            } else {\n                string ans = \"\";\n                for (int i = x; i <= y; ++i) {\n                    int j = i, k = i;\n                    string cur = \"\";\n                    while (j <= y || k <= y) {\n                        if (j > y) {\n                            cur += \"b\";\n                            k++;\n                        } else if (k > y) {\n                            cur += \"a\";\n                            j++;\n                        } else if (A[j] < B[k]) {\n                            cur += \"a\";\n                            j++;\n                        } else {\n                            cur += \"b\";\n                            k++;\n                        }\n                    }\n                    ans = max(ans, cur);\n                }\n                return ans;\n            }\n        };\n        vector<string> O;\n        for (int i = 0; i < 2*N; ++i) {\n            if (S[i] == 'a') {\n                A.push_back(i);\n                ++bal;\n            } else {\n                B.push_back(i);\n                --bal;\n            }\n            if (bal == 0) {\n                O.push_back(solve(last, B.size()-1));\n                last = B.size();\n            }\n        }\n\n        O.push_back(solve(last, B.size()-1));\n        string Ans;\n        for (int i = 0; i < O.size(); ++i) {\n            bool ok = true;\n            for (int j = i+1; j < O.size(); ++j) {\n                ok &= O[j] <= O[i];\n            }\n            if (ok) Ans += O[i];\n        }\n        cout << Ans << endl;\n\n\n    }\n};\n\n\n\nint main() {\n\tios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr);\n\tESynchronizedSubsequence solver;\n\tstd::istream& in(std::cin);\n\tstd::ostream& out(std::cout);\n\tsolver.solve(in, out);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6010;\nint n,a[N],b[N],f[N],ans[N][N],top[N]; char s[N];\nstring tmp[N],dp[N],mx[N]; bool vis[N];\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    for(int i=1; i<=2*n; ++i)\n        if(s[i]=='a')a[++a[0]]=i;\n        else b[++b[0]]=i;\n    a[0]=b[0]=0;\n    bool flag=0;\n    for(int i=1; i<=n; ++i)\n        if(b[i]<a[i])flag=1;\n    if(!flag){\n        for(int i=1; i<=n; ++i)f[i]=1;\n        for(int i=1; i<=n; ++i)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i])f[i]=max(f[i],f[j]+1);\n        int ans=0;\n        for(int i=1; i<=n; ++i)ans=max(ans,f[i]);\n        for(int i=1; i<=ans; ++i)printf(\"ab\");\n        return 0;\n    }\n    for(int i=1; i<=n; ++i)if(b[i]<a[i]){\n        int t=a[i]; ans[i][top[i]=1]=i;\n        for(int j=i+1; j<=n; ++j){\n            if(b[j]>t)break;\n            if(b[j]<a[j]){\n                t=max(t,a[j]);\n                ans[i][++top[i]]=j;\n            }\n        }\n    }\n    for(int i=1; i<=n; ++i){\n        memset(vis,0,sizeof(vis));\n        for(int j=1; j<=top[i]; ++j)\n            vis[a[ans[i][j]]]=vis[b[ans[i][j]]]=1;\n        for(int j=1; j<=2*n; ++j)\n            if(vis[j])tmp[i]=tmp[i]+s[j];\n    }\n    for(int i=n,t=n; i>=1; --i)if(a[i]>b[i]){\n        while(t>i&&b[t]>a[ans[i][top[i]]])--t; ++t;\n        dp[i]=tmp[i]+mx[t]; --t;\n        mx[i]=max(mx[i+1],dp[i]);\n    }else mx[i]=mx[i+1];\n    int pos=0;\n    for(int i=1; i<=n; ++i)\n        if(dp[i]==mx[1]){\n            pos=i; break;\n        }\n    /*int R=a[ans[pos][top[pos]]];\n    for(int i=1; i<=n; ++i)if(a[i]>R)f[i]=1;\n    for(int i=1; i<=n; ++i)\n        if(a[i]>R)\n            for(int j=1; j<i; ++j)\n                if(b[j]<a[i]&&a[j]>R)f[i]=max(f[i],f[j]+1);\n    int res=0;\n    for(int i=1; i<=n; ++i)res=max(res,f[i]);*/\n    cout << mx[1]; //for(int i=1; i<=res; ++i)printf(\"ab\");\n    return 0;\n}\n/*\n11\nabbbaababaababbabaabaabb\n*/"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n;\nconst int N=3010;\nint posa[N],posb[N],id[N<<1],nt[N<<1];\nstring s,f[N];\nint main()\n{\n\tcin>>n>>s;s=\" \"+s;\n\tfor(int i=1,a=0,b=0;i<=n*2;++i)\n\t\tif(s[i]=='a')posa[id[i]=++a]=i;\n\t\telse posb[id[i]=++b]=i;\n\tposa[n+1]=posb[n+1]=2*n+1;id[2*n+1]=n+1;\n\tfor(int i=1,j=0;i<=n+1;++i)\n\t\twhile(j<min(posa[i],posb[i]))nt[++j]=i;\n    for(int i=n;i>=1;--i)\n    {\n    \tif(posa[i]>posb[i])\n    \t{\n    \t\tint j=posb[i];\n    \t\tfor(;posb[id[j]]<posa[id[j]]&&(id[j]<=i||posb[id[j]]<posa[id[j]-1]);++j)\n    \t\t\tif(id[j]>=i)f[i]+=s[j];\n    \t\tf[i]+=f[id[j]];\n\t\t}\n\t\telse f[i]=\"ab\"+f[nt[posb[i]+1]];\n    \tf[i]=max(f[i],f[i+1]);\n\t}\n\tcout<<f[1];\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <math.h>\n#include <string.h>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <set>\n#include <list>\n#include <bitset>\n\nusing namespace std;\n\n#define fi first\n#define se second\n#define long long long\ntypedef pair<int,int> ii;\ntypedef pair<int,ii> iii;\n\nint A[5003], B[5003];\nstring dp[5003];\nvector<string> vec, opt;\n\nint main()\n{\n\tios_base::sync_with_stdio(); cin.tie(0); cout.tie(0);\n\t// freopen(\"input.in\", \"r\", stdin);\n\t\n\tint n; cin >> n;\n\tstring s; cin >> s;\n\tint cnt1 = 0, cnt2 = 0;\n\tstring temp = \"\";\n\tfor(int i = 0; i < s.size(); i++)\n\t{\n\t\ttemp += s[i];\n\t\tcnt1 += (s[i] == 'a');\n\t\tcnt2 += (s[i] == 'b');\n\t\tif(cnt1 == cnt2)\n\t\t{\n\t\t\tvec.push_back(temp);\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\ttemp = \"\";\n\t\t}\n\t}\n\tfor(string t : vec)\n\t{\n\t\t// cout << \"T : \" << t << \"\\n\"; fflush(stdout);\n\t\tstring temp = \"\";\t\n\t\tif(t[0] == 'a')\n\t\t{\n\t\t\tcnt1 = cnt2 = 1;\n\t\t\tfor(int i = 0; i < t.size(); i++)\n\t\t\t{\n\t\t\t\tif(t[i] == 'a') A[cnt1++] = i;\n\t\t\t\tif(t[i] == 'b') B[cnt2++] = i;\n\t\t\t}\n\t\t\tint ri = -1;\n\t\t\tfor(int i = 1; i <= n; i++)\n\t\t\t{\n\t\t\t\t// cout << A[i] << \" \" << B[i] << \" \" << ri << \"\\n\";\n\t\t\t\tif(A[i] > ri)\n\t\t\t\t{\n\t\t\t\t\ttemp += \"ab\";\n\t\t\t\t\tri = B[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttemp = \"\";\n\t\t\tstring now = \"\";\n\t\t\tcnt1 = cnt2 = 0;\n\t\t\tfor(int i = t.size()-1; i >= 0; i--)\n\t\t\t{\n\t\t\t\tnow += t[i];\n\t\t\t\tcnt1 += (t[i] == 'a');\n\t\t\t\tcnt2 += (t[i] == 'b');\n\t\t\t\tstring temp2 = now;\n\t\t\t\tint cnt3 = cnt2;\n\t\t\t\tint j = i;\n\t\t\t\twhile(cnt3 != cnt1)\n\t\t\t\t{\n\t\t\t\t\tj--;\n\t\t\t\t\tif(t[j] == 'a') continue;\n\t\t\t\t\ttemp2 += 'b';\n\t\t\t\t\tcnt3++;\n\t\t\t\t}\n\t\t\t\treverse(temp2.begin(), temp2.end());\n\t\t\t\ttemp = max(temp,temp2);\n\t\t\t}\n\t\t\topt.push_back(temp);\n\t\t}\n\t}\n\tstring ans = \"\";\n\tfor(int i = 0; i < opt.size(); i++)\n\t{\n\t\tdp[i] = opt[i];\n\t\tans = max(dp[i], ans);\n\t\tfor(int j = 0; j < i; j++)\n\t\t{\n\t\t\tdp[i] = max(dp[i], dp[j]+opt[i]);\n\t\t\tans = max(dp[i], ans);\n\t\t}\n\t}\n\tcout << ans << \"\\n\";\n}\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <random>\n#include <set>\n#include <sstream>\n#include <string>\n#include <utility>\n#include <vector>\n\nconst int DEBUG = 0;\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n#define DEBUGP(val) cerr << #val << \"=\" << val << \"\\n\"\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\n\nstring compact_pos(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  int delta = 0;\n  string cur;\n  REP(i, 0, n + 1) {\n    ma = max(ma, cur + s.substr(i, n));\n    if (i == n) break;\n    if (cur.size() > 0){\n      if (cur[cur.size() - 1] == 'a' && s[i] == 'b') {\n\tassert (delta > 0);\n\tcur = string(delta, 'b');\n      }\n    }\n    cur += s[i];\n    delta += s[i] == 'b' ? 1 : -1;\n  }\n  return ma;\n}\n\nstring compact_neg(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  string cur;\n  REP(i, 1, n) {\n    if (s[i - 1] == 'a' && s[i] == 'b') {\n      cur += \"ab\";\n    }\n  }\n  return cur;\n}\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> cand;\n  string ma = \"\";\n  int delta = 0;\n  VI zeros(1, 0);\n  REP(i, 0, 2 * n) {\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) zeros.push_back(i + 1);\n  }\n  REP(i, 0, zeros.size() - 1) {\n    int ta = zeros[i];\n    int tb = zeros[i + 1];\n    string u = s.substr(ta, tb - ta);\n    cand.push_back(u[0] == 'a' ? compact_neg(u) : compact_pos(u));\n  }\n  if (DEBUG) {\n    REP(i, 0, cand.size()) {\n      DEBUGP(cand[i]);\n    }\n  }\n  ma = \"\";\n  for (int i = (int)cand.size() - 1; i >= 0; --i) {\n    ma = max(ma, cand[i] + ma);\n  }\n  cout << ma << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing std::pair;\nusing std::vector;\nusing std::string;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\n#define fst first\n#define snd second\n#define pb(a) push_back(a)\n#define mp(a, b) std::make_pair(a, b)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntemplate <typename T> bool chkmax(T& a, T b) { return a < b ? a = b, 1 : 0; }\ntemplate <typename T> bool chkmin(T& a, T b) { return a > b ? a = b, 1 : 0; }\n\nconst int oo = 0x3f3f3f3f;\n\nstring procStatus() {\n    std::ifstream t(\"/proc/self/status\");\n    return string(std::istreambuf_iterator<char>(t), std::istreambuf_iterator<char>());\n}\n\ntemplate <typename T> T read(T& x) {\n    int f = 1; x = 0;\n    char ch = getchar();\n    for(;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1;\n    for(; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    return x *= f;\n}\n\nconst int N = 6000;\n\nint n;\nstring str;\nint a[N + 5], b[N + 5];\n\nstring solve0(int l, int r) {\n    string res = \"ab\";\n    int pa = l + 1, pb = b[l];\n\n    while(a[r] > pb) {\n        while(a[pa] < pb) ++ pa;\n        res += \"ab\";\n        pb = b[pa];\n    }\n    return res;\n}\n\nbool vis[N + 5];\nstring solve1(int l, int r) {\n    string res;\n    for(int i = l; i <= r; ++i) vis[a[i]] = vis[b[i]] = true;\n    for(int i = l; i <= r; ++i) {\n        string temp;\n        for(int j = 0; j < (n << 1); ++j) if(vis[j]) temp += str[j];\n        vis[a[i]] = vis[b[i]] = false;\n        chkmax(res, temp);\n    }\n    return res;\n}\n\nint main() {\n#ifdef Wearry\n    freopen(\"in\", \"r\", stdin);\n    freopen(\"out\", \"w\", stdout);\n#endif\n\n    read(n);\n    std::cin >> str;\n\n    for(int i = 0; i < (n << 1); ++i) {\n        if(str[i] == 'a') a[++ a[0]] = i; else b[++ b[0]] = i;\n    }\n\n    string tmp, ans;\n    vector<string> stk;\n\n    for(int i = 1; i <= n; ++i) {\n        int j = i;\n        if(a[i] < b[i]) {\n            while(j + 1 <= n && a[j + 1] < b[j + 1]) ++ j;\n            tmp = solve0(i, j), i = j;\n        } else {\n            while(j + 1 <= n && a[j + 1] > b[j + 1]) ++ j;\n            tmp = solve1(i, j), i = j;\n        }\n\n        stk.push_back(tmp);\n    }\n\n    std::reverse(stk.begin(), stk.end());\n    for(auto s : stk) {\n        chkmax(ans, s + ans);\n    }\n    std::cout << ans << std::endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\nint fre(int i) {\n\tint id = loc[i];\n\tif (s[i] == 'a')return vb[id];\n\telse return va[id];\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (fre(i)>i) {\n\t\t\t\tint to = fre(i) + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[fre(i)] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn;\n\n\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size()) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && fre(to) < to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i] | ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tz[i].push_back(i);\n\t\t\t\tbz[i][i] = 1;\n\t\t\t\tbz[i][va[loc[i]]] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tint iid = loc[j];\n\t\t\t\t\t\tif (va[iid] > j) {\n\t\t\t\t\t\t\tz[i].push_back(j);\n\t\t\t\t\t\t\tbz[i][j] = 1;\n\t\t\t\t\t\t\tbz[i][va[loc[j]]] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(0);\n\tcout << trans(ans[0]) << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h> \nusing namespace std; \n  \nstring LexicographicalMaxString(string str) \n{ \n    string mx = \"\"; \n    for (int i = 0; i < str.length(); ++i) \n        mx = max(mx, str.substr(i)); \n  \n    return mx; \n} \n\nint main() \n{ \n\tint n;\n\tcin >> n;\n    string str; \n    cin >> str;\n    cout << LexicographicalMaxString(str); \n    return 0; \n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) if(s[i]=='a'){\n    \t;\n\t}\n    return 0;\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nchar s[6005];\nint num[6005];\nint pa[3005],tot;\nint pb[3005];\nstruct str{\n\tchar v[6005];\n\tint l;\n\tvoid pb(char x){\n\t\tv[l++]=x;\n\t\tv[l]=0;\n\t}\n\tstr operator +(str b){\n\t\tstr c=*this;\n\t\tfor(int i=0;i<=b.l;i++)c.v[l+i]=b.v[i];\n\t\tc.l=l+b.l;\n\t\treturn c;\n\t}\n\tbool operator >(str b){\n\t\tfor(int i=0;i<=min(l,b.l);i++)if(v[i]!=b.v[i])return v[i]>b.v[i];\n\t\treturn false;\n\t}\n};\nstr f[3005];\nstr v[3005];\nint t[3005],lst[3005];\nint main(){\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++)if(s[i]=='a')pa[++tot]=i,num[i]=tot;\n\ttot=0;\n\tbool ok=0;\n\tfor(int i=1;i<=2*n;i++)if(s[i]=='b'){\n\t\tpb[++tot]=i;\n\t\tnum[i]=tot;\n\t\tif(pa[tot]>i)ok=1;\n\t}\n\tpa[n+1]=2*n+2;pb[n+1]=2*n+1;\n\tfor(int i=1;i<=n;i++)if(pa[i]>pb[i]){\n\t\tint cnt=1,j=pb[i];\n\t\tv[i].pb(s[j]);\n\t\twhile(cnt!=0){\n\t\t\tj++;\n\t\t\twhile(s[j]=='a'&&num[j]<i)j++;\n\t\t\tif(s[j]=='a')cnt--;\n\t\t\telse cnt++;\n\t\t\tv[i].pb(s[j]);\n\t\t}\n\t\tt[i]=j;\n\t\t/*\n\t\tprintf(\"%d\\n\",v[i].l);\n\t\tputs(v[i].v);\n\t\t*/\n\t}\n\tfor(int i=n;i>=1;i--){\n\t\tf[i]=f[i+1];\n\t\tlst[i]=lst[i+1];\n\t\tif(pa[i]>pb[i])\n\t\t\tfor(int j=i+1;j<=n+1;j++)if(pa[j]>pb[j])\n\t\t\t\tif(pb[j]>t[i]){\n\t\t\t\t\t// printf(\"%d\\n\",j);\n\t\t\t\t\tif(v[i]+f[j]>f[i])f[i]=v[i]+f[j],lst[i]=(j==n+1?t[i]:lst[j]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t// printf(\"%d %d\\n\",lst[i],f[i].l);\n\t\t// puts(f[i].v);\n\t}\n\tprintf(\"%s\",f[1].v);\n\tfor(int i=1,p=lst[1];i<=n;i++)if(pa[i]>p){p=pb[i]; printf(\"ab\");}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=3005,p=1000000007;\nint read(){\n\tint f=1,g=0;\n\tchar ch=getchar();\n\tfor (;!isdigit(ch);ch=getchar()) if (ch=='-') f=-1;\n\tfor (;isdigit(ch);ch=getchar()) g=g*10+ch-'0';\n\treturn f*g;\n}\nint qpow(int x,int k){\n\tint t=1;\n\tfor (;k;k>>=1){\n\t\tif (k&1) t=(ll)t*x%p;\n\t\tx=(ll)x*x%p;\n\t}\n\treturn t;\n}\nint n,a[N],b[N],cnt,r[N];\nstring s,f[N];\nstring calc(int l,int r){\n\tstring ans=\"\";\n\tif (a[l]<b[l]){\n\t\tint las=a[l]-1;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (las<a[i]){ans+=\"ab\";las=b[i];}\n\t}\n\telse{\n\t\tstring t;\n\t\tfor (int i=l;i<=r;i++){\n\t\t\tt=\"\";\n\t\t\tint j=i,k=i;\n\t\t\twhile ((j<=r)||(k<=r))\n\t\t\tif (a[j]<b[k]){t+='a';j++;}\n\t\t\telse {t+='b';k++;}\n\t\t\tans=max(ans,t);\n\t\t}\n\t}\n\treturn ans;\n}\nint main(){\n\tcin>>n>>s;\n\tfor (int i=0;i<n*2;i++)\n\tif (s[i]=='a') a[++a[0]]=i+1;\n\telse b[++b[0]]=i+1;\n\ta[n+1]=b[n+1]=n*2+1;\n\t\n\tfor (int i=1;i<=n;i++)\n\tif (max(a[i],b[i])==i*2) r[++cnt]=i;\n\tfor (int i=1;i<=cnt;i++) f[i]=calc(r[i-1]+1,r[i]);\n\tfor (int i=cnt-1;i;i--) f[i]=max(f[i+1],f[i]+f[i+1]);\n\tcout<<f[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n                                                                                                     \n                                             `-:://:::-                                             \n                                           `//:-------:/:`                                          \n                                          .+:--.......--:+`                                         \n                                         `+:--..`````..--//`                                        \n                                         .o:--..`` ``..--:o`                                        \n                                         .o:--...```..---+/`                                        \n                                       `/y+o/---....---:+o.                                         \n                                   `...````-os+/:---:/+o/--.`                                       \n              `-/+++++/:.      `...`       :h+d+oooo+/+-`   ...                                     \n            `/++//:::://++-`....`         -.`//````````:`     `..`                                  \n           `o+/::------://o/`           `-` -.          -`       `..`                               \n `---.-o/:./o/::-..``..-ЗАПУСКАЕМ      ..  ..            -`        `...       ``..``                \n  `....o+:-++/:--.```..-://s.        `-`  .-              -`          `-o: .-//::::/:-`             \n          `:s+/:--....-::/+s-`      .-   `-                -`           -///:--------:/:`           \n           ./s+//:::::://oo-``..НЕЙРОННУЮ: СЕТЬ:::::::-`РАБОТЯГИ        `+:--........--:/`          \n            .:ooo+++++osso-`    `.:-...`/` ./::-------:/:`   -`         :+--..``````.--:+:...-+:-`  \n             `.-/+++++/+-.-`    -.   ``:so:/:--.......--:+`  `-```````o+/+--..`````..--:o/-..:s+:.  \n                 ```````:``.. `-`     -` `+:--..`````..--/+-.../.`````..-o:--.......---/o.    `     \n                        `:  `:-      -.  .o:--..`` ``..--:o`   `-`      `:o+:--------:+o-`          \n                         `-`-...    ..   .o/--...```..--:+/`    `-`     `oy/so/////++o/.`           \n                          -/`  `-` `- ``+s/o/:---...---:++.      `-`   .-../d://///:-.`             \n                `.---..``-..-    .-/..`````-oo+/:::::/+o+-        `-``-`  `-.  ````                 \n             `:++++/+++++-  ..``.-/:`      /y-:/++o++/:.`..`       ./.   `-                         \n            -++/::::::://+/..:-``:` ..   `-.`  ```.```    `..`   `..`-` `-                          \n       ``  -o//:--....-::/++` -.-`   `-`.-`                 `..`..`  `-.-                           \n  -----ss+:++/:--.```..-://s.  /.     `::                    `-:.     ./`                           \n  `````/:..+o/::-..``.--:/+s. ..-`   `-``-`                 ..` `-`  `-`-`                          \n          `-s+/::-----::/+oo---``-` ..    .:-    ```      .-`     .-.-  `-`                         \n           `:oo+//::://+os/..:`..-/:`      :y.-:::::::.`.-`        ./-`  `-`                        \n            `./+oooooooo+/.`-    .-:...`.. .//:-------://`        `- `..` `:.                       \n              ``.-::::-.``-/`  `-` `-  `oo:+:--.......--:/`      `-    `.:--h.``..```               \n                          -.-`.-    .-   `+:--..`````..--//`    `-       /s-//::::::::.             \n                         -` `/-      ..  .o:--..`` ``..--:o.```.-        `//:--------://`           \n                        -` .-`.-`     -.`-o/--...```..--:+/.``-:....``:-.+:--....`...--:+`          \n                       ..`-.   `-.   ``:os:o/:---...---:++.  `-     ``///+:-..``````.--:+-````-.`   \n              `.:///////.-`      .:-..` -``-+o+/:::::/+o/.  `-         `:+:-..`````..--:o/:--/ys+-  \n            `-++///////+o/. ``....`-.    :` `.:++++++/:.`  .-           -o/---......---/o.   `.`    \n           `++//:-----::/+o:..`     .-`   :    ```````    .-           `+so+:--------:++-`          \n  `````:-``:o/::-..`..--:/+o`         -.  `-             .-          `../../+o+////+o+:.`           \n  -----syo/o+/:--.```..-://s.          .-` `-           .-        `...     ``-:////:-``             \n       .` `/s//:--....-::/+s.            -. `-`        .-       `..`                                \n           .+o+/:::--:://+s/-..`          .::+y  ```  .-     `..`                                   \n            ./oo++////+oso-`   `....       :y-+:::::::/`   ...                                      \n             `.:+oooooo/-`         `....-. .//:-------:/:-.`                                        \n                ``...``                 /+:+:--.......--:+`                                         \n                                         `+:--..`````..--//`                                        \n                                         .o:--..`` ``..--:o`                                        \n                                         .+/--...```..--:+/`                                        \n                                         `-o/:---...---:++.                                         \n                                          `-+o+/:---:/+o/.                                          \n                                            `.:+oooo+/-.`                                           \n                                               ``````                                               \n*/\n\n#ifdef aimbot\n#pragma GCC optimize(\"Ofast\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,avx,avx2\")\n#include <immintrin.h>\n#endif\n\n#define hur(f, g) template<class c> int f(c a) {if (sizeof(c) == 8) return g##ll(a); else return g(a);}\nhur(popc, __builtin_popcount) hur(ctz, __builtin_ctz) hur(clz, __builtin_clz)\n\n/*\n\t- place bitset modifications here\n*/\n\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <unordered_map>\n#include <unordered_set>\n#include <map>\n#include <set>\n#include <queue>\n#include <ostream>\n#include <istream>\n#include <typeinfo>\n#include <iomanip>\n#include <cstdio>\n#include <cstdlib>\n#include <cassert>\n#include <limits>\n#include <fstream>\n#include <array>\n#include <list>\n#include <bitset>\n#include <functional>\n#include <random>\n#include <cstring>\n#include <chrono>\n\n#define random escape__from__random__aetuhoetnuhshe\n#define mt make_tuple\n#define x first\n#define y second\n#define pb push_back\n#define mp make_pair\n#define le(v) ((int)v.size())\n#define f(i, n) for (int i = 0; i < (n); i++)\n#define rof(i, n) for (int i = ((n) - 1); i >= 0; i--)\n#define apply(v, act) for (auto &x : v) { act; }\n#define log(args...) {string s = #args;deque<string> deq;\\\nstring buf = \"\";int bal = 0;for (char c : s) {\\\nif (c == '(' || c == '[' || c == '{') {bal++;\\\n} else if (c == ')' || c == ']' || c == '}') {\\\nbal--;} else {if (bal == 0) {if (c == ',') {\\\ndeq.pb(buf);buf = \"\";} else {if (c != ' ') {\\\nbuf += c;}}}}}if (!buf.empty()) {deq.pb(buf);}\\\nsmart_io::precall_print();smart_io::_print(deq, args);}\n\ninline int min(const int &x, const int &y) { return (((y-x)>>(32-1))&(x^y))^x; }\ninline int max(const int &x, const int &y) { return (((y-x)>>(32-1))&(x^y))^y; }\ninline long long min(const long long &x, const long long &y) { return (((y-x)>>(64-1))&(x^y))^x; }\ninline long long max(const long long &x, const long long &y) { return (((y-x)>>(64-1))&(x^y))^y; }\n\n#define print    \\\nsmart_io::precall_print(); \\\ncout,\n\n#define scan cin,\n\n#ifdef fast_allocator\nconst int MAXMEM = 200 * 1000 * 1024;\nchar _memory[MAXMEM];\nsize_t _ptr = 0;\nvoid* operator new(size_t _x) { _ptr += _x; assert(_ptr < MAXMEM); return _memory + _ptr - _x; }\nvoid operator delete (void*) noexcept {}\n#endif\n\nusing namespace std;\n\nchar string_in_buffer[(int)2e6];\n\n\nvoid fast_scan(int &x) { scanf(\"%d\", &x); }\nvoid fast_scan(long long &x) { scanf(\"%lld\", &x); }\nvoid fast_scan(unsigned long long &x) { scanf(\"%llu\", &x); }\nvoid fast_scan(double &x) { scanf(\"%lf\", &x); }\nvoid fast_scan(long double &x) { scanf(\"%Lf\", &x); }\nvoid fast_scan(char &x) {\n\tscanf(\"%c\", &x);\n\tif (x == '\\n') {\n\t\tfast_scan(x);\n\t}\n}\nvoid fast_scan(string &x) {\n\tscanf(\"%s\", string_in_buffer);\n\tx = string(string_in_buffer);\n}\n\ntemplate<class TFirst, class TSecond>\nvoid fast_scan(pair<TFirst, TSecond> &p) {\n\tfast_scan(p.first);\n\tfast_scan(p.second);\n}\n\ntemplate <class T>\nvoid fast_scan(vector<T> &v) {\n\tfor (auto &x : v) fast_scan(x);\n}\n\nvoid fast_print(const int &x) { printf(\"%d\", x); }\nvoid fast_print(const unsigned int &x) { printf(\"%u\", x); }\nvoid fast_print(const long long &x) { printf(\"%lld\", x); }\nvoid fast_print(const unsigned long long &x) { printf(\"%llu\", x); }\nvoid fast_print(const char &x) { printf(\"%c\", x); };\n// void fast_print(__int128 x) {\n// \tif (x == 0) { fast_print('0'); return; }\n// \tif (x < 0) {\n// \t\tfast_print('-');\n// \t\tx = -x;\n// \t}\n// \t__int128 p = 1;\n// \twhile (x / (p * 10)) p *= 10;\n// \twhile (p) {\n// \t\t__int128 symb = x / p;\n// \t\tfast_print((int)symb);\n// \t\tx -= p * symb;\n// \t\tp /= 10;\n// \t}\n// };\nvoid fast_print(const double &x) { printf(\"%.15lf\", x); }\nvoid fast_print(const long double &x) { printf(\"%.15Lf\", x); }\nvoid fast_print(const string &x) { printf(\"%s\", x.c_str());}\nvoid fast_print(const char v[]) { fast_print((string)v); }\n\ntemplate<class TFirst, class TSecond>\nvoid fast_print(const pair<TFirst, TSecond> &p) {\n\tfast_print(p.first);\n\tfast_print(' ');\n\tfast_print(p.second);\n}\n\ntemplate <class T>\nvoid fast_print(const vector<T> &v) {\n\tif (v.empty()) return;\n\tfast_print(v[0]);\n\tfor (int i = 1; i < v.size(); i++) {\n\t\tfast_print(' ');\n\t\tfast_print(v[i]);\n\t}\n}\n\ntemplate <class T>\nvoid fast_print(const vector<vector<T>> &v) {\n\tif (v.empty()) return;\n\tfast_print(v[0]);\n\tfor (int i = 1; i < v.size(); i++) {\n\t\tfast_print('\\n');\n\t\tfast_print(v[i]);\n\t}\n}\n\ntemplate <class T>\nvoid fast_print(const T &v) {\n\tfor (const auto &x : v) {\n\t\tfast_print(x);\n\t\tfast_print(' ');\n\t}\n}\n\n\nusing namespace std;\n\n\nnamespace smart_io {\n\tstring print_start = \"\";\n\tstring sep = \" \";\n\tbool first_print = false;\n\t\n\tvoid precall_print() {\n\t\tfast_print(print_start);\n\t\tprint_start = \"\\n\";\n\t\tfirst_print = true;\n\t}\n\t\n\tvoid _print(deque<string>) {}\n\ttemplate<class T, class... Args>\n\tvoid _print(deque<string> names, T elem, Args... args) {\n\t\tif (!first_print) {\n\t\t\tfast_print(\"\\n\");\n\t\t} else {\n\t\t\tfirst_print = false;\n\t\t}\n\t\tfast_print(names.front());\n\t\tfast_print(\" = \");\n\t\tfast_print(elem);\n\t\tnames.pop_front();\n\t\t_print(names, args...);\n\t}\n} //namespace smart_io\n\n\ntemplate <class T>\nostream &operator,(ostream &os, const T &object) {\n\tif (!smart_io::first_print) {\n\t\tfast_print(smart_io::sep);\n\t} else {\n\t\tsmart_io::first_print = false;\n\t}\n\tfast_print(object);\n\treturn os;\n}\n\ntemplate <class T>\nistream &operator,(istream &is, T &object) {\n\tfast_scan(object);\n\treturn is;\n}\n\nnamespace random {\n\tusing namespace std::chrono;\n\tmt19937 rng(duration_cast< milliseconds >(\n\t\t\t\t\t\t\t\t\t\t\t  system_clock::now().time_since_epoch()\n\t\t\t\t\t\t\t\t\t\t\t  ).count());\n\tuniform_real_distribution<> prob_dist(0.0, 1.0);\n};\n\nnamespace typedefs {\n\ttypedef long long ll;\n\ttypedef unsigned long long ull;\n\ttypedef pair<int, int> pii;\n\ttypedef long double ld;\n}\n\nnamespace numbers_operation {\n\ttemplate<class T>\n\tinline T floor_mod(T a, const T &b) {\n\t\ta %= b;\t\n\t\tif (a < 0) a += b;\n\t\treturn a;\n\t}\n}\n\nusing namespace numbers_operation;\nusing namespace typedefs;\nusing namespace random;\nint n; string s;\nvector<int> link;\nsigned main(signed argc, char *argv[]) {\n\tscan n, s; n = n + n;\n\tvector<int> a, b;\n\tf(i, n) {\n\t\tif (s[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tlink.resize(n);\n\tfor (int i = 0; i < n / 2; i++) {\n\t\tlink[a[i]] = b[i];\n\t\tlink[b[i]] = a[i];\n\t}\n\tvector<string> dp(n + 1, \"\");\n\tfor (int i = n - 1; ~i; i--) {\n\t\tdp[i] = max(dp[i], dp[i + 1]);\n\t\tif (s[i] == 'b') {\n\t\t\tif (link[i] > i) {\n\t\t\t\tint R = link[i];\n\t\t\t\tvector<int> pick;\n\t\t\t\tfor (int j = i; j < R; j++) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tR = max(R, link[j]);\n\t\t\t\t\t\tpick.pb(j);\n\t\t\t\t\t\tpick.pb(link[j]);\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t\tsort(pick.begin(), pick.end());\n\t\t\t\tstring t; for (int id : pick) t += s[id];\n\t\t\t\tdp[i] = max(dp[i], t + dp[R + 1]);\n\t\t\t}\n\t\t} else {\n\t\t\tif (link[i] > i) {\n\t\t\t\tdp[i] = max(dp[i], \"ab\" + dp[link[i] + 1]);\n\t\t\t}\n\t\t}\n\t}\n\tprint dp[0];\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*\nCoded by 秦惜梦\nThe most attractive girl in the world\n.........   `;!!!!!!!!!;;;;;;;;::::::'''''''``''''''''````````````````````....`:;;;;;:'.....`:|$$$$$$$|;;;:`.    ..........`''``...`''``.   ........   ...  ...   ....  ...   ...  '\n........     '!!!!!!!!!;;;;;;;:::::::::''''':::''''`````````````````````......`:;;;;;!%$$%!'.....`:|$%!;;;'....   .....`....`'''`...```..    ........  ..   ...    ..   ...  ...   '\n........     .:!!!!!!!!;;;;;;;:::::::::::::::'''''''`````````..```````........`:;!%$$$$$$$$$$$%!'.....`:|!'````..   .........`''``.......    ........  ...  ...   ...   ..   ..   .'\n.......       `;!!!!!!;;;;;;;;::::::::::::::::'''''```````````.``````...       .`';|%$$$$$&&$$$$$$%%;'..`'':'''``..  ...``.....```.   ....    .......  ...  ...   ...  ...  ...   .'\n.......      . '!!!!!!;;;;;;;:::'''''''''::::::'''```````````````````.........':'`.......`:!%%|||%$$$$$&%;'::::''``.   .```..   ....   ....   .......   ..  ...   ..   ...  ...  ..'\n......      '::'''':::::::::::::'''''''''''::::''''``````````````````.........'!$$$$$$%!:`.......`:!%&&&|'``':::'''``.....```.   ....   ...    ......   .......   ..   ..  ...   ..'\n``...       .`.``'::::::::;;;;:::::'''''''`'''''`````````````..```````........'!$$$$$$$$$$$$$$%!;'`.....`'`..`'::''''`.....```..  ....   ...   ......   ........ .... .......  ....'\n````.      .````.`;!!!;;;;;;;;::'''''''``'''''`````````````````````````.. ....`:!|%$$$&&&&&&&$%%$&&&&@&$|::'`.`''''''''`....````.  ....   ...   ......   .  .....```..``.....  ... '\n````      .````.  `;!!;;;;;;;:::::'''''':::'''''````````````........`````.... ........````........``'::::::::'``.``'''''``...````.. ....   ...  ......   .  ......``.```....   ..  '\n```.      .```.  .`';!!;;;;;;;:::::::::::::'''''``````````..........````````...`;$$$$&&&&&&$%%||||!|!;;::::::::'`...`'''''`....````.  .... ...   .....   .   .. .``..```....  ..   '\n``.       .``.  .`'`';!;;;;;;;;:::::::::::'''''`````````...........`````````....'!|%%%%%%%%%%%%%%%%%%$&&&|:'''''''`...`'''''`....```.  .... ...   .....  .   ..  ..  ......   .   .'\n`.        .`.  `''''`';!;;;;;;;::::::::::'''''''```````..........````````````....:|%%%%%%%%%%%%%%%%%%%%%%|:`''''''''`...`''''`....```.. ...   ..  .....  ..  .   ..  .. ...  ..  ..'\n`         .  .`'''''``';!;;;;;;;:::::::''''''''''```.``........```````````````````!%%%%%%%%%%||!;:''`.........`'''''''`...`''''`...````.....  ..   ....  ..  .   .   .  ..  ..  ...'\n            .''''''````';!;;;;;;;:::::'''''''''''```````````````````````````.........``````...  ...```':;!!:....`'''''''``..`'''`....```.  ... ..  ....      ..  .   .  ..  ..  ...'\n         .`''''''''``````;!;;;;;;:::::'''''''''''``````````'''''''''``....```````````````````````````':!||%|;``....`''''''``..`''``....`..  ...     ...   .  .   .  .. ..  .   ... '\n        .'''''''''````````:;;;;:::'''''':::::::::::::''''''''''''``..``````....```````````````````````````:!!'`'`.....`'''''``...```.  .........    ....     .  ..  .  .  ..  ...  '\n        `'''''''''````';;;:::::::::::::::::::::::''''```````````..........```````````````````````````````````'`.``'``....`''''``.. .`.. ..... ...    ...        .  .. ..  .   ..   '\n       .'''''''''```````';;:::::''''''''''''''''''`''```````.`````.....````````````````````````````````''``````....``''`...``''```......  ........   ...     .     .  .  .   ..    '\n       `''''''''````'''`````.`::::::::'''''''''''''''''``.``.```........````````````''''`````````````````''''''''`....``'``...``````...... ........   ..     .  .  . .   .  ..     '\n      .`'''''''```'''''````````':::::::''''''''''''''``.``.`............`````````'''''''''''''''``````````'''''''''`.....````....```...  ..  ......    .                .   .     .'\n      `'''''''`''''''''````````.`::::::'''''''''''''`.```..............``````````'''''''''''''''''````````''''''''''``.......```.........  .  ....     .     ........              '\n     .`''''''`''''''''``````````.`:::::::'''''''''``.`..............```````'''''''''''''''''''''''''``````'''''''''''''.........``... .....  .  ...     ..`:::::::::::::'`.        '\n      .'''''`''''''''``````````````':::::''''''''``..````````````````````''''''''''''''''''':''''''```''````''''::''''''`.```..........  .....   ....    `'::::::::::::::::`.      '\n     ....`''''''''''```````````````.`':::::'''''`...``````````''''''''''''''''''''''''''''''';:'''``''`::````';:''''''''''.....``......... .....   ...   `::::::::::::::::::'`.....'\n    ......`''''''''``````````````````.':::::::'`...``'''````''''''''''''''''''''''''''''''';!:;:'''':!;::'```````''''''''''`   ........ ..... ...    ..  ....`':::':::::::::::'... '\n    .......`'''''`````````````````````.`':::'```.`''''''````''''''''':'''::'''::''':;::!!!;:;!;;:```````::`````````'''''''''`.     ............  ..   ..          .':::::::::''`   '\n   ........`''`````````````````````````..`':''`:;:'':''':''''''''''''::'':;:'''''''''::'''''':;;;:``````:;'```''``````'``'''''`.... ...........    ..                 `::::::'`.   '\n  ..........`````````````````````````'::::''':;!!!!;:'::':!;;;:::'''';;'''::::''''':'''::'''''''::'`````':''``''````::`':'''''''''.         ......                      .''`....   '\n.`'`.......```````````````````````````````'':!;:::::::::':;::::::::''::''`''::::'`''''':::'':''`:;'`````':'```''`````::`````'''''':;'..................                 .......  . '\n`'''''```````````````````````````````````.`;!:::::::::::'''::::::::''::''``'::::'``'''''::''''''':'````````````'`````''````````````:!!;'................              ..........   '\n'''''`````````````````````````````````````;!;;;:':::''::''''::::;;:'':::'```'::'````''''''''''''':'```````````''````````````````````';!!!;'....  ......               .......      '\n''''````````````````````````````````````';!;;;:'::::':''`''':::;;;:'''':'``'':'````.```''''''''`':'````````````'`````````..``....`...`:!!!!:`.`.....                    .          '\n'''````````````````````````````````````':;!;;:`'::':'''``''':::;;;:''``'```'':'``....''`'''''''`''`.`````````````.````````.............';;'.`:;;;'`.                 .....   ...   '\n''````````````````````````````````````'':!;::'`::':::''`''''':;;;;:```````'''''```...''`'''''''`''`.``.````````````````````............... `;;;;;;;;;:`.                ....   ....'\n''''''''````````````````````````````''`:!;;:''':''::''`'':''':;;;;'```'```''''''`.`'``:'''::''''''```````````````````````````.............`:;;;;;;;;;;;'.      .         ....    ..'\n:::::::''''````````````````````````''`'!!;:''''''':''`''''''':;;;:```::``'''':'''`';:';:'::::':`''`''`````````````````'``````````..........`:;;;;;;;;;:.     `'..          .....   '\n|%$$%%!;;:'''````````````````````''``';!;:'''':'``'''`'':''':::;:'``:!:``':::::::`:!;';;':::::''`''::````'''''````````''`````````...........`:;;;;;;;'.    .':` `;;;;:. ..   ..... '\n@@@@@@@@$|;:''`````````````````''```';!;:::::::'``````'':''::::::'`'!|:`':::;:::'';|!:;;'''''''::::;:``'::''`'````````''````````````.........`:;;;;;`     .:;'..';;;;;;;;;:` ......'\n@@@@@@@@@@$|;:''`````````````:'`````;;;:';;;;::'`'````'':''::::::'`;!!;':::::::'`.';!;;;:::::';!!::;'`':::'``'`.``````''````````.......... ..``';;:`     .';;` `:;;;;;;;;;:` `;;;;;;\n@@@@@@@@@@@&|;:'``````````''```````;;::':;;;;:'`''```'':'::::;;;:':;|!!;:'''''::::!||!!!!;!!!!||;:!'`:::::'````..``````''`````.......... .  ..`':;`     .';;:` ';;;;;;;;;;:. ';;;;;;\n@@@@@@@@@@#@$!:''`````````````````::```';;;;::``'''``'::':::;;;::;;!|||!::;;!!!;;;:'``````'':!!!!|:``':::'`````:;:`.``````.............   . ..`';'     .';;;'..:;;;;;;;;;;'..';;;;;;\n@@@@@@@@@@@@$|;:'````````````````::````:;;;::'.`''```''''':::;:::;||%|||%%%%%|!:''''`...`'':!;:;|;```:::'``''`';!;'..`````..............  . ..`''.    .';;;:` `;;;;;;;;;;;' .:;;;;;;\n@@@@@@@@@@@&%!;:'```````````````''````':;;;::'..''```````:::::';||%%%%%%$$&&&%!;!|$&%:..';!%%!!|!'`;::::'``''';!;;'...````..............  ....``..   .';;;;'..';;;;;;;;;;;` `:;;;;;;\n@@@@@@@@@#@%!!;:'````````````````````.'''::::`..````'''::!||||%%%%&&&&&&&&&&&&&$&&&%||||!|%%%%|!:';;;;!;``''`:;;;:`....`...................`....```. .`':::` `:;;;;;;;;;;:` `;;;;;;;\n@@@@@@##@$|!!;:''```````````````````````':'```..`````':!;:''''':!%$&&&&&&&&&&&&$$$|!;;!|%%%%%%|;':;''::'`'''`:!;:`........................```..````........  .':;;;;;;;;;'. ';;;;;;;\n!%$$$$%%|!!!;:''``````````````````````````````````````';!:'::'``':|$&&&&&&&&&&&&$$$$$$$$%%%%%|!:```''::'''''```...........................``..`'''`........   ......'::;;'..';;;;;;;\n;!!!!!!!!!!;:''``````````````````````````````..````````'!%!;!;;!!%$%$&&&&&&&&&&&&$$$$$$$$$$%%||;``'''':''''``..`....    ... .................`'''````.....   .....`.......  `::;;;;;\n::;!!!!!;;:''````````````````````````````````...````````'!%|!|%$$$$%$&&&&&&&&&&&&&&$$$$$$$$%|||:``''''''''```..`....      ..    ...     ....`'''`''```....   .'|%%;......    .... .'\n``'::::'''````````````````````````````````````..`...```'`'|&$$$$$$$%$&&&&&&&&&&&&&&$$$$$$$$%%%|:`'''''''''```..`....                    ....`''```''```... .:%%%%|:......   .......'\n .````````````````````````````````````````````.``..```````:|&$$$$$$|%$&&&&&&&&&&&&&&&&&$$$$%%%|:'`'''''''````..`....                      .``'`````''````. :%%%%%;`....... ........'\n  .``````````````````````````````````````````..`..`````````:%&&&&&&$%|%$&&&&&&&&&&&&&&&&$$$%$%|:'`'''''''````.``.....                    .``'`````'`'':|:.'!%%%%|'.`````.   .......'\n  .```````````````````````````````````````````'`..`````````.:$&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$$%|;'```''''```````.......                  .``'```'``':|%%|'.'|%%%%;```````...........'\n  .`````````````````````````````````````````:'`..''````````..!&&&&&&&&&&&&&&&&&&&&&&&&&&&$$&$%%;''```''````````....   .                .'''`.`'``'`;%%%;``;%%$%!'..................'\n  .``````````````````````````````````````;|:.``.`''''`````...`|&&&&&&&&&&&&&&&&&&&&&&&&&&$$&&$%!:'```````````.``..                    .`''```;;'''';%%%:.:%&&$|:...................:\n  .```````````````````````````````````'!!```'`.`:!:''`````. ..`|&&&&&&&&&&&$%%$$$%|%$$&&&$$&&&$%;'`.``..`......`.                   ..`''''!;''''':|%$|'`!&&$|:...................`:\n   .````````````````````````````````;|:````'::`'!;::''''`.  ...`!&&&&&&&&&&&&&&$&&&&&&&&&&$&&&&$|:'```.``.........        .`.    ....`'''```''''';$&&&;`:!;`......................`:\n   .`````````````````````````````:|;`````'';:'`';:'''```.. ......'|&&&&&&&&&&&%%%$&&&&&&&$$&&&&&%;'`'`..```........         ``  `;:`''''``'```'!$&&&%!'.....................```````:\n   .``````````````````````````:|;``````'':;:'``':'''`````. ........`:%&&&&&&&&&&&&&&&&&&&$&&&&|!!!;'''`....``......`.        .;%%;`''''';|||!;:''::;;' ..``......``````````````````:\n   .```````````````````````!%:````````'':;:'```'':''````.. ............'|&@&&&&&&&&&&&&&&&$$|;!!!!!;:'``'`....``...````..      `:;;:'''!%;::::::::;;`. .````````'''````````````````:\n   .```````````````````:%!'``````````'::::'````'''''````.  .............```;$&@&&&&&&&&&&$|;;!!!!!!!!;```::`  ...``.';;'```.    `:::'';$$|;:::::!;'`....``````''''''''````''''`````:\n   .```````````````:%|'`````````````'::::'`````'''''''``.  .....  ....`````````;$&&&&@&|::!!;!!!!!!!!|!'```';'..  ....'!%%|!::``'':'':|$&&$|!!;:;:'`. .```````':::::''''''''''''''':\n   .``````````;||:```````````````''::'::'````.`'''''''`.. .......  ..`````````````';:`````';!!!!!!!||||!;'```';!:`... ..`:|%%!'''''`:!%$&&&$$$!:;;;:'``'```''::::::::''''':::::'''';\n   ..``';;:'```````````````````'''::'':'```````'''::''`..  .......   ..``````````````````. '||!!!|||||||!!;'````'!|;'``````````'''`';:'`'%&&&&&&|;!;:;!!!;;::;;::::::''''::::::::::;\n``...``````````````````````''''''::''''`````````':::''``. .........  ....```````````...   .:!||||||%%%|||!!!!;'````'!||;'```.`'''`.`.`''`.;$&&&$:  .``'::::;!|%$$%|;:''':::::::::::;\n    .````````````````````'''''''::```'````````.`:::'''```. .......... .............    `!%|!!||||%%||||!!!!!|%%%!:````````..`'''..``''`.....':. .   ..`':;;;;;;;::::;!%&%!;;;;:::::;\n    .`````````````````''''''''''''''::'''````..`::''''`````. ........``............ .;%%%|!!!||%%%%%%%|!!!|%%%%%%||%%%%%%!'`'''`````....``.....       ..  .`':;;;;;;:::::;!%%!;;;;;;\n    .`````````````'''''''''''```''''::'''''``..`''''''```````........````````.....:%%%$%||!|||%%%%%%%||!|%%%%%%%%%%%%|||!'`'''';%%|;`````......'`.      ..      `':::::::;;;;;|%!;;;\n    .``````````''''''''''```````'```''''````..`.`'''''````````....  ..```....  `|%%%%$%|||!|%%%%%%%%%|!|%%%%%%%%%%%%%%%|:`'''`;%%%%!:.:!|%$$$$|;:'`...   .``..  .`.  '::::;;;;;;!%!;\n%!'..```````''''''''''``````````'```'````````.``.`'''''```````.......       .;%%%%%%%|!!!||%%%%%|!!!!!|%%%%%%%%%%%%%%%%:`''''!%%%!!!:`:!|%$$$$$$$$$%|'`.  .```'`.``.  ..     .':::|%\n%%%%%%;```''''''''```````````````'``''``````.````.`''''`..'````.......`'''';|%%%%%%%%||%%%%%%%%%%%|!!%%%%%%%%%%%%%%%%%:`'''';%%||||:`:!|%$$$$$$$$$$$$$%;``. .``''`.                '\n$$$%%%%%$$|:''````````````````````''''``````.`````.`'''''`...      .`':|%$$%%%%%%%%%|!|%%%%%%%%%%|||%%$$%%%%%%%%%%%%%:`'''';%||%%%;.:||%$$$$$$$$$$$$$$&&&%:...````''`              '\n$$$$$$$$$$%%%%%;`.``````````````````':'``````.`````.`'''''`......`''':!%%%%%%%%%%%%|!!%%%%|||%%|!|%%%%%%%%%%%%%%%%%%:`'''';||%%%|:`;||%$$$$$$$$$$$$&&&&&&&$|'...```'''`            '\n|%%$$%%$$$$$%%%%%%%;`..`.`````````````':'````.``.```..`''````''''':|!:|%%%%%%%%%%%%|!!|%|||%||!!%%%%%%%%%%%%%%%%%%%:`'''':|%%%%;``;|%%$$$$$$$$$$&&&&&&&&&&&$$;...`````''`          '\n@$|||||%%%%%%%%%%%%%%%%|:`....```````.`''``'''`````````.````''':;|%|;:|%%%%%%%%%%||!!|||||||!!|%%%%%%%%%%%%%%%%%%%:`'''';|%%%%:.'!|%$$$$$$$$$$$$$&&&&&&&&&&&&$!`..``````''`        '\n||||&@&%|!|||%%%%%%%%%%%%%%|:.....```````'````.........`!%%%%%%%%|||;:|%%%%%%%%%%||!!|%|%|!!||%%%%%%%%%%%%%%%%%%%:`'''';|%%%!'`;||%$$$$$$$&&$$$$$&&&&&&@&&&&&$$!`..``````````.     '\n|||||!|!|$@&%|!|||%%%%%%%%%%%%%:. ...`````''``........:|%%%%%%%%%||%;:|%%%%%%%$%%%%!;|||!!||||%%%%%%%%%%%%%%%%%%:`'''';||%|:`:||%%$$$&&&&&$$%%$$&&&&@######&&$$$!`..``..```````.   '\n||||||||!|!!!!|%$%|||||%$%%%%%%%%%!`.....````'`......'|%%%%%%%%%%|%$|;%&&&&&&&&$$$$|!|!!%$$$$&&&&&&&&&$$$$$$$$%;`''':;|||;``;||%$$&&&&&&&$$%%$$&&&&&@######&$$$$%:.....``````````. '\n||%%||||||!!|!!|||!|%$%|||%%%%%%%%%%%|:.....`.`'`...'|%%%%%%%%%$$$$&|:|&&&&&&&&$$$$|;!|$$$$&&&&&&&&&&&&&&&&@&$;`''':;||;``!||%$&$$$&&&&$%%%%%$&#####@@###@&$$&$$$!`.......`````````:\n   .:!|%%|||||||||||||||!|||||%%%%$%%%%%;`.......``:%&&&&&&&&&&&&$$$%;;$&&&&&&&&&&$||$$$&&@@@@@@@@@@@@@@@@@@&!'''':;!:`'!||%$&$$$$$&&&$%%|%%$@######@&&&&&$$$$$$$%;..`...`...`````':\n    .....`;|%%%%%|||!|||!|||!!!||%%%%%%%%%%;`.....:%&&&&&&&&&&&&$$$&$|'!$&&&&&&&$$%$$$&&@@@@@@@@@@@@@@@@@@@@!'::':'`.'|||%$$&&$$$$$&&$%%||%$@#########@@&&$$$$&$%$!`..`...```..````:\n    ..........'!|%|%|||||!||||||||||%%%%%%%%%:...'|&&&&&&&&&&&&&$$&&&$;'|&&&&&$%%$$$&&@@@@@@@@@@@@@@@@@##@@!'::::'`:|%%%$$$&&&$$$$$$$%%|%&@@##########@@@@&&&$$$$$%;..``....````.``:\n    .....```......`;|%|%%||||||||||||||%%%%%%|!:`!&&&&&&&&&&&&&&$$$&&$%::%&$$%%$$&&&@@@@@@@@@@@@@@@@@@@#@&|::::::;|%%$$$$&&&&&$$$$$$%%%%&@@@###########@@@@&&&&&$$$!`..`.....`````.'\n    ..................`;|%%%|%%|||!|||||||%%%|||$&&&&&&&&&&&@&&&$$$&&&$%;;%%%$$&&@@@@@@@@@@@@@@@@@##@#@&$;':::::!%%$$$$&&&&&&&$$$%%%%%|$@@@@##@#########@@@@@&&&&$$|:...`.....`````:\n    ............``..```...`;|%|||%||!!|||||||||%&&&&&&&&&&@@@@&&$$$&&&&$%;;%$$&@@@@@@@@@@@@@@@@@@#@@&$!`.`:::::!%$$$&&&&&&&&$$$$$$%%%||&@@@@##@@@@########@@@@&&&&$$!`...`.....````:\n    ...................```...`:|%||||||||!||||%&&&&&&&&&&&@@@@@&$%&&$$$%%%;:!$&@@@@@@@@@@@@@@#@@&&%;``;|;:::::!$$$&&&&&&&&&&$$$$$%%%%||&@@@@@@@@@@##@#####@@@@@&&&&&$:..```.....```:\n    .....................``.`...`;|%|||||||||%&&&&&&&&&&&&@@@@@@$$&$$%%$$$%!::|&@@@@@####@@@&$%;'':|%|!::::::!$$&&&&&@&&&&&&$$$$$$%%|||$@@@@@@@@@@@@@@@####@@@@@&&&&&%'.```..`...``:\n    ...........................``..'!%|||||!%$&&&&&&&&&&&&@@@@@&$$$%%$$@@@&$%!::|&&&&&&&&$|;::;||||%%|::::::!$$&&&&@@@&&&&&&$$$$$$%%|||$@@@@&&&&&&&@@@@@@@@@@@@@@&&&$$|'.```.......:\n    ...........................```...`;||||%$&&&&&&&&&&&&@@@@@&$%%$$&@@@@&&&&$|!!;;!||;:;!|%%||%$&&$|;:::::!$$&&&@@@@@@@&&&&$$$$$$%%%%|%&@@@&&&&&&&&&&&&&&&&&@@@&&&&$$$!`.``.......:\n*/\n\nint n;\nchar s[6005];\nint a[6005],b[6005],pos[6005],cnta,cntb;\nstring dp[6005];\n\nint main(){\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor(int i=1;i<=2*n;i++){\n\t\tif(s[i]=='a'){\n\t\t\ta[++cnta]=i;\n\t\t\tpos[i]=cnta;\n\t\t}else{\n\t\t\tb[++cntb]=i;\n\t\t\tpos[i]=cntb;\n\t\t}\n\t}\n\tfor(int i=n;i>=1;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint to=0;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tto=max(to,pos[j]);\n\t\t\t}\n\t\t\tdp[i]=\"ab\"+dp[to+1];\n\t\t}else{\n\t\t\tint fk=i;\n\t\t\twhile(fk<=n&&b[fk+1]<a[fk]){\n\t\t\t\tfk++;\n\t\t\t}\n\t\t\tfor(int j=1;j<=2*n;j++){\n\t\t\t\tif(pos[j]>=i&&pos[j]<=fk){\n\t\t\t\t\tdp[i]+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i]+=dp[fk+1];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[1]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <string>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n\nint n,Ac,Pa[6005],To[6006];\nbool v[6005];\nchar s[6005];\nstd::string f[6005];\n\nint main()\n{\n    scanf(\"%d%s\",&n,s+1),n<<=1;\n    for(int i=1;i<=n;++i)if(s[i]=='a')Pa[++Ac]=i;\n    Ac=0;\n    for(int i=1;i<=n;++i)if(s[i]=='b')To[i]=Pa[++Ac],To[To[i]]=i;\n    for(int i=n;i>=1;--i)\n    {\n        if(To[i]>i)\n        {\n            if(s[i]=='a')f[i]=std::string(\"a\")+'b'+f[To[i]];\n            else\n            {\n                int r=To[i];\n                memset(v,0,sizeof v);\n                v[i]=v[r]=true;\n                for(int j=i+1;j<=r;++j)\n                    if(s[j]=='b')\n                        v[j]=v[To[j]]=true,r=To[j];\n                for(int j=i;j<=r;++j)if(v[j])f[i]+=s[j];\n                f[i]+=f[r+1];\n            }\n        }\n        f[i]=std::max(f[i],f[i+1]);\n    }\n    std::cout<<f[1]<<std::endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint N;\nchar S[6005];\n\nint a[3005], b[3005];\nint ca, cb;\n\nvector<int> res[6005], cur;\n\nvoid maxim(vector<int>& a, vector<int> &b) {\n\tfor (int i = 0; i < min(a.size(), b.size()); ++i) {\n\t\tif (S[a[i]] < S[b[i]]) { a = b; return; }\n\t\tif (S[a[i]] > S[b[i]]) return;\n\t}\n\tif (a.size() < b.size()) a = b;\n}\n\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S);\n\n\tfor (int i = 0; i < 2*N; ++i) {\n\t\tif (S[i] == 'a') a[ca++] = i;\n\t\telse b[cb++] = i;\n\t}\n\n\tfor (int i = 2*N; i--; ) {\n\t\tmaxim(res[i], res[i+1]);\n\n\t\tcur = res[i];\n\t\tint mn = -1;\n\t\tfor (int j = 0; j < N; ++j) if (b[j] < i && a[j] >= i) {\n\t\t\tif (mn == -1) mn = b[j];\n\t\t\tcur.push_back(b[j]), cur.push_back(a[j]);\n\t\t}\n\t\tsort(cur.begin(), cur.end());\n\n\t\tmaxim(res[mn], cur);\n\t}\n\n\tfor (int j = 0; j < N; ++j) if (a[j] < b[j]) {\n\t\tcur = res[0];\n\t\tcur.push_back(a[j]); cur.push_back(b[j]);\n\t\tsort(cur.begin(), cur.end());\n\t\tmaxim(res[0], cur);\n\t}\n\n\tfor (auto i : res[0]) printf(\"%c\", S[i]);\n\tprintf(\"\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <string>\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nint n;\n\nchar ch[6666];\n\nint _a[6666], _b[6666];\n\nstring dealab(int l, int r) {\n    string S = \"\";\n    for(int i = l, nxt; i <= r; i = nxt + 1) {\n        S += \"ab\";\n        for(nxt = i; nxt < n && _a[nxt + 1] < _b[i]; nxt++);\n    }\n    return S;\n}\n\nstring dealba(int l, int r, string T) {\n    string X = T;\n    static bool B[6666];\n    memset(B, 0, sizeof B);\n    for(int i = r; i >= l; i--) {\n        B[_b[i]] = 1;\n        B[_a[i]] = 1;\n        string Y = \"\";\n        for(int j = 1; j <= 2 * n; j++) if(B[j]) Y = Y + ch[j];\n        Y = Y + T;\n        if(X < Y) X = Y;\n    }\n    return X;\n}\n\nint main() {\n    scanf(\"%d%s\", &n, ch + 1);\n    int t = 0, a = 1, b = 1;\n    while(ch[a] != 'a') a++;\n    while(ch[b] != 'b') b++;\n    for(int i = 1; i <= n; i++) {\n        _a[i] = a;\n        _b[i] = b;\n        if(i == n) break;\n        a++, b++;\n        while(ch[a] != 'a') a++;\n        while(ch[b] != 'b') b++;\n    }\n    int l = n + 1;\n    if(ch[n * 2] == 'b') {\n        for(int i = n; i >= 1; i--) if(_a[i] < _b[i]) l = i; else break;\n    }\n    vector <int> V;\n    V.push_back(0);\n    for(int i = 1, nxt; i <= n; i = nxt + 1) {\n        if(_b[i] > _a[i]) {\n            nxt = i;\n            continue;\n        }\n        for(nxt = i; nxt < n && _b[nxt + 1] < _a[nxt]; nxt++);\n        V.push_back(nxt);\n    }\n    string S = dealab(l, n);\n    for(int i = (int) V.size() - 1; i > 0; i--) S = dealba(V[i - 1] + 1, V[i], S);\n    cout << S;\n    putchar('\\n');\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<vector>\ntypedef long long ll;\ntypedef double dd;\n#define For(i,j,k) for (int i=(int)j;i<=(int)k;++i)\n#define Forr(i,j,k) for (int i=(int)j;i>=(int)k;--i)\n#define Set(a,p) memset(a,p,sizeof(a))\nusing namespace std;\n\ntemplate<typename T>bool chkmax(T &a,T b) { return a<b?a=b,1:0; }\ntemplate<typename T>bool chkmin(T &a,T b) { return a>b?a=b,1:0; }\n\nconst int maxn=6000+100;\nstruct node {\n\tint l,r;\n};\nint n;\nint sum[maxn],ma[maxn];\nchar s[maxn];\nvector<node>a;\nvector<int>sa,sb;\nstring dp[maxn];\n\ninline void file() {\n\tfreopen(\"AGC026E.in\",\"r\",stdin);\n\tfreopen(\"AGC026E.out\",\"w\",stdout);\n}\n\nstring solve(int l,int r) {\n\tstring ans=\"\";\n\tif (s[l]=='a') {\n\t\tFor (i,l,r)\n\t\t\tif (s[i]=='a') {\n\t\t\t\tstring ss=\"ab\";\n\t\t\t\tint p=ma[i]+1;\n\t\t\t\twhile (p<=r) {\n\t\t\t\t\twhile (p<=r && s[p]=='b') ++p;\n\t\t\t\t\tif (p>r) break;\n\t\t\t\t\tss=ss+\"ab\"; p=ma[p]+1;\n\t\t\t\t}\n\t\t\t\tif (ss>ans) ans=ss;\n\t\t\t}\n\t}\n\telse {\n\t\tFor (i,l,r)\n\t\t\tif (s[i]=='b') {\n\t\t\t\tstring ss=\"\";\n\t\t\t\tint p=i,R=ma[i];\n\t\t\t\twhile (p<=R && p<=r) {\n\t\t\t\t\tif (s[p]=='b') ss=ss+\"b\",chkmax(R,ma[p]);\n\t\t\t\t\tif (s[p]=='a' && ma[p]>=i) ss=ss+\"a\";\n\t\t\t\t\t++p;\n\t\t\t\t}\n\t\t\t\tif (ss>ans) ans=ss;\n\t\t\t}\n\t}\n\treturn ans;\n}\n\nint main() {\n//\tfile();\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1,l=1;i<=2*n;++i) {\n\t\tif (s[i]=='a') {\n\t\t\tsum[i]=sum[i-1]+1;\n\t\t\tsa.push_back(i);\n\t\t}\n\t\telse {\n\t\t\tsum[i]=sum[i-1]-1;\n\t\t\tsb.push_back(i);\n\t\t}\n\t\tif (sum[i]==0) {\n\t\t\ta.push_back((node){l,i}); l=i+1;\n\t\t}\n\t}\n\tFor (i,0,n-1) ma[sa[i]]=sb[i],ma[sb[i]]=sa[i];\n//\tFor (i,1,2*n) printf(\"%d \",ma[i]); cout << endl;\n//\tFor (i,0,a.size()-1)\n//\t\tcout << a[i].l << \" \" << a[i].r << endl;\n\tFor (i,0,a.size()-1) dp[i]=solve(a[i].l,a[i].r);\n\tForr (i,a.size()-2,0) dp[i]=max(dp[i]+dp[i+1],dp[i+1]);\n\tcout << dp[0] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n\n  int ctr = 0, lp = -1;\n  rep(i, pos_a.size()) if (lp < pos_a[i]) {\n    ctr++;\n    lp = pos_b[i];\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (a < num && (b == num || pos_a[a] < pos_b[b])) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    //cout<<\"offset=\"<<offset<<\": \"<<o<<\"\\n\";\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<pair<string, int> > list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(make_pair(solve_ba(s), -i));\n    }\n  }\n  sort(all(list2), greater<pair<string, int> >());\n  string out = \"\";\n  int lp = -1;\n  for (auto p : list2) {\n    int ord = -p._2;\n    if (lp < ord) {\n      out += p._1;\n      lp = ord;\n    }\n  }\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  //cout<<\"add=\"<<add<<\"\\n\";\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],nxt[MAX],cnt[2];\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=L;A<=R;A++)\n\t\t{\n\t\t\tif(X[A]=='a')\n\t\t\t\tcontinue;\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <string>\n\nusing namespace std;\n\nconst int MAXN = 3000 + 10;\n\nint N;\nchar str[MAXN << 1];\nint apos[MAXN]= {0}, bpos[MAXN]= {0};\nint an = 0, bn = 0;\n\nstring f[MAXN], g[MAXN];\n// f[i]: 强制选第i对a、b，对i...n对a、b的最大串\n// g[i]: max (f[i], f[i + 1], ..., f[n])\n\nint main () {\n\tscanf (\"%d%s\", & N, str + 1);\n\tfor (int i = 1; i <= N << 1; i ++) {\n\t\tif (str[i] == 'a') apos[++ an] = i;\n\t\tif (str[i] == 'b') bpos[++ bn] = i;\n\t}\n\tfor (int i = N; i >= 1; i --) {\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tint j = i;\n\t\t\twhile (j <= N && apos[j] < bpos[i]) j ++;\n\t\t\tf[i] = \"ab\" + g[j];\n\t\t}\n\t\telse {\n\t\t\tint j = i;\n\t\t\twhile (j <= N && bpos[j] < apos[i]) j ++;\n\t\t\tfor (int k = 1; k <= j - i; k ++) f[i] += 'b';\n\t\t\tf[i] += 'a' + (i + 1 == j ? g[i + 1] : f[i + 1]).substr(j - i - 1, string::npos);\n\t\t}\n\t\tg[i] = max (f[i], g[i + 1]);\n\t}\n\tcout << g[1] << endl;\n\n\treturn 0;\n}\n\n/*\n3\naababb\n*/\n\n/*\n9\nabbbaababaababbaba\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace TYC\n{\n\ttypedef pair<int, int> pii;\n\tconst int N = 3005;\n\n\tinline bool operator < (const string &a, const string &b)\n\t{\n\t\tint la = int(a.size()), lb = int(b.size()), l = min(la, lb);\n\t\tfor (int i = 0; i < l; i++)\n\t\t\tif (a[i] != b[i])\n\t\t\t\treturn a[i] < b[i];\n\t\treturn la < lb;\n\t}\n\n\tvoid solve(string &S)\n\t{\n\t\tstring ans;\n\t\tint len = int(S.size());\n\t\tif (S[0] == 'a')\n\t\t{\n\t\t\tstatic int P[N];\n\t\t\tfor (int i = 0, j = 0; i < len; i++)\n\t\t\t\tif (S[i] == 'b')\n\t\t\t\t\tP[++j] = i;\n\t\t\tfor (int i = 0, j = 0; i < len; )\n\t\t\t{\n\t\t\t\tans += \"ab\";\n\t\t\t\ti = P[++j] + 1;\n\t\t\t\twhile (i < len && S[i] == 'b')\n\t\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\twhile (len)\n\t\t\t{\n\t\t\t\tans = max(ans, S); \n\t\t\t\tS[0] = '#';\n\t\t\t\tfor (int i = 1; i < len; i++)\n\t\t\t\t\tif (S[i] == 'a')\n\t\t\t\t\t{\n\t\t\t\t\t\tS[i] = '#';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tfor (int i = 0, j = 0; i < len; i++)\n\t\t\t\t\tif (S[i] != '#')\n\t\t\t\t\t\tS[j++] = S[i];\n\t\t\t\tlen -= 2;\n\t\t\t\tS.resize(len);\n\t\t\t}\n\t\t}\n\t\tS = ans;\n\t}\n\n\tvoid work()\n\t{\n\t\tios::sync_with_stdio(false);\n\t\tcin.tie(0);\n\t\tstatic string S[N], Str;\n\t\tint n, tot = 1;\n\t\tcin >> n >> Str;\n\t\tfor (int i = 0, c = 0; i < (n << 1); i++)\n\t\t{\n\t\t\tS[tot] += Str[i];\n\t\t\tc += Str[i] == 'a' ? 1 : -1;\n\t\t   \tif (!c)\n\t\t\t\t++tot;\n\t\t}\t\n\t\tfor (int i = 1; i <= tot; i++)\n\t\t\tsolve(S[i]);\n\t\tstring ans;\n\t\tfor (int i = tot; i; i--)\n\t\t\tans = max(ans, S[i] + ans);\n\t\tcout << ans << '\\n';\n\t}\n}\n\nint main()\n{\n\tTYC::work();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[6005];\nstring dp[3005];\nvoid rec(){\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tassert(a.size()==b.size());\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tif(pos.empty()){\n\t\trec(); return 0;\n\t}\n\tvector<int>vec;\n\tfor(int i=0;i<pos.size();i++){\n\t\tvector<int>in;\n\t\tint pre = INF;\n\t\tint en = pos.size();\n\t\ten--;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tif(pre < b[pos[j]]){\n\t\t\t\ten = j-1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tpre = a[pos[j]];\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tif(dp[en] < cur)\t{\n\t\t\tdp[en] = cur;\n\t\t\tvec.pb(en);\n\t\t}\n\t}\n\tERASE(vec);\n\tstring pre = \"\";\n\tfor(int i=1;i<vec.size();i++){\n\t\tfor(int j=0;j<i;j++) dp[i] = max(dp[i],dp[j]+dp[i]);\n\t\tint nxt = b[pos[vec[i]]]+1;\n\t\tstring cur = dp[i];\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\t//assert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <chrono>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstring>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <random>\n#include <set>\n#include <stack>\n#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <cstdint>\nusing namespace std;\ntypedef long long ll;\n#define MP make_pair\n#define PB push_back\n#define inf 1000000007\n#define mod 1000000007\n#define rep(i,n) for(int i = 0; i < (int)(n); ++i)\n\nint main(){\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<int>a(n),b(n);\n    int ai = 0,bi = 0;\n    for(int i=0;i<2*n;i++){\n        if(s[i]=='a'){\n            a[ai] = i;\n            ai++;\n        }else{\n            b[bi] = i;\n            bi++;\n        }\n    }\n    bool flag = 0;\n    vector<pair<int,int> >v;\n    vector<pair<int,char> > qqq;\n    vector<int> pa,pb;\n    rep(i,n){\n        if(a[i]>b[i]){\n            flag = 1;\n            v.push_back(MP(b[i],i));\n            qqq.push_back(MP(a[i],'a'));\n            qqq.push_back(MP(b[i],'b'));\n            pa.push_back(a[i]);\n            pb.push_back(b[i]);\n        }\n    }\n    \n    if(!flag){\n        string res;\n        res += \"ab\";\n        int p = b[0];\n        while(1){\n            int k = lower_bound(a.begin(),a.end(),p)-a.begin();\n            if(k==n){\n                break;\n            }else{\n                res += \"ab\";\n                p = b[k];\n            }\n        }\n        cout << res << endl;\n        return 0;\n    }\n    sort(qqq.begin(),qqq.end());\n    string ps;\n    rep(i,qqq.size())ps.push_back(qqq[i].second);\n    int m = ps.size()/2;\n    vector<int> nxt(m,m);\n    for(int i=m-1;i>=0;i--){\n        auto x = upper_bound(pb.begin(),pb.end(),pa[i]);\n        x--;\n        int k = x-pb.begin();\n        nxt[i] = k;\n    }\n    for(int i=m-1;i>=0;i--){\n        nxt[i] = nxt[nxt[i]];\n    }\n    vector<pair<string,int> > d(m);\n    rep(i,m){\n        int aid = 0;\n        int bid = 0;\n        string c;\n        rep(j,2*m){\n            if(ps[j]=='a'){\n                if(aid>=i&&aid<=nxt[i]){\n                    c.push_back('a');\n                }\n                aid++;\n            }else{\n                if(bid>=i&&bid<=nxt[i]){\n                    c.push_back('b');\n                }\n                bid++;\n            }\n        }\n        d[i] = MP(c,-i);\n    }\n    sort(d.rbegin(),d.rend());\n    int cc = -1;\n    string res;\n    rep(i,m){\n        if(cc >=-d[i].second)continue;\n        else{\n            res += d[i].first;\n            cc = nxt[-d[i].second];\n        }\n    }\n    int p = pa[m-1]+1;\n    while(1){\n        int k = lower_bound(a.begin(),a.end(),p)-a.begin();\n        if(k==n){\n            break;\n        }else{\n            res += \"ab\";\n            p = b[k];\n        }\n    }\n    cout << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int N = 6005;\nstd::string s, f[N];\nint n, apos[N], bpos[N], id[N];\nint main() {\n\tstd::ios::sync_with_stdio(0), std::cin.tie(0);\n\tstd::cin >> n >> s;\n\tint a = 0, b = 0;\n\tfor (int i = 0; i < n + n; ++i)\n\t\tif (s[i] == 'a') apos[a] = i, id[i] = a++;\n\t\telse bpos[b] = i, id[i] = b++;\n\tf[n - 1] = apos[n - 1] < bpos[n - 1] ? \"ab\" : \"ba\";\n\tfor (int i = n - 2; ~i; --i) {\n\t\tf[i] = f[i + 1];\n\t\tif (apos[i] < bpos[i]) {\n\t\t\tf[i] = std::max(f[i], \"ab\" + f[i + std::count(s.begin() + apos[i], s.begin() + bpos[i], 'a')]);\n\t\t} else {\n\t\t\tstd::string t; int q = 0;\n\t\t\tfor (int j = bpos[i]; j < n + n; ++j) if (id[j] >= i) {\n\t\t\t\tq += s[j] == 'b' ? 1 : -1, t += s[j];\n\t\t\t\tif (!q) break;\n\t\t\t}\n\t\t\tf[i] = std::max(f[i], t + f[i + t.size() / 2]);\n\t\t}\n\t}\n\tstd::cout << f[0] << '\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#include <math.h>\n#include <string.h>\n#include <time.h>\n#include <stdlib.h>\n#include <string>\n#include <bitset>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <algorithm>\n#include <sstream>\n#include <stack>\n#include <iomanip>\nusing namespace std;\n#define pb push_back\n#define mp make_pair\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef double ld;\ntypedef vector<int> vi;\n#define fi first\n#define se second\n#define fe first\n#define FO(x) {freopen(#x\".in\",\"r\",stdin);freopen(#x\".out\",\"w\",stdout);}\n#define Edg int M=0,fst[SZ],vb[SZ],nxt[SZ];void ad_de(int a,int b){++M;nxt[M]=fst[a];fst[a]=M;vb[M]=b;}void adde(int a,int b){ad_de(a,b);ad_de(b,a);}\n#define Edgc int M=0,fst[SZ],vb[SZ],nxt[SZ],vc[SZ];void ad_de(int a,int b,int c){++M;nxt[M]=fst[a];fst[a]=M;vb[M]=b;vc[M]=c;}void adde(int a,int b,int c){ad_de(a,b,c);ad_de(b,a,c);}\n#define es(x,e) (int e=fst[x];e;e=nxt[e])\n#define esb(x,e,b) (int e=fst[x],b=vb[e];e;e=nxt[e],b=vb[e])\n#define SZ 6666\nint n,a[SZ],an=0,b[SZ],bn=0,fy[SZ]; char s[SZ];\nstring ss[SZ]; int sn=0;\nstring work(int l,int r)\n{\n\tint tl=-1,tr;\n\tfor(int g=1;g<=n;++g)\n\t\tif(a[g]>=l&&a[g]<=r)\n\t\t{\n\t\t\tif(tl==-1) tl=g; tr=g;\n\t\t}\n\tif(a[tl]<b[tl])\n\t{\n\t\tint cp=0; string op=\"\";\n\t\tfor(int i=tl;i<=tr;++i)\n\t\t\tif(cp<a[i]) op=op+\"ab\",cp=b[i];\n\t\treturn op;\n\t}\n\tstring mx=\"\";\n\tfor(int i=tl;i<=tr;++i)\n\t{\n\t\tstring c=\"\";\n\t\tfor(int j=l;j<=r;++j)\n\t\t\tif(fy[j]>=i) c.pb(s[j]);\n\t\tmx=max(mx,c);\n\t}\n\treturn mx;\n}\nstring f[SZ];\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n+n;++i)\n\t{\n\t\tif(s[i]=='a') a[++an]=i,fy[i]=an;\n\t\telse b[++bn]=i,fy[i]=bn;\n\t}\n\tint cl=1,cs=0;\n\tfor(int i=1;i<=n+n;++i)\n\t{\n\t\tif(s[i]=='a') ++cs; else --cs;\n\t\tif(!cs) ss[++sn]=work(cl,i),cl=i+1;\n\t}\n\tfor(int i=sn;i>=1;--i)\n\t\tf[i]=max(ss[i]+f[i+1],f[i+1]);\n\tcout<<f[1]<<\"\\n\";\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n//#define int long long\nusing namespace std;\n\nint n,cnt[6010];\nstring dp[6010];\nstring s;\nvector<int> a,b;\n\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tcin>>s;\n\tfor(int i=0;i<n*2;i++){\n\t\tif(s[i]=='a'){a.push_back(i);cnt[i]=a.size()-1;}\n\t\telse{b.push_back(i);cnt[i]=b.size()-1;}\n\t}\n\tfor(int i=0;i<=2*n;i++) dp[i]=\"\";\n\tfor(int i=n-1;i>=0;i--){\n\t\tif(a[i]<b[i]){\n\t\t\tint maxv=i;\n\t\t\tfor(int j=a[i];j<=b[i];j++){\n\t\t\t\tmaxv=max(maxv,cnt[j]);\n\t\t\t}\n\t\t\tdp[i]=\"ab\"+dp[maxv+1];\n\t\t\tcout<<dp[i]<<endl;\n\t\t}\n\t\telse{\n\t\t\tint cur=i;\n\t\t\twhile(cur+1<n&&b[cur+1]<a[cur]) cur++;\n\t\t\tfor(int j=b[i];j<2*n;j++){\n\t\t\t\tif(cnt[j]>=i&&cnt[j]<=cur){\n\t\t\t\t\tdp[i]+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i]+=dp[cur+1];\n\t\t\tcout<<dp[i]<<endl;\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[0]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define F(i, a, b) for (int i = a; i <= b; i ++)\n#define G(i, a, b) for (int i = a; i >= b; i --)\n#define out4(x, y, z, w) { if (debug) printf(#x\" = \"),W(x),printf(\" \"#y\" = \"),W(y),printf(\" \"#z\" = \"),W(z),printf(\" \"#w\" = \"),W(w),putc('\\n'); }\n#define out3(x, y, z) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), printf(\" \"#z\" = \"), W(z), putc('\\n'); }\n#define out2(x, y) { if (debug) printf(#x\" = \"), W(x), printf(\" \"#y\" = \"), W(y), putc('\\n'); }\n#define out1(x) { if (debug) printf(#x\" = \"), W(x), putc('\\n'); }\n#define outline(x) { if (debug) puts(\"-------------------------------------------\"#x\"----------------------------------------\"); }\n#define outarr(a, L, R) { if (debug) { printf(#a\"[%d..%d] = \", L, R); F(i, L, R) W(a[i]), putc(' '); putc('\\n'); } }\n#define Assert(x) { if ((debug) && (!(x))) { puts(\"Wrong Answer\"); exit(0); } }\n#define max(a, b) ((a) > (b) ? (a) : (b))\n#define min(a, b) ((a) < (b) ? (a) : (b))\n#define mem(a, b) memset(a, b, sizeof a)\n#define mec(a, b) memcpy(a, b, sizeof a)\n#define mx(a, b) ((a) = max(a, b))\n#define mn(a, b) ((a) = min(a, b))\n#define lowbit(x) ((x) & (-(x)))\n#define abs(x) ((max(x, - (x))))\n#define get getchar()\n#define pb push_back\n#define putc putchar\n#define inf 2e9\n\ntemplate <typename Int>\nvoid R(Int &x) {\n\tchar c = get; x = 0; Int t = 1;\n\tfor (; !isdigit(c); c = get) t = (c == '-' ? - 1 : t);\n\tfor (; isdigit(c); x = (x << 3) + (x << 1) + c - '0', c = get); x *= t;\n}\ntemplate <typename Int>\nvoid W(Int x) {\n\tif (x < 0) { putc('-'); x = - x ; }\n\tif (x > 9) W(x / 10); putc(x % 10 + '0');\n}\n\n#define debug (0)\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\nint n, L, LEN, c[N], Ans[N], cnt[2], C[N], D[N];\nstruct node {\n\tint num; vector <int> c;\n\tfriend bool operator < (node a, node b) {\n\t\tint len = min(a.c.size(), b.c.size());\n\t\tF(i, 0, len - 1)\n\t\t\tif (a.c[i] < b.c[i]) return 1; else\n\t\t\tif (a.c[i] > b.c[i]) return 0;\n\t\treturn a.c.size() < b.c.size() || a.c.size() == b.c.size() && a.num > b.num;\n\t}\n\tvoid add(int x) { c.pb(x); }\n} a, b[N];\n\nchar ch[N];\nstruct nobe { int x, l, r; } d[N];\n\nint main() {\n\tfreopen(\"data.in\",\"r\",stdin);\n\n\tR(n), scanf(\"%s\", ch + 1), n *= 2;\n\tint las = 0, s = 0;\n\tF(i, 1, n) {\n\t\ts += (ch[i] == 'b' ? 1 : (-1));\n\t\tif (s == 0)\n\t\t\td[++ L] = {ch[las + 1] - 'a', las + 1, i}, las = i;\n//\t\tprintf(\"%d \", s);\n\t}\n//\tputc('\\n');\n\n\tint flag = 0, total = 0;\n\tG(i, L, 1) {\n\t\tint l = d[i].l, r = d[i].r;\n\t\tif (d[i].x) {\n\t\t\tout4(d[i].x, d[i].l, d[i].r, i);\n\t\t\tflag = 1, b[++ total].num = i;\n\t\t\tF(k, 1, (r - l + 1) / 2) {\n\t\t\t\tcnt[0] = cnt[1] = 0;\n\t\t\t\tint len = 0;\n\t\t\t\tG(j, r, l)\n\t\t\t\t\tif (++ cnt[ch[j] - 'a'] <= k)\n\t\t\t\t\t\tc[++ len] = ch[j] - 'a';\n\t\t\t\treverse(c + 1, c + len + 1);\n//\t\t\t\toutarr(c, 1, len);\n\t\t\t\ta.c.clear(), a.num = i;\n\t\t\t\tF(j, 1, len) a.add(c[j]);\n\t\t\t\tif (b[total] < a)\n\t\t\t\t\tb[total] = a;\n\t\t\t}\n//\t\t\tprintf(\"%d %d\\n\", b[total].c.size(), b[total].num);\n//\t\t\tF(j, 0, b[total].c.size() - 1)\n//\t\t\t\tprintf(\"%c\", b[total].c[j] + 'a');\n//\t\t\tputc('\\n');\n\t\t}\n\t\telse {\n\t\t\tif (flag) continue;\n\t\t\tint len = 0, bz = 0;\n\t\t\tF(j, l, r) {\n\t\t\t\tif (ch[j] == 'a') {\n\t\t\t\t\tif (!bz)\n\t\t\t\t\t\tC[++ len] = 0, bz = 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (bz)\n\t\t\t\t\t\tC[++ len] = 1, bz = 0;\n\t\t\t\t}\n\t\t\t\toutarr(C, 1, len);\n\t\t\t}\n\t\t\tG(j, len, 1) D[++ LEN] = C[j];\n\t\t}\n\t}\n\n\tsort(b + 1, b + total + 1);\n\n\tout1(b[1].num);\n\tlas = 0;\n\tG(i, total, 1)\n\t\tif (b[i].num > las) {\n\t\t\tF(j, 0, b[i].c.size() - 1)\n\t\t\t\tprintf(\"%c\", b[i].c[j] + 'a');\n\t\t\tlas = b[i].num;\n\t\t}\n\tG(i, LEN, 1) printf(\"%c\", D[i] + 'a');\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using gpp_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename L> using gpp_map = tree<T, L, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T> using gpp_multiset = tree<T, null_type, less_equal<T>, rb_tree_tag, tree_order_statistics_node_update>;*/\nstruct fast_ios { fast_ios(){ cin.tie(0); ios::sync_with_stdio(false); cout << fixed << setprecision(20); }; } fast_ios_;\n#define FOR(i, begin, end) for(int i=(begin);i<(end);i++)\n#define REP(i, n) FOR(i,0,n)\n#define IFOR(i, begin, end) for(int i=(end)-1;i>=(begin);i--)\n#define IREP(i, n) IFOR(i,0,n)\n#define Sort(v) sort(v.begin(), v.end())\n#define Reverse(v) reverse(v.begin(), v.end())\n#define all(v) v.begin(),v.end()\n#define SZ(v) ((int)v.size())\n#define Lower_bound(v, x) distance(v.begin(), lower_bound(v.begin(), v.end(), x))\n#define Upper_bound(v, x) distance(v.begin(), upper_bound(v.begin(), v.end(), x))\n#define Max(a, b) a = max(a, b)\n#define Min(a, b) a = min(a, b)\n#define bit(n) (1LL<<(n))\n#define bit_exist(x, n) ((x >> n) & 1)\n#define debug(x) cout << #x << \"=\" << x << endl;\n#define vdebug(v) cout << #v << \"=\" << endl; REP(i_debug, v.size()){ cout << v[i_debug] << \",\"; } cout << endl;\n#define mdebug(m) cout << #m << \"=\" << endl; REP(i_debug, m.size()){ REP(j_debug, m[i_debug].size()){ cout << m[i_debug][j_debug] << \",\"; } cout << endl;}\n#define pb push_back\n#define f first\n#define s second\n#define int long long\n#define INF 1000000000000000000\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v){ for (auto &x : v) is >> x; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &v){ for(int i = 0; i < v.size(); i++) { cout << v[i]; if(i != v.size() - 1) cout << endl; }; return os; }\ntemplate<typename T> void Out(T x) { cout << x << endl; }\ntemplate<typename T1, typename T2> void Ans(bool f, T1 y, T2 n) { if(f) Out(y); else Out(n); }\n\nusing vec = vector<int>;\nusing mat = vector<vec>;\nusing Pii = pair<int, int>;\nusing PiP = pair<int, Pii>;\nusing PPi = pair<Pii, int>;\nusing bools = vector<bool>;\nusing pairs = vector<Pii>;\n\n//int dx[4] = {1,0,-1,0};\n//int dy[4] = {0,1,0,-1};\n//char d[4] = {'D','R','U','L'};\n\nconst int mod = 1000000007;\n//const int mod = 998244353;\n//#define Add(x, y) x = (x + (y)) % mod\n//#define Mult(x, y) x = (x * (y)) % mod\n\nvoid add_a(string &S, int i0, int i1, vector<string> &v){\n    \n    string x = \"\";\n    vec id_A, id_B;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'a') id_A.pb(i);\n        else id_B.pb(i);\n    }\n    int ia = 0;\n    while(ia < SZ(id_A)){\n        x += \"ab\";\n        int tmp = id_B[ia];\n        while(ia < SZ(id_A) && id_A[ia] <= tmp) ia++;\n    }\n\n    if(SZ(v) > 0 && v.back()[0] == 'a') v.back() += x;\n    else v.pb(x);\n}\n\nvoid add_b(string &S, int i0, int i1, vector<string> &v){\n    string x = \"\";\n    int now = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        Max(x, string(now, 'b') + S.substr(i + 1, i1 - i));\n    }\n    v.pb(x);\n}\n\nsigned main(){\n\n    int N; cin >> N;\n    string S; cin >> S;\n\n    vector<string> v;\n    int now = 0, i0 = 0;\n    REP(i, 2 * N){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        if(now == 0){\n            if(S[i0] == 'a') add_a(S, i0, i, v);\n            else add_b(S, i0, i, v);\n            i0 = i + 1;\n        }\n    }\n    //vdebug(v);\n\n    vector<string> ans;\n    for(string x: v){\n        while(SZ(ans) > 0 && ans.back() < x) ans.pop_back();\n        ans.pb(x);\n    }\n    for(string x: ans) cout << x;\n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int MAXN = 3e3 + 10;\n\nint n, cntA, cntB;\nint posA[MAXN], posB[MAXN], nxt[MAXN], id[MAXN << 1];\nchar s[MAXN << 1];\nstd::string dp[MAXN];\n\nint main() {\n\tscanf(\"%d %s\", &n, s + 1);\n\tfor (int i = 1; i <= n << 1; ++i) s[i] == 'a' ? posA[id[i] = ++cntA] = i: posB[id[i] = ++cntB] = i;\n\tid[posA[n + 1] = posB[n + 1] = n * 2 + 1] = n + 1;\n\tfor (int i = 1, j = 0; i <= n + 1; ++i) while (j < posA[i] && j < posB[i]) nxt[++j] = i;\n\tfor (int i = n; i; --i) {\n\t\tif (posA[i] > posB[i]) {\n\t\t\tint j = posB[i];\n\t\t\twhile (posB[id[j]] < posA[id[j]] && (id[j] <= i || posB[id[j]] < posA[id[j] - 1])) { if (id[j] >= i) dp[i] += s[j]; ++j; }\n\t\t\tdp[i] += dp[id[j]];\n\t\t} else dp[i] = \"ab\" + dp[nxt[posB[i] + 1]];\n\t\tdp[i] = std::max(dp[i], dp[i + 1]);\n\t}\n\tstd::cout << dp[1] << '\\n';\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MAXN = 3000;\nchar S[2*MAXN + 5];\nint a[MAXN + 5], b[MAXN + 5], c[2*MAXN + 5];\nint dp[MAXN + 5][MAXN + 5];\nint N, A, B;\nstring fun(int num[]) {\n\tstring ret = \"\";\n\tfor(int i=1;i<=2*N;i++)\n\t\tif( num[c[i]] ) ret.insert(ret.end(), S[i]);\n\treturn ret;\n}\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S+1);\n\tfor(int i=1;i<=2*N;i++) {\n\t\tif( S[i] == 'a' ) a[++A] = i, c[i] = A;\n\t\telse b[++B] = i, c[i] = B;\n\t}\n\tdp[N][N] = 1;\n\tfor(int i=N-1;i>=1;i--) {\n\t\tdp[i][i] = 1;\n\t\tif( a[i] < b[i] ) {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=a[i];j<=b[i];j++) {\n\t\t\t\tif( c[j] < i ) continue;\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\t}\n\t\t\tfor(int j=b[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] > Max )\n\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t}\n\t\telse {\n\t\t\tint Max = 0;\n\t\t\tfor(int j=b[i];j<=a[i];j++) {\n\t\t\t\tif( c[j] < i ) continue;\n\t\t\t\tMax = max(Max, c[j]);\n\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t}\n\t\t\tfor(int j=a[i]+1;j<=2*N;j++)\n\t\t\t\tif( c[j] > Max )\n\t\t\t\t\tdp[i][c[j]] = dp[Max+1][c[j]];\n\t\t}\n\t\tif( fun(dp[i]) < fun(dp[i+1]) )\n\t\t\tmemcpy(dp[i], dp[i+1], sizeof dp[i+1]);\n\t}\n\tcout << fun(dp[1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <cassert>\n#include <string.h>\n//#include <unordered_set>\n//#include <unordered_map>\n//#include <bits/stdc++.h>\n\n#define MP(A,B) make_pair(A,B)\n#define PB(A) push_back(A)\n#define SIZE(A) ((int)A.size())\n#define LEN(A) ((int)A.length())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define fi first\n#define se second\n\nusing namespace std;\n\ntemplate<typename T>inline bool upmin(T &x,T y) { return y<x?x=y,1:0; }\ntemplate<typename T>inline bool upmax(T &x,T y) { return x<y?x=y,1:0; }\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double lod;\ntypedef pair<int,int> PR;\ntypedef vector<int> VI;\n\nconst lod eps=1e-11;\nconst lod pi=acos(-1);\nconst int oo=1<<30;\nconst ll loo=1ll<<62;\nconst int mods=998244353;\nconst int MAXN=6005;\nconst int INF=0x3f3f3f3f;//1061109567\n/*--------------------------------------------------------------------*/\ninline int read()\n{\n\tint f=1,x=0; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') f=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') { x=(x<<3)+(x<<1)+(c^48); c=getchar(); }\n\treturn x*f;\n}\nchar ST[MAXN>>1][MAXN],st[MAXN],ch[MAXN];\nint c[MAXN],ID[MAXN],id[MAXN],cnt[2];\nPR p[MAXN];\nbool compare(char *x,char *y)\n{\n\tint len=max(strlen(x+1),strlen(y+1));\n\tfor (int i=1;i<=len;i++)\n\t\tif (x[i]>y[i]) return 1;\n\t\telse if (x[i]<y[i]) return 0;\n\treturn 0;\n}\nint comparec(int x,int y){ return x>y; } \nvoid solve(int t,int l,int r)\n{\n\t\n\tif (st[l]=='a')\n\t{\n\t\tint mx=0;\n\t\tfor (int i=l;i<=r;i++)\n\t\tif (st[i]=='a')\n\t\t{\n\t\t\tint tmp=0;\n\t\t\tfor (int j=i;j<=r;j++)\n\t\t\t\tif (st[j]=='a') ++tmp,j=p[id[j]].se;\n\t\t\tupmax(mx,tmp);\n\t\t}\n\t\tfor (int i=1;i<=mx<<1;i+=2) ST[t][i]='a',ST[t][i+1]='b';\n\t}\n\tif (st[l]=='b')\n\t{\n\t\tint num=0;\n\t\tfor (int i=l;i<=r;i++) if (st[i]=='a') c[++num]=id[i];\n\t\tsort(c+1,c+num+1,comparec);\n\t\tfor (int i=1;i<=r-l+1;i++) ST[t][i]=st[i+l-1];\n\t\tfor (int i=1;i<=num;i++)\n\t\t{\n\t\t\tint len=0;\n\t\t\tfor (int j=l;j<=r;j++)\n\t\t\t\tif (id[j]>=c[i]) ch[++len]=st[j];\n//\t\t\tcout<<ch+1<<endl;\n\t\t\tif (compare(ch,ST[t]))\n\t\t\t{\t\n\t\t\t\tfor (int j=1;j<=len;j++) ST[t][j]=ch[j];\n\t\t\t\tfor (int j=len+1;j<=r-l+1;j++) ST[t][j]=' ';\n\t\t\t}\n\t\t}\n\t}\n}\nint compareid(int x,int y) { return compare(ST[x],ST[y]); } \nint main()\n{\n\tint n=read();\n\tscanf(\"%s\",st+1);\n\tint numa=0,numb=0;\n\tfor (int i=1;i<=n<<1;i++)\n\t{\n\t\tif (st[i]=='a') p[++numa].fi=i,id[i]=numa;\n\t\tif (st[i]=='b') p[++numb].se=i,id[i]=numb;\n\t}\n\t\n\tint t=0;\n\tfor (int i=1,lst=1;i<=n<<1;i++)\n\t{\n\t\tcnt[st[i]-'a']++;\n\t\tif (cnt[0]==cnt[1]) ID[++t]=t,solve(t,lst,i),lst=i+1;\n\t}\n\tsort(ID+1,ID+t+1,compareid);\n//\tcout<<endl;\n//\tfor (int i=1;i<=t;i++) cout<<ST[i]+1<<\" \"<<ID[i]<<endl;\n\tint smax=0;\n\tfor (int i=1;i<=t;i++)\n\t\tif (ID[i]>smax) printf(\"%s\",ST[ID[i]]+1),smax=ID[i]; \n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int N = 3005, M = 6005;\n\nint n, na, nb, a[N], b[N], wh[N];\nchar s[M];\nstd::string f[N];\n\nint main()\n{\n\tstd::cin >> n;\n\tscanf(\"%s\", s + 1);\n\tfor (int i = 1; i <= n * 2; i++)\n\t\tif (s[i] == 'a') a[++na] = i; else b[wh[i] = ++nb] = i;\n\tfor (int i = n; i >= 1; i--)\n\t{\n\t\tif (a[i] < b[i])\n\t\t{\n\t\t\tint j = i;\n\t\t\twhile (j <= n && (a[j] <= b[i] || b[j] <= b[i])) j++;\n\t\t\tf[i].push_back('a'); f[i].push_back('b'); f[i] = f[i] + f[j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint mx = a[i], k = n + 1;\n\t\t\tfor (int j = b[i]; j <= mx; j++)\n\t\t\t\tif (s[j] == 'b' && a[wh[j]] > mx) mx = a[wh[j]];\n\t\t\tfor (int j = 1; j <= n; j++) if (a[j] > mx && b[j] > mx && j < k)\n\t\t\t\tk = j;\n\t\t\tfor (int j = b[i]; j <= mx; j++) f[i].push_back(s[j]);\n\t\t\tf[i] = f[i] + f[k];\n\t\t}\n\t\tif (f[i + 1] > f[i]) f[i] = f[i + 1];\n\t}\n\treturn std::cout << f[1] << std::endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define N 10000\n#define M 1000005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Max[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Max(int x,int y) {\n\tif(f[x]<N&&f[y]>N) return 0;\n\tif(f[x]>N&&f[y]<N) return 1;\n\tif(f[x]<N) return f[x]>=f[y];\n\tif(f[x]/N>f[y]/N||(f[x]/N==f[y]/N&&check(f[y]%N,R[y],f[x]%N,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\t//cout<<\"-_-\"<<l<<\" \"<<r<<endl;\n\t\tif(s[l]=='a') {\n\t\t\tshu=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='a'&&!shu) ++f[be[l]],shu=1;\n\t\t\t\telse shu=0;\n\t\t} \n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r-1,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*N+id;\n\t\t}\n\t}\n\t\n\t\n\tMax[be[0]]=be[0];\n\tFOR2(be[0]-1,1,i) {\n\t\tMax[i]=Max[i+1];\n\t\tif(check_Max(i,Max[i])) Max[i]=i;\n\t}\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Max[pos+1];\n\t\tif(f[pos]>N) {\n\t\t\tFOR2(f[pos]/N,1,i) putchar('b');\n\t\t\tfor1(f[pos]%N,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 3005;\n\nint A[N], B[N], n, tA, tB, l[N], r[N], tot;\n\nstring s, dp[N];\n\nvoid solve(int x) {\n  if(A[l[x]] < B[l[x]]) {\n    int L = 0;\n    for(int i = l[x]; i <= r[x]; ++ i) {\n      if(A[i] > L) {\n        dp[x] += \"ab\";\n        L = B[i];\n      }\n    }\n  }\n  else {\n    dp[x] = \"\";\n    vector < pair < int, char> > it;\n    for(int i = r[x]; i >= l[x]; -- i) {\n      string now = \"\";\n      it.clear();\n      for(int j = i; j <= r[x]; ++ j)\n        it.push_back(make_pair(B[j], 'b')),\n          it.push_back(make_pair(A[j], 'a'));\n      sort(it.begin(), it.end());\n      for(int j = 0; j < (int) it.size(); ++ j)\n        now += it[j].second;\n      dp[x] = max(dp[x], now);\n    }\n  }\n}\n\nmain() {\n  cin >> n;\n  cin >> s;\n  int L = 1;\n  for(int i = 0; i < n * 2; ++ i) {\n    if(s[i] == 'a') A[++ tA] = i + 1;\n    else B[++ tB] = i + 1;\n    if(tA == tB) {\n      l[++ tot] = L, r[tot] = tA;\n      L = tA + 1;\n    }\n  }\n  for(int i = 1; i <= tot; ++ i) solve(i);\n\n  for(int i = tot - 1; i >= 1; -- i) {\n    dp[i] = max(dp[i] + dp[i + 1], dp[i + 1]);\n  }\n  cout << dp[1] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring resultant=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresultant+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=occurence[A])\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tresultant=max(resultant,current);\n\t\t}\n\t}\n\treturn resultant;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb  push_back\n#define mp  make_pair\n#define int long long\n#define itr ::iterator \n\ntypedef pair<int,int>  pii;\n\nconst int MAX=1e5;\n\nvector<pii> vec;\nvector<string> ans;\n\nstring X,res[MAX];\n\nint N,pre,cur,occurence[MAX],cnt[2];\n\nstring max(string X,string Y)\n{\n\tfor(int A=0;A<min(X.size(),Y.size());A++)\n\t{\n\t\tif(X[A]>Y[A])\n\t\t\treturn X;\n\t\telse if(X[A]<Y[A])\n\t\t\treturn Y;\n\t}\n\treturn X.size()>Y.size()?X:Y;\n}\n\nstring solve(int L,int R)\n{\n\tstring res=\"\";\n\tif(X[L]=='a')\n\t{\n\t\tint cur=L,pre=0;\n\t\twhile(cur<=R)\n\t\t{\n\t\t\tif(X[cur]=='b')\n\t\t\t{\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tres+=\"ab\";\n\t\t\tfor(int A=L;A<=R;A++)\n\t\t\t{\n\t\t\t\tif(X[A]=='b' and occurence[A]==occurence[cur])\n\t\t\t\t{\n\t\t\t\t\tcur=A+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tstring current;\n\t\tfor(int A=1;A<=N;A++)\n\t\t{\n\t\t\tcurrent=\"\";\n\t\t\tfor(int B=L;B<=R;B++)\n\t\t\t{\n\t\t\t\tif(occurence[B]>=A)\n\t\t\t\t\tcurrent+=X[B];\n\t\t\t}\n\t\t\tres=max(res,current);\n\t\t}\n\t}\n\treturn res;\n}\n\nsigned main()\n{\n\tios_base::sync_with_stdio(false);\n\n\tpre=-1;\n\tcin>>N;\n\tcin>>X;\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcur+=X[A]=='a'?1:-1;\n\t\tif(cur==0)\n\t\t{\n\t\t\tvec.pb(mp(pre+1,A));\n\t\t\tcur=0;\n\t\t\tpre=A;\n\t\t}\n\t}\t\n\tfor(int A=0;A<X.size();A++)\n\t{\n\t\tcnt[X[A]-'a']++;\n\t\toccurence[A]=cnt[X[A]-'a'];\n\t}\n\tfor(int A=0;A<vec.size();A++)\n\t\tres[A]=solve(vec[A].first,vec[A].second);\n\tstring maximum=\"\";\n\tfor(int A=vec.size()-1;A>=0;A--)\n\t{\n\t\tmaximum=max(maximum,res[A]);\n\t\tif(res[A]==maximum)\n\t\t\tans.pb(res[A]);\n\t}\n\treverse(ans.begin(),ans.end());\n\tfor(auto A:ans)\n\t\tcout<<A;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Created by Alphagocc\n#include<bits/stdc++.h>\n\n#define likely(x) __builtin_expect(!!(x), 1)\n#define unlikely(x) __builtin_expect(!!(x), 0)\n// namespace IO \nnamespace IO\n{\ntemplate <typename T>\nvoid __RI(T &x)\n{\n    int ch = getchar(), neg = 1;\n    x = 0;\n    for (; !(isdigit(ch) || ch == '-' || ch == EOF); ch = getchar())\n        ;\n    if (unlikely(ch == EOF)) return;\n    if (ch == '-') neg = -1;\n    for (; isdigit(ch); ch = getchar()) x = x * 10 + ch - 48;\n    x *= neg;\n}\nvoid R(int &x) { __RI(x); }\nvoid R(int64_t &x) { __RI(x); }\nvoid R(double &x) { scanf(\"%lf\", &x); }\nvoid R(char &x) { scanf(\"%c\", &x); }\nvoid R(char *x) { scanf(\"%s\", x); }\nvoid R(std::string &x) { std::cin >> x; }\ntemplate <typename T1, typename T2>\nvoid R(std::pair<T1, T2> &x)\n{\n    R(x.first);\n    R(x.second);\n}\ntemplate <typename T>\nvoid R(std::vector<T> &x)\n{\n    for (auto &i : x) { R(i); }\n}\ntemplate <typename T>\nvoid R(T &x)\n{\n    std::cin >> x;\n}\ntemplate <typename T, typename... Args>\nvoid R(T &x, Args &... args)\n{\n    R(x), R(args...);\n}\nchar space = ' ';\ntemplate <typename T>\nvoid __WI(T x)\n{\n    if (unlikely(x == 0)) putchar('0');\n    if (x < 0) putchar('-'), x = -x;\n    char ch[ 64 ];\n    int  pos = 0;\n    while (x) ch[ pos++ ] = x % 10 + 48, x /= 10;\n    while (pos) putchar(ch[ --pos ]);\n}\nvoid W() {}\nvoid W(const int &x) { __WI(x); }\nvoid W(const int64_t &x) { __WI(x); }\nvoid W(const double &x) { printf(\"%lf\",static_cast<double>(x)); }\nvoid W(const char &x) { putchar(x); }\nvoid W(const std::string &x) { printf(\"%s\", x.c_str()); }\ntemplate <typename T1, typename T2>\nvoid W(const std::pair<T1, T2> &x)\n{\n    W(x.first);\n    W(space);\n    W(x.second);\n}\ntemplate <typename T>\nvoid W(const std::vector<T> &x)\n{\n    for (auto it = x.cbegin();it != x.cend(); it++)\n    {\n        W(*it);\n        W(space);\n    }\n    W('\\n');\n}\ntemplate <typename T>\nvoid W(const T &x)\n{\n    std::cout << x;\n}\ntemplate <typename T, typename... Args>\nvoid W(const T &x,const Args &... args)\n{\n    W(x), W(space), W(args...);\n}\ntemplate <typename... Args>\nvoid WL(const Args &... args)\n{\n    W(args...), W('\\n');\n}\n}; // namespace IO\n\nusing namespace std;\n\n#define REP(i, x, y) for (int i = x;i < y; i++)\n\nconst int8_t  INFC = 0x3f;\nconst int16_t INFS = 0x3f3f;\nconst int32_t INF  = 0x3f3f3f3f;\nconst int64_t INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst int MAXN = 6.1e3;\n\nint    pos[ 6010 ], a[ 3010 ], b[ 3010 ];\nstring dp[ 6010 ];\n\nint main()\n{\n    int    n;\n    string s, ans;\n    IO::R(n, s);\n    s.insert(s.begin(),' ');\n    for (int i = 1; i <= n * 2; i++)\n        if (s[ i ] == 'a')\n            a[ ++a[ 0 ] ] = i, pos[ i ] = a[ 0 ];\n        else\n            b[ ++b[ 0 ] ] = i, pos[ i ] = b[ 0 ];\n    for (int i = n; i >= 1; i--)\n    {\n        if (a[ i ] < b[ i ])\n        {\n            int k = i;\n            for (int j = a[ i ] + 1; j < b[ i ]; j++) k = max(k, pos[ j ]);\n            dp[ i ] = \"ab\" + dp[ k + 1 ];\n        }\n        else\n        {\n            int k = i;\n            while (k < n && b[ k + 1 ] < a[ k ]) k++;\n            for (int j = b[ i ]; j <= n * 2; j++)\n                if (i <= pos[ j ] && pos[ j ] <= k) dp[ i ] += s[ j ];\n            dp[ i ] += dp[ k + 1 ];\n        }\n        dp[ i ] = max(dp[ i ], dp[ i + 1 ]);\n        ans     = max(ans, dp[ i ]);\n    }\n    IO::WL(ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int MAXN = 3010;\n\ntypedef std::bitset<MAXN> B;\nchar arr[MAXN << 1];\nint n, L[MAXN], R[MAXN], cr[MAXN << 1];\nvoid decode(B t, char * dst) {\n\tfor (int i = 1; i <= n * 2; ++i)\n\t\tif (t.test(cr[i]))\n\t\t\t*dst++ = arr[i];\n\t*dst = 0;\n}\nbool cmp(B src, B dst) {\n\tstatic char s1[MAXN << 1], s2[MAXN << 1];\n\tdecode(src, s1); decode(dst, s2);\n\treturn strcmp(s1, s2) < 0;\n}\nvoid getmax(B & a, B b) { cmp(a, b) ? (a = b, 0) : 0; }\nB dp[MAXN];\n\nint main() {\n\tstd::ios_base::sync_with_stdio(false), std::cin.tie(0);\n\tstd::cin >> n >> arr + 1;\n\tfor (int i = 1, ta = 0, tb = 0; i <= n * 2; ++i)\n\t\tarr[i] == 'a' ? L[++ta] = i : R[++tb] = i;\n\tfor (int i = 1; i <= n; ++i) cr[L[i]] = i;\n\tfor (int i = 1; i <= n; ++i) cr[R[i]] = i;\n\tfor (int i = n; i; --i) {\n\t\tstatic B t;\n\t\tdp[i] = dp[i + 1];\n\t\tif (L[i] < R[i]) {\n\t\t\tint r = *std::max_element(cr + L[i], cr + R[i] + 1);\n\t\t\t(t = dp[r + 1]).set(i);\n\t\t\tgetmax(dp[i], t);\n\t\t} else {\n\t\t\tt.reset();\n\t\t\tint rr = L[i];\n\t\t\tfor (int j = R[i]; j <= n * 2 && j <= rr; ++j) {\n\t\t\t\tif (arr[j] == 'b') {\n\t\t\t\t\tt.set(cr[j]);\n\t\t\t\t\trr = std::max(rr, L[cr[j]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint r = *std::max_element(cr + R[i], cr + rr + 1);\n\t\t\tgetmax(dp[i], t | dp[r + 1]);\n\t\t}\n\t}\n\tdecode(dp[1], arr);\n\tstd::cout << arr << std::endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <queue>\n#include <map>\n#include <string.h>\n#include <math.h>\n#include <stdio.h>\n#include <deque>\n#include <bits/stdc++.h>\n//#include \"D:\\C++\\test_lib_projects\\testlib.h\"\nusing namespace std;\n#define ll long long\n#define pii pair<int,int>\n#define qi ios::sync_with_stdio(0)\n\nbool debug=true;\n\n/*    *************************************\n\t  * Written in New Computer           *\n\t  * The following code belongs to     *\n\t  * XiaoGeNintendo of HellHoleStudios *\n\t  *************************************\n\t  \n\t  Solution Idea From MonkeyKing(chinauser)\n*/\ntemplate<typename T1,typename T2>ostream& operator<<(ostream& os,pair<T1,T2> ptt){\n\tos<<ptt.first<<\",\"<<ptt.second;\n\treturn os;\n}\ntemplate<typename T>ostream& operator<<(ostream& os,vector<T> vt){\n\tos<<\"{\";\n\tfor(int i=0;i<vt.size();i++){\n\t\tos<<vt[i]<<\" \";\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nint n;\nstring s;\n\nvector<string> parts;\n\nbool poss[7000];\nvoid solve(int l,int r){\n\tif(s[l]=='a'){\n\t\t\n\t\tstring ans;\n\t\t\n\t\tint a=0,b=0,c=0; \n\t\tfor(int i=l;i<=r;i++){\n\t\t\tif(s[i]=='a'){\n\t\t\t\ta++;\n\t\t\t}else{\n\t\t\t\tb++;\n\t\t\t}\n\t\t\tif(b>c){\n\t\t\t\tc=a;\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t\t}\n\t\t\n\t\tparts.push_back(ans);\n\t}else{\n\t\tvector<string> all;\n\t\tfor(int i=l;i<=r;i++){\n\t\t\tposs[i]=true;\n\t\t}\n\t\t\n\t\tfor(int i=0;i<(r-l+1)/2;i++){\n\t\t\tstring t=\"\";\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(poss[j]){\n\t\t\t\t\tt+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tall.push_back(t);\n\t\t\t\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(s[j]=='a' && poss[j]){\n\t\t\t\t\tposs[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(s[j]=='b' && poss[j]){\n\t\t\t\t\tposs[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tsort(all.begin(),all.end());\n\t\tparts.push_back(all.back());\n\t}\n}\nint main(int argc,char* argv[]){\n\tcin>>n>>s;\n\tn*=2;\n\t\n\tint delta=0,last=0;\n\t\n\tfor(int i=0;i<n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tdelta++;\n\t\t}else{\n\t\t\tdelta--;\n\t\t}\n\t\tif(delta==0){\n\t\t\tsolve(last,i);\n\t\t\tlast=i+1;\n\t\t}\n\t}\n\t\n\tstring ans=parts.back();\n\tfor(int i=parts.size()-2;i>=0;i--){\n\t\tbool ok=false;\n\t\tfor(int j=0;j<min(ans.size(),parts[i].size());j++){\n\t\t\tif(parts[i][j]!=ans[j]){\n\t\t\t\tif(parts[i][j]<ans[j]){\n\t\t\t\t\tok=true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(!ok){\n\t\t\tans=parts[i]+ans;\t\n\t\t}\n\t}\n\t\n\tcout<<ans;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define mod 998244353\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define repn(i,x) for(int i=1;i<=x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nint n;\nstring str;\nstring ans;\nvector<int>pos,a,b;\nint A,B;\nbool ok[3005];\nint main(){\n\tcin>>n;\n\tcin>>str;\n\tfor(int i=0;i<2*n;i++){\n\t\tif(str[i] == 'a') a.pb(i);\n\t\telse b.pb(i);\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tif(a[i]>b[i]){\n\t\t\tpos.pb(i);\n\t\t}\n\t\tok[i] = 1;\n\t}\n\tstring ans = \"\";\n\tfor(int i=0;i<=pos.size();i++){\n\t    if(i == pos.size() && !pos.empty()) break;\n\t\tvector<int>in;\n\t\tfor(int j=i;j<pos.size();j++){\n\t\t\tin.pb(a[pos[j]]);\n\t\t\tin.pb(b[pos[j]]);\n\t\t\tassert(a[pos[j]]>b[pos[j]]);\n\t\t}\n\t\tSORT(in);\n\t\tstring cur = \"\";\n\t\tfor(int ii=0;ii<in.size();ii++){\n\t\t\tcur.pb(str[in[ii]]);\n\t\t}\n\t\tint nxt = 0;\n\t\tif(in.size()) nxt = in[in.size()-1]+1;\n\t\twhile(nxt<2*n){\n\t\t\tint p = POSL(a,nxt);\n\t\t\tif(p == a.size()) break;\n\t\t\tassert(a[p]<b[p]);\n\t\t\tcur.pb('a'); cur.pb('b');\n\t\t\tnxt = b[p]+1;\n\t\t}\n\t\tif(ans<cur) ans = cur;\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <cmath>\n#include <iomanip>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <iterator>\n#include <ext/pb_ds/assoc_container.hpp>\n\n#define x first\n#define y second\n#define mp make_pair\n#define up_b upper_bound\n#define low_b lower_bound\n#define sz(x) (int)x.size()\n#define bit __builtin_popcount\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,int> pii;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\ntypedef tree<int,null_type,less<int>,rb_tree_tag,tree_order_statistics_node_update> indexed_set;\n\nconst ll INF=1e18+123;\nconst ld EPS=1e-9;\nconst int inf=1e9+123;\nconst int MOD=1e9+7;\nconst int N=1e5+123;\nconst int dx[]={0,0,1,-1};\nconst int dy[]={1,-1,0,0};\n\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0);\n    int n;\n    string s;\n    cin>>n;\n    cin>>s;\n    n+=n;\n    string ans=\"\",l=\"\",q=\"\";\n    int ca=0,cb=0;\n    for(int i=0;i<n;i++){\n        if(s[i]=='a'){\n            ca++;\n        }\n        else{\n            cb++;\n        }\n        q+=s[i];\n        if(ca==cb){\n            if(q[0]=='a'){\n                for(int j=0;j<sz(q);j++){\n                    if(q[j]=='a' && ca==cb){\n                        l+='a';\n                        ca++;\n                    }\n                    if(q[j]=='b' && ca!=cb){\n                        l+='b';\n                        cb++;\n                    }\n                }\n            }\n            else{\n                l.clear();\n                string mx=q;\n                for(;sz(q);){\n                    bool da=0,db=0;\n                    for(int j=0;j<sz(q) && (!da || !db);j++){\n                        if(q[j]=='a' && !da){\n                            da=1;\n                            q.erase(q.begin()+j);\n                            j--;\n                        }\n                        if(q[j]=='b' && !db){\n                            db=1;\n                            q.erase(q.begin()+j);\n                            j--;\n                        }\n                    }\n                    mx=max(q,mx);\n                }\n                ans+=mx;\n            }\n            ca=0;\n            cb=0;\n            q.clear();\n        }\n    }\n    ans+=l;\n    cout<<ans;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define maxn 10004\nusing namespace std;\nint pos[maxn], posa[maxn], posb[maxn];\nstring s, ans, f[maxn];\nint main(){\n\tint n;\n\tcin >> n;\n\tcin >> s;\n\tint cnta = 0, cntb = 0;\n\tfor (int i = 0; i < 2 * n; ++ i){\n\t\tif (s[i] == 'a'){\n\t\t\tpos[i] = ++ cnta;\n\t\t\tposa[cnta] = i;\n\t\t}\n\t\telse{\n\t\t\tpos[i] = ++ cntb;\n\t\t\tposb[cntb] = i;\n\t\t}\n\t}\n\tfor (int i = n; i; -- i){\n\t\tif (posa[i] < posb[i]){\n\t\t\tint k = i;\n\t\t\tfor (int j = posa[i] + 1; j < posb[i]; ++ j)\n\t\t\t\tk = max(k, pos[j]);\n\t\t\tf[i] = \"ab\" + f[k + 1];\n\t\t}\n\t\telse{\n\t\t\tint k = i;\n\t\t\twhile (k < n && posb[k + 1] < posa[k])\n\t\t\t\t++ k;\n\t\t\tfor (int j = posb[i]; j < 2 * n; ++ j)\n\t\t\t\tif (pos[j] >= i && pos[j] <= k)\n\t\t\t\t\tf[i] += s[j];\n\t\t\tf[i] += f[k + 1];\n\t\t}\n\t\tf[i] = max(f[i], f[i + 1]);\n\t\tans = max(ans, f[i]);\n\t}\n\tcout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst int N = 3005, M = 6005;\n\nint n, na, nb, a[N], b[N], wh[M];\nchar s[M];\nstd::string f[N];\n\nint main()\n{\n\tstd::cin >> n;\n\tscanf(\"%s\", s + 1);\n\tfor (int i = 1; i <= n * 2; i++)\n\t\tif (s[i] == 'a') a[wh[i] = ++na] = i; else b[wh[i] = ++nb] = i;\n\tfor (int i = n; i >= 1; i--)\n\t{\n\t\tif (a[i] < b[i])\n\t\t{\n\t\t\tint j = i;\n\t\t\twhile (j <= n && (a[j] <= b[i] || b[j] <= b[i])) j++;\n\t\t\tf[i].push_back('a'); f[i].push_back('b'); f[i] = f[i] + f[j];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint mx = a[i], k = n + 1;\n\t\t\tfor (int j = b[i]; j <= mx; j++)\n\t\t\t\tif (s[j] == 'b' && a[wh[j]] > mx) mx = a[wh[j]];\n\t\t\tfor (int j = 1; j <= n; j++) if (a[j] > mx && b[j] > mx && j < k)\n\t\t\t\tk = j;\n\t\t\tfor (int j = b[i]; j <= mx; j++) if (wh[j] >= i) f[i].push_back(s[j]);\n\t\t\tf[i] = f[i] + f[k];\n\t\t}\n\t\tif (f[i + 1] > f[i]) f[i] = f[i + 1];\n\t}\n\treturn std::cout << f[1] << std::endl, 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef int LL;\ntypedef double dl;\n#define opt operator\n#define pb push_back\nconst LL maxn=2e3+9,mod=998244353,inf=0x3f3f3f3f;\nLL Read(){\n\tLL x(0),f(1); char c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=(x<<3ll)+(x<<1ll)+c-'0'; c=getchar();\n\t}return x*f;\n}\nvoid Chkmin(LL &x,LL y){\n\tif(y<x) x=y;\n}\nvoid Chkmax(LL &x,LL y){\n\tif(y>x) x=y;\n}\nLL add(LL x,LL y){\n\treturn x+=y,x>=mod?x-mod:x;\n}\nLL dec(LL x,LL y){\n\treturn x-=y,x<0?x+mod:x;\n}\nLL mul(LL x,LL y){\n\treturn 1ll*x*y%mod;\n}\nLL Pow(LL base,LL b){\n\tLL ret(1); while(b){\n\t\tif(b&1) ret=mul(ret,base); base=mul(base,base); b>>=1;\n\t}return ret;\n}\nLL n;\nLL a[maxn],sum[2],pos[2][maxn],rk[maxn];\nchar s[maxn];\nstruct node{\n\tLL mark[maxn];\n\tnode(){\n\t\tmemset(mark,0,sizeof(mark));\n    }\n\tnode opt + (const node A)const{\n\t\tnode Tmp;\n\t\tfor(LL i=1;i<=2*n;++i) Tmp.mark[i]|=mark[i]|A.mark[i];\n\t\treturn Tmp;\n\t}\n\tbool opt < (const node A)const{\n\t\tstatic LL Tmp1[maxn],Tmp2[maxn];\n\t\tLL tot1(0),tot2(0);\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]) Tmp1[++tot1]=a[i];\n\t\tfor(LL i=1;i<=2*n;++i) if(A.mark[i]) Tmp2[++tot2]=a[i];\n\t\tTmp1[++tot1]=-1; Tmp2[++tot2]=-1;\n\t\tfor(LL i=1;i<=std::min(tot1,tot2);++i){\n\t\t\tif(Tmp1[i]==Tmp2[i]) continue;\n\t\t\treturn Tmp1[i]<Tmp2[i];\n\t\t}\n\t\treturn 1;\n\t}\n\tvoid Get(){\n\t\tfor(LL i=1;i<=2*n;++i) if(mark[i]){\n\t\t\tif(a[i]) printf(\"b\");\n\t\t\telse printf(\"a\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}f[maxn];\nnode Tmp;\nint main(){\n    n=Read();\n    scanf(\" %s\",s+1);\n    for(LL i=1;i<=2*n;++i) a[i]=(s[i]=='b');\n    for(LL i=1;i<=2*n;++i){\n    \tsum[a[i]]++;\n    \trk[i]=sum[a[i]];\n    \tpos[a[i]][sum[a[i]]]=i;\n\t}\n    for(LL i=2*n;i>=1;--i){\n    \tLL x(pos[a[i]^1][rk[i]]);\n    \tif(x<i){\n    \t\tf[i]=f[i+1]; continue;\n\t\t}\n    \t//printf(\"(%d,%d)\\n\",x,i);\n    \tTmp.mark[i]=1; Tmp.mark[x]=1;\n    \tif(!a[i]){\n    \t\tf[i]=Tmp+f[x+1];\n\t\t}else{\n\t\t\tf[i]=Tmp+f[i+1];\n\t\t}\n    \tTmp.mark[i]=0; Tmp.mark[x]=0;\n\t\tf[i]=std::max(f[i],f[i+1]);\n\t\t//f[i].Get();\n\t}\n\tf[1].Get();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint N;\nchar S[6005];\n\nint a[3005], b[3005];\nint ca, cb;\n\nvector<int> res[6005], cur;\n\nvoid maxim(vector<int>& a, vector<int> &b) {\n\tfor (int i = 0; i < min(a.size(), b.size()); ++i) {\n\t\tif (S[a[i]] < S[b[i]]) { a = b; return; }\n\t\tif (S[a[i]] > S[b[i]]) return;\n\t}\n\tif (a.size() < b.size()) a = b;\n}\n\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S);\n\n\tfor (int i = 0; i < 2*N; ++i) {\n\t\tif (S[i] == 'a') a[ca++] = i;\n\t\telse b[cb++] = i;\n\t}\n\n\tfor (int i = 2*N; i--; ) {\n\t\tmaxim(res[i], res[i+1]);\n\n\t\tcur = res[i];\n\t\tint mn = -1;\n\t\tfor (int j = 0; j < N; ++j) if (b[j] < i && a[j] >= i) {\n\t\t\tif (mn == -1) mn = b[j];\n\t\t\tcur.push_back(b[j]), cur.push_back(a[j]);\n\t\t}\n\t\tsort(cur.begin(), cur.end());\n\n\t\tif (~mn) maxim(res[mn], cur);\n\t}\n\n\tfor (int j = 0; j < N; ++j) if (a[j] < b[j]) {\n\t\tcur = res[0];\n\t\tcur.push_back(a[j]); cur.push_back(b[j]);\n\t\tsort(cur.begin(), cur.end());\n\t\tmaxim(res[0], cur);\n\t}\n\n\tfor (auto i : res[0]) printf(\"%c\", S[i]);\n\tprintf(\"\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int maxn=3e3+500;\nint n;\nchar s[maxn*4];\nint t[maxn<<2];\nint a[maxn],b[maxn];\nint A,B;\nstring Ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tcin >> (s+1);\n\t//n=3;\n\tfor (int i=1;i<=n*2;i++){\n\t\tif (s[i]=='a'){\n\t\t\tA++;\n\t\t\ta[A]=i;\n\t\t\tt[i]=A;\n\t\t}\n\t\telse{\n\t\t\tB++;\n\t\t\tb[B]=i;\n\t\t\tt[i]=B;\n\t\t}\n\t}\n\tfor (int i=1;i<=n*2;i++){\n\t\tstring S=\"\";\n\t\tint pos=i-1;\n\t\tint mi=min(a[t[i]],b[t[i]]);\n\t\tif (mi!=i) continue;\n\t\tif (a[t[i]]>b[t[i]]){\n\t\t\tfor (int j=i;j<=n*2;j++){\n\t\t\t\tif (a[t[j]]>b[t[j]]&&b[t[j]]>=i){\n\t\t\t\t\tS.push_back(s[j]);\n\t\t\t\t\tpos=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int j=pos+1;j<=n*2;j++){\n\t\t\tif (a[t[j]]<b[t[j]]&&s[j]=='a'){\n\t\t\t\tS+=\"ab\";\n\t\t\t\tj=b[t[j]];\n\t\t\t}\n\t\t}\n\t//\tcout << i << ' ' << S << '\\n';\n\t\tAns=max(Ans,S);\n\t}\n\tcout << Ans << '\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <algorithm>\n#include <string>\nusing namespace std;\n\nint N; char S[6060];\nint A[3030], B[3030], C[6060];\n\nint main()\n{\n\tscanf(\"%d %s\", &N, S);\n\tA[0] = B[0] = -1;\n\tfor (int i=0, a=0, b=0;i<N*2;i++){\n\t\tif (S[i] == 'a') A[++a] = i;\n\t\tif (S[i] == 'b') B[++b] = i;\n\t}\n\n\tstring ans = \"\", best = \"\";\n\tint l = N*2+1, lm = N*2+1; bool see = false;\n\tfor (int i=N;i>=0;i--){\n\t\tif (A[i] >= B[i]){\n\t\t\tif (A[i] < l) best = ans, lm = l;\n\n\t\t\tif (i){\n\t\t\t\tC[A[i]] = C[B[i]] = 1;\n\t\t\t\tstring now = \"\";\n\t\t\t\tfor (int j=B[i];j<lm;j++) if (C[j]) now += S[j];\n\n\t\t\t\tstring mk = now + best;\n\t\t\t\tif (ans < mk)\n\t\t\t\t\tans = move(mk);\n\t\t\t}\n\n\t\t\tl = B[i];\n\t\t\tsee = true;\n\t\t}\n\t\telse if (!see){\n\t\t\tif (B[i] < l){\n\t\t\t\tans += \"ab\";\n\t\t\t\tbest += \"ab\";\n\t\t\t\tl = A[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tputs(ans.c_str());\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (valid[i]) {\n\t\t\t\tint to = i + 1;\n\t\t\t\twhile (to < 2 * n && !valid[to])to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[vb[loc[i]]] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn;\n\t\tint to = le + 1;\n\t\twhile (to < 2 * n && !valid[to])to++;\n\t\tdfs(to);\n\t\tans[le] = ans[to];\n\t\tans[le][le] = 1;\n\t\tif (s[le] == 'a') {\n\t\t\tint id = loc[le];\n\t\t\tans[le][vb[id]] = 1;\n\t\t}\n\t\telse {\n\t\t\tint id = loc[le];\n\t\t\tans[le][va[id]] = 1;\n\t\t}\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size() == len) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && !valid[to])to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i]|ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tz[i].push_back(i);\n\t\t\t\tbz[i][i] = 1;\n\t\t\t\tbz[i][va[loc[i]]] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tint iid = loc[j];\n\t\t\t\t\t\tif (va[iid] > j) {\n\t\t\t\t\t\t\tz[i].push_back(j);\n\t\t\t\t\t\t\tbz[i][j] = 1;\n\t\t\t\t\t\t\tbz[i][va[loc[j]]] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(0);\n\tcout << trans(ans[0]) << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \n// Shortcut\n \n#define int long long\n#define endl '\\n'\n#define eb emplace_back\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define upb upper_bound\n#define lwb lower_bound\n#define fi first\n#define se second\n#define For(i, l, r) for (int i = l; i < r; i++)\n#define ForE(i, l, r) for (int i = l; i <= r; i++)\n#define Ford(i, r, l) for (int i = r; i > l; i--)\n#define FordE(i, r, l) for (int i = r; i >= l; i--)\n#define Fora(i, a) for (auto i : a)\n \n// I/O & Debug\n \n#define PrintV(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << ' ';\n#define PrintVl(a) for (int iiii = 0; iiii < a.size(); iiii++) cout << a[iiii] << endl;\n#define PrintA(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << ' ';\n#define PrintAl(a, n) for (int iiii = 0; iiii < n; iiii++) cout << a[iiii] << endl;\n#define Ptest(x) return cout << x, 0;\n#define gl(s) getline(cin, s);\n#define setpre(x) fixed << setprecision(x)\n/*\n#define debug(args...){ string _sDEB = #args; replace(_sDEB.begin(), _sDEB.end(), ',', ' '); stringstream _ssDEB(_sDEB); istream_iterator<string> _itDEB(_ssDEB); DEB(_itDEB, args); }\nvoid DEB(istream_iterator<string> it) {}\ntemplate<typename T, typename... Args>\nvoid DEB(istream_iterator<string> it, T a, Args... args){\n    cout << *it << \" = \" << a << endl;\n    DEB(++it, args...);\n}\n*/\n \n// Functions\n \n//#define isvowel(a) (a == 'a' || a == 'e' || a == 'i' || a == 'o' || a == 'u')\n#define bend(a) a.begin(), a.end()\n#define rbend(a) a.rbegin(), a.rend()\n#define mset(a) memset(a, 0, sizeof(a));\n//mt19937 rando(chrono::steady_clock::now().time_since_epoch().count());\n \n// Data Structure\n \n#define pque priority_queue\n#define mts multiset\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector <int> vi;\ntypedef vector <ll> vll;\ntypedef vector <ld> vld;\ntypedef vector <string> vs;\ntypedef pair <int, int> pii;\ntypedef pair <ll, ll> pll;\ntypedef vector <vi > vvi;\ntypedef vector <vll > vvll;\ntypedef vector <pii > vpii;\ntypedef vector <pll > vpll;\n \nconst int N = 3e3 + 5, mod = 1e9 + 7, inf = 1e9 + 7;\n \nint n;\nint a[N];\nstring s, ans = \"\";\nvs b, c;\n \nsigned main(){\n    ios_base::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    cin >> n >> s;\n    int tmp = 0, x = 0, y = 0;\n    For(i, 0, s.size()){\n        if (s[i] == 'a'){\n            a[i] = ++x;\n        }\n        else{\n            a[i] = ++y;\n        }\n        if (x == y){\n            string t = \"\";\n            if (s[tmp] == 'a'){\n                int z = 0;\n                ForE(j, tmp, i){\n                    if (z == a[j]){\n                        z = 0;\n                    }\n                    if (!z && s[j] == 'a'){\n                        t += \"ab\";\n                        z = a[j];\n                    }\n                }\n            }\n            else{\n                ForE(j, a[tmp], a[i]){\n                    string u = \"\";\n                    ForE(k, tmp, i){\n                        if (a[k] >= j){\n                            u += s[k];\n                        }\n                    }\n                    t = max(t, u);\n                }\n            }\n            b.pb(t);\n            tmp = i + 1;\n        }\n    }\n    c.assign(b.size(), \"\");\n    For(i, 0, b.size()){\n        c[i] = b[i];\n        For(j, 0, i){\n            c[i] = max(c[i], c[j] + b[i]);\n        }\n        ans = max(ans, c[i]);\n    }\n    cout << ans;\n}\n \n/*\n==================================+\nINPUT:                            |\n------------------------------    |\n \n------------------------------    |\n==================================+\nOUTPUT:                           |\n------------------------------    |\n \n------------------------------    |\n==================================+\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cmath>\n#include<algorithm>\n#include<stack>\n#include<queue>\n#include<map>\n#include<set>\n#include<iomanip>\n#define _USE_MATH_DEFINES\n#include <math.h>\n#include <functional>\n#include<complex>\nusing namespace std;\n\n#define rep(i,x) for(ll i=0;i<x;i++)\n#define repn(i,x) for(ll i=1;i<=x;i++)\n\ntypedef long long ll;\nconst ll INF = 1e17;\nconst ll MOD = 1000000007;\nconst ll MAX = 4000001;\nconst long double eps = 1E-14;\n\nll max(ll a, ll b) {\n\tif (a > b) { return a; }\n\treturn b;\n}\n\nll min(ll a, ll b) {\n\tif (a > b) { return b; }\n\treturn a;\n}\n\nll gcd(ll a, ll b) {\n\tif (b == 0) { return a; }\n\tif (a < b) { return gcd(b, a); }\n\treturn gcd(b, a % b);\n}\n\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b) * b;\n}\n\nstruct edge {\n\tll ind;\n\tll fr;\n\tll to;\n\tll d;\n};\n\nclass mint {\n\tlong long x;\npublic:\n\tmint(long long x = 0) : x((x% MOD + MOD) % MOD) {}\n\tmint operator-() const {\n\t\treturn mint(-x);\n\t}\n\tmint& operator+=(const mint& a) {\n\t\tif ((x += a.x) >= MOD) x -= MOD;\n\t\treturn *this;\n\t}\n\tmint& operator-=(const mint& a) {\n\t\tif ((x += MOD - a.x) >= MOD) x -= MOD;\n\t\treturn *this;\n\t}\n\tmint& operator*=(const  mint& a) {\n\t\t(x *= a.x) %= MOD;\n\t\treturn *this;\n\t}\n\tmint operator+(const mint& a) const {\n\t\tmint res(*this);\n\t\treturn res += a;\n\t}\n\tmint operator-(const mint& a) const {\n\t\tmint res(*this);\n\t\treturn res -= a;\n\t}\n\tmint operator*(const mint& a) const {\n\t\tmint res(*this);\n\t\treturn res *= a;\n\t}\n\n\tmint pow(ll t) const {\n\t\tif (!t) return 1;\n\t\tmint a = pow(t >> 1);\n\t\ta *= a;\n\t\tif (t & 1) a *= *this;\n\t\treturn a;\n\t}\n\n\t// for prime MOD\n\tmint inv() const {\n\t\treturn pow(MOD - 2);\n\t}\n\tmint& operator/=(const mint& a) {\n\t\treturn (*this) *= a.inv();\n\t}\n\tmint operator/(const mint& a) const {\n\t\tmint res(*this);\n\t\treturn res /= a;\n\t}\n\n\tfriend ostream& operator<<(ostream& os, const mint& m) {\n\t\tos << m.x;\n\t\treturn os;\n\t}\n};\n\nmint pw(mint a, ll b) {\n\tif (b == 0) { return 1; }\n\tmint ret = pw(a, b >> 1);\n\tret *= ret;\n\tif (b & 1) { ret *= a; }\n\treturn ret;\n}\n\ntypedef vector<ll> vll;\ntypedef vector<vector<ll>> vvll;\ntypedef vector<vector<vector<ll>>> vvvll;\n\ntypedef vector<mint> vmint;\ntypedef vector<vector<mint>> vvmint;\ntypedef vector<vector<vector<mint>>> vvvmint;\n\n//////////////////////////////////////\n\nstring asen(string s) {\n\tll acnt = 0;\n\tll bcnt = 0;\n\n\tstring ret;\n\n\tll ad = -1;\n\n\trep(i, s.size()) {\n\t\tif (s[i] == 'a') {\n\t\t\tif (ad == -1) { ret += 'a'; ad = acnt; }\n\t\t\tacnt++;\n\t\t}\n\t\tif (s[i] == 'b') {\n\t\t\tif (ad == bcnt) { ret += 'b'; ad = -1; }\n\t\t\tbcnt++;\n\t\t}\n\t}\n\n\treturn ret;\n}\n\nstring bsen(string s) {\n\tstring ret;\n\n\trep(i, s.size()) {\n\t\tif (s[i] == 'a') { continue; }\n\n\t\tll acnt = 0;\n\t\tll bcnt = 0;\n\n\t\trep(j, i) {\n\t\t\tif (s[j] == 'a') { acnt++; }\n\t\t\telse { bcnt++; }\n\t\t}\n\n\t\tstring now;\n\t\tfor (ll j = i; j < s.size(); j++) {\n\t\t\tif (s[j] == 'b') { now += 'b'; }\n\t\t\telse {\n\t\t\t\tif (acnt == bcnt) { now += 'a'; }\n\t\t\t\telse { acnt++; }\n\t\t\t}\n\t\t}\n\n\t\tret = max(ret, now);\n\t}\n\n\treturn ret;\n}\n\n\nint main() {\n\tll N;\n\tstring s;\n\tcin >> N >> s;\n\n\tll acnt = 0;\n\tll bcnt = 0;\n\tvll ab(1, 0);\n\trep(i, 2 * N) {\n\t\tif (s[i] == 'a') { acnt++; }\n\t\telse { bcnt++; }\n\t\tif (acnt == bcnt) { ab.push_back(i+1); }\n\t}\n\tll M = ab.size() - 1;\n\n\tvector<string> lis;\n\trep(i,M){\n\t\tstring t = s.substr(ab[i], ab[i + 1] - ab[i]);\n\t\tif (t[0] == 'a') { lis.push_back(asen(t)); }\n\t\telse { lis.push_back(bsen(t)); }\n\t}\n\n\tstring ans;\n\n\trep(i, M) {\n\t\tbool b = 1;\n\n\t\tif (lis[i][0] == 'a') {\n\t\t\tfor (ll j = i + 1; j < M; j++) { if (lis[j][0] == 'b') { b = 0; } }\n\t\t}\n\t\telse {\n\t\t\tfor (ll j = i + 1; j < M; j++) { if (lis[j]>lis[i]) { b = 0; } }\n\t\t}\n\n\t\tif (b) { ans += lis[i]; }\n\t}\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "// new day,new strength,new thougts\n#include<bits/stdc++.h>\n#define MP make_pair\n#define PB push_back\n#define PF push_front\n#define POB pop_back\n#define POF pop_front\n#define F first\n#define S second\n#define sz(c) int((c).size())\n#define REP(i,n)  for(int i=0;i<int(n);i++)\n#define REPD(i,n) for(int i=int(n)-1;i>=0;i--)\n#define FOR(i,a,b) for(int i=int(a);i<=int(b);i++)\n#define FORD(i,a,b) for(int i=int(a);i>=int(b);i--)\n#define all(s) (s).begin(),(s).end()\n#define bit(num,i) ((num>>i)&1)\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\n\nconst ll inf=4e18;\nconst ll maxn=3010;\nconst ll mod=1e9+7;\n\nvector<string>vec;\nvector<ll>inds[2];\nll who[maxn];\n\nstring solve(string str){\n    memset(who,0,sizeof who);\n    inds[0].clear();\n    inds[1].clear();\n    string ans=\"\",sss=\"\";\n    if(str[0]=='b'){\n\tll c=0;\n\tREP(i,sz(str)){\n\t    if(str[i]=='a')\n\t\twho[i]=(c++);\n\t}\n\tll numb=0;\n\tREP(i,sz(str)){\n\t    sss=\"\";\n\t    if(str[i]=='a')continue;\n\t    FOR(j,i,sz(str)-1){\n\t\tif(str[j]=='b')\n\t\t    sss+=\"b\";\n\t\telse if(who[j]>=numb)\n\t\t    sss+=\"a\";\n\t\t    \n\t    }\n\t    numb++;\n\t    ans=max(ans,sss);\n\t}\n    }\n    else{\n\tll num=0,lst=-1;\n\tREP(i,sz(str)){\n\t    if(str[i]=='a')\n\t\tinds[0].PB(i);\n\t    else\n\t\tinds[1].PB(i);\n\t    if(str[i]=='b' && lst<inds[0][sz(inds[1])-1])\n\t\tnum++,lst=i;\n\t}\n\tREP(i,num){\n\t    ans+=\"ab\";\n\t}\n    }\n    return ans;\n}\n\nint main(){\n    ll n,sm=0,lst=-1;cin>>n;\n    string s;cin>>s;\n    REP(i,(2*n)){\n\tsm+=(s[i]=='a'?1:-1);\n\tif(sm==0){\n\t    string str=solve(s.substr(lst+1,i-lst));\n\t    lst=i;\n\t    while(sz(vec) && str>vec.back())\n\t\tvec.POB();\n\t    vec.PB(str);\n\t}\n    }\n    REP(i,sz(vec)){\n\tcout<<vec[i];\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <map>\n#include <list>\n#include <iterator>\n#include <set>\n#include <queue>\n#include <iostream>\n#include <sstream>\n#include <stack>\n#include <deque>\n#include <cmath>\n#include <memory.h>\n#include <cstdlib>\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#include <utility>\n#include <time.h>\n#include <bitset>\n#include <assert.h>\n#include <complex.h>\nusing namespace std;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i=(a)-1;i>=(b);--i)\n#define FILL(A,val) memset(A,val,sizeof(A))\n\n#define ALL(V) V.begin(),V.end()\n#define SZ(V) (int)V.size()\n#define PB push_back\n#define MP make_pair\n\ntypedef long long Int;\ntypedef unsigned long long UInt;\ntypedef vector<int> VI;\ntypedef pair<int, int> PII;\n\nconst double Pi = acos(-1.0);\nconst int INF = 1000000000;\nconst Int INF2 = Int(INF) * 5000;\nconst Int INF3 = Int(INF) * INF;\nconst int MAX = 100007;\nconst int MAXE = 2007000;\nconst int MAXV = 5000;\nconst int BASE = 1000000000;\nconst int ST = 1000000007;\n\nconst int MOD = 1000000007;\n\nstring solve(string s)\n{\n\n    if (s[0] == 'a')\n    {\n        string res = \"\";\n\n        bool st = 0;\n\n        FOR(i,0,SZ(s))\n        {\n            if (st == (s[i] == 'b'))\n            {\n                res += s[i];\n                st ^= 1;\n            }\n        }\n        return res;\n    }\n\n    string res = \"\";\n\n    int n = SZ(s) / 2;\n\n    FOR(j,0,n)\n    {\n        int cntA = 0;\n        int cntB = 0;\n        string r = \"\";\n        FOR(i,0,SZ(s))\n        {\n            if (s[i] == 'a')\n            {\n                ++ cntA;\n                if (cntA > j) r += 'a';\n            }\n            if (s[i] == 'b')\n            {\n                ++ cntB;\n                if (cntB > j) r += 'b';\n            }\n        }\n        res = max(res , r);\n    }\n\n    return res;\n}\n\nint main()\n{\n//    freopen(\"in.txt\", \"r\", stdin);\n//    freopen(\"out.txt\" , \"w\", stdout);\n\n    int n;\n    cin >> n;\n    string s;\n    cin >> s;\n\n    int L = 0;\n\n    vector<string> A;\n\n    int bal = 0;\n\n    FOR(i,0,SZ(s))\n    {\n        if (s[i] == 'a')\n        {\n            bal ++;\n        } else\n        {\n            bal --;\n        }\n        if (bal == 0) {\n            A.push_back(solve(s.substr(L, i - L + 1)));\n            L = i + 1;\n        }\n    }\n\n    string res = \"\";\n    RFOR(i,SZ(A) , 0)\n    {\n        if (A[i] + res > res)\n            res = A[i] + res;\n    }\n\n    cout << res << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nvector<int> a,b;\nvector<string> ans;\nint n;\nint main(){\n\tcin>>n;scanf(\"\\n\");\n\tfor (int i=1;i<=2*n;i++){\n\t\tchar e=getchar();\n\t\tif (e=='a')a.push_back(i);\n\t\telse b.push_back(i);\n\t\tif (a.size()==b.size()){\n\t\t\tstring s=\"\",t;\n\t\t\tif (a[0]<b[0]){\n\t\t\t\tint las=-1;\n\t\t\t\tfor (int i=0;i<a.size();i++)\n\t\t\t\t\tif (las<a[i]){\n\t\t\t\t\t\ts=s+\"ab\";\n\t\t\t\t\t\tlas=b[i];\n\t\t\t\t\t}\n\t\t\t\tans.push_back(s);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ts.append(2*a.size(),'a');\n\t\t\t\tfor (int i=0;i<b.size();i++)s[b[i]-b[0]]='b';\n\t\t\t\tt=s;\n\t\t\t\tfor (int i=0;i<b.size()-1;i++){\n\t\t\t\t\tfor (int j=0;;j++){\n\t\t\t\t\t\tif (s[j]=='a'){\n\t\t\t\t\t\t\ts.erase(j,1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts.erase(0,1);\n\t\t\t\t\tt=max(t,s);\n//\t\t\t\t\tcout<<s<<endl;\n\t\t\t\t}\n\t\t\t\tans.push_back(t);\n\t\t\t}\n\t\t\ta.clear();\n\t\t\tb.clear();\n\t\t}\n\t}\n\tstring Ans=\"\";\n\tfor (;ans.size();ans.pop_back())Ans=max(Ans,ans.back()+Ans);\n\tcout<<Ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define PB push_back\n#define MP make_pair\n#define F first\n#define S second\n#define SZ(x) ((int)(x).size())\n#define ALL(x) (x).begin(),(x).end()\n#ifdef _DEBUG_\n  #define debug(...) printf(__VA_ARGS__)\n#else\n  #define debug(...) (void)0\n#endif\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\n\n#define rank jaskdlfjasldfjlkasdjflksa\n\nconst int MAXN = 3000 + 100;\nint N;\nstring S;\nint a[MAXN], b[MAXN];\nstring bst[MAXN];\nint nxt[MAXN];\nint rank[MAXN];\n\nvoid go(int id) {\n  if (id == N)\n    return;\n  int ch = id;\n  for (int i = id + 1; i < N; i++)\n    if (rank[i] < rank[ch])\n      ch = i;\n  cout << bst[ch];\n  go(nxt[ch]);\n}\n\nint main() {\n  cin >> N;\n  cin >> S;\n  int cnta = 0, cntb = 0;\n  for (int i = 0; i < SZ(S); i++) {\n    if (S[i] == 'a')\n      a[cnta++] = i;\n    else if (S[i] == 'b')\n      b[cntb++] = i;\n    else\n      assert(false);\n  }\n  assert(cnta == N);\n  assert(cntb == N);\n  for (int i = 0; i < N; i++) {\n    int cover;\n    if (a[i] < b[i])\n      bst[i] = \"ab\", cover = b[i];\n    else {\n      cover = a[i];\n      VI tmp;\n      tmp.PB(a[i]);\n      tmp.PB(b[i]);\n      for (int j = i + 1; j < N; j++) {\n        if (a[j] < b[j])\n          continue;\n        if (b[j] < cover) {\n          cover = a[j];\n          tmp.PB(a[j]);\n          tmp.PB(b[j]);\n        }\n        else {\n          break;\n        }\n      }\n      sort(ALL(tmp));\n      for (int id : tmp)\n        bst[i] += S[id];\n    }\n    int next = i + 1;\n    while (next < N && min(a[next], b[next]) < cover)\n      next++;\n    nxt[i] = next;\n    debug(\"bst[%d] = %s\\n\", i, bst[i].c_str());\n  }\n  vector<pair<string, int>> vec;\n  for (int i = 0; i < N; i++)\n    vec.PB(MP(bst[i], -i));\n  sort(ALL(vec));\n  reverse(ALL(vec));\n  for (int i = 0; i < N; i++)\n    rank[-vec[i].S] = i;\n  go(0);\n  puts(\"\");\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <cassert>\n#include <bitset>\nusing namespace std;\n\ntypedef pair<int, int> P;\n#define rep(i, n) for (int i=0; i<(n); i++)\n#define all(c) (c).begin(), (c).end()\n#define uniq(c) c.erase(unique(all(c)), (c).end())\n#define index(xs, x) (int)(lower_bound(all(xs), x) - xs.begin())\n#define _1 first\n#define _2 second\n#define pb push_back\n#define INF 1145141919\n#define MOD 1000000007\n\nint count_ab(string s) {\n  //cout<<\"count_ab(\"<<s<<\")\\n\";\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n\n  int ctr = 0, lp = -1;\n  rep(i, pos_a.size()) if (lp < pos_a[i]) {\n    ctr++;\n    lp = pos_b[i];\n  }\n  return ctr;\n}\n\nstring solve_ba(string s) {\n  vector<int> pos_a, pos_b;\n  rep(i, s.length()) if (s[i] == 'a') pos_a.pb(i);\n  rep(i, s.length()) if (s[i] == 'b') pos_b.pb(i);\n  int num = pos_a.size();\n  string m = \"\";\n  rep(offset, num) {\n    int a = offset, b = offset;\n    string o = \"\";\n    while (a < num || b < num) {\n      if (a < num && (b == num || pos_a[a] < pos_b[b])) a++, o += 'a';\n      else b++, o += 'b';\n    }\n    m = max(m, o);\n  }\n  //cout<<\"solve_ba(\"<<s<<\") = \"<<m<<\"\\n\";\n  return m;\n}\n\nint N;\nstring S;\nsigned main() {\n  ios::sync_with_stdio(false); cin.tie(0);\n  cin >> N >> S;\n  vector<string> block_list;\n\n  int a = 0, b = 0;\n  string buf = \"\";\n  rep(i, 2*N) {\n    buf += S[i];\n    if (S[i] == 'a') a++;\n    else b++;\n    if (a == b) {\n      a = b = 0;\n      block_list.pb(buf);\n      buf = \"\";\n    }\n  }\n  assert(buf.empty());\n\n  vector<string> list2;\n  rep(i, block_list.size()) {\n    string s = block_list[i];\n    if (s[0] == 'b') {\n      list2.pb(solve_ba(s));\n    }\n  }\n  string out = \"\";\n  for (int i=list2.size()-1; i>=0; i--) out = max(out, out+list2[i]);\n\n  int add = 0;\n  while (!block_list.empty() && block_list.back()[0] == 'a') {\n    add += count_ab(block_list.back());\n    block_list.pop_back();\n  }\n  rep(_, add) out += \"ab\";\n  cout << out << \"\\n\";\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <iostream>\n\nusing namespace std;\n\nconst int N = 3'009;\n\nchar s[2 * N];\nint w[2 * N];\nint pa[N];\nint pb[N];\nstring f[2 * N];\n\nint main() {\n  int n;\n  scanf(\"%d %s\", &n, s);\n  for (int i = 0, cnta = 0; i < 2 * n; ++i) {\n    if (s[i] == 'a') {\n      w[i] = cnta;\n      pa[cnta] = i;\n      ++cnta;\n    } else {\n      w[i] = i - cnta;\n      pb[i - cnta] = i;\n    }\n  }\n  f[2 * n] = \"\";\n  for (int i = 2 * n - 1; i >= 0; --i) {\n    f[i] = f[i + 1];\n    if (s[i] == 'a') {\n      if (pb[w[i]] > i) {\n        f[i] = max(f[i], \"ab\" + f[pb[w[i]] + 1]);\n      }\n    } else {\n      if (pa[w[i]] > i) {\n        string cur = \"b\";\n        int l = w[i], r = w[i];\n        int j = i + 1;\n        while (l <= r) {\n          if (s[j] == 'a') {\n            if (w[j] == l) {\n              cur += \"a\";\n              ++l;\n            }\n          } else {\n            cur += \"b\";\n            ++r;\n          }\n          ++j;\n        }\n        f[i] = max(f[i], cur + f[j]);\n      }\n    }\n  }\n  puts(f[0].c_str());\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[6600];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[i], tmpbs[i]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        tmpas.push_back(as[i]);\n        tmpbs.push_back(bs[i]);\n        if(max(as[i], bs[i]) == i * 2 + 1){\n            string tmp = calc(tmpas, tmpbs);\n            int pos = 0;\n            if(tmp[0] == 'a')pos = strs.size();\n            while(pos < strs.size() && strs[pos] >= tmp)pos++;\n            if(pos == strs.size())strs.push_back(tmp);\n            else{\n                strs[pos] = tmp;\n                while(strs.size() > pos+1)strs.pop_back();\n            }\n            tmpas.clear();tmpbs.clear();\n        }\n    }\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\nint N,sum[6010],pos[6010],nxt[6010];\nchar S[6010],lt[6010][6010];\nbool cmp(int i,int j){\n\tif(sum[i]!=sum[j])return sum[i]>sum[j];\n\tif(lt[i][j])return lt[i][j]==1;\n\treturn i<j;\n}\nint main(){\n\tscanf(\"%d%s\",&N,S);\n\tfor(int i=0;i<N*2;i++)sum[i+1]=sum[i]+(S[i]=='b'?1:-1),pos[i]=i;\n\tnxt[N*2]=N*2;\n\tfor(int i=N*2;i--;)nxt[i]=sum[i+1]?nxt[i+1]:i+1;\n\tfor(int i=N*2;i>=0;i--){\n\t\tfor(int j=N*2;j>=0;j--){ \n\t\t\tif(i==j)lt[i][j]=0;\n\t\t\telse if(S[i]!=S[j])lt[i][j]=(S[i]<S[j]?-1:1);\n\t\t\telse if(sum[i+1]>0&&sum[j+1]>0)lt[i][j]=lt[i+1][j+1];\n\t\t\telse lt[i][j]=sum[i+1]>0?1:sum[j+1]>0?-1:0;\n\t\t}\n\t}\n\tstd::sort(pos,pos+N*2,cmp);\n\tint r=0;\n\tfor(;;){\n\t\tint i=0;\n\t\twhile(i<N*2&&sum[pos[i]]>0&&pos[i]<r)i++;\n\t\tif(i==N*2||sum[pos[i]]<=0){\n\t\t\tfor(int pa=r,pb=r;pb<N*2;pb++)if(S[pb]=='b'){\n\t\t\t\tif(pa>=r)printf(\"ab\"),r=pb;\n\t\t\t\tfor(pa++;pa<N*2&&S[pa]=='b';pa++);\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t\treturn 0;\n\t\t}\n\t\tfor(int j=sum[pos[i]];j--;)putchar('b');\n\t\tfor(int j=pos[i];j<pos[i]+nxt[pos[i]];j++)putchar(S[j]);\n\t\tr=pos[i]+nxt[pos[i]];\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\n#define N 6005\nint n,l1,l2,v[N][2],ct[N],dp2[N];\nchar s[N],dp[N][N];\nbool check(int i,int j){for(int k=1;k<=n*2;k++)if(dp[i][k]<dp[j][k])return 1;else if(dp[i][k]>dp[j][k])return 0;return 0;}\nint main()\n{\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1;i<=n*2;i++)\n\tif(s[i]=='a')v[++l1][0]=i;\n\telse v[++l2][1]=i;\n\tfor(int i=n;i>=1;i--)\n\tif(v[i][0]<v[i][1])\n\t{\n\t\tct[i]=ct[i+1];\n\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t}\n\telse\n\t{\n\t\tint rb=i;\n\t\twhile(rb<n&&v[rb][0]>v[rb+1][1])rb++;\n\t\tint l1=i,l2=i;\n\t\tfor(ct[i]=1;ct[i]<=(rb-i+1)*2;ct[i]++)\n\t\tif(l1==rb+1)dp[i][ct[i]]='b',++l2;\n\t\telse if(l2==rb+1)dp[i][ct[i]]='a',++l1;\n\t\telse if(v[l1][0]<v[l2][1])dp[i][ct[i]]='a',++l1;\n\t\telse dp[i][ct[i]]='b',++l2;\n\t\tct[i]--;\n\t\tfor(int j=1;j<=ct[rb+1];j++)dp[i][j+ct[i]]=dp[rb+1][j];\n\t\tct[i]+=ct[rb+1];\n\t\tif(check(i,i+1))\n\t\t{\n\t\t\tct[i]=ct[i+1];\n\t\t\tfor(int j=1;j<=ct[i];j++)dp[i][j]=dp[i+1][j];\n\t\t\tdp[i][ct[i]+1]=0;\n\t\t}\n\t}\n\tif(ct[1])printf(\"%s\\n\",dp[1]+1);\n\telse\n\t{\n\t\tfor(int i=2;i<=n;i++)\n\t\tfor(int j=1;j<i;j++)\n\t\tif(v[j][1]<v[i][0]&&dp2[i]<=dp2[j])dp2[i]=dp2[j]+1;\n\t\tfor(int i=1;i<=n;i++)if(dp2[i]>dp2[n])dp2[n]=dp2[i];\n\t\tfor(int i=1;i<=dp2[n]+1;i++)printf(\"ab\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <string>\n#include <iostream>\n\nusing namespace std;\n\nint n;\n\nchar ch[6666];\n\nint _a[6666], _b[6666];\n\nvoid dealab(int l, int r) {\n    for(int i = l, nxt; i <= r; i = nxt + 1) {\n        putchar('a'), putchar('b');\n        for(nxt = i; nxt < n && _a[nxt + 1] < _b[i]; nxt++);\n    }\n}\n\nvoid dealba(int l, int r) {\n    string X = \"\";\n    static bool B[6666];\n    memset(B, 0, sizeof B);\n    for(int i = r; i >= l; i--) {\n        B[_b[i]] = 1;\n        B[_a[i]] = 1;\n        string Y = \"\";\n        for(int j = 1; j <= 2 * n; j++) if(B[j]) Y = Y + ch[j];\n        if(X < Y) X = Y;\n    }\n    cout << X;\n}\n\nint main() {\n    scanf(\"%d%s\", &n, ch + 1);\n    int t = 0, a = 1, b = 1;\n    while(ch[a] != 'a') a++;\n    while(ch[b] != 'b') b++;\n    for(int i = 1; i <= n; i++) {\n        _a[i] = a;\n        _b[i] = b;\n        if(i == n) break;\n        a++, b++;\n        while(ch[a] != 'a') a++;\n        while(ch[b] != 'b') b++;\n    }\n    int l = n + 1;\n    if(ch[n * 2] == 'b') {\n        for(int i = n; i >= 1; i--) if(_a[i] < _b[i]) l = i; else break;\n    }\n    for(int i = 1, nxt; i <= n; i = nxt + 1) {\n        if(_b[i] > _a[i]) {\n            nxt = i;\n            continue;\n        }\n        for(nxt = i; nxt < n && _b[nxt + 1] < _a[nxt]; nxt++);\n        dealba(i, nxt);\n    }\n    dealab(l, n);\n    putchar('\\n');\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>  \n#include <iostream>  \n#include <sstream>  \n#include <string>  \n#include <cstring>\n#include <vector>  \n#include <queue>  \n#include <set>  \n#include <map>  \n#include <cstdio>  \n#include <cstdlib>  \n#include <cctype>  \n#include <cmath>  \n#include <list>  \n#include <cassert>\n#include <ctime>\n#include <climits>\nusing namespace std;  \n\n#define PB push_back  \n#define MP make_pair  \n#define SZ(v) ((int)(v).size())  \n#define FOR(i,a,b) for(int i=(a);i<(b);++i)  \n#define REP(i,n) FOR(i,0,n)  \n#define FORE(i,a,b) for(int i=(a);i<=(b);++i)  \n#define REPE(i,n) FORE(i,0,n)  \n#define FORSZ(i,a,v) FOR(i,a,SZ(v))  \n#define REPSZ(i,v) REP(i,SZ(v))  \ntypedef long long ll;\ntypedef unsigned long long ull;\nll gcd(ll a,ll b) { return b==0?a:gcd(b,a%b); }\n\nconst int MAXN=3000;\n\nint n;\nchar s[2*MAXN+1];\n\nint a[2*MAXN],na;\nint b[2*MAXN],nb;\nint idx[2*MAXN];\nint match[2*MAXN];\n\nstring dp[2*MAXN+1];\n\nvoid run() {\n\tscanf(\"%d%s\",&n,s);\n\n\tna=nb=0; REP(i,2*n) if(s[i]=='a') idx[i]=na,a[na++]=i; else if(s[i]=='b') idx[i]=nb,b[nb++]=i; assert(na==n&&nb==n);\n\tREP(i,2*n) match[i]=s[i]=='a'?b[idx[i]]:s[i]=='b'?a[idx[i]]:-1;\n\n\tdp[2*n]=\"\";\n\tfor(int i=2*n-1;i>=0;--i) {\n\t\tdp[i]=dp[i+1];\n\t\tif(match[i]<i) continue;\n\t\tif(s[i]=='a') { dp[i]=max(dp[i],\"ab\"+dp[match[i]+1]); continue; }\n\t\t\n\t\tvector<bool> used(2*n,false); int nused=0,mxused=-1; used[i]=true,mxused=max(mxused,i),++nused; used[match[i]]=true,mxused=max(mxused,match[i]),++nused;\n\t\tFORE(j,i+1,mxused) {\n\t\t\tif(s[j]!='b') continue;\n\t\t\tassert(match[j]>mxused);\n\t\t\tused[j]=true,mxused=max(mxused,j),++nused; used[match[j]]=true,mxused=max(mxused,match[j]),++nused;\n\t\t}\n\t\tstring cur(nused,'?'); int at=0; FORE(j,i,mxused) if(used[j]) cur[at++]=s[j]; assert(at==nused);\n\t\tdp[i]=max(dp[i],cur+dp[mxused+1]);\n\t}\n\n\tprintf(\"%s\\n\",dp[0].c_str());\n}\n\nint main() {\n\trun();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <cassert>\n#include <random>\n#include <iomanip>\n#define FOR(i, n, m) for(ll i = n; i < (int)m; i++)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define pb push_back\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll, ll>;\nconstexpr ll inf = 1000000000;\nconstexpr ll mod = 1000000007;\nconstexpr long double eps = 1e-15;\n \ntemplate<typename T1, typename T2>\nostream& operator<<(ostream& os, pair<T1, T2> p) {\n    os << to_string(p.first) << \" \" << to_string(p.second);\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& v) {\n    REP(i, v.size()) {\n        if(i) os << \" \";\n        os << to_string(v[i]);\n    }\n    return os;\n}\n \nstruct modint {\n    ll n;\npublic:\n    modint(const ll n = 0) : n((n % mod + mod) % mod) {}\n    static modint pow(modint a, int m) {\n        modint r = 1;\n        while(m > 0) {\n            if(m & 1) { r *= a; }\n            a = (a * a); m /= 2;\n        }\n        return r;\n    }\n    modint &operator++() { *this += 1; return *this; }\n    modint &operator--() { *this -= 1; return *this; }\n    modint operator++(int) { modint ret = *this; *this += 1; return ret; }\n    modint operator--(int) { modint ret = *this; *this -= 1; return ret; }\n    modint operator~() const { return (this -> pow(n, mod - 2)); } // inverse\n    friend bool operator==(const modint& lhs, const modint& rhs) {\n        return lhs.n == rhs.n;\n    }\n    friend bool operator<(const modint& lhs, const modint& rhs) {\n        return lhs.n < rhs.n;\n    }\n    friend bool operator>(const modint& lhs, const modint& rhs) {\n        return lhs.n > rhs.n;\n    }\n    friend modint &operator+=(modint& lhs, const modint& rhs) {\n        lhs.n += rhs.n;\n        if (lhs.n >= mod) lhs.n -= mod;\n        return lhs;\n    }\n    friend modint &operator-=(modint& lhs, const modint& rhs) {\n        lhs.n -= rhs.n;\n        if (lhs.n < 0) lhs.n += mod;\n        return lhs;\n    }\n    friend modint &operator*=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * rhs.n) % mod;\n        return lhs;\n    }\n    friend modint &operator/=(modint& lhs, const modint& rhs) {\n        lhs.n = (lhs.n * (~rhs).n) % mod;\n        return lhs;\n    }\n    friend modint operator+(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n + rhs.n);\n    }\n    friend modint operator-(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n - rhs.n);\n    }\n    friend modint operator*(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * rhs.n);\n    }\n    friend modint operator/(const modint& lhs, const modint& rhs) {\n        return modint(lhs.n * (~rhs).n);\n    }\n};\nistream& operator>>(istream& is, modint m) { is >> m.n; return is; }\nostream& operator<<(ostream& os, modint m) { os << m.n; return os; }\n \n#define MAX_N 3030303\nlong long extgcd(long long a, long long b, long long& x, long long& y) {\n    long long d = a;\n    if (b != 0) {\n        d = extgcd(b, a % b, y, x);\n        y -= (a / b) * x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nlong long mod_inverse(long long a, long long m) {\n    long long x, y;\n    if(extgcd(a, m, x, y) == 1) return (m + x % m) % m;\n    else return -1;\n}\nvector<long long> fact(MAX_N+1, inf);\nlong long mod_fact(long long n, long long& e) {\n    if(fact[0] == inf) {\n        fact[0]=1;\n        if(MAX_N != 0) fact[1]=1;\n        for(ll i = 2; i <= MAX_N; ++i) {\n            fact[i] = (fact[i-1] * i) % mod;\n        }\n    }\n    e = 0;\n    if(n == 0) return 1;\n    long long res = mod_fact(n / mod, e);\n    e += n / mod;\n    if((n / mod) % 2 != 0) return (res * (mod - fact[n % mod])) % mod;\n    return (res * fact[n % mod]) % mod;\n}\n// return nCk\nlong long mod_comb(long long n, long long k) {\n    if(n < 0 || k < 0 || n < k) return 0;\n    long long e1, e2, e3;\n    long long a1 = mod_fact(n, e1), a2 = mod_fact(k, e2), a3 = mod_fact(n - k, e3);\n    if(e1 > e2 + e3) return 0;\n    return (a1 * mod_inverse((a2 * a3) % mod, mod)) % mod;\n}\n \nusing mi = modint;\n \nmi mod_pow(mi a, ll n) {\n    mi ret = 1;\n    mi tmp = a;\n    while(n > 0) {\n        if(n % 2) ret *= tmp;\n        tmp = tmp * tmp;\n        n /= 2;\n    }\n    return ret;\n}\n \nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n \nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    string s;\n    cin >> n >> s;\n    vector<pair<int, int>> idx(n);\n    vector<int> v(2 * n, -1);\n    int ca = 0, cb = 0;\n    REP(i, 2 * n) {\n        if(s[i] == 'a') {\n            idx[ca].first = i;\n            v[i] = ca;\n            ca++;\n        } else {\n            idx[cb].second = i;\n            v[i] = cb;\n            cb++;\n        }\n    }\n    vector<string> mx(n, \"\");\n    for(int i = n - 1; i >= 0; i--) {\n        if(idx[i].first < idx[i].second) {\n            mx[i] = \"ab\";\n            int tmp = i;\n            for(int j = idx[i].first + 1; j < idx[i].second; j++) if(s[j] == 'a') tmp++;\n            if(tmp + 1 < n) mx[i] += mx[tmp + 1];\n        } else {\n            int tmp = i;\n            for(int j = idx[i].second; j < 2 * n; j++) {\n                if(s[j] == 'b') {\n                    mx[i] += 'b';\n                    tmp = v[j];\n                } else {\n                    if(v[j] < i) continue;\n                    if(v[j] > tmp) {\n                        mx[i] += mx[v[j]];\n                        break;\n                    } else mx[i] += 'a';\n                }\n            }\n        }\n        if(i < n - 1) mx[i] = max(mx[i], mx[i + 1]);\n    }\n    string ans = mx[0];\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint A[3010],B[3010];\nstring getans(int l,int r)\n{\n\tstring ans=\"\";\n\tif(A[l]<B[l])\n\t{\n\t\tint now=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(A[i]>now){\n\t\t\t\tnow=B[i];\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t}\n\telse{\n\t\tfor(int i=l;i<=r;i++)\n\t\t{\n\t\t\tstring cur=\"\";\n\t\t\tint nowa=i,nowb=i;\n\t\t\twhile(nowa<=r||nowb<=r)\n\t\t\t{\n\t\t\t\tif((nowa<=r&&A[nowa]<B[nowb])||nowb>r)\n\t\t\t\t\tcur+='a',nowa++;\n\t\t\t\telse cur+='b',nowb++;\n\t\t\t}\n\t\t\tans=max(ans,cur);\n\t\t}\n\t}\n\treturn ans;\n}\nchar str[6010];\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint nowa=0,nowb=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')A[++nowa]=i;\n\t\telse B[++nowb]=i;\n\tstring ans=\"\";\n\tfor(int i=n;i>=1;)\n\t{\n\t\tint j=i;\n\t\tif(A[i]<B[i])while(j>0&&A[j]<B[j])j--;\n\t\telse while(j>0&&A[j]>B[j])j--;\n\t\tstring tmp=getans(j+1,i);\n\t\tans=max(max(tmp,ans),tmp+ans);\n\t\ti=j;\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//                             In The Name Of Allah                                           \n#include <bits/stdc++.h>\n#define\tss second\n#define ff first\n#define use_fast ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)\n#define se(n) cout << setprecision(n) << fixed\n#define pb push_back\n#define ll long long\n#define int long long\n#define ld long double\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops\")\n#pragma GCC optimize(\"no-stack-protector,fast-math\")\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\nusing namespace std; \n\nconst int N = 1e5 + 100, OO = 1e9 + 7, K = 3e5 + 100, T = 5, M = 1e9 + 7, P = 6151, SQ = 450, lg = 20;\ntypedef pair <int, int> pii;\nint mark[N], n;\nstring s, ans[N];\n\nvoid solve(int x) {\n\tint mx = 0;\n\tfor(int i = 1; i < x; i++) \n\t\tmx = max(mx, mark[i]);\n\tif(mark[x] <= mx)\n\t\treturn;\n\tif(s[x - 1] == 'a') {\n\t\tans[x] = \"ab\";\n\t\tfor(int i = x + 1; i <= n; i++) {\n\t\t\tif(mark[i] == mark[x]) {\n\t\t\t\tans[x] += ans[i + 1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tint cnt = 1;\n\t\tans[x] = \"b\";\n\t\tfor(int i = x + 1; i <= n; i++) {\n\t\t\tif(mark[i] <= mx)\n\t\t\t\tcontinue;\n\t\t\tans[x] += s[i - 1];\n\t\t\tif(s[i - 1] == 'a')\n\t\t\t\tcnt--;\n\t\t\telse\n\t\t\t\tcnt++;\n\t\t\tif(cnt == 0) {\n\t\t\t\tans[x] += ans[i + 1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint32_t main() {\n\tuse_fast;\n\tcin >> n >> s;\n\tn *= 2;\n\tint a0 = 0, a1 = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tif(s[i - 1] == 'a')\n\t\t\ta0++, mark[i] = a0;\n\t\telse\n\t\t\ta1++, mark[i] = a1;\n\t}\n\tfor(int i = n; i; i--) \n\t\tsolve(i), ans[i] = max(ans[i], ans[i + 1]);\n\tcout << ans[1] << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nint n;\nchar s[6003];\nstd::string parts[3003];\nint main()\n{\n\tscanf(\"%d %s\",&n,s);\n\tint i = 0, j = 0;\n\twhile(i < 2 * n) {\n\t\tstd::string max;\n\t\tint sum = 0;\n\t\tint type = s[i] - 'a';\n\t\tstd::vector<int> va, vb;\n\t\tdo {\n\t\t\tif(s[i] == 'a') {\n\t\t\t\t++sum;\n\t\t\t\tva.push_back(i);\n\t\t\t} else {\n\t\t\t\t--sum;\n\t\t\t\tvb.push_back(i);\n\t\t\t}\n\t\t\t++i;\n\t\t} while(sum != 0);\n\t\tif(type == 0) {\n\t\t\twhile(!va.empty()) {\n\t\t\t\tassert(va[0] < vb[0]);\n\t\t\t\tmax += \"ab\";\n\t\t\t\tint j = vb[0];\n\t\t\t\twhile(!va.empty() && va[0] < j) {\n\t\t\t\t\tva.erase(va.begin());\n\t\t\t\t\tvb.erase(vb.begin());\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint s = va.size();\n\t\t\tfor(int k = 0;k < s;++k) {\n\t\t\t\tstd::string cur;\n\t\t\t\tint a = k, b = k;\n\t\t\t\twhile(a < s || b < s) {\n\t\t\t\t\tif(b == s || (a != s && va[a] < vb[b])) {\n\t\t\t\t\t\tcur.push_back('a');\n\t\t\t\t\t\t++a;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcur.push_back('b');\n\t\t\t\t\t\t++b;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(cur > max) max = cur;\n\t\t\t}\n\t\t}\n\t\tparts[j++] = max;\n\t}\n\tstd::string max, ans;\n\tfor(int k = j-1;k >= 0;--k) {\n\t\tif(parts[k] >= max) {\n\t\t\tmax = parts[k];\n\t\t}\n\t\tif(std::mismatch(parts[k].begin(),parts[k].end(),max.begin()).first == parts[k].end()) {\n\t\t\tans = parts[k] + ans;\n\t\t}\n\t}\n\tprintf(\"%s\\n\", ans.c_str());\n\t\t\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#define M 6006\n#define N 3003\nchar a[M];int b[N],c[N],d[M],f[N][M],g[N],i,j,k,n,u;\nint main()\n{\n    scanf(\"%d%s\",&n,a+1);\n    for(i=1;i<=n<<1;i++)a[i]==97?b[++j]=i:c[++k]=i;\n    for(i=1;i<=n;i++)d[b[i]<c[i]?b[i]:c[i]]++;\n    for(i=1;i<=n<<1;i++)d[i]+=d[i-1];\n    for(i=n;i;i--)\n    {\n        if(b[i]<c[i])f[i][1]=b[i],f[i][2]=c[i],u=d[c[i]]+1,memcpy(f[i]+3,f[u]+1,g[u]<<2),g[i]=g[u]+2;\n        else\n        {\n            for(u=d[b[j=i]]+1;j<u;j++)f[i][++g[i]]=c[j];\n            for(j=i,k=1;j<u||k<=g[u];)\n            if(j<u&&(g[u]<k||b[j]<f[u][k]))f[i][++g[i]]=b[j++];\n            else f[i][++g[i]]=f[u][k++];\n        }\n        for(j=1;a[f[i][j]]==a[f[i+1][j]]&&j<=g[i]&&j<=g[i+1];j++);\n        if(a[f[i][j]]<a[f[i+1][j]])memcpy(f[i]+1,f[i+1]+1,g[i+1]<<2),g[i]=g[i+1],f[i][g[i]+1]=0;\n    }\n    for(i=1;i<=g[1];i++)printf(\"%c\",a[f[1][i]]);\n    return 0&puts(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint a[3010],b[3010];\nchar str[6010];\nstring dp[3010];\nbool vis[6010];\nint main()\n{\n\tint n;scanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint num1=0,num2=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')a[++num1]=i;\n\t\telse b[++num2]=i;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(a[i]<b[i])\n\t\t{\n\t\t\tint j=i;\n\t\t\twhile(j<=n&&(a[j]<b[i]||b[j]<b[i]))\n\t\t\t\tj++;\n\t\t\tdp[i]=\"ab\"+dp[j];\n\t\t}\n\t\telse{\n\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\tint mx=a[i],j=i;\n\t\t\twhile(j<=n&&a[j]>b[j]&&b[j]<=mx){\n\t\t\t\tvis[a[j]]=true;\n\t\t\t\tvis[b[j]]=true;\n\t\t\t\tmx=max(mx,a[j]);\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor(int k=i;k<=n*2;k++)\n\t\t\t\tif(vis[k])dp[i]+=str[k];\n\t\t\tdp[i]+=dp[j];\n\t\t}\n\t\tdp[i]=max(dp[i],dp[i+1]);\n\t}\n\tcout<<dp[1]<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst int N = 6e3 + 3;\nint M[N];\nbool mark[N];\nstring dp[N];\nvector <int> v[2];\n\nint main() {\n    int n; cin >> n;\n    string s; cin >> s;\n    for (int i = 0; i < 2 * n; i++) v[s[i] - 'a'].push_back(i);\n    for (int i = 0; i < n; i++) M[v[0][i]] = v[1][i], M[v[1][i]] = v[0][i];\n    for (int i = 2 * n - 1; i >= 0; i--) {\n        if (s[i] == 'a' && M[i] > i) dp[i] = \"ab\" + dp[M[i] + 1];\n        if (s[i] == 'b' && M[i] > i) {\n            memset(mark, 0, sizeof mark);\n            string res = \"\";\n            int lst = M[i];\n            mark[i] = mark[M[i]] = 1;\n            for (int j = i; j <= lst; j++) {\n                if (s[j] == 'b' && M[j] > j) mark[j] = mark[M[j]] = 1, lst = M[j];\n                if (mark[j]) res += s[j];\n            }\n            dp[i] = res + dp[lst + 1];\n        }\n        dp[i] = max(dp[i], dp[i + 1]);\n    }\n    cout << dp[0] << \"\\n\";\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<math.h>\n#include<ctype.h>\n#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cerrno>\n#include<cfloat>\n#include<ciso646>\n#include<climits>\n#include<clocale>\n#include<complex>\n#include<csetjmp>\n#include<csignal>\n#include<cstdarg>\n#include<cstddef>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<cwchar>\n#include<cwctype>\n#include<deque>\n#include<exception>\n#include<fstream>\n#include<functional>\n#include<iomanip>\n#include<ios>\n#include<iosfwd>\n#include<iostream>\n#include<istream>\n#include<iterator>\n#include<limits>\n#include<list>\n#include<locale>\n#include<map>\n#include<memory>\n#include<new>\n#include<numeric>\n#include<ostream>\n#include<queue>\n#include<set>\n#include<sstream>\n#include<stack>\n#include<stdexcept>\n#include<streambuf>\n#include<string>\n#include<typeinfo>\n#include<utility>\n#include<valarray>\n#include<vector>\n#include<string.h>\n#include<stdlib.h>\n#include<stdio.h>\nusing namespace std;\nstruct node\n{\n\tint a[6010],l;\n\tstring s;\n\tnode()\n\t{\n\t\tl=0;\n\t\tmemset(a,0,sizeof(a));\n\t\ts=\"\";\n\t}\n\tvoid add(int i,int j)\n\t{\n\t\tint x=lower_bound(a,a+l,j)-a;\n\t\tstring str=\"b\"+s.substr(0,x)+\"a\"+s.substr(x,l-x);\n\t\tif (str<s)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tl++;\n\t\tfor (int k=l;k>x;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[x]=j;\n\t\tl++;\n\t\tfor (int k=l;k;k--)\n\t\t{\n\t\t\ta[k]=a[k-1];\n\t\t}\n\t\ta[0]=i;\n\t\ts=str;\n\t}\n};\nint n,a[6010],b[6010],c[6010];\nchar s[6010];\nstring work(int f,int l,int r)\n{\n\tif (l>r)\n\t{\n\t\treturn \"\";\n\t}\n\t//cout<<f<<\" \"<<l<<\" \"<<r<<endl;\n\t//system(\"pause\");\n\tint s0=0,s1=0;\n\tfor (int i=l;i<=r;i++)\n\t{\n\t\tif ((s[i]-'a')==f)\n\t\t{\n\t\t\ts0++;\n\t\t\ta[s0]=i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts1++;\n\t\t\tb[a[s1]]=i;\n\t\t}\n\t}\n\tstring res=\"\";\n\tif (!f)\n\t{\n\t\tint i=l;\n\t\twhile (i<=r)\n\t\t{\n\t\t\tif ((s[i]-'a')!=f)\n\t\t\t{\n\t\t\t\ti++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/*\n\t\t\tcout<<i<<endl;\n\t\t\tsystem(\"pause\");\n\t\t\t*/\n\t\t\tres=res+\"ab\";\n\t\t\ti=b[i]+1;\n\t\t}\n\t}\n\telse\n\t{\n\t\t/*\n\t\ts0=s1=0;\n\t\tint lst=r;\n\t\tfor (int j=r;j>=l;j--)\n\t\t{\n\t\t\tif ((s[j]-'a')==f)\n\t\t\t{\n\t\t\t\ts0++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ts1++;\n\t\t\t}\n\t\t\tif (s0==s1)\n\t\t\t{\n\t\t\t\tnode now;\n\t\t\t\tfor (int i=lst;i>=j;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tif ((now.s+res)>res)\n\t\t\t\t{\n\t\t\t\t\tres=now.s+res;\n\t\t\t\t}\n\t\t\t\tlst=j-1;\n\t\t\t}\n\t\t}\n\t\tnode now;\n\t\t\t\tfor (int i=r;i>=l;i--)\n\t\t\t\t{\n\t\t\t\t\tif ((s[i]-'a')!=f)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnow.add(i,b[i]);\n\t\t\t\t}\n\t\t\t\tres=now.s;\n\t\t*/\n\t\tfor (int i=l-1;i<=r;i++)\n\t\t{\n\t\t\tc[i]=0;\n\t\t}\n\t\tfor (int i=l;i<=r;i++)\n\t\t{\n\t\t\tif ((s[i]-'a')==f)\n\t\t\t{\n\t\t\t\tc[i]=c[i-1]+1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tc[i]=c[i-1];\n\t\t\t}\n\t\t}\n\t\tvector<int> v;\n\t\tv.clear();\n\t\tint mx=l;\n\t\tv.push_back(l);\n\t\tfor (int i=l+1;i<=r;i++)\n\t\t{\n\t\t\t//cout<<i<<\" \"<<c[b[i]]-c[i]<<endl;\n\t\t\tif (c[b[i]]-c[i]>c[b[mx]]-c[mx])\n\t\t\t{\n\t\t\t\tv.clear();\n\t\t\t\tmx=i;\n\t\t\t\tv.push_back(i);\n\t\t\t}\n\t\t\telse if (c[b[i]]-c[i]==c[b[mx]]-c[mx])\n\t\t\t{\n\t\t\t\tv.push_back(i);\n\t\t\t}\n\t\t}\n\t\tfor (int j=0;j<v.size();j++)\n\t\t{\n\t\t\tstring now=\"\";\n\t\t\tfor (int i=v[j];i<=r;i++)\n\t\t\t{\n\t\t\t\tif ((s[i]-'a')==f)\n\t\t\t\t{\n\t\t\t\t\tnow.push_back(s[i]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (i>=b[v[j]])\n\t\t\t\t\t{\n\t\t\t\t\t\tnow.push_back(s[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//cout<<now<<endl;\n\t\t\tres=max(res,now);\n\t\t}\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",&s);\n\tint sa=0,sb=0,lst=2*n-1;\n\tstring ans=\"\";\n\tfor (int i=2*n-1;i>=0;i--)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa!=sb)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tif (s[i-1]=='b')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (lst==2*n-1)\n\t\t\t{\n\t\t\t\tans=work(0,i,lst)+ans;\n\t\t\t}\n\t\t\tlst=i-1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstring str=work(1,i,lst);\n\t\t\t/*\n\t\t\tfor (int j=i;j<=lst;j++)\n\t\t\t{\n\t\t\t\tstr.push_back(s[j]);\n\t\t\t}\n\t\t\t*/\n\t\t\tif ((str+ans)>ans)\n\t\t\t{\n\t\t\t\tans=str+ans;\n\t\t\t}\n\t\t\t//cout<<ans<<endl;\n\t\t\tlst=i-1;\n\t\t}\n\t}\n\t/*\n\tfor (int i=0;i<2*n;i++)\n\t{\n\t\tif (s[i]=='a')\n\t\t{\n\t\t\tsa++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsb++;\n\t\t}\n\t\tif (sa==sb)\n\t\t{\n\t\t\tif (i==2*n-1 || s[i+1]!=s[lst])\n\t\t\t{\n\t\t\t\tif (i==2*n-1 || (s[i+1]!=s[lst] && s[lst]!='a'))\n\t\t\t\t{\n\t\t\t\t\tans=ans+work(s[lst]-'a',lst,i);\n\t\t\t\t}\n\t\t\t\tsa=sb=0;\n\t\t\t\tlst=i+1;\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\tcout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nvector<string> s;\nstring S, res;\nint n, m;\n\nvoid sol(string &s) {\n    vector<int> p[2];\n    string t = \"\";\n    for (int i = 0; i < s.length(); ++i) p[s[i] == 'a'].push_back(i);\n\n    if (s[0] == 'a') {\n        int last = -1;\n        for (int i = 0; i < p[1].size(); ++i)\n            if (p[1][i] > last) last = p[0][i], t += \"ab\";\n    } else {\n        for (int i = 0; i < p[1].size(); ++i) {\n            string tp = \"\";\n            int x = i, y = i;\n            while (1)\n                if (x < p[1].size() && (y == p[0].size() || p[1][x] < p[0][y]))\n                    tp += 'a', ++x;\n                else if (y < p[0].size())\n                    tp += 'b', ++y;\n                else\n                    break;\n            if (tp > t) t = tp;\n        }\n    }\n    s = t;\n}\n\nint main() {\n    cin >> n >> S;\n    int cnt = 0;\n    string tmp;\n    for (int i = 0; i < n * 2; ++i) {\n        (S[i] == 'a') ? cnt++ : cnt--, tmp += S[i];\n        if (cnt == 0) s.push_back(tmp), tmp = \"\";\n    }\n    for (int i = 0; i < s.size(); ++i) sol(s[i]);\n    res = s.back();\n    for (int i = (int)s.size() - 2; i >= 0; --i) {\n        int flag = 1;\n        for (int j = 0; j < min(s[i].length(), res.length()); ++j)\n            if (s[i][j] != res[j]) {\n                if (s[i][j] < res[j]) flag = 0;\n                break;\n            }\n        if (flag) res = s[i] + res;\n    }\n    cout << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define MAX 3002\n\nint n;\n\nvector<bool> dp[MAX];\n\nvector<pair<int, int> > pos;  //b , a\nint mode[MAX];\nbool us[MAX];\n\nbool use[MAX];\nchar buf[MAX];\nstring s;\nvector<int> v1;\nvector<int> v2;\nbool cmp(vector<bool> a, vector<bool> b){\n\tint lef = 0;\n\tint rig = 0;\n\twhile (lef < a.size() || rig < b.size()){\n\t\twhile (lef < a.size() && a[lef] == false){\n\t\t\tlef++;\n\t\t}\n\t\twhile (rig < b.size() && b[rig] == false){\n\t\t\trig++;\n\t\t}\n\t\tif (rig == b.size())return true;\n\t\tif (lef == a.size())return false;\n\t\tif (s[lef] > s[rig])return true;\n\t\tif (s[lef] < s[rig])return false;\n\t\tlef++;\n\t\trig++;\n\t}\n\treturn false;\n}\nvector<bool> dfs(int b){\n\tif (b == n)return vector<bool>(2*n,0);\n\tif (us[b])return dp[b];\n\tus[b] = true;\n\tdp[b] = dfs(b + 1);  //choose nothing\n\tif (pos[b].first <= pos[b].second){\n\t\tint til = 0;\n\t\tint cnt = 0;\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (min(pos[j].second, pos[j].first)> pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttil = j;\n\t\t\tcnt++;\n\t\t}\n\t\tvector<bool> nex = dfs(til + 1);\n\t\tfor (int j = b; j < pos.size(); j++){\n\t\t\tif (min(pos[j].second,pos[j].first) > pos[b].second){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (pos[j].first > pos[j].second){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnex[pos[j].first] = true;\n\t\t\tnex[pos[j].second] = true;\n\t\t}\n\t\tif (cmp(nex,dp[b])){\n\t\t\tdp[b] = nex;\n\t\t}\n\t}\n\telse{\n\t\tvector<bool> ne(2 * n, false);\n\t\tne[pos[b].first] = ne[pos[b].second] = true;\n\t\tint maxt = max(pos[b].first, pos[b].second);\n\t\tfor (int j = b + 1; j < n; j++){\n\t\t\tif (min(pos[j].first, pos[j].second) >= maxt){\n\t\t\t\tvector<bool> k2 = dfs(j);\n\t\t\t\tfor (int i = 0; i < 2 * n; i++){\n\t\t\t\t\tne[i] = (ne[i]|k2[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (cmp(ne, dp[b])){\n\t\t\tdp[b] = ne;\n\t\t}\n\t}\n\treturn dp[b];\n}\n\nint main(){\n\tcin >> n;\n\tscanf(\"%s\", buf);\n\ts = buf;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (s[i] == 'a'){\n\t\t\tv1.push_back(i);\n\t\t}\n\t\tif (s[i] == 'b'){\n\t\t\tv2.push_back(i);\n\t\t}\n\t}\n\tfor (int i = 0; i < v1.size(); i++){\n\t\tpos.push_back(make_pair(v2[i], v1[i]));\n\t}\n\tvector<bool> uss=dfs(0);\n\t//dfs2(0);\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif (uss[i]){\n\t\t\tputchar(s[i]);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cctype>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\n#define rep(i,n) for (int i=0;i<n;++i)\n#define REP(i,n) for (int i=1;i<=n;++i)\n#define all(x) x.begin(),x.end()\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define F first\n#define S second\n#define read(x) scanf(\"%d\",&x)\nbool operator < (const string &s1,const string &s2){\n\tint sZ=min(s1.size(),s2.size());\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]<s2[i]) return 1;\n\t\telse if (s1[i]>s2[i]) return 0;\n\treturn s1.size()<s2.size();\n}\nbool operator > (const string &s1,const string &s2){\n\tint sZ=min(s1.size(),s2.size());\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]>s2[i]) return 1;\n\t\telse if (s1[i]<s2[i]) return 0;\n\treturn s1.size()>s2.size();\n}\nbool operator == (const string &s1,const string &s2){\n\tint sZ=s1.size();if (sZ!=s2.size()) return 0;\n\tfor (int i=0;i<sZ;++i)\n\t\tif (s1[i]!=s2[i]) return 0;\n\treturn 1;\n}\nint n;\nstring s;\nstruct segment{\n\tint l,r;bool type;\n\tsegment(int L=0,int R=0,bool TYPE=0):l(L),r(R),type(TYPE){}\n\tsegment operator = (const segment &sg){\n\t\tl=sg.l;r=sg.r;type=sg.type;return *this;\n\t}\n};\nsegment seg[6005];int cntseg=0;\nint rank_to_a[6005],rank_to_b[6005],a_to_rank[6005],b_to_rank[6005];\nbool used_rank[6005];\npair<string,int> material_string[6005];\nstruct info{\n\tstring s;int ptr,verdict;\n\tbitset<6005> must;\n\tinfo(int i=0):ptr(i),verdict(1){must.reset();must.set(rank_to_a[b_to_rank[i]]);s.clear();s.pb('b');}\n};\nvector<info> tmp;\ninline string segProcess(segment sg){\n\tbool tp=sg.type;\n\tstring ret;\n\tint l=sg.l,r=sg.r;\n\tif (tp==0){\n\t\t\n\t\tfor (int i=l;i<=r;++i){\n\t\t\twhile(i<=r&&s[i]=='b') ++i;\n\t\t\tif (i>r) break;\n\t\t\tret.pb('a');ret.pb('b');\n\t\t\ti=rank_to_b[a_to_rank[i]];\n\t\t}\n\t\treturn ret;\n\t}\n\tif (tp==1){\n\t\tint best_next=11;// 0:a  1:b  -1:end\n\t\ttmp.clear();\n\t\tfor (int i=l;i<=r;++i){\n\t\t\tif (s[i]=='b') tmp.pb(info(i));\n\t\t}\n\t\twhile(best_next!=-1){\n\t\t\tbest_next=-1;\n\t\t\tfor (int i=0;i<tmp.size();++i){\n\t\t\t\tinfo &temp=tmp[i];\n\t\t\t\ttemp.ptr++;\n\t\t\t\tif (temp.ptr>r){\n\t\t\t\t\ttemp.verdict=-1;continue;\n\t\t\t\t}\n\t\t\t\twhile(temp.ptr<=r&&s[temp.ptr]=='a'&&temp.must[temp.ptr]==0) ++temp.ptr;\n\t\t\t\tif (temp.ptr>r){\n\t\t\t\t\ttemp.verdict=-1;continue;\n\t\t\t\t}\n\t\t\t\tif (s[temp.ptr]=='a') temp.s+='a',temp.verdict=0,best_next=max(best_next,0);\n\t\t\t\telse temp.s+='b',temp.verdict=1,temp.must[rank_to_a[b_to_rank[temp.ptr]]]=1,best_next=1;\n\t\t\t}\n\t\t\tfor (vector<info>::iterator it=tmp.begin();it!=tmp.end();){\n\t\t\t\tif (it->verdict < best_next) it=tmp.erase(it);\n\t\t\t\telse ++it;\n\t\t\t}\n\t\t}\n\t\treturn tmp[0].s;\n\t}\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>n>>s;s='*'+s;n*=2;\n\tint cnta=0,cntb=0;\n\tfor (int i=1;i<=n;++i){\n\t\tif (s[i]=='a'){\n\t\t\trank_to_a[++cnta]=i;\n\t\t\ta_to_rank[i]=cnta;\n\t\t}\n\t\telse{\n\t\t\trank_to_b[++cntb]=i;\n\t\t\tb_to_rank[i]=cntb;\n\t\t}\n\t}\n\tint l=1,r;bool type;\n\tif (s[1]=='a') r=rank_to_b[1],type=0;\n\telse r=rank_to_a[1],type=1;\n\tused_rank[1]=1;\n\tfor (int i=2;i<=n;++i){\n\t\tif (i>r){\n\t\t\tseg[++cntseg]=segment(l,r,type);\n\t\t\tl=i;\n\t\t\tif (s[i]=='a') r=rank_to_b[a_to_rank[i]],type=0;\n\t\t\telse r=rank_to_a[b_to_rank[i]],type=1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (s[i]=='a'&&type==0){\n\t\t\tr=max(r,rank_to_b[a_to_rank[i]]);\n\t\t}\n\t\tif (s[i]=='b'&&type==1){\n\t\t\tr=max(r,rank_to_a[b_to_rank[i]]);\n\t\t}\n\t}\n\tseg[++cntseg]=segment(l,r,type);\n\tfor (int i=1;i<=cntseg;++i) material_string[i]=mp(segProcess(seg[i]),-i);\n\tsort(material_string+1,material_string+cntseg+1);\n\treverse(material_string+1,material_string+cntseg+1);\n\tint begin=0;\n\tfor (int i=1;i<=cntseg;++i){\n\t\tif (material_string[i].F[0]=='a') break;\n\t\telse if (-material_string[i].S>begin){\n\t\t\tbegin=-material_string[i].S;\n\t\t\tcout<<material_string[i].F;\n\t\t}\n\t}\n\tfor (int i=1;i<=cntseg;++i){\n\t\tif (material_string[i].F[0]=='a'&&-material_string[i].S>begin) cout<<material_string[i].F;\n\t}\n\tcout<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint N;\nchar S[6005];\n\nchar bst[6005], dis[6005];\n\nint a[3005], b[3005];\nint ca, cb;\n\nvector<int> pos;\n\nint main() {\n\tscanf(\"%d\", &N);\n\tscanf(\"%s\", S);\n\n\tfor (int i = 0; i < 2*N; ++i) {\n\t\tif (S[i] == 'a') a[ca++] = i;\n\t\telse b[cb++] = i;\n\t}\n\n\tbst[0] = 0;\n\n\tfor (int mn = 0; mn < N; ++mn) {\n\t\tpos.clear();\n\t\tfor (int i = 0; i < N; ++i) if (b[i] < a[i] && a[i] >= mn) pos.push_back(b[i]), pos.push_back(a[i]);\n\t\tsort(pos.begin(), pos.end());\n\n\t\tfor (int i = 0; i < N; ++i) if (a[i] < b[i] && (!pos.size() || (pos.back() < a[i]))) pos.push_back(a[i]), pos.push_back(b[i]);\n\n\t\tfor (int i = 0; i < pos.size(); ++i) dis[i] = S[pos[i]];\n\t\tdis[pos.size()] = 0;\n\n\t\tif (strcmp(dis, bst) > 0) strcpy(bst, dis);\n\t}\n\n\tprintf(\"%s\\n\", bst);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<vector>\n#include<map>\n#include<set>\n#include<string>\n#include<queue>\n#include<stack>\n#include<numeric>\n#include<complex>\nusing namespace std;\n#define MOD 1000000007\n#define MOD2 993244353\n#define INF (1<<29)\n#define LINF (1LL<<60)\n#define EPS (1e-10)\n#define PI 3.1415926535897932384626433832795028\ntypedef long long Int;\ntypedef pair<Int, Int> P;\ntypedef long double Real;\ntypedef complex<Real> CP;\n\nchar field[3300];\n\nstring calc(vector<int> &tmpas, vector<int> &tmpbs){\n    string res;\n    if(tmpas.back() < tmpbs.back()){\n        int now = -1;\n        for(int p = 0;p < tmpas.size();p++){\n            if(tmpas[p] < now)continue;\n            res += \"ab\";\n            now = tmpbs[p];\n        }\n    }\n    else{\n        for(int i = 0;i < tmpas.size();i++){\n            string tmp;\n            for(int j = i;j < tmpas.size();j++){\n                field[tmpas[j]] = 'a';\n                field[tmpbs[j]] = 'b';\n            }\n            for(int j = min(tmpas[0], tmpbs[0]); j <= max(tmpas.back(), tmpbs.back());j++){\n                if(field[j])tmp.push_back(field[j]);\n                field[j] = 0;\n            }\n            res = max(res, tmp);\n        }        \n    }\n    return res;\n}\n\nint main(){\n    int n;\n    string str;\n    vector<string> strs;\n    vector<int> as, bs, tmpas, tmpbs;\n    cin >> n;\n    cin >> str;\n    for(int i = 0;i < 2*n;i++){\n        if(str[i] == 'a')as.push_back(i);\n        else bs.push_back(i);\n    }\n    for(int i = 0;i < n;i++){\n        if(tmpas.empty() || tmpas.back() < tmpbs.back() == as[i] < bs[i]){\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n        else{\n            string tmp = calc(tmpas, tmpbs);\n            while(!strs.empty() && strs.back() < tmp)strs.pop_back();\n            strs.push_back(tmp);\n            tmpas.clear();tmpbs.clear();\n            tmpas.push_back(as[i]);\n            tmpbs.push_back(bs[i]);\n        }\n    }\n    string tmp = calc(tmpas, tmpbs);\n    while(!strs.empty() && strs.back() < tmp)strs.pop_back();\n    strs.push_back(tmp);\n    cout << accumulate(strs.begin(), strs.end(), string()) << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 3005;\n\nint n, dp[maxn][maxn], pa[maxn], pb[maxn], c[maxn], d[maxn];\nchar s[maxn<<1], a[maxn<<1], b[maxn<<1];\nbool used[maxn<<1];\n\nbool check(int x)\n{\n\tint cnta = 0, cntb = 0;\n\tfor(int i = x; i <= n; ++i)\n\t\tif(dp[x][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x], pb[x]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\ta[++cnta] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = x + 1; i <= n; ++i)\n\t\tif(dp[x+1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\n\t\t}\n\tfor(int i = min(pa[x+1], pb[x+1]); i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t{\n\t\t\tb[++cntb] = s[i];\n\t\t\tused[i] = 0;\n\t\t}\n\tfor(int i = 1; i <= min(cnta, cntb); ++i)\n\t\tif(a[i] != b[i])\n\t\t\treturn b[i] > a[i];\n\treturn cntb > cnta;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", s + 1);\n\tint cnta = 0, cntb = 0;\n\tfor(int i = 1; i <= (n << 1); ++i)\t\n\t{\n\t\tif(s[i] == 'a')\n\t\t{\n\t\t\tpa[++cnta] = i;\n\t\t\tc[i] = cnta;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpb[++cntb] = i;\n\t\t\td[i] = cntb;\n\t\t}\n\t}\n\tfor(int i = n; i >= 1; --i)\n\t{\n\t\tdp[i][i] = 1;\n\t\tif(pa[i] > pb[i])\n\t\t{\n\t\t\tint p = n + 1, tot = 0;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t{\n\t\t\t\tif(pb[j] > pa[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t++ tot;\n\t\t\t\tdp[i][j] = 1;\n\t\t\t}\n\t\t\tfor(int j = pa[i] + 1; j <= (n << 1); ++j)\n\t\t\t{\n\t\t\t\tif(s[j] == 'b')\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\t++ tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(tot == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = dp[p][c[j]];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][c[j]] = 1;\n\t\t\t\t\t\tp = max(p, c[j] + 1);\n\t\t\t\t\t\t-- tot;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint p = n + 1;\n\t\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\t\tif(pa[j] > pb[i])\n\t\t\t\t{\n\t\t\t\t\tp = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tfor(int j = p; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[p][j];\n\t\t}\n\t\tif(check(i))\n\t\t{\n\t\t\tfor(int j = i; j <= n; ++j)\n\t\t\t\tdp[i][j] = dp[i+1][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(dp[1][i])\n\t\t{\n\t\t\tused[pa[i]] = 1;\n\t\t\tused[pb[i]] = 1;\t\n\t\t}\n\tfor(int i = 1; i <= (n << 1); ++i)\n\t\tif(used[i])\n\t\t\tprintf(\"%c\", s[i]);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define for1(a,b,i) for(int i=a;i<=b;++i)\n#define FOR2(a,b,i) for(int i=a;i>=b;--i)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tint f=1,sum=0;\n\tchar x=getchar();\n\tfor(;(x<'0'||x>'9');x=getchar()) if(x=='-') f=-1;\n\tfor(;x>='0'&&x<='9';x=getchar()) sum=sum*10+x-'0';\n\treturn f*sum;\n}\n\n#define N 10000\n#define M 1000005\nint n;\nchar s[M];\nint be[M],f[M],buc[M];\nint id[M],Max[M],pos[M],nxt[M],sum[M],L[M],R[M];\n\ninline bool check(int x,int xr,int y,int yr) {\n\tint len=min(xr-x,yr-y);\n\tfor1(0,len,i)\n\t\tif(s[x+i]!=s[y+i]) return s[x+i]<s[y+i];\n\treturn xr-x<=yr-y;\n}\n\ninline bool check_Max(int x,int y) {\n\tif(f[x]<N&&f[y]>N) return 0;\n\tif(f[x]>N&&f[y]<N) return 1;\n\tif(f[x]<N) return f[x]>=f[y];\n\tif(f[x]/N>f[y]/N||(f[x]/N==f[y]/N&&check(f[y]%N,R[y],f[x]%N,R[x]))) return 1;\n\treturn 0;\n}\n\nint main() {\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"mine.out\",\"w\",stdout);\n\tn=read()*2;\n\tscanf(\"%s\",s+1);\n\tint shu=0;\n\tfor1(1,n,i) {\n\t\tif(!shu) be[i]=++be[0];\n\t\telse     be[i]=be[i-1];\n\t\tshu+=('a'==s[i])-('b'==s[i]);\n\t}\n\tfor1(1,n,i) R[be[i]]=i;\n\tFOR2(n,1,i) L[be[i]]=i;\n\t\n\tfor(int l=1,r;l<=n;l=r+1) {\n\t\tr=l;\n\t\twhile (be[r+1]==be[l]) ++r;\n\t\tif(s[l]=='a') {\n\t\t\t//怎么都没想到这里错啊，太马虎了\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='a') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tint now=l;\n\t\t\twhile (1) {\n\t\t\t\t++f[be[l]];\n\t\t\t\tnow=pos[now]+1;\n\t\t\t\twhile (now<=r&&s[now]!='a') ++now;\n\t\t\t\tif(now>r) break;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tsum[l-1]=0;\n\t\t\tfor1(l,r,i) sum[i]=sum[i-1]+(s[i]=='b');\n\t\t\tint h=1,t=0;\n\t\t\tfor1(l,r,i) \n\t\t\t\tif(s[i]=='b') buc[++t]=i;\n\t\t\t\telse pos[buc[h++]]=i;\n\t\t\tFOR2(r,l,i)\n\t\t\t\tif(s[i]=='b') nxt[i]=nxt[i+1];\n\t\t\t\telse nxt[i]=i;\n\t\t\tint pre=sum[pos[l]],id=pos[l];\n\t\t\tfor1(l,r-1,i) if(s[i]=='b') {\n\t\t\t\tint x[2]={sum[pos[i]]-sum[i],pos[i]+1};\n\t\t\t\tx[0]+=nxt[x[1]]-x[1];\n\t\t\t\tx[1]=nxt[x[1]];\n\t\t\t\tif(x[0]>pre||(x[0]==pre&&check(id,r,x[1],r))) pre=x[0],id=x[1];\n\t\t\t}\n\t\t\tf[be[l]]=pre*N+id;\n\t\t}\n\t}\n\t\n\t//abab是累加，不能比较字典序。。\n\tFOR2(be[0],1,i) {\n\t\tMax[i]=Max[i+1];\n\t\tif(f[i]>N&&check_Max(i,Max[i])) Max[i]=i;\n\t}\n\t//for1(1,be[0],i) cout<<f[be[i]]<<\" \"; cout<<endl;\n\tfor1(1,be[0],i) if(!Max[i]) Max[i]=i;\n\tint pos=0;\n\twhile (1) {\n\t\tpos=Max[pos+1];\n\t\tif(f[pos]>N) {\n\t\t\tFOR2(f[pos]/N,1,i) putchar('b');\n\t\t\tfor1(f[pos]%N,R[pos],i) putchar(s[i]);\n\t\t}\n\t\telse {\n\t\t\tfor1(1,f[pos],i) putchar('a'),putchar('b');\n\t\t}\n\t\tif(pos==be[0]) break;\n\t}\n\tputs(\"\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<set>\n#include<stack>\n#include<bitset>\n#include<functional>\n#include<ctime>\n#include<queue>\n#include<deque>\n#include<complex>\n#include<cassert>\nusing namespace std;\n#define pb push_back\n#define pf push_front\ntypedef long long lint;\ntypedef complex<double> P;\n#define mp make_pair\n#define fi first\n#define se second\ntypedef pair<int,int> pint;\n#define All(s) s.begin(),s.end()\n#define rAll(s) s.rbegin(),s.rend()\n#define REP(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,n) REP(i,0,n)\n//問題文および制約はちゃんと確認しよう！\n//サイズは10^5じゃなくて2×10^5とかかもしれないし、重要な制約・条件を見落としているかも\n//とりあえずサンプルを読んでから解法を考えよう？\nint a[3010],b[3010];\nstring s;int n;\nvector<int> v;\nint bo=0;\nvector<int> out;\nint ok(){\n\tREP(i,bo,n){\n\t\tint f=0,su=0;\n\t\trep(j,v.size()){\n\t\t\tsu+=v[j];\n\t\t\tif(!(i+su-1<n && i+j<n && b[i+su-1]<a[i+j])) f=1;\n\t\t}\n\t\tif(f==0) return i;\n\t}\n\treturn -1;\n}\nint bs(int p){\n\tint lo=0,hi=n;\n\twhile(hi>lo){\n\t\tint mi=(hi+lo+1)/2;\n\t\tv[p]=mi;\n\t\tif(ok()>=0) lo=mi;else hi=mi-1;\n\t}\n}\nvoid cal(){\n\t//cout<<bo<<endl;\n\tif(bo>=n) return;\n\tv.clear();v.pb(0);\n\tint num=bs(0);\n\t//cout<<num<<endl;\n\tif(num==0){\n\t\tout.pb(bo);int nb=bo+1;\n\t\twhile(nb<n && b[bo]>a[nb]) nb++;\n\t\tbo=nb;\n\t\tcal();\n\t\treturn;\n\t}\n\tv.clear();rep(i,num) v.pb(0);v[0]=num;\n\tREP(i,1,num) v[i]=bs(i);\n\tint p=ok();\n\tassert(p>=0);\n\t//cout<<'p'<<p<<endl;\n\tint len=0;rep(i,num) len+=v[i];\n\trep(i,len) out.pb(i+p);\n\tbo=p+len;\n\tcal();\n}\nint main()\n{\n\tcin>>n;cin>>s;\n\tint an=0,bn=0;\n\trep(i,n*2){\n\t\tif(s[i]=='a') a[an++]=i;else b[bn++]=i;\n\t}\n\tcal();\n\tvector<int> p;\n\trep(i,out.size()) p.pb(a[out[i]]),p.pb(b[out[i]]);\n\tsort(All(p));\n\tstring ret=\"\";\n\trep(i,p.size()) ret+=s[p[i]];\n\tcout<<ret<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint n;\nchar str[6010];\nstring ans[3010];\nint occur_a[3010], occur_b[3010], pos[6010];\n\nint main() {\n\tscanf(\"%d%s\", &n, str + 1);\n\tint top_a = 0, top_b = 0;\n\tfor (int i = 1; i <= n * 2; ++i) {\n\t\tif (str[i] == 'a') {\n\t\t\toccur_a[++top_a] = i;\n\t\t\tpos[i] = top_a;\n\t\t} else {\n\t\t\toccur_b[++top_b] = i;\n\t\t\tpos[i] = top_b;\n\t\t}\n\t}\n\tstring result;\n\t\n\tfor (int i = n; i >= 1; --i) {\n\t\tif (occur_a[i] < occur_b[i]) {\n\t\t\tint k = i;\n\t\t\tfor (int j = occur_a[i] + 1; j < occur_b[i]; ++j) k = max(k, pos[j]);\n\t\t\tans[i] = \"ab\" + ans[k + 1];\n\t\t} else {\n\t\t\tint k = i;\n\t\t\twhile (k < n && occur_b[k + 1] < occur_a[k]) ++k;\n\t\t\tfor (int j = occur_b[i]; j <= 2 * n; ++j)\n\t\t\t\tif (pos[j] >= i && pos[j] <= k) ans[i] += str[j];\n\t\t\tans[i] += ans[k + 1];\n\t\t}\n\t\tans[i] = max(ans[i], ans[i + 1]);\n\t\tresult = max(result, ans[i]);\n\t}\n\t\n\tcout << result << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,a,n) for (int i=a;i<n;i++)\n#define per(i,a,n) for (int i=n-1;i>=a;i--)\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\ntypedef vector<int> VI;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst ll mod=1000000007;\nll powmod(ll a,ll b) {ll res=1;a%=mod; assert(b>=0); for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}\nll gcd(ll a,ll b) { return b?gcd(b,a%b):a;}\n// head\n\nconst int N=6010;\nstring dp[N];\nint mark[N],op[N],sel[N];\nstring solve(string s) {\n\tint n=SZ(s)/2;\n\trep(i,0,2*n) mark[i]=0;\n\tint r=0;\n\trep(i,0,2*n) if (!mark[i]) {\n\t\tmark[i]=1;\n\t\twhile (r<2*n&&(mark[r]||s[i]==s[r])) ++r;\n\t\tmark[r]=2;\n\t\top[i]=r;\n\t\top[r]=i;\n\t}\n\tdp[2*n]=\"\";\n\tper(i,0,2*n) {\n\t\tdp[i]=dp[i+1];\n\t\tif (mark[i]!=1) continue;\n\t\tif (s[i]=='a') {\n\t\t\tdp[i]=max(dp[i],\"ab\"+dp[op[i]+1]);\n\t\t\tcontinue;\n\t\t}\n\t\trep(j,0,2*n) sel[j]=0;\n\t\tsel[i]=1; sel[op[i]]=1;\n\t\tint mr=op[i];\n\t\tstring tmp;\n\t\tfor (int j=i;j<2*n;j++) {\n\t\t\tif (j<mr&&mark[j]==1&&s[j]=='b') {\n\t\t\t\tmr=op[j];\n\t\t\t\tsel[j]=sel[op[j]]=1;\n\t\t\t}\n\t\t\tif (sel[j]) tmp.pb(s[j]);\n\t\t}\n\t\tdp[i]=max(dp[i],tmp+dp[mr+1]);\n\t\tfor (int j=2*n-1;j>=i;j--) if (mark[j]==1&&!sel[j]) {\n\t\t\tsel[j]=sel[op[j]]=1; break;\n\t\t}\n\t\ttmp.clear();\n\t\tfor (int j=i;j<2*n;j++) if (sel[j]) tmp.pb(s[j]);\n\t\tdp[i]=max(dp[i],tmp);\n\t}\n\treturn dp[0];\n}\nstring bf(string s) {\n\tint n=SZ(s)/2;\n\trep(i,0,2*n) mark[i]=0;\n\tint r=0;\n\tVI pos;\n\trep(i,0,2*n) if (!mark[i]) {\n\t\tmark[i]=1;\n\t\tpos.pb(i);\n\t\twhile (r<2*n&&(mark[r]||s[i]==s[r])) ++r;\n\t\tmark[r]=2;\n\t\top[i]=r;\n\t\top[r]=i;\n\t}\n\tstring ans;\n\trep(S,0,(1<<n)) {\n\t\tstring tmp;\n\t\trep(i,0,2*n) sel[i]=0;\n\t\trep(i,0,n) if (S&(1<<i)) sel[pos[i]]=sel[op[pos[i]]]=1;\n\t\trep(i,0,2*n) if (sel[i]) tmp.pb(s[i]);\n\t\tans=max(ans,tmp);\n\t}\n\treturn ans;\n}\n\nint main() {\n\tscanf(\"%*d\");\n\tstring s;\n\tcin>>s;\n\tcout<<solve(s)<<endl;\n/*\n\twhile (1) {\n\t\tint n=rand()%10+1;\n\t\tstring s;\n\t\trep(j,0,n) s.pb('a'),s.pb('b');\n\t\trandom_shuffle(all(s));\n\t\tcout<<s<<endl;\n\t\tassert(solve(s)==bf(s));\n\t}*/\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize (\"O3\")\n#pragma GCC target (\"sse4\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\ntemplate <class T> using Tree = tree<T, null_type, less<T>, rb_tree_tag,tree_order_statistics_node_update>;\nusing namespace std;\n/***********************************************/\n/* Dear online judge:\n * I've read the problem, and tried to solve it.\n * Even if you don't accept my solution, you should respect my effort.\n * I hope my code compiles and gets accepted.\n *  ___  __     _______    _______      \n * |\\  \\|\\  \\  |\\  ___ \\  |\\  ___ \\     \n * \\ \\  \\/  /|_\\ \\   __/| \\ \\   __/|    \n *  \\ \\   ___  \\\\ \\  \\_|/__\\ \\  \\_|/__  \n *   \\ \\  \\\\ \\  \\\\ \\  \\_|\\ \\\\ \\  \\_|\\ \\ \n *    \\ \\__\\\\ \\__\\\\ \\_______\\\\ \\_______\\\n *     \\|__| \\|__| \\|_______| \\|_______|\n */\nconst long long mod = 1000000007;\n\nint main(int argc,char** argv) {\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\n\tint N;\n\tstring s;\n\tcin>>N>>s;\n\tN <<= 1;\n\tvector<string> in;\n\tfor(int i = 0;i < N;) {\n\t\tint j = i;\n\t\tstring to = \"\";\n\t\tint cura = 0,curb = 0;\n\t\twhile(j < N) {\n\t\t\tif((curb + (s[j] == 'b')) != (cura + (s[j] == 'a')))\n\t\t\t\tif(((curb + (s[j] == 'b')) > (cura + (s[j] == 'a'))) != (s[i] == 'b')) \n\t\t\t\t\tbreak;\n\t\t\tto += s[j];\n\t\t\tcurb += s[j] == 'b';\n\t\t\tcura += s[j] == 'a';\n\t\t\tj++;\n\t\t}\n\t\tif(s[i] == 'a') {\n\t\t\tstring o = to;\n\t\t\tto = \"\";\n\t\t\tfor(int k = 0;k < (int)o.size();k++) {\n\t\t\t\tif(to.empty() || to.back() != o[k]) to += o[k];\n\t\t\t}\n\t\t} else {\n\t\t\tint cnt = 0;\n\t\t\tfor(int k = i+1;k < j;k++) {\n\t\t\t\tcnt += (s[k-1] == 'b'?1:-1);\n\t\t\t\tif(s[k] != 'b') continue;\n\t\t\t\tstring cur = \"\";\n\t\t\t\tint curcnt = cnt;\n\t\t\t\tfor(int z = k;z < j;z++) {\n\t\t\t\t\tif(s[z] == 'a' && curcnt > 0) continue;\n\t\t\t\t\tcur += s[z];\n\t\t\t\t\tif(s[z] == 'b') curcnt--;\n\t\t\t\t}\n\t\t\t\tto = max(to,cur);\n\t\t\t}\n\t\t}\n\t\tin.push_back(to);\n\t\ti = j;\n\t}\n\tstring res = \"\";\n\tfor(int i = in.size()-1;i >= 0;i--) {\n//\t\tcerr<<in[i]<<'\\n';\n\t\tif(in[i] >= res.substr(0,in[i].size())) res = in[i] + res;\n\t}\n\tcout<<res<<'\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint N;\nstring S;\n\nstring subSolve(const string &s) {\n    if (s[0] == 'a') {\n        string res = \"\";\n        int prev_a = -1;\n        int a_num = 0, b_num = 0;\n        bool search_a = true;\n        for (int i = 0; i < s.size(); ++i) {\n            if (s[i] == 'a') {\n                if (search_a) {\n                    res += \"a\";\n                    prev_a = a_num;\n                    search_a = false;\n                }\n                ++a_num;\n            }\n            else {\n                if (!search_a) {\n                    if (b_num == prev_a) {\n                        res += \"b\";\n                        search_a = true;\n                    }\n                }\n                ++b_num;\n            }\n        }\n        return res;\n    }\n    else {\n        string res = \"\";\n        for (int i = 0; i*2 < s.size(); ++i) {\n            string tmp = \"\";\n            int a_num = 0, b_num = 0;\n            for (int j = 0; j < s.size(); ++j) {\n                if (s[j] == 'a') {\n                    if (a_num >= i) tmp += s[j];\n                    ++a_num;\n                }\n                else {\n                    if (b_num >= i) tmp += s[j];\n                    ++b_num;\n                }\n            }\n            res = max(res, tmp);\n        }\n        return res;\n    }\n}\n\nint main() {\n    cin >> N >> S;\n    int iter = 0;\n    vector<string> vec;\n    string tmp = \"\";\n    bool exist = false;\n    for (int i = (int)S.size()-1; i >= 0; --i) {\n        tmp += S[i];\n        if (S[i] == 'a') ++iter;\n        else --iter;\n        if (iter == 0) {\n            reverse(tmp.begin(), tmp.end());\n            if (tmp[0] == 'a' && exist) { tmp = \"\"; continue; }\n            if (tmp[0] == 'b') exist = true;\n            string ma = subSolve(tmp);\n            vec.push_back(ma);\n            tmp = \"\";\n        }\n    }\n    \n    vector<string> dp; dp.assign(N+1, \"\");\n    for (int i = 0; i < vec.size(); ++i) {\n        dp[i+1] = max(dp[i+1], dp[i]);\n        dp[i+1] = max(dp[i+1], vec[i] +dp[i]);\n    }\n    cout << dp[vec.size()] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using gpp_set = tree<T, null_type, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T, typename L> using gpp_map = tree<T, L, less<T>, rb_tree_tag, tree_order_statistics_node_update>;\ntemplate<typename T> using gpp_multiset = tree<T, null_type, less_equal<T>, rb_tree_tag, tree_order_statistics_node_update>;*/\nstruct fast_ios { fast_ios(){ cin.tie(0); ios::sync_with_stdio(false); cout << fixed << setprecision(20); }; } fast_ios_;\n#define FOR(i, begin, end) for(int i=(begin);i<(end);i++)\n#define REP(i, n) FOR(i,0,n)\n#define IFOR(i, begin, end) for(int i=(end)-1;i>=(begin);i--)\n#define IREP(i, n) IFOR(i,0,n)\n#define Sort(v) sort(v.begin(), v.end())\n#define Reverse(v) reverse(v.begin(), v.end())\n#define all(v) v.begin(),v.end()\n#define SZ(v) ((int)v.size())\n#define Lower_bound(v, x) distance(v.begin(), lower_bound(v.begin(), v.end(), x))\n#define Upper_bound(v, x) distance(v.begin(), upper_bound(v.begin(), v.end(), x))\n#define Max(a, b) a = max(a, b)\n#define Min(a, b) a = min(a, b)\n#define bit(n) (1LL<<(n))\n#define bit_exist(x, n) ((x >> n) & 1)\n#define debug(x) cout << #x << \"=\" << x << endl;\n#define vdebug(v) cout << #v << \"=\" << endl; REP(i_debug, v.size()){ cout << v[i_debug] << \",\"; } cout << endl;\n#define mdebug(m) cout << #m << \"=\" << endl; REP(i_debug, m.size()){ REP(j_debug, m[i_debug].size()){ cout << m[i_debug][j_debug] << \",\"; } cout << endl;}\n#define pb push_back\n#define f first\n#define s second\n#define int long long\n#define INF 1000000000000000000\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v){ for (auto &x : v) is >> x; return is; }\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &v){ for(int i = 0; i < v.size(); i++) { cout << v[i]; if(i != v.size() - 1) cout << endl; }; return os; }\ntemplate<typename T> void Out(T x) { cout << x << endl; }\ntemplate<typename T1, typename T2> void Ans(bool f, T1 y, T2 n) { if(f) Out(y); else Out(n); }\n\nusing vec = vector<int>;\nusing mat = vector<vec>;\nusing Pii = pair<int, int>;\nusing PiP = pair<int, Pii>;\nusing PPi = pair<Pii, int>;\nusing bools = vector<bool>;\nusing pairs = vector<Pii>;\n\n//int dx[4] = {1,0,-1,0};\n//int dy[4] = {0,1,0,-1};\n//char d[4] = {'D','R','U','L'};\n\nconst int mod = 1000000007;\n//const int mod = 998244353;\n//#define Add(x, y) x = (x + (y)) % mod\n//#define Mult(x, y) x = (x * (y)) % mod\n\nvoid add_a(string &S, int i0, int i1, vector<string> &v){\n    \n    vec id_B, next(i1 - i0 + 1);\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') id_B.pb(i);\n    }\n    int na = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'a'){\n            next[i - i0] = id_B[na];\n            na++;\n        }\n    }\n    string x = \"\";\n    int i = i0;\n    while(i <= i1){\n        if(S[i] == 'a'){\n            i = next[i - i0] + 1;\n            x += \"ab\";\n        }else i++;\n    }\n\n    if(SZ(v) > 0 && v.back()[0] == 'a') v.back() += x;\n    else v.pb(x);\n}\n\nvoid add_b(string &S, int i0, int i1, vector<string> &v){\n    string x = \"\";\n    int now = 0;\n    FOR(i, i0, i1 + 1){\n        if(S[i] == 'b') now++;\n\n        else now--;\n\n        Max(x, string(now, 'b') + S.substr(i + 1, i1 - i));\n    }\n    v.pb(x);\n}\n\nsigned main(){\n\n    int N; cin >> N;\n    string S; cin >> S;\n\n    vector<string> v;\n    int now = 0, i0 = 0;\n    REP(i, 2 * N){\n        if(S[i] == 'b') now++;\n        else now--;\n\n        if(now == 0){\n            if(S[i0] == 'a') add_a(S, i0, i, v);\n            else add_b(S, i0, i, v);\n            i0 = i + 1;\n        }\n    }\n    //vdebug(v);\n\n    vector<string> ans;\n    for(string x: v){\n        while(SZ(ans) > 0 && ans.back() < x) ans.pop_back();\n        ans.pb(x);\n    }\n    for(string x: ans) cout << x;\n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <queue>\n#include <map>\n#include <string.h>\n#include <math.h>\n#include <stdio.h>\n#include <deque>\n#include <bits/stdc++.h>\n//#include \"D:\\C++\\test_lib_projects\\testlib.h\"\nusing namespace std;\n#define ll long long\n#define pii pair<int,int>\n#define qi ios::sync_with_stdio(0)\n\nbool debug=true;\n\n/*    *************************************\n\t  * Written in New Computer           *\n\t  * The following code belongs to     *\n\t  * XiaoGeNintendo of HellHoleStudios *\n\t  *************************************\n\t  \n\t  Solution Idea From MonkeyKing(chinauser)\n*/\ntemplate<typename T1,typename T2>ostream& operator<<(ostream& os,pair<T1,T2> ptt){\n\tos<<ptt.first<<\",\"<<ptt.second;\n\treturn os;\n}\ntemplate<typename T>ostream& operator<<(ostream& os,vector<T> vt){\n\tos<<\"{\";\n\tfor(int i=0;i<vt.size();i++){\n\t\tos<<vt[i]<<\" \";\n\t}\n\tos<<\"}\";\n\treturn os;\n}\n\nint n;\nstring s;\n\nvector<string> parts;\n\nbool poss[4000];\nvoid solve(int l,int r){\n\tif(s[l]=='a'){\n\t\t\n\t\tstring ans;\n\t\t\n\t\tint a=0,b=0,c=0; \n\t\tfor(int i=l;i<=r;i++){\n\t\t\tif(s[i]=='a'){\n\t\t\t\ta++;\n\t\t\t}else{\n\t\t\t\tb++;\n\t\t\t}\n\t\t\tif(b>c){\n\t\t\t\tc=a;\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t\t}\n\t\t\n\t\tparts.push_back(ans);\n\t}else{\n\t\tvector<string> all;\n\t\tfor(int i=l;i<=r;i++){\n\t\t\tposs[i]=true;\n\t\t}\n\t\t\n\t\tfor(int i=0;i<(r-l+1)/2;i++){\n\t\t\tstring t=\"\";\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(poss[j]){\n\t\t\t\t\tt+=s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tall.push_back(t);\n\t\t\t\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(s[j]=='a' && poss[j]){\n\t\t\t\t\tposs[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=l;j<=r;j++){\n\t\t\t\tif(s[j]=='b' && poss[j]){\n\t\t\t\t\tposs[j]=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tsort(all.begin(),all.end());\n\t\tparts.push_back(all.back());\n\t}\n}\nint main(int argc,char* argv[]){\n\tcin>>n>>s;\n\tn*=2;\n\t\n\tint delta=0,last=0;\n\t\n\tfor(int i=0;i<n;i++){\n\t\tif(s[i]=='a'){\n\t\t\tdelta++;\n\t\t}else{\n\t\t\tdelta--;\n\t\t}\n\t\tif(delta==0){\n\t\t\tsolve(last,i);\n\t\t\tlast=i+1;\n\t\t}\n\t}\n\t\n\tstring ans=parts.back();\n\tfor(int i=parts.size()-2;i>=0;i--){\n\t\tbool ok=false;\n\t\tfor(int j=0;j<min(ans.size(),parts[i].size());j++){\n\t\t\tif(parts[i][j]!=ans[j]){\n\t\t\t\tif(parts[i][j]<ans[j]){\n\t\t\t\t\tok=true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(ok){\n\t\t\tans=parts[i]+ans;\t\n\t\t}\n\t}\n\t\n\tcout<<ans;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// warm heart, wagging tail,and a smile just for you!\n//                                                                     ███████████\n//                                                                   ███╬╬╬╬╬╬╬╬╬╬███\n//                                                                ███╬╬╬╬╬████╬╬╬╬╬╬███\n//                                            ███████████       ██╬╬╬╬╬████╬╬████╬╬╬╬╬██\n//                                      █████████╬╬╬╬╬████████████╬╬╬╬╬██╬╬╬╬╬╬███╬╬╬╬╬██\n//                               ████████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬██╬╬╬╬╬╬╬██\n//                             ████╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████████╬╬╬╬╬╬╬╬╬╬╬██\n//                           ███╬╬╬█╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬███╬╬╬╬╬╬╬█████\n//                         ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬████████╬╬╬╬╬██\n//                       ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬╬╬╬╬███\n//                     ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬██\n//                 ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬████\n//     █████████████╬╬╬╬╬╬╬╬██╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬██████\n//   ████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬██████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████╬╬╬╬╬╬╬███████████╬╬╬╬╬╬╬╬██╬╬╬██╬╬╬██\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████╬╬╬╬╬╬╬╬╬╬╬█╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬██\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬▓▓▓▓▓▓╬╬╬████╬╬████╬╬╬╬╬╬╬▓▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬███\n// ██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██████▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓▓▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██╬╬╬╬█████\n// ███╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████████\n//   ███╬╬╬╬╬╬╬╬╬╬╬╬╬█████╬╬╬╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬███╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n//       ██████████████  ████╬╬╬╬╬╬███████████████████████████╬╬╬╬╬██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬████\n//                         ███████                           █████  ███████████████████  \n//\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define INF (1<<30)\n#define LINF (1LL<<60)\n#define fs first\n#define sc second\n#define int long long\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define RFOR(i,a,b) for(int i = (b-1);i>=(a);--i)\n#define REP(i,n)  FOR(i,0,(n))\n#define RREP(i,n) RFOR(i,0,(n))\n#define ITR(itr,mp) for(auto itr = (mp).begin(); itr != (mp).end(); ++itr)\n#define RITR(itr,mp) for(auto itr = (mp).rbegin(); itr != (mp).rend(); ++itr)\n#define range(i,a,b) ((a)<=(i) && (i)<(b))\n#define debug(x)  cout << #x << \" = \" << (x) << endl\n#define SP << \" \" << \ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){if(a>b) {a=b; return true;} else return false;}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){if(a<b) {a=b; return true;} else return false;}\n#define MSB(x) (63-__builtin_clzll(x))\n#define pcnt(x) (__builtin_popcountll(x))\n#define parity(i,j) (i&(1LL<<j))\ntypedef pair<int,int> P;\ntypedef tuple<int,int,int> T;\ntypedef vector<int> vec;\ntypedef vector<vector<int>> mat;\n\nstring S;\nstring f(int l, int r){\n  string res;\n  if(S[l]=='a'){\n    bool flag = false;\n    FOR(i,l,r){\n      if(flag^(S[i]=='a')) res += S[i], flag = !flag;\n    }\n  }\n  else{\n    vector<int> flag(S.size(),0);\n    res = S.substr(l,r-l);\n    int cnt = 0;\n    FOR(i,l,r){\n      if(S[i]=='a') continue;\n      cnt++;\n      string tmp; int a = 0, b = 0;\n      FOR(j,l,r){\n        if(S[j]=='a'){\n          a++;\n          if(a > cnt) tmp += \"a\";\n        }\n        else{\n          b++;\n          if(b > cnt) tmp += \"b\";\n        }\n      }\n      chmax(res,tmp);\n    }\n  }\n  return res;\n}\n\nvoid solve(){\n  int N;\n  cin >> N >> S;\n\n  vec a = {0};\n  int now = 0;\n  REP(i,2*N){\n    if(S[i]=='a') now++;\n    else now--;\n    if(!now) a.push_back(i+1);\n  }\n\n  vector<string> s;\n  REP(i,a.size()-1) s.push_back(f(a[i],a[i+1]));\n\n  vector<string> dp(s.size()+1);\n  RREP(i,s.size()){\n    dp[i] = s[i];\n    FOR(j,i+1,s.size()+1){\n      chmax(dp[i],s[i]+dp[j]);\n    }\n  }\n\n  cout << dp[0] << endl;\n\n}\n\nsigned main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int T = 1;\n  // cin >> T;\n\n  while(T--) solve();\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LOG(FMT...) fprintf(stderr, FMT)\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\n\n// mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n\ntemplate <class T>\nistream& operator>>(istream& is, vector<T>& v) {\n  for (T& x : v)\n    is >> x;\n  return is;\n}\n\nostream& operator<<(ostream& os, const pair<char, int>& unit) {\n  return os << unit.first << \"^\" << unit.second;\n}\n\ntemplate <class T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n  if (!v.empty()) {\n    os << v.front();\n    for (int i = 1; i < v.size(); ++i)\n      os << ' ' << v[i];\n  }\n  return os;\n}\n\nstring naive(string ba) {\n  string ret = ba;\n  while (!ba.empty()) {\n    ba.erase(0, 1);\n    ba.erase(ba.find_first_of('a'), 1);\n    ret = max(ret, ba);\n  }\n  return ret;\n}\n\nint main() {\n#ifdef LBT\n  freopen(\"test.in\", \"r\", stdin);\n  int nol_cl = clock();\n#endif\n  ios::sync_with_stdio(false);\n  cin.tie(nullptr);\n  \n  int n;\n  string s;\n  cin >> n >> s;\n  vector<int> pre(n * 2);\n  int cur = 0;\n  for (int i = 0; i < n * 2; ++i) {\n    if (s[i] == 'a') ++cur;\n    else --cur;\n    pre[i] = cur;\n  }\n  string ans;\n  vector<string> stk;\n  int last = 0;\n  for (int i = 0; i < n * 2; i += 2) {\n    if (pre[i] < 0) {\n      int r = find(pre.begin() + i, pre.end(), 0) - pre.begin();\n      last = r + 1;\n      string res = naive(string(s.begin() + i, s.begin() + last));\n      while (!stk.empty() && stk.back() < res)\n        stk.pop_back();\n      stk.push_back(res);\n      i = r - 1;\n    }\n  }\n  for (const auto& str : stk)\n    ans += str;\n  bool f = false;\n  for (int i = last; i < n * 2; ++i) {\n    if (s[i] == 'a' && !f) {\n      f = true;\n      ans.push_back('a');\n    } else if (s[i] == 'b' && f) {\n      f = false;\n      ans.push_back('b');\n    }\n  }\n  cout << ans;\n\n#ifdef LBT\n  LOG(\"Time: %dms\\n\", int ((clock()\n          -nol_cl) / (double)CLOCKS_PER_SEC * 1000));\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <random>\n#include <set>\n#include <sstream>\n#include <string>\n#include <utility>\n#include <vector>\n\nconst int DEBUG = 0;\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n#define DEBUGP(val) cerr << #val << \"=\" << val << \"\\n\"\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\nconst ll mod = 1e9 + 7;\n\nstring compact_pos(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  int delta = 0;\n  string cur;\n  REP(i, 0, n + 1) {\n    ma = max(ma, cur + s.substr(i));\n    if (i == n) break;\n    if (cur.size() > 0){\n      if (cur[cur.size() - 1] == 'a' && s[i] == 'b') {\n\tassert (delta > 0);\n\tcur = string(delta, 'b');\n      }\n    }\n      cur += s[i];\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) {\n      return ma;\n    }\n  }\n  return ma;\n}\n\nstring compact_neg(string s) {\n  int n = s.length();\n  string ma = \"TAPRIS\";\n  string cur;\n  REP(i, 0, n + 1) {\n    if (i == n - 1 || (s[i - 1] == 'b' && s[i] == 'a')) {\n      cur += \"ab\";\n    }\n  }\n  return cur;\n}\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  string s;\n  cin >> n >> s;\n  vector<string> cand;\n  string ma = \"TAPRIS\";\n  string cur;\n  string aux;\n  int delta = 0;\n  VI zeros(1, 0);\n  REP(i, 0, 2 * n) {\n    delta += s[i] == 'b' ? 1 : -1;\n    if (delta == 0) zeros.push_back(i + 1);\n  }\n  bool ba = 1;\n  REP(i, 0, zeros.size() - 1) {\n    int ta = zeros[i];\n    int tb = zeros[i + 1];\n    string u = s.substr(ta, tb - ta);\n    cand.push_back(u[0] == 'a' ? compact_neg(u) : compact_pos(u));\n  }\n  if (DEBUG) {\n    REP(i, 0, cand.size()) {\n      DEBUGP(cand[i]);\n    }\n  }\n  ma = \"\";\n  for (int i = (int)cand.size() - 1; i >= 0; --i) {\n    ma = max(ma, cand[i] + ma);\n  }\n  cout << ma << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\n#include<cassert>\nusing namespace std;\n\n//#define int long long\ntypedef long long ll;\n\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef pair<ll, ll> LP;\ntypedef vector<ll> vec;\ntypedef long double ld;\ntypedef pair<ld, ld> LDP;\nconst ld eps = 1e-5;\n\nbool used[6000];\n\nint loc[6000];\nint va[3000];\nint vb[3000];\n\nvector<int> z[6000];\ntypedef bitset<6000> bt;\nbt bz[6000];\nint n; string s;\n\nbool chked[6000];\nbt ans[6001];\nbool valid[6000];\n\nstring trans(bt &b) {\n\tstring ret;\n\trep(i, 2 * n) {\n\t\tif (b[i]) {\n\t\t\tret.push_back(s[i]);\n\t\t}\n\t}\n\treturn ret;\n}\nint fre(int i) {\n\tint id = loc[i];\n\tif (s[i] == 'a')return vb[id];\n\telse return va[id];\n}\n\nvoid dfs(int le) {\n\tif (le == 2 * n)return;\n\tif (chked[le])return;\n\tchked[le] = true;\n\tint len = 0;\n\tRep(i, le, 2 * n) {\n\t\tlen = max(len, (int)z[i].size());\n\t}\n\tif (len == 0) {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (fre(i)>i) {\n\t\t\t\tint to = i + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = ans[to];\n\t\t\t\tnex[i] = 1; nex[fre(i)] = 1;\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn;\n\n\n\t}\n\telse {\n\t\tstring ma = \"\";\n\t\tRep(i, le, 2 * n) {\n\t\t\tif (z[i].size() == len) {\n\t\t\t\tint to = z[i].back() + 1;\n\t\t\t\twhile (to < 2 * n && fre(to)<to)to++;\n\t\t\t\tdfs(to);\n\t\t\t\tbt nex = bz[i]|ans[to];\n\t\t\t\tstring snex = trans(nex);\n\t\t\t\tif (ma < snex) {\n\t\t\t\t\tma = snex;\n\t\t\t\t\tans[le] = nex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//cout << le << \" \" << trans(ans[le]) << endl;\n}\nvoid solve(){\n\tcin >> n >> s;\n\tint c[2] = {};\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'a') {\n\t\t\tva[c[0]] = i;\n\t\t\tloc[i] = c[0];\n\t\t\tc[0]++;\n\t\t}\n\t\telse {\n\t\t\tvb[c[1]] = i;\n\t\t\tloc[i] = c[1];\n\t\t\tc[1]++;\n\t\t}\n\t}\n\tfill(valid, valid + 2 * n, true);\n\trep(i, 2 * n) {\n\t\tint id = loc[i];\n\t\tif (s[i] == 'a') {\n\t\t\tif (vb[id] < i)valid[i] = false;\n\t\t}\n\t\telse {\n\t\t\tif (va[id] < i)valid[i] = false;\n\t\t}\n\t}\n\trep(i, 2 * n) {\n\t\tif (s[i] == 'b') {\n\t\t\tint id = loc[i];\n\t\t\tif (va[id] > i) {\n\t\t\t\tz[i].push_back(i);\n\t\t\t\tbz[i][i] = 1;\n\t\t\t\tbz[i][va[loc[i]]] = 1;\n\t\t\t\tint ri = va[id];\n\t\t\t\tRep(j, i + 1, ri) {\n\t\t\t\t\tif (s[j] == 'b') {\n\t\t\t\t\t\tint iid = loc[j];\n\t\t\t\t\t\tif (va[iid] > j) {\n\t\t\t\t\t\t\tz[i].push_back(j);\n\t\t\t\t\t\t\tbz[i][j] = 1;\n\t\t\t\t\t\t\tbz[i][va[loc[j]]] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(0);\n\tcout << trans(ans[0]) << endl;\n}\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(5);\n\t//init();\n\tsolve();\n\n\t//cout << \"finish\" << endl;\n\t//stop\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint A[3010],B[3010];\nchar str[6010];\nstring getans(int l,int r)\n{\n\tstring ans=\"\";\n\tif(A[l]<B[l])\n\t{\n\t\tint now=0;\n\t\tfor(int i=l;i<=r;i++)\n\t\t\tif(A[i]>now){\n\t\t\t\tnow=B[i];\n\t\t\t\tans+=\"ab\";\n\t\t\t}\n\t}\n\telse{\n\t\tint L=B[l],R=A[r];\n\t\tfor(int i=1;i<=r-l+1;i++)\n\t\t{\n\t\t\tint nowa=i,nowb=i;\n\t\t\tstring cur=\"\";\n\t\t\tfor(int j=R;j>=L;j--)\n\t\t\t{\n\t\t\t\tif(str[j]=='a'&&nowa>0)nowa--,cur+='a';\n\t\t\t\tif(str[j]=='b'&&nowb>0)nowb--,cur+='b';\n\t\t\t}\n\t\t\treverse(cur.begin(),cur.end());\n\t\t\tans=max(ans,cur);\n\t\t}\n\t}\n\treturn ans;\n}\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",str+1);\n\tint nowa=0,nowb=0;\n\tfor(int i=1;i<=n*2;i++)\n\t\tif(str[i]=='a')A[++nowa]=i;\n\t\telse B[++nowb]=i;\n\tstring ans=\"\";\n\tfor(int i=n;i>=1;)\n\t{\n\t\tint j=i;\n\t\tif(A[i]<B[i])while(j>0&&A[j]<B[j])j--;\n\t\telse while(j>0&&A[j]>B[j])j--;\n\t\tstring tmp=getans(j+1,i);\n\t\tans=max(ans,tmp+ans);\n\t\ti=j;\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "Haskell",
    "code": "import Data.List\n\nsolve :: Int -> String -> String\nsolve _ s = foldr1 f $ map solveB (mkBlocks s)\n  where\n    f s1 s2 | cmpless s1 s2 = s2\n            | otherwise     = s1 ++ s2\n\ncmpless (x : s) (y : t) | x == y = cmpless s t\n                        | otherwise = x < y\ncmpless _ _ = False\n\nmkBlocks = unfoldr f\n  where\n    f \"\" = Nothing\n    f s@(c:_) = let cnts = (takeWhile (> 0) (tail (scanl' g 0 s))) ++ [0]\n                    (s1, s2) = splitAt (length cnts) s\n                in Just $ ((s1, cnts), s2)\n      where g n c' | c' == c   = n + 1\n                   | otherwise = n - 1\n\nsolveB (s@('a':_), _) = take (2*count) $ cycle \"ab\"\n  where\n    count = sub 0 0 0 s\n\n    sub ia ib cnt [] = cnt\n    sub ia ib cnt ('a':s) = sub2 ia (ia+1) ib cnt s\n    sub ia ib cnt ('b':s) = sub ia (ib+1) cnt s\n\n    sub2 ga ia ib cnt ('a':s) = sub2 ga (ia+1) ib cnt s\n    sub2 ga ia ib cnt ('b':s) | ga == ib = sub ia (ib+1) (cnt+1) s\n                              | otherwise = sub2 ga ia (ib+1) cnt s\n\nsolveB (s@('b':_), cnts) =\n  maximum [take cmax (repeat 'b') ++ drop i s\n          | (i, cnt) <- zip [1..] cnts, cnt == cmax]\n  where\n    cmax = maximum cnts\n\nmain = do\n  cont <- getContents\n  let [sn, s] = words cont\n  putStrLn $ solve (read sn) s\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void)\n{\n\nreturn 0;\n\n}\n\n"
  },
  {
    "language": "C",
    "code": "#if 0\ncat <<EOF >mistaken-paste\n#endif\n// thx Ebi-chan!\n\n#pragma GCC diagnostic ignored \"-Wincompatible-pointer-types\"\n#define _USE_MATH_DEFINES\n\n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdbool.h>\n#include <math.h>\n#include <time.h>\n\n#define BIG 2000000007\n#define VERYBIG 20000000000000007LL\n\n#define MOD 1000000007\n#define FOD  998244353\ntypedef uint64_t ull;\ntypedef  int64_t sll;\n\n#define N_MAX 1048576\n\n#ifdef __cplusplus\n#include <queue>\n#include <stack>\n#include <tuple>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <array>\n\nusing std::queue;\nusing std::priority_queue;\nusing std::stack;\nusing std::tuple;\nusing std::set;\nusing std::map;\nusing std::vector;\nusing std::greater;\nusing std::pair;\nusing std::string;\nusing std::get;\n\ntemplate <typename T, typename U>\npair<T, U> operator+(pair<T, U> l, pair<T, U> r) {\n\treturn pair<T, U>(l.first + r.first, l.second + r.second);\n}\n\n#endif\n\ntypedef struct {\n\tsll a;\n\tsll b;\n} hwll;\n\ntypedef struct {\n\tsll a;\n\tsll b;\n\tsll c;\n} hwllc;\n\ntypedef struct {\n\thwll a;\n\thwll b;\n} linell;\n\ntypedef struct {\n\tdouble a;\n\tdouble b;\n} hwreal;\n\null n, m;\null h, w;\null k;\null q;\nsll va, vb, vc, vd, ve, vf;\null ua, ub, uc, ud, ue, uf;\nlong double vra, vrb, vrc;\ndouble vda, vdb, vdc;\nchar ch, dh;\n\null umin (ull x, ull y) {\n\treturn (x < y) ? x : y;\n}\n\null umax (ull x, ull y) {\n\treturn (x > y) ? x : y;\n}\n\nsll smin (sll x, sll y) {\n\treturn (x < y) ? x : y;\n}\n\nsll smax (sll x, sll y) {\n\treturn (x > y) ? x : y;\n}\n\null gcd (ull x, ull y) {\n\tif (y == 0) {\n\t\treturn x;\n\t} else {\n\t\treturn gcd(y, x % y);\n\t}\n}\n\null bitpow (ull a, ull x, ull modulo) {\n\tull result = 1;\n\twhile (x) {\n\t\tif (x & 1) {\n\t\t\tresult *= a;\n\t\t\tresult %= modulo;\n\t\t}\n\t\tx /= 2;\n\t\ta = (a * a) % modulo;\n\t}\n\treturn result;\n}\n\null divide (ull a, ull b, ull modulo) {\n\treturn (a * bitpow(b, modulo - 2, modulo)) % modulo;\n}\n\null udiff (ull a, ull b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nsll sdiff (sll a, sll b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nint bitcount (ull n) {\n\tint result = 0;\n\twhile (n) {\n\t\tif (n & 1) result++;\n\t\tn /= 2;\n\t}\n\treturn result;\n}\n\n#define BEGCMP(NAME) int32_t NAME (const void *left, const void *right)\n#define DEFLR(TYPE) TYPE l=*(TYPE*)left,r=*(TYPE*)right\n#define CMPRET(L, R) if((L)<(R))return-1;if((L)>(R))return+1\n\n// int32_t pullcomp (const void *left, const void *right) {\n// \tull l = *(ull*)left;\n// \tull r = *(ull*)right;\n// \tif (l < r) {\n// \t\treturn -1;\n// \t}\n// \tif (l > r) {\n// \t\treturn +1;\n// \t}\n// \treturn 0;\n// }\nBEGCMP(pullcomp){\n\tDEFLR(ull);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(prevcomp){\n\tDEFLR(sll);\n\tCMPRET(r, l);\n\treturn 0;\n}\nBEGCMP(psllcomp){\n\tDEFLR(sll);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pcharcomp){\n\tDEFLR(char);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pdoublecomp){\n\tDEFLR(double);\n\tCMPRET(l, r);\n\treturn 0;\n}\n\nint32_t pstrcomp (const void *left, const void *right) {\n\tchar* l = *(char**)left;\n\tchar* r = *(char**)right;\n\n\treturn strcmp(l, r);\n}\n\nBEGCMP(phwllABcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwllREVcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\treturn 0;\n}\nBEGCMP(ptriplecomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleREVcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleCABcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.c, r.c);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwrealcomp){\n\tDEFLR(hwreal);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\n\nint32_t pquadcomp (const void *left, const void *right) {\n\tlinell l = *(linell*)left;\n\tlinell r = *(linell*)right;\n\n\tsll ac = phwllABcomp(&(l.a), &(r.a));\n\tif (ac) return ac;\n\tsll bc = phwllABcomp(&(l.b), &(r.b));\n\tif (bc) return bc;\n\n\treturn 0;\n}\nint32_t pfracomp (const void *left, const void *right) {\n\thwllc l = *(hwllc*)left;\n\thwllc r = *(hwllc*)right;\n\n\tCMPRET(l.a * r.b, l.b * r.a);\n\treturn 0;\n}\n\nbool isinrange (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right);\n}\n\nbool isinrange_soft (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right) || (left >= x && x >= right);\n}\n\nsll a[N_MAX + 5];\n// ull a[N_MAX + 5];\n// sll a[3001][3001];\nsll b[N_MAX + 5];\n// ull b[N_MAX + 5];\n// sll b[3001][3001];\nsll c[N_MAX + 5];\nsll d[N_MAX + 5];\nsll e[N_MAX * 4];\nchar s[N_MAX + 1];\n// char s[3010][3010];\nchar t[N_MAX + 1];\n// char t[3010][3010];\nchar u[N_MAX + 1];\nhwll xy[N_MAX * 2 + 5];\nhwllc tup[N_MAX + 5];\n// sll table[3005][3005];\null gin[N_MAX];\n// here we go\n\n\n\null solve () {\n\tsll i, j, ki, li;\n\t// ull result = 0;\n\tsll result = 0;\n\tdouble dresult = 0;\n\t// ull maybe = 0;\n\tsll maybe = 0;\n\t// ull sum = 0;\n\tsll sum = 0;\n\tsll item;\n\tsll *dpcell;\n\n\tm = 0;\n\tk = 0;\n\tfor (i = 0; i < n * 2; i++) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[i] = m++;\n\t\t} else {\n\t\t\ta[i] = k++;\n\t\t}\n\t}\n\n\tm = 0;\n\ti = 0;\n\twhile (i < n * 2) {\n\t\txy[m].a = i;\n\t\txy[m].b = s[i];\n\t\tm++;\n\n\t\titem = 0;\n\t\tdo {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\titem--;\n\t\t\t} else {\n\t\t\t\titem++;\n\t\t\t}\n\n\t\t\ti++;\n\t\t} while (item != 0);\n\t}\n\txy[m].a = n * 2;\n\ta[n * 2] = n;\n\n\t// puts(\"Hello\");\n\t// fflush(stdout);\n\n\tfor (i = m - 1; i >= 0; i--) {\n\t\tif (xy[i].b != 'a') break;\n\n\t\txy[i].b = 'c';\n\t}\n\n\tk = 0;\n\tfor (i = 0; i < m; i++) {\n\t\t// printf(\"%llu %c\\n\", xy[i].a, (char)xy[i].b);\n\t\t// fflush(stdout);\n\t\tswitch (xy[i].b) {\n\t\tcase 'a':\n\t\t\tbreak;\n\t\tcase 'b':\n\t\t\tfor (ki = a[xy[i + 1].a] - 1; ki >= a[xy[i].a]; ki--) {\n\t\t\t\tli = 0;\n\t\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\t\tif (a[j] >= ki) {\n\t\t\t\t\t\tu[li++] = s[j];\n\t\t\t\t\t}\n\t\t\t\t\tu[li] = '\\0';\n\t\t\t\t}\n\t\t\t\t// printf(\"%s ?\\n\", u);\n\t\t\t\tif (strcmp(t + k, u) < 0) {\n\t\t\t\t\tfor (j = 0; u[j]; j++) {\n\t\t\t\t\t\tt[k + j] = u[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (t[k]) k++;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\tt[k++] = 'a';\n\t\t\t\t\tt[k++] = 'b';\n\n\t\t\t\t\tull v = a[j];\n\t\t\t\t\twhile (a[++j] != v);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\tputs(t);\n\n\t// printf(\"%lld\\n\", result);\n\t// printf(\"%.15lf\\n\", dresult);\n\t// puts(s);\n\n\treturn 0;\n\n\tsuccess:\n\tputs(\"YES\");\n\t// puts(\"Yes\");\n\t// printf(\"%llu\\n\", result);\n\t// puts(\"0\");\n\t// puts(\"First\");\n\treturn 0;\n\n\tfail:\n\tputs(\"NO\");\n\t// puts(\"No\");\n\t// puts(\"0\");\n\t// puts(\"-1\");\n\t// puts(\"-1 -1 -1\");\n\t// puts(\"Second\");\n\treturn 1;\n}\n\nint32_t main (int argc, char *argv[]) {\n\tint32_t i, j;\n\n\tn = 5;\n\tm = 0;\n\n\t// scanf(\"%llu%llu\", &h, &w);\n\tscanf(\"%llu\", &n, &m);\n\t// scanf(\"%llu\", &k, &n, &m);\n\t// scanf(\"%llu%llu\", &h, &w);\n\t// scanf(\"%llu\", &q);\n\t// scanf(\"%lld%lld\", &va, &vb, &vc, &vd);\n\t// va--;\n\t// vb--;\n\t// scanf(\"%llu%llu\", &ua, &ub, &uc, &ud, &ue);\n\tscanf(\"%s\", s);\n\t// scanf(\"%s\", t);\n\t// scanf(\"%s\", u);\n\t// scanf(\"%llu\", &k);\n\t// scanf(\"%lld\", &m);\n\t// for (i = 0; i < n; i++) {\n\t// \tscanf(\"%lld\", &a[i]);\n\t// \t// scanf(\"%lld\", &d[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\tfor (i = 0; i < 0; i++) {\n\t\t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t\t// scanf(\"%lld%lld%lld\", &tup[i].a, &tup[i].b, &tup[i].c);\n\t\t// scanf(\"%lld\", &c[i]);\n\n\t\tscanf(\"%lld\", &a[i]);\n\t\t// scanf(\"%lld\", &b[i]);\n\t\t// scanf(\"%lld\", &c[i]);\n\t\t// scanf(\"%lld\", &d[i]);\n\t\t// a[i]--;\n\t\t// b[i]--;\n\t\t// c[i]--;\n\t\t// d[i]--;\n\t\t// xy[i].a--;\n\t\t// xy[i].b--;\n\t\t// tup[i].a--;\n\t\t// tup[i].b--;\n\t}\n\t// scanf(\"%llu\", &m);\n\t// for (i = 0; i < m; i++) {\n\t// \t// scanf(\"%lld%lld\", &a[i], &b[i]);\n\t// \t// scanf(\"%lld\", &b[i]);\n\t// \t// a[i]--;\n\t// \t// b[i]--;\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \tscanf(\"%lld\", &d[i]);\n\t// \t// scanf(\"%lld\", &e[i]);\n\t// \tc[i]--;\n\t// \td[i]--;\n\t// }\n\n\t// for (i = 0; i < q; i++) {\n\t// \t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \t// xy[i].a--;\n\t// \t// xy[i].b--;\n\t// }\n\n\t// for (i = 0; i < n; i++) {\n\t// \tfor (j = 0; j < m; j++) {\n\t// \t\tscanf(\"%lld\", &table[i][j]);\n\t// \t\t// table[i][j]--;\n\t// \t}\n\t// }\n\t// for (i = 0; i < h; i++) {\n\t// \tscanf(\"%s\", s[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\n\tsolve();\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#if 0\ncat <<EOF >mistaken-paste\n#endif\n// thx Ebi-chan!\n\n#pragma GCC diagnostic ignored \"-Wincompatible-pointer-types\"\n#define _USE_MATH_DEFINES\n\n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdbool.h>\n#include <math.h>\n#include <time.h>\n\n#define BIG 2000000007\n#define VERYBIG 20000000000000007LL\n\n#define MOD 1000000007\n#define FOD  998244353\ntypedef uint64_t ull;\ntypedef  int64_t sll;\n\n#define N_MAX 1048576\n\n#ifdef __cplusplus\n#include <queue>\n#include <stack>\n#include <tuple>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <array>\n\nusing std::queue;\nusing std::priority_queue;\nusing std::stack;\nusing std::tuple;\nusing std::set;\nusing std::map;\nusing std::vector;\nusing std::greater;\nusing std::pair;\nusing std::string;\nusing std::get;\n\ntemplate <typename T, typename U>\npair<T, U> operator+(pair<T, U> l, pair<T, U> r) {\n\treturn pair<T, U>(l.first + r.first, l.second + r.second);\n}\n\n#endif\n\ntypedef struct {\n\tsll a;\n\tsll b;\n} hwll;\n\ntypedef struct {\n\tsll a;\n\tsll b;\n\tsll c;\n} hwllc;\n\ntypedef struct {\n\thwll a;\n\thwll b;\n} linell;\n\ntypedef struct {\n\tdouble a;\n\tdouble b;\n} hwreal;\n\null n, m;\null h, w;\null k;\null q;\nsll va, vb, vc, vd, ve, vf;\null ua, ub, uc, ud, ue, uf;\nlong double vra, vrb, vrc;\ndouble vda, vdb, vdc;\nchar ch, dh;\n\null umin (ull x, ull y) {\n\treturn (x < y) ? x : y;\n}\n\null umax (ull x, ull y) {\n\treturn (x > y) ? x : y;\n}\n\nsll smin (sll x, sll y) {\n\treturn (x < y) ? x : y;\n}\n\nsll smax (sll x, sll y) {\n\treturn (x > y) ? x : y;\n}\n\null gcd (ull x, ull y) {\n\tif (y == 0) {\n\t\treturn x;\n\t} else {\n\t\treturn gcd(y, x % y);\n\t}\n}\n\null bitpow (ull a, ull x, ull modulo) {\n\tull result = 1;\n\twhile (x) {\n\t\tif (x & 1) {\n\t\t\tresult *= a;\n\t\t\tresult %= modulo;\n\t\t}\n\t\tx /= 2;\n\t\ta = (a * a) % modulo;\n\t}\n\treturn result;\n}\n\null divide (ull a, ull b, ull modulo) {\n\treturn (a * bitpow(b, modulo - 2, modulo)) % modulo;\n}\n\null udiff (ull a, ull b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nsll sdiff (sll a, sll b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nint bitcount (ull n) {\n\tint result = 0;\n\twhile (n) {\n\t\tif (n & 1) result++;\n\t\tn /= 2;\n\t}\n\treturn result;\n}\n\n#define BEGCMP(NAME) int32_t NAME (const void *left, const void *right)\n#define DEFLR(TYPE) TYPE l=*(TYPE*)left,r=*(TYPE*)right\n#define CMPRET(L, R) if((L)<(R))return-1;if((L)>(R))return+1\n\n// int32_t pullcomp (const void *left, const void *right) {\n// \tull l = *(ull*)left;\n// \tull r = *(ull*)right;\n// \tif (l < r) {\n// \t\treturn -1;\n// \t}\n// \tif (l > r) {\n// \t\treturn +1;\n// \t}\n// \treturn 0;\n// }\nBEGCMP(pullcomp){\n\tDEFLR(ull);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(prevcomp){\n\tDEFLR(sll);\n\tCMPRET(r, l);\n\treturn 0;\n}\nBEGCMP(psllcomp){\n\tDEFLR(sll);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pcharcomp){\n\tDEFLR(char);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pdoublecomp){\n\tDEFLR(double);\n\tCMPRET(l, r);\n\treturn 0;\n}\n\nint32_t pstrcomp (const void *left, const void *right) {\n\tchar* l = *(char**)left;\n\tchar* r = *(char**)right;\n\n\treturn strcmp(l, r);\n}\n\nBEGCMP(phwllABcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwllREVcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\treturn 0;\n}\nBEGCMP(ptriplecomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleREVcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleCABcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.c, r.c);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwrealcomp){\n\tDEFLR(hwreal);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\n\nint32_t pquadcomp (const void *left, const void *right) {\n\tlinell l = *(linell*)left;\n\tlinell r = *(linell*)right;\n\n\tsll ac = phwllABcomp(&(l.a), &(r.a));\n\tif (ac) return ac;\n\tsll bc = phwllABcomp(&(l.b), &(r.b));\n\tif (bc) return bc;\n\n\treturn 0;\n}\nint32_t pfracomp (const void *left, const void *right) {\n\thwllc l = *(hwllc*)left;\n\thwllc r = *(hwllc*)right;\n\n\tCMPRET(l.a * r.b, l.b * r.a);\n\treturn 0;\n}\n\nbool isinrange (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right);\n}\n\nbool isinrange_soft (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right) || (left >= x && x >= right);\n}\n\nsll a[N_MAX + 5];\n// ull a[N_MAX + 5];\n// sll a[3001][3001];\nsll b[N_MAX + 5];\n// ull b[N_MAX + 5];\n// sll b[3001][3001];\nsll c[N_MAX + 5];\nsll d[N_MAX + 5];\nsll e[N_MAX * 4];\nchar s[N_MAX + 1];\n// char s[3010][3010];\nchar t[N_MAX + 1];\n// char t[3010][3010];\nchar u[N_MAX + 1];\nhwll xy[N_MAX * 2 + 5];\nhwllc tup[N_MAX + 5];\n// sll table[3005][3005];\null gin[N_MAX];\n// here we go\n\nchar xs[N_MAX];\n\null solve () {\n\tsll i, j, ki, li;\n\t// ull result = 0;\n\tsll result = 0;\n\tdouble dresult = 0;\n\t// ull maybe = 0;\n\tsll maybe = 0;\n\t// ull sum = 0;\n\tsll sum = 0;\n\tsll item;\n\tsll *dpcell;\n\n\tm = 0;\n\tk = 0;\n\tfor (i = 0; i < n * 2; i++) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[i] = m++;\n\t\t} else {\n\t\t\ta[i] = k++;\n\t\t}\n\t}\n\n\tm = 0;\n\ti = 0;\n\twhile (i < n * 2) {\n\t\txy[m].a = i;\n\t\txy[m].b = s[i];\n\t\tm++;\n\n\t\titem = 0;\n\t\tdo {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\titem--;\n\t\t\t} else {\n\t\t\t\titem++;\n\t\t\t}\n\n\t\t\ti++;\n\t\t} while (item != 0);\n\t}\n\txy[m].a = n * 2;\n\ta[n * 2] = n;\n\n\t// puts(\"Hello\");\n\t// fflush(stdout);\n\n\tfor (i = m - 1; i >= 0; i--) {\n\t\tif (xy[i].b != 'a') break;\n\n\t\txy[i].b = 'c';\n\t}\n\n\tull curr = 10000;\n\n\tk = 0;\n\tfor (i = m - 1; i >= 0; i--) {\n\t\t// printf(\"%llu %c\\n\", xy[i].a, (char)xy[i].b);\n\t\t// fflush(stdout);\n\n\t\tk = 0;\n\t\tt[0] = '\\0';\n\t\tswitch (xy[i].b) {\n\t\tcase 'a':\n\t\t\tbreak;\n\t\tcase 'b':\n\t\t\tfor (ki = a[xy[i + 1].a] - 1; ki >= a[xy[i].a]; ki--) {\n\t\t\t\tli = 0;\n\t\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\t\tif (a[j] >= ki) {\n\t\t\t\t\t\tu[li++] = s[j];\n\t\t\t\t\t}\n\t\t\t\t\tu[li] = '\\0';\n\t\t\t\t}\n\t\t\t\t// printf(\"%s ?\\n\", u);\n\t\t\t\tif (strcmp(t + k, u) < 0) {\n\t\t\t\t\tfor (j = 0; u[j]; j++) {\n\t\t\t\t\t\tt[k + j] = u[j];\n\t\t\t\t\t}\n\t\t\t\t\tt[k + j] = '\\0';\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (t[k]) k++;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\tt[k++] = 'a';\n\t\t\t\t\tt[k++] = 'b';\n\n\t\t\t\t\tull v = a[j];\n\t\t\t\t\twhile (a[++j] != v);\n\t\t\t\t}\n\t\t\t}\n\t\t\tt[k] = '\\0';\n\t\t\tbreak;\n\t\t}\n\n\t\t// printf(\"%s ...\\n\", t);\n\n\t\tfor (j = 0; j < k; j++) {\n\t\t\txs[curr - k + j] = t[j];\n\t\t}\n\t\tif (strcmp(xs + curr, xs + curr - k) < 0) curr -= k;\n\t}\n\tputs(xs + curr);\n\n\t// printf(\"%lld\\n\", result);\n\t// printf(\"%.15lf\\n\", dresult);\n\t// puts(s);\n\n\treturn 0;\n\n\tsuccess:\n\tputs(\"YES\");\n\t// puts(\"Yes\");\n\t// printf(\"%llu\\n\", result);\n\t// puts(\"0\");\n\t// puts(\"First\");\n\treturn 0;\n\n\tfail:\n\tputs(\"NO\");\n\t// puts(\"No\");\n\t// puts(\"0\");\n\t// puts(\"-1\");\n\t// puts(\"-1 -1 -1\");\n\t// puts(\"Second\");\n\treturn 1;\n}\n\nint32_t main (int argc, char *argv[]) {\n\tint32_t i, j;\n\n\tn = 5;\n\tm = 0;\n\n\t// scanf(\"%llu%llu\", &h, &w);\n\tscanf(\"%llu\", &n, &m);\n\t// scanf(\"%llu\", &k, &n, &m);\n\t// scanf(\"%llu%llu\", &h, &w);\n\t// scanf(\"%llu\", &q);\n\t// scanf(\"%lld%lld\", &va, &vb, &vc, &vd);\n\t// va--;\n\t// vb--;\n\t// scanf(\"%llu%llu\", &ua, &ub, &uc, &ud, &ue);\n\tscanf(\"%s\", s);\n\t// scanf(\"%s\", t);\n\t// scanf(\"%s\", u);\n\t// scanf(\"%llu\", &k);\n\t// scanf(\"%lld\", &m);\n\t// for (i = 0; i < n; i++) {\n\t// \tscanf(\"%lld\", &a[i]);\n\t// \t// scanf(\"%lld\", &d[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\tfor (i = 0; i < 0; i++) {\n\t\t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t\t// scanf(\"%lld%lld%lld\", &tup[i].a, &tup[i].b, &tup[i].c);\n\t\t// scanf(\"%lld\", &c[i]);\n\n\t\tscanf(\"%lld\", &a[i]);\n\t\t// scanf(\"%lld\", &b[i]);\n\t\t// scanf(\"%lld\", &c[i]);\n\t\t// scanf(\"%lld\", &d[i]);\n\t\t// a[i]--;\n\t\t// b[i]--;\n\t\t// c[i]--;\n\t\t// d[i]--;\n\t\t// xy[i].a--;\n\t\t// xy[i].b--;\n\t\t// tup[i].a--;\n\t\t// tup[i].b--;\n\t}\n\t// scanf(\"%llu\", &m);\n\t// for (i = 0; i < m; i++) {\n\t// \t// scanf(\"%lld%lld\", &a[i], &b[i]);\n\t// \t// scanf(\"%lld\", &b[i]);\n\t// \t// a[i]--;\n\t// \t// b[i]--;\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \tscanf(\"%lld\", &d[i]);\n\t// \t// scanf(\"%lld\", &e[i]);\n\t// \tc[i]--;\n\t// \td[i]--;\n\t// }\n\n\t// for (i = 0; i < q; i++) {\n\t// \t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \t// xy[i].a--;\n\t// \t// xy[i].b--;\n\t// }\n\n\t// for (i = 0; i < n; i++) {\n\t// \tfor (j = 0; j < m; j++) {\n\t// \t\tscanf(\"%lld\", &table[i][j]);\n\t// \t\t// table[i][j]--;\n\t// \t}\n\t// }\n\t// for (i = 0; i < h; i++) {\n\t// \tscanf(\"%s\", s[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\n\tsolve();\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#if 0\ncat <<EOF >mistaken-paste\n#endif\n// thx Ebi-chan!\n\n#pragma GCC diagnostic ignored \"-Wincompatible-pointer-types\"\n#define _USE_MATH_DEFINES\n\n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdbool.h>\n#include <math.h>\n#include <time.h>\n\n#define BIG 2000000007\n#define VERYBIG 20000000000000007LL\n\n#define MOD 1000000007\n#define FOD  998244353\ntypedef uint64_t ull;\ntypedef  int64_t sll;\n\n#define N_MAX 1048576\n\n#ifdef __cplusplus\n#include <queue>\n#include <stack>\n#include <tuple>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <array>\n\nusing std::queue;\nusing std::priority_queue;\nusing std::stack;\nusing std::tuple;\nusing std::set;\nusing std::map;\nusing std::vector;\nusing std::greater;\nusing std::pair;\nusing std::string;\nusing std::get;\n\ntemplate <typename T, typename U>\npair<T, U> operator+(pair<T, U> l, pair<T, U> r) {\n\treturn pair<T, U>(l.first + r.first, l.second + r.second);\n}\n\n#endif\n\ntypedef struct {\n\tsll a;\n\tsll b;\n} hwll;\n\ntypedef struct {\n\tsll a;\n\tsll b;\n\tsll c;\n} hwllc;\n\ntypedef struct {\n\thwll a;\n\thwll b;\n} linell;\n\ntypedef struct {\n\tdouble a;\n\tdouble b;\n} hwreal;\n\null n, m;\null h, w;\null k;\null q;\nsll va, vb, vc, vd, ve, vf;\null ua, ub, uc, ud, ue, uf;\nlong double vra, vrb, vrc;\ndouble vda, vdb, vdc;\nchar ch, dh;\n\null umin (ull x, ull y) {\n\treturn (x < y) ? x : y;\n}\n\null umax (ull x, ull y) {\n\treturn (x > y) ? x : y;\n}\n\nsll smin (sll x, sll y) {\n\treturn (x < y) ? x : y;\n}\n\nsll smax (sll x, sll y) {\n\treturn (x > y) ? x : y;\n}\n\null gcd (ull x, ull y) {\n\tif (y == 0) {\n\t\treturn x;\n\t} else {\n\t\treturn gcd(y, x % y);\n\t}\n}\n\null bitpow (ull a, ull x, ull modulo) {\n\tull result = 1;\n\twhile (x) {\n\t\tif (x & 1) {\n\t\t\tresult *= a;\n\t\t\tresult %= modulo;\n\t\t}\n\t\tx /= 2;\n\t\ta = (a * a) % modulo;\n\t}\n\treturn result;\n}\n\null divide (ull a, ull b, ull modulo) {\n\treturn (a * bitpow(b, modulo - 2, modulo)) % modulo;\n}\n\null udiff (ull a, ull b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nsll sdiff (sll a, sll b) {\n\tif (a >= b) {\n\t\treturn a - b;\n\t} else {\n\t\treturn b - a;\n\t}\n}\n\nint bitcount (ull n) {\n\tint result = 0;\n\twhile (n) {\n\t\tif (n & 1) result++;\n\t\tn /= 2;\n\t}\n\treturn result;\n}\n\n#define BEGCMP(NAME) int32_t NAME (const void *left, const void *right)\n#define DEFLR(TYPE) TYPE l=*(TYPE*)left,r=*(TYPE*)right\n#define CMPRET(L, R) if((L)<(R))return-1;if((L)>(R))return+1\n\n// int32_t pullcomp (const void *left, const void *right) {\n// \tull l = *(ull*)left;\n// \tull r = *(ull*)right;\n// \tif (l < r) {\n// \t\treturn -1;\n// \t}\n// \tif (l > r) {\n// \t\treturn +1;\n// \t}\n// \treturn 0;\n// }\nBEGCMP(pullcomp){\n\tDEFLR(ull);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(prevcomp){\n\tDEFLR(sll);\n\tCMPRET(r, l);\n\treturn 0;\n}\nBEGCMP(psllcomp){\n\tDEFLR(sll);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pcharcomp){\n\tDEFLR(char);\n\tCMPRET(l, r);\n\treturn 0;\n}\nBEGCMP(pdoublecomp){\n\tDEFLR(double);\n\tCMPRET(l, r);\n\treturn 0;\n}\n\nint32_t pstrcomp (const void *left, const void *right) {\n\tchar* l = *(char**)left;\n\tchar* r = *(char**)right;\n\n\treturn strcmp(l, r);\n}\n\nBEGCMP(phwllABcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwllREVcomp){\n\tDEFLR(hwll);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\treturn 0;\n}\nBEGCMP(ptriplecomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleREVcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.b, r.b);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.c, r.c);\n\treturn 0;\n}\nBEGCMP(ptripleCABcomp){\n\tDEFLR(hwllc);\n\tCMPRET(l.c, r.c);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\nBEGCMP(phwrealcomp){\n\tDEFLR(hwreal);\n\tCMPRET(l.a, r.a);\n\tCMPRET(l.b, r.b);\n\treturn 0;\n}\n\nint32_t pquadcomp (const void *left, const void *right) {\n\tlinell l = *(linell*)left;\n\tlinell r = *(linell*)right;\n\n\tsll ac = phwllABcomp(&(l.a), &(r.a));\n\tif (ac) return ac;\n\tsll bc = phwllABcomp(&(l.b), &(r.b));\n\tif (bc) return bc;\n\n\treturn 0;\n}\nint32_t pfracomp (const void *left, const void *right) {\n\thwllc l = *(hwllc*)left;\n\thwllc r = *(hwllc*)right;\n\n\tCMPRET(l.a * r.b, l.b * r.a);\n\treturn 0;\n}\n\nbool isinrange (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right);\n}\n\nbool isinrange_soft (sll left, sll x, sll right) {\n\treturn (left <= x && x <= right) || (left >= x && x >= right);\n}\n\nsll a[N_MAX + 5];\n// ull a[N_MAX + 5];\n// sll a[3001][3001];\nsll b[N_MAX + 5];\n// ull b[N_MAX + 5];\n// sll b[3001][3001];\nsll c[N_MAX + 5];\nsll d[N_MAX + 5];\nsll e[N_MAX * 4];\nchar s[N_MAX + 1];\n// char s[3010][3010];\nchar t[N_MAX + 1];\n// char t[3010][3010];\nchar u[N_MAX + 1];\nhwll xy[N_MAX * 2 + 5];\nhwllc tup[N_MAX + 5];\n// sll table[3005][3005];\null gin[N_MAX];\n// here we go\n\n\n\null solve () {\n\tsll i, j, ki, li;\n\t// ull result = 0;\n\tsll result = 0;\n\tdouble dresult = 0;\n\t// ull maybe = 0;\n\tsll maybe = 0;\n\t// ull sum = 0;\n\tsll sum = 0;\n\tsll item;\n\tsll *dpcell;\n\n\tm = 0;\n\tk = 0;\n\tfor (i = 0; i < n * 2; i++) {\n\t\tif (s[i] == 'a') {\n\t\t\ta[i] = m++;\n\t\t} else {\n\t\t\ta[i] = k++;\n\t\t}\n\t}\n\n\tm = 0;\n\ti = 0;\n\twhile (i < n * 2) {\n\t\txy[m].a = i;\n\t\txy[m].b = s[i];\n\t\tm++;\n\n\t\titem = 0;\n\t\tdo {\n\t\t\tif (s[i] == 'a') {\n\t\t\t\titem--;\n\t\t\t} else {\n\t\t\t\titem++;\n\t\t\t}\n\n\t\t\ti++;\n\t\t} while (item != 0);\n\t}\n\txy[m].a = n * 2;\n\ta[n * 2] = n;\n\n\t// puts(\"Hello\");\n\t// fflush(stdout);\n\n\tfor (i = m - 1; i >= 0; i--) {\n\t\tif (xy[i].b != 'a') break;\n\n\t\txy[i].b = 'c';\n\t}\n\n\tk = 0;\n\tfor (i = 0; i < m; i++) {\n\t\t// printf(\"%llu %c\\n\", xy[i].a, (char)xy[i].b);\n\t\t// fflush(stdout);\n\t\tswitch (xy[i].b) {\n\t\tcase 'a':\n\t\t\tbreak;\n\t\tcase 'b':\n\t\t\tfor (ki = a[xy[i + 1].a] - 1; ki >= a[xy[i].a]; ki--) {\n\t\t\t\tli = 0;\n\t\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\t\tif (a[j] >= ki) {\n\t\t\t\t\t\tu[li++] = s[j];\n\t\t\t\t\t}\n\t\t\t\t\tu[li] = '\\0';\n\t\t\t\t}\n\t\t\t\t// printf(\"%s ?\\n\", u);\n\t\t\t\tif (strcmp(t + k, u) < 0) {\n\t\t\t\t\tfor (j = 0; u[j]; j++) {\n\t\t\t\t\t\tt[k + j] = u[j];\n\t\t\t\t\t}\n\t\t\t\t\tt[k + j] = '\\0';\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (t[k]) k++;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tfor (j = xy[i].a; j < xy[i + 1].a; j++) {\n\t\t\t\tif (s[j] == 'a') {\n\t\t\t\t\tt[k++] = 'a';\n\t\t\t\t\tt[k++] = 'b';\n\n\t\t\t\t\tull v = a[j];\n\t\t\t\t\twhile (a[++j] != v);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\tputs(t);\n\n\t// printf(\"%lld\\n\", result);\n\t// printf(\"%.15lf\\n\", dresult);\n\t// puts(s);\n\n\treturn 0;\n\n\tsuccess:\n\tputs(\"YES\");\n\t// puts(\"Yes\");\n\t// printf(\"%llu\\n\", result);\n\t// puts(\"0\");\n\t// puts(\"First\");\n\treturn 0;\n\n\tfail:\n\tputs(\"NO\");\n\t// puts(\"No\");\n\t// puts(\"0\");\n\t// puts(\"-1\");\n\t// puts(\"-1 -1 -1\");\n\t// puts(\"Second\");\n\treturn 1;\n}\n\nint32_t main (int argc, char *argv[]) {\n\tint32_t i, j;\n\n\tn = 5;\n\tm = 0;\n\n\t// scanf(\"%llu%llu\", &h, &w);\n\tscanf(\"%llu\", &n, &m);\n\t// scanf(\"%llu\", &k, &n, &m);\n\t// scanf(\"%llu%llu\", &h, &w);\n\t// scanf(\"%llu\", &q);\n\t// scanf(\"%lld%lld\", &va, &vb, &vc, &vd);\n\t// va--;\n\t// vb--;\n\t// scanf(\"%llu%llu\", &ua, &ub, &uc, &ud, &ue);\n\tscanf(\"%s\", s);\n\t// scanf(\"%s\", t);\n\t// scanf(\"%s\", u);\n\t// scanf(\"%llu\", &k);\n\t// scanf(\"%lld\", &m);\n\t// for (i = 0; i < n; i++) {\n\t// \tscanf(\"%lld\", &a[i]);\n\t// \t// scanf(\"%lld\", &d[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\tfor (i = 0; i < 0; i++) {\n\t\t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t\t// scanf(\"%lld%lld%lld\", &tup[i].a, &tup[i].b, &tup[i].c);\n\t\t// scanf(\"%lld\", &c[i]);\n\n\t\tscanf(\"%lld\", &a[i]);\n\t\t// scanf(\"%lld\", &b[i]);\n\t\t// scanf(\"%lld\", &c[i]);\n\t\t// scanf(\"%lld\", &d[i]);\n\t\t// a[i]--;\n\t\t// b[i]--;\n\t\t// c[i]--;\n\t\t// d[i]--;\n\t\t// xy[i].a--;\n\t\t// xy[i].b--;\n\t\t// tup[i].a--;\n\t\t// tup[i].b--;\n\t}\n\t// scanf(\"%llu\", &m);\n\t// for (i = 0; i < m; i++) {\n\t// \t// scanf(\"%lld%lld\", &a[i], &b[i]);\n\t// \t// scanf(\"%lld\", &b[i]);\n\t// \t// a[i]--;\n\t// \t// b[i]--;\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \tscanf(\"%lld\", &d[i]);\n\t// \t// scanf(\"%lld\", &e[i]);\n\t// \tc[i]--;\n\t// \td[i]--;\n\t// }\n\n\t// for (i = 0; i < q; i++) {\n\t// \t// scanf(\"%lld%lld\", &xy[i].a, &xy[i].b);\n\t// \tscanf(\"%lld\", &c[i]);\n\t// \t// xy[i].a--;\n\t// \t// xy[i].b--;\n\t// }\n\n\t// for (i = 0; i < n; i++) {\n\t// \tfor (j = 0; j < m; j++) {\n\t// \t\tscanf(\"%lld\", &table[i][j]);\n\t// \t\t// table[i][j]--;\n\t// \t}\n\t// }\n\t// for (i = 0; i < h; i++) {\n\t// \tscanf(\"%s\", s[i]);\n\t// }\n\t// scanf(\"%llu\", &q);\n\n\tsolve();\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\ntypedef struct {\n\tchar *s;\n\tint i;\n}pair;\n\nint compare_string(const void *a, const void *b){\n\treturn strcmp(*(char **)b, *(char **)a);\n}\n\nint compair(const void *a, const void *b){\n\tpair pa = *(pair *)a, pb = *(pair *)b;\n\tint res = strcmp(pb.s, pa.s);\n\tif(res == 0){\n\t\treturn pa.i - pb.i;\n\t}\n\telse{\n\t\treturn res;\n\t}\n}\n\nint max(int a, int b){\n\treturn a >= b ? a : b;\n}\n\nint main(){\n\tint N, i, j, k, l;\n\tscanf(\"%d\", &N);\n\tchar *S = (char *)malloc(sizeof(char) * (2 * N + 1));\n\tscanf(\"%s\", S);\n\tint *T = (int *)malloc(sizeof(int) * (2 * N + 1));\n\tint *a = (int *)malloc(sizeof(int) * (N + 1));\n\tint *b = (int *)malloc(sizeof(int) * (N + 1));\n\tfor(i = 0, j = 0, k = 0; i < 2 * N; i++){\n\t\tif(S[i] == 'a'){\n\t\t\tT[i] = j;\n\t\t\ta[j] = i;\n\t\t\tj++;\n\t\t}\n\t\telse{\n\t\t\tT[i] = k;\n\t\t\tb[k] = i;\n\t\t\tk++;\n\t\t}\n\t}\n\ta[N] = 2 * N;\n\tb[N] = 2 * N;\n\tint *left = (int *)malloc(sizeof(int) * N);\n\tint *right = (int *)malloc(sizeof(int) * N);\n\tleft[0] = 0;\n\tfor(i = 1, j = 1; i < N; i++){\n\t\tif(a[i] > b[i - 1] && b[i] > a[i - 1]){\n\t\t\tleft[j] = i;\n\t\t\tright[j - 1] = i;\n\t\t\tj++;\n\t\t}\n\t}\n\tright[j - 1] = N;\n\tint K = j, prevj;\n//\tprintf(\"K = %d\\n\", K);\n\tpair *p = (pair *)malloc(sizeof(pair) * K);\n\tfor(i = 0; i < K; i++){\n\t\tl = max(a[right[i] - 1] - b[left[i]], b[right[i] - 1] - a[left[i]]) + 1;\n\t\tp[i].s = (char *)malloc(sizeof(char) * (l + 1));\n\t\tp[i].i = i;\n\t\tif(a[left[i]] < b[left[i]]){\n\t\t\tfor(j = left[i], k = 0; j < right[i]; ){\n\t\t\t\tp[i].s[k] = 'a';\n\t\t\t\tp[i].s[k + 1] = 'b';\n\t\t\t\tk += 2;\n\t\t\t\tprevj = j;\n\t\t\t\twhile(a[j] < b[prevj]){\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tp[i].s[k] = '\\0';\n\t\t}\n\t\telse{\n\t\t\tint d = right[i] - left[i];\n\t\t\tchar **sub = (char **)malloc(sizeof(char *) * d);\n\t\t\tfor(j = left[i]; j < right[i]; j++){\n\t\t\t\tsub[j - left[i]] = (char *)malloc(sizeof(char) * (2 * (right[i] - j) + 1));\n\t\t\t\tfor(k = b[left[i]], l = 0; k <= a[right[i] - 1]; k++){\n\t\t\t\t\tif(T[k] >= j){\n\t\t\t\t\t\tsub[j - left[i]][l] = S[k];\n\t\t\t\t\t\tl++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsub[j - left[i]][l] = '\\0';\n//\t\t\t\tprintf(\"sub[%d] = %s\\n\", j - left[i], sub[j - left[i]]);\n\t\t\t}\n//\t\t\tprintf(\"qsort!\\n\");\n\t\t\tqsort(sub, d, sizeof(char *), compare_string);\n/*\t\t\tfor(j = 0; j < d; j++){\n\t\t\t\tprintf(\"sub[%d] = %s\\n\", j, sub[j]);\n\t\t\t}\n*/\t\t\tfor(j = 0; sub[0][j] != '\\0'; j++){\n\t\t\t\tp[i].s[j] = sub[0][j];\n\t\t\t}\n\t\t\tp[i].s[j] = '\\0';\n\t\t}\n\t}\n\tqsort(p, K, sizeof(pair), compair);\n/*\tfor(i = 0; i < K; i++){\n\t\tprintf(\"i = %d\\n\", i);\n\t\tprintf(\"(i, s) = (%d, %s))\\n\", p[i].i, p[i].s);\n\t}\n*/\tfor(i = 0, j = -1; i < K; i++){\n//\t\tprintf(\"\\n(i, j) = (%d, %d)\\n\", i, j);\n\t\tif(p[i].i > j){\n\t\t\tfor(k = 0; p[i].s[k] != '\\0'; k++){\n\t\t\t\tprintf(\"%c\", p[i].s[k]);\n\t\t\t}\n\t\t\tj = p[i].i;\n\t\t}\n\t}\n\tprintf(\"\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\ntypedef struct {\n\tchar *s;\n\tint i;\n}pair;\n\nint compare_string(const void *a, const void *b){\n\treturn strcmp(*(char **)b, *(char **)a);\n}\n\nint compair(const void *a, const void *b){\n\tpair pa = *(pair *)a, pb = *(pair *)b;\n\tint res = strcmp(pb.s, pa.s);\n\tif(res == 0){\n\t\treturn pa.i - pb.i;\n\t}\n\telse{\n\t\treturn res;\n\t}\n}\n\nint max(int a, int b){\n\treturn a >= b ? a : b;\n}\n\nint main(){\n\tint N, i, j, k, l;\n\tscanf(\"%d\", &N);\n\tchar *S = (char *)malloc(sizeof(char) * (2 * N + 1));\n\tscanf(\"%s\", S);\n\tint *T = (int *)malloc(sizeof(int) * (2 * N + 1));\n\tint *a = (int *)malloc(sizeof(int) * (N + 1));\n\tint *b = (int *)malloc(sizeof(int) * (N + 1));\n\tfor(i = 0, j = 0, k = 0; i < 2 * N; i++){\n\t\tif(S[i] == 'a'){\n\t\t\tT[i] = j;\n\t\t\ta[j] = i;\n\t\t\tj++;\n\t\t}\n\t\telse{\n\t\t\tT[i] = k;\n\t\t\tb[k] = i;\n\t\t\tk++;\n\t\t}\n\t}\n\ta[N] = 2 * N;\n\tb[N] = 2 * N;\n\tint *left = (int *)malloc(sizeof(int) * N);\n\tint *right = (int *)malloc(sizeof(int) * N);\n\tleft[0] = 0;\n\tfor(i = 1, j = 1; i < N; i++){\n\t\tif(a[i] > b[i - 1] && b[i] > a[i - 1]){\n\t\t\tleft[j] = i;\n\t\t\tright[j - 1] = i;\n\t\t\tj++;\n\t\t}\n\t}\n\tright[j - 1] = N;\n\tint K = j, prevj;\n//\tprintf(\"K = %d\\n\", K);\n\tpair *p = (pair *)malloc(sizeof(pair) * K);\n\tfor(i = 0; i < K; i++){\n\t\tl = max(a[right[i] - 1] - b[left[i]], b[right[i] - 1] - a[left[i]]) + 1;\n\t\tp[i].s = (char *)malloc(sizeof(char) * (l + 1));\n\t\tp[i].i = i;\n\t\tif(a[left[i]] < b[left[i]]){\n\t\t\tfor(j = left[i], k = 0; j < right[i]; ){\n\t\t\t\tp[i].s[k] = 'a';\n\t\t\t\tp[i].s[k + 1] = 'b';\n\t\t\t\tk += 2;\n\t\t\t\tprevj = j;\n\t\t\t\twhile(a[j] < b[prevj] && j < right[i]){\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tp[i].s[k] = '\\0';\n\t\t}\n\t\telse{\n\t\t\tint d = right[i] - left[i];\n\t\t\tchar **sub = (char **)malloc(sizeof(char *) * d);\n\t\t\tfor(j = left[i]; j < right[i]; j++){\n\t\t\t\tsub[j - left[i]] = (char *)malloc(sizeof(char) * (2 * (right[i] - j) + 1));\n\t\t\t\tfor(k = b[left[i]], l = 0; k <= a[right[i] - 1]; k++){\n\t\t\t\t\tif(T[k] >= j){\n\t\t\t\t\t\tsub[j - left[i]][l] = S[k];\n\t\t\t\t\t\tl++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsub[j - left[i]][l] = '\\0';\n//\t\t\t\tprintf(\"sub[%d] = %s\\n\", j - left[i], sub[j - left[i]]);\n\t\t\t}\n//\t\t\tprintf(\"qsort!\\n\");\n\t\t\tqsort(sub, d, sizeof(char *), compare_string);\n/*\t\t\tfor(j = 0; j < d; j++){\n\t\t\t\tprintf(\"sub[%d] = %s\\n\", j, sub[j]);\n\t\t\t}\n*/\t\t\tfor(j = 0; sub[0][j] != '\\0'; j++){\n\t\t\t\tp[i].s[j] = sub[0][j];\n\t\t\t}\n\t\t\tp[i].s[j] = '\\0';\n\t\t}\n\t}\n\tqsort(p, K, sizeof(pair), compair);\n/*\tfor(i = 0; i < K; i++){\n\t\tprintf(\"i = %d\\n\", i);\n\t\tprintf(\"(i, s) = (%d, %s))\\n\", p[i].i, p[i].s);\n\t}\n*/\tfor(i = 0, j = -1; i < K; i++){\n//\t\tprintf(\"\\n(i, j) = (%d, %d)\\n\", i, j);\n\t\tif(p[i].i > j){\n\t\t\tfor(k = 0; p[i].s[k] != '\\0'; k++){\n\t\t\t\tprintf(\"%c\", p[i].s[k]);\n\t\t\t}\n\t\t\tj = p[i].i;\n\t\t}\n\t}\n\tprintf(\"\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\ntypedef struct {\n\tchar *s;\n\tint i;\n}pair;\n\nint compare_string(const void *a, const void *b){\n\treturn strcmp(*(char **)b, *(char **)a);\n}\n\nint compair(const void *a, const void *b){\n\tpair pa = *(pair *)a, pb = *(pair *)b;\n\tint res = strcmp(pb.s, pa.s);\n\tif(res == 0){\n\t\treturn pa.i - pb.i;\n\t}\n\telse{\n\t\treturn res;\n\t}\n}\n\nint max(int a, int b){\n\treturn a >= b ? a : b;\n}\n\nint main(){\n\tint N, i, j, k, l;\n\tscanf(\"%d\", &N);\n\tchar *S = (char *)malloc(sizeof(char) * (2 * N + 1));\n\tscanf(\"%s\", S);\n\tint *T = (int *)malloc(sizeof(int) * (2 * N + 1));\n\tint *a = (int *)malloc(sizeof(int) * (N + 1));\n\tint *b = (int *)malloc(sizeof(int) * (N + 1));\n\tfor(i = 0, j = 0, k = 0; i < 2 * N; i++){\n\t\tif(S[i] == 'a'){\n\t\t\tT[i] = j;\n\t\t\ta[j] = i;\n\t\t\tj++;\n\t\t}\n\t\telse{\n\t\t\tT[i] = k;\n\t\t\tb[k] = i;\n\t\t\tk++;\n\t\t}\n\t}\n\ta[N] = 2 * N;\n\tb[N] = 2 * N;\n\tint *left = (int *)malloc(sizeof(int) * N);\n\tint *right = (int *)malloc(sizeof(int) * N);\n\tleft[0] = 0;\n\tfor(i = 1, j = 1; i < N; i++){\n\t\tif(a[i] > b[i - 1] && b[i] > a[i - 1]){\n\t\t\tleft[j] = i;\n\t\t\tright[j - 1] = i;\n\t\t\tj++;\n\t\t}\n\t}\n\tright[j - 1] = N;\n\tint K = j, prevj;\n//\tprintf(\"K = %d\\n\", K);\n\tpair *p = (pair *)malloc(sizeof(pair) * K);\n\tfor(i = 0; i < K; i++){\n\t\tl = max(a[right[i] - 1] - b[left[i]], b[right[i] - 1] - a[left[i]]) + 1;\n\t\tp[i].s = (char *)malloc(sizeof(char) * (l + 1));\n\t\tp[i].i = i;\n\t\tif(a[left[i]] < b[left[i]]){\n\t\t\tfor(j = left[i], k = 0; j < right[i]; ){\n\t\t\t\tp[i].s[k] = 'a';\n\t\t\t\tp[i].s[k + 1] = 'b';\n\t\t\t\tk += 2;\n\t\t\t\tprevj = j;\n\t\t\t\twhile(a[j] < b[prevj] && j < right[i]){\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tp[i].s[k] = '\\0';\n\t\t}\n\t\telse{\n\t\t\tint d = right[i] - left[i];\n\t\t\tchar **sub = (char **)malloc(sizeof(char *) * d);\n\t\t\tfor(j = left[i]; j < right[i]; j++){\n\t\t\t\tsub[j - left[i]] = (char *)malloc(sizeof(char) * (2 * (right[i] - j) + 1));\n\t\t\t\tfor(k = b[left[i]], l = 0; k <= a[right[i] - 1]; k++){\n\t\t\t\t\tif(T[k] >= j){\n\t\t\t\t\t\tsub[j - left[i]][l] = S[k];\n\t\t\t\t\t\tl++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsub[j - left[i]][l] = '\\0';\n//\t\t\t\tprintf(\"sub[%d] = %s\\n\", j - left[i], sub[j - left[i]]);\n\t\t\t}\n//\t\t\tprintf(\"qsort!\\n\");\n\t\t\tqsort(sub, d, sizeof(char *), compare_string);\n/*\t\t\tfor(j = 0; j < d; j++){\n\t\t\t\tprintf(\"sub[%d] = %s\\n\", j, sub[j]);\n\t\t\t}\n*/\t\t\tfor(j = 0; sub[0][j] != '\\0'; j++){\n\t\t\t\tp[i].s[j] = sub[0][j];\n\t\t\t}\n\t\t\tp[i].s[j] = '\\0';\n\t\t}\n\t}\n\tint ab = 0;\n\tfor(i = K - 1; i >= 0; i--){\n\t\tif(p[i].s[0] == 'a'){\n\t\t\tfor(j = 0; p[i].s[j] != '\\0'; j++){}\n\t\t\tab += j / 2;\n\t\t}\n\t\telse{\n\t\t\tbreak;\n\t\t}\n\t}\n\tqsort(p, K, sizeof(pair), compair);\n/*\tfor(i = 0; i < K; i++){\n\t\tprintf(\"i = %d\\n\", i);\n\t\tprintf(\"(i, s) = (%d, %s))\\n\", p[i].i, p[i].s);\n\t}\n*/\tfor(i = 0, j = -1; i < K; i++){\n//\t\tprintf(\"\\n(i, j) = (%d, %d)\\n\", i, j);\n\t\tif(p[i].i > j && p[i].s[0] == 'b'){\n\t\t\tfor(k = 0; p[i].s[k] != '\\0'; k++){\n\t\t\t\tprintf(\"%c\", p[i].s[k]);\n\t\t\t}\n\t\t\tj = p[i].i;\n\t\t}\n\t}\n\tfor(i = 0; i < ab; i++){\n\t\tprintf(\"ab\");\n\t}\n\tprintf(\"\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.io.IOException;\nimport java.util.InputMismatchException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.StringTokenizer;\nimport java.io.BufferedReader;\nimport java.util.Collections;\nimport java.io.InputStream;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        InputReader in = new InputReader(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        ESynchronizedSubsequence solver = new ESynchronizedSubsequence();\n        solver.solve(1, in, out);\n        out.close();\n    }\n\n    static class ESynchronizedSubsequence {\n        public void solve(int testNumber, InputReader in, PrintWriter out) {\n            int n = in.nextInt();\n            String s = in.nextString();\n\n            int sum = 0;\n            List<String> list = new ArrayList<>();\n            int prev = 0;\n            for (int i = 0; i < 2 * n; i++) {\n                sum += s.charAt(i) == 'a' ? -1 : 1;\n                if (sum == 0) {\n                    list.add(exec(s.substring(prev, i + 1)));\n                    prev = i + 1;\n                }\n            }\n\n            String ans = list.get(list.size() - 1);\n            for (int i = list.size() - 2; i >= 0; i--) {\n                if (ans.compareTo(list.get(i) + ans) <= 0) {\n                    ans = list.get(i) + ans;\n                }\n            }\n\n            out.println(ans);\n        }\n\n        String exec(String s) {\n            int n = s.length() / 2;\n\n            int aCount = 0;\n            int bCount = 0;\n            int[] aIndex = new int[n];\n            int[] bIndex = new int[n];\n            for (int i = 0; i < 2 * n; i++) {\n                if (s.charAt(i) == 'a') {\n                    aIndex[aCount] = i;\n                    aCount++;\n                } else {\n                    bIndex[bCount] = i;\n                    bCount++;\n                }\n            }\n\n            int[] pairIndex = new int[2 * n];\n            for (int i = 0; i < n; i++) {\n                pairIndex[aIndex[i]] = bIndex[i];\n                pairIndex[bIndex[i]] = aIndex[i];\n            }\n\n            if (s.charAt(0) == 'a') {\n                StringBuilder sb = new StringBuilder();\n                for (int i = 0; i < 2 * n; i++) {\n                    if (s.charAt(i) == 'a') {\n                        sb.append(\"ab\");\n                        i = pairIndex[i];\n                    }\n                }\n                return sb.toString();\n            } else {\n                List<String> list = new ArrayList<>();\n                for (int i = 1; i <= n; i++) {\n                    boolean[] use = new boolean[2 * n];\n                    int count = 0;\n                    for (int j = 2 * n - 1; j >= 0; j--) {\n                        if (s.charAt(j) == 'a') {\n                            use[j] = true;\n                            use[pairIndex[j]] = true;\n\n                            count++;\n                            if (count == i) break;\n                        }\n                    }\n                    StringBuilder sb = new StringBuilder();\n                    for (int j = 0; j < 2 * n; j++) {\n                        if (use[j]) sb.append(s.charAt(j));\n                    }\n                    list.add(sb.toString());\n                }\n                Collections.sort(list);\n                return list.get(list.size() - 1);\n            }\n        }\n\n    }\n\n    static class InputReader {\n        private BufferedReader br;\n        private StringTokenizer st;\n\n        public InputReader(InputStream inputStream) {\n            br = new BufferedReader(new InputStreamReader(inputStream));\n            st = new StringTokenizer(\"\");\n        }\n\n        public String nextString() {\n            while (!st.hasMoreTokens()) {\n                try {\n                    st = new StringTokenizer(br.readLine(), \" \");\n                } catch (IOException e) {\n                    throw new InputMismatchException();\n                }\n            }\n            return st.nextToken();\n        }\n\n        public int nextInt() {\n            return Integer.parseInt(nextString());\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.List;\nimport java.util.StringTokenizer;\nimport java.io.IOException;\nimport java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.io.InputStream;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        InputReader in = new InputReader(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        TaskE solver = new TaskE();\n        solver.solve(1, in, out);\n        out.close();\n    }\n\n    static class TaskE {\n        public void solve(int testNumber, InputReader in, PrintWriter out) {\n            int n = in.nextInt();\n            String s = in.next();\n            int[] balance = new int[2 * n + 1];\n            for (int i = 0; i < 2 * n; ++i) {\n                int w = s.charAt(i) - 'a';\n                balance[i + 1] = balance[i] + 2 * w - 1;\n            }\n            int start = 0;\n            List<String> sections = new ArrayList<>();\n\n            for (int i = 1; i <= 2 * n; ++i)\n                if (balance[i] == 0) {\n                    String cur = solveSection(s.substring(start, i));\n                    while (!sections.isEmpty() && (sections.get(sections.size() - 1) + cur).compareTo(cur) < 0) {\n                        sections.remove(sections.size() - 1);\n                    }\n                    sections.add(cur);\n                    start = i;\n                }\n            for (String x : sections) out.print(x);\n            out.println();\n        }\n\n        private String solveSection(String s) {\n            if (s.charAt(0) == 'a') {\n                return solveASection(s);\n            } else {\n                return solveBSection(s);\n            }\n        }\n\n        private String solveBSection(String s) {\n            int n = s.length() / 2;\n            int[] cnt = new int[2];\n            int[] index = new int[2 * n];\n            int[][] where = new int[2][n];\n            for (int i = 0; i < 2 * n; ++i) {\n                int w = s.charAt(i) - 'a';\n                index[i] = cnt[w];\n                where[w][cnt[w]] = i;\n                ++cnt[w];\n            }\n            String res = \"\";\n            for (int first = 0; first < n; ++first) {\n                StringBuilder b = new StringBuilder();\n                for (int i = 0; i < 2 * n; ++i) if (index[i] >= first) b.append(s.charAt(i));\n                String t = b.toString();\n                if (t.compareTo(res) > 0) res = t;\n            }\n            return res;\n        }\n\n        private String solveASection(String s) {\n            int n = s.length() / 2;\n            int[] cnt = new int[2];\n            int[] index = new int[2 * n];\n            int[][] where = new int[2][n];\n            for (int i = 0; i < 2 * n; ++i) {\n                int w = s.charAt(i) - 'a';\n                index[i] = cnt[w];\n                where[w][cnt[w]] = i;\n                ++cnt[w];\n            }\n            StringBuilder res = new StringBuilder();\n            int atleast = 0;\n            for (int i = 0; i < 2 * n; ++i) {\n                if (s.charAt(i) == 'b') {\n                    int pa = where[0][index[i]];\n                    if (pa >= atleast) {\n                        res.append(\"ab\");\n                        atleast = i + 1;\n                    }\n                }\n            }\n            return res.toString();\n        }\n\n    }\n\n    static class InputReader {\n        public BufferedReader reader;\n        public StringTokenizer tokenizer;\n\n        public InputReader(InputStream stream) {\n            reader = new BufferedReader(new InputStreamReader(stream), 32768);\n            tokenizer = null;\n        }\n\n        public String next() {\n            while (tokenizer == null || !tokenizer.hasMoreTokens()) {\n                try {\n                    tokenizer = new StringTokenizer(reader.readLine());\n                } catch (IOException e) {\n                    throw new RuntimeException(e);\n                }\n            }\n            return tokenizer.nextToken();\n        }\n\n        public int nextInt() {\n            return Integer.parseInt(next());\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.io.PrintStream;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.io.IOException;\nimport java.util.stream.Collectors;\nimport java.util.ArrayList;\nimport java.io.UncheckedIOException;\nimport java.util.List;\nimport java.util.stream.Stream;\nimport java.io.Closeable;\nimport java.io.Writer;\nimport java.io.OutputStreamWriter;\nimport java.io.InputStream;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        Thread thread = new Thread(null, new TaskAdapter(), \"\", 1 << 29);\n        thread.start();\n        thread.join();\n    }\n\n    static class TaskAdapter implements Runnable {\n        @Override\n        public void run() {\n            InputStream inputStream = System.in;\n            OutputStream outputStream = System.out;\n            FastInput in = new FastInput(inputStream);\n            FastOutput out = new FastOutput(outputStream);\n            ESynchronizedSubsequence solver = new ESynchronizedSubsequence();\n            solver.solve(1, in, out);\n            out.close();\n        }\n    }\n\n    static class ESynchronizedSubsequence {\n        Debug debug = new Debug(false);\n\n        public void solve(int testNumber, FastInput in, FastOutput out) {\n            int n = in.readInt();\n            int[] s = new int[n * 2];\n            for (int i = 0; i < 2 * n; i++) {\n                s[i] = in.readChar() - 'a';\n            }\n            List<Block> blocks = new ArrayList<>(n);\n            int cur = 0;\n            int left = 0;\n            for (int i = 0; i < 2 * n; i++) {\n                if (s[i] == 0) {\n                    cur--;\n                } else {\n                    cur++;\n                }\n                if (cur == 0) {\n                    Block b = new Block();\n                    b.start = s[left];\n                    b.data = Arrays.copyOfRange(s, left, i + 1);\n                    left = i + 1;\n                    if (b.start == 0) {\n                        extractType0(b);\n                    } else {\n                        extractType1(b);\n                    }\n                    blocks.add(b);\n                }\n            }\n            debug.debug(\"blocks\", blocks);\n\n            List<Block> type1 = blocks.stream().filter(x -> x.start == 1).collect(Collectors.toList());\n            for (int i = 0; i < type1.size(); i++) {\n                type1.get(i).index = i;\n            }\n            type1.sort((a, b) -> {\n                int ans = -a.seq.compareTo(b.seq);\n                if (ans == 0) {\n                    ans = a.index - b.index;\n                }\n                return ans;\n            });\n\n            StringBuilder ans = new StringBuilder();\n            int now = 0;\n            for (Block b : type1) {\n                if (b.index < now) {\n                    continue;\n                }\n                ans.append(b.seq);\n                now = b.index + 1;\n            }\n            int tail = blocks.size();\n            while (tail > 0 && blocks.get(tail - 1).start == 0) {\n                tail--;\n            }\n            for (int i = tail; i < blocks.size(); i++) {\n                ans.append(blocks.get(i).seq);\n            }\n            for (int i = 0; i < ans.length(); i++) {\n                ans.setCharAt(i, (char) (ans.charAt(i) - '0' + 'a'));\n            }\n            out.println(ans.toString());\n        }\n\n        public String build(int[] data, boolean[] added) {\n            StringBuilder builder = new StringBuilder(data.length);\n            for (int i = 0; i < data.length; i++) {\n                if (added[i]) {\n                    builder.append(data[i]);\n                }\n            }\n            return builder.toString();\n        }\n\n        public int[][] getIndices(int[] data) {\n            int[][] indices = new int[2][data.length / 2];\n            int[] wpos = new int[2];\n            for (int i = 0; i < data.length; i++) {\n                indices[data[i]][wpos[data[i]]++] = i;\n            }\n            return indices;\n        }\n\n        public void extractType0(Block b) {\n            int[] data = b.data;\n            int[][] indices = getIndices(data);\n            StringBuilder ans = new StringBuilder(data.length);\n            int cur = 0;\n            for (int i = 0; i < data.length / 2; i++) {\n                if (cur <= indices[0][i]) {\n                    ans.append(\"01\");\n                    cur = indices[1][i] + 1;\n                }\n            }\n            b.seq = ans.toString();\n        }\n\n        public String max(String a, String b) {\n            return a.compareTo(b) >= 0 ? a : b;\n        }\n\n        public void extractType1(Block b) {\n            int[] data = b.data;\n            int[][] indices = getIndices(data);\n            boolean[] added = new boolean[data.length];\n            Arrays.fill(added, true);\n            String s = build(data, added);\n            for (int i = 0; i < data.length / 2; i++) {\n                added[indices[0][i]] = added[indices[1][i]] = false;\n                String cur = build(data, added);\n                s = max(s, cur);\n            }\n            b.seq = s;\n        }\n\n    }\n\n    static class Block {\n        int start;\n        int[] data;\n        int index;\n        String seq;\n\n        public String toString() {\n            return seq;\n        }\n\n    }\n\n    static class FastInput {\n        private final InputStream is;\n        private byte[] buf = new byte[1 << 13];\n        private int bufLen;\n        private int bufOffset;\n        private int next;\n\n        public FastInput(InputStream is) {\n            this.is = is;\n        }\n\n        private int read() {\n            while (bufLen == bufOffset) {\n                bufOffset = 0;\n                try {\n                    bufLen = is.read(buf);\n                } catch (IOException e) {\n                    bufLen = -1;\n                }\n                if (bufLen == -1) {\n                    return -1;\n                }\n            }\n            return buf[bufOffset++];\n        }\n\n        public void skipBlank() {\n            while (next >= 0 && next <= 32) {\n                next = read();\n            }\n        }\n\n        public int readInt() {\n            int sign = 1;\n\n            skipBlank();\n            if (next == '+' || next == '-') {\n                sign = next == '+' ? 1 : -1;\n                next = read();\n            }\n\n            int val = 0;\n            if (sign == 1) {\n                while (next >= '0' && next <= '9') {\n                    val = val * 10 + next - '0';\n                    next = read();\n                }\n            } else {\n                while (next >= '0' && next <= '9') {\n                    val = val * 10 - next + '0';\n                    next = read();\n                }\n            }\n\n            return val;\n        }\n\n        public char readChar() {\n            skipBlank();\n            char c = (char) next;\n            next = read();\n            return c;\n        }\n\n    }\n\n    static class Debug {\n        private boolean offline;\n        private PrintStream out = System.err;\n        static int[] empty = new int[0];\n\n        public Debug(boolean enable) {\n            offline = enable && System.getSecurityManager() == null;\n        }\n\n        public Debug debug(String name, Object x) {\n            return debug(name, x, empty);\n        }\n\n        public Debug debug(String name, Object x, int... indexes) {\n            if (offline) {\n                if (x == null || !x.getClass().isArray()) {\n                    out.append(name);\n                    for (int i : indexes) {\n                        out.printf(\"[%d]\", i);\n                    }\n                    out.append(\"=\").append(\"\" + x);\n                    out.println();\n                } else {\n                    indexes = Arrays.copyOf(indexes, indexes.length + 1);\n                    if (x instanceof byte[]) {\n                        byte[] arr = (byte[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof short[]) {\n                        short[] arr = (short[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof boolean[]) {\n                        boolean[] arr = (boolean[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof char[]) {\n                        char[] arr = (char[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof int[]) {\n                        int[] arr = (int[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof float[]) {\n                        float[] arr = (float[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof double[]) {\n                        double[] arr = (double[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else if (x instanceof long[]) {\n                        long[] arr = (long[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    } else {\n                        Object[] arr = (Object[]) x;\n                        for (int i = 0; i < arr.length; i++) {\n                            indexes[indexes.length - 1] = i;\n                            debug(name, arr[i], indexes);\n                        }\n                    }\n                }\n            }\n            return this;\n        }\n\n    }\n\n    static class FastOutput implements AutoCloseable, Closeable, Appendable {\n        private StringBuilder cache = new StringBuilder(10 << 20);\n        private final Writer os;\n\n        public FastOutput append(CharSequence csq) {\n            cache.append(csq);\n            return this;\n        }\n\n        public FastOutput append(CharSequence csq, int start, int end) {\n            cache.append(csq, start, end);\n            return this;\n        }\n\n        public FastOutput(Writer os) {\n            this.os = os;\n        }\n\n        public FastOutput(OutputStream os) {\n            this(new OutputStreamWriter(os));\n        }\n\n        public FastOutput append(char c) {\n            cache.append(c);\n            return this;\n        }\n\n        public FastOutput append(String c) {\n            cache.append(c);\n            return this;\n        }\n\n        public FastOutput println(String c) {\n            return append(c).println();\n        }\n\n        public FastOutput println() {\n            cache.append(System.lineSeparator());\n            return this;\n        }\n\n        public FastOutput flush() {\n            try {\n                os.append(cache);\n                os.flush();\n                cache.setLength(0);\n            } catch (IOException e) {\n                throw new UncheckedIOException(e);\n            }\n            return this;\n        }\n\n        public void close() {\n            flush();\n            try {\n                os.close();\n            } catch (IOException e) {\n                throw new UncheckedIOException(e);\n            }\n        }\n\n        public String toString() {\n            return cache.toString();\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.io.PrintWriter;\nimport java.io.BufferedWriter;\nimport java.util.InputMismatchException;\nimport java.io.IOException;\nimport java.io.Writer;\nimport java.io.OutputStreamWriter;\nimport java.io.InputStream;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n *\n * @author Egor Kulikov (egor@egork.net)\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        InputReader in = new InputReader(inputStream);\n        OutputWriter out = new OutputWriter(outputStream);\n        ESynchronizedSubsequence solver = new ESynchronizedSubsequence();\n        solver.solve(1, in, out);\n        out.close();\n    }\n\n    static class ESynchronizedSubsequence {\n        public void solve(int testNumber, InputReader in, OutputWriter out) {\n            int n = in.readInt();\n            String s = in.readString();\n            int[] a = new int[n];\n            int[] b = new int[n];\n            int atA = 0;\n            int atB = 0;\n            for (int i = 0; i < 2 * n; i++) {\n                if (s.charAt(i) == 'a') {\n                    a[atA++] = i;\n                } else {\n                    b[atB++] = i;\n                }\n            }\n            boolean canStartB = false;\n            for (int i = 0; i < n; i++) {\n                if (b[i] < a[i]) {\n                    canStartB = true;\n                }\n            }\n            if (!canStartB) {\n                int times = 0;\n                int at = -1;\n                for (int i = 0; i < n; i++) {\n                    if (a[i] > at) {\n                        times++;\n                        at = b[i];\n                    }\n                }\n                StringBuilder answer = new StringBuilder();\n                for (int i = 0; i < times; i++) {\n                    answer.append(\"ab\");\n                }\n                out.printLine(answer);\n                return;\n            }\n            String[] best = new String[n + 1];\n            best[n] = \"\";\n            for (int i = n - 1; i >= 0; i--) {\n                best[i] = best[i + 1];\n                if (a[i] < b[i]) {\n                    int j = n;\n                    while (a[j - 1] > b[i]) {\n                        j--;\n                    }\n                    best[i] = MiscUtils.max(best[i], \"ab\" + best[j]);\n                    continue;\n                }\n                int include = 1;\n                int lastA = a[i];\n                for (int j = i + 1; j < n; j++) {\n                    if (b[j] < lastA) {\n                        include++;\n                        lastA = a[j];\n                    }\n                }\n                StringBuilder varBuilder = new StringBuilder(2 * include);\n                int aa = i;\n                int bb = i;\n                for (int j = 0; j < 2 * include; j++) {\n                    if (aa == i + include) {\n                        varBuilder.append('b');\n                        bb++;\n                    } else if (bb == i + include) {\n                        varBuilder.append('a');\n                        aa++;\n                    } else if (a[aa] < b[bb]) {\n                        varBuilder.append('a');\n                        aa++;\n                    } else {\n                        varBuilder.append('b');\n                        bb++;\n                    }\n                }\n                String variant = varBuilder.toString() + best[i + include];\n                best[i] = MiscUtils.max(best[i], variant);\n            }\n            out.printLine(best[0]);\n        }\n\n    }\n\n    static class OutputWriter {\n        private final PrintWriter writer;\n\n        public OutputWriter(OutputStream outputStream) {\n            writer = new PrintWriter(new BufferedWriter(new OutputStreamWriter(outputStream)));\n        }\n\n        public OutputWriter(Writer writer) {\n            this.writer = new PrintWriter(writer);\n        }\n\n        public void print(Object... objects) {\n            for (int i = 0; i < objects.length; i++) {\n                if (i != 0) {\n                    writer.print(' ');\n                }\n                writer.print(objects[i]);\n            }\n        }\n\n        public void printLine(Object... objects) {\n            print(objects);\n            writer.println();\n        }\n\n        public void close() {\n            writer.close();\n        }\n\n    }\n\n    static class MiscUtils {\n        public static <T extends Comparable<T>> T max(T first, T second) {\n            if (first.compareTo(second) <= 0) {\n                return second;\n            }\n            return first;\n        }\n\n    }\n\n    static class InputReader {\n        private InputStream stream;\n        private byte[] buf = new byte[1024];\n        private int curChar;\n        private int numChars;\n        private InputReader.SpaceCharFilter filter;\n\n        public InputReader(InputStream stream) {\n            this.stream = stream;\n        }\n\n        public int read() {\n            if (numChars == -1) {\n                throw new InputMismatchException();\n            }\n            if (curChar >= numChars) {\n                curChar = 0;\n                try {\n                    numChars = stream.read(buf);\n                } catch (IOException e) {\n                    throw new InputMismatchException();\n                }\n                if (numChars <= 0) {\n                    return -1;\n                }\n            }\n            return buf[curChar++];\n        }\n\n        public int readInt() {\n            int c = read();\n            while (isSpaceChar(c)) {\n                c = read();\n            }\n            int sgn = 1;\n            if (c == '-') {\n                sgn = -1;\n                c = read();\n            }\n            int res = 0;\n            do {\n                if (c < '0' || c > '9') {\n                    throw new InputMismatchException();\n                }\n                res *= 10;\n                res += c - '0';\n                c = read();\n            } while (!isSpaceChar(c));\n            return res * sgn;\n        }\n\n        public String readString() {\n            int c = read();\n            while (isSpaceChar(c)) {\n                c = read();\n            }\n            StringBuilder res = new StringBuilder();\n            do {\n                if (Character.isValidCodePoint(c)) {\n                    res.appendCodePoint(c);\n                }\n                c = read();\n            } while (!isSpaceChar(c));\n            return res.toString();\n        }\n\n        public boolean isSpaceChar(int c) {\n            if (filter != null) {\n                return filter.isSpaceChar(c);\n            }\n            return isWhitespace(c);\n        }\n\n        public static boolean isWhitespace(int c) {\n            return c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n        }\n\n        public interface SpaceCharFilter {\n            public boolean isSpaceChar(int ch);\n\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.io.PrintWriter;\nimport java.io.BufferedWriter;\nimport java.util.InputMismatchException;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.io.Writer;\nimport java.io.OutputStreamWriter;\nimport java.util.Collections;\nimport java.io.InputStream;\n\n/**\n * Built using CHelper plug-in Actual solution is at the top\n *\n * @author ilyakor\n */\npublic class Main {\n\n  public static void main(String[] args) {\n    InputStream inputStream = System.in;\n    OutputStream outputStream = System.out;\n    InputReader in = new InputReader(inputStream);\n    OutputWriter out = new OutputWriter(outputStream);\n    TaskE solver = new TaskE();\n    solver.solve(1, in, out);\n    out.close();\n  }\n\n  static class TaskE {\n\n    public void solve(int testNumber, InputReader in, OutputWriter out) {\n      int n = in.nextInt();\n      String S = in.nextToken();\n      StringBuilder res = new StringBuilder();\n      int[] bal = new int[2 * n + 2];\n      while (S.length() > 0) {\n        char[] s = S.toCharArray();\n        int delta = 0, best = 0;\n        for (int i = 0; i < s.length; ++i) {\n          if (s[i] == 'b') {\n            ++delta;\n          } else {\n            --delta;\n          }\n          bal[i] = delta;\n          if (delta > bal[best]) {\n            best = i;\n          }\n        }\n        int numBest = bal[best];\n        if (numBest <= 0) {\n          res.append('a');\n          res.append('b');\n          int ca = 0;\n          int pos = 0;\n          Assert.assertTrue(s[pos] == 'a');\n          ArrayList<Integer> toRemove = new ArrayList<>();\n          while (s[pos] != 'b') {\n            toRemove.add(pos);\n            ++ca;\n            ++pos;\n          }\n          while (ca > 0) {\n            if (s[pos] == 'b') {\n              --ca;\n              toRemove.add(pos);\n            }\n            ++pos;\n          }\n          Collections.reverse(toRemove);\n          for (int x : toRemove) {\n            S = S.substring(0, x) + S.substring(x + 1);\n          }\n          continue;\n        }\n        String part = null;\n        int pi = -1;\n        for (int i = 0; i < s.length; ++i) {\n          if (bal[i] == numBest) {\n            StringBuilder cand = new StringBuilder();\n            int cb = numBest;\n            int j;\n            for (j = i + 1; ; ++j) {\n              if (s[j] == 'b') {\n                ++cb;\n              } else {\n                --cb;\n              }\n              cand.append(s[j]);\n              if (cb == 0) {\n                break;\n              }\n            }\n            if (part == null) {\n              part = cand.toString();\n              pi = j + 1;\n            } else if (part.compareTo(cand.toString()) < 0) {\n              part = cand.toString();\n              pi = j + 1;\n            }\n          }\n        }\n        for (int i = 0; i < numBest; ++i) {\n          res.append('b');\n        }\n        res.append(part);\n        S = S.substring(pi);\n      }\n      out.printLine(res.toString());\n    }\n\n  }\n\n  static class InputReader {\n\n    private InputStream stream;\n    private byte[] buffer = new byte[10000];\n    private int cur;\n    private int count;\n\n    public InputReader(InputStream stream) {\n      this.stream = stream;\n    }\n\n    public static boolean isSpace(int c) {\n      return c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n    }\n\n    public int read() {\n      if (count == -1) {\n        throw new InputMismatchException();\n      }\n      try {\n        if (cur >= count) {\n          cur = 0;\n          count = stream.read(buffer);\n          if (count <= 0) {\n            return -1;\n          }\n        }\n      } catch (IOException e) {\n        throw new InputMismatchException();\n      }\n      return buffer[cur++];\n    }\n\n    public int readSkipSpace() {\n      int c;\n      do {\n        c = read();\n      } while (isSpace(c));\n      return c;\n    }\n\n    public String nextToken() {\n      int c = readSkipSpace();\n      StringBuilder sb = new StringBuilder();\n      while (!isSpace(c)) {\n        sb.append((char) c);\n        c = read();\n      }\n      return sb.toString();\n    }\n\n    public int nextInt() {\n      int sgn = 1;\n      int c = readSkipSpace();\n      if (c == '-') {\n        sgn = -1;\n        c = read();\n      }\n      int res = 0;\n      do {\n        if (c < '0' || c > '9') {\n          throw new InputMismatchException();\n        }\n        res = res * 10 + c - '0';\n        c = read();\n      } while (!isSpace(c));\n      res *= sgn;\n      return res;\n    }\n\n  }\n\n  static class OutputWriter {\n\n    private final PrintWriter writer;\n\n    public OutputWriter(OutputStream outputStream) {\n      writer = new PrintWriter(new BufferedWriter(new OutputStreamWriter(outputStream)));\n    }\n\n    public OutputWriter(Writer writer) {\n      this.writer = new PrintWriter(writer);\n    }\n\n    public void print(Object... objects) {\n      for (int i = 0; i < objects.length; i++) {\n        if (i != 0) {\n          writer.print(' ');\n        }\n        writer.print(objects[i]);\n      }\n    }\n\n    public void printLine(Object... objects) {\n      print(objects);\n      writer.println();\n    }\n\n    public void close() {\n      writer.close();\n    }\n\n  }\n\n  static class Assert {\n\n    public static void assertTrue(boolean flag) {\n      // if (!flag)\n      // while (true);\n      if (!flag) {\n        throw new AssertionError();\n      }\n    }\n\n  }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\nusing System.Collections.Generic;\nusing Debug = System.Diagnostics.Debug;\nusing SB = System.Text.StringBuilder;\nusing System.Numerics;\nusing static System.Math;\nnamespace Program {\n    public class Solver {\n        Random rnd = new Random();\n        public void Solve() {\n            var n = ri;\n            var s = rs;\n            if (false)\n            {\n                n = 3000;\n                var otaku = Enumerate(2 * n, x => rnd.Next());\n                var pp = Enumerate(2 * n, x => x);\n                var sb = new SB();\n                foreach (var id in pp.OrderBy(x => otaku[x]))\n                    if (id % 2 == 0) sb.Append('a');\n                    else sb.Append('b');\n                s = sb.ToString();\n\n            }\n            var ptr = new int[2 * n];\n            var a = new List<int>();\n            var b = new List<int>();\n            for (int i = 0; i < s.Length; i++)\n            {\n                if (s[i] == 'a') { ptr[i] = a.Count; a.Add(i); }\n                else { ptr[i] = b.Count + n; b.Add(i); }\n            }\n            var dp = new string[2 * n + 1];\n            dp[2 * n] = \"\";\n            for (int i = s.Length - 1; i >= 0; i--)\n            {\n                dp[i] = dp[i + 1];\n                var p = ptr[i] % n;\n                if (Min(a[p], b[p]) != i) continue;\n                //a->b\n                if (ptr[i] < n)\n                {\n                    var t = \"ab\" + dp[b[p] + 1];\n                    if (string.CompareOrdinal(dp[i], t) < 0) dp[i] = t;\n                }\n                else\n                {\n                    var used = new bool[2 * n];\n                    var r = a[p];\n                    for (int j = p; j < n; j++)\n                    {\n                        var ll = b[j];\n                        if (ll < r)\n                        {\n                            used[ll] = true;\n                            r = a[j];\n                            used[ll] = true;\n                            used[r] = true;\n                        }\n                    }\n                    var sb = new SB();\n                    for (int j = 0; j < 2 * n; j++)\n                        if (used[j]) sb.Append(s[j]);\n                    sb.Append(dp[r + 1]);\n                    var t = sb.ToString();\n                    if (string.Compare(dp[i], t) < 0) dp[i] = t;\n\n                }\n            }\n            Console.WriteLine(dp[0]);\n        }\n        const long INF = 1L << 60;\n        int ri { get { return sc.Integer(); } }\n        long rl { get { return sc.Long(); } }\n        double rd { get { return sc.Double(); } }\n        string rs { get { return sc.Scan(); } }\n        public IO.StreamScanner sc = new IO.StreamScanner(Console.OpenStandardInput());\n\n        static T[] Enumerate<T>(int n, Func<int, T> f) {\n            var a = new T[n];\n            for (int i = 0; i < n; ++i) a[i] = f(i);\n            return a;\n        }\n        static public void Swap<T>(ref T a, ref T b) { var tmp = a; a = b; b = tmp; }\n    }\n}\n\n#region main\nstatic class Ex {\n    static public string AsString(this IEnumerable<char> ie) { return new string(ie.ToArray()); }\n    static public string AsJoinedString<T>(this IEnumerable<T> ie, string st = \" \") {\n        return string.Join(st, ie);\n    }\n    static public void Main() {\n        Console.SetOut(new Program.IO.Printer(Console.OpenStandardOutput()) { AutoFlush = false });\n        var solver = new Program.Solver();\n        solver.Solve();\n        Console.Out.Flush();\n    }\n}\n#endregion\n#region Ex\nnamespace Program.IO {\n    using System.IO;\n    using System.Text;\n    using System.Globalization;\n\n    public class Printer: StreamWriter {\n        public override IFormatProvider FormatProvider { get { return CultureInfo.InvariantCulture; } }\n        public Printer(Stream stream) : base(stream, new UTF8Encoding(false, true)) { }\n    }\n\n    public class StreamScanner {\n        public StreamScanner(Stream stream) { str = stream; }\n\n        public readonly Stream str;\n        private readonly byte[] buf = new byte[1024];\n        private int len, ptr;\n        public bool isEof = false;\n        public bool IsEndOfStream { get { return isEof; } }\n\n        private byte read() {\n            if (isEof) return 0;\n            if (ptr >= len)\n            {\n                ptr = 0;\n                if ((len = str.Read(buf, 0, 1024)) <= 0)\n                {\n                    isEof = true;\n                    return 0;\n                }\n            }\n            return buf[ptr++];\n        }\n\n        public char Char() {\n            byte b = 0;\n            do b = read(); while ((b < 33 || 126 < b) && !isEof);\n            return (char)b;\n        }\n        public string Scan() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b >= 33 && b <= 126; b = (char)read()) sb.Append(b);\n            return sb.ToString();\n        }\n        public string ScanLine() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b != '\\n' && b != 0; b = (char)read()) if (b != '\\r') sb.Append(b);\n            return sb.ToString();\n        }\n        public long Long() { return isEof ? long.MinValue : long.Parse(Scan()); }\n        public int Integer() { return isEof ? int.MinValue : int.Parse(Scan()); }\n        public double Double() { return isEof ? double.NaN : double.Parse(Scan(), CultureInfo.InvariantCulture); }\n    }\n}\n\n#endregion\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\nusing System.Collections.Generic;\nusing Debug = System.Diagnostics.Debug;\nusing SB = System.Text.StringBuilder;\nusing System.Numerics;\nusing static System.Math;\nnamespace Program {\n    public class Solver {\n        Random rnd = new Random();\n        public void Solve() {\n            var n = ri;\n            var s = rs;\n            var ptr = new int[2 * n];\n            var a = new List<int>();\n            var b = new List<int>();\n            for (int i = 0; i < s.Length; i++)\n            {\n                if (s[i] == 'a') { ptr[i] = a.Count; a.Add(i); }\n                else { ptr[i] = b.Count + n; b.Add(i); }\n            }\n            var dp = new string[2 * n + 1];\n            dp[2 * n] = \"\";\n            for (int i = s.Length - 1; i >= 0; i--)\n            {\n                dp[i] = dp[i + 1];\n                var p = ptr[i] % n;\n                if (Min(a[p], b[p]) != i) continue;\n                //a->b\n                if (ptr[i] < n)\n                {\n                    var t = \"ab\" + dp[b[p] + 1];\n                    if (string.CompareOrdinal(dp[i], t) < 0) dp[i] = t;\n                }\n                else\n                {\n                    var used = new bool[2 * n];\n                    var r = a[p];\n                    for (int j = p; j < n; j++)\n                        if (b[j] < r)\n                        {\n                            used[b[j]] = used[a[j]] = true;\n                            r = a[j];\n                        }\n                    var sb = new SB();\n                    for (int j = 0; j < 2 * n; j++)\n                        if (used[j]) sb.Append(s[j]);\n                    sb.Append(dp[r + 1]);\n                    var t = sb.ToString();\n                    if (string.CompareOrdinal(dp[i], t) < 0) dp[i] = t;\n\n                }\n            }\n            Console.WriteLine(dp[0]);\n        }\n        const long INF = 1L << 60;\n        int ri { get { return sc.Integer(); } }\n        long rl { get { return sc.Long(); } }\n        double rd { get { return sc.Double(); } }\n        string rs { get { return sc.Scan(); } }\n        public IO.StreamScanner sc = new IO.StreamScanner(Console.OpenStandardInput());\n\n        static T[] Enumerate<T>(int n, Func<int, T> f) {\n            var a = new T[n];\n            for (int i = 0; i < n; ++i) a[i] = f(i);\n            return a;\n        }\n        static public void Swap<T>(ref T a, ref T b) { var tmp = a; a = b; b = tmp; }\n    }\n}\n\n#region main\nstatic class Ex {\n    static public string AsString(this IEnumerable<char> ie) { return new string(ie.ToArray()); }\n    static public string AsJoinedString<T>(this IEnumerable<T> ie, string st = \" \") {\n        return string.Join(st, ie);\n    }\n    static public void Main() {\n        Console.SetOut(new Program.IO.Printer(Console.OpenStandardOutput()) { AutoFlush = false });\n        var solver = new Program.Solver();\n        solver.Solve();\n        Console.Out.Flush();\n    }\n}\n#endregion\n#region Ex\nnamespace Program.IO {\n    using System.IO;\n    using System.Text;\n    using System.Globalization;\n\n    public class Printer: StreamWriter {\n        public override IFormatProvider FormatProvider { get { return CultureInfo.InvariantCulture; } }\n        public Printer(Stream stream) : base(stream, new UTF8Encoding(false, true)) { }\n    }\n\n    public class StreamScanner {\n        public StreamScanner(Stream stream) { str = stream; }\n\n        public readonly Stream str;\n        private readonly byte[] buf = new byte[1024];\n        private int len, ptr;\n        public bool isEof = false;\n        public bool IsEndOfStream { get { return isEof; } }\n\n        private byte read() {\n            if (isEof) return 0;\n            if (ptr >= len)\n            {\n                ptr = 0;\n                if ((len = str.Read(buf, 0, 1024)) <= 0)\n                {\n                    isEof = true;\n                    return 0;\n                }\n            }\n            return buf[ptr++];\n        }\n\n        public char Char() {\n            byte b = 0;\n            do b = read(); while ((b < 33 || 126 < b) && !isEof);\n            return (char)b;\n        }\n        public string Scan() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b >= 33 && b <= 126; b = (char)read()) sb.Append(b);\n            return sb.ToString();\n        }\n        public string ScanLine() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b != '\\n' && b != 0; b = (char)read()) if (b != '\\r') sb.Append(b);\n            return sb.ToString();\n        }\n        public long Long() { return isEof ? long.MinValue : long.Parse(Scan()); }\n        public int Integer() { return isEof ? int.MinValue : int.Parse(Scan()); }\n        public double Double() { return isEof ? double.NaN : double.Parse(Scan(), CultureInfo.InvariantCulture); }\n    }\n}\n\n#endregion"
  },
  {
    "language": "Ruby",
    "code": "#\n# File    : E.rb\n# Author  : Kazune Takahashi\n# Created : 2018-7-16 13:05:22\n# Powered by Visual Studio Code\n#\n\nn = gets.to_i\ns = gets.chomp\n\nary = []\nwhile !(s == \"\")\n  a = 0\n  b = 0\n  for i in 0...s.size()\n    if s[i] == \"a\"\n      a += 1\n    else\n      b += 1\n    end\n    if a == b\n      ary << s[0..i]\n      s = s[i+1..-1]\n      break\n    end\n  end\nend\n\nans = []\n\nary.each{|str|\n  num = []\n  a = 0\n  b = 0\n  str.chars{|c|\n    if c == 'a'\n      num << a\n      a += 1\n    else\n      num << b\n      b += 1\n    end\n  }\n  if str[0] == \"a\"\n    res = \"\"\n    _a = true\n    search = nil\n    for i in 0..str.size\n      if _a && str[i] == 'a'\n        res += str[i]\n        search = num[i]\n        _a = false\n      else (!_a) && str[i] == 'b'\n        if num[i] == search\n          res += str[i]\n          _a = true\n        end\n      end\n    end\n    ans << res\n  else\n    res = []\n    for k in 0..str.size/2\n      temp = \"\"\n      for i in 0...str.size\n        if num[i] >= k\n          temp += str[i]\n        end\n      end\n      res << temp\n    end\n    ans << res.max\n  end\n}\n\nres = \"\"\n\nans.reverse.each{|str|\n  if res < str + res\n    res = str + res\n  end\n}\n\nputs res\n"
  },
  {
    "language": "Python",
    "code": "n = int(input())\ns = input()\n\nab_index = {'a': 0, 'b': 0}\nab_dic = {}\ni = 0\nwhile i < (2 * n):\n    ab_dic[i] = (s[i], ab_index[s[i]])\n    ab_index[s[i]] += 1\n    i += 1\n\nimport copy\n\n\nclass Info:\n    def __init__(self, string, includeds, excludeds):\n        self.string = string\n        self.includeds = includeds\n        self.excludeds = excludeds\n\n    def include(self, s, i):\n        dic = copy.copy(self.includeds)\n        dic[(s, i)] = True\n        return Info(self.string + s, dic, self.excludeds)\n\n    def exclude(self, s, i):\n        dic = copy.copy(self.excludeds)\n        dic[(s, i)] = True\n        return Info(self.string, self.includeds, dic)\n\n    def __repr__(self):\n        return '({0}, {1}, {2})'.format(self.string, self.includeds, self.excludeds)\n\n\n\ndp = [[None for _ in range(len(s) + 1)] for _ in range(len(s) + 1)]\ndp[0][0] = Info('', {}, {})\n\n\nfor i in range(len(s)):\n    ab, abi = ab_dic[i]\n    for j in range(i + 1):\n        inf = dp[i][j]\n        if inf is None:\n            continue\n        if inf.string == 'aa':\n            dp[i][j] = None\n            continue\n\n        if ab == 'a':\n            if inf.includeds.get(('b', abi)):\n                dp[i + 1][j + 1] = inf.include('a', abi)\n            elif inf.excludeds.get(('b', abi)):\n                candidate = inf.exclude('a', abi)\n\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('a', abi)\n\n                candidate = inf.exclude('a', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n        if ab == 'b':\n            if inf.includeds.get(('a', abi)):\n                dp[i + 1][j + 1] = inf.include('b', abi)\n            elif inf.excludeds.get(('a', abi)):\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('b', abi)\n\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n\n\nprint(sorted(map(lambda x: x.string, filter(lambda x: x is not None, dp[-1])))[-1])\n"
  },
  {
    "language": "Python",
    "code": "import bisect\nfrom itertools import accumulate, combinations\n\n\ndef search_ab(sss, cursor):\n    ai = aaa.index(cursor)\n    tmp_cur = bbb[ai]\n    repeat = 1\n    while sss[tmp_cur] < 0:\n        repeat += 1\n        ai = bisect.bisect(aaa, tmp_cur, lo=ai)\n        if ai >= n:\n            tmp_cur = n2 - 1\n            break\n        tmp_cur = bbb[ai]\n    return 'ab' * repeat, tmp_cur + 1\n\n\ndef search_ba(sss, cursor):\n    first_bi = bbb.index(cursor)\n    last_cursor = sss.index(0, cursor)\n    last_bi = aaa.index(last_cursor)\n\n    tmp_buf = [''] * (last_bi - first_bi + 1) * 2\n    tmp_max = ''\n    for i in range(last_bi, first_bi - 1, -1):\n        tmp_buf[aaa[i] - cursor] = 'a'\n        tmp_buf[bbb[i] - cursor] = 'b'\n        tmp = ''.join(tmp_buf)\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max, last_cursor + 1\n\n\ndef integrate(parts_a, parts_b):\n    if not parts_b:\n        return ''.join(parts_a)\n    tmp_max = ''\n    for k in range(1, len(parts_b) + 1):\n        for cmb in combinations(parts_b, k):\n            tmp = ''.join(cmb)\n            if tmp > tmp_max:\n                tmp_max = tmp\n    return tmp_max\n\n\nn = int(input())\ns = input()\n\n# n = 10\n# s = ['a', 'b'] * n\n# import random\n#\n# random.seed(4)\n# random.shuffle(s)\n# s = ''.join(s)\n# print(s)\n\nn2 = n * 2\nsss = []\naaa, bbb = [], []\nfor i, c in enumerate(s):\n    if c == 'a':\n        aaa.append(i)\n        sss.append(-1)\n    else:\n        bbb.append(i)\n        sss.append(1)\nsss = list(accumulate(sss))\nparts_a = []\nparts_b = []\ncursor = 0\nwhile cursor < n2:\n    c = sss[cursor]\n    if c < 0:\n        tmp, cursor = search_ab(sss, cursor)\n        parts_a.append(tmp)\n    else:\n        tmp, cursor = search_ba(sss, cursor)\n        parts_b.append(tmp)\nprint(integrate(parts_a, parts_b))\n"
  },
  {
    "language": "Python",
    "code": "from itertools import accumulate\n\n\ndef search_ab(sss, cursor):\n    # print('a', cursor)\n    ai = aaa.index(cursor)\n    tmp_cur = bbb[ai]\n    max_cur = sss.index(0, cursor)\n    repeat = 1\n    while tmp_cur < max_cur:\n        cur = s.find('a', tmp_cur, max_cur)\n        if cur == -1:\n            break\n        ai = aaa.index(cur, ai)\n        tmp_cur = bbb[ai]\n        repeat += 1\n    return repeat, max_cur + 1\n\n\ndef search_ba(sss, cursor):\n    # print('b', cursor)\n    first_bi = bbb.index(cursor)\n    max_cursor = sss.index(0, cursor)\n    last_bi = aaa.index(max_cursor)\n\n    tmp_buf = [''] * (last_bi - first_bi + 1) * 2\n    tmp_max = ''\n    for i in range(last_bi, first_bi - 1, -1):\n        tmp_buf[aaa[i] - cursor] = 'a'\n        tmp_buf[bbb[i] - cursor] = 'b'\n        tmp = ''.join(tmp_buf)\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max, max_cursor + 1\n\n\ndef integrate(parts_b):\n    tmp_max = ''\n    for pb in reversed(parts_b):\n        tmp = pb + tmp_max\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max\n\n\nn = int(input())\ns = input()\n\nn2 = n * 2\nsss = []\naaa, bbb = [], []\nfor i, c in enumerate(s):\n    if c == 'a':\n        aaa.append(i)\n        sss.append(-1)\n    else:\n        bbb.append(i)\n        sss.append(1)\nsss = list(accumulate(sss))\nrepeats_a = []\nparts_b = []\nlast_b_cur = 0\ncursor = 0\nwhile cursor < n2:\n    c = sss[cursor]\n    if c < 0:\n        repeat, cursor = search_ab(sss, cursor)\n        repeats_a.append((cursor, repeat))\n    else:\n        tmp, cursor = search_ba(sss, cursor)\n        parts_b.append(tmp)\n        last_b_cur = cursor\nprint(integrate(parts_b) + 'ab' * sum(r for c, r in repeats_a if c > last_b_cur))\n"
  },
  {
    "language": "Python",
    "code": "from itertools import accumulate\n\n\ndef search_ab(sss, cursor):\n    # print('a', cursor)\n    ai = aaa.index(cursor)\n    tmp_cur = bbb[ai]\n    max_cur = sss.index(0, cursor)\n    repeat = 1\n    while tmp_cur < max_cur:\n        cur = s.find('a', tmp_cur, max_cur)\n        if cur == -1:\n            break\n        ai = aaa.index(cur, ai)\n        tmp_cur = bbb[ai]\n        repeat += 1\n    return repeat, max_cur + 1\n\n\ndef search_ba(sss, cursor):\n    # print('b', cursor)\n    first_bi = bbb.index(cursor)\n    max_cursor = sss.index(0, cursor)\n    last_bi = aaa.index(max_cursor)\n\n    tmp_buf = [''] * (last_bi - first_bi + 1) * 2\n    tmp_max = ''\n    for i in range(last_bi, first_bi - 1, -1):\n        tmp_buf[aaa[i] - cursor] = 'a'\n        tmp_buf[bbb[i] - cursor] = 'b'\n        tmp = ''.join(tmp_buf)\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max, max_cursor + 1\n\n\ndef integrate(parts_b):\n    tmp_max = ''\n    for pb in reversed(parts_b):\n        tmp = pb + tmp_max\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max\n\n\nn = int(input())\ns = input()\n\nn2 = n * 2\nsss = []\naaa, bbb = [], []\nfor i, c in enumerate(s):\n    if c == 'a':\n        aaa.append(i)\n        sss.append(-1)\n    else:\n        bbb.append(i)\n        sss.append(1)\nsss = list(accumulate(sss))\nrepeat_a = 0\nparts_b = []\ncursor = 0\nwhile cursor < n2:\n    c = sss[cursor]\n    if c < 0:\n        repeat, cursor = search_ab(sss, cursor)\n        repeat_a += repeat\n    else:\n        tmp, cursor = search_ba(sss, cursor)\n        parts_b.append(tmp)\nif parts_b:\n    print(integrate(parts_b))\nelse:\n    print('ab' * repeat_a)\n"
  },
  {
    "language": "Python",
    "code": "n = int(input())\ns = input()\n\nab_index = {'a': 0, 'b': 0}\nab_dic = {}\ni = 0\nwhile i < (2 * n):\n    ab_dic[i] = (s[i], ab_index[s[i]])\n    ab_index[s[i]] += 1\n    i += 1\n\nimport copy\n\n\nclass Info:\n    def __init__(self, string, includeds, excludeds):\n        self.string = string\n        self.includeds = includeds\n        self.excludeds = excludeds\n\n    def include(self, s, i):\n        dic = copy.copy(self.includeds)\n        dic[(s, i)] = True\n        return Info(self.string + s, dic, self.excludeds)\n\n    def exclude(self, s, i):\n        dic = copy.copy(self.excludeds)\n        dic[(s, i)] = True\n        return Info(self.string, self.includeds, dic)\n\n    def __repr__(self):\n        return '({0}, {1}, {2})'.format(self.string, self.includeds, self.excludeds)\n\n\n\ndp = [[None for _ in range(len(s) + 1)] for _ in range(len(s) + 1)]\ndp[0][0] = Info('', {}, {})\n\n\nfor i in range(len(s)):\n    ab, abi = ab_dic[i]\n    for j in range(i + 1):\n        inf = dp[i][j]\n        if inf is None:\n            continue\n\n        if ab == 'a':\n            if inf.includeds.get(('b', abi)):\n                dp[i + 1][j + 1] = inf.include('a', abi)\n            elif inf.excludeds.get(('b', abi)):\n                candidate = inf.exclude('a', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('a', abi)\n\n                candidate = inf.exclude('a', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n        if ab == 'b':\n            if inf.includeds.get(('a', abi)):\n                dp[i + 1][j + 1] = inf.include('b', abi)\n            elif inf.excludeds.get(('a', abi)):\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('b', abi)\n\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n\nprint(sorted(map(lambda x: x.string, filter(lambda x: x is not None, dp[-1])))[-1])\n"
  },
  {
    "language": "Python",
    "code": "N=int(input())\nidx=[[0,0]for _ in[0]*N]\na=b=0\nfor k,x in enumerate(input()):\n    if x=='a':\n        idx[a][0]=k\n        a+=1\n    else:\n        idx[b][1]=k\n        b+=1\nres=[]\nfor i in range(1,2**N):\n    tmp=[0]*2*N\n    for k in range(N):\n        if (i>>k)&1:\n            a,b=idx[k]\n            tmp[a]='a'\n            tmp[b]='b'\n    res+=[''.join(c for c in tmp if c)]\nprint(max(res))"
  },
  {
    "language": "Python",
    "code": "from itertools import accumulate\n\n\ndef search_ab(sss, cursor):\n    # print('a', cursor)\n    ai = aaa.index(cursor)\n    tmp_cur = bbb[ai]\n    max_cur = sss.index(0, cursor)\n    repeat = 1\n    while tmp_cur < max_cur:\n        cur = s.find('a', tmp_cur, max_cur)\n        if cur == -1:\n            tmp_cur = max_cur\n            break\n        ai = aaa.index(cur)\n        tmp_cur = bbb[ai]\n        repeat += 1\n    return repeat, tmp_cur + 1\n\n\ndef search_ba(sss, cursor):\n    # print('b', cursor)\n    first_bi = bbb.index(cursor)\n    last_cursor = sss.index(0, cursor)\n    last_bi = aaa.index(last_cursor)\n\n    tmp_buf = [''] * (last_bi - first_bi + 1) * 2\n    tmp_max = ''\n    for i in range(last_bi, first_bi - 1, -1):\n        tmp_buf[aaa[i] - cursor] = 'a'\n        tmp_buf[bbb[i] - cursor] = 'b'\n        tmp = ''.join(tmp_buf)\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max, last_cursor + 1\n\n\ndef integrate(parts_b):\n    tmp_max = ''\n    for pb in reversed(parts_b):\n        tmp = pb + tmp_max\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max\n\n\nn = int(input())\ns = input()\n\nn2 = n * 2\nsss = []\naaa, bbb = [], []\nfor i, c in enumerate(s):\n    if c == 'a':\n        aaa.append(i)\n        sss.append(-1)\n    else:\n        bbb.append(i)\n        sss.append(1)\nsss = list(accumulate(sss))\nrepeat_a = 0\nparts_b = []\ncursor = 0\nwhile cursor < n2:\n    c = sss[cursor]\n    if c < 0:\n        repeat, cursor = search_ab(sss, cursor)\n        repeat_a += repeat\n    else:\n        tmp, cursor = search_ba(sss, cursor)\n        parts_b.append(tmp)\nif parts_b:\n    print(integrate(parts_b))\nelse:\n    print('ab' * repeat_a)\n"
  },
  {
    "language": "Python",
    "code": "import bisect\nfrom itertools import accumulate, combinations\n\n\ndef search_ab(sss, cursor):\n    ai = aaa.index(cursor)\n    tmp_cur = bbb[ai]\n    repeat = 1\n    while sss[tmp_cur] < 0:\n        repeat += 1\n        ai = bisect.bisect(aaa, tmp_cur, lo=ai)\n        tmp_cur = bbb[ai]\n    return 'ab' * repeat, tmp_cur + 1\n\n\ndef search_ba(sss, cursor):\n    first_bi = bbb.index(cursor)\n    last_cursor = sss.index(0, cursor)\n    last_bi = aaa.index(last_cursor)\n\n    tmp_buf = [''] * (last_bi - first_bi + 1) * 2\n    tmp_max = ''\n    for i in range(last_bi, first_bi - 1, -1):\n        tmp_buf[aaa[i] - cursor] = 'a'\n        tmp_buf[bbb[i] - cursor] = 'b'\n        tmp = ''.join(tmp_buf)\n        if tmp > tmp_max:\n            tmp_max = tmp\n    return tmp_max, last_cursor + 1\n\n\ndef integrate(parts_a, parts_b):\n    if not parts_b:\n        return ''.join(parts_a)\n    tmp_max = ''\n    for k in range(1, len(parts_b) + 1):\n        for cmb in combinations(parts_b, k):\n            tmp = ''.join(cmb)\n            if tmp > tmp_max:\n                tmp_max = tmp\n    return tmp_max\n\n\nn = int(input())\nn2 = n * 2\ns = input()\nsss = []\naaa, bbb = [], []\nfor i, c in enumerate(s):\n    if c == 'a':\n        aaa.append(i)\n        sss.append(-1)\n    else:\n        bbb.append(i)\n        sss.append(1)\nsss = list(accumulate(sss))\nparts_a = []\nparts_b = []\ncursor = 0\nwhile cursor < n2:\n    c = sss[cursor]\n    if c < 0:\n        tmp, cursor = search_ab(sss, cursor)\n        parts_a.append(tmp)\n    else:\n        tmp, cursor = search_ba(sss, cursor)\n        parts_b.append(tmp)\nprint(integrate(parts_a, parts_b))\n"
  },
  {
    "language": "Python",
    "code": "n = int(input())\ns = input()\n\nab_index = {'a': 0, 'b': 0}\nab_dic = {}\ni = 0\nwhile i < (2 * n):\n    ab_dic[i] = (s[i], ab_index[s[i]])\n    ab_index[s[i]] += 1\n    i += 1\n\nimport copy\n\n\nclass Info:\n    def __init__(self, string, includeds, excludeds):\n        self.string = string\n        self.includeds = includeds\n        self.excludeds = excludeds\n\n    def include(self, s, i):\n        dic = copy.copy(self.includeds)\n        dic[(s, i)] = True\n        return Info(self.string + s, dic, self.excludeds)\n\n    def exclude(self, s, i):\n        dic = copy.copy(self.excludeds)\n        dic[(s, i)] = True\n        return Info(self.string, self.includeds, dic)\n\n    def __repr__(self):\n        return '({0}, {1}, {2})'.format(self.string, self.includeds, self.excludeds)\n\n\n\ndp: [[Info]] = [[None for _ in range(len(s) + 1)] for _ in range(len(s) + 1)]\ndp[0][0] = Info('', {}, {})\n\n\nfor i in range(len(s)):\n    ab, abi = ab_dic[i]\n    for j in range(i + 1):\n        inf = dp[i][j]\n        if inf is None:\n            continue\n\n        if ab == 'a':\n            if inf.includeds.get(('b', abi)):\n                dp[i + 1][j + 1] = inf.include('a', abi)\n            elif inf.excludeds.get(('b', abi)):\n                candidate = inf.exclude('a', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('a', abi)\n\n                candidate = inf.exclude('a', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string <= candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n        if ab == 'b':\n            if inf.includeds.get(('a', abi)):\n                dp[i + 1][j + 1] = inf.include('b', abi)\n            elif inf.excludeds.get(('a', abi)):\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n            else:\n                dp[i + 1][j + 1] = inf.include('b', abi)\n\n                candidate = inf.exclude('b', abi)\n                if dp[i + 1][j] is None:\n                    dp[i + 1][j] = candidate\n                else:\n                    if dp[i + 1][j].string < candidate.string:\n                        dp[i + 1][j] = candidate\n                    else:\n                        pass\n\nprint(sorted(map(lambda x: x.string, filter(lambda x: x is not None, dp[-1])))[-1])\n"
  },
  {
    "language": "Rust",
    "code": "#[allow(unused_imports)]\nuse std::cmp::{min,max};\n#[allow(unused_imports)]\nuse std::collections::BTreeMap;\n#[allow(unused_imports)]\nuse std::ops::*;\n#[allow(unused_imports)]\nuse std::collections::BinaryHeap;\n\n#[allow(unused_macros)]\nmacro_rules! tf {\n    ($c:expr, $t:expr, $f:expr) => {{\n        if $c { $t } else { $f }\n    }};\n}\n\nfn main() {\n    let n = read_i64() as usize;\n    let ss: Vec<u8> = read_line().bytes().collect();\n    let mut xs = vec![0; 2*n+1];\n    for i in 0..2*n {\n        xs[i+1] = xs[i] + tf!(ss[i] == b'a', 1, -1);\n    }\n    let ys = {\n        let mut ys: Vec<Vec<u8>> = vec![];\n        let mut buf = vec![];\n        for i in 0..2*n+1 {\n            if i == 2*n || xs[i] == 0 {\n                if ! buf.is_empty() {\n                    ys.push(buf.clone());\n                    buf.clear();\n                }\n            }\n            if i != 2 * n {\n                buf.push(ss[i]);\n            }\n        }\n        ys\n    };\n    let zs: Vec<Vec<u8>> = ys.iter().map(|y| {\n        let mut ai = vec![];\n        let mut bi = vec![];\n        let mut si = vec![];\n        for (i,&c) in y.iter().enumerate() {\n            match c {\n                b'a' => {\n                    si.push(ai.len());\n                    ai.push(i);\n                }\n                b'b' => {\n                    si.push(bi.len());\n                    bi.push(i);\n                }\n                _ => {\n                    panic!();\n                }\n            }\n        }\n        let mut res: Vec<u8> = vec![];\n        match y[0] {\n            b'a' => {\n                let mut prev = b'b';\n                let mut valid: Vec<bool> = vec![true; y.len()];\n                for (i,&c) in y.iter().enumerate() {\n                    if ! valid[i] {\n                        continue;\n                    }\n                    if c == prev {\n                        match c {\n                            b'a' => {\n                                valid[bi[si[i]]] = false;\n                            }\n                            b'b' => {\n                                valid[ai[si[i]]] = false;\n                            }\n                            _ => {\n                                panic!();\n                            }\n                        }\n                    }\n                    else {\n                        res.push(c);\n                        prev = c;\n                    }\n                }\n            }\n            b'b' => {\n                let mut valid = vec![true; y.len()];\n                for i in 0..y.len() {\n                    if ! valid[i] {\n                        continue;\n                    }\n                    if y[i] == b'b' {\n                        let mut buf = vec![];\n                        for k in i..y.len() {\n                            if ! valid[k] {\n                                continue;\n                            }\n                            buf.push(y[k]);\n                            if res < buf {\n                                res = buf.clone();\n                            }\n                        }\n                        valid[ai[si[i]]] = false;\n                    }\n                }\n            }\n            _ => {\n                panic!();\n            }\n        }\n        res\n    }).collect();\n    //eprintln!(\"{:?}\", ys);\n    //eprintln!(\"{:?}\", zs);\n    let mut res = vec![];\n    for z in zs.iter().rev() {\n        let mut buf = z.clone();\n        for &c in &res {\n            buf.push(c);\n        }\n        if res < buf {\n            res = buf.clone();\n        }\n    }\n    println!(\"{}\", std::str::from_utf8(&res).unwrap());\n}\n\n#[allow(dead_code)]\nfn read_line() -> String {\n    let mut ret = String::new();\n    std::io::stdin().read_line(&mut ret).ok();\n    ret.pop();\n    return ret;\n}\n\n#[allow(dead_code)]\nfn read_i64() -> i64 {\n    let ss = read_line();\n    return ss.parse::<i64>().unwrap();\n}\n\n#[allow(dead_code)]\nfn read_vec_i64() -> Vec<i64> {\n    let mut res = vec![];\n    let ss = read_line();\n    for ts in ss.split_whitespace() {\n        let x = ts.parse::<i64>().unwrap();\n        res.push(x);\n    }\n    return res;\n}\n\nuse std::fmt::Display;\n#[allow(dead_code)]\nfn write_vec<T: Display>(xs: &Vec<T>) {\n    if xs.len() == 0 {\n        println!(\"\");\n        return;\n    }\n    print!(\"{}\", xs[0]);\n    for i in 1..xs.len() {\n        print!(\" {}\", xs[i]);\n    }\n    println!(\"\");\n}\n"
  }
]