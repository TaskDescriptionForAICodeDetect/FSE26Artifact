You are a programmer working at a post office on an archipelago, where each island has port towns and possibly other towns or villages. To travel between islands, you must use a boat, while land routes can be used within an island but sometimes using the sea is faster. Due to privatization, there is only one mail carrier left, Mr. Rito, who requires help in determining the most efficient route for mail collection based on a given sequence of towns and villages. The task is to write a program that calculates the shortest traveling time for Mr. Rito to visit these locations in order while adhering to specific movement restrictions, including returning to the last visited port town if utilizing sea routes.