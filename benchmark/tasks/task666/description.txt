In a two-dimensional plane, we have a rectangle R whose vertices are (0,0), (W,0), (0,H), and (W,H), where W and H are positive integers. The task is to find the number of triangles Δ in the plane that meet the following conditions: Each vertex of Δ is a grid point, meaning it has integer x- and y-coordinates. Δ and R share no vertex. Each vertex of Δ lies on the perimeter of R, and all vertices belong to different sides of R. Δ contains at most K grid points strictly within itself, excluding its perimeter and vertices.