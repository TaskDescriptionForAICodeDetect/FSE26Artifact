There are N blocks arranged in a row. We need to paint these blocks using one of M colors. Two ways of painting are considered different if at least one block is painted in a different color. The task is to find the number of ways to paint the blocks under the conditions that at most K pairs of adjacent blocks may be painted in the same color. Since the count may be enormous, the result should be printed modulo 998244353.