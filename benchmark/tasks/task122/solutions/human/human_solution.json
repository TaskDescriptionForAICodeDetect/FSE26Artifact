[
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nusing ll = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;};\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;};\n\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(0);\n\n  Int m,n;\n  cin>>m>>n;\n  vector<Int> ws(m),ts(m);\n  for(Int i=0;i<m;i++) cin>>ws[i]>>ts[i];\n\n  vector<Int> cs(n),bs(n);\n  for(Int i=0;i<n;i++) cin>>cs[i]>>bs[i];\n\n  vector<Int> sw(m+1,0),st(m+1,0);\n  for(Int i=0;i<m;i++){\n    sw[i+1]=sw[i]+ws[i];\n    st[i+1]=st[i]+ts[i];\n  }\n  \n  Int s=1<<n;\n  const Int INF = 1e9;\n  vector<Int> dp(s,-INF);\n  dp[0]=0;\n  for(Int b=0;b<s;b++){\n    for(Int i=0;i<n;i++){\n      if((b>>i)&1) continue;\n      Int nb=b|(1<<i);\n      Int x=upper_bound(sw.begin(),sw.end(),sw[dp[b]]+cs[i])-sw.begin();\n      Int y=upper_bound(st.begin(),st.end(),st[dp[b]]+bs[i])-st.begin();\n      chmax(dp[nb],min(x,y)-1);\n    }\n  }  \n  cout<<dp[s-1]<<endl;\n  return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint sumw[200001], sumt[200001];\nint c[15], b[15];\n\nint main() {\n\n  int M, N; cin >> M >> N;\n  rep(i, M) {\n    scanf(\"%d%d\", &sumw[i+1], &sumt[i+1]);\n    sumw[i+1] += sumw[i];\n    sumt[i+1] += sumt[i];\n  }\n  rep(i, N) {\n    cin >> c[i] >> b[i];\n  }\n\n  int dp[1<<N]; zero(dp);\n\n  rep(S, 1<<N) {\n    rep(i, N) {\n      if(S >> i & 1) { continue; }\n      int k = upper_bound(sumw + dp[S], sumw + M + 1, c[i] + sumw[dp[S]]) - sumw - 1;\n      int l = upper_bound(sumt + dp[S], sumt + M + 1, b[i] + sumt[dp[S]]) - sumt - 1;\n      dp[S|(1<<i)] = max(dp[S|(1<<i)], min(k, l));\n    }\n  }\n\n  cout << dp[(1<<N)-1] << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nstruct book {\n    int w;\n    int t;\n};\n\nint binSearch(vector<book> &c_sum, int start, book limit) {\n    int ok = start;\n    int ng = c_sum.size();\n\n    while (ng - ok > 1) {\n        int mid = ok + (ng - ok) / 2;\n\n        if (c_sum[mid].w - c_sum[start].w <= limit.w &&\n            c_sum[mid].t - c_sum[start].t <= limit.t) {\n            ok = mid;\n        } else {\n            ng = mid;\n        }\n    }\n    return ok;\n}\n\nint main() {\n    int m, n;\n    cin >> m >> n;\n\n    vector<book> c_sum(m + 1);\n    for (int i = 0; i < m; i++) {\n        book now;\n        cin >> now.w >> now.t;\n\n        c_sum[i + 1].w = c_sum[i].w + now.w;\n        c_sum[i + 1].t = c_sum[i].t + now.t;\n    }\n\n    vector<book> shelf(n);\n    for (int i = 0; i < n; i++)cin >> shelf[i].w >> shelf[i].t;\n\n    vector<int> dp(1 << n, -1145141919);\n    dp[0] = 0;\n    for (int i = 1; i < 1 << n; i++) {\n        for (int j = 0; j < n; j++) {\n            if (i & (1 << j)) {\n                int back = i ^(1 << j);\n                dp[i] = max(dp[i], binSearch(c_sum, dp[back], shelf[j]));\n            }\n        }\n    }\n\n    int ret = 0;\n    for (int i = 0; i < 1 << n; i++)ret = max(ret, dp[i]);\n    cout << ret << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <iomanip>\n#include <numeric>\n#include <cmath>\n#include <cassert>\n#include <complex>\n#define repi(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) repi(i, 0, n)\n#define endl \"\\n\"\n#define ing long long\nusing namespace std;\nusing ll = long long;\nconst int INF = 1<<30;\nconst int MOD = (int)1e9 + 7;\nconst int MAX_N = (int)1e5 + 5;\n#define debug(x) cout << #x << \": \" << x << endl\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2>& p) { os << p.first << \" \" << p.second; return os; }\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) { for(int i = 0; i < (int) v.size(); i++) os << v[i] << (i + 1 != v.size() ? \" \" : \"\"); return os; }\n\n#define w first\n#define t second\n#define c first\n#define d second\n\nsigned main(void)\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int M, N;\n    vector<pair<int,int>> in, cd;\n    vector<int> dp, sum1, sum2;\n\n    cin>>M>>N;\n\n    in.resize(M);\n    sum1.resize(M+1,0);\n    sum2.resize(M+1,0);\n    cd.resize(N);\n    dp.resize((1<<N) + 10);\n    \n    for(int i = 0; i < M; i++){\n        cin>>in[i].w>>in[i].t;\n        sum1[i+1] += in[i].w;\n        sum2[i+1] += in[i].t;\n        sum1[i+1] += sum1[i];\n        sum2[i+1] += sum2[i];\n        // cout<<\"i = \"<<i+1<<\" sum1 \"<<sum1[i+1]<<endl;\n        // \n        // cout<<\"i = \"<<i+1<<\" sum2 \"<<sum2[i+1]<<endl;\n    }\n\n    for(int i = 0; i < N; i++){\n        cin>>cd[i].c>>cd[i].d;\n    }\n\n    dp[0] = -1;\n\n    for(int i = 1; i < (1<<N); i++){\n        int maximum = -1 ;\n        for(int j = 0; j < N; j++){\n            int bit = i&(~(1<<j));\n            \n            //cout<<\"bit = \"<<bit<<\" \"<<i<<endl;\n            if(bit == i) continue;\n            int num = dp[bit];\n            int W = 0, T = 0;\n            maximum = max(num, maximum);\n            int x = 0,  y = 0;\n\n            if(num == M-1){\n                cout<<M<<endl;\n                return 0;\n            }\n            //if(num != -1)\n                x = sum1[num+1] +cd[j].c;\n                //if(num != -1)\n                y = sum2[num+1]+ cd[j].d;\n            \n            /*\n            for(int k = num+1; k < M; k++){\n                W += in[k].w;\n                T += in[k].t;\n                if(W > cd[j].c || T > cd[j].d) break;\n\n                maximum = max(k,maximum);\n            }\n\n            */\n            int temp1 = upper_bound(sum1.begin(), sum1.end(), x) - sum1.begin();\n            int temp2 = upper_bound(sum2.begin(), sum2.end(), y) - sum2.begin();\n            // cout<<i<<\" \"<<j<<\" \"<<temp1<<\" \"<<temp2<<endl;\n            // cout<<\"x = \"<<x<<\" y = \"<<y<<\" num = \"<<num<<\" temp = \"<<min(temp1,temp2)-1<<endl;\n            maximum = max(min(temp1,temp2)-2, maximum);\n            \n        }\n        dp[i] = maximum;\n        //cout<<i<<\" \"<<maximum<<endl;\n    }\n\n    cout<<dp[(1<<N)-1]+1<<endl;\n    \n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<int>sumws;\nvector<int>sumts;\nvector<int>maxcs;\nvector<int>maxbs;\nint memo[1 << 15];\nint getans(bitset<15>&bs) {\n\tif (memo[bs.to_ulong()] != -1)return memo[bs.to_ulong()];\n\tif (bs.count() == 1) {\n\t\tfor (int i = 0; i < 15; ++i) {\n\t\t\tif (bs[i]) {\n\t\t\t\tauto it = upper_bound(sumws.begin(), sumws.end(), maxcs[i]);\n\t\t\t\tauto jt = upper_bound(sumts.begin(), sumts.end(), maxbs[i]);\n\t\t\t\treturn min(it - sumws.begin(), jt - sumts.begin()) - 1;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < 15; ++i) {\n\t\t\tif (bs[i]) {\n\t\t\t\tbs[i] = false;\n\t\t\t\tint preread=getans(bs);\n\t\t\t\tconst int noww = sumws[preread];\n\t\t\t\tconst int nowt = sumts[preread];\n\n\t\t\t\tauto it = upper_bound(sumws.begin(), sumws.end(), noww+maxcs[i]);\n\t\t\t\tauto jt = upper_bound(sumts.begin(), sumts.end(), nowt+maxbs[i]);\n\t\t\t\tconst int nowread= min(it - sumws.begin(), jt - sumts.begin()) - 1;\n\t\t\t\tans = max(ans, nowread);\n\t\t\t\tbs[i] = true;\n\t\t\t}\n\t\t}\n\t\treturn memo[bs.to_ulong()] = ans;\n\t}\n}\nint main() {\n\tfor (int i = 0; i < 1 << 15; ++i) {\n\t\tmemo[i] = -1;\n\t}\n\tint M, N; cin >> M >> N;\n\tsumws.resize(M + 1);\n\tsumts.resize(M + 1);\n\tfor (int i = 0; i < M; ++i) {\n\t\tint w, t; cin >> w >> t;\n\t\tsumws[i + 1] = sumws[i] + w;\n\t\tsumts[i + 1] = sumts[i] + t;\n\t}\n\tfor (int i = 0; i < N; ++i) {\n\t\tint c, b; cin >> c >> b;\n\t\tmaxcs.push_back(c);\n\t\tmaxbs.push_back(b);\n\t}\n\tbitset<15>bs;\n\tfor (int i = 0; i < N; ++i) {\n\t\tbs[i] = true;\n\n\t}\n\tint ans = getans(bs);\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define INF LLONG_MAX\ntypedef long long ll;\n\nint M, N;\nvector<ll> tw, tt;\nvector<ll> c, b;\n\nvoid init()\n{\n    tw.resize(M+2); tt.resize(M+2);\n    tw[0] = tt[0] = 0;\n    tw[M+1] = tt[M+1] = INF;\n    c.resize(N); b.resize(N);\n}\n\nint solve()\n{\n    int dp[1<<15];\n    memset(dp, -1, sizeof(dp));\n    dp[0] = 0;\n    \n    for (int i = 0; i < (1<<N); i++) {\n        if (dp[i] == -1) continue;        \n        for (int j = 0; j < N; j++) {\n            if (i >> j & 1) continue;                        \n            int ni = i | (1<<j);\n            int p1 = upper_bound(tw.begin() + dp[i], tw.end(), c[j] + tw[dp[i]]) - (tw.begin()) - 1;\n            int p2 = upper_bound(tt.begin() + dp[i], tt.end(), b[j] + tt[dp[i]]) - (tt.begin()) - 1;\n            dp[ni] = max(dp[ni], min(p1, p2));\n        }\n    }\n\n    return dp[(1<<N)-1];\n}\n\nint main()\n{    \n    cin >> M >> N;\n    init();\n    for (int i = 1; i <= M; i++) {\n        cin >> tw[i] >> tt[i];\n        tw[i] += tw[i-1];\n        tt[i] += tt[i-1];\n    }    \n    for (int i = 0; i < N; i++) {\n        cin >> c[i] >> b[i];\n    }\n    cout << solve() << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * 0312.cc: Net Cafe\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_M = 200000;\nconst int MAX_N = 15;\nconst int NBITS = 1 << MAX_N;\n\n/* typedef */\n\n/* global variables */\n\nint wis[MAX_M], tis[MAX_M], wsums[MAX_M + 1], tsums[MAX_M + 1];\nint cs[MAX_N], bs[MAX_N];\nint dp[NBITS];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  int m, n;\n  cin >> m >> n;\n\n  wsums[0] = tsums[0] = 0;\n  for (int i = 0; i < m; i++) {\n    cin >> wis[i] >> tis[i];\n    wsums[i + 1] = wsums[i] + wis[i];\n    tsums[i + 1] = tsums[i] + tis[i];\n  }\n\n  for (int i = 0; i < n; i++) cin >> cs[i] >> bs[i];\n\n  int nbits = 1 << n;\n  memset(dp, -1, sizeof(dp));\n  dp[0] = 0;\n\n  for (int bits = 0; bits < nbits; bits++) {\n    int wsum0 = wsums[dp[bits]], tsum0 = tsums[dp[bits]];\n\n    for (int i = 0, bi = 1; i < n; i++, bi <<= 1)\n      if (! (bits & bi)) {\n\tint wsum = wsum0 + cs[i], tsum = tsum0 + bs[i];\n\tint wi = upper_bound(wsums, wsums + m + 1, wsum) - wsums - 1;\n\tint ti = upper_bound(tsums, tsums + m + 1, tsum) - tsums - 1;\n\tint bitsi = bits | bi;\n\tint dpi = min(wi, ti);\n\tif (dp[bitsi] < dpi) dp[bitsi] = dpi;\n      }\n  }\n\n  printf(\"%d\\n\", dp[nbits - 1]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// 基本テンプレート\n \n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\nusing namespace std;\n \n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define int long long int\n \ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n \ntypedef pair<int, int> pii;\ntypedef long long ll;\n \nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconst ll INF = 1001001001001001LL;\nconst ll MOD = 1000000007LL;\n\nint M, N, dp[1 << 15];\nint w[200010], t[200010];\nint c[20], b[20];\n\nsigned main() {\n    cin >> M >> N;\n    for(int i=0; i<M; i++) {\n        cin >> w[i+1] >> t[i+1];\n        w[i+1] += w[i];\n        t[i+1] += t[i];\n    }\n    for(int i=0; i<N; i++) {\n        cin >> c[i] >> b[i];\n    }\n\n    fill(dp, dp + (1 << N), -1);\n    dp[0] = 0;\n    for(int bit=0; bit<(1<<N); bit++) {\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) continue;\n            int nbit = bit | (1 << i);\n            int baseW = w[ dp[bit] ];\n            int baseT = t[ dp[bit] ];\n\n            int idx = upper_bound(w, w+M+1, baseW + c[i]) - w - 1;\n            int jdx = upper_bound(t, t+M+1, baseT + b[i]) - t - 1;\n            int k = min(idx, jdx);\n            chmax(dp[nbit], k);\n        }\n    }\n\n    cout << dp[(1 << N) - 1] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,a) FOR(i,0,a)\n\nconst int MAX_M=2e5,MAX_N=15;\nconst int INF=1e8;\n\nint M,N;\nint w[MAX_M],t[MAX_M];\nint c[MAX_N],b[MAX_N];\n\nint sumw[MAX_M+1],sumt[MAX_M+1];\nint dp[1<<MAX_N];\n\nint main(){\n\tscanf(\"%d %d\",&M,&N);\n\tREP(i,M){\n\t\tscanf(\"%d %d\",&w[i],&t[i]);\n\t}\n\tREP(i,N){\n\t\tscanf(\"%d %d\",&c[i],&b[i]);\n\t}\n\tFOR(i,1,M+1){\n\t\tsumw[i]=sumw[i-1]+w[i-1];\n\t\tsumt[i]=sumt[i-1]+t[i-1];\n\t}\n\tFOR(S,1,1<<N){\n\t\tint a=0;\n\t\tREP(i,N){\n\t\t\tif (S & 1<<i){\n\t\t\t\tint d=dp[S-(1<<i)];\n\t\t\t\tint u=upper_bound(sumw,sumw+M+1,sumw[d]+c[i])-1-sumw;\n\t\t\t\tint v=upper_bound(sumt,sumt+M+1,sumt[d]+b[i])-1-sumt;\n\t\t\t\ta=max(a,min(u,v));\n\t\t\t}\n\t\t}\n\t\tdp[S]=a;\n\t}\n\tprintf(\"%d\\n\",dp[(1<<N)-1]);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define r(i,n) for(int i=0;i<n;i++)\n\nint m,n;\nint w[222222];\nint t[222222];\nint c[222222];\nint b[222222];\n\nint dp[1<<16];\n\nvector<int>A,B;\n\nmain(){\n\n  A.push_back(0);\n  B.push_back(0);\n\n  \n  cin>>m>>n;\n  r(i,m) cin>>w[i]>>t[i] , A.push_back(w[i]) , B.push_back(t[i]);\n  r(i,n) cin>>c[i]>>b[i];\n\n  r(i,m){\n    A[i+1] += A[i];\n    B[i+1] += B[i];\n  }\n\n  A.push_back(4e18);\n  B.push_back(4e18);\n\n  dp[0]=0;\n\n  for(int i=0;i<(1<<n);i++){\n    for(int j=0;j<n;j++){\n      if(i&(1<<j))continue;\n      \n      int ai = upper_bound(A.begin(),A.end(),A[dp[i]]+c[j]) - A.begin(); ai--;\n      int bi = upper_bound(B.begin(),B.end(),B[dp[i]]+b[j]) - B.begin(); bi--;\n      int x = min( ai , bi );\n      //cout<<x<<endl;\n      dp[i|(1<<j)] = max(dp[i|(1<<j)],x);\n    }\n  }\n\n  cout<< dp[(1<<n)-1] <<endl;\n  \n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define MM 200100\n#define MN 15\nint M,N;\nint w[MM],t[MM];\nint c[MN],b[MN];\nint dp[1<<MN];\nbool used[1<<MN];\nint pre[MN][MM];\nint preculc(int stage,int pos){\n\tint l = pos-1,r = M+1;\n\twhile(r-l>1){\n\t\tint mid = (l+r)/2;\n\t\tif(w[mid]-w[pos-1]<=c[stage]&&t[mid]-t[pos-1]<=b[stage]){\n\t\t\t//printf(\"mid %d\\n\",mid);\n\t\t\t//printf(\"%d %d %d %d\\n\",w[mid]-w[pos-1],c[stage],t[mid]-t[pos-1],b[stage]);\n\t\t\tl=mid;\n\t\t}\n\t\telse r = mid;\n\t}\n\tpre[stage][pos]=l;\n\t//cout << stage << ' ' << pos << ' ' << l << endl;\n}\nqueue<int> q;\nint main(){\n\tscanf(\"%d %d\",&M,&N);\n\tfor(int i=1;i<=M;i++)scanf(\"%d %d\",&w[i],&t[i]);\n\tfor(int i=1;i<M;i++)w[i+1]+=w[i];\n\tfor(int i=1;i<M;i++)t[i+1]+=t[i];\n\tfor(int i=0;i<N;i++)scanf(\"%d %d\",&c[i],&b[i]);\n\tfor(int i=0;i<N;i++){\n\t\tfor(int j=1;j<=M;j++)pre[i][j]=preculc(i,j);\n\t}\n\tmemset(dp,-1,sizeof(dp));\n\tdp[(1<<N)-1]=0;\n\tq.push((1<<N)-1);\n\tint ans = 0;\n\twhile(!q.empty()){\n\t\tint S = q.front();\n\t\tq.pop();\n\t\tif(used[S])continue;\n\t\tused[S]=true;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif((S>>i)&1){\n\t\t\t\tint T = S-(1<<i);\n\t\t\t\tdp[T]=max(dp[T],pre[i][dp[S]+1]);\n\t\t\t\tans = max(ans,dp[T]);\n\t\t\t\tq.push(T);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define INF LLONG_MAX\ntypedef long long ll;\n\nint M, N;\nvector<ll> tw, tt;\nvector<ll> c, b;\n\nvoid init()\n{\n    tw.resize(M+2); tt.resize(M+2);\n    c.resize(N); b.resize(N);\n}\n\nint solve()\n{\n    int dp[1<<15];\n    memset(dp, -1, sizeof(dp));\n    dp[0] = 0;\n    \n    for (int i = 0; i < (1<<N); i++) {\n        if (dp[i] == -1) continue;        \n        for (int j = 0; j < N; j++) {\n            if (i >> j & 1) continue;                        \n            int ni = i | (1<<j);\n            int p1 = upper_bound(tw.begin() + dp[i], tw.end(), c[j] + tw[dp[i]]) - (tw.begin()) - 1;\n            int p2 = upper_bound(tt.begin() + dp[i], tt.end(), b[j] + tt[dp[i]]) - (tt.begin()) - 1;\n            dp[ni] = max(dp[ni], min(p1, p2));\n        }\n    }\n\n    return dp[(1<<N)-1];\n}\n\nint main()\n{    \n    cin >> M >> N;\n    init();\n    tw[0] = tt[0] = 0;\n    tw[M+1] = tt[M+1] = INF;\n    for (int i = 1; i <= M; i++) {\n        cin >> tw[i] >> tt[i];\n        tw[i] += tw[i-1];\n        tt[i] += tt[i-1];\n    }    \n    for (int i = 0; i < N; i++) {\n        cin >> c[i] >> b[i];\n    }\n    cout << solve() << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\nstruct book{\n    int wilde;\n    int weight;\n    void operator =(book a){\n        wilde+=a.wilde;\n        weight+=a.weight;\n        return ;\n    }\n    void in(){\n        scanf(\"%d%d\",&wilde,&weight);\n        return ;\n    }\n    book operator +(book a){\n        return {wilde+a.wilde,weight+a.weight};\n    }\n    void init(){\n        wilde=weight=0;\n        return ;\n    }\n    void operator +=(book a){\n        wilde+=a.wilde;\n        weight+=a.weight;\n        return ;\n    }\n    book operator -(book a){\n        return {wilde-a.wilde,weight-a.weight};\n    }\n};\nbool fitin(book b,book a){\n    return a.weight>=b.weight&&a.wilde>=b.wilde;\n}\nconst int N=2e5+10;\nbook s[N];\nint n;\nint find(int from,book shelf){\n    if(!fitin(s[from]-s[from-1],shelf))return from-1;\n    int r=n,mid,l=from;\n    while(r-l>1){\n        mid=(l+r)>>1;\n        if(fitin(s[mid]-s[from-1],shelf))l=mid;\n        else r=mid;\n    }\n    if(fitin(s[r]-s[from-1],shelf))return r;\n    return l;\n}\nint max(int a,int b){return a>b?a:b;}\nint main(){\n    int m,top,dp[N];\n    book shelf[20];\n    scanf(\"%d%d\",&n,&m);\n    s[0].init();\n    for(int i=1;i<=n;i++){\n        s[i].in();\n        s[i]+=s[i-1];\n    }\n    for(int i=0;i<m;i++)shelf[i].in();\n    top=1<<m;\n    dp[0]=0;\n    for(int i=1;i<top;i++){\n        dp[i]=0;\n        for(int j=0;j<m;j++)if(i&(1<<j))dp[i]=max(dp[i],find(dp[i^(1<<j)]+1,shelf[j]));\n    }\n    printf(\"%d\\n\",dp[top-1]);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint N, M;\n\nint weis[200000], heis[200000];\n\nint cli[15], bre[15];\n\nint now = 0;\n\nbool jouken(int n, int ni){\n    int ws = weis[n + now] - weis[now];\n    int hs = heis[n + now] - heis[now];\n    return (cli[ni] >= ws) && (bre[ni] >= hs);\n}\n\nint binarysearch(int tp, int bt, int ni){\n    if(tp == bt){\n        return tp;\n    }\n    int p = (tp + bt - 1) / 2;\n    bool flg = jouken(p, ni);\n    if(flg){\n        return binarysearch(p, bt, ni);\n    }else{\n        return binarysearch(tp, p, ni);\n    }\n}\n\nint main(){\n    //fill(&weis[0], &weis[199999], 0);\n    //fill(&heis[0], &heis[199999], 0);\n    //fill(&cli[0], &cli[14], 0);\n    //fill(&bre[0], &bre[14], 0);\n    scanf(\"%d %d\", &M, &N);\n    for(int i = 0; i < M; i++){\n        scanf(\"%d %d\", &weis[i], &heis[i]);\n        if(i > 0){\n            weis[i] += weis[i - 1];\n            heis[i] += heis[i - 1];\n        }\n    }\n    for(int i = 0; i < N; i++){\n        scanf(\"%d %d\", &cli[i], &bre[i]);\n        now += binarysearch(0, M - now, i);\n        if(now >= M){\n            break;\n        }\n    }\n    printf(\"%d\", now);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define M 200001\n#define N 15\nusing namespace std;\nint m,n,w[M],t[M],c[N],b[N];\nint dp[(1<<N)],W[M],T[M];\n\nint cal(int x,int l[],int C){\n  C+=l[x];\n  int L=x,R=m+1;\n  while(L<R){\n    int mid=(L+R)/2;\n    if(C<l[mid])R=mid;\n    else L=mid+1;\n  }\n  return L-1;\n}\n\nint main(){\n  cin>>m>>n;\n  for(int i=1;i<=m;i++){\n    cin>>w[i]>>t[i];\n    W[i]=W[i-1]+w[i];\n    T[i]=T[i-1]+t[i];\n  }\n  for(int i=0;i<n;i++)cin>>c[i]>>b[i];\n  for(int i=0;i<(1<<n);i++){\n    for(int j=0;j<n;j++){\n      if(i&(1<<j))continue;\n      int r=min(cal(dp[i],W,c[j]),cal(dp[i],T,b[j]));\n      dp[(i|(1<<j))]=max(dp[(i|(1<<j))],r);\n    }\n  }\n  cout<<dp[(1<<n)-1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint bw[15], bh[15], aw[210000], ah[210000];\nint n, m, dp[1 << 15], L[15][210000];\nint main() {\n\tcin >> n >> m; for (int i = 0; i < n; i++)cin >> aw[i] >> ah[i];\n\tfor (int i = 0; i < m; i++)cin >> bw[i] >> bh[i]; aw[n] = 999999999; ah[n] = 999999999;\n\tfor (int i = 0; i < m; i++) {\n\t\tint V = 0, D1 = 0, D2 = 0;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\twhile (D1 + aw[V] <= bw[i] && D2 + ah[V] <= bh[i]) { D1 += aw[V]; D2 += ah[V]; V++; }\n\t\t\tL[i][j] = V; D1 -= aw[j]; D2 -= ah[j];\n\t\t}\n\t}\n\tfor (int i = 0; i < (1 << m); i++) {\n\t\tfor (int j = 0; j < m; j++) {\n\t\t\tif ((i / (1 << j)) % 2 == 1)continue;\n\t\t\tdp[i + (1 << j)] = max(dp[i + (1 << j)], L[j][dp[i]]);\n\t\t}\n\t}\n\tcout << dp[(1 << m) - 1] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define fst(t) std::get<0>(t)\n#define snd(t) std::get<1>(t)\n#define thd(t) std::get<2>(t)\n#define unless(p) if(!(p))\n#define until(p) while(!(p))\n\nusing ll = std::int64_t;\nusing P = std::tuple<int,int>;\n\nint M, N;\nint W[200100], T[200100];\nint C[20], B[20];\nint dp[1<<15];\n\ninline int sumW(int i, int j){\n    return W[i] - W[j + 1];\n}\n\ninline int sumT(int i, int j){\n    return T[i] - T[j + 1];\n}\n\ntemplate <class Pred>\nint lb(int l, int r, Pred p){\n    while(r - l > 1){\n        int m = (l + r) / 2;\n        if(p(m)){\n            l = m;\n        }else{\n            r = m;\n        }\n    }\n    return l;\n}\n\nint main(){\n    std::cin.tie(nullptr);\n    std::ios::sync_with_stdio(false);\n\n    std::cin >> M >> N;\n\n    for(int i=0;i<M;++i){\n        std::cin >> W[i] >> T[i];\n    }\n\n    for(int i=M-2;i>=0;--i){\n        W[i] += W[i + 1];\n        T[i] += T[i + 1];\n    }\n\n    for(int i=0;i<N;++i){\n        std::cin >> C[i] >> B[i];\n    }\n\n    for(int i=0;i<(1<<N);++i){\n        for(int j=0;j<N;++j){\n            if(i >> j & 1){\n                continue;\n            }\n\n            int k = dp[i], l = lb(k, M + 1, [&](int l){return C[j] >= sumW(k, l - 1) && B[j] >= sumT(k, l - 1);});\n\n            dp[i | (1 << j)] = std::max(dp[i | (1 << j)], l);\n        }\n    }\n\n    int mx = dp[(1<<N)-1];\n    std::cout << mx << std::endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint n,m;\nint w[200002],t[200002];\nint x[16],y[16];\n\nint check(int idx,int mx,int *a){\n  mx+=a[idx];\n  int L=idx+1,R=m+1,M;\n  while(L<R){\n    M=(L+R)/2;\n    if(a[M]>mx) R=M;\n    else L=M+1;\n  }\n  return L-1;\n}\n\nint main(){\n  cin>>m>>n;\n\n  for(int i=1;i<=m;i++){\n    cin>>w[i]>>t[i];\n    w[i]+=w[i-1],t[i]+=t[i-1];\n  }\n  for(int i=0;i<n;i++)cin>>x[i]>>y[i];\n\n  int dp[1<<15]={};\n  for(int i=0;i<(1<<n);i++)\n    for(int j=0;j<n;j++){\n      if((i&(1<<j)))continue;\n      int res=min(check(dp[i],x[j],w),check(dp[i],y[j],t));\n      dp[i|(1<<j)]=max(dp[i|(1<<j)],res);\n    }\n  cout << dp[(1<<n)-1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>inline void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>inline void chmax(T &t,U f){if(t<f)t=f;}\n\nint M,N;\nint w[222222],t[222222];\nint sw[222222],st[222222];\n\nint dp[1<<15];\nint c[22],b[22];\nsigned main(){\n    cin>>M>>N;\n    rep(i,M)cin>>w[i]>>t[i];\n    rep(i,M){\n        sw[i+1]=sw[i]+w[i];\n        st[i+1]=st[i]+t[i];\n    }\n    rep(i,N)cin>>c[i]>>b[i];\n\n    rep(i,1<<N){\n        rep(j,N){\n            if(i>>j&1)continue;\n            int lb=dp[i],ub=M+1;\n            while(ub-lb>1){\n                int mid=(ub+lb)/2;\n                if(sw[mid]-sw[dp[i]]>c[j]||st[mid]-st[dp[i]]>b[j])ub=mid;\n                else lb=mid;\n            }\n            chmax(dp[i|(1<<j)],lb);\n        }\n    }\n\n    cout<<dp[(1<<N)-1]<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <iomanip>\n#include <numeric>\n#include <cmath>\n#include <cassert>\n#include <complex>\n#define repi(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) repi(i, 0, n)\n#define endl \"\\n\"\n#define ing long long\nusing namespace std;\nusing ll = long long;\nconst int INF = 1<<30;\nconst int MOD = (int)1e9 + 7;\nconst int MAX_N = (int)1e5 + 5;\n#define debug(x) cout << #x << \": \" << x << endl\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2>& p) { os << p.first << \" \" << p.second; return os; }\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) { for(int i = 0; i < (int) v.size(); i++) os << v[i] << (i + 1 != v.size() ? \" \" : \"\"); return os; }\n\n#define w first\n#define t second\n#define c first\n#define d second\n\nsigned main(void)\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int M, N;\n    vector<pair<int,int>> in, cd;\n    vector<int> dp, sum1, sum2;\n\n    cin>>M>>N;\n\n    in.resize(M);\n    sum1.resize(M+1,0);\n    sum2.resize(M+1,0);\n    cd.resize(N);\n    dp.resize((1<<N) + 10);\n    \n    for(int i = 0; i < M; i++){\n        cin>>in[i].w>>in[i].t;\n        sum1[i+1] += in[i].w;\n        sum2[i+1] += in[i].t;\n        sum1[i+1] += sum1[i];\n        sum2[i+1] += sum2[i];\n        // cout<<\"i = \"<<i+1<<\" sum1 \"<<sum1[i+1]<<endl;\n        // \n        // cout<<\"i = \"<<i+1<<\" sum2 \"<<sum2[i+1]<<endl;\n    }\n\n    for(int i = 0; i < N; i++){\n        cin>>cd[i].c>>cd[i].d;\n    }\n\n    dp[0] = -1;\n\n    for(int i = 1; i < (1<<N); i++){\n        int maximum = -1 ;\n        for(int j = 0; j < N; j++){\n            int bit = i&(~(1<<j));\n            \n            //cout<<\"bit = \"<<bit<<\" \"<<i<<endl;\n            if(bit == i) continue;\n            int num = dp[bit];\n            int W = 0, T = 0;\n            maximum = max(num, maximum);\n            int x = 0,  y = 0;\n\n            if(num == M-1){\n                cout<<M<<endl;\n                return 0;\n            }\n            //if(num != -1)\n                x = sum1[num+1] +cd[j].c;\n                //if(num != -1)\n                y = sum2[num+1]+ cd[j].d;\n            \n            /*\n            for(int k = num+1; k < M; k++){\n                W += in[k].w;\n                T += in[k].t;\n                if(W > cd[j].c || T > cd[j].d) break;\n\n                maximum = max(k,maximum);\n            }\n\n            */\n            int temp1 = upper_bound(sum1.begin(), sum1.end(), x) - sum1.begin();\n            int temp2 = upper_bound(sum2.begin(), sum2.end(), y) - sum2.begin();\n            // cout<<i<<\" \"<<j<<\" \"<<temp1<<\" \"<<temp2<<endl;\n            // cout<<\"x = \"<<x<<\" y = \"<<y<<\" num = \"<<num<<\" temp = \"<<min(temp1,temp2)-1<<endl;\n            maximum = max(min(temp1,temp2)-2, maximum);\n            \n        }\n        dp[i] = maximum;\n        //cout<<i<<\" \"<<maximum<<endl;\n    }\n\n    cout<<dp[(1<<N)-1]+1<<endl;\n    \n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nconst ll inf=174417444174;\nvector<ll> wn,tn,w_s,ts;\nll cn[15],bn[15];\nll dp[1<<15]={0};\nll m,n;\n\nll get_ans(int count,int idx){\n  ll c_max=cn[idx]+w_s[count];\n  int a1=upper_bound(w_s.begin(),w_s.end(),c_max)-w_s.begin()-1;\n  ll b_max=bn[idx]+ts[count];\n  int a2=upper_bound(ts.begin(),ts.end(),b_max)-ts.begin()-1;\n  return min(a1,a2);\n}\n\nint main(){\n  cin>>m>>n;\n  wn.push_back(0);\n  tn.push_back(0);\n  w_s.push_back(0);\n  ts.push_back(0);\n  for(int i=1;i<=m;i++){\n    ll w,t;\n    cin>>w>>t;\n    wn.push_back(w);\n    tn.push_back(t);\n    w_s.push_back(w_s[i-1]+w);\n    ts.push_back(ts[i-1]+t);\n  }\n  w_s.push_back(inf);\n  ts.push_back(inf);\n\n/*\n  int k,cc;\n  cin>>k>>cc;\n  cout<<upper_bound(w_s.begin(),w_s.end(),k+w_s[cc])-w_s.begin()<<endl;\n  return 0;\n  */\n\n  for(int i=0;i<n;i++){\n    cin>>cn[i]>>bn[i];\n  }\n\n  for(int i=0;i<(1<<n)-1;i++){\n    for(int j=0;j<n;j++){\n      if(((i>>j)&1)==0){\n        int nb=(i|(1<<j));\n      //  cout<<i<<\" \"<<j<<\" \"<<nb<<endl;\n        dp[nb]=max(dp[nb],get_ans(dp[i],j));\n      }\n    }\n  //  cout<<i<<\" \"<<dp[i]<<endl;\n  }\n  cout<<dp[(1<<n)-1]<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint s[210000];\nint t[210000];\nint c[20];\nint d[20];\nint p[210000];\nint q[210000];\nint dp[1<<15];\nint main(){\n\tint a,b;\n\tscanf(\"%d%d\",&a,&b);\n\tfor(int i=0;i<a;i++){\n\t\tscanf(\"%d%d\",p+i,q+i);\n\t\ts[i+1]=s[i]+p[i];\n\t\tt[i+1]=t[i]+q[i];\n\t}\n\tfor(int i=0;i<b;i++)scanf(\"%d%d\",c+i,d+i);\n\tfor(int i=0;i<(1<<b);i++)dp[i]=-999999999;\n\tdp[0]=0;\n\t\n\tfor(int i=0;i<(1<<b);i++){\n\t\tfor(int j=0;j<b;j++){\n\t\t\tif(i&(1<<j))continue;\n\t\t\tint to=min(upper_bound(s,s+a+1,s[dp[i]]+c[j])-s-1,upper_bound(t,t+a+1,t[dp[i]]+d[j])-t-1);\n\t\t\tdp[i+(1<<j)]=max(dp[i+(1<<j)],to);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",dp[(1<<b)-1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <array>\n#include <string>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <tuple>\n#include <bitset>\n#include <memory>\n#include <cmath>\n#include <algorithm>\n#include <functional>\n#include <iomanip>\n#include <numeric>\n#include <climits>\n#include <cfloat>\n\nint main() {\n\tstd::cin.tie(0); std::cin.sync_with_stdio(false);\n\tint m, n; std::cin >> m >> n;\n\tstd::vector<long long int> weights(m + 1, 0), thicks(m + 1, 0);\n\tfor (auto i = 1; i <= m; ++i) std::cin >> weights[i] >> thicks[i];\n\tfor (auto i = 1; i <= m; ++i) {\n\t\tweights[i] += weights[i - 1];\n\t\tthicks[i] += thicks[i - 1];\n\t}\n\tstd::vector<long long int> max_weight(n), max_thick(n);\n\tfor (auto i = 0; i < n; ++i) std::cin >> max_weight[i] >> max_thick[i];\n\tstd::vector<int> max_size(1 << n, 0);\n\tfor (auto p = 0; p < (1 << n); ++p) {\n\t\tconst int current = max_size[p];\n\t\tfor (auto i = 0; i < n; ++i) if ((p & (1 << i)) == 0) {\n\t\t\tconst int next_with_weight = (current == m) ? current : std::distance(weights.begin(), std::upper_bound(std::next(weights.begin(), current), weights.end(), weights[current] + max_weight[i])) - 1;\n\t\t\tconst int next_with_thick = (current == m) ? current : std::distance(thicks.begin(), std::upper_bound(std::next(thicks.begin(), current), thicks.end(), thicks[current] + max_thick[i])) - 1;\n\t\t\tmax_size[p | (1 << i)] = std::max(max_size[p | (1 << i)], std::min(next_with_weight, next_with_thick));\n\t\t}\n\t}\n\tstd::cout << max_size.back() << '\\n';\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint m, n, w[200009], t[200009], sw[200009], st[200009], c[16], b[16], dp[1 << 15];\nint main() {\n\tcin >> m >> n;\n\tfor (int i = 0; i < m; i++) cin >> w[i] >> t[i];\n\tfor (int i = 0; i < m; i++) {\n\t\tsw[i + 1] = sw[i] + w[i];\n\t\tst[i + 1] = st[i] + t[i];\n\t}\n\tsw[m + 1] = st[m + 1] = 999999999;\n\tfor (int i = 0; i < n; i++) cin >> c[i] >> b[i];\n\tfor (int i = 1; i < 1 << n; i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (!(i & (1 << j))) continue;\n\t\t\tint val = dp[i - (1 << j)];\n\t\t\tint ptr1 = lower_bound(sw, sw + m + 1, c[j] + sw[val] + 1) - sw - 1;\n\t\t\tint ptr2 = lower_bound(st, st + m + 1, b[j] + st[val] + 1) - st - 1;\n\t\t\tdp[i] = max(dp[i], min(ptr1, ptr2));\n\t\t}\n\t}\n\tcout << dp[(1 << n) - 1] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define M 200005\n#define N 15\nusing namespace std;\n\nint m,n,w[M],t[M],c[N],b[N];\nint dp[(1<<N)],W[M],T[M];\n\nint calc(int x,int C,int arr[]){\n  C+=arr[x];\n  int L=x+1,R=m+1;\n  while(L<R){\n    int mid=(L+R)/2;\n    if(C<arr[mid])R=mid;\n    else L=mid+1;\n  }\n  return L-1;\n}\n\nint main(){\n  cin>>m>>n;\n  for(int i=0;i<m;i++){\n    cin>>w[i]>>t[i];\n    W[i+1]=W[i]+w[i];\n    T[i+1]=T[i]+t[i];\n  }\n  for(int i=0;i<n;i++)cin>>c[i]>>b[i];\n  for(int i=0;i<(1<<n);i++){\n    for(int j=0;j<n;j++){\n      if((i&(1<<j)))continue;\n      int r=min(calc(dp[i],c[j],W),calc(dp[i],b[j],T));\n      dp[i|(1<<j)]=max(dp[i|(1<<j)],r);\n    }\n  }\n  cout<<dp[(1<<n)-1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define REP(i, n) FOR(i, 0, n)\n#define FOR(i, a, b) for(int i = a; i < b; i++)\n\n#define PB push_back\n#define PI 3.141592653589793238462643383279L\n\n#define MOD 1000000007LL\ntypedef long long ll;\ntypedef long double ld;\n\n#define LAR(a, b) a=max(a, (b))\n#define SQ(x) ((x)*(x))\n\nint w[212345], x[212345];\nint ms[212345], xs[212345];\nint wb[20], xb[20];\nint n, m;\n\ntypedef map<int, int> mii;\n#define itr iterator\n\nmap<int, int> memo[65536];\nint mi[65536];\nint ama(int, int);\nint DP(int, int);\nint dp(int a, int b){\n\tmii::itr it = memo[a].find(b);\n\tif(it!=memo[a].end())\n\t\treturn it->second;\n\telse if(b<mi[a])\n\t\treturn -100;\n\telse\n\t\treturn memo[a][b]=DP(a, b);\n}\nint DP(int a, int b){\n\tint ret = b;\n\tREP(i, m){\n\t\tif((a&(1<<i))==0){\n\t\t\tLAR(ret, dp(a|(1<<i), ama(b, i)));\n\t\t}\n\t}\n\tLAR(mi[a], ret);\n\treturn ret;\n}\nint ama(int a, int b){\n\tint lo = a,\n\t\t\thg = n+1;\n\twhile(hg-lo>1){\n\t\tint md = (lo+hg)/2;\n\t\tif(ms[md]-ms[a]<=wb[b] && xs[md]-xs[a]<=xb[b])\n\t\t\tlo = md;\n\t\telse\n\t\t\thg = md;\n\t}\n\treturn lo;\n}\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tREP(i, n) scanf(\"%d%d\", w+i, x+i);\n\tREP(i, m) scanf(\"%d%d\", wb+i, xb+i);\n\tms[0]=xs[0]=0;\n\tfill(mi, mi+65536, 0);\n\tREP(i, n){\n\t\tms[i+1]=ms[i]+w[i];\n\t\txs[i+1]=xs[i]+x[i];\n\t}\n\tprintf(\"%d\\n\", dp(0, 0));\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\n\nint main()\n{\n  int M, N;\n  int64 w[200001], t[200001];\n  int c[15], b[15];\n  int dp[1 << 15];\n  \n  scanf(\"%d %d\", &M, &N);\n  for(int i = 1; i <= M; i++) {\n    scanf(\"%lld %lld\", &w[i], &t[i]);\n    w[i] += w[i - 1];\n    t[i] += t[i - 1];\n  }\n  for(int i = 0; i < N; i++) {\n    scanf(\"%d %d\", &c[i], &b[i]);\n  }\n  for(int i = 0; i < 1 << N; i++) {\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) continue;\n      int weightHigh = upper_bound(w + dp[i], w + M + 1, w[dp[i]] + c[j]) - w - 1;\n      int widthHigh  = upper_bound(t + dp[i], t + M + 1, t[dp[i]] + b[j]) - t - 1;\n      dp[i|(1 << j)] = max(dp[i|(1 << j)], min(weightHigh, widthHigh));\n    }\n  }\n  printf(\"%d\\n\", dp[(1 << N) - 1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_M 200005\n#define MAX_N 20\nint m,n;\n\nint dp[(1<<MAX_N)];\nint w[MAX_M],t[MAX_M];\nint c,b;\nint a[MAX_N][MAX_M];\n\nint main(){\n  cin>>m>>n;\n  for(int i=0;i<m;i++)scanf(\"%d %d\",&w[i],&t[i]);\n  for(int i=0;i<n;i++){\n    scanf(\"%d %d\",&c,&b);\n    int k=0,sc=0,sb=0;\n    for(int j=0;j<m;j++){\n      if(j)sc-=w[j-1],sb-=t[j-1];\n      while(k<m&&sc+w[k]<=c&&sb+t[k]<=b){\n        sc+=w[j];\n        sb+=t[j];\n        k++;\n      }\n      a[i][j]=k;\n    }\n  }\n  for(int S=0;S<(1<<n);S++){\n    for(int i=0;i<n;i++){\n      if(S>>i&1)continue;\n      dp[S|(1<<i)]=max(dp[S|(1<<i)],a[i][dp[S]]);\n    }\n  }\n  printf(\"%d\\n\",dp[(1<<n)-1]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define M 200001\n#define N 15\nusing namespace std;\nint m,n,w[M],t[M],c[N],b[N];\nint dp[(1<<N)],W[M],T[M];\n\nint cal(int x,int l[],int C){\n  C+=l[x];\n  int L=x,R=m+1;\n  while(L<R){\n    int mid=(L+R)/2;\n    if(C<l[mid])R=mid;\n    else L=mid+1;\n  }\n  return L-1;\n}\n\nint main(){\n  cin>>m>>n;\n  for(int i=1;i<=m;i++){\n    cin>>w[i]>>t[i];\n    W[i]=W[i-1]+w[i];\n    T[i]=T[i-1]+t[i];\n  }\n  for(int i=0;i<n;i++)cin>>c[i]>>b[i];\n  for(int i=0;i<(1<<n);i++){\n    for(int j=0;j<n;j++){\n      if(i&(1<<j))continue;\n      int r=min(cal(dp[i],W,c[j]),cal(dp[i],T,b[j]));\n      dp[(i|(1<<j))]=max(dp[(i|(1<<j))],r);\n    }\n  }\n  cout<<dp[(1<<n)-1]<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//3\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b)for(int i=(a); i<(b); i++)\n#define REP(i,n)FOR(i,0,n)\n#define ALL(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n\ntemplate<typename A, typename B> inline bool chmax(A &a, B b){if (a<b){a = b; return 1;}return 0;}\ntemplate<typename A, typename B> inline bool chmin(A &a, B b){if (a>b){a = b; return 1;}return 0;}\n\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll>pll;\ntypedef pair<int,pii>pip;\n\nconst ll INF = 1e9+100;\nconst ll MOD = 1e9+7;\nconst double EPS = 1e-10;\nconst bool debug = 0;\n\nint M, N;\nint w[212345], t[212345];\nint c[212345], b[212345];\nint sumw[212345], sumt[212345];\nint dp[1<<15];\n\nint main() {\n\tcin >> M >> N;\n\tREP(i, M) scanf(\"%d %d\", w + i, t + i);\n\tREP(i, N) scanf(\"%d %d\", c + i, b + i);\n\t\n\tREP(i, M) {\n\t\tsumw[i + 1] = sumw[i] + w[i];\n\t\tsumt[i + 1] = sumt[i] + t[i];\n\t}\n\t\n\tREP(i, 1<<N) {\n\t\tREP(j, N) if (!(i >> j & 1)) {\n\t\t\tint mc = upper_bound(sumw, sumw + M + 1, sumw[dp[i]] + c[j]) - sumw - 1;\n\t\t\tint tc = upper_bound(sumt, sumt + M + 1, sumt[dp[i]] + b[j]) - sumt - 1;\n\t\t\tchmax(dp[i | 1<<j], min(mc, tc));\n\t\t}\n\t}\n\t\n\tcout << dp[(1<<N)-1] << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define r(i,n) for(int i=0;i<n;i++)\n\nint m,n;\nint w[222222];\nint t[222222];\nint c[222222];\nint b[222222];\n\nint dp[1<<16];\n\nvector<int>A,B;\n\nmain(){\n\n  A.push_back(0);\n  B.push_back(0);\n\n  \n  cin>>m>>n;\n  r(i,m) cin>>w[i]>>t[i] , A.push_back(w[i]) , B.push_back(t[i]);\n  r(i,n) cin>>c[i]>>b[i];\n\n  r(i,m){\n    A[i+1] += A[i];\n    B[i+1] += B[i];\n  }\n\n  A.push_back(4e18);\n  B.push_back(4e18);\n\n  dp[0]=0;\n\n  for(int i=0;i<(1<<n);i++){\n    for(int j=0;j<n;j++){\n      if(i&(1<<j))continue;\n      \n      int ai = upper_bound(A.begin(),A.end(),A[dp[i]]+c[j]) - A.begin(); ai--;\n      int bi = upper_bound(B.begin(),B.end(),B[dp[i]]+b[j]) - B.begin(); bi--;\n      int x = min( ai , bi );\n      //cout<<x<<endl;\n      dp[i|(1<<j)] = max(dp[i|(1<<j)],x);\n    }\n  }\n\n  cout<< dp[(1<<n)-1] <<endl;\n  \n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint m, n, w[200009], t[200009], sw[200009], st[200009], c[16], b[16], dp[1 << 15];\nint main() {\n\tcin >> m >> n;\n\tfor (int i = 0; i < m; i++) cin >> w[i] >> t[i];\n\tfor (int i = 0; i < m; i++) {\n\t\tsw[i + 1] = sw[i] + w[i];\n\t\tst[i + 1] = st[i] + t[i];\n\t}\n\tsw[m + 1] = st[m + 1] = 999999999;\n\tfor (int i = 0; i < n; i++) cin >> c[i] >> b[i];\n\tfor (int i = 1; i < 1 << n; i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (!(i & (1 << j))) continue;\n\t\t\tint val = dp[i - (1 << j)];\n\t\t\tint ptr1 = lower_bound(sw, sw + m + 1, c[j] + sw[val] + 1) - sw - 1;\n\t\t\tint ptr2 = lower_bound(st, st + m + 1, b[j] + st[val] + 1) - st - 1;\n\t\t\tdp[i] = max(dp[i], min(ptr1, ptr2));\n\t\t}\n\t}\n\tcout << dp[(1 << n) - 1] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nusing ll = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;};\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;};\n\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(0);\n\n  Int m,n;\n  cin>>m>>n;\n  vector<Int> ws(m),ts(m);\n  for(Int i=0;i<m;i++) cin>>ws[i]>>ts[i];\n\n  vector<Int> cs(n),bs(n);\n  for(Int i=0;i<n;i++) cin>>cs[i]>>bs[i];\n\n  vector<Int> sw(m+1,0),st(m+1,0);\n  for(Int i=0;i<m;i++){\n    sw[i+1]=sw[i]+ws[i];\n    st[i+1]=st[i]+ts[i];\n  }\n  \n  Int s=1<<n;\n  const Int INF = 1e9;\n  vector<Int> dp(s,-INF);\n  dp[0]=0;\n  for(Int b=0;b<s;b++){\n    for(Int i=0;i<n;i++){\n      if((b>>i)&1) continue;\n      Int nb=b|(1<<i);\n      Int x=upper_bound(sw.begin(),sw.end(),sw[dp[b]]+cs[i])-sw.begin();\n      Int y=upper_bound(st.begin(),st.end(),st[dp[b]]+bs[i])-st.begin();\n      chmax(dp[nb],min(x,y)-1);\n    }\n  }  \n  cout<<dp[s-1]<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_M 200005\n#define MAX_N 20\nint m,n;\n\nint dp[(1<<MAX_N)];\nint w[MAX_M],t[MAX_M];\nint c,b;\nint a[MAX_N][MAX_M];\n\nint main(){\n  cin>>m>>n;\n  for(int i=0;i<m;i++)scanf(\"%d %d\",&w[i],&t[i]);\n  for(int i=0;i<n;i++){\n    scanf(\"%d %d\",&c,&b);\n    int k=0,sc=0,sb=0;\n    for(int j=0;j<m;j++){\n      if(j)sc-=w[j-1],sb-=t[j-1];\n      while(k<m&&sc+w[k]<=c&&sb+t[k]<=b){\n        sc+=w[k];\n        sb+=t[k];\n        k++;\n      }\n      a[i][j]=k;\n    }\n  }\n  for(int S=0;S<(1<<n);S++){\n    for(int i=0;i<n;i++){\n      if(S>>i&1)continue;\n      dp[S|(1<<i)]=max(dp[S|(1<<i)],a[i][dp[S]]);\n    }\n  }\n  printf(\"%d\\n\",dp[(1<<n)-1]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing std::cin;\nusing std::cout;\nusing std::endl;\nusing std::max;\nusing ll = long long;\n\nll n, m;\nll w[200005];\nll t[200005];\nll c[16], b[16];\nll ws[200005];\nll ts[200005];\nll dp[1 << 15];\n\nint main() {\n\tcin >> m >> n;\n\tfor (int i = 0; i < m; i++) {\n\t\tcin >> w[i] >> t[i];\n\t\t\n\t\tws[i + 1] = ws[i] + w[i];\n\t\tts[i + 1] = ts[i] + t[i];\n\t}\n\tws[m + 1] = ts[m + 1] = 1ll << 60ll;\n\t\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> c[i] >> b[i];\n\t}\n\t\n\tfor (int i = 0; i < (1 << n); i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (i & (1 << j)) continue;\n\t\t\t\n\t\t\tll valid = dp[i];\n\t\t\tll invalid = m + 1;\n\t\t\tll mid;\n\t\t\t\n\t\t\twhile (invalid - valid > 1) {\n\t\t\t\tmid = (invalid + valid) / 2;\n\t\t\t\t\n\t\t\t\tif (ws[mid] - ws[dp[i]] <= c[j] &&\n\t\t\t\t\tts[mid] - ts[dp[i]] <= b[j]) {\n\t\t\t\t\tvalid = mid;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tinvalid = mid;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tdp[i | (1 << j)] = max(valid, dp[i | (1 << j)]);\n\t\t}\n\t}\n\t\n\tcout << dp[(1 << n) - 1] << endl;\n\t\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nint m, n;\nint w[200010];\nint t[200010];\nint c[20];\nint d[20];\n\nint dp[(1 << 15)];\n\nint search(int idx, int l){\n    int st = l;\n    int r = m+1;\n\n    while(r-l > 1){\n        int mid = (r+l)/2;\n        int ww = w[mid]-w[st];\n        int tt = t[mid]-t[st];\n        if(ww <= c[idx] && tt <= d[idx]){\n            l = mid;\n        }else{\n            r = mid;\n        }\n    }\n\n    return l;\n}\n\nint solve(){\n\n    dp[0] = 0;\n\n    for(int i = 0;i < (1 << n);i++){\n        dp[i] = -1;\n        for(int j = 0;j < n;j++){\n            if((i & (1 << j)) != 0){\n                dp[i] = max(dp[i], search(j, dp[i^(1 << j)]));\n            }\n        }\n    }\n\n    return dp[(1 << n)-1];\n}\n\nsigned main(){\n    cin >> m >> n;\n    for(int i = 0;i < m;i++){\n        cin >> w[i+1] >> t[i+1];\n        w[i+1] += w[i];\n        t[i+1] += t[i];\n    }\n\n    for(int i = 0;i < n;i++){\n        cin >> c[i] >> d[i];\n    }\n\n    cout << solve() << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define dbg(...) do{cerr<<__LINE__<<\": \";dbgprint(#__VA_ARGS__, __VA_ARGS__);}while(0);\n\nusing namespace std;\n\nnamespace std{template<class S,class T>struct hash<pair<S,T>>{size_t operator()(const pair<S,T>&p)const{return ((size_t)1e9+7)*hash<S>()(p.first)+hash<T>()(p.second);}};template<class T>struct hash<vector<T>>{size_t operator()(const vector<T> &v)const{size_t h=0;for(auto i : v)h=h*((size_t)1e9+7)+hash<T>()(i)+1;return h;}};}\ntemplate<class T>ostream& operator<<(ostream &os, const vector<T> &v){os<<\"[ \";rep(i,v.size())os<<v[i]<<(i==v.size()-1?\" ]\":\", \");return os;}template<class T>ostream& operator<<(ostream &os,const set<T> &v){os<<\"{ \"; for(const auto &i:v)os<<i<<\", \";return os<<\"}\";}\ntemplate<class T,class U>ostream& operator<<(ostream &os,const map<T,U> &v){os<<\"{\";for(const auto &i:v)os<<\" \"<<i.first<<\": \"<<i.second<<\",\";return os<<\"}\";}template<class T,class U>ostream& operator<<(ostream &os,const pair<T,U> &p){return os<<\"(\"<<p.first<<\", \"<<p.second<<\")\";}\nvoid dbgprint(const string &fmt){cerr<<endl;}template<class H,class... T>void dbgprint(const string &fmt,const H &h,const T&... r){cerr<<fmt.substr(0,fmt.find(\",\"))<<\"= \"<<h<<\" \";dbgprint(fmt.substr(fmt.find(\",\")+1),r...);}\ntypedef long long ll;typedef vector<int> vi;typedef pair<int,int> pi;const int inf = (int)1e9;const double INF = 1e12, EPS = 1e-9;\n\nint main(){\n\tcin.tie(0); cin.sync_with_stdio(0);\n\tint m, n; cin >> m >> n;\n\tvector<ll> w(m + 1), t(m + 1);\n\trep(i, m){\n\t\tint x, y; cin >> x >> y;\n\t\tw[i + 1] = w[i] + x;\n\t\tt[i + 1] = t[i] + y;\n\t}\n\tvector<ll> c(n), b(n);\n\trep(i, n) cin >> c[i] >> b[i];\n\t\n\tvi dp(1 << n, -1);\n\tdp[0] = 0;\n\t\n\trep(i, 1 << n) if(dp[i] >= 0) rep(j, n) if(!(i & 1 << j)){\n\t\tll nw = w[dp[i]] + c[j];\n\t\tll nt = t[dp[i]] + b[j];\n\t\tnw = upper_bound(all(w), nw) - w.begin();\n\t\tnt = upper_bound(all(t), nt) - t.begin();\n\t\tdp[i | 1 << j] = max(dp[i | 1 << j], (int)min(nw, nt) - 1);\n\t}\n\tcout << dp[(1 << n) - 1] << endl;\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define MM 200100\n#define MN 15\nint M,N;\nint w[MM],t[MM];\nint c[MN],b[MN];\nint dp[1<<(MN)];\nbool used[1<<(MN)];\nint pre[MN][MM];\nint preculc(int stage,int pos){\n\tint l = pos-1,r = M+1;\n\twhile(r-l>1){\n\t\tint mid = (l+r)/2;\n\t\tif(w[mid]-w[pos-1]<=c[stage]&&t[mid]-t[pos-1]<=b[stage]){\n\t\t\t//printf(\"mid %d\\n\",mid);\n\t\t\t//printf(\"%d %d %d %d\\n\",w[mid]-w[pos-1],c[stage],t[mid]-t[pos-1],b[stage]);\n\t\t\tl=mid;\n\t\t}\n\t\telse r = mid;\n\t}\n\tpre[stage][pos]=l;\n\t//cout << stage << ' ' << pos << ' ' << l << endl;\n}\nint main(){\n\tscanf(\"%d %d\",&M,&N);\n\tfor(int i=1;i<=M;i++)scanf(\"%d %d\",&w[i],&t[i]);\n\tfor(int i=1;i<M;i++)w[i+1]+=w[i];\n\tfor(int i=1;i<M;i++)t[i+1]+=t[i];\n\tfor(int i=0;i<N;i++)scanf(\"%d %d\",&c[i],&b[i]);\n\tfor(int i=0;i<N;i++){\n\t\tfor(int j=1;j<=M;j++)preculc(i,j);\n\t}\n\tmemset(dp,-1,sizeof(dp));\n\t//cout << pre[0][1] << endl;\n\tdp[(1<<N)-1]=0;\n\tqueue<int> q;\n\tq.push((1<<N)-1);\n\tint ans = 0;\n\twhile(!q.empty()){\n\t\tint S = q.front();\n\t\tq.pop();\n\t\tif(used[S])continue;\n\t\t//cout << S << endl;\n\t\tused[S]=true;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif((S>>i)&1){\n\t\t\t\tint T = S-(1<<i);\n\t\t\t\t//printf(\"i %d S %d dp[S]+1 %d\\n\",i,S,dp[S]+1);\n\t\t\t\tdp[T]=max(dp[T],pre[i][dp[S]+1]);\n\t\t\t\tans = max(ans,dp[T]);\n\t\t\t\tq.push(T);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define REP(i, n) FOR(i, 0, n)\n#define FOR(i, a, b) for(int i = a; i < b; i++)\n\n#define MP make_pair\n#define PB push_back\n#define PI 3.141592653589793238462643383279L\n\n#define MOD 1000000007LL\ntypedef long long ll;\ntypedef long double ld;\n\n#define LAR(a, b) a=max(a, (b))\n#define SQ(x) ((x)*(x))\n\nint w[212345], x[212345];\nint ms[212345], xs[212345];\nint wb[20], xb[20];\nint n, m;\n\ntypedef map<int, int> mii;\ntypedef pair<int, int> pii;\n#define itr iterator\n\nint ama(int a, int b){\n\tint lo = a,\n\t\t\thg = n+1;\n\twhile(hg-lo>1){\n\t\tint md = (lo+hg)/2;\n\t\tif(ms[md]-ms[a]<=wb[b] && xs[md]-xs[a]<=xb[b])\n\t\t\tlo = md;\n\t\telse\n\t\t\thg = md;\n\t}\n\treturn lo;\n}\n\nvector<pii> v;\nint ans[65536];\n\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tREP(i, n) scanf(\"%d%d\", w+i, x+i);\n\tREP(i, m) scanf(\"%d%d\", wb+i, xb+i);\n\tms[0]=xs[0]=0;\n\tREP(i, n){\n\t\tms[i+1]=ms[i]+w[i];\n\t\txs[i+1]=xs[i]+x[i];\n\t}\n\tREP(i, 1<<m){\n\t\tint cnt = 0;\n\t\tREP(j, m) if(i&(1<<j)) cnt++;\n\t\tv.PB(MP(cnt, i));\n\t}\n\tfill(ans, ans+65536, 0);\n\tsort(v.begin(), v.end());\n\tREP(h, v.size()){\n\t\tint i = v[h].second;\n\t\tREP(j, m){\n\t\t\tif((i&(1<<j))==0){\n\t\t\t\tLAR(ans[i|(1<<j)], ama(ans[i], j));\n\t\t\t}\n\t\t}\n\t}\n\tint ret = 0;\n\tREP(i, 65536) LAR(ret, ans[i]);\n\tprintf(\"%d\\n\", ret);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define INF LLONG_MAX\ntypedef long long ll;\n\nint M, N;\nvector<ll> tw, tt;\nvector<ll> c, b;\n\nvoid init()\n{\n    tw.resize(M+2); tt.resize(M+2);\n    tw[0] = tt[0] = 0;\n    tw[M+1] = tt[M+1] = INF;\n    c.resize(N); b.resize(N);\n}\n\nint solve()\n{\n    int dp[1<<15];\n    memset(dp, -1, sizeof(dp));\n    dp[0] = 0;\n    \n    for (int i = 0; i < (1<<N); i++) {\n        if (dp[i] == -1) continue;        \n        for (int j = 0; j < N; j++) {\n            if (i >> j & 1) continue;                        \n            int ni = i | (1<<j);\n            int p1 = upper_bound(tw.begin() + dp[i], tw.end(), c[j] + tw[dp[i]]) - (tw.begin()) - 1;\n            int p2 = upper_bound(tt.begin() + dp[i], tt.end(), b[j] + tt[dp[i]]) - (tt.begin()) - 1;\n            dp[ni] = max(dp[ni], min(p1, p2));\n        }\n    }\n\n    return dp[(1<<N)-1];\n}\n\nint main()\n{    \n    cin >> M >> N;\n    init();\n    for (int i = 1; i <= M; i++) {\n        cin >> tw[i] >> tt[i];\n        tw[i] += tw[i-1];\n        tt[i] += tt[i-1];\n    }    \n    for (int i = 0; i < N; i++) {\n        cin >> c[i] >> b[i];\n    }\n    cout << solve() << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n\nint dp[1<<15]={};\n\nint main()\n{\n    int m,n;\n    scanf(\" %d %d\", &m, &n);\n    vector<int> w(m),t(m),W(n),T(n);\n    rep(i,m) scanf(\" %d %d\", &w[i], &t[i]);\n    rep(i,n) scanf(\" %d %d\", &W[i], &T[i]);\n\n    vector<int> sumw(m+1),sumt(m+1);\n    rep(i,m)\n    {\n        sumw[i+1] = sumw[i]+w[i];\n        sumt[i+1] = sumt[i]+t[i];\n    }\n\n    rep(mask,1<<n)\n    {\n        // ?¬?????????????????????¶\n        rep(i,n)if(!(mask>>i&1))\n        {\n            int nmask = mask | 1<<i;\n            int s=dp[mask];\n            int widx = upper_bound(all(sumw),W[i]+sumw[s])-sumw.begin()-1;\n            int tidx = upper_bound(all(sumt),T[i]+sumt[s])-sumt.begin()-1;\n\n            dp[nmask] = max(dp[nmask],min(widx,tidx));\n        }\n    }\n\n    printf(\"%d\\n\", dp[(1<<n)-1]);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* template.cpp {{{ */\n#include <bits/stdc++.h>\nusing namespace std;\n#define get_macro(a, b, c, d, name, ...) name\n#define rep(...) get_macro(__VA_ARGS__, rep4, rep3, rep2, rep1)(__VA_ARGS__)\n#define rrep(...) get_macro(__VA_ARGS__, rrep4, rrep3, rrep2, rrep1)(__VA_ARGS__)\n#define rep1(n) rep2(i_, n)\n#define rep2(i, n) rep3(i, 0, n)\n#define rep3(i, a, b) rep4(i, a, b, 1)\n#define rep4(i, a, b, s) for (ll i = (a); i < (ll)(b); i += (ll)(s))\n#define rrep1(n) rrep2(i_, n)\n#define rrep2(i, n) rrep3(i, 0, n)\n#define rrep3(i, a, b) rrep4(i, a, b, 1)\n#define rrep4(i, a, b, s) for (ll i = (ll)(b) - 1; i >= (ll)(a); i -= (ll)(s))\n#define each(x, c) for (auto &&x : c)\n#define fs first\n#define sc second\n#define all(c) begin(c), end(c)\nusing ui = unsigned;\nusing ll = long long;\nusing ul = unsigned long long;\nusing ld = long double;\nconst int inf = 1e9 + 10;\nconst ll inf_ll = 1e18 + 10;\nconst ll mod = 1e9 + 7;\nconst ll mod9 = 1e9 + 9;\nconst int dx[]{-1, 0, 1, 0, -1, 1, 1, -1};\nconst int dy[]{0, -1, 0, 1, -1, -1, 1, 1};\ntemplate<class T, class U> void chmin(T &x, const U &y){ x = min<T>(x, y); }\ntemplate<class T, class U> void chmax(T &x, const U &y){ x = max<T>(x, y); }\nstruct prepare_ { prepare_(){ cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(12); } } prepare__;\n/* }}} */\n\nll n, m;\nll a[200000], b[200000];\nll c[15], d[15];\nll sa[200010], sb[200010];\nll dp[1 << 15];\n\nint main(){\n  cin >> n >> m;\n  rep(i, n) cin >> a[i] >> b[i];\n  rep(i, m) cin >> c[i] >> d[i];\n  rep(i, n) sa[i + 1] = sa[i] + a[i];\n  rep(i, n) sb[i + 1] = sb[i] + b[i];\n\n  rep(i, 1 << m) rep(j, m){\n    if (i >> j & 1) continue;\n    ll lb = dp[i], ub = n + 1;\n    while (ub - lb > 1){\n      ll md = (lb + ub) / 2;\n      bool f = true;\n      f &= sa[md] - sa[dp[i]] <= c[j];\n      f &= sb[md] - sb[dp[i]] <= d[j];\n      (f ? lb : ub) = md;\n    }\n    chmax(dp[i | 1 << j], lb);\n  }\n\n  cout << dp[(1 << m) - 1] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <complex>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <limits>\n#include <climits>\n#include <cfloat>\n#include <functional>\n#include <iterator>\nusing namespace std;\n\nint main()\n{\n    int m, n;\n    cin >> m >> n;\n\n    vector<vector<int> > book(2, vector<int>(m));\n    for(int i=0; i<m; ++i)\n        cin >> book[0][i] >> book[1][i];\n    for(int i=1; i<m; ++i){\n        book[0][i] += book[0][i-1];\n        book[1][i] += book[1][i-1];\n    }\n\n    vector<vector<int> > shelf(2, vector<int>(n));\n    for(int i=0; i<n; ++i)\n        cin >> shelf[0][i] >> shelf[1][i];\n\n    vector<int> dp(1<<n, 0);\n    for(int i=0; i<(1<<n); ++i){\n        bitset<15> bs(i);\n        for(int j=0; j<n; ++j){\n            if(bs[j])\n                continue;\n            bs[j] = true;\n\n            int next = m;\n            for(int k=0; k<2; ++k){\n                int base = 0;\n                if(dp[i] > 0)\n                    base = book[k][dp[i]-1];\n                int tmp = upper_bound(book[k].begin(), book[k].end(), base + shelf[k][j]) - book[k].begin();\n                next = min(next, tmp);\n            }\n            dp[bs.to_ulong()] = max(dp[bs.to_ulong()], next);\n\n            bs[j] = false;\n        }\n    }\n    cout << dp.back() << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = unsigned;\nusing u64 = unsigned long long;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\ntemplate <class T, class U>\nvector<T> make_v(U size, const T& init){ return vector<T>(static_cast<size_t>(size), init); }\n\ntemplate<class... Ts, class U>\nauto make_v(U size, Ts... rest) { return vector<decltype(make_v(rest...))>(static_cast<size_t>(size), make_v(rest...)); }\n\ntemplate<class T> void chmin(T &a, const T &b){ a = (a < b ? a : b); }\ntemplate<class T> void chmax(T &a, const T &b){ a = (a > b ? a : b); }\n\nint main() {\n    int m, n;\n    cin >> m >> n;\n    vector<int> S(m+1), T(m+1);\n    for (int i = 0; i < m; ++i) {\n        scanf(\"%d %d\", &S[i+1], &T[i+1]);\n        S[i+1] += S[i]; T[i+1] += T[i];\n    }\n    vector<int> A(n), B(n);\n    for (int i = 0; i < n; ++i) {\n        cin >> A[i] >> B[i];\n    }\n    vector<int> dp(1 << n);\n    for (int i = 0; i < (1 << n); ++i) {\n        for (int j = 0; j < n; ++j) {\n            if(i & (1 << j)) continue;\n            chmax(dp[i^(1 << j)], dp[i]);\n            int ok = dp[i^(1 << j)], ng = m+1;\n            while(ng-ok > 1){\n                int mid = (ok+ng)/2;\n                if(S[mid]-S[dp[i]] <= A[j] && T[mid]-T[dp[i]] <= B[j]) ok = mid;\n                else ng = mid;\n            }\n            dp[i^(1 << j)] = ok;\n        }\n    }\n    cout << dp.back() << \"\\n\";\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<ll> V;\ntypedef pair<ll,ll> P;\ntypedef map<ll,ll> M;\n\n#define REP(i, n) for(ll (i) = 0; (i) < (n); ++(i))\n#define FOR(i, j, n) for(ll (i) = (j); (i) < (n); ++(i))\n#define REPR(i, n) for(ll (i) = (n); (i) >= 0; --(i))\n\nconst ll MOD = 1e9+7;\n\nsigned main(){\n    ll m,n;\n    cin >> m >> n;\n    V w(m);\n    V t(m);\n    V c(n);\n    V b(n);\n    REP(i,m)cin >> w[i] >> t[i];\n    REP(i,n)cin >> c[i] >> b[i];\n\n    V wrui(m+1, 0);\n    V trui(m+1, 0);\n    REP(i,m){\n        wrui[i+1]=wrui[i] + w[i];\n        trui[i+1]=trui[i] + t[i];\n    }\n    wrui.push_back(1e15);\n    trui.push_back(1e15);\n\n    V dp(1<<n, -1);\n    priority_queue<ll,V,greater<ll>> que;\n    dp[0] = 0;\n    que.push(0);\n    while(!que.empty()){\n        ll num = que.top();\n        que.pop();\n\n        REP(j,n){\n            if(!(num & (1 << j))){\n                ll cou_w = distance(wrui.begin(), upper_bound(wrui.begin(), wrui.end(), wrui[dp[num]] + c[j])) - 1;\n                ll cou_t = distance(trui.begin(), upper_bound(trui.begin(), trui.end(), trui[dp[num]] + b[j])) - 1;\n\n                ll next = min(cou_w, cou_t);\n                if(next > dp[num | (1<<j)]){\n                    dp[num | (1<<j)] = next;\n                    que.push(num | (1<<j));\n                }\n            }\n        }\n    }\n    cout << dp.back() << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\n\nint M, N;\nint64 w[200001], t[200001];\nint c[15], b[15];\nint dp[1 << 15];\n\nint main()\n{\n  cin >> M >> N;\n  for(int i = 1; i <= M; i++) {\n    cin >> w[i] >> t[i];\n    w[i] += w[i - 1];\n    t[i] += t[i - 1];\n  }\n  for(int i = 0; i < N; i++) {\n    cin >> c[i] >> b[i];\n  }\n  dp[0] = 0;\n  for(int i = 0; i < 1 << N; i++) {\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) continue;\n      int weightHigh = upper_bound(w, w + M + 1, w[dp[i]] + c[j]) - w - 1;\n      int widthHigh  = upper_bound(t, t + M + 1, t[dp[i]] + b[j]) - t - 1;\n      dp[i|(1 << j)] = max(dp[i|(1 << j)], min(weightHigh, widthHigh));\n    }\n  }\n  cout << *max_element(dp, dp + (1 << N)) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main()\n{\n    int M, N; cin>>M>>N;\n    vector<int> sumW(M+1), sumT(M+1);\n    for(int i=0;i<M;i++){\n        int W, T; cin>>W>>T;\n        sumW[i+1]=sumW[i]+W;\n        sumT[i+1]=sumT[i]+T;\n    }\n    //for(int i=0;i<=M;i++) cout<<sumW[i]<<' '; cout<<endl;\n    //for(int i=0;i<=M;i++) cout<<sumT[i]<<' '; cout<<endl;\n    vector<int> c(N), b(N);\n    for(int i=0;i<N;i++){\n        cin>>c[i]>>b[i];\n    }\n\n    vector<int> dp(1<<N, -1);\n    dp[0]=0;\n    for(int S=0;S<(1<<N);S++){\n        if(dp[S]==-1) continue;\n        for(int i=0;i<N;i++){\n            if(S>>i&1) continue;\n            int j1=upper_bound(sumW.begin(), sumW.end(), sumW[dp[S]]+c[i])-sumW.begin()-1;\n            int j2=upper_bound(sumT.begin(), sumT.end(), sumT[dp[S]]+b[i])-sumT.begin()-1;\n            int j=min(j1, j2);\n            dp[S|(1<<i)]=max(dp[S|(1<<i)], j);\n        }\n    }\n    cout<<dp[(1<<N)-1]<<endl;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint m, n;\nint w[200010], t[200010];\nint dp[100010];\nint c[20], b[20];\n\nbool isOK(int i, int left, int right){\n\treturn (c[i] >= w[right+1]-w[left]) && (b[i] >= t[right+1]-t[left]);\n}\n\nint search(int i, int num){\n\tint left = num-1;\n\tint right = m;\n\twhile(right - left > 1){\n\t\tint mid = left + (right - left) / 2;\n\t\tif(isOK(i, num, mid)) left = mid;\n\t\telse right = mid;\n\t}\n\t\n\treturn right;\n}\n\n\nint solve(int bit){\n\tif(bit == ((1 << n)-1)){\n\t\treturn 0;\n\t}\n\t\n\tif(dp[bit] != -1) return dp[bit];\t\n\t\n\tint ans = 0;\n\tfor(int i = 0;i < n;i++){\n\t  if((bit & (1 << i)) == 0){\n\t\t\tint tmp = solve(bit | (1 << i));\n\t\t\ttmp = search(i, tmp);\n\t\t\tans = max(ans, tmp);\n\t\t}\n\t}\n\t\n\treturn dp[bit] = ans;\n}\t\t\t\n\nint main(){\n\tcin >> m >> n;\n\t\n\tint wt, tt;\n\tfor(int i = 0;i < m;i++){\n\t\tcin >> wt >> tt;\n\t\tw[i+1] = w[i] + wt;\n\t\tt[i+1] = t[i] + tt;\n\t}\n\t\n\tfor(int i = 0;i < n;i++){\n\t\tcin >> c[i] >> b[i];\n\t}\n\t\n\tmemset(dp,-1,sizeof(dp));\n\t\n\tcout << solve(0) << endl;\t\n}\n\t\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\n\nint main()\n{\n  int M, N;\n  int64 w[200001] = {}, t[200002] = {};\n  int c[15], b[15];\n  int dp[1 << 15] = {};\n  \n  scanf(\"%d %d\", &M, &N);\n  for(int i = 1; i <= M; i++) {\n    scanf(\"%lld %lld\", &w[i], &t[i]);\n    w[i] += w[i - 1];\n    t[i] += t[i - 1];\n  }\n  for(int i = 0; i < N; i++) {\n    scanf(\"%d %d\", &c[i], &b[i]);\n  }\n  for(int i = 0; i < 1 << N; i++) {\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) continue;\n      int weightHigh = upper_bound(w + dp[i], w + M + 1, w[dp[i]] + c[j]) - w - 1;\n      int widthHigh  = upper_bound(t + dp[i], t + M + 1, t[dp[i]] + b[j]) - t - 1;\n      dp[i|(1 << j)] = max(dp[i|(1 << j)], min(weightHigh, widthHigh));\n    }\n  }\n  printf(\"%d\\n\", dp[(1 << N) - 1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define REP(i, n) FOR(i, 0, n)\n#define FOR(i, a, b) for(int i = a; i < b; i++)\n\n#define PB push_back\n#define PI 3.141592653589793238462643383279L\n\n#define MOD 1000000007LL\ntypedef long long ll;\ntypedef long double ld;\n\n#define LAR(a, b) a=max(a, (b))\n#define SQ(x) ((x)*(x))\n\nint w[212345], x[212345];\nint ms[212345], xs[212345];\nint wb[20], xb[20];\nint n, m;\n\ntypedef map<int, int> mii;\n#define itr iterator\n\nmap<int, int> memo[65536];\nint ama(int, int);\nint DP(int, int);\nint dp(int a, int b){\n\tmii::itr it = memo[a].find(b);\n\tif(it!=memo[a].end())\n\t\treturn it->second;\n\telse\n\t\treturn memo[a][b]=DP(a, b);\n}\nint DP(int a, int b){\n\tint ret = b;\n\tREP(i, m){\n\t\tif((a&(1<<i))==0){\n\t\t\tLAR(ret, dp(a|(1<<i), ama(b, i)));\n\t\t}\n\t}\n\treturn ret;\n}\nint ama(int a, int b){\n\tint lo = a,\n\t\t\thg = n+1;\n\twhile(hg-lo>1){\n\t\tint md = (lo+hg)/2;\n\t\tif(ms[md]-ms[a]<=wb[b] && xs[md]-xs[a]<=xb[b])\n\t\t\tlo = md;\n\t\telse\n\t\t\thg = md;\n\t}\n\treturn lo;\n}\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tREP(i, n) scanf(\"%d%d\", w+i, x+i);\n\tREP(i, m) scanf(\"%d%d\", wb+i, xb+i);\n\tms[0]=xs[0]=0;\n\tREP(i, n){\n\t\tms[i+1]=ms[i]+w[i];\n\t\txs[i+1]=xs[i]+x[i];\n\t}\n\tprintf(\"%d\\n\", dp(0, 0));\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing pll=pair<ll,ll>;\nconst ll LINF=0x1fffffffffffffff;\n#define _name3(_1,_2,_3,name,...) name\n#define _rep1(n) for(ll i=0;i<(n);++i)\n#define _rep2(i,n) for(ll i=0;i<(n);++i)\n#define _rep3(i,a,b) for(ll i=(a);i<(b);++i)\n#define rep(...) _name3(__VA_ARGS__,_rep3,_rep2,_rep1)(__VA_ARGS__)\n#define rrep(i,a,b) for(ll i=(b)-1;i>=(a);i--)\n#define each(i,a) for(auto &i:a)\n#define sum(a) accumulate(range(a),0LL)\n#define range(i) (i).begin(),(i).end()\ntemplate<class T> inline constexpr bool chmin(T &a,const T &b){ if(a>b){ a=b; return 1; } else return 0; }\ntemplate<class T> inline constexpr bool chmax(T &a,const T &b){ if(a<b){ a=b; return 1; } else return 0; }\n\nint main(){\n    ll m,n;\n    cin>>m>>n;\n    vector<pll>a(m);\n    each(i, a)cin>>i.first>>i.second;\n    vector<pll>b(n);\n    each(i, b)cin>>i.first>>i.second;\n    ll book[n][m+1]={};\n    rep(n){\n        ll C=b[i].first,B=b[i].second;\n        ll width=0,weight=0,at=0;\n        rep(j,m){\n            while(at<m&&weight+a[at].first<=C&&width+a[at].second<=B){\n                weight+=a[at].first;\n                width+=a[at].second;\n                at++;\n            }\n            book[i][j]=at-j;\n            weight-=a[j].first;\n            width-=a[j].second;\n        }\n    }\n    ll dp[1<<n]={};\n    rep(1<<n){\n        rep(j,n)if((i>>j)&1^1){\n            chmax(dp[i|(1<<j)],dp[i]+book[j][dp[i]]);\n        }\n    }\n    cout<<dp[(1<<n)-1]<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing LL = long long;\n\nint main() {\n  int M, N;\n  cin >> M >> N;\n\n  vector<LL> W = {0}, T = {0};\n  for(int i = 1; i <= M; ++i) {\n    LL w, t;\n    cin >> w >> t;\n    W.push_back(W.back() + w);\n    T.push_back(T.back() + t);\n  }\n\n  vector<int> C(N), B(N);\n  for(int i = 0; i < N; ++i) cin >> C[i] >> B[i];\n\n  auto weight = [W](int i, int j) {return W[j] - W[i - 1];};\n  auto thickness = [T](int i, int j) {return T[j] - T[i - 1];};\n  auto lastvolume = [&](LL start, int i) {\n    LL low = start - 1, high = M + 1;\n    while(high - low > 1) {\n      int middle = (low + high) / 2;\n      auto w = weight(start, middle) <= C[i];\n      auto b = thickness(start, middle) <= B[i];\n      if(w & b) low = middle;\n      else      high = middle;\n    }\n    return low;\n  };\n\n  const int BIT = 1 << N;\n  auto get = [](int bit, int i) {return (bit >> i) & 1;};\n  auto set = [](int bit, int i) {return bit | (1 << i);};\n\n  vector<LL> dp(BIT);\n  for(int bit = 0; bit < BIT; ++bit) {\n    for(int i = 0; i < N; ++i) if(!get(bit, i)) {\n      auto nex = set(bit, i);\n      dp[nex] = max(dp[nex], lastvolume(dp[bit] + 1, i));\n    }\n  }\n  cout << *max_element(begin(dp), end(dp)) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define W first\n#define T second\nusing namespace std;\ntypedef pair<long long,long long> P;\nP book[200005],tana[20];\nlong long mem[1<<16];\nlong long m,n;\nlong long wacc[200005]={0};long long tacc[200005]={0};\nlong long bitDP();\nmain(){\n  cin>>m>>n;\n  for(int i=1;i<=m;i++){\n    cin>>book[i].W>>book[i].T;\n    wacc[i]=wacc[i-1]+book[i].W;\n    tacc[i]=tacc[i-1]+book[i].T;\n  }\n  for(int i=1;i<=n;i++){\n    cin>>tana[i].W>>tana[i].T;\n  }\n  memset(mem,0,sizeof(mem));\n  cout<<bitDP()<<endl;\n}\nlong long bitDP(){\n  for(int i=0;i<(1<<n);i++){\n    long long d=1;\n    for(int j=1;j<=n;j++){\n      if((i&d)==0){\n\tlong long a=upper_bound(wacc+mem[i],wacc+m+1,wacc[mem[i]]+tana[j].W)-wacc-1;\n\tlong long b=upper_bound(tacc+mem[i],tacc+m+1,tacc[mem[i]]+tana[j].T)-tacc-1;\n\t//cout<<j<<\" \"<<a<<\" \"<<b<<endl;\n\tmem[(i|d)]=max(mem[(i|d)],min(a,b));\n      }\n      d=d<<1;\n    }\n  }\n  for(int i=0;i<(1<<n);i++){\n    //cout<<mem[i]<<endl;\n  }\n  return mem[(1<<n)-1];\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\n\nint main()\n{\n  int M, N;\n  int64 w[200001] = {}, t[200001] = {};\n  int c[15], b[15];\n  int dp[1 << 15];\n  \n  scanf(\"%d %d\", &M, &N);\n  for(int i = 1; i <= M; i++) {\n    scanf(\"%lld %lld\", &w[i], &t[i]);\n    w[i] += w[i - 1];\n    t[i] += t[i - 1];\n  }\n  for(int i = 0; i < N; i++) {\n    scanf(\"%d %d\", &c[i], &b[i]);\n  }\n  for(int i = 0; i < 1 << N; i++) {\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) continue;\n      int weightHigh = upper_bound(w + dp[i], w + M + 1, w[dp[i]] + c[j]) - w - 1;\n      int widthHigh  = upper_bound(t + dp[i], t + M + 1, t[dp[i]] + b[j]) - t - 1;\n      dp[i|(1 << j)] = max(dp[i|(1 << j)], min(weightHigh, widthHigh));\n    }\n  }\n  printf(\"%d\\n\", dp[(1 << N) - 1]);\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\n#include <set>\n#include <map>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main(){\n\n\tint POW[16];\n\tfor(int i = 0; i < 16; i++)POW[i] = pow(2,i);\n\n\tint M,N;\n\tscanf(\"%d %d\",&M,&N);\n\n\tint* W_ruisekiwa = new int[M+1];\n\tint* T_ruisekiwa = new int[M+1];\n\n\tW_ruisekiwa[0] = 0;\n\tT_ruisekiwa[0] = 0;\n\n\tfor(int i = 1; i <= M; i++){\n\t\tscanf(\"%d %d\",&W_ruisekiwa[i],&T_ruisekiwa[i]);\n\t\tW_ruisekiwa[i] += W_ruisekiwa[i-1];\n\t\tT_ruisekiwa[i] += T_ruisekiwa[i-1];\n\t}\n\n\tint w_limit[N],t_limit[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d %d\",&w_limit[i],&t_limit[i]);\n\t}\n\n\tint* dp = new int[POW[N]];\n\n\tfor(int i = 0; i < POW[N]; i++)dp[i] = 0;\n\n\tint left,right,m,end_book,next_state;\n\n\tfor(int state = 0; state < POW[N]; state++){\n\n\t\tint start_book = dp[state]+1;\n\n\t\tif(start_book == M+1){\n\t\t\tprintf(\"%d\\n\",M);\n\t\t\treturn 0;\n\t\t}\n\n\t\tfor(int loop = 0; loop < N; loop++){\n\t\t\tif(state & (1 << loop)){\n\t\t\t\t//Do nothing\n\t\t\t}else{\n\n\t\t\t\tleft = start_book,right = M,m = (left+right)/2;\n\t\t\t\tend_book = BIG_NUM;\n\n\t\t\t\twhile(left <= right){\n\t\t\t\t\tif(W_ruisekiwa[m]-W_ruisekiwa[start_book-1] <= w_limit[loop] && T_ruisekiwa[m]-T_ruisekiwa[start_book-1] <= t_limit[loop]){\n\t\t\t\t\t\tend_book = m;\n\t\t\t\t\t\tleft = m+1;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tright = m-1;\n\t\t\t\t\t}\n\t\t\t\t\tm = (left+right)/2;\n\t\t\t\t}\n\n\t\t\t\tif(end_book == BIG_NUM){\n\t\t\t\t\tend_book = dp[state];\n\t\t\t\t}\n\n\t\t\t\tnext_state = state + POW[loop];\n\n\t\t\t\tdp[next_state] = max(dp[next_state],end_book);\n\t\t\t}\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\",dp[POW[N]-1]);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint m, n;\nint w[200010], t[200010];\nint dp[100010];\nint c[20], b[20];\n\nbool isOK(int i, int left, int right){\n\treturn (c[i] >= w[right+1]-w[left]) && (b[i] >= t[right+1]-t[left]);\n}\n\nint search(int i, int num){\n\tint left = num-1;\n\tint right = m;\n\twhile(right - left > 1){\n\t\tint mid = left + (right - left) / 2;\n\t\tif(isOK(i, num, mid)) left = mid;\n\t\telse right = mid;\n\t}\n\t\n\treturn right;\n}\n\n\nint solve(int bit){\n\tif(bit == ((1 << n)-1)){\n\t\treturn 0;\n\t}\n\t\n\tif(dp[bit] != -1) return dp[bit];\t\n\t\n\tint ans = 0;\n\tfor(int i = 0;i < n;i++){\n\t  if((bit & (1 << i)) == 0){\n\t\t\tint tmp = solve(bit | (1 << i));\n\t\t\ttmp = search(i, tmp);\n\t\t\tans = max(ans, tmp);\n\t\t}\n\t}\n\t\n\treturn dp[bit] = ans;\n}\t\t\t\n\nint main(){\n\tcin >> m >> n;\n\t\n\tint wt, tt;\n\tfor(int i = 0;i < m;i++){\n\t\tcin >> wt >> tt;\n\t\tw[i+1] = w[i] + wt;\n\t\tt[i+1] = t[i] + tt;\n\t}\n\t\n\tfor(int i = 0;i < n;i++){\n\t\tcin >> c[i] >> b[i];\n\t}\n\t\n\tmemset(dp,-1,sizeof(dp));\n\t\n\tcout << solve(0) << endl;\t\n}\n\t\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint c[15],b[15];\nint w[200010];\nint t[200010];\nint best[200010][15];\n\nint dp[1<<15];\nsigned main(){\n\t\tint M,N;\n\t\tcin >> M >> N;\n\t\tvector< pair<int,int> > v;\n\t\tfor(int i = 0 ; i < M ; i++){\n\t\t\tcin >> w[i] >> t[i];\n\t\t\t//w[i] = rand() % 100 + 1;\n\t\t\t//t[i] = rand() % 100 + 1;\n\t\t}\n\t\tfor(int i = 0 ; i < N ; i++){\n\t\t\tcin >> c[i] >> b[i];\n\t\t\t//c[i] = rand() % 1000000 + 1;\n\t\t\t//b[i] = rand() % 1000000 + 1;\n\t\t\tint r=0;\n\t\t\tint W=0,T=0;\n\t\t\tfor(int j = 0 ; j < M ; j++){\n\t\t\t\twhile( r < M and W + w[r] <= c[i] and T + t[r] <= b[i] ){\n\t\t\t\t\tW += w[r];\n\t\t\t\t\tT += t[r];\n\t\t\t\t\tr++;\n\t\t\t\t}\n\t\t\t\tbest[j][i] = r;\n\t\t\t\t//cout << i << \"; \" << j << \"->\" <<  r << \" \" << W << \" \" << T << endl;\n\t\t\t\tif(j<r){\n\t\t\t\t\tW -= w[j];\n\t\t\t\t\tT -= t[j];\n\t\t\t\t}else{\n\t\t\t\t\tr++;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tfor(int i = 0 ; i < (1<<N) ; i++){\n\t\t\tfor(int j = 0 ; j < N ; j++){\n\t\t\t\tif( !(i >> j & 1) ){\n\t\t\t\t\tdp[i|(1<<j)] = max(dp[i|(1<<j)],best[dp[i]][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[(1<<N)-1] << endl;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ Vol-3 0312: Net Cafe\n// 2017.9.30\n\n#include <stdio.h>\n\n#define MAX 200005\n#define N 16\n\nint m;\nint w[MAX], t[MAX];;\nint sw[MAX], st[MAX];\nint c[N], b[N];\nint dp[N][32770];\t\t// 32768 = 2^15\n\nint bsch(int *a, int x)\n{\n\tint h, l = 1, r = m;\n\n    while (l < r) {\n        h = (l + r) >> 1;\n\t\tif (a[h] == x) return h;\n        if (a[h] < x) l = h + 1; else r = h;\n    }\n\treturn l-1;\n}\n\nint main()\n{\n\tint n, i, j, k, x, y, lim, ans;\n\n\tscanf(\"%d%d\", &m, &n); m++;\n\tfor (sw[0] = st[0] = 0, i = 1; i < m; i++) {\n\t\tscanf(\"%d%d\", w+i, t+i);\n\t\tsw[i] = sw[i-1] + w[i], st[i] = st[i-1] + t[i];\n\t}\n\tfor (i = 0; i < n; i++) scanf(\"%d%d\", c+i, b+i);\n\n//\tmemset(dp, 0, sizeof(dp));\n\tfor (i = 0; i < n; i++)\t{\n\t\tx = bsch(sw, c[i]);\n\t\ty = bsch(st, b[i]);\n\t\tif (x > y) x = y;\n\t\tif (x == m-1) { ans = m-1; goto Done; }\n\t\tdp[0][1<<i] = x;\n\t}\n\n\tlim = 1 << n;\n\tfor (k = 1; k < lim; k++) {\n\t\tfor (i = 0; i < n; i++)\t{\t\t\t// this book shelf\n\t\t\tfor (j = 0; j < n; j++) {\t\t// last book shelf\n\t\t\t\tif (dp[j][k] && !(k & (1<<i))) {\n\t\t\t\t\tint ii = k | (1 << i);\n\t\t\t\t\tx = bsch(sw, sw[dp[j][k]] + c[i]);\n\t\t\t\t\ty = bsch(st, st[dp[j][k]] + b[i]);\n\t\t\t\t\tif (x > y) x = y;\n\t\t\t\t\tif (x > dp[i][ii]) dp[i][ii] = x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (ans = 0, i = 0; i < n; i++) if (dp[i][lim-1] > ans) ans = dp[i][lim-1];\nDone:\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tint i,tana,M,N,w[200000],t[200000],c[15],b[15];\n\tscanf(\"%d %d\",&M,&N);tana=N;\n\tfor(i=0;i<M;i++){scanf(\"%d %d\",&w[i],&t[i]);}\n\tfor(i=0;i<N;i++){scanf(\"%d %d\",&c[i],&b[i]);}\n\ti=0;\n\twhile(N--){\n\t\twhile(c[tana-N]>=w[i]&&b[tana-N]>=t[i]){\n\t\t\tc[tana-N]-=w[i];\n\t\t\tb[tana-N]-=t[i];\n\t\t\ti++;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",i);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ Vol-3 0312: Net Cafe\n// 2017.9.30\n\n#include <stdio.h>\n\n#define MAX 200005\n#define N 16\n\nint m;\nint w[MAX], t[MAX];;\nint sw[MAX], st[MAX];\nint c[N], b[N];\nint dp[N][32770];\t\t// 32768 = 2^15\n\nint bsch(int *a, int x)\n{\n\tint h, l = 1, r = m;\n\n    while (l < r) {\n        h = (l + r) >> 1;\n\t\tif (a[h] == x) return h;\n        if (a[h] < x) l = h + 1; else r = h;\n    }\n\treturn l-1;\n}\n\nint main()\n{\n\tint n, i, j, k, x, y, lim, ans;\n\n\tscanf(\"%d%d\", &m, &n); m++;\n\tfor (sw[0] = st[0] = 0, i = 1; i < m; i++) {\n\t\tscanf(\"%d%d\", w+i, t+i);\n\t\tsw[i] = sw[i-1] + w[i], st[i] = st[i-1] + t[i];\n\t}\n\tfor (i = 0; i < n; i++) scanf(\"%d%d\", c+i, b+i);\n\n//\tmemset(dp, 0, sizeof(dp));\n\tfor (i = 0; i < n; i++)\t{\n\t\tx = bsch(sw, c[i]);\n\t\ty = bsch(st, b[i]);\n\t\tif (x > y) x = y;\n\t\tif (x == m-1) { ans = m-1; goto Done; }\n\t\tdp[0][1<<i] = x;\n\t}\n\n\tlim = 1 << n;\n\tfor (k = 1; k < lim; k++) {\n\t\tfor (i = 0; i < n; i++)\t{\t\t\t// this book shelf\n\t\t\tfor (j = 0; j < n; j++) {\t\t// last book shelf\n\t\t\t\tif (dp[j][k] && !(k & (1<<i))) {\n\t\t\t\t\tint ii = k | (1 << i);\n\t\t\t\t\tx = bsch(sw, sw[dp[j][k]] + c[i]);\n\t\t\t\t\ty = bsch(st, st[dp[j][k]] + b[i]);\n\t\t\t\t\tif (x > y) x = y;\n\t\t\t\t\tif (x == m-1) { ans = m-1; goto Done; }\n\t\t\t\t\tif (x > dp[i][ii]) dp[i][ii] = x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (ans = 0, i = 0; i < n; i++) if (dp[i][lim-1] > ans) ans = dp[i][lim-1];\nDone:\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ Vol-3 0312: Net Cafe\n// 2017.9.30\n\n#include <stdio.h>\n\n#define MAX 200005\n#define N 16\n\nint m;\nint w[MAX], t[MAX];;\nint sw[MAX], st[MAX];\nint c[N], b[N];\nint dp[N][32770];\t\t// 32768 = 2^15\n\nint bsch(int *a, int l, int r, int x)\n{\n\tint m;\n\n    while (l < r) {\n        m = (l + r) >> 1;\n\t\tif (a[m] == x) return m;\n        if (a[m] < x) l = m + 1; else r = m;\n    }\n\treturn l-1;\n}\n\nint main()\n{\n\tint n, i, j, k, x, y, lim, ans;\n\n\tscanf(\"%d%d\", &m, &n); m++;\n\tfor (sw[0] = st[0] = 0, i = 1; i < m; i++) {\n\t\tscanf(\"%d%d\", w+i, t+i);\n\t\tsw[i] = sw[i-1] + w[i], st[i] = st[i-1] + t[i];\n\t}\n\tfor (i = 0; i < n; i++) scanf(\"%d%d\", c+i, b+i);\n\n//\tmemset(dp, 0, sizeof(dp));\n\tfor (i = 0; i < n; i++)\t{\n\t\tx = bsch(sw, 1, m, c[i]);\n\t\ty = bsch(st, 1, m, b[i]);\n\t\tif (x > y) x = y;\n\t\tif (x == m-1) { ans = m-1; goto Done; }\n\t\tdp[0][1<<i] = x;\n\t}\n\n\tlim = 1 << n;\n\tfor (k = 1; k < lim; k++) {\n\t\tfor (i = 0; i < n; i++)\t{\t\t\t// this book shelf\n\t\t\tfor (j = 0; j < n; j++) {\t\t// last book shelf\n\t\t\t\tif (dp[j][k] && !(k & (1<<i))) {\n\t\t\t\t\tint ii = k | (1 << i);\n\t\t\t\t\tint t = dp[j][k];\n\t\t\t\t\tx = bsch(sw, t, m, sw[t] + c[i]);\n\t\t\t\t\ty = bsch(st, t, m, st[t] + b[i]);\n\t\t\t\t\tif (x > y) x = y;\n\t\t\t\t\tif (x == m-1) { ans = m-1; goto Done; }\n\t\t\t\t\tif (x > dp[i][ii]) dp[i][ii] = x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (ans = 0, i = 0; i < n; i++) if (dp[i][lim-1] > ans) ans = dp[i][lim-1];\nDone:\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\npublic class Main {\n\n\tpublic static final int BIG_NUM = 2000000000;\n\tpublic static final int MOD = 1000000007;\n\tpublic static final long HUGE_NUM = 99999999999999999L;\n\tpublic static final double EPS = 0.000000001;\n\n\tpublic static int SIZE = 16;\n\n\t@SuppressWarnings(\"unchecked\")\n\tpublic static void main(String[] args) {\n\n\t\t//BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tScanner scanner = new Scanner(System.in);\n\n\t\tint POW[] = new int[SIZE];\n\t\tPOW[0] = 1;\n\t\tfor(int i = 1; i < SIZE; i++){\n\n\t\t\tPOW[i] = POW[i-1]*2;\n\t\t}\n\n\t\tint M = scanner.nextInt();\n\t\tint N = scanner.nextInt();\n\n\t\t//本の情報\n\t\tInfo info[] = new Info[M+1];\n\t\tfor(int i = 0; i <= M; i++){\n\n\t\t\tinfo[i] = new Info();\n\t\t}\n\t\tinfo[0].set(0, 0);\n\n\t\t//棚\n\t\tInfo shelf[] = new Info[N];\n\t\tfor(int i = 0; i < N; i++){\n\n\t\t\tshelf[i] = new Info();\n\t\t}\n\n\t\tfor(int i = 1; i <= M; i++){\n\n\t\t\tinfo[i].set(scanner.nextInt(), scanner.nextInt());\n\t\t\tinfo[i].weight += info[i-1].weight;\n\t\t\tinfo[i].thick += info[i-1].thick;\n\t\t}\n\n\t\tfor(int i = 0; i < N; i++){\n\n\t\t\tshelf[i].set(scanner.nextInt(), scanner.nextInt());\n\t\t}\n\n\t\tint dp[] = new int[POW[N]];\n\t\tfor(int state = 0; state < POW[N]; state++){\n\n\t\t\tdp[state] = 0; //dp[集合] = 最大冊数\n\t\t}\n\n\t\tboolean FLG = false;\n\n\t\tfor(int state = 0; state < POW[N]; state++){\n\n\t\t\tint next_start = dp[state]+1; //格納を開始する本\n\n\t\t\tfor(int next_shelf = 0; next_shelf < N; next_shelf++){\n\t\t\t\tif((state & POW[next_shelf]) != 0)continue; //集合に含まれているならSKIP\n\n\t\t\t\tint next_state = state+POW[next_shelf];\n\n\t\t\t\tif(info[next_start].weight-info[next_start-1].weight > shelf[next_shelf].weight ||\n\t\t\t\t\t\tinfo[next_start].thick-info[next_start-1].thick > shelf[next_shelf].thick){ //1冊も入らない場合\n\n\t\t\t\t\tdp[next_state] = Math.max(dp[next_state],dp[state]);\n\n\t\t\t\t}else{\n\n\t\t\t\t\tint left = next_start,right = M,mid = (left+right)/2;\n\t\t\t\t\tint tail = next_start;\n\n\t\t\t\t\twhile(left <= right){\n\n\t\t\t\t\t\tif(info[mid].weight-info[next_start-1].weight <= shelf[next_shelf].weight &&\n\t\t\t\t\t\t\t\tinfo[mid].thick-info[next_start-1].thick <= shelf[next_shelf].thick){\n\n\t\t\t\t\t\t\ttail = mid;\n\t\t\t\t\t\t\tleft = mid+1;\n\n\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\tright = mid-1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmid = (left+right)/2;\n\t\t\t\t\t}\n\t\t\t\t\tif(tail == M){\n\n\t\t\t\t\t\tSystem.out.println(M);\n\t\t\t\t\t\tFLG = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdp[next_state] = Math.max(dp[next_state],tail);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(FLG){\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(!FLG){\n\n\t\t\tSystem.out.println(dp[POW[N]-1]);\n\t\t}\n    }\n}\n\nclass Info{\n\n\tpublic long weight;\n\tpublic long thick;\n\n\tpublic void set(int arg_weight,int arg_thick){\n\t\tweight = arg_weight;\n\t\tthick = arg_thick;\n\t}\n}\n\nclass UTIL{\n\n\t//最大公約数\n\tpublic static long gcd(long x,long y){\n\n\t\tx = Math.abs(x);\n\t\ty = Math.abs(y);\n\n\t\tif(x < y){\n\n\t\t\tlong tmp = y;\n\t\t\ty = x;\n\t\t\tx = tmp;\n\t\t}\n\n\t\tif(y == 0){\n\n\t\t\treturn x;\n\t\t}else{\n\n\t\t\treturn gcd(y,x%y);\n\t\t}\n\t}\n\n\t//最小公倍数\n\tpublic static long lcm(long x,long y){\n\n\t\treturn (x*y)/gcd(x,y);\n\t}\n\n\t//String→intへ変換\n    public static int getNUM(String tmp_str){\n\n        return Integer.parseInt(tmp_str);\n    }\n\n    //文字が半角数字か判定する関数\n    public static boolean isNumber(String tmp_str){\n\n        if(tmp_str == null || tmp_str.length() == 0){\n\n            return false;\n        }\n\n        Pattern pattern = Pattern.compile(\"\\\\A[0-9]+\\\\z\");\n        Matcher matcher = pattern.matcher(tmp_str);\n        return matcher.matches();\n    }\n}\n"
  },
  {
    "language": "C#",
    "code": "using System;\n\nnamespace AOJ.Volume3\n{\n    public class NetCafe\n    {\n        public static int Main()\n        {\n            var input = Console.ReadLine().Split(' ');\n            int m = int.Parse(input[0]);\n            int n = int.Parse(input[1]);\n\n            int[] weight = new int[m];\n            int[] tick = new int[m];\n            for(int i = 0; i < m; i++)\n            {\n                input = Console.ReadLine().Split(' ');\n                weight[i] = int.Parse(input[0]);\n                tick[i] = int.Parse(input[1]);\n            }\n\n            int counter = 0;\n            for(int i= 0; i < n; i++)\n            {\n                input = Console.ReadLine().Split(' ');\n                int c_weight = int.Parse(input[0]);\n                int c_tick = int.Parse(input[1]);\n\n                while(c_weight >= 0 && c_tick >= 0)\n                {\n                    if (c_weight >= weight[counter]) { c_weight -= weight[counter]; }\n                    else { break; }\n\n                    if (c_tick >= tick[counter]) { c_tick -= tick[counter]; }\n                    else { break; }\n\n                    counter++;\n                }\n            }\n\n            Console.WriteLine(counter);\n            return 0;\n        }\n    }\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing static System.Math;\npublic class hello\n{\n\tstatic int dpmax;\n\tpublic static void Main()\n\t{\n\n\t\tstring[] line = Console.ReadLine().Trim().Split(' ');\n\t\tvar m = int.Parse(line[0]);\n\t\tvar n = int.Parse(line[1]);\n\t\tdpmax = 1 << n;\n\t\tvar book = getData(m);\n\t\tvar s = getData(n);\n\t\tvar book2 = getCsum(book, m);\n\t\tvar dp = new int[dpmax];\n\t\tfor (int i = 1; i < dpmax; i++) dp[i] = -10;\n\t\tdp[0] = -1;\n\t\tvar ans = getAns(dp, book2, m, s, n);\n\t\tConsole.WriteLine(ans == 0 ? 0 : ans + 1);\n\t}\n\tstatic int getAns(int[] dp, int[,] book2, int m, int[,] s, int n)\n\t{\n\t\tvar ans = 0;\n\t\tfor (int i = 0; i < dpmax; i++)\n\t\t{\n\t\t\tif (dp[i] == m - 1) return m - 1;\n\t\t\tfor (int j = 0; j < n; j++)\n\t\t\t{\n\t\t\t\tif (dp[i] != -10)\n\t\t\t\t\tif (((i >> (n - j - 1)) & 1) == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar ww = i | (1 << (n - j - 1));\n\t\t\t\t\t\tvar t = goBS(book2, m, s, n, j, dp[i] + 1);\n\t\t\t\t\t\tif (t != -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[ww] = Max(dp[ww], t);\n\t\t\t\t\t\t\tans = Max(ans, dp[ww]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tstatic int goBS(int[,] book2, int m, int[,] s, int n, int t, int next)\n\t{\n\t\tif ((book2[m, 0] - book2[next, 0] <= s[t, 0]) && (book2[m, 1] - book2[next, 1] <= s[t, 1]))\n\t\t\treturn m - 1;\n\t\tif ((book2[next + 1, 0] - book2[next, 0] > s[t, 0]) | (book2[next + 1, 1] - book2[next, 1] > s[t, 1]))\n\t\t\treturn -1;\n\t\tvar ok = next;\n\t\tvar ng = m - 1;\n\t\twhile (ng - ok > 1)\n\t\t{\n\t\t\tvar mid = ok + (ng - ok) / 2;\n\t\t\tif ((book2[mid + 1, 0] - book2[next, 0] <= s[t, 0]) && (book2[mid + 1, 1] - book2[next, 1] <= s[t, 1]))\n\t\t\t\tok = mid;\n\t\t\telse ng = mid;\n\t\t}\n\t\treturn ok;\n\t}\n\tstatic int[,] getCsum(int[,] a, int n)\n\t{\n\t\tvar ans = new int[n + 1, 2];\n\t\tfor (int i = 0; i < n; i++)\n\t\t{\n\t\t\tans[i + 1, 0] = ans[i, 0] + a[i, 0];\n\t\t\tans[i + 1, 1] = ans[i, 1] + a[i, 1];\n\t\t}\n\t\treturn ans;\n\t}\n\tstatic int[,] getData(int n)\n\t{\n\t\tvar ans = new int[n, 2];\n\t\tfor (int i = 0; i < n; i++)\n\t\t{\n\t\t\tstring[] line = Console.ReadLine().Trim().Split(' ');\n\t\t\tans[i, 0] = int.Parse(line[0]);\n\t\t\tans[i, 1] = int.Parse(line[1]);\n\t\t}\n\t\treturn ans;\n\t}\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\n\nnamespace AOJ.Volume3\n{\n    public class NetCafe\n    {\n        public static int Main()\n        {\n            var input = Console.ReadLine().Split(' ');\n            int m = int.Parse(input[0]);\n            int n = int.Parse(input[1]);\n\n            var weight = new int[m + 1];\n            var thick = new int[m + 1];\n            for(int i = 1; i <= m; i++)\n            {\n                input = Console.ReadLine().Split(' ');\n                weight[i] = int.Parse(input[0]);\n                thick[i] = int.Parse(input[1]);\n            }\n\n            int book_cnt = 0;\n            for(int i = 1; i <= n; i++)\n            {\n                input = Console.ReadLine().Split(' ');\n                int c = int.Parse(input[0]);\n                int b = int.Parse(input[1]);\n\n                while (c > 0 && b > 0)\n                {\n                    if (book_cnt >= m) { break; }\n                    if ((c >= weight[book_cnt + 1]) && (b >= thick[book_cnt + 1]))\n                    {\n                        c -= weight[book_cnt + 1];\n                        b -= thick[book_cnt + 1];\n                    }\n                    else { break; }\n\n                    book_cnt++;\n                }\n            }\n            Console.WriteLine(book_cnt);\n\n            return 0;\n        }\n    }\n}"
  },
  {
    "language": "Ruby",
    "code": "m, n = gets.split.map(&:to_i)\nbooks = (1..m).map { gets.split.map(&:to_i) }\nshelfs = (1..n).map { gets.split.map(&:to_i) }\ntsp = Array.new(2 ** n, 0)\ntsp[0] = 0\n(1..2**n).each do |x|\n    (0..n-1).each do |i|\n        next if x[i] == 0\n        c, b = shelfs[i]\n        y = x - (1 << i)\n        k = tsp[y]\n        while k < m && books[k][0] <= c && books[k][1] <= b\n            c -= books[k][0]\n            b -= books[k][1]\n            k += 1\n        end\n        tsp[x] = k if k > tsp[x]\n    end\nend\np tsp[-1]\n"
  },
  {
    "language": "Ruby",
    "code": "class Array\n    def accum\n        ac = Array.new(size + 1)\n        ac[0] = 0\n        (1..size).each do |i|\n            ac[i] = ac[i-1] + self[i-1]\n        end\n        ac\n    end\n\n    def bsearch_last_index(l = 0, r = size - 1, &pred)\n        return nil if l > r\n        c = (l + r) / 2 \n        if pred[self[c]]\n            bsearch_last_index(c+1, r, &pred) || c\n        else\n            bsearch_last_index(l, c-1, &pred)\n        end\n    end\nend\n\nm, n = gets.split.map(&:to_i)\nbooks = (1..m).map { gets.split.map(&:to_i) }\nshelfs = (1..n).map { gets.split.map(&:to_i) }\naccum = books.transpose.map(&:accum).transpose\n\ncache = {}\ntsp = Array.new(2 ** n, 0)\ntsp[0] = 0\n(1..2**n-1).each do |x|\n    (0..n-1).each do |i|\n        next if x[i] == 0\n        c, b = shelfs[i]\n        y = x - (1 << i)\n        k = tsp[y]\n        l = accum.bsearch_last_index(0, m){|aw, at| aw - accum[k][0] <= c && at - accum[k][1] <= b}\n        tsp[x] = l if l > tsp[x]\n    end\nend\np tsp[-1]\n"
  },
  {
    "language": "Ruby",
    "code": "m, n = gets.split.map(&:to_i)\nbooks = (1..m).map { gets.split.map(&:to_i) }\nshelfs = (1..n).map { gets.split.map(&:to_i) }\ntsp = Array.new(2 ** n, 0)\ntsp[0] = 0\n(1..2**n).each do |x|\n    (0..n-1).each do |i|\n        next if x[i] == 0\n        c, b = shelfs[i]\n        y = x - (1 << i)\n        k = tsp[y]\n        while k < m && books[k][0] <= c && books[k][1] <= b\n            c -= books[k][0]\n            b -= books[k][1]\n            k += 1\n        end\n        tsp[x] = k if k > tsp[x]\n    end\nend\np tsp[-1]\n"
  },
  {
    "language": "PHP",
    "code": "<?php\n{\n  $k = explode(' ', trim(fgets(STDIN)));\n\n  $bookkNum = $k[0];\n  $tanaNum = $k[1];\n\n  $books = array();\n  for($i = 0; $i < $bookkNum; ++ $i) {\n    $books[$i] = explode(' ', trim(fgets(STDIN))); // ?????? ??????\n  }\n\n  $ichidans = array();\n  for($i = 0; $i < $tanaNum; ++ $i) {\n    $ichidans[$i] = explode(' ', trim(fgets(STDIN))); // ?????? ??????\n  }\n\n  $answer =0;\n  $wait =0;\n  $width = 0;\n  $dan = 0;\n  foreach ($books as $book) {\n    $ichidan = $ichidans[$dan];\n    if($wait + $book[0] > $ichidan[0]) {\n      ++$dan;\n      $width = 0;\n      $wait = 0;\n    } else if($width + $book[1] > $ichidan[1]) {\n      ++$dan;\n      $width = 0;\n      $wait = 0;\n    }\n    if ($dan >= $tanaNum) {\n      break;\n    }\n    $ichidan = $ichidans[$dan];\n    if ($book[0] > $ichidan[0] || $book[1] > $ichidan[1]) {\n      break;\n    }\n    ++$answer;\n    $wait += $book[0];\n    $width += $book[1];\n  }\n\n  echo $answer . PHP_EOL;\n}\n~"
  },
  {
    "language": "PHP",
    "code": "<?php\n{\n  $k = explode(' ', trim(fgets(STDIN)));\n\n  $bookkNum = $k[0];\n  $tanaNum = $k[1];\n\n  $books = array();\n  for($i = 0; $i < $bookkNum; ++ $i) {\n    $books[$i] = explode(' ', trim(fgets(STDIN))); // ?????? ??????\n  }\n\n  $ichidans = array();\n  for($i = 0; $i < $tanaNum; ++ $i) {\n    $ichidans[$i] = explode(' ', trim(fgets(STDIN))); // ?????? ??????\n  }\n\n  $answer =0;\n  $wait =0;\n  $width = 0;\n  $dan = 0;\n  foreach ($books as $book) {\n    $ichidan = $ichidans[$dan];\n    if($wait + $book[0] > $ichidan[0]) {\n      ++$dan;\n      $width = 0;\n      $wait = 0;\n    } else if($width + $book[1] > $ichidan[1]) {\n      ++$dan;\n      $width = 0;\n      $wait = 0;\n    }\n    if ($dan >= $tanaNum) {\n      break;\n    }\n    ++$answer;\n    $wait += $book[0];\n    $width += $book[1];\n  }\n\n  echo $answer . PHP_EOL;\n}"
  },
  {
    "language": "PHP",
    "code": "<?php\n// Here your code !\nif (basename(__FILE__) == basename($_SERVER['PHP_SELF'])) {\n    $test = 0;\n  while ($line = fgets(STDIN)) {\n      if ($test===0) {\n          $maxAry = $line;\n      } else {\n          $ary_keyword = preg_split('/[ ]/', $line);\n      }\n      $test++;\n  }\n  sort($ary_keyword);\n  $min = 100000001;\n  $arysum = array_sum($ary_keyword);\n  $heikin = $arysum/$maxAry;\n  for($i=$maxAry-1; $i>=1; $i--) {\n      \n      $kamiya = $ary_keyword[$i]-$ary_keyword[$i-1];\n      if ($min>=$kamiya && $heikin >= $ary_keyword[$i]) {\n          $min = $kamiya;\n          $c = $ary_keyword[$i];\n          $d = $ary_keyword[$i-1];\n          $cindex = $i;\n          $dindex = $i-1;\n      }\n      \n  }\n  \n  array_splice($ary_keyword,$cindex,1);\n  array_splice($ary_keyword,$dindex,1);\n \n sort($ary_keyword);\n  \n  $a = $ary_keyword[count($ary_keyword)-1];\n  $b = $ary_keyword[count($ary_keyword)-2];\n  $kotae = ($a+$b)/($c-$d);\n\n  \n  echo round($kotae,5);\n}\n?>"
  },
  {
    "language": "PHP",
    "code": "<?php\n// Here your code !\nif (basename(__FILE__) == basename($_SERVER['PHP_SELF'])) {\n    $test = 0;\n  while ($line = fgets(STDIN)) {\n      if ($test===0) {\n          $maxAry = $line;\n      } else {\n          $ary_keyword = preg_split('/[ ]/', $line);\n      }\n      $test++;\n  }\n  sort($ary_keyword);\n  $min = 100000001;\n  $arysum = array_sum($ary_keyword);\n  $heikin = $arysum/$maxAry;\n  for($i=$maxAry-1; $i>=1; $i--) {\n      \n      $kamiya = $ary_keyword[$i]-$ary_keyword[$i-1];\n      if ($min>=$kamiya && $heikin >= $ary_keyword[$i]) {\n          $min = $kamiya;\n          $c = $ary_keyword[$i];\n          $d = $ary_keyword[$i-1];\n          $cindex = $i;\n          $dindex = $i-1;\n      }\n      \n  }\n  \n  array_splice($ary_keyword,$cindex,1);\n  array_splice($ary_keyword,$dindex,1);\n \n sort($ary_keyword);\n  \n  $a = $ary_keyword[count($ary_keyword)-1];\n  $b = $ary_keyword[count($ary_keyword)-2];\n  $kotae = ($a+$b)/($c-$d);\n\n  echo round($kotae,5);\n}\n?>"
  },
  {
    "language": "Python",
    "code": "from bisect import bisect_right as br\nfrom itertools import accumulate\n\ndef main():\n  \n  m, n = map(int, input().split())\n  books = list(list(map(int, input().split())) for _ in range(m))\n  ws = list(accumulate([0] + [book[0] for book in books]))\n  ts = list(accumulate([0] + [book[1] for book in books]))\n  shelf = list(list(map(int, input().split())) for _ in range(n))\n  \n  dic = {}\n  rest = 2 ** n - 1\n  def search(index, num):\n    wlim, tlim = shelf[num]\n    wind = br(ws, ws[index] + wlim)\n    tind = br(ts, ts[index] + tlim)\n    return min(wind, tind) - 1\n  \n  def dp(rest,  dic):\n    if rest in dic:\n      return dic[rest]\n    if rest == 0:\n      return 0\n    \n    mask = 1  \n    ret = 0\n    for i in range(n):\n      if rest & mask:\n        pre_rest = rest & ~mask\n        temp = dp(pre_rest, dic)\n        temp = search(temp, i)\n        ret = max(ret, temp)\n      mask <<= 1\n    dic[rest] = ret\n    return ret\n  \n  print(dp(rest, dic))\n\nmain()\n"
  },
  {
    "language": "Python",
    "code": "import bisect\nm, n = map(int, input().split())\nw = [tuple(map(int, input().split())) for _ in range(m)]\nw, t = map(list,zip(*w))\nfor i in range(1, m):\n    w[i] += w[i - 1]\n    t[i] += t[i - 1]\nc = [tuple(map(int, input().split())) for _ in range(n)]\nc, b = map(list,zip(*c))\na = {}\na[tuple(range(n))] = -1\nfor _ in range(n):\n    an = [(k,a[k]) for k in a]\n    a = {}\n    for x in an:\n        for p in x[0]:\n            if x[1] != -1:i = min(bisect.bisect_right(w, c[p] + w[x[1]], x[1]), bisect.bisect_right(t, b[p] + t[x[1]], x[1])) - 1\n            else:i = min(bisect.bisect_right(w, c[p]), bisect.bisect_right(t, b[p])) - 1\n            y = list(x[0])\n            y.remove(p)\n            y = tuple(y)\n            if y in a:a[y] = max(a[y], i)\n            else:a[y] = i\nprint(max([a[i] for i in a]) + 1)\n"
  }
]