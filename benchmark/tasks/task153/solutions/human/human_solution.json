[
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n    int h, w; cin >> h >> w;\n\n    for (int i = 0; i < h; ++i) cin >> mp[i];\n\n    for (int i = 0; i < 2; ++i) cin >> e[i];\n\n    int sum = 0;\n\n    for (int i = 0; i < h - 1; ++i) {\n        for (int j = 0; j < w - 1; ++j) {\n            if (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n                sum++;\n            }\n        }\n    }\n\n    for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n            int cnt = 0;\n\n            char tmp = mp[i][j];\n\n            for (int k = 0; k < 4; ++k) {\n                int y = i + dy[k], x = j + dx[k];\n                if (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n                if (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n                    cnt++;\n                }\n            }\n\n            sum -= cnt;\n\n            for (int k = 0; k < 3; ++k) {\n                mp[i][j] = a[k];\n\n                int cnt2 = 0;\n\n                for (int l = 0; l < 4; ++l) {\n                    int y = i + dy[l], x = j + dx[l];\n                    if (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n                    if (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n                        cnt2++;\n                    }\n                }\n\n                cnt = max(cnt, cnt2);\n            }\n\n            sum += cnt;\n\n            mp[i][j] = tmp;\n        }\n    }\n\n    cout << sum << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std; char s; int x[5000][5000], y[3][3], h, w, MAX, t, u, v, MAXN;\nint main() {\n\tcin >> h >> w;\n\tfor (int i = 1; i <= h; i++) {\n\t\tfor (int j = 1; j <= w; j++) {\n\t\t\tcin >> s;\n\t\t\tif (s == 'J') {\n\t\t\t\tx[i][j] = 1;\n\t\t\t}\n\t\t\telse if (s == 'O') {\n\t\t\t\tx[i][j] = 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tx[i][j] = 3;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= 2; i++) {\n\t\tfor (int j = 1; j <= 2; j++) {\n\t\t\tcin >> s;\n\t\t\tif (s == 'J') {\n\t\t\t\ty[i][j] = 1;\n\t\t\t}\n\t\t\telse if (s == 'O') {\n\t\t\t\ty[i][j] = 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ty[i][j] = 3;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i < h; i++) {\n\t\tfor (int j = 1; j < w; j++) {\n\t\t\tif (x[i][j] == y[1][1] && x[i][j + 1] == y[1][2] && x[i + 1][j] == y[2][1] && x[i + 1][j + 1] == y[2][2]) {\n\t\t\t\tMAX++;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= h; i++) {\n\t\tfor (int j = 1; j <= w; j++) {\n\t\t\tt = 0;\n\t\t\tfor (int k = -1; k <= 0; k++) {\n\t\t\t\tfor (int l = -1; l <= 0; l++) {\n\t\t\t\t\tif (x[k + i][l + j] == y[1][1] && x[k + i][l + j + 1] == y[1][2] && x[k + i + 1][l + j] == y[2][1] && x[k + i + 1][l + j + 1] == y[2][2]) {\n\t\t\t\t\t\tt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tu = x[i][j];\n\t\t\tfor (int o = 1; o <= 3; o++) {\n\t\t\t\tx[i][j] = o;\n\t\t\t\tv = 0;\n\t\t\t\tfor (int k = -1; k <= 0; k++) {\n\t\t\t\t\tfor (int l = -1; l <= 0; l++) {\n\t\t\t\t\t\tif (x[k + i][l + j] == y[1][1] && x[k + i][l + j + 1] == y[1][2] && x[k + i + 1][l + j] == y[2][1] && x[k + i + 1][l + j + 1] == y[2][2]) {\n\t\t\t\t\t\t\tv++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tMAXN = max(MAXN, v - t);\n\t\t\t}\n\t\t\tx[i][j] = u;\n\t\t}\n\t}\n\tMAX += MAXN;\n\tcout << MAX << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar field[1010][1010];\nint score[1010][1010] = {0};\nint main()\n{\n    char E[2][2];\n    int x,y,cou = 0,ans = 0,mx,my;\n    int dx[] = {0,1,0,1},dy[] = {0,0,1,1};\n    scanf(\"%d%d\",&y,&x);\n    for(int i = 0; i < y; i++)\n    {\n        scanf(\" %c\",&field[0][i]);\n        for(int j = 1; j < x; j++)\n            scanf(\"%c\",&field[j][i]);\n    }\n    for(int i = 0; i < 2; i++)\n    {\n        scanf(\" %c\",&E[0][i]);\n        for(int j = 1; j < 2; j++)\n            scanf(\"%c\",&E[j][i]);\n    }\n    for(int i = 0; i < y ; i++)\n        for(int j = 0; j < x ; j++)\n        {\n            for(int k = 0; k < 4; k++)\n                if(field[j + dx[k]][i + dy[k]] == E[dx[k]][dy[k]])\n                    cou++;\n                else\n                {\n                    mx = j + dx[k];\n                    my = i + dy[k];\n                }\n            if(cou == 3)score[mx][my]++;\n            else if(cou == 4)\n            {\n                ans++;\n                for(int k = 0; k < 4; k++)\n                    score[j + dx[k]][i + dy[k]]--;\n            }\n            cou = 0;\n        }\n    for(int i = 0; i < y; i++)\n        for(int j = 0; j < x; j++)\n            cou = max(cou,score[j][i]);\n    printf(\"%d\\n\",ans + cou);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//include----------------------------------------------------------------------------------------------------------------------\n#include <bits/stdc++.h>\n//using namespace--------------------------------------------------------------------------------------------------------------\nusing namespace std;\n\n//define-----------------------------------------------------------------------------------------------------------------------\n#define rep(i, n) for(int i = 0; i < (int)n; i++)\n#define FOR(i, s, n) for(int i = s; i < (int)n; i++)\n#define per(i, n) for(int i = n; i >= 0; i--)\n#define ROF(i, s, n) for(int i = s; i >= (int)n; i--)\n#define FORIT(i, A) for (auto i : A)\n#define PRINT(x) cout << (x) << \"\\n\"\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define EACH(i, n) for (__typeof((n).begin()) i = (n).begin(); i != (n).end(); ++i)\n#define SZ(a) int((a).size())\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n#define dump(x) cout << #x << \" = \" << (x) << \"\\n\";\n#define debug(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << \"\\n\";\n#define sq(n) (n) * (n)\n\n//typedef----------------------------------------------------------------------------------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef priority_queue<int> maxpq;\ntypedef priority_queue< int, vector<int>, greater<int> > minpq;\n//const------------------------------------------------------------------------------------------------------------------------\nstatic const double EPS = 1e-10;\nstatic const double PI = acos( -1.0 );\nstatic const int mod = 1000000007;\nstatic const int INF = 1 << 25;\nstatic const LL LL_INF = 1152921504606846976;\n//global-----------------------------------------------------------------------------------------------------------------------\nVS a;\nstring str;\nVS eb;\nint default_ans = 0;\nint diff_max = 0;\nint diff;\nchar b[1000];\nstring joi = \"JOI\";\nint n, m;\n//#define DEBUG\n//function-------------------------------------------------------------------------------------------------------------------\nint main() {\n\tscanf( \"%d %d\", &n, &m );\n\trep( i, m ) {\n\t\tstr += \"?\";\n\t}\n\ta.PB( str );\n\trep( i, n ) {\n\t\tscanf( \"%s\", b );\n\t\ta.PB( \"?\" + ( string ) b + \"?\" );\n\t}\n\ta.PB( str );\n\trep( i, 2 ) {\n\t\tscanf( \"%s\", b );\n\t\teb.PB( ( string ) b );\n\t}\n\tFOR( i,0, n  ) {\n\t\tFOR( j, 0, m - 1 ) {\n\t\t\tif ( a[ i + 1 ][ j + 1 ] == eb[ 0 ][ 0 ] && a[ i + 2 ][ j + 1 ] == eb[ 1 ][ 0 ] && a[ i + 1 ][ j + 2 ] == eb[ 0 ][ 1 ] && a[ i + 2 ][ j + 2 ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\tdefault_ans++;\n\t\t\t}\n\t\t}\n\t}\n\trep( i, 3 ) {\n\t\tFOR( j, 1, n + 1 ) {\n\t\t\tFOR( k, 1, m  ) {\n\t\t\t\tdiff = 0;\n\t\t\t\tif ( joi[ i ] == a[ j ][ k ] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j - 1 ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j + 1 ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j + 1][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k ] == eb[ 0 ][ 0 ] && a[ j ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j - 1 ][ k + 1 ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j + 1 ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j ][ k + 1 ] == eb[ 0 ][ 1 ] && a[ j + 1 ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdiff_max = max( diff, diff_max );\n\t\t\t}\n\t\t}\n\t}\n\tprintf( \"%d\\n\", default_ans + diff_max );\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nstring s[1001],t[3];\nint h,w,sum,ans=0;\nint dx[]={0,0,-1,-1};\nint dy[]={0,-1,0,-1};\nint gx[]={0,0,1,1};\nint gy[]={0,1,0,1};\nchar c[]={'J','O','I'};\nbool used[1001][1001];\nvoid get_sum(){\n  r(i,h-1)r(j,w-1){\n    if(s[i][j]==t[0][0]&&s[i+1][j]==t[1][0]&s[i][j+1]==t[0][1]&&s[i+1][j+1]==t[1][1]){\n      used[i][j]=1;\n      sum++;\n    }\n  }\n}\nint get_res(int y,int x){\n  int res=ans;\n  r(i,4){\n    int yy=y+dy[i];\n    int xx=x+dx[i];\n    if(yy<0||xx<0||yy>=h||xx>=w)continue;\n    if(used[yy][xx])ans--;\n  }\n  r(i,4){\n     int yy=y+dy[i];\n     int xx=x+dx[i];\n     if(yy<0||xx<0||yy>=h||xx>=w)continue;\n     r(k,4){\n       int sy=yy+gy[k];\n       int sx=xx+gx[k];\n       if(sy<0||sx<0||sy>=h||sx>=w)continue;\n       if(s[sy][sx]!=t[gy[k]][gx[k]])break;\n       if(k==3)res++;\n     }\n  }\n  return res;\n}\nint get_ans(int y,int x){\n  char tmp = s[y][x];\n  int res=0;\n  r(i,3){\n    if(s[y][x]!=c[i]){\n      s[y][x]=c[i];\n      res=max(res,get_res(y,x));\n      s[y][x]=tmp;\n    }\n  }\n  return res;\n}\nint main(){\n  cin>>h>>w;\n  r(i,h)cin>>s[i];\n  r(i,2)cin>>t[i];\n  get_sum();\n  ans=sum;\n  r(i,h)r(j,w){\n    ans=max(ans,get_ans(i,j));\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  int h,w;\n  char maps[1010][1010];\n  char kun[10];\n  int cnt;\n  int ans=0;\n  string str;\n  int best;\n  char joi[3];\n  //旗の入力\n  cin>>h>>w;\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      cin>>maps[i][j];\n    }\n  }\n  //勲章入力\n  cin>>str;\n  kun[0]=str[0];\n  kun[1]=str[1];\n  cin>>str;\n  kun[2]=str[0];\n  kun[3]=str[1];\n  cnt=0;\n  //昔の旗の勲章の数\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(kun[0]==maps[i][j] && kun[1]==maps[i][j+1] && kun[2]==maps[i+1][j] && kun[3]==maps[i+1][j+1])cnt++;\n    }\n  }\n  if(ans<cnt)ans=cnt;\n  best=cnt;\n  //白紙のパターン\n  joi[0]='J';\n  joi[1]='O';\n  joi[2]='I';\n  for(int s=0;s<h;s++){\n    for(int r=0;r<w;r++){\n      for(int m=0;m<3;m++){\n\tchar kari=maps[s][r];\n\tmaps[s][r]=joi[m];\n\tcnt=0;\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    if(kun[0]==maps[i][j]){\n\t      if(kun[1]==maps[i][j+1]){\n\t\tif(kun[2]==maps[i+1][j]){\n\t\t  if(kun[3]==maps[i+1][j+1])cnt++;\n\t\t}\n\t      }\n\t    }\n\t  }\n\t}\n\t//\tcout<<cnt<<\" \"<<s<<\",\"<<r<<\" \"<<joi[m]<<endl;\n\tif(ans<cnt)ans=cnt;\n\tmaps[s][r]=kari;\n      }\n    }\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 114514810\n#define ll long long\n#define ALL(a) (a).begin(),(a).end()\n#define SORT(v) sort(ALL(v))\n//#define scanf scanf_s\n\nint m, n;\nchar hata[1005][1005];\nchar emb[2][2];\nint is_emb[1005][1005];\n\nbool check(int i, int j)\n{\n\treturn (hata[i][j] == emb[0][0] && hata[i + 1][j] == emb[1][0] && hata[i][j + 1] == emb[0][1] && hata[i + 1][j + 1] == emb[1][1]);\n}\n\nint change(int i, int j, char c, int cnt)\n{\n\tif (c == hata[i][j]) return cnt;\n\telse\n\t{\n\t\thata[i][j] = c;\n\t\tif (i == 0 && j == 0)\n\t\t{\n\t\t\tcnt -= is_emb[i][j];\n\t\t\tif (check(i, j)) cnt++;\n\t\t}\n\t\telse if (i == 0 && j > 0 && j < n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i][j] + is_emb[i][j + 1]);\n\t\t\tif (check(i, j)) cnt++;\n\t\t\tif (check(i, j + 1)) cnt++;\n\t\t}\n\t\telse if (i == 0 && j == n - 1)\n\t\t{\n\t\t\tcnt -= is_emb[i][j - 1];\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t}\n\t\telse if (i > 0 && i < n - 1 && j == 0)\n\t\t{\n\t\t\tcnt -= (is_emb[i][j] + is_emb[i - 1][j]);\n\t\t\tif (check(i, j)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i == m - 1 && j == 0)\n\t\t{\n\t\t\tcnt -= is_emb[i - 1][j];\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i > 0 && i < n - 1 && j == n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i][j - 1]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t}\n\t\telse if (i == m - 1 && j>0 && j < n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i - 1][j]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i == m - 1 && j == n - 1)\n\t\t{\n\t\t\tcnt -= is_emb[i - 1][j - 1];\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i][j - 1] + is_emb[i - 1][j] + is_emb[i][j]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t\tif (check(i, j)) cnt++;\n\t\t}\n\t}\n\n\treturn cnt;\n}\n\nint main()\n{\n\tcin >> m >> n;\n\tmemset(is_emb, 0, sizeof(is_emb));\n\tREP(i, m)REP(j, n) cin >> hata[i][j];\n\tREP(i, 2)REP(j, 2) cin >> emb[i][j];\n\tint cnt = 0;\n\tREP(i, m - 1)REP(j, n - 1)\n\t{\n\t\tif (check(i, j))\n\t\t{\n\t\t\tis_emb[i][j] = 1;\n\t\t\tcnt++;\n\t\t}\n\t}\n\tint ans = 0;\n\tREP(i, m)REP(j, n)\n\t{\n\t\tint tmp = cnt;\n\t\tchar c = hata[i][j];\n\t\tans = max({ ans, change(i, j, 'J', tmp), change(i, j, 'O', tmp), change(i, j, 'I', tmp) });\n\t\thata[i][j] = c;\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\nchar field[1001][1001];\ntypedef pair<int, int> P;\n\nclass white\n{\npublic:\n\tint x;\n\tint y;\n\tchar c;\n};\n\nvoid solve()\n{\n\tint M, N;\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; ++i)\n\t{\n\t\tfor (int j = 0; j < N; ++j)\n\t\t{\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tchar flag[2][2];\n\tfor (int i = 0; i < 2; ++i)\n\t{\n\t\tfor (int j = 0; j < 2; ++j)\n\t\t{\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tint ans = 0;\n\tvector<white> threePointOK;\n\tfor (int i = 0; i < M - 1; ++i)\n\t{\n\t\tfor (int j = 0; j < N - 1; ++j)\n\t\t{\n\t\t\tif (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++ans;\n\t\t\t}\n\t\t\telse if (field[i][j] != flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j;\n\t\t\t\tw.y = i;\n\t\t\t\tw.c = flag[0][0];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] != flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j + 1;\n\t\t\t\tw.y = i;\n\t\t\t\tw.c = flag[0][1];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] != flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j;\n\t\t\t\tw.y = i + 1;\n\t\t\t\tw.c = flag[1][0];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] != flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j + 1;\n\t\t\t\tw.y = i + 1;\n\t\t\t\tw.c = flag[1][1];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t}\n\t}\n\tint additional = 0;\n\tfor (int i = 0; i < threePointOK.size(); ++i)\n\t{\n\t\tint plus = 0;\n\t\twhite w = threePointOK[i];\n\t\tchar c_back = field[w.y][w.x];\n\t\tfield[w.y][w.x] = w.c;\n\t\tif (w.x != 0 && w.y != 0)\n\t\t{\n\t\t\tif (field[w.y - 1][w.x - 1] == flag[0][0] && field[w.y - 1][w.x] == flag[0][1] && field[w.y][w.x - 1] == flag[1][0] && field[w.y][w.x] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != N - 1 && w.y != 0)\n\t\t{\n\t\t\tif (field[w.y - 1][w.x] == flag[0][0] && field[w.y - 1][w.x + 1] == flag[0][1] && field[w.y][w.x] == flag[1][0] && field[w.y][w.x + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != 0 && w.y != M - 1)\n\t\t{\n\t\t\tif (field[w.y][w.x - 1] == flag[0][0] && field[w.y][w.x] == flag[0][1] && field[w.y + 1][w.x - 1] == flag[1][0] && field[w.y + 1][w.x] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != N - 1 && w.y != M - 1)\n\t\t{\n\t\t\tif (field[w.y][w.x] == flag[0][0] && field[w.y][w.x + 1] == flag[0][1] && field[w.y + 1][w.x] == flag[1][0] && field[w.y + 1][w.x + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tfield[w.y][w.x] = c_back;\n\t\tadditional = max(additional, plus);\n\t}\n\tans += additional;\n\tcout << ans << endl;\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1010][1010],pat[5][5];\nint n,m;\nstring ch=\"JOI\";\n\nbool match(int x, int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>0 && ny>0 && match(nx,ny))res++;\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      if(match(j,i))res++;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<n;i++){    \n     for(int j=0;j<m;j++){\n       char tmp=g[i][j];\n\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> n >> m;\n  \n  fill(g[0],g[1010],NULL);\n  fill(pat[0],pat[5],NULL);\n\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin >> g[i][j];\n    }\n  }\n\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin >> pat[i][j];\n    }\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\n#include <map>\n#include <queue>\n#include <stack>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdlib>\n\nusing namespace std;\n\n#define ALL(c) c.begin(),c.end()\n#define RALL(c) c.rbegin(),c.rend()\n#define REP(type,i,n) for(type i=0;i<(n);++i)\n#define MP(a,b) make_pair((a),(b))\n#define F_ first\n#define S_ second\n\ntypedef long long int lli;\ntypedef pair<int,int> Pi;\n\nconst int INF=100000000;\nconst long long int INF_=1000000000000000000;\n\nint dy[4]={0,1,0,1},dx[4]={0,0,1,1};\nint dy_[9]={0,0,1,1,1,0,-1,-1,-1},dx_[9]={0,1,1,0,-1,-1,-1,0,1};\n\nbool IsSame(char c[][2],vector<vector<char> > &g,int y,int x){\n\tREP(int,i,4){\n\t\tint ny=y+dy[i],nx=x+dx[i];\n\t\tif(g[ny][nx]!=c[dy[i]][dx[i]]) return false;\n\t}\n\treturn true;\n}\n\nint main(){\n\tint M,N;\n\tcin >> M >> N;\n\tvector<vector<char> > g(M+2,vector<char>(N+2,'.'));\n\tREP(int,i,M){\n\t\tREP(int,j,N){\n\t\t\tcin >> g[i+1][j+1];\n\t\t}\n\t}\n\tchar c[2][2];\n\tREP(int,i,2) REP(int,j,2) cin >> c[i][j];\n\tint ans=0,sum=0;\n\tfor(int y=1; y<M; ++y){\n\t\tfor(int x=1; x<N; ++x){\n\t\t\tif(IsSame(c,g,y,x)) ++sum;\n\t\t}\n\t}\n\tans=sum;\n\tstring s=\"JOI\";\n\tfor(int y=1; y<=M; ++y){\n\t\tfor(int x=1; x<=N; ++x){\n\t\t\tREP(int,i,3){\n\t\t\t\tchar tmp=g[y][x];\n\t\t\t\tint c1=0,c2=0;\n\t\t\t\tREP(int,j,9){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c1;\n\t\t\t\t}\n\t\t\t\tg[y][x]=s[i];\n\t\t\t\tREP(int,j,9){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c1;\n\t\t\t\t}\n\t\t\t\tg[y][x]=tmp;\n\t\t\t\tans=max(ans,sum-c1-c2);\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nint main(){\n    int m, n; cin >> m >> n;\n\n    vector<vector<char> > a(m + 2, vector<char> (n + 2, 'd'));\n    for(int i = 1; i <= m; i++){\n        for(int j = 1; j <= n; j++){\n            cin >> a[i][j];\n        }\n    }\n\n    vector<char> b(4);\n    for(int i = 0; i < 4; i++) cin >> b[i];\n\n    int sum = 0;\n    for(int i = 1; i <= m; i++){\n        for(int j = 1; j <= n; j++){\n            if(a[i][j] == b[0] && a[i][j + 1] == b[1] && a[i + 1][j] == b[2] && a[i + 1][j + 1] == b[3]) sum++;\n        }\n    }\n\n    //cout << sum << endl;\n    int ans = sum;\n\n    for(int i = 1; i <= m; i++){\n        for(int j = 1; j <= n; j++){\n            int temp = sum;\n            char c = a[i][j];\n            temp -= (a[i - 1][j - 1] == b[0] && a[i - 1][j] == b[1] && a[i][j - 1] == b[2] && a[i][j] == b[3]);\n            //if(i == 2 && j == 2) cout << temp << endl;\n            temp -= (a[i - 1][j] == b[0] && a[i - 1][j + 1] == b[1] && a[i][j] == b[2] && a[i][j + 1] == b[3]);\n            //if(i == 2 && j == 2) cout << temp << endl;            \n            temp -= (a[i][j - 1] == b[0] && a[i][j] == b[1] && a[i + 1][j - 1] == b[2] && a[i + 1][j] == b[3]);\n            //if(i == 2 && j == 2) cout << temp << endl;            \n            temp -= (a[i][j] == b[0] && a[i][j + 1] == b[1] && a[i + 1][j] == b[2] && a[i + 1][j + 1] == b[3]);\n            //if(i == 2 && j == 2) cout << temp << endl;\n            \n            //if(i == 2 && j == 2) cout << i << \" \" << j << \" \" << temp << endl;\n            if(c != 'I'){\n                a[i][j] = 'I';\n                int tmp = temp;\n                tmp += (a[i - 1][j - 1] == b[0] && a[i - 1][j] == b[1] && a[i][j - 1] == b[2] && a[i][j] == b[3]);\n                tmp += (a[i - 1][j] == b[0] && a[i - 1][j + 1] == b[1] && a[i][j] == b[2] && a[i][j + 1] == b[3]);\n                tmp += (a[i][j - 1] == b[0] && a[i][j] == b[1] && a[i + 1][j - 1] == b[2] && a[i + 1][j] == b[3]);\n                tmp += (a[i][j] == b[0] && a[i][j + 1] == b[1] && a[i + 1][j] == b[2] && a[i + 1][j + 1] == b[3]);\n                ans = max(ans, tmp);\n            }\n\n            if(c != 'O'){\n                a[i][j] = 'O';\n                int tmp = temp;\n                tmp += (a[i - 1][j - 1] == b[0] && a[i - 1][j] == b[1] && a[i][j - 1] == b[2] && a[i][j] == b[3]);\n                tmp += (a[i - 1][j] == b[0] && a[i - 1][j + 1] == b[1] && a[i][j] == b[2] && a[i][j + 1] == b[3]);\n                tmp += (a[i][j - 1] == b[0] && a[i][j] == b[1] && a[i + 1][j - 1] == b[2] && a[i + 1][j] == b[3]);\n                tmp += (a[i][j] == b[0] && a[i][j + 1] == b[1] && a[i + 1][j] == b[2] && a[i + 1][j + 1] == b[3]);\n                ans = max(ans, tmp);                 \n            }\n\n            if(c != 'J'){\n                a[i][j] = 'J';\n                int tmp = temp;\n                tmp += (a[i - 1][j - 1] == b[0] && a[i - 1][j] == b[1] && a[i][j - 1] == b[2] && a[i][j] == b[3]);\n                tmp += (a[i - 1][j] == b[0] && a[i - 1][j + 1] == b[1] && a[i][j] == b[2] && a[i][j + 1] == b[3]);\n                tmp += (a[i][j - 1] == b[0] && a[i][j] == b[1] && a[i + 1][j - 1] == b[2] && a[i + 1][j] == b[3]);\n                tmp += (a[i][j] == b[0] && a[i][j + 1] == b[1] && a[i + 1][j] == b[2] && a[i + 1][j + 1] == b[3]);\n                ans = max(ans, tmp);                 \n            }\n\n            a[i][j] = c;\n        }\n    }\n\n    cout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    //init\n    if(match(1,1)){\n      dp[1][1] = 1;\n    }\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y; dy++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx = x - 2,dy = y - 2; dx <= x; dx++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n        }\n        else{\n          dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n          dp[y][x] = max(dp[y][x],dp[y-1][x-1]);\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint m, n;\nvector<string> v;\nvector<string> w;\nint c;\nchar x[4] = \"JOI\";\nint ans;\n\nint count(int p, int q){\n\tint z = 0;\n\tfor(int i=0; i<2; i++){\n\t\tfor(int j=0; j<2; j++){\n\t\t\tif(0 <= p+i && p+i+1 <= m-1 && 0 <= q+j && q+j+1 <= n-1){\n\t\t\t\tbool b = true;\n\t\t\t\tfor(int k=0; k<2; k++)\n\t\t\t\t\tfor(int l=0; l<2; l++)\n\t\t\t\t\t\tif(v[p+i+k][q+j+l] != w[k][l]) b = false;\n\t\t\t\tif(b) z++;\n\t\t\t}\n\t\t}\n\t}\n\treturn z;\n}\n\nint main(){\n\tscanf(\"%d %d\", &m, &n);\n\tfor(int i=0; i<m; i++){\n\t\tchar t[n+1];\n\t\tscanf(\"%s\", t);\n\t\tv.push_back(t);\n\t}\n\tfor(int i=0; i<2; i++){\n\t\tchar t[3];\n\t\tscanf(\"%s\", t);\n\t\tw.push_back(t);\n\t}\n\n\tfor(int i=0; i<m-1; i++){\n\t\tfor(int j=0; j<n-1; j++){\n\t\t\tbool b = true;\n\t\t\tfor(int k=0; k<2; k++)\n\t\t\t\tfor(int l=0; l<2; l++)\n\t\t\t\t\tif(v[i+k][j+l] != w[k][l]) b = false;\n\t\t\tif(b) c++;\n\t\t}\n\t}\n\n//\tprintf(\"%d\\n\", ans);\n\n\tfor(int i=0; i<m; i++){\n\t\tfor(int j=0; j<n; j++){\n\t\t\tint a = count(i-1, j-1);\n\t\t\tfor(int k=0; k<3; k++){\n\t\t\t\tchar y[2];\n\t\t\t\ty[0] = v[i][j];\n\t\t\t\tv[i][j] = x[k];\n\t\t\t\tint b = count(i-1, j-1);\n\t\t\t\tans = max(ans, c + b - a);\n\t\t\t\tv[i][j] = y[0];\n\t\t\t}\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar field[1010][1010];\nint score[1010][1010] = {0};\nint main()\n{\n    char E[2][2];\n    int x,y,cou = 0,ans = 0,mx,my;\n    int dx[] = {0,1,0,1},dy[] = {0,0,1,1};\n    scanf(\"%d%d\",&y,&x);\n    for(int i = 0; i < y; i++)\n    {\n        scanf(\" %c\",&field[0][i]);\n        for(int j = 1; j < x; j++)\n            scanf(\"%c\",&field[j][i]);\n    }\n    for(int i = 0; i < 2; i++)\n    {\n        scanf(\" %c\",&E[0][i]);\n        for(int j = 1; j < 2; j++)\n            scanf(\"%c\",&E[j][i]);\n    }\n    for(int i = 0; i < y - 1; i++)\n        for(int j = 0; j < x - 1; j++)\n        {\n            for(int k = 0; k < 4; k++)\n                if(field[j + dx[k]][i + dy[k]] == E[dx[k]][dy[k]])\n                {\n                    cou++;\n                    mx = j + dx[k];my = i + dy[k];\n                }\n            if(cou == 3)score[mx][my]++;\n            else if(cou == 4)\n            {\n                ans++;\n                for(int k = 0; k < 4; k++)\n                    score[j + dx[k]][i + dy[k]]--;\n            }\n            cou = 0;\n        }\n    for(int i = 0; i < y; i++)\n        for(int j = 0; j < x; j++)\n            cou = max(cou,score[j][i]);\n    printf(\"%d\\n\",ans + cou);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint m, n;\nchar flag[1100][1010];\nchar emblem[3][3];\nint f() {\n\tint sum = 0;\n\tfor (int i = 1; i < m; i++) {\n\t\tfor (int j = 1; j < n; j++) {\n\t\t\tif (flag[i][j] == emblem[0][0]) {\n\t\t\t\tif (flag[i + 1][j] == emblem[1][0] && flag[i][j + 1] == emblem[0][1]) {\n\t\t\t\t\tif (flag[i + 1][j + 1] == emblem[1][1]) {\n\t\t\t\t\t\tsum++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn sum;\n}\nint main() {\n\tcin >> m >> n;\n\tint ans = 0;\n\tfor (int i = 1; i <= m; i++)for (int j = 1; j <= n; j++)cin >> flag[i][j];\n\tfor (int i = 0; i < 2; i++)for (int j = 0; j < 2; j++)cin >> emblem[i][j];\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tchar ch = flag[i][j];\n\t\t\tflag[i][j] = 'J';\n\t\t\tans = max(ans, f());\n\t\t\tflag[i][j] = 'O';\n\t\t\tans = max(ans, f());\n\t\t\tflag[i][j] = 'I';\n\t\t\tans = max(ans, f());\n\t\t\tflag[i][j] = ch;\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint search2(int x, int y){\n\tbool flag = true;\n\tif(check[y][x])\n\t\tflag = false;\n\tint c = search(x, y);\n\tif(flag)\n\t\tcheck[y][x] = false;\n\tif(c == 4)\n\t\tres--;\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0 || ny == H - 1){\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse if(nx == 0){\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse if(nx == W - 1){\n\t\t\t\t\tint t = (search2(nx - 1, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\ts[ny][nx] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n\nstatic const int MOD = 1000000007;\nusing ll = int64_t;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\ntemplate <class T, class U>\nvector<T> make_v(U size, const T& init){ return vector<T>(static_cast<size_t>(size), init); }\n\ntemplate<class... Ts, class U>\nauto make_v(U size, Ts... rest) { return vector<decltype(make_v(rest...))>(static_cast<size_t>(size), make_v(rest...)); }\n\ntemplate<class T> void chmin(T &a, const T &b){ a = (a < b ? a : b); }\ntemplate<class T> void chmax(T &a, const T &b){ a = (a > b ? a : b); }\n\nint main() {\n    int h, w;\n    cin >> h >> w;\n    auto v = make_v(h+2, w+2, 'X');\n    for (int i = 0; i < h; ++i) {\n        string s;\n        cin >> s;\n        for (int j = 0; j < w; ++j) {\n            v[i+1][j+1] = s[j];\n        }\n    }\n    string s[2];\n    cin >> s[0] >> s[1];\n    int ans = 0;\n    for (int i = 1; i < h; ++i) {\n        for (int j = 1; j < w; ++j) {\n            int x = 0;\n            if(v[i][j] == s[0][0] && v[i][j+1] == s[0][1] && v[i+1][j] == s[1][0] && v[i+1][j+1] == s[1][1]) ans++;\n        }\n    }\n    int ans2 = 0;\n    string t = \"JOI\";\n    for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n            char tmp = v[i+1][j+1];\n            int p = 0;\n            for (int k = 0; k < 2; ++k) {\n                for (int l = 0; l < 2; ++l) {\n                    if(v[i+k][j+l] == s[0][0] && v[i+k][j+1+l] == s[0][1] &&\n                    v[i+1+k][j+l] == s[1][0] && v[i+1+k][j+1+l] == s[1][1]) p--;\n                }\n            }\n            for (auto &&q : t) {\n                v[i+1][j+1] = q;\n                int pp = p;\n                for (int k = 0; k < 2; ++k) {\n                    for (int l = 0; l < 2; ++l) {\n                        if(v[i+k][j+l] == s[0][0] && v[i+k][j+1+l] == s[0][1] &&\n                           v[i+1+k][j+l] == s[1][0] && v[i+1+k][j+1+l] == s[1][1]) pp++;\n                    }\n                }\n                ans2 = max(ans2, pp);\n            }\n            v[i+1][j+1] = tmp;\n        }\n    }\n    cout << ans + ans2 << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <set>\n#include <string>\n#include <stack>\n#include <cmath>\n#define ll long long\n#define FOR(i,a,b) for(int i=a;i<b;i++)\n#define ROF(i,a,b) for(int i=b-1;i>=a;i--)\nusing namespace std;\n//\nconst int inf=1e9+7;\nconst int mod=1e9+7;\n//\nstruct poi{\n\tint X;int Y;int Z;\n\tbool operator<(const poi&R)const{\n\t\treturn X==R.X ? Y==R.Y ? Z<R.Z : Y<R.Y : X<R.X;\n\t}\n};\n//\nll GCD(ll a,ll b){\n\treturn (b==0)?(a):(GCD(b,a%b));\n}\nll LCM(ll a,ll b){\n\treturn a/GCD(a,b)*b;\n}\n//\nint M,N;\nchar F[1000][1000],f[2][2];\nbool u[1000][1000];\nint main(){\n\tcin>>M>>N;\n\tFOR(i,0,M){\n\t\tFOR(j,0,N){\n\t\t\tcin>>F[i][j];\n\t\t}\n\t}\n\tFOR(i,0,2){\n\t\tFOR(j,0,2){\n\t\t\tcin>>f[i][j];\n\t\t}\n\t}\n\tint cnt=0;\n\tFOR(i,0,M-1){\n\t\tFOR(j,0,N-1){\n\t\t\tif(F[i][j]==f[0][0]&&F[i][j+1]==f[0][1]&&F[i+1][j]==f[1][0]&&F[i+1][j+1]==f[1][1]){\n\t\t\t\tu[i][j]=true;u[i][j+1]=true;\n\t\t\t\tu[i+1][j]=true;u[i+1][j+1]=true;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t}\n\tint ma=cnt;\n\tFOR(i,0,M-1){\n\t\tFOR(j,0,N-1){\n\t\t\tint x,y;\n\t\t\tint c=0;\n\t\t\tchar cc;\n\t\t\tFOR(k,0,2){\n\t\t\t\tFOR(l,0,2){\n\t\t\t\t\tif(F[i+k][j+l]!=f[k][l]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t\tx=i+k;\n\t\t\t\t\t\ty=j+l;\n\t\t\t\t\t\tcc=f[k][l];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(c==1){\n\t\t\t\tif(u[x][y]==false){\n\t\t\t\t\tc=0;\n\t\t\t\t\tchar mem=F[x][y];\n\t\t\t\t\tF[x][y]=cc;\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]&&F[x][y]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y]==f[1][0]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x][y]==f[0][1]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y]==f[0][0]&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tF[x][y]=mem;\n\t\t\t\t\tma=max(ma,c+cnt);\n\t\t\t\t}else{\n\t\t\t\t\tc=0;\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]&&F[x][y]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y]==f[1][0]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x][y]==f[0][1]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y]==f[0][0]&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tchar mem=F[x][y];\n\t\t\t\t\tF[x][y]=cc;\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]&&F[x][y]!=f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y]!=f[1][0]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x][y]!=f[0][1]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y]!=f[0][0]&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tma=max(ma,c+cnt);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ma<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<math.h>\n#include <cstdlib>\n#include<algorithm>\n#include <utility>\n\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int INF = 1001001001;\nint M,N;\nint map[1002][1002];\nint flag[5][5];\nFILE *file;\n\nint char_to_id(){\n\tchar a;\n\tdo{\n\t\tscanf(\"%c\",&a);\n\t\tif(a=='J')return 0;\n\t\tif(a=='O')return 1;\n\t\tif(a=='I')return 2;\n\t}while(a!='J'&&a!='O'&&a!='I');\n\treturn -1;\n}\n\nint main(){\n\t//file=fopen(\"G:\\\\1JOI本選\\\\2014\\\\joi2014-ho-data\\\\joi2014-ho-data\\\\2014-ho-t1\\\\in\\\\02-28.txt\",\"r\");\n\tscanf(\"%d %d\",&M,&N);\n\trep(i,M)rep(k,N)map[i][k]=char_to_id();\n\trep(i,2)rep(k,2)flag[i][k]=char_to_id();\n\tint ans=0;\n\trep(i,M-1)rep(k,N-1){\n\t\tif(map[i][k]!=flag[0][0])continue;\n\t\tif(map[i+1][k]!=flag[1][0])continue;\n\t\tif(map[i+1][k+1]!=flag[1][1])continue;\n\t\tif(map[i][k+1]!=flag[0][1])continue;\n\t\tans++;\n\t}\n\tint sa=0;\n\trep(i,M)rep(k,N){\n\t\tint ba=0;\n\t\tfor(int m=-1;m<1;m++)for(int n=-1;n<1;n++){\n\t\tif(i+m>-1&&i+m<M-1&&i+n>-1&&i+n<N-1){\n\t\t\tif(map[i][k]!=flag[0][0])continue;\n\t\t\tif(map[i+1][k]!=flag[1][0])continue;\n\t\t\tif(map[i+1][k+1]!=flag[1][1])continue;\n\t\t\tif(map[i][k+1]!=flag[0][1])continue;\n\t\t\tba++;\n\t\t}\n\t\t}\n\t\trep(j,3){\n\t\t\tint aa=0;\n\t\tif(j==map[i][k])continue;\n\t\tint stack=map[i][k];\n\t\tmap[i][k]=j;\n\t\t\tfor(int m=-1;m<1;m++)for(int n=-1;n<1;n++){\n\t\t\t\tif(i+m>-1&&i+m<M-1&&i+n>-1&&i+n<N-1){\n\t\t\t\t\tif(map[i+m][k+n]!=flag[0][0])continue;\n\t\t\t\t\tif(map[i+m+1][k+n]!=flag[1][0])continue;\n\t\t\t\t\tif(map[i+m+1][k+1+n]!=flag[1][1])continue;\n\t\t\t\t\tif(map[i+m][k+1+n]!=flag[0][1])continue;\n\t\t\t\t\taa++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(aa>ba)sa=max(sa,aa-ba);\n\t\t\tmap[i][k]=stack;\n\t\t}\t\n\t}\n\tprintf(\"%d\\n\",ans+sa);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint h,w;\nstring s[1010],joi[2];\nbool ok[1010][1010];\nconst char change[] = {'J', 'O', 'I'};\n\ninline bool check(int y, int x){\n  if(y<0 || x<0 || y>=h || x>=w)return 0;\n  return s[y][x] == joi[0][0] && s[y+1][x] == joi[1][0] &&\n\t  s[y][x+1] == joi[0][1] && s[y+1][x+1] == joi[1][1];\n}\n\nint main(){\n  cin.tie(0); ios::sync_with_stdio(0);\n\n  cin >> h >> w;\n  for(int i=0;i<h;i++)cin >> s[i];\n  cin >> joi[0] >> joi[1];\n\n  int sum = 0;\n  for(int i=0;i<h-1;i++){\n    for(int j=0;j<w-1;j++){\n      ok[i][j] = check(i,j);\n      if(ok[i][j])sum++;\n    }\n  }\n\n  int ans = sum;\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      char mem = s[i][j];\n      for(int c=0;c<3;c++){\n\tint tmp = sum;\n\tfor(int dy=-1;dy<=0;dy++){\n\t  for(int dx=-1;dx<=0;dx++){\n\t    tmp -= ok[i+dy][j+dx];\n\t  }\n\t}\n      \n\ts[i][j] = change[c];\n\tfor(int dy=-1;dy<=0;dy++){\n\t  for(int dx=-1;dx<=0;dx++){\n\t    tmp += check(i+dy,j+dx);\n\t  }\n\t}\n\tans = max(ans, tmp);\n      }\n      s[i][j] = mem;\n    }\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define st first\n#define nd second\n#define mp make_pair\n#define space << \" \" <<\n#define END << endl\n#define pb push_back\n#define fo(i,n) for(int i = 0; i<n; ++i)\n#define ff(i,n) for(int i = 1; i<n; ++i)\n\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\ntypedef pair<int,pii> pi;\ntypedef long long ll;\ntypedef pair<int,ll> pil;\ntypedef pair<ll,int> pli;\ntypedef pair<ll,ll> pll;\ntypedef pair<ll,pll> pl;\ntypedef vector<pil>vil;\n\nconst int N = 1050;\nstring s[N];\nstring a[3];\nstring b[3];\nint n,m;\n\nbool check(int i,int j)\n{\n    if(i + 1 >= n || j + 1 >= m ) return 0;\n    for(int x=0; x<2; ++x) for(int y=0; y<2; ++y) if(a[x][y] != s[i+x][j+y]) return false;\n    return true;\n}\n\nint work(int x,int y,int su , char k)\n{\n    char h = s[x][y];\n    int u = 0;\n    for(int i=max(0,x-1);i<=min(n-1,x); ++i)\n    for(int j=max(0,y-1);j<=min(m-1,y); ++j)\n    {\n        if(check(i,j)) u--;\n    }\n    s[x][y] = k;\n    for(int i=max(0,x-1);i<=min(n-1,x); ++i)\n    for(int j=max(0,y-1);j<=min(m-1,y); ++j)\n    {\n        if(check(i,j)) u++;\n    }\n    s[x][y] = h;\n    return su + u;\n}\n\nint main()\n{\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int ans = 0; cin >> n >> m;\n    for(int x=0; x<n; ++x) cin >> s[x];\n    for(int x=0; x<2; ++x) cin >> a[x];\n    for(int x=0; x<n; ++x) for(int y=0; y<m; ++y)\n    {\n        if(x + 1 >= n || y + 1 >= m) continue;\n        if(check(x,y)) { ans++; }\n    }\n    int res = ans;\n    for(int x=0; x<n; ++x) for(int y=0; y<m; ++y)\n    {\n        if(s[x][y] != 'O') res = max( res , work(x,y,ans,'O'));\n        if(s[x][y] != 'I') res = max( res , work(x,y,ans,'I'));\n        if(s[x][y] != 'J') res = max( res , work(x,y,ans,'J'));\n    }\n    cout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "// 2014/10/23 Tazoe\n\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nbool equalA(char F[1002][1002], char A[2][2], int y, int x)\n{\n\tif(F[y][x]==A[0][0] && F[y][x+1]==A[0][1] && F[y+1][x]==A[1][0] && F[y+1][x+1]==A[1][1])\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n\nint countA(char F[1002][1002], char A[2][2], int y, int x)\n{\n\tint cnt = 0;\n\n\tfor(int i=0; i<2; i++){\n\t\tfor(int j=0; j<2; j++){\n\t\t\tif(equalA(F, A, y-1+i, x-1+j)){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn cnt;\n}\n\nint main()\n{\n\tint M, N;\n\tcin >> M >> N;\n\n\tchar F[1002][1002];\n\tfor(int i=0; i<=M+1; i++){\n\t\tfor(int j=0; j<=N+1; j++){\n\t\t\tF[i][j] = 'Z';\n\t\t}\n\t}\n\n\tfor(int i=1; i<=M; i++){\n\t\tfor(int j=1; j<=N; j++){\n\t\t\tcin >> F[i][j];\n\t\t}\n\t}\n\n\tchar A[2][2];\n\tfor(int i=0; i<2; i++){\n\t\tfor(int j=0; j<2; j++){\n\t\t\tcin >> A[i][j];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\n\tfor(int i=1; i<=M-1; i++){\n\t\tfor(int j=1; j<=N-1; j++){\n\t\t\tif(equalA(F, A, i, j)){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint n_max = 0;\n\n\tfor(int i=1; i<=M; i++){\n\t\tfor(int j=1; j<=N; j++){\n\t\t\tint n_old = countA(F, A, i, j);\n//\t\t\tcout << n_old << endl;\n\n\t\t\tchar tmp = F[i][j];\n\n\t\t\tF[i][j] = 'J';\n\t\t\tint n_new = countA(F, A, i, j);\n\n\t\t\tF[i][j] = 'O';\n\t\t\tn_new = max(n_new, countA(F, A, i, j));\n\n\t\t\tF[i][j] = 'I';\n\t\t\tn_new = max(n_new, countA(F, A, i, j));\n\n\t\t\tF[i][j] = tmp;\n\n\t\t\tn_max = max(n_max, n_new-n_old);\n\t\t}\n\t}\n\n\tcout << cnt+n_max << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1010][1010];\nchar crest[8][8];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1010];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[4];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nchar map[1000 * 1000];\nchar emb[4];\n\nint plus_map_j[1000 * 1000] = {};\nint plus_map_o[1000 * 1000] = {};\nint plus_map_i[1000 * 1000] = {};\n\nint w;\nint h;\n\nint index_map_xy(int x, int y) {\n    return y * w + x;\n}\n\nint index_emb_xy(int x, int y) {\n    return y * 2 + x;\n}\n\nchar map_xy(int x, int y) {\n    return map[index_map_xy(x, y)];\n}\n\nchar emb_xy(int x, int y) {\n    return emb[index_emb_xy(x, y)];\n}\n\nint process_area(int x, int y) {\n    int miss_count = 0;\n    int miss_plus_i;\n    char miss_plus_char;\n    for (int iy=0; iy<2; iy++) {\n        for (int ix=0; ix<2; ix++) {\n            int mi = index_map_xy(x+ix, y+iy);\n            char emb = emb_xy(ix,iy);\n            if (map[mi] != emb) {\n                miss_count++;\n                if (miss_count == 1) {\n                    miss_plus_i = mi;\n                    miss_plus_char = emb;\n                }\n            }\n        }\n    }\n    if (miss_count == 0) {\n        for (int iy=0; iy<2; iy++) {\n            for (int ix=0; ix<2; ix++) {\n                int i = index_map_xy(x+ix, y+iy);\n                plus_map_j[i] -= 1;\n                plus_map_o[i] -= 1;\n                plus_map_i[i] -= 1;\n            }\n        }\n    }\n    if (miss_count == 1) {\n        if (miss_plus_char == 'J') { plus_map_j[miss_plus_i] += 1; }\n        if (miss_plus_char == 'O') { plus_map_o[miss_plus_i] += 1; }\n        if (miss_plus_char == 'I') { plus_map_i[miss_plus_i] += 1; }\n    }\n    return !miss_count;\n}\n\nint main(void){\n    cin >> h >> w;\n    for (int i=0; i<w*h; i++) {\n        cin >> map[i];\n    }\n    for (int i=0; i<4; i++) {\n        cin >> emb[i];\n    }\n    \n    int count = 0;\n    for (int y=0; y<h-1; y++) {\n        for (int x=0; x<w-1; x++) {\n            count += process_area(x, y);\n        }\n    }\n    \n    int max_plus = 0;\n    for (int y=0; y<h; y++) {\n        for (int x=0; x<w; x++) {\n            int mi = index_map_xy(x, y);\n            if (plus_map_j[mi] > max_plus) { max_plus = plus_map_j[mi]; }\n            if (plus_map_o[mi] > max_plus) { max_plus = plus_map_o[mi]; }\n            if (plus_map_i[mi] > max_plus) { max_plus = plus_map_i[mi]; }\n        }\n    }\n    \n    cout << count + max_plus << endl;\n    /*\n    for (int y=0; y<h; y++) {\n        for (int x=0; x<w; x++) {\n            cout << map_xy(x,y);\n        }\n        cout << endl;\n    }\n        cout << endl;\n    for (int y=0; y<h; y++) {\n        for (int x=0; x<w; x++) {\n            int n = plus_map_j[index_map_xy(x, y)];\n            cout << n << \" \";\n        }\n        cout << endl;\n    }\n        cout << endl;\n    for (int y=0; y<h; y++) {\n        for (int x=0; x<w; x++) {\n            int n = plus_map_o[index_map_xy(x, y)];\n            cout << n << \" \";\n        }\n        cout << endl;\n    }\n        cout << endl;\n    for (int y=0; y<h; y++) {\n        for (int x=0; x<w; x++) {\n            int n = plus_map_i[index_map_xy(x, y)];\n            cout << n << \" \";\n        }\n        cout << endl;\n    }\n    /*\n    for (int y=0; y<h; iy++) {\n        for (int x=0; x<w; ix++) {\n            cout << map_xy(x,y);\n        }\n        cout << endl;\n    }\n    for (int iy=0; iy<2; iy++) {\n        for (int ix=0; ix<2; ix++) {\n            cout << emb_xy(ix,iy);\n        }\n        cout << endl;\n    }\n    */\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint mm[1001][1001][3];\nint main(){\n    int m,n;\n    string flag[1000],emb[2];\n    cin>>m>>n;\n    int ans=0;\n    for(int i=0;i<m;++i) cin>>flag[i];\n    for(int i=0;i<2;++i) cin>>emb[i];\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            int cnt=0,mx,my;\n            for(int k=0;k<2;++k){\n                for(int l=0;l<2;++l){\n                    if(flag[i+k][j+l]==emb[k][l]) ++cnt;\n                    else{mx=l;my=k;}\n                }\n            }\n            if(cnt==4) ++ans;\n            else if(cnt==3){\n                if(emb[my][mx]=='J') ++mm[i+my][j+mx][0];\n                else if(emb[my][mx]=='O') ++mm[i+my][j+mx][1];\n                else ++mm[i+my][j+mx][3];\n            }\n        }\n    }\n    int w=0;\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            for(int k=0;k<3;++k) w=max(w,mm[i][j][k]);\n        }\n    }\n    cout<<ans+w<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nchar new[1001][1001];\nint i,j,k;\nint main(void)\n{\n\tchar old[5];\n\tchar joi[3]={'J','O','I'};\n\tint m,n;\n\tlong long int cnt,c,max;\n\tc=0;\n\tcnt=0;\n\tmax=0;\n\t\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tscanf(\" %c\",&new[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<4;i++){\n\t\tscanf(\" %c\",&old[i]);\n\t}\n\tfor(i=0;i<m-1;i++){\n\t\tfor(j=0;j<n-1;j++){\n\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse if(new[i][j]=='J'){\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='O'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='I'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",cnt+max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#include <vector>\n\n#define INF (1 << 28)\n\nusing namespace std;\n\nstring str[2000];\n\nstring crest[2];\n\nint map[1001][1001][3];\n\nint main(){\n\t\n\tchar JOI[3] = {'J', 'O', 'I'};\n\t\n\tint M, N;\n\t\n\tcin >> M >> N;\n\t\n\tfor(int i = 0; i < M; i++){\n\t\tcin >> str[i];\n\t}\n\t\n\tcin >> crest[0];\n\tcin >> crest[1];\n\t\n\tint ans = 0;\n\t\n\tfor(int i = 0; i < M; i++){\n\t\tfor(int j = 0; j < N; j++){\n\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\tmap[i][j][k] = 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\t\n\t\t\tint count = 0;\n\t\t\t\n\t\t\tint x_not, y_not, x_crest, y_crest;\n\t\t\t\n\t\t\tfor(int x = 0; x < 2; x++){\n\t\t\t\tfor(int y = 0; y < 2; y++){\n\t\t\t\t\tif(crest[y][x] == str[i + y][j + x]){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tx_not = j + x;\n\t\t\t\t\t\ty_not = i + y;\n\t\t\t\t\t\tx_crest = x;\n\t\t\t\t\t\ty_crest = y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(count == 4){\n\t\t\t\tans++;\n\t\t\t\t\n\t\t\t\tfor(int x = 0; x < 2; x++){\n\t\t\t\t\tfor(int y = 0; y < 2; y++){\n\t\t\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\t\t\tmap[i + y][j + x][k]--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(count == 3){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(JOI[k] == crest[y_crest][x_crest])\n\t\t\t\t\tmap[y_not][x_not][k]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint fix_max = 0;\n\t\n\tfor(int k = 0; k < 3; k++){\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tfor(int j = 0; j < N; j++){\n\t\t\t\t//cout << map[i][j][k] << \" \";\n\t\t\t\tif(map[i][j][k] > fix_max){\n\t\t\t\t\tfix_max = map[i][j][k];\n\t\t\t\t}\n\t\t\t}\n\t\t\t//cout << endl;\n\t\t}\n\t\t//cout << endl;\n\t}\n\t\n\tcout << ans + fix_max << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nstring s[1001],t[3];\nint h,w,sum,ans=0;\nint dx[]={0,0,-1,-1};\nint dy[]={0,-1,0,-1};\nint gx[]={0,0,1,1};\nint gy[]={0,1,0,1};\nchar c[]={'J','O','I'};\nbool used[1001][1001];\nvoid get_sum(){\n  r(i,h-1)r(j,w-1){\n    if(s[i][j]==t[0][0]&&s[i+1][j]==t[1][0]&s[i][j+1]==t[0][1]&&s[i+1][j+1]==t[1][1]){\n      used[i][j]=1;\n      sum++;\n    }\n  }\n}\nint get_res(int y,int x){\n  int res=sum;\n  r(i,4){\n    int yy=y+dy[i];\n    int xx=x+dx[i];\n    if(yy<0||xx<0||yy>=h||xx>=w)continue;\n    if(used[yy][xx])res--;\n  }\n  r(i,4){\n     int yy=y+dy[i];\n     int xx=x+dx[i];\n     if(yy<0||xx<0||yy>=h||xx>=w)continue;\n     r(k,4){\n       int sy=yy+gy[k];\n       int sx=xx+gx[k];\n       if(sy<0||sx<0||sy>=h||sx>=w)continue;\n       if(s[sy][sx]!=t[gy[k]][gx[k]])break;\n       if(k==3)res++;\n     }\n  }\n  return res;\n}\nint get_ans(int y,int x){\n  char tmp = s[y][x];\n  int res=0;\n  r(i,3){\n    if(s[y][x]!=c[i]){\n      s[y][x]=c[i];\n      res=max(res,get_res(y,x));\n      s[y][x]=tmp;\n    }\n  }\n  return res;\n}\nint main(){\n  cin>>h>>w;\n  r(i,h)cin>>s[i];\n  r(i,2)cin>>t[i];\n  get_sum();\n  ans=sum;\n  r(i,h)r(j,w){\n    ans=max(ans,get_ans(i,j));\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\n\nint H, W;\nchar board[1010][1010], pat[2][2];\n\nint matching(int x, int y) {\n  for(int dx=0; dx<2; dx++) {\n    for(int dy=0; dy<2; dy++) {\n      int nx = x + dx, ny = y + dy;\n      if(pat[dx][dy] != board[nx][ny]) return 0;\n    }\n  }\n  return 1;\n}\n\nint solve(int x, int y) {\n  int sum = 0;\n  for(int p=x-1; p<=x; p++) {\n    for(int q=y-1; q<=y; q++) {\n      if(p < 0 || p >= H || q < 0 || q >= W) continue;\n      sum += matching(p, q);\n    }\n  }\n  return sum;\n}\n\nint main() {\n  cin >> H >> W;\n  for(int i=0; i<H; i++) {\n    for(int j=0; j<W; j++) {\n      cin >> board[i][j];\n    }\n  }\n\n  for(int i=0; i<2; i++) {\n    for(int j=0; j<2; j++) {\n      cin >> pat[i][j];\n    }\n  }\n\n  int ans = 0;\n  for(int i=0; i<H-1; i++) {\n    for(int j=0; j<W-1; j++) {\n      ans += matching(i, j);\n    }\n  }\n\n  int max_diff = 0;\n  string joi = \"JOI\";\n  for(int i=0; i<H; i++) {\n    for(int j=0; j<W; j++) {\n      int prev = solve(i, j);\n      char c = board[i][j];\n      for(int k=0; k<3; k++) {\n        board[i][j] = joi[k];\n        int changed = solve(i, j);\n        max_diff = max(max_diff, changed - prev);\n        board[i][j] = c;\n      }\n    }\n  }\n\n  cout << ans + max_diff << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint mm[1001][1001][3];\nstring flag[1000],emb[2];\nint main(){\n    int m,n;\n    cin>>m>>n;\n    int ans=0;\n    for(int i=0;i<m;++i) cin>>flag[i];\n    for(int i=0;i<2;++i) cin>>emb[i];\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            int cnt=0,mx,my;\n            for(int k=0;k<2;++k){\n                for(int l=0;l<2;++l){\n                    if(flag[i+k][j+l]==emb[k][l]) ++cnt;\n                    else{mx=l;my=k;}\n                }\n            }\n            if(cnt==4) ++ans;\n            else if(cnt==3){\n                if(emb[my][mx]=='J') ++mm[i+my][j+mx][0];\n                else if(emb[my][mx]=='O') ++mm[i+my][j+mx][1];\n                else ++mm[i+my][j+mx][2];\n            }\n        }\n    }\n    int w=0;\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            for(int k=0;k<3;++k) w=max(w,mm[i][j][k]);\n        }\n    }\n    cout<<ans+w<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define IN(a, b, x) (a<=x&&x<b)\n#define MP make_pair\n#define PB push_back\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\nstring s[1010], t[2];\nint dp[1010][1010];\nsigned main(void)\n{\n  int h, w;\n  cin >> h >> w;\n  REP(i, h) cin >> s[i];\n  REP(i, 2) cin >> t[i];\n\n  int sum = 0;\n  FOR(i, 1, h) FOR(j, 1, w) {\n    if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n      dp[i][j] = 1;\n      sum++;\n    }\n  }\n\n  char c[3] = {'J', 'O', 'I'};\n  int ans = 0;\n  REP(i, h) REP(j, w) REP(k, 3) {\n    int ret = sum;\n    // ??????\n    if(i != 0 && j != 0) {\n      if(dp[i][j]) ret--;\n      if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && c[k] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != 0 && j != w-1) {\n      if(dp[i][j+1]) ret--;\n      if(s[i-1][j] == t[0][0] && s[i-1][j+1] == t[0][1] && c[k] == t[1][0] && s[i][j+1] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != h-1 && j != 0) {\n      if(dp[i+1][j]) ret--;\n      if(s[i][j-1] == t[0][0] && c[k] == t[0][1] && s[i+1][j-1] == t[1][0] && s[i+1][j] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != 0 && j != w-1) {\n      if(dp[i+1][j+1]) ret--;\n      if(c[k] == t[0][0] && s[i][j+1] == t[0][1] && s[i+1][j] == t[1][0] && s[i+1][j+1] == t[1][1]) {\n        ret++;\n      }\n    }\n    ans = max(ans, ret);\n  }\n  cout << ans << endl;\n  //\n  // FOR(i, 1, h) FOR(j, 1, w) {\n  //   dp[i][j][0] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0];\n  //   if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n  //     dp[i][j][0]++;\n  //   }\n  //   dp[i][j][1] = dp[i][j][0];\n  //   /*if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n  //     dp[i][j][1]++;\n  //   }*/\n  //   if((s[i-1][j-1] != t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] != t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] != t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] != t[1][1])) {\n  //     dp[i][j][1] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0] + 1;\n  //   }\n  //   int tmp = dp[i-1][j][1] + dp[i][j-1][1] - dp[i-1][j-1][1];\n  //   if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) tmp++;\n  //   dp[i][j][1] = max(dp[i][j][1], tmp);\n  // }\n  //\n  // REP(i, h) {\n  //   REP(j, w) {\n  //     cout << \"(\" << dp[i][j][0] << \",\" << dp[i][j][1] << \")\";\n  //   }\n  //   cout << endl;\n  // // }\n  //\n  // cout << max(dp[h-1][w-1][0], dp[h-1][w-1][1]) << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nchar stage[1000][1000],emblem[2][2];\nint latte[1000][1000],ans,mx;\n\nvoid JOI_cmp(int y,int x){\n    int cy,cx,cnt=0;\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            if(stage[y+i][x+j]!=emblem[i][j]){\n                cnt++;\n                cy=y+i; cx=x+j;\n                if(cnt>1) break;\n            }\n        }\n    }\n    if(cnt==0){\n        ans++;\n        for(int i=0;i<2;i++){\n            for(int j=0;j<2;j++){\n                latte[y+i][x+j]--;\n            }\n        }\n    }\n    if(cnt==1){\n        latte[cy][cx]++;\n        mx=max(mx,latte[cy][cx]);\n    }\n    return;\n}\n\nint main(){\n    int M,N;\n    cin>>M>>N;\n    for(int i=0;i<M;i++){\n        for(int j=0;j<N;j++){\n            cin>>stage[i][j];\n        }\n    }\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            cin>>emblem[i][j];\n        }\n    }\n    for(int i=0;i<M-1;i++){\n        for(int j=0;j<N-1;j++){\n            JOI_cmp(i,j);\n        }\n    }\n    printf(\"%d\\n\",ans+mx);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <typeinfo>\n#include <vector>\n#include <cmath>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <queue>\n#include <iomanip>\n#include <cctype>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<char> vc;\ntypedef vector<vc> vvc;\ntypedef vector<bool> vb;\ntypedef vector<vb> vvb;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<25;\nconst ll INF=1ll<<50;\nconst double pi=acos(-1);\nconst double eps=1e-8;\nconst vi emp;\n\nint h,w,ans=0;\nvvc a,b(2,vc(2));\nvector<vip> c;\n\nvoid Judge(int x,int y){\n\tvp T,F;\n\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++){\n\t\tif(b[i][j]==a[i+x][j+y]) T.push_back(P(i+x,j+y));\n\t\telse F.push_back(P(i+x,j+y));\n\t}\n\tif(T.size()==4){\n\t\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++){\n\t\t\tint dx=i+x,dy=j+y;\n\t\t\tc[dx][dy].first--;\n\t\t\tc[dx][dy].second.first--;\n\t\t\tc[dx][dy].second.second--;\n\t\t}\n\t\tans++;\n\t}\n\telse if(T.size()==3){\n\t\tint dx=F[0].first,dy=F[0].second;\n\t\tchar joi=b[dx-x][dy-y];\n\t\tif(joi=='J') c[dx][dy].first++;\n\t\telse if(joi=='O') c[dx][dy].second.first++;\n\t\telse c[dx][dy].second.second++;\n\t}\n}\n\nint main(){\n\tcin>>h>>w;\n\ta=vvc(h,vc(w));\n\tc=vector<vip>(h,vip(w));\n\tfor(int i=0;i<h;i++) for(int j=0;j<w;j++) cin>>a[i][j];\n\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++) cin>>b[i][j];\n\tfor(int i=0;i<h-1;i++) for(int j=0;j<w-1;j++) Judge(i,j);\n\tint M=0;\n\tfor(int i=0;i<h;i++) for(int j=0;j<w;j++) M=max(M,max(c[i][j].first,max(c[i][j].second.first,c[i][j].second.second)));\n\tcout<<ans+M<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint a1=0,a2,a3,a4;\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\ta1=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a1+=1;\n\t\t\tC=D[i][j];\n\t\t\tD[i][j]='J';\n\t\t\ta2=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a2+=1;\n\t\t\tD[i][j]='O';\n\t\t\ta3=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a3+=1;\n\t\t\tD[i][j]='I';\n\t\t\ta4=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a4+=1;\n\t\t\tD[i][j]=C;\n\n\n\t\t}\n\t}\n\tR=max(R,a+a1);\n\tR=max(R,a+a2);\n\tR=max(R,a+a3);\n\tR=max(R,a+a4);\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nint main() {\n\tint M,N;\n\tchar D[1000][1000];\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tint R=0;\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1])a+=1;\n\t\t}\n\t}\n\n\tint c[4];\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i+1][j-1]==E[1][0]&&D[i][j]==E[0][1]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i][j]==E[1][0]&&D[i-1][j+1]==E[0][1]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i][j-1]==E[1][0]&&D[i-1][j]==E[0][1]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst char c[] = {'J', 'O', 'I'};\n\nint main(void){\n  int H, W;\n  cin >> H >> W;\n  int cnt = 0;\n  vector< vector <char> > f(H, vector<char>(W));\n  vector< vector <char> > e(2, vector<char>(2));\n  for(int i=0; i < H; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++)\n      f[i][p] = tmp[p];\n  }\n\n  for(int i=0; i < 2; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++){\n      e[i][p] = tmp[p];\n    }\n  }\n\n  for(int p=0; p < H-1; p++){\n    for(int q=0; q < W-1; q++){\n      \n      bool flg = true;\n      for(int r=0; r < 2; r++){\n\tfor(int s=0; s < 2; s++){\n\t  if(f[p+r][q+s] == e[r][s]){\n\t  }else{\n\t    flg = false;\n\t  }\n\t}\n      }\n      if(flg){\n\tcnt++;\n      }\n\n    }\n  }\n\n  int ans = cnt;\n  for(int p=0; p < H; p++){\n    for(int q=0; q < W; q++){\n      //changeGrid\n      char moto = f[p][q];\n      int ccnt = cnt;\n      for(int z=0; z < 3; z++){\n\tif(c[z] == moto) continue;\n\tf[p][q] = c[z];\n\tif(p == H-1 && q == 0){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r-1][q+s] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\telse if(p == 0 && q == W-1){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r][q+s-1] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\t\n\telse if(p == 0 || q == 0){\n\t  if(p==0 && q==0){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r][q+r] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p==0){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else if(p == H-1 || q == W-1){\n\t  if(p==H-1 && q==W-1){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r-1][q+s-1] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p == H-1){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r-1][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s-1] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else{\n\t  for(int m=-1; m <= 0; m++){\n\t    for(int n = -1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\t\n      }\n      ans = max(ans, ccnt);\n      f[p][q] = moto;\n    }\n  }\n  \n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1111][1111];\nbool a[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  int cnt;\n  int ans=-111;\n  cin>>M>>N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      // haku[i][j]=mas[i][j];\n    \n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  int a_cnt=0;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(mas[i+k][j+l]==key[k][l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4) a_cnt++;\n    }\n  }\n \n  int dx[]={-1,-1,0,0};\n  int dy[]={-1,0,-1,0};\n  char joi[]={'J','O','I'};\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      for(int mozi=0;mozi<3;mozi++){\n\tif(mas[i][j]==joi[mozi]) continue;\n\tchar tmp=mas[i][j];\n\tmas[i][j]=joi[mozi];\n\tfor(int k=0;k<4;k++){\n\t  int nx=i+dx[k];\n\t  int ny=j+dy[k];\n\t  if(0<=nx && nx<M-1 && 0<=ny && ny<N-1){\n\t    cnt=0;\n\t    \n\t    for(int m=0;m<2;m++){\n\t      for(int l=0;l<2;l++){\n\t\tif(mas[nx+m][ny+l]==key[m][l]){\n\t\t  cnt++;\n\t\t}\n\t      }\n\t    }\n\t    if(cnt==4) a_cnt++;\n\t  }\n\t}\n\tans=max(ans,a_cnt);\n\tmas[i][j]=tmp;\n      }\n    }\n  }\n  cout<<ans<<endl;\n  return 0;\n}\n\t\t"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint H, W; string s[1009], t[3], x = \"JOI\";\nint main() {\n\tcin >> H >> W;\n\tfor (int i = 0; i < H; i++) cin >> s[i];\n\tcin >> t[0] >> t[1];\n\tint sum = 0;\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tbool flag = true;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (s[i + k][j + l] != t[k][l]) flag = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (flag) sum++;\n\t\t}\n\t}\n\tint ret = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tchar e = s[i][j];\n\t\t\tint a[3] = { 0 }, z = -1;\n\t\t\tfor (int c = 0; c < 3; c++) {\n\t\t\t\tif (x[c] == e) z = c;\n\t\t\t\ts[i][j] = x[c];\n\t\t\t\tfor (int k = -1; k < 1 && i + k + 1 < H; k++) {\n\t\t\t\t\tif (i + k < 0) continue;\n\t\t\t\t\tfor (int l = -1; l < 1 && j + l + 1 < W; l++) {\n\t\t\t\t\t\tif (j + l < 0) continue;\n\t\t\t\t\t\tbool flag = true;\n\t\t\t\t\t\tfor (int m = 0; m < 2; m++) {\n\t\t\t\t\t\t\tfor (int n = 0; n < 2; n++) {\n\t\t\t\t\t\t\t\tif (s[i + k + m][j + l + n] != t[m][n]) flag = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flag) a[c]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int c = 0; c < 3; c++) ret = max(ret, sum + a[c] - a[z]);\n\t\t\ts[i][j] = e;\n\t\t}\n\t}\n\tcout << ret << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[1024][1024];\nchar pat[8][8];\nchar cs[]=\"JOI\";\nint mj[1024][1024];\nint has;\nint a,b;\nint calc(int p,int q){\n\tint ret=has;\n\tfor(int i=p-1;i<=p;i++){\n\t\tfor(int j=q-1;j<=q;j++){\n\t\t\tif(i<0||i>=a-1)continue;\n\t\t\tif(j<0||j>=b-1)continue;\n\t\t\tbool ok=true;\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t\tif(str[i+k][j+l]!=pat[k][l])ok=false;\n\t\t\tif(ok&&!mj[i][j])ret++;\n\t\t\tif(!ok&&mj[i][j])ret--;\n\t\t}\n\t}\n\treturn ret;\n}\nint main(){\n\tscanf(\"%d%d\",&a,&b);\n\tfor(int i=0;i<a;i++){\n\t\tscanf(\"%s\",str[i]);\n\t}\n\tfor(int i=0;i<2;i++)scanf(\"%s\",pat[i]);\n\tint ret=0;\n\tfor(int i=0;i<a-1;i++){\n\t\tfor(int j=0;j<b-1;j++){\n\t\t\tbool ok=true;\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t\tif(str[i+k][j+l]!=pat[k][l])ok=false;\n\t\t\tif(ok){mj[i][j]=true;has++;}\n\t\t}\n\t}\n\tfor(int i=0;i<a;i++){\n\t\tfor(int j=0;j<b;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tchar rev=str[i][j];\n\t\t\t\tstr[i][j]=cs[k];\n\t\t\t\tret=max(ret,calc(i,j));\n\t\t\t\tstr[i][j]=rev;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define range(x,l,r) (l<=x && x<r)\nusing namespace std;\n\nconst string joi = \"JOI\";\nint h,w;\nstring g[1010];\nstring flag;\n\ninline int check(int y, int x){\n  if(!range(y,0,h-1) || !range(x,0,w-1))return 0;\n  for(int i=0;i<4;i++){\n    if(g[y+i/2][x+i%2] != flag[i])return 0;\n  }\n  return 1;\n}\n  \nint main(){\n  cin.tie(0); ios::sync_with_stdio(0);\n\n  cin >> h >> w;\n  rep(i,h)cin >> g[i];\n  string a,b;\n  cin >> a >> b;\n  flag = a + b;\n\n  int sum = 0;\n  rep(i,h-1)rep(j,w-1)sum += check(i,j);\n\n  int ans = sum;\n  rep(i,h)rep(j,w){\n    int before = 0;\n    rep(ii,2)rep(jj,2)before += check(i-ii,j-jj);\n\n    char tmp = g[i][j];\n    rep(k,3){\n      g[i][j] = joi[k];\n      int after = 0;\n      rep(ii,2)rep(jj,2)after += check(i-ii,j-jj);\n      ans = max(ans, sum - before + after);\n    }\n    g[i][j] = tmp;\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <queue>\n#include <stack>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\ntypedef double db;\n\n#define fr first\n#define sc second\n#define pb push_back\n#define rep(i,x) for(ll i=0;i<x;i++)\n#define rep1(i,x) for(ll i=1;i<=x;i++)\n#define rrep(i,x) for(ll i=x-1;i>=0;i--)\n#define rrep1(i,x) for(ll i=x;i>0;i--)\n#define plus asdgew\nll H,W;\nstring s[1000];\nll cnt[1000][1000];\nstring f[2];\nchar c[4]=\"JOI\";\nll ans=0;\nll plus;\nll ok(ll y,ll x){\n\trep(i,2) rep(j,2){\n\t\tif(f[i][j]!=s[y+i][x+j]) return 0;\n\t}\n\treturn 1;\n}\n\nll calc(ll y,ll x){\n\tll res=0;\n\tauto jud = [](ll Y,ll X){\n\t\treturn 0<=Y&&Y<H-1&&0<=X&&X<W-1;\n\t};\n\tchar cc=s[y][x];\n\trep(i,3){\n\t\tll bs=0;\n\t\tif(cc==c[i]) continue;\n\t\ts[y][x]=c[i];\n\t\tif(jud(y-1,x-1)) bs+=ok(y-1,x-1);\n\t\tif(jud(y,x-1)) bs+=ok(y,x-1);\n\t\tif(jud(y-1,x)) bs+=ok(y-1,x);\n\t\tif(jud(y,x)) bs+=ok(y,x);\n\t\tres=max(res,bs);\n\t}\n\ts[y][x]=cc;\n\treturn res-cnt[y][x];\n}\n\nint main()\n{\n\tcin>>H>>W;\n\trep(i,H) cin>>s[i];\n\tcin>>f[0]>>f[1];\n\trep(i,H-1) rep(j,W-1){\n\t\tif(s[i][j]==f[0][0]&&s[i+1][j]==f[1][0]&&s[i][j+1]==f[0][1]&&s[i+1][j+1]==f[1][1]){\n\t\t\tans++;\n\t\t\tcnt[i][j]++;\n\t\t\tcnt[i+1][j]++;\n\t\t\tcnt[i][j+1]++;\n\t\t\tcnt[i+1][j+1]++;\n\t\t}\n\t}\n\tplus=0;\n\t/*rep(i,H){\n\t\trep(j,W){\n\t\t\tcout<<cnt[i][j];\n\t\t}\n\t\tcout<<endl;\n\t}*/\n\trep(i,H) rep(j,W) plus=max(plus,calc(i,j));\n\tcout<<ans+plus<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[1024][1024];\nchar pat[8][8];\nchar cs[]=\"JOI\";\nint mj[1024][1024];\nint has;\nint a,b;\nint calc(int p,int q){\n\tint ret=has;\n\tfor(int i=p-1;i<=p;i++){\n\t\tfor(int j=q-1;j<=q;j++){\n\t\t\tif(i<0||i>=a-1)continue;\n\t\t\tif(j<0||j>=b-1)continue;\n\t\t\tbool ok=true;\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t\tif(str[i+k][j+l]!=pat[k][l])ok=false;\n\t\t\tif(ok&&!mj[i][j])ret++;\n\t\t\tif(!ok&&mj[i][j])ret--;\n\t\t}\n\t}\n\treturn ret;\n}\nint main(){\n\tscanf(\"%d%d\",&a,&b);\n\tfor(int i=0;i<a;i++){\n\t\tscanf(\"%s\",str[i]);\n\t}\n\tfor(int i=0;i<2;i++)scanf(\"%s\",pat[i]);\n\tint ret=0;\n\tfor(int i=0;i<a-1;i++){\n\t\tfor(int j=0;j<b-1;j++){\n\t\t\tbool ok=true;\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t\tif(str[i+k][j+l]!=pat[k][l])ok=false;\n\t\t\tif(ok){mj[i][j]=true;has++;}\n\t\t}\n\t}\n\tfor(int i=0;i<a;i++){\n\t\tfor(int j=0;j<b;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tchar rev=str[i][j];\n\t\t\t\tstr[i][j]=cs[k];\n\t\t\t\tret=max(ret,calc(i,j));\n\t\t\t\tstr[i][j]=cs[k];\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for(int i=a;i<=b;i++)\n#define FORD(i,a,b) for(int i=a;i>=b;i--)\n#define FORV(i,a,b) for(int i=a;i*i<=b;i++)\n#define Forv(i,a,b) for(int i=a;i*i<b;i++)\n#define For(i,a,b) for(int i=a;i<b;i++)\n#define Ford(i,a,b) for(int i=a;i>b;i--)\n#define Fill(s,a) memset(s,a,sizeof(s))\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n\nint n, m, cnt=0;\nchar c[1002][1002], x[3][3];\n\nbool check(int i, int j)\n{\n    FOR(k, 1, 2)\n        FOR(l, 1, 2)\n            if(c[i+k-1][j+l-1] != x[k][l]) return false;\n    return true;\n}\n\nint solve(char y, int i, int j)\n{\n    int cnt1=0, cnt2=0;\n    char z = c[i][j];\n    if(check(i, j))cnt1++;\n    if(check(i-1, j-1))cnt1++;\n    if(check(i-1, j))cnt1++;\n    if(check(i, j-1))cnt1++;\n    c[i][j] = y;\n    if(check(i, j))cnt2++;\n    if(check(i-1, j-1))cnt2++;\n    if(check(i-1, j))cnt2++;\n    if(check(i, j-1))cnt2++;\n    c[i][j] = z;\n    return (cnt2-cnt1);\n}\n\nint main()\n{\n    cin>>m>>n;\n    FOR(i, 1, m)\n    {\n        scanf(\"\\n\");\n        FOR(j, 1, n)\n            scanf(\"%c\", &c[i][j]);\n    }\n    scanf(\"\\n%c%c\\n%c%c\", &x[1][1], &x[1][2], &x[2][1], &x[2][2]);\n    For(i, 1, m)\n        For(j, 1, n)\n        {\n            if(check(i, j))cnt++;\n        }\n    int res=0;\n    FOR(i, 1, m)\n        FOR(j, 1, n)\n        {\n            res = max(res, solve('J', i, j));\n            res = max(res, solve('O', i, j));\n            res = max(res, solve('I', i, j));\n        }\n    cout<<cnt+res<<'\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint m, n;\nint ans = 0;\nint dx[4] = {0,1,0,1}, dy[4] = {0,0,1,1};\nchar flag[1000][1000], hole[2][2], joi[3] = {'J', 'O', 'I'};\n\nint main(){\n\tscanf(\"%d%d\", &m, &n);\n\tfor(int i = 0; i < m; i++){\n\t\tfor(int j = 0; j < n; j++) scanf(\" %c\", &flag[i][j]);\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tfor(int j = 0; j < 2; j++) scanf(\" %c\", &hole[i][j]);\n\t}\n\tfor(int i = 1; i < m; i++){\n\t\tfor(int j = 1; j < n; j++){\n\t\t\tif(flag[i-1][j-1]==hole[0][0]&&flag[i][j-1]==hole[1][0]&&flag[i-1][j]==hole[0][1]&&flag[i][j]==hole[1][1]) ans++;\n\t\t}\n\t}\n\tint paper = 0;\n\tfor(int i = 0; i < m; i++){\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tint t = 0;\n\t\t\tchar tmp = flag[i][j];\n\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\tif((i==0&&(k==0||k==2))||(j==0&&(k==0||k==1))||(i==m-1&&(k==1||k==3))||(j==n-1&&(k==2||k==3))) continue;\n\t\t\t\tif(flag[i-1+dx[k]][j-1+dy[k]]==hole[0][0]&&flag[i+dx[k]][j-1+dy[k]]==hole[1][0]&&flag[i-1+dx[k]][j+dy[k]]==hole[0][1]&&flag[i+dx[k]][j+dy[k]]==hole[1][1]) t++;\n\t\t\t}\n\t\t\tint ss = 0;\n\t\t\tfor(int u = 0; u < 3; u++){\n\t\t\t\tint s = 0;\n\t\t\t\tflag[i][j] = joi[u];\n\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\tif((i==0&&(k==0||k==2))||(j==0&&(k==0||k==1))||(i==m-1&&(k==1||k==3))||(j==n-1&&(k==2||k==3))) continue;\n\t\t\t\t\tif(flag[i-1+dx[k]][j-1+dy[k]]==hole[0][0]&&flag[i+dx[k]][j-1+dy[k]]==hole[1][0]&&flag[i-1+dx[k]][j+dy[k]]==hole[0][1]&&flag[i+dx[k]][j+dy[k]]==hole[1][1]) s++;\n\t\t\t\t}\n\t\t\t\tss = max(ss,s);\n\t\t\t}\n\t\t\tpaper = max(paper,ss-t);\n\t\t\tflag[i][j] = tmp;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans+paper);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n\tint h, w; scanf(\"%d %d\", &h, &w);\n\n\tfor (int i = 0; i < h; ++i) scanf(\"%s\", mp[i]);\n\n\tfor (int i = 0; i < 2; ++i) scanf(\"%s\", e[i]);\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tint sum2 = sum;\n\n\t\t\tchar tmp = mp[i][j];\n\n\t\t\tint cnt = 0;\n\n\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\tint y = i + dy[k], x = j + dx[k];\n\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsum2 -= cnt;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tmp[i][j] = a[k];\n\n\t\t\t\tint cnt2 = 0;\n\n\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\tint y = i + dy[l], x = j + dx[l];\n\t\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\t\tcnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcnt = max(cnt, cnt2);\n\t\t\t}\n\n\t\t\tsum2 += cnt;\n\n\t\t\tmp[i][j] = tmp;\n\n\t\t\tans = max(ans, sum2);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nint n, m;\nchar c[1080][1080];\nint cnt[1080][1080];\nchar ans[2][2];\nint anss, res;\nint main(){\n\tcin >> m >> n;\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++) \n\t\t\tcin >> c[i][j];\n\t\n\tfor(int i = 0;i < 2;i++)\n\t\tfor(int j = 0;j < 2;j++)\n\t\t\tcin >> ans[i][j];\n\t\t\t\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tcnt[i][j] = 1;\n\t\t  \tfor(int k = 0;k < 2;k++)\n\t\t\t\tfor(int l = 0;l < 2;l++)\n\t\t\t\t\tif(c[i + k][j + l] != ans[k][l])cnt[i][j] = 0;\n\t\t\tres += cnt[i][j];\n\t\t}\n\t\n\tint anss = res;\n\tfor(int i = 1;i <= m;i++){\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tint last = c[i][j];\n\t\t\tint tres;\n\t\t\tc[i][j] = 'J';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\tc[i][j] = 'O';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = 'I';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = last;\n\t\t}\n\t}\n\tcout << anss << endl;\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint search2(int x, int y){\n\tbool flag = true;\n\tif(check[y][x])\n\t\tflag = false;\n\tint c = search(x, y);\n\tif(flag)\n\t\tcheck[y][x] = false;\n\tif(c == 4)\n\t\tres--;\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0){\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse if(ny == H - 1){\n\t\t\t\t\tint t = (search2(nx, ny - 1) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse if(nx == 0){\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse if(nx == W - 1){\n\t\t\t\t\tint t = (search2(nx - 1, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = (search2(nx, ny) == 4);\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\ts[ny][nx] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n\nint M,N;\nchar flags[1002][1002];\nchar symbols[5][5];\n\nint main() {\n\tscanf(\"%d%d\",&M,&N);\n\tfor(int i=0;i<M;i++) scanf(\"%s\",flags[i]);\n\tfor(int i=0;i<2;i++) scanf(\"%s\",symbols[i]);\n\tint defsol=0;\n\tfor(int i=0;i<M-1;i++) {\n\t\tfor(int j=0;j<N-1;j++) {\n\t\t\tint exists=1;\n\t\t\tfor(int x=0;x<2;x++) {\n\t\t\t\tfor(int y=0;y<2;y++) {\n\t\t\t\t\tif(flags[i+x][j+y]!=symbols[x][y]) exists=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdefsol+=exists;\n\t\t}\n\t}\n\tint changemax=0;\n\tfor(int i=0;i<M;i++) {\n\t\tfor(int j=0;j<N;j++) {\n\t\t\tchar def=flags[i][j];\n\t\t\tint deleted_emblems=0;\n\t\t\tint addmax=0;\n\t\t\tfor(int x=-1;x<=0;x++) {\n\t\t\t\tfor(int y=-1;y<=0;y++) {\n\t\t\t\t\tif(i+x>=0&&i+x+1<M) {\n\t\t\t\t\t\tif(j+y>=0&&j+y+1<N) {\n\t\t\t\t\t\t\tint exists=1;\n\t\t\t\t\t\t\tfor(int v=0;v<2;v++) {\n\t\t\t\t\t\t\t\tfor(int w=0;w<2;w++) {\n\t\t\t\t\t\t\t\t\tif(flags[i+x+v][j+y+w]!=symbols[v][w]) exists=0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdeleted_emblems+=exists;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int types=0;types<3;types++) {\n\t\t\t\tif(types==0) flags[i][j]='J';\n\t\t\t\tif(types==1) flags[i][j]='O';\n\t\t\t\tif(types==2) flags[i][j]='I';\n\t\t\t\tint addvl=0;\n\t\t\t\tfor(int x=-1;x<=0;x++) {\n\t\t\t\t\tfor(int y=-1;y<=0;y++) {\n\t\t\t\t\t\tif(i+x>=0&&i+x+1<M) {\n\t\t\t\t\t\t\tif(j+y>=0&&j+y+1<N) {\n\t\t\t\t\t\t\t\tint exists=1;\n\t\t\t\t\t\t\t\tfor(int v=0;v<2;v++) {\n\t\t\t\t\t\t\t\t\tfor(int w=0;w<2;w++) {\n\t\t\t\t\t\t\t\t\t\tif(flags[i+x+v][j+y+w]!=symbols[v][w]) exists=0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\taddvl+=exists;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(addmax<addvl) addmax=addvl;\n\t\t\t}\n\t\t\tif(changemax<addmax-deleted_emblems) changemax=addmax-deleted_emblems;\n\t\t\tflags[i][j]=def;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",changemax+defsol);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint ct[1000][1000];\nchar table[1000][1000];\nchar target[2][2];\n\nint N, M;\n\nbool match(int x, int y) {\n\treturn table[y][x] == target[0][0] && \n\t\ttable[y + 1][x] == target[1][0] && \n\t\ttable[y][x + 1] == target[0][1] && \n\t\ttable[y + 1][x + 1] == target[1][1];\n}\n\nint f(int x, int y) {\n\tint ct = 0;\n\tif (x + 1 < N && y + 1 < M) {\n\t\tif (match(x, y))ct++;\n\t}\n\tif (x - 1 >= 0 && y + 1 < M) {\n\t\tif (match(x - 1, y))ct++;\n\t}\n\tif (x + 1 < N && y >= 0) {\n\t\tif (match(x, y - 1))ct++;\n\t}\n\tif (x >= 0 && y >= 0) {\n\t\tif (match(x - 1, y - 1))ct++;\n\t}\n\treturn ct;\n}\n\nint main() {\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tcin >> table[i][j];\n\t\t}\n\t}\n\n\tcin >> target[0][0] >> target[0][1] >> target[1][0] >> target[1][1];\n\tint ans = 0, tmp = 0;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tif (i < M - 1 && j < N - 1)ans += match(j, i);\n\t\t\tct[i][j] = f(j, i);\n\t\t}\n\t}\n\ttmp = ans;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tchar bef = table[i][j];\n\t\t\ttable[i][j] = 'J';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\t\n\t\t\ttable[i][j] = 'O';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = 'I';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = bef;\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define IN(a, b, x) (a<=x&&x<b)\n#define MP make_pair\n#define PB push_back\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\nstring s[1010], t[2];\nint dp[1010][1010][2];\nsigned main(void)\n{\n  int h, w;\n  cin >> h >> w;\n  REP(i, h) cin >> s[i];\n  REP(i, 2) cin >> t[i];\n\n  FOR(i, 1, h) FOR(j, 1, w) {\n    dp[i][j][0] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0];\n    if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n      dp[i][j][0]++;\n    }\n    dp[i][j][1] = dp[i][j][0];\n    /*if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n      dp[i][j][1]++;\n    }*/\n    if((s[i-1][j-1] != t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] != t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] != t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] != t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1])) {\n      dp[i][j][1] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0] + 1;\n    }\n    int tmp = dp[i-1][j][1] + dp[i][j-1][1] - dp[i-1][j-1][1];\n    if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) tmp++;\n    dp[i][j][1] = max(dp[i][j][1], tmp);\n  }\n\n  // REP(i, h) {\n    // REP(j, w) {\n      // cout << \"(\" << dp[i][j][0] << \",\" << dp[i][j][1] << \")\";\n    // }\n    // cout << endl;\n  // }\n\n  cout << max(dp[h-1][w-1][0], dp[h-1][w-1][1]) << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main()\n{\n\tint a, b;\n\tcin >>a>>b;\n\tchar a11, a12, a21, a22, x[a][b], y;\n\tint j=0;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\tcin >> x[k][l];\n\t\t}\n\t}\n\tcin >>a11>>a12>>a21>>a22;\n\tfor (int k=0; k<a-1; k++)\n\t{\n\t\tfor (int l=0; l<b-1; l++)\n\t\t{\n\t\t\tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t\tj+=1;\n\t\t}\n\t}\n\tint q=j;\n\tint m, n, p;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\ty=x[k][l];\n\t\t\tm=0;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tm+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    m+=1;\n\t\t    n=0;\n\t\t\tx[k][l]=a11;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(m, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a12;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a21;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a22;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\t\t    \n\t       \tj=max(j, q+p-m);\n\t       \tx[k][l]=y;\n\t\t}\n\t}\n\tcout <<j<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nint ans[3][1000][1000] = {};\nint main()\n{\n\tint n,m;\n\tstring x[1000];\n\tstring an[2];\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tcin >> x[i];\n\t}\n\tcin >> an[0];\n\tcin >> an[1];\n\tint mmm[4] = { 0, 0, 1, 1 };\n\tint nnn[4] = { 0, 1, 0, 1 };\n\tint sum = 0;\n\tfor (int i = 0; i < n - 1; i++)\n\t{\n\t\tfor (int I = 0; I < m - 1; I++)\n\t\t{\n\t\t\tint a = -1;\n\t\t\tint ji = -1;\n\t\t\tint jI = -1;\n\t\t\tchar as;\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t{\n\t\t\t\tif (x[i + mmm[k]][I + nnn[k]] == an[mmm[k]][nnn[k]])\n\t\t\t\t{\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ta++;\n\t\t\t\t\tas = an[mmm[k]][nnn[k]];\n\t\t\t\t\tji = i + mmm[k];\n\t\t\t\t\tjI = I + nnn[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a == -1)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\t{\n\t\t\t\t\tfor (int s = 0; s < 3;s++)\n\t\t\t\t\t\tans[s][i + mmm[k]][I + nnn[k]]--;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (a == 0)\n\t\t\t{\n\t\t\t\tswitch (as)\n\t\t\t\t{\n\t\t\t\tcase'J':\n\t\t\t\t\tans[0][ji][jI]++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase'O':\n\t\t\t\t\tans[1][ji][jI]++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase'I':\n\t\t\t\t\tans[2][ji][jI]++;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint gh = 0;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tfor (int k = 0; k < m; k++)\n\t\t{\n\t\t\tfor (int s = 0; s < 3;s++)\n\t\t\t\tif (gh < ans[s][i][k])gh = ans[s][i][k];\n\t\t}\n\t}\n\tcout << sum + gh << endl;\n\t\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define IVSN(expr) ((expr) ? 1 : 0)\nusing namespace std;\n\nconst int WMAX = 1024, HMAX = 1024;\nint w, h;\nchar flag[WMAX][HMAX];\nchar em[4];\n\nbool is_emblem(int x, int y) {\n  return (em[0] == flag[x][y] and em[1] == flag[x+1][y]\n      and em[2] == flag[x][y+1] and em[3] == flag[x+1][y+1]);\n}\n\nint difference(char c, int x, int y) {\n  char temp = flag[x][y];\n  if (temp == c) return 0;\n  flag[x][y] = c;\n\n  int ans = IVSN(is_emblem(x,y)) +\n    IVSN(is_emblem(x-1,y)) +\n    IVSN(is_emblem(x,y-1)) +\n    IVSN(is_emblem(x-1,y-1));\n  flag[x][y] = temp;\n  return ans;\n}\n\nint count_emblems() {\n  int ans = 0;\n  for (int y = 1; y < h; y++) {\n    for (int x = 1; x < w; x++) {\n      if (is_emblem(x, y))\n        ans++;\n    }\n  }\n  return ans;\n}\n\nint solve() {\n  char joi[3] = {'J', 'O', 'I'};\n  int ans = 0;\n\n  REP(c, 3) {\n    for (int y = 1; y <= h; y++) \n      for (int x = 1; x <= w; x++) {\n      ans = max(ans, difference(joi[c], x, y));\n    }\n  }\n  return ans;\n}\n\nint main() {\n  cin >> h >> w;\n  for (int y = 1; y <= h; y++) {\n    string low;\n    cin >> low;\n    for (int x = 1; x <= w; x++) {\n      flag[x][y] = low[x-1];\n    }\n  }\n  for (int i = 0; i <= 2; i += 2) {\n    string low;\n    cin >> low;\n    em[i] = low[0], em[i + 1] = low[1];\n  }\n  cout << count_emblems() + solve() << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\n\nstruct st {\n\tint x, y;\n\tchar c;\n};\nbool operator<(st a, st b) {\n\tif (a.x == b.x&&a.y == b.y)return a.c < b.c;\n\tif (a.x == b.x)return a.y < b.y;\n\treturn a.x < b.x;\n}\nchar s[1000][1001], f[2][3];\nint main() {\n\tint m, n; scanf(\"%d%d\", &m, &n);\n\trep(i, m)scanf(\"%s\", s[i]);\n\trep(i, 2)scanf(\"%s\", f[i]);\n\tmap<st, int>mp;\n\tint ans = 0;\n\trep(i, m - 1) {\n\t\trep(j, n - 1) {\n\t\t\tbool match[4]{};\n\t\t\trep(k, 2)rep(t, 2) {\n\t\t\t\tif (s[i + k][j + t] == f[k][t])\n\t\t\t\t\tmatch[k * 2 + t] = true;\n\t\t\t}\n\t\t\tint cnt = count(match, match + 4, true);\n\t\t\tif (cnt == 4)ans++;\n\t\t\tif (cnt == 3) {\n\t\t\t\trep(k, 4) {\n\t\t\t\t\tif (!match[k])\n\t\t\t\t\t\tmp[{i + k / 2, j + k % 2, f[k / 2][k % 2]}]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint Max = 0;\n\tfor (auto p : mp) {\n\t\tint cnt = 0;\n\t\tchar c = p.first.c;\n\t\trep(i, 2)rep(j, 2) {\n\t\t\tint x = p.first.x + i, y = p.first.y + j;\n\t\t\tbool ok = true;\n\t\t\trep(k, 2)rep(t, 2) {\n\t\t\t\tif (s[x + k][y + t] != f[k][t])ok = false;\n\t\t\t}\n\t\t\tif (ok) {\n\t\t\t\tswap(s[p.first.x][p.first.y], c);\n\t\t\t\tif (s[p.first.x][p.first.y] != f[i][j])cnt++;\n\t\t\t\tswap(s[p.first.x][p.first.y], c);\n\t\t\t}\n\t\t}\n\t\tMax = max(Max, p.second - cnt);\n\t}\n\tprintf(\"%d\\n\", ans + Max);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define MP make_pair\n#define PB push_back\n#define F first\n#define S second\n#define INF 1 << 30\n#define EPS 1e-10\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint flag[1024][1024], cr[2][2], M, N;\n\nint count(int y, int x){\n  int res = 0;\n  REP(i, -1, 1) REP(j, -1, 1){\n    int ny = y+i, nx = x+j;\n    if(ny < 0 || nx < 0 || ny+1 >= M || nx+1 >= N) continue;\n    int f = 1;\n    rep(k, 2) rep(l, 2) if(flag[ny+k][nx+l] != cr[k][l]) f = 0;\n    res += f;\n  }\n  return res;\n}\n\nint main(){\n  char in[1024];\n  scanf(\"%d%d\", &M, &N);\n  rep(i, M){\n    scanf(\"%s\", in);\n    rep(j, N){\n      if(in[j] == 'J') flag[i][j] = 0;\n      else if(in[j] == 'O') flag[i][j] = 1;\n      else flag[i][j] = 2;\n    }\n  }\n  rep(i, 2){\n    scanf(\"%s\", in);\n    rep(j, 2){\n      switch(in[j]){\n      case 'J': cr[i][j] = 0; break;\n      case 'O': cr[i][j] = 1; break;\n      case 'I': cr[i][j] = 2; break;\n      }\n    }\n  }\n\n  int sum = 0;\n  rep(i, M-1) rep(j, N-1){\n    if(flag[i][j] != cr[0][0]) continue;\n    if(flag[i+1][j] == cr[1][0] && flag[i+1][j+1] == cr[1][1] && flag[i][j+1] == cr[0][1]) sum++;\n  }\n\n  int res = sum;\n  rep(i, M) rep(j, N){\n    int tmpc = count(i, j), tmp = flag[i][j];\n    rep(k, 3){\n      if(tmp == k) continue;\n      flag[i][j] = k;\n      res = max(res, sum - tmpc + count(i, j));\n    }\n    flag[i][j] = tmp;\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int dx[] = {-1, 0, -1, 0};\nconst int dy[] = {-1, -1, 0, 0};\n\nconst int nx[] = {0, 1, 0, 1};\nconst int ny[] = {0, 0, 1, 1};\n\nint main()\n{\n  int ans = 0;\n  int h, w;\n  char f[1010][1010], emb[4];\n  char joi[] = {'J', 'O', 'I'};\n  int d[1010][1010];\n\n  cin >> h >> w;\n  for (int i = 0; i < h; i++){\n    for (int j = 0; j < w; j++){\n      cin >> f[i][j];\n    }\n  }\n\n  for (int i = 0; i < 4; i++){\n    cin >> emb[i];\n  }\n\n  for (int i = 0; i < h; i++){\n    for (int j = 0; j < w; j++){\n      for (int k = 0; k < 4; k++){\n        int x = j + dx[k];\n        int y = i + dy[k];\n\n        if (x < 0 || y < 0 || w - 1 <= x || h - 1 <= y) continue;\n\n        char uri[4];\n        for (int l = 0; l < 4; l++){\n          int sx = x + nx[l];\n          int sy = y + ny[l];\n          uri[l] = f[sy][sx];\n        }\n\n        int cnt = 0;\n        for (int l = 0; l < 4; l++){\n          cnt += (uri[l] == emb[l]);\n        }\n\n        if (cnt == 4){\n          d[i][j]++;\n          if (k == 0) ans++;\n        }\n      }\n    }\n  }\n\n  int maxplus = 0;\n  for (int i = 0; i < h; i++){\n    for (int j = 0; j < w; j++){\n      char s = f[i][j];\n      int onakasuita = 0;\n      for (int l = 0; l < 3; l++){\n        f[i][j] = joi[l];\n        char uri[4];\n        for (int k = 0; k < 4; k++){\n          int x = j + nx[k];\n          int y = i + ny[k];\n          uri[k] = f[y][x];\n        }\n        \n        int cnt = 0;\n        for (int k = 0; k < 4; k++){\n          cnt += (uri[k] == emb[k]);\n        }\n\n        if (cnt == 4) onakasuita++;\n      }\n      maxplus = max(maxplus, onakasuita - d[i][j]);\n      f[i][j] = s;\n    }\n  }\n\n  cout << ans + maxplus << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <iostream>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n \ntypedef long long ll;\n \nusing namespace std;\n \nint mo[5]={0,0,1,1,0};\nchar ch[4] = \"JOI\";\nchar in[1002][1002],flag[2][3];\nint m,n,c=0,ans;\n \nbool check(int i,int j){\n    int check=0;\n    for(int k=0;k<4;k++){\n        if(in[i+mo[k]][j+mo[k+1]]==flag[mo[k]][mo[k+1]])\n            check++;\n    }\n    if(check==4) return true;\n     \n    return false;\n}\n \nint main(){\n     \n    scanf(\"%d%d\",&m,&n);\n     \n    for(int i=1;i<=m;i++){\n        scanf(\"%s\",&in[i][1]);\n    }\n     \n    for(int i=0;i<2;i++){\n        scanf(\"%s\",flag[i]);\n    }\n     \n     \n    for(int i=1;i<m;i++){\n        for(int j=1;j<n;j++){\n            c+=check(i,j);\n        }\n    }\n     \n    ans=c;\n     \n    for(int i=1;i<=m;i++){\n        for(int j=1;j<=n;j++){\n            char memo=in[i][j];\n            int sc=0;\n             \n            for(int l=0;l<4;l++){\n                sc+=check(i+mo[l]-1,j+mo[l+1]-1);\n            }\n             \n            for(int k=0;k<3;k++){\n                int cc=0;\n                in[i][j]=ch[k];\n                 \n                for(int l=0;l<4;l++){\n                    cc+=check(i+mo[l]-1,j+mo[l+1]-1);\n                }\n                ans=max(ans,c+cc-sc);\n            }\n             \n            in[i][j]=memo;\n        }\n    }\n     \n    printf(\"%d\\n\",ans);\n     \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n\nint dx[4]={0,0,1,1},dy[4]={0,1,0,1};\nchar map[1003][1003],flag[3][3];\n\nbool isflag(int x, int y){\n    int nx,ny,i;\n    for(i=0; i<4; i++){\n        nx = x+dx[i];\n        ny = y+dy[i];\n        if(map[nx][ny]!=flag[dx[i]][dy[i]]){\n            return false;\n        }\n    }\n    return true;\n}\n\nint main(void){\n    int m,n,ans=0,max=0,i,j,h,a,b,c,d,e,nx,ny;\n    char tmp;\n    scanf(\"%d%d\",&m,&n);\n    for(i=0; i<(n+2); i++){\n        map[0][i]='.';\n        map[m+1][i]='.';\n    }\n    for(i=1; i<=m; i++){\n        scanf(\"%s\",map[i]);\n        for(j=n; j>0; j--){\n            map[i][j] = map[i][j-1];\n        }\n        map[i][0]='.';\n        map[i][n+1]='.';\n    }\n    for(i=0; i<2; i++){\n        scanf(\"%s\",flag[i]);\n    }\n    for(i=1; i<m; i++){\n        for(j=1; j<n; j++){\n            if(isflag(i,j)){\n                ans++;\n            }\n        }\n    }\n    for(i=1; i<=m; i++){\n        for(j=1; j<=n; j++){\n            tmp = map[i][j];\n            e = 0;\n            //J???????????????\n            map[i][j] = 'J';\n            d = 0;\n            for(h=0; h<4; h++){\n                nx = i-dx[h];\n                ny = j-dy[h];\n                if(isflag(nx,ny)){\n                    d++;\n                }\n            }\n            if(map[i][j]==tmp){\n                c = d;\n            }else{\n                a = d;\n                e = 1;\n            }\n            //O???????????????\n            map[i][j] = 'O';\n            d = 0;\n            for(h=0; h<4; h++){\n                nx = i-dx[h];\n                ny = j-dy[h];\n                if(isflag(nx,ny)){\n                    d++;\n                }\n            }\n            if(map[i][j]==tmp){\n                c = d;\n            }else if(e==0){\n                a = d;\n                e = 1;\n            }else{\n                b = d;\n            }\n            //I???????????????\n            map[i][j] = 'I';\n            d = 0;\n            for(h=0; h<4; h++){\n                nx = i-dx[h];\n                ny = j-dy[h];\n                if(isflag(nx,ny)){\n                    d++;\n                }\n            }\n            if(map[i][j]==tmp){\n                c=d;\n            }else{\n                b=d;\n            }\n            //??????\n            map[i][j] = tmp;\n            c*=-1;\n            c+=(a>b)?a:b;\n            max = (max>c)?max:c;\n        }\n    }\n    printf(\"%d\\n\",ans+max);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\nstring mp[1000];\nstring mark[2];\nint  his[3][1000][1000];\n \nint main() {\n \n  int h,w;\n \n  cin >> h >> w;\n \n  for(int i=0;i<h;i++) cin >> mp[i];\n \n  for(int i=0;i<2;i++) cin >> mark[i];\n  w = mp[1].size();\n \n  for(int k=0;k<3;k++)  \n    for(int i=0;i<h;i++)\n      for(int j=0;j<w;j++) \n      his[k][i][j] = 0;\n   \n   \n   \n  int ans = 0;\n  for(int i=0;i<h;i++) \n    for(int j=0;j<w;j++) \n      if(i+1 < h && j+1 < w)\n    if(mp[i][j] == mark[0][0] && mp[i][j+1] == mark[0][1] && mp[i+1][j] == mark[1][0] && mp[i+1][j+1] == mark[1][1]) ans++;\n       \n  //    cout << ans << endl;\n   \n  char m,t;\n  int ansx,ansy,big = 0;\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) {\n      int count = 0;\n      int x,y;\n      if(i+1 < h && j+1 <w) {\n    if(mp[i][j] == mark[0][0]) count++;\n    else {\n      x = j;\n      y = i;\n      m = mark[0][0];\n    }\n    if(mp[i][j+1] == mark[0][1]) count++;\n    else{\n      x = j+1;\n      y = i; \n      m = mark[0][1];     \n    } \n    if(mp[i+1][j] == mark[1][0] ) count++;\n    else {\n      x = j;\n      y = i+1;\n      m = mark[1][0];\n    }\n    if(mp[i+1][j+1] == mark[1][1]) count++;\n    else {\n      x = j+1;\n      y = i+1;\n      m = mark[1][1];\n    }\n      }\n      if(count == 3) {\n    int k;\n    if(m == 'O') k = 0;\n    if(m == 'J') k = 1;\n    if(m == 'I') k = 2;\n    his[k][y][x]++;\n    if(his[k][y][x] > big) {\n      big = his[k][y][x];\n      ansx = x;\n      ansy = y;\n      t = m;\n    }\n      }\n    }\n  }\n   \n  \n  cout << ans+ big<< endl;      \n   \n  \n \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <functional> //sort(A,A.end(),greater<int>());???????????????\n#include <queue>\n#include <stack>\n#include <vector>\n\n#define INF 10 << 10\n\nint n, m;\nchar flag[1002][1002];\nchar coa[3][3]; //?´???? Coat of arms\nint over[1002][1002]; // ?????????\n\nbool check(char y0x0, char y0x1, char y1x0, char y1x1) {\n\tif (y0x0 == coa[0][0]) {\n\t\tif (y0x1 != coa[0][1]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x0 != coa[1][0]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x1 != coa[1][1]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvoid Over(int y, int x) {\n\tfor (int i = y - 1; i < y + 1; ++i) {\n\t\tfor (int i2 = x - 1; i2 < x + 1; ++i2) {\n\t\t\t++over[i][i2];\n\t\t}\n\t}\n}\n\nint main() {\n\tmemset(over, 0, sizeof(over));\n\tmemset(flag, '0', sizeof(flag));\n\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tcin >> flag[i][i2];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int i2 = 0; i2 < 2; ++i2) {\n\t\t\tcin >> coa[i][i2];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\t//???????????§?????¢?´¢\n\tfor (int i = 1; i <= n - 1; ++i) {\n\t\tfor (int i2 = 1; i2 <= m - 1; ++i2) {\n\t\t\tif (check(flag[i][i2], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t++cnt;\n\t\t\t\tOver(i, i2);\n\t\t\t}\n\t\t}\n\t}\n\n\t//???????????????J,O,I,????????´????????????\n\t//(i, i2)????????????(i - 1, i2 - 1)???(i + 1, i2 + 1)??????????????°??????\n\t//??????????¢????????????????\t\t???\t??????(i, i2)?????????????´??????¨???????????£??????????????????????????????????????°???\n\tint cnt_add = 0;\n\tchar JOI[] = { \"JOI\" };\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tint add = 0;\n\t\t\t\tif (check(flag[i - 1][i2 - 1], flag[i - 1][i2], flag[i][i2 - 1], JOI[j])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i - 1][i2], flag[i - 1][i2 + 1], JOI[j], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i][i2 - 1], JOI[j], flag[i + 1][i2 - 1], flag[i + 1][i2])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(JOI[j], flag[i][i2 + 1], flag[i + 1][i2], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tcnt_add = max(cnt_add, add - over[i][i2]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << max(cnt, cnt + cnt_add) << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n \nint main()\n{\n    int a, b;\n    cin >>a>>b;\n    char a11, a12, a21, a22, x[1000][1000], y;\n    int j=0;\n    for (int k=0; k<a; k++)\n    {\n        for (int l=0; l<b; l++)\n        {\n            cin >> x[k][l];\n        }\n    }\n    cin >>a11>>a12>>a21>>a22;\n    for (int k=0; k<a-1; k++)\n    {\n        for (int l=0; l<b-1; l++)\n        {\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            j+=1;\n        }\n    }\n    int q=j;\n    int m, n, p;\n    for (int k=0; k<a; k++)\n    {\n        for (int l=0; l<b; l++)\n        {\n            y=x[k][l];\n            m=0;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            m+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            m+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            m+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            m+=1;\n            n=0;\n            x[k][l]=a11;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(m, n);\n            n=0;\n            x[k][l]=a12;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a21;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a22;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);            \n            j=max(j, q+p-m);\n            x[k][l]=y;\n        }\n    }\n    cout <<j<<\"\\n\";\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define IN(a, b, x) (a<=x&&x<b)\n#define MP make_pair\n#define PB push_back\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\nstring s[1010], t[2];\nint dp[1010][1010][2];\nsigned main(void)\n{\n  int h, w;\n  cin >> h >> w;\n  REP(i, h) cin >> s[i];\n  REP(i, 2) cin >> t[i];\n\n  FOR(i, 1, h) FOR(j, 1, w) {\n    dp[i][j][0] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0];\n    if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n      dp[i][j][0]++;\n    }\n    if((s[i-1][j-1] != t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] != t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] != t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] != t[1][1])) {\n      dp[i][j][1] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0] + 1;\n    }\n    dp[i][j][1] = max(dp[i][j][1], dp[i-1][j][1] + dp[i][j-1][1] - dp[i-1][j-1][1]);\n  }\n\n  cout << max(dp[h-1][w-1][0], dp[h-1][w-1][1]) << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <fstream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <set>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <sstream>\n#include <fstream>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n#define int long long\nconst int mod = 1000000007;\n\nchar flag[1000][1000] = {};\nint z[1000][1000] = {};\nchar base[2][2];\nsigned main()\n{\n\tint ans = 0;\n\tint H, W; cin >> H >> W;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> base[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tint tmp = 0;\n\t\t\tint x, y;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (flag[i + k][j + l] == base[k][l]) {\n\t\t\t\t\t\ttmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx = i + k; y = j + l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == 4) ans++;\n\t\t\telse if (tmp == 3) z[x][y]++;\n\t\t}\n\t}\n\tint tmp = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\ttmp = max(tmp, z[i][j]);\n\t\t}\n\t}\n\n\n\tcout << ans+tmp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst char c[] = {'J', 'O', 'I'};\n\nint main(void){\n  int H, W;\n  cin >> H >> W;\n  int cnt = 0;\n  vector< vector <char> > f(H, vector<char>(W));\n  vector< vector <char> > e(2, vector<char>(2));\n  for(int i=0; i < H; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++)\n      f[i][p] = tmp[p];\n  }\n\n  for(int i=0; i < 2; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++){\n      e[i][p] = tmp[p];\n    }\n  }\n\n  for(int p=0; p < H-1; p++){\n    for(int q=0; q < W-1; q++){\n      \n      bool flg = true;\n      for(int r=0; r < 2; r++){\n\tfor(int s=0; s < 2; s++){\n\t  if(f[p+r][q+s] == e[r][s]){\n\t  }else{\n\t    flg = false;\n\t  }\n\t}\n      }\n      if(flg){\n\tcnt++;\n      }\n\n    }\n  }\n\n  int ans = cnt;\n  for(int p=0; p < H; p++){\n    for(int q=0; q < W; q++){\n      //changeGrid\n      char moto = f[p][q];\n      int ccnt = cnt;\n      for(int z=0; z < 3; z++){\n\tif(c[z] == moto) continue;\n\tf[p][q] = c[z];\n\tif(p == H-1 && q == 0){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r-1][q+s] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\telse if(p == 0 && q == W-1){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r][q+s-1] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\t\n\telse if(p == 0 || q == 0){\n\t  if(p==0 && q==0){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r][q+s] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p==0){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else if(p == H-1 || q == W-1){\n\t  if(p==H-1 && q==W-1){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r-1][q+s-1] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p == H-1){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r-1][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s-1] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else{\n\t  for(int m=-1; m <= 0; m++){\n\t    for(int n = -1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\t\n      }\n      ans = max(ans, ccnt);\n      f[p][q] = moto;\n    }\n  }\n  \n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint conv[256];\nint grid[1024][1024];\nint emblem[2][2];\n\nbool check(int x, int y)\n{\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tif (grid[x + i][y + j] != emblem[i][j]) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint main()\n{\n\tconv['J'] = 1;\n\tconv['O'] = 2;\n\tconv['I'] = 3;\n\t\n\tint m, n;\n\tchar c;\n\t\n\tscanf(\"%d %d\", &m, &n);\n\tfor (int i = 1; i <= m; i++){\n\t\tfor (int j = 1; j <= n; j++){\n\t\t\tscanf(\" %c\", &c);\n\t\t\tgrid[i][j] = conv[c];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tscanf(\" %c\", &c);\n\t\t\temblem[i][j] = conv[c];\n\t\t}\n\t}\n\t\n\tint def = 0;\n\tfor (int i = 1; i < m; i++){\n\t\tfor (int j = 1; j < n; j++){\n\t\t\tdef += check(i, j);\n\t\t}\n\t}\n\t\n\tint maxi = def;\n\tfor (int i = 1; i <= m; i++){\n\t\tfor (int j = 1; j <= n; j++){\n\t\t\tint tmp = grid[i][j];\n\t\t\t\n\t\t\tint num = def;\n\t\t\tfor (int x = i - 1; x <= i; x++){\n\t\t\t\tfor (int y = j - 1; y <= j; y++){\n\t\t\t\t\tnum -= check(x, y);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (int to = 1; to <= 3; to++){\n\t\t\t\tgrid[i][j] = to;\n\t\t\t\tint add = 0;\n\t\t\t\tfor (int x = i - 1; x <= i; x++){\n\t\t\t\t\tfor (int y = j - 1; y <= j; y++){\n\t\t\t\t\t\tadd += check(x, y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmaxi = max(maxi, num + add);\n\t\t\t}\n\t\t\tgrid[i][j] = tmp;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", maxi);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint N,M;\nchar F[1111][1111];\nchar E[11][11];\nint D[1111][1111];\n\nbool check(int x,int y,char c){\n  char tmp = F[x][y];\n  F[x][y] = c;\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if( i+y >= M || j+x >= N ){\n        F[x][y] = tmp; return false;\n      }\n      if( F[j+x][i+y] != E[j][i] ){\n        F[x][y] = tmp; return false;\n      }\n    }\n  }\n  F[x][y] = tmp;\n  return true;\n}\n\nint dx[]={0,-1,-1,0};\nint dy[]={0,-1,0,-1};\nchar dc[]=\"JOI\";\nint main(){\n  cin >> M >> N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin >> F[j][i];\n    }\n  }\n\n  for(int i=0;i<2;i++)\n    for(int j=0;j<2;j++) cin >> E[j][i];\n\n  int sum = 0;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      D[j][i] = check(j,i,F[j][i]);\n      if( D[j][i] == 1 ) sum++;\n    }\n  }\n  int res = sum;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      for(int k=0;k<3;k++){\n        int pr = 0;\n        for(int t =0;t<4;t++){\n          int nx = j+dx[t], ny = i+dy[t];\n          if( nx < 0 || ny < 0 ) continue;\n          int fl = check(nx,ny,dc[k]);\n          pr += (fl - D[nx][ny]); \n        }\n        res = max(res,sum+pr);\n      }\n    }\n  }\n  cout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H, string(W, ' '));\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        cin >> G[i][j];\n      }\n    }\n    vector<string> F(2, string(2, ' '));\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        cin >> F[i][j];\n      }\n    }\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<int> > B(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        int T = S + B[i][j] - A[i][j];\n        if(i) T -= A[i-1][j];\n        if(j) T -= A[i][j-1];\n        if(i && j) T -= A[i-1][j-1];\n        res = max(res, T);\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\nusing namespace std;\n\nchar a[1001][1001];\nvector<string> vs;\n\nbool func(int y, int x) {\n  for(int i=0; i<vs.size(); i++) {\n    for(int j=0; j<vs[i].size(); j++) {\n      if(a[y+i][x+j] != vs[i][j]) return false;\n    }\n  }\n  return true;\n}\n\nint main() {\n\n  int m, n;\n  cin >> m >> n;\n  for(int i=0; i<m; i++) {\n    for(int j=0; j<n; j++) {\n      cin >> a[i][j];\n    }\n  }\n  string tmp;\n  while(vs.size() < m && cin >> tmp) vs.push_back(tmp);\n\n  int ans = 0;\n  for(int i=0; i< m - vs.size() + 1; i++) {\n    for(int j=0; j < n - vs[i].size() + 1; j++) {\n      if(a[i][j] == vs[i][0] && func(i,j)) ans++;\n    }\n  }\n  cout << ans << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint m, n;\nchar flag[1100][1010];\nchar emblem[3][3];\nbool g(int i, int j) {\n\tif (flag[i][j] == emblem[0][0])\n\t\tif (flag[i + 1][j] == emblem[1][0])\n\t\t\tif (flag[i][j + 1] == emblem[0][1])\n\t\t\t\tif (flag[i + 1][j + 1] == emblem[1][1])\n\t\t\t\t\treturn true;\n\treturn false;\n}\nint f() {\n\tint sum = 0;\n\tfor (int i = 1; i < m; i++) {\n\t\tfor (int j = 1; j < n; j++) {\n\t\t\tif (g(i, j))sum++;\n\t\t}\n\t}\n\treturn sum;\n}\nint g1(int i,int j) {\n\tint cnt = 0;\n\tif (i > 1) {\n\t\tif (j > 1)cnt += g(i - 1, j - 1);\n\t\tcnt += g(i - 1, j);\n\t}\n\tif (j > 1)cnt += g(i, j - 1);\n\tcnt += g(i, j);\n\treturn cnt;\n}\nint main() {\n\tcin >> m >> n;\n\tfor (int i = 1; i <= m; i++)for (int j = 1; j <= n; j++)cin >> flag[i][j];\n\tfor (int i = 0; i < 2; i++)for (int j = 0; j < 2; j++)cin >> emblem[i][j];\n\tint ans = f();\n\tint ans1 = ans;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tint a = g1(i, j);\n\t\t\tint b = g1(i, j);\n\t\t\tchar ch = flag[i][j];\n\t\t\tflag[i][j] = 'J';\n\t\t\tb = max(b, g1(i, j));\n\t\t\tflag[i][j] = 'O';\n\t\t\tb = max(b, g1(i, j));\n\t\t\tflag[i][j] = 'I';\n\t\t\tb = max(b, g1(i, j));\n\t\t\tflag[i][j] = ch;\n\t\t\tif (b > a)ans1 = max(ans1, ans + b - a);\n\t\t}\n\t}\n\tcout << ans1 << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nenum{J='J',O='O',I='I'};\n\nchar moj[3]={J,O,I};\nchar ary[1010][1010];\nint ary2[1010][1010][3]={};\nint main(){\n\tint M,N,hog,ug,ma,cnt,nuk;\n\tchar emb[2][2];\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>ary[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>emb[i][j];\n\t\t}\n\t}\n\tcnt=0;\n\tfor(int i=0;i<M-1;i++){\n\t\tfor(int j=0;j<N-1;j++){\n\t\t\thog=0;ug=-1;\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tif(ary[i+k/2][j+k%2]!=emb[k/2][k%2]){\n\t\t\t\t\thog++;\n\t\t\t\t\tug=k;\n\t\t\t\t}\n\t\t\t\tif(hog>=2) break;\n\t\t\t}\n\t\t\tif(hog==0){\n\t\t\t\tcnt++;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tfor(int l=0;l<3;l++){\n\t\t\t\t\t\tif(moj[l]!=ary[i+k/2][j+k%2])ary2[i+k/2][j+k%2][l]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(hog==1){\n\t\t\t\tswitch(emb[ug/2][ug%2]){\n\t\t\t\tcase J:\n\t\t\t\t\tary2[i+ug/2][j+ug%2][0]++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase O:\n\t\t\t\t\tary2[i+ug/2][j+ug%2][1]++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase I:\n\t\t\t\t\tary2[i+ug/2][j+ug%2][2]++;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tma=0;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tif(moj[k]!=ary[i][j]){\n\t\t\t\t\tma=max(ma,ary2[i][j][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcnt+=ma;\n\tcout<<cnt<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n\tint h, w; cin >> h >> w;\n\n\tfor (int i = 0; i < h; ++i) cin >> mp[i];\n\n\tfor (int i = 0; i < 2; ++i) cin >> e[i];\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tint sum2 = sum;\n\n\t\t\tchar tmp = mp[i][j];\n\n\t\t\tint cnt = 0;\n\n\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\tint y = i + dy[k], x = j + dx[k];\n\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsum2 -= cnt;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tmp[i][j] = a[k];\n\n\t\t\t\tint cnt2 = 0;\n\n\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\tint y = i + dy[l], x = j + dx[l];\n\t\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\t\tcnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcnt = max(cnt, cnt2);\n\t\t\t}\n\n\t\t\tsum2 += cnt;\n\n\t\t\tmp[i][j] = tmp;\n\n\t\t\tans = max(ans, sum2);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <cstring>\n#include <algorithm>\n\nusing std::max;\n\nint row, col;\nint flag[1002][1002];\nint mons[2][2];\n\nint node(char c)\n{\n\tif (c == 'J')return 0;\n\tif (c == 'O')return 1;\n\treturn 2;\n}\n\nint isap(int a,int b,int c,int d)\n{\n\treturn (a == mons[0][0] && b == mons[0][1] && c == mons[1][0] && d == mons[1][1]) ? 1 : 0;\n}\n#define isap_(fl,i,j) isap(fl[i][j],fl[i][j+1],fl[i+1][j],fl[i+1][j+1])\n\nint main(void)\n{\n\tscanf(\"%d %d\", &row, &col);\n\tmemset(flag, 0xFF, sizeof(flag));\n\tfor (int i = 1; i <= row; ++i)\n\t{\n\t\tchar tmp[1001]; scanf(\"%s\", tmp);\n\t\tfor (int j = 0; j < col; ++j)\n\t\t{\n\t\t\tflag[i][j+1] = node(tmp[j]);\n\t\t}\n\t}\n\tchar tmp[3];\n\tscanf(\"%s\", tmp);\n\tmons[0][0] = node(tmp[0]);\n\tmons[0][1] = node(tmp[1]);\n\tscanf(\"%s\", tmp);\n\tmons[1][0] = node(tmp[0]);\n\tmons[1][1] = node(tmp[1]);\n\tint answer = 0;\n\tfor (int i = 1; i < row; ++i)\n\t{\n\t\tfor (int j = 1; j < col; ++j)\n\t\t{\n\t\t\tif (isap_(flag,i,j))\n\t\t\t{\n\t\t\t\t++answer;\n\t\t\t}\n\t\t}\n\t}\n\tint maxrem = 0;\n\tfor (int i = 1; i <= row; ++i)\n\t{\n\t\tfor (int j = 1; j <= col; ++j)\n\t\t{\n\t\t\tif (i == 4 && j == 4)\n\t\t\t{\n\t\t\t\tint a = 3;\n\t\t\t}\n\t\t\tint rem = isap_(flag,i-1,j-1) + isap_(flag,i-1,j) + isap_(flag,i,j-1) + isap_(flag,i,j);\n\t\t\tint flij = flag[i][j];\n\t\t\tint maxr = 0;\n\t\t\tfor (int k = 0; k <= 2; ++k)\n\t\t\t{\n\t\t\t\tflag[i][j] = k;\n\t\t\t\tmaxr = max(maxr, isap_(flag, i - 1, j - 1) + isap_(flag, i - 1, j) + isap_(flag, i, j - 1) + isap_(flag, i, j));\n\t\t\t}\n\t\t\tflag[i][j] = flij;\n\t\t\tmaxrem = max(maxrem, maxr - rem);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",answer + maxrem);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar field[1010][1010];\nint score[1010][1010][4] = {0};//0 j 1 o 2 i\nint main()\n{\n    char E[2][2];\n    int x,y,cou = 0,ans = 0,mx,my;\n    int dx[] = {0,1,0,1},dy[] = {0,0,1,1};\n    scanf(\"%d%d\",&y,&x);\n    for(int i = 0; i < y; i++)\n    {\n        scanf(\" %c\",&field[0][i]);\n        for(int j = 1; j < x; j++)\n                scanf(\"%c\",&field[j][i]);\n    }\n    for(int i = 0; i < 2; i++)\n    {\n        scanf(\" %c\",&E[0][i]);\n        for(int j = 1; j < 2; j++)\n                scanf(\"%c\",&E[j][i]);\n    }\n    for(int i = 0; i < y ; i++)\n        for(int j = 0; j < x ; j++)\n        {\n            for(int k = 0; k < 4; k++)\n            {\n                if(field[j + dx[k]][i + dy[k]] == E[dx[k]][dy[k]])\n                        cou++;\n                else\n                {\n                    mx = j + dx[k];\n                    my = i + dy[k];\n                }\n            }\n            if(cou == 3)\n            {\n                if(E[mx - j][my - i] == 'J')score[mx][my][0]++;\n                else if(E[mx - j][my - i] == 'O')score[mx][my][1]++;\n                else score[mx][my][2]++;\n            }\n            else if(cou == 4)\n            {\n                ans++;\n            for(int k = 0; k < 4; k++)\n                score[j + dx[k]][i + dy[k]][3]--;\n            }\n            cou = 0;\n        }\n    for(int l = 0; l < 3; l++)\n        for(int i = 0; i < y; i++)\n            for(int j = 0; j < x; j++)\n            {\n                cou = max(cou,score[j][i][l] + score[j][i][3]);\n            }\n    printf(\"%d\\n\",ans + cou);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<queue>\n#include<map>\nusing namespace std;\ntypedef pair<int,int> P;\nmain(){\n  int n,m;\n  char masu[1001][1001];\n  char monsyou[3][3];\n  int before=0,after=0;\n  char joi[3]={'J','O','I'};\n  int ihu[4]={-1,-1,0,0};\n  int jhu[4]={-1,0,-1,0};\n  int imu[4]={-1,-1,0,0};\n  int jmu[4]={0,1,0,1};\n  int ihs[4]={0,0,1,1};\n  int jhs[4]={-1,0,-1,0};\n  int ims[4]={0,0,1,1};\n  int jms[4]={0,1,0,1};\n  queue<P> q;\n  cin>>n>>m;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin>>masu[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<n-1;i++){\n    for(int j=0;j<m-1;j++){\n      if(masu[i][j]==monsyou[0][0]&&masu[i][j+1]==monsyou[0][1]&&masu[i+1][j]==monsyou[1][0]&&masu[i+1][j+1]==monsyou[1][1]){\n\tbefore=before+1;\n\tP p;\n\tp.first=i;\n\tp.second=j;\n\tq.push(p);\n      }\n    }\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      char kioku;\n      kioku=masu[i][j];\n      for(int a=0;a<3;a++){\n\tint count=0;\n\tif(masu[i][j]!=joi[a]){\n\t  masu[i][j]=joi[a];\n\t  for(int k=0;k<4;k++){\n\t    if(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t      count=count+1;\n\t    }\n\t    else{\n\t      int size;\n\t      size=q.size();\n\t      for(int z=0;z<size;z++){\n\t\tP p;\n\t\tp=q.front();\n\t\tq.push(p);\n\t\tq.pop();\n\t\tif(i+ihu[k]==p.first&&j+jhu[k]==p.second){\n\t\t  count=count-1;\n\t\t}\n\t      }\n\t    }\n\t  }\n\t  masu[i][j]=kioku;\n\t}\n\tif(count>after){\n\t  after=count;\n\t}\n      }\t\n    }\n  }\n  cout<<before+after<<endl;\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nchar map[1001][1001];\nchar sign[2][2];\n\nint main(){\n\n\tint max = 0;\n\tint res = 0;\n\n\tint m, n;\n\tstd::cin >> m >> n;\n\n\tfor (int i = 0; i < m; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tstd::cin >> map[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tstd::cin >> sign[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < m - 1; i++){\n\t\tfor (int j = 0; j < n - 1; j++){\n\t\t\tbool flg = true;\n\t\t\tfor (int k = 0; k < 2; k++){\n\t\t\t\tfor (int l = 0; l < 2; l++){\n\t\t\t\t\tif (map[i + k][j + l] != sign[k][l])flg = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (flg)max++;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < m; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tint cnt = 0;\n\t\t\tint bnt = 0;\n\t\t\tchar bef = map[i][j];\n\t\t\tfor (int k = 0; k < 4; k++){\n\t\t\t\tif (k == 1)map[i][j] = 'J';\n\t\t\t\tif (k == 2)map[i][j] = 'O';\n\t\t\t\tif (k == 3)map[i][j] = 'I';\n\n\t\t\t\tint a = 0;\n\t\t\t\tfor (int l = -1; l < 1; l++){\n\t\t\t\t\tfor (int q = -1; q < 1; q++){\n\t\t\t\t\t\tif (i + l < 0 || i + l + 1 >= m)continue;\n\t\t\t\t\t\tif (j + q < 0 || j + q + 1 >= n)continue;\n\n\t\t\t\t\t\tbool flg = true;\n\t\t\t\t\t\tfor (int o = 0; o < 2; o++){\n\t\t\t\t\t\t\tfor (int p = 0; p < 2; p++){\n\t\t\t\t\t\t\t\tif (map[i + l + o][j + q + p] != sign[o][p])flg = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flg)a++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (k == 0)bnt = a;\n\t\t\t\telse cnt = std::max(cnt, a);\n\n\t\t\t\tmap[i][j] = bef;\n\t\t\t}\n\n\t\t\tres = std::max(res, max + (cnt - bnt));\n\t\t}\n\t}\n\n\tstd::cout << res << std::endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main()\n{\n\tint a, b;\n\tcin >>a>>b;\n\tchar a11, a12, a21, a22, x[a][b], y;\n\tint j=0;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\tcin >> x[k][l];\n\t\t}\n\t}\n\tcin >>a11>>a12>>a21>>a22;\n\tfor (int k=0; k<a-1; k++)\n\t{\n\t\tfor (int l=0; l<b-1; l++)\n\t\t{\n\t\t\tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t\tj+=1;\n\t\t}\n\t}\n\tint m, n, p;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\ty=x[k][l];\n\t\t\tm=0;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tm+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    m+=1;\n\t\t    n=0;\n\t\t\tx[k][l]=a11;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(m, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a12;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a21;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a22;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k+1][l+1]==a11 && x[k+1][l+2]==a12)&&(x[k+2][l+1]==a21 && x[k+2][l+2]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\t\t    \n\t       \tj+=p-m;\n\t       \tx[k][l]=y;\n\t\t}\n\t}\n\tcout <<j<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <utility>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <set>\n\n#define INF_LL 9000000000000000000\n#define INF 2000000000\n\n#define REP(i, n) for(int i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> PII;\ntypedef pair<int, PII> PPII;\ntypedef pair<int, PPII> PPPII;\n\nclass Union_find{\nprivate:\n\tvector<int> par;\n\tvector<int> rank;\n\tint n;\n\npublic:\n\tUnion_find(int a){\n\t\tn = a;\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tpar.push_back(i);\n\t\t\trank.push_back(0);\n\t\t}\n\t}\n\n\tint find(int x){\n\t\tif(par[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn par[x] = find(par[x]);\n\t\t}\n\t}\n\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y) return;\n\n\t\tif(rank[x] < rank[y]){\n\t\t\tpar[x] = y;\n\t\t}else{\n\t\t\tpar[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t}\n\t}\n\n\tbool same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n\nint main(void){\n\tint N, M;\n\tstring flag[2];\n\tstring base[1010];\n\tll res = 0;\n\n\tcin >> M >> N;\n\tREP(i, M){\n\t\tcin >> base[i];\n\t}\n\tREP(i, 2){\n\t\tcin >> flag[i];\n\t}\n\n\tREP(i, M-1){\n\t\tREP(j, N-1){\n\t\t\tbool ok = true;\n\t\t\tREP(a, 2){\n\t\t\t\tREP(b, 2){\n\t\t\t\t\tif(flag[a][b] != base[i+a][j+b]){\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ok)\n\t\t\t\tres++;\n\t\t}\n\t}\n\tint mp = 0;\n\tREP(i, M){\n\t\tREP(j, N){\n\t\t\tchar ch[] = {'J', 'O', 'I'};\n\t\t\tchar org = base[i][j];\n\t\t\tREP(k, 3){\n\t\t\t\tbase[i][j] = ch[k];\n\t\t\t\t\n\t\t\t\tint cnt = 0;\n\t\t\t\tFOR(a, max(i-1, 0), i+1){\n\t\t\t\t\tFOR(b, max(j-1, 0), j+1){\n\t\t\t\t\t\tbool ok = true;\n\t\t\t\t\t\tREP(c, 2){\n\t\t\t\t\t\t\tREP(d, 2){\n\t\t\t\t\t\t\t\tif(flag[c][d] != base[a+c][b+d]){\n\t\t\t\t\t\t\t\t\tok =false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ok) cnt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(mp < cnt && ch[k] != org)\n\t\t\t\t\tmp = cnt;\n\t\t\t\tbase[i][j] = org;\n\t\t\t}\n\t\t}\n\t}\n\tcout << res + mp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tios::sync_with_stdio(false), cin.tie(0);\n\tconst string s = \"JOI\";\n\tint M, N;\n\tcin >> M >> N;\n\tvector<string> S(M);\n\tfor (int i = 0; i < M; i++) {\n\t\tcin >> S[i];\n\t}\n\tvector<string> t(2);\n\tfor (int i = 0; i < 2; i++) {\n\t\tcin >> t[i];\n\t}\n\tint cnt = 0;\n\tfor (int i = 0; i + 2 <= M; i++) {\n\t\tfor (int j = 0; j + 2 <= N; j++) {\n\t\t\tbool ok = true;\n\t\t\tfor (int x = i; x < i + 2; x++) {\n\t\t\t\tfor (int y = j; y < j + 2; y++) {\n\t\t\t\t\tif (S[x][y] != t[x - i][y - j]) {\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt += ok;\n\t\t}\n\t}\n\tint add = 0;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tint aa = 0;\n\t\t\t\tfor (int x = max(0, i - 1); x <= min(i, M - 2); x++) {\n\t\t\t\t\tfor (int y = max(0, j - 1); y <= min(j, N - 2); y++) {\n\t\t\t\t\t\tbool ok = true;\n\t\t\t\t\t\tfor (int xx = x; xx < x + 2; xx++) {\n\t\t\t\t\t\t\tfor (int yy = y; yy < y + 2; yy++) {\n\t\t\t\t\t\t\t\tif (S[xx][yy] != t[xx - x][yy - y]) {\n\t\t\t\t\t\t\t\t\tok = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\taa -= ok;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tchar c = S[i][j];\n\t\t\t\tS[i][j] = s[k];\n\t\t\t\tfor (int x = max(0, i - 1); x <= min(i, M - 2); x++) {\n\t\t\t\t\tfor (int y = max(0, j - 1); y <= min(j, N - 2); y++) {\n\t\t\t\t\t\tbool ok = true;\n\t\t\t\t\t\tfor (int xx = x; xx < x + 2; xx++) {\n\t\t\t\t\t\t\tfor (int yy = y; yy < y + 2; yy++) {\n\t\t\t\t\t\t\t\tif (S[xx][yy] != t[xx - x][yy - y]) {\n\t\t\t\t\t\t\t\t\tok = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\taa += ok;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tS[i][j] = c;\n\t\t\t\tadd = max(add, aa);\n\t\t\t}\n\t\t}\n\t}\n\tcout << cnt + add << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include<bits/stdc++.h>\n\n#define int long long int\n#define rep(a,b,c) for(int a=b;a<c;a++)\n#define repm(a,b,c) for(int a=(b-1);a>=c;a--)\n#define pb push_back\n#define str string\n#define sf(a) scanfs(\"%d\",&a)\n#define pb push_back\n#define mp make_pair\n#define Fi first\n#define Se second\n#define ALL(v) (v).begin(), (v).end()\n\nusing namespace std;\n\nconst int INF = 1e18 + 9;\nconst int Mod = 1e9 + 7;\ninline int replac(str s){double ans=0;rep(i,0,s.length()){ans+=(s[i]-'0')*pow(10,s.length()-i-1);}return (int)ans;}\ninline string numstr(int m){str s=\"\";while(m>0){char c;int a=m/10;if(a>0)a=m%(a*10);else a=m;c=(char)('0'+a);s+=c;m/=10;}str st=\"\";for(int i=s.size()-1;i>=0;i--){st+=s[i];}return st;}\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\ntypedef vector<pii> vii;\nstring m[1001];\nstring mon[2];\nint memo[1001][1001][3];\nint w,h;\n/**\n    ???????????¨?????????4?????????????????????\n**/\nsigned main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w;\n    rep(i,0,h){\n        cin >> m[i];\n    }\n    rep(i,0,2){\n        cin >> mon[i];\n    }\n    vii no;\n    char ki;\n    int ans=0;\n    int dx[4]={0,1,1,0};\n    int dy[4]={1,1,0,0};\n    rep(i,0,h-1){\n        rep(j,0,w-1){\n            no.clear();\n            rep(k,0,4){\n                if(mon[dx[k]][dy[k]]!=m[i+dx[k]][j+dy[k]]){\n                    no.pb(mp(i+dx[k],j+dy[k]));\n                    ki=mon[dx[k]][dy[k]];\n                 //   cout << \"a\" << endl;\n                }\n            }\n            if(no.empty()){\n                rep(k,0,4){\n                    rep(o,0,3){\n                        memo[i+dx[k]][j+dy[k]][o]--;\n                    }\n                }\n                ans++;\n            }\n            if(no.size()==1){\n                int u=0;\n                if(ki=='O')u=1;\n                else if(ki=='I')u=2;\n                memo[no[0].first][no[0].second][u]++;\n            }\n        }\n    }\n    int a=0,ax=0,ay=0,ak=0;\n    rep(i,0,h){\n        rep(j,0,w){\n            rep(k,0,3)if(memo[i][j][k]>a){\n              //  cout << i << \" \" << j << \" \" << memo[i][j][k] << endl;\n                a=memo[i][j][k];\n                ax=i;ay=j;ak=k;\n            }\n        }\n    }\n    char kog='J';\n    if(a>0){\n        if(ak==1)kog='O';else if(ak==2)kog='I';\n        m[ax][ay]=kog;\n        //cout << m[ax][ay] << endl;\n    }\n    int ans2=0;\n    rep(i,0,h-1){\n        rep(j,0,w-1){\n            bool ansc=true;\n            rep(k,0,4){\n                if(mon[dx[k]][dy[k]]!=m[i+dx[k]][j+dy[k]]){\n\n                    ansc=false;\n                }\n                //if(i==1&&j==3)cout << m[i+dx[k]][j+dy[k]] << endl;\n            }\n            if(ansc){\n          //      cout << i << \" ans \" << j << endl;\n                ans2++;\n            }\n        }\n    }\n    cout << max(ans,ans2) << endl;\n    //cout << ans << \" \" << ans2 << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(),(c).end()\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\n#define mem(a) memset(a,0,sizeof(a))\n#define pb(a) push_back(a)\n#define in(a) insert(a)\n#define R cin>>\n#define F first\n#define S second\n#define C class\n#define ll long long\n#define ln cout<<'\\n'\n#define _(_1,_2,_3,N,...)N\n#define pr(...) _(__VA_ARGS__,pr3,pr2,pr1)(__VA_ARGS__)\ntemplate<C T>void pr1(T a){cout<<a;ln;}\ntemplate<C T,C T2>void pr2(T a,T2 b){cout<<a<<' '<<b;ln;}\ntemplate<C T,C T2,C T3>void pr3(T a,T2 b,T3 c){cout<<a<<' '<<b<<' '<<c;ln;}\ntemplate<C T>void PR(T a,int n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nbool check(int n,int m,int x,int y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<60,dx[4]={-1,-1,0,0},dy[4]={-1,0,-1,0};\ntypedef pair<int,int> P;\n\nint a[1001][1001];\nstring s[1001],t[2];\nchar c[3]={'J','O','I'};\n\nvoid Main() {\n  int n,m;\n  cin >> n >> m;\n  rep(i,n) R s[i];\n  rep(i,2) R t[i];\n  int cnt=0;\n  rep(i,n)rep(j,m)a[i][j]=1;\n  rep(i,n-1) {\n    rep(j,m-1) {\n      rep(ii,2) {\n        rep(jj,2) {\n          if(s[i+ii][j+jj]!=t[ii][jj]) a[i][j]=0;\n        }\n      }\n      cnt+=a[i][j];\n    }\n  }\n  int ans=cnt;\n  rep(i,n) {\n    rep(j,m) {\n      char ch=s[i][j];\n      rep(k,3) {\n        s[i][j]=c[k];\n        int sum=cnt;\n        rep(l,4) {\n          int x=i+dx[l],y=j+dy[l],c=1;\n          if(!check(n,m,x,y) || !check(n,m,x+1,y+1)) continue;\n          rep(ii,2) {\n            rep(jj,2) {\n              if(s[x+ii][y+jj]!=t[ii][jj]) c=0;\n            }\n          }\n          if(a[x][y] && !c) sum--;\n          if(!a[x][y] && c) sum++;\n        }\n        ans=max(ans,sum);\n      }\n      s[i][j]=ch;\n    }\n  }\n  pr(ans);\n}\n\nint main() {\n  ios::sync_with_stdio(0);cin.tie(0);Main();\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H);\n    for(int i = 0; i < H; ++i) cin >> G[i];\n    vector<string> F(2);\n    for(int i = 0; i < 2; ++i) cin >> F[i];\n\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<int> > B(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(B[i][j]) {\n          int T = S + B[i][j] - A[i][j];\n          if(i) T -= A[i-1][j];\n          if(j) T -= A[i][j-1];\n          if(i && j) T -= A[i-1][j-1];\n          res = max(res, T);\n        }\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nint match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y && crest_y >= 0; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x && crest_x >= 0; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst char c[] = {'J', 'O', 'I'};\n\nint main(void){\n  int H, W;\n  cin >> H >> W;\n  int cnt = 0;\n  vector< vector <char> > f(H, vector<char>(W));\n  vector< vector <char> > e(2, vector<char>(2));\n  for(int i=0; i < H; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++)\n      f[i][p] = tmp[p];\n  }\n\n  for(int i=0; i < 2; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++){\n      e[i][p] = tmp[p];\n    }\n  }\n\n  for(int p=0; p < H-1; p++){\n    for(int q=0; q < W-1; q++){\n      \n      bool flg = true;\n      for(int r=0; r < 2; r++){\n\tfor(int s=0; s < 2; s++){\n\t  if(f[p+r][q+s] == e[r][s]){\n\t  }else{\n\t    flg = false;\n\t  }\n\t}\n      }\n      if(flg){\n\tcnt++;\n      }\n\n    }\n  }\n\n  int ans = cnt;\n  for(int p=0; p < H; p++){\n    for(int q=0; q < W; q++){\n      //changeGrid\n      char moto = f[p][q];\n      int ccnt = cnt;\n      for(int z=0; z < 3; z++){\n\tif(c[z] == moto) continue;\n\tf[p][q] = c[z];\n\tif(p == H-1 && q == 0){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r-1][q+s] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\telse if(p == 0 && q == W-1){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r][q+s-1] == e[r][s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\t\n\telse if(p == 0 || q == 0){\n\t  if(p==0 && q==0){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r][q+s] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p==0 && q != 0){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else if(p == H-1 || q == W-1){\n\t  if(p==H-1 && q==W-1){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r-1][q+s-1] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p == H-1 && q != W-1){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r-1][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s-1] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else{\n\t  for(int m=-1; m <= 0; m++){\n\t    for(int n = -1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\t\n      }\n      ans = max(ans, ccnt);\n      f[p][q] = moto;\n    }\n  }\n  \n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<map>\n#include<queue>\n#include<cmath>\n\nusing namespace std;\n \ntemplate<typename T1, typename T2> istream& operator>>(istream& is, pair<T1,T2>& a){ return is >> a.first >> a.second; }\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& os, pair<T1,T2>& a){ return os << a.first << \" \" << a.second; }\ntemplate<typename T> istream& operator>>(istream& is, vector< T >& vc){ for(int i = 0; i < vc.size(); i++) is >> vc[i]; return is; }\ntemplate<typename T> ostream& operator<<(ostream& os, vector< T >& vc){ for(int i = 0; i < vc.size(); i++) os << vc[i] << endl; return os; }\n \n#define ForEach(it,c) for(__typeof (c).begin() it = (c).begin(); it != (c).end(); it++)\n#define ALL(v) (v).begin(), (v).end()\n#define UNQ(s) { sort(ALL(s)); (s).erase( unique( ALL(s)), (s).end());}\n\ntypedef pair< int, int > Pi;\ntypedef pair< bool , Pi > Pii;\ntypedef long long int int64;\n\nint main(){\n  int M, N;\n  string mas[1000], Find[2];\n  bool hori[1000][1000];\n  string temp = \"JOI\";\n\n  cin >> M >> N;\n  for(int i = 0; i < M; i++){\n    cin >> mas[i];\n  }\n  for(int i = 0; i < 2; i++){\n    cin >> Find[i];\n  }\n  \n  int base = 0, ret;\n  for(int i = 0; i <= M - 2; i++){\n    for(int j = 0; j <= N - 2; j++){\n      \n      bool flag = true;\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          flag &= Find[k][l] == mas[i + k][j + l];\n        }\n      }\n      base += hori[i][j] = flag;\n    }\n  }\n  ret = base;\n  for(int i = 0; i < M; i++){\n    for(int j = 0; j < N; j++){\n      for(int k = 0; k < 3; k++){\n        if(mas[i][j] == temp[k]) continue;\n        swap( mas[i][j], temp[k]);\n        int cnt = base;\n        for(int l = -(i != 0); l < (i + 1 < M); l++){\n          for(int m = -(j != 0); m < (j + 1 < N); m++){\n            bool flag = true;\n            for(int o = 0; o < 2; o++){\n              for(int p = 0; p < 2; p++){\n                flag &= mas[i + l + o][j + m + p] == Find[o][p];\n              }\n            }\n            cnt = cnt + flag - hori[i + l][j + m];\n          }\n        }\n        ret = max( cnt, ret);\n        swap( mas[i][j], temp[k]);\n      }\n    }\n  }\n  cout << ret << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <map>\n#include <algorithm>\n#include <set>\n#include <sstream>\n#include <numeric>\n#include <bitset>\n#include <complex>\n#include <iomanip>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cctype>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\nstatic const double EPS = 1e-8;\nstatic const double PI = 4.0 * atan(1.0);\nbool ISINT(double x){return fabs(x-(int)round(x))<EPS;}\nbool ISEQ(double x,double y){return fabs(x-y)<EPS;}\nstring itos(ll x){stringstream ss;ss<<x;return ss.str();}\n#define foreach(itr,c) for(__typeof(c.begin()) itr=c.begin();itr!=c.end();itr++)\n\nint h, w;\nstring t[1002], s[1002];\nbool match[1002][1002];\n\nbool matches(int sx, int sy){\n  for(int x = sx; x < sx + 2; x++){\n    for(int y = sy; y < sy + 2; y++){\n      if(t[y][x] != s[y - sy][x - sx]){\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nint main(void){\n  while(cin >> h >> w){\n    for(int i = 0; i < h; i++){\n      cin >> t[i];\n    }\n    for(int i = 0; i < 2; i++){\n      cin >> s[i];\n    }\n\n    memset(match, 0, sizeof(match));\n\n    int cnt = 0;\n\n    for(int i = 0; i < h - 1; i++){\n      for(int j = 0; j < w - 1; j++){\n        match[i][j] = matches(j, i);\n        cnt += (int)match[i][j];\n      }\n    }\n\n    int res = cnt;\n    string joi = \"JOI\";\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n        char tmp = t[i][j];\n\n        for(int k = 0; k < (int)joi.size(); k++){\n          if(t[i][j] == joi[k]) continue;\n          t[i][j] = joi[k];\n\n          int diff = 0;\n\n          for(int ti = i - 1; ti <= i; ti++){\n            for(int tj = j - 1; tj <= j; tj++){\n              if(ti < 0 || h - 1 <= ti) continue;\n              if(tj < 0 || w - 1 <= tj) continue;\n              if(match[ti][tj]){\n                diff--;\n              }\n              else if(matches(tj, ti)){\n                diff++;\n              }\n            }\n          }\n\n          res = max(res, cnt + diff);\n        }\n\n        t[i][j] = tmp;\n      }\n    }\n\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\n#include <cmath>\nusing namespace std;\n\nint M, N;\nchar field[1010][1010];\nchar emblem[2][2];\nint ex[1010][1010][3];\n\nint f(char c) {\n  if (c == 'J') return 0;\n  if (c == 'O') return 1;\n  if (c == 'I') return 2;\n  exit(1);\n}\n\nint main() {\n  cin >> M >> N;\n  for (int i=0; i<M; i++) {\n    for (int j=0; j<N; j++) {\n      cin >> field[i][j];\n    }\n  }\n  for (int i=0; i<2; i++) {\n    for (int j=0; j<2; j++) {\n      cin >> emblem[i][j];\n    }\n  }\n\n  int ans = 0;\n  for (int i=0; i<M-1; i++) {\n    for (int j=0; j<N-1; j++) {\n      int c = 0;\n      if (field[i  ][j  ] == emblem[0][0]) c++;\n      if (field[i+1][j  ] == emblem[1][0]) c++;\n      if (field[i  ][j+1] == emblem[0][1]) c++;\n      if (field[i+1][j+1] == emblem[1][1]) c++;\n      if (c == 4) ans++;\n      if (c == 3) {\n        if (field[i  ][j  ] != emblem[0][0]) ex[i  ][j  ][f(emblem[0][0])]++;\n        if (field[i+1][j  ] != emblem[1][0]) ex[i+1][j  ][f(emblem[1][0])]++;\n        if (field[i  ][j+1] != emblem[0][1]) ex[i  ][j+1][f(emblem[0][1])]++;\n        if (field[i+1][j+1] != emblem[1][1]) ex[i+1][j+1][f(emblem[1][1])]++;\n      }\n    }\n  }\n  int s = 0;\n  for (int i=0; i<M; i++) {\n    for (int j=0; j<N; j++) {\n      for (int k=0; k<3; k++) {\n        s = max(s, ex[i][j][k]);\n      }\n    }\n  }\n  cout << ans + s << \"\\n\";\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string>\nusing namespace std;\nint mp[3][1001][1001] = {};\nstring str[1001];\nstring joi[3];\nint co=0;\n\nvoid che(int a,int b){\n  int f=0;\n  int x,y,x2,y2;\n  for(int i=0;i<2;i++)\n    for(int j=0;j<2;j++)\n      if(str[i+a][j+b]!=joi[i][j]){f++;x=j+b;y=i+a;x2=j;y2=i;}\n  \n  if(f==0){\n    co++;\n    for(int i=0;i<2;i++)\n      for(int j=0;j<2;j++)\n\tfor(int k=0;k<3;k++)\n\t  mp[k][i+a][j+b]--;\n  }\n  else if(f==1){\n    if(joi[y2][x2]=='J') mp[0][y][x]++;\n    else if(joi[y2][x2]=='O') mp[1][y][x]++;\n    else if(joi[y2][x2]=='I') mp[2][y][x]++;\n  }\n}\n\n\nint main(){\n  int m,n;\n  cin>>m>>n;\n\n  for(int i=0;i<m;i++) cin>>str[i];\n  for(int i=0;i<2;i++) cin>>joi[i];\n\n  for(int i=0;i<m-1;i++)\n    for(int j=0;j<n-1;j++)\n      che(i,j);\n\n  int mpmax=0;\n  for(int i=0;i<m;i++)\n    for(int j=0;j<n;j++)\n      for(int k=0;k<3;k++)\n\tif(mpmax<mp[k][i][j]) \n\t  mpmax = mp[k][i][j];\n\n  cout <<co+mpmax<<endl;  \n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1010][1010];\nchar crest[8][8];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    int res = 0;\n    for(int y = 0; y < H; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n    int base = res;\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = base - (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1));\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1111][1111];\nbool a[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      // haku[i][j]=mas[i][j];\n    \n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  int a_cnt=0;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(mas[i+k][j+l]==key[k][l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4) a_cnt++;\n    }\n  }\n \n  int dx[]={-1,-1,0,0};\n  int dy[]={-1,0,-1,0};\n  char joi[]={'J','O','I'};\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      char tmp=mas[i][j];\n      for(int mozi=0;mozi<3;mozi++){\n\tif(mas[i][j]==joi[mozi]) continue;\n\tmas[i][j]=joi[mozi];\n\tfor(int k=0;k<4;k++){\n\t  int nx=i+dx[k];\n\t  int ny=j+dy[k];\n\t  if(0<=nx && nx<M-1 && 0<=ny && ny<N-1){\n\t    cnt=0;\n\t    \n\t    for(int m=0;m<2;m++){\n\t      for(int l=0;l<2;l++){\n\t\tif(mas[nx+m][ny+l]==key[m][l]){\n\t\t  cnt++;\n\t\t}\n\t      }\n\t    }\n\t    if(cnt==4) a_cnt++;\n\t  }\n\t}\n\tans=max(ans,a_cnt);\n      }\n    }\n  }\n  cout<<ans<<endl;\n  return 0;\n}\n\t\t"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint mm[1001][1001][3];\nint main(){\n    int m,n;\n    string flag[1000],emb[2];\n    cin>>m>>n;\n    int ans=0;\n    for(int i=0;i<m;++i) cin>>flag[i];\n    for(int i=0;i<2;++i) cin>>emb[i];\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            int cnt=0,mx,my;\n            for(int k=0;k<2;++k){\n                for(int l=0;l<2;++l){\n                    if(flag[i+k][j+l]==emb[k][l]) ++cnt;\n                    else{mx=l;my=k;}\n                }\n            }\n            if(cnt==4) ++ans;\n            else if(cnt==3){\n                if(emb[my][mx]=='J') ++mm[i+my][j+mx][0];\n                else if(emb[my][mx]=='O') ++mm[i+my][j+mx][1];\n                else ++mm[i+my][j+mx][2];\n            }\n        }\n    }\n    int w=0;\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            for(int k=0;k<3;++k) w=max(w,mm[i][j][k]);\n        }\n    }\n    cout<<ans+w<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nchar stage[1000][1000],emblem[2][2];\nint latte[1000][1000],ans,mx;\n\nvoid JOI_cmp(int y,int x){\n    int cy,cx,cnt=0;\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            if(stage[y+i][x+j]!=emblem[i][j]){\n                cnt++;\n                cy=y+i; cx=x+j;\n                if(cnt>1) break;\n            }\n        }\n    }\n    if(cnt==0){\n        ans++;\n    }\n    if(cnt==1){\n        latte[cy][cx]++;\n        mx=max(mx,latte[cy][cx]);\n    }\n    return;\n}\n\nint main(){\n    int M,N;\n    cin>>M>>N;\n    for(int i=0;i<M;i++){\n        for(int j=0;j<N;j++){\n            cin>>stage[i][j];\n        }\n    }\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            cin>>emblem[i][j];\n        }\n    }\n    for(int i=0;i<M-1;i++){\n        for(int j=0;j<N-1;j++){\n            JOI_cmp(i,j);\n        }\n    }\n    printf(\"%d\\n\",ans+mx);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1001][1001];\nchar haku[1001][1001];\nbool a[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  char mozi;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  memset(mas,0,sizeof(mas));\n  memset(haku,0,sizeof(haku));\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      haku[i][j]=mas[i][j];\n      a[i][j]=false;\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n    for(int l=0;l<2;l++){\n      if(key[k][l]==mas[i+k][j+l]){\n        cnt++;\n      }\n    }\n      }\n      if(cnt==4){\n    ans++;\n      }else if(cnt==3){\n    a[i][j]=true;\n      }\n    }\n  }\n  int cnnt=-111;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      if(a[i][j]){\n    int x,y;\n    for(int k=0;k<2;k++){\n      for(int l=0;l<2;l++){\n        if(mas[i+k][j+l]!=key[k][l]){\n          haku[i+k][j+l]=key[k][l];\n          x=i+k;\n          y=j+l;\n        }\n      }\n    }\n    cnt++;\n    int mozicnt=0;\n    if(i-1>=0 && j-1>=0){\n      for(int k=0;k<2;k++){\n        for(int l=0;l<2;l++){\n          if(haku[i-1+k][j-1+l]==key[k][l]){\n        mozicnt++;\n          }\n        }\n      }\n      if(mozicnt==4){\n        cnt++;\n      }\n      //mozicnt=0;\n    }\n    mozicnt=0;\n    if(j-1>=0){\n      for(int k=0;k<2;k++){\n        for(int l=0;l<2;l++){\n          if(haku[i+k][j-1+l]==key[k][l]){\n        mozicnt++;\n          }\n        }\n      }\n      if(mozicnt==4){\n        cnt++;\n      }\n      mozicnt=0;\n    }\n    mozicnt=0;\n    if(i-1>=0){\n      for(int k=0;k<2;k++){\n        for(int l=0;l<2;l++){\n          if(haku[i-1+k][j+l]==key[k][l]){\n        mozicnt++;\n          }\n        }\n      }\n      if(mozicnt==4){\n        cnt++;\n      }\n    }\n    haku[x][y]=mas[x][y];\n      }\n      cnnt=max(cnnt,cnt);\n    }\n  }\n  ans+=cnnt;\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <functional> //sort(A,A.end(),greater<int>());???????????????\n#include <queue>\n#include <stack>\n#include <vector>\n\n#define INF 10 << 10\n\nint n, m;\nchar flag[1002][1002];\nchar coa[3][3]; //?´???? Coat of arms\nint over[1002][1002]; // ?????????\n\nbool check(char y0x0, char y0x1, char y1x0, char y1x1) {\n\tif (y0x0 == coa[0][0]) {\n\t\tif (y0x1 != coa[0][1]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x0 != coa[1][0]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x1 != coa[1][1]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvoid Over(int y, int x) {\n\tfor (int i = y - 1; i < y + 1; ++i) {\n\t\tfor (int i2 = x - 1; i2 < x + 1; ++i2) {\n\t\t\t++over[i][i2];\n\t\t}\n\t}\n}\n\nint main() {\n\tmemset(over, 0, sizeof(over));\n\tmemset(flag, '0', sizeof(flag));\n\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tcin >> flag[i][i2];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int i2 = 0; i2 < 2; ++i2) {\n\t\t\tcin >> coa[i][i2];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\t//???????????§?????¢?´¢\n\tfor (int i = 1; i <= m - 1; ++i) {\n\t\tfor (int i2 = 1; i2 <= n - 1; ++i2) {\n\t\t\tif (check(flag[i][i2], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t++cnt;\n\t\t\t\tOver(i, i2);\n\t\t\t}\n\t\t}\n\t}\n\n\t//???????????????J,O,I,????????´????????????\n\t//(i, i2)????????????(i - 1, i2 - 1)???(i + 1, i2 + 1)??????????????°??????\n\t//??????????¢????????????????\t\t???\t??????(i, i2)?????????????´??????¨???????????£??????????????????????????????????????°???\n\tint cnt_add = 0;\n\tchar JOI[] = { \"JOI\" };\n\tfor (int i = 1; i <= m; ++i) {\n\t\tfor (int i2 = 1; i2 <= n; ++i2) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tint add = 0;\n\t\t\t\tif (check(flag[i - 1][i2 - 1], flag[i - 1][i2], flag[i][i2 - 1], JOI[j])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i - 1][i2], flag[i - 1][i2 + 1], JOI[j], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i][i2 - 1], JOI[j], flag[i + 1][i2 - 1], flag[i + 1][i2])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(JOI[j], flag[i][i2 + 1], flag[i + 1][i2], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tcnt_add = max(cnt_add, add - over[i][i2]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << max(cnt, cnt + cnt_add) << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstring joi=\"JOI\";\nstring s[1000],f[2];\nint cnt[1000][1000];\nint main(){\n\tint m,n;\tcin>>m>>n;\n\tfor(int i=0;i<m;i++)\tcin>>s[i];\n\tfor(int i=0;i<2;i++)\tcin>>f[i];\n\tint tmp=0;\n\tfor(int i=1;i<m;i++){\n\t\tfor(int j=1;j<n;j++){\n\t\t\tif(s[i-1][j-1]==f[0][0]&&s[i-1][j]==f[0][1]&&s[i][j-1]==f[1][0]&&s[i][j]==f[1][1]){\n\t\t\t\ttmp++;\n\t\t\t\tcnt[i-1][j-1]++;\tcnt[i-1][j]++;\tcnt[i][j-1]++;\tcnt[i][j]++;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=tmp;\n\tfor(int i=0;i<m;i++){\n\t\tfor(int j=0;j<n;j++){\n\t\t\tfor(int k=0;k<3;k++){//s[i][j]をjoi[k]にした時\n\t\t\t\tint count=0;\n\t\t\t\tfor(int a=-1;a<1;a++){\n\t\t\t\t\tfor(int b=-1;b<1;b++){//左上がs[i+a][j+b]の正方形を考える\n\t\t\t\t\t\tint r=i+a,c=j+b;\n\t\t\t\t\t\tif(r<0||c<0)\tcontinue;\n\t\t\t\t\t\tif(r+1>=m||c+1>=n)\tcontinue;\n\t\t\t\t\t\tstring ts[]={\"  \",\"  \"};\n\t\t\t\t\t\tfor(int y=0;y<2;y++){\n\t\t\t\t\t\t\tfor(int x=0;x<2;x++){\n\t\t\t\t\t\t\t\tif(r+y==i&&c+x==j)\tts[y][x]=joi[k];\n\t\t\t\t\t\t\t\telse \tts[y][x]=s[r+y][c+x];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ts[0]==f[0]&&ts[1]==f[1])\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans=max(ans,tmp-cnt[i][j]+count);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint C[128];\n\nint main() {\n  C['J'] = 0;\n  C['O'] = 1;\n  C['I'] = 2;\n  for(int H, W; cin >> H >> W;) {\n    vector<vector<int> > G(H);\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        char c; cin >> c;\n        G[i].push_back(C[(int)c]);\n      }\n    }\n    vector<vector<int> > F(2);\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        char c; cin >> c;\n        F[i].push_back(C[(int)c]);\n      }\n    }\n\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<vector<int> > > B(H, vector<vector<int> >(W, vector<int>(3, 0)));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj, pc;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n              pc.push_back(F[a][b]);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]][pc[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        for(int k = 0; k < 3; ++k) {\n          int T = S + B[i][j][k] - A[i][j];\n          if(i) T -= A[i-1][j];\n          if(j) T -= A[i][j-1];\n          if(i && j) T -= A[i-1][j-1];\n          res = max(res, T);\n        }\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H, string(W, ' '));\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        cin >> G[i][j];\n      }\n    }\n    vector<string> F(2, string(2, ' '));\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        cin >> F[i][j];\n      }\n    }\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<int> > B(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        int T = S + B[i][j];\n        if(i) T -= A[i-1][j];\n        if(j) T -= A[i][j-1];\n        if(i && j) T -= A[i-1][j-1];\n        res = max(res, T);\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H, string(W, ' '));\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        cin >> G[i][j];\n      }\n    }\n    vector<string> F(2, string(2, ' '));\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        cin >> F[i][j];\n      }\n    }\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<int> > B(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        int T = S + B[i][j];\n        if(i) T -= A[i-1][j];\n        if(j) T -= A[i][j-1];\n        if(i && j) T -= A[i-1][j-1];\n        res = max(res, T);\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m;\nstring g[1000];\nstring h[2];\n\nint check(int r, int c)\n{\n\tif (r < 0 || n <= r + 1) return 0;\n\tif (c < 0 || m <= c + 1) return 0;\n\treturn g[r][c] == h[0][0]\n\t\t&& g[r + 1][c] == h[1][0]\n\t\t&& g[r][c + 1] == h[0][1]\n\t\t&& g[r + 1][c + 1] == h[1][1];\n}\n\nint main()\n{\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++){\n\t\tcin >> g[i];\n\t}\n\tcin >> h[0] >> h[1];\n\n\tint c = 0;\n\tfor (int i = 0; i < n - 1; i++){\n\t\tfor (int j = 0; j < m - 1; j++){\n\t\t\tc += check(i, j);\n\t\t}\n\t}\n\t\n\tint res = c;\n\tfor (int i = 0; i < n; i++){\n\t\tfor (int j = 0; j < m; j++){\n\t\t\tfor (int k = 0; k < 3; k++){\n\t\t\t\tint t = c;\n\t\t\t\tchar ct = g[i][j];\n\t\t\t\tfor (int dx = -1; dx < 1; dx++){\n\t\t\t\t\tfor (int dy = -1; dy < 1; dy++){\n\t\t\t\t\t\tt -= check(i + dx, j + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tg[i][j] = \"JOI\"[k];\n\t\t\t\tfor (int dx = -1; dx < 1; dx++){\n\t\t\t\t\tfor (int dy = -1; dy < 1; dy++){\n\t\t\t\t\t\tt += check(i + dx, j + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tres = max(res, t);\n\t\t\t\tg[i][j] = ct;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring c[1002];\nint ruisekiwa[1000][1000];\nint main() {\n\tint a, b;\n\tcin >> a >> b;\n\tfor (int d = 0; d<a; d++) {\n\t\tcin >> c[d];\n\t}\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g<a - 1; g++) {\n\t\tfor (int h = 0; h<b - 1; h++) {\n\t\t\tbool s[2][2]{}; int l = 0;\n\t\t\tfor (int i = 0; i<2; i++) {\n\t\t\t\tfor (int j = 0; j<2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) { l++; s[i][j] = true; }\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\truisekiwa[g + x][h + y]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\tif (!s[x][y])ruisekiwa[g + x][h + y]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i<a; i++) {\n\t\tfor (int p = 0; p<a; p++) {\n\t\t\tMAX = max(MAX, ruisekiwa[i][p]);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define PB push_back\n#define MP make_pair\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define ALL(a) (a).begin(),(a).end()\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef long long ll;\nconst int INF=1e9;\nchar fld[1010][1010];\nchar flg[2][2];\nstring tmp=\"JOI\";\nint m,n;\nbool ok(int x,int y){\n  if(x<0||y<0||x+1>=n||y+1>=m)return false;\n  REP(i,2)REP(j,2)if(fld[x+j][y+i]!=flg[j][i])return false;\n  return true;\n}\nint rec(int x,int y){\n  int res=0;\n  for(int dx=-1;dx<=0;dx++){\n    for(int dy=-1;dy<=0;dy++){\n      if(ok(x+dx,y+dy))res++;\n    }\n  }\n  return res;\n}\nint main(){\n  cin>>m>>n;\n  REP(i,m)REP(j,n)cin>>fld[j][i];\n  REP(i,2)REP(j,2)cin>>flg[j][i];\n  int pre=0;\n  REP(i,m-1)REP(j,n-1){\n    bool f=true;\n    REP(x,2)REP(y,2){\n      if(fld[j+x][i+y]!=flg[x][y])f=false;\n    }\n    if(f)pre++;\n  }\n  int ans=0;\n  REP(i,m)REP(j,n){\n    int cnt=rec(j,i);\n    char t=fld[j][i];\n    REP(k,3){\n      fld[j][i]=tmp[k];\n      ans=max(ans,pre-cnt+rec(j,i));\n    }\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main()\n{\n\tint a, b;\n\tcin >>a>>b;\n\tchar a11, a12, a21, a22, x[a][b], y;\n\tint j=0;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\tcin >> x[k][l];\n\t\t}\n\t}\n\tcin >>a11>>a12>>a21>>a22;\n\tfor (int k=0; k<a-1; k++)\n\t{\n\t\tfor (int l=0; l<b-1; l++)\n\t\t{\n\t\t\tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t\tj+=1;\n\t\t}\n\t}\n\t\n\tint m;\n\tfor (int k=0; k<a; k++)\n\t{for (int l=0; l<b; l++)\n\t{\n\t\ty=x[k][l];\n\t\tx[k][l]=a11;\n\t\tm=0;\n\t    for (int k=0; k<a-1; k++)\n\t       {\n\t        for (int l=0; l<b-1; l++)\n\t        {\n\t\t        if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t        \n\t\t        m+=1;\n\t        }\n\t       }\n\t       j=max(j, m);\n\t       x[k][l]=y;\n\t}}\n\tfor (int k=0; k<a; k++)\n\t{for (int l=0; l<b; l++)\n\t{\n\t\ty=x[k][l];\n\t\tx[k][l]=a12;\n\t\tm=0;\n\t    for (int k=0; k<a-1; k++)\n\t       {\n\t        for (int l=0; l<b-1; l++)\n\t        {\n\t\t        if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t       \n\t\t        m+=1;\n\t        }\n\t       }\n\t       j=max(j, m);\n\t       x[k][l]=y;\n\t}}\n\tfor (int k=0; k<a; k++)\n\t{for (int l=0; l<b; l++)\n\t{\n\t\ty=x[k][l];\n\t\tx[k][l]=a21;\n\t\tm=0;\n\t    for (int k=0; k<a-1; k++)\n\t       {\n\t        for (int l=0; l<b-1; l++)\n\t        {\n\t\t        if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t        \n\t\t        m+=1;\n\t        }\n\t       }\n\t       j=max(j, m);\n\t       x[k][l]=y;\n\t}}\n\tfor (int k=0; k<a; k++)\n\t{for (int l=0; l<b; l++)\n\t{\n\t\ty=x[k][l];\n\t\tx[k][l]=a22;\n\t\tm=0;\n\t    for (int k=0; k<a-1; k++)\n\t       {\n\t        for (int l=0; l<b-1; l++)\n\t        {\n\t\t        if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t        \n\t\t        m+=1;\n\t        }\n\t       }\n\t       j=max(j, m);\n\t       x[k][l]=y;\n\t}}\n\tcout <<j<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long int;\nusing P = pair<int, int>;\nusing P3 = pair<int,P>;\nusing PP = pair<P, P>;\nconstexpr int INF = 1<<30;\nconstexpr ll MOD = ll(1e9)+7;\nconstexpr int di[] = {0,1,0,-1};\nconstexpr int dj[] = {1,0,-1,0};\n\n\nbool solve(){\n    int m, n;\n    cin >> m >> n;\n    vector<string> s(m), t(2);\n    for(int i=0;i<m;i++){\n        cin >> s[i];\n    }\n    for(int i=0;i<2;i++){\n        cin >> t[i];\n    }\n    int ans = 0, cnt = 0;\n    for(int i=0;i<m-1;i++){\n        for(int j=0;j<n-1;j++){\n            bool ok = true;\n            for(int k=0;k<4;k++){\n                ok &= s[i+k/2][j+k%2] == t[k/2][k%2];\n            }\n            if(ok) cnt++;\n        }\n    }\n    char c[4] = {' ', 'J','O', 'I'};\n    for(int i=0;i<m;i++){\n        for(int j=0;j<n;j++){\n            char tmp = s[i][j];\n            int d0 = 0;\n            c[0] = tmp;\n            for(int x=0;x<4;x++){\n                int diff = 0;\n                bool ok = true;\n                s[i][j] = c[x];\n                if(i<m-1 && j<n-1){\n                    for(int k=0;k<4;k++){\n                        ok &= s[i+k/2][j+k%2] == t[k/2][k%2];\n                    }\n                    if(ok) diff++;\n                }\n                if(i<m-1 && j>0){\n                    ok = true;\n                    for(int k=0;k<4;k++){\n                        ok &= s[i+k/2][j-1+k%2] == t[k/2][k%2];\n                    }\n                    if(ok) diff++;\n                }\n                if(i>0 && j<n-1){\n                    ok = true;\n                    for(int k=0;k<4;k++){\n                        ok &= s[i-1+k/2][j+k%2] == t[k/2][k%2];\n                    }\n                    if(ok) diff++;\n                }\n                if(i>0 && j>0){\n                    ok = true;\n                    for(int k=0;k<4;k++){\n                        ok &= s[i-1+k/2][j-1+k%2] == t[k/2][k%2];\n                    }\n                    if(ok) diff++;\n                }\n                if(x == 0) d0 = diff;\n                ans = max(ans, cnt-d0+diff);\n            }\n            s[i][j] = tmp;\n        }\n    }\n    cout << ans << endl;\n    return true;\n}\n\nint main(){\n    solve();\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n\nconstexpr int MAX = 1000;\n\nint h, w;\nint board[MAX][MAX];//j:0,o:1,i:2\nbool res[MAX - 1][MAX - 1];\nint target[2][2];\n\nbool check(int x, int y) {\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tif (board[i + y][j + x] != target[i][j])\n\t\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint dx[] = { -1,-1,0,0 }, dy[] = { -1,0,0,-1 };\n\nint solve() {\n\tint ans = 0;\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (check(j, i)) {\n\t\t\t\t++ans;\n\t\t\t\tres[i][j] = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tint r = 0, cnt = 0;\n\n\tfor (int change = 0; change < 3; ++change) {\n\t\tfor (int i = 0; i < h; ++i) {\n\t\t\tfor (int j = 0; j < w; ++j) {\n\t\t\t\tint nx, ny, a = board[i][j];\n\t\t\t\tboard[i][j] = change;\n\t\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\t\tnx = j + dx[k];\n\t\t\t\t\tny = i + dy[k];\n\t\t\t\t\tif (0 <= nx&&nx < w - 1 &&\n\t\t\t\t\t\t0 <= ny&&ny < h - 1) {\n\t\t\t\t\t\tif (check(nx, ny)) {\n\t\t\t\t\t\t\tif (!res[ny][nx])\n\t\t\t\t\t\t\t\t++cnt;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (res[ny][nx])\n\t\t\t\t\t\t\t--cnt;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tr = std::max(r, cnt);\n\t\t\t\tcnt = 0;\n\t\t\t\tboard[i][j] = a;\n\t\t\t}\n\t\t}\n\t}\n\tans += r;\n\treturn ans;\n}\n\nint main() {\n\tstd::cin >> h >> w;\n\tchar ch;\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tstd::cin >> ch;\n\t\t\tswitch (ch) {\n\t\t\tcase 'O':\n\t\t\t\tboard[i][j] = 1; break;\n\t\t\tcase 'I':\n\t\t\t\tboard[i][j] = 2; break;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tstd::cin >> ch;\n\t\t\tswitch (ch) {\n\t\t\tcase 'O':\n\t\t\t\ttarget[i][j] = 1; break;\n\t\t\tcase 'I':\n\t\t\t\ttarget[i][j] = 2; break;\n\t\t\t}\n\t\t}\n\t}\n\tstd::cout << solve() << std::endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H, string(W, ' '));\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        cin >> G[i][j];\n      }\n    }\n    vector<string> F(2, string(2, ' '));\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        cin >> F[i][j];\n      }\n    }\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.size() == 1) {\n          int T = S + 1;\n          if(i) T -= A[i-1][j];\n          if(j) T -= A[i][j-1];\n          if(i && j) T -= A[i-1][j-1];\n          res = max(res, T);\n        }\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n// Begin {{{\nusing namespace std;\n\n#ifndef DEBUG\n#define dump(...)\n#endif\n\ntemplate <class A, class B> inline bool chmax(A &a, const B &b) { return b > a && (a = b, true); }\ntemplate <class A, class B> inline bool chmin(A &a, const B &b) { return b < a && (a = b, true); }\n\ntemplate <class T>\ninline vector<T> make_v(const T &initvalue, size_t sz) {\n    return vector<T>(sz, initvalue);\n}\n\ntemplate <class T, class... Args>\ninline auto make_v(const T &initvalue, size_t sz, Args... args) {\n    return vector<decltype(make_v<T>(initvalue, args...))>(sz, make_v<T>(initvalue, args...));\n}\n\nconstexpr int INF = 0x3f3f3f3f;\nconstexpr int64_t LINF = 0x3f3f3f3f3f3f3f3fLL;\n\nconstexpr size_t    operator\"\"_sz(unsigned long long value) { return value; };\nconstexpr intmax_t  operator\"\"_im(unsigned long long value) { return value; };\nconstexpr uintmax_t operator\"\"_um(unsigned long long value) { return value; };\n// }}} End\n\nsigned main() {\n    ios_base::sync_with_stdio(false);\n    cin.tie(nullptr);\n\n    size_t H, W;\n    cin >> H >> W;\n\n    auto mat = make_v(' ', H + 2, W + 2);\n    for (size_t i = 1; i <= H; ++i) {\n        for (size_t j = 1; j <= W; ++j) {\n            cin >> mat[i][j];\n        }\n    }\n\n    vector<string> symbol(2);\n    cin >> symbol[0] >> symbol[1];\n\n    auto f = [&](size_t y, size_t x) -> bool {\n        for (size_t i = 0; i < 2; ++i) {\n            for (size_t j = 0; j < 2; ++j) {\n                if (mat[y + i][x + j] != symbol[i][j]) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n\n    int64_t base = 0;\n    for (size_t i = 1; i <= H; ++i) {\n        for (size_t j = 1; j <= W; ++j) {\n            if (f(i, j)) {\n                base++;\n            }\n        }\n    }\n\n    string joi = \"JOI\";\n    int64_t add = 0;\n    for (size_t i = 1; i <= H; ++i) {\n        for (size_t j = 1; j <= W; ++j) {\n\n            char c = mat[i][j];\n\n            int cnt = 0;\n            const int dy[] = {0, -1, -1, 0};\n            const int dx[] = {0, 0, -1, -1};\n            for (size_t k = 0; k < 4; ++k) {\n                if (f(i + dy[k], j + dx[k])) {\n                    cnt++;\n                }\n            }\n\n            for (size_t k = 0; k < 3; ++k) {\n                mat[i][j] = joi[k];\n                int changed_cnt = 0;\n                for (size_t l = 0; l < 4; ++l) {\n                    if (f(i + dy[l], j + dx[l])) {\n                        changed_cnt++;\n                    }\n                }\n\n                chmax(add, changed_cnt - cnt);\n            }\n\n            mat[i][j] = c;\n        }\n    }\n\n    cout << base + add << \"\\n\";\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=a;i<b;++i)\n\nint M, N;\nstring f[1010], p[2], JOI = \"JOI\";\n\nbool isok(int y, int x) {\n\tif (y < 0 || x < 0 || y > M - 1 || x > N - 1) return 0;\n\tfor_(i,0,2) for_(j,0,2) if (f[y+i][x+j] != p[i][j]) return 0;\n\treturn 1;\n}\n\nint center(int y, int x) {\n\tint res = 0;\n\tfor_(i,-1,1) for_(j,-1,1) if (isok(y+i,x+j)) ++res;\n\treturn res;\n}\n\nint main() {\n\tcin >> M >> N;\n\tfor_(i,0,M) cin >> f[i];\n\tfor_(i,0,2) cin >> p[i];\n\t\n\tint ini = 0;\n\tfor_(y,0,M) for_(x,0,N) if (isok(y,x)) ++ini;\n\t\n\tint ans = 0;\t\n\tfor_(y,0,M) for_(x,0,N) {\n\t\tint cur = center(y,x), nx = 0;\n\t\tchar ff = f[y][x];\n\t\t\n\t\tfor_(i,0,3) {\n\t\t\tf[y][x] = JOI[i];\n\t\t\tnx = max(nx, center(y,x));\n\t\t}\n\t\t\n\t\tf[y][x] = ff;\n\t\tans = max(ans, ini + nx - cur);\n\t}\n\t\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y; dy++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx = x - 2,dy = y - 2; dx <= x; dx++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          if(dp[y][x] == 0){\n            dp[y][x] = 1;\n          }\n        }\n        else{\n          dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n          dp[y][x] = max(dp[y][x],dp[y-1][x-1]);\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1005][1005],pat[5][5];\nint n,m;\nstring ch=\"JOI\";\n\nbool match(int x,int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>0 && ny>0)res+=match(nx,ny);\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      if(match(j,i))res+=1;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<n;i++){    \n     for(int j=0;j<m;j++){\n       char tmp=g[i][j];\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> n >> m;\n  \n  fill(g[0],g[1005],'.');\n  fill(pat[0],pat[5],'$');\n\n  for(int i=0;i<n;i++){\n    cin >> g[i];\n  }\n\n  for(int i=0;i<2;i++){\n    cin >> pat[i];\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <limits>\n#include <climits>\n#include <cfloat>\n#include <functional>\nusing namespace std;\n\nint h, w;\nvector<string> flag, pattern;\n\nbool check(int y, int x)\n{\n    if(y < 0 || y + 1 >= h || x < 0 || x + 1 >= w)\n        return false;\n\n    for(int i=0; i<4; ++i){\n        if(flag[y+i/2][x+i%2] != pattern[i/2][i%2])\n            return false;\n    }\n    return true;\n}\n\nint main()\n{\n    cin >> h >> w;\n    flag.resize(h);\n    pattern.resize(2);\n    for(int y=0; y<h; ++y)\n        cin >> flag[y];\n    for(int i=0; i<2; ++i)\n        cin >> pattern[i];\n\n    int cnt = 0;\n    for(int y=0; y<h; ++y){\n        for(int x=0; x<w; ++x){\n            if(check(y, x))\n                ++ cnt;\n        }\n    }\n\n    const string s = \"JOI\";\n    int ret = cnt;\n    for(int y=0; y<h; ++y){\n        for(int x=0; x<w; ++x){\n            int sub = 0;\n            for(int i=0; i<4; ++i){\n                if(check(y - i/2, x - i%2))\n                    ++ sub;\n            }\n\n            char c = flag[y][x];\n            for(int i=0; i<3; ++i){\n                flag[y][x] = s[i];\n                int add = 0;\n                for(int j=0; j<4; ++j){\n                    if(check(y - j/2, x - j%2))\n                        ++ add;\n                }\n                ret = max(ret, cnt - sub + add);\n            }\n            flag[y][x] = c;\n        }\n    }\n    cout << ret << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>    \n#include<cmath>\n#include<map>\n#include<vector>\n#include<math.h>\n#include<stdio.h>\n#include<stack>\n#include<queue>\n#include<tuple>\n#include<cassert>\n#include<set>\n#define int long long\nusing namespace std;\nconst int INF = 1000000000000;\nconst int mod = 1000000007;\nstring s[345678];\nsigned main() {\n\tint n, m, huu = 0, sum = 0, ans = 0; string a, b; cin >> n >> m;\n\tfor (int h = 0; h < n; h++) {\n\t\tcin >> s[h];\n\t}\n\tcin >> a >> b;\n\t//変えない\n\tfor (int h = 0; h < n - 1; h++) {\n\t\tfor (int i = 0; i < m - 1; i++) {\n\t\t\tif (s[h][i] == a[0] && s[h][i + 1] == a[1]) {\n\t\t\t\tif (s[h + 1][i] == b[0] && s[h + 1][i + 1] == b[1]) {\n\t\t\t\t\thuu++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tans = max(ans, huu);\n\t//変える\n\tfor (int x = 0; x < n; x++) {\n\t\tfor (int y = 0; y < m; y++) {\n\t\t\tchar z; sum = huu; z = 'J';\n\t\t\tfor (int h = x - 1; h <= x; h++) {\n\t\t\t\tfor (int i = y - 1; i <= y; i++) {\n\t\t\t\t\tif (0 <= h && h < n - 1 && 0 <= i && i < m - 1) {\n\t\t\t\t\t\tif (s[h][i] == a[0] && s[h][i + 1] == a[1]) {\n\t\t\t\t\t\t\tif (s[h + 1][i] == b[0] && s[h + 1][i + 1] == b[1]) {\n\t\t\t\t\t\t\t\tsum--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((h == x && i == y && z == a[0]) || ((h != x || i != y) && s[h][i] == a[0])) {\n\t\t\t\t\t\t\tif ((h == x && i + 1 == y && z == a[1]) || ((h != x || i + 1 != y) && s[h][i + 1] == a[1])) {\n\t\t\t\t\t\t\t\tif ((h + 1 == x && i == y && z == b[0]) || ((h + 1 != x || i != y) && s[h + 1][i] == b[0])) {\n\t\t\t\t\t\t\t\t\tif ((h + 1 == x && i + 1 == y && z == b[1]) || ((h + 1 != x || i + 1 != y) && s[h + 1][i + 1] == b[1])) {\n\t\t\t\t\t\t\t\t\t\tsum++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, sum); sum = huu; z = 'I';\n\t\t\tfor (int h = x - 1; h <= x; h++) {\n\t\t\t\tfor (int i = y - 1; i <= y; i++) {\n\t\t\t\t\tif (0 <= h && h < n - 1 && 0 <= i && i < m - 1) {\n\t\t\t\t\t\tif (s[h][i] == a[0] && s[h][i + 1] == a[1]) {\n\t\t\t\t\t\t\tif (s[h + 1][i] == b[0] && s[h + 1][i + 1] == b[1]) {\n\t\t\t\t\t\t\t\tsum--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((h == x && i == y && z == a[0]) || ((h != x || i != y) && s[h][i] == a[0])) {\n\t\t\t\t\t\t\tif ((h == x && i + 1 == y && z == a[1]) || ((h != x || i + 1 != y) && s[h][i + 1] == a[1])) {\n\t\t\t\t\t\t\t\tif ((h + 1 == x && i == y && z == b[0]) || ((h + 1 != x || i != y) && s[h + 1][i] == b[0])) {\n\t\t\t\t\t\t\t\t\tif ((h + 1 == x && i + 1 == y && z == b[1]) || ((h + 1 != x || i + 1 != y) && s[h + 1][i + 1] == b[1])) {\n\t\t\t\t\t\t\t\t\t\tsum++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, sum); sum = huu; z = 'O';\n\t\t\tfor (int h = x - 1; h <= x; h++) {\n\t\t\t\tfor (int i = y - 1; i <= y; i++) {\n\t\t\t\t\tif (0 <= h && h < n - 1 && 0 <= i && i < m - 1) {\n\t\t\t\t\t\tif (s[h][i] == a[0] && s[h][i + 1] == a[1]) {\n\t\t\t\t\t\t\tif (s[h + 1][i] == b[0] && s[h + 1][i + 1] == b[1]) {\n\t\t\t\t\t\t\t\tsum--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((h == x && i == y && z == a[0]) || ((h != x || i != y) && s[h][i] == a[0])) {\n\t\t\t\t\t\t\tif ((h == x && i + 1 == y && z == a[1]) || ((h != x || i + 1 != y) && s[h][i + 1] == a[1])) {\n\t\t\t\t\t\t\t\tif ((h + 1 == x && i == y && z == b[0]) || ((h + 1 != x || i != y) && s[h + 1][i] == b[0])) {\n\t\t\t\t\t\t\t\t\tif ((h + 1 == x && i + 1 == y && z == b[1]) || ((h + 1 != x || i + 1 != y) && s[h + 1][i + 1] == b[1])) {\n\t\t\t\t\t\t\t\t\t\tsum++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, sum);\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1001][1001];\nchar haku[1001][1001];\nbool a[1001][1001];\nbool deki[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  char mozi;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  memset(mas,0,sizeof(mas));\n  memset(haku,0,sizeof(haku));\n  memset(deki,0,sizeof(deki));\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      haku[i][j]=mas[i][j];\n      a[i][j]=false;\n      deki[i][j]=false;\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(key[k][l]==mas[i+k][j+l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4){\n\tans++;\n\tdeki[i][j]=true;\n\tdeki[i+1][j+1]=true;\n\tdeki[i+1][j]=true;\n\tdeki[i][j+1]=true;\n      }else if(cnt==3){\n\ta[i][j]=true;\n      }\n    }\n  }\n  int cnnt=-111;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      int f=0;\n      if(a[i][j]){\n\tint x,y;\n\tfor(int k=0;k<2;k++){\n\t  for(int l=0;l<2;l++){\n\t    if(mas[i+k][j+l]!=key[k][l] && !deki[i+k][j+l]){\n\t      haku[i+k][j+l]=key[k][l];\n\t      x=i+k;\n\t      y=j+l;\n\t    }else if(mas[i+k][j+l]!=key[k][l] && deki[i+k][j+l]){\n\t      f=1;\n\t    }\n\t  }\n\t}\n\tif(f==0){\n\t  cnt++;\n\t  int mozicnt=0;\n\t  if(i-1>=0 && j-1>=0){\n\t    for(int k=0;k<2;k++){\n\t      for(int l=0;l<2;l++){\n\t\tif(haku[i-1+k][j-1+l]==key[k][l] && !deki[i-1+k][j-1+l]){\n\t\t  mozicnt++;\n\t\t}\n\t      }\n\t    }\n\t    if(mozicnt==4){\n\t      cnt++;\n\t    }\n\n\t  }\n\t  mozicnt=0;\n\t  if(j-1>=0){\n\t    for(int k=0;k<2;k++){\n\t      for(int l=0;l<2;l++){\n\t\tif(haku[i+k][j-1+l]==key[k][l] && !deki[i+k][j-1+l]){\n\t\t  mozicnt++; \n\t\t}\n\t      }\n\t    }\n\t    if(mozicnt==4){\n\t      cnt++;\n\t    }\n\n\t  }\n\t  mozicnt=0;\n\t  if(i-1>=0){\n\t    for(int k=0;k<2;k++){\n\t      for(int l=0;l<2;l++){\n\t\tif(haku[i-1+k][j+l]==key[k][l]&& !deki[i-1+k][j+l]){\n\t\t  mozicnt++;\n\t\t}\n\t      }\n\t    }\n\t    if(mozicnt==4){\n\t      cnt++;\n\t    }\n\t  }\n\t  haku[x][y]=mas[x][y];\n\t}\n      }\n      cnnt=max(cnnt,cnt);\n    }\n  }\n  ans+=cnnt;\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <array>\n#include <list>\n#include <string>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <unordered_map>\n#include <unordered_set>\n#include <tuple>\n#include <memory>\n#include <cmath>\n#include <algorithm>\n#include <functional>\n#include <iomanip>\n#include <numeric>\n#include <climits>\n#include <cfloat>\n#include <cassert>\n#include <random>\n\nint count(const std::vector<std::string>& flag, const std::vector<std::string>& pattern, int i, int j) {\n\tif (i < 0) return 0;\n\tif (j < 0) return 0;\n\tif (i + 1 >= flag.size()) return 0;\n\tif (j + 1 >= flag[i].size()) return 0;\n\tfor (auto di = 0; di < 2; ++di) for (auto dj = 0; dj < 2; ++dj) if (flag[i + di][j + dj] != pattern[di][dj]) {\n\t\treturn 0;\n\t}\n\treturn 1;\n}\n\nint main() {\n\tint m, n; std::cin >> m >> n;\n\tstd::vector<std::string> flag(m), pattern(2); for (auto& line : flag) std::cin >> line;\n\tfor (auto& line : pattern) std::cin >> line;\n\tint initial_count = 0;\n\tfor (auto i = 0; i < m; ++i) for (auto j = 0; j < n; ++j) {\n\t\tinitial_count += count(flag, pattern, i, j);\n\t}\n\tint diff_max = 0;\n\tfor (auto i = 0; i < m; ++i) for (auto j = 0; j < n; ++j) {\n\t\tconst auto origin = flag[i][j];\n\t\tconst int origin_count = count(flag, pattern, i - 1, j - 1) + count(flag, pattern, i - 1, j) + count(flag, pattern, i, j - 1) + count(flag, pattern, i, j);\n\t\tfor (const auto changed : \"JOI\") {\n\t\t\tflag[i][j] = changed;\n\t\t\tconst int new_count = count(flag, pattern, i - 1, j - 1) + count(flag, pattern, i - 1, j) + count(flag, pattern, i, j - 1) + count(flag, pattern, i, j);\n\t\t\tdiff_max = std::max(diff_max, new_count - origin_count);\n\t\t}\n\t\tflag[i][j] = origin;\n\t}\n\tstd::cout << initial_count + diff_max << std::endl;\n}\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<string>\n#include<iostream>\n\nusing namespace std;\n\nint m,n;\n\nint fie[1001][1001];\nint flag[3][3];\nint ok[1001][1001];\n\nbool check(int x,int y){\n\tif(fie[x][y]!=flag[0][0])return false;\n\tif(fie[x+1][y]!=flag[1][0])return false;\n\tif(fie[x][y+1]!=flag[0][1])return false;\n\tif(fie[x+1][y+1]!=flag[1][1])return false;\n\treturn true;\n}\n\nint main(void){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<n;i++){\n\t\tstring s;\n\t\tcin >> s;\n\t\tfor(int j=0;j<m;j++){\n\t\t\tif(s[j]=='J')fie[j][i]=0;\n\t\t\tif(s[j]=='O')fie[j][i]=1;\n\t\t\tif(s[j]=='I')fie[j][i]=2;\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tstring s;\n\t\tcin >> s;\n\t\tfor(int j=0;j<2;j++){\n\t\t\tif(s[j]=='J')flag[j][i]=0;\n\t\t\tif(s[j]=='O')flag[j][i]=1;\n\t\t\tif(s[j]=='I')flag[j][i]=2;\n\t\t}\n\t}\n\tint cnt=0;\n\tfor(int i=0;i<n-1;i++){\n\t\tfor(int j=0;j<m-1;j++){\n\t\t\tif(check(j,i))cnt++,ok[j][i]=1;\n\t\t}\n\t}\n\t\n\tint res=0;\n\tfor(int i=0;i<n;i++){\n\t\tfor(int j=0;j<m;j++){\n\t\t\tint prev=fie[j][i];\n\t\t\tfor(int k=0;k<=2;k++){\n\t\t\t\tint plus=0;\n\t\t\t\tfie[j][i]=k;\n\t\t\t\tfor(int y=-1;y<=1;y++){\n\t\t\t\t\tfor(int x=-1;x<=1;x++){\n\t\t\t\t\t\tif(j+x>=0 && j+x<m && y+i>=0 && y+i<n){\n\t\t\t\t\t\t\tplus-=ok[j+x][i+y];\n\t\t\t\t\t\t\tif(check(j+x,i+y))plus++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tres=max(res,plus);\n\t\t\t}\n\t\t\tfie[j][i]=prev;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",res+cnt);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nchar stage[1000][1000],emblem[2][2];\nint latte[1000][1000][3],ans,mx;\n\nvoid JOI_cmp(int y,int x){\n    int cy,cx,cnt=0;\n    char cc;\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            if(stage[y+i][x+j]!=emblem[i][j]){\n                cnt++;\n                cy=y+i; cx=x+j; cc=emblem[i][j];\n                if(cc=='J') cc=0;\n                else if(cc=='O') cc=1;\n                else cc=2;\n                if(cnt>1) break;\n            }\n        }\n    }\n    if(cnt==0){\n        ans++;\n        for(int i=0;i<2;i++){\n            for(int j=0;j<2;j++){\n                for(int k=0;k<3;k++){\n                    latte[y+i][x+j][k]--;\n                }\n            }\n        }\n    }\n    if(cnt==1){\n        //printf(\" %d,%d\\n\",y,x);\n        latte[cy][cx][cc]++;\n        mx=max(mx,latte[cy][cx][cc]);\n    }\n    return;\n}\n\nint main(){\n    int M,N;\n    cin>>M>>N;\n    for(int i=0;i<M;i++){\n        for(int j=0;j<N;j++){\n            cin>>stage[i][j];\n        }\n    }\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            cin>>emblem[i][j];\n        }\n    }\n    for(int i=0;i<M-1;i++){\n        for(int j=0;j<N-1;j++){\n            JOI_cmp(i,j);\n        }\n    }\n    printf(\"%d\\n\",ans+mx);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<queue>\n#include<map>\n#include<set>\n#include<list>\n#include<iomanip>\n#include<vector>\n#include<functional>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nchar a[1000][1000];\nint c[1000][1000];\nint main(){\n\tint h,w;\n\twhile(cin>>h>>w){\n\t\tstring u;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\ta[i][j]=u[j];\n\t\t\t\tc[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tchar b[2][2];\n\t\tfor(int i=0;i<2;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<2;j++) b[i][j]=u[j];\n\t\t}\n\t\tint sum=0,sum2=0;\n\t\tfor(int i=0;i<h-1;i++){\n\t\t\tfor(int j=0;j<w-1;j++){\n\t\t\t\tif(a[i][j]==b[0][0]&&a[i][j+1]==b[0][1]&&\n\t\t\t\ta[i+1][j]==b[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\tc[i][j]++;\n\t\t\t\t\tsum++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsum2=sum;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmap<char, int>d;\n\t\t\t\td.insert(map<char, int>::value_type('J',0));\n\t\t\t\td.insert(map<char, int>::value_type('O',0));\n\t\t\t\td.insert(map<char, int>::value_type('I',0));\n\t\t\t\tif(i+1<h&&j+1<w){\n\t\t\t\t\tif(a[i][j+1]==b[0][1]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\t\t\td[b[0][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i+1<h&&j-1>=0){\n\t\t\t\t\tif(a[i][j-1]==b[0][0]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][1]&&a[i+1][j-1]==b[1][0]){\n\t\t\t\t\t\td[b[0][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j+1<h){\n\t\t\t\t\tif(a[i-1][j]==b[0][0]&&a[i-1][j+1]==b[0][1]&&\n\t\t\t\t\t\ta[i][j+1]==b[1][1]){\n\t\t\t\t\t\td[b[1][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j-1>=0){\n\t\t\t\t\tif(a[i-1][j-1]==b[0][0]&&a[i-1][j]==b[0][1]&&\n\t\t\t\t\t\ta[i][j-1]==a[1][0]){\n\t\t\t\t\t\td[b[1][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['J']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['J']);\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['O']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['O']);\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['I']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['I']);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<sum2<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define MP make_pair\n#define PB push_back\n#define F first\n#define S second\n#define INF 1 << 30\n#define EPS 1e-10\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint flag[1024][1024], cr[2][2], M, N;\n\nint countF(int y, int x){\n  int res = 0,i,j;\n  for(i=y-1;i<=y;i++){\n    for(j=x-1;j<=x;j++){\n      int f = 1;\n      rep(k,2) rep(l,2) if(flag[i+k][j+l]!=cr[k][l]) f = 0;\n      if(f) res++;\n    }\n  }\n  return res;\n}\n\nint main(){\n  scanf(\"%d%d\", &M, &N);\n  memset(flag, -1, sizeof(flag));\n  char in[1024];\n  rep(i, M){\n    scanf(\"%s\", in);\n    for(int j=0;j<N;j++){\n      flag[i+1][j+1] = (in[j]=='J')?0:(in[j]=='O')?1:2;\n    }\t\n  }\n\n  rep(i,2){\n    scanf(\"%s\", in);\n    for(int j=0;j<2;j++)\n      cr[i][j] = (in[j]=='J')?0:(in[j]=='O')?1:2;\n  }\n\n  /*  rep(i, M+1){\n    rep(j, N+1) cout << flag[i][j] << \" \";\n    cout << endl;\n    }*/\n\n  //  cout << cr[0][0] << cr[0][1] << endl << cr[1][0] << cr[1][1] << endl;\n\n  int res = 0;\n  int origin = 0;\n  REP(i,1,M)REP(j,1,N){\n    if(flag[i][j]==cr[0][0] && flag[i+1][j]==cr[1][0] &&\n       flag[i][j+1]==cr[0][1] && flag[i+1][j+1]==cr[1][1]) origin++;\n  }\n\n  res = origin;\n\n  REP(i,1,M+1) REP(j,1,N+1){\n    int diff = countF(i, j);\n    rep(d, 3){\n      flag[i][j] = (flag[i][j]+1)%3;\n      int add = countF(i, j);\n      res = max(res, origin-diff+add);\n    }\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  int h,w;\n  char maps[1010][1010];\n  char kun[10];\n  int cnt;\n  int ans=0;\n  string str;\n  int best;\n  char joi[3];\n  //旗の入力\n  cin>>h>>w;\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      cin>>maps[i][j];\n    }\n  }\n  //勲章入力\n  cin>>str;\n  kun[0]=str[0];\n  kun[1]=str[1];\n  cin>>str;\n  kun[2]=str[0];\n  kun[3]=str[1];\n  cnt=0;\n  //昔の旗の勲章の数\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(kun[0]==maps[i][j] && kun[1]==maps[i][j+1] && kun[2]==maps[i+1][j] && kun[3]==maps[i+1][j+1])cnt++;\n    }\n  }\n  if(ans<cnt)ans=cnt;\n  best=cnt;\n  //白紙のパターン\n  joi[0]='J';\n  joi[1]='O';\n  joi[2]='I';\n  int miruy[]={-1,-1,0,0,-1,-1,0,0,0,0,1,1,0,0,1,1};\n  int mirux[]={-1,0,-1,0,0,1,0,1,-1,0,-1,0,0,1,0,1};\n  int ima;\n  char kari;\n  for(int s=0;s<h;s++){\n    for(int r=0;r<w;r++){\n      cnt=0;\n      kari=maps[s][r];\n      for(int i=0;i<13;i+=4){\n\tif(kun[0]==maps[s+miruy[i]][r+mirux[i]]){\n\t  if(kun[1]==maps[s+miruy[i+1]][r+mirux[i+1]]){\n\t    if(kun[2]==maps[s+miruy[i+2]][r+mirux[i+2]]){\n\t      if(kun[3]==maps[s+miruy[i+3]][r+mirux[i+3]])cnt++;\n\t    }\n\t  }\n\t}\n      }\n      ima=cnt;\n      best-=ima;\n      for(int m=0;m<3;m++){\n\tmaps[s][r]=joi[m];\n\tcnt=0;\n\tfor(int i=0;i<13;i+=4){\n\t  if(kun[0]==maps[s+miruy[i]][r+mirux[i]]){\n\t    if(kun[1]==maps[s+miruy[i+1]][r+mirux[i+1]]){\n\t      if(kun[2]==maps[s+miruy[i+2]][r+mirux[i+2]]){\n\t\tif(kun[3]==maps[s+miruy[i+3]][r+mirux[i+3]])cnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\tif(ans<best+cnt)ans=best+cnt;\n\t//\tcout<<best<<\" \"<<cnt<<\" \"<<s<<\",\"<<r<<\" \"<<joi[m]<<endl;\n      }\n      maps[s][r]=kari;\n      best+=ima;\n    }\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define int long long\n \n#define INF (1<<61)\n \nusing namespace std;\n \ntypedef pair<int, int> Pii;\n \nint h, w, flag[1010][1010] = {0}, emblem[4];\n \nbool IsEmblem(int x, int y) {\n    int dx[] = {0, 1, 0, 1}, dy[] = {0, 0, 1, 1};\n    for (int i = 0; i < 4; ++i)\n        if (flag[x + dx[i]][y + dy[i]] != emblem[i]) return false;\n \n    return true;\n}\n \nsigned main() {\n    cin >> h >> w;\n \n    for (int y = 1; y <= h; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 1; x <= w; ++x) {\n            switch (temp[x - 1]) {\n                case 'J':\n                    flag[x][y] = 1;\n                    break;\n                case 'O':\n                    flag[x][y] = 2;\n                    break;\n                case 'I':\n                    flag[x][y] = 3;\n            }\n        }\n    }\n \n    for (int y = 0; y < 2; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 0; x < 2; ++x) {\n            int i = x + (2 * y);\n            switch (temp[x]) {\n                case 'J':\n                    emblem[i] = 1;\n                    break;\n                case 'O':\n                    emblem[i] = 2;\n                    break;\n                case 'I':\n                    emblem[i] = 3;\n            }\n        }\n    }\n \n    int base = 0;\n    for (int y = 1; y < h; ++y) {\n        for (int x = 1; x < w; ++x) {\n            if (IsEmblem(x, y)) base++;\n        }\n    }\n \n    int max = 0, dx[] = {-1, 0, -1, 0}, dy[] = {-1, -1, 0, 0};\n    for (int y = 1; y <= h; ++y) {\n        for (int x = 1; x <= w; ++x) {\n            for (int i = 1; i < 4; ++i) {\n                int temp = flag[x][y], count = 0;\n                flag[x][y] = i;\n \n                for (int j = 0; j < 4; ++j) {\n                    if (IsEmblem(x + dx[j], y + dy[j])) count++;\n                }\n \n                if (max < count) max = count;\n                flag[x][y] = temp;\n            }\n        }\n    }\n \n    cout << base + max << endl;\n \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n#define MAX_N 1005\nint n,m;\nchar flag[MAX_N][MAX_N];\nchar pat[3][3];\nchar JOI[]=\"JOI\";\nbool check(int x,int y)\n{\n\tif(!(x>=0&&y>=0&&x<n-1&&y<m-1))return false;\n\tfor(int i=0;i<2;i++)\n\t{\n\t\tfor(int j=0;j<2;j++)\n\t\t{\n\t\t\tif(flag[x+i][y+j]!=pat[i][j])return false;\n\t\t}\n\t}\n\treturn true;\n}\nint main()\n{\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++)\n\t{\n\t\tfor(int j=0;j<2;j++)\n\t\t{\n\t\t\tcin >> pat[i][j];\n\t\t}\n\t}\n\tint base=0,ans;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tif(check(i,j))base++;\n\t\t}\n\t}\n\tans=base;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tchar e = flag[i][j];\n\t\t\tint rem=0,cnt;\t\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t{\n\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t{\n\t\t\t\t\tif(check(i-k,j-l))rem++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int s=0;s<3;s++)\n\t\t\t{\n\t\t\t\tcnt=0;\n\t\t\t\tflag[i][j]=JOI[s];\n\t\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\t{\n\t\t\t\t\tfor(int l=0;l<2;l++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(check(i-k,j-l))cnt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans=max(ans,base-rem+cnt);\n\t\t\t}\n\t\t\tflag[i][j]=e;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nint n, m;\nchar flag[1024][1024];\nchar emblem[2][3];\n\nbool check(int i, int j)\n{\n\tif (i < 0 || i + 1 >= m) return (false);\n\tif (j < 0 || j + 1 >= n) return (false);\n\treturn (strncmp(flag[i] + j, emblem[0], 2) == 0 && strncmp(flag[i + 1] + j, emblem[1], 2) == 0);\n}\n\nint main()\n{\n\tscanf(\"%d %d\", &m, &n);\n\t\n\tfor (int i = 0; i < m; i++){\n\t\tscanf(\"%s\", flag[i]);\n\t}\n\t\n\tscanf(\"%s\", emblem[0]); scanf(\"%s\", emblem[1]);\n\t\n\tint ans = 0;\n\tfor (int i = 0; i <= m - 2; i++){\n\t\tfor (int j = 0; j <= n - 2; j++){\n\t\t\tif (check(i, j)){\n\t\t\t\tans++;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint base = ans;\n\tchar rot[] = \"JOI\";\n\tfor (int i = 0; i < m; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tchar bef = flag[i][j];\n\t\t\tint ct = 0;\n\t\t\t\n\t\t\tif (check(i - 1, j)) ct++;\n\t\t\tif (check(i - 1, j - 1)) ct++;\n\t\t\tif (check(i, j - 1)) ct++;\n\t\t\tif (check(i, j)) ct++;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; k++){\n\t\t\t\tint tmp = base - ct;\n\t\t\t\tflag[i][j] = rot[k];\n\t\t\t\t\n\t\t\t\tif (check(i - 1, j)) tmp++;\n\t\t\t\tif (check(i - 1, j - 1)) tmp++;\n\t\t\t\tif (check(i, j - 1)) tmp++;\n\t\t\t\tif (check(i, j)) tmp++;\n\t\t\t\t\n\t\t\t\tflag[i][j] = bef;\n\t\t\t\tans = max(ans, tmp);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprintf(\"%d\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nenum{J,O,I};\n\nchar ary[1010][1010];\nint ary2[1010][1010]={};\nint main(){\n\tint M,N,hog,ug,ma,cnt;\n\tchar emb[2][2];\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>ary[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>emb[i][j];\n\t\t}\n\t}\n\tcnt=0;\n\tfor(int i=0;i<M-1;i++){\n\t\tfor(int j=0;j<N-1;j++){\n\t\t\thog=0;ug=-1;\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tif(ary[i+k/2][j+k%2]!=emb[k/2][k%2]){\n\t\t\t\t\thog++;\n\t\t\t\t\tug=k;\n\t\t\t\t}\n\t\t\t\tif(hog>=2) break;\n\t\t\t}\n\t\t\tif(hog==0){\n\t\t\t\tcnt++;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tary2[i+k/2][j+k%2]--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(hog==1){\n\t\t\t\tary2[i+ug/2][j+ug%2]++;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t\n\tma=0;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tif(ma<ary2[i][j]){\n\t\t\t\tma=ary2[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tcnt+=ma;\n\tcout<<cnt<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nchar new[1001][1001];\nint i,j,k;\nint main(void)\n{\n\tchar old[5];\n\tchar joi[3]={'J','O','I'};\n\tint m,n;\n\tint cnt,c,max;\n\tc=0;\n\tcnt=0;\n\tmax=0;\n\t\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tscanf(\" %c\",&new[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<4;i++){\n\t\tscanf(\" %c\",&old[i]);\n\t}\n\tfor(i=0;i<m-1;i++){\n\t\tfor(j=0;j<n-1;j++){\n\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse if(new[i][j]=='J'){\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='O'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='I'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt+max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<string>\nusing namespace std;\n\nstring flag[1080];\nstring emblem[2];\nint n, m;\nint match[1080][1080];\nint res;\n\nbool isMatching(int x, int y){\n\tfor(int i = 0;i < 2;i++){\n\t\tfor(int j = 0;j < 2;j++){\n\t\t\tif(flag[x+i][y+j] != emblem[i][j]){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nint diff(int x, int y){\n\tif(x < 0 || y < 0)return 0;\n\tif(x >= n-1 || y >= m-1)return 0;\n\treturn isMatching(x, y) - match[x][y];\n}\n\nint defaultCount;\n\nint main(){\n\tcin >> n >> m;\n\tfor(int i = 0;i < n;i++){\n\t\tcin >> flag[i];\n\t}\n\tfor(int i = 0;i < 2;i++){\n\t\tcin >> emblem[i];\n\t}\n\n\tfor(int i = 0;i < n-1;i++){\n\t\tfor(int j = 0;j < m-1;j++){\n\t\t\tmatch[i][j] = isMatching(i,j);\n\t\t\tdefaultCount += match[i][j];\n\t\t}\n\t}\n\t\n\tfor(int i = 0;i < n;i++){\n\t\tfor(int j = 0;j < m;j++){\n\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\tchar c = \"JOI\"[k];\n\t\t\t\tchar original = flag[i][j];\n\t\t\t\tflag[i][j] = c;\n\t\t\t\tint tmp = defaultCount;\n\t\t\t\ttmp += diff(i-1,j-1);\n\t\t\t\ttmp += diff(i,j-1);\n\t\t\t\ttmp += diff(i-1,j);\n\t\t\t\ttmp += diff(i,j);\n\t\t\t\tres = max(res, tmp);\n\t\t\t\tflag[i][j] = original;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << res << endl;\n\treturn 0;\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <typeinfo>\n#include <vector>\n#include <cmath>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <queue>\n#include <iomanip>\n#include <cctype>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<char> vc;\ntypedef vector<vc> vvc;\ntypedef vector<bool> vb;\ntypedef vector<vb> vvb;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<25;\nconst ll INF=1ll<<50;\nconst double pi=acos(-1);\nconst double eps=1e-8;\nconst vi emp;\n\nint h,w,ans=0;\nvvc a,b(2,vc(2));\nvvi c;\n\nvoid Judge(int x,int y){\n\tvp T,F;\n\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++){\n\t\tif(b[i][j]==a[i+x][j+y]) T.push_back(P(i+x,j+y));\n\t\telse F.push_back(P(i+x,j+y));\n\t}\n\tif(T.size()>=3){\n\t\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++) c[i+x][j+y]--;\n\t\tif(T.size()==4) ans++;\n\t\tif(T.size()==3) c[F[0].first][F[0].second]+=2;\n\t}\n}\n\nint main(){\n\tcin>>h>>w;\n\ta=vvc(h,vc(w));\n\tc=vvi(h,vi(w));\n\tfor(int i=0;i<h;i++) for(int j=0;j<w;j++) cin>>a[i][j];\n\tfor(int i=0;i<2;i++) for(int j=0;j<2;j++) cin>>b[i][j];\n\tfor(int i=0;i<h-1;i++) for(int j=0;j<w-1;j++) Judge(i,j);\n\tint M=0;\n\tfor(int i=0;i<h;i++) for(int j=0;j<w;j++) M=max(M,c[i][j]);\n\tcout<<ans+M<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n\nusing namespace std;\n\n#define MMAX 1000\n#define NMAX 1000\n\nint M,N;\nstring emb[MMAX];\nstring mon[2];\nint changec[MMAX][NMAX];\n\nint main(){\n\n\t\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tcin>>emb[i];\n\t}\n\n\tcin>>mon[0];\n\tcin>>mon[1];\n\n\tint c=0;\n\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tchangec[i][j]=0;\n\n\t\t}\n\t}\n\n\tfor(int i=0;i<M-1;i++){\n\t\tfor(int j=0;j<N-1;j++){\n\t\t\tbool f=true;\n\t\t\tint fc=0;\n\t\t\tint fi=0,fj=0;\n\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\tfor(int l=0;l<2;l++){\n\t\t\t\t\tif(emb[i+k][j+l]!=mon[k][l]) f=false,fc++,fi=i+k,fj=j+l;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(f){\n\t\t\t\tc++;\n\t\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\t\tfor(int l=0;l<2;l++){\n\t\t\t\t\t\tchangec[i+k][j+l]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(fc==1){\n\t\t\t\t\tchangec[fi][fj]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint max=-1;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tif(max<changec[i][j]) max=changec[i][j];\n\t\t}\n\t}\n\n\tif(max>=1) c+=max;\n\tcout<<c<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n\nusing namespace std ;\n\nint main()\n{\n\tint n ,m ;\n\tcin >> n >> m ;\n\tchar c[ n ][ m + 1 ] ;\n\tfor( int i = 0 ; i < n ; i++ )\n\t\tcin >> c[ i ] ;\n\tchar ch[ 2 ][ 3 ] ;\n\tcin >> ch[ 0 ] ;\n\tcin >> ch[ 1 ] ;\n\tint cnt = 0 ;\n\tfor( int i = 0 ; i < n ; i++ )\n\t{\n\t\tfor( int j = 0 ; j < m ; j++ )\n\t\t{\n\t\t\tif( c[ i ][ j ] == ch[ 0 ][ 0 ] && c[ i ][ j + 1 ] == ch[ 0 ][ 1 ] && c[ i + 1 ][ j ] == ch[ 1 ][ 0 ] && c[ i + 1 ][ j + 1 ] == ch[ 1 ][ 1 ] )\n\t\t\t\tcnt++ ;\n\t\t}\n\t}\n\tcout << cnt << endl ;\n\treturn 0 ;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1005][1005],pat[5][5];\nint n,m;\nstring ch=\"JOI\";\n\nbool match(int x,int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>0 && ny>0)res+=match(nx,ny);\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      if(match(j,i))res+=1;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<n;i++){    \n     for(int j=0;j<m;j++){\n       char tmp=g[i][j];\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> m >> n;\n  \n  fill(g[0],g[1005],'.');\n  fill(pat[0],pat[5],'$');\n\n  for(int i=0;i<n;i++){\n    cin >> g[i];\n  }\n\n  for(int i=0;i<2;i++){\n    cin >> pat[i];\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for(int i=a;i<=b;i++)\n#define FORD(i,a,b) for(int i=a;i>=b;i--)\n#define FORV(i,a,b) for(int i=a;i*i<=b;i++)\n#define Forv(i,a,b) for(int i=a;i*i<b;i++)\n#define For(i,a,b) for(int i=a;i<b;i++)\n#define Ford(i,a,b) for(int i=a;i>b;i--)\n#define Fill(s,a) memset(s,a,sizeof(s))\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n\nint n, m, cnt=0;\nchar c[1001][1001], x[3][3];\n\nbool check(int i, int j)\n{\n    FOR(k, 1, 2)\n        FOR(l, 1, 2)\n            if(c[i+k-1][j+l-1] != x[k][l]) return false;\n    return true;\n}\n\nint solve(char y, int i, int j)\n{\n    int cnt1=0, cnt2=0;\n    char z = c[i][j];\n    if(check(i, j))cnt1++;\n    if(check(i-1, j-1))cnt1++;\n    if(check(i-1, j))cnt1++;\n    if(check(i, j-1))cnt1++;\n    c[i][j] = y;\n    if(check(i, j))cnt2++;\n    if(check(i-1, j-1))cnt2++;\n    if(check(i-1, j))cnt2++;\n    if(check(i, j-1))cnt2++;\n    c[i][j] = z;\n    return (cnt2-cnt1);\n}\n\nint main()\n{\n    cin>>m>>n;\n    FOR(i, 1, m)\n    {\n        scanf(\"\\n\");\n        FOR(j, 1, n)\n            scanf(\"%c\", &c[i][j]);\n    }\n    scanf(\"\\n%c%c\\n%c%c\", &x[1][1], &x[1][2], &x[2][1], &x[2][2]);\n    For(i, 1, m)\n        For(j, 1, n)\n        {\n            if(check(i, j))cnt++;\n        }\n    int res=0;\n    FOR(i, 1, m)\n        FOR(j, 1, n)\n        {\n            res = max(res, solve('J', i, j));\n            res = max(res, solve('O', i, j));\n            res = max(res, solve('I', i, j));\n        }\n    cout<<cnt+res<<'\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint W, H;\nstring s[1000], ss[2], joi = \"JOI\";\nint b[1000][1000];\n\nint check(int x, int y)\n{\n  bool bb = true;\n  for(int yy = 0; yy < 2; yy++)\n    for(int xx = 0; xx < 2; xx++)\n      bb &= s[y + yy][x + xx] == ss[yy][xx];\n  return bb ? 1 : 0;\n}\n\nint count(int x, int y)\n{\n  int n = 0, m = 0;\n  if(x > 0 && y > 0)\n  {\n    n += check(x - 1, y - 1);\n    m += b[y - 1][x - 1];\n  }\n  if(x > 0)\n  {\n    n += check(x - 1, y);\n    m += b[y][x - 1];\n  }\n  if(y > 0)\n  {\n    n += check(x, y - 1);\n    m += b[y - 1][x];\n  }\n  \n  n += check(x, y);\n  m += b[y][x];\n\n  return n - m;\n}\n\nint main()\n{\n  int n = 0, ans = -1;\n  \n  cin >> H >> W;\n  for(int i = 0; i < H; i++)\n    cin >> s[i];\n  cin >> ss[0] >> ss[1];\n  \n  for(int y = 0; y < H - 1; y++)\n    for(int x = 0; x < W - 1; x++)\n      n += b[y][x] = check(x, y);\n  for(int y = 0; y < H - 1; y++)\n  {\n    for(int x = 0; x < W - 1; x++)\n    {\n      auto c = s[y][x];\n      for(int i = 0; i < 3; i++)\n      {\n        s[y][x] = joi[i];\n        ans = max(ans, n + count(x, y));\n      }\n      s[y][x] = c;\n    }\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <vector>\n\n#define INF 10 << 10\n\nint n, m;\nchar flag[1002][1002];\nchar coa[3][3]; //?´???? Coat of arms\nint over[1002][1002]; // ?????????\n\nbool check(char y0x0, char y0x1, char y1x0, char y1x1) {\n\tif (y0x0 == coa[0][0]) {\n\t\tif (y0x1 != coa[0][1]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x0 != coa[1][0]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x1 != coa[1][1]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvoid Over(int y, int x) {\n\tfor (int i = y; i <= y + 1; ++i) {\n\t\tfor (int i2 = x; i2 <= x + 1; ++i2) {\n\t\t\t++over[i][i2];\n\t\t}\n\t}\n}\n\nint main() {\n\tmemset(over, 0, sizeof(over));\n\tmemset(flag, '0', sizeof(flag));\n\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tcin >> flag[i][i2];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int i2 = 0; i2 < 2; ++i2) {\n\t\t\tcin >> coa[i][i2];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\t//???????????§?????¢?´¢\n\tfor (int i = 1; i <= n - 1; ++i) {\n\t\tfor (int i2 = 1; i2 <= m - 1; ++i2) {\n\t\t\tif (check(flag[i][i2], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t++cnt;\n\t\t\t\tOver(i, i2);\n\t\t\t}\n\t\t}\n\t}\n\n\t//???????????????J,O,I,????????´????????????\n\t//(i, i2)????????????(i - 1, i2 - 1)???(i + 1, i2 + 1)??????????????°??????\n\t//??????????¢????????????????\t\t???\t??????(i, i2)?????????????´??????¨???????????£??????????????????????????????????????°???\n\tint cnt_add = 0;\n\tchar JOI[] = { \"JOI\" };\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tint add = 0;\n\t\t\t\tif (check(flag[i - 1][i2 - 1], flag[i - 1][i2], flag[i][i2 - 1], JOI[j])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i - 1][i2], flag[i - 1][i2 + 1], JOI[j], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i][i2 - 1], JOI[j], flag[i + 1][i2 - 1], flag[i + 1][i2])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(JOI[j], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tcnt_add = max(cnt_add, add - over[i][i2]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << max(cnt, cnt + cnt_add) << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n#define ALL(x) begin(x), end(x)\nvector<string> field,squ;\nint check(int x,int y){\n  for(int i =0 ;i < 2;i++){\n\tfor(int j = 0;j < 2;j++){\n\t  if(field[y+i][x+j] != squ[i][j])return 0;\n\t}\n  }\n  return 1;\n}\nint main(){\n  int n,m;\n  cin >> m >> n;\n  field = vector<string>(m);\n  for(int i = 0;i < m;i++){\n\tcin >> field[i];\n  }\n  squ = vector<string>(2);\n  for(int i = 0;i < 2;i++){\n\tcin >> squ[i];\n  }\n  vector<vector<int> > cnt(m,vector<int>(n,0));\n  int sum = 0;\n  for(int i = 0;i < m-1;i++){\n\tfor(int j = 0;j < n-1;j++){\n\t  if(check(j,i)){\n\t\tcnt[i][j] = 1;\n\t\tsum++;\n\t  }\n\t}\n  }\n\n  int ans = sum;\n  string str = \"JOI\";\n  int dx[] = {-1,1,1,-1};\n  int dy[] = {-1,-1,1,1};\n  int dxx[] = {-1,0,0,-1};\n  int dyy[] = {-1,-1,0,0};\n  for(int i = 0;i < m;i++){\n\tfor(int j = 0;j < n;j++){\n\t  char keep = field[i][j];\n\t  for(int l = 0;l < str.size();l++){\n\t\tfield[i][j] = str[l];\n\t\tint tmp = 0;\n\t\tfor(int k = 0;k < 4;k++){\n\t\t  if(i+dy[k] >= m || i+dy[k] < 0 || j+dx[k] >= n || j+dx[k] < 0)continue;\n\t\t  int res = check(j+dxx[k],i+dyy[k]);\n\t\t  tmp+=res - cnt[i+dyy[k]][j+dxx[k]];\n\t\t}\n\t\tans = max(ans,tmp+sum);\n\t  }\n\t  field[i][j] = keep;\n\t}\n  }\n  cout << ans << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstring s[1002];\nint n,m;\nstring t[2];\nint d(int x,int y)\n{\n\treturn s[x][y]==t[0][0]&&s[x+1][y]==t[1][0]&&s[x][y+1]==t[0][1]&&s[x+1][y+1]==t[1][1];\n}\nint c(int x,int y)\n{\n\treturn d(x-1,y-1)+d(x-1,y)+d(x,y-1)+d(x,y);\n}\nmain()\n{\n\tcin>>n>>m;\n\ts[0].resize(m+2);s[n+1].resize(m+2);\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tcin>>s[i+1];\n\t\ts[i+1]=\" \"+s[i+1]+\" \";\n\t}\n\tcin>>t[0]>>t[1];\n\tint sum=0;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tfor(int j=1;j<m;j++)sum+=d(i,j);\n\t}\n\tint M=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tchar sto=s[i][j];\n\t\t\tif(sto!='J')s[i][j]='J',M=max(M,c(i,j));\n\t\t\tif(sto!='O')s[i][j]='O',M=max(M,c(i,j));\n\t\t\tif(sto!='I')s[i][j]='I',M=max(M,c(i,j));\n\t\t\ts[i][j]=sto;\n\t\t}\n\t}\n\tcout<<sum+M<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint m,n;\nbool check(vector<string>& flag, vector<string>& mark, int x, int y) {\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tint nx = x+i, ny = y+j;\n\t\t\tif (nx < 0 || nx >= m || ny < 0 || ny >= n) return false;\n\t\t\tif (flag[nx][ny] != mark[i][j]) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint main() {\n\tcin >> m >> n;\n\tvector<string> flag(m);\n\tfor (auto& i : flag) cin >> i;\n\tvector<string> mark(2);\n\tcin >> mark[0] >> mark[1];\n\tint cnt = 0;\n\tfor (int i = 0; i < m-1; i++)\n\t\tfor (int j = 0; j < n-1; j++)\n\t\t\tif(check(flag, mark, i, j)) ++cnt;\n\tint maximum = 0;\n\tfor (int i = 0; i < m; i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tauto bef = flag[i][j];\n\t\t\tint init = 0;\n\t\t\tfor (int k = -1; k <= 0; k++)\n\t\t\t\tfor (int l = -1; l <= 0; l++)\n\t\t\t\t\tif (check(flag, mark, i+k, j+l)) ++init;\n\t\t\tfor (auto k : {'J', 'O', 'I'}) {\n\t\t\t\tif (bef == k) continue;\n\t\t\t\tflag[i][j] = k;\n\t\t\t\tint now = 0;\n\t\t\t\tfor (int l = -1; l <= 0; l++)\n\t\t\t\t\tfor (int m = -1; m <= 0; m++)\n\t\t\t\t\t\tif (check(flag, mark, i+l, j+m)) ++now;\n\t\t\t\tmaximum = max(maximum, now-init);\n\t\t\t}\n\t\t\tflag[i][j] = bef;\n\t\t}\n\t}\n\tcout << cnt+maximum << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint mm[1005][1005][3];\nstring flag[1005],emb[2];\nint main(){\n    int m,n;\n    cin>>m>>n;\n    int ans=0;\n    for(int i=0;i<m;++i) cin>>flag[i];\n    for(int i=0;i<2;++i) cin>>emb[i];\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            int cnt=0,mx,my;\n            for(int k=0;k<2;++k){\n                for(int l=0;l<2;++l){\n                    if(flag[i+k][j+l]==emb[k][l]) ++cnt;\n                    else{mx=l;my=k;}\n                }\n            }\n            if(cnt==4) ++ans;\n            else if(cnt==3){\n                if(emb[my][mx]=='J') ++mm[i+my][j+mx][0];\n                else if(emb[my][mx]=='O') ++mm[i+my][j+mx][1];\n                else ++mm[i+my][j+mx][2];\n            }\n        }\n    }\n    int w=0;\n    for(int i=0;i<m;++i){\n        for(int j=0;j<n;++j){\n            for(int k=0;k<3;++k) w=max(w,mm[i][j][k]);\n        }\n    }\n    cout<<ans+w<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int M, N;\n  cin >> M >> N;\n  vector<string> flag(M), emblem(2);\n  for(auto& s: flag) cin >> s;\n  for(auto& s: emblem) cin >> s;\n\n  for(auto& s: flag) s = \"X\" + s + \"X\";\n  flag.emplace(begin(flag), N + 2, 'X');\n  flag.emplace_back(N + 2, 'X');\n\n  int all = 0;\n  for(int i = 1; i < M; ++i) for(int j = 1; j < N; ++j) {\n    bool ok = true;\n    for(int di: {0, 1}) for(int dj: {0, 1}) ok &= (flag[i + di][j + dj] == emblem[di][dj]);\n    if(ok) ++all;\n  }\n\n  int dif = 0;\n  for(int y = 1; y <= M; ++y) for(int x = 1; x <= N; ++x) {\n    char dup = flag[y][x];\n    int high = 0;\n    int original = 0;\n    for(char c: {'J', 'O', 'I'}) {\n      flag[y][x] = c;\n      int cnt = 0;\n      for(int i: {y-1, y}) for(int j: {x-1, x}) {\n        bool ok = true;\n        for(int di: {0, 1}) for(int dj: {0, 1}) ok &= (flag[i + di][j + dj] == emblem[di][dj]);\n        if(ok) ++cnt;\n      }\n      if(c == dup) original = cnt;\n      high = max(high, cnt);\n    }\n    dif = max(dif, high - original);\n    flag[y][x] = dup;\n  }\n\n  cout << all + dif << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define For(i , a , b) for (int i = (a) ; i <= (b) ; i++)\n#define Rep(i , n) for (int i = 0 ; i < (n) ; i++)\n#define Ford(i , a , b) for (int i = (a) ; i >= (b) ; i--)\n\nconst int maxn = 1912;\nint n , m;\nstring s[maxn];\nstring pat[2];\n\nvoid ReadData() {\n\tcin >> n >> m;\n\tFor(i , 1 , n) cin >> s[i] , s[i] = ' ' + s[i];\n\tFor(i , 0 , 1) cin >> pat[i];\n}\n\nbool inside(const int &x , const int &y) {\n\treturn x >= 1 && x <= n && y >= 1 && y <= m;\n}\n\nint check(int i , int j) {\n\tif (!(i >= 1 && i <= n - 1 && j >= 1 && j <= m - 1)) return 0;\n\tif (pat[0][0] == s[i][j] && pat[1][0] == s[i + 1][j] \n\t && pat[0][1] == s[i][j + 1] && pat[1][1] == s[i + 1][j + 1]) return 1;\n\treturn 0;\n}\n\nvoid Process() {\n\tint cnt = 0;\n\tchar choice[] = {'J' , 'O' , 'I'};\n\t\n\tFor(i , 1 , n - 1) For(j , 1 , m - 1) {\n\t\tcnt += check(i , j);\n\t}\n\tint res = cnt;\n\tFor(i , 1 , n) For(j , 1 , m) { // try to change cell i , j\n\t\tchar tmp = s[i][j];\n\t\tint last = cnt;\n\t\tRep(k , 3) {\n\t\t\tcnt -= check(i , j) + check(i - 1 , j) + check(i , j - 1) + check(i - 1 , j - 1);\n\t\t\ts[i][j] = choice[k];\n\t\t\tcnt += check(i , j) + check(i - 1 , j) + check(i , j - 1) + check(i - 1 , j - 1);\n\t\t\tres = max(res , cnt);\n\t\t}\n\t\tcnt = last;\n\t\ts[i][j] = tmp;\n\t}\n\t\n\tcout << res << endl;\n}\n\nint main() {\n   // ios_base::sync_with_stdio(false);\n   // cin.tie(NULL);\n    \n    //freopen(\"./emblem.inp\" , \"r\" , stdin);\t\n   \tReadData();\n   \tProcess();\n\n    return 0;\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<ctime>\n#include<cmath>\n#include<cstring>\n#include<cctype>\n#include<complex>\n#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<functional>\n#include<vector>\n#include<string>\n#include<stack>\n#include<queue>\n#include<map>\n#include<set>\n#include<bitset>\n#include<numeric>\nusing namespace std;\n//const int dx[]={1,0,-1,0};\n//const int dy[]={0,1,0,-1};\n#define INF 1e+8\n#define EPS 1e-7\n#define PB push_back\n#define fi first\n#define se second\n#define ll long long\n#define reps(i,j,k) for(int i = (j); i < (k); i++)\n#define rep(i,j) reps(i,0,j)\ntypedef complex < double > Point;\ntypedef pair<int,int> Pii;\ntypedef vector < int > vi;\ntypedef vector < vi > vii;\nconst int dx[]={0,1,0,1},dy[] = {0,0,1,1};\nchar flag[1024][1024];\nbool made[1024][1024];\nint check(string str,int y,int x){\n    rep(i,4){\n        if(flag[y+dy[i]][x+dx[i]] != str[i])return 0;\n    }\n    rep(i,4){\n        made[y+dy[i]][x+dx[i]] = 1;\n    }\n    return 1;\n}\nint solve(int i,int j,string x,int m,int n){\n    int res=0;\n    if(i == 0 && j == 0){res+=check(x,i,j);}\n    else if(i == 0 && j == m-1){res+=check(x,i,j-1);}\n    else if(i == n-1 && j == 0){res+=check(x,i-1,j);}\n    else if(i == n-1 && j == m-1){res+=check(x,i-1,j-1);}\n    else if(i == 0){res+=check(x,i,j);res+=check(x,i,j-1);}\n    else if(i == n-1){res+=check(x,i-1,j-1);res+=check(x,i-1,j);}\n    else if(j == 0){res+=check(x,i-1,j);res+=check(x,i,j);}\n    else if(j == m-1){res+=check(x,i-1,j-1);res+=check(x,i,j-1);}\n    else{res+=check(x,i-1,j-1);res+=check(x,i-1,j);res+=check(x,i,j-1);res+=check(x,i,j);}\n    return res;\n}\nint main(){\n    int n,m;\n    scanf(\"%d%d\",&n,&m);\n    rep(i,n){\n        scanf(\"%s\",flag[i]);\n    }\n\n    string x;\n    string y;\n    cin >> x;\n    cin >> y;\n    x += y;\n    int ans = 0;\n    rep(i,n){\n        rep(j,m){\n            if(x[0] == flag[i][j]){\n                ans += check(x,i,j);\n            }\n        }\n    }\n    int ma = 0;\n    rep(i,n){\n        rep(j,m){\n            if(!made[i][j]){\n                char sub = flag[i][j];\n                int res = 0;\n                if(sub == 'J'){\n                    int hoge1=0;\n                    int hoge2=0;\n                    flag[i][j] = 'O';\n                    hoge1 = solve(i,j,x,m,n);\n                    flag[i][j] = 'I';\n                    hoge2 = solve(i,j,x,m,n);\n                    flag[i][j] = 'J';\n                    res += max(hoge1,hoge2);\n                }\n                if(sub == 'O'){\n                    int hoge1=0;\n                    int hoge2=0;\n                    flag[i][j] = 'J';\n                    hoge1 = solve(i,j,x,m,n);\n                    flag[i][j] = 'I';\n                    hoge2 = solve(i,j,x,m,n);\n                    flag[i][j] = 'O';\n                    res += max(hoge1,hoge2);\n                }\n                if(sub == 'I'){\n                    int hoge1=0;\n                    int hoge2=0;\n                    flag[i][j] = 'J';\n                    hoge1 = solve(i,j,x,m,n);\n                    flag[i][j] = 'O';\n                    hoge2 = solve(i,j,x,m,n);\n                    flag[i][j] = 'I';\n                    res += max(hoge1,hoge2);\n                }\n                ma = max(res,ma);\n            }\n        }\n    }\n    printf(\"%d\\n\",ans+ma);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<string>\n#include<iostream>\n\nusing namespace std;\n\nint m,n;\n\nint fie[1002][1002];\nint flag[3][3];\nint ok[1002][1002];\n\nbool check(int x,int y){\n\tif(fie[x][y]!=flag[0][0])return false;\n\tif(fie[x+1][y]!=flag[1][0])return false;\n\tif(fie[x][y+1]!=flag[0][1])return false;\n\tif(fie[x+1][y+1]!=flag[1][1])return false;\n\treturn true;\n}\n\nint main(void){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<n;i++){\n\t\tstring s;\n\t\tcin >> s;\n\t\tfor(int j=0;j<m;j++){\n\t\t\tif(s[j]=='J')fie[j][i]=0;\n\t\t\tif(s[j]=='O')fie[j][i]=1;\n\t\t\tif(s[j]=='I')fie[j][i]=2;\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tstring s;\n\t\tcin >> s;\n\t\tfor(int j=0;j<2;j++){\n\t\t\tif(s[j]=='J')flag[j][i]=0;\n\t\t\tif(s[j]=='O')flag[j][i]=1;\n\t\t\tif(s[j]=='I')flag[j][i]=2;\n\t\t}\n\t}\n\tint cnt=0;\n\tfor(int i=0;i<n-1;i++){\n\t\tfor(int j=0;j<m-1;j++){\n\t\t\tif(check(j,i))cnt++,ok[j][i]=1;\n\t\t}\n\t}\n\t\n\tint res=0;\n\tfor(int i=0;i<n;i++){\n\t\tfor(int j=0;j<m;j++){\n\t\t\tint prev=fie[j][i];\n\t\t\tfor(int k=0;k<=2;k++){\n\t\t\t\tint plus=0;\n\t\t\t\tfie[j][i]=k;\n\t\t\t\tfor(int y=-1;y<=1;y++){\n\t\t\t\t\tfor(int x=-1;x<=1;x++){\n\t\t\t\t\t\tif(j+x>=0 && j+x<m-1 && y+i>=0 && y+i<n-1){\n\t\t\t\t\t\t\tplus-=ok[j+x][i+y];\n\t\t\t\t\t\t\tif(check(j+x,i+y))plus++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tres=max(res,plus);\n\t\t\t}\n\t\t\tfie[j][i]=prev;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",res+cnt);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n\n#define J 0\n#define O 1\n#define I 2\n#define UNDEF -1\n\nusing namespace std;\n\nstring buf;\nint M,N,MAP[1000][1000],EM[2][2];\n\nint getmap(int x,int y)\n{\n\tif(x >= 0 && y >= 0 && x < N && y < M)\n\t\treturn MAP[x][y];\n\telse\n\t\treturn UNDEF;\n}\n\nbool match(int x,int y)\n{\n\treturn ((getmap(x,y) == EM[0][0]) && (getmap(x+1,y) == EM[1][0]) && (getmap(x,y+1) == EM[0][1]) && (getmap(x+1,y+1) == EM[1][1]));\n}\n\nint main(void)\n{\n\tcin >> M >> N;\n\tfor(int i = 0;i < M;i++)\n\t{\n\t\tcin >> buf;\n\t\tfor(int ii = 0;ii < N;ii++)\n\t\t{\n\t\t\tif(buf[ii] == 'J')\n\t\t\t\tMAP[ii][i] = J;\n\t\t\telse if(buf[ii] == 'O')\n\t\t\t\tMAP[ii][i] = O;\n\t\t\telse\n\t\t\t\tMAP[ii][i] = I;\n\t\t}\n\t}\n\tfor(int i = 0;i < 2;i++)\n\t{\n\t\tcin >> buf;\n\t\tfor(int ii = 0;ii < 2;ii++)\n\t\t{\n\t\t\tif(buf[ii] == 'J')\n\t\t\t\tEM[ii][i] = J;\n\t\t\telse if(buf[ii] == 'O')\n\t\t\t\tEM[ii][i] = O;\n\t\t\telse\n\t\t\t\tEM[ii][i] = I;\n\t\t}\n\t}\n\tint maxadd = 0;\n\tint sum = 0;\n\tfor(int y = 0;y < M;y++)\n\t{\n\t\tfor(int x = 0;x < N;x++)\n\t\t{\n\t\t\tif(match(x,y))\n\t\t\t\tsum++;\n\t\t}\n\t}\n\tfor(int y = 0;y < M;y++)\n\t{\n\t\tfor(int x = 0;x < N;x++)\n\t\t{\n\t\t\tint a[3] = {0,0,0};\n\t\t\tint o = 0;\n\t\t\tint org = MAP[x][y];\n\t\t\tfor(int oy = -1;oy < 1;oy++)\n\t\t\t{\n\t\t\t\tfor(int ox = -1;ox < 1;ox++)\n\t\t\t\t{\n\t\t\t\t\tif(match(x+ox,y+oy))\n\t\t\t\t\t\to++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i < 3;i++)\n\t\t\t{\n\t\t\t\tMAP[x][y] = i;\n\t\t\t\tfor(int oy = -1;oy < 1;oy++)\n\t\t\t\t{\n\t\t\t\t\tfor(int ox = -1;ox < 1;ox++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(match(x+ox,y+oy))\n\t\t\t\t\t\t\ta[i]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tMAP[x][y] = org;\n\t\t\tmaxadd = max(maxadd,max(a[0],max(a[1],a[2])) - o);\n\t\t}\n\t}\n\tcout << maxadd + sum << endl;\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<iostream>\n#include<cstring>\nusing namespace std;\nint M,N;\nchar fie[1001][1001];\nchar flag[3][3];\nint ok[1001][1001];\nint dx[]={-1,0,-1,0};\nint dy[]={-1,-1,0,0};\nchar dc[]=\"JOI\";\nbool check(int x,int y){\nif( x<0 || y<0 ) return false;\nbool f=true;\nfor(int k=0;k<2;k++){\nfor(int l=0;l<2;l++){\nif( fie[x+k][y+l] != flag[k][l] ) f=false;\n}\n}\nreturn f;\n}\nint main(){\ncin >> M >> N;\nfor(int i=0;i<M;i++){\nfor(int j=0;j<N;j++){\ncin >> fie[j][i];\n}\n}\nfor(int i=0;i<2;i++)\nfor(int j=0;j<2;j++)\ncin >> flag[j][i];\n \nint sum = 0;\nfor(int i=0;i<M;i++){\nfor(int j=0;j<N;j++){\nif( check(j,i) ){\nok[j][i]=1;\nsum++;\n}\n}\n}\n \nint res = sum;\nfor(int i=0;i<M;i++){\nfor(int j=0;j<N;j++){\nchar tmp = fie[j][i];\nfor(int c=0;c<3;c++){\nint ret=sum;\nfie[j][i] = dc[c];\nfor(int k=0;k<4;k++){\nint nx = j+dx[k],ny = i+dy[k];\nif( check(nx,ny) ){\nif( ok[nx][ny] == 0 ) ret++;\n} else {\nif( nx>=0 && nx>=0 && ok[nx][ny] == 1 )ret--;\n}\n}\nres = max(res,ret);\n}\nfie[j][i] = tmp;\n}\n}\ncout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\n# include <tuple>\n# include <unordered_map>\n# include <numeric>\n# include <complex>\nusing namespace std;\nusing LL = long long;\nusing ULL = unsigned long long;\nconstexpr int INF = 2000000000;\nconstexpr int HINF = INF / 2;\nconstexpr double DINF = 100000000000000000.0;\nconstexpr long long LINF = 9223372036854775807;\nconstexpr long long HLINF = 4500000000000000000;\nconst double PI = acos(-1);\nint dx[4] = { 0,1,0,-1 }, dy[4] = { 1,0,-1,0 };\n# define ALL(x)     (x).begin(),(x).end()\n# define UNIQ(c)    (c).erase(unique(ALL((c))), end((c)))\n# define mp         make_pair\n# define eb         emplace_back\n# define FOR(i,a,b) for(int i=(a);i<(b);++i)\n# define REP(i,n)   FOR(i,0,n)\n# define INIT       std::ios::sync_with_stdio(false);std::cin.tie(0);\n\nstring maze[1010];\nstring serch[2];\nbool B[1010][1010];\nint h, w;\nstring JOI = \"JOI\";\n\nbool calc(int i, int j) {\n\tif (i < 0 || j < 0)return false;\n\tif (i >= h - 1 || j >= w - 1)return false;\n\tif (maze[i][j] == serch[0][0]\n\t\t&& maze[i][j + 1] == serch[0][1]\n\t\t&& maze[i + 1][j] == serch[1][0]\n\t\t&& maze[i + 1][j + 1] == serch[1][1])return true;\n\treturn false;\n}\n\nint main() {\n\tcin >> h >> w;\n\tfor (int i = 0; i < h; i++) {\n\t\tcin >> maze[i];\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tcin >> serch[i];\n\t}\n\tint ans = 0;\n\tfor (int i = 0; i < h - 1; i++) {\n\t\tfor (int j = 0; j < w - 1; j++) {\n\t\t\tif (calc(i, j)) {\n\t\t\t\tans++;\n\t\t\t}\n\t\t}\n\t}\n\tint maxl = 0;\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tint count = 0;\n\t\t\t\tif (maze[i][j] == JOI[k])continue;\n\t\t\t\tchar copy = maze[i][j];\n\t\t\t\tmaze[i][j] = JOI[k];\n\n\t\t\t\tcount += calc(i - 1, j - 1) + calc(i - 1, j) + calc(i, j - 1) + calc(i, j);\n\t\t\t\tmaxl = max(count, maxl);\n\t\t\t\tmaze[i][j] = copy;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans + maxl << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint flag[1000][1000];\nint emb[2][2];\nconst int dx2[4] = { 0,0,1,1 };\nconst int dy2[4] = { 0,1,1,0 };\nbool check(const int l, const int u) {\n\tfor (int i = 0; i < 4; ++i) {\n\t\tif (flag[u + dy2[i]][l + dx2[i]] != emb[dy2[i]][dx2[i]])return false;\n\t}\n\treturn true;\n}\nint main() {\n\tint M, N; cin >> M >> N;\n\tmap<char, int>mp;\n\tmp['J'] = 0;\n\tmp['O'] = 1;\n\tmp['I'] = 2;\n\tfor (int i = 0; i < M; ++i) {\n\t\tstring st; cin >> st;\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tflag[i][j] = mp[st[j]];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tstring st; cin >> st;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\temb[i][j] = mp[st[j]];\n\t\t}\n\t}\n\tint sum = 0;\n\tfor (int u = 0; u < M - 1; ++u) {\n\t\tfor (int l = 0; l < N - 1; ++l) {\n\t\t\tif (check(l, u))sum++;\n\t\t}\n\t}\n\tint ans = sum;\n\tfor (int u = 0; u < M; ++u) {\n\t\tfor (int l = 0; l < N; ++l) {\n\t\t\tint pre = flag[u][l];\n\t\t\tint precount = 0;\n\t\t\tfor (int i = 0; i < 4; ++i) {\n\t\t\t\tconst int nl = l + dx2[i]-1;\n\t\t\t\tconst int nu = u + dy2[i]-1;\n\t\t\t\tif (nl >= 0 && nl < N - 1 && nu >= 0 && nu < M - 1) {\n\t\t\t\t\tif (check(nl, nu))precount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < 3; ++i) {\n\t\t\t\tflag[u][l] = i;\n\t\t\t\tint nextcount = 0;\n\t\t\t\tfor (int i = 0; i < 4; ++i) {\n\t\t\t\t\tconst int nl = l + dx2[i] - 1;\n\t\t\t\t\tconst int nu = u + dy2[i] - 1;\n\t\t\t\t\tif (nl >= 0 && nl < N - 1 && nu >= 0 && nu < M - 1) {\n\t\t\t\t\t\tif (check(nl, nu))nextcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans = max(ans, sum + nextcount - precount);\n\t\t\t}\n\t\t\t\n\t\t\tflag[u][l] = pre;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring c[1002];\nint ruisekiwa[1000][1000];\nint main() {\n\tint a, b;\n\tcin >> a >> b;\n\tfor (int d = 0; d<a; d++) {\n\t\tcin >> c[d];\n\t}\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g<a - 1; g++) {\n\t\tfor (int h = 0; h<b - 1; h++) {\n\t\t\tbool s[2][2]{}; int l = 0;\n\t\t\tfor (int i = 0; i<2; i++) {\n\t\t\t\tfor (int j = 0; j<2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) { l++; s[i][j] = true; }\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\truisekiwa[g + x ][h + y ]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\tif (!s[x][y])ruisekiwa[g + x - 1][h + y - 1]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i<a; i++) {\n\t\tfor (int p = 0; p<a; p++) {\n\t\t\tMAX = max(MAX, ruisekiwa[i][p]);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = long long;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\n\nbool isin(int x, int y, VS& a, VS& b){\n  REP(dy,2) REP(dx,2)\n\tif(a[y+dy][x+dx] != b[dy][dx])\n\t  return false;\n  return true;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  int H, W;\n  cin >> H >> W;\n\n  VS vs(H);\n  REP(y,H) cin >> vs[y];\n\n  VS flag(2);\n  REP(y,2) cin >> flag[y];\n\n  int sum = 0;\n  REP(y,H-1) REP(x,W-1){\n\tif(isin(x, y, vs, flag))\n\t  ++sum;\n  }\n\n  const string JOI = \"JOI\";\n  \n  int ans = sum;\n  REP(y,H) REP(x,W){\n\tchar orig = vs[y][x];\n\tREP(i,3){\n\t  int tmp = sum;\n\t  FOR(ty,y-1,y+1) FOR(tx,x-1,x+1)\n\t\tif(0 <= ty && ty+1 < H && 0 <= tx && tx+1 < W){\n\t\t  if(isin(tx, ty, vs, flag)) --tmp;\n\t\t}\n\t  vs[y][x] = JOI[i];\n\t  FOR(ty,y-1,y+1) FOR(tx,x-1,x+1)\n\t\tif(0 <= ty && ty+1 < H && 0 <= tx && tx+1 < W){\n\t\t  if(isin(tx, ty, vs, flag)) ++tmp;\n\t\t}\n\t  vs[y][x] = orig;\n\t  maxi(ans, tmp);\n\t}\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nstring sa[1005];\nstring sb[2];\nint used[1005][1005][3];\nint main(){\n\tint n,m;\n\tint i,j,k,l;\n\tint s=0,miss=0;\n\tint count=0;\n\tcin>>n>>m;\n\tfor(i=0;i<n;i++){\n\t\tcin>>sa[i];\n\t}\n\tfor(i=0;i<2;i++){\n\t\tcin>>sb[i];\n\t}\n\tfor(i=0;i<n-1;i++){\n\t\tfor(j=0;j<m-1;j++){\n\t\t\ts=0;\n\t\t\tfor(k=0;k<2;k++){for(l=0;l<2;l++){\n\t\t\t\tif(sa[i+k][j+l]==sb[k][l]){\n\t\t\t\t\ts++;\n\t\t\t\t}else{\n\t\t\t\t\tmiss=k*2+l;\n\t\t\t\t}\n\t\t\t}}\n\t\t\tif(s==4)count++;\n\t\t\tif(s==3){\n\t\t\t\tk=miss/2,l=miss%2;\n\t\t\t\tif(sb[k][l]=='J')s=0;\n\t\t\t\tif(sb[k][l]=='O')s=1;\n\t\t\t\tif(sb[k][l]=='I')s=2;\n\t\t\t\tused[i+k][j+l][s]++;\n\t\t\t}\n\t\t}\n\t}\n\tfor(s=0,i=0;i<n;i++){\n\t\tfor(j=0;j<m;j++){\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tif(s<used[i][j][k])s=used[i][j][k];\n\t\t\t}\n\t\t}\n\t}\n\tcount+=s;\n\tcout<<count<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//2014年5月14日\n\n#include<stdio.h>\n#define rep(i,n) for(i = 0;i < n;i++)\n#define DB(x) \t\t\t\t\t\t//デバッグ用\n\nchar flag[1002][1002] = {0};\t//調べたくないところはJ,O,I以外の文字にする。\nchar monsyo[2][3];\t\t\t\t//紋章\nchar hash[4] = \"JOI\";\t\t\t//'0'がつくので4byte確保\n\n//紋章の左上と旗の(x,y)とを合わせたとき、紋章が旗に含まれるか ( 含まれる:1,含まれない:0 )\n//要するに一致判定\nint Check( int x,int y )\n{\n\t/*間違い\n\tint i,j;\n\trep(i,2){\n\t\trep(j,2){\n\t\t\tif( monsyo[i][j] != flag[x+i][y+i] ){\n\t\t\t\tDB( printf(\"Check内 i = %d j = %d\\n\",i,j); )\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tif(i == 2 && j == 2)\n\t\treturn 1;*/\n\tif( monsyo[0][0] == flag[x][y] && monsyo[0][1] == flag[x][y+1] && monsyo[1][0] == flag[x+1][y] && monsyo[1][1] == flag[x+1][y+1] )\n\t\treturn 1;\n\treturn 0;\n}\n\nint main(){\n\tint i,j,k;\t\t//ループ用\n\tchar c;\t\t\t//1文字保存用\n\tint U = 0;\t\t//初期状態でのJOI紋章の数\n\tint u1,u2;\t\t//3*3マスにおけるJOI紋章の数 u1は初期状態,u2は1文字代えた後\n\tint K = 0;\t\t//u2-u1の最大値\n\tint H,W;\t\t//JOI旗の行数,列数\n\n\tscanf(\"%d%d\",&H,&W);\n\trep(i,H){\n\t\tscanf(\"%s\",flag[i+1]+1);\n\t}\n\trep(i,2){\n\t\tscanf(\"%s\",monsyo[i]);\n\t}\n\t\n\tDB(\n\t\t//Check関数のデバッグ\n\t\trep(i,H+1){\n\t\t\trep(j,W+1){\n\t\t\t\tprintf(\"Check(%d,%d) == %d\\n\",i,j,Check(i,j) );\n\t\t\t}\n\t\t}\n\t)\n\n\t//3*3の真ん中が(i,j) ⇔ flag[i][j]を変更\n\trep(i,H+1){\n\t\tif(i == 0)\n\t\t\tcontinue;\n\t\trep(j,W+1){\n\t\t\tif(j == 0)\n\t\t\t\tcontinue;\n\t\t\t//u1を求める\n\t\t\tu1 = Check( i-1,j-1 ) + Check( i-1,j ) + Check( i,j-1 ) + Check( i,j );\n\t\t\t//Uを更新\n\t\t\tU += Check( i,j );\t//U += u1ではない\n\t\t\trep(k,3){\n\t\t\t\tc = flag[i][j];\n\t\t\t\tflag[i][j] = hash[k];\n\t\t\t\t//u2を求める\n\t\t\t\tu2 = Check( i-1,j-1 ) + Check( i-1,j ) + Check( i,j-1 ) + Check( i,j );\n\t\t\t\t//Kを更新\n\t\t\t\tif( K < u2-u1 )\n\t\t\t\t\tK = u2-u1;\n\t\t\t\tflag[i][j] = c;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\", U+K );\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<n;++i)\n\nusing namespace std;\n\ntypedef pair<int,int>P;\n\nconst int MAX_N = 1003;\n\nstring s[MAX_N];\nstring e[2];\nint a[MAX_N][MAX_N];\nint b[MAX_N][MAX_N][3];\nint m,n;\n\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\trep(i,n){\n\t\tcin >> s[i];\n\t}\n\trep(i,2){\n\t\tcin >> e[i];\n\t}\n\trep(i,n){\n\t\trep(j,m){\n\t\t\ta[i][j] = 0;\n\t\t\trep(k,3){\n\t\t\t\tb[i][j][k] = 0;\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\trep(i,n-1){\n\t\trep(j,m-1){\n\t\t\tif(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tans++;\n\t\t\t\trep(k,2){\n\t\t\t\t\trep(l,2){\n\t\t\t\t\t\ta[i+k][j+l] += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1]){\n\t\t\t\tif(e[1][1] == 'J'){\n\t\t\t\t\tb[i+1][j+1][0] += 1;\n\t\t\t\t}else if(e[1][1] == 'O'){\n\t\t\t\t\tb[i+1][j+1][1] += 1;\n\t\t\t\t}else{\n\t\t\t\t\tb[i+1][j+1][2] += 1;\n\t\t\t\t}\n\t\t\t}else if(s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tif(e[0][0] == 'J'){\n\t\t\t\t\tb[i][j][0] += 1;\n\t\t\t\t}else if(e[0][0] == 'O'){\n\t\t\t\t\tb[i][j][1] += 1;\n\t\t\t\t}else{\n\t\t\t\t\tb[i][j][2] += 1;\n\t\t\t\t}\n\t\t\t}else if(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tif(e[0][1] == 'J'){\n\t\t\t\t\tb[i][j+1][0] += 1;\n\t\t\t\t}else if(e[0][1] == 'O'){\n\t\t\t\t\tb[i][j+1][1] += 1;\n\t\t\t\t}else{\n\t\t\t\t\tb[i][j+1][2] += 1;\n\t\t\t\t}\n\t\t\t}else if(s[i][j] == e[0][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tif(e[1][0] == 'J'){\n\t\t\t\t\tb[i+1][j][0] += 1;\n\t\t\t\t}else if(e[1][0] == 'O'){\n\t\t\t\t\tb[i+1][j][1] += 1;\n\t\t\t\t}else{\n\t\t\t\t\tb[i+1][j][2] += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint mx = 0;\n\trep(i,n){\n\t\trep(j,m){\n\t\t\trep(k,3){\n\t\t\t\tmx = max(mx,b[i][j][k]-a[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans+mx << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nconst string JOI = \"JOI\";\n\nint main()\n{\n\tint H, W;\n\n\tscanf(\"%d\", &H);\n\tscanf(\"%d\", &W);\n\n\tvector<string> D(H);\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tcin >> D[i];\n\t}\n\n\tstring C1, C2; cin >> C1 >> C2;\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < H - 1; i++)\n\t{\n\t\tfor (int j = 0; j < W - 1; j++)\n\t\t{\n\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\tif (R1 == C1 && R2 == C2)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint diff, ret = sum;\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tdiff = 0; char prevch = D[i][j];\n\n\t\t\tfor (int k = 0; k < 3; k++)\n\t\t\t{\n\t\t\t\tif (JOI[k] != prevch)\n\t\t\t\t{\n\t\t\t\t\tif (i != 0 && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R3 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\t\tstring R4 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0 && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R3 = D[i - 1].substr(j, 2);\n\t\t\t\t\t\tstring R4 = D[i].substr(j, 2);\n\n\t\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R3 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\tstring R4 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R3 = D[i].substr(j, 2);\n\t\t\t\t\t\tstring R4 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tret = max(ret, sum + diff);\n\t\t\t}\n\n\t\t\tD[i][j] = prevch;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ret);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nchar s[1010][1010];\nstring p,q;\nstring b=\"JOI\";\nint ans,res;\nint cnt(int x,int y){\n\tif(s[x][y]==p[0]&&s[x][y+1]==p[1]&&s[x+1][y]==q[0]&&s[x+1][y+1]==q[1]){\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nint sq(int x,int y){\n\treturn cnt(x-1,y-1)+cnt(x-1,y)+cnt(x,y-1)+cnt(x,y);\n}\nint main(){\n\tint h,w; cin >> h >> w;\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tcin >> s[i][j];\n\t\t}\n\t}\n\tcin >> p >> q;\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tans+=cnt(i,j);\n\t\t\tint v=sq(i,j);\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tchar cp=s[i][j];\n\t\t\t\ts[i][j]=b[k];\n\t\t\t\tres=max(res,sq(i,j)-v);\n\t\t\t\ts[i][j]=cp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans+res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//include----------------------------------------------------------------------------------------------------------------------\n#include <bits/stdc++.h>\n//using namespace--------------------------------------------------------------------------------------------------------------\nusing namespace std;\n\n//define-----------------------------------------------------------------------------------------------------------------------\n#define rep(i, n) for(int i = 0; i < (int)n; i++)\n#define FOR(i, s, n) for(int i = s; i < (int)n; i++)\n#define per(i, n) for(int i = n; i >= 0; i--)\n#define ROF(i, s, n) for(int i = s; i >= (int)n; i--)\n#define FORIT(i, A) for (auto i : A)\n#define PRINT(x) cout << (x) << \"\\n\"\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define EACH(i, n) for (__typeof((n).begin()) i = (n).begin(); i != (n).end(); ++i)\n#define SZ(a) int((a).size())\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n#define dump(x) cout << #x << \" = \" << (x) << \"\\n\";\n#define debug(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << \"\\n\";\n#define sq(n) (n) * (n)\n\n//typedef----------------------------------------------------------------------------------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef priority_queue<int> maxpq;\ntypedef priority_queue< int, vector<int>, greater<int> > minpq;\n//const------------------------------------------------------------------------------------------------------------------------\nstatic const double EPS = 1e-10;\nstatic const double PI = acos( -1.0 );\nstatic const int mod = 1000000007;\nstatic const int INF = 1 << 25;\nstatic const LL LL_INF = 1152921504606846976;\n//global-----------------------------------------------------------------------------------------------------------------------\nVS a;\nstring str;\nVS eb;\nint default_ans = 0;\nint diff_max = 0;\nint diff;\nchar b[1000];\nstring joi = \"JOI\";\nint n, m;\n//#define DEBUG\n//function-------------------------------------------------------------------------------------------------------------------\nint main() {\n\tscanf( \"%d %d\", &n, &m );\n\trep( i, m ) {\n\t\tstr += \"?\";\n\t}\n\ta.PB( str );\n\trep( i, n ) {\n\t\tscanf( \"%s\", b );\n\t\ta.PB( \"?\" + ( string ) b + \"?\" );\n\t}\n\ta.PB( str );\n\trep( i, 2 ) {\n\t\tscanf( \"%s\", b );\n\t\teb.PB( ( string ) b );\n\t}\n\trep( i, n ) {\n\t\trep( j, m - 1 ) {\n\t\t\tif ( a[ i + 1 ][ j + 1 ] == eb[ 0 ][ 0 ] && a[ i + 2 ][ j + 1 ] == eb[ 1 ][ 0 ] && a[ i + 1 ][ j + 2 ] == eb[ 0 ][ 1 ] && a[ i + 2 ][ j + 2 ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\tdefault_ans++;\n\t\t\t}\n\t\t}\n\t}\n\trep( i, 3 ) {\n\t\tFOR( j, 1, n + 1 ) {\n\t\t\tFOR( k, 1, m + 1 ) {\n\t\t\t\tdiff = 0;\n\t\t\t\tif ( joi[ 0 ] == a[ j ][ k ] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j - 1 ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j + 1 ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j ][ k + 1 ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k ] == eb[ 0 ][ 0 ] && a[ j ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j - 1 ][ k + 1 ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j + 1 ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j ][ k + 1 ] == eb[ 0 ][ 1 ] && a[ j + 1 ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdiff_max = max( diff, diff_max );\n\t\t\t}\n\t\t}\n\t}\n\tprintf( \"%d\\n\", default_ans + diff_max );\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<fstream>\n\nusing namespace std;\n\nint ct[1000][1000];\nchar table[1000][1000];\nchar target[2][2];\n\nint N, M;\n\n//(x,y)????????????????????¨????????¨????????????????´????????????????\nbool match(int x, int y) {\n\treturn table[y][x] == target[0][0] && \n\t\ttable[y + 1][x] == target[1][0] && \n\t\ttable[y][x + 1] == target[0][1] && \n\t\ttable[y + 1][x + 1] == target[1][1];\n}\n//(x,y)????????????????´?????????° (x,y)????????????????????????????????????????????§??????\n//?????§4\n/*\n***\n*???*\n***\n*/\nint f(int x, int y) {\n\tint ct = 0;\n\tif (x + 1 < N && y + 1 < M) {\n\t\tif (match(x, y))ct++;\n\t}\n\tif (x - 1 >= 0 && y + 1 < M) {\n\t\tif (match(x - 1, y))ct++;\n\t}\n\tif (x + 1 < N && y >= 0) {\n\t\tif (match(x, y - 1))ct++;\n\t}\n\tif (x >= 0 && y >= 0) {\n\t\tif (match(x - 1, y - 1))ct++;\n\t}\n\treturn ct;\n}\n\nint main() {\n\t\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tcin >> table[i][j];\n\t\t}\n\t}\n\n\tcin >> target[0][0] >> target[0][1] >> target[1][0] >> target[1][1];\n\tint ans = 0, tmp = 0;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tif (i + 1 < M && j + 1 < N )ans += match(j, i);\n\t\t\tct[i][j] = f(j, i);\n\t\t}\n\t}\n\ttmp = ans;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tchar bef = table[i][j];\n\t\t\ttable[i][j] = 'J';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = 'O';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = 'I';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = bef;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nmain(){\n  int n,m;\n  char masu[1002][1002];\n  int mem[1002][1002]={0};\n  int mem2[1002][1002]={0};\n  char monsyou[3][3];\n  int before=0,after=0;\n  char joi[3]={'J','O','I'};\n  int ihu[4]={-1,-1,0,0};\n  int jhu[4]={-1,0,-1,0};\n  int imu[4]={-1,-1,0,0};\n  int jmu[4]={0,1,0,1};\n  int ihs[4]={0,0,1,1};\n  int jhs[4]={-1,0,-1,0};\n  int ims[4]={0,0,1,1};\n  int jms[4]={0,1,0,1};\n  cin>>n>>m;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin>>masu[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      for(int k=0;k<4;k++){\n\tif(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t  before=before+1;\n\t  mem[i][j]=mem[i][j]+1;\n\t}\n      }\n    }\n  }\n  if(before!=0){\n    before=before/4;\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      char kioku;\n      kioku=masu[i][j];\n      for(int a=0;a<3;a++){\n\tif(masu[i][j]!=joi[a]){\n\t  masu[i][j]=joi[a];\n\t  for(int k=0;k<4;k++){\n\t    if(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t      mem2[i][j]=mem[i][j]+1;\n\t    }\n\t  }\n\t  masu[i][j]=kioku;\n\t}\n\tif(mem2[i][j]-mem[i][j]>after){\n\t  after=mem2[i][j]-mem[i][j];\n\t}\n      }\t\n    }\n  }\n  cout<<before+after<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\n#define FOR(i,s,e) for(int i = (s);i <= (e);i++)\n\nint N;\nint M;\n\nstring flag[1000];\nstring emblem[2];\n\nbool issame[1000][1000];\n\n\nint none_cou = 0;\nint main()\n{\n\n\tcin >> M >> N;\n\n\tFOR(i,0,M - 1)\n\t{\n\t\tcin >> flag[i];\n\t}\n\tFOR(i,0,1)\n\t{\n\t\tcin >> emblem[i];\n\t}\n\tFOR(i,0,M - 2)\n\t{\n\t\tFOR(j,0,N - 2)\n\t\t{\n\t\t\tbool same = true;\n\t\t\tFOR(k,0,1)\n\t\t\t{\n\t\t\t\tFOR(l,0,1)\n\t\t\t\t{\n\t\t\t\t\tsame = same && (flag[i + k][j + l] == emblem[k][l]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tissame[i][j] = same;\n\t\t\tif(same)\n\t\t\t{\n\t\t\t\tnone_cou++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint result = none_cou;\n\n\tstring JOI = \"JOI\";\n\tFOR(mi,0,M - 1)\n\t{\n\t\tFOR(ni,0,N - 1)\n\t\t{\n\t\t\tint cou = 0;\n\t\t\tfor(char c : JOI)\n\t\t\t{\n\t\t\t\tint cou = none_cou;\n\t\t\t\tFOR(m,max(mi - 1,0),min(mi,M - 2))\n\t\t\t\t{\n\t\t\t\t\tFOR(n,max(ni - 1,0),min(ni,N - 2))\n\t\t\t\t\t{ \n\t\t\t\t\t\tbool same = true;\n\t\t\t\t\t\tFOR(k,0,1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tFOR(l,0,1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(!(0 <= m + k && m + k < M && 0 <= n + l && n + l < N))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsame = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tchar tmp = flag[m + k][n + l];\n\t\t\t\t\t\t\t\tif(m + k == mi && n + l == ni) tmp = c;\n\t\t\t\t\t\t\t\tsame = same && (emblem[k][l] == tmp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(same && (issame[m][n] == false))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcou++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( !same && issame[m][n])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcou--;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresult = max(result,cou);\n\t\t\t\tif(result == cou)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcout  << result << endl;\n\treturn 0;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y && dx >= 0; dy++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx = x - 2,dy = y - 2; dx <= x && dy >= 0; dx++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n        }\n        else{\n          dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nint n, m;\nchar c[1080][1080];\nint cnt[1080][1080];\nint ans[2][2], anss, res;\nint main(){\n\tcin >> m >> n;\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++) \n\t\t\tcin >> c[i][j];\n\t\n\tfor(int i = 0;i < 2;i++)\n\t\tfor(int j = 0;j < 2;j++)\n\t\t\tcin >> ans[i][j];\n\t\t\t\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tcnt[i][j] = 1;\n\t\t  \tfor(int k = 0;k < 2;k++)\n\t\t\t\tfor(int l = 0;l < 2;l++)\n\t\t\t\t\tif(c[i + k][j + l] != ans[k][l])cnt[i][j] = 0;\n\t\t\tres += cnt[i][j];\n\t\t}\n\t\n\tint anss = res;\n\tfor(int i = 1;i <= m;i++){\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tint last = c[i][j];\n\t\t\tint tres;\n\t\t\tc[i][j] = 'J';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p]tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\tc[i][j] = 'O';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p]tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = 'I';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p]tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = last;\n\t\t}\n\t}\n\tcout << anss << endl;\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1010][1010],pat[5][5];\nint n,m;\nstring ch=\"JOI\";\n\nbool match(int x,int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>0 && ny>0)res+=match(nx,ny);\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      if(match(j,i))res+=1;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<n;i++){    \n     for(int j=0;j<m;j++){\n       char tmp=g[i][j];\n\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> n >> m;\n  \n  fill(g[0],g[1010],NULL);\n  fill(pat[0],pat[5],NULL);\n\n  for(int i=0;i<n;i++){\n    cin >> g[i];\n  }\n\n  for(int i=0;i<2;i++){\n    cin >> pat[i];\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n\nusing namespace std ;\n\nint main()\n{\n\tint n ,m ;\n\tcin >> n >> m ;\n\tchar c[ n ][ m + 1 ] ;\n\tfor( int i = 0 ; i < n ; i++ )\n\t\tcin >> c[ i ] ;\n\tchar ch[ 2 ][ 3 ] ;\n\tcin >> ch[ 0 ] ;\n\tcin >> ch[ 1 ] ;\n\tint cnt1 = 0 ,cnt2 = 0 ;\n\tfor( int i = 0 ; i < n ; i++ )\n\t{\n\t\tfor( int j = 0 ; j < m ; j++ )\n\t\t{\n\t\t\tif( c[ i ][ j ] == ch[ 0 ][ 0 ] && c[ i ][ j + 1 ] == ch[ 0 ][ 1 ] )\n\t\t\t\tcnt1++ ;\n\t\t\tif( c[ i + 1 ][ j ] == ch[ 1 ][ 0 ] && c[ i + 1 ][ j + 1 ] == ch[ 1 ][ 1 ] )\n\t\t\t\tcnt2++ ;\n\t\t}\n\t}\n\tcout << ( cnt1 < cnt2 ? cnt1 : cnt2 ) << endl ;\n\treturn 0 ;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://joi2014ho.contest.atcoder.jp/img/other/joi2014ho/joi2014ho1.pdf>\n ?????????============================================================\n JOI???????????????JOI???????????£?????¢?????????M(2<=M<=1000)???????¨????N(2<=N<=1000)????????????\n ??¢???????????????????????£?????¢??????J,O,I???????????????????????????1???????????????????????????\n \n ?????±????????????????????\\??¬?§??????????JOI ?????¨?????\\???JOI ?´??????¨????????????????±????????????????\n JOI ?´????????????£?????¢?????????2 ???????¨????2 ??????????????¢??????????????????\n ?????£?????¢??????J???O???I ???????????????????????????1 ??????????????????????????????\n \n JOI ??????????????????JOI ?´????????????°??¨??????JOI ?????????????????????2 ???????¨?2 ????????????????????????\n ???????????????J???O???I ????????????JOI ?´??????¨(?????¢????£???????????????????) ?????´??????????????????????????°????????¨??§?????????\n ?????¶???????????????2 ???????¨?2 ????????????????£????????????£??????????????????????????\\????????°??????????????¨?????????\n \n ?????±????????????????????\\??¬?§????????????????JOI ?????¨1 ??????????´?????????£????????????\n ????´????JOI ???????§????????????£?????¢1 ???????????§????????§???J???O???I ??????????\\???????1 ??????????????????????????¨?????§?????????\n ?????±????????????????????\\??¬?§????????????\\??????????????????1 ??????????????????????????°??????JOI ???????????????????????¨????????????\n \n ?????????JOI ??????????????????????????????????????????????????°??????JOI ?????¨?????????????´?????????¨????????????\n ???????´????1 ???????????????????????????JOI ???????????????????????£?????¢????????????????????????????????¨??§??????JOI ????????????1 ??????????????´??????\n ????????´??????JOI ????????°??????JOI ?????¨?????????\n \n ?????±????????????????????\\??¬?§????????????°??????JOI ??????????????????JOI ?´????????????°?????§?????????????????????????????¨?????£????????????\n ??????????????°??????JOI ??????????????????JOI ?´????????????°????????§???????±????????????¨????????£??????\n =================================================================\n ?§£??¬=============================================================\n ================================================================\n */\nvector<vector<char>> m;\nchar flag[2][2];\nll Cnt = 0;\nll res = 0;\nll M,N;\n\nll calc(int y,int x,char c){\n    ll cnt1 = 0;\n    for(int i = y - 1; i <= y;i++){\n        for(int j = x - 1; j<=x;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            cnt1++;\n        }\n    }\n    char C = m[y][x];\n    m[y][x] = c;\n    ll cnt2 = 0;\n    for(int i = y - 1; i <= y;i++){\n        for(int j = x - 1; j<=x;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            cnt2++;\n        }\n    }\n    m[y][x] = C;\n    return cnt2 - cnt1;\n}\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    cin >> M >> N;\n    m.assign(M+2,vector<char>(N+2,'#'));\n    for(int i = 1; i <= M;i++)for(int j = 1; j<=N;j++) cin >> m[i][j];\n    for(int i = 0; i < 2;i++)for(int j = 0; j < 2;j++) cin >> flag[i][j];\n    for(int i = 1; i < M;i++){\n        for(int j = 1; j < N;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            Cnt++;\n        }\n    }\n    res = Cnt;\n    ll tmp = 0;\n    for(int i = 1; i <= M;i++){\n        for(int j = 1; j <= N;j++){\n            tmp = max(tmp,calc(i,j,'J'));\n            tmp = max(tmp,calc(i,j,'O'));\n            tmp = max(tmp,calc(i,j,'I'));\n        }\n    }\n    \n    cout << res + tmp << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1001][1001];\nchar haku[1001][1001];\nbool a[1001][1001];\nbool deki[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  char mozi;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  memset(mas,0,sizeof(mas));\n  memset(haku,0,sizeof(haku));\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      haku[i][j]=mas[i][j];\n      a[i][j]=false;\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(key[k][l]==mas[i+k][j+l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4){\n\tans++;\n\tdeki[i][j]=deki[i+1][j+1]=deki[i+1][j]=deki[i][j+1]=true;\n      }else if(cnt==3){\n\ta[i][j]=true;\n      }\n    }\n  }\n  int cnnt=-111;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      if(a[i][j]){\n\tint x,y;\n\tfor(int k=0;k<2;k++){\n\t  for(int l=0;l<2;l++){\n\t    if(mas[i+k][j+l]!=key[k][l]){\n\t      haku[i+k][j+l]=key[k][l];\n\t      x=i+k;\n\t      y=j+l;\n\t      cnt++;\n\t    }\n\t    if(mas[i+k][j+l]!=key[k][l] && deki[i+k][j+l]){\n\t      cnt--;\n\t    }\n\t  }\n\t}\n\tint mozicnt=0;\n\tif(i-1>=0 && j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(i-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\thaku[x][y]=mas[x][y];\n      }\n      cnnt=max(cnnt,cnt);\n    }\n  }\n  ans+=cnnt;\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint mp[3][1000][1000] = {};\nstring str[1000];\nstring joi[2];\nint co=0;\n\nvoid che(int a,int b){\n  int f=0;\n  int x,y,x2,y2;\n  for(int i=0;i<2;i++)\n    for(int j=0;j<2;j++)\n      if(str[i+a][j+b]!=joi[i][j]){f++;x=j+b;y=i+a;x2=j;y2=i;}\n  \n  if(f==0){\n    co++;\n    for(int i=0;i<2;i++)\n      for(int j=0;j<2;j++)\n\tfor(int k=0;k<3;k++)\n\t  mp[k][i][j]--;\n  }\n  else if(f==1){\n    if(joi[y2][x2]=='J') mp[0][y][x]++;\n    else if(joi[y2][x2]=='O') mp[1][y][x]++;\n    else if(joi[y2][x2]=='I') mp[2][y][x]++;\n  }\n}\n\n\nint main(){\n  int m,n;\n  cin>>m>>n;\n\n  for(int i=0;i<m;i++) cin>>str[i];\n  for(int i=0;i<2;i++) cin>>joi[i];\n\n  for(int i=0;i<m-1;i++)\n    for(int j=0;j<n-1;j++)\n      che(i,j);\n  int mpmax=0;\n  for(int i=0;i<m;i++)\n    for(int j=0;j<n;j++)\n      for(int k=0;k<3;k++)\n\tif(mpmax<mp[k][i][j]) \n\t  mpmax = mp[k][i][j];\n  cout <<co+mpmax<<endl;  \n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint a1=0,a2,a3,a4;\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\ta1=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a1+=1;\n\t\t\tC=D[i][j];\n\t\t\tD[i][j]='J';\n\t\t\ta2=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a2+=1;\n\t\t\tD[i][j]='O';\n\t\t\ta3=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a3+=1;\n\t\t\tD[i][j]='I';\n\t\t\ta4=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a4+=1;\n\t\t\tD[i][j]=C;\n\n\t\t\tR=max(R,a+a2-a1);\n\t\t\tR=max(R,a+a3-a1);\n\t\t\tR=max(R,a+a4-a1);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\n\nchar c[1010][1010];\nchar joi[2][2];\nint H,W;\n\nint isjoi(int x,int y){\n\tif( x < 0 || y < 0 || x == W - 1 || y == H - 1 ) return 0;\n\tfor(int i = 0 ; i < 2 ; i++)\n\t\tfor(int j = 0 ; j < 2 ; j++)\n\t\t\tif( joi[i][j] != c[y+i][x+j] ) return 0;\n\treturn 1;\n}\n\nint main(){\n\tcin >> H >> W;\n\tint ans = 0;\n\tfor(int i = 0 ; i < H ; i++){\n\t\tfor(int j = 0 ; j < W ; j++){\n\t\t\tcin >> c[i][j];\n\t\t\tans += isjoi(j-1,i-1);\n\t\t}\n\t}\n\tfor(int i = 0 ; i < 2 ; i++)\n\t\tfor(int j = 0 ; j < 2 ; j++)\n\t\t\tcin >> joi[i][j];\n\tfor(int i = 0 ; i < H ; i++){\n\t\tfor(int j = 0 ; j < W ; j++){\n\t\t\tans += isjoi(j,i);\n\t\t}\n\t}\n\tint mans = ans;\n\tfor(int i = 0 ; i < H ; i++){\n\t\tfor(int j = 0 ; j < W ; j++){\n\t\t\tfor(int k = 0 ; k < 3 ; k++){\n\t\t\t\tint tmp = ans - isjoi(j-1,i-1) - isjoi(j,i-1) - isjoi(j,i) - isjoi(j-1,i);\n\t\t\t\tchar z = c[i][j];\n\t\t\t\tc[i][j] = \"JOI\"[k];\n\t\t\t\ttmp += isjoi(j-1,i-1) + isjoi(j,i-1) + isjoi(j,i) + isjoi(j-1,i);\n\t\t\t\tmans = max(tmp,mans);\n\t\t\t\tc[i][j] = z;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t} \n\tcout << mans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"math.h\"\n#include \"utility\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"iomanip\"\n#include \"random\"\n\nusing namespace std;\nconst long long int MOD = 1000000007;\n\nint H, W;\nint fst;\nint add;\nbool exist[1002][1002];\nchar mod[3] = { 'J','O','I' };\nint ans;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> H >> W;\n\tvector<string>field(H + 2);\n\tvector<string>joi(2);\n\tfor (int i = 1; i <= H; i++) {\n\t\tcin >> field[i];\n\t\tfield[i] = '0' + field[i] + '0';\n\t}\n\tfor (int i = 0; i < W + 2;i++) {\n\t\tfield[0] += '0';\n\t\tfield[H + 1] += '0';\n\t}\n\tfor (int i = 0; i <= 1; i++)cin >> joi[i];\n\tfor (int i = 1; i < H; i++) \n\t\tfor (int j = 1; j < W; j++) {\n\t\t\tbool flag = true;\n\t\t\tfor (int k = 0; k < 2; k++)\n\t\t\t\tfor (int l = 0; l < 2; l++)\n\t\t\t\t\tif (field[i + k][j + l] != joi[k][l])flag = false;\n\t\t\tif (flag) {\n\t\t\t\tfst++;\n\t\t\t\texist[i][j] = true;\n\t\t\t}\n\t\t}\n\n\tfor (int i = 1; i <= H; i++)\n\t\tfor (int j = 1; j <= W; j++) {\n\t\t\tint box = 0;\n\t\t\tfor (int k = -1; k <= 0; k++)\n\t\t\t\tfor (int l = -1; l <= 0; l++)if (exist[i + k][j + l])box--;\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tint bag=0;\n\t\t\t\tfor(int l=-1;l<=0;l++)\n\t\t\t\t\tfor (int m = -1; m <= 0; m++) {\n\t\t\t\t\t\tbool flag = true;\n\t\t\t\t\t\tfor (int n = 0; n <= 1; n++)\n\t\t\t\t\t\t\tfor (int o = 0; o <= 1; o++) {\n\t\t\t\t\t\t\t\tif (!n && !o) {\n\t\t\t\t\t\t\t\t\tif (mod[k] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (field[1 + l + n][j + m + o] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flag)bag++;\n\t\t\t\t\t}\n\t\t\t\t//cout << mod[k] << \" \" << box << \" \" << bag << endl;\n\t\t\t\tans = max(ans, fst + box + bag);\n\t\t\t}\n\t\t}\n//\tcout << fst << endl;\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define int long long\n \n#define INF (1<<61)\n \nusing namespace std;\n \ntypedef pair<int, int> Pii;\n \nint h, w, flag[1010][1010] = {0}, emblem[4];\n \nbool IsEmblem(int x, int y) {\n    int dx[] = {0, 1, 0, 1}, dy[] = {0, 0, 1, 1};\n    for (int i = 0; i < 4; ++i)\n        if (flag[x + dx[i]][y + dy[i]] != emblem[i]) return false;\n \n    return true;\n}\n \nsigned main() {\n    cin >> h >> w;\n \n    for (int y = 1; y <= h; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 1; x <= w; ++x) {\n            switch (temp[x - 1]) {\n                case 'J':\n                    flag[x][y] = 1;\n                    break;\n                case 'O':\n                    flag[x][y] = 2;\n                    break;\n                case 'I':\n                    flag[x][y] = 3;\n            }\n        }\n    }\n \n    for (int y = 0; y < 2; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 0; x < 2; ++x) {\n            int i = x + (2 * y);\n            switch (temp[x]) {\n                case 'J':\n                    emblem[i] = 1;\n                    break;\n                case 'O':\n                    emblem[i] = 2;\n                    break;\n                case 'I':\n                    emblem[i] = 3;\n            }\n        }\n    }\n \n    int base = 0;\n    for (int y = 1; y < h; ++y) {\n        for (int x = 1; x < w; ++x) {\n            if (IsEmblem(x, y)) base++;\n        }\n    }\n \n    int max = 0, dx[] = {-1, 0, -1, 0}, dy[] = {-1, -1, 0, 0};\n    for (int y = 1; y <= h; ++y) {\n        for (int x = 1; x <= w; ++x) {\n            for (int i = 1; i < 4; ++i) {\n                int temp = flag[x][y], count = 0, countb = 0;\n\n                for (int j = 0; j < 4; ++j) {\n                    if (IsEmblem(x + dx[j], y + dy[j])) countb++;\n                }\n\n                flag[x][y] = i;\n \n                for (int j = 0; j < 4; ++j) {\n                    if (IsEmblem(x + dx[j], y + dy[j])) count++;\n                }\n \n                count -= countb;\n                if (max < count) max = count;\n                flag[x][y] = temp;\n            }\n        }\n    }\n \n    cout << base + max << endl;\n \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<unordered_map>\n#include<string>\n#include<algorithm>\nusing namespace std;\n\nstruct masu {\n\tint hiku;\n\tunordered_map<char, int>tasu;\n};\nmasu t[1000][1000];\nint main() {\n\tcout << 3 << endl;\n\tint a, b;\n\tcin >> a >> b;\n\tstring c[1000];\n\tfor (int d = 0; d < a; d++)cin >> c[d];\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g < a - 1; g++) {\n\t\tfor (int h = 0; h < b - 1; h++) {\n\t\t\tint l = 0; bool r[2][2];\n\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\tl++;\n\t\t\t\t\t\tr[i][j] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\t\tt[g + i][h + j].hiku++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (r[i][j])t[g + i][h + j].tasu[c[g + i][h + j]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i < a; i++) {\n\t\tfor (int j = 0; j < b; j++) {\n\t\t\tMAX = max(MAX, max({ t[i][j].tasu['J'],t[i][j].tasu['O'] ,t[i][j].tasu['I'] }) - t[i][j].hiku);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nconst string JOI = \"JOI\";\n\nint main()\n{\n\tint H, W;\n\n\tscanf(\"%d\", &H);\n\tscanf(\"%d\", &W);\n\n\tvector<string> D(H);\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tcin >> D[i];\n\t}\n\n\tstring C1, C2; cin >> C1 >> C2;\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < H - 1; i++)\n\t{\n\t\tfor (int j = 0; j < W - 1; j++)\n\t\t{\n\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\tif (R1 == C1 && R2 == C2)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint diff, ret = sum;\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tdiff = 0; char prevch = D[i][j];\n\n\t\t\tfor (int k = 0; k < 3; k++)\n\t\t\t{\n\t\t\t\tif (JOI[k] != prevch)\n\t\t\t\t{\n\t\t\t\t\tif (i != 0 && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff -= (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0 && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\t\t\tdiff -= (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff -= (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\t\tdiff -= (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tret = max(ret, sum + diff);\n\t\t\t}\n\n\t\t\tD[i][j] = prevch;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ret);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint m, n;\nvector<string> v;\nvector<string> w;\nint c;\nchar x[4] = \"JOI\";\nint ans;\n\nint count(int p, int q){\n\tint z = 0;\n\tfor(int i=0; i<2; i++){\n\t\tfor(int j=0; j<2; j++){\n\t\t\tif(0 <= p+i && p+i+1 <= m-1 && 0 <= q+j && q+j+1 <= n-1){\n\t\t\t\tbool b = true;\n\t\t\t\tfor(int k=0; k<2; k++)\n\t\t\t\t\tfor(int l=0; l<2; l++)\n\t\t\t\t\t\tif(v[p+i+k][q+j+l] != w[k][l]) b = false;\n\t\t\t\tif(b) z++;\n\t\t\t}\n\t\t}\n\t}\n\treturn z;\n}\n\nint main(){\n\tscanf(\"%d %d\", &m, &n);\n\tfor(int i=0; i<m; i++){\n\t\tchar t[n+1];\n\t\tscanf(\"%s\", t);\n\t\tv.push_back(t);\n\t}\n\tfor(int i=0; i<2; i++){\n\t\tchar t[3];\n\t\tscanf(\"%s\", t);\n\t\tw.push_back(t);\n\t}\n\n\tfor(int i=0; i<m-1; i++){\n\t\tfor(int j=0; j<n-1; j++){\n\t\t\tbool b = true;\n\t\t\tfor(int k=0; k<2; k++)\n\t\t\t\tfor(int l=0; l<2; l++)\n\t\t\t\t\tif(v[i+k][j+l] != w[k][l]) b = false;\n\t\t\tif(b) ans++;\n\t\t}\n\t}\n\n\tfor(int i=0; i<m; i++){\n\t\tfor(int j=0; j<n; j++){\n\t\t\tint a = count(i-1, j-1);\n\t\t\tfor(int k=0; k<3; k++){\n\t\t\t\tchar y[2];\n\t\t\t\ty[0] = v[i][j];\n\t\t\t\tv[i][j] = x[k];\n\t\t\t\tint b = count(i-1, j-1);\n\t\t\t\tans = max(ans, ans + b - a);\n\t\t\t\tv[i][j] = y[0];\n\t\t\t}\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst char c[] = {'J', 'O', 'I'};\n\nint main(void){\n  int H, W;\n  cin >> H >> W;\n  int cnt = 0;\n  vector< vector <char> > f(H, vector<char>(W));\n  vector< vector <char> > e(2, vector<char>(2));\n  for(int i=0; i < H; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++)\n      f[i][p] = tmp[p];\n  }\n\n  for(int i=0; i < 2; i++){\n    string tmp; cin >> tmp;\n    for(unsigned int p=0; p < tmp.length(); p++){\n      e[i][p] = tmp[p];\n    }\n  }\n\n  for(int p=0; p < H-1; p++){\n    for(int q=0; q < W-1; q++){\n      \n      bool flg = true;\n      for(int r=0; r < 2; r++){\n\tfor(int s=0; s < 2; s++){\n\t  if(f[p+r][q+s] == e[r][s]){\n\t  }else{\n\t    flg = false;\n\t  }\n\t}\n      }\n      if(flg){\n\tcnt++;\n      }\n\n    }\n  }\n\n  int ans = cnt;\n  for(int p=0; p < H; p++){\n    for(int q=0; q < W; q++){\n      //changeGrid\n      char moto = f[p][q];\n      int ccnt = cnt;\n      for(int z=0; z < 3; z++){\n\tif(c[z] == moto) continue;\n\tf[p][q] = c[z];\n\tif(p == H-1 && q == 0){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r-1][q+s]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\telse if(p == 0 && q == W-1){\n\t  bool flg = true;\n\t  for(int r=0; r < 2; r++){\n\t    for(int s=0; s < 2; s++){\n\t      if(f[p+r][q+s-1]){\n\t      }else{\n\t\tflg = false;\n\t      }\n\t    }\n\t  }\n\t  if(flg){\n\t    ccnt++;\n\t  }\n\t}\n\t\n\telse if(p == 0 || q == 0){\n\t  if(p==0 && q==0){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r][q+r] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p==0){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\n\t}else if(p == H-1 || q == W-1){\n\t  if(p==H-1 && q==W-1){\n\t    bool flg = true;\n\t    for(int r=0; r < 2; r++){\n\t      for(int s=0; s < 2; s++){\n\t\tif(f[p+r-1][q+s-1] == e[r][s]){\n\t\t}else{\n\t\t  flg = false;\n\t\t}\n\t      }\n\t    }\n\t    if(flg){\n\t      ccnt++;\n\t    }\n\n\t  }else if(p == H-1){\n\t    for(int n=-1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r-1][q+s+n] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\n\t  }else{\n\t    cout << \"D\" << endl;\n\t    for(int m=-1; m <= 0; m++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+s-1] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t    cout << \"D\" << endl;\n\t  }\n\n\t}else{\n\t\n\t  for(int m=-1; m <= 0; m++){\n\t    for(int n = -1; n <= 0; n++){\n\t      bool flg = true;\n\t      for(int r=0; r < 2; r++){\n\t\tfor(int s=0; s < 2; s++){\n\t\t  if(f[p+r+m][q+r+m] == e[r][s]){\n\t\t  }else{\n\t\t    flg = false;\n\t\t  }\n\t\t}\n\t      }\n\t      if(flg){\n\t\tccnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\t\n      }\n      ans = max(ans, ccnt);\n    }\n  }\n  \n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring c[1002];\nint ruisekiwa[1000][1000];\nint main() {\n\tint a, b;\n\tcin >> a >> b;\n\tfor (int d = 0; d<a; d++) {\n\t\tcin >> c[d];\n\t}\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g<a - 1; g++) {\n\t\tfor (int h = 0; h<b - 1; h++) {\n\t\t\tbool s[2][2]{}; int l = 0;\n\t\t\tfor (int i = 0; i<2; i++) {\n\t\t\t\tfor (int j = 0; j<2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) { l++; s[i][j] = true; }\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\truisekiwa[g + x][h + y]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int x = 0; x<2; x++) {\n\t\t\t\t\tfor (int y = 0; y<2; y++) {\n\t\t\t\t\t\tif (!s[x][y])ruisekiwa[g + x][h + y]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i<a; i++) {\n\t\tfor (int p = 0; p<b; p++) {\n\t\t\tMAX = max(MAX, ruisekiwa[i][p]);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n#define ALL(x) begin(x), end(x)\nvector<string> field,squ;\nint check(int x,int y){\n  for(int i =0 ;i < 2;i++){\n\tfor(int j = 0;j < 2;j++){\n\t  if(field[y+i][x+j] != squ[i][j])return 0;\n\t}\n  }\n  return 1;\n}\nint main(){\n  int n,m;\n  cin >> m >> n;\n  field = vector<string>(m);\n  for(int i = 0;i < m;i++){\n\tcin >> field[i];\n  }\n  squ = vector<string>(2);\n  for(int i = 0;i < 2;i++){\n\tcin >> squ[i];\n  }\n  vector<vector<int> > cnt(m,vector<int>(n,0));\n  int sum = 0;\n  for(int i = 0;i < m-1;i++){\n\tfor(int j = 0;j < n-1;j++){\n\t  if(check(j,i)){\n\t\tcnt[i][j] = 1;\n\t\tsum++;\n\t  }\n\t}\n  }\n\n  int ans = sum;\n  string str = \"JOI\";\n  int dx[] = {-1,1,1,-1};\n  int dy[] = {-1,-1,1,1};\n  int dxx[] = {-1,0,-1,0};\n  int dyy[] = {-1,-1,0,0};\n  for(int i = 0;i < m;i++){\n\tfor(int j = 0;j < n;j++){\n\t  char keep = field[i][j];\n\t  for(int l = 0;l < str.size();l++){\n\t\tfield[i][j] = str[l];\n\t\tint tmp = 0;\n\t\tfor(int k = 0;k < 4;k++){\n\t\t  if(i+dy[k] >= m || i+dy[k] < 0 || j+dx[k] >= n || j+dx[k] < 0)continue;\n\t\t  int res = check(j+dxx[k],i+dyy[k]);\n\t\t  tmp+=res - cnt[i+dyy[k]][j+dxx[k]];\n\t\t}\n\t\tans = max(ans,tmp+sum);\n\t  }\n\t  field[i][j] = keep;\n\t}\n  }\n  cout << ans << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <fstream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <set>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <sstream>\n#include <fstream>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n#define int long long\nconst int mod = 1000000007;\n\nchar flag[1000][1000] = {};\nint ks[1000][1000] = {};\nint z[1000][1000] = {};\nchar base[2][2];\nsigned main()\n{\n\tint ans = 0;\n\tint H, W; cin >> H >> W;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> base[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tint tmp = 0;\n\t\t\tint x, y;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (flag[i + k][j + l] == base[k][l]) {\n\t\t\t\t\t\ttmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx = i + k; y = j + l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == 4) {\n\t\t\t\tans++;\n\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\tks[i + k][j + l]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tmp == 3) z[x][y]++;\n\t\t}\n\t}\n\tint tmp = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tif (z[i][j] != 0) {\n\t\t\t\ttmp = max(tmp, abs(ks[i][j] - z[i][j]));\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcout << ans+tmp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include <iostream>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<queue>\n#include<vector>\n#include<functional>\n#include<cmath>\n#include<map>\n#include<stack>\n#include<cstdlib>\n#include<list>\n#include<set>\n#include<numeric>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nchar board[1001][1001];\nchar pattern[5][5];\nchar tmp[5];\n\nint main()\n{\n\tint N, M;  cin >> N >> M;\n\n\tfor (int i = 0; i < N; i++) {\n\t\tfor (int j = 0; j < M; j++) {\n\t\t\tcin >> board[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < 2; i++)\n\t\tfor (int j = 0; j < 2; j++)\n\t\t\tcin >> pattern[i][j];\n\n\ttmp[0] = pattern[0][0], tmp[1] = pattern[0][1];\n\ttmp[2] = pattern[1][0], tmp[3] = pattern[1][1];\n\tint ans = 0,flag = 0,ind=0;\n\t\n\tfor (int i = 0; i < N - 1; i++) {\n\t\tfor (int j = 0; j < M - 1; j++) {\n\t\t\t\tint cnt = 0;\n\t\t\t\tif (pattern[0][0] != board[i][j]) \n\t\t\t\t\tcnt++,ind = 0;\n\t\t\t\tif (pattern[0][1] != board[i][j + 1]) \n\t\t\t\t\tcnt++,ind = 1;\n\t\t\t\tif (pattern[1][0] != board[i + 1][j]) \n\t\t\t\t\tcnt++,ind = 2;\n\t\t\t\tif (pattern[1][1] != board[i + 1][j + 1]) \n\t\t\t\t\tcnt++,ind = 3;\n\t\t\t\tif (cnt == 1 && !flag) {\n\t\t\t\t\tflag = 1;\n\t\t\t\t\tif (ind == 0)board[i][j] = tmp[ind];\n\t\t\t\t\tif (ind == 1)board[i][j+1] = tmp[ind];\n\t\t\t\t\tif (ind == 2)board[i+1][j] = tmp[ind];\n\t\t\t\t\tif (ind == 3)board[i+1][j+1] = tmp[ind];\n\t\t\t\t\tans++;\n\t\t\t\t}\n\t\t\t\telse if (cnt == 0)ans++;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <algorithm>\n\n#define rep(x,y) for(int x=0;x<(y);x++)\n\nusing namespace std;\n\nint M,N;\nchar f[1024][1024];\nchar e[4][4];\nchar joi[]={'J','O','I'};\n\nint same(int y, int x){\n  if(y+1 >= M || x+1 >= N || y < 0 || x < 0) return 0;\n  rep(i,2) rep(j,2) if(f[y+i][x+j] != e[i][j]) return 0;\n  return 1;\n}\n\nint main(){\n  scanf(\"%d%d\", &M, &N);\n  rep(i,M) scanf(\"%s\", f[i]);\n  rep(i,2) scanf(\"%s\", e[i]);\n\n  int sum = 0;\n  rep(i,M-1) rep(j,N-1) if(same(i,j)) sum++;\n  int res = sum;\n  rep(i,M) rep(j,N) rep(al,3){\n    if(f[i][j]==joi[al]) continue;\n    int diff = 0;\n    for(int k=max(0,i-1);k<=min(M-2,i);k++){\n      for(int l=max(0,j-1);l<=min(N-2,j);l++){\n\tif(same(k,l)) diff--;\n      }\n    }\n    char tmp = f[i][j];\n    f[i][j] = joi[al];\n\n    for(int k=max(0,i-1);k<=min(M-2,i);k++){\n      for(int l=max(0,j-1);l<=min(N-2,j);l++){\n\tif(same(k,l)) diff++;\n      }\n    }\n    f[i][j] = tmp;\n\n    res= max(res, sum+diff);\n  }\n\n  printf(\"%d\\n\", res);\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1010];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define MP make_pair\n#define PB push_back\n#define F first\n#define S second\n#define INF 1 << 30\n#define EPS 1e-10\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint flag[1024][1024], cr[2][2], M, N;\n\nint count(int y, int x){\n  int res = 0;\n  REP(i, -1, 1) REP(j, -1, 1){\n    int ny = y+i, nx = x+j;\n    if(ny < 0 || nx < 0 || ny+1 >= M || nx+1 >= N) continue;\n    int f = 1;\n    rep(k, 2) rep(l, 2) if(flag[ny+k][nx+l] != cr[k][l]) f = 0;\n    res += f;\n  }\n  return res;\n}\n\nint main(){\n  char in[1024];\n  scanf(\"%d%d\", &M, &N);\n  rep(i, M){\n    scanf(\"%s\", in);\n    rep(j, N){\n      if(in[j] == 'J') flag[i][j] = 0;\n      else if(in[j] == 'O') flag[i][j] = 1;\n      else flag[i][j] = 2;\n    }\n  }\n  rep(i, 2){\n    scanf(\"%s\", in);\n    rep(j, 2){\n      switch(in[j]){\n      case 'J': cr[i][j] = 0; break;\n      case 'O': cr[i][j] = 1; break;\n      case 'I': cr[i][j] = 2; break;\n      }\n    }\n  }\n\n  int sum = 0;\n  rep(i, M-1) rep(j, N-1){\n    if(flag[i][j] != cr[0][0]) continue;\n    if(flag[i+1][j] == cr[1][0] && flag[i+1][j+1] == cr[1][1] && flag[i][j+1] == cr[0][1]) sum++;\n  }\n\n  int res = 0;\n  rep(i, M) rep(j, N){\n    int tmpc = count(i, j), tmp = flag[i][j];\n    rep(k, 3){\n      if(tmp == k) continue;\n      flag[i][j] = k;\n      res = max(res, sum - tmpc + count(i, j));\n    }\n    flag[i][j] = tmp;\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#define INF 999999999\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nint m, n;\nchar f[1050][1050];\nchar em[3][3];\n\nchar flag[4] = { 'J','O','I' };\n\nbool emblem(int i,int j)\n{\n\tif (f[i][j] == em[0][0]) {\n\t\tif (f[i][j + 1] == em[0][1]) {\n\t\t\tif (f[i + 1][j] == em[1][0]) {\n\t\t\t\tif (f[i + 1][j + 1] == em[1][1]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n\nint fchange(char a,int i,int j)\n{\n\tchar b = f[i][j];\n\tf[i][j] = a;\n\n\tint res = 0;\n\n\tint plus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\tf[i][j] = b;\n\tint minus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\n\t//cout << \"plus:\" << plus << \"minus\" << minus << endl;\n\treturn plus - minus;\n\n}\n\nint main()\n{\n\tcin >> m >> n;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tcin >> f[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> em[i][j];\n\t\t}\n\t}\n\n\tint num = 0;\n\tvector<P> change;\n\n\tfor (int i = 1; i <= n - 1; i++) {\n\t\tfor (int j = 1; j <= n - 1; j++) {\n\t\t\tint lu = 0, ru = 0, ll = 0, rl = 0;\n\t\t\tif (f[i][j] == em[0][0])lu = 1;\n\t\t\tif (f[i][j + 1] == em[0][1])ru = 1;\n\t\t\tif (f[i + 1][j] == em[1][0])ll = 1;\n\t\t\tif (f[i + 1][j + 1] == em[1][1])rl = 1;\n\n\t\t\tif (lu + ru + ll + rl == 4) {\n\t\t\t\tnum++;\n\t\t\t}\n\t\t\telse if (lu + ru + ll + rl == 3) {\n\t\t\t\tif (lu == 0)change.push_back(P(i, j));\n\t\t\t\tif (ru == 0)change.push_back(P(i, j + 1));\n\t\t\t\tif (ll == 0)change.push_back(P(i + 1, j));\n\t\t\t\tif (rl == 0)change.push_back(P(i + 1, j + 1));\n\t\t\t}\n\n\t\t}\n\t}\n\t//cout << \"num:\" << num << endl;\n\n\tint max = 0;\n\tfor (int i = 0; i < change.size(); i++) {\n\t\t//cout << \"change:\"<<change[i].first << change[i].second << endl;\n\t\tint imax = 0;\n\t\tfor(int j = 0; j < 3; j++) {\n\t\t\tint k = fchange(flag[j], change[i].first, change[i].second);\n\t\t\tif (k > imax)imax = k;\n\t\t}\n\t\tif (imax > max)max = imax;\n\t}\n\n\tcout << num + max << endl;\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\n#define FOR(i,a,b) for (int i = (a); i < (b); i++)\n#define REP(i,n) FOR(i,0,n)\n\nstring str[1000];\nstring emb[2];\nchar c[3] = {'J', 'O', 'I'};\nint m, n;\n\nbool isInMap(int x, int y) {\n\treturn x >= 0 && x < n && y >= 0 && y < m;\n}\n\nbool check(int x, int y) {\n\tif (!isInMap(x, y) || !isInMap(x + 1, y + 1)) return false;\n\tif (str[y][x] == emb[0][0] && str[y][x + 1] == emb[0][1]\n\t\t&& str[y + 1][x] == emb[1][0] && str[y + 1][x + 1] == emb[1][1])\n\t\treturn true;\n\t\n\treturn false;\n}\n\nint solve(int x, int y) {\n\tint res = 0;\n\t\n\tint dx[4] = {-1,0,-1,0};\n\tint dy[4] = {-1,-1,0,0};\n\t\n\tREP(i, 4) if (check(x + dx[i], y + dy[i])) res++;\n\treturn res;\n}\n\nint main() {\n\tcin >> m >> n;\n\tREP(i, m) cin >> str[i];\n\tREP(i, 2) cin >> emb[i];\n\t\n\tint base = 0;\n\tREP(i, m) {\n\t\tREP(j, n) {\n\t\t\tif (check(j, i)) base++;\n\t\t}\n\t}\n\t\n\tint ans = 0;\n\tREP(i, m) {\n\t\tREP(j, n) {\n\t\t\tint pos = 0;\n\t\t\twhile (c[pos] != str[i][j]) pos++;\n\t\t\t\n\t\t\tbool nowC = check(j, i);\n\t\t\tFOR(k, 1, 3) {\n\t\t\t\tstr[i][j] = c[(pos + k) % 3];\n\t\t\t\t\n\t\t\t\tint sub = solve(j, i);\n\t\t\t\tif (nowC) sub--;\n\t\t\t\tans = max(ans, base + sub);\n\t\t\t}\n\t\t\tstr[i][j] = c[pos];\n\t\t}\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <fstream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <set>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <sstream>\n#include <fstream>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n#define int long long\nconst int mod = 1000000007;\n\nchar flag[1000][1000] = {};\nint ks[1000][1000] = {};\nint z[1000][1000][3] = {};\nchar base[2][2];\nsigned main()\n{\n\tint ans = 0;\n\tint H, W; cin >> H >> W;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> base[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tint tmp = 0;\n\t\t\tint x, y;\n\t\t\tint m = 0;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (flag[i + k][j + l] == base[k][l]) {\n\t\t\t\t\t\ttmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx = i + k; y = j + l;\n\t\t\t\t\t\tif (base[k][l] == 'J') m = 0;\n\t\t\t\t\t\telse if (base[k][l] == 'O') m = 1;\n\t\t\t\t\t\telse m = 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == 4) {\n\t\t\t\tans++;\n\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\tks[i + k][j + l]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tmp == 3) z[x][y][m]++;\n\t\t}\n\t}\n\tint tmp = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (z[i][j] != 0) {\n\t\t\t\t\ttmp = max(tmp, z[i][j][k]);\n\t\t\t\t//\tcout << i << \" \" << j << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans+tmp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring c[1002];\nint ruisekiwa[1000][1000];\nint main(){\n    int a,b;\n    cin>>a>>b;\n    for(int d=0;d<a;d++){\n\tcin>>c[d];\n    }\n    string f[2];\n    cin>>f[0]>>f[1];\n    int sum=0;\n    for(int g=0;g<a-1;g++){\n\tfor(int h=0;h<b-1;h++){\n\t    bool s[2][2]{};int l=0;\n\t    for(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t    if(c[g+i][h+j]==f[i][j]){l++;s[i][j]=true;}\n\t\t    }\n\t\t}\n\t\tif(l==4){sum++;\n\t\t    for(int x=0;x<2;x++){\n\t\t\tfor(int y=0;y<2;y++){\n\t\t\t    ruisekiwa[g+x-1][h+y-1]--;\n\t\t\t    }\n\t\t\t}\n\t\t    }\n\t\telse if(l==3){\n\t\t    for(int x=0;x<2;x++){\n\t\t\tfor(int y=0;y<2;y++){\n\t\t\t    if(!s[x][y])ruisekiwa[g+x-1][h+y-1]++;\n\t\t\t    }\n\t\t\t}\n\t\t    }\n\t    }\n\t}\n\tint MAX=0;\n\tfor(int i=0;i<a;i++){\n\t    for(int p=0;p<a;p++){\n\t\tMAX=max(MAX,ruisekiwa[i][p]);\n\t\t}\n\t    }\n\t    cout<<sum+MAX<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nint main()\n{\n\tint n,m;\n\tstring x[1000];\n\tstring an[2];\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tcin >> x[i];\n\t}\n\tcin >> an[0];\n\tcin >> an[1];\n\tint ans[1000][1000] = {};\n\tint mmm[4] = { 0, 0, 1, 1 };\n\tint nnn[4] = { 0, 1, 0, 1 };\n\tint sum = 0;\n\tfor (int i = 0; i < n - 1; i++)\n\t{\n\t\tfor (int I = 0; I < m - 1; I++)\n\t\t{\n\t\t\tint a = -1;\n\t\t\tint ji = -1;\n\t\t\tint jI = -1;\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t{\n\t\t\t\tif (x[i + mmm[k]][I + nnn[k]] == an[mmm[k]][nnn[k]])\n\t\t\t\t{\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ta++;\n\t\t\t\t\tji = i + mmm[k];\n\t\t\t\t\tjI = I + nnn[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a == -1)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\t{\n\t\t\t\t\tans[i + mmm[k]][I + nnn[k]]--;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (a == 0)\n\t\t\t{\n\t\t\t\tans[ji][jI]++;\n\t\t\t}\n\t\t}\n\t}\n\tint gh = 0;\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tfor (int k = 0; k < m; k++)\n\t\t{\n\t\t\tif (gh < ans[i][k])gh = ans[i][k];\n\t\t}\n\t}\n\tcout << sum + gh << endl;\n\t\n\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\nint main() {\n\tint M,N;\n\tint R=0;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\n\tint c[4];\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\n\t\t}\n\t}\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint a1=0,a2,a3,a4;\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\ta1=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a1+=1;\n\t\t\tC=D[i][j];\n\t\t\tD[i][j]='J';\n\t\t\ta2=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a2+=1;\n\t\t\tD[i][j]='O';\n\t\t\ta3=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a3+=1;\n\t\t\tD[i][j]='I';\n\t\t\ta4=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a4+=1;\n\t\t\tD[i][j]=C;\n\n\t\t\tR=max(R,a+a2-a1);\n\t\t\tR=max(R,a+a3-a1);\n\t\t\tR=max(R,a+a4-a1);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cassert>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <set>\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\ntypedef long long ll;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\nint main()\n{\n\tint n,m;\n\tstring x[1005];\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> x[i];\n\tstring p[2];\n\tcin >> p[0] >> p[1];\n\tint res = 0;\n\tint sum = 0;\n\tfor(int i=0;i<n-1;i++)\n\t{\n\t\tfor(int j=0;j<m-1;j++)\n\t\t{\n\t\t\tif(x[i][j] == p[0][0] && x[i][j+1] == p[0][1]\n\t\t\t&& x[i+1][j] == p[1][0] && x[i+1][j+1] == p[1][1])\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\tchar c[3]={'J','O','I'};\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tfor(int k=0;k<3;k++)\n\t\t\t{\n\t\t\t\tif(x[i][j] == c[k]) continue;\n\t\t\t\tchar pp = x[i][j];\n\t\t\t\tint add = 0;\n\t\t\t\tif(i>0 && j>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i-1][j-1]==p[0][0]&&x[i-1][j]==p[0][1]&&x[i][j-1]==p[1][0]&&x[i][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(i>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i-1][j]==p[0][0]&&x[i-1][j+1]==p[0][1]&&x[i][j]==p[1][0]&&x[i][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(j>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i][j-1]==p[0][0]&&x[i][j]==p[0][1]&&x[i+1][j-1]==p[1][0]&&x[i+1][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i][j]==p[0][0]&&x[i][j+1]==p[0][1]&&x[i+1][j]==p[1][0]&&x[i+1][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tx[i][j] = c[k];\n\t\t\t\tif(i>0 && j>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i-1][j-1]==p[0][0]&&x[i-1][j]==p[0][1]&&x[i][j-1]==p[1][0]&&x[i][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(i>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i-1][j]==p[0][0]&&x[i-1][j+1]==p[0][1]&&x[i][j]==p[1][0]&&x[i][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(j>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i][j-1]==p[0][0]&&x[i][j]==p[0][1]&&x[i+1][j-1]==p[1][0]&&x[i+1][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i][j]==p[0][0]&&x[i][j+1]==p[0][1]&&x[i+1][j]==p[1][0]&&x[i+1][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tres = max(res,sum+add);\n\t\t\t\tx[i][j] = pp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint a1=0,a2,a3,a4;\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\ta1=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a1+=1;\n\t\t\tC=D[i][j];\n\t\t\tD[i][j]='J';\n\t\t\ta2=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a2+=1;\n\t\t\tD[i][j]='O';\n\t\t\ta3=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a3+=1;\n\t\t\tD[i][j]='I';\n\t\t\ta4=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a4+=1;\n\t\t\tD[i][j]=C;\n\n\t\t\tR=max(R,a+a2-a1);\n\t\t\tR=max(R,a+a3-a1);\n\t\t\tR=max(R,a+a4-a1);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nint n, m;\nchar c[1080][1080];\nint cnt[1080][1080];\nchar ans[2][2];\nint anss, res;\nint main(){\n\tcin >> m >> n;\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++) \n\t\t\tcin >> c[i][j];\n\t\n\tfor(int i = 0;i < 2;i++)\n\t\tfor(int j = 0;j < 2;j++)\n\t\t\tcin >> ans[i][j];\n\t\t\t\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tcnt[i][j] = 1;\n\t\t  \tfor(int k = 0;k < 2;k++)\n\t\t\t\tfor(int l = 0;l < 2;l++)\n\t\t\t\t\tif(c[i + k][j + l] != ans[k][l])cnt[i][j] = 0;\n\t\t\tres += cnt[i][j];\n\t\t}\n\t\n\tint anss = res;\n\tfor(int i = 1;i <= m;i++){\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tint last = c[i][j];\n\t\t\tint tres;\n\t\t\tc[i][j] = 'J';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p < 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\tc[i][j] = 'O';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p < 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = 'I';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p < 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = last;\n\t\t}\n\t}\n\tcout << anss << endl;\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst string name = \"JOI\";\nchar field[1010][1010];\nchar mark[2][2];\nint N, M;\n\nbool check(int sx, int sy){\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      if(field[sy+i][sx+j] != mark[i][j]) return false;\n    }\n  }\n  return true;\n}\n\nint diff(int x, int y, char c){\n  int curr = 0, nex = 0;\n  for(int i = y-1 ; i <= y ; i++){\n    for(int j = x-1 ; j <= x ; j++){\n      if(check(j, i)) curr++;\n    }\n  }\n  \n  char org = field[y][x];\n  field[y][x] = c;\n  \n  for(int i = y-1 ; i <= y ; i++){\n    for(int j = x-1 ; j <= x ; j++){\n      if(check(j, i)) nex++;\n    }\n  }\n  \n  field[y][x] = org;\n  \n  return nex - curr;\n}\n\nint solve(){\n int ini = 0;\n  \n  for(int y = 0 ; y < N-1 ; y++)\n    for(int x = 0 ; x < M-1 ; x++) if(check(x, y)) ini++;      \n  \n  int ans = ini;\n  \n  for(int i = 0 ; i < N ; i++){\n    for(int j = 0 ; j < M ; j++){\n      for(int k = 0 ; k < 3 ; k++){\n\tif(field[i][j] == name[k]) continue;\n\t\n\tint d = diff(j, i, name[k]);\n\tif(d == 4) return ini + d;\n\tans = max(ans, ini + d);\t\n      }\n    }\n  }\n  return ans;\n}\n\nint main(){\n  \n  cin >> N >> M;\n  \n  for(int i = 0 ; i < N ; i++)\n    for(int j = 0 ; j < M ; j++) cin >> field[i][j];\n  \n  for(int i = 0 ; i < 2 ; i++)\n    for(int j = 0 ; j < 2 ; j++) cin >> mark[i][j];\n  \n  cout << solve() << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<unordered_map>\n#include<string>\n#include<algorithm>\nusing namespace std;\n\nstruct masu {\n\tint hiku;\n\tunordered_map<char, int>tasu;\n};\nmasu t[1000][1000];\nint main() {\n\tint a, b;\n\tcin >> a >> b;\n\tstring c[1000];\n\tfor (int d = 0; d < a; d++)cin >> c[d];\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g < a - 1; g++) {\n\t\tfor (int h = 0; h < b - 1; h++) {\n\t\t\tint l = 0; bool r[2][2];\n\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\tl++;\n\t\t\t\t\t\tr[i][j] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\t\tt[g + i][h + j].hiku++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (r[i][j])t[g + i][h + j].tasu[c[g + i][h + j]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i < a; i++) {\n\t\tfor (int j = 0; j < b; j++) {\n\t\t\tMAX = max(MAX, max({ t[i][j].tasu['J'],t[i][j].tasu['O'] ,t[i][j].tasu['I'] }) - t[i][j].hiku);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#define INF 999999999\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nint m, n;\nchar f[1050][1050];\nchar em[3][3];\n\nchar flag[4] = { 'J','O','I' };\n\nbool emblem(int i,int j)\n{\n\tif (f[i][j] == em[0][0]) {\n\t\tif (f[i][j + 1] == em[0][1]) {\n\t\t\tif (f[i + 1][j] == em[1][0]) {\n\t\t\t\tif (f[i + 1][j + 1] == em[1][1]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n\nint fchange(char a,int i,int j)\n{\n\tchar b = f[i][j];\n\tf[i][j] = a;\n\n\tint res = 0;\n\n\tint plus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\tf[i][j] = b;\n\tint minus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\n\t//cout << \"plus:\" << plus << \"minus\" << minus << endl;\n\treturn plus - minus;\n\n}\n\nint main()\n{\n\tcin >> m >> n;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tcin >> f[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> em[i][j];\n\t\t}\n\t}\n\n\tint num = 0;\n\tvector<P> change;\n\n\tfor (int i = 1; i <= m - 1; i++) {\n\t\tfor (int j = 1; j <= n - 1; j++) {\n\t\t\tint lu = 0, ru = 0, ll = 0, rl = 0;\n\t\t\tif (f[i][j] == em[0][0])lu = 1;\n\t\t\tif (f[i][j + 1] == em[0][1])ru = 1;\n\t\t\tif (f[i + 1][j] == em[1][0])ll = 1;\n\t\t\tif (f[i + 1][j + 1] == em[1][1])rl = 1;\n\n\t\t\tif (lu + ru + ll + rl == 4) {\n\t\t\t\tnum++;\n\t\t\t}\n\t\t\telse if (lu + ru + ll + rl == 3) {\n\t\t\t\tif (lu == 0)change.push_back(P(i, j));\n\t\t\t\tif (ru == 0)change.push_back(P(i, j + 1));\n\t\t\t\tif (ll == 0)change.push_back(P(i + 1, j));\n\t\t\t\tif (rl == 0)change.push_back(P(i + 1, j + 1));\n\t\t\t}\n\n\t\t}\n\t}\n\t//cout << \"num:\" << num << endl;\n\n\tint max = 0;\n\tfor (int i = 0; i < change.size(); i++) {\n\t\t//cout << \"change:\"<<change[i].first << change[i].second << endl;\n\t\tint imax = 0;\n\t\tfor(int j = 0; j < 3; j++) {\n\t\t\tint k = fchange(flag[j], change[i].first, change[i].second);\n\t\t\tif (k > imax)imax = k;\n\t\t}\n\t\tif (imax > max)max = imax;\n\t}\n\n\tcout << num + max << endl;\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nchar flag[1024][1024];\n\nint main(){\n\tint m,n;\n\tcin>>m>>n;\n\t\n\tfor(int i=0;i<=n+5;i++){\n\t\tflag[0][i]='X';\n\t\tflag[m+1][i]='X';\n\t\t}\n\t\t\n\t\tfor(int i=0;i<m;i++){\n\t\t\tfor(int j=0;j<n;j++)cin>>flag[i+1][j+1];\n\t\t\t}\n\t\t\t\n\t\tstring mon[2];\n\t\tcin>>mon[0]>>mon[1];\n\t\t\t\n\t\tint sum=0;\n\t\t\n\t\tfor(int i=0;i<=m;i++){\n\t\t\tfor(int j=0;j<=n;j++){\n\t\t\t\tif(flag[i][j]==mon[0][0]&&flag[i][j+1]==mon[0][1]&&flag[i+1][j]==mon[1][0]&&flag[i+1][j+1]==mon[1][1]){\n\t\t\t\t\tsum++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\tint ans=0;\t\n\t\tstring joi=\"JOI\";\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tfor(int j=1;j<=n;j++){\n\t\t\t\tfor(int k=0;k<=2;k++){\n\t\t\t\t\tint a=0;\n\t\t\t\t\tif(flag[i][j]==mon[0][0]&&flag[i][j+1]==mon[0][1]&&flag[i+1][j]==mon[1][0]&&flag[i+1][j+1]==mon[1][1]){\n\t\t\t\t\t\ta--;\n\t\t\t\t\t\t}\n\t\t\t\t\tif(flag[i-1][j-1]==mon[0][0]&&flag[i-1][j]==mon[0][1]&&flag[i][j-1]==mon[1][0]&&flag[i][j]==mon[1][1]){\n\t\t\t\t\t\ta--;\n\t\t\t\t\t\t}\t\n\t\t\t\t\tif(flag[i-1][j]==mon[0][0]&&flag[i-1][j+1]==mon[0][1]&&flag[i][j]==mon[1][0]&&flag[i][j+1]==mon[1][1]){\n\t\t\t\t\t\ta--;\n\t\t\t\t\t\t}\n\t\t\t\t\tif(flag[i][j-1]==mon[0][0]&&flag[i][j]==mon[0][1]&&flag[i+1][j-1]==mon[1][0]&&flag[i+1][j]==mon[1][1]){\n\t\t\t\t\t\ta--;\n\t\t\t\t\t\t}\t\t\n\t\t\t\t\t\t\n\t\t\t\t\tif(joi[k]==mon[0][0]&&flag[i][j+1]==mon[0][1]&&flag[i+1][j]==mon[1][0]&&flag[i+1][j+1]==mon[1][1]){\n\t\t\t\t\t\ta++;\n\t\t\t\t\t\t}\n\t\t\t\t\tif(flag[i-1][j-1]==mon[0][0]&&flag[i-1][j]==mon[0][1]&&flag[i][j-1]==mon[1][0]&&joi[k]==mon[1][1]){\n\t\t\t\t\t\ta++;\n\t\t\t\t\t\t}\t\n\t\t\t\t\tif(flag[i-1][j]==mon[0][0]&&flag[i-1][j+1]==mon[0][1]&&joi[k]==mon[1][0]&&flag[i][j+1]==mon[1][1]){\n\t\t\t\t\t\ta++;\n\t\t\t\t\t\t}\n\t\t\t\t\tif(flag[i][j-1]==mon[0][0]&&joi[k]==mon[0][1]&&flag[i+1][j-1]==mon[1][0]&&flag[i+1][j]==mon[1][1]){\n\t\t\t\t\t\ta++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tans=max(ans,sum+a);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\tcout<<ans<<endl;\n\t\treturn 0;\t\t\t\n\t}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\nusing namespace std;\nint h,w,total=0,maxm=0;\nstring ss[1002],sa[2];\nstring a=\"JOI\";\nbool c(int x,int y){\n\tif(x>=0&&y>=0&&x<h&&y<w){\n\tif(ss[x][y]==sa[0][0]&&ss[x+1][y]==sa[1][0]&&ss[x][y+1]==sa[0][1]&&ss[x+1][y+1]==sa[1][1])return true;\n\t}\n\treturn false;\n}\nint main()\n{\n\tscanf(\"%d%d\",&h,&w);\n\tfor(int i=0;i<h;i++){\n\t\tcin >> ss[i];\n\t\tss[i]+=\"K\";\n\t}\n\tfor(int i=0;i<=w;i++)ss[h]+=\"K\";\n\tcin >> sa[0] >> sa[1];\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(c(i,j))total++;\n\t\t}\n\t}\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tint A=c(i-1,j-1)+c(i,j)+c(i-1,j)+c(i,j-1);\n\t\t\tstring sx;\n\t\t\tsx+=ss[i][j];\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tss[i][j]=a[k];\n\t\t\t\tint b=c(i-1,j-1)+c(i,j)+c(i,j-1)+c(i-1,j);\n\t\t\t\tmaxm=max(maxm,b-A);\n\t\t\t}\n\t\t\tss[i][j]=sx[0];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",total+maxm);\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\n#include <map>\n#include <queue>\n#include <stack>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdlib>\n\nusing namespace std;\n\n#define ALL(c) c.begin(),c.end()\n#define RALL(c) c.rbegin(),c.rend()\n#define REP(type,i,n) for(type i=0;i<(n);++i)\n#define MP(a,b) make_pair((a),(b))\n#define F_ first\n#define S_ second\n\ntypedef long long int lli;\ntypedef pair<int,int> Pi;\n\nconst int INF=100000000;\nconst long long int INF_=1000000000000000000;\n\nint dy[4]={0,1,0,1},dx[4]={0,0,1,1};\nint dy_[4]={0,1,1,0},dx_[4]={0,0,-1,-1};\n\nbool IsSame(char c[][2],vector<vector<char> > &g,int y,int x){\n\tREP(int,i,4){\n\t\tint ny=y+dy[i],nx=x+dx[i];\n\t\tif(g[ny][nx]!=c[dy[i]][dx[i]]) return false;\n\t}\n\treturn true;\n}\n\nint main(){\n\tint M,N;\n\tcin >> M >> N;\n\tvector<vector<char> > g(M+2,vector<char>(N+2,'.'));\n\tREP(int,i,M){\n\t\tREP(int,j,N){\n\t\t\tcin >> g[i+1][j+1];\n\t\t}\n\t}\n\tchar c[2][2];\n\tREP(int,i,2) REP(int,j,2) cin >> c[i][j];\n\tint ans=0,sum=0;\n\tfor(int y=1; y<M; ++y){\n\t\tfor(int x=1; x<N; ++x){\n\t\t\tif(IsSame(c,g,y,x)) ++sum;\n\t\t}\n\t}\n\tans=sum;\n\tstring s=\"JOI\";\n\tfor(int y=1; y<=M; ++y){\n\t\tfor(int x=1; x<=N; ++x){\n\t\t\tREP(int,i,3){\n\t\t\t\tchar tmp=g[y][x];\n\t\t\t\tint c1=0,c2=0;\n\t\t\t\tREP(int,j,4){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c1;\n\t\t\t\t}\n\t\t\t\tg[y][x]=s[i];\n\t\t\t\tREP(int,j,4){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c2;\n\t\t\t\t}\n\t\t\t\tg[y][x]=tmp;\n\t\t\t\tans=max(ans,sum-c1+c2);\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint m, n, ans = 0, diff = 0;\nchar flag[1010][1010];\nchar sample[3][3];\n\nint status[1010][1010];\n\nint color(char c)\n{\n  if(c == 'J')\n    return 1; \n  if(c == 'O')\n    return 2;\n  if(c == 'I')\n    return 3;\n}\n\nint judge(int x, int y)\n{\n  return\n    ((flag[x][y] == sample[1][1]) << 3) +\n    ((flag[x][y + 1] == sample[1][2]) << 2) +\n    ((flag[x + 1][y] == sample[2][1]) << 1) +\n    (flag[x + 1][y + 1] == sample[2][2]);\n}\n\nint pls(int x, int y)\n{\n  int ret[4] = {};\n  if(status[x][y] == 14)\n    ret[color(sample[1][1])]++;\n  if(status[x][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][1])]++;\n  }\n\n  if(status[x][y - 1] == 13)\n    ret[color(sample[1][2])]++;\n  if(status[x][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][2])]++;\n  }\n\n  if(status[x - 1][y] == 11)\n    ret[color(sample[2][1])]++;\n  if(status[x - 1][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][1])]++;\n  }\n\n  if(status[x - 1][y - 1] == 7)\n    ret[color(sample[2][2])]++;\n  if(status[x - 1][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][2])]++;\n  }\n  \n  return max(max(ret[1], ret[2]), ret[3]);\n}\n    \n\nint main()\n{\n  cin >> m >> n;\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      cin >> flag[i][j];\n\n  for(int i = 1; i <= 2; i++)\n    for(int j = 1; j <= 2; j++)\n      cin >> sample[i][j];\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++){\n      status[i][j] = judge(i, j);\n      if(status[i][j] == 15)\n\tans++;\n    }\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      diff = max(diff, pls(i, j));\n\n  cout << ans + diff << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nstring s[1001],t[3];\nint h,w,sum,ans=0;\nint dx[]={0,0,-1,-1};\nint dy[]={0,-1,0,-1};\nint gx[]={0,0,1,1};\nint gy[]={0,1,0,1};\nchar c[]={'J','O','I'};\nbool used[1001][1001];\nvoid get_sum(){\n  r(i,h-1)r(j,w-1){\n    if(s[i][j]==t[0][0]&&s[i+1][j]==t[1][0]&s[i][j+1]==t[0][1]&&s[i+1][j+1]==t[1][1]){\n      used[i][j]=1;\n      sum++;\n    }\n  }\n}\nint get_res(int y,int x){\n  int res=sum;\n  r(i,4){\n    int yy=y+dy[i];\n    int xx=x+dx[i];\n    if(yy<0||xx<0||yy>=h||xx>=w)continue;\n    if(used[yy][xx])ans--;\n  }\n  r(i,4){\n     int yy=y+dy[i];\n     int xx=x+dx[i];\n     if(yy<0||xx<0||yy>=h||xx>=w)continue;\n     r(k,4){\n       int sy=yy+gy[k];\n       int sx=xx+gx[k];\n       if(sy<0||sx<0||sy>=h||sx>=w)continue;\n       if(s[sy][sx]!=t[gy[k]][gx[k]])break;\n       if(k==3)res++;\n     }\n  }\n  return res;\n}\nint get_ans(int y,int x){\n  char tmp = s[y][x];\n  int res=0;\n  r(i,3){\n    if(s[y][x]!=c[i]){\n      s[y][x]=c[i];\n      res=max(res,get_res(y,x));\n      s[y][x]=tmp;\n    }\n  }\n  return res;\n}\nint main(){\n  cin>>h>>w;\n  r(i,h)cin>>s[i];\n  r(i,2)cin>>t[i];\n  get_sum();\n  ans=sum;\n  r(i,h)r(j,w){\n    ans=max(ans,get_ans(i,j));\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <stdio.h>\n#include <list>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <math.h>\n#include <utility>\n#include <string>\n#include <ctype.h>\n#include <cstring>\n#include <cstdio>\n#include <sstream>\n#include <functional>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 114514810\n#define ll long long\n#define ALL(a) (a).begin(),(a).end()\n#define SORT(v) sort(ALL(v))\n//#define scanf scanf_s\n\nint m, n;\nchar hata[1005][1005];\nchar emb[2][2];\nint is_emb[1005][1005];\n\nbool check(int i, int j)\n{\n\treturn (hata[i][j] == emb[0][0] && hata[i + 1][j] == emb[1][0] && hata[i][j + 1] == emb[0][1] && hata[i + 1][j + 1] == emb[1][1]);\n}\n\nint search(int i, int j)\n{\n\tif (hata[i][j] == emb[0][0] && hata[i + 1][j] == emb[1][0] && hata[i][j + 1] == emb[0][1] && hata[i + 1][j + 1] == emb[1][1]) return 1;\n\telse return 0;\n}\n\nint change(int i, int j, char c,int cnt)\n{\n\tif (c == hata[i][j]) return cnt;\n\telse\n\t{\n\t\thata[i][j] = c;\n\t\tif (i == 0 && j == 0)\n\t\t{\n\t\t\tcnt -= is_emb[i][j];\n\t\t\tif (check(i,j)) cnt++;\n\t\t}\n\t\telse if (i == 0 && j > 0 && j < n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i][j] + is_emb[i][j + 1]);\n\t\t\tif (check(i, j)) cnt++;\n\t\t\tif (check(i, j + 1)) cnt++;\n\t\t}\n\t\telse if (i == 0 && j == n - 1)\n\t\t{\n\t\t\tcnt -= is_emb[i][j-1];\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t}\n\t\telse if (i > 0 && i < n - 1 && j == 0)\n\t\t{\n\t\t\tcnt -= (is_emb[i][j] + is_emb[i - 1][j]);\n\t\t\tif (check(i, j)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i == n - 1 && j == 0)\n\t\t{\n\t\t\tcnt -= is_emb[i - 1][j];\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i > 0 && i < n - 1 && j == n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i][j - 1]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t}\n\t\telse if (i == n - 1 && j>0 && j < n - 1)\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i - 1][j]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t}\n\t\telse if (i == n - 1 && j == n - 1)\n\t\t{\n\t\t\tcnt -= is_emb[i - 1][j - 1];\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcnt -= (is_emb[i - 1][j - 1] + is_emb[i][j - 1] + is_emb[i - 1][j] + is_emb[i][j]);\n\t\t\tif (check(i - 1, j - 1)) cnt++;\n\t\t\tif (check(i, j - 1)) cnt++;\n\t\t\tif (check(i - 1, j)) cnt++;\n\t\t\tif (check(i, j)) cnt++;\n\t\t}\n\t}\n\n\treturn cnt;\n}\n\nint main()\n{\n\tcin >> m >> n;\n\tmemset(is_emb, 0, sizeof(is_emb));\n\tREP(i, m)REP(j, n) cin >> hata[i][j];\n\tREP(i, 2)REP(j, 2) cin >> emb[i][j];\n\tint cnt = 0;\n\tREP(i, m - 1)REP(j, n - 1)\n\t{\n\t\tif (check(i,j))\n\t\t{\n\t\t\tis_emb[i][j] = 1;\n\t\t\tcnt++;\n\t\t}\n\t}\n\tint ans = 0;\n\tREP(i, m)REP(j, n)\n\t{\n\t\tint tmp = cnt;\n\t\tans = max({ ans, change(i, j, 'J', tmp), change(i, j, 'O', tmp), change(i, j, 'I', tmp) });\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<string.h>\nchar map[1000][1000];\nint i,j;\nint main(void){\n\tint m,n;\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tscanf(\"%s\",map[i]);\n\t}\n\tchar d[4];\n\tscanf(\"%s\",d);\n\tchar b[4];\n\tstrcpy(b,d);\n\tscanf(\"%s\",d);\n\tstrcat(b,d);\n\t//printf(\"%s\\n\",b);\n\tint max=0;\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tint k,o,p;\n\t\t\tint temp=map[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tint cnt=0;\n\t\t\t\tif(k==0){\n\t\t\t\t\tmap[i][j]='J';\n\t\t\t\t}\n\t\t\t\telse if(k==1){\n\t\t\t\t\tmap[i][j]='O';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmap[i][j]='I';\n\t\t\t\t}\n\t\t\t\tfor(o=0;o<m;o++){\n\t\t\t\t\tfor(p=0;p<n;p++){\n\t\t\t\t\t\tif(map[o][p]==b[0] && map[o][p+1]==b[1] && map[o+1][p]==b[2] && map[o+1][p+1]==b[3] && o+1<=m && p+1<=n){\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*for(o=0;o<m;o++){\n\t\t\t\t\tprintf(\"%s\\n\",map[o]);\n\t\t\t\t}\n\t\t\t\tprintf(\"%d\\n\",cnt);\n\t\t\t\t*/if(max<cnt){\n\t\t\t\t\tmax=cnt;\n\t\t\t\t}\n\t\t\t\tmap[i][j]=temp;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<queue>\n#include<map>\n#include<set>\n#include<list>\n#include<iomanip>\n#include<vector>\n#include<functional>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nchar a[1000][1000];\nint c[1000][1000];\nint main() {\n\tint h,w;\n\twhile (cin >> h >> w) {\n\t\tstring u;\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tcin >> u;\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\ta[i][j] = u[j];\n\t\t\t\tc[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tchar b[2][2];\n\t\tfor (int i = 0; i < 2; i++) {\n\t\t\tcin >> u;\n\t\t\tb[i][0] = u[0];\n\t\t\tb[i][1] = u[1];\n\t\t}\n\t\tint sum = 0;\n\t\tfor (int i=0; i < h-1; i++) {\n\t\t\tfor (int j = 0; j < w-1; j++) {\n\t\t\t\tif (a[i][j] == b[0][0]&&a[i][j+1]==b[0][1]&&\n\t\t\t\t\ta[i+1][j]==b[1][0]&&a[i+1][j+1]==b[1][1]) {\n\t\t\t\t\tc[i][j]++;\n\t\t\t\t\tsum++;\n\t\t\t\t\tc[i][j + 1]++;\n\t\t\t\t\tc[i + 1][j]++;\n\t\t\t\t\tc[i + 1][j + 1]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint sum2 = sum;\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\tmap<char, int>d;\n\t\t\t\td.insert(map<char, int>::value_type('J', 0));\n\t\t\t\td.insert(map<char, int>::value_type('O', 0));\n\t\t\t\td.insert(map<char, int>::value_type('I', 0));\n\t\t\t\tif (i + 1 < h&&j + 1 < w) {\n\t\t\t\t\tif (a[i][j + 1] == b[0][1] &&\n\t\t\t\t\t\ta[i + 1][j] == b[1][0] && a[i + 1][j + 1] == b[1][1]) {\n\t\t\t\t\t\td[b[0][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (i + 1 < h&&j - 1 >= 0) {\n\t\t\t\t\tif (a[i][j-1] == b[0][0] &&\n\t\t\t\t\t\ta[i + 1][j-1] == b[1][0] && a[i + 1][j] == b[1][1]) {\n\t\t\t\t\t\td[b[0][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (i - 1 >= 0 && j + 1 < w) {\n\t\t\t\t\tif (a[i-1][j] == b[0][0] && a[i-1][j + 1] == b[0][1] &&\n\t\t\t\t\t\ta[i][j + 1] == b[1][1]) {\n\t\t\t\t\t\td[b[1][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (i - 1 >= 0 && j - 1 >= 0) {\n\t\t\t\t\tif (a[i-1][j-1] == b[0][0] && a[i-1][j] == b[0][1] &&\n\t\t\t\t\t\ta[i][j-1] == b[1][0]) {\n\t\t\t\t\t\td[b[1][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tint sum3 = max(d['J'], max(d['O'], d['I']));\n\t\t\t\tif (sum - c[i][j] + sum3 > sum2) {\n\t\t\t\t\tsum2 = sum - c[i][j] + sum3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << sum2 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\n\n#define REP(i,n) for(long long i = 0; i < (n); i++)\n#define FOR(i, m, n) for(long long i = (m);i < (n); ++i)\n#define ALL(obj) (obj).begin(),(obj).end()\n#define SPEED cin.tie(0);ios::sync_with_stdio(false);\n\ntemplate<class T> using V = vector<T>;\ntemplate<class T, class U> using P = pair<T, U>;\n\nconst ll MOD = (ll)1e9 + 7;\nconst ll MOD2 = 998244353;\nconst ll HIGHINF = (ll)1e18;\nconst ll LOWINF = (ll)1e15;\nconst long double PI = 3.1415926535897932384626433;\n\ntemplate <class T> void corner(bool flg, T hoge) {if (flg) {cout << hoge << endl; exit(0);}}\ntemplate <class T, class U>ostream &operator<<(ostream &o, const map<T, U>&obj) {o << \"{\"; for (auto &x : obj) o << \" {\" << x.first << \" : \" << x.second << \"}\" << \",\"; o << \" }\"; return o;}\ntemplate <class T>ostream &operator<<(ostream &o, const set<T>&obj) {o << \"{\"; for (auto itr = obj.begin(); itr != obj.end(); ++itr) o << (itr != obj.begin() ? \", \" : \"\") << *itr; o << \"}\"; return o;}\ntemplate <class T>ostream &operator<<(ostream &o, const multiset<T>&obj) {o << \"{\"; for (auto itr = obj.begin(); itr != obj.end(); ++itr) o << (itr != obj.begin() ? \", \" : \"\") << *itr; o << \"}\"; return o;}\ntemplate <class T>ostream &operator<<(ostream &o, const vector<T>&obj) {o << \"{\"; for (int i = 0; i < (int)obj.size(); ++i)o << (i > 0 ? \", \" : \"\") << obj[i]; o << \"}\"; return o;}\ntemplate <class T, class U>ostream &operator<<(ostream &o, const pair<T, U>&obj) {o << \"{\" << obj.first << \", \" << obj.second << \"}\"; return o;}\ntemplate <template <class tmp>  class T, class U> ostream &operator<<(ostream &o, const T<U> &obj) {o << \"{\"; for (auto itr = obj.begin(); itr != obj.end(); ++itr)o << (itr != obj.begin() ? \", \" : \"\") << *itr; o << \"}\"; return o;}\nvoid print(void) {cout << endl;}\ntemplate <class Head> void print(Head&& head) {cout << head;print();}\ntemplate <class Head, class... Tail> void print(Head&& head, Tail&&... tail) {cout << head << \" \";print(forward<Tail>(tail)...);}\ntemplate <class T> void chmax(T& a, const T b){a=max<T>(a,b);}\ntemplate <class T> void chmin(T& a, const T b){a=min<T>(a,b);}\nvoid YN(bool flg) {cout << ((flg) ? \"YES\" : \"NO\") << endl;}\nvoid Yn(bool flg) {cout << ((flg) ? \"Yes\" : \"No\") << endl;}\nvoid yn(bool flg) {cout << ((flg) ? \"yes\" : \"no\") << endl;}\n\nint main() {\n\tint H,W; cin >> H >> W;\n\tV<string> S(H+2),T(2);\n\tfor(int i = 0; i < W+2; ++i) S[0].push_back('.');\n\tfor(int i = 1; i <= H; ++i) {\n\t\tcin >> S[i];\n\t\tS[i] = \".\"+S[i]+\".\";\n\t}\n\tfor(int i = 0; i < W+2; ++i) S[H+1].push_back('.');\n\t\n\tcin >> T[0];\n\tcin >> T[1];\n\n\tint sum = 0;\n\tfor(int i = 0; i < H+1; ++i){\n\t\tfor(int j = 0; j < W+1; ++j){\n\t\t\tint flg = 1;\n\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\tif(S[i+k][j+l]!=T[k][l]) flg = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsum += flg;\n\t\t}\n\t}\n\n\tint ans = sum;\n\tfor(int i = 1; i <= H; ++i){\n\t\tfor(int j = 1; j <= W; ++j){\n\t\t\tint flg,cnt1 = 0,cnt2 = 0;\n\n\t\t\tflg = 1;\n\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\tif(S[i-1+k][j-1+l]!=T[k][l]) flg = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt1 += flg;\n\n\t\t\tflg = 1;\n\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\tif(S[i-1+k][j+l]!=T[k][l]) flg = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt1 += flg;\n\n\t\t\tflg = 1;\n\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\tif(S[i+k][j-1+l]!=T[k][l]) flg = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt1 += flg;\n\n\t\t\tflg = 1;\n\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\tif(S[i+k][j+l]!=T[k][l]) flg = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt1 += flg;\n\n\t\t\tchar org = S[i][j];\n\t\t\tstring U = \"JOI\";\n\t\t\t\n\t\t\tfor(int n = 0; n < 3; ++n){\n\t\t\t\tS[i][j] = U[n];\n\t\t\t\tcnt2 = 0;\n\n\t\t\t\tflg = 1;\n\t\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\t\tif(S[i-1+k][j-1+l]!=T[k][l]) flg = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcnt2 += flg;\n\n\t\t\t\tflg = 1;\n\t\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\t\tif(S[i-1+k][j+l]!=T[k][l]) flg = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcnt2 += flg;\n\n\t\t\t\tflg = 1;\n\t\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\t\tif(S[i+k][j-1+l]!=T[k][l]) flg = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcnt2 += flg;\n\n\t\t\t\tflg = 1;\n\t\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\t\tfor(int l = 0; l < 2; ++l){\n\t\t\t\t\t\tif(S[i+k][j+l]!=T[k][l]) flg = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcnt2 += flg;\n\n\t\t\t\tchmax(ans,sum-cnt1+cnt2);\n\t\t\t}\n\t\t\tS[i][j] = org;\n\t\t}\n\t}\n\tcout << ans << endl;\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\ntemplate<typename T>\nvoid fill_all(T& ar,const T& v){\n\tar=v;\n}\ntemplate<typename T,size_t N,typename U>\nvoid fill_all(T(& ar)[N],const U& v){\n\tfor(auto&i:ar){fill_all(i,v);}\n}\n\nint H,W;\nchar map[1000][1002];\nchar flag[2][3];\n\nint main()\n{\n\tstd::cin >> H>>W;\n\t\n\tfor(int y = 0;y < H;++y){\n\t\tstd::cin >> map[y];\n\t}\n\tfor(int i = 0;i < 2;++i){\n\t\tstd::cin >> flag[i];\n\t}\n\t\t#ifdef DEBUG\n\t\t\tstd::cout <<\"map32:\" << map[2][3]<<'\\n';\n\t\t#endif\n\tauto is_same = [](int x,int y){\t\t\t\n\t\t\tbool ok = true;\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"same:\" << map[y][x]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\tfor(int i = 0;i < 2;++i)for(int j = 0;j < 2;++j){\n\t\t\t\tif(flag[j][i] == map[y+j][x+i]){\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tok = false;\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"samefalse:\"<<(x+i)<<' '<<(y+j) <<' ' <<map[y+j][x+i] <<' ' <<(int)map[y+j][x+i]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ok;\n\t};\n\t\n\tint32_t count = 0;\n\tfor(int y = 0;y <= H-2;++y){\n\tfor(int x = 0;x <= W-2;++x){\n\t\tif(is_same(x,y)){++count;}\n\t}}\n\t\n\t\n\tint32_t max = count;\n\tfor(int y = 0;y < H;++y){\n\tfor(int x = 0;x < W;++x){\n\t\tconst char CHAR[] = \"JOI\"; \n\t\tauto bef = map[y][x];\n\t\tauto bef_count = 0;\n\t\tfor(int u = -1;u <= 0;++u)for(int l = -1;l <= 0;++l){\n\t\t\tint lu_x = x+l,lu_y = y+u;\n\t\t\tif(lu_x<0)continue;\n\t\t\tif(lu_y<0)continue;\n\t\t\tif(W<=lu_x+1)continue;\n\t\t\tif(H<=lu_y+1)continue;\n\n\t\t\tif(is_same(lu_x,lu_y)){++bef_count;}\n\t\t}\n\t\t#ifdef DEBUG\n\t\tstd::cout << \"IN\"<<x<<' '<<y<<'\\n';\n\t\tstd::cout << bef_count << std::endl;\n\t\t#endif\n\t\t\n\t\tfor(int char_ = 0;char_<3;++char_)\n\t\t{\n\t\t\tmap[y][x] = CHAR[char_];\n\t\t\t\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"MAP:\" << map[y][x]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\tint add = 0;\n\t\t\tfor(int u = -1;u <= 0;++u)for(int l = -1;l <= 0;++l){\n\t\t\t\tint lu_x = x+l,lu_y = y+u;\n\t\t\t\tif(lu_x<0)continue;\n\t\t\t\tif(lu_y<0)continue;\n\t\t\t\tif(W<=lu_x+1)continue;\n\t\t\t\tif(H<=lu_y+1)continue;\n\t\t\t\t\n\t\t\t\tif(is_same(lu_x,lu_y)){++add;}\n\t\t\t}\n\t\t\t\n\t\t\t#ifdef DEBUG\n\t\t\tstd::cout << add << std::endl;\n\t\t\t#endif\n\t\t\tmax = std::max(max, count-bef_count+add);\n\t\t}\n\t\tmap[y][x] =bef;\n\t\t\n\t}}\n\t\n\tstd::cout << max << std::endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\nusing namespace std;\nint h,w,total=0,maxm=0;\nstring ss[1002],sa[2];\nstring a=\"JOI\";\nbool c(int x,int y){\n\tif(ss[x][y]==sa[0][0]&&ss[x+1][y]==sa[1][0]&&ss[x][y+1]==sa[0][1]&&ss[x+1][y+1]==sa[1][1])return true;\n\treturn false;\n}\nint main()\n{\n\tscanf(\"%d%d\",&h,&w);\n\tfor(int i=0;i<h;i++){\n\t\tcin >> ss[i];\n\t\tss[i]+='KK';\n\t}\n\tfor(int i=0;i<=w+1;i++)ss[h]+=\"K\";\n\tfor(int i=0;i<=w+1;i++)ss[h+1]+=\"K\";\n\tcin >> sa[0] >> sa[1];\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(c(i,j))total++;\n\t\t}\n\t}\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tint A=c(i+1,j+1)+c(i,j)+c(i+1,j)+c(i,j+1);\n\t\t\tstring sx;\n\t\t\tsx+=ss[i][j];\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tss[i][j]=a[k];\n\t\t\t\tint b=c(i+1,j+1)+c(i,j)+c(i,j+1)+c(i+1,j);\n\t\t\t\tmaxm=max(maxm,b-A);\n\t\t\t}\n\t\t\tss[i][j]=sx[0];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",total+maxm);\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <functional> //sort(A,A.end(),greater<int>());???????????????\n#include <queue>\n#include <stack>\n#include <vector>\n\n#define INF 10 << 10\n\nint n, m;\nchar flag[1002][1002];\nchar coa[3][3]; //?´???? Coat of arms\nint over[1002][1002]; // ?????????\n\nbool check(char y0x0, char y0x1, char y1x0, char y1x1) {\n\tif (y0x0 == coa[0][0]) {\n\t\tif (y0x1 != coa[0][1]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x0 != coa[1][0]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x1 != coa[1][1]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvoid Over(int y, int x) {\n\tfor (int i = y - 1; i <= y + 1; ++i) {\n\t\tfor (int i2 = x - 1; i2 <= x + 1; ++i2) {\n\t\t\t++over[i][i2];\n\t\t}\n\t}\n}\n\nint main() {\n\tmemset(over, 0, sizeof(over));\n\tmemset(flag, '0', sizeof(flag));\n\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tcin >> flag[i][i2];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int i2 = 0; i2 < 2; ++i2) {\n\t\t\tcin >> coa[i][i2];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\t//???????????§?????¢?´¢\n\tfor (int i = 1; i <= n - 1; ++i) {\n\t\tfor (int i2 = 1; i2 <= m - 1; ++i2) {\n\t\t\tif (check(flag[i][i2], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t++cnt;\n\t\t\t\tOver(i, i2);\n\t\t\t}\n\t\t}\n\t}\n\n\t//???????????????J,O,I,????????´????????????\n\t//(i, i2)????????????(i - 1, i2 - 1)???(i + 1, i2 + 1)??????????????°??????\n\t//??????????¢????????????????\t\t???\t??????(i, i2)?????????????´??????¨???????????£??????????????????????????????????????°???\n//\tcout << \"++++++++++++++++++++++++++++++++++++++++++++++++++++++++\" << endl;\n\tint cnt_add = 0;\n\tchar JOI[] = { \"JOI\" };\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tint add = 0;\n//\t\t\t\tcout << i << \" \" << i2 << \" \" << JOI[j] << endl;\n\t\t\t\tif (check(flag[i - 1][i2 - 1], flag[i - 1][i2], flag[i][i2 - 1], JOI[j])) {\n\t\t\t\t\t++add;\n//\t\t\t\t\tcout << flag[i - 1][i2 - 1] << flag[i - 1][i2] << endl << flag[i][i2 - 1] << JOI[j] << endl;\n//\t\t\t\t\tcout << \"++\" << endl;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i - 1][i2], flag[i - 1][i2 + 1], JOI[j], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n//\t\t\t\t\tcout << endl << flag[i - 1][i2] << flag[i - 1][i2 + 1] << endl << JOI[j] << flag[i][i2 + 1] << endl;\n//\t\t\t\t\tcout << \"++\" << endl;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i][i2 - 1], JOI[j], flag[i + 1][i2 - 1], flag[i + 1][i2])) {\n\t\t\t\t\t++add;\n//\t\t\t\t\tcout << endl << flag[i][i2 - 1] << JOI[j] << endl << flag[i + 1][i2 - 1] << flag[i + 1][i2] << endl;\n//\t\t\t\t\tcout << \"++\" << endl;\n\t\t\t\t}\n\t\t\t\tif (check(JOI[j], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t\t++add;\n//\t\t\t\t\tcout << endl << JOI[j] << flag[i][i2 + 1] << endl << flag[i + 1][i2] << flag[i + 1][i2 + 1] << endl;\n//\t\t\t\t\tcout << \"++\" << endl;\n\t\t\t\t}\n\t\t\t\tcnt_add = max(cnt_add, add - over[i][i2]);\n//\t\t\t\tcout << cnt_add << endl;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << max(cnt, cnt + cnt_add) << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n \nusing namespace std;\n \n#define MAX 1010\n \nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\n \nbool inField(int y,int x){\n    return 0 <= y && y < H && 0 <= x && x < W;\n}\n \nint Cnt(int y,int x,char ch){\n    int res = 0;\n \n    if(a[y][x] == b[0][0] && \n       (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n       (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n       (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res++;\n  \n    if(b[0][0] == ch && \n       (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n       (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n       (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res--;\n  \n    if(a[y][x] == b[0][1] && \n       (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n       (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n       (inField(y+1,x) && a[y+1][x] == b[1][1])) res++;\n  \n    if(b[0][1] == ch && \n       (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n       (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n       (inField(y+1,x) && a[y+1][x] == b[1][1])) res--;\n \n    if(a[y][x] == b[1][0] && \n       (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n       (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n       (inField(y,x+1) && a[y][x+1] == b[1][1])){\n\tres++;\n    }\n    if(b[1][0] == ch && \n       (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n       (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n       (inField(y,x+1) && a[y][x+1] == b[1][1])) res--;\n  \n    if(a[y][x] == b[1][1] && \n       (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n       (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n       (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res++;\n  \n    if(b[1][1] == ch && \n       (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n       (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n       (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res--;\n  \n    return res;\n}\n \nint main(){\n    cin >> H >> W;\n    for(int i = 0 ; i < H ; i++){\n\tfor(int j = 0 ; j < W ; j++){\n\t    cin >> a[i][j];\n\t}\n    }\n    for(int i = 0 ; i < 2 ; i++){\n\tfor(int j = 0 ; j < 2 ; j++){\n\t    cin >> b[i][j];\n\t}\n    }\n    int ans = 0;\n    for(int i = 0 ; i < H-1 ; i++){\n\tfor(int j = 0 ; j < W-1 ; j++){\n\t    for(int k = 0 ; k < 2 ; k++){\n\t\tfor(int l = 0 ; l < 2 ; l++){\n\t\t    if(a[i+k][j+l] != b[k][l]){\n\t\t\tgoto next;\n\t\t    }\n\t\t}\n\t    }\n\t    ans++;\n\tnext:;\n\t}\n    }\n    int d = ans;\n    for(int i = 0 ; i < H ; i++){\n\tfor(int j = 0 ; j < W ; j++){\n\t    char tmp = a[i][j];\n\t    for(int k = 0 ; k < 3 ; k++){\n\t\tif(tmp == c[k]) continue;\n\t\ta[i][j] = c[k];\n\t\tans = max(ans,d+Cnt(i,j,tmp));\n\t    }\n\t    a[i][j] = tmp;\n\t}\n    }\n    cout << ans << endl;\n \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef pair<int,int> P;\nint n,m;\nint d[1010][1010][5];\nchar s[1010][1010];\nchar joi[3][3];\nint ans = 0;\nint ha[4][4];\nint main(){\n\tscanf(\"%d%d\",&m,&n);\n\tfor(int i = 0;i < m;i++){\n\t//\tscanf(\"%s\",&s[i]);\n\t\tcin >> s[i];\n\t}\n//\tscanf(\"%s\\n%s\",&joi[0],&joi[1]);\n\tcin >> joi[0] >> joi[1];\n\tfor(int i = 0;i < 2;i++){\n\t\tfor(int j = 0;j < 2;j++){\n\t\t\tif(joi[i][j] == 'O'){\n\t\t\t\tha[i][j] = 1;\n\t\t\t}else if(joi[i][j] == 'I'){\n\t\t\t\tha[i][j] = 2;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 0;i < m-1;i++){\n\t\tfor(int j = 0;j < n-1;j++){\n\t\t\tint co = 0;\n\t\t\tP t;\n\t\t\tfor(int k = 0;k < 2;k++){\n\t\t\t\tfor(int l = 0;l < 2;l++){\n\t\t\t\t\tif(s[i+k][j+l] == joi[k][l]){\n\t\t\t\t\t\tco++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tt = P(k,l);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(co == 4){\n\t\t\t\tans++;\n\t\t\t\tfor(int k = 0;k < 2;k++){\n\t\t\t\t\tfor(int l = 0;l < 2;l++){\n\t\t\t\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\t\t\t\tif(k != ha[k][l]){\n\t\t\t\t\t\t\t\td[i+k][j+l][ha[k][l]]--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(co == 3){\n\t\t\t\td[t.first+i][t.second+j][ha[t.first][t.second]]++;\n\t\t\t}\n\t\t}\n\t}\n\tint plus = 0;\n\tfor(int i = 0;i < m;i++){\n\t\tfor(int j = 0;j < n;j++){\n\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\tplus = max(plus,d[i][j][k]);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans+plus);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define filein(t) freopen(t, \"r\", stdin)\n#define fileout(t) freopen(t, \"w\", stdout)\n#define f first\n#define s second\n#define cs 137\n#define ll long long\n#define mp make_pair\n#define NN 505\n#define N 10005\n#define oo 1000000007\n\nusing namespace std;\n\nint m, n;\nint P[N], S[N], ans, C[N], E[N], DP[NN][N];\n\nvoid Up(int &x, int y)\n{\n    x = max(x, y);\n}\n\nint main()\n{\n    //filein(\"MANJU.inp\");    fileout(\"MANJU.out\");\n    cin >> m >> n;\n    for(int i=1; i<=m; i++)\n        cin >> P[i];\n    sort(P+1, P+m+1);\n    reverse(P+1, P+m+1);\n    for(int i=1; i<=m; i++)\n        S[i] = S[i-1] + P[i];\n    for(int i=1; i<=n; i++)\n        cin >> C[i] >> E[i];\n    for(int i=0; i<=n; i++)\n        for(int j=0; j<=m; j++)\n        {\n            Up(DP[i+1][j], DP[i][j]);\n            Up(DP[i+1][min(j+C[i+1],m)], DP[i][j] + S[min(j+C[i+1],m)] - S[j] - E[i+1]);\n            Up(ans, DP[i][j]);\n        }\n    cout << ans;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <map>\n#include <set>\n#include <vector>\n#include <cmath>\n#include <utility>\n#include <list>\n#include <bitset>\n#include <functional>\n\nusing namespace std;\n\n#define st1 first\n#define nd2 second\n#define pb push_back\n#define mp make_pair\n#define ins insert\n#define ers erase\n#define fort(i,a,b) for(int i=(a); i<=(b); i++)\n#define forl(i,a,b) for(int i=(a); i>=(b); i--)\n#define forc(i,c) for(typeof(c.begin()) i=c.begin(); i!=c.end(); i++)\n#define forcn(i,c) for(typeof(c.rbegin()) i=c.rbegin(); i!=c.rend(); i++)\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> prii;\n\nconst char* fi=\"emblem.inp\";\nconst char* fo=\"emblem.out\";\n\nconst int maxn=1002;\n\nconst int di[]={-1,-1,0,0};\nconst int dj[]={-1,0,-1,0};\n\nint m,n,a[maxn][maxn],b[2][2];\n\nint trans(char c)\n{\n    if (c=='I') return 1;\n    else    if (c=='J') return 2;\n    else    return 3;\n}\n\nvoid nhap()\n{\n    cin>>m>>n; char c;\n    fort(i,1,m) fort(j,1,n)\n    {\n        cin>>c;\n        a[i][j]=trans(c);\n    }\n    fort(i,0,1) fort(j,0,1)\n    {\n        cin>>c;\n        b[i][j]=trans(c);\n    }\n}\n\nbool match(int i, int j)\n{\n    if (i<1 || j<1 ||i>m-1 || j>n-1) return false;\n    fort(ii,0,1) fort(jj,0,1)\n        if (a[i+ii][j+jj] != b[ii][jj]) return false;\n    return true;\n}\n\nvoid xl()\n{\n    nhap();\n\n    int dem=0, res=0, tmp,old,ii,jj;\n    fort(i,1,m-1) fort(j,1,n-1) dem+=match(i,j);\n\n    fort(i,1,m) fort(j,1,n)\n        fort(k,1,3)\n        {\n            tmp=dem, old=a[i][j];\n            fort(t,0,3)\n            {\n                ii=i+di[t],jj=j+dj[t];\n                tmp-=match(ii,jj);\n            }\n            a[i][j]=k;\n            fort(t,0,3)\n            {\n                ii=i+di[t],jj=j+dj[t];\n                tmp+=match(ii,jj);\n            }\n            res=max(res,tmp);\n            a[i][j]=old;\n        }\n\n    cout<<res;\n}\n\n\n\nint main()\n{\n    #ifndef ONLINE_JUDGE\n        freopen(fi,\"r\",stdin);\n        freopen(fo,\"w\",stdout);\n    #endif\n    ios::sync_with_stdio(false);\n    xl();\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint N,M;\nchar F[1111][1111];\nchar E[11][11];\nint D[1111][1111];\n\nbool check(int x,int y,int bx,int by,char c){\n  char tmp = F[bx][by];\n  F[bx][by] = c;\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      int nx = j+x, ny = i+y;\n      if( ny >= M || nx >= N ){\n        F[bx][by] = tmp; return false;\n      }\n      if( F[nx][ny] != E[j][i] ){\n        F[bx][by] = tmp; return false;\n      }\n    }\n  }\n  F[bx][by] = tmp;\n  return true;\n}\n\nint dx[]={0,-1,-1,0};\nint dy[]={0,-1,0,-1};\nchar dc[]=\"JOI\";\nint main(){\n  cin >> M >> N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin >> F[j][i];\n    }\n  }\n\n  for(int i=0;i<2;i++)\n    for(int j=0;j<2;j++) cin >> E[j][i];\n\n  int sum = 0;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      D[j][i] = check(j,i,j,i,F[j][i]);\n      if( D[j][i] == 1 ) sum++;\n    }\n  }\n  int res = sum;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n\n      for(int k=0;k<3;k++){\n        int pr = 0;\n\n        for(int t =0;t<4;t++){\n          int nx = j+dx[t], ny = i+dy[t];\n          if( nx < 0 || ny < 0 ) continue;\n          int fl = check(nx,ny,j,i,dc[k]);\n          pr += (fl - D[nx][ny]); \n        }\n        res = max(res,sum+pr);\n\n      }\n\n    }\n  }\n  cout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(void){\n\tint h,w;\n\tint i,j,k,l;\n\tchar em[1001][1001];\n\tchar box[3][3];\n\tchar joi[3]={'J','O','I'};\n\tbool flg1,flg2,flg3,flg4;\n\tint cnt,cnt1;\n\tint MAX=-1;\n\tcin>>h>>w;\n\tfor(i=0;i<h;i++){\n\t\tfor(j=0;j<w;j++){\n\t\t\tcin>>em[i][j];\n\t\t}\n\t}\n\tfor(i=0;i<2;i++){\n\t\tfor(j=0;j<2;j++){\n\t\t\tcin>>box[i][j];\n\t\t}\n\t}\n\t//cout<<box[0][0]<<\" \"<<box[0][1]<<\" \"<<box[1][0]<<\" \"<<box[1][1]<<endl;\n\t\n\tcnt=0;\n\tfor(i=0;i<h;i++){\n\t\tfor(j=0;j<w;j++){\n\t\t\t// cout<<i<<\" \"<<j<<endl;\n\t\t\t// cout<<em[i][j]<<endl;\n\t\t\tif(box[0][0]==em[i][j]){\n\t\t\t\tif(j+1<w){\n\t\t\t\t\tif(box[0][1]==em[i][j+1]){\n\t\t\t\t\t\tif(i+1<h){\n\t\t\t\t\t\t\tif(box[1][0]==em[i+1][j]){\n\t\t\t\t\t\t\t\tif(box[1][1]==em[i+1][j+1]){\n\t\t\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// cout<<endl;\n\t}\n\t// for(i=0;i<h;i++){\n\t\t// for(j=0;j<w;j++){\n\t\t\t// cout<<i<<\" \"<<j<<endl;\n\t\t\t// cout<<em[i][j]<<endl;\n\t\t// }\n\t\t// cout<<endl;\n\t// }\n\t// cout<<endl;\n\tMAX=max(MAX,cnt);\n\tfor(i=0;i<h;i++){\n\t\tfor(j=0;j<w;j++){\n\t\t\t// cout<<i<<\" \"<<j<<endl;\n\t\t\t// for(int a=0;a<h;a++){\n\t\t\t\t// for(int b=0;b<w;b++){\n\t\t\t\t\t// cout<<em[a][b];\n\t\t\t\t// }\n\t\t\t\t// cout<<endl;\n\t\t\t// }\n\t\t\t// cout<<endl;\n\t\t\t\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tcnt1=cnt;\n\t\t\t\t\n\t\t\t\tif(em[i][j]!=joi[k]){\n\t\t\t\t\t//cout<<joi[k]<<endl;\n\t\t\t\t\tfor(l=0;l<4;l++){\n\t\t\t\t\t\tflg1=false;\n\t\t\t\t\t\tflg2=false;\n\t\t\t\t\t\tflg3=false;\n\t\t\t\t\t\tflg4=false;\n\t\t\t\t\t\tif(l==0){\n\t\t\t\t\t\t\tif(em[i][j]==box[1][1]){\n\t\t\t\t\t\t\t\tif(0<=j-1){\n\t\t\t\t\t\t\t\t\tif(em[i][j-1]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\tif(0<=i-1){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j-1]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tflg1=true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(joi[k]==box[1][1]){\n\t\t\t\t\t\t\t\tif(0<=j-1){\n\t\t\t\t\t\t\t\t\tif(em[i][j-1]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\tif(0<=i-1){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j-1]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(flg1)\tcnt1--;\n\t\t\t\t\t\t\t\t\t\t\t\t\telse\t\tcnt1++;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(l==1){\n\t\t\t\t\t\t\tif(em[i][j]==box[1][0]){\n\t\t\t\t\t\t\t\tif(j+1<w){\n\t\t\t\t\t\t\t\t\tif(em[i][j+1]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\tif(0<=i-1){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j+1]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tflg2=true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(joi[k]==box[1][0]){\n\t\t\t\t\t\t\t\tif(j+1<w){\n\t\t\t\t\t\t\t\t\tif(em[i][j+1]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\tif(0<=i-1){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i-1][j+1]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(flg2)\tcnt1--;\n\t\t\t\t\t\t\t\t\t\t\t\t\telse\t\tcnt1++;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(l==2){\n\t\t\t\t\t\t\tif(em[i][j]==box[0][1]){\n\t\t\t\t\t\t\t\tif(0<=j-1){\n\t\t\t\t\t\t\t\t\tif(em[i][j-1]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\tif(i+1<h){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j-1]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tflg3=true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(joi[k]==box[0][1]){\n\t\t\t\t\t\t\t\tif(0<=j-1){\n\t\t\t\t\t\t\t\t\tif(em[i][j-1]==box[0][0]){\n\t\t\t\t\t\t\t\t\t\tif(i+1<h){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j-1]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(flg3)\tcnt1--;\n\t\t\t\t\t\t\t\t\t\t\t\t\telse\t\tcnt1++;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(em[i][j]==box[0][0]){\n\t\t\t\t\t\t\t\tif(j+1<w){\n\t\t\t\t\t\t\t\t\tif(em[i][j+1]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\tif(i+1<h){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j+1]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tflg4=true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(joi[k]==box[0][0]){\n\t\t\t\t\t\t\t\tif(j+1<w){\n\t\t\t\t\t\t\t\t\tif(em[i][j+1]==box[0][1]){\n\t\t\t\t\t\t\t\t\t\tif(i+1<h){\n\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j]==box[1][0]){\n\t\t\t\t\t\t\t\t\t\t\t\tif(em[i+1][j+1]==box[1][1]){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(flg4)\tcnt1--;\n\t\t\t\t\t\t\t\t\t\t\t\t\telse\t\tcnt1++;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//cout<<cnt1<<endl;\n\t\t\t\tMAX=max(MAX,cnt1);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<MAX<<endl;\n\treturn 0;\n}\n\t\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\n#define MAX 1000\n\nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\n\nbool inField(int y,int x){\n  return 0 <= y && y < H && 0 <= x && x < W;\n}\n\nint Cnt(int y,int x,char ch){\n  int res = 0;\n\n  if(a[y][x] == b[0][0] && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res++;\n \n  if(a[y][x] == ch && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[0][1] && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res++;\n \n  if(a[y][x] == ch && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res--;\n \n\n  if(a[y][x] == b[1][0] && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])) res++;\n \n  if(a[y][x] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[1][1] && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res++;\n \n  if(a[y][x] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res--;\n \n  return res;\n}\n\nint main(){\n  cin >> H >> W;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      cin >> b[i][j];\n    }\n  }\n  int ans = 0;\n  for(int i = 0 ; i < H-1 ; i++){\n    for(int j = 0 ; j < W-1 ; j++){\n      for(int k = 0 ; k < 2 ; k++){\n        for(int l = 0 ; l < 2 ; l++){\n          if(a[i+k][j+l] != b[k][l]){\n            goto next;\n          }\n        }\n      }\n      ans++;\n    next:;\n    }\n  }\n\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      char tmp = a[i][j];\n      for(int k = 0 ; k < 3 ; k++){\n        if(tmp == c[k]) continue;\n        a[i][j] = c[k];\n        ans = max(ans,ans+Cnt(i,j,tmp));\n      }\n      a[i][j] = tmp;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n\nusing namespace std;\n\nchar s[1000][1111];\n\nchar w[2][10];\n\nchar q[3] = {'J','O','I'};\n\nint k[1000][1000];\n\nbool itti(int y,int x)\n{\n\tfor(int i = 0; i < 2; i++)\n\t{\n\t\tfor(int ii = 0; ii < 2; ii++)\n\t\t{\n\t\t\tif(s[y + i][x + ii] != w[i][ii])\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nint main()\n{\n\tint m,n;\n\tscanf(\"%d%d\",&m,&n);\n\tfor(int i = 0; i < m; i++)\n\t{\n\t\tscanf(\"%s\",s[i]);\n\t}\n\tfor(int i = 0; i < 2; i++)\n\t{\n\t\tscanf(\"%s\",w[i]);\n\t}\n\tfor(int i = 0; i < m; i++)\n\t{\n\t\tfor(int ii = 0; ii < n; ii++)\n\t\t{\n\t\t\tk[i][ii] = 0;\n\t\t}\n\t}\n\tint all = 0;\n\tfor(int i = 0; i < m - 1; i++)\n\t{\n\t\tfor(int ii = 0; ii < n - 1; ii++)\n\t\t{\n\t\t\tif(itti(i,ii))\n\t\t\t{\n\t\t\t\tk[i][ii]++;\n\t\t\t\tk[i + 1][ii]++;\n\t\t\t\tk[i][ii + 1]++;\n\t\t\t\tk[i + 1][ii + 1]++;\n\t\t\t\tall++;\n\t\t\t}\n\t\t}\n\t}\n\tint maxw = all;\n\tfor(int i = 0; i < m; i++)\n\t{\n\t\tfor(int ii = 0; ii < n; ii++)\n\t\t{\n\t\t\tchar moto = s[i][ii];\n\t\t\tfor(int j = 0; j < 3; j++)\n\t\t\t{\n\t\t\t\ts[i][ii] = q[j];\n\t\t\t\tint now = all - k[i][ii];\n\t\t\t\tif(i != 0)\n\t\t\t\t{\n\t\t\t\t\tif(ii != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(itti(i - 1,ii - 1))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(ii != n - 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(itti(i - 1,ii))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i != m - 1)\n\t\t\t\t{\n\t\t\t\t\tif(ii != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(itti(i,ii - 1))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(ii != n - 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(itti(i,ii))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnow++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmaxw = max(maxw,now);\n\t\t\t}\n\t\t\ts[i][ii] = moto;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",maxw);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tint h, w; cin >> h >> w;\n\n\tfor (int i = 0; i < h; ++i) cin >> mp[i];\n\n\tfor (int i = 0; i < 2; ++i) cin >> e[i];\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tint sum2 = sum;\n\n\t\t\tchar tmp = mp[i][j];\n\n\t\t\tint cnt = 0;\n\n\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\tint y = i + dy[k], x = j + dx[k];\n\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsum2 -= cnt;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tmp[i][j] = a[k];\n\n\t\t\t\tint cnt2 = 0;\n\n\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\tint y = i + dy[l], x = j + dx[l];\n\t\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\t\tcnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcnt = max(cnt, cnt2);\n\t\t\t}\n\n\t\t\tsum2 += cnt;\n\n\t\t\tmp[i][j] = tmp;\n\n\t\t\tans = max(ans, sum2);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(void){\n\tint cnt,i,j,k,l,m,n,flg,xx,yy,t,f,c,x,y,max;\n\tint dx[9]={0,1,1,1,0,-1,-1,-1,0},dy[9]={-1,-1,0,1,1,1,0,-1,-1};\n\tchar fl[1000][1001],em[2][3],a[]=\"JOI\";\n\tcin>>m>>n;\n\tfor(i=0;i<m;i++) cin>>fl[i];\n\tfor(i=0;i<2;i++) cin>>em[i];\n\tcnt=0;\n\tfor(i=0;i<m-1;i++){\n\t\tfor(j=0;j<n-1;j++){\n\t\t\tif(fl[i][j]==em[0][0]){\n\t\t\t\tflg=1;\n\t\t\t\tfor(k=2;k<=4;k++){\n\t\t\t\t\txx=j+dx[k]; yy=i+dy[k];\n\t\t\t\t\tif(fl[yy][xx]!=em[dy[k]][dx[k]]){\n\t\t\t\t\t\tflg=0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flg==1){\n//\t\t\t\t\tcout<<1<<' '<<i<<' '<<j<<endl;\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tmax=cnt;\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tc=0;\n\t\t\t\tif(em[0][0]==a[k]&&a[k]!=fl[i][j]&&i<m-1&&j<n-1){\n\t\t\t\t\tflg=1;\n\t\t\t\t\tfor(l=2;l<=4;l++){\n\t\t\t\t\t\txx=j+dx[l]; yy=i+dy[l];\n\t\t\t\t\t\tif(fl[yy][xx]!=em[dy[l]][dx[l]]){\n\t\t\t\t\t\t\tflg=0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flg==1){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(em[0][1]==a[k]&&a[k]!=fl[i][j]&&i<m-1&&j!=0){\n\t\t\t\t\tflg=1;\n\t\t\t\t\tfor(l=4;l<=6;l++){\n\t\t\t\t\t\txx=j+dx[l]; yy=i+dy[l];\n\t\t\t\t\t\tif(fl[yy][xx]!=em[dy[l]][1+dx[l]]){\n\t\t\t\t\t\t\tflg=0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flg==1){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(em[1][1]==a[k]&&a[k]!=fl[i][j]&&i!=0&&j!=0){\n\t\t\t\t\tflg=1;\n\t\t\t\t\tfor(l=6;l<=8;l++){\n\t\t\t\t\t\txx=j+dx[l]; yy=i+dy[l];\n\t\t\t\t\t\tif(fl[yy][xx]!=em[1+dy[l]][1+dx[l]]){\n\t\t\t\t\t\t\tflg=0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flg==1){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(em[1][0]==a[k]&&a[k]!=fl[i][j]&&i!=0&&j<n-1){\n\t\t\t\t\tflg=1;\n\t\t\t\t\tfor(l=0;l<=2;l++){\n\t\t\t\t\t\txx=j+dx[l]; yy=i+dy[l];\n\t\t\t\t\t\tif(fl[yy][xx]!=em[1+dy[l]][dx[l]]){\n\t\t\t\t\t\t\tflg=0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flg==1){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(max<cnt+c) max=cnt+c;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<max<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint c[4];\n\tint R=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;++k){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define repp(i, m, n) for(int i = m; i < n; i++)\n#define reps(i, n) for(int i = 1; i <= n; i++)\nconst int    INF = 100000000;\nconst double EPS = 1e-10;\nconst int    MOD = 1000000007;\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pai;\ntypedef pair<ll,ll> pal;\n\nchar a[1010][1010];\nchar w, x, y, z;\n\nint hantei(int i, int j, int k, char p)\n{\n\tif(k==0)\n\t{\n\t\tif(p==w && a[i][j+1]==x && a[i+1][j]==y && a[i+1][j+1]==z) return 1;\n\t\telse return 0;\n\t}\n\telse if(k==1)\n\t{\n\t\tif(a[i][j]==w && p==x && a[i+1][j]==y && a[i+1][j+1]==z) return 1;\n\t\telse return 0;\n\t}\n\telse if(k==2)\n\t{\n\t\tif(a[i][j]==w && a[i][j+1]==x && p==y && a[i+1][j+1]==z) return 1;\n\t\telse return 0;\n\t}\n\telse if(k==3)\n\t{\n\t\tif(a[i][j]==w && a[i][j+1]==x && a[i+1][j]==y && p==z) return 1;\n\t\telse return 0;\n\t}\n}\n\nint main()\n{\n\tint m, n;\n\tcin >> m >> n;\n\t\n\tint b[1010][1010]={};\n\trep(i, m) rep(j, n) cin >> a[i][j];\n\t\n\tcin >> w >> x >> y >> z;\n\tint ans1=0;\n\trep(i, m-1) rep(j, n-1)\n\t{\n\t\tif(a[i][j]==w && a[i][j+1]==x && a[i+1][j]==y && a[i+1][j+1]==z)\n\t\t{\n\t\t\tb[i][j]=1;\n\t\t\tans1++;\n\t\t}\n\t}\n\tint ans=0, tmp, tmp1, tmp2, tmp3;\n\trep(i, m) rep(j, n)\n\t{\n\t\ttmp=tmp1=tmp2=tmp3=0;\n\t\tif(i>0 && j>0)\n\t\t{\n\t\t\tif(b[i-1][j-1]==1) tmp--;\n\t\t\t\ttmp1+=hantei(i-1, j-1, 3, 'J');\n\t\t\t\ttmp2+=hantei(i-1, j-1, 3, 'O');\n\t\t\t\ttmp3+=hantei(i-1, j-1, 3, 'I');\n\t\t}\n\t\tif(i>0 && j<n-1)\n\t\t{\n\t\t\tif(b[i-1][j]==1) tmp--;\n\t\t\t\ttmp1+=hantei(i-1, j, 2, 'J');\n\t\t\t\ttmp2+=hantei(i-1, j, 2, 'O');\n\t\t\t\ttmp3+=hantei(i-1, j, 2, 'I');\n\t\t}\n\t\tif(i<m-1 && j>0)\n\t\t{\n\t\t\tif(b[i][j-1]==1) tmp--;\n\t\t\t\ttmp1+=hantei(i, j-1, 1, 'J');\n\t\t\t\ttmp2+=hantei(i, j-1, 1, 'O');\n\t\t\t\ttmp3+=hantei(i, j-1, 1, 'I');\n\t\t}\n\t\tif(i<m-1 && j<n-1)\n\t\t{\n\t\t\tif(b[i][j]==1) tmp--;\n\t\t\t\ttmp1+=hantei(i, j, 0, 'J');\n\t\t\t\ttmp2+=hantei(i, j, 0, 'O');\n\t\t\t\ttmp3+=hantei(i, j, 0, 'I');\n\t\t}\n\t\ttmp1=max(tmp1, max(tmp2, tmp3));\n\t\ttmp+=tmp1;\n\t\tans=max(ans, tmp);\n\t}\n\tcout << (ans+ans1) << endl; \n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1111][1111];\nbool a[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  int cnt;\n  int ans=-111;\n  cin>>M>>N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      // haku[i][j]=mas[i][j];\n    \n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  int a_cnt=0;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(mas[i+k][j+l]==key[k][l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4) a_cnt++;\n    }\n  }\n \n  int dx[]={-1,-1,0,0};\n  int dy[]={-1,0,-1,0};\n  char joi[]={'J','O','I'};\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      for(int mozi=0;mozi<3;mozi++){\n\tif(mas[i][j]==joi[mozi]) continue;\n\tchar tmp=mas[i][j];\n\tmas[i][j]=joi[mozi];\n\tcnt=0;\n\tfor(int k=0;k<4;k++){\n\t  int nx=i+dx[k];\n\t  int ny=j+dy[k];\n\t  int ret=0;\n\t  if(0<=nx && nx<M-1 && 0<=ny && ny<N-1){\n\t    \n\t    for(int m=0;m<2;m++){\n\t      for(int l=0;l<2;l++){\n\t\tif(mas[nx+m][ny+l]==key[m][l]){\n\t\t  ret++;\n\t\t}\n\t      }\n\t    }\n\t    if(ret==4) cnt++;\n\t  }\n\t}\n\tans=max(ans,a_cnt+cnt);\n\tmas[i][j]=tmp;\n      }\n    }\n  }\n  cout<<ans<<endl;\n  return 0;\n}\n\t\t"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#include<algorithm>\n#include<vector>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\n\nint m,n;\nchar d[1000][1001];\nchar h[2][3];\nchar dd[3]={'J','I','O'};\n\nint change(int x,int y,char c){\n\tif(c==d[x][y]) return 0;\n\tint res=0;\n\tfor(int i=max(0,x-1);i<=min(x,m-1);i++) for(int j=max(0,y-1);j<=min(y,n-1);j++){\n\t\tint ok=1;\n\t\tfor(int k=i;k<i+2;k++) for(int r=j;r<j+2;r++) if(d[k][r]!=h[k-i][r-j]) ok=0;\n\t\tif(ok) res--;\n\t}\n\tchar p=d[x][y];d[x][y]=c;\n\tfor(int i=max(0,x-1);i<=min(x,m-1);i++) for(int j=max(0,y-1);j<=min(y,n-1);j++){\n\t\tint ok=1;\n\t\tfor(int k=i;k<i+2;k++) for(int r=j;r<j+2;r++) if(d[k][r]!=h[k-i][r-j]) ok=0;\n\t\tif(ok) res++;\n\t}\n\td[x][y]=p;\n\treturn res;\n}\n\nint main(){\n\tscanf(\"%d%d\",&m,&n);\n\tfor(int i=0;i<m;i++) scanf(\"%s\",d[i]);\n\tscanf(\"%s%s\",h[0],h[1]);\n\tint res=0;\n\tfor(int i=0;i<m;i++) for(int j=0;j<n;j++) for(int k=0;k<3;k++) res=max(res,change(i,j,dd[k]));\n\tfor(int i=0;i<m-1;i++) for(int j=0;j<n-1;j++){\n\t\tint ok=1;\n\t\tfor(int k=i;k<i+2;k++) for(int r=j;r<j+2;r++) if(d[k][r]!=h[k-i][r-j]) ok=0;\n\t\tif(ok) res++;\n\t}\n\tprintf(\"%d\\n\",res);\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n\nusing namespace std;\n\nchar s[1000][1111];\n\nchar w[2][2];\n\nchar q[3] = {'J','O','I'};\n\nint k[1000][1000];\n\nbool itti(int y,int x)\n{\nfor(int i = 0; i < 2; i++)\n{\nfor(int ii = 0; ii < 2; ii++)\n{\nif(s[y + i][x + ii] != w[i][ii])\n{\nreturn false;\n}\n}\n}\nreturn true;\n}\n\nint main()\n{\nint m,n;\nscanf(\"%d%d\",&m,&n);\nfor(int i = 0; i < m; i++)\n{\nscanf(\"%s\",s[i]);\n}\nfor(int i = 0; i < 2; i++)\n{\nscanf(\"%s\",w[i]);\n}\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nk[i][ii] = 0;\n}\n}\nint all = 0;\nfor(int i = 0; i < m - 1; i++)\n{\nfor(int ii = 0; ii < n - 1; ii++)\n{\nif(itti(i,ii))\n{\nk[i][ii]++;\nk[i + 1][ii]++;\nk[i][ii + 1]++;\nk[i + 1][ii + 1]++;\nall++;\n}\n}\n}\nint maxw = all;\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nchar moto = s[i][ii];\nfor(int j = 0; j < 3; j++)\n{\ns[i][ii] = q[j];\nint now = all - k[i][ii];\nif(i != 0)\n{\nif(itti(i - 1,ii))\n{\nnow++;\n}\n}\nif(i != m - 1)\n{\nif(itti(i + 1,ii))\n{\nnow++;\n}\n}\nif(ii != 0)\n{\nif(itti(i,ii - 1))\n{\nnow++;\n}\n}\nif(ii != n - 1)\n{\nif(itti(i,ii + 1))\n{\nnow++;\n}\n}\nmaxw = max(maxw,now);\n}\ns[i][ii] = moto;\n}\n}\nprintf(\"%d\\n\",maxw);\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=a;i<b;++i)\n\nint M, N;\nstring grid[1010], pat[2], JOI = \"JOI\";\n\nbool isok(int i, int j) {\n\tif (i < 0 || j < 0 || i >= M - 1 || j >= N - 1) return false;\n\tfor_(k,0,2) for_(l,0,2) if (grid[i + k][j + l] != pat[k][l]) return false;\n\treturn true;\n}\n\nint center(int i, int j) {\n\tint res = 0;\n\tfor_(y,-1,1) for_(x,-1,1) if (isok(i+y, j+x)) ++res;\n\treturn res;\n}\n\nint main() {\n\tcin >> M >> N;\n\tfor_(i,0,M) cin >> grid[i];\n\tfor_(i,0,2) cin >> pat[i];\n\t\n\tint ini = 0;\n\tfor_(i,0,M) for_(j,0,N) {\n\t\tif (isok(i, j)) ++ini;\n\t}\n\t\n\tint ans = 0;\n\tfor_(i,0,M) for_(j,0,N) {\n\t\tint cur = center(i,j), nx = 0;\n\t\t\n\t\tchar c = grid[i][j];\n\t\tfor_(k,0,3) {\n\t\t\tgrid[i][j] = JOI[k];\n\t\t\tnx = max(nx, center(i,j));\n\t\t}\n\t\tgrid[i][j] = c;\n\t\t\n\t\tans = max(ans, ini + nx - cur);\n\t}\n\t\n\tcout << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\n#include <map>\n#include <queue>\n#include <stack>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdlib>\n\nusing namespace std;\n\n#define ALL(c) c.begin(),c.end()\n#define RALL(c) c.rbegin(),c.rend()\n#define REP(type,i,n) for(type i=0;i<(n);++i)\n#define MP(a,b) make_pair((a),(b))\n#define F_ first\n#define S_ second\n\ntypedef long long int lli;\ntypedef pair<int,int> Pi;\n\nconst int INF=100000000;\nconst long long int INF_=1000000000000000000;\n\nint dy[4]={0,1,0,1},dx[4]={0,0,1,1};\nint dy_[4]={0,-1,-1,0},dx_[4]={0,0,-1,-1};\n\nbool IsSame(char c[][2],vector<vector<char> > &g,int y,int x){\n\tREP(int,i,4){\n\t\tint ny=y+dy[i],nx=x+dx[i];\n\t\tif(g[ny][nx]!=c[dy[i]][dx[i]]) return false;\n\t}\n\treturn true;\n}\n\nint main(){\n\tint M,N;\n\tcin >> M >> N;\n\tvector<vector<char> > g(M+2,vector<char>(N+2,'.'));\n\tREP(int,i,M){\n\t\tREP(int,j,N){\n\t\t\tcin >> g[i+1][j+1];\n\t\t}\n\t}\n\tchar c[2][2];\n\tREP(int,i,2) REP(int,j,2) cin >> c[i][j];\n\tint ans=0,sum=0;\n\tfor(int y=1; y<M; ++y){\n\t\tfor(int x=1; x<N; ++x){\n\t\t\tif(IsSame(c,g,y,x)) ++sum;\n\t\t}\n\t}\n\tans=sum;\n\tstring s=\"JOI\";\n\tfor(int y=1; y<=M; ++y){\n\t\tfor(int x=1; x<=N; ++x){\n\t\t\tREP(int,i,3){\n\t\t\t\tchar tmp=g[y][x];\n\t\t\t\tint c1=0,c2=0;\n\t\t\t\tREP(int,j,4){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c1;\n\t\t\t\t}\n\t\t\t\tg[y][x]=s[i];\n\t\t\t\tREP(int,j,4){\n\t\t\t\t\tint ny=y+dy_[j],nx=x+dx_[j];\n\t\t\t\t\tif(IsSame(c,g,ny,nx)) ++c2;\n\t\t\t\t}\n\t\t\t\tg[y][x]=tmp;\n\t\t\t\tans=max(ans,sum-c1+c2);\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\nchar g[1111][1111];\nchar f[11][11];\nbool ok[1111][1111];\n\nbool ch(int i,int j) {\n  return g[i][j] == f[0][0] && g[i][j+1] == f[0][1] &&\n    g[i+1][j] == f[1][0] && g[i+1][j+1] == f[1][1];\n}\n\nint main(void)\n{\n  int h,w;\n  scanf(\"%d%d\",&h,&w);\n  for( int i = 0; i < h; i++ ) {\n    for( int j = 0; j < w; j++ ) {\n      scanf(\" %c\",g[i]+j);\n    }\n  }\n  for( int i = 0; i < 2; i++ ) {\n    for( int j = 0; j < 2; j++ ) scanf(\" %c\",f[i]+j);\n  }\n  int res = 0,cnt = 0;\n  for( int i = 0; i < h-1; i++ ) {\n    for( int j = 0; j < w-1; j++ ) {\n      if( ch(i,j) ) {\n        ok[i][j] = true;\n        ++cnt;\n      }\n    }\n  }\n  res = cnt;\n  for( int i = 0; i < h; i++ ) {\n    for( int j = 0; j < w; j++ ) {\n      static const char* joi = \"JOI\";\n      char t = g[i][j];\n      for( int k = 0; k < 3; k++ ) {\n        int c = cnt;\n        g[i][j] = joi[k];\n        for( int ii = max(0,i-1); ii <= min(i,h-1); ii++ ) {\n          for( int jj = max(0,j-1); jj <= min(j,w-1); jj++ ) {\n            if( ok[ii][jj] ) --c;\n            if( ch(ii,jj) ) ++c;\n          }\n        }\n        res = max(res,c);\n      }\n      g[i][j] = t;\n    }\n  }\n  printf(\"%d\\n\",res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\nusing ll = long long;\n#define rep(i, n) for (int i = 0; i < (int)n; i++)\n\nint M, N;\nchar joi[1003][1003];\nchar c[2][2];\nbool ok(int y, int x) {\n    if (y + 1 >= M || x + 1 >= N) return 0;\n    if (y < 0 || x < 0) return 0;\n    int ys[] = {0, 0, 1, 1};\n    int xs[] = {0, 1, 0, 1};\n    rep(i, 4) {\n        if (c[ys[i]][xs[i]] != joi[y + ys[i]][x + xs[i]]) {\n            return 0;\n        }\n    }\n    return 1;\n}\nvoid show() {\n    rep(y, M) {\n        rep(x, N) cout << joi[y][x] << \" \";\n        cout << endl;\n    }\n    cout << endl;\n}\nint main() {\n    cin >> M >> N;\n    rep(i, M) rep(j, N) { cin >> joi[i][j]; }\n    rep(i, 2) rep(j, 2) cin >> c[i][j];\n    int ans = 0;\n    rep(y, M) rep(x, N) {\n        if (ok(y, x)) ans++;\n        //printf(\"%d %d %d\\n\",y,x,ok(y,x));\n    }\n\n    string logo = \"J\";\n    rep(y, M) rep(x, N) {\n        char tmp = joi[y][x];\n        rep(k, logo.size()) {\n            int cnt = 0;\n            joi[y][x] = logo[k];\n            //show();\n            for (int dy = -1; dy <= 1; dy++)\n                for (int dx = -1; dx <= 1; dx++)\n                    if (ok(y + dy, x + dx)) cnt++;\n            ans = max(ans, cnt);\n            joi[y][x] = tmp;\n        }\n    }\n\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nint match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y && crest_y >= 0; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x && crest_x >= 0; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint m, n;\nint ans = 0;\nint dx[4] = {0,1,0,1}, dy[4] = {0,0,1,1};\nchar flag[1000][1000], hole[2][2], joi[3] = {'J', 'O', 'I'};\n\nint main(){\n\tscanf(\"%d%d\", &m, &n);\n\tfor(int i = 0; i < m; i++){\n\t\tfor(int j = 0; j < n; j++) scanf(\" %c\", &flag[i][j]);\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tfor(int j = 0; j < 2; j++) scanf(\" %c\", &hole[i][j]);\n\t}\n\tfor(int i = 1; i < m; i++){\n\t\tfor(int j = 1; j < n; j++){\n\t\t\tif(flag[i-1][j-1]==hole[0][0]&&flag[i][j-1]==hole[1][0]&&flag[i-1][j]==hole[0][1]&&flag[i][j]==hole[1][1]) ans++;\n\t\t}\n\t}\n\tint paper = 0;\n\tfor(int i = 0; i < m; i++){\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tint t = 0;\n\t\t\tchar tmp = flag[i][j];\n\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\tif((i==0&&(k==0||k==2))||(j==0&&(k==0||k==1))||(i==m-1&&(k==1||k==3))||(i==n-1&&(k==2||k==3))) continue;\n\t\t\t\tif(flag[i-1+dx[k]][j-1+dy[k]]==hole[0][0]&&flag[i+dx[k]][j-1+dy[k]]==hole[1][0]&&flag[i-1+dx[k]][j+dy[k]]==hole[0][1]&&flag[i+dx[k]][j+dy[k]]==hole[1][1]) t++;\n\t\t\t}\n\t\t\tint ss = 0;\n\t\t\tfor(int u = 0; u < 3; u++){\n\t\t\t\tint s = 0;\n\t\t\t\tflag[i][j] = joi[u];\n\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\tif((i==0&&(k==0||k==2))||(j==0&&(k==0||k==1))||(i==m-1&&(k==1||k==3))||(i==n-1&&(k==2||k==3))) continue;\n\t\t\t\t\tif(flag[i-1+dx[k]][j-1+dy[k]]==hole[0][0]&&flag[i+dx[k]][j-1+dy[k]]==hole[1][0]&&flag[i-1+dx[k]][j+dy[k]]==hole[0][1]&&flag[i+dx[k]][j+dy[k]]==hole[1][1]) s++;\n\t\t\t\t}\n\t\t\t\tss = max(ss,s);\n\t\t\t}\n\t\t\tpaper = max(paper,ss-t);\n\t\t\tflag[i][j] = tmp;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans+paper);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n\n//?????????(i,j)?????????????´????????????????\nint em[1000][1000]={0};\n\nint main()\n{\n    int m,n;\n    cin >>m >>n;\n\n    vector<string> s(m);\n    rep(i,m) cin >>s[i];\n\n    vector<string> t(2);\n    rep(i,2) cin >>t[i];\n\n    //?????????????????§???????????????\n    int def=0;\n    rep(i,m-1)rep(j,n-1)\n    {\n        int v=1;\n        rep(y,2)rep(x,2)\n        {\n            if(s[i+y][j+x]!=t[y][x]) v=0;\n        }\n        em[i][j]=v;\n        def+=v;\n    }\n\n    int ans=def;\n    string joi=\"JOI\";\n    //?????´??????\n    rep(i,m)rep(j,n)rep(k,3)\n    {\n        if(s[i][j]==joi[k]) continue;\n\n        int ct=0;\n        //???????????????\n        for(int y=-1; y<=0; ++y)for(int x=-1; x<=0; ++x)\n        {\n            int sy=i+y, sx=j+x;\n            if(0<=sy&&sy<m-1 && 0<=sx&&sx<n-1)\n            {\n                if(em[sy][sx]) --ct;\n                else\n                {\n                    //?´????????????£???????????????\n                    char tmp=s[i][j];\n                    s[i][j]=joi[k];\n\n                    int v=1;\n                    rep(p,2)rep(q,2)\n                    {\n                        if(s[sy+p][sx+q]!=t[p][q]) v=0;\n                    }\n                    ct+=v;\n\n                    s[i][j]=tmp;\n                }\n            }\n        }\n\n        ans=max(ans,def+ct);\n    }\n\n    cout << ans << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//JOI紋章\n\n#include<iostream>\n#include<utility>\n#include<string>\n#include<vector>\n#include<algorithm>\n#include<deque>\n#include<queue>\n#include<set>\n#include<map>\n\nusing namespace std;\n#define LL long long\n\nint M, N, STD = 0, ans = 0;\nchar F[1002][1002], E[3][3];\nstring S = \"JOI\";\n\nbool J(int i, int j) {//紋章と一致しているか\n\treturn\t(F[i][j] == E[0][0] &&\n\t\tF[i][j + 1] == E[0][1] &&\n\t\tF[i + 1][j] == E[1][0] &&\n\t\tF[i + 1][j + 1] == E[1][1]);\n}\n\nint ch(int i, int j) {\n\tint tmp = 0;\n\tif (i != M - 1 && j != N - 1) {//左上を変える\n\t\tif (J(i, j)) tmp++;\n\t}\n\tif (i != M - 1 && j) {//右上\n\t\tif (J(i, j - 1)) tmp++;\n\t}\n\tif (i && j != N - 1) {//左下\n\t\tif (J(i - 1, j)) tmp++;\n\t}\n\tif (i * j) {//右下\n\t\tif (J(i - 1, j - 1)) tmp++;\n\t}\n\treturn tmp;\n}\n\nint main() {\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++)\n\t\t\tcin >> F[i][j];\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) \n\t\t\tcin >> E[i][j];\n\t}\n\tfor (int i = 0; i < M - 1; i++) {\n\t\tfor (int j = 0; j < N - 1; j++) {\n\t\t\tif (J(i,j)) STD++;\n\t\t}\n\t}\n\tans = STD;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tchar T = F[i][j];\n\t\t\tint a, b;\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (T != S[k]) {\n\t\t\t\t\tb = ch(i, j);\n\t\t\t\t\tF[i][j] = S[k];\n\t\t\t\t\ta = ch(i, j);\n\t\t\t\t\tans = max(ans, STD - b + a);\n\t\t\t\t\tF[i][j] = T;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\t\n\t}\n\tcout << ans << endl;\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n//#define int long long\nusing namespace std;\ntypedef long long ll;\n\nint M, N;\nstring hata[1010];\nstring monsyo[2];\nint di[4] = {-1, -1, 0, 0};\nint dj[4] = {-1, 0, -1, 0};\n\nint f(int i, int j, char c) {\n\t//printf(\"f(%d, %d, %c) called\\n\", i, j, c);\n\n\tint pre_num = 0;\n\trep(k,4) {\n\t\tint ni = i + di[k];\n\t\tint nj = j + dj[k];\n\t\tif (ni >= 0 && ni+1 < M && 0 <= nj && hata[ni].substr(nj,2) == monsyo[0] && hata[ni+1].substr(nj,2) == monsyo[1]) {\n\t\t\tpre_num++;\n\t\t}\n\t}\n\n\t//printf(\"AAA\\n\");\n\n\tchar pre_char = hata[i][j];\n\thata[i][j] = c;\n\tint new_num = 0;\n\trep(k,4) {\n\t\tint ni = i + di[k];\n\t\tint nj = j + dj[k];\n\t\tif (ni >= 0 && ni+1 < M && 0 <= nj && hata[ni].substr(nj,2) == monsyo[0] && hata[ni+1].substr(nj,2) == monsyo[1]) {\n\t\t\tnew_num++;\n\t\t}\n\t}\n\thata[i][j] = pre_char;\n\n\t//printf(\"BBB\\n\");\n\n\treturn new_num - pre_num;\n}\n\nsigned main()\n{\n\tcin >> M >> N;\n\trep(i,M) cin >> hata[i];\n\trep(i,2) cin >> monsyo[i];\n\n\tint num = 0;\n\trep(i,M-1) rep(j,N-1) {\n\t\tif (hata[i].substr(j, 2) == monsyo[0] && hata[i+1].substr(j, 2) == monsyo[1]) {\n\t\t\tnum++;\n\t\t}\n\t}\n\n\t//printf(\"num = %d\\n\", num);\n\n\tint mx = -1;\n\trep(i,M) rep(j,N) {\n\t\tmx = max(mx, f(i, j, 'J'));\n\t\tmx = max(mx, f(i, j, 'O'));\n\t\tmx = max(mx, f(i, j, 'I'));\n\t}\n\n\tcout << num + mx << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint H,W;\nint dx[4] = {-1,-1,0,0},dy[4] = {-1,0,-1,0};\nchar F[1010][1010],JOI[3] = {'J','O','I'};\nchar S[2][2];\nbool good[1010][1010] = {};\nint ok(int x,int y){\n\tif(x<1 || H<=x || y<1 || W<=y) return 0;\n\tif(F[x][y]==S[0][0] && F[x+1][y]==S[1][0] && F[x][y+1]==S[0][1] && F[x+1][y+1]==S[1][1]) return 1;\n\telse return 0;\n}\nint main(){\n\tcin >> H >> W;\n\tfor(int i=1;i<=H;i++){\n\t\tfor(int j=1;j<=W;j++){\n\t\t\tcin >> F[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin >> S[i][j];\n\t\t}\n\t}\n\tint ans = 0,sum = 0;\n\tfor(int i=1;i<H;i++){\n\t\tfor(int j=1;j<W;j++){\n\t\t\tsum += ok(i,j);\n\t\t\tgood[i][j] = ok(i,j);\n\t\t}\n\t}\n\tans = sum;\n\tfor(int i=1;i<=H;i++){\n\t\tfor(int j=1;j<=W;j++){\n\t\t\tchar c = F[i][j];\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tint cnt = 0;\n\t\t\t\tif(JOI[k]==c) continue;\n\t\t\t\tF[i][j] = JOI[k];\n\t\t\t\tfor(int l=0;l<4;l++){\n\t\t\t\t\tint nx = i+dx[l],ny = j+dy[l];\n\t\t\t\t\tif(ok(nx,ny)) cnt++;\n\t\t\t\t\telse if(good[nx][ny]) cnt--;\n\t\t\t\t}\n\t\t\t\tans = max(ans,sum+cnt);\n\t\t\t}\n\t\t\tF[i][j] = c;\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nmain(){\n  int n,m;\n  char masu[1002][1002];\n  int mem[1002][1002]={0};\n  int mem2[1002][1002]={0};\n  char monsyou[3][3];\n  int before=0,after=0;\n  char joi[3]={'J','O','I'};\n  int ihu[4]={-1,-1,0,0};\n  int jhu[4]={-1,0,-1,0};\n  int imu[4]={-1,-1,0,0};\n  int jmu[4]={0,1,0,1};\n  int ihs[4]={0,0,1,1};\n  int jhs[4]={-1,0,-1,0};\n  int ims[4]={0,0,1,1};\n  int jms[4]={0,1,0,1};\n  cin>>n>>m;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin>>masu[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      for(int k=0;k<4;k++){\n\tif(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t  before=before+1;\n\t  mem[i][j]=mem[i][j]+1;\n\t}\n      }\n    }\n  }\n  before=before/4;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      char kioku;\n      kioku=masu[i][j];\n      for(int a=0;a<3;a++){\n\tif(masu[i][j]!=joi[a]){\n\t  masu[i][j]=joi[a];\n\t  for(int k=0;k<4;k++){\n\t    if(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t      mem2[i][j]=mem[i][j]+1;\n\t    }\n\t  }\n\t  masu[i][j]=kioku;\n\t}\n\tif(mem2[i][j]-mem[i][j]>after){\n\t  after=mem2[i][j]-mem[i][j];\n\t}\n      }\t\n    }\n  }\n  cout<<before+after<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\nusing namespace std;\nint mmin(int &a, int b) {\n\ta = min(a, b);\n\treturn a;\n}\nint mmax(int &a, int b) {\n\ta = max(a, b);\n\treturn a;\n}\nint sq(vector<vector<int> > &ha,vector<vector<int> > & mo,int y,int x,int m, int n) {\n\tint ans = 0;\n\tif (0 <= x and x < n-1 and 0 <= y and y < m-1) {\n\t\tans = 1;\n\t\tfor (int i = 0; i < 2; i++) {\n\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\tif (ha[y + i][x + j] != mo[i][j]) {\n\t\t\t\t\tans = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\nint ko(vector<vector<int> > &ha, vector<vector<int> > & mo, int y, int x, int m, int n) {\n\tint ans = 0;\n\tfor (int dy = 0; dy >= -1; dy--) {\n\t\tfor (int dx = 0; dx >= -1; dx--) {\n\t\t\tans += sq(ha, mo, y + dy, x + dx, m, n);\n\t\t}\n\t}\n\treturn ans;\n}\nint main() {\n\tint m, n;\n\tcin >> m >> n;\n\tvector<vector<int> > h(m, vector<int>(n));\n\tstring he = \"JOI\";\n\tfor (int i = 0; i < m; i++) {\n\t\tstring s; cin >> s;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (he[k] == s[j]) {\n\t\t\t\t\th[i][j] = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<vector<int> > mo(2, vector<int>(2));\n\tfor (int i = 0; i < 2; i++) {\n\t\tstring s; cin >> s;\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (he[k] == s[j]) {\n\t\t\t\t\tmo[i][j] = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint sy = 0;\n\tfor (int i = 0; i < m - 1; i++) {\n\t\tfor (int j = 0; j < n - 1; j++) {\n\t\t\tbool che = true;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (h[i + k][j + l] != mo[k][l]) {\n\t\t\t\t\t\tche = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (che) {\n\t\t\t\tsy++;\n\t\t\t}\n\t\t}\n\t}\n\tint cha = 0;\n\tfor (int i = 0; i < m; i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tint mot = ko(h, mo, i, j, m, n);\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\th[i][j] = (h[i][j] + 1) % 3;\n\t\t\t\tint x = ko(h, mo, i, j, m, n);\n\t\t\t\tmmax(cha, x - mot);\n\t\t\t}\n\t\t\th[i][j] = (h[i][j] + 1) % 3;\n\t\t}\n\t}\n\tcout << sy+cha << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <map>\n#include <set>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <cctype>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <cstdlib>\n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <functional>\n\n#define INF (2 << 28)\n#define fr first\n#define sc second\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> iP;\n\nint main(){\n  \n  int w, h, base = 0;\n  char mas[1111][1111], flag[2][2];\n  string joi = \"JOI\";\n\n  cin >> h >> w;\n  for(int i = 0; i < h; i++)\n    for(int j = 0; j < w; j++) cin >> mas[i][j];\n  \n  for(int i = 0; i < 2; i++)\n    for(int j = 0; j < 2; j++) cin >> flag[i][j];\n  \n  for(int i = 0; i < h-1; i++){\n    for(int j = 0; j < w-1; j++){\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          if(mas[i + k][j + l] != flag[k][l]) goto next;\n        }\n      }\n      base++;\n    next:;\n    }\n  }\n\n  int res = 0;\n  for(int i = 0; i < h; i++){\n    for(int j = 0; j < w; j++){\n      int base2 = 0;\n      for(int l = max(0, i - 1); l <= i; l++){\n        for(int m = max(0, j - 1); m <= j; m++){\n          for(int x = 0; x < 2; x++){\n            for(int y = 0; y < 2; y++){\n              if(mas[l + x][m + y] != flag[x][y]) goto next2;\n            }\n          }\n          base2++;\n        next2:;\n        }\n      }\n  \n      for(int k = 0; k < 3; k++){\n        char change = joi[k];\n        if(mas[i][j] == change) continue;\n        swap(change, mas[i][j]);\n        int sum1 = 0;\n        for(int l = max(0, i - 1); l <= i; l++){\n          for(int m = max(0, j - 1); m <= j; m++){\n            for(int x = 0; x < 2; x++){\n              for(int y = 0; y < 2; y++){\n                if(mas[l + x][m + y] != flag[x][y]) goto next3;\n              }\n            }\n            sum1++;\n          next3:;\n          }\n        }\n        res = max(res, base + (sum1 - base2));\n        mas[i][j] = change;\n      }\n    }\n  } \n  cout << res << endl;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0 || ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx]);\n\t\t\t\t}\n\t\t\t\telse if(nx == 0 || nx == W - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx - 1]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = 1;\n\t\t\t\t\tt += (search(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "   #include <bits/stdc++.h>\n \n//    #include <boost/multiprecision/cpp_int.hpp>\n #define int long long\n #define inf  1000000007\n #define pa pair<int,int>\n #define ll long long\n #define pal pair<double,double>\n #define ppap pair<pa,int>\n  #define PI 3.14159265358979323846\n  #define paa pair<int,char>\n  #define  mp make_pair\n  #define  pb push_back\n  #define EPS (1e-8)\n                                          \n    int dx[8]={0,1,0,-1,1,1,-1,-1};\n    int dy[8]={1,0,-1,0,-1,1,1,-1};\n                                            using namespace std;\n                                   \t\t\tclass pa3{\n                                            \tpublic:\n                                            \tint x;\n                                   \t\t\t\tint y,z;\n                                            \tpa3(int x=0,int y=0,int z=0):x(x),y(y),z(z) {}\n                                            \tbool operator < (const pa3 &p) const{\n                                            \t\tif(x!=p.x) return x<p.x;\n                                            \t\tif(y!=p.y) return y<p.y;\n                                            \t\t return z<p.z;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                   \t\t\t\tbool operator > (const pa3 &p) const{\n                                            \t\tif(x!=p.x) return x>p.x;\n                                            \t\tif(y!=p.y) return y>p.y;\n                                            \t\t return z>p.z;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa3 &p) const{\n                                            \t\treturn x==p.x && y==p.y && z==p.z;\n                                            \t}\n                                            \t\tbool operator != (const pa3 &p) const{\n                                            \t\t\treturn !( x==p.x && y==p.y && z==p.z);\n                                            \t}\n                                            \n                                            };\n                                            \n                                            class pa4{\n                                            \tpublic:\n                                            \tint x;\n                                            \tint y,z,w;\n                                            \tpa4(int x=0,int y=0,int z=0,int w=0):x(x),y(y),z(z),w(w) {}\n                                            \tbool operator < (const pa4 &p) const{\n                                            \t\tif(x!=p.x) return x<p.x;\n                                            \t\tif(y!=p.y) return y<p.y;\n                                            \t\tif(z!=p.z)return z<p.z;\n                                            \t\treturn w<p.w;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator > (const pa4 &p) const{\n                                            \t\tif(x!=p.x) return x>p.x;\n                                            \t\tif(y!=p.y) return y>p.y;\n                                            \t\tif(z!=p.z)return z>p.z;\n                                            \t\treturn w>p.w;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa4 &p) const{\n                                            \t\treturn x==p.x && y==p.y && z==p.z &&w==p.w;\n                                            \t}\n                                            \t\t\n                                            \n                                            };\n                                            class pa2{\n                                            \tpublic:\n                                            \tint x,y;\n                                            \tpa2(int x=0,int y=0):x(x),y(y) {}\n                                            \tpa2 operator + (pa2 p) {return pa2(x+p.x,y+p.y);}\n                                            \tpa2 operator - (pa2 p) {return pa2(x-p.x,y-p.y);}\n                                            \tbool operator < (const pa2 &p) const{\n                                            \t\treturn y != p.y ? y<p.y: x<p.x;\n                                            \t}\n                                            \tbool operator > (const pa2 &p) const{\n                                            \t\treturn x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa2 &p) const{\n                                            \t\treturn abs(x-p.x)==0 && abs(y-p.y)==0;\n                                            \t}\n                                            \tbool operator != (const pa2 &p) const{\n                                            \t\treturn !(abs(x-p.x)==0 && abs(y-p.y)==0);\n                                            \t}\n                                            \t\t\n                                            \n                                            };\n                                            \n \n                      \n                                string itos( int i ) {\n                                ostringstream s ;\n                                s << i ;\n                                return s.str() ;\n                                }\n                                 \n                                int gcd(int v,int b){\n                                \tif(v==0) return b;\n                                \tif(b==0) return v;\n                                \tif(v>b) return gcd(b,v);\n                                \tif(v==b) return b;\n                                \tif(b%v==0) return v;\n                                \treturn gcd(v,b%v);\n                                }\n                 \n                            \n                                int mod;\nint extgcd(int a, int b, int &x, int &y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int d = extgcd(b, a%b, y, x);\n    y -= a/b * x;\n    return d;\n}\npa operator+(const pa & l,const pa & r) {   \n    return {l.first+r.first,l.second+r.second};                                    \n}    \npa operator-(const pa & l,const pa & r) {   \n    return {l.first-r.first,l.second-r.second};                                    \n}  \n                                \n                int pr[10000100];\n                int inv[10000010];\n                \n                int beki(int wa,int rr,int warukazu){\n                \tif(rr==0) return 1%warukazu;\n                \tif(rr==1) return wa%warukazu;\n                \twa%=warukazu;\n                \tif(rr%2==1) return ((ll)beki(wa,rr-1,warukazu)*(ll)wa)%warukazu;\n                \tll zx=beki(wa,rr/2,warukazu);\n                \treturn (zx*zx)%warukazu;\n                }\n \n                \n    \t\t\tint comb(int nn,int rr){\n    \t\t\t\tif(rr<0 || rr>nn || nn<0) return 0;\n    \t\t\t\tint r=pr[nn]*inv[rr];\n    \t\t\t\tr%=mod;\n    \t\t\t\tr*=inv[nn-rr];\n    \t\t\t\tr%=mod;\n    \t\t\t\treturn r;\n    \t\t\t}\n               \n                void gya(int ert){\n                \tpr[0]=1;\n                \tfor(int i=1;i<=ert;i++){\n                \t\tpr[i]=(pr[i-1]*i)%mod;\n                \t}\n                \t\tinv[ert]=beki(pr[ert],mod-2,mod);\n                \tfor(int i=ert-1;i>=0;i--){\n                \t\tinv[i]=inv[i+1]*(i+1)%mod;\n                \t}\n                }\n                \n              //   cin.tie(0);\n    \t\t//\tios::sync_with_stdio(false);\n    \t\t\t//priority_queue<pa3,vector<pa3>,greater<pa3>> pq;            \n                 //sort(ve.begin(),ve.end(),greater<int>());\n //   mt19937(clock_per_sec);\n  //  mt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count()) ;\n      \n       \nstring s[1010];\nstring t[2];\nbool ok[1010][1010];\n\nsigned main(){\n\t\n\t\n   cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint h,w;\n\tcin>>h>>w;\n\tfor(int i=0;i<h;i++)cin>>s[i];\n\tcin>>t[0]>>t[1];\n\tint cnt=0;\n\tfor(int i=0;i<h-1;i++)for(int j=0;j<w-1;j++){\n\t\tbool bo=true;\n\t\tif(s[i][j]!=t[0][0])bo=false;\n\t\tif(s[i+1][j]!=t[1][0])bo=false;\n\t\tif(s[i][j+1]!=t[0][1])bo=false;\n\t\tif(s[i+1][j+1]!=t[1][1])bo=false;\n\t\tok[i][j]=bo;\n\t\tif(bo)cnt++;\n\t}\n\tint sa=0;\n\tstring E=\"JOI\";\n\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++){\n\t\tchar c=s[i][j];\n\t\tfor(auto d:E)if(d!=c){\n\t\t\ts[i][j]=d;\n\t\t\tint p=0;\n\t\t\tfor(int k=-1;k<=0;k++)for(int l=-1;l<=0;l++)if(i+k>=0 && i+k<h-1 && j+l>=0 && j+l<w-1){\n\t\t\t\tif(ok[i+k][j+l])p--;\n\t\t\t\tif(s[i+k][j+l]==t[0][0] && s[i+k][j+l+1]==t[0][1] &&s[i+k+1][j+l]==t[1][0] &&s[i+k+1][j+l+1]==t[1][1] )p++;\n\t\t\t\t\n\t\t\t}\n\t\t\tsa=max(sa,p);\n\t\t\t\n\t\t}\n\t\ts[i][j]=c;\n\t}\n\tcout<<cnt+sa<<endl;\n\treturn 0;\n\t\n\n \n }\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<int,int> P;\nint n;\n\nint main(){\n  int h,w;\n  char flag[1111][1111];\n  char emb[5][5];\n  char mas[] = {'J','O','I'};\n  int dx[] = {-1,-1,0,0};\n  int dy[] = {-1,0,-1,0};\n  int cnt = 0;\n  int ans = 0;\n  cin >> h >> w;\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      cin >> flag[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin >> emb[i][j];\n    }\n  }\n  for(int i=0;i<h-1;i++){\n    for(int j=0;j<w-1;j++){\n      if(flag[i][j] == emb[0][0] && flag[i][j+1] == emb[0][1] && flag[i+1][j] == emb[1][0] && flag[i+1][j+1] == emb[1][1]){\n\tcnt++;\n      }\n    }\n  }\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      for(int z=0;z<3;z++){\n\tif(flag[i][j] == mas[z]) continue;\n\tchar tmp = flag[i][j];\n\tflag[i][j] = mas[z];\n\tint ret = 0;\n\tfor(int k=0;k<4;k++){\n\t  int nx = j + dx[k];\n\t  int ny = i + dy[k];\n\t  if(flag[ny][nx] == emb[0][0] && flag[ny][nx+1] == emb[0][1] && flag[ny+1][nx] == emb[1][0] && flag[ny+1][nx+1] == emb[1][1]){\n\t    ret++;\n\t  }\n\t}\n\tans = max(ans,cnt+ret);\n\tflag[i][j] = tmp;\n      }\n    }\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\n\nstruct st {\n\tint x, y;\n\tchar c;\n};\nbool operator<(st a, st b) {\n\tif (a.x == b.x&&a.y == b.y)return a.c < b.c;\n\tif (a.x == b.x)return a.y < b.y;\n\treturn a.x < b.x;\n}\nchar s[1000][1001], f[2][3];\nint main() {\n\tint m, n; scanf(\"%d%d\", &m, &n);\n\trep(i, m)scanf(\"%s\", s[i]);\n\trep(i, 2)scanf(\"%s\", f[i]);\n\tmap<st, int>mp;\n\tint ans = 0;\n\trep(i, m - 1) {\n\t\trep(j, n - 1) {\n\t\t\tbool match[4]{};\n\t\t\trep(k, 2)rep(t, 2) {\n\t\t\t\tif (s[i + k][j + t] == f[k][t])\n\t\t\t\t\tmatch[k * 2 + t] = true;\n\t\t\t}\n\t\t\tint cnt = count(match, match + 4, true);\n\t\t\tif (cnt == 4)ans++;\n\t\t\tif (cnt == 3) {\n\t\t\t\trep(k, 4) {\n\t\t\t\t\tif (!match[k])\n\t\t\t\t\t\tmp[{i + k / 2, j + k % 2, f[k / 2][k % 2]}]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint Max = 0;\n\tfor (auto p : mp) {\n\t\tint cnt = 0;\n\t\trep(i, 2)rep(j, 2) {\n\t\t\tint x = p.first.x + i, y = p.first.y + j;\n\t\t\tbool ok = true;\n\t\t\trep(k, 2)rep(t, 2) {\n\t\t\t\tif (s[x + k][y + t] != f[k][t])ok = false;\n\t\t\t}\n\t\t\tif (ok) {\n\t\t\t\tswap(s[p.first.x][p.first.y], (char)p.first.c);\n\t\t\t\tif (s[p.first.x][p.first.y] != f[i][j])cnt++;\n\t\t\t\tswap(s[p.first.x][p.first.y], (char)p.first.c);\n\t\t\t}\n\t\t}\n\t\tMax = max(Max, p.second - cnt);\n\t}\n\tprintf(\"%d\\n\", ans + Max);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define LINF (ll)INF*INF\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(int i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\n#define int ll //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef vector<pii> vp;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a/gcd(a,b)*b;\n}\n\nint n,m;\nvs s,t(2);\nbool f(int x,int y){\n    if(x < 0 || y < 0)return false;\n    if(x >= n-1 || y >= m-1)return false;\n    rep(i,2)rep(j,2){\n        if(s[x+i][y+j] != t[i][j])return false;\n    }\n    return true;\n}\n\nsigned main(void) {\n    cin >> n >> m;\n    s = vs(n);\n    rep(i,n)cin >> s[i];\n    rep(i,2)cin >> t[i];\n    int sum = 0;\n    rep(i,n-1)rep(j,m-1){\n        if(f(i,j))sum++;\n    }\n    int ans = 0;\n    string q = \"JOI\";\n    rep(i,n)rep(j,m)rep(k,3){\n        int tmp = sum;\n        int p = -1;\n        char c = s[i][j];\n        rep(_,2){\n            if(f(i-1,j))tmp += p;\n            if(f(i-1,j-1))tmp += p;\n            if(f(i,j-1))tmp += p;\n            if(f(i,j))tmp += p;\n            p *= -1;\n            s[i][j] = q[k];\n        }\n        s[i][j] = c;\n        ans = max(ans, tmp);\n    }\n    cout << ans << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nint main(){\n  int m,n;\n  char s[1000][1001];\n  char monsyo[2][3];\n  scanf(\"%d %d\",&m,&n);\n  for(int i=0;i<m;i++) scanf(\"%s\",s[i]);\n  for(int i=0;i<2;i++) scanf(\"%s\",monsyo[i]);\n  int cnt = 0, ans = 0;\n  for(int i=0;i+1<m;i++){\n    for(int j=0;j+1<n;j++){\n      if(s[i][j]==monsyo[0][0]&&s[i+1][j+1]==monsyo[1][1]&&s[i+1][j]==monsyo[1][0]&&s[i][j+1]==monsyo[0][1]) cnt++;\n    }\n  }\n  for(int i=0;i<m;i++){\n    for(int j=0;j<n;j++){\n      char c[] = \"JOI\";\n      int x;\n      int tmp[3] = {0, 0, 0};\n      char d = s[i][j];\n      for(int k=0;k<3;k++){\n        s[i][j] = c[k];\n        int dx[] = {-1, 0, -1, 0};\n        int dy[] = {-1, -1, 0, 0};\n        for(int l=0;l<4;l++){\n          int ni = i + dx[l], nj = j + dy[l];\n          if(ni<0||ni>=m-1||nj<0||nj>=n-1) continue;\n          if(s[ni][nj]==monsyo[0][0]&&s[ni+1][nj+1]==monsyo[1][1]&&s[ni+1][nj]==monsyo[1][0]&&s[ni][nj+1]==monsyo[0][1]) tmp[k]++;\n        }\n        if(c[k]==d) x = tmp[k];\n      }\n      for(int k=0;k<3;k++) ans = max(ans,tmp[k]-x);\n      s[i][j] = d;\n    }\n  }\n  ans += cnt;\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint M, N;\nstring mas[1000];\nstring comp[2];\nbool joi[1000][1000];\n\n\nint check_st(){\n  int sum = 0;\n  for(int i = 0; i < M - 1; i++){\n    for(int j = 0; j < N - 1; j++){\n      bool flag = true;\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          if(mas[i + k][j + l] != comp[k][l]){\n            flag = false;\n            break;\n          }\n          if(!flag) break;\n        }\n      }\n      joi[i][j] = flag;\n      sum += flag;\n    }\n  }\n  return sum;\n}\n\nint check_nl(const int& x, const int& y, const int& pv){\n\n  int ret = pv;\n\n  for(int i = -1; i < 1; i++){\n    for(int j = -1; j < 1; j++){\n      if(y + i < 0 || x + j < 0 || y + i + 1 >= M || x + j + 1 >= N) continue;\n      bool flag = true;\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          if(mas[y + i + k][x + j + l] != comp[k][l]){\n            flag = false;\n            break;\n          }\n        }\n        if(!flag) break;\n      }\n      if(flag){\n        if(!joi[y + i][x + j]) ret++;\n      }else{\n        if(joi[y + i][x + j]) ret--;\n      }\n    }\n  }\n  \n  return ret;\n}\nint main(){\n\n\n  cin >> M >> N;\n  for(int i = 0; i < M; i++){\n    cin >> mas[i];\n  }\n  for(int i = 0; i < 2; i++){\n    cin >> comp[i];\n  }\n\n  int ret = check_st();\n  int pv = ret;\n\n  for(int i = 0; i < M; i++){\n    for(int j = 0; j < N; j++){\n      char prev = mas[i][j];\n      for(int k = 0; k < 3; k++){\n        if(prev != k[\"JOI\"]){\n          mas[i][j] = k[\"JOI\"];\n          ret = max( ret, check_nl( j, i, pv));\n        }\n      }\n      mas[i][j] = prev;\n    }\n  }\n\n  cout << ret << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n\nusing namespace std;\n\n#define MMAX 1000\n#define NMAX 1000\n#define JOI_J 0\n#define JOI_O 1\n#define JOI_I 2\n\nint M,N;\nstring emb[MMAX];\nstring mon[2];\nint changec[3][MMAX][NMAX];\n\nint main(){\n\n\t\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tcin>>emb[i];\n\t}\n\n\tcin>>mon[0];\n\tcin>>mon[1];\n\n\tint c=0;\n\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tchangec[k][i][j]=0;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor(int i=0;i<M-1;i++){\n\t\tfor(int j=0;j<N-1;j++){\n\t\t\tbool f=true;\n\t\t\tint fc=0;\n\t\t\tint fi=0,fj=0,fm=0;\n\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\tfor(int l=0;l<2;l++){\n\t\t\t\t\tif(emb[i+k][j+l]!=mon[k][l]){\n\t\t\t\t\t\tf=false,fc++,fi=i+k,fj=j+l;\n\t\t\t\t\t\tif(mon[k][l]=='J') fm=JOI_J;\n\t\t\t\t\t\tif(mon[k][l]=='O') fm=JOI_O;\n\t\t\t\t\t\tif(mon[k][l]=='I') fm=JOI_I;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(f){\n\t\t\t\tc++;\n\t\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\t\tfor(int l=0;l<2;l++){\n\t\t\t\t\t\tfor(int m=0;m<3;m++){\n\t\t\t\t\t\t\tif(!(m==JOI_J&&emb[i+k][j+l]=='J'||m==JOI_O&&emb[i+k][j+l]=='O'||m==JOI_I&&emb[i+k][j+l]=='I')) changec[m][i+k][j+l]--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(fc==1){\n\t\t\t\t\tchangec[fm][fi][fj]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t\n\n\tint max=-1;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tif(max<changec[k][i][j]) max=changec[k][i][j];\n\t\t\t}\n\t\t}\n\t}\n\n\tif(max>=1) c+=max;\n\tcout<<c<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002];\nint main() {\n\tint M,N;\n\tint R=0;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a=0;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a+=1;\n\t\t}\n\t}\n\n\tint c[4];\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\n\t\t}\n\t}\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<math.h>\n#include<queue>\n#include<set>\n#include<map>\n#include<random>\n#include<functional>\n#include<utility>\n\ntypedef long long ll;\n\n#define rep(i,n) for(int i=0; i<n; i++)\n#define pb push_back\n#define P pair<int, int>\n#define PLI pair<ll, int>\n#define PLL pair<ll, ll>\n#define VI vector<int>\n#define VII vector<VI>\n\nusing namespace std;\n\n\nstring JOI = \"JOI\";\nint M, N;\nstring frag[1005], mon[2];\nint old[1005][1005] = {};\nint main() {\n\tcin >> M >> N;\n\trep(i, M) cin >> frag[i];\n\trep(i, 2) cin >> mon[i];\n\tint cnt = 0;\n\trep(i, M-1) rep(j, N-1) {\n\t\tif (!(frag[i][j] == mon[0][0] && frag[i][j + 1] == mon[0][1] && frag[i + 1][j] == mon[1][0] && frag[i + 1][j + 1] == mon[1][1]))\n\t\t\tcontinue;\n\t\tcnt++;\n\t\trep(k, 2)rep(l, 2) old[i + k][j + l]++;\n\t}\n\tint ans = cnt;\n\trep(i, M)rep(j, N) {\n\t\trep(o, 3) {\n\t\t\tif (frag[i][j] == JOI[o]) continue;\n\t\t\tchar bf = frag[i][j];\n\t\t\tfrag[i][j] = JOI[o];\n\t\t\tint tmp = cnt - old[i][j];\n\t\t\trep(k, 2) rep(l, 2) {\n\t\t\t\tint x = i - k, y = j - l;\n\t\t\t\tif (x < 0 || y < 0 || M - 1 <= x || N - 1 <= y) continue;\n\t\t\t\tif (frag[x][y] == mon[0][0] && frag[x][y + 1] == mon[0][1] && frag[x + 1][y] == mon[1][0] && frag[x + 1][y + 1] == mon[1][1])\n\t\t\t\t\ttmp++;\n\t\t\t}\n\t\t\tans = max(ans, tmp);\n\t\t\tfrag[i][j] = bf;\n\t\t}\n\t}\n\tcout << ans << endl;\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint siro[1000][1000][3];\nint main(){\n  int m,n;\n  char str[1000][1001],flag[5];\n  cin >> m >> n;\n  for(int i=0;i<m;i++){\n    scanf(\"%s\",str[i]);\n  }\n  scanf(\" %c %c %c %c\",&flag[0],&flag[1],&flag[2],&flag[3]);\n  int ans = 0,ma = 0;\n  fill_n(**siro,1000*1000*3,0);\n  for(int i=0;i<m-1;i++){\n    for(int j=0;j<n-1;j++){\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tans++;\n      }\n      if(str[i][j]!=flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tif(flag[0] == 'J'){\n\t  siro[i][j][0]++;\n\t  ma = max(ma,siro[i][j][0]);\n\t}\n\tif(flag[0] == 'O'){\n\t  siro[i][j][1]++;\n\t  ma = max(ma,siro[i][j][1]);\n\t}\n\tif(flag[0] == 'I'){\n\t  siro[i][j][2]++;\n\t  ma = max(ma,siro[i][j][2]);\n\t}\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]!=flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tif(flag[1] == 'J'){\n\t  siro[i][j+1][0]++;\n\t  ma = max(ma,siro[i][j+1][0]);\n\t}\n\tif(flag[1] == 'O'){\n\t  siro[i][j+1][1]++;\n\t  ma = max(ma,siro[i][j+1][1]);\n\t}\n\tif(flag[1] == 'I'){\n\t  siro[i][j+1][2]++;\n\t  ma = max(ma,siro[i][j+1][2]);\n\t}\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]!=flag[2] && str[i+1][j+1]==flag[3]){\n\tif(flag[2] == 'J'){\n\t  siro[i+1][j][0]++;\n\t  ma = max(ma,siro[i+1][j][0]);\n\t}\n\tif(flag[2] == 'O'){\n\t  siro[i+1][j][1]++;\n\t  ma = max(ma,siro[i+1][j][1]);\n\t}\n\tif(flag[2] == 'I'){\n\t  siro[i+1][j][2]++;\n\t  ma = max(ma,siro[i+1][j][2]);\n\t}\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]!=flag[3]){\n\tif(flag[3] == 'J'){\n\t  siro[i+1][j+1][0]++;\n\t  ma = max(ma,siro[i+1][j+1][0]);\n\t}\n\tif(flag[3] == 'O'){\n\t  siro[i+1][j+1][1]++;\n\t  ma = max(ma,siro[i+1][j+1][1]);\n\t}\n\tif(flag[3] == 'I'){\n\t  siro[i+1][j+1][2]++;\n\t  ma = max(ma,siro[i+1][j+1][2]);\n\t}\n      }\n    }\n  }\n  cout << ans+ma << endl;\n  return (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<queue>\n#include<map>\n#include<set>\n#include<list>\n#include<iomanip>\n#include<vector>\n#include<functional>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nchar a[1000][1000];\nint c[1000][1000];\nint main(){\n\tint h,w;\n\twhile(cin>>h>>w){\n\t\tstring u;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\ta[i][j]=u[j];\n\t\t\t\tc[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tchar b[2][2];\n\t\tfor(int i=0;i<2;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<2;j++) b[i][j]=u[j];\n\t\t}\n\t\tint sum=0,sum2=0;\n\t\tfor(int i=0;i<h-1;i++){\n\t\t\tfor(int j=0;j<w-1;j++){\n\t\t\t\tif(a[i][j]==b[0][0]&&a[i][j+1]==b[0][1]&&\n\t\t\t\ta[i+1][j]==b[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\tc[i][j]++;\n\t\t\t\t\tsum++;\n\t\t\t\t\tc[i][j+1]++;\n\t\t\t\t\tc[i+1][j]++;\n\t\t\t\t\tc[i+1][j+1]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsum2=sum;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmap<char, int>d;\n\t\t\t\td.insert(map<char, int>::value_type('J',0));\n\t\t\t\td.insert(map<char, int>::value_type('O',0));\n\t\t\t\td.insert(map<char, int>::value_type('I',0));\n\t\t\t\tif(i+1<h&&j+1<w){\n\t\t\t\t\tif(a[i][j+1]==b[0][1]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\t\t\td[b[0][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i+1<h&&j-1>=0){\n\t\t\t\t\tif(a[i][j-1]==b[0][0]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][1]&&a[i+1][j-1]==b[1][0]){\n\t\t\t\t\t\td[b[0][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j+1<h){\n\t\t\t\t\tif(a[i-1][j]==b[0][0]&&a[i-1][j+1]==b[0][1]&&\n\t\t\t\t\t\ta[i][j+1]==b[1][1]){\n\t\t\t\t\t\td[b[1][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j-1>=0){\n\t\t\t\t\tif(a[i-1][j-1]==b[0][0]&&a[i-1][j]==b[0][1]&&\n\t\t\t\t\t\ta[i][j-1]==a[1][0]){\n\t\t\t\t\t\td[b[1][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['J']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['J']);\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['O']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['O']);\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['I']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['I']);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<sum2<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <set>\n#include <string>\n#include <stack>\n#include <cmath>\n#define ll long long\n#define FOR(i,a,b) for(int i=a;i<b;i++)\n#define ROF(i,a,b) for(int i=b-1;i>=a;i--)\nusing namespace std;\n//\nconst int inf=1e9+7;\nconst int mod=1e9+7;\n//\nstruct poi{\n\tint X;int Y;int Z;\n\tbool operator<(const poi&R)const{\n\t\treturn X==R.X ? Y==R.Y ? Z<R.Z : Y<R.Y : X<R.X;\n\t}\n};\n//\nll GCD(ll a,ll b){\n\treturn (b==0)?(a):(GCD(b,a%b));\n}\nll LCM(ll a,ll b){\n\treturn a/GCD(a,b)*b;\n}\n//\nint M,N;\nchar F[1000][1000],f[2][2];\nbool u[1000][1000];\nint main(){\n\tcin>>M>>N;\n\tFOR(i,0,M){\n\t\tFOR(j,0,N){\n\t\t\tcin>>F[i][j];\n\t\t}\n\t}\n\tFOR(i,0,2){\n\t\tFOR(j,0,2){\n\t\t\tcin>>f[i][j];\n\t\t}\n\t}\n\tint cnt=0;\n\tFOR(i,0,M-1){\n\t\tFOR(j,0,N-1){\n\t\t\tif(F[i][j]==f[0][0]&&F[i][j+1]==f[0][1]&&F[i+1][j]==f[1][0]&&F[i+1][j+1]==f[1][1]){\n\t\t\t\tu[i][j]=true;u[i][j+1]=true;\n\t\t\t\tu[i+1][j]=true;u[i+1][j+1]=true;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t}\n\tint ma=cnt;\n\tFOR(i,0,M-1){\n\t\tFOR(j,0,N-1){\n\t\t\tint x,y;\n\t\t\tint c=0;\n\t\t\tFOR(k,0,2){\n\t\t\t\tFOR(l,0,2){\n\t\t\t\t\tif(F[i+k][j+l]!=f[k][l]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t\tx=i+k;\n\t\t\t\t\t\ty=j+l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(c==1){\n\t\t\t\tif(u[x][y]==false){\n\t\t\t\t\tc=0;\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tma=max(ma,c+cnt);\n\t\t\t\t}else{\n\t\t\t\t\tc=0;\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]&&F[x][y]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y]==f[1][0]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x][y]==f[0][1]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y]==f[0][0]&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc--;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y-1>=0&&F[x-1][y-1]==f[0][0]&&F[x-1][y]==f[0][1]&&F[x][y-1]==f[1][0]&&F[x][y]!=f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x-1>=0&&y+1<N&&F[x-1][y]==f[0][0]&&F[x-1][y+1]==f[0][1]&&F[x][y]!=f[1][0]&&F[x][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(y-1>=0&&x+1<M&&F[x][y-1]==f[0][0]&&F[x][y]!=f[0][1]&&F[x+1][y-1]==f[1][0]&&F[x+1][y]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x+1<M&&y+1<N&&F[x][y]!=f[0][0]&&F[x][y+1]==f[0][1]&&F[x+1][y]==f[1][0]&&F[x+1][y+1]==f[1][1]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t}\n\t\t\t\t\tma=max(ma,c+cnt);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ma<<endl;\n\treturn 0;\n}   \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long \n#define ff(i, a, b) for(int i = a; i <= b; i++)\n#define fo(i, a, b) for(int i = a; i < b; i++)\n#define fod(i, a, b) for(int i = a; i >= b; i--)\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n\nconst int INF = 1e9, N = 1010;\nconst ll INFL = 1e18;\n\ntypedef pair <int, int> ii;\ntypedef vector <int> vi;\ntypedef vector <ii> vii;\n\nint n, m, f[N][N], ans, res;\nchar a[N][N];\nchar c[3][3];\n\nint in(int x, int y) {\n\treturn (x >= 1 && x + 1 <= n && y >= 1 && y + 1 <= m);\n}\n\nint main() {\n\tios_base::sync_with_stdio(false); cin.tie(0);\n\tcin >> n >> m; ff(i, 1, n) ff(j, 1, m) cin >> a[i][j];\n\tff(i, 1, 2) ff(j, 1, 2) cin >> c[i][j];\n\tff(i, 0, n - 1) ff(j, 0, m - 1) {\n\t\tint x = i + 2, y = j + 2;\n\t\tff(I, i, x - 1) ff(J, j, y - 1) {\n\t\t\tif (!in(I, J)) continue;\n\t\t\tif (a[I][J] == c[1][1] && a[I][J + 1] == c[1][2] && a[I + 1][J] == c[2][1] && a[I + 1][J + 1] == c[2][2]) f[i+1][j+1]++;\n\t\t} \n\t\t//cout << i + 1 << ' ' << j + 1 << ' ' << f[i + 1][j + 1] << \"\\n\";\n\t}\n\tff(i, 1, n - 1) ff(j, 1, m - 1) {\n\t\tif (a[i][j] == c[1][1] && a[i][j + 1] == c[1][2] && a[i + 1][j] == c[2][1] && a[i + 1][j + 1] == c[2][2]) ans++;\n\t}\n\tres = ans;\n\tff(x, 1, 2) ff(y, 1, 2) {\n\t\t// cut in the square (x, y) of 2x2 square\n\t\tchar cur = c[x][y];\n\t\tff(i, 1, n) ff(j, 1, m) {\n\t\t\tchar k = a[i][j];\n\t\t\ta[i][j] = cur;\n\t\t\tint cnt = 0;\n\t\t\tff(I, i - 1, i) ff(J, j - 1, j) {\n\t\t\t\tif (!in(I, J)) continue;\n\t\t\t\tif (a[I][J] == c[1][1] && a[I][J + 1] == c[1][2] && a[I + 1][J] == c[2][1] && a[I + 1][J + 1] == c[2][2]) cnt++;\n\t\t\t}\n\t\t\tint Ans = ans - f[i][j] + cnt;\n\t\t\tres = max(res, Ans);\n\t\t\ta[i][j] = k;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", res);\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y && dx >= 0; dy++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx =  x - 2,dy = y - 2; dx <= x && dy >= 0; dx++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint M, N;\nchar FlagData[1000][1000];\nchar Emblem[2][2];\nconst char WhitePaper[] = { 'J','O','I' };\n\nint calculate(int row, int col) {\n\tint cnt;\n\n\tcnt = 0;\n\tif (row + 1 < M && col + 1 < N) {\n\t\tif (FlagData[row][col] == Emblem[0][0] && FlagData[row][col + 1] == Emblem[0][1] && \n\t\t\tFlagData[row + 1][col] == Emblem[1][0] && FlagData[row + 1][col + 1] == Emblem[1][1]) {\n\t\t\t++cnt;\n\t\t}\n\t}\n\n\tif (row + 1 < M && col - 1 >= 0) {\n\t\tif (FlagData[row][col - 1] == Emblem[0][0] && FlagData[row][col] == Emblem[0][1] &&\n\t\t\tFlagData[row + 1][col - 1] == Emblem[1][0] && FlagData[row + 1][col] == Emblem[1][1]) {\n\t\t\t++cnt;\n\t\t}\n\t}\n\n\tif (row - 1 >= 0 && col + 1 < N) {\n\t\tif (FlagData[row - 1][col] == Emblem[0][0] && FlagData[row - 1][col + 1] == Emblem[0][1] &&\n\t\t\tFlagData[row][col] == Emblem[1][0] && FlagData[row][col + 1] == Emblem[1][1]) {\n\t\t\t++cnt;\n\t\t}\n\t}\n\n\tif (row - 1 >= 0 && col - 1 >= 0) {\n\t\tif (FlagData[row - 1][col - 1] == Emblem[0][0] && FlagData[row - 1][col] == Emblem[0][1] &&\n\t\t\tFlagData[row][col - 1] == Emblem[1][0] && FlagData[row][col] == Emblem[1][1]) {\n\t\t\t++cnt;\n\t\t}\n\t}\n\n\treturn cnt;\n}\n\nint solve() {\n\tint bCnt, aCnt, maxCnt;;\n\tchar ch;\n\n\tmaxCnt = 0;\n\tfor (int i = 0; i < M; ++i) {\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tch = FlagData[i][j];\n\t\t\tbCnt = calculate(i, j);\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tif (ch == WhitePaper[k]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tFlagData[i][j] = WhitePaper[k];\n\t\t\t\taCnt = calculate(i, j);\n\t\t\t\tmaxCnt = max(maxCnt, aCnt - bCnt);\n\t\t\t}\n\t\t\tFlagData[i][j] = ch;\n\t\t}\n\t}\n\n\treturn maxCnt;\n}\n\nint main() {\n\tint baseCnt;\n\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; ++i) {\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tcin >> FlagData[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tcin >> Emblem[i][j];\n\t\t}\n\t}\n\tbaseCnt = 0;\n\tfor (int i = 1; i < M; ++i) {\n\t\tfor (int j = 1; j < N; ++j) {\n\t\t\tif (FlagData[i][j] == Emblem[1][1] && FlagData[i][j - 1] == Emblem[1][0] &&\n\t\t\t\tFlagData[i - 1][j] == Emblem[0][1] && FlagData[i - 1][j - 1] == Emblem[0][0]) {\n\t\t\t\t++baseCnt;\n\t\t\t}\n\t\t}\n\t}\n\tcout << baseCnt + solve() << endl;\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m;\nstring g[1000];\nstring h[2];\n\nint check(int r, int c)\n{\n\tif (r < 0 || n <= r + 1) return 0;\n\tif (c < 0 || m <= c + 1) return 0;\n\treturn g[r][c] == h[0][0]\n\t\t&& g[r + 1][c] == h[1][0]\n\t\t&& g[r][c + 1] == h[0][1]\n\t\t&& g[r + 1][c + 1] == h[1][1];\n}\n\nint main()\n{\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++){\n\t\tcin >> g[i];\n\t}\n\tcin >> h[0] >> h[1];\n\n\tint c = 0;\n\tfor (int i = 0; i < n - 1; i++){\n\t\tfor (int j = 0; j < m - 1; j++){\n\t\t\tc += check(i, j);\n\t\t}\n\t}\n\t\n\tint res = c;\n\tfor (int i = 0; i < n; i++){\n\t\tfor (int j = 0; j < m; j++){\n\t\t\tfor (int k = 0; k < 3; k++){\n\t\t\t\tint t = c;\n\t\t\t\tchar ct = g[i][j];\n\t\t\t\tfor (int dx = 0; dx < 2; dx++){\n\t\t\t\t\tfor (int dy = 0; dy < 2; dy++){\n\t\t\t\t\t\tt -= check(i + dx, j + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tg[i][j] = \"JOI\"[k];\n\t\t\t\tfor (int dx = 0; dx < 2; dx++){\n\t\t\t\t\tfor (int dy = 0; dy < 2; dy++){\n\t\t\t\t\t\tt += check(i + dx, j + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tres = max(res, t);\n\t\t\t\tg[i][j] = ct;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst string name = \"JOI\";\nchar field[1010][1010];\nchar mark[2][2];\nint N, M;\n\nbool check(int sx, int sy){\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      if(field[sy+i][sx+j] != mark[i][j]) return false;\n    }\n  }\n  return true;\n}\n\nint diff(int x, int y, char c){\n  int curr = 0, nex = 0;\n  for(int i = y-1 ; i <= y ; i++){\n    for(int j = x-1 ; j <= x ; j++){\n      if(check(j, i)) curr++;\n    }\n  }\n  \n  char org = field[y][x];\n  field[y][x] = c;\n  \n  for(int i = y-1 ; i <= y ; i++){\n    for(int j = x-1 ; j <= x ; j++){\n      if(check(j, i)) nex++;\n    }\n  }\n  \n  field[y][x] = org;\n  \n  return nex - curr;\n}\n\nint main(){\n  \n  cin >> N >> M;\n  \n  for(int i = 0 ; i < N ; i++)\n    for(int j = 0 ; j < M ; j++) cin >> field[i][j];\n  \n  for(int i = 0 ; i < 2 ; i++)\n    for(int j = 0 ; j < 2 ; j++) cin >> mark[i][j];\n  \n  int ini = 0;\n  \n  for(int y = 0 ; y < N-1 ; y++)\n    for(int x = 0 ; x < M-1 ; x++) if(check(x, y)) ini++;      \n  \n  int ans = ini;\n  \n  for(int i = 0 ; i < N ; i++){\n    for(int j = 0 ; j < M ; j++){\n      for(int k = 0 ; k < 3 ; k++){\n\tif(field[i][j] == name[k]) continue;\n\t\n\tint d = diff(j, i, name[k]);\n\tans = max(ans, ini + d);\t\n      }\n    }\n  }\n  \n  cout << ans << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 0598\n#include<cstdio>\n#include<algorithm>\n#include<map>\n#define rep(i,a) for(int i=0;i<(a);++i)\n#define all(a) (a).begin(), (a).end()\n\nconst int dx[4][4] = {\n\t{ 0, 1, 0, 1 },\n\t{ 0, 1, 0, 1 },\n\t{ -1, 0, -1, 0 },\n\t{ -1, 0, -1, 0 }\n};\nconst int dy[4][4] = {\n\t{ 0, 0, 1, 1 },\n\t{ -1, -1, 0, 0 },\n\t{ -1, -1, 0, 0 },\n\t{ 0, 0, 1, 1 }\n};\n\nint M, N;\nchar fld[1000][1001], emb[2][3];\n\nbool safe( int i, int j )\n{ return i >= 0 && i < M && j >= 0 && j < N; }\n\nint main()\n{\n\tscanf( \"%d%d\", &M, &N );\n\trep( i, M )\n\t\tscanf( \"%s\", fld[i] );\n\trep( i, 2 )\n\t\tscanf( \"%s\", emb[i] );\n\n\tint ans = 0, inc = 0;\n\trep( i, M ) rep( j, N )\n\t{\n\t\tstd::map<char, int> m;\n\n\t\trep( t, 4 )\n\t\t{\n\t\t\tint cnt = 0;\n\t\t\tchar ch = '\\0';\n\n\t\t\trep( d, 4 ) if( safe( i+dy[t][d], j+dx[t][d] ) )\n\t\t\t{\n\t\t\t\tcnt += fld[i+dy[t][d]][j+dx[t][d]] == emb[d/2][d&1];\n\n\t\t\t\tif( !dx[t][d] && !dy[t][d] && fld[i+dy[t][d]][j+dx[t][d]] != emb[d/2][d&1] )\n\t\t\t\t\tch = emb[d/2][d&1];\n\t\t\t}\n\n\t\t\tif( !t && cnt == 4 )\n\t\t\t\t++ans;\n\t\t\tif( cnt == 3 && ch != '\\0' )\n\t\t\t\t++m[ch];\n\t\t}\n\n\t\tfor( auto it = m.begin(); it != m.end(); ++it )\n\t\t\tinc = std::max( inc, it->second );\n\t}\n\n\tprintf( \"%d\\n\", ans+inc );\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tchar b[4]=\"SJOI\";\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint c[4];\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;++k){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tC=D[i][j];\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\n#define FOR(i,s,e) for(int i = (s);i <= (e);i++)\n\nint N;\nint M;\n\nstring flag[1000];\nstring emblem[2];\n\nbool issame[1000][1000];\n\n\nint none_cou = 0;\nint main()\n{\n\n\tcin >> M >> N;\n\n\tFOR(i,0,M - 1)\n\t{\n\t\tcin >> flag[i];\n\t}\n\tFOR(i,0,1)\n\t{\n\t\tcin >> emblem[i];\n\t}\n\tFOR(i,0,M - 2)\n\t{\n\t\tFOR(j,0,N - 2)\n\t\t{\n\t\t\tbool same = true;\n\t\t\tFOR(k,0,1)\n\t\t\t{\n\t\t\t\tFOR(l,0,1)\n\t\t\t\t{\n\t\t\t\t\tsame = same && (flag[i + k][j + l] == emblem[k][l]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tissame[i][j] = same;\n\t\t\tif(same)\n\t\t\t{\n\t\t\t\tnone_cou++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint result = none_cou;\n\n\n\tstring JOI = \"JOI\";\n\tFOR(mi,0,M - 1)\n\t{\n\t\tFOR(ni,0,N - 1)\n\t\t{\n\t\t\tint cou = 0;\n\t\t\tfor(char c : JOI)\n\t\t\t{\n\t\t\t\tint cou = none_cou;\n\t\t\t\tFOR(m,max(mi - 1,0),mi)\n\t\t\t\t{\n\t\t\t\t\tFOR(n,max(ni - 1,0),ni)\n\t\t\t\t\t{ \n\t\t\t\t\t\tbool same = true;\n\t\t\t\t\t\tFOR(k,0,1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tFOR(l,0,1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(!(0 <= m + k && m + k < M && 0 <= n + l && n + l < N))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsame = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tchar tmp = emblem[k][l];\n\t\t\t\t\t\t\t\tif(m + k == mi && n + l == ni) tmp = c;\n\t\t\t\t\t\t\t\tsame = same && (flag[m + k][n + l] == tmp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(same && (issame[m][n] == false))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcou++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( !same && issame[m][n])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcou--;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresult = max(result,cou);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout  << result << endl;\n\treturn 0;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  int m,n;\n  cin>>m>>n;\n  vector<string> f(m+2);\n  REP(i,m) {\n    string l;\n    cin>>l;\n    f[i+1] = \" \" + l + \" \";\n  }\n  f[0] = f[m+1] = string(n+2, ' ');\n  vector<string> s(2);\n  REP(i,2)cin>>s[i];\n  int sum = 0;\n  REP(i,m-1)REP(j,n-1) {\n    bool iss = true;\n    REP(k,2)REP(l,2)\n      if(f[i+k+1][j+l+1] != s[k][l]) iss = false;\n    if (iss) ++sum;\n  }\n  int mx = 0;\n  REP(i,m)REP(j,n) {\n    string joi = \"JOI\";\n    char old = f[i+1][j+1];\n    int oldff = 0;\n    int ffmx = 0;\n    REP(k,3) {\n      f[i+1][j+1] = joi[k];\n      int ff = 0;\n      REP(o,2)REP(p,2) {\n        bool ok = true;\n        REP(q,2)REP(r,2)\n          if (f[i+o+q][j+p+r] != s[q][r]) ok = false;\n        if (ok) ++ff;\n      }\n      if (joi[k] == old) oldff = ff;\n      ffmx = max(ffmx, ff);\n    }\n    f[i+1][j+1] = old;\n    mx = max(mx, ffmx-oldff);\n  }\n  cout << sum + mx << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\ntemplate<typename T>\nvoid fill_all(T& ar,const T& v){\n\tar=v;\n}\ntemplate<typename T,size_t N,typename U>\nvoid fill_all(T(& ar)[N],const U& v){\n\tfor(auto&i:ar){fill_all(i,v);}\n}\n\nint H,W;\nchar map[1000][1002];\nchar flag[2][3];\n\nint main()\n{\n\tstd::cin >> H>>W;\n\t\n\tfor(int y = 0;y < H;++y){\n\t\tstd::cin >> map[y];\n\t}\n\tfor(int i = 0;i < 2;++i){\n\t\tstd::cin >> flag[i];\n\t}\n\t\t#ifdef DEBUG\n\t\t\tstd::cout <<\"map32:\" << map[2][3]<<'\\n';\n\t\t#endif\n\t\n\tint32_t count = 0;\n\tfor(int y = 0;y <= H-2;++y){\n\tfor(int x = 0;x <= W-2;++x){\n\t\tbool ok = true;\n\t\tfor(int i = 0;i < 2;++i)for(int j = 0;j < 2;++j){\n\t\t\tif(flag[j][i] == map[y+j][x+i]){\n\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tok = false;\n\t\t\t}\n\t\t}\n\t\tif(ok){++count;}\n\t}}\n\t\n\tauto is_same = [](int x,int y){\t\t\t\n\t\t\tbool ok = true;\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"same:\" << map[y][x]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\tfor(int i = 0;i < 2;++i)for(int j = 0;j < 2;++j){\n\t\t\t\tif(flag[j][i] == map[y+j][x+i]){\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tok = false;\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"samefalse:\"<<(x+i)<<' '<<(y+j) <<' ' <<map[y+j][x+i] <<' ' <<(int)map[y+j][x+i]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ok;\n\t};\n\t\n\tint32_t max = count;\n\tfor(int y = 0;y < H;++y){\n\tfor(int x = 0;x < W;++x){\n\t\tconst char CHAR[] = \"JOI\"; \n\t\tauto bef = map[y][x];\n\t\tauto bef_count = 0;\n\t\tfor(int u = -1;u <= 0;++u)for(int l = -1;l <= 0;++l){\n\t\t\tint lu_x = x+l,lu_y = y+u;\n\t\t\tif(lu_x<0)continue;\n\t\t\tif(lu_y<0)continue;\n\n\t\t\tif(is_same(lu_x,lu_y)){++bef_count;}\n\t\t}\n\t\t#ifdef DEBUG\n\t\tstd::cout << \"IN\"<<x<<' '<<y<<'\\n';\n\t\tstd::cout << bef_count << std::endl;\n\t\t#endif\n\t\t\n\t\tfor(int char_ = 0;char_<3;++char_)\n\t\t{\n\t\t\tmap[y][x] = CHAR[char_];\n\t\t\t\n\t\t#ifdef DEBUG\n\t\tif(x==3&&y==1){\n\t\t\tstd::cout <<\"MAP:\" << map[y][x]<<'\\n';\n\t\t}\n\t\t#endif\n\t\t\tint add = 0;\n\t\t\tfor(int u = -1;u <= 0;++u)for(int l = -1;l <= 0;++l){\n\t\t\t\tint lu_x = x+l,lu_y = y+u;\n\t\t\t\tif(lu_x<0)continue;\n\t\t\t\tif(lu_y<0)continue;\n\t\t\t\t\n\t\t\t\tif(is_same(lu_x,lu_y)){++add;}\n\t\t\t}\n\t\t\t\n\t\t\t#ifdef DEBUG\n\t\t\tstd::cout << add << std::endl;\n\t\t\t#endif\n\t\t\tmax = std::max(max, count-bef_count+add);\n\t\t}\n\t\tmap[y][x] =bef;\n\t\t\n\t}}\n\t\n\tstd::cout << max << std::endl;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint c[4];\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;++k){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tC=D[i][j];\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n\nusing namespace std;\n\nint M,N,ans=0;\nchar tbl[1100][1100];\nchar flag[2][2];\nchar k;\nint kotae;\nint a,b,c,d,e;\n\n\nint hantei(int i,int j){\n\tif(i<0 || j<0) return 0;\n\telse if(tbl[i][j]==flag[0][0]&&tbl[i+1][j]==flag[1][0]&&tbl[i][j+1]==flag[0][1]&&tbl[i+1][j+1]==flag[1][1]){\n\t\treturn 1;\n\t}\n\telse return 0;\n}\n\n\nint main(){\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>k;\n\t\t\ttbl[i][j]=k;\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>k;\n\t\t\tflag[i][j]=k;\n\t\t}\n\t}\n\tfor(int i=0;i<M-1;i++){\n\t\tfor(int j=0;j<N-1;j++){\n\t\t\tif(tbl[i][j]==flag[0][0]&&tbl[i+1][j]==flag[1][0]&&tbl[i][j+1]==flag[0][1]&&tbl[i+1][j+1]==flag[1][1]){\n\t\t\t\tkotae ++;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tk=tbl[i][j];\n\n\t\t\ta = hantei(i-1,j-1)+hantei(i-1,j)+hantei(i,j-1)+hantei(i,j);\n\n\t\t\ttbl[i][j]=flag[0][0];\n\t\t\tb = hantei(i-1,j-1)+hantei(i-1,j)+hantei(i,j-1)+hantei(i,j);\n\t\t\ttbl[i][j]=flag[0][1];\n\t\t\tb = max(b,hantei(i-1,j-1)+hantei(i-1,j)+hantei(i,j-1)+hantei(i,j));\n\t\t\ttbl[i][j]=flag[1][0];\n\t\t\tb = max(b,hantei(i-1,j-1)+hantei(i-1,j)+hantei(i,j-1)+hantei(i,j));\n\t\t\ttbl[i][j]=flag[1][1];\n\t\t\tb = max(b,hantei(i-1,j-1)+hantei(i-1,j)+hantei(i,j-1)+hantei(i,j));\n\n\t\t\tc = max(c,b-a);\n\t\t\ttbl[i][j]=k;\n\t\t}\n\t}\n\tcout << kotae+c << endl;\n\treturn 0;\n}\n\t\t\n\t\t\t\n\t\t\t\n\t"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n\nusing namespace std;\n\nchar s[1000][1111];\n\nchar w[2][10];\n\nchar q[3] = {'J','O','I'};\n\nint k[1000][1000];\n\nbool itti(int y,int x)\n{\nfor(int i = 0; i < 2; i++)\n{\nfor(int ii = 0; ii < 2; ii++)\n{\nif(s[y + i][x + ii] != w[i][ii])\n{\nreturn false;\n}\n}\n}\nreturn true;\n}\n\nint main()\n{\nint m,n;\nscanf(\"%d%d\",&m,&n);\nfor(int i = 0; i < m; i++)\n{\nscanf(\"%s\",s[i]);\n}\nfor(int i = 0; i < 2; i++)\n{\nscanf(\"%s\",w[i]);\n}\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nk[i][ii] = 0;\n}\n}\nint all = 0;\nfor(int i = 0; i < m - 1; i++)\n{\nfor(int ii = 0; ii < n - 1; ii++)\n{\nif(itti(i,ii))\n{\nk[i][ii]++;\nk[i + 1][ii]++;\nk[i][ii + 1]++;\nk[i + 1][ii + 1]++;\nall++;\n}\n}\n}\nint maxw = all;\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nchar moto = s[i][ii];\nfor(int j = 0; j < 3; j++)\n{\ns[i][ii] = q[j];\nint now = all - k[i][ii];\nif(i != 0)\n{\nif(itti(i - 1,ii))\n{\nnow++;\n}\n}\nif(i != m - 1)\n{\nif(itti(i + 1,ii))\n{\nnow++;\n}\n}\nif(ii != 0)\n{\nif(itti(i,ii - 1))\n{\nnow++;\n}\n}\nif(ii != n - 1)\n{\nif(itti(i,ii + 1))\n{\nnow++;\n}\n}\nmaxw = max(maxw,now);\n}\ns[i][ii] = moto;\n}\n}\nprintf(\"%d\\n\",maxw);\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <cstring>\n#include <algorithm>\n\nusing std::max;\n\nint row, col;\nint flag[1002][1002];\nint mons[2][2];\n\nint node(char c)\n{\n\tif (c == 'J')return 0;\n\tif (c == 'O')return 1;\n\treturn 2;\n}\n\nint isap(int a,int b,int c,int d)\n{\n\treturn (a == mons[0][0] && b == mons[0][1] && c == mons[1][0] && d == mons[1][1]) ? 1 : 0;\n}\n#define isap_(fl,i,j) isap(fl[i][j],fl[i][j+1],fl[i+1][j],fl[i+1][j+1])\n\nint main(void)\n{\n\tscanf(\"%d %d\", &row, &col);\n\tmemset(flag, 0xFF, sizeof(flag));\n\tfor (int i = 1; i <= row; ++i)\n\t{\n\t\tchar tmp[1001]; scanf(\"%s\", tmp);\n\t\tfor (int j = 0; j < col; ++j)\n\t\t{\n\t\t\tflag[i][j+1] = node(tmp[j]);\n\t\t}\n\t}\n\tchar tmp[3];\n\tscanf(\"%s\", tmp);\n\tmons[0][0] = node(tmp[0]);\n\tmons[0][1] = node(tmp[1]);\n\tscanf(\"%s\", tmp);\n\tmons[1][0] = node(tmp[0]);\n\tmons[1][1] = node(tmp[1]);\n\tint answer = 0;\n\tfor (int i = 1; i < row; ++i)\n\t{\n\t\tfor (int j = 1; j < col; ++j)\n\t\t{\n\t\t\tif (isap_(flag,i,j))\n\t\t\t{\n\t\t\t\t++answer;\n\t\t\t}\n\t\t}\n\t}\n\tint maxrem = 0;\n\tfor (int i = 1; i <= row; ++i)\n\t{\n\t\tfor (int j = 1; j <= col; ++j)\n\t\t{\n\t\t\tint rem = isap_(flag,i-1,j-1) + isap_(flag,i-1,j) + isap_(flag,i,j-1) + isap_(flag,i,j);\n\t\t\tint flij = flag[i][j];\n\t\t\tint maxr = 0;\n\t\t\tfor (int k = 0; k < 2; ++k)\n\t\t\t{\n\t\t\t\tflag[i][j] = k;\n\t\t\t\tmaxr = max(maxr, isap_(flag, i - 1, j - 1) + isap_(flag, i - 1, j) + isap_(flag, i, j - 1) + isap_(flag, i, j));\n\t\t\t}\n\t\t\tflag[i][j] = flij;\n\t\t\tmaxrem = max(maxrem, maxr - rem);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",answer + maxrem);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define IN(a, b, x) (a<=x&&x<b)\n#define MP make_pair\n#define PB push_back\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\nstring s[1010], t[2];\nint dp[1010][1010];\nsigned main(void)\n{\n  int h, w;\n  cin >> h >> w;\n  REP(i, h) cin >> s[i];\n  REP(i, 2) cin >> t[i];\n\n  int sum = 0;\n  FOR(i, 1, h) FOR(j, 1, w) {\n    if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n      dp[i][j] = 1;\n      sum++;\n    }\n  }\n\n  char c[3] = {'J', 'O', 'I'};\n  int ans = 0;\n  REP(i, h) REP(j, w) REP(k, 3) {\n    int ret = sum;\n    // ??????\n    if(i != 0 && j != 0) {\n      // if(!i && !j && k == 2) cout << \"a\" << ret << endl;\n      if(dp[i][j]) ret--;\n      if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && c[k] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != 0 && j != w-1) {\n      if(dp[i][j+1]) ret--;\n      if(s[i-1][j] == t[0][0] && s[i-1][j+1] == t[0][1] && c[k] == t[1][0] && s[i][j+1] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != h-1 && j != 0) {\n      if(dp[i+1][j]) ret--;\n      if(s[i][j-1] == t[0][0] && c[k] == t[0][1] && s[i+1][j-1] == t[1][0] && s[i+1][j] == t[1][1]) {\n        ret++;\n      }\n    }\n    // ??????\n    if(i != h-1 && j != w-1) {\n      if(dp[i+1][j+1]) ret--;\n      if(c[k] == t[0][0] && s[i][j+1] == t[0][1] && s[i+1][j] == t[1][0] && s[i+1][j+1] == t[1][1]) {\n        ret++;\n      }\n    }\n    // if(!i && !j && k == 2) cout << ret << endl;\n    ans = max(ans, ret);\n  }\n  cout << ans << endl;\n  //\n  // FOR(i, 1, h) FOR(j, 1, w) {\n  //   dp[i][j][0] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0];\n  //   if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n  //     dp[i][j][0]++;\n  //   }\n  //   dp[i][j][1] = dp[i][j][0];\n  //   /*if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) {\n  //     dp[i][j][1]++;\n  //   }*/\n  //   if((s[i-1][j-1] != t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] != t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] != t[1][0] && s[i][j] == t[1][1]) || (s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] != t[1][1])) {\n  //     dp[i][j][1] = dp[i-1][j][0] + dp[i][j-1][0] - dp[i-1][j-1][0] + 1;\n  //   }\n  //   int tmp = dp[i-1][j][1] + dp[i][j-1][1] - dp[i-1][j-1][1];\n  //   if(s[i-1][j-1] == t[0][0] && s[i-1][j] == t[0][1] && s[i][j-1] == t[1][0] && s[i][j] == t[1][1]) tmp++;\n  //   dp[i][j][1] = max(dp[i][j][1], tmp);\n  // }\n  //\n  // REP(i, h) {\n  //   REP(j, w) {\n  //     cout << \"(\" << dp[i][j][0] << \",\" << dp[i][j][1] << \")\";\n  //   }\n  //   cout << endl;\n  // // }\n  //\n  // cout << max(dp[h-1][w-1][0], dp[h-1][w-1][1]) << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <string>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n\nusing namespace std;\n\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\n\nint h, w;\nchar g[1024][1024], joi[3][3];\n\nint dx[] = { 0, 0, 1, 1 };\nint dy[] = { 0, 1, 0, 1 };\n\nbool eq(int i, int j){\n    for (int d = 0; d < 4; d++){\n        if (g[i + dy[d]][j + dx[d]] != joi[dy[d]][dx[d]]) return false;\n    }\n    return true;\n}\n\nint main(){\n    memset(g, 'X', sizeof(g));\n    while (cin >> h >> w){\n        for (int i = 0; i < h; i++){\n            scanf(\"%s\", &g[i + 1][1]);\n            g[i + 1][w + 1] = 'X';\n        }\n        for (int i = 0; i < 2; i++){\n            scanf(\"%s\", joi[i]);\n        }\n\n        int before = 0;\n        int diff = 0;\n        for (int i = 1; i <= h; i++){\n            for (int j = 1; j <= w; j++){\n                static char cnt[256];\n                char orig = g[i][j];\n                before += eq(i, j);\n                for (char c : \"JOI\"){\n                    cnt[c] = 0;\n                    g[i][j] = c;\n                    for (int k = 0; k < 4; k++){\n                        cnt[c] += eq(i - 1 + dy[k], j - 1 + dx[k]);\n                    }\n                }\n                g[i][j] = orig;\n                for (char c : \"JOI\"){\n                    diff = max(diff, cnt[c] - cnt[orig]);\n                }\n            }\n        }\n        cout << before + diff << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <array>\n#include <cstdlib>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n\ntemplate<class T> inline void chmax(T &a, const T &b) { if(a < b) a = b; }\n\nconstexpr int EMBLEM_SIZE = 2;\nbool out(int x, int y, int w, int h) {\n\treturn x < 0 || y < 0 || x >= w || y >= h;\n}\n\nbool check(int x, int y, const vector<string> &flag, const array<string, 2> &emblem) {\n\trep(i, EMBLEM_SIZE) {\n\t\trep(j, EMBLEM_SIZE) {\n\t\t\tif(flag[y + i][x + j] != emblem[i][j]) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint main() {\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\n\tconstexpr int dx[] = {-1, 0, -1, 0};\n\tconstexpr int dy[] = {-1, -1, 0, 0};\n\tconst string JOI = \"JOI\";\n\n\tint h, w;\n\tcin >> h >> w;\n\n\tvector<string> flag(h);\n\tfor(auto &e : flag) cin >> e;\n\n\tarray<string, EMBLEM_SIZE> emblem;\n\tfor(auto &e : emblem) cin >> e;\n\n\tvector<vector<bool>> match(h - 1, vector<bool>(w - 1, 0));\n\tint sum = 0;\n\n\trep(y, h - 1) {\n\t\trep(x, w - 1) {\n\t\t\tif(check(x, y, flag, emblem)) {\n\t\t\t\tmatch[y][x] = true;\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\trep(y, h) {\n\t\trep(x, w) {\n\t\t\tfor(const auto &c : JOI) {\n\t\t\t\tconst char tmp = flag[y][x];\n\t\t\t\tflag[y][x] = c;\n\n\t\t\t\tint num = sum;\n\t\t\t\trep(d, 4) {\n\t\t\t\t\tconst int nx = x + dx[d];\n\t\t\t\t\tconst int ny = y + dy[d];\n\t\t\t\t\tif(out(nx, ny, w, h) || out(nx + 1, ny + 1, w, h)) continue;\n\t\t\t\t\tnum += check(nx, ny, flag, emblem) - match[ny][nx];\n\t\t\t\t}\n\n\t\t\t\tchmax(ans, num);\n\t\t\t\tflag[y][x] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\n#pragma warning(disable : 4996)\n\nusing namespace std;\n\nconst string JOI = \"JOI\";\n\nint main()\n{\n\tint H, W;\n\n\tscanf(\"%d\", &H);\n\tscanf(\"%d\", &W);\n\n\tvector<string> D(H);\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tcin >> D[i];\n\t}\n\n\tstring C1, C2; cin >> C1 >> C2;\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < H - 1; i++)\n\t{\n\t\tfor (int j = 0; j < W - 1; j++)\n\t\t{\n\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\tif (R1 == C1 && R2 == C2)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint diff, ret = sum;\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tchar prevch = D[i][j];\n\n\t\t\tfor (int k = 0; k < 3; k++)\n\t\t\t{\n\t\t\t    diff = 0;\n\t\t\t    \n\t\t\t\tif (i != 0 && j != 0)\n\t\t\t\t{\n\t\t\t\t\tD[i][j] = JOI[k];\n\t\t\t\t\t\n\t\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\tstring R3 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\tstring R4 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\n\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t}\n\n\t\t\t\tif (i != 0 && j + 1 != W)\n\t\t\t\t{\n\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\tstring R3 = D[i - 1].substr(j, 2);\n\t\t\t\t\tstring R4 = D[i].substr(j, 2);\n\n\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t}\n\n\t\t\t\tif (i + 1 != H && j != 0)\n\t\t\t\t{\n\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\tstring R3 = D[i].substr(j - 1, 2);\n\t\t\t\t\tstring R4 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t}\n\n\t\t\t\tif (i + 1 != H && j + 1 != W)\n\t\t\t\t{\n\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\n\t\t\t\t\tD[i][j] = prevch;\n\n\t\t\t\t\tstring R3 = D[i].substr(j, 2);\n\t\t\t\t\tstring R4 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\tdiff -= (R3 == C1 && R4 == C2 ? 1 : 0);\n\t\t\t\t}\n\n\t\t\t\tret = max(ret, sum + diff);\n\t\t\t}\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ret);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring c[1002];\nint ruisekiwa[1000][1000];\nint main(){\n    int a,b;\n    cin>>a>>b;\n    for(int d=0;d<a;d++){\n\tcin>>c[d];\n    }\n    string f[2];\n    cin>>f[0]>>f[1];\n    int sum=0;\n    for(int g=0;g<a-1;g++){\n\tfor(int h=0;h<b-1;h++){\n\t    bool s[2][2]{};int l=0;\n\t    for(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t    if(c[g+i][h+j]==f[i][j]){l++;s[i][j]=true;}\n\t\t    }\n\t\t}\n\t\tif(l==4)sum++;\n\t\telse if(l==3){\n\t\t    for(int x=0;x<2;x++){\n\t\t\tfor(int y=0;y<2;y++){\n\t\t\t    if(!s[x][y])ruisekiwa[g+x-1][h+y-1]++;\n\t\t\t    }\n\t\t\t}\n\t\t    }\n\t    }\n\t}\n\tint MAX=0;\n\tfor(int i=0;i<a;i++){\n\t    for(int p=0;p<a;p++){\n\t\tMAX=max(MAX,ruisekiwa[i][p]);\n\t\t}\n\t    }\n\t    cout<<sum+MAX<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nchar new[1001][1001];\nint i,j,k;\nint main(void)\n{\n\tchar old[5];\n\tchar joi[3]={'J','O','I'};\n\tint m,n;\n\tint cnt,c,max;\n\tc=0;\n\tcnt=0;\n\tmax=0;\n\t\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tscanf(\" %c\",&new[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<4;i++){\n\t\tscanf(\" %c\",&old[i]);\n\t}\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse if(new[i][j]=='J'){\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='O'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='I'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt+max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\n#include <deque>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint M, N;\nvector<string> vs(1000);\nvector<string> JOI(2);\nbool calc(int y, int x) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return false;\n  return vs[y][x] == JOI[0][0] && vs[y][x+1] == JOI[0][1] && vs[y+1][x] == JOI[1][0] && vs[y+1][x+1] == JOI[1][1];\n}\nint change(int y, int x, char c) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return false;\n  int ret = 0;\n  ret -= calc(y, x);\n  char vsc = vs[y][x];\n  vs[y][x] = c;\n  ret += calc(y, x);\n  vs[y][x] = vsc;\n  return ret;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cin >> M >> N;\n  FOR(i,0,M) cin >> vs[i];\n  FOR(i,0,2) cin >> JOI[i];\n  int p = 0;\n  FOR(y,0,M) FOR(x,0,N) if(calc(y, x)) p++;\n\n  int mx = 0;\n  // ?´????->?´??????§????????? -1????´??????§?????????->?´???? +1????´??????§?????????->?´??????§????????? 0\n  string str = \"JOI\";\n  FOR(y,0,M) {\n    FOR(x,0,N) {\n      int cnt = 0;\n      FOR(i,0,3) {\n        int Y = y - 1, X = x - 1;\n        cnt += change(Y, X, str[i]);\n        Y = y, X = x - 1;\n        cnt += change(Y, X, str[i]);\n        Y = y - 1, X = x;\n        cnt += change(Y, X, str[i]);\n        Y = y, X = x;\n        cnt += change(Y, X, str[i]);\n      }\n      mx = max(mx, cnt);\n    }\n  }\n  cout << p + mx << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1010];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[4];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <utility>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <set>\n\n#define INF_LL 9000000000000000000\n#define INF 2000000000\n\n#define REP(i, n) for(int i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> PII;\ntypedef pair<int, PII> PPII;\ntypedef pair<int, PPII> PPPII;\n\nclass Union_find{\nprivate:\n\tvector<int> par;\n\tvector<int> rank;\n\tint n;\n\npublic:\n\tUnion_find(int a){\n\t\tn = a;\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tpar.push_back(i);\n\t\t\trank.push_back(0);\n\t\t}\n\t}\n\n\tint find(int x){\n\t\tif(par[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn par[x] = find(par[x]);\n\t\t}\n\t}\n\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y) return;\n\n\t\tif(rank[x] < rank[y]){\n\t\t\tpar[x] = y;\n\t\t}else{\n\t\t\tpar[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t}\n\t}\n\n\tbool same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n\nint main(void){\n\tint N, M;\n\tstring flag[2];\n\tstring base[1010];\n\tll res = 0;\n\n\tcin >> M >> N;\n\tREP(i, M){\n\t\tcin >> base[i];\n\t}\n\tREP(i, 2){\n\t\tcin >> flag[i];\n\t}\n\n\tREP(i, M-1){\n\t\tREP(j, N-1){\n\t\t\tbool ok = true;\n\t\t\tREP(a, 2){\n\t\t\t\tREP(b, 2){\n\t\t\t\t\tif(flag[a][b] != base[i+a][j+b]){\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ok)\n\t\t\t\tres++;\n\t\t}\n\t}\n\tint mp = 0;\n\tREP(i, M){\n\t\tREP(j, N){\n\t\t\tchar ch[] = {'J', 'O', 'I'};\n\t\t\tchar org = base[i][j];\n\t\t\tREP(k, 3){\n\t\t\t\tbase[i][j] = ch[k];\n\t\t\t\t\n\t\t\t\tint cnt = 0;\n\t\t\t\tFOR(a, max(i-1, 0), i+1){\n\t\t\t\t\tFOR(b, max(j-1, 0), j+1){\n\t\t\t\t\t\tbool ok = true;\n\t\t\t\t\t\tREP(c, 2){\n\t\t\t\t\t\t\tREP(d, 2){\n\t\t\t\t\t\t\t\tif(flag[c][d] != base[a+c][b+d])\n\t\t\t\t\t\t\t\t\tok =false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ok) cnt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(mp < cnt && ch[k] != org)\n\t\t\t\t\tmp = cnt;\n\t\t\t}\n\t\t}\n\t}\n\tcout << res + mp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nmain(){\n  int n,m;\n  char masu[1002][1002];\n  int mem[1002][1002]={0};\n  char monsyou[3][3];\n  int before=0,after=0;\n  char joi[3]={'J','O','I'};\n  int ihu[4]={-1,-1,0,0};\n  int jhu[4]={-1,0,-1,0};\n  int imu[4]={-1,-1,0,0};\n  int jmu[4]={0,1,0,1};\n  int ihs[4]={0,0,1,1};\n  int jhs[4]={-1,0,-1,0};\n  int ims[4]={0,0,1,1};\n  int jms[4]={0,1,0,1};\n  cin>>n>>m;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin>>masu[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      for(int k=0;k<4;k++){\n\tif(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t  before=before+1;\n\t  mem[i][j]=mem[i][j]+1;\n\t}\n      }\n    }\n  }\n  if(before!=0){\n    before=before/4;\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      char kioku;\n      kioku=masu[i][j];\n      for(int a=0;a<3;a++){\n\tif(masu[i][j]!=joi[a]){\n\t  int count=0;\n\t  masu[i][j]=joi[a];\n\t  for(int k=0;k<4;k++){\n\t    if(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t      count=count+1;\n\t    }\n\t  }\n\t  masu[i][j]=kioku;\n\t  if(count-mem[i][j]>after){\n\t    after=count-mem[i][j];\n\t  }\n\t}\n      }\t\n    }\n  }\n  cout<<before+after<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cmath>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n    int H,W;\n    int ans=0;\n    string fie[1002],ansfie[2];\n    cin>>H>>W;\n    for(int i=0;i<H;i++)cin>>fie[i];\n    for(int i=0;i<2;i++)cin>>ansfie[i];\n    for(int i=0;i<H-1;i++){\n        for(int j=0;j<W-1;j++){\n            if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])ans++;\n        }\n    }\n    for(int i=0;i<H;i++){\n        for(int j=0;j<W;j++){\n            for(int k=0;k<3;k++){\n                int a=0,b=0;\n                char p;\n                if(k==0)p='J';\n                if(k==1)p='O';\n                if(k==2)p='I';\n                if(i!=H-1&&j!=W-1){\n                    if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])a++;\n                    if(p==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=W-1){\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&fie[i][j]==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])a++;\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&p==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=H-1&&j!=0){\n                    if(fie[i][j-1]==ansfie[0][0]&&fie[i][j]==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])a++;\n                    if(fie[i][j-1]==ansfie[0][0]&&p==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=0){\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&fie[i][j]==ansfie[1][1])a++;\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&p==ansfie[1][1])b++;\n                }\n                ans=max(ans,ans+b-a);\n            }\n        }\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"math.h\"\n#include \"utility\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"iomanip\"\n#include \"random\"\n\nusing namespace std;\nconst long long int MOD = 1000000007;\n\nint H, W;\nint fst;\nint add;\nbool exist[1002][1002];\nchar mod[3] = { 'J','O','I' };\nint ans;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> H >> W;\n\tvector<string>field(H + 2);\n\tvector<string>joi(2);\n\tfor (int i = 1; i <= H; i++) {\n\t\tcin >> field[i];\n\t\tfield[i] = '0' + field[i] + '0';\n\t}\n\tfor (int i = 0; i < W + 2;i++) {\n\t\tfield[0] += '0';\n\t\tfield[H + 1] += '0';\n\t}\n\tfor (int i = 0; i <= 1; i++)cin >> joi[i];\n\tfor (int i = 1; i < H; i++) \n\t\tfor (int j = 1; j < W; j++) {\n\t\t\tbool flag = true;\n\t\t\tfor (int k = 0; k < 2; k++)\n\t\t\t\tfor (int l = 0; l < 2; l++)\n\t\t\t\t\tif (field[i + k][j + l] != joi[k][l])flag = false;\n\t\t\tif (flag) {\n\t\t\t\tfst++;\n\t\t\t\texist[i][j] = true;\n\t\t\t}\n\t\t}\n\n\tfor (int i = 1; i <= H; i++)\n\t\tfor (int j = 1; j <= W; j++) {\n\t\t\tint box = 0;\n\t\t\tfor (int k = -1; k <= 0; k++)\n\t\t\t\tfor (int l = -1; l <= 0; l++)if (exist[i + k][j + l])box--;\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tint bag=0;\n\t\t\t\tfor(int l=-1;l<=0;l++)\n\t\t\t\t\tfor (int m = -1; m <= 0; m++) {\n\t\t\t\t\t\tbool flag = true;\n\t\t\t\t\t\tfor (int n = 0; n <= 1; n++)\n\t\t\t\t\t\t\tfor (int o = 0; o <= 1; o++) {\n\t\t\t\t\t\t\t\tif (!(l+n) && !(m+o)) {\n\t\t\t\t\t\t\t\t\tif (mod[k] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (field[i + l + n][j + m + o] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flag)bag++;\n\t\t\t\t\t}\n\t\t\t\t//cout << mod[k] << \" \" << box << \" \" << bag << endl;\n\t\t\t\tans = max(ans, fst + box + bag);\n\t\t\t}\n\t\t}\n//\tcout << fst << endl;\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint m, n, ans = 0, diff = 0;\nchar flag[1010][1010];\nchar sample[3][3];\n\nint status[1010][1010];\n\nint color(char c)\n{\n  if(c == 'J')\n    return 1; \n  if(c == 'O')\n    return 2;\n  if(c == 'I')\n    return 3;\n}\n\nint judge(int x, int y)\n{\n  return\n    (flag[x][y] == sample[1][1]) +\n    ((flag[x][y + 1] == sample[1][2]) << 1) +\n    ((flag[x + 1][y] == sample[2][1]) << 2) +\n    ((flag[x + 1][y + 1] == sample[2][2]) << 3);\n}\n\nint pls(int x, int y)\n{\n  int ret[4] = {0, 0, 0, 0};\n  if(status[x][y] == 14)\n    ret[color(sample[1][1])]++;\n  if(status[x][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][1])]++;\n  }\n\n  if(status[x][y - 1] == 13)\n    ret[color(sample[1][2])]++;\n  if(status[x][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][2])]++;\n  }\n\n  if(status[x - 1][y] == 11)\n    ret[color(sample[2][1])]++;\n  if(status[x - 1][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][1])]++;\n  }\n\n  if(status[x - 1][y - 1] == 7)\n    ret[color(sample[2][2])]++;\n  if(status[x - 1][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][2])]++;\n  }\n  \n  return max(max(ret[1], ret[2]), ret[3]);\n}\n    \n\nint main()\n{\n  cin >> m >> n;\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      cin >> flag[i][j];\n\n  for(int i = 1; i <= 2; i++)\n    for(int j = 1; j <= 2; j++)\n      cin >> sample[i][j];\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++){\n      status[i][j] = judge(i, j);\n      if(status[i][j] == 15)\n\tans++;\n    }\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      diff = max(diff, pls(i, j));\n\n  cout << ans + diff << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1010];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[4];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint M, N;\nchar map[2010][2010];\nchar emblem[2][2];\nconst char *table = \"JOI\";\n\nint eval(int x, int y, int value) {\n  int bcount = 0;\n  for (int bx=0; bx<=1; bx++) {\n    for (int by=0; by<=1; by++) {\n      int _x = bx + x;\n      int _y = by + y;\n      if (map[_y][_x]   == emblem[0][0] && map[_y+1][_x]   == emblem[1][0]\n       && map[_y][_x+1] == emblem[0][1] && map[_y+1][_x+1] == emblem[1][1]) bcount++;\n     }\n  }\n\n  int _r = map[y][x];\n  map[y][x] = table[value];\n  //if (_r == map[y][x]) return 0;\n  int count = 0;\n  for (int bx=0; bx<=1; bx++) {\n    for (int by=0; by<=1; by++) {\n      int _x = bx + x;\n      int _y = by + y;\n      /*\n      cout << \"#####\\n\";\n      cout << map[_y][_x]   << map[_y][_x+1] << \"\\n\";\n      cout << map[_y+1][_x] << map[_y+1][_x+1] << \"\\n\";\n      */\n      if (map[_y][_x]   == emblem[0][0] && map[_y+1][_x]   == emblem[1][0]\n       && map[_y][_x+1] == emblem[0][1] && map[_y+1][_x+1] == emblem[1][1]) count++;\n     }\n  }\n  //cout << \"eval(\" << x << \", \" << y << \", \" << value << \") = \" << count << \" - \" << bcount << \"\\n\";\n  map[y][x] = _r;\n  return count - bcount;\n}\n\nint main() {\n  cin >> M >> N;\n  for (int i=0; i<M; i++) {\n    cin >> map[i+1];\n    for (int j=N+10; j>0; j--) {\n      map[i+1][j] = map[i+1][j-1];\n    }\n    map[i+1][0] = ' ';\n  }\n\n  for (int i=0; i<2; i++) {\n    cin >> emblem[i];\n  }\n\n  int _max = -1;\n  int val_x = -1, val_y = -1, val_k = 0;\n  for (int i=1; i<=1010; i++) {\n    for (int j=1; j<=1010; j++) {\n      for (int k=0; k<3; k++) {\n        //if (map[j][i] == table[k]) continue;\n        int t = eval(j, i, k);\n        if (t > _max) {\n          _max = t;\n          val_x = j; val_y = i; val_k = k;\n        }\n      }\n    }\n  }\n  //cout << \"(\" << val_x << \", \" << val_y << \"), \" << table[val_k] << \"\\n\";\n  map[val_y][val_x] = table[val_k];\n\n  int ans = 0;\n  for (int i=1; i<=1010; i++) {\n    for (int j=1; j<=1010; j++) {\n      if (map[j][i]   == emblem[0][0] && map[j+1][i]   == emblem[1][0]\n       && map[j][i+1] == emblem[0][1] && map[j+1][i+1] == emblem[1][1])\n        ans++;\n    }\n  }\n  cout << ans << '\\n';\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<unordered_map>\n#include<string>\n#include<algorithm>\nusing namespace std;\n\nstruct masu {\n\tint hiku;\n\tunordered_map<char, int>tasu;\n};\nmasu t[1000][1000];\nint main() {\n\tint a, b;\n\tcin >> a >> b;\n\tstring c[1000];\n\tfor (int d = 0; d < a; d++)cin >> c[d];\n\tstring f[2];\n\tcin >> f[0] >> f[1];\n\tint sum = 0;\n\tfor (int g = 0; g < a - 1; g++) {\n\t\tfor (int h = 0; h < b - 1; h++) {\n\t\t\tint l = 0; bool r[2][2]{};\n\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\tl++;\n\t\t\t\t\t\tr[i][j] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l == 4) {\n\t\t\t\tsum++;\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (c[g + i][h + j] == f[i][j]) {\n\t\t\t\t\t\t\tt[g + i][h + j].hiku++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (l == 3) {\n\t\t\t\tfor (int i = 0; i < 2; i++) {\n\t\t\t\t\tfor (int j = 0; j < 2; j++) {\n\t\t\t\t\t\tif (!r[i][j])t[g + i][h + j].tasu[f[i][j]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint MAX = 0;\n\tfor (int i = 0; i < a; i++) {\n\t\tfor (int j = 0; j < b; j++) {\n\t\t\tMAX = max(MAX, max({ t[i][j].tasu['J'],t[i][j].tasu['O'] ,t[i][j].tasu['I'] })-t[i][j].hiku);\n\t\t}\n\t}\n\tcout << sum + MAX << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nchar new[1002][1002];\nint i,j,k;\nint main(void)\n{\n\tchar old[5];\n\tchar joi[3]={'J','O','I'};\n\tint m,n;\n\tint cnt,c,max;\n\tc=0;\n\tcnt=0;\n\tmax=0;\n\t\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tscanf(\" %c\",&new[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<4;i++){\n\t\tscanf(\" %c\",&old[i]);\n\t}\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse if(new[i][j]=='J'){\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='O'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[2];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(new[i][j]=='I'){\n\t\t\t\tnew[i][j]=joi[0];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnew[i][j]=joi[1];\n\t\t\t\tif(new[i][j]==old[0] && new[i][j+1]==old[1] && new[i+1][j]==old[2] && new[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i][j-1]==old[0] && new[i][j]==old[1] && new[i-1][j-1]==old[2] && new[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j-1]==old[0] && new[i+1][j]==old[1] && new[i][j-1]==old[2] && new[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(new[i+1][j]==old[0] && new[i+1][j+1]==old[1] && new[i][j]==old[2] && new[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt+max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\nusing namespace std;\n\nchar a[1010][1010];\nchar joi[5] = {'J', 'O', 'I'};\nvector<string> vs;\nint m, n;\n\nbool func(int y, int x) {\n  for(int i=0; i<vs.size(); i++) {\n    for(int j=0; j<vs[i].size(); j++) {\n      if(y >= m || x >= n) return false;\n      if(a[y+i][x+j] != vs[i][j]) return false;\n    }\n  }\n  return true;\n}\n\nint main() {\n\n  cin >> m >> n;\n  for(int i=0; i<m; i++) {\n    for(int j=0; j<n; j++) {\n      cin >> a[i][j];\n    }\n  }\n  string tmp;\n  while(cin >> tmp) vs.push_back(tmp);\n\n  int ans = 0;\n  for(int i=0; i < m; i++) {\n    for(int j=0; j < n; j++) {\n      if(a[i][j] == vs[0][0] && func(i,j)) ans++;\n    }\n  }\n\n  for(int z = 0; z < 3; z++) {\n    for(int q=0; q < m; q++) {\n      for(int w=0; w < n; w++) {\n        char tmp = a[q][w];\n        a[q][w] = joi[z];\n        int num = 0;\n        for(int i=0; i< m; i++) {\n          for(int j=0; j < n; j++) {\n            if(a[i][j] == vs[0][0] && func(i,j)) num++;\n          }\n        }\n        ans = max(ans, num);\n        a[q][w] = tmp;\n      }\n    }\n  }\n  cout << ans << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n\nint ans = 0;\nint h, w;\nchar f[1010][1010], emb[4];\nchar joi[] = {'J', 'O', 'I'};\nint d[1010][1010];\n\nconst int dx[] = {-1, 0, -1, 0};\nconst int dy[] = {-1, -1, 0, 0};\n\nconst int nx[] = {0, 1, 0, 1};\nconst int ny[] = {0, 0, 1, 1};\n\ninline bool in(int x, int y){\n  return (x<0||y<0||w-1<=x||h-1<=y);\n}\n\nint main()\n{\n\n  cin >> h >> w;\n  REP(i, h) REP(j, w){\n    cin >> f[i][j];\n  }\n\n  REP(i, 4){\n    cin >> emb[i];\n  }\n\n  REP(i, h) REP(j, w) REP(k, 4){\n    int x = j + dx[k];\n    int y = i + dy[k];\n\n    if (in(x, y)) continue;\n\n    int cnt = 0;\n    for (int l = 0; l < 4; l++){\n      int sx = x + nx[l];\n      int sy = y + ny[l];\n      cnt += (f[sy][sx] == emb[l]);\n    }\n    if (cnt == 4){\n      d[i][j]++;\n      ans += (k == 0);\n    }\n  }\n\n  int maxplus = 0;\n  REP(i, h) REP(j, w){\n    char s = f[i][j];\n    int onakasuita = 0;\n    REP(m, 3){\n      f[i][j] = joi[m];\n\n      REP(k, 4){\n        int x = j + dx[k];\n        int y = i + dy[k];\n\n        if (in(x, y)) continue;\n\n        int cnt = 0;\n        REP(l, 4){\n          int sx = x + nx[l];\n          int sy = y + ny[l];\n          cnt += (f[sy][sx] == emb[l]);\n        }\n        if (cnt == 4) onakasuita++;\n      }\n    }\n    maxplus = max(maxplus, onakasuita - d[i][j]);\n    f[i][j] = s;\n  }\n\n  cout << ans + maxplus << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#pragma GCC optimize(\"Ofast\")\n#pragma GCC target(\"avx\")\n#define all(x) (x).begin(),(x).end()\n#define rep(i,n) for(int (i)=0;i<(n);i++)\n#define REP(i,m,n) for(int (i)=(m);(i)<(n);(i)++)\n#define MOD 1000000007\n#define fcout cout << fixed << setprecision(15)\n#define int long long\n#define endl \"\\n\"\n#define yorn(f) puts((f)?\"Yes\":\"No\")\n#define YORN(f) puts((f)?\"YES\":\"NO\")\ntypedef long long ll;\ntypedef pair<int, int> P;\nint gcd(int a,int b){return b?gcd(b,a%b):a;};\nint lcm(int a,int b){return a/gcd(a,b)*b;};\nint mod(int a,int b){return (a+b-1)/b;};\ntemplate<typename A, size_t N, typename T>\nvoid Fill(A(&array)[N],const T &val){std::fill((T*)array,(T*)(array+N),val);}\ntemplate<class T>inline bool chmax(T& a,T b){if(a<b){a=b;return true;}return false;};\ntemplate<class T>inline bool chmin(T& a,T b){if(a>b){a=b;return true;}return false;};\n\nstring joi = \"JOI\";\n\nsigned main() {\n    cin.tie(0);\n    cout.tie(0);\n    ios::sync_with_stdio(false);\n    \n    int h, w;\n    cin >> h >> w;\n    vector<string> s(h), tmp(2);\n    rep(i, h) cin >> s[i];\n    rep(i, 2) cin >> tmp[i];\n\n    int defcnt = 0;\n    rep(i, h-1) {\n        rep(j, w-1) {\n            vector<string> now(2);\n            now[0] = s[i].substr(j, 2);\n            now[1] = s[i+1].substr(j, 2);\n            if(now == tmp) defcnt++;\n        }\n    }\n\n    int dif = 0;\n    rep(i, h) {\n        rep(j, w) {\n            char focus = s[i][j];\n            rep(k, 3) {\n                if(focus == joi[k]) continue;\n                s[i][j] = joi[k];\n                int nowcnt = 0;\n\n                REP(dy, -1, 1) {\n                    int ny = i + dy;\n                    REP(dx, -1, 1) {\n                        // 左上\n                        int nx = j + dx;\n                        if(0 <= nx && nx < w-1 && 0 <= ny && ny < h-1) {\n                            if(s[ny][nx] == tmp[0][0] && s[ny][nx+1] == tmp[0][1] && s[ny+1][nx] == tmp[1][0] && s[ny+1][nx+1] == tmp[1][1]) {\n                                nowcnt++;\n                                // cout << nx << \" \" << ny << endl;\n                                // cout << s[ny][nx] << s[ny][nx+1] << endl;\n                                // cout << s[ny+1][nx] << s[ny+1][nx+1] << endl;\n                            }\n                        }\n                    }\n                }\n                chmax(dif, nowcnt);\n                //cout << nowcnt << endl;\n\n            }\n            s[i][j] = focus;\n        }\n    }\n    cout << defcnt + dif << endl;\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define PB push_back\n#define MP make_pair\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define ALL(a) (a).begin(),(a).end()\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ndouble EPS=1e-8;\nint m,n;\nchar fld[1000][1000];\nchar flag[2][2];\nbool ok(int x,int y){\n\tif(x<0||y<0||x+1>=m||y+1>=n)return false;\n\tREP(i,4)if(fld[x+i%2][y+i/2]!=flag[i%2][i/2])return false;\n\treturn true;\n}\nstring JOI=\"JOI\";\nint main(){\n\tcin>>n>>m;\n\tREP(i,n)REP(j,m)cin>>fld[j][i];\n\tREP(i,2)REP(j,2)cin>>flag[j][i];\n\tint ans=0;\n\tREP(i,n-1)REP(j,m-1)if(ok(j,i))ans++;\n\tint res=ans;\n\tREP(i,n)REP(j,m){\n\t\tint c1=0;\n\t\tchar tmp=fld[j][i];\n\t\tREP(k,4)if(ok(j-k%2,i-k/2))c1++;\n\t\tREP(k,3){\n\t\t\tint c2=0;\n\t\t\tfld[j][i]=JOI[k];\n\t\t\tREP(l,4)if(ok(j-l%2,i-l/2))c2++;\n\t\t\tans=max(ans,res-c1+c2);\n\t\t}\n\t\tfld[j][i]=tmp;\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 0598\n#include<cstdio>\n#include<algorithm>\n#include<map>\n#define rep(i,a) for(int i=0;i<(a);++i)\n#define all(a) (a).begin(), (a).end()\n\nconst int dx[4][4] = {\n\t{ 0, 1, 0, 1 },\n\t{ 0, 1, 0, 1 },\n\t{ -1, 0, -1, 0 },\n\t{ -1, 0, -1, 0 }\n};\nconst int dy[4][4] = {\n\t{ 0, 0, 1, 1 },\n\t{ -1, -1, 0, 0 },\n\t{ -1, -1, 0, 0 },\n\t{ 0, 0, 1, 1 }\n};\n\nint M, N;\nchar fld[1000][1001], emb[2][3];\n\nbool safe( int i, int j )\n{ return i >= 0 && i < M && j >= 0 && j < N; }\n\nint main()\n{\n\tscanf( \"%d%d\", &M, &N );\n\trep( i, M )\n\t\tscanf( \"%s\", fld[i] );\n\trep( i, 2 )\n\t\tscanf( \"%s\", emb[i] );\n\n\tint ans = 0, inc = 0;\n\trep( i, M ) rep( j, N )\n\t{\n\t\tstd::map<char, int> m;\n\n\t\trep( t, 4 )\n\t\t{\n\t\t\tint cnt = 0;\n\t\t\tchar ch = '\\0';\n\n\t\t\trep( d, 4 ) if( safe( i+dx[t][d], j+dy[t][d] ) )\n\t\t\t{\n\t\t\t\tcnt += fld[i+dy[t][d]][j+dx[t][d]] == emb[d/2][d&1];\n\n\t\t\t\tif( !dx[t][d] && !dy[t][d] && fld[i+dy[t][d]][j+dx[t][d]] != emb[d/2][d&1] )\n\t\t\t\t\tch = emb[d/2][d&1];\n\t\t\t}\n\n\t\t\tif( !t && cnt == 4 )\n\t\t\t\t++ans;\n\t\t\tif( cnt == 3 && ch != '\\0' )\n\t\t\t\t++m[ch];\n\t\t}\n\n\t\tinc = std::max( inc, std::max_element( all(m), []( const std::pair<char, int> &lhs, const std::pair<char, int> &rhs ){ return lhs.second > rhs.second; } )->second );\n\t}\n\n\tprintf( \"%d\\n\", ans+inc );\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nint n, m;\nchar c[1080][1080];\nint cnt[1080][1080];\nint ans[2][2], anss, res;\nint main(){\n\tcin >> m >> n;\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++) \n\t\t\tcin >> c[i][j];\n\t\n\tfor(int i = 0;i < 2;i++)\n\t\tfor(int j = 0;j < 2;j++)\n\t\t\tcin >> ans[i][j];\n\t\t\t\n\tfor(int i = 1;i <= m;i++)\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tcnt[i][j] = 1;\n\t\t  \tfor(int k = 0;k < 2;k++)\n\t\t\t\tfor(int l = 0;l < 2;l++)\n\t\t\t\t\tif(c[i + k][j + l] != ans[k][l])cnt[i][j] = 0;\n\t\t\tres += cnt[i][j];\n\t\t}\n\t\n\tint anss = res;\n\tfor(int i = 1;i <= m;i++){\n\t\tfor(int j = 1;j <= n;j++){\n\t\t\tint last = c[i][j];\n\t\t\tint tres;\n\t\t\tc[i][j] = 'J';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\tc[i][j] = 'O';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = 'I';\n\t\t\ttres = res;\n\t\t\tfor(int k = i - 1;k <= i;k++)\n\t\t\t\tfor(int l = j - 1;l <= j;l++){\n\t\t\t\t\tint tmp = 1;\n\t\t\t\t\tfor(int o = 0;o < 2;o++)\n\t\t\t\t\t\tfor(int p = 0;p > 2;p++)\n\t\t\t\t\t\t\tif(c[k + o][l + p] != ans[o][p])tmp = 0;\n\t\t\t\t\ttres += tmp - cnt[k][l];\t\n\t\t\t\t}\n                        anss = max(anss, tres);\n\t\t\t\n\t\t\tc[i][j] = last;\n\t\t}\n\t}\n\tcout << anss << endl;\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint a1=0,a2,a3,a4;\n\tchar C;\n\tint R=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\ta1=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a1+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a1+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a1+=1;\n\t\t\tC=D[i][j];\n\t\t\tD[i][j]='J';\n\t\t\ta2=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a2+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a2+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a2+=1;\n\t\t\tD[i][j]='O';\n\t\t\ta3=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a3+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a3+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a3+=1;\n\t\t\tD[i][j]='I';\n\t\t\ta4=0;\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])a4+=1;\n\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])a4+=1;\n\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])a4+=1;\n\t\t\tD[i][j]=C;\n\n\t\t\tR=max(R,a+a2-a1);\n\t\t\tR=max(R,a+a3-a1);\n\t\t\tR=max(R,a+a4-a1);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<n;++i)\n\nusing namespace std;\n\ntypedef pair<int,int>P;\n\nconst int MAX_N = 1003;\n\nstring s[MAX_N];\nstring e[2];\nint a[MAX_N][MAX_N];\nint b[MAX_N][MAX_N];\nint m,n;\n\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\trep(i,n){\n\t\tcin >> s[i];\n\t}\n\trep(i,2){\n\t\tcin >> e[i];\n\t}\n\trep(i,n){\n\t\trep(j,m){\n\t\t\ta[i][j] = 0;\n\t\t\tb[i][j] = 0;\n\t\t}\n\t}\n\tint ans = 0;\n\trep(i,n-1){\n\t\trep(j,m-1){\n\t\t\tif(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tans++;\n\t\t\t\trep(k,2){\n\t\t\t\t\trep(l,2){\n\t\t\t\t\t\ta[i+k][j+l] += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1]){\n\t\t\t\tb[i+1][j+1] += 1;\n\t\t\t}else if(s[i+1][j] == e[1][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tb[i][j] += 1;\n\t\t\t}else if(s[i][j] == e[0][0] && s[i+1][j] == e[1][0] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tb[i][j+1] += 1;\n\t\t\t}else if(s[i][j] == e[0][0] && s[i][j+1] == e[0][1] && s[i+1][j+1] == e[1][1]){\n\t\t\t\tb[i+1][j] += 1;\n\t\t\t}\n\t\t}\n\t}\n\tint mx = 0;\n\trep(i,n){\n\t\trep(j,m){\n\t\t\tmx = max(mx,b[i][j]-a[i][j]);\n\t\t}\n\t}\n\tcout << ans+mx << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y && dx >= 0; dy++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx = x - 2,dy = y - 2; dx <= x && dy >= 0; dx++){\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n        }\n        else{\n          dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n          dp[y][x] = max(dp[y][x],dp[y-1][x-1]);\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#define lol(i,n) for(int i=0;i<n;i++)\n#define mod 100000007\ntypedef long long ll;\nusing namespace std;\nchar c[1010][1010];\nint h,w;\nchar mem[2][2],z[3]={'J','O','I'};\nint main(){\n  cin>>h>>w;\n  lol(i,h)lol(j,w)cin>>c[i][j];\n  lol(i,2)lol(j,2)cin>>mem[i][j];\n  int cnt=0;\n  lol(i,h-1)lol(j,w-1){\n    bool ok=true;\n    lol(f,2)lol(g,2){\n      if(c[i+f][j+g]!=mem[f][g])ok=false;\n    }\n    if(ok)cnt++;\n  }\n  int ans=0;\n  lol(i,h)lol(j,w){\n    lol(k,3){\n      int bef=0,aft=0;\n      for(int y=max(0,i-1);y<=i&&y+1<h;y++){\n\tfor(int x=max(0,j-1);x<=j&&x+1<w;x++){\n\t  bool ok=true;\n\t  lol(f,2)lol(g,2){\n\t    if(c[y+f][x+g]!=mem[f][g])ok=false;\n\t  }\n\t  if(ok)bef++;\n\t}\n      }\n      swap(z[k],c[i][j]);\n      for(int y=max(0,i-1);y<=i&&y+1<h;y++){\n\tfor(int x=max(0,j-1);x<=j&&x+1<w;x++){\n\t  bool ok=true;\n\t  lol(f,2)lol(g,2){\n\t    if(c[y+f][x+g]!=mem[f][g])ok=false;\n\t  }\n\t  if(ok)aft++;\n\t}\n      }\n      swap(z[k],c[i][j]);\n      ans=max(ans,cnt+aft-bef);\n    }\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int MAX_M = 100, MAX_N = 100;\nstring flag[MAX_M];\nstring Emb[2];\n\nbool lu(int i, int j){ return flag[i][j] == Emb[0][0]; }\nbool ru(int i, int j){ return flag[i][j + 1] == Emb[0][1]; }\nbool ld(int i, int j){ return flag[i + 1][j] == Emb[1][0]; }\nbool rd(int i, int j){ return flag[i + 1][j + 1] == Emb[1][1]; }\n\nint main(){\n\tint M, N;\n\tint table[MAX_M][MAX_N];\n\tint res, plus, n;\n\tfor(int i = 0; i < MAX_M; i++){\n\t\tfor(int j = 0; j < MAX_N; j++){\n\t\t\ttable[i][j] = 0;\n\t\t}\n\t}\n\t\n\tcin >> M >> N;\n\tfor(int i = 0; i < M; i++){\n\t\tcin >> flag[i];\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tcin >> Emb[i];\n\t}\n\t\n\tres = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tif(lu(i, j) && ru(i, j) && ld(i, j) && rd(i, j)) res++;\n\t\t\telse{\n\t\t\t\tif(ru(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 1;\n\t\t\t\telse if(lu(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 2;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && rd(i, j)) table[i][j] = 3;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && ld(i, j)) table[i][j] = 4;\n\t\t\t\telse table[i][j] = -1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tplus = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tn = 0;\n\t\t\tif(table[i][j] == 0 || table[i][j] == -1) continue;\n\t\t\tif(table[i][j] == 1) n = 1;\n\t\t\telse if(table[i][j] == 2){\n\t\t\t\tn = 1;\n\t\t\t\tif(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 1 && Emb[0][0] == Emb[0][1]) n++;\n\t\t\t\t\telse if(table[i][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(table[i][j] == 3){\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 1 && Emb[0][0] == Emb[1][0]) n++;\n\t\t\t\t\telse if(table[i + 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2 && j < N - 2){\n\t\t\t\t\tif(table[i + 1][j + 1] == 1 && Emb[0][0] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i + 1][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 2 && Emb[0][1] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i + 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3 && Emb[1][0] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tplus = max(plus, n);\n\t\t}\n\t}\n\t\n\tcout << res + plus << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 0598\n#include<cstdio>\n#include<algorithm>\n#include<map>\n#define rep(i,a) for(int i=0;i<(a);++i)\n#define all(a) (a).begin(), (a).end()\n\nconst int dx[4][4] = {\n\t{ 0, 1, 0, 1 },\n\t{ 0, 1, 0, 1 },\n\t{ -1, 0, -1, 0 },\n\t{ -1, 0, -1, 0 }\n};\nconst int dy[4][4] = {\n\t{ 0, 0, 1, 1 },\n\t{ -1, -1, 0, 0 },\n\t{ -1, -1, 0, 0 },\n\t{ 0, 0, 1, 1 }\n};\n\nint M, N;\nchar fld[1000][1001], emb[2][3];\n\nbool safe( int i, int j )\n{ return i >= 0 && i < M && j >= 0 && j < N; }\n\nint main()\n{\n\tscanf( \"%d%d\", &M, &N );\n\trep( i, M )\n\t\tscanf( \"%s\", fld[i] );\n\trep( i, 2 )\n\t\tscanf( \"%s\", emb[i] );\n\n\tint ans = 0, inc = 0;\n\trep( i, M ) rep( j, N )\n\t{\n\t\tstd::map<char, int> m;\n\n\t\trep( t, 4 )\n\t\t{\n\t\t\tint cnt = 0;\n\t\t\tchar ch = '\\0';\n\n\t\t\trep( d, 4 ) if( safe( i+dx[t][d], j+dy[t][d] ) )\n\t\t\t{\n\t\t\t\tcnt += fld[i+dy[t][d]][j+dx[t][d]] == emb[d/2][d&1];\n\n\t\t\t\tif( !dx[t][d] && !dy[t][d] && fld[i+dy[t][d]][j+dx[t][d]] != emb[d/2][d&1] )\n\t\t\t\t\tch = emb[d/2][d&1];\n\t\t\t}\n\n\t\t\tif( !t && cnt == 4 )\n\t\t\t\t++ans;\n\t\t\tif( cnt == 3 && ch != '\\0' )\n\t\t\t\t++m[ch];\n\t\t}\n\n\t\tinc = std::max( inc, std::max_element( all(m), []( const std::pair<char, int> &lhs, const std::pair<char, int> &rhs ){ return lhs.second > rhs.second; } )->second );\n\t}\n\n\tprintf( \"%d\\n\", ans+inc );\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool check(vector<string> const& v, vector<string> const& flag, int x, int y) {\n    if(x < 0 || x+1 >= v[0].size() || y < 0 || y+1 >= v.size()) {\n        return false;\n    }\n    return v[y][x] == flag[0][0] && v[y+1][x] == flag[1][0] && v[y][x+1] == flag[0][1] && v[y+1][x+1] == flag[1][1];\n}\n\nint main() {\n    int M, N;\n    cin >> M >> N;\n    vector<string> v(M);\n    for(int i=0; i<M; ++i) {\n        cin >> v[i];\n    }\n    vector<string> flag(2);\n    for(int i=0; i<2; ++i) {\n        cin >> flag[i];\n    }\n\n    int sum = 0;\n    for(int i=0; i<N; ++i) {\n        for(int j=0; j<M; ++j) {\n            sum += check(v, flag, i, j);\n        }\n    }\n    int res = 0;\n    for(int x=0; x<N; ++x) {\n        for(int y=0; y<M; ++y) {\n            int t = 0;\n            int dx[4] = {-1, 0, -1, 0},\n                dy[4] = {-1, -1, 0, 0};\n            for(int k=0; k<4; ++k) {\n                t += check(v, flag, x+dx[k], y+dy[k]);\n            }\n            array<char, 3> ar = {'J', 'O', 'I'};\n            for(int k=0; k<3; ++k) {\n                int s = 0;\n                char tmp = v[y][x];\n                v[y][x] = ar[k];\n                for(int l=0; l<4; ++l) {\n                    s += check(v, flag, x+dx[l], y+dy[l]);\n                }\n                v[y][x] = tmp;\n                res = max(res, sum - t + s);\n            }\n        }\n    }\n    cout << res << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<string>\n#include<stdio.h>\nusing namespace std;\nint n, m;\nstring fl[1001];\nstring tmp[2];\nstring JOI = \"JOI\";\n\nbool hani(int i, int j) {\n\tif (i < n && i >= 0 && j < m && j >= 0) return true;\n\treturn false;\n}\n\nbool check(int i,int j) {\n\t\n\tif (hani(i, j))\n\t\tif (fl[i][j] == tmp[0][0])\n\t\t\tif (hani(i + 1, j))\n\t\t\t\tif (fl[i + 1][j] == tmp[1][0])\n\t\t\t\t\tif (hani(i, j + 1))\n\t\t\t\t\t\tif (fl[i][j + 1] == tmp[0][1])\n\t\t\t\t\t\t\tif (hani(i + 1, j + 1))\n\t\t\t\t\t\t\t\tif (fl[i + 1][j + 1] == tmp[1][1]) return true;\n\treturn false;\n}\n\nint mxy(int i, int j) {\n\tint cnt = 0;\n\tif (check(i - 1, j - 1)) cnt++;\n\tif (check(i - 1, j)) cnt++;\n\tif (check(i, j - 1)) cnt++;\n\tif (check(i, j)) cnt++;\n\treturn cnt;\n}\n\n\nint main() {\n\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> fl[i];\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tcin >> tmp[i];\n\t}\n\n\tint cnt = 0;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < m; j++) {\n\t\t\tif (check(i, j)) cnt++;\n\t\t}\n\t}\n\n\tint ans = 0;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < m; j++) {\n\t\t\tchar now = fl[i][j];\n\t\t\tint ncnt = mxy(i, j);\n\t\t\tint MAX = 0;\n\t\t\tfor (int s = 0; s < 3; s++) {\n\t\t\t\tif (now == JOI[s]) continue;\n\t\t\t\tfl[i][j] = JOI[s];\n\t\t\t\tMAX = max(MAX, mxy(i, j));\n\t\t\t}\n\t\t\tfl[i][j] = now;\n\t\t\tif (ncnt < MAX) {\n\t\t\t\tans = max(ans, MAX - ncnt);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\", cnt + ans);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint H,W,total=0,maxm=0;\nstring str;\nchar t[1010][1010];\nchar u[2][2];\nchar v[]={'J','O','I'};\nint check(int y,int x){\n  if(t[y][x]==u[0][0]&&\n     t[y+1][x]==u[1][0]&&\n     t[y][x+1]==u[0][1]&&\n     t[y+1][x+1]==u[1][1])\n    return 1;\n  return 0;\n}\n \nint main(){\n  for(int i=0;i<1010;i++)\n    for(int j=00;j<1010;j++)\n      t[i][j]='*';\n  cin>>H>>W;\n  for(int i=1;i<=H;i++){\n    for(int j=1;j<=W;j++){\n      cin>>t[i][j];\n    }\n  }\n  for(int i=0;i<2;i++)for(int j=0;j<2;j++)cin>>u[i][j];\n \n  for(int i=1;i<=H;i++){\n    for(int j=1;j<=W;j++){\n      total+=check(i,j);\n    }\n  }\n \n  for(int i=1;i<=H;i++){\n    for(int j=1;j<=W;j++){\n  \n      int a = check(i-1,j-1)+check(i,j)\n    +check(i-1,j)+check(i,j-1);\n      char tmp=t[i][j];\n      for(int k=0;k<3;k++){\n    t[i][j]=v[k];\n    int b = check(i-1,j-1)+check(i,j)\n      +check(i-1,j)+check(i,j-1);\n    maxm=max(maxm,b-a);\n      }\n      t[i][j]=tmp;\n    }\n  }\n  cout<<total+maxm<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nconst int N=1010;\n\nint main()\n{\n    int a, b;\n    cin >>a>>b;\n    char a11, a12, a21, a22, x[N][N], y;\n    int j=0;\n    for (int k=1; k<=a; k++)\n    {\n        for (int l=1; l<=b; l++)\n        {\n            cin >> x[k][l];\n        }\n    }\n    cin >>a11>>a12>>a21>>a22;\n    for (int k=1; k<=a-1; k++)\n    {\n        for (int l=1; l<=b-1; l++)\n        {\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            j+=1;\n        }\n    }\n    int q=j;\n    int m, n, p;\n    for (int k=1; k<=a; k++)\n    {\n        for (int l=1; l<=b; l++)\n        {\n            y=x[k][l];\n            m=0;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            m+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            m+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            m+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            m+=1;\n            n=0;\n            x[k][l]=a11;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(m, n);\n            n=0;\n            x[k][l]=a12;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a21;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a22;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);            \n            j=max(j, q+p-m);\n            x[k][l]=y;\n        }\n    }\n    cout <<j<<\"\\n\";\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n    int h, w; cin >> h >> w;\n\n    for (int i = 0; i < h; ++i) cin >> mp[i];\n\n    for (int i = 0; i < 2; ++i) cin >> e[i];\n\n    int sum = 0;\n\n    for (int i = 0; i < h - 1; ++i) {\n        for (int j = 0; j < w - 1; ++j) {\n            if (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n                sum++;\n            }\n        }\n    }\n\n    int ans = sum;\n\n    for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n            int sum2 = sum;\n\n            char tmp = mp[i][j];\n\n            int cnt = 0;\n\n            for (int k = 0; k < 4; ++k) {\n                int y = i + dy[k], x = j + dx[k];\n                if (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n                if (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n                    cnt++;\n                }\n            }\n\n            sum2 -= cnt;\n            \n            for (int k = 0; k < 3; ++k) {\n                mp[i][j] = a[k];\n\n                int cnt2 = 0;\n\n                for (int l = 0; l < 4; ++l) {\n                    int y = i + dy[l], x = j + dx[l];\n                    if (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n                    if (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n                        cnt2++;\n                    }\n                }\n\n                cnt = max(cnt, cnt2);\n            }\n\n            sum2 += cnt;\n\n            mp[i][j] = tmp;\n\n            ans = max(ans, sum2);\n        }\n    }\n\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0 || ny == H - 1 || nx == 0 || nx == W - 1){\n\t\t\t\t\tans = max(ans, res);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = 1;\n\t\t\t\t\tt += (search(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint W, H;\nstring s[1000], ss[2], joi = \"JOI\";\nint b[1000][1000];\n\nint check(int x, int y)\n{\n  bool bb = true;\n  for(int yy = 0; yy < 2; yy++)\n    for(int xx = 0; xx < 2; xx++)\n      bb &= s[y + yy][x + xx] == ss[yy][xx];\n  return bb ? 1 : 0;\n}\n\nint count(int x, int y)\n{\n  int n = 0, m = 0;\n  if(x > 0 && y > 0)\n  {\n    n += check(x - 1, y - 1);\n    m += b[y - 1][x - 1];\n  }\n  if(x > 0 && y < H - 1)\n  {\n    n += check(x - 1, y);\n    m += b[y][x - 1];\n  }\n  if(y > 0 && x < W - 1)\n  {\n    n += check(x, y - 1);\n    m += b[y - 1][x];\n  }\n  if(y < H - 1 && x < W - 1)\n  {\n    n += check(x, y);\n    m += b[y][x];\n  }\n  return n - m;\n}\n\nint main()\n{\n  int n = 0, ans = -1;\n  \n  cin >> H >> W;\n  for(int i = 0; i < H; i++)\n    cin >> s[i];\n  cin >> ss[0] >> ss[1];\n  \n  for(int y = 0; y < H - 1; y++)\n    for(int x = 0; x < W - 1; x++)\n      n += b[y][x] = check(x, y);\n  for(int y = 0; y < H; y++)\n  {\n    for(int x = 0; x < W; x++)\n    {\n      auto c = s[y][x];\n      for(int i = 0; i < 3; i++)\n      {\n        s[y][x] = joi[i];\n        ans = max(ans, n + count(x, y));\n      }\n      s[y][x] = c;\n    }\n  }\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define rrep(i,n) for(int i=1;i<=n;i++)\n#define drep(i,n) for(int i=n;i>=0;i--)\n#define INF 100000005\n#define MAX 1002\n#define ll long long\n#define dmp make_pair\n#define dpb push_back\n#define P pair<int,int>\n#define fi first\n#define se second\nusing namespace std;\n//__gcd(a,b), __builtin_popcount(a);\n\nint dx[4] = {0,1,0,1}, dy[4] = {0,0,1,1};\nint f[MAX][MAX];\nchar str[MAX][MAX], a[MAX][MAX], s[2][2];\nint main(){\n\tint h, w;\n\tscanf(\"%d%d\", &h, &w);\n\trep(i,h)scanf(\"%s\", str[i]);\n\trep(i,MAX)rep(j,MAX)a[i][j] = 'x';\n\trep(i,h)rep(j,w)a[i+1][j+1] = str[i][j];\n\tscanf(\"%s%s\", s[0], s[1]);\n\t\n\tint d[4], ans = 0, tmp, sum, p;\n\tfor(int i = 1;i <= h;i++){\n\t\tfor(int j = 1;j <= w;j++){\n\t\t\ttmp = sum = 0;\n\t\t\tfor(int k = 0;k < 4;k++){\n\t\t\t\tif(a[i+dy[k]][j+dx[k]] != s[dy[k]][dx[k]])tmp = 1;\n\t\t\t\telse sum++;\n\t\t\t}\n\t\t\tif(!tmp){\n\t\t\t\trep(k,4)f[i+dy[k]][j+dx[k]]--;\n\t\t\t\tans++;\n\t\t\t}\n\t\t\tif(sum == 3){\n\t\t\t\trep(k,4)if(a[i+dy[k]][j+dx[k]] != s[dy[k]][dx[k]])\n\t\t\t\tf[i+dy[k]][j+dx[k]]++;\n\t\t\t}\n\t\t}\n\t}\n\tint res = 0;\n\trrep(i,h)rrep(j,w)res = max(res, f[i][j]);\n\t/*rep(i,h+2){\n\t\trep(j,w+2)printf(\"%d \", f[i][j]);\n\t\tprintf(\"\\n\");\n\t}*/\n\tprintf(\"%d\\n\", ans+res);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned __int128 HASH;\ntypedef pair<int,int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ull, ull> pullull;\ntypedef pair<ll,int> plli;\ntypedef pair<double, int> pdbi;\ntypedef pair<int,pii> pipii;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vi> vvi;\ntypedef vector<vvi> vvvi;\ntypedef vector<pii> vpii;\ntypedef vector<vector<int>> mat;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n);i>0;i--)\n#define rrep2(i,a,b) for (int i=(a);i>b;i--)\n#define pb push_back\n#define fi first\n#define se second\n#define all(a) (a).begin(),(a).end()\n#define rall(a) (a).rbegin(),(a).rend()\n\nconst ll hmod1 = 999999937;\nconst ll hmod2 = 1000000000 + 9;\nconst ll INF = 1<<30;\nconst ll mod = 10000 + 7;\nconst int dx4[4] = {1, 0, -1, 0};\nconst int dy4[4] = {0, 1, 0, -1};\nconst int dx8[8] = {1, 1, 1, 0, 0, -1, -1, -1};\nconst int dy8[8] = {0, 1, -1, 1, -1, 0, 1, -1};\nconst double pi = 3.141592653589793;\n\n//#define int long long\n#define addm(X, Y) (X) = ((X) + ((Y) % mod) + mod) % mod\n\nint m, n;\nstring s[1005];\nstring joi[2];\nchar w[3] = {'J', 'O', 'I'};\n\nsigned main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> n >> m;\n    rep(i, n) cin >> s[i];\n    rep(i, 2) cin >> joi[i];\n    int ans = 0;\n    rep(i, n - 1)rep(j, m - 1) {\n        bool ok = true;\n        rep(k, 2)rep(l, 2) {\n            if (s[i + k][j + l] != joi[k][l]) {\n                ok = false;\n                break;\n            }\n        }\n        if (ok) ans++;\n    }\n    int plus = 0;\n    rep(i, n)rep(j, m) {\n        int cnt = 0;\n        rep2(l, i - 1, i + 1)rep2(o, j - 1, j + 1) {\n            if (l < 0 || o < 0) continue;\n            bool ok = true;\n            rep(a, 2)rep(b, 2) {\n                if (l + a >= n || o + b >= m) {\n                    ok = false;\n                    break;\n                }\n                if (s[l + a][o + b] != joi[a][b]) {\n                    ok = false;\n                    break;\n                }\n            }\n            if (ok) cnt++;\n        }\n        char tmp = s[i][j];\n        rep(k, 3) {\n            s[i][j] = w[k];\n            int cnt_tmp = 0;\n            rep2(l, i - 1, i + 1)rep2(o, j - 1, j + 1) {\n                if (l < 0 || o < 0) continue;\n                bool ok = true;\n                rep(a, 2){\n                    rep(b, 2) {\n                        if (l + a >= n || o + b >= m) {\n                            ok = false;\n                            break;\n                        }\n                        if (s[l + a][o + b] != joi[a][b]) {\n                            ok = false;\n                            continue;\n                        }\n                    }\n                }\n                if (ok) cnt_tmp++;\n            }\n            plus = max(plus, cnt_tmp - cnt);\n        }\n        s[i][j] = tmp;\n    }\n    cout << ans + plus << endl;\n}"
  },
  {
    "language": "C++",
    "code": "//関数作ればよかったorzorz\n#include<stdio.h>\n\nint m,n;\nchar flag[1002][1002],batch[2][4];\nint\tJOI[1002][1002],mon[2][4];\t//flagのJを0,Oを1,Iを2にしたもの,batchの以下略 \nint data[1000][1000] = {0};\nint change(int y,int x);\nint canmake(int i,int j){\n\tif(JOI[i][j] == mon[0][0] && JOI[i][j+1] == mon[0][1]){\n\t\tif(JOI[i+1][j] == mon[1][0] && JOI[i+1][j+1] == mon[1][1]){\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}\nint main(){\n\tint i,j;\n\tint syokisum = 0,mmax = 0;\n\tint x;\n\tx = scanf(\"%d%d\",&m,&n);\n\tfor(i = 0;i < m;i++){\n\t\tx = scanf(\"%s\",flag[i]);\n\t}\n\tx = scanf(\"%s%s\",batch[0],batch[1]);\n\tfor(i = 0;i < 2;i++){for(j = 0;j < 2;j++){\n\t\tif(batch[i][j] == 'J')mon[i][j] = 1;\n\t\tif(batch[i][j] == 'O')mon[i][j] = 2;\n\t\tif(batch[i][j] == 'I')mon[i][j] = 3;\n\t\t}\n\t}\n\tfor(i = 0;i < m;i++){\n\t\tfor(j = 0;j < n;j++){\n\t\t\t//探索用\n\t\t\tif(flag[i][j] == 'J')JOI[i][j] = 1;\n\t\t\tif(flag[i][j] == 'O')JOI[i][j] = 2;\n\t\t\tif(flag[i][j] == 'I')JOI[i][j] = 3;\n\t\t}\n\t}\n\t//(i,j) 0 <= i < m-1,0 <= j < n-1を左上として、そのなかにJOI紋章あるかを調べる\n\tfor(i = 0;i < m-1;i++){\n\t\tfor(j = 0;j < n-1;j++){\n\t\t\tsyokisum += canmake(i,j);\n\t\t\tdata[i][j] = canmake(i,j);\n\t\t\t//printf(\"data[i][j] = %d\\n\",data[i][j]);\n\t\t}\n\t}\n\tmmax = syokisum;\n\t//flag[i][j]を変える→data[i-1][j-1]~data[i][j]を変更(他の配列に保存)→増減を調べる\n\tfor(i = 0;i < m;i++){\n\t\tfor(j = 0;j < n;j++){\n\t\t\tint kosuu;\n\t\t\tkosuu = syokisum+change(i,j);\n\t\t\tif(mmax < kosuu)mmax = kosuu;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\",mmax);\n\treturn 0;\n}\nint change(int y,int x){\n\tint num,dist = 0;\n\tint mdist = 0;\n\tfor(int t = 0;t < 3;t++){\n\t\tnum = JOI[y][x];\n\t\tJOI[y][x] = t;\n\t\tfor(int i = y-1;i < y+1;i++){\n\t\t\tfor(int j = x-1;j < x+1;j++){\n\t\t\t\tif(i < 0 || j < 0 || i >= m-1 || j >= n-1)continue;\n\t\t\t\tdist += canmake(i,j)-data[i][j];\n\t\t\t\t//printf(\"%d %d\\n\",data[i][j],canmake(i,j));\n\t\t\t}\n\t\t}\n\t\tif(mdist < dist)mdist = dist; \n\t\tJOI[y][x] = num;\n\t}\n\treturn dist;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\n#include <deque>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint M, N;\nvector<string> vs(1000);\nvector<string> JOI(2);\nbool calc(int y, int x) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return false;\n  return vs[y][x] == JOI[0][0] && vs[y][x+1] == JOI[0][1] && vs[y+1][x] == JOI[1][0] && vs[y+1][x+1] == JOI[1][1];\n}\nint change(int y, int x, char c, int cy, int cx) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return 0;\n  int ret = 0;\n  ret -= calc(y, x);\n  char vsc = vs[cy][cx];\n  vs[cy][cx] = c;\n  ret += calc(y, x);\n  vs[cy][cx] = vsc;\n  return ret;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cin >> M >> N;\n  FOR(i,0,M) cin >> vs[i];\n  FOR(i,0,2) cin >> JOI[i];\n  int p = 0;\n  FOR(y,0,M) FOR(x,0,N) p += calc(y, x);\n\n  int mx = 0;\n  // ?´????->?´??????§????????? -1????´??????§?????????->?´???? +1????´??????§?????????->?´??????§????????? 0\n  string str = \"JOI\";\n  FOR(y,0,M) {\n    FOR(x,0,N) {\n      FOR(i,0,3) {\n        int cnt = 0;\n        int Y = y - 1, X = x - 1;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y, X = x - 1;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y - 1, X = x;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y, X = x;\n        cnt += change(Y, X, str[i], y, x);\n        mx = max(mx, cnt);\n      }\n    }\n  }\n  cout << p + mx << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\n#define MAX 1010\n\nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\n\nbool inField(int y,int x){\n  return 0 <= y && y < H && 0 <= x && x < W;\n}\n\nint Cnt(int y,int x,char ch){\n  int res = 0;\n\n  if(a[y][x] == b[0][0] && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res++;\n \n  if(b[0][0] == ch && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[0][1] && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res++;\n \n  if(b[0][1] == ch && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res--;\n\n  if(a[y][x] == b[1][0] && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])){\n    res++;\n  }\n  if(b[1][0] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[1][1] && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res++;\n \n  if(b[1][1] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res--;\n \n  return res;\n}\n\nint main(){\n  cin >> H >> W;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      cin >> b[i][j];\n    }\n  }\n  int ans = 0;\n  for(int i = 0 ; i < H-1 ; i++){\n    for(int j = 0 ; j < W-1 ; j++){\n      for(int k = 0 ; k < 2 ; k++){\n        for(int l = 0 ; l < 2 ; l++){\n          if(a[i+k][j+l] != b[k][l]){\n            goto next;\n          }\n        }\n      }\n      ans++;\n    next:;\n    }\n  }\n  int d = ans;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      char tmp = a[i][j];\n      for(int k = 0 ; k < 3 ; k++){\n        if(tmp == c[k]) continue;\n        a[i][j] = c[k];\n        ans = max(ans,d+Cnt(i,j,tmp));\n      }\n      a[i][j] = tmp;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nint match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y && crest_y >= 0; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x && crest_x >= 0; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1010][1010];\nchar crest[8][8];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1010];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[4];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstring joi=\"JOI\";\nstring s[1000],f[2];\nint cnt[1000][1000];\nint main(){\n\tint m,n;\tcin>>m>>n;\n\tfor(int i=0;i<m;i++)\tcin>>s[i];\n\tfor(int i=0;i<2;i++)\tcin>>f[i];\n\tint tmp=0;\n\tfor(int i=1;i<m;i++){\n\t\tfor(int j=1;j<n;j++){\n\t\t\tif(s[i-1][j-1]==f[0][0]&&s[i-1][j]==f[0][1]&&s[i][j-1]==f[1][0]&&s[i][j]==f[1][1]){\n\t\t\t\ttmp++;\n\t\t\t\tcnt[i-1][j-1]++;\tcnt[i-1][j]++;\tcnt[i][j-1]++;\tcnt[i][j]++;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=tmp;\n\tfor(int i=0;i<m;i++){\n\t\tfor(int j=0;j<n;j++){\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tint count=0;\n\t\t\t\t//s[i][j]をjoi[k]にした時\n\t\t\t\tfor(int a=-1;a<1;a++){\n\t\t\t\t\tfor(int b=-1;b<1;b++){//左上がs[i+a][j+b]\n\t\t\t\t\t\tif(i+a<0||j+b<0)\tcontinue;\n\t\t\t\t\t\tif(i+a+1>=m||j+b+1>=n)\tcontinue;\n\t\t\t\t\t\tint r=i+a,c=j+b;\n\t\t\t\t\t\tstring ts[]={\"  \",\"  \"};\n\t\t\t\t\t\tfor(int y=0;y<2;y++){\n\t\t\t\t\t\t\tfor(int x=0;x<2;x++){\n\t\t\t\t\t\t\t\tif(r+y==i&&c+x==c)\tts[y][x]=joi[k];\n\t\t\t\t\t\t\t\telse \tts[y][x]=s[r+y][c+x];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ts[0]==f[0]&&ts[1]==f[1])\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans=max(ans,tmp-cnt[i][j]+count);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <cstdint>\n#include <cstdio>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\nusing namespace std;\n#define rep(i, n) for(int(i) = 0; (i) < (n); (i)++)\n#define FOR(i, m, n) for(int(i) = (m); (i) < (n); (i)++)\n#define All(v) (v).begin(), (v).end()\n#define pb push_back\n#define MP(a, b) make_pair((a), (b))\nusing ll = long long;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\nconst int INF = 1 << 30;\nconst ll LINF = 1LL << 60;\nconst int MOD = 1e9 + 7;\n\nint check(int x, int y, const vector<vector<char>> &flag,\n          const vector<vector<char>> &filter) {\n    int res = 0;\n    int M = flag.size();\n    int N = flag[0].size();\n    for(int i = y - 1; i <= y; i++) {\n        for(int j = x - 1; j <= x; j++) {\n            if(i == -1 || j == -1 || i == M - 1 || j == N - 1)\n                continue;\n            bool ok = 1;\n            rep(ii, 2) {\n                rep(jj, 2) {\n\n                    if(flag[i + ii][j + jj] != filter[ii][jj])\n                        ok = 0;\n                }\n            }\n            res += ok;\n        }\n    }\n    return res;\n}\n\nint main() {\n    int M, N;\n    cin >> M >> N;\n    vector<vector<char>> flag(M, vector<char>(N));\n    vector<vector<char>> filter(2, vector<char>(2));\n    rep(i, M) rep(j, N) cin >> flag[i][j];\n    rep(i, 2) rep(j, 2) cin >> filter[i][j];\n    int old = 0;\n    rep(i, M - 1) rep(j, N - 1) {\n        int ok = 1;\n        rep(ii, 2) rep(jj, 2) {\n            if(filter[ii][jj] != flag[i + ii][j + jj])\n                ok = 0;\n        }\n        old += ok;\n    }\n    int res = old;\n    for(int y = 0; y < M; y++) {\n        for(int x = 0; x < N; x++) {\n            int base = check(x, y, flag, filter);\n            if(flag[y][x] == 'J') {\n                int after;\n                flag[y][x] = 'O';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'I';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'J';\n            } else if(flag[y][x] == 'O') {\n                int after;\n                flag[y][x] = 'J';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'I';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'O';\n            } else {\n                int after;\n                flag[y][x] = 'O';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'J';\n                after = check(x, y, flag, filter);\n                res = max(res, old - base + after);\n                flag[y][x] = 'I';\n            }\n        }\n    }\n    cout << res << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\nint main() {\n\tint M,N;\n\tint R=0;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a=0;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\n\tint c[4];\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\n\t\t}\n\t}\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<climits>\nusing namespace std;\ntypedef long long int ll;\nstatic const int MAX_M = 1000;\nstatic const int MAX_N = 1000;\n\nint M, N;\nchar field1[MAX_M + 1][MAX_N], field2[MAX_M + 1][MAX_N];\nchar field3[2][2];\n\nint memo[3][MAX_M][MAX_N];\nchar ch[] = {'J', 'O', 'I'};\nint dy[] = {0, 0, 1, 1};\nint dx[] = {0, 1, 1, 0};\n\nint main(){\n\tscanf(\"%d %d\", &M, &N);\n\tfor(int i = 0; i < M; i++){\n\t\tscanf(\"%s\", field1[i]);\n\t\tstrcpy(field2[i], field1[i]);\n\t}\n\tfor(int i = 0; i < 2; i++) scanf(\"%s\", field3[i]);\n\n\tint res = 0;\n\tfor(int i = 0; i < M; i++){\n\t\tfor(int j = 0; j < N; j++){\n\t\t\tint cy = i, cx = j;\n\t\t\tbool flag = true;\n\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\tint ny = cy + dy[k], nx = cx + dx[k];\n\t\t\t\tif(ny > M - 1 || nx > N - 1) flag = false;\n\t\t\t\tif(field1[ny][nx] != field3[dy[k]][dx[k]]) flag = false;\n\t\t\t}\n\t\t\tif(flag){\n\t\t\t\tres++;\n\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\tint ny = cy + dy[k], nx = cx + dx[k];\n\t\t\t\t\tif(field1[ny][nx] == 'J') memo[0][ny][nx]--;\n\t\t\t\t\tif(field1[ny][nx] == 'O') memo[1][ny][nx]--;\n\t\t\t\t\tif(field1[ny][nx] == 'I') memo[2][ny][nx]--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint max_diff = -2;\n\tfor(int i = 0; i < M; i++){\n\t\tfor(int j = 0; j < N; j++){\n\t\t\tint cy = i, cx = j;\n\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\tfield2[i][j] = ch[k];\n\t\t\t\tfor(int l = 0; l < 4; l++){\n\t\t\t\t\tint ny = cy - dy[l], nx = cx - dx[l];\n\t\t\t\t\tif(ny < 0|| nx < 0) continue;\n\t\t\t\t\tbool flag = true;\n\t\t\t\t\tfor(int m = 0; m < 4; m++){\n\t\t\t\t\t\tint ny2 = ny + dy[m], nx2 = nx + dx[m];\n\t\t\t\t\t\tif(ny2 > M - 1 || nx2 > N - 1) flag = false;\n\t\t\t\t\t\tif(field2[ny2][nx2] != field3[dy[m]][dx[m]]) flag = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(flag) memo[k][i][j]++;\n\t\t\t\t}\n\t\t\t\tmax_diff = max(max_diff, memo[k][i][j]);\n\t\t\t\tfield2[i][j] = field1[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tres += max_diff;\n\tprintf(\"%d\\n\", res);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <queue>\n#include <stack>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\ntypedef double db;\n\n#define fr first\n#define sc second\n#define pb push_back\n#define rep(i,x) for(ll i=0;i<x;i++)\n#define rep1(i,x) for(ll i=1;i<=x;i++)\n#define rrep(i,x) for(ll i=x-1;i>=0;i--)\n#define rrep1(i,x) for(ll i=x;i>0;i--)\n#define plus asdgew\nll H,W;\nstring s[1000];\nll cnt[1000][1000];\nstring f[2];\nchar c[4]=\"JOI\";\nll ans=0;\nll plus;\nll ok(ll y,ll x){\n\trep(i,2) rep(j,2){\n\t\tif(f[i][j]!=s[y+i][x+j]) return 0;\n\t}\n\treturn 1;\n}\n\nll calc(ll y,ll x){\n\tll res=0;\n\tauto jud = [](ll Y,ll X){\n\t\treturn 0<=Y&&Y<H-1&&0<=X&&X<W-1;\n\t};\n\tchar cc=s[y][x];\n\trep(i,3){\n\t\tll bs=0;\n\t\tif(cc==c[i]) continue;\n\t\ts[y][x]=c[i];\n\t\tif(jud(y-1,x-1)) bs+=ok(y-1,x-1);\n\t\tif(jud(y,x-1)) bs+=ok(y,x-1);\n\t\tif(jud(y-1,x)) bs+=ok(y-1,x);\n\t\tif(jud(y,x)) bs+=ok(y,x);\n\t\tres=max(res,bs);\n\t}\n\ts[y][x]=cc;\n\treturn res-cnt[y][x];\n}\n\nint main()\n{\n\tcin>>H>>W;\n\trep(i,H) cin>>s[i];\n\tcin>>f[0]>>f[1];\n\trep(i,H-1) rep(j,W-1){\n\t\tif(s[i][j]==f[0][0]&&s[i+1][j]==f[1][0]&&s[i][j+1]==f[0][1]&&s[i+1][j+1]==f[1][1]){\n\t\t\tans++;\n\t\t\tcnt[i][j]++;\n\t\t\tcnt[i+1][j]++;\n\t\t\tcnt[i][j+1]++;\n\t\t\tcnt[i+1][j+1]++;\n\t\t}\n\t}\n\tplus=0;\n\t/*rep(i,H){\n\t\trep(j,W){\n\t\t\tcout<<cnt[i][j];\n\t\t}\n\t\tcout<<endl;\n\t}*/\n\trep(i,H) rep(j,W) plus=max(plus,calc(i,j));\n\tcout<<ans+plus<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1010][1010];\nchar crest[8][8];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1111][1111];\nbool a[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  int cnt;\n  int ans=-111;\n  cin>>M>>N;\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  int a_cnt=0;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(mas[i+k][j+l]==key[k][l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4) a_cnt++;\n    }\n  }\n \n  int dx[]={-1,-1,0,0};\n  int dy[]={-1,0,-1,0};\n  char joi[]={'J','O','I'};\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      for(int mozi=0;mozi<3;mozi++){\n\tif(mas[i][j]==joi[mozi]) continue;\n\tchar tmp=mas[i][j];\n\tmas[i][j]=joi[mozi];\n\tcnt=0;\n\tfor(int k=0;k<4;k++){\n\t  int nx=i+dx[k];\n\t  int ny=j+dy[k];\n\t  int ret=0;\n\t  if(0<=nx && nx<M-1 && 0<=ny && ny<N-1){\n\t    \n\t    for(int m=0;m<2;m++){\n\t      for(int l=0;l<2;l++){\n\t\tif(mas[nx+m][ny+l]==key[m][l]){\n\t\t  ret++;\n\t\t}\n\t      }\n\t    }\n\t    if(ret==4) cnt++;\n\t  }\n\t}\n\tans=max(ans,cnt);\n\tmas[i][j]=tmp;\n      }\n    }\n  }\n  cout<<ans+a_cnt<<endl;\n  return 0;\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\nint di[4] = {-1,-1, 0, 0};\nint dj[4] = {-1, 0,-1, 0};\n\nint main(){\n    string joi = \"JOI\";\n    int m, n;\n    cin >> m >> n;\n    vector<vector<char>> mat(m+2, vector<char>(n+2, '.')), flag(2, vector<char>(2));\n    for(int i = 1; i <= m; i++){\n        for(int j = 1; j <= n; j++){\n            cin >> mat[i][j];\n        }\n    }\n    for(int i = 0; i < 2; i++)  for(int j = 0; j < 2; j++)  cin >> flag[i][j];\n    auto f = [&](int i, int j)->bool{\n        for(int k = 0; k < 2; k++){\n            for(int l = 0; l < 2; l++){\n                if(mat[i+k][j+l] != flag[k][l]) return false;\n            }\n        }\n        return true;\n    };\n    int base = 0;\n    for(int i = 1; i <= m-1; i++){\n        for(int j = 1; j <= n-1; j++){\n            if(f(i,j))  base++;\n        }\n    }\n    int add = 0;\n    for(int i = 1; i <= m; i++){\n        for(int j = 1; j <= n; j++){\n            char c = mat[i][j];\n            int def = 0;\n            for(int k = 0; k < 4; k++)  if(f(i+di[k],j+dj[k]))  def++;\n            for(int k = 0; k < 3; k++){\n                mat[i][j] = joi[k];\n                int tmp = 0;\n                for(int l = 0; l < 4; l++)  if(f(i+di[l],j+dj[l]))  tmp++;\n                add = max(add, tmp-def);\n            }\n            mat[i][j] = c;\n        }\n    }\n    cout << base+add << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <fstream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <set>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <sstream>\n#include <fstream>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n#define int long long\nconst int mod = 1000000007;\n\nchar flag[1000][1000] = {};\nint z[1000][1000][3] = {};\nchar base[2][2];\nsigned main()\n{\n\tint ans = 0;\n\tint H, W; cin >> H >> W;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> base[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tint tmp = 0;\n\t\t\tint x, y;\n\t\t\tint m = 0;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (flag[i + k][j + l] == base[k][l]) {\n\t\t\t\t\t\ttmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx = i + k; y = j + l;\n\t\t\t\t\t\tif (base[k][l] == 'J') m = 0;\n\t\t\t\t\t\telse if (base[k][l] == 'O') m = 1;\n\t\t\t\t\t\telse m = 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == 4) {\n\t\t\t\tans++;\n\t\t\t}\n\t\t\telse if (tmp == 3) z[x][y][m]++;\n\t\t}\n\t}\n\tint tmp = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (z[i][j] != 0) {\n\t\t\t\t\ttmp = max(tmp, z[i][j][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans+tmp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include <iostream>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<queue>\n#include<vector>\n#include<functional>\n#include<cmath>\n#include<map>\n#include<stack>\n#include<cstdlib>\n#include<list>\n#include<set>\n#include<numeric>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nchar board[1001][1001];\nchar pattern[5][5];\n\nint main()\n{\n\tint N, M;  cin >> N >> M;\n\n\tfor (int i = 0; i < N; i++) {\n\t\tfor (int j = 0; j < M; j++) {\n\t\t\tcin >> board[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < 2; i++)\n\t\tfor (int j = 0; j < 2; j++)\n\t\t\tcin >> pattern[i][j];\n\n\tint ans = 0,flag = 0;\n\tfor (int i = 0; i < N - 1; i++) {\n\t\tfor (int j = 0; j < M - 1; j++) {\n\t\t\t\tint cnt = 0;\n\t\t\t\tif (pattern[0][0] != board[i][j]) \n\t\t\t\t\tcnt++;\n\t\t\t\tif (pattern[0][1] != board[i][j + 1]) \n\t\t\t\t\tcnt++;\n\t\t\t\tif (pattern[1][0] != board[i + 1][j]) \n\t\t\t\t\tcnt++;\n\t\t\t\tif (pattern[1][1] != board[i + 1][j + 1]) \n\t\t\t\t\tcnt++;\n\t\t\t\tif (cnt == 1 && !flag) {\n\t\t\t\t\tflag = 1;\n\t\t\t\t\tans++;\n\t\t\t\t}\n\t\t\t\telse if (cnt == 0)ans++;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint main()\n{\n\tint H, W;\n\n\tscanf(\"%d\", &H);\n\tscanf(\"%d\", &W);\n\n\tvector<string> D(H);\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tcin >> D[i];\n\t}\n\n\tstring C1, C2; cin >> C1 >> C2;\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < H - 1; i++)\n\t{\n\t\tfor (int j = 0; j < W - 1; j++)\n\t\t{\n\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\tif (R1 == C1 && R2 == C2)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint diff, ret = sum;\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tdiff = 0;\n\n\t\t\tif (i != 0 && j != 0)\n\t\t\t{\n\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t}\n\n\t\t\tif (i != 0 && j + 1 != W)\n\t\t\t{\n\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t}\n\n\t\t\tif (i + 1 != H && j != 0)\n\t\t\t{\n\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t}\n\n\t\t\tif (i + 1 != H && j + 1 != W)\n\t\t\t{\n\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t}\n\n\t\t\tret = max(ret, sum + diff);\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ret);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\nint H, W, bs, res, ret; char c, s[1009][1009], t[5][5], r[] = \"JOI\";\nbool check(int x, int y) { return 0 <= x && x < H - 1 && 0 <= y && y < W - 1 && s[x][y] == t[0][0] && s[x][y + 1] == t[0][1] && s[x + 1][y] == t[1][0] && s[x + 1][y + 1] == t[1][1]; }\nint main() {\n\tscanf(\"%d%d\", &H, &W);\n\tfor(int i = 0; i < H; i++) scanf(\"%s\", s[i]);\n\tscanf(\"%s%s\", t[0], t[1]);\n\tfor(int i = 0; i < H; i++) {\n\t\tfor(int j = 0; j < W; j++) {\n\t\t\tbs += check(i, j); c = s[i][j];\n\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\tres = -check(i - 1, j - 1) - check(i - 1, j) - check(i, j - 1) - check(i, j);\n\t\t\t\ts[i][j] = r[k];\n\t\t\t\tres += check(i - 1, j - 1) + check(i - 1, j) + check(i, j - 1) + check(i, j);\n\t\t\t\tret = ret > res ? ret : res;\n\t\t\t\ts[i][j] = c;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ret + bs);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint m, n, ans = 0, diff = 0;\nchar flag[1010][1010];\nchar sample[3][3];\n\nint status[1010][1010];\n\nint color(char c)\n{\n  if(c == 'J')\n    return 1; \n  if(c == 'O')\n    return 2;\n  if(c == 'I')\n    return 3;\n}\n\nint judge(int x, int y)\n{\n  return\n    ((flag[x][y] == sample[1][1]) << 3) +\n    ((flag[x][y + 1] == sample[1][2]) << 2) +\n    ((flag[x + 1][y] == sample[2][1]) << 1) +\n    (flag[x + 1][y + 1] == sample[2][2]);\n}\n\nint pls(int x, int y)\n{\n  int ret[4] = {0, 0, 0, 0};\n  if(status[x][y] == 14)\n    ret[color(sample[1][1])]++;\n  if(status[x][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][1])]++;\n  }\n\n  if(status[x][y - 1] == 13)\n    ret[color(sample[1][2])]++;\n  if(status[x][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[1][2])]++;\n  }\n\n  if(status[x - 1][y] == 11)\n    ret[color(sample[2][1])]++;\n  if(status[x - 1][y] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][1])]++;\n  }\n\n  if(status[x - 1][y - 1] == 7)\n    ret[color(sample[2][2])]++;\n  if(status[x - 1][y - 1] == 15){\n    ret[1]--;\n    ret[2]--;\n    ret[3]--;\n    ret[color(sample[2][2])]++;\n  }\n  \n  return max(max(ret[1], ret[2]), ret[3]);\n}\n    \n\nint main()\n{\n  cin >> m >> n;\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      cin >> flag[i][j];\n\n  for(int i = 1; i <= 2; i++)\n    for(int j = 1; j <= 2; j++)\n      cin >> sample[i][j];\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++){\n      status[i][j] = judge(i, j);\n      if(status[i][j] == 15)\n\tans++;\n    }\n\n  for(int i = 1; i <= m; i++)\n    for(int j = 1; j <= n; j++)\n      diff = max(diff, pls(i, j));\n\n  cout << ans + diff << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\nusing ll = long long;\n#define rep(i, n) for (int i = 0; i < (int)n; i++)\n\nint M, N;\nchar joi[1003][1003];\nchar c[2][2];\nbool ok(int y, int x) {\n    if (y + 1 >= M || x + 1 >= N) return 0;\n    if (y < 0 || x < 0) return 0;\n    int ys[] = {0, 0, 1, 1};\n    int xs[] = {0, 1, 0, 1};\n    rep(i, 4) {\n        if (c[ys[i]][xs[i]] != joi[y + ys[i]][x + xs[i]]) {\n            return 0;\n        }\n    }\n    return 1;\n}\nvoid show() {\n    rep(y, M) {\n        rep(x, N) cout << joi[y][x] << \" \";\n        cout << endl;\n    }\n    cout << endl;\n}\nint main() {\n    cin >> M >> N;\n    rep(i, M) rep(j, N) { cin >> joi[i][j]; }\n    rep(i, 2) rep(j, 2) cin >> c[i][j];\n    int ans = 0;\n    rep(y, M) rep(x, N) {\n        if (ok(y, x)) ans++;\n        //printf(\"%d %d %d\\n\",y,x,ok(y,x));\n    }\n\n    string logo = \"JOI\";\n    rep(y, M) rep(x, N) {\n        char tmp = joi[y][x];\n        rep(k, logo.size()) {\n            int cnt = 0;\n            joi[y][x] = logo[k];\n            //show();\n            for (int dy = -1; dy <= 1; dy++)\n                for (int dx = -1; dx <= 1; dx++)\n                    if (ok(y + dy, x + dx)) cnt++;\n            ans = max(ans, cnt);\n            joi[y][x] = tmp;\n        }\n    }\n\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<queue>\n#include<map>\n#include<set>\n#include<list>\n#include<iomanip>\n#include<vector>\n#include<functional>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nchar a[1000][1000];\nint c[1000][1000];\nint main(){\n\tint h,w;\n\twhile(cin>>h>>w){\n\t\tstring u;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\ta[i][j]=u[j];\n\t\t\t\tc[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tchar b[2][2];\n\t\tfor(int i=0;i<2;i++){\n\t\t\tcin>>u;\n\t\t\tfor(int j=0;j<2;j++) b[i][j]=u[j];\n\t\t}\n\t\tint sum=0,sum2=0;\n\t\tfor(int i=0;i<h-1;i++){\n\t\t\tfor(int j=0;j<w-1;j++){\n\t\t\t\tif(a[i][j]==b[0][0]&&a[i][j+1]==b[0][1]&&\n\t\t\t\ta[i+1][j]==b[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\n\tc[i][j]++;\n\t\t\t\t\tsum++;\n\t\t\t\t\tc[i][j+1]++;\n\t\t\t\t\tc[i+1][j]++;\n\t\t\t\t\tc[i+1][j+1]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsum2=sum;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmap<char, int>d;\n\t\t\t\td.insert(map<char, int>::value_type('J',0));\n\t\t\t\td.insert(map<char, int>::value_type('O',0));\n\t\t\t\td.insert(map<char, int>::value_type('I',0));\n\t\t\t\n\tif(i+1<h&&j+1<w){\n\t\t\t\t\tif(a[i][j+1]==b[0][1]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][0]&&a[i+1][j+1]==b[1][1]){\n\t\t\t\t\t\t\td[b[0][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i+1<h&&j-1>=0){\n\t\t\t\t\n\tif(a[i][j-1]==b[0][0]&&\n\t\t\t\t\t\ta[i+1][j]==a[1][1]&&a[i+1][j-1]==b[1][0]){\n\t\t\t\t\t\td[b[0][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j+1<h){\n\t\t\t\t\tif(a[i-1][j]==b[0][0]&&a[i-1][j+1]==b[0][1]&&\n\t\t\t\t\t\n\ta[i][j+1]==b[1][1]){\n\t\t\t\t\t\td[b[1][0]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i-1>=0&&j-1>=0){\n\t\t\t\t\tif(a[i-1][j-1]==b[0][0]&&a[i-1][j]==b[0][1]&&\n\t\t\t\t\t\ta[i][j-1]==a[1][0]){\n\t\t\t\t\t\td[b[1][1]]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['J']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['J']);\n\t\t\t\t}\n\t\t\t\tif(sum-c[i][j]+d['O']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['O']);\n\t\t\t\n\t}\n\t\t\t\tif(sum-c[i][j]+d['I']>sum2){\n\t\t\t\t\tsum2=(sum-c[i][j]+d['I']);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<sum2<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\n#define MAX 1010\n\nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\n\nbool inField(int y,int x){\n  return 0 <= y && y < H && 0 <= x && x < W;\n}\n\nint Cnt(int y,int x,char ch){\n  int res = 0;\n\n  if(a[y][x] == b[0][0] && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res++;\n \n  if(b[0][0] == ch && \n     (inField(y,x+1) && a[y][x+1] == b[0][1]) && \n     (inField(y+1,x) && a[y+1][x] == b[1][0]) &&\n     (inField(y+1,x+1) && a[y+1][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[0][1] && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res++;\n \n  if(b[0][1] == ch && \n     (inField(y,x-1) && a[y][x-1] == b[0][0]) && \n     (inField(y+1,x-1) && a[y+1][x-1] == b[1][0]) &&\n     (inField(y+1,x) && a[y+1][x] == b[1][1])) res--;\n\n  if(a[y][x] == b[1][0] && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])) res++;\n \n  if(b[1][0] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][0]) && \n     (inField(y-1,x+1) && a[y-1][x+1] == b[0][1]) &&\n     (inField(y,x+1) && a[y][x+1] == b[1][1])) res--;\n \n  if(a[y][x] == b[1][1] && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res++;\n \n  if(b[1][1] == ch && \n     (inField(y-1,x) && a[y-1][x] == b[0][1]) && \n     (inField(y,x-1) && a[y][x-1] == b[1][0]) &&\n     (inField(y-1,x-1) && a[y-1][x-1] == b[0][0])) res--;\n \n  return res;\n}\n\nint main(){\n  cin >> H >> W;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      cin >> b[i][j];\n    }\n  }\n  int ans = 0;\n  for(int i = 0 ; i < H-1 ; i++){\n    for(int j = 0 ; j < W-1 ; j++){\n      for(int k = 0 ; k < 2 ; k++){\n        for(int l = 0 ; l < 2 ; l++){\n          if(a[i+k][j+l] != b[k][l]){\n            goto next;\n          }\n        }\n      }\n      ans++;\n    next:;\n    }\n  }\n\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      char tmp = a[i][j];\n      for(int k = 0 ; k < 3 ; k++){\n        if(tmp == c[k]) continue;\n        a[i][j] = c[k];\n        ans = max(ans,ans+Cnt(i,j,tmp));\n      }\n      a[i][j] = tmp;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  int h,w;\n  char maps[1010][1010];\n  char kun[10];\n  int cnt;\n  int ans=0;\n  string str;\n  int best;\n  char joi[3];\n  //旗の入力\n  cin>>h>>w;\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      cin>>maps[i][j];\n    }\n  }\n  //勲章入力\n  cin>>str;\n  kun[0]=str[0];\n  kun[1]=str[1];\n  cin>>str;\n  kun[2]=str[0];\n  kun[3]=str[1];\n  cnt=0;\n  //昔の旗の勲章の数\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(kun[0]==maps[i][j] && kun[1]==maps[i][j+1] && kun[2]==maps[i+1][j] && kun[3]==maps[i+1][j+1])cnt++;\n    }\n  }\n  if(ans<cnt)ans=cnt;\n  best=cnt;\n  //白紙のパターン\n  joi[0]='J';\n  joi[1]='o';\n  joi[2]='i';\n  for(int s=0;s<h;s++){\n    for(int r=0;r<w;r++){\n      for(int m=0;m<3;m++){\n\tchar kari=maps[s][r];\n\tmaps[s][r]=joi[m];\n\tcnt=0;\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    if(kun[0]==maps[i][j]){\n\t      if(kun[1]==maps[i][j+1]){\n\t\tif(kun[2]==maps[i+1][j]){\n\t\t  if(kun[3]==maps[i+1][j+1])cnt++;\n\t\t}\n\t      }\n\t    }\n\t  }\n\t}\n\tif(ans<cnt)ans=cnt;\n\tmaps[s][r]=kari;\n      }\n    }\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n#define rep(i, n) for(int i = 0; i < signed(n); i++)\n#define REP(i, s, n) for(int i = (s); i < signed(n); i++)\n#define rrep(i, n) for(int i = signed(n) - 1; i >= 0; i--)\n#define all(co) co.begin(), co.end()\ntypedef pair<int, int> P;\ntypedef long long LL;\ntypedef pair<P, int> PI;\ntypedef pair<int, P> IP;\nconst int INF = 1 << 29;\nconst LL LINF = 1ll << 62ll;\n\nstruct edge{ int from, to, cost; };\n\nint dr[] = { -1, 0, 1, 0 };\nint dc[] = { 0, 1, 0, -1 };\n\ntemplate<typename T = int>\nvector<vector<T>> vvector(int h, int w, T def = T()){ return move(vector<vector<T>>(h, vector<T>(w, def))); }\nclass range {\nprivate: struct I{ int x; int operator*(){ return x; }bool operator!=(I& lhs){ return x < lhs.x; }void operator++(){ ++x; } }; I i, n;\npublic:range(int n) :i({ 0 }), n({ n }){}range(int i, int n) :i({ i }), n({ n }){}I& begin(){ return i; }I& end(){ return n; }\n};\n\nconst int MOD = 10000;\nsigned main()\n{\n\tint W, H;\n\twhile (cin >> H >> W && H)\n\t{\n\t\tvector<string> stage(H);\n\t\tvector<string> monsho(2);\n\t\trep(i, H) cin >> stage[i];\n\t\tcin >> monsho[0] >> monsho[1];\n\n\t\tint base = 0;\n\t\tauto isMonsho = [&](int i, int j){\n\t\t\treturn  i >= 0 && j >= 0 && i + 1 < H && j + 1 < W\n\t\t\t\t&& stage[i][j] == monsho[0][0]\n\t\t\t\t&& stage[i][j + 1] == monsho[0][1]\n\t\t\t\t&& stage[i + 1][j] == monsho[1][0]\n\t\t\t\t&& stage[i + 1][j + 1] == monsho[1][1];\n\t\t};\n\n\t\trep(i, H - 1) rep(j, W - 1) if (isMonsho(i, j))\n\t\t\tbase++;\n\n\t\tint ans = base;\n\t\tstring str = \"JOI\";\n\t\tint dr[] = { 0, 0, -1, -1 };\n\t\tint dc[] = { 0, -1, -1, 0 };\n\t\trep(r, H) rep(c, W)\n\t\t{\n\t\t\tint baseSur = 0;\n\t\t\trep(i, 4) if (isMonsho(r + dr[i], c + dc[i])) baseSur++;\n\n\t\t\trep(i, 3)\n\t\t\t{\n\t\t\t\tchar buf = stage[r][c];\n\t\t\t\tstage[r][c] = str[i];\n\t\t\t\tint nextSur = 0;\n\t\t\t\trep(i, 4) if (isMonsho(r + dr[i], c + dc[i])) nextSur++;\n\t\t\t\tstage[r][c] = buf;\n\n\t\t\t\tans = max(ans, base - baseSur + nextSur);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int MAX_M = 1000, MAX_N = 1000;\nstring flag[MAX_M];\nstring Emb[2];\n\nbool lu(int i, int j){ return flag[i][j] == Emb[0][0]; }\nbool ru(int i, int j){ return flag[i][j + 1] == Emb[0][1]; }\nbool ld(int i, int j){ return flag[i + 1][j] == Emb[1][0]; }\nbool rd(int i, int j){ return flag[i + 1][j + 1] == Emb[1][1]; }\n\nint main(){\n\tint M, N;\n\tint table[MAX_M][MAX_N];\n\tint res, plus, n;\n\tfor(int i = 0; i < MAX_M; i++){\n\t\tfor(int j = 0; j < MAX_N; j++){\n\t\t\ttable[i][j] = 0;\n\t\t}\n\t}\n\t\n\tcin >> M >> N;\n\tfor(int i = 0; i < M; i++){\n\t\tcin >> flag[i];\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tcin >> Emb[i];\n\t}\n\t\n\tres = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tif(lu(i, j) && ru(i, j) && ld(i, j) && rd(i, j)) res++;\n\t\t\telse{\n\t\t\t\tif(ru(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 1;\n\t\t\t\telse if(lu(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 2;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && rd(i, j)) table[i][j] = 3;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && ld(i, j)) table[i][j] = 4;\n\t\t\t\telse table[i][j] = -1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tplus = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tn = 0;\n\t\t\tif(table[i][j] == 0 || table[i][j] == -1) continue;\n\t\t\tif(table[i][j] == 1) n = 1;\n\t\t\telse if(table[i][j] == 2){\n\t\t\t\tif(j < N - 2 && table[i][j + 1] == 1) n = 2;\n\t\t\t\telse n = 1;\n\t\t\t}\n\t\t\telse if(table[i][j] == 3){\n\t\t\t\tif(i < M - 2 && table[i + 1][j] == 1) n = 2;\n\t\t\t\telse n = 1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2 && j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3) n++;\n\t\t\t\t\tif(table[i + 1][j] == 2) n++;\n\t\t\t\t\tif(table[i + 1][j + 1] == 1) n++;\n\t\t\t\t}\n\t\t\t\telse if(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 2) n++;\n\t\t\t\t}\n\t\t\t\telse if(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3) n++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tplus = max(plus, n);\n\t\t}\n\t}\n\t\n\tcout << res + plus << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define PB push_back\n#define MP make_pair\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define ALL(a) (a).begin(),(a).end()\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef long long ll;\nconst int INF=1e9;\nchar fld[1010][1010];\nchar flg[2][2];\nstring tmp=\"JOI\";\nint m,n;\nbool ok(int x,int y){\n  if(x<0||y<0||x+1>=n||y+1>=m)return false;\n  REP(i,2)REP(j,2)if(fld[x+j][y+i]!=flg[j][i])return false;\n  return true;\n}\nint rec(int x,int y){\n  int res=0;\n  for(int dx=-1;dx<=0;dx++){\n    for(int dy=-1;dy<=0;dy++){\n      if(ok(x+dx,y+dy))res++;\n    }\n  }\n  return res;\n}\nint main(){\n  cin>>m>>n;\n  REP(i,m)REP(j,n)cin>>fld[j][i];\n  REP(i,2)REP(j,2)cin>>flg[j][i];\n  int pre=0;\n  REP(i,m-1)REP(j,n-1){\n    bool f=true;\n    REP(x,2)REP(y,2){\n      if(fld[j+x][i+y]!=flg[x][y])f=false;\n    }\n    if(f)pre++;\n  }\n  int ans=0;\n  REP(i,m)REP(j,n){\n    int cnt=rec(j,i);\n    char t=fld[j][i];\n    REP(k,3){\n      fld[j][i]=tmp[k];\n      ans=max(ans,pre-cnt+rec(j,i));\n    }\n    fld[j][i]=t;\n  }\n  cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<fstream>\n\nusing namespace std;\n\nint ct[1000][1000];\nchar table[1000][1000];\nchar target[2][2];\n\nint N, M;\n\n//(x,y)????????????????????¨????????¨????????????????´????????????????\nbool match(int x, int y) {\n\treturn table[y][x] == target[0][0] && \n\t\ttable[y + 1][x] == target[1][0] && \n\t\ttable[y][x + 1] == target[0][1] && \n\t\ttable[y + 1][x + 1] == target[1][1];\n}\n//(x,y)????????????????´?????????°\n/*\n***\n*???*\n***\n*/\nint f(int x, int y) {\n\tint ct = 0;\n\tif (x + 1 < N && y + 1 < M) {\n\t\tif (match(x, y))ct++;\n\t}\n\tif (x - 1 >= 0 && y + 1 < M) {\n\t\tif (match(x - 1, y))ct++;\n\t}\n\tif (x + 1 < N && y >= 0) {\n\t\tif (match(x, y - 1))ct++;\n\t}\n\tif (x >= 0 && y >= 0) {\n\t\tif (match(x - 1, y - 1))ct++;\n\t}\n\treturn ct;\n}\n\nint main() {\n\t\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tcin >> table[i][j];\n\t\t}\n\t}\n\n\tcin >> target[0][0] >> target[0][1] >> target[1][0] >> target[1][1];\n\tint ans = 0, tmp = 0;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tif (i < M - 1 && j < N - 1)ans += match(j, i);\n\t\t\tct[i][j] = f(j, i);\n\t\t}\n\t}\n\ttmp = ans;\n\tfor (int i = 0; i < M; i++) {\n\t\tfor (int j = 0; j < N; j++) {\n\t\t\tchar bef = table[i][j];\n\t\t\ttable[i][j] = 'J';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = 'O';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = 'I';\n\t\t\tans = max(ans, tmp - ct[i][j] + f(j, i));\n\t\t\ttable[i][j] = bef;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<map>\n#include<string>\nusing namespace std;\nint h,w;\nint dy[]={0,0,1,1},dx[]={0,1,0,1};\nmap<char,int>M;\nint flag[1000][1000];\nint cnt[1000][1000][5];\nint emb[2][2];\nint main(){\n    M['J']=0;\n    M['O']=1;\n    M['I']=2;\n    cin>>h>>w;\n    int ans=0;\n    for(int i=0;i<h;i++){\n        string str;\n        cin>>str;\n        for(int j=0;j<w;j++)\n            flag[i][j]=M[str[j]];\n    }\n    for(int i=0;i<2;i++){\n        string str;\n        cin>>str;\n        for(int j=0;j<2;j++)\n            emb[i][j]=M[str[j]];\n    }\n\n    for(int i=0;i<h-1;i++){\n        for(int j=0;j<w-1;j++){\n            int c=0,memo;\n            for(int k=0;k<4;k++){\n                if(flag[i+dy[k]][j+dx[k]]==emb[dy[k]][dx[k]])c++;\n                else memo=k;\n            }\n            if(c==4){\n                for(int k=0;k<4;k++)\n                    cnt[i+dy[k]][j+dx[k]][0]++;\n                ans++;\n            }\n            else if(c==3){\n                int y=i+dy[memo],x=j+dx[memo];\n                int v=emb[y-i][x-j]+1;\n                cnt[y][x][v]++;\n            }\n\n        }\n    }\n    int sub=0;\n    for(int i=0;i<h;i++){\n        for(int j=0;j<w;j++){\n            if(cnt[i][j][0])continue;\n            for(int k=1;k<4;k++)\n                sub=max(sub,cnt[i][j][k]);\n        }\n    }\n    cout<<ans+sub<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\n\n\nchar mp[1002][1002]={0};\nchar fl[2][2];\n\nint main(){\n\t\n\tmemset(mp,'#',sizeof(mp));\n\t\n\tint h,w;\n\tcin>>h>>w;\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tcin>>mp[j][i];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>fl[j][i];\n\t\t}\n\t}\n\tint as=0;\n\tfor(int i=1;i<h;i++){\n\t\tfor(int j=1;j<w;j++){\n\t\t\tint f=1;\n\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\tfor(int l=0;l<2;l++){\n\t\t\t\t\tif(mp[j+l][i+k]!=fl[l][k]){\n\t\t\t\t\t\tf=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(f)as++;\n\t\t}\n\t}\n\t\n\tint as2=0;\n\t\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\t\n\t\t\tint fs=0;\n\t\t\tfor(int k=i-1;k<=i;k++){\n\t\t\t\tfor(int l=j-1;l<=j;l++){\n\t\t\t\t\tint f=1;\n\t\t\t\t\tfor(int m=0;m<2;m++){\n\t\t\t\t\t\tfor(int n=0;n<2;n++){\n\t\t\t\t\t\t\tif(mp[l+n][k+m]!=fl[n][m])f=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(f)fs++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tchar t=mp[j][i];\n\t\t\tfor(int c=0;c<3;c++){\n\t\t\t\tmp[j][i]=(c==0?'J':(c==1?'O':'I'));\n\t\t\t\tint tmp=0;\n\t\t\t\t\n\t\t\t\tfor(int k=i-1;k<=i;k++){\n\t\t\t\t\tfor(int l=j-1;l<=j;l++){\n\t\t\t\t\t\tint f=1;\n\t\t\t\t\t\tfor(int m=0;m<2;m++){\n\t\t\t\t\t\t\tfor(int n=0;n<2;n++){\n\t\t\t\t\t\t\t\tif(mp[l+n][k+m]!=fl[n][m])f=0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(f)tmp++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tas2=max(as2,tmp-fs);\n\t\t\t}\n\t\t\tmp[j][i]=t;\n\t\t\t\n\t\t}\n\t}\n\t\n\tcout<<as+as2<<endl;\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1001][1001];\nchar haku[1001][1001];\nbool a[1001][1001];\nbool deki[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  char mozi;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  memset(mas,0,sizeof(mas));\n  memset(haku,0,sizeof(haku));\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      haku[i][j]=mas[i][j];\n      a[i][j]=false;\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(key[k][l]==mas[i+k][j+l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4){\n\tans++;\n\tdeki[i][j]=deki[i+1][j+1]=deki[i+1][j]=deki[i][j+1]=true;\n      }else if(cnt==3){\n\ta[i][j]=true;\n      }\n    }\n  }\n  int cnnt=-111;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      if(a[i][j]){\n\tint x,y;\n\tfor(int k=0;k<2;k++){\n\t  for(int l=0;l<2;l++){\n\t    if(mas[i+k][j+l]!=key[k][l]){\n\t      haku[i+k][j+l]=key[k][l];\n\t      x=i+k;\n\t      y=j+l;\n\t      if(deki[i+k][j+l]){\n\t\tcnt--;\n\t      }else if(!deki[i+k][j+l]){\n\t\tcnt++;\n\t      }\n\t    }\n\t  }\n\t}\n\tint mozicnt=0;\n\tif(i-1>=0 && j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(i-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\thaku[x][y]=mas[x][y];\n      }\n      cnnt=max(cnnt,cnt);\n    }\n  }\n  ans+=cnnt;\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1<<30;\nvector<string>in,s;\nbool f(int a,int b){\n\tbool h=true;\n\trep(i,2)rep(j,2)if(in[a+i][b+j]!=s[i][j])h=false;\n\treturn h;\n}\nint main(){\n\tint n,m;\n\tcin>>n>>m;\n\tchar q[3]={'J','O','I'};\n\tin=vector<string>(n);\n\ts=vector<string>(2);\n\trep(i,n)cin>>in[i];\n\trep(i,2)cin>>s[i];\n\tint co=0;\n\trep(i,n-1)rep(j,m-1)co+=f(i,j);\n\tint out=co;\n\trep(i,n)rep(j,m)rep(k,3)if(in[i][j]!=q[k]){\n\t\tint t=co;\n\t\tint w[4]={max(0,i-1),max(0,j-1),min(n-1,i+1),min(m-1,j+1)};\n\t\tloop(I,w[0],w[2])loop(J,w[1],w[3])t-=f(I,J);\n\t\tchar C=in[i][j];\n\t\tin[i][j]=q[k];\n\t\tloop(I,w[0],w[2])loop(J,w[1],w[3])t+=f(I,J);\n\t\tin[i][j]=C;\n\t\tout=max(out,t);\n\t}\n\tcout<<out<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\n\nint main(){\n\n\tint H,W;\n\tscanf(\"%d %d\",&H,&W);\n\n\tchar** map = new char*[H];\n\tfor(int i = 0; i < H; i++)map[i] = new char[W+1];\n\n\tfor(int i = 0; i < H; i++)scanf(\"%s\",map[i]);\n\n\tchar emblem[2][3];\n\tscanf(\"%s\",emblem[0]);\n\tscanf(\"%s\",emblem[1]);\n\n\tint base = 0;\n\n\tfor(int row = 0; row < H-1; row++){\n\t\tfor(int col = 0; col < W-1; col++){\n\t\t\tif(map[row][col] == emblem[0][0] && map[row][col+1] == emblem[0][1] &&\n\t\t\t\t\tmap[row+1][col] == emblem[1][0] && map[row+1][col+1] == emblem[1][1])base++;\n\t\t}\n\t}\n\n\tint max_add = 0,pre_num,tmp_num;\n\tchar pre_char,array[4] = \"JOI\";\n\n\tfor(int row = 0; row < H; row++){\n\t\tfor(int col = 0; col < W; col++){\n\n\t\t\tpre_char = map[row][col];\n\n\t\t\tpre_num = 0;\n\n\t\t\tif(row-1 >= 0 && col-1 >= 0){\n\t\t\t\tif(map[row-1][col-1] == emblem[0][0] && map[row-1][col] == emblem[0][1] &&\n\t\t\t\t\t\tmap[row][col-1] == emblem[1][0] && map[row][col] == emblem[1][1])pre_num++;\n\t\t\t}\n\n\t\t\tif(row-1 >= 0 && col+1 <= W-1){\n\t\t\t\tif(map[row-1][col] == emblem[0][0] && map[row-1][col+1] == emblem[0][1] &&\n\t\t\t\t\t\t\t\t\t\tmap[row][col] == emblem[1][0] && map[row][col+1] == emblem[1][1])pre_num++;\n\t\t\t}\n\n\t\t\tif(row+1 <= H-1 && col-1 >= 0){\n\t\t\t\tif(map[row][col-1] == emblem[0][0] && map[row][col] == emblem[0][1] &&\n\t\t\t\t\t\t\tmap[row+1][col-1] == emblem[1][0] && map[row+1][col] == emblem[1][1])pre_num++;\n\t\t\t}\n\n\t\t\tif(row+1 <= H-1 && col+1 <= W-1){\n\t\t\t\tif(map[row][col] == emblem[0][0] && map[row][col+1] == emblem[0][1] &&\n\t\t\t\t\t\t\tmap[row+1][col] == emblem[1][0] && map[row+1][col+1] == emblem[1][1])pre_num++;\n\t\t\t}\n\n\t\t\tfor(int i = 0; i < 3; i++){\n\n\t\t\t\tmap[row][col] = array[i];\n\n\t\t\t\ttmp_num = 0;\n\n\t\t\t\tif(row-1 >= 0 && col-1 >= 0){\n\t\t\t\t\tif(map[row-1][col-1] == emblem[0][0] && map[row-1][col] == emblem[0][1] &&\n\t\t\t\t\t\t\tmap[row][col-1] == emblem[1][0] && map[row][col] == emblem[1][1])tmp_num++;\n\t\t\t\t}\n\n\t\t\t\tif(row-1 >= 0 && col+1 <= W-1){\n\t\t\t\t\tif(map[row-1][col] == emblem[0][0] && map[row-1][col+1] == emblem[0][1] &&\n\t\t\t\t\t\t\t\t\t\t\tmap[row][col] == emblem[1][0] && map[row][col+1] == emblem[1][1])tmp_num++;\n\t\t\t\t}\n\n\t\t\t\tif(row+1 <= H-1 && col-1 >= 0){\n\t\t\t\t\tif(map[row][col-1] == emblem[0][0] && map[row][col] == emblem[0][1] &&\n\t\t\t\t\t\t\t\tmap[row+1][col-1] == emblem[1][0] && map[row+1][col] == emblem[1][1])tmp_num++;\n\t\t\t\t}\n\n\t\t\t\tif(row+1 <= H-1 && col+1 <= W-1){\n\t\t\t\t\tif(map[row][col] == emblem[0][0] && map[row][col+1] == emblem[0][1] &&\n\t\t\t\t\t\t\t\tmap[row+1][col] == emblem[1][0] && map[row+1][col+1] == emblem[1][1])tmp_num++;\n\t\t\t\t}\n\n\t\t\t\tmax_add = max(max_add,tmp_num-pre_num);\n\n\t\t\t}\n\n\t\t\tmap[row][col] = pre_char;\n\t\t}\n\t}\n\n\n\tprintf(\"%d\\n\",base+max_add);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint dy[] = {0, 0, 1, 1};\nint dx[] = {0, 1, 0, 1};\nint H, W;\nchar mas[1005][1005];\nchar data[4];\nchar ch[] = \"JOI\";\nint calc(int y, int x)\n{\n    int cnt = 0;\n    for(int i = 0; i < 4; i++) {\n        int sy = y - 1 + dy[i], sx = x - 1 + dx[i];\n        bool flag = true;\n        if(sy < 0 || sx < 0 || sy >= H - 1 || sx >= W - 1) continue;\n        for(int j = 0; j < 4; j++) {\n            if(data[j] != mas[sy + dy[j]][sx + dx[j]]) flag = false;\n        }\n        if(flag) cnt++;\n    }\n    return (cnt);\n}\nint main()\n{\n    cin >> H >> W;\n    for(int i = 0; i < H; i++) {\n        for(int j = 0; j < W; j++) {\n            cin >> mas[i][j];\n        }\n    }\n    for(int i = 0; i < 4; i++) cin >> data[i];\n    int old = 0;\n    for(int i = 0; i < H - 1; i++) {\n        for(int j = 0; j < W - 1; j++) {\n            bool flag = true;\n            for(int k = 0; k < 4; k++) {\n                if(data[k] != mas[i + dy[k]][j + dx[k]]) flag = false;\n            }\n            if(flag) old++;\n        }\n    }\n    int plus = 0;\n    for(int i = 0; i < H; i++) {\n        for(int j = 0; j < W; j++) {\n            for(int k = 0; k < 3; k++) {\n                char temp = mas[i][j];\n                int a, b;\n                a = calc(i, j);\n                mas[i][j] = ch[k];\n                b = calc(i, j);\n                mas[i][j] = temp; \n                plus = max(plus, b - a);\n            }\n        }\n    }\n    cout << old + plus << endl;\n    return (0);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1005][1005],pat[5][5];\nint n,m;\nstring ch=\"JOI\";\n\nbool match(int x,int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>0 && ny>0)res+=match(nx,ny);\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      if(match(j,i))res+=1;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<n;i++){    \n     for(int j=0;j<m;j++){\n       char tmp=g[i][j];\n\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> n >> m;\n  \n  fill(g[0],g[1005],NULL);\n  fill(pat[0],pat[5],NULL);\n\n  for(int i=0;i<n;i++){\n    cin >> g[i];\n  }\n\n  for(int i=0;i<2;i++){\n    cin >> pat[i];\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring a[1010], b[2];\nbool same[1010][1010];\n\nbool check(int si, int sj) {\n  for (int i = 0; i < 2; i++) {\n    for (int j = 0; j < 2; j++) {\n      if (a[si + i][sj + j] == b[i][j]) continue;\n      return false;      \n    }\n  }\n  return true;\n}\n\nint main(void) {\n  int m, n;\n  cin >> m >> n;\n\n  for (int i = 0; i < m; i++) {\n    cin >> a[i];\n  }\n  for (int i = 0; i < 2; i++) {\n    cin >> b[i];\n  }\n\n  int cnt1 = 0;\n  for (int i = 0; i + 1 < m; i++) {\n    for (int j = 0; j + 1 < n; j++) {\n      same[i][j] = check(i, j);\n      cnt1 += same[i][j];\n    }\n  }\n\n  string ord = \"JOI\";\n  int di[] = {-1, -1, 0, 0}, dj[] = {-1, 0, -1, 0};\n  int ans = cnt1;\n  for (int i = 0; i < m; i++) {\n    for (int j = 0; j < n; j++) {\n      for (int k = 0; k < 3; k++) {\n        if (a[i][j] == ord[k]) continue;\n        int cnt2 = cnt1;\n        char tmp = a[i][j];\n        a[i][j] = ord[k];\n        for (int l = 0; l < 4; l++) {\n          int ni = i + di[l], nj = j + dj[l];\n          if (ni >= 0 && ni < m && nj >=0 && nj < n) {\n            if (same[ni][nj]) cnt2--;\n            else cnt2 += check(ni, nj);\n          }\n        }\n        a[i][j] = tmp;\n        ans = max(ans, cnt2);\n      }\n    }\n  }\n\n  cout << ans << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\nusing namespace std;\nint h,w,total=0,maxm=0;\nstring ss[1002],sa[2];\nstring a=\"JOI\";\nbool c(int x,int y){\n\tif(x<h&&y<w){\n\tif(ss[x][y]==sa[0][0]&&ss[x+1][y]==sa[1][0]&&ss[x][y+1]==sa[0][1]&&ss[x+1][y+1]==sa[1][1])return true;\n\t}\n\treturn false;\n}\nint main()\n{\n\tscanf(\"%d%d\",&h,&w);\n\tfor(int i=0;i<h;i++){\n\t\tcin >> ss[i];\n\t\tss[i]+=\"K\";\n\t}\n\tfor(int i=0;i<=w;i++)ss[h]+=\"K\";\n\tcin >> sa[0] >> sa[1];\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(c(i,j))total++;\n\t\t}\n\t}\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tint A=c(i+1,j+1)+c(i,j)+c(i+1,j)+c(i,j+1);\n\t\t\tstring sx;\n\t\t\tsx+=ss[i+1][j+1];\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tss[i+1][j+1]=a[k];\n\t\t\t\tint b=c(i+1,j+1)+c(i,j)+c(i,j+1)+c(i+1,j);\n\t\t\t\tmaxm=max(maxm,b-A);\n\t\t\t}\n\t\t\tss[i+1][j+1]=sx[0];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",total+maxm);\n\n}"
  },
  {
    "language": "C++",
    "code": "class in{struct myIterator{int it;const bool rev;explicit constexpr myIterator(int it_, bool rev=false):it(it_),rev(rev){}int operator*(){return it;}bool operator!=(myIterator& r){return it!=r.it;}void operator++(){rev?--it:++it;}};const myIterator i,n;public:explicit constexpr in(int n):i(0),n(n){}explicit constexpr in(int i,int n):i(i,n<i),n(n){}const myIterator& begin(){return i;}const myIterator& end(){return n;}};\n\n#include <bits/stdc++.h>\nusing namespace std;\nint score[1000][1000][3];\nconst string JOI = \"JOI\";\nint main() {\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int n, m;\n    cin >> n >> m;\n    vector<string> fld(n);\n    for(auto& x : fld) cin >> x;\n    vector<string> joi(2);\n    for(auto& x : joi) cin >> x;\n    int sum = 0;\n    for(int i : in(n - 1)) for(int j : in(m - 1)) {\n        int cnt = 0, cx = 0, cy = 0;\n        for(int y : in(2)) for(int x : in(2)) {\n            char aim = fld[i + y][j + x];\n            if(aim == joi[y][x])\n              ++cnt;\n            else\n              cy = y, cx = x;\n        }\n        if(cnt == 4) {\n            ++sum;\n            for(int y : in(i, i + 2))\n              for(int x : in(j, j + 2))\n                for(int k : in(3))\n                  if(fld[y][x] != JOI[k])\n                    --score[y][x][k];\n        }\n        else if(cnt == 3) {\n            int kk = 0;\n            for(int k : in(3))\n              if(JOI[k] == joi[cy][cx])\n                kk = k;\n            ++score[cy + i][cx + j][kk];\n        }\n    }\n    int ma = 0;\n    for(int i : in(n)) for(int j : in(m)) for(int k : in(3))\n      ma = max(ma, score[i][j][k]);\n    cout << sum + ma << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\nstring emblem[1100];\nstring test[2];\nint n,m,sum=0;\nint check(int y,int x){\n  if(y<0 || n-1<=y ||\n     x<0 || m-1<=x)return 0;\n  \n    for(int i=0;i<2;i++){\n      for(int j=0;j<2;j++){\n\tif(test[i][j]!=emblem[y+i][x+j])\n\t  return 0;\n      }\n    }\n    return 1;\n}\n\nint main(){\n  char c[3]={'J','O','I'};\n  cin>>n>>m;\n  for(int i=0;i<n;i++)cin>>emblem[i];\n  for(int i=0;i<2;i++)cin>>test[i];\n\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      sum+=check(i,j);\n    }\n  }\n  int ans=sum;\n  for(int i=0;i<3;i++){\n    for(int j=0;j<n;j++){\n      for(int k=0;k<m;k++){\n\tint plus=0;\n\tplus-=check(j,k);\n\tplus-=check(j-1,k);\n\tplus-=check(j,k-1);\n\tplus-=check(j-1,k-1);\n\t//cout << \"j:\" << j << \" k:\" << k << \" plus:\" << plus << endl;\n\n\tchar tmp=emblem[j][k];\n\temblem[j][k]=c[i];\n\tplus+=check(j,k);\n\tplus+=check(j-1,k);\n\tplus+=check(j,k-1);\n\tplus+=check(j-1,k-1);\n\temblem[j][k]=tmp;\n\t//cout << \"j:\" << j << \" k:\" << k << \" plus:\" << plus << endl;\n\tans=max(ans,sum+plus);\n      }\n    }\n  }\n  cout << ans << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<queue>\n#include<map>\nusing namespace std;\ntypedef pair<int,int> P;\nmain(){\n  int n,m;\n  char masu[1001][1001];\n  int mem[1001][1001]={0};\n  int mem2[1001][1001]={0};\n  char monsyou[3][3];\n  int before=0,after=0;\n  char joi[3]={'J','O','I'};\n  int ihu[4]={-1,-1,0,0};\n  int jhu[4]={-1,0,-1,0};\n  int imu[4]={-1,-1,0,0};\n  int jmu[4]={0,1,0,1};\n  int ihs[4]={0,0,1,1};\n  int jhs[4]={-1,0,-1,0};\n  int ims[4]={0,0,1,1};\n  int jms[4]={0,1,0,1};\n  queue<P> q;\n  cin>>n>>m;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      cin>>masu[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      for(int k=0;k<4;k++){\n\tif(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t  before=before+1;\n\t  mem[i][j]=mem[i][j]+1;\n\t}\n      }\n    }\n  }\n  before=before/4;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<m;j++){\n      char kioku;\n      kioku=masu[i][j];\n      for(int a=0;a<3;a++){\n\tif(masu[i][j]!=joi[a]){\n\t  masu[i][j]=joi[a];\n\t  for(int k=0;k<4;k++){\n\t    if(masu[i+ihu[k]][j+jhu[k]]==monsyou[0][0]&&masu[i+imu[k]][j+jmu[k]]==monsyou[0][1]&&masu[i+ihs[k]][j+jhs[k]]==monsyou[1][0]&&masu[i+ims[k]][j+jms[k]]==monsyou[1][1]){\n\t      mem2[i][j]=mem[i][j]+1;\n\t    }\n\t  }\n\t  masu[i][j]=kioku;\n\t}\n\tif(mem2[i][j]-mem[i][j]>after){\n\t  after=mem2[i][j]-mem[i][j];\n\t}\n      }\t\n    }\n  }\n  cout<<before+after<<endl;\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cmath>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n    int H,W;\n    int ans=0,maxans=0;\n    string fie[1002],ansfie[2];\n    cin>>H>>W;\n    for(int i=0;i<H;i++)cin>>fie[i];\n    for(int i=0;i<2;i++)cin>>ansfie[i];\n    for(int i=0;i<H-1;i++){\n        for(int j=0;j<W-1;j++){\n            if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])ans++;\n        }\n    }\n    cout<<ans<<endl;\n    for(int i=0;i<H;i++){\n        for(int j=0;j<W;j++){\n            for(int k=0;k<3;k++){\n                int a=0,b=0;\n                char p;\n                if(k==0)p='J';\n                if(k==1)p='O';\n                if(k==2)p='I';\n                if(i!=H-1&&j!=W-1){\n                    if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])a++;\n                    if(p==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=W-1){\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&fie[i][j]==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])a++;\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&p==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=H-1&&j!=0){\n                    if(fie[i][j-1]==ansfie[0][0]&&fie[i][j]==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])a++;\n                    if(fie[i][j-1]==ansfie[0][0]&&p==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=0){\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&fie[i][j]==ansfie[1][1])a++;\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&p==ansfie[1][1])b++;\n                }\n                maxans=max(maxans,ans+b-a);\n            }\n        }\n    }\n    cout<<maxans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int MAX_M = 1000, MAX_N = 1000;\nstring flag[MAX_M];\nstring Emb[2];\n\nbool lu(int i, int j){ return flag[i][j] == Emb[0][0]; }\nbool ru(int i, int j){ return flag[i][j + 1] == Emb[0][1]; }\nbool ld(int i, int j){ return flag[i + 1][j] == Emb[1][0]; }\nbool rd(int i, int j){ return flag[i + 1][j + 1] == Emb[1][1]; }\n\nint main(){\n\tint M, N;\n\tint table[MAX_M][MAX_N];\n\tint res, plus, n;\n\tfor(int i = 0; i < MAX_M; i++){\n\t\tfor(int j = 0; j < MAX_N; j++){\n\t\t\ttable[i][j] = 0;\n\t\t}\n\t}\n\t\n\tcin >> M >> N;\n\tfor(int i = 0; i < M; i++){\n\t\tcin >> flag[i];\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tcin >> Emb[i];\n\t}\n\t\n\tres = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tif(lu(i, j) && ru(i, j) && ld(i, j) && rd(i, j)) res++;\n\t\t\telse{\n\t\t\t\tif(ru(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 1;\n\t\t\t\telse if(lu(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 2;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && rd(i, j)) table[i][j] = 3;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && ld(i, j)) table[i][j] = 4;\n\t\t\t\telse table[i][j] = -1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tplus = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tn = 0;\n\t\t\tif(table[i][j] == 1){\n\t\t\t\tn = 1;\n\t\t\t\tif(j > 0){\n\t\t\t\t\tif(table[i][j - 1] == 2 && Emb[0][0] == Emb[0][1]) n++;\n\t\t\t\t\telse if(table[i][j - 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i > 0){\n\t\t\t\t\tif(table[i - 1][j] == 3 && Emb[0][0] == Emb[1][0]) n++;\n\t\t\t\t\telse if(table[i - 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i > 0 && j > 0){\n\t\t\t\t\tif(table[i - 1][j - 1] == 3 && Emb[0][0] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i - 1][j - 1] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(table[i][j] == 2){\n\t\t\t\tn = 1;\n\t\t\t\tif(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 1 && Emb[0][0] == Emb[0][1]) n++;\n\t\t\t\t\telse if(table[i][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i > 0 && j < N - 2){\n\t\t\t\t\tif(table[i - 1][j + 1] == 3 && Emb[1][0] == Emb[0][1]) n++;\n\t\t\t\t\telse if(table[i][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i > 0){\n\t\t\t\t\tif(table[i - 1][j] == 4 && Emb[1][1] == Emb[0][1]) n++;\n\t\t\t\t\telse if(table[i - 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(table[i][j] == 3){\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 1 && Emb[0][0] == Emb[1][0]) n++;\n\t\t\t\t\telse if(table[i + 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(j > 0 && i < M - 2){\n\t\t\t\t\tif(table[i + 1][j - 1] == 2 && Emb[0][1] == Emb[1][0]) n++;\n\t\t\t\t\telse if(table[i + 1][j - 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(j > 0){\n\t\t\t\t\tif(table[i][j - 1] == 4 && Emb[1][1] == Emb[1][0]) n++;\n\t\t\t\t\telse if(table[i][j - 1] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(table[i][j] == 4){\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2 && j < N - 2){\n\t\t\t\t\tif(table[i + 1][j + 1] == 1 && Emb[0][0] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i + 1][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 2 && Emb[0][1] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i + 1][j] == 0) n--;\n\t\t\t\t}\n\t\t\t\tif(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3 && Emb[1][0] == Emb[1][1]) n++;\n\t\t\t\t\telse if(table[i][j + 1] == 0) n--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tplus = max(plus, n);\n\t\t}\n\t}\n\t\n\tcout << res + plus << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nchar map[1001][1001];\nchar sign[2][2];\n\nint main(){\n\n\tint max = 0;\n\n\tint m, n;\n\tstd::cin >> m >> n;\n\n\tfor (int i = 0; i < m; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tstd::cin >> map[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tstd::cin >> sign[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < m - 1; i++){\n\t\tfor (int j = 0; j < n - 1; j++){\n\t\t\tbool flg = true;\n\t\t\tfor (int k = 0; k < 2; k++){\n\t\t\t\tfor (int l = 0; l < 2; l++){\n\t\t\t\t\tif (map[i + k][j + l] != sign[k][l])flg = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (flg)max++;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < m; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tint cnt = 0;\n\t\t\tint bnt = 0;\n\t\t\tchar bef = map[i][j];\n\t\t\tfor (int k = 0; k < 4; k++){\n\t\t\t\tif (k == 1)map[i][j] = 'J';\n\t\t\t\tif (k == 2)map[i][j] = 'O';\n\t\t\t\tif (k == 3)map[i][j] = 'I';\n\n\t\t\t\tint a = 0;\n\t\t\t\tfor (int l = -1; l < 1; l++){\n\t\t\t\t\tfor (int q = -1; q < 1; q++){\n\t\t\t\t\t\tif (i + l < 0 || i + l + 1 >= m)continue;\n\t\t\t\t\t\tif (j + q < 0 || j + q + 1 >= n)continue;\n\n\t\t\t\t\t\tbool flg = true;\n\t\t\t\t\t\tfor (int o = 0; o < 2; o++){\n\t\t\t\t\t\t\tfor (int p = 0; p < 2; p++){\n\t\t\t\t\t\t\t\tif (map[i + l + o][j + q + p] != sign[o][p])flg = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flg)a++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (k == 0)bnt = a;\n\t\t\t\telse cnt = std::max(cnt, a);\n\n\t\t\t\tmap[i][j] = bef;\n\t\t\t}\n\n\t\t\tmax = std::max(max, max + (cnt - bnt));\n\t\t}\n\t}\n\n\tstd::cout << max << std::endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define PB push_back\n#define PPB pop_back\ntypedef pair<int, int> pii;\nstatic const int INF = 1LL<<61;\n\nint grid[1005][1005], m, n, mo[2][2], dx[] = {0, 1, 1, 0}, dy[] = {0, 0, 1, 1};\n\ninline int get(char t) {\n  switch (t) {\n    case 'J':\n      return 1;\n    case 'O':\n      return 2;\n    case 'I':\n      return 3;\n  }\n}\n\n\nsigned main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  cin >> m >> n;\n  for (int y = 1; y <= m; ++y) {\n    string t;\n    cin >> t;\n    for (int x = 1; x <= n; ++x) {\n      grid[x][y] = get(t[x - 1]);\n    }\n  }\n\n  for (int y = 0; y < 2; ++y) {\n    string t;\n    cin >> t;\n    for (int x = 0; x < 2; ++x) {\n      mo[x][y] = get(t[x]);\n    }\n  }\n\n  int base = 0, addi = 0;\n\n  for (int y = 1; y <= m; ++y) {\n    for (int x = 1; x <= n; ++x) {\n      {\n        bool flg = true;\n        for (int j = 0; j < 4; ++j) {\n          flg = flg && grid[x + dx[j]][y + dy[j]] == mo[dx[j]][dy[j]];\n          if (!flg) break;\n        }\n        if (flg) base++;\n      }\n\n      int pre = grid[x][y], tmax = 0;\n      for (int i = 1; i <= 3; ++i) {\n        if (pre == i) continue;\n        grid[x][y] = i;\n        int temp = 0;\n\n        for (int j = 0; j < 4; ++j) {\n          bool flg = true;\n          for (int k = 0; k < 4; ++k) {\n            flg = flg && grid[x + dx[k] - dx[j]][y + dy[k] - dy[j]] == mo[dx[k]][dy[k]];\n            if (!flg) break;\n          }\n          if (!flg) continue;\n\n          temp++;\n        }\n\n        tmax = max(tmax, temp);\n      }\n      grid[x][y] = pre;\n\n      addi = max(tmax, addi);\n    }\n  }\n\n  cout << base + addi << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nchar field[1145][1145];\nchar JOI[2][2];\n\nbool WithinRange(int y, int x) {\n  if (y < 0 || H <= y) return false;\n  if (x < 0 || W <= x) return false;\n  return true;\n}\n\nbool IsJoi(int y, int x) {\n  if (!WithinRange(y+1, x+1)) return false;\n  \n  int cnt = 0;\n  for (int i=0; i<2; ++i) {\n    for (int j=0; j<2; ++j) {\n      cnt += field[y+i][x+j] == JOI[i][j];\n    }\n  }\n  return cnt == 4;\n}\n\nint GetAround(int y, int x) {\n  int ret = 0;\n  for (int i=0; i<2; ++i) {\n    for (int j=0; j<2; ++j) {\n      int ny = y-i;\n      int nx = x-j;\n      if (!WithinRange(ny, nx)) continue;\n      ret += IsJoi(ny, nx);\n    }\n  }\n  return ret;\n}\n\nint main() {\n  scanf(\"%d%d\", &H, &W);\n  for (int i=0; i<H; ++i) {\n    for (int j=0; j<W; ++j) {\n      scanf(\" %c\", &field[i][j]);\n    }\n  }\n\n  for (int i=0; i<2; ++i) {\n    for (int j=0; j<2; ++j) {\n      scanf(\" %c\", &JOI[i][j]);\n    }\n  }\n\n  int def = 0;\n  for (int i=0; i<H; ++i) {\n    for (int j=0; j<W; ++j) {\n      def += IsJoi(i, j);\n    }\n  }\n\n  int ans = def;\n  for (int i=0; i<H; ++i) {\n    for (int j=0; j<W; ++j) {\n      char pres = field[i][j];\n      int p = GetAround(i, j);\n      for (int k=0; k<3; k++) {\n        field[i][j] = \"JOI\"[k];\n        int n = GetAround(i, j);\n        ans = max(ans, def-p+n);\n      }\n      field[i][j] = pres;\n    }\n  }\n  printf(\"%d\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for(int i=0; i<(int)(n); ++i)\n\nusing namespace std;\n\nint main(){\n    int H, W;\n    cin >> H >> W;\n    vector<string> flag(H);\n    REP(y, H) cin >> flag[y];\n    string mark[2];\n    REP(i, 2) cin >> mark[i];\n\n    int base = 0;\n    REP(y, H - 1) REP(x, W - 1){\n        int cnt = 0;\n        REP(dy, 2) REP(dx, 2) cnt += flag[y + dy][x + dx] == mark[dy][dx];\n        if(cnt == 4) base++;\n    }\n\n    string JOI = \"JOI\";\n    int max_diff = 0;\n    REP(y, H) REP(x, W) for(char c : JOI) {\n        int diff = 0;\n        REP(sdy, 2) REP(sdx, 2) {\n            int sy = y - sdy;\n            int sx = x - sdx;\n            if(sx >= 0 && sx + 1 < W && sy >= 0 && sy + 1 < H) {\n                int cnt = 0;\n                REP(dy, 2) REP(dx, 2) cnt += flag[sy + dy][sx + dx] == mark[dy][dx];\n                if(cnt == 4) diff--;\n            }\n        }\n        char tmp = flag[y][x];\n        flag[y][x] = c;\n        REP(sdy, 2) REP(sdx, 2) {\n            int sy = y - sdy;\n            int sx = x - sdx;\n            if(sx >= 0 && sx + 1 < W && sy >= 0 && sy + 1 < H) {\n                int cnt = 0;\n                REP(dy, 2) REP(dx, 2) cnt += flag[sy + dy][sx + dx] == mark[dy][dx];\n                if(cnt == 4) diff++;\n            }\n        }\n        flag[y][x] = tmp;\n        max_diff = max(max_diff, diff);\n    }\n    cout << base + max_diff << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n \n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n \nusing namespace std;\n \nint H,W;\nchar G[1100][1100],JOI[2][2];\nint ok[1100][1100];\nint dx[] = {0,1,0,1};\nint dy[] = {0,0,1,1};\n \nint ndx[] = {1,0,1,0};\nint ndy[] = {1,1,0,0};\n \nchar Flag[3] = {'J','O','I'};\n \nbool isValid(int x,int y){ return 0 <= x && x < W && 0 <= y && y < H; }\n \nint main(){\n  scanf(\"%d %d\",&H,&W);\n  rep(i,H) rep(j,W){\n    cin >> G[i][j];\n    ok[i][j] = -1;\n  }\n  rep(i,2) rep(j,2) cin >> JOI[i][j];\n \n  int ans = 0;\n \n  rep(i,H)rep(j,W){\n    int res = -1;\n    int out = 0, op = -1;\n    rep(k,4){\n      int nx = j + dx[k], ny = i + dy[k];\n      if( !isValid(nx,ny) ) {\n        out = 100;\n        break;\n      }\n      if( JOI[dy[k]][dx[k]] != G[ny][nx] ) {\n        out++;\n        op = k + 1;\n      }\n    }\n    if( out == 0 ) res = 0, ++ans;\n    if( out == 1 ) res = op;\n    if( out >= 2 ) res = -1;\n    ok[i][j] = res;\n  }\n \n  int maxi = ans;\n  rep(y,H)rep(x,W){\n    rep(i,3){\n      int cost = ans;\n      int sx = x - 1, sy =  y - 1;\n      char c = Flag[i];\n      rep(j,4){\n        int nx = sx + dx[j], ny = sy + dy[j];\n        if( !isValid(nx,ny) ) continue;\n        if( ok[ny][nx] == -1 ) continue;\n        int nnx = nx + ndx[j], nny = ny + ndy[j];\n        if( !isValid(nnx,nny) ) continue;\n        if( ok[ny][nx] == 0 && G[nny][nnx] != JOI[ndy[j]][ndx[j]] ) {\n          cost--;\n          continue;\n        }\n        if( ( 1 <= ok[ny][nx] && ok[ny][nx] <= 4 ) ){ \n          int dir = ok[ny][nx] - 1;\n          int bx = nx + dx[dir], by = ny + dy[dir];\n          if( !isValid(bx,by) ) continue;\n          if( bx != nnx || by != nny ) continue;\n          if( c == JOI[dy[dir]][dx[dir]] ) cost++;\n        }\n      }\n      maxi = max(maxi,cost);\n    }\n  }\n  cout << maxi << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\nint M,N;\nchar E[2][2];\nchar b[4]={'S','J','O','I'};\n\nint main() {\n\n\tcin>>M>>N;\n\tfor(int i=1; i<M+1; i++){\n\t\tfor(int j=1; j<N+1; j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0; i<2; i++){\n\t\tfor(int j=0; j<2; j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a = 0;\n\tfor(int i=1; i<M; i++){//何も変えなかったとき\n\t\tfor(int j=1; j<N; j++){\n\t\t\tif(D[i][j]==E[0][0] && D[i][j+1]==E[0][1] && D[i+1][j]==E[1][0] && D[i+1][j+1]==E[1][1])a += 1;\n\t\t}\n\t}\n\n\tint c[4];\n\tint R = 0;\n\tfor(int i=1; i<M+1; i++){//一文字変えたとき\n\t\tfor(int j=1; j<N+1; j++){\n\n\t\t\tb[0] = D[i][j];\n\n\t\t\tfor(int k=0; k<4; ++k){\n\n\t\t\t\tD[i][j] = b[k];\n\n\t\t\t\tc[k] = 0;\n\t\t\t\tif(D[i][j]==E[0][0]     && D[i][j+1]==E[0][1]   && D[i+1][j]==E[1][0]   && D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]   && D[i][j]==E[0][1]     && D[i+1][j-1]==E[1][0] && D[i+1][j]==E[1][1])  c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0] && D[i-1][j]==E[0][1]   && D[i][j-1]==E[1][0]   && D[i][j]==E[1][1])    c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]   && D[i-1][j+1]==E[0][1] && D[i][j]==E[1][0]     && D[i][j+1]==E[1][1])  c[k]+=1;\n\t\t\t}\n\n\t\t\tD[i][j] = b[0];\n\n\t\t\tR = max(R,a+c[1]-c[0]);\n\t\t\tR = max(R,a+c[2]-c[0]);\n\t\t\tR = max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\tcout<<R<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\nusing ll = long long;\n#define rep(i, n) for (int i = 0; i < (int)n; i++)\n\nint M, N;\nchar joi[1003][1003];\nchar c[2][2];\nbool ok(int y, int x) {\n    if (y + 1 >= M || x + 1 >= N) return 0;\n    if (y < 0 || x < 0) return 0;\n    int ys[] = {0, 0, 1, 1};\n    int xs[] = {0, 1, 0, 1};\n    rep(i, 4) {\n        if (c[ys[i]][xs[i]] != joi[y + ys[i]][x + xs[i]]) {\n            return 0;\n        }\n    }\n    return 1;\n}\nvoid show() {\n    rep(y, M) {\n        rep(x, N) cout << joi[y][x] << \" \";\n        cout << endl;\n    }\n    cout << endl;\n}\nbool valid(int y, int x) {\n    if (y < 0 || x < 0) return 0;\n    if (y >= M || x >= N) return 0;\n    return 1;\n}\nbool f[1003][1003];\nint main() {\n    cin >> M >> N;\n    rep(i, M) rep(j, N) { cin >> joi[i][j]; }\n    rep(i, 2) rep(j, 2) cin >> c[i][j];\n    int ans = 0;\n    rep(y, M) rep(x, N) {\n        if (ok(y, x)) ans++;\n        f[y][x] = ok(y, x);\n        // printf(\"%d %d %d\\n\",y,x,ok(y,x));\n    }\n\n    string logo = \"JOI\";\n    int maxi = 0;\n    rep(y, M) rep(x, N) {\n        char tmp = joi[y][x];\n        rep(k, logo.size()) {\n            int cnt = 0;\n            joi[y][x] = logo[k];\n            // show();\n            for (int dy = -1; dy <= 1; dy++)\n                for (int dx = -1; dx <= 1; dx++) {\n                    if (!valid(y + dy, x + dx)) continue;\n                    if (ok(y + dy, x + dx)) {\n                        if (!f[y + dy][x + dx]) cnt++;\n                    } else {\n                        if (f[y + dy][x + dx]) cnt--;\n                    }\n                }\n            //printf(\"%d %d %c: %d\\n\", y, x, logo[k], cnt);\n            maxi = max(maxi, cnt);\n            joi[y][x] = tmp;\n        }\n    }\n\n    cout << ans + maxi << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <array>\n#include <cstdlib>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n\ntemplate<class T> inline void chmax(T &a, const T &b) { if(a < b) a = b; }\n\nconstexpr int EMBLEM_SIZE = 2;\nbool out(int x, int y, int w, int h) {\n\treturn x < 0 || y < 0 || x >= w || y >= h;\n}\n\nbool check(int x, int y, const vector<string> &flag, const array<string, 2> &emblem) {\n\trep(i, EMBLEM_SIZE) {\n\t\trep(j, EMBLEM_SIZE) {\n\t\t\tif(flag[y + i][x + j] != emblem[i][j]) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint main() {\n\tconstexpr int dx[] = {-1, 0, -1, 0};\n\tconstexpr int dy[] = {-1, -1, 0, 0};\n\tconst string JOI = \"JOI\";\n\n\tint h, w;\n\tcin >> h >> w;\n\n\tvector<string> flag(h);\n\tfor(auto &e : flag) cin >> e;\n\n\tarray<string, EMBLEM_SIZE> emblem;\n\tfor(auto &e : emblem) cin >> e;\n\n\tvector<vector<bool>> match(h - 1, vector<bool>(w - 1, 0));\n\tint sum = 0;\n\n\trep(y, h - 1) {\n\t\trep(x, w - 1) {\n\t\t\tif(check(x, y, flag, emblem)) {\n\t\t\t\tmatch[y][x] = true;\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\trep(y, h) {\n\t\trep(x, w) {\n\t\t\tfor(const auto &c : JOI) {\n\t\t\t\tconst char tmp = flag[y][x];\n\t\t\t\tflag[y][x] = c;\n\n\t\t\t\tint num = sum;\n\t\t\t\trep(d, 4) {\n\t\t\t\t\tconst int nx = x + dx[d];\n\t\t\t\t\tconst int ny = y + dy[d];\n\t\t\t\t\tif(out(nx, ny, w, h) || out(nx + 1, ny + 1, w, h)) continue;\n\t\t\t\t\tnum += check(nx, ny, flag, emblem) - match[ny][nx];\n\t\t\t\t}\n\n\t\t\t\tchmax(ans, num);\n\t\t\t\tflag[y][x] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1010][1010];\nchar crest[8][8];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 0 || y < 0 || x + 1 >= W || y + 1 >= H) return 0;\n  for(int stage_y = y,crest_y = 0; stage_y <= y + 1; stage_y++,crest_y++){\n    for(int stage_x = x,crest_x = 0; stage_x <= x + 1; stage_x++,crest_x++){\n      if(stage[stage_y][stage_x] == crest[crest_y][crest_x]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      string line;\n      cin >> line;\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          int tmp = match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1);\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - tmp + (match(x,y) + match(x-1,y) + match(x,y-1) + match(x-1,y-1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#define INF 999999999\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nint m, n;\nchar f[1050][1050];\nchar em[3][3];\n\nchar flag[4] = { 'J','O','I' };\n\nbool emblem(int i,int j)\n{\n\tif (f[i][j] == em[0][0]) {\n\t\tif (f[i][j + 1] == em[0][1]) {\n\t\t\tif (f[i + 1][j] == em[1][0]) {\n\t\t\t\tif (f[i + 1][j + 1] == em[1][1]) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n\nint fchange(char a,int i,int j)\n{\n\tchar b = f[i][j];\n\tf[i][j] = a;\n\n\tint res = 0;\n\n\tint plus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\tf[i][j] = b;\n\tint minus = emblem(i - 1, j - 1) + emblem(i - 1, j) + emblem(i, j - 1) + emblem(i, j);\n\n\tcout << \"plus:\" << plus << \"minus\" << minus << endl;\n\treturn plus - minus;\n\n}\n\nint main()\n{\n\tcin >> m >> n;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tcin >> f[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> em[i][j];\n\t\t}\n\t}\n\n\tint num = 0;\n\tvector<P> change;\n\n\tfor (int i = 1; i <= n - 1; i++) {\n\t\tfor (int j = 1; j <= n - 1; j++) {\n\t\t\tint lu = 0, ru = 0, ll = 0, rl = 0;\n\t\t\tif (f[i][j] == em[0][0])lu = 1;\n\t\t\tif (f[i][j + 1] == em[0][1])ru = 1;\n\t\t\tif (f[i + 1][j] == em[1][0])ll = 1;\n\t\t\tif (f[i + 1][j + 1] == em[1][1])rl = 1;\n\n\t\t\tif (lu + ru + ll + rl == 4) {\n\t\t\t\tnum++;\n\t\t\t}\n\t\t\telse if (lu + ru + ll + rl == 3) {\n\t\t\t\tif (lu == 0)change.push_back(P(i, j));\n\t\t\t\tif (ru == 0)change.push_back(P(i, j + 1));\n\t\t\t\tif (ll == 0)change.push_back(P(i + 1, j));\n\t\t\t\tif (rl == 0)change.push_back(P(i + 1, j + 1));\n\t\t\t}\n\n\t\t}\n\t}\n\tcout << \"num:\" << num << endl;\n\n\tint max = 0;\n\tfor (int i = 0; i < change.size(); i++) {\n\t\t//cout << \"change:\"<<change[i].first << change[i].second << endl;\n\t\tint imax = 0;\n\t\tfor(int j = 0; j < 3; j++) {\n\t\t\tint k = fchange(flag[j], change[i].first, change[i].second);\n\t\t\tif (k > imax)imax = k;\n\t\t}\n\t\tif (imax > max)max = imax;\n\t}\n\n\tcout << num + max << endl;\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n \nint main()\n{\n    int a, b;\n    cin >>a>>b;\n    char a11, a12, a21, a22, x[1010][1010], y;\n    int j=0;\n    for (int k=0; k<a; k++)\n    {\n        for (int l=0; l<b; l++)\n        {\n            cin >> x[k][l];\n        }\n    }\n    cin >>a11>>a12>>a21>>a22;\n    for (int k=0; k<a-1; k++)\n    {\n        for (int l=0; l<b-1; l++)\n        {\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            j+=1;\n        }\n    }\n    int q=j;\n    int m, n, p;\n    for (int k=0; k<a; k++)\n    {\n        for (int l=0; l<b; l++)\n        {\n            y=x[k][l];\n            m=0;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            m+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            m+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            m+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            m+=1;\n            n=0;\n            x[k][l]=a11;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(m, n);\n            n=0;\n            x[k][l]=a12;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a21;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);\n            n=0;\n            x[k][l]=a22;\n            if ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n            n+=1;\n            if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n            n+=1;\n            if ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n            n+=1;\n            if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n            n+=1;\n            p=max(p, n);            \n            j=max(j, q+p-m);\n            x[k][l]=y;\n        }\n    }\n    cout <<j<<\"\\n\";\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define first F\n#define second S\ntypedef pair<int,int> P;\ntypedef vector<int> v;\nchar mas[1001][1001];\nchar haku[1001][1001];\nbool a[1001][1001];\nbool deki[1001][1001];\nint main(){\n  char key[2][2];\n  int N,M;\n  char mozi;\n  int cnt;\n  int ans=0;\n  cin>>M>>N;\n  memset(mas,0,sizeof(mas));\n  memset(haku,0,sizeof(haku));\n  for(int i=0;i<M;i++){\n    for(int j=0;j<N;j++){\n      cin>>mas[i][j];\n      haku[i][j]=mas[i][j];\n      a[i][j]=false;\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>key[i][j];\n    }\n  }\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      for(int k=0;k<2;k++){\n\tfor(int l=0;l<2;l++){\n\t  if(key[k][l]==mas[i+k][j+l]){\n\t    cnt++;\n\t  }\n\t}\n      }\n      if(cnt==4){\n\tans++;\n\tdeki[i][j]=deki[i+1][j+1]=deki[i+1][j]=deki[i][j+1]=true;\n      }else if(cnt==3){\n\ta[i][j]=true;\n      }\n    }\n  }\n  int cnnt=-111;\n  for(int i=0;i<M-1;i++){\n    for(int j=0;j<N-1;j++){\n      cnt=0;\n      if(a[i][j]){\n\tint x,y;\n\tfor(int k=0;k<2;k++){\n\t  for(int l=0;l<2;l++){\n\t    if(mas[i+k][j+l]!=key[k][l]){\n\t      haku[i+k][j+l]=key[k][l];\n\t      x=i+k;\n\t      y=j+l;\n\t      if(deki[i+k][j+l]){\n\t\tcnt--;\n\t      }\n\t      cnt++;\n\t    }\n\t  }\n\t}\n\tint mozicnt=0;\n\tif(i-1>=0 && j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(j-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i+k][j-1+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\tmozicnt=0;\n\tif(i-1>=0){\n\t  for(int k=0;k<2;k++){\n\t    for(int l=0;l<2;l++){\n\t      if(haku[i-1+k][j+l]==key[k][l]){\n\t\tmozicnt++;\n\t      }\n\t    }\n\t  }\n\t  if(mozicnt==4){\n\t    cnt++;\n\t  }\n\t}\n\thaku[x][y]=mas[x][y];\n      }\n      cnnt=max(cnnt,cnt);\n    }\n  }\n  ans+=cnnt;\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//家で書いたO(MN)、外周の変更時の数え上げも一括でできることが判明.\n//というか、なぜ本選でバグったし…、0点の割に解説内容が自分の考え\n//と全くいっしょだっだのがショック\n//実装：約30分\n#include <iostream>\nusing namespace std;\n\nint M,N;\nchar str1[1002],str2[4];\nint JOI[1002][1002],mon[2][2];\t//外周は0,Jは1,Oは2,Iは3であらわす。\nint data[1002][1002];\t\t\t//data[i][j]は左上(j,i)から紋章をいくつ作れるか(0or1)を記録\n\nint ctoi(char c){\n\tchar str[4] = \"JOI\";\n\tfor(int i = 0;i < 3;i++){\n\t\tif(c == str[i])\n\t\t\treturn i+1;\n\t}\n\treturn 0;\n}\nint make(int i,int j){\n\tfor(int a = 0;a < 2;a++){\n\t\tfor(int b = 0;b < 2;b++){\n\t\t\tif(JOI[i+a][j+b] != mon[a][b])\n\t\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}\nint new_makecount(int i,int j);\n\nint main(){\n\tint sum = 0,maxsum = 0;\n\tcin >> M >> N;\n\tfor(int i = 1;i <= M;i++){\n\t\tcin >> str1;\n\t\tfor(int j = 1;j <= N;j++){\n\t\t\tJOI[i][j] = ctoi(str1[j-1]);\t//マイナスを忘れるな！！\n\t\t}\n\t}\n\tfor(int i = 0;i < 2;i++){\n\t\tcin >> str2;\n\t\tfor(int j = 0;j < 2;j++){\n\t\t\tmon[i][j] = ctoi(str2[j]);\n\t\t}\n\t}\n\t//最初の数え上げ(monとの一致を調べる左上の座標が(j,i)である)\n\tfor(int i = 1;i <= M;i++){\n\t\tfor(int j = 1;j <= N;j++){\n\t\t\tdata[i][j] = make(i,j);\n\t\t\tsum += data[i][j];\n\t\t\t//cout << data[i][j] << \" \";\n\t\t}\n\t\t//cout<<endl;\n\t}\n\tmaxsum = sum;\n\tint delta;\t\t//紋章の数の増減\n\tint memo;\n\t//一つ変える\n\tfor(int i = 1;i <= M;i++){\n\t\tfor(int j = 1;j <= N;j++){\n\t\t\tmemo = JOI[i][j];\n\t\t\t//(j,i)を変えたときにどれだけ紋章が増えるのか\n\t\t\tdelta = new_makecount(i,j);\n\t\t\tif(maxsum < delta+sum){\n\t\t\t\tmaxsum = delta+sum;\n\t\t\t}\n\t\t\tJOI[i][j] = memo;\n\t\t}\n\t}\n\tcout << maxsum << endl;\n\treturn 0;\n}\nint new_makecount(int i,int j){\n\tint del,maxdel = -5;\n\tfor(int k = 1;k < 4;k++){\n\t\tJOI[i][j] = k;\n\t\tdel = 0;\n\t\tfor(int l = i-1;l < i+1;l++){\n\t\t\tfor(int m = j-1;m < j+1;m++){\n\t\t\t\tdel += make(l,m)-data[l][m];\n\t\t\t}\n\t\t}\n\t\tif(maxdel < del)\n\t\t\tmaxdel = del;\n\t}\n\treturn maxdel;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\nint W,H;\n\nint match(int x,int y){\n  int count = 0;\n  if(x < 1 || y < 1 || x + 1 > W || y + 1 > H) return 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4 ? 1 : 0);\n}\n\nint main(){\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    memset(stage,'\\0',sizeof(stage));\n    memset(crest,'\\0',sizeof(crest));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res += match(x,y);\n      }\n    }\n\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        dp[y][x] = match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1);\n      }\n    }\n\n    const char JOI[] = {'J','O','I'};\n    for(int y = 0; y < H; y++){\n      for(int x = 0; x < W; x++){\n        for(int char_i = 0; char_i < 3; char_i++){\n          char prev = stage[y][x];\n          stage[y][x] = JOI[char_i];\n          res = max(res,res - dp[y][x] + (match(x,y) + match(x+1,y) + match(x,y+1) + match(x+1,y+1)));\n          stage[y][x] = prev;\n        }\n      }\n    }\n    \n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nstd::string S[1000], T[2];\nconst int dx[4] = {0, 1, 0, 1}, dy[4] = {0, 0, 1, 1};\nint M, N;\n\nint f(int y, int x){\n    if(y < 0 || x < 0){return 0;}\n    if(y+1 >= M || x+1 >= N){return 0;}\n    for(int i=0;i<4;i++){\n        if(S[y+dy[i]][x+dx[i]] != T[dy[i]][dx[i]]){return 0;}\n    }\n    return 1;\n}\n\nint main(){\n    std::cin >> M >> N;\n\n    for(int i=0;i<M;i++){\n        std::cin >> S[i];\n    }\n\n    for(int i=0;i<2;i++){\n        std::cin >> T[i];\n    }\n\n    int count = 0;\n    for(int i=0;i+1<M;i++){\n        for(int j=0;j+1<N;j++){\n            count += f(i, j);\n        }\n    }\n\n    int res = count;\n    for(int i=0;i+1<M;i++){\n        for(int j=0;j+1<N;j++){\n            for(int k=0;k<3;k++){\n                int x = 0;\n                for(int l=0;l<4;l++){\n                    x -= f(i-dy[l], j-dx[l]);\n                }\n\n                char prev = S[i][j];\n                S[i][j] = \"JOI\"[k];\n\n                for(int l=0;l<4;l++){\n                    x += f(i-dy[l], j-dx[l]);\n                }\n\n                S[i][j] = prev;\n                \n                res = std::max(res, count + x);\n            }\n        }\n    }\n\n    std::cout << res << std::endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint search2(int x, int y){\n\tint c = search(x, y);\n\tcheck[y][x] = false;\n\tif(c == 4)\n\t\tres--;\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0 || ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx]);\n\t\t\t\t}\n\t\t\t\telse if(nx == 0 || nx == W - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx - 1]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = 1;\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\ts[ny][nx] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T> void chmin(T &a,T b){if(a>b) a=b;}\ntemplate<typename T> void chmax(T &a,T b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nsigned main(){\n  Int n,m;\n  cin>>n>>m;\n  vector<string> s(n);\n  for(Int i=0;i<n;i++) cin>>s[i];\n  vector<string> t(2);\n  for(Int i=0;i<2;i++) cin>>t[i];\n\n  auto calc=[&](Int y,Int x){\n    if(0<=y&&y+1<n&&0<=x&&x+1<m){\n      bool flg=1;\n      for(Int i=0;i<2;i++)\n\tfor(Int j=0;j<2;j++)\n\t  flg&=s[y+i][x+j]==t[i][j];\n      return flg;\n    }\n    return false;\n  };\n  \n  Int tmp=0;\n  for(Int i=0;i<n-1;i++)\n    for(Int j=0;j<m-1;j++)\n      tmp+=calc(i,j);\n\n  Int ans=tmp;\n  \n  string x=\"JOI\";\n  for(Int i=0;i<n;i++){\n    for(Int j=0;j<m;j++){\n      char c=s[i][j];\n      for(Int a=0;a<2;a++)\n\tfor(Int b=0;b<2;b++)\n\t  tmp-=calc(i-a,j-b);\n      for(auto y:x){\n\tInt res=tmp;\n\ts[i][j]=y;\n\tfor(Int a=0;a<2;a++)\n\t  for(Int b=0;b<2;b++)\n\t    res+=calc(i-a,j-b);\n\tchmax(ans,res);\n      }\n      s[i][j]=c;\n      for(Int a=0;a<2;a++)\n\tfor(Int b=0;b<2;b++)\n\t  tmp+=calc(i-a,j-b);\n      //cout<<i<<\" \"<<j<<\":\"<<tmp<<endl;\n    }\n  }\n  \n  cout<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int m,n;\n  char str[1000][1001],flag[5];\n  cin >> m >> n;\n  for(int i=0;i<m;i++){\n    scanf(\"%s\",str[i]);\n  }\n  scanf(\" %c %c %c %c\",&flag[0],&flag[1],&flag[2],&flag[3]);\n  int ans = 0,ma = 0;\n  int siro[1000][1000]={};\n  for(int i=0;i<m-1;i++){\n    for(int j=0;j<n-1;j++){\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tans++;\n      }\n      if(str[i][j]!=flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tsiro[i][j]++;\n\tma = max(ma,siro[i][j]);\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]!=flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]==flag[3]){\n\tsiro[i][j+1]++;\n\tma = max(ma,siro[i][j+1]);\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]!=flag[2] && str[i+1][j+1]==flag[3]){\n\tsiro[i+1][j]++;\n\tma = max(ma,siro[i+1][j]);\n      }\n      if(str[i][j]==flag[0] && str[i][j+1]==flag[1] && str[i+1][j]==flag[2] && str[i+1][j+1]!=flag[3]){\n\tsiro[i+1][j+1]++;\n\tma = max(ma,siro[i+1][j+1]);\n      }\n    }\n  }\n  cout << ans+ma << endl;\n  return (0);\n}"
  },
  {
    "language": "C++",
    "code": "//include----------------------------------------------------------------------------------------------------------------------\n#include <bits/stdc++.h>\n//using namespace--------------------------------------------------------------------------------------------------------------\nusing namespace std;\n\n//define-----------------------------------------------------------------------------------------------------------------------\n#define rep(i, n) for(int i = 0; i < (int)n; i++)\n#define FOR(i, s, n) for(int i = s; i < (int)n; i++)\n#define per(i, n) for(int i = n; i >= 0; i--)\n#define ROF(i, s, n) for(int i = s; i >= (int)n; i--)\n#define FORIT(i, A) for (auto i : A)\n#define PRINT(x) cout << (x) << \"\\n\"\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define EACH(i, n) for (__typeof((n).begin()) i = (n).begin(); i != (n).end(); ++i)\n#define SZ(a) int((a).size())\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n#define dump(x) cout << #x << \" = \" << (x) << \"\\n\";\n#define debug(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << \"\\n\";\n#define sq(n) (n) * (n)\n\n//typedef----------------------------------------------------------------------------------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef priority_queue<int> maxpq;\ntypedef priority_queue< int, vector<int>, greater<int> > minpq;\n//const------------------------------------------------------------------------------------------------------------------------\nstatic const double EPS = 1e-10;\nstatic const double PI = acos( -1.0 );\nstatic const int mod = 1000000007;\nstatic const int INF = 1 << 25;\nstatic const LL LL_INF = 1152921504606846976;\n//global-----------------------------------------------------------------------------------------------------------------------\nVS a;\nstring str;\nVS eb;\nint default_ans = 0;\nint diff_max = 0;\nint diff;\nchar b[1000];\nstring joi = \"JOI\";\nint n, m;\n//#define DEBUG\n//function-------------------------------------------------------------------------------------------------------------------\nint main() {\n\tscanf( \"%d %d\", &n, &m );\n\trep( i, m + 2 ) {\n\t\tstr += \"?\";\n\t}\n\ta.PB( str );\n\trep( i, n ) {\n\t\tscanf( \"%s\", b );\n\t\ta.PB( \"?\" + ( string ) b + \"?\" );\n\t}\n\ta.PB( str );\n\trep( i, 2 ) {\n\t\tscanf( \"%s\", b );\n\t\teb.PB( ( string ) b );\n\t}\n\tFOR( i,0, a.size() - 2 ) {\n\t\tFOR( j, 0, a[0].size() - 2 ) {\n\t\t\tif ( a[ i + 1 ][ j + 1 ] == eb[ 0 ][ 0 ] && a[ i + 2 ][ j + 1 ] == eb[ 1 ][ 0 ] && a[ i + 1 ][ j + 2 ] == eb[ 0 ][ 1 ] && a[ i + 2 ][ j + 2 ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\tdefault_ans++;\n\t\t\t}\n\t\t}\n\t}\n\trep( i, 3 ) {\n\t\tFOR( j, 1, a.size() - 1 ) {\n\t\t\tFOR( k, 1, a[0].size() - 1) {\n\t\t\t\tdiff = 0;\n\t\t\t\tif ( joi[ i ] == a[ j ][ k ] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j - 1 ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j + 1 ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j + 1 ][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k ] == eb[ 0 ][ 0 ] && a[ j ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j - 1 ][ k + 1 ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j + 1 ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j ][ k + 1 ] == eb[ 0 ][ 1 ] && a[ j + 1 ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdiff_max = max( diff, diff_max );\n\t\t\t}\n\t\t}\n\t}\n\tprintf( \"%d\\n\", default_ans + diff_max );\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define MP make_pair\n#define PB push_back\n#define F first\n#define S second\n#define INF 1 << 30\n#define EPS 1e-10\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint flag[1000][1000], cr[2][2], M, N;\n\nint count(int y, int x){\n  int res = 0;\n  REP(i, -1, 1) REP(j, -1, 1){\n    int ny = y+i, nx = x+j;\n    if(ny < 0 || nx < 0 || ny+1 >= M || nx+1 >= N) continue;\n    int f = 1;\n    rep(k, 2) rep(l, 2) if(flag[ny+k][nx+l] != cr[k][l]) f = 0;\n    res += f;\n  }\n  return res;\n}\n\nint main(){\n  char in[1024];\n  scanf(\"%d%d\", &M, &N);\n  rep(i, M){\n    scanf(\"%s\", in);\n    rep(j, N){\n      if(in[j] == 'J') flag[i][j] = 0;\n      else if(in[j] == 'O') flag[i][j] = 1;\n      else flag[i][j] = 2;\n    }\n  }\n  rep(i, 2){\n    scanf(\"%s\", in);\n    rep(j, 2){\n      switch(in[j]){\n      case 'J': cr[i][j] = 0; break;\n      case 'O': cr[i][j] = 1; break;\n      case 'I': cr[i][j] = 2; break;\n      }\n    }\n  }\n\n  int sum = 0;\n  rep(i, M-1) rep(j, N-1){\n    if(flag[i][j] != cr[0][0]) continue;\n    if(flag[i+1][j] == cr[1][0] && flag[i+1][j+1] == cr[1][1] && flag[i][j+1] == cr[0][1]) sum++;\n  }\n\n  int res = 0;\n  rep(i, M) rep(j, N){\n    int tmpc = count(i, j), tmp = flag[i][j];\n    rep(k, 3){\n      if(tmp == k) continue;\n      flag[i][j] = k;\n      res = max(res, sum - tmpc + count(i, j));\n    }\n    flag[i][j] = tmp;\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n\tint h, w; scanf(\"%d %d\", &h, &w);\n\n\tfor (int i = 0; i < h; ++i) scanf(\"%s\", mp[i]);\n\n\tfor (int i = 0; i < 2; ++i) scanf(\"%s\", mp[i]);\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tint sum2 = sum;\n\n\t\t\tchar tmp = mp[i][j];\n\n\t\t\tint cnt = 0;\n\n\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\tint y = i + dy[k], x = j + dx[k];\n\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsum2 -= cnt;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tmp[i][j] = a[k];\n\n\t\t\t\tint cnt2 = 0;\n\n\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\tint y = i + dy[l], x = j + dx[l];\n\t\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\t\tcnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcnt = max(cnt, cnt2);\n\t\t\t}\n\n\t\t\tsum2 += cnt;\n\n\t\t\tmp[i][j] = tmp;\n\n\t\t\tans = max(ans, sum2);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nchar nnew[1001][1001];\nint i,j,k;\nint main(void)\n{\n\tchar old[5];\n\tchar joi[3]={'J','O','I'};\n\tint m,n;\n\tint cnt,c,max;\n\tc=0;\n\tcnt=0;\n\tmax=0;\n\t\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tscanf(\" %c\",&nnew[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<4;i++){\n\t\tscanf(\" %c\",&old[i]);\n\t}\n\tfor(i=0;i<m;i++){\n\t\tfor(j=0;j<n;j++){\n\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse if(nnew[i][j]=='J'){\n\t\t\t\tnnew[i][j]=joi[1];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnnew[i][j]=joi[2];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(nnew[i][j]=='O'){\n\t\t\t\tnnew[i][j]=joi[0];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnnew[i][j]=joi[2];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(nnew[i][j]=='I'){\n\t\t\t\tnnew[i][j]=joi[0];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t\tc=0;\n\t\t\t\tnnew[i][j]=joi[1];\n\t\t\t\tif(nnew[i][j]==old[0] && nnew[i][j+1]==old[1] && nnew[i+1][j]==old[2] && nnew[i+1][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i][j-1]==old[0] && nnew[i][j]==old[1] && nnew[i-1][j-1]==old[2] && nnew[i-1][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j-1]==old[0] && nnew[i+1][j]==old[1] && nnew[i][j-1]==old[2] && nnew[i][j]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(nnew[i+1][j]==old[0] && nnew[i+1][j+1]==old[1] && nnew[i][j]==old[2] && nnew[i][j+1]==old[3]){\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t\tif(c>max){\n\t\t\t\t\tmax=c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt+max);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H, string(W, ' '));\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        cin >> G[i][j];\n      }\n    }\n    vector<string> F(2, string(2, ' '));\n    for(int i = 0; i < 2; ++i) {\n      for(int j = 0; j < 2; ++j) {\n        cin >> F[i][j];\n      }\n    }\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n            }\n          }\n        }\n        if(pi.size() == 1) {\n          int T = S + 1;\n          if(pi[0]) T -= A[pi[0]-1][pj[0]];\n          if(pj[0]) T -= A[pi[0]][pj[0]-1];\n          if(pi[0] && pj[0]) T -= A[pi[0]-1][pj[0]-1];\n          res = max(res, T);\n        }\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\nint countjoi(vector<vector<char> >& flag, vector<vector<char> >& joi, int i, int j) {\n    int res=0;\n    if(i>=0 && i<flag.size()-1 && j>=0 && j<flag[0].size()-1\n       && flag[i][j]==joi[0][0] && flag[i][j+1]==joi[0][1] && flag[i+1][j]==joi[1][0] && flag[i+1][j+1]==joi[1][1]) res=1;\n    return res;\n}\n\nint countjoi4(vector<vector<char> >& flag, vector<vector<char> >& joi, int i, int j) {\n    int res=0;\n    int di[4]={-1,-1,0,0};\n    int dj[4]={-1,0,-1,0};\n\n    for(int k=0; k<4; ++k) {\n        res+=countjoi(flag,joi,i+di[k],j+dj[k]);\n    }\n    return res;\n}\n\nint main()\n{\n    int M,N;\n\n    cin >> M >> N;\n\n    vector<vector<char> > flag(M);\n    vector<vector<char> > joi(2);\n\n    for(int i=0; i<M; ++i) {\n        string instr;\n        cin >> instr;\n        for(int j=0; j<N; ++j) {\n            flag[i].push_back(instr[j]);\n        }\n    }\n\n    string instr;\n    cin >> instr;\n    joi[0].push_back(instr[0]); joi[0].push_back(instr[1]);\n    cin >> instr;\n    joi[1].push_back(instr[0]); joi[1].push_back(instr[1]);\n\n    int cnt=0,ans=0;\n\n    for(int i=0; i<M-1; ++i) {\n        for(int j=0; j<N-1; ++j) {\n            cnt+=countjoi(flag,joi,i,j);\n        }\n    }\n    ans=cnt;\n    for(int i=0; i<M; ++i) {\n        for(int j=0; j<N; ++j) {\n            char org=flag[i][j],new1,new2;\n            int orgc=0,newc=0;\n            orgc=countjoi4(flag,joi,i,j);\n            switch(org) {\n            case 'J' :\n                new1='O'; new2='I'; break;\n            case 'O' :\n                new1='J'; new2='I'; break;\n            case 'I' :\n                new1='J'; new2='O'; break;\n            }\n            flag[i][j]=new1;\n            newc=countjoi4(flag,joi,i,j);\n            ans=max(ans,cnt+(newc-orgc));\n            flag[i][j]=new2;\n            newc=countjoi4(flag,joi,i,j);\n            ans=max(ans,cnt+(newc-orgc));\n            flag[i][j]=org;\n        }\n    }\n\n\n    cout << ans << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint M, N;\nchar map[1010][1010];\nchar emblem[2][2];\nconst char *table = \"JOI\";\n\nint eval(int x, int y, int value) {\n  int bcount = 0;\n  for (int bx=0; bx<=1; bx++) {\n    for (int by=0; by<=1; by++) {\n      int _x = bx + x;\n      int _y = by + y;\n      if (map[_y][_x]   == emblem[0][0] && map[_y+1][_x]   == emblem[1][0]\n       && map[_y][_x+1] == emblem[0][1] && map[_y+1][_x+1] == emblem[1][1]) bcount++;\n     }\n  }\n\n  int _r = map[y][x];\n  map[y][x] = table[value];\n  //if (_r == map[y][x]) return 0;\n  int count = 0;\n  for (int bx=0; bx<=1; bx++) {\n    for (int by=0; by<=1; by++) {\n      int _x = bx + x;\n      int _y = by + y;\n      /*\n      cout << \"#####\\n\";\n      cout << map[_y][_x]   << map[_y][_x+1] << \"\\n\";\n      cout << map[_y+1][_x] << map[_y+1][_x+1] << \"\\n\";\n      */\n      if (map[_y][_x]   == emblem[0][0] && map[_y+1][_x]   == emblem[1][0]\n       && map[_y][_x+1] == emblem[0][1] && map[_y+1][_x+1] == emblem[1][1]) count++;\n     }\n  }\n  //cout << \"eval(\" << x << \", \" << y << \", \" << value << \") = \" << count << \" - \" << bcount << \"\\n\";\n  map[y][x] = _r;\n  return count - bcount;\n}\n\nint main() {\n  cin >> M >> N;\n  for (int i=0; i<M; i++) {\n    cin >> map[i+1];\n    for (int j=N; j>0; j--) {\n      map[i+1][j] = map[i+1][j-1];\n    }\n    map[i+1][0] = ' ';\n  }\n\n  for (int i=0; i<2; i++) {\n    cin >> emblem[i];\n  }\n\n  int _max = -1;\n  int val_x = -1, val_y = -1, val_k = 0;\n  for (int i=1; i<=M; i++) {\n    for (int j=1; j<=N; j++) {\n      for (int k=0; k<3; k++) {\n        //if (map[j][i] == table[k]) continue;\n        int t = eval(j, i, k);\n        if (t > _max) {\n          _max = t;\n          val_x = j; val_y = i; val_k = k;\n        }\n      }\n    }\n  }\n  //cout << \"(\" << val_x << \", \" << val_y << \"), \" << table[val_k] << \"\\n\";\n  map[val_y][val_x] = table[val_k];\n\n  int ans = 0;\n  for (int i=1; i<=M+4; i++) {\n    for (int j=1; j<=N+4; j++) {\n      if (map[j][i]   == emblem[0][0] && map[j+1][i]   == emblem[1][0]\n       && map[j][i+1] == emblem[0][1] && map[j+1][i+1] == emblem[1][1])\n        ans++;\n    }\n  }\n  cout << ans << '\\n';\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nconst string JOI = \"JOI\";\n\nint main()\n{\n\tint H, W;\n\n\tscanf(\"%d\", &H);\n\tscanf(\"%d\", &W);\n\n\tvector<string> D(H);\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tcin >> D[i];\n\t}\n\n\tstring C1, C2; cin >> C1 >> C2;\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < H - 1; i++)\n\t{\n\t\tfor (int j = 0; j < W - 1; j++)\n\t\t{\n\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\tif (R1 == C1 && R2 == C2)\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint diff, ret = sum;\n\n\tfor (int i = 0; i < H; i++)\n\t{\n\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tdiff = 0; char prevch = D[i][j];\n\n\t\t\tfor (int k = 0; k < 3; k++)\n\t\t\t{\n\t\t\t\tif (JOI[k] != prevch)\n\t\t\t\t{\n\t\t\t\t\tD[i][j] = JOI[k];\n\n\t\t\t\t\tif (i != 0 && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0 && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tstring R1 = D[i - 1].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tstring R1 = D[i].substr(j - 1, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j - 1, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i + 1 != H && j + 1 != W)\n\t\t\t\t\t{\n\t\t\t\t\t\tstring R1 = D[i].substr(j, 2);\n\t\t\t\t\t\tstring R2 = D[i + 1].substr(j, 2);\n\n\t\t\t\t\t\tdiff += (R1 == C1 && R2 == C2 ? 1 : 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tret = max(ret, sum + diff);\n\t\t\t}\n\n\t\t\tD[i][j] = prevch;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", ret);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint h,w,oldcnt = 0;\nchar field[1000][1000],mon[2][2],joi[] = {'J','O','I'};\n\nbool isMon(int x,int y){\n  bool ret = true;\n  if(x < 0 || x >= h - 1 || y < 0 || y >= w - 1) return false;\n  for(int i = 0;i < 2;i++){\n    for(int j = 0;j < 2;j++){\n      if(field[x + i][y + j] != mon[i][j]) ret = false;\n    }\n  }\n  return ret;\n}\n\nint main(){\n  cin >> h >> w;\n  getchar();\n  for(int i = 0;i < h;i++){\n    for(int j = 0;j < w;j++){\n      field[i][j] = getchar();\n    }\n    getchar();\n  }\n  for(int i = 0;i < 2;i++){\n    for(int j = 0;j < 2;j++){\n      mon[i][j] = getchar();\n    }\n    getchar();\n  }\n  for(int i = 0;i < h - 1;i++){\n    for(int j = 0;j < w - 1;j++){\n      if(isMon(i,j)) oldcnt++;\n    }\n  }\n  int maxcnt = 0;\n  for(int i = 0;i < h;i++){\n    for(int j = 0;j < w;j++){\n      for(int k = 0;k < 3;k++){\n\tif(field[i][j] == joi[k]) continue;\n\tint cnt = 0;\n\tchar t = field[i][j];\n\tfield[i][j] = joi[k];\n        for(int k = -1;k < 1;k++){\n\t  for(int l = -1;l < 1;l++){\n\t    if(isMon(i + k,j + l)) cnt++;\n\t  }\n\t}\n\tmaxcnt = max(maxcnt,cnt);\n\tfield[i][j] = t;\n      }\n    }\n  }\n  cout << oldcnt + maxcnt << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <bitset>\n#include <numeric>\n#include <utility>\n#include <iomanip>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vint;\ntypedef vector<long long> vll;\ntypedef pair<int,int> pint;\ntypedef pair<long long, long long> pll;\n\n#define MP make_pair\n#define PB push_back\n#define ALL(s) (s).begin(),(s).end()\n#define EACH(i, s) for (__typeof__((s).begin()) i = (s).begin(); i != (s).end(); ++i)\n#define COUT(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << endl\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, pair<T1,T2> P) \n{ return s << '<' << P.first << \", \" << P.second << '>'; }\ntemplate<class T> ostream& operator << (ostream &s, vector<T> P) \n{ for (int i = 0; i < P.size(); ++i) { if (i > 0) { s << \" \"; } s << P[i]; } return s; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, map<T1,T2> P) \n{ EACH(it, P) { s << \"<\" << it->first << \"->\" << it->second << \"> \"; } return s; }\n\n\n\nvector<string> banpei(vector<string> vstr, char c) {\n    int n = vstr.size(), m = vstr[0].size();\n    string line(m+2, c);\n    reverse(ALL(vstr)); vstr.push_back(line);\n    reverse(ALL(vstr)); vstr.push_back(line);\n    for (int i = 1; i <= n; ++i) vstr[i] = c + vstr[i] + c;\n    return vstr;\n}\n\n\n\nint n, m;\nstring fi[1100];\nstring sub[2];\n\nbool check(string fi[], int i, int j) {\n    for (int p = 0; p < 2; ++p)\n        for (int q = 0; q < 2; ++q)\n            if (fi[i+p][j+q] != sub[p][q]) return false;\n    return true;\n}\n\nint main() {\n    while (cin >> n >> m) {\n        for (int i = 0; i < n; ++i) {\n            cin >> fi[i+1];\n            fi[i+1] = \" \" + fi[i+1] + \" \";\n        }\n        for (int i = 0; i < 2; ++i) cin >> sub[i];\n        \n        int res = 0;\n        for (int i = 1; i <= n; ++i)\n            for (int j = 1; j <= m; ++j) \n                if (check(fi, i, j)) ++res;\n        \n        int Max = 0, ori = 0, tmp = 0;\n        for (int i = 1; i <= n; ++i)\n            for (int j = 1; j <= m; ++j) {\n                ori = 0;\n                for (int p = -1; p <= 0; ++p)\n                    for (int q = -1; q <= 0; ++q)\n                        if (check(fi, i+p, j+q)) ++ori;\n                \n                char ct = fi[i][j];\n                \n                tmp = 0;\n                fi[i][j] = 'J';\n                for (int p = -1; p <= 0; ++p)\n                    for (int q = -1; q <= 0; ++q)\n                        if (check(fi, i+p, j+q)) ++tmp;\n                chmax(Max, tmp-ori);\n                \n                tmp = 0;\n                fi[i][j] = 'O';\n                for (int p = -1; p <= 0; ++p)\n                    for (int q = -1; q <= 0; ++q)\n                        if (check(fi, i+p, j+q)) ++tmp;\n                chmax(Max, tmp-ori);\n                \n                tmp = 0;\n                fi[i][j] = 'I';\n                for (int p = -1; p <= 0; ++p)\n                    for (int q = -1; q <= 0; ++q)\n                        if (check(fi, i+p, j+q)) ++tmp;\n                chmax(Max, tmp-ori);\n                \n                fi[i][j] = ct;\n            }\n    \n        cout << res + Max << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cassert>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <set>\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\ntypedef long long ll;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\nint main()\n{\n\tint n,m;\n\tstring x[1005];\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> x[i];\n\tstring p[2];\n\tcin >> p[0] >> p[1];\n\tint res = 0;\n\tint sum = 0;\n\tfor(int i=0;i<n-1;i++)\n\t{\n\t\tfor(int j=0;j<m-1;j++)\n\t\t{\n\t\t\tif(x[i][j] == p[0][0] && x[i][j+1] == p[0][1]\n\t\t\t&& x[i+1][j] == p[1][0] && x[i+1][j+1] == p[1][1])\n\t\t\t{\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\tres = sum;\n\tchar c[3]={'J','O','I'};\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tfor(int k=0;k<3;k++)\n\t\t\t{\n\t\t\t\tif(x[i][j] == c[k]) continue;\n\t\t\t\tchar pp = x[i][j];\n\t\t\t\tint add = 0;\n\t\t\t\tif(i>0 && j>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i-1][j-1]==p[0][0]&&x[i-1][j]==p[0][1]&&x[i][j-1]==p[1][0]&&x[i][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(i>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i-1][j]==p[0][0]&&x[i-1][j+1]==p[0][1]&&x[i][j]==p[1][0]&&x[i][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(j>0)\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i][j-1]==p[0][0]&&x[i][j]==p[0][1]&&x[i+1][j-1]==p[1][0]&&x[i+1][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tadd -= (x[i][j]==p[0][0]&&x[i][j+1]==p[0][1]&&x[i+1][j]==p[1][0]&&x[i+1][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tx[i][j] = c[k];\n\t\t\t\tif(i>0 && j>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i-1][j-1]==p[0][0]&&x[i-1][j]==p[0][1]&&x[i][j-1]==p[1][0]&&x[i][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(i>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i-1][j]==p[0][0]&&x[i-1][j+1]==p[0][1]&&x[i][j]==p[1][0]&&x[i][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tif(j>0)\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i][j-1]==p[0][0]&&x[i][j]==p[0][1]&&x[i+1][j-1]==p[1][0]&&x[i+1][j]==p[1][1]);\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tadd += (x[i][j]==p[0][0]&&x[i][j+1]==p[0][1]&&x[i+1][j]==p[1][0]&&x[i+1][j+1]==p[1][1]);\n\t\t\t\t}\n\t\t\t\tres = max(res,sum+add);\n\t\t\t\tx[i][j] = pp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar mp[1000][1000];\nchar e[2][2];\n\nint dx[4] = {-1, 0, -1, 0}, dy[4] = {-1, -1, 0, 0};\nchar a[3] = {'J', 'O', 'I'};\n\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tint h, w; cin >> h >> w;\n\n\tfor (int i = 0; i < h; ++i) cin >> mp[i];\n\n\tfor (int i = 0; i < 2; ++i) cin >> e[i];\n\n\tint sum = 0;\n\n\tfor (int i = 0; i < h - 1; ++i) {\n\t\tfor (int j = 0; j < w - 1; ++j) {\n\t\t\tif (mp[i][j] == e[0][0] && mp[i][j + 1] == e[0][1] && mp[i + 1][j] == e[1][0] && mp[i + 1][j + 1] == e[1][1]) {\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = sum;\n\n\tfor (int i = 0; i < h; ++i) {\n\t\tfor (int j = 0; j < w; ++j) {\n\t\t\tint sum2 = sum;\n\n\t\t\tchar tmp = mp[i][j];\n\n\t\t\tint cnt = 0;\n\n\t\t\tfor (int k = 0; k < 4; ++k) {\n\t\t\t\tint y = i + dy[k], x = j + dx[k];\n\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsum2 -= cnt;\n\t\t\t\n\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\tmp[i][j] = a[k];\n\n\t\t\t\tint cnt2 = 0;\n\n\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\tint y = i + dy[l], x = j + dx[l];\n\t\t\t\t\tif (y < 0 || x < 0 || y + 1 >= h || x + 1 >= w) continue;\n\t\t\t\t\tif (mp[y][x] == e[0][0] && mp[y][x + 1] == e[0][1] && mp[y + 1][x] == e[1][0] && mp[y + 1][x + 1] == e[1][1]) {\n\t\t\t\t\t\tcnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcnt = max(cnt, cnt2);\n\t\t\t}\n\n\t\t\tsum2 += cnt;\n\n\t\t\tmp[i][j] = tmp;\n\n\t\t\tans = max(ans, sum2);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\n#define MAX 1000\n\nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\n\nbool inField(int y,int x){\n  return 0 <= y && y < H && 0 <= x && x < W;\n}\n\nint Cnt(int y,int x){\n  int res = 0;\n  bool flg = true;\n\n  if(a[y][x] != b[0][0]) flg = false;\n  if(!inField(y,x+1) || a[y][x+1] != b[0][1]) flg = false;\n  if(!inField(y+1,x) || a[y+1][x] != b[1][0]) flg = false;\n  if(!inField(y+1,x+1) || a[y+1][x+1] != b[1][1]) flg = false;\n  if(flg) res++;\n  flg = true;\n\n  return res;\n}\n\nint main(){\n  cin >> H >> W;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      cin >> b[i][j];\n    }\n  }\n  int ans = 0;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      char tmp = a[i][j];\n      for(int k = 0 ; k < 3 ; k++){\n        a[i][j] = c[k];\n        ans += Cnt(i,j);\n      }\n      a[i][j] = tmp;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//間違いソース\n//関数作ればよかったorzorz\n#include<stdio.h>\n\nint m,n;\nchar flag[1002][1002],batch[2][4];\nint\tJOI[1002][1002],mon[2][4];\t//flagのJを0,Oを1,Iを2にしたもの,batchの以下略 \nint data[1000][1000] = {0};\nint change(int y,int x);\nint canmake(int i,int j){\n\tif(JOI[i][j] == mon[0][0] && JOI[i][j+1] == mon[0][1]){\n\t\tif(JOI[i+1][j] == mon[1][0] && JOI[i+1][j+1] == mon[1][1]){\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}\nint main(){\n\tint i,j;\n\tint syokisum = 0,mmax = 0;\n\tint x;\n\tx = scanf(\"%d%d\",&m,&n);\n\tfor(i = 0;i < m;i++){\n\t\tx = scanf(\"%s\",flag[i]);\n\t}\n\tx = scanf(\"%s%s\",batch[0],batch[1]);\n\tfor(i = 0;i < 2;i++){for(j = 0;j < 2;j++){\n\t\tif(batch[i][j] == 'J')mon[i][j] = 0;\n\t\tif(batch[i][j] == 'O')mon[i][j] = 1;\n\t\tif(batch[i][j] == 'I')mon[i][j] = 2;\n\t\t}\n\t}\n\tfor(i = 0;i < m;i++){\n\t\tfor(j = 0;j < n;j++){\n\t\t\t//探索用\n\t\t\tif(flag[i][j] == 'J')JOI[i][j] = 0;\n\t\t\tif(flag[i][j] == 'O')JOI[i][j] = 1;\n\t\t\tif(flag[i][j] == 'I')JOI[i][j] = 2;\n\t\t}\n\t}\n\t//(i,j) 0 <= i < m-1,0 <= j < n-1を左上として、そのなかにJOI紋章あるかを調べる\n\tfor(i = 0;i < m-1;i++){\n\t\tfor(j = 0;j < n-1;j++){\n\t\t\tsyokisum += canmake(i,j);\n\t\t\tdata[i][j] = canmake(i,j);\n\t\t\t//printf(\"data[i][j] = %d\\n\",data[i][j]);\n\t\t}\n\t}\n\tmmax = syokisum;\n\t//flag[i][j]を変える→data[i-1][j-1]~data[i][j]を変更(他の配列に保存)→増減を調べる\n\tfor(i = 0;i < m;i++){\n\t\tfor(j = 0;j < n;j++){\n\t\t\tint kosuu;\n\t\t\tkosuu = syokisum+change(i,j);\n\t\t\tif(mmax < kosuu)mmax = kosuu;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\",mmax);\n\treturn 0;\n}\nint change(int y,int x){\n\tint num,dist = 0;\n\tint mdist = 0;\n\tfor(int t = 0;t < 3;t++){\n\t\tnum = JOI[y][x];\n\t\tJOI[y][x] = t;\n\t\tfor(int i = y-1;i < y+1;i++){\n\t\t\tfor(int j = x-1;j < x+1;j++){\n\t\t\t\tif(i < 0 || j < 0 || i >= m-1 || j >= n-1)continue;\n\t\t\t\tdist += canmake(i,j)-data[i][j];\n\t\t\t\t//printf(\"%d %d\\n\",data[i][j],canmake(i,j));\n\t\t\t}\n\t\t}\n\t\tif(mdist < dist)mdist = dist; \n\t\tJOI[y][x] = num;\n\t}\n\treturn dist;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : JOI.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\n#include <cstdio>\n#include <string>\n#include <algorithm>\n#include <math.h>\n#include <stdio.h>\n#include <vector>\nusing namespace std;\ntypedef long long ll;\nchar D[1002][1002]={};\nint M,N;\nchar b[4]={'S','J','O','I'};\nchar E[2][2];\nint main() {\n\tcin>>M>>N;\n\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0] && D[i][j+1]==E[0][1] && D[i+1][j]==E[1][0] && D[i+1][j+1]==E[1][1])a++;\n\t\t}\n\t}\n\n\tint R=0;\n\tint C[4];\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tC[k]=0;\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tif(D[i][j]==E[0][0] && D[i][j+1]==E[0][1] && D[i+1][j]==E[1][0] && D[i+1][j+1]==E[1][1])C[k]++;\n\t\t\t\tif(D[i][j-1]==E[0][0] && D[i][j]==E[0][1] && D[i+1][j-1]==E[1][0] && D[i+1][j]==E[1][1])C[k]++;\n\t\t\t\tif(D[i-1][j-1]==E[0][0] && D[i-1][j]==E[0][1] && D[i][j-1]==E[1][0] && D[i][j]==E[1][1])C[k]++;\n\t\t\t\tif(D[i-1][j]==E[0][0] && D[i-1][j+1]==E[0][1] && D[i][j]==E[1][0] && D[i][j+1]==E[1][1])C[k]++;\n\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+C[1]-C[0]);\n\t\t\tR=max(R,a+C[2]-C[0]);\n\t\t\tR=max(R,a+C[3]-C[0]);\n\t\t}\n\t}\n\n\tcout<<R<<endl;\n\n \treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint m,n; cin >> m >> n;\n\n\tchar flag[1005][1005];\n\tint cnt[1005][1005][3];\n\tint cnt2[1005][1005];\n\tint ans = 0;\n\n\tfor (int i = 0;i < m;i++){\n\t\tfor (int j = 0;j < n;j++){\n\t\t\tcin >> flag[i][j];\n\t\t\tcnt2[i][j] = 0;\n\t\t\tfor (int k = 0;k < 3;k++){\n\t\t\t\tcnt[i][j][k] = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tchar sq[2][2];\n\n\tfor (int i = 0;i < 2;i++){\n\t\tfor (int j = 0;j < 2;j++){\n\t\t\tcin >> sq[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0;i < m-1;i++){\n\t\tfor (int j = 0;j < n-1;j++){\n\t\t\tint c = 0;\n\t\t\tint tmp1,tmp2;\n\t\t\tfor (int k = 0;k < 2;k++){\n\t\t\t\tfor (int l = 0;l < 2;l++){\n\t\t\t\t\tif(flag[i+k][j+l] == sq[k][l]){\n\t\t\t\t\t\tc++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmp1 = i+k; tmp2 = j+l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(c == 3){\n\t\t\t\tif(sq[tmp1-i][tmp2-j] == 'J') cnt[tmp1][tmp2][0]++;\n\t\t\t\tif(sq[tmp1-i][tmp2-j] == 'O') cnt[tmp1][tmp2][1]++;\n\t\t\t\tif(sq[tmp1-i][tmp2-j] == 'I') cnt[tmp1][tmp2][2]++;\n\t\t\t}\n\t\t\tif(c == 4){\n\t\t\t\tcnt2[i][j]++; cnt2[i+1][j]++; cnt2[i][j+1]++; cnt2[i+1][j+1]++;\n\t\t\t\tans++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint MAX = 0;\n\n\tfor (int i = 0;i < m;i++){\n\t\tfor (int j = 0;j < n;j++){\n\t\t\tfor (int k = 0;k < 3;k++){\n\t\t\t\tMAX = max(MAX, cnt[i][j][k]-cnt2[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << ans+MAX << endl;\n\n\treturn 0;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,a,b) for(ll i=(a);i<(b);i++)\n#define RREP(i,a,b) for(int i=(a);i>=(b);i--)\n#define pq priority_queue\n#define P pair<int,int>\n#define P2 pair<int,P>\n#define P3 pair<int,P2>\ntypedef long long ll; typedef long double ld;\nusing namespace std;\nconst int INF=1e9, MOD=1e9+7, around[]={0,1,1,-1,-1,0,-1,1,0,0};\nconst ll LINF=1e18;\nconst ld PI=abs(acos(-1));\nint n,m;\nstring s[1010],w[5];\nint li[1010][1010]={};\n\nint ch(int i,int j,int x,int y,char c){\n\tint cc=0; P p;\n\t\n\tint vx[]={0,1,0,1}, vy[]={0,0,1,1};\n\tbool f=true;\n\tREP(k,0,4){\n\t\tint nx=i+vx[k], ny=j+vy[k];\n\t\tif(nx==x and ny==y and c!=w[vx[k]][vy[k]]) f=false;\n\t\telse if(nx==x and ny==y) continue;\n\t\telse if(s[nx][ny]!=w[vx[k]][vy[k]]) f=false;\n\t\telse continue;\n\t}\n\t\n\treturn (f?1:0);\n}\n\nint get(int i,int j,char c){\n\tint cc=0;\n\tif(1) cc+=ch(i,j,i,j,c);\n\tif(i-1>=0) cc+=ch(i-1,j,i,j,c);\n\tif(j-1>=0) cc+=ch(i,j-1,i,j,c);\n\tif(i-1>=0 and j-1>=0) cc+=ch(i-1,j-1,i,j,c);\n\n\treturn cc;\n}\n\nint main(){\n\tcin >> n >> m;\n\tREP(i,0,n) cin >> s[i];\n\tREP(i,0,2) cin >> w[i];\n\t\n\tint cou=0;\n\tREP(i,0,n-1){\n\t\tREP(j,0,m-1){\n\t\t\tif(ch(i,j,i,j,s[i][j])){\n\t\t\t\tli[i][j]++;\n\t\t\t\tli[i+1][j]++;\n\t\t\t\tli[i][j+1]++;\n\t\t\t\tli[i+1][j+1]++;\n\t\t\t\tcou++;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans=cou;\n\tREP(i,0,n-1){\n\t\tREP(j,0,m-1){\n\t\t\tint ma=max(get(i,j,w[0][0]), get(i,j,w[1][0]));\n\t\t\tma=max(ma,get(i,j,w[0][1]));\n\t\t\tma=max(ma,get(i,j,w[1][1]));\n\t\t\tans=max(ans, cou-li[i][j]+ma);\n\t\t}\n\t}\n\t\n\tcout << ans << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n#define ALL(x) begin(x), end(x)\nvector<string> field,squ;\nint check(int x,int y){\n  for(int i =0 ;i < 2;i++){\n\tfor(int j = 0;j < 2;j++){\n\t  if(field[y+i][x+j] != squ[i][j])return 0;\n\t}\n  }\n  return 1;\n}\nint main(){\n  int n,m;\n  cin >> m >> n;\n  field = vector<string>(m);\n  for(int i = 0;i < m;i++){\n\tcin >> field[i];\n  }\n  squ = vector<string>(m);\n  for(int i = 0;i < 2;i++){\n\tcin >> squ[i];\n  }\n  vector<vector<int> > cnt(m,vector<int>(n,0));\n  int ans = 0;\n  for(int i = 0;i < m-1;i++){\n\tfor(int j = 0;j < n-1;j++){\n\t  if(check(j,i)){\n\t\tcnt[i][j] = 1;\n\t\tans++;\n\t  }\n\t}\n  }\n  string str = \"JOI\";\n  int dx[] = {-1,1,1,-1};\n  int dy[] = {-1,-1,1,1};\n  int dxx[] = {-1,0,-1,0};\n  int dyy[] = {-1,-1,0,0};\n  for(int i = 0;i < m;i++){\n\tfor(int j = 0;j < n;j++){\n\t  char keep = field[i][j];\n\t  for(int l = 0;l < str.size();l++){\n\t\tfield[i][j] = str[l];\n\t\tint tmp = 0;\n\t\tfor(int k = 0;k < 4;k++){\n\t\t  if(i+dy[k] >= m || i+dy[k] < 0 || j+dx[k] >= n || j+dx[k] < 0)continue;\n\t\t  int res = check(j+dxx[k],i+dyy[k]);\n\t\t  tmp+=res - cnt[i+dyy[k]][j+dxx[k]];\n\t\t}\n\t\tans = max(ans,tmp+ans);\n\t  }\n\t  field[i][j] = keep;\n\t}\n  }\n  cout << ans << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    memset(dp,0,sizeof(dp));\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        if(match(x,y)){\n          for(int dy = y - 2,dx = x - 2; dy <= y; dy++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          for(int dx = x - 2,dy = y - 2; dx <= x; dx++){\n            if(dx < 0 || dy < 0) continue;\n            dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n          }\n          if(dp[y][x] == 0){\n            dp[y][x] = 1;\n          }\n        }\n        else{\n          dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n          dp[y][x] = max(dp[y][x],dp[y-1][x-1]);\n        }\n      }\n    }\n\n    int res = 0;\n    for(int y = 1; y < H; y++){\n      for(int x = 1; x < W; x++){\n        res = max(dp[y][x],res);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\nusing namespace std;\nint h,w,total=0,maxm=0;\nstring ss[1002],sa[2];\nstring a=\"JOI\";\nbool c(int x,int y){\n\tif(ss[x][y]==sa[0][0]&&ss[x+1][y]==sa[1][0]&&ss[x][y+1]==sa[0][1]&&ss[x+1][y+1]==sa[1][1])return true;\n\treturn false;\n}\nint main()\n{\n\tscanf(\"%d%d\",&h,&w);\n\tfor(int i=0;i<h;i++){\n\t\tcin >> ss[i];\n\t\tss[i]+=\"KK\";\n\t}\n\tfor(int i=0;i<=w+1;i++)ss[h]+=\"K\";\n\tfor(int i=0;i<=w+1;i++)ss[h+1]+=\"K\";\n\tcin >> sa[0] >> sa[1];\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(c(i,j))total++;\n\t\t}\n\t}\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tint A=c(i-1,j-1)+c(i,j)+c(i-1,j)+c(i,j-1);\n\t\t\tstring sx;\n\t\t\tsx+=ss[i][j];\n\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\tss[i][j]=a[k];\n\t\t\t\tint b=c(i-1,j-1)+c(i,j)+c(i,j-1)+c(i-1,j);\n\t\t\t\tmaxm=max(maxm,b-A);\n\t\t\t}\n\t\t\tss[i][j]=sx[0];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",total+maxm);\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nconst int N=1e3+10;\nint max(int a,int b){return a>b?a:b;}\nstring s[N],a[2];\nbool same(int i,int j){return s[i][j]==a[0][0]&&s[i][j+1]==a[0][1]&&s[i+1][j]==a[1][0]&&s[i+1][j+1]==a[1][1];}\nint main(){\n\tint ans=0,n,m,toj[N][N],toi[N][N],too[N][N],now=0;\n\tchar temp;\n\tcin>>n>>m;\n\tfor(int i=0;i<n;i++)cin>>s[i];\n\tfor(int i=0;i<n;i++)for(int j=0;j<m;j++)toj[i][j]=toi[i][j]=too[i][j]=0;\n\tcin>>a[0]>>a[1];\n\tfor(int i=0;i<n-1;i++)for(int j=0;j<m-1;j++){\n\t\tif(same(i,j))now++;\n\t\tfor(int x=0;x<2;x++)for(int y=0;y<2;y++){\n\t\t\tif(same(i,j)){\n\t\t\t\ttoi[i+x][j+y]--;\n\t\t\t\ttoj[i+x][j+y]--;\n\t\t\t\ttoo[i+x][j+y]--;\n\t\t\t}\n\t\t\ttemp=s[i+x][j+y];\n\t\t\ts[i+x][j+y]='J';\n\t\t\tif(same(i,j))toj[i+x][j+y]++;\n\t\t\ts[i+x][j+y]='I';\n\t\t\tif(same(i,j))toi[i+x][j+y]++;\n\t\t\ts[i+x][j+y]='O';\n\t\t\tif(same(i,j))too[i+x][j+y]++;\n\t\t\ts[i+x][j+y]=temp;\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++)for(int j=0;j<m;j++)ans=max(ans,max(toj[i][j],max(too[i][j],toi[i][j])));\n\tprintf(\"%d\\n\",ans+now);\t\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\n#define MAX 1000\n\nint H,W;\nchar a[MAX][MAX],b[2][2];\nconst char c[3] = {'J','O','I'};\nconst int dx[] = {0,0,1,1};\nconst int dy[] = {0,1,0,1};\n\nbool inField(int y,int x){\n  return 0 <= y && y < H && 0 <= x && x < W;\n}\n\nint Cnt(int y,int x){\n  int res = 0;\n  bool flg = true;\n\n  if(a[y][x] != b[0][0]) flg = false;\n  if(!inField(y,x+1) || a[y][x+1] != b[0][1]) flg = false;\n  if(!inField(y+1,x) || a[y+1][x] != b[1][0]) flg = false;\n  if(!inField(y+1,x+1) || a[y+1][x+1] != b[1][1]) flg = false;\n  if(flg) res++;\n  flg = true;\n\n  if(a[y][x] != b[0][1]) flg = false;\n  if(!inField(y,x-1) || a[y][x-1] != b[0][0]) flg = false;\n  if(!inField(y-1,x-1) || a[y-1][x-1] != b[1][0]) flg = false;\n  if(!inField(y+1,x) || a[y+1][x] != b[1][1]) flg = false;\n  if(flg) res++;\n\n  return res;\n}\n\nint main(){\n  cin >> H >> W;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 0 ; i < 2 ; i++){\n    for(int j = 0 ; j < 2 ; j++){\n      cin >> b[i][j];\n    }\n  }\n  int ans = 0;\n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      char tmp = a[i][j];\n      for(int k = 0 ; k < 3 ; k++){\n        a[i][j] = c[k];\n        ans += Cnt(i,j);\n      }\n      a[i][j] = tmp;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nint main() {\n\tint M,N;\n\tchar D[1000][1000];\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tint R=0;\n\tcin>>M>>N;\n\tfor(int i=0;i<M;i++){\n\t\tfor(int j=0;j<N;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1])a+=1;\n\t\t}\n\t}\n\n\tint c[4];\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i+1][j-1]==E[1][0]&&D[i][j]==E[0][1]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i][j]==E[1][0]&&D[i-1][j+1]==E[0][1]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i][j-1]==E[1][0]&&D[i-1][j]==E[0][1]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint C[128];\n\nint main() {\n  C['J'] = 0;\n  C['O'] = 1;\n  C['I'] = 2;\n  for(int H, W; cin >> H >> W;) {\n    vector<string> G(H);\n    for(int i = 0; i < H; ++i) cin >> G[i];\n    vector<string> F(2);\n    for(int i = 0; i < 2; ++i) cin >> F[i];\n\n    vector<vector<int> > A(H, vector<int>(W, 0));\n    vector<vector<vector<int> > > B(H, vector<vector<int> >(W, vector<int>(3, 0)));\n    int S = 0;\n    for(int i = 0; i+2 <= H; ++i) {\n      for(int j = 0; j+2 <= W; ++j) {\n        vector<int> pi, pj, pc;\n        for(int a = 0; a < 2; ++a) {\n          for(int b = 0; b < 2; ++b) {\n            if(G[i+a][j+b] != F[a][b]) {\n              pi.push_back(i+a);\n              pj.push_back(j+b);\n              pc.push_back(C[(int)F[a][b]]);\n            }\n          }\n        }\n        if(pi.empty()) {\n          S += 1;\n          A[i][j] = 1;\n        } else if(pi.size() == 1) {\n          B[pi[0]][pj[0]][pc[0]] += 1;\n        }\n      }\n    }\n    int res = S;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        for(int k = 0; k < 3; ++k) {\n          int T = S + B[i][j][k] - A[i][j];\n          if(i) T -= A[i-1][j];\n          if(j) T -= A[i][j-1];\n          if(i && j) T -= A[i-1][j-1];\n          res = max(res, T);\n        }\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main()\n{\n\tint a, b;\n\tcin >>a>>b;\n\tchar a11, a12, a21, a22, x[a][b], y;\n\tint j=0;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\tcin >> x[k][l];\n\t\t}\n\t}\n\tcin >>a11>>a12>>a21>>a22;\n\tfor (int k=0; k<a-1; k++)\n\t{\n\t\tfor (int l=0; l<b-1; l++)\n\t\t{\n\t\t\tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t\tj+=1;\n\t\t}\n\t}\n\tint q=j;\n\tint m, n, p;\n\tfor (int k=0; k<a; k++)\n\t{\n\t\tfor (int l=0; l<b; l++)\n\t\t{\n\t\t\ty=x[k][l];\n\t\t\tm=0;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tm+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    m+=1;\n\t\t    if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n\t\t    m+=1;\n\t\t    n=0;\n\t\t\tx[k][l]=a11;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n\t\t    n+=1;\n\t\t    p=max(m, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a12;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a21;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\n\t\t    n=0;\n\t\t\tx[k][l]=a22;\n\t    \tif ((x[k][l]==a11 && x[k][l+1]==a12)&&(x[k+1][l]==a21 && x[k+1][l+1]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l]==a11 && x[k-1][l+1]==a12)&&(x[k][l]==a21 && x[k][l+1]==a22))\n\t       \tn+=1;\n\t       \tif ((x[k][l-1]==a11 && x[k][l]==a12)&&(x[k+1][l-1]==a21 && x[k+1][l]==a22))\n\t\t    n+=1;\n\t\t    if ((x[k-1][l-1]==a11 && x[k-1][l]==a12)&&(x[k][l-1]==a21 && x[k][l]==a22))\n\t\t    n+=1;\n\t\t    p=max(p, n);\t\t    \n\t       \tj=max(j, q+p-m);\n\t       \tx[k][l]=y;\n\t\t}\n\t}\n\tcout <<j<<\"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define PB push_back\n#define PPB pop_back\ntypedef pair<int, int> pii;\nstatic const int INF = 1LL<<61;\n\nint grid[1005][1005], m, n, mo[2][2], dx[] = {0, 1, 1, 0}, dy[] = {0, 0, 1, 1};\n\ninline int get(char t) {\n  switch (t) {\n    case 'J':\n      return 1;\n    case 'O':\n      return 2;\n    case 'I':\n      return 3;\n  }\n}\n\n\nsigned main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  cin >> m >> n;\n  for (int y = 1; y <= m; ++y) {\n    string t;\n    cin >> t;\n    for (int x = 1; x <= n; ++x) {\n      grid[x][y] = get(t[x - 1]);\n    }\n  }\n\n  for (int y = 0; y < 2; ++y) {\n    string t;\n    cin >> t;\n    for (int x = 0; x < 2; ++x) {\n      mo[x][y] = get(t[x]);\n    }\n  }\n\n  int base = 0, addi = 0;\n\n  for (int y = 1; y <= m; ++y) {\n    for (int x = 1; x <= n; ++x) {\n      {\n        bool flg = true;\n        for (int j = 0; j < 4; ++j) {\n          flg = flg && grid[x + dx[j]][y + dy[j]] == mo[dx[j]][dy[j]];\n          if (!flg) break;\n        }\n        if (flg) base++;\n      }\n\n      int pre = grid[x][y], tmax = 0;\n      for (int i = 1; i <= 3; ++i) {\n        if (pre == i) continue;\n        grid[x][y] = i;\n        int temp = 0;\n\n        for (int j = 0; j < 4; ++j) {\n          bool flg = true;\n          for (int k = 0; k < 4; ++k) {\n            flg = flg && grid[x + dx[k] - dx[j]][y + dy[k] - dy[j]] == mo[1 + dx[k]][1 + dy[k]];\n            if (!flg) break;\n          }\n          if (!flg) continue;\n\n          temp++;\n        }\n\n        tmax = max(tmax, temp);\n      }\n      grid[x][y] = pre;\n\n      addi = max(tmax, addi);\n    }\n  }\n\n  cout << base + addi << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<n;i++)\nint m, n;\nchar F[1002][1002];\nchar M[2][2];\n\nint match(int i, int j){\n\tif (i < 0 || m <= i + 1 || j < 0 || n <= j + 1)return 0;\n\tif(F[i][j] == M[0][0] && F[i][j + 1] == M[0][1]\n\t\t&& F[i + 1][j] == M[1][0] && F[i + 1][j + 1] == M[1][1])return 1;\n\telse return 0;\n}\n\nint around(int i, int j){\n\treturn match(i - 1, j - 1) + match(i - 1, j) + match(i, j - 1) + match(i, j);\n}\n\nvoid turn(int i, int j){\n\tif (F[i][j] == 'J')F[i][j] = 'O';\n\telse if (F[i][j] == 'O')F[i][j] = 'I';\n\telse if (F[i][j] == 'I')F[i][j] = 'J';\n}\n\nint main(){\n\tcin >> m >> n;\n\tREP(i, m)REP(j, n)cin >> F[i][j];\n\tREP(i, 2)REP(j, 2)cin >> M[i][j];\n\tint ms = 0;\n\tREP(i, m - 1)REP(j, n - 1)if (match(i, j))ms++;\n\tint ma = 0;\n\tREP(i, m)REP(j, n){\n\t\tint old = around(i, j);\n\t\tturn(i, j);\n\t\tint hen = around(i, j);\n\t\tturn(i, j);\n\t\then = max(hen, around(i, j));\n\t\tturn(i, j);\n\t\tma = max(ma, hen - old);\n\t}\n\tcout << (ms + ma) << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\nconst int MAX_M=1000,MAX_N=1000;\n\nint M,N;\nchar flg[MAX_M][MAX_N+1];\nchar emb[2][2+1];\n\nint count(int m,int n){\n\t//上からm行目,下からn行目に含まれるJOI紋章\n\tint i,j;\n\tbool flag;\n\tint cnt=0;\n\tif (m!=0 && n!=0){\n\t\tflag=true;\n\t\tfor (i=0;i<2;i++){\n\t\t\tfor (j=0;j<2;j++){\n\t\t\t\tif (emb[i][j]!=flg[m-1+i][n-1+j]){\n\t\t\t\t\tflag=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (flag) cnt++;\n\t}\n\tif (m!=0 && n!=N-1){\n\t\tflag=true;\n\t\tfor (i=0;i<2;i++){\n\t\t\tfor (j=0;j<2;j++){\n\t\t\t\tif (emb[i][j]!=flg[m-1+i][n+j]){\n\t\t\t\t\tflag=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (flag) cnt++;\n\t}\n\tif (m!=M-1 && n!=0){\n\t\tflag=true;\n\t\tfor (i=0;i<2;i++){\n\t\t\tfor (j=0;j<2;j++){\n\t\t\t\tif (emb[i][j]!=flg[m+i][n-1+j]){\n\t\t\t\t\tflag=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (flag) cnt++;\n\t}\n\tif (m!=M-1 && n!=N-1){\n\t\tflag=true;\n\t\tfor (i=0;i<2;i++){\n\t\t\tfor (j=0;j<2;j++){\n\t\t\t\tif (emb[i][j]!=flg[m+i][n+j]){\n\t\t\t\t\tflag=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (flag) cnt++;\n\t}\n\treturn cnt;\n}\n\nint main(){\n\tint i,j;\n\tscanf(\"%d %d\",&M,&N);\n\tfor (i=0;i<M;i++){\n\t\tscanf(\"%s\",flg[i]);\n\t}\n\tfor (i=0;i<2;i++){\n\t\tscanf(\"%s\",emb[i]);\n\t}\n\tint all=0;\t//古い旗に含まれる紋章の数\n\tfor (i=0;i<M-1;i++){\n\t\tfor (j=0;j<N-1;j++){\n\t\t\tbool flag=true;\n\t\t\tfor (int s=0;s<2;s++){\n\t\t\t\tfor (int t=0;t<2;t++){\n\t\t\t\t\tif (emb[s][t]!=flg[i+s][j+t]){\n\t\t\t\t\t\tflag=false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (flag) all++;\n\t\t}\n\t}\n\tint ma=all;\n\tfor (i=0;i<M;i++){\n\t\tfor (j=0;j<N;j++){\n\t\t\t//flg[i][j]をJ,O,Iに変える\n\t\t\tchar f=flg[i][j];\n\t\t\tint c=count(i,j);\n\t\t\tflg[i][j]='J';\n\t\t\tint c2=count(i,j);\n\t\t\tma=max(ma,all-c+c2);\n\t\t\tflg[i][j]='O';\n\t\t\tc2=count(i,j);\n\t\t\tma=max(ma,all-c+c2);\n\t\t\tflg[i][j]='I';\n\t\t\tc2=count(i,j);\n\t\t\tma=max(ma,all-c+c2);\n\t\t\tflg[i][j]=f;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ma);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar field[1010][1010];\nint score[1010][1010][4] = {0};//0 j 1 o 2 i\nint main()\n{\n    char E[2][2];\n    int x,y,cou = 0,ans = 0,mx,my;\n    int dx[] = {0,1,0,1},dy[] = {0,0,1,1};\n    scanf(\"%d%d\",&y,&x);\n    for(int i = 0; i < y; i++)\n    {\n        scanf(\" %c\",&field[0][i]);\n        for(int j = 1; j < x; j++)\n                scanf(\"%c\",&field[j][i]);\n    }\n    for(int i = 0; i < 2; i++)\n    {\n        scanf(\" %c\",&E[0][i]);\n        for(int j = 1; j < 2; j++)\n                scanf(\"%c\",&E[j][i]);\n    }\n    for(int i = 0; i < y ; i++)\n        for(int j = 0; j < x ; j++)\n        {\n            for(int k = 0; k < 4; k++)\n            {\n                if(field[j + dx[k]][i + dy[k]] == E[dx[k]][dy[k]])\n                        cou++;\n                else\n                {\n                    mx = j + dx[k];\n                    my = i + dy[k];\n                }\n            }\n            if(cou == 3)\n            {\n                if(E[mx - j][my - i] == 'J')score[mx][my][0]++;\n                else if(E[mx - j][my - i] == 'O')score[mx][my][1]++;\n                else score[mx][my][2]++;\n            }\n            else if(cou == 4)\n            {\n                ans++;\n            for(int k = 0; k < 4; k++)\n                score[j + dx[k]][i + dy[k]][3]--;\n            }\n            cou = 0;\n        }\n    for(int l = 0; l < 3; l++)\n        for(int i = 0; i < y; i++)\n            for(int j = 0; j < x; j++)\n            {\n                cou = max(cou,score[j][i][l] + score[j][i][3]);\n            }\n    printf(\"%d\\n\",ans + cou);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cmath>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n    int H,W;\n    int ans=0,maxans=0;\n    string fie[1002],ansfie[2];\n    cin>>H>>W;\n    for(int i=0;i<H;i++)cin>>fie[i];\n    for(int i=0;i<2;i++)cin>>ansfie[i];\n    for(int i=0;i<H-1;i++){\n        for(int j=0;j<W-1;j++){\n            if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])ans++;\n        }\n    }\n    maxans=ans;\n    for(int i=0;i<H;i++){\n        for(int j=0;j<W;j++){\n            for(int k=0;k<3;k++){\n                int a=0,b=0;\n                char p;\n                if(k==0)p='J';\n                if(k==1)p='O';\n                if(k==2)p='I';\n                if(i!=H-1&&j!=W-1){\n                    if(fie[i][j]==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])a++;\n                    if(p==ansfie[0][0]&&fie[i][j+1]==ansfie[0][1]&&fie[i+1][j]==ansfie[1][0]&&fie[i+1][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=W-1){\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&fie[i][j]==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])a++;\n                    if(fie[i-1][j]==ansfie[0][0]&&fie[i-1][j+1]==ansfie[0][1]&&p==ansfie[1][0]&&fie[i][j+1]==ansfie[1][1])b++;\n                }\n                if(i!=H-1&&j!=0){\n                    if(fie[i][j-1]==ansfie[0][0]&&fie[i][j]==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])a++;\n                    if(fie[i][j-1]==ansfie[0][0]&&p==ansfie[0][1]&&fie[i+1][j-1]==ansfie[1][0]&&fie[i+1][j]==ansfie[1][1])b++;\n                }\n                if(i!=0&&j!=0){\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&fie[i][j]==ansfie[1][1])a++;\n                    if(fie[i-1][j-1]==ansfie[0][0]&&fie[i-1][j]==ansfie[0][1]&&fie[i][j-1]==ansfie[1][0]&&p==ansfie[1][1])b++;\n                }\n                maxans=max(maxans,ans+b-a);\n            }\n        }\n    }\n    cout<<maxans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <fstream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <set>\n#include <map>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <sstream>\n#include <fstream>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n#define int long long\nconst int mod = 1000000007;\n\nchar flag[1000][1000] = {};\nint ks[1000][1000] = {};\nint z[1000][1000][3] = {};\nchar base[2][2];\nsigned main()\n{\n\tint ans = 0;\n\tint H, W; cin >> H >> W;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> base[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tint tmp = 0;\n\t\t\tint x, y;\n\t\t\tint m = 0;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (flag[i + k][j + l] == base[k][l]) {\n\t\t\t\t\t\ttmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx = i + k; y = j + l;\n\t\t\t\t\t\tif (base[k][l] == 'J') m = 0;\n\t\t\t\t\t\telse if (base[k][l] == 'O') m = 1;\n\t\t\t\t\t\telse m = 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == 4) {\n\t\t\t\tans++;\n\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\tks[i + k][j + l]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tmp == 3) z[x][y][m]++;\n\t\t}\n\t}\n\tint tmp = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (z[i][j] != 0) {\n\t\t\t\t\ttmp = max(tmp, abs(ks[i][j] - z[i][j][k]));\n\t\t\t\t//\tcout << i << \" \" << j << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\tcout << ans+tmp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint h, w;\nbool used[1005][1005];\nvector<string> s, v(2);\n\nint func(int i, int j) {\n\tint ret = 0;\n\tif(i-1 >= 0 && j-1 >= 0) {\n\t\tif(s[i-1][j-1] == v[0][0] && s[i-1][j] == v[0][1] && s[i][j-1] == v[1][0] && s[i][j] == v[1][1]) {\n\t\t\tret++;\n\t\t}\n\t}\n\n\tif(i-1 >= 0 && j+1 < w) {\n\t\tif(s[i-1][j] == v[0][0] && s[i-1][j+1] == v[0][1] && s[i][j] == v[1][0] && s[i][j+1] == v[1][1]) {\n\t\t\tret++;\n\t\t}\n\t}\n\tif(i+1 < h && j-1 >= 0) {\n\t\tif(s[i][j-1] == v[0][0] && s[i][j] == v[0][1] && s[i+1][j-1] == v[1][0] && s[i+1][j] == v[1][1]) {\n\t\t\tret++;\n\t\t}\n\t}\n\n\tif(i+1 < h && j+1 < w) {\n\t\tif(s[i][j] == v[0][0] && s[i][j+1] == v[0][1] && s[i+1][j] == v[1][0] && s[i+1][j+1] == v[1][1]) {\n\t\t\tret++;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main() {\n\tcin >> h >> w;\n\n\ts.resize(h);\n\n\trep(i, h) cin >> s[i];\n\trep(i, 2) cin >> v[i];\n\n\tint ans = 0;\n\tmemset(used, 0, sizeof(used));\n\n\trep(i, h-1) {\n\t\trep(j, w-1) {\n\t\t\tif(s[i][j] == v[0][0] && s[i][j+1] == v[0][1] && s[i+1][j] == v[1][0] && s[i+1][j+1] == v[1][1]) {\n\t\t\t\tans++;\n\t\t\t\tused[i][j] = true;\n\t\t\t\tused[i][j+1] = true;\n\t\t\t\tused[i+1][j] = true;\n\t\t\t\tused[i+1][j+1] = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tint res = 0;\n\trep(i, h) {\n\t\trep(j, w) {\n\t\t\tint t = func(i, j), t2 = 0;\n\t\t\tchar c = s[i][j];\n\n\t\t\ts[i][j] = 'J';\n\t\t\tt2 = func(i, j);\n\t\t\tres = max(res, t2 - t);\n\n\t\t\ts[i][j] = 'O';\n\t\t\tt2 = func(i, j);\n\t\t\tres = max(res, t2 - t);\n\n\t\t\ts[i][j] = 'I';\n\t\t\tt2 = func(i, j);\n\t\t\tres = max(res, t2 - t);\n\n\t\t\ts[i][j] = c;\n\t\t}\n\t}\n\n\tcout << ans + res << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint conv[256];\nint grid[1024][1024];\nint emblem[2][2];\nbool f[1024][1024];\n\nbool check(int x, int y)\n{\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tif (grid[x + i][y + j] != emblem[i][j]) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nint main()\n{\n\tconv['J'] = 1;\n\tconv['O'] = 2;\n\tconv['I'] = 3;\n\t\n\tint m, n;\n\tchar c;\n\t\n\tscanf(\"%d %d\", &m, &n);\n\tfor (int i = 1; i <= m; i++){\n\t\tfor (int j = 1; j <= n; j++){\n\t\t\tscanf(\" %c\", &c);\n\t\t\tgrid[i][j] = conv[c];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++){\n\t\tfor (int j = 0; j < 2; j++){\n\t\t\tscanf(\" %c\", &c);\n\t\t\temblem[i][j] = conv[c];\n\t\t}\n\t}\n\t\n\tint def = 0;\n\tfor (int i = 0; i <= m; i++){\n\t\tfor (int j = 0; j <= n; j++){\n\t\t\tdef += f[i][j] = check(i, j);\n\t\t}\n\t}\n\t\n\tint maxi = def;\n\tfor (int i = 1; i <= m; i++){\n\t\tfor (int j = 1; j <= n; j++){\n\t\t\tint tmp = grid[i][j];\n\t\t\t\n\t\t\tint num = def;\n\t\t\tfor (int x = i - 1; x <= i; x++){\n\t\t\t\tfor (int y = j - 1; y <= j; y++){\n\t\t\t\t\tnum -= f[x][y];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint add = 0;\n\t\t\tfor (int to = 1; to <= 3; to++){\n\t\t\t\tgrid[i][j] = to;\n\t\t\t\tfor (int x = i - 1; x <= i; x++){\n\t\t\t\t\tfor (int y = j - 1; y <= j; y++){\n\t\t\t\t\t\tadd += check(x, y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmaxi = max(maxi, num + add);\n\t\t\tgrid[i][j] = tmp;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", maxi);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\n\nint H, W, cnt[1001][1001], res;\nstring s[1001], emb[2];\nbool check[1001][1001];\n\nint search(int x, int y){\n\tint c = 0;\n\tfor(int i = 0; i < 2; ++i){\n\t\tfor(int j = 0; j < 2; ++j){\n\t\t\tif(s[y + i][x + j] == emb[i][j])\n\t\t\t\tc++;\n\t\t}\n\t}\n\tif(c == 4){\n\t\tres++;\n\t\tcheck[y][x] = true;\n\t}\n\treturn c;\n}\n\nint search2(int x, int y){\n\tbool flag = true;\n\tif(check[y][x])\n\t\tflag = false;\n\tint c = search(x, y);\n\tif(flag)\n\t\tcheck[y][x] = false;\n\tif(c == 4)\n\t\tres--;\n\treturn c;\n}\n\nint main() {\n\tcin >> H >> W;\n\tfor(int i = 0; i < H; ++i)\n\t\tcin >> s[i];\n\tfor(int i = 0; i < 2; ++i)\n\t\tcin >> emb[i];\n\t\t\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tcnt[y][x] = search(x, y);\n\t\t}\n\t}\n\tint ans = res;\n\tfor(int y = 0; y < H - 1; ++y){\n\t\tfor(int x = 0; x < W - 1; ++x){\n\t\t\tif(cnt[y][x] == 3){\n\t\t\t\tint nx, ny;\n\t\t\t\tchar tmp;\n\t\t\t\tfor(int i = 0; i < 2; ++i){\n\t\t\t\t\tfor(int j = 0; j < 2; ++j){\n\t\t\t\t\t\tif(s[y + i][x + j] != emb[i][j]){\n\t\t\t\t\t\t\tnx = x + j;\n\t\t\t\t\t\t\tny = y + i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = s[ny][nx];\n\t\t\t\ts[ny][nx] = emb[ny - y][nx - x];\n\t\t\t\tif((nx == 0 && ny == 0) || (nx == 0 && ny == H - 1)\n\t\t\t\t  || (nx == W - 1 && ny == 0) || nx == W - 1 && ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1);\n\t\t\t\t}\n\t\t\t\telse if(ny == 0 || ny == H - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx]);\n\t\t\t\t}\n\t\t\t\telse if(nx == 0 || nx == W - 1){\n\t\t\t\t\tans = max(ans, res + 1 - check[ny - 1][nx - 1]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint t = (search2(nx, ny) == 4) - check[ny][nx];\n\t\t\t\t\tt += (search2(nx - 1, ny - 1) == 4) - check[ny - 1][nx - 1];\n\t\t\t\t\tt += (search2(nx - 1, ny) == 4) - check[ny][nx - 1];\n\t\t\t\t\tt += (search2(nx, ny - 1) == 4) - check[ny - 1][nx];\n\t\t\t\t\tans = max(ans, res + t);\n\t\t\t\t}\n\t\t\t\ts[ny][nx] = tmp;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nstd::string S[1000], T[2];\nconst int dx[4] = {0, 1, 0, 1}, dy[4] = {0, 0, 1, 1};\nint M, N;\n\nint f(int y, int x){\n    if(y < 0 || x < 0){return 0;}\n    if(y+1 >= M || x+1 >= N){return 0;}\n    for(int i=0;i<4;i++){\n        if(S[y+dy[i]][x+dx[i]] != T[dy[i]][dx[i]]){return 0;}\n    }\n    return 1;\n}\n\nint main(){\n    std::cin >> M >> N;\n\n    for(int i=0;i<M;i++){\n        std::cin >> S[i];\n    }\n\n    for(int i=0;i<2;i++){\n        std::cin >> T[i];\n    }\n\n    int count = 0;\n    for(int i=0;i+1<M;i++){\n        for(int j=0;j+1<N;j++){\n            count += f(i, j);\n        }\n    }\n\n    int res = count;\n    for(int i=0;i<M;i++){\n        for(int j=0;j<N;j++){\n            for(int k=0;k<3;k++){\n                int x = 0;\n                for(int l=0;l<4;l++){\n                    x -= f(i-dy[l], j-dx[l]);\n                }\n\n                char prev = S[i][j];\n                S[i][j] = \"JOI\"[k];\n\n                for(int l=0;l<4;l++){\n                    x += f(i-dy[l], j-dx[l]);\n                }\n\n                S[i][j] = prev;\n                \n                res = std::max(res, count + x);\n            }\n        }\n    }\n\n    std::cout << res << std::endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n\nusing namespace std;\n\nchar s[1000][1111];\n\nchar w[2][2];\n\nchar q[3] = {'J','O','I'};\n\nint k[1000][1000];\n\nbool itti(int y,int x)\n{\nfor(int i = 0; i < 2; i++)\n{\nfor(int ii = 0; ii < 2; ii++)\n{\nif(s[y + i][x + ii] != w[i][ii])\n{\nreturn false;\n}\n}\n}\nreturn true;\n}\n\nint main()\n{\nint m,n;\nscanf(\"%d%d\",&m,&n);\nfor(int i = 0; i < m; i++)\n{\nscanf(\"%s\",s + i);\n}\nfor(int i = 0; i < 2; i++)\n{\nscanf(\"%s\",w + i);\n}\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nk[i][ii] = 0;\n}\n}\nint all = 0;\nfor(int i = 0; i < m - 1; i++)\n{\nfor(int ii = 0; ii < n - 1; ii++)\n{\nif(itti(i,ii))\n{\nk[i][ii]++;\nk[i + 1][ii]++;\nk[i][ii + 1]++;\nk[i + 1][ii + 1]++;\nall++;\n}\n}\n}\nint maxw = all;\nfor(int i = 0; i < m; i++)\n{\nfor(int ii = 0; ii < n; ii++)\n{\nchar moto = s[i][ii];\nfor(int j = 0; j < 3; j++)\n{\ns[i][ii] = q[j];\nint now = all - k[i][ii];\nif(i != 0)\n{\nif(itti(i - 1,ii))\n{\nnow++;\n}\n}\nif(i != m - 1)\n{\nif(itti(i + 1,ii))\n{\nnow++;\n}\n}\nif(ii != 0)\n{\nif(itti(i,ii - 1))\n{\nnow++;\n}\n}\nif(ii != n - 1)\n{\nif(itti(i,ii + 1))\n{\nnow++;\n}\n}\nmaxw = max(maxw,now);\n}\ns[i][ii] = moto;\n}\n}\nprintf(\"%d\\n\",maxw);\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define int long long\n\n#define INF (1<<61)\n\nusing namespace std;\n\ntypedef pair<int, int> Pii;\n\nint h, w, flag[1010][1010] = {0}, emblem[4];\n\nbool IsEmblem(int x, int y) {\n    int dx[] = {0, 1, 0, 1}, dy[] = {0, 0, -1, -1};\n    for (int i = 0; i < 4; ++i)\n        if (flag[x + dx[i]][y + dy[i]] != emblem[i]) return false;\n\n    return true;\n}\n\nsigned main() {\n    cin >> h >> w;\n\n    for (int y = 1; y <= h; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 1; x <= w; ++x) {\n            switch (temp[x - 1]) {\n                case 'J':\n                    flag[x][y] = 1;\n                    break;\n                case 'O':\n                    flag[x][y] = 2;\n                    break;\n                case 'I':\n                    flag[x][y] = 3;\n            }\n        }\n    }\n\n    for (int y = 0; y < 2; ++y) {\n        string temp;\n        cin >> temp;\n        for (int x = 0; x < 2; ++x) {\n            int i = x + (2 * y);\n            switch (temp[x]) {\n                case 'J':\n                    emblem[i] = 1;\n                    break;\n                case 'O':\n                    emblem[i] = 2;\n                    break;\n                case 'I':\n                    emblem[i] = 3;\n            }\n        }\n    }\n\n    int base = 0;\n    for (int y = 1; y < h; ++y) {\n        for (int x = 1; x < w; ++x) {\n            if (IsEmblem(x, y)) base++;\n        }\n    }\n\n    int max = 0, dx[] = {-1, 0, -1, 0}, dy[] = {-1, -1, 0, 0};\n    for (int y = 1; y <= h; ++y) {\n        for (int x = 1; x <= w; ++x) {\n            for (int i = 1; i < 4; ++i) {\n                int temp = flag[x][y], count = 0;\n                flag[x][y] = i;\n\n                for (int j = 0; j < 4; ++j) {\n                    if (IsEmblem(x + dx[j], y + dy[j])) count++;\n                }\n\n                if (max < count) max = count;\n                flag[x][y] = temp;\n            }\n        }\n    }\n\n    cout << base + max << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"math.h\"\n#include \"utility\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"iomanip\"\n#include \"random\"\n\nusing namespace std;\nconst long long int MOD = 1000000007;\n\nint H, W;\nint fst;\nint add;\nbool exist[1002][1002];\nchar mod[3] = { 'J','O','I' };\nint ans;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> H >> W;\n\tvector<string>field(H + 2);\n\tvector<string>joi(2);\n\tfor (int i = 1; i <= H; i++) {\n\t\tcin >> field[i];\n\t\tfield[i] = '0' + field[i] + '0';\n\t}\n\tfor (int i = 0; i < W + 2;i++) {\n\t\tfield[0] += '0';\n\t\tfield[H + 1] += '0';\n\t}\n\tfor (int i = 0; i <= 1; i++)cin >> joi[i];\n\tfor (int i = 1; i < H; i++) \n\t\tfor (int j = 1; j < W; j++) {\n\t\t\tbool flag = true;\n\t\t\tfor (int k = 0; k < 2; k++)\n\t\t\t\tfor (int l = 0; l < 2; l++)\n\t\t\t\t\tif (field[i + k][j + l] != joi[k][l])flag = false;\n\t\t\tif (flag) {\n\t\t\t\tfst++;\n\t\t\t\texist[i][j] = true;\n\t\t\t}\n\t\t}\n\n\tfor (int i = 1; i <= H; i++)\n\t\tfor (int j = 1; j <= W; j++) {\n\t\t\tint box = 0;\n\t\t\tfor (int k = -1; k <= 0; k++)\n\t\t\t\tfor (int l = -1; l <= 0; l++)if (exist[i + k][j + l])box--;\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tint bag=0;\n\t\t\t\tfor(int l=-1;l<=0;l++)\n\t\t\t\t\tfor (int m = -1; m <= 0; m++) {\n\t\t\t\t\t\tbool flag = true;\n\t\t\t\t\t\tfor (int n = 0; n <= 1; n++)\n\t\t\t\t\t\t\tfor (int o = 0; o <= 1; o++) {\n\t\t\t\t\t\t\t\tif (!n && !o) {\n\t\t\t\t\t\t\t\t\tif (mod[k] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (field[i + l + n][j + m + o] != joi[n][o])flag = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flag)bag++;\n\t\t\t\t\t}\n\t\t\t\t//if(i==1)cout << mod[k] << \" \" << box << \" \" << bag << endl;\n\t\t\t\tans = max(ans, fst + box + bag);\n\t\t\t}\n\t\t}\n//\tcout << fst << endl;\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint H, W; string s[1009], t[3], x = \"JOI\";\nint main() {\n\tcin >> H >> W;\n\tfor (int i = 0; i < H; i++) cin >> s[i];\n\tcin >> t[0] >> t[1];\n\tint sum = 0;\n\tfor (int i = 0; i < H - 1; i++) {\n\t\tfor (int j = 0; j < W - 1; j++) {\n\t\t\tbool flag = true;\n\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tif (s[i + k][j + l] != t[k][l]) flag = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (flag) sum++;\n\t\t}\n\t}\n\tint ret = 0;\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tchar e = s[i][j];\n\t\t\tint a[3] = { 0 }, z = -1;\n\t\t\tfor (int c = 0; c < 3; c++) {\n\t\t\t\tif (x[c] == e) z = c;\n\t\t\t\ts[i][j] = x[c];\n\t\t\t\tfor (int k = -1; k < 1 && 0 <= i + k && i + k + 1 < H; k++) {\n\t\t\t\t\tfor (int l = -1; l < 1 && 0 <= j + l && j + l + 1 < W; l++) {\n\t\t\t\t\t\tbool flag = true;\n\t\t\t\t\t\tfor (int m = 0; m < 2; m++) {\n\t\t\t\t\t\t\tfor (int n = 0; n < 2; n++) {\n\t\t\t\t\t\t\t\tif (s[i + k + m][j + l + n] != t[m][n]) flag = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (flag) a[c]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int c = 0; c < 3; c++) ret = max(ret, sum + a[c] - a[z]);\n\t\t\ts[i][j] = e;\n\t\t}\n\t}\n\tcout << ret << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1e3L + 11;\n\nchar c[N][N];\nchar a[2][2];\n\nbool f(int i, int j) {\n\tfor(int s : {0, 1})\n\t\tfor(int t : {0, 1})\n\t\t\tif(c[i + s][j + t] != a[s][t]) return 0;\n\treturn 1;\n}\n\nint main() {\n\tint n, m; scanf(\"%d%d\", &n, &m);\n\tfor(int i = 1; i <= n; i ++)\n\t\tscanf(\"%s\", c[i] + 1);\n\tscanf(\"%s\", a[0]);\n\tscanf(\"%s\", a[1]);\n\n\tint all = 0;\n\tfor(int i = 1; i <= n; i ++)\n\t\tfor(int j = 1; j <= m; j ++)\n\t\t\tall += f(i, j);\n\tint ans = all;\n\tfor(int i = 1; i <= n; i ++)\n\t\tfor(int j = 1; j <= m; j ++) {\n\t\t\tchar old = c[i][j];\n\t\t\tfor(char k : {'J', 'O', 'I'}) {\n\t\t\t\tint tmp = all - f(i - 1, j - 1) - f(i, j - 1) - f(i - 1, j) - f(i, j);\n\t\t\t\tc[i][j] = k;\n\t\t\t\tans = max(ans, tmp + f(i - 1, j - 1) + f(i, j - 1) + f(i - 1, j) + f(i, j));\n\t\t\t\tc[i][j] = old;\n\t\t\t}\n\t\t}\n\tcout << ans << '\\n';\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\n#include <cmath>\nusing namespace std;\n\nint M, N;\nchar field[1010][1010];\nchar emblem[2][2];\nint ex[1010][1010][3];\n\nint f(char c) {\n  if (c == 'J') return 0;\n  if (c == 'O') return 1;\n  if (c == 'I') return 2;\n  exit(1);\n}\n\nint main() {\n  cin >> M >> N;\n  for (int i=0; i<M; i++) {\n    for (int j=0; j<N; j++) {\n      cin >> field[i][j];\n    }\n  }\n  for (int i=0; i<2; i++) {\n    for (int j=0; j<2; j++) {\n      cin >> emblem[i][j];\n    }\n  }\n\n  int ans = 0;\n  for (int i=0; i<M-1; i++) {\n    for (int j=0; j<N-1; j++) {\n      int c = 0;\n      if (field[i  ][j  ] == emblem[0][0]) c++;\n      if (field[i+1][j  ] == emblem[1][0]) c++;\n      if (field[i  ][j+1] == emblem[0][1]) c++;\n      if (field[i+1][j+1] == emblem[1][1]) c++;\n      if (c == 4) ans++;\n      if (c == 3) {\n        if (field[i  ][j  ] != emblem[0][0]) ex[i][j][f(emblem[0][0])]++;\n        if (field[i+1][j  ] != emblem[1][0]) ex[i][j][f(emblem[1][0])]++;\n        if (field[i  ][j+1] != emblem[0][1]) ex[i][j][f(emblem[0][1])]++;\n        if (field[i+1][j+1] != emblem[1][1]) ex[i][j][f(emblem[1][1])]++;\n      }\n    }\n  }\n  int s = 0;\n  for (int i=0; i<M-1; i++) {\n    for (int j=0; j<N-1; j++) {\n      for (int k=0; k<3; k++) {\n        s = max(s, ex[i][j][k]);\n      }\n    }\n  }\n  cout << ans + s << \"\\n\";\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1e3L + 11;\n\nchar c[N][N];\nchar a[2][2];\n\nbool f(int i, int j) {\n\tfor(int s : {0, 1})\n\t\tfor(int t : {0, 1})\n\t\t\tif(c[i + s][j + t] != a[s][t]) return 0;\n\treturn 1;\n}\n\nint main() {\n\tint n, m; scanf(\"%d%d\", &n, &m);\n\tfor(int i = 1; i <= n; i ++)\n\t\tscanf(\"%s\", c[i] + 1);\n\tscanf(\"%s\", a[0]);\n\tscanf(\"%s\", a[1]);\n\n\tint all = 0;\n\tfor(int i = 1; i <= n; i ++)\n\t\tfor(int j = 1; j <= m; j ++)\n\t\t\tall += f(i, j);\n\tint ans = all;\n\tfor(int i = 1; i <= n; i ++)\n\t\tfor(int j = 1; j <= m; j ++) {\n\t\t\tchar old = a[i][j];\n\t\t\tfor(char k : {'J', 'O', 'I'}) {\n\t\t\t\tint tmp = all - f(i - 1, j - 1) - f(i, j - 1) - f(i - 1, j) - f(i, j);\n\t\t\t\tc[i][j] = k;\n\t\t\t\tans = max(ans, tmp + f(i - 1, j - 1) + f(i, j - 1) + f(i - 1, j) + f(i, j));\n\t\t\t\tc[i][j] = old;\n\t\t\t}\n\t\t}\n\tcout << ans << '\\n';\n}"
  },
  {
    "language": "C++",
    "code": "class in{struct myIterator{int it;const bool rev;explicit constexpr myIterator(int it_, bool rev=false):it(it_),rev(rev){}int operator*(){return it;}bool operator!=(myIterator& r){return it!=r.it;}void operator++(){rev?--it:++it;}};const myIterator i,n;public:explicit constexpr in(int n):i(0),n(n){}explicit constexpr in(int i,int n):i(i,n<i),n(n){}const myIterator& begin(){return i;}const myIterator& end(){return n;}};\n\n#include <bits/stdc++.h>\nusing namespace std;\nint main() {\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int n, m;\n    cin >> n >> m;\n    vector<string> fld(n);\n    for(auto& x : fld) cin >> x;\n    vector<string> joi(2);\n    for(auto& x : joi) cin >> x;\n    vector<vector<int>> score(n, vector<int>(m, 0));\n    int sum = 0;\n    for(int i : in(n - 1)) for(int j : in(m - 1)) {\n        int cnt = 0, cx = 0, cy = 0;\n        for(int y : in(2)) for(int x : in(2)) {\n            char aim = fld[i + y][j + x];\n            if(aim == joi[y][x])\n              ++cnt;\n            else\n              cy = i + y, cx = j + x;\n        }\n        if(cnt == 4) {\n            ++sum;\n            for(int y : in(i, i + 2)) for(int x : in(j, j + 2))\n              --score[y][x];\n        }\n        else if(cnt == 3)\n          ++score[cy][cx];\n    }\n    int ma = 0;\n    for(const auto& x : score)\n      ma = max(ma, *max_element(x.begin(), x.end()));\n    cout << sum + ma << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint h, w;\nchar b[1005][1005], f[2][2] = { 0 };\nchar t[] = { 'J','O','I' };\n\nbool solve(char c1[2][2], char c2[2][2]) {\n\tbool flag = true;\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tif (c1[i][j] != c2[i][j]) flag = false;\n\t\t}\n\t}\n\treturn flag;\n}\n\nint main() {\n\tcin >> h >> w;\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> b[i][j];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; i++) {\n\t\tfor (int j = 0; j < 2; j++) {\n\t\t\tcin >> f[i][j];\n\t\t}\n\t}\n\tint res = 0;\n\tfor (int i = 0; i < h - 1; i++) {\n\t\tfor (int j = 0; j < w - 1; j++) {\n\t\t\tif (b[i][j] == f[0][0]) {\n\t\t\t\tbool foo = true;\n\t\t\t\tif (b[i][j + 1] != f[0][1]) foo = false;\n\t\t\t\tif (b[i + 1][j] != f[1][0]) foo = false;\n\t\t\t\tif (b[i + 1][j + 1] != f[1][1]) foo = false;\n\t\t\t\tif (foo) res++;\n\t\t\t}\n\t\t}\n\t}\n\tint ma = 0;\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tint nc[3] = { 0 };//nc:全数\n\t\t\tint nt = 0;//今のchar番号\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (b[i][j] == t[k]) nt = k;\n\t\t\t}\n\t\t\tchar cut[2][2];\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tif (i + 1 < h&&j + 1 < w) {\n\t\t\t\t\tcut[0][0] = t[(nt+k)%3];\n\t\t\t\t\tcut[0][1] = b[i][j + 1];\n\t\t\t\t\tcut[1][0] = b[i + 1][j];\n\t\t\t\t\tcut[1][1] = b[i + 1][j + 1];\n\t\t\t\t\tif (solve(cut, f)) nc[k]++;\n\t\t\t\t}\n\t\t\t\tif (j-1>=0&&i + 1 < h) {\n\t\t\t\t\tcut[0][0] = b[i][j - 1];\n\t\t\t\t\tcut[0][1] = t[(nt + k) % 3];\n\t\t\t\t\tcut[1][0] = b[i + 1][j - 1];\n\t\t\t\t\tcut[1][1] = b[i + 1][j];\n\t\t\t\t\tif (solve(cut, f)) nc[k]++;\n\t\t\t\t}\n\t\t\t\tif (j + 1 < w&&i-1>=0) {\n\t\t\t\t\tcut[0][0] = b[i - 1][j];\n\t\t\t\t\tcut[0][1] = b[i - 1][j + 1];\n\t\t\t\t\tcut[1][0] = t[(nt + k) % 3];\n\t\t\t\t\tcut[1][1] = b[i][j + 1];\n\t\t\t\t\tif (solve(cut, f)) nc[k]++;\n\t\t\t\t}\n\t\t\t\tif (i - 1 >= 0 && j - 1 >= 0) {\n\t\t\t\t\tcut[0][0] = b[i - 1][j - 1];\n\t\t\t\t\tcut[0][1] = b[i - 1][j];\n\t\t\t\t\tcut[1][0] = b[i][j - 1];\n\t\t\t\t\tcut[1][1] = t[(nt + k) % 3];\n\t\t\t\t\tif (solve(f, cut)) nc[k]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tma = max(ma, max(nc[1], nc[2]) - nc[0]);\n\t\t\t//if (max(nc[1], nc[2]) - nc[0] == 1) cout << i << \" \" << j << endl;\n\t\t}\n\t}\n\tcout << res + ma << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nchar g[1010][1010],pat[5][5];\nint h,w;\nstring ch=\"JOI\";\n\nbool match(int x, int y){\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      if(g[y+i][x+j]!=pat[i][j])return false;\n    }\n  }\n  return true;\n}\n\nint count(int x, int y) {\n  int res=0;\n  for(int i=-1;i<1;i++){\n    for(int j=-1;j<1;j++){\n      int nx=x+j,ny=y+i;\n      if(nx>=0 && ny>=0 && match(nx,ny))res++;\n    }\n  }\n  return res;\n}\n\n\nint solve() {\n  \n  int res=0;\n\n   for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(match(j,i))res++;\n    }\n  }\n   \n   int mx=res;\n   for(int i=0;i<h;i++){    \n     for(int j=0;j<w;j++){\n       char tmp=g[i][j];\n\n       int c=count(j,i);\n       for(int k=0;k<3;k++){\n\t g[i][j]=ch[k];\n\t mx = max(mx,res-c+count(j,i));\n       }\n\n       g[i][j]=tmp;\n     }\n   }\n   return mx;\n}\n\nint main(void){\n\n  cin >> h >> w;\n  \n  fill(g[0],g[1010],NULL);\n  fill(pat[0],pat[5],NULL);\n\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      cin >> g[i][j];\n    }\n  }\n\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin >> pat[i][j];\n    }\n  }\n  \n  cout << solve() << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i = 0;i < n;i++)\n#define rrep(i,n) for(int i = 1;i <= n;i++)\n\nint h, w;\nint dy[4] = {0, 0, 1, 1}, dx[4] = {0, 1, 0, 1};\nint dy1[4] = {-1, -1, 0, 0}, dx1[4] = {-1, 0, -1, 0};\nchar a[1006][1006], str[1006][1006], base[3][3];\nint solve(int y, int x){\n\tint f = 1;\n\tfor(int i = 0;i < 4;i++){\n\t\tint yy = dy[i], xx = dx[i];\n\t\tif(a[y+yy][x+xx] != base[yy][xx])f = 0;\n\t}\n\treturn f;\n}\n\nint calc(){\n\tint ans = 0;\n\trrep(y,h)rrep(x,w)ans += solve(y, x);\n\treturn ans;\n}\n\nint dis(){\n\tint ans = 0;\n\trrep(y,h)rrep(x,w){\n\t\tint d1 = 0,d2 = 0;\n\t\tchar tmp = a[y][x];\n\t\trep(i,4)d1 += solve(y+dy1[i], x+dx1[i]);\n\t\trep(j,4){\n\t\t\ta[y][x] = base[dy[j]][dx[j]];\n\t\t\tint t = 0;\n\t\t\trep(i,4)t += solve(y+dy1[i], x+dx1[i]);\n\t\t\td2 = max(d2, t);\n\t\t}\n\t\tans = max(ans, d2-d1);\n\t\ta[y][x] = tmp;\n\t}\n\treturn ans;\n}\n\nint main(){\n\tfill((char*)a, (char*)(a+1006), '.');\n\tscanf(\"%d%d\", &h, &w);\n\trep(i,h)scanf(\"%s\", str[i]);\n\trrep(i,h)rrep(j,w)a[i][j] = str[i-1][j-1];\n\trep(i,2)scanf(\"%s\", base[i]);\n\tint sum = calc();\n\tint d = dis();\n\tint ans = max(sum, sum+d);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nchar stage[1001][1001];\nchar crest[5][5];\nint dp[1001][1001];\n\nbool match(int x,int y){\n  int count = 0;\n  for(int crest_y = y - 1,dy = 0; crest_y <= y; crest_y++,dy++){\n    for(int crest_x = x - 1,dx = 0; crest_x <= x; crest_x++,dx++){\n      if(stage[crest_y][crest_x] == crest[dy][dx]){\n        count++;\n      }\n    }\n  }\n  return (count == 4);\n}\n\nint main(){\n  int H,W;\n  while(~scanf(\"%d %d\",&H,&W)){\n    for(int y = 0; y < H; y++){\n      char line[1001];\n      scanf(\"%s\",line);\n      for(int x = 0; x < W; x++){\n        stage[y][x] = line[x];\n      }\n    }\n    for(int y = 0; y < 2; y++){\n      char line[3];\n      scanf(\"%s\",line);\n      for(int x = 0; x < 2; x++){\n        crest[y][x] = line[x];\n      }\n    }\n\n    int res = 0;\n    const char JOI[] = {'J','O','I'};\n    for(int char_i = 0; char_i < 3; char_i++){\n      for(int pos = 0; pos < 4; pos++){\n        char prev_crest[5][5];\n        memcpy(prev_crest,crest,sizeof(char)*5*5);\n        memset(dp,0,sizeof(dp));\n\n        int char_y = pos / 2;\n        int char_x = pos % 2;\n        crest[char_y][char_x] = JOI[char_i];\n        for(int y = 1; y < H; y++){\n          for(int x = 1; x < W; x++){\n            if(match(x,y)){\n              for(int dy = y - 2,dx = x - 2; dy <= y; dy++){\n                if(dx < 0 || dy < 0) continue;\n                dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n              }\n              for(int dx = x - 2,dy = y - 2; dx <= x; dx++){\n                if(dx < 0 || dy < 0) continue;\n                dp[y][x] = max(dp[y][x],dp[dy][dx] + 1);\n              }\n              if(dp[y][x] == 0){\n                dp[y][x] = 1;\n              }\n            }\n            else{\n              dp[y][x] = max(dp[y-1][x],dp[y][x-1]);\n              dp[y][x] = max(dp[y][x],dp[y-1][x-1]);\n            }\n          }\n        }\n\n        for(int y = 1; y < H; y++){\n          for(int x = 1; x < W; x++){\n            res = max(dp[y][x],res);\n          }\n        }\n        memcpy(crest,prev_crest,sizeof(char)*5*5);\n      }\n    }\n    printf(\"%d\\n\",res);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int MAX_M = 1000, MAX_N = 1000;\nint M, N;\nstring flag[MAX_M];\nstring Emb[2];\nint table[MAX_M][MAX_N];\nint res, plus, n;\n\nbool lu(int i, int j){ return flag[i][j] == Emb[0][0]; }\nbool ru(int i, int j){ return flag[i][j + 1] == Emb[0][1]; }\nbool ld(int i, int j){ return flag[i + 1][j] == Emb[1][0]; }\nbool rd(int i, int j){ return flag[i + 1][j + 1] == Emb[1][1]; }\n\nint main(){\n\tfor(int i = 0; i < MAX_M; i++){\n\t\tfor(int j = 0; j < MAX_N; j++){\n\t\t\ttable[i][j] = 0;\n\t\t}\n\t}\n\t\n\tcin >> M >> N;\n\tfor(int i = 0; i < M; i++){\n\t\tcin >> flag[i];\n\t}\n\tfor(int i = 0; i < 2; i++){\n\t\tcin >> Emb[i];\n\t}\n\t\n\tres = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tif(lu(i, j) && ru(i, j) && ld(i, j) && rd(i, j)) res++;\n\t\t\telse{\n\t\t\t\tif(ru(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 1;\n\t\t\t\telse if(lu(i, j) && ld(i, j) && rd(i, j)) table[i][j] = 2;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && rd(i, j)) table[i][j] = 3;\n\t\t\t\telse if(lu(i, j) && ru(i, j) && ld(i, j)) table[i][j] = 4;\n\t\t\t\telse table[i][j] = -1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tplus = 0;\n\tfor(int i = 0; i < M - 1; i++){\n\t\tfor(int j = 0; j < N - 1; j++){\n\t\t\tn = 0;\n\t\t\tif(table[i][j] == 0 || table[i][j] == -1) continue;\n\t\t\tif(table[i][j] == 1) n = 1;\n\t\t\telse if(table[i][j] == 2){\n\t\t\t\tif(j < N - 2 && table[i][j + 1] == 1) n = 2;\n\t\t\t\telse n = 1;\n\t\t\t}\n\t\t\telse if(table[i][j] == 3){\n\t\t\t\tif(i < M - 2 && table[i + 1][j] == 1) n = 2;\n\t\t\t\telse n = 1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tn = 1;\n\t\t\t\tif(i < M - 2 && j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3) n++;\n\t\t\t\t\tif(table[i + 1][j] == 2) n++;\n\t\t\t\t\tif(table[i + 1][j + 1] == 1) n++;\n\t\t\t\t}\n\t\t\t\telse if(i < M - 2){\n\t\t\t\t\tif(table[i + 1][j] == 2) n++;\n\t\t\t\t}\n\t\t\t\telse if(j < N - 2){\n\t\t\t\t\tif(table[i][j + 1] == 3) n++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tplus = max(plus, n);\n\t\t}\n\t}\n\t\n\tcout << res + plus << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<functional>\nusing namespace std;\nchar a[1000][1001];\nint main(void)\n{\n\tint i,j,k,l,m,n,ii,jj,cnt1,cnt2,sum,mx,flg,i1,j1,iii,jjj;\n\tchar b[4],buf[3],c[4]=\"JOI\",d;\n\tint dx1[4]={-1,0,-1,0},dy1[4]={-1,-1,0,0};\n\tint dx2[4]={0,1,0,1},dy2[4]={0,0,1,1};\n\tscanf(\"%d %d\",&m,&n);\n\tfor(i=0;i<m;i++)\tscanf(\"%s\",a[i]);\n\tscanf(\"%s\",buf);\n\tb[0]=buf[0];\tb[1]=buf[1];\n\tscanf(\"%s\",buf);\n\tb[2]=buf[0];\tb[3]=buf[1];\n\tsum=0;\n\tfor(i=0;i<m-1;i++)\t{\n\t\tfor(j=0;j<n-1;j++)\t{\n\t\t\tflg=1;\n\t\t\tfor(k=0;k<4;k++)\t{\n\t\t\t\tii=i+dy2[k];\tjj=j+dx2[k];\n\t\t\t\tif(a[ii][jj]!=b[k])\t{\n\t\t\t\t\tflg=0;\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsum+=flg;\n//\t\t\tif(flg==1)\tprintf(\"i=%d j=%d\\n\",i,j);\n\t\t}\n\t}\n//\tprintf(\"sum=%d\\n\",sum);\n\tmx=0;\n\tfor(i=0;i<m;i++)\t{\n\t\tfor(j=0;j<n;j++)\t{\n\t\t\tcnt1=0;\n\t\t\tfor(i1=0;i1<4;i1++)\t{\n\t\t\t\tii=i+dy1[i1];\tjj=j+dx1[i1];\n\t\t\t\tif(ii>=0 && jj>=0)\t{\n\t\t\t\t\tflg=1;\n\t\t\t\t\tfor(j1=0;j1<4;j1++)\t{\n\t\t\t\t\t\tiii=ii+dy2[j1];\tjjj=jj+dx2[j1];\n//\t\t\t\t\t\tprintf(\"i=%d j=%d ii=%d jj=%d iii=%d jjj=%d\\n\",i,j,ii,jj,iii,jjj);\n\t\t\t\t\t\tif(iii>=m || jjj>=n || a[iii][jjj]!=b[j1])\t{\n\t\t\t\t\t\t\tflg=0;\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcnt1+=flg;\n\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\td=a[i][j];\n\t\t\tfor(k=0;k<3;k++)\t{\n\t\t\t\tcnt2=0;\t\t\t\n\t\t\t\tif(a[i][j]!=c[k])\t{\n\t\t\t\t\ta[i][j]=c[k];\n\t\t\t\t\tfor(i1=0;i1<4;i1++)\t{\n\t\t\t\t\t\tii=i+dy1[i1];\tjj=j+dx1[i1];\n\t\t\t\t\t\tif(ii>=0 && jj>=0)\t{\n\t\t\t\t\t\t\tflg=1;\n\t\t\t\t\t\t\tfor(j1=0;j1<4;j1++)\t{\n\t\t\t\t\t\t\t\tiii=ii+dy2[j1];\tjjj=jj+dx2[j1];\n\t\t\t\t\t\t\t\tif(iii>=m || jjj>=n || a[iii][jjj]!=b[j1])\t{\n\t\t\t\t\t\t\t\t\tflg=0;\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcnt2+=flg;\n//\t\t\t\t\t\t\tif(flg==1)\tprintf(\"i=%d j=%d ii=%d jj=%d\\n\",i,j,ii,jj);\n//\t\t\t\t\t\t\tprintf(\"cnt2=%d\\n\",cnt2);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmx=max(mx,cnt2-cnt1);\n\t\t\t\t\ta[i][j]=d;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",sum+mx);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint n,m;\nchar s[1007][1007],flag[3][3];\nint ans=0,ml=0;\nint main(){\n    ios_base::sync_with_stdio(0);\n    cin>>n>>m;\n    for(int i=0;i<n;i++){\n        for(int j=0;j<m;j++){\n            cin>>s[i][j];\n        }\n    }\n    for(int i=0;i<2;i++){\n        for(int j=0;j<2;j++){\n            cin>>flag[i][j];\n        }\n    }\n    for(int i=0;i<n;i++){\n        for(int j=0;j<m;j++){\n            char p=s[i][j];\n            int res=0,ret=0;\n            for(int k=1;k<=3;k++){\n                if(k==1) s[i][j]='J';\n                else if(k==2) s[i][j]='O';\n                else s[i][j]='I';\n                int cnt=0,ok=1;\n                if(i<n-1 && j<m-1){\n                    ok=1;\n                    for(int ii=i;ii<=i+1;ii++){\n                        for(int jj=j;jj<=j+1;jj++){\n                            if(s[ii][jj]!=flag[ii-i][jj-j]) ok=0;\n                        }\n                    }\n                    if(p==s[i][j]) res+=ok;\n                    cnt+=ok;\n                }\n                if(i<n-1 && j>0){\n                    ok=1;\n                    for(int ii=i;ii<=i+1;ii++){\n                        for(int jj=j-1;jj<=j;jj++){\n                            if(s[ii][jj]!=flag[ii-i][jj-j+1]) ok=0;\n                        }\n                    }\n                    cnt+=ok;\n                }\n                if(i>0 && j<m-1){\n                    ok=1;\n                    for(int ii=i-1;ii<=i;ii++){\n                        for(int jj=j;jj<=j+1;jj++){\n                            if(s[ii][jj]!=flag[ii-i+1][jj-j]) ok=0;\n                        }\n                    }\n                    cnt+=ok;\n                }\n                if(i>0 && j>0){\n                    ok=1;\n                    for(int ii=i-1;ii<=i;ii++){\n                        for(int jj=j-1;jj<=j;jj++){\n                            if(s[ii][jj]!=flag[ii-i+1][jj-j+1]) ok=0;\n                        }\n                    }\n                    cnt+=ok;\n                }\n                if(p!=s[i][j]) ret=max(ret,cnt);\n            }\n            s[i][j]=p;\n            ml=max(ml,ret-res);\n            ans+=res;\n        }\n    }\n    cout<<ans+ml<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "//include----------------------------------------------------------------------------------------------------------------------\n#include <bits/stdc++.h>\n//using namespace--------------------------------------------------------------------------------------------------------------\nusing namespace std;\n\n//define-----------------------------------------------------------------------------------------------------------------------\n#define rep(i, n) for(int i = 0; i < (int)n; i++)\n#define FOR(i, s, n) for(int i = s; i < (int)n; i++)\n#define per(i, n) for(int i = n; i >= 0; i--)\n#define ROF(i, s, n) for(int i = s; i >= (int)n; i--)\n#define FORIT(i, A) for (auto i : A)\n#define PRINT(x) cout << (x) << \"\\n\"\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define EACH(i, n) for (__typeof((n).begin()) i = (n).begin(); i != (n).end(); ++i)\n#define SZ(a) int((a).size())\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n#define dump(x) cout << #x << \" = \" << (x) << \"\\n\";\n#define debug(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << \"\\n\";\n#define sq(n) (n) * (n)\n\n//typedef----------------------------------------------------------------------------------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef priority_queue<int> maxpq;\ntypedef priority_queue< int, vector<int>, greater<int> > minpq;\n//const------------------------------------------------------------------------------------------------------------------------\nstatic const double EPS = 1e-10;\nstatic const double PI = acos( -1.0 );\nstatic const int mod = 1000000007;\nstatic const int INF = 1 << 25;\nstatic const LL LL_INF = 1152921504606846976;\n//global-----------------------------------------------------------------------------------------------------------------------\nVS a;\nstring str;\nVS eb;\nint default_ans = 0;\nint diff_max = 0;\nint diff;\nchar b[1000];\nstring joi = \"JOI\";\nint n, m;\n//#define DEBUG\n//function-------------------------------------------------------------------------------------------------------------------\nint main() {\n\tscanf( \"%d %d\", &n, &m );\n\trep( i, m ) {\n\t\tstr += \"?\";\n\t}\n\ta.PB( str );\n\trep( i, n ) {\n\t\tscanf( \"%s\", b );\n\t\ta.PB( \"?\" + ( string ) b + \"?\" );\n\t}\n\ta.PB( str );\n\trep( i, 2 ) {\n\t\tscanf( \"%s\", b );\n\t\teb.PB( ( string ) b );\n\t}\n\trep( i, n ) {\n\t\trep( j, m - 1 ) {\n\t\t\tif ( a[ i + 1 ][ j + 1 ] == eb[ 0 ][ 0 ] && a[ i + 2 ][ j + 1 ] == eb[ 1 ][ 0 ] && a[ i + 1 ][ j + 2 ] == eb[ 0 ][ 1 ] && a[ i + 2 ][ j + 2 ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\tdefault_ans++;\n\t\t\t}\n\t\t}\n\t}\n\trep( i, 3 ) {\n\t\tFOR( j, 1, n + 1 ) {\n\t\t\tFOR( k, 1, m + 1 ) {\n\t\t\t\tdiff = 0;\n\t\t\t\tif ( joi[ 0 ] == a[ j ][ k ] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j - 1 ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j ][ k - 1 ] == eb[ 0 ][ 0 ] && a[ j + 1 ][ k - 1 ] == eb[ 1 ][ 0 ] && a[ j + 1][ k ] == eb[ 1 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j - 1 ][ k ] == eb[ 0 ][ 0 ] && a[ j ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j - 1 ][ k + 1 ] == eb[ 0 ][ 1 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( a[ j + 1 ][ k + 1 ] == eb[ 1 ][ 1 ] && a[ j ][ k + 1 ] == eb[ 0 ][ 1 ] && a[ j + 1 ][ k ] == eb[ 1 ][ 0 ] ) {\n\t\t\t\t\tif ( joi[ i ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff++;\n\t\t\t\t\t}\n\t\t\t\t\tif ( a[ j ][ k ] == eb[ 0 ][ 0 ] ) {\n\t\t\t\t\t\tdiff--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdiff_max = max( diff, diff_max );\n\t\t\t}\n\t\t}\n\t}\n\tprintf( \"%d\\n\", default_ans + diff_max );\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iomanip>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <utility>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <set>\n\n#define INF_LL 9000000000000000000\n#define INF 2000000000\n\n#define REP(i, n) for(int i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> PII;\ntypedef pair<int, PII> PPII;\ntypedef pair<int, PPII> PPPII;\n\nclass Union_find{\nprivate:\n\tvector<int> par;\n\tvector<int> rank;\n\tint n;\n\npublic:\n\tUnion_find(int a){\n\t\tn = a;\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tpar.push_back(i);\n\t\t\trank.push_back(0);\n\t\t}\n\t}\n\n\tint find(int x){\n\t\tif(par[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn par[x] = find(par[x]);\n\t\t}\n\t}\n\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y) return;\n\n\t\tif(rank[x] < rank[y]){\n\t\t\tpar[x] = y;\n\t\t}else{\n\t\t\tpar[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t}\n\t}\n\n\tbool same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n\nint main(void){\n\tint N, M;\n\tstring flag[2];\n\tstring base[1010];\n\tll res = 0;\n\n\tcin >> M >> N;\n\tREP(i, M){\n\t\tcin >> base[i];\n\t}\n\tREP(i, 2){\n\t\tcin >> flag[i];\n\t}\n\n\tREP(i, M-1){\n\t\tREP(j, N-1){\n\t\t\tbool ok = true;\n\t\t\tREP(a, 2){\n\t\t\t\tREP(b, 2){\n\t\t\t\t\tif(flag[a][b] != base[i+a][j+b]){\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ok)\n\t\t\t\tres++;\n\t\t}\n\t}\n\tint mp = 0;\n\tREP(i, M){\n\t\tREP(j, N){\n\t\t\tchar ch[] = {'J', 'O', 'I'};\n\t\t\tchar org = base[i][j];\n\t\t\tREP(k, 3){\n\t\t\t\tbase[i][j] = ch[k];\n\t\t\t\t\n\t\t\t\tint cnt = 0;\n\t\t\t\tFOR(a, max(i-1, 0), i+1){\n\t\t\t\t\tFOR(b, max(j-1, 0), j+1){\n\t\t\t\t\t\tbool ok = true;\n\t\t\t\t\t\tREP(c, 2){\n\t\t\t\t\t\t\tREP(d, 2){\n\t\t\t\t\t\t\t\tif(flag[c][d] != base[a+c][b+d])\n\t\t\t\t\t\t\t\t\tok =false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ok) cnt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(mp < cnt && ch[k] != org)\n\t\t\t\t\tmp = cnt;\n\t\t\t}\n\t\t}\n\t}\n\tcout << res + mp << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\n#include <deque>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint M, N;\nvector<string> vs(1000);\nvector<string> JOI(2);\nbool calc(int y, int x) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return false;\n  return vs[y][x] == JOI[0][0] && vs[y][x+1] == JOI[0][1] && vs[y+1][x] == JOI[1][0] && vs[y+1][x+1] == JOI[1][1];\n}\nint change(int y, int x, char c, int cy, int cx) {\n  if(y < 0 || x < 0 || y + 1 >= M || x + 1 >= N) return 0;\n  int ret = 0;\n  ret -= calc(y, x);\n  char vsc = vs[cy][cx];\n  vs[cy][cx] = c;\n  ret += calc(y, x);\n  vs[cy][cx] = vsc;\n  return ret;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cin >> M >> N;\n  FOR(i,0,M) cin >> vs[i];\n  FOR(i,0,2) cin >> JOI[i];\n  int p = 0;\n  FOR(y,0,M) FOR(x,0,N) if(calc(y, x)) p++;\n\n  int mx = 0;\n  // ?´????->?´??????§????????? -1????´??????§?????????->?´???? +1????´??????§?????????->?´??????§????????? 0\n  string str = \"JOI\";\n  FOR(y,0,M) {\n    FOR(x,0,N) {\n      int cnt = 0;\n      FOR(i,0,3) {\n        int Y = y - 1, X = x - 1;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y, X = x - 1;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y - 1, X = x;\n        cnt += change(Y, X, str[i], y, x);\n        Y = y, X = x;\n        cnt += change(Y, X, str[i], y, x);\n      }\n      mx = max(mx, cnt);\n    }\n  }\n  cout << p + mx << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\nchar field[1001][1001];\ntypedef pair<int, int> P;\n\nclass white\n{\npublic:\n\tint x;\n\tint y;\n\tchar c;\n};\n\nvoid solve()\n{\n\tint M, N;\n\tcin >> M >> N;\n\tfor (int i = 0; i < M; ++i)\n\t{\n\t\tfor (int j = 0; j < N; ++j)\n\t\t{\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tchar flag[2][2];\n\tfor (int i = 0; i < 2; ++i)\n\t{\n\t\tfor (int j = 0; j < 2; ++j)\n\t\t{\n\t\t\tcin >> flag[i][j];\n\t\t}\n\t}\n\tint ans = 0;\n\tvector<white> threePointOK;\n\tfor (int i = 0; i < M - 1; ++i)\n\t{\n\t\tfor (int j = 0; j < N - 1; ++j)\n\t\t{\n\t\t\tif (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++ans;\n\t\t\t}\n\t\t\telse if (field[i][j] != flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j;\n\t\t\t\tw.y = i;\n\t\t\t\tw.c = flag[0][0];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] != flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j + 1;\n\t\t\t\tw.y = i;\n\t\t\t\tw.c = flag[0][1];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] != flag[1][0] && field[i + 1][j + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j;\n\t\t\t\tw.y = i + 1;\n\t\t\t\tw.c = flag[1][0];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t\telse if (field[i][j] == flag[0][0] && field[i][j + 1] == flag[0][1] && field[i + 1][j] == flag[1][0] && field[i + 1][j + 1] != flag[1][1])\n\t\t\t{\n\t\t\t\twhite w;\n\t\t\t\tw.x = j + 1;\n\t\t\t\tw.y = i + 1;\n\t\t\t\tw.c = flag[1][1];\n\t\t\t\tthreePointOK.push_back(w);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 0; i < threePointOK.size(); ++i)\n\t{\n\t\tcout << threePointOK[i].y << \" \" << threePointOK[i].x << \" \" << threePointOK[i].c << endl;\n\t}\n\tint additional = 0;\n\tfor (int i = 0; i < threePointOK.size(); ++i)\n\t{\n\t\tint plus = 0;\n\t\twhite w = threePointOK[i];\n\t\tchar c_back = field[w.y][w.x];\n\t\tfield[w.y][w.x] = w.c;\n\t\tif (w.x != 0 && w.y != 0)\n\t\t{\n\t\t\tif (field[w.y - 1][w.x - 1] == flag[0][0] && field[w.y - 1][w.x] == flag[0][1] && field[w.y][w.x - 1] == flag[1][0] && field[w.y][w.x] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != N - 1 && w.y != 0)\n\t\t{\n\t\t\tif (field[w.y - 1][w.x] == flag[0][0] && field[w.y - 1][w.x + 1] == flag[0][1] && field[w.y][w.x] == flag[1][0] && field[w.y][w.x + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != 0 && w.y != M - 1)\n\t\t{\n\t\t\tif (field[w.y][w.x - 1] == flag[0][0] && field[w.y][w.x] == flag[0][1] && field[w.y + 1][w.x - 1] == flag[1][0] && field[w.y + 1][w.x] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tif (w.x != N - 1 && w.y != M - 1)\n\t\t{\n\t\t\tcout << w.y << \" \" << w.x << \" \" << w.c << endl;\n\t\t\tif (field[w.y][w.x] == flag[0][0] && field[w.y][w.x + 1] == flag[0][1] && field[w.y + 1][w.x] == flag[1][0] && field[w.y + 1][w.x + 1] == flag[1][1])\n\t\t\t{\n\t\t\t\t++plus;\n\t\t\t}\n\t\t}\n\t\tfield[w.y][w.x] = c_back;\n\t\tadditional = max(additional, plus);\n\t}\n\tans += additional;\n\tcout << ans << endl;\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "\n//h14-1 JOI紋章\n#include <iostream>\n#include <fstream>\n#include <stdio.h>\n#include <math.h>\n#include <time.h>\n#include <string>\n#include <vector>\n#include <map>\n#include <list>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <random>\n#include <cassert>\nusing namespace std;\n#include <boost/multiprecision/cpp_int.hpp>\nnamespace boost_multiprecision = boost::multiprecision;\n#define LL long long\n#define CINT boost_multiprecision::cpp_int\n#undef INT_MIN\n#undef INT_MAX\n#define INT_MIN -2147483648\n#define INT_MAX 2147483647\n#define LL_MIN -9223372036854775808\n#define LL_MAX 9223372036854775807\n#define segment_size 65536\n#define ROOP() while (true)\n\n\nint main(){\n    int M,N;\n    cin >> M >> N;\n\n    string S[1000];\n    for(int i=0; i<M; i++){\n        cin >> S[i];\n    }\n\n    string a[2];\n    cin >> a[0] >> a[1];\n\n    int count[1000][1000];\n    int changeJ[1000][1000];\n    int changeO[1000][1000];\n    int changeI[1000][1000];\n    for(int i=0; i<M; i++){\n        for(int j=0; j<N; j++){\n            count[i][j] = 0;\n            changeJ[i][j] = 0;\n            changeO[i][j] = 0;\n            changeI[i][j] = 0;\n        }\n    }\n\n    LL sum = 0;\n    vector<pair<int,int>> l;\n    for(int i=0; i<M-1; i++){\n        for(int j=0; j<N-1; j++){\n            int tmp = 0;\n            int y,x;\n            if(S[i][j] == a[0][0]) tmp++;\n            else{\n                y = 0;\n                x = 0;\n            }\n            if(S[i+1][j] == a[1][0]) tmp++;\n            else{\n                y = 1;\n                x = 0;\n            }\n            if(S[i][j+1] == a[0][1]) tmp++;\n            else{\n                y = 0;\n                x = 1;\n            }\n            if(S[i+1][j+1] == a[1][1]) tmp++;\n            else{\n                y = 1;\n                x = 1;\n            }\n\n            if(tmp == 3){\n                l.push_back(make_pair(i+y,j+x));\n                if(a[y][x] == 'J') changeJ[i+y][j+x]++;\n                if(a[y][x] == 'O') changeO[i+y][j+x]++;\n                if(a[y][x] == 'I') changeI[i+y][j+x]++;\n            }\n            if(tmp == 4){\n                count[i][j]++;\n                count[i+1][j]++;\n                count[i][j+1]++;\n                count[i+1][j+1]++;\n                sum++;\n            }\n        }\n    }\n\n    LL ans = sum;\n    for(int i=0; i<l.size(); i++){\n        ans = max(ans, sum + max({changeJ[l[i].first][l[i].second], changeO[l[i].first][l[i].second], changeI[l[i].first][l[i].second]}) - count[l[i].first][l[i].second]);\n    }\n    cout << ans << endl;\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nmain(){\n  int m,n;\n  char flag[1001][1001];\n  char monsyou[3][3];\n  int before[1001][1001]={0};\n  int ball=0;\n  char mihon[3]={'J','O','I'};\n  char hozon;\n  int xzahyou[4]={0,1,0,1};\n  int yzahyou[4]={0,0,1,1};\n  cin>>m>>n;\n  for(int i=0;i<m;i++){\n    for(int j=0;j<n;j++){\n      cin>>flag[i][j];\n    }\n  }\n  for(int i=0;i<2;i++){\n    for(int j=0;j<2;j++){\n      cin>>monsyou[i][j];\n    }\n  }\n  for(int i=0;i<m;i++){\n    for(int j=0;j<n;j++){\n      for(int l=0;l<4;l++){\n\tif(i-1+yzahyou[l]>=0&&i+yzahyou[l]<m&&j-1+xzahyou[l]>=0&&j+xzahyou[l]<n){\n\t  if(flag[i-1+yzahyou[l]][j-1+xzahyou[l]]==monsyou[0][0]&&flag[i+yzahyou[l]][j-1+xzahyou[l]]==monsyou[1][0]&&flag[i-1+yzahyou[l]][j+xzahyou[l]]==monsyou[0][1]&&flag[i+yzahyou[l]][j+xzahyou[l]]==monsyou[1][1]){\n\t    before[i][j]=before[i][j]+1;\n\t  }\n\t}\n      }\n    }\n  }\n  for(int i=1;i<m;i++){\n    for(int j=1;j<n;j++){\n      if(flag[i-1][j-1]==monsyou[0][0]&&flag[i][j-1]==monsyou[1][0]&&flag[i-1][j]==monsyou[0][1]&&flag[i][j]==monsyou[1][1]){\n\tball=ball+1;\n      }\n    }\n  }\n  for(int i=0;i<m;i++){\n    for(int j=0;j<n;j++){\n      for(int k=0;k<3;k++){\n\tint after=0;\n\tif(flag[i][j]!=mihon[k]){\n\t  hozon=flag[i][j];\n\t  flag[i][j]=mihon[k];\n\t  for(int l=0;l<4;l++){\n\t    if(i-1+yzahyou[l]>=0&&i+yzahyou[l]<m&&j-1+xzahyou[l]>=0&&j+xzahyou[l]<n){\n\t      if(flag[i-1+yzahyou[l]][j-1+xzahyou[l]]==monsyou[0][0]&&flag[i+yzahyou[l]][j-1+xzahyou[l]]==monsyou[1][0]&&flag[i-1+yzahyou[l]][j+xzahyou[l]]==monsyou[0][1]&&flag[i+yzahyou[l]][j+xzahyou[l]]==monsyou[1][1]){\n\t      after=after+1;\n\t      }\n\t    }\n\t  }\n\t  if(ball<ball+after-before[i][j]){\n\t    ball=after-before[i][j]+ball;\n\t  }\n\t  flag[i][j]=hozon;\n\t}\n      }\n    }\n  }\n  cout<<ball<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002]={};\n\nint main() {\n\tint M,N;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M;i++){\n\t\tfor(int j=1;j<N;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint c[4];\n\tint R=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;++k){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i][j+1]==E[0][1]&&D[i+1][j]==E[1][0]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i][j]==E[0][1]&&D[i+1][j-1]==E[1][0]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i-1][j]==E[0][1]&&D[i][j-1]==E[1][0]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i-1][j+1]==E[0][1]&&D[i][j]==E[1][0]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <queue>\n#include <stack>\n#include <cctype>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <cstdlib>\n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <functional>\n\n#define INF (2 << 28)\n#define fr first\n#define sc second\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> iP;\n\nint main(){\n  \n  int w, h, base = 0;\n  char mas[1111][1111], flag[2][2];\n  string joi = \"JOI\";\n\n  cin >> h >> w;\n  for(int i = 0; i < h; i++)\n    for(int j = 0; j < w; j++) cin >> mas[i][j];\n  \n  for(int i = 0; i < 2; i++)\n    for(int j = 0; j < 2; j++) cin >> flag[i][j];\n  \n  for(int i = 0; i < h-1; i++){\n    for(int j = 0; j < w-1; j++){\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          if(mas[i + k][j + l] != flag[k][l]) goto next;\n        }\n      }\n      base++;\n    next:;\n    }\n  }\n\n  int res = 0;\n  for(int i = 0; i < h; i++){\n    for(int j = 0; j < w; j++){\n      int base2 = 0;\n      for(int l = max(0, i - 1); l <= i; l++){\n        for(int m = max(0, j - 1); m <= j; m++){\n          for(int x = 0; x < 2; x++){\n            for(int y = 0; y < 2; y++){\n              if(mas[l + x][m + y] != flag[x][y]) goto next2;\n            }\n          }\n          base2++;\n        next2:;\n        }\n      }\n  \n      for(int k = 0; k < 3; k++){\n        char change = joi[k];\n        swap(change, mas[i][j]);\n        int sum1 = 0;\n        for(int l = max(0, i - 1); l <= i; l++){\n          for(int m = max(0, j - 1); m <= j; m++){\n            for(int x = 0; x < 2; x++){\n              for(int y = 0; y < 2; y++){\n                if(mas[l + x][m + y] != flag[x][y]) goto next3;\n              }\n            }\n            sum1++;\n          next3:;\n          }\n        }\n        res = max(res, base + (sum1 - base2));\n        mas[i][j] = change;\n      }\n    }\n  } \n  cout << res << endl;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n#define rep(i, n) for(int i = 0; i < signed(n); i++)\n#define REP(i, s, n) for(int i = (s); i < signed(n); i++)\n#define rrep(i, n) for(int i = signed(n) - 1; i >= 0; i--)\n#define all(co) co.begin(), co.end()\ntypedef pair<int, int> P;\ntypedef long long LL;\ntypedef pair<P, int> PI;\ntypedef pair<int, P> IP;\nconst int INF = 1 << 29;\nconst LL LINF = 1ll << 62ll;\n\nstruct edge{ int from, to, cost; };\n\nint dr[] = { -1, 0, 1, 0 };\nint dc[] = { 0, 1, 0, -1 };\n\ntemplate<typename T = int>\nvector<vector<T>> vvector(int h, int w, T def = T()){ return move(vector<vector<T>>(h, vector<T>(w, def))); }\nclass range {\nprivate: struct I{ int x; int operator*(){ return x; }bool operator!=(I& lhs){ return x < lhs.x; }void operator++(){ ++x; } }; I i, n;\npublic:range(int n) :i({ 0 }), n({ n }){}range(int i, int n) :i({ i }), n({ n }){}I& begin(){ return i; }I& end(){ return n; }\n};\n\nconst int MOD = 10000;\nsigned main()\n{\n\tint W, H;\n\twhile (cin >> H >> W && H)\n\t{\n\t\tvector<string> stage(H);\n\t\tvector<string> monsho(2);\n\t\trep(i, H) cin >> stage[i];\n\t\tcin >> monsho[0] >> monsho[1];\n\n\t\tint base = 0;\n\t\tauto isMonsho = [&](int i, int j){\n\t\t\treturn  i >= 0 && j >= 0 && i + 1 < H && j + 1 < W\n\t\t\t\t&& stage[i][j] == monsho[0][0]\n\t\t\t\t&& stage[i][j + 1] == monsho[0][1]\n\t\t\t\t&& stage[i + 1][j] == monsho[1][0]\n\t\t\t\t&& stage[i + 1][j + 1] == monsho[1][1];\n\t\t};\n\n\t\trep(i, H - 1) rep(j, W - 1) if (isMonsho(i, j))\n\t\t\tbase++;\n\n\t\tint ans = base;\n\t\tstring str = \"JOI\";\n\t\tint dr[] = { -1, -1, 0, 1, 1, 1, 0, -1 };\n\t\tint dc[] = { 0, 1, 1, 1, 0, -1, -1, -1 };\n\t\trep(r, H) rep(c, W)\n\t\t{\n\t\t\tint baseSur = 0;\n\t\t\trep(i, 8) if (isMonsho(r + dr[i], c + dc[i])) baseSur++;\n\t\t\trep(i, 3)\n\t\t\t{\n\t\t\t\tchar buf = stage[r][c];\n\t\t\t\tstage[r][c] = str[i];\n\t\t\t\tint nextSur = 0;\n\t\t\t\trep(i, 8) if (isMonsho(r + dr[i], c + dc[i])) nextSur++;\n\t\t\t\tstage[r][c] = buf;\n\n\t\t\t\tans = max(ans, base - baseSur + nextSur);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<map>\n#include<queue>\n\nusing namespace std;\n \ntemplate<typename T1, typename T2> istream& operator>>(istream& is, pair<T1,T2>& a){ return is >> a.first >> a.second; }\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& os, pair<T1,T2>& a){ return os << a.first << \" \" << a.second; }\ntemplate<typename T> istream& operator>>(istream& is, vector< T >& vc){ for(int i = 0; i < vc.size(); i++) is >> vc[i]; return is; }\ntemplate<typename T> ostream& operator<<(ostream& os, vector< T >& vc){ for(int i = 0; i < vc.size(); i++) os << vc[i] << endl; return os; }\n \n#define ForEach(it,c) for(__typeof (c).begin() it = (c).begin(); it != (c).end(); it++)\n#define ALL(v) (v).begin(), (v).end()\n#define UNQ(s) { sort(ALL(s)); (s).erase( unique( ALL(s)), (s).end());}\n\ntypedef pair< double , double > Pi;\ntypedef pair< double , Pi > Pii;\ntypedef long long int64;\n\nint M, N;\nstring mas[1000], FIND[2];\nbool flag[1000][1000];\n\n\nint cnt_mas(){\n  int ret = 0;\n  for(int i = 0; i < M - 1; i++){\n    for(int j = 0; j < N - 1; j++){\n      bool judge = true;\n      for(int k = 0; k < 2; k++){\n        for(int l = 0; l < 2; l++){\n          judge &= mas[i + k][j + l] == FIND[k][l];\n        }\n      }\n      flag[i][j] = judge;\n      ret += flag[i][j];\n    }\n  }\n  return ret;\n}\n\n\nint main(){\n\n  cin >> M >> N;\n  for(int i = 0; i < M; i++){\n    cin >> mas[i];\n  }\n  for(int i = 0; i < 2; i++){\n    cin >> FIND[i];\n  }\n  int base = cnt_mas(), ret = 0;\n  string buff = \"JOI\";\n  for(int i = 0; i < M; i++){\n    for(int j = 0; j < N; j++){\n      for(int k = 0; k < 3; k++){\n        if(buff.at(k) != mas[i][j]){\n          swap( mas[i][j], buff.at(k));\n          int add = 0;\n          for(int l = -(i != 0); l < (i != M - 1); l++){\n            for(int m = -(j != 0); m < (j != N - 1); m++){\n              bool judge = true;\n              for(int n = 0; n < 2; n++){\n                for(int o = 0; o < 2; o++){\n                  judge &= mas[i + l + n][j + m + o] == FIND[n][o];\n                }\n              }\n              add += judge - flag[i + l][j + m];\n            }\n          }\n          ret = max( ret, add);\n          swap( mas[i][j], buff.at(k));\n        }\n      }\n    }\n  }\n  cout << base + ret << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://joi2014ho.contest.atcoder.jp/img/other/joi2014ho/joi2014ho1.pdf>\n ?????????============================================================\n JOI???????????????JOI???????????£?????¢?????????M(2<=M<=1000)???????¨????N(2<=N<=1000)????????????\n ??¢???????????????????????£?????¢??????J,O,I???????????????????????????1???????????????????????????\n \n ?????±????????????????????\\??¬?§??????????JOI ?????¨?????\\???JOI ?´??????¨????????????????±????????????????\n JOI ?´????????????£?????¢?????????2 ???????¨????2 ??????????????¢??????????????????\n ?????£?????¢??????J???O???I ???????????????????????????1 ??????????????????????????????\n \n JOI ??????????????????JOI ?´????????????°??¨??????JOI ?????????????????????2 ???????¨?2 ????????????????????????\n ???????????????J???O???I ????????????JOI ?´??????¨(?????¢????£???????????????????) ?????´??????????????????????????°????????¨??§?????????\n ?????¶???????????????2 ???????¨?2 ????????????????£????????????£??????????????????????????\\????????°??????????????¨?????????\n \n ?????±????????????????????\\??¬?§????????????????JOI ?????¨1 ??????????´?????????£????????????\n ????´????JOI ???????§????????????£?????¢1 ???????????§????????§???J???O???I ??????????\\???????1 ??????????????????????????¨?????§?????????\n ?????±????????????????????\\??¬?§????????????\\??????????????????1 ??????????????????????????°??????JOI ???????????????????????¨????????????\n \n ?????????JOI ??????????????????????????????????????????????????°??????JOI ?????¨?????????????´?????????¨????????????\n ???????´????1 ???????????????????????????JOI ???????????????????????£?????¢????????????????????????????????¨??§??????JOI ????????????1 ??????????????´??????\n ????????´??????JOI ????????°??????JOI ?????¨?????????\n \n ?????±????????????????????\\??¬?§????????????°??????JOI ??????????????????JOI ?´????????????°?????§?????????????????????????????¨?????£????????????\n ??????????????°??????JOI ??????????????????JOI ?´????????????°????????§???????±????????????¨????????£??????\n =================================================================\n ?§£??¬=============================================================\n ================================================================\n */\nvector<vector<char>> m;\nchar flag[2][2];\nll Cnt = 0;\nll res = 0;\nll M,N;\n\nll calc(int y,int x,char c){\n    ll cnt1 = 0;\n    for(int i = y - 1; i <= y;i++){\n        for(int j = x - 1; j<=x;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            cnt1++;\n        }\n    }\n    char C = m[y][x];\n    m[y][x] = c;\n    ll cnt2 = 0;\n    for(int i = y - 1; i <= y;i++){\n        for(int j = x - 1; j<=x;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            cnt2++;\n        }\n    }\n    m[y][x] = C;\n    return cnt2 - cnt1;\n}\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    cin >> M >> N;\n    m.assign(M+2,vector<char>(N+2,'#'));\n    for(int i = 1; i <= M;i++)for(int j = 1; j<=N;j++) cin >> m[i][j];\n    for(int i = 0; i < 2;i++)for(int j = 0; j < 2;j++) cin >> flag[i][j];\n    for(int i = 1; i < M;i++){\n        for(int j = 1; j < N;j++){\n            bool f = false;\n            for(int ii = 0; ii < 2;ii++){\n                for(int jj = 0; jj < 2;jj++){\n                    if(flag[ii][jj] == m[i + ii][j + jj])continue;\n                    f = true; break;\n                }\n                if(f)break;\n            }\n            if(f)continue;\n            Cnt++;\n        }\n    }\n    res = Cnt;\n    for(int i = 1; i <= M;i++){\n        for(int j = 1; j <= N;j++){\n            res = max(res,res + calc(i,j,'J'));\n            res = max(res,res + calc(i,j,'O'));\n            res = max(res,res + calc(i,j,'I'));\n        }\n    }\n    \n    cout << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n\nint ans = 0;\nint h, w;\nchar f[1010][1010], emb[4];\nchar joi[] = {'J', 'O', 'I'};\nint d[1010][1010];\n\nconst int dx[] = {-1, 0, -1, 0};\nconst int dy[] = {-1, -1, 0, 0};\n\nconst int nx[] = {0, 1, 0, 1};\nconst int ny[] = {0, 0, 1, 1};\n\ninline bool in(int x, int y){\n  return (x<0||y<0||w-1<=x||h-1<=y);\n}\n\nint main()\n{\n\n  cin >> h >> w;\n  REP(i, h) REP(j, w){\n    cin >> f[i][j];\n  }\n\n  REP(i, 4){\n    cin >> emb[i];\n  }\n\n  REP(i, h) REP(j, w) REP(k, 4){\n    int x = j + dx[k];\n    int y = i + dy[k];\n\n    if (in(x, y)) continue;\n\n    int cnt = 0;\n    for (int l = 0; l < 4; l++){\n      int sx = x + nx[l];\n      int sy = y + ny[l];\n      cnt += (f[sy][sx] == emb[l]);\n    }\n    if (cnt == 4){\n      d[i][j]++;\n      ans += (k == 0);\n    }\n  }\n\n  int maxplus = 0;\n  REP(i, h) REP(j, w){\n    char s = f[i][j];\n    REP(m, 3){\n      int onakasuita = 0;\n      f[i][j] = joi[m];\n\n      REP(k, 4){\n        int x = j + dx[k];\n        int y = i + dy[k];\n\n        if (in(x, y)) continue;\n\n        int cnt = 0;\n        REP(l, 4){\n          int sx = x + nx[l];\n          int sy = y + ny[l];\n          cnt += (f[sy][sx] == emb[l]);\n        }\n        if (cnt == 4) onakasuita++;\n      }\n      maxplus = max(maxplus, onakasuita - d[i][j]);\n    }\n    f[i][j] = s;\n  }\n\n  cout << ans + maxplus << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdint>\n#include <cstring>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define FOR(i, s, t) for (int i = s; i < t; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << fixed << setprecision(10)\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\ntemplate <class T>\ninline bool chmax(T& a, T b) {\n    if (a < b) {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\ntemplate <class T>\ninline bool chmin(T& a, T b) {\n    if (a > b) {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\n\ntemplate <int MOD>\nstruct ModInt {\n    long long val;\n    constexpr ModInt(long long v = 0) noexcept : val(v % MOD) {\n        if (val < 0) val += MOD;\n    }\n    constexpr int getmod() { return MOD; }\n    constexpr ModInt operator-() const noexcept { return val ? MOD - val : 0; }\n    constexpr ModInt operator+(const ModInt& r) const noexcept { return ModInt(*this) += r; }\n    constexpr ModInt operator-(const ModInt& r) const noexcept { return ModInt(*this) -= r; }\n    constexpr ModInt operator*(const ModInt& r) const noexcept { return ModInt(*this) *= r; }\n    constexpr ModInt operator/(const ModInt& r) const noexcept { return ModInt(*this) /= r; }\n    constexpr ModInt& operator+=(const ModInt& r) noexcept {\n        val += r.val;\n        if (val >= MOD) val -= MOD;\n        return *this;\n    }\n    constexpr ModInt& operator-=(const ModInt& r) noexcept {\n        val -= r.val;\n        if (val < 0) val += MOD;\n        return *this;\n    }\n    constexpr ModInt& operator*=(const ModInt& r) noexcept {\n        val = val * r.val % MOD;\n        return *this;\n    }\n    constexpr ModInt& operator/=(const ModInt& r) noexcept {\n        long long a = r.val, b = MOD, u = 1, v = 0;\n        while (b) {\n            long long t = a / b;\n            a -= t * b;\n            swap(a, b);\n            u -= t * v;\n            swap(u, v);\n        }\n        val = val * u % MOD;\n        if (val < 0) val += MOD;\n        return *this;\n    }\n    constexpr bool operator==(const ModInt& r) const noexcept { return this->val == r.val; }\n    constexpr bool operator!=(const ModInt& r) const noexcept { return this->val != r.val; }\n    friend constexpr ostream& operator<<(ostream& os, const ModInt<MOD>& x) noexcept { return os << x.val; }\n\n    friend constexpr istream& operator>>(istream& is, ModInt<MOD>& x) noexcept { return is >> x.val; }\n    friend constexpr ModInt<MOD> pow(const ModInt<MOD>& a, long long n) noexcept {\n        if (n == 0) return 1;\n        auto t = pow(a, n / 2);\n        t = t * t;\n        if (n & 1) t = t * a;\n        return t;\n    }\n};\n\nusing mint = ModInt<MOD>;\n\nlong long extGCD(long long a, long long b, long long& x, long long& y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n\n    long long d = extGCD(b, a % b, y, x);\n    y -= a / b * x;\n    return d;\n}\n\nlong long gcd(long long a, long long b) {\n    if (b == 0) {\n        return a;\n    } else {\n        return gcd(b, a % b);\n    }\n}\n\nlong long lcm(long long a, long long b) { return a / gcd(a, b) * b; }\n\ntemplate <typename T>\nmap<T, int> compress(vector<T> x) {\n    map<T, int> res;\n    sort(x.begin(), x.end());\n    x.erase(unique(x.begin(), x.end()), x.end());\n    for (int i = 0; i < x.size(); i++) {\n        res[x[i]] = i;\n    }\n\n    return res;\n}\n\ntemplate <typename T>\nint former(const vector<T>& v, T x) {\n    return upper_bound(v.begin(), v.end(), x) - v.begin() - 1;\n}\n\ntemplate <typename T>\nint latter(const vector<T>& v, T x) {\n    return lower_bound(v.begin(), v.end(), x) - v.begin();\n}\n\ntemplate <typename T>\nusing vec = vector<T>;\ntemplate <typename T>\nusing vvec = vector<vector<T>>;\nusing ll = long long;\n\nusing Pli = pair<long long, int>;\nusing Pll = pair<long long, long long>;\n\nll dp[2010][2010];\nint N;\nvec<ll> a;\n\nint main() {\n    int N, M;\n    cin >> N >> M;\n    vec<string> s, t(2);\n    vec<char> type = {'J', 'O', 'I'};\n\n    s.push_back(string(M + 2, '-'));\n    REP(i, N) {\n        string in;\n        cin >> in;\n        in.push_back('-');\n        in = '-' + in;\n        s.push_back(in);\n    }\n\n    s.push_back(string(M + 2, '-'));\n    REP(i, 2) cin >> t[i];\n    int all = 0;\n    vvec<int> cnt(s.size(), vec<int>(s[0].size(), 0));\n    auto f = [&](int i, int j) { return (s[i][j] == t[0][0] && s[i + 1][j] == t[1][0] && s[i][j + 1] == t[0][1] && s[i + 1][j + 1] == t[1][1]); };\n    N = s.size();\n    M = s[0].size();\n\n    FOR(i, 1, N - 1) FOR(j, 1, M - 1) {\n        cnt[i][j] = f(i, j);\n        all += cnt[i][j];\n    }\n\n    \n\n    int ans = all;\n    FOR(i, 1, N - 1) {\n        FOR(j, 1, M - 1) {\n            REP(k, 3) {\n                char bfr = s[i][j];\n                int tmp = 0;\n                s[i][j] = type[k];\n                tmp += f(i - 1, j - 1) + f(i, j - 1) + f(i - 1, j) + f(i, j);\n                chmax(ans, all + tmp - cnt[i - 1][j - 1] - cnt[i][j - 1] - cnt[i - 1][j] - cnt[i][j]);\n                s[i][j] = bfr;\n            }\n        }\n    }\n\n    cout << ans << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <functional> //sort(A,A.end(),greater<int>());???????????????\n#include <queue>\n#include <stack>\n#include <vector>\n\n#define INF 10 << 10\n\nint n, m;\nchar flag[1002][1002];\nchar coa[3][3]; //?´???? Coat of arms\nint over[1002][1002]; // ?????????\n\nbool check(char y0x0, char y0x1, char y1x0, char y1x1) {\n\tif (y0x0 == coa[0][0]) {\n\t\tif (y0x1 != coa[0][1]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x0 != coa[1][0]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (y1x1 != coa[1][1]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvoid Over(int y, int x) {\n\tfor (int i = y - 1; i < y + 1; ++i) {\n\t\tfor (int i2 = x - 1; i2 < x + 1; ++i2) {\n\t\t\t++over[i][i2];\n\t\t}\n\t}\n}\n\nint main() {\n\tmemset(over, 0, sizeof(over));\n\tmemset(flag, '0', sizeof(flag));\n\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tcin >> flag[i][i2];\n\t\t}\n\t}\n\tfor (int i = 0; i < 2; ++i) {\n\t\tfor (int i2 = 0; i2 < 2; ++i2) {\n\t\t\tcin >> coa[i][i2];\n\t\t}\n\t}\n\n\tint cnt = 0;\n\t//???????????§?????¢?´¢\n\tfor (int i = 1; i <= n - 1; ++i) {\n\t\tfor (int i2 = 1; i2 <= m - 1; ++i2) {\n\t\t\tif (check(flag[i][i2], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t++cnt;\n\t\t\t\tOver(i, i2);\n\t\t\t}\n\t\t}\n\t}\n\n\t//???????????????J,O,I,????????´????????????\n\t//(i, i2)????????????(i - 1, i2 - 1)???(i + 1, i2 + 1)??????????????°??????\n\t//??????????¢????????????????\t\t???\t??????(i, i2)?????????????´??????¨???????????£??????????????????????????????????????°???\n\tint cnt_add = 0;\n\tchar JOI[] = { \"JOI\" };\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int i2 = 1; i2 <= m; ++i2) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tint add = 0;\n\t\t\t\tif (check(flag[i - 1][i2 - 1], flag[i - 1][i2], flag[i][i2 - 1], JOI[j])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i - 1][i2], flag[i - 1][i2 + 1], JOI[j], flag[i][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(flag[i][i2 - 1], JOI[j], flag[i + 1][i2 - 1], flag[i + 1][i2])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tif (check(JOI[j], flag[i][i2 + 1], flag[i + 1][i2], flag[i + 1][i2 + 1])) {\n\t\t\t\t\t++add;\n\t\t\t\t}\n\t\t\t\tcnt_add = max(cnt_add, add - over[i][i2]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcout << max(cnt, cnt + cnt_add) << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : AOJ.cpp\n// Author      :\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\nusing namespace std;\nchar D[1002][1002];\nint main() {\n\tint M,N;\n\tint R=0;\n\tchar E[2][2];\n\tchar b[4]={'S','J','O','I'};\n\tcin>>M>>N;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tcin>>D[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<2;i++){\n\t\tfor(int j=0;j<2;j++){\n\t\t\tcin>>E[i][j];\n\t\t}\n\t}\n\tint a=0;\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1]){\n\t\t\t\ta+=1;\n\t\t\t}\n\t\t}\n\t}\n\tint c[4];\n\n\tfor(int i=1;i<M+1;i++){\n\t\tfor(int j=1;j<N+1;j++){\n\t\t\tb[0]=D[i][j];\n\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\tD[i][j]=b[k];\n\t\t\t\tc[k]=0;\n\t\t\t\tif(D[i][j]==E[0][0]&&D[i+1][j]==E[1][0]&&D[i][j+1]==E[0][1]&&D[i+1][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j]==E[0][0]&&D[i][j]==E[1][0]&&D[i-1][j+1]==E[0][1]&&D[i][j+1]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i][j-1]==E[0][0]&&D[i+1][j-1]==E[1][0]&&D[i][j]==E[0][1]&&D[i+1][j]==E[1][1])c[k]+=1;\n\t\t\t\tif(D[i-1][j-1]==E[0][0]&&D[i][j-1]==E[1][0]&&D[i-1][j]==E[0][1]&&D[i][j]==E[1][1])c[k]+=1;\n\t\t\t}\n\t\t\tD[i][j]=b[0];\n\t\t\tR=max(R,a+c[1]-c[0]);\n\t\t\tR=max(R,a+c[2]-c[0]);\n\t\t\tR=max(R,a+c[3]-c[0]);\n\t\t}\n\t}\n\n\n\n\tcout<<R<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cmath>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <set>\n#include <map>\n#include <list>\n#include <stdio.h>\n#include <string.h>\n#include <cstdlib>\n#include <math.h>\n#include <bitset>\n#include <iterator>\n#include <iomanip>\n#include <sstream>\n#define INF 2000000000\nusing namespace std;\nint dx[4]={1,0,-1,0},dy[4]={0,1,0,-1};\n#define sym cout<<\"-----------\"<<endl;\n#define ll long long\n#define PL pair<long long, long long>\n#define P pair<int,int>\n#define mk make_pair\n#define en endl\n#define WHITE 0\n#define BLACK 2\n#define GRAY 1\n#define RE return 0\n#define int ll\n\n#define MAX 1005\nint JOI[MAX][MAX];\nint mark[2][2];\nint count_coin[MAX][MAX][4];\nint used[MAX][MAX];\n\nsigned main(){\n  int m,n;\n  cin>>m>>n;\n  for(int i=1; i<=m; i++){\n    for(int j=1; j<=n; j++){\n      char ch;\n      cin>>ch;\n      if(ch=='J') JOI[i][j]=1;\n      else if(ch=='O') JOI[i][j]=2;\n      else JOI[i][j]=3;\n    }\n  }\n  for(int i=0; i<2; i++) for(int j=0; j<2; j++){\n    char ch;\n    cin>>ch;\n    if(ch=='J') mark[i][j]=1;\n    else if(ch=='O') mark[i][j]=2;\n    else mark[i][j]=3;\n  }\n  \n  int cnt_four=0;\n  for(int i=1; i<=m-1; i++){\n    for(int j=1; j<=n-1; j++){\n      bool four=true;\n      bool trash=false;\n      int num=0;\n      P where;\n      for(int k=0; k<2; k++){\n        for(int l=0; l<2; l++){\n          if(JOI[i+k][j+l]!=mark[k][l]){\n            if(four) {\n              four=false;\n              where.first=i+k; where.second=j+l;\n              num=mark[k][l];\n            }\n            else trash=true;\n          }\n        }\n      }\n      if(four){\n        cnt_four++;\n        used[i][j]=used[i+1][j]=1;\n        used[i][j+1]=used[i+1][j+1]=1;\n      }else if(!trash&&!four){\n        count_coin[where.first][where.second][num]++;\n      }\n    }\n  }\n  \n  int maxl=0;\n  for(int i=1; i<=m; i++){\n    for(int j=1; j<=n; j++){\n      for(int k=1; k<=3; k++){\n        int c;\n        if(used[i][j]) c=count_coin[i][j][k]-1;\n        else c=count_coin[i][j][k];\n        maxl=max(maxl,c);\n      }\n    }\n  }\n  cout<<cnt_four+maxl<<en;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int dx[]={0,0,-1,0},dy[]={0,-1,0,1};\n\nint main() {\n\n  int h, w;\n  char data[1001][1001];\n  char emb[3][3];\n  string joi = \"JOI\";\n  int ans = 0;\n\n  cin >> h >> w;\n\n  for(int i=0; i<h; i++) {\n    cin >> data[i];\n  }\n \n  for(int i=0; i<2; i++) {\n    cin >> emb[i];\n  }\n \n  int cnt = 0;\n\n  for(int i=0; i<h-1; i++) {\n    for(int j=0; j<w-1; j++) {\n      if( data[i][j] == emb[0][0] && data[i][j+1] == emb[0][1] &&  data[i+1][j] == emb[1][0] && data[i+1][j+1] == emb[1][1] ) {\n\tcnt++;\n      }\n    }\n  }\n\n  int after = 0, before = 0;\n  for(int i=0; i<h; i++) {\n    for(int j=0; j<w; j++) {\n      before = 0;\n      for(int k=0; k<4; i++) {\n\tint ny = i + dy[k], nx = j + dx[k];\n\tif( 0 <= nx && 0 <= ny && nx < w-1 && ny < h-1 ) {\n\t  if( data[ny][nx] == emb[0][0] && data[ny][nx+1] == emb[0][1] &&  data[ny+1][nx] == emb[1][0] && data[ny+1][nx+1] == emb[1][1] ) {\n\t  before++;\n\t  }\n\t}\n      }\n  \n      after = 0;\n      char tmp = data[i][j];\n      for(int l=0; l<3; l++) {\n\tif( joi[l] != tmp ) {\n\t  data[i][j] = joi[l];\n\t  for(int k=0; k<4; i++) {\n\t    int ny = i + dy[k], nx = j + dx[k];\n\t    if( 0 <= nx && 0 <= ny && nx < w-1 && ny < h-1 ) {\n\t      if( data[ny][nx] == emb[0][0] && data[ny][nx+1] == emb[0][1] &&  data[ny+1][nx] == emb[1][0] && data[ny+1][nx+1] == emb[1][1] ) {\n\t\tafter++;\n\t      }\n\t    }\n\t  }\n\t\n\t  ans = max(ans, cnt + (after - before));\n\t}\n      }\n      data[i][j] = tmp;\n    }\n  }\n\n  cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\nusing namespace std;\n\nchar a[1001][1001];\nchar joi[] = {'J', 'O', 'I'};\nvector<string> vs;\n\nbool func(int y, int x) {\n  for(int i=0; i<vs.size(); i++) {\n    for(int j=0; j<vs[i].size(); j++) {\n      if(a[y+i][x+j] != vs[i][j]) return false;\n    }\n  }\n  return true;\n}\n\nint main() {\n\n  int m, n;\n  cin >> m >> n;\n  for(int i=0; i<m; i++) {\n    for(int j=0; j<n; j++) {\n      cin >> a[i][j];\n    }\n  }\n  string tmp;\n  while(cin >> tmp) vs.push_back(tmp);\n\n  int ans = 0;\n  for(int i=0; i< m - vs.size() + 1; i++) {\n    for(int j=0; j < n - vs[i].size() + 1; j++) {\n      if(a[i][j] == vs[0][0] && func(i,j)) ans++;\n    }\n  }\n\n  for(int z = 0; z < 3; z++) {\n    for(int q=0; q < m; q++) {\n      for(int w=0; w < n; w++) {\n        char tmp = a[q][w];\n        a[q][w] = joi[z];\n        int num = 0;\n        for(int i=0; i< m - vs.size() + 1; i++) {\n          for(int j=0; j < n - vs[i].size() + 1; j++) {\n            if(a[i][j] == vs[0][0] && func(i,j)) num++;\n          }\n        }\n        ans = max(ans, num);\n        a[q][w] = tmp;\n      }\n    }\n  }\n  cout << ans << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n/* macro */\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define revrep(i,a,b) for(int i = a; i > b; i--)\n#define int long long\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define all(v) (v).begin(), (v).end()\n#define each(s,itr) for(auto (itr) = s.begin(); (itr) != s.end(); (itr)++)\n#define sum(v) accumulate(all(v), (0LL))\n#define isin(a, b, c) (b <= a && a <= c)\n#define println cout << \"\\n\";\n#define sz(v) (int)v.size()\n#define bin(x) static_cast<bitset<16> >(x)\n\n\n\n/* alias */\ntemplate<class T> using vec = vector<T>;\ntypedef vector<int> vi;\ntypedef pair<int, int> pi;\ntypedef tuple<int, int, int> ti;\ntypedef map<int, int> mi;\ntypedef set<int> si;\n\n\n/* constant */\nconst int inf = 1LL << 62;\nconst int mod = 1e9 + 7;\nconst int dx[8]={1,0,-1,0,-1,1,-1,1};\nconst int dy[8]={0,1,0,-1,-1,-1,1,1};\nconst string alphabet = \"abcdefghijklmnopqrstuvwxyz\";\n\n/* io_method */\nint input(){int tmp;cin >> tmp;return tmp;}\nstring raw_input(){string tmp;cin >> tmp;return tmp;}\ntemplate<class T> void printx(T n){cout << n;}\ntemplate<class T, class U> void printx(pair<T, U> p){cout << \"(\" << p.first << \",\" << p.second << \")\";}\ntemplate<class T, class U, class V> void printx(tuple<T, U, V> t){cout << \"{\" << get<0>(t) << \",\" << get<1>(t) <<\",\" << get<2>(t) << \"}\" << endl;}\ntemplate<class T> void printx(vector<T> v){cout << \"{\";rep(i,0,v.size()){printx(v[i]);if(i != v.size()-1)printx(\",\");}cout << \"}\";}\ntemplate<class T> void print(T n){printx(n);cout << endl;}\ntemplate<class T> void print(set<T> s){cout << \"{\";each(s, e){if(e != s.begin()) printx(\",\");printx(*e);}cout << \"}\" << endl;}\ntemplate<class T, class U> void print(map<T, U> mp){cout << \"{\";each(mp, e){cout << \"(\" << e -> first << \",\" << e -> second << \")\";}cout << \"}\" << endl;}\ntemplate<class T> void printans(vec<T> v){rep(i,0,sz(v)){cout << v[i] << (i == sz(v) - 1 ? \"\" : \" \");}cout << endl;}\n\n\n/* general_method */\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\ntemplate<class T>T cut(T &a, int l, int r){return T(a.begin()+l, a.begin()+r);}\n\n/* main */\n\nint h, w;\nvoid in(){\n    cin >> h >> w;\n}\n\nchar c[2][2];\nchar arr[1010][1010];\n\nint cnt(int i, int j, char t){\n    int cnt = 0;\n    char tmp = arr[i][j];\n    if(i - 1 > -1 && j - 1 > -1){//top left\n        cnt -= (arr[i - 1][j - 1] == c[0][0] && arr[i - 1][j] == c[0][1]\n                    && arr[i][j - 1] == c[1][0] && arr[i][j] == c[1][1]);\n    }\n\n    if(i - 1 > -1 && j + 1 < w){\n        cnt -= (arr[i - 1][j] == c[0][0] && arr[i - 1][j + 1] == c[0][1]\n                    && arr[i][j] == c[1][0] && arr[i][j + 1] == c[1][1]);\n    }\n\n    if(i + 1 < h && j - 1 > -1){\n        cnt -= (arr[i][j - 1] == c[0][0] && arr[i][j] == c[0][1]\n                    && arr[i + 1][j - 1] == c[1][0] && arr[i + 1][j] == c[1][1]);\n    }\n\n    if(i + 1 < h && j + 1 < w){\n        cnt -= (arr[i][j] == c[0][0] && arr[i][j + 1] == c[0][1]\n                    && arr[i + 1][j] == c[1][0] && arr[i + 1][j + 1] == c[1][1]);\n    }\n\n    arr[i][j] = t; //exchange\n\n    if(i - 1 > -1 && j - 1 > -1){//top left\n        cnt += (arr[i - 1][j - 1] == c[0][0] && arr[i - 1][j] == c[0][1]\n                    && arr[i][j - 1] == c[1][0] && arr[i][j] == c[1][1]);\n    }\n\n    if(i - 1 > -1 && j + 1 < w){\n        cnt += (arr[i - 1][j] == c[0][0] && arr[i - 1][j + 1] == c[0][1]\n                    && arr[i][j] == c[1][0] && arr[i][j + 1] == c[1][1]);\n    }\n\n    if(i + 1 < h && j - 1 > -1){\n        cnt += (arr[i][j - 1] == c[0][0] && arr[i][j] == c[0][1]\n                    && arr[i + 1][j - 1] == c[1][0] && arr[i + 1][j] == c[1][1]);\n    }\n\n    if(i + 1 < h && j + 1 < w){\n        cnt += (arr[i][j] == c[0][0] && arr[i][j + 1] == c[0][1]\n                    && arr[i + 1][j] == c[1][0] && arr[i + 1][j + 1] == c[1][1]);\n    }\n\n    arr[i][j] = tmp;\n    return cnt;\n\n}\n\nvoid solve(){\n    \n    \n    rep(i,0,h){\n        rep(j,0,w){\n            char t; cin >> t; arr[i][j] = t;\n        }\n    }\n\n    \n    rep(i,0,2) rep(j,0,2) {\n        char t; cin >> t; c[i][j] = t;\n    }\n\n    vec<char> joi = {'J', 'O', 'I'};\n\n    int ans = 0;\n\n    rep(i,0,h){\n        rep(j,0,w){\n            for(char e : joi){\n                chmax(ans, cnt(i,j,e));\n            }\n        }\n    }\n\n    int tmp = 0;\n    rep(i,0,h - 1){\n        rep(j,0, w - 1){\n            tmp += (arr[i][j] == c[0][0] && arr[i][j + 1] == c[0][1] &&\n                        arr[i + 1][j] == c[1][0] && arr[i + 1][j + 1] == c[1][1]);\n        }\n    }\n\n    print(tmp + ans);\n\n\n}\n\nsigned main(){\n\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    in();\n    solve();\n    \n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar field[1010][1010];\nint score[1010][1010] = {0};\nint main()\n{\n    char E[2][2];\n    int x,y,cou = 0,ans = 0,mx,my;\n    int dx[] = {0,1,0,1},dy[] = {0,0,1,1};\n    scanf(\"%d%d\",&y,&x);\n    for(int i = 0; i < y; i++)\n    {\n        scanf(\" %c\",&field[0][i]);\n        for(int j = 1; j < x; j++)\n            scanf(\"%c\",&field[j][i]);\n    }\n    for(int i = 0; i < 2; i++)\n    {\n        scanf(\" %c\",&E[0][i]);\n        for(int j = 1; j < 2; j++)\n            scanf(\"%c\",&E[j][i]);\n    }\n    for(int i = 0; i < y - 1; i++)\n        for(int j = 0; j < x - 1; j++)\n        {\n            for(int k = 0; k < 4; k++)\n                if(field[j + dx[k]][i + dy[k]] == E[dx[k]][dy[k]])\n                    cou++;\n                else\n                {\n                    mx = j + dx[k];\n                    my = i + dy[k];\n                }\n            if(cou == 3)score[mx][my]++;\n            else if(cou == 4)\n            {\n                ans++;\n                for(int k = 0; k < 4; k++)\n                    score[j + dx[k]][i + dy[k]]--;\n            }\n            cou = 0;\n        }\n    for(int i = 0; i < y; i++)\n        for(int j = 0; j < x; j++)\n            cou = max(cou,score[j][i]);\n    printf(\"%d\\n\",ans + cou);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "//安定の時間超過でクッソワロタWWW\n#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nchar constfield[1002][1002];\nint i,j,k;\nint ans;\nint bans;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tbans = Check_num();\n\t//ここの計算量やばくね！？！？\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tif(mem == f[k])continue;\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\t//\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] != c[0][0])continue;\n\t\t\tif(field[i][j+1] != c[0][1])continue;\n\t\t\tif(field[i+1][j] != c[1][0])continue;\n\t\t\tif(field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(){\n  int w,h,a,b,c,i,j,k,l,n,y,x,ans,max;\n  char e[3][3],f[1003][1003]={0};\n  char s[5]=\" JOI\";\n  scanf(\"%d %d\",&h,&w);\n  for(i=ans=0;i<h;i++)scanf(\"%s\",f[i+1]+1);\n  for(i=max=0;i<2;i++)scanf(\"%s\",e[i]);\n  for(i=1;i<=h;i++){\n    for(j=1;j<=w;j++){\n      c=f[i][j];//printf(\"%c:\",c);\n      for(k=0;k<4;k++){\n\tif(k)f[i][j]=s[k];\n\tfor(l=a=0;l<4;l++){\n\t  for(n=0;n<4;n++){\n\t    y=n/2-l/2;\n\t    x=n%2-l%2;//printf(\"%c %c  \",f[i+y][j+x],e[n/2][n%2]);\n\t    if(f[i+y][j+x]-e[n/2][n%2])break;\n\t  }//printf(\"\\n\");\n\t  if(n==4)a++;\n\t}\n\tif(k==0)b=a;\n\tif(max<a-b)max=a-b;\n      }\n      ans+=b;//printf(\"%d\\n\",ans);\n      f[i][j]=c;\n    }\n  }//printf(\"\\n\");\n  printf(\"%d\\n\",ans/4+max);\n  return 0;\n}\n "
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint M,N;\nchar hata[1000][1001],niko[2][3],tmp[4] = \"JOI\";\n\t\nint check(int y,int x){\n\tint i,j;\n\t\n\tif(x < 0 || y < 0 || y+1 >= M || x+1 >= N) return 0;\n\t\n\tfor(i = 0;i < 2;i++){\n\t\tfor(j = 0;j < 2;j++){\n\t\t\tif(hata[y+i][x+j] != niko[i][j]){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn 1;\n}\n\nint main(void) {\n\tint i,j,k,cnt,max,tmpn,tmpc;\n\t\n\tscanf(\"%d %d\",&M,&N);\n\tfor(i = 0;i < M;i++){\n\t\tscanf(\"%s\",hata[i]);\n\t}\n\t\n\tfor(i = 0;i < 2;i++){\n\t\tscanf(\"%s\",niko[i]);\n\t}\n\t\n\tcnt = 0;\n\tfor(i = 0;i < M-1;i++){\n\t\tfor(j = 0;j < N-1;j++){\n\t\t\tif(hata[i][j] == niko[0][0]){\n\t\t\t\tif(check(i,j)){\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmax = 0;\n\tfor(i = 0;i < M;i++){\n\t\tfor(j = 0;j < N;j++){\n\t\t\tfor(k = 0;k < 3;k++){\n\t\t\t\tif(hata[i][j] != tmp[k]){\n\t\t\t\t\ttmpc = hata[i][j];\n\t\t\t\t\thata[i][j] = tmp[k];\n\t\t\t\t\ttmpn = check(i,j)+check(i-1,j)+check(i,j-1)+check(i-1,j-1);\n\t\t\t\t\tif(tmpn > max){\n\t\t\t\t\t\tmax = tmpn;\n\t\t\t\t\t}\n\t\t\t\t\thata[i][j] = tmpc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprintf(\"%d\\n\",max+cnt);\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ \t0598: JOI Emblem\n// 2018.1.26 bal4u\n\n#include <stdio.h>\n#include <string.h>\n\nint h, w;\nchar s[1005][1005];\nchar t[3][5];\n\nint f(int r, int c)\n{\n\tint ans = 0;\n\n\tif (r >= 1 && c >= 1 && s[r-1][c-1] == t[0][0] && s[r-1][c] == t[0][1] && s[r][c-1] == t[1][0] && s[r][c] == t[1][1]) ans++;\n\tif (r >= 1 && c < w  && s[r-1][c] == t[0][0] && s[r-1][c+1] == t[0][1] && s[r][c] == t[1][0] && s[r][c+1] == t[1][1]) ans++;\n\tif (r < h  && c >= 1 && s[r][c-1] == t[0][0] && s[r][c] == t[0][1] && s[r+1][c-1] == t[1][0] && s[r+1][c] == t[1][1]) ans++;\n\tif (r < h  && c < w  && s[r][c] == t[0][0] && s[r][c+1] == t[0][1] && s[r+1][c] == t[1][0] && s[r+1][c+1] == t[1][1]) ans++;\n\treturn ans;\n}\n\nint main()\n{\n\tint m, n, i, r, c, t1, t2, ans, cnt;\n\tchar buf[15], cc, a[4] = \"JOI\";\n\n\tfgets(buf, 15, stdin), sscanf(buf, \"%d%d\", &m, &n); h = m-1, w = n-1;\n\tfor (r = 0; r < m; r++) fgets(s[r], 1005, stdin);\n\tfor (r = 0; r < 2; r++) fgets(t[r], 5, stdin);\n\n\tans = 0;\n\tfor (r = 0; r < h; r++) for (c = 0; c < w; c++) {\n\t\tif (s[r][c] == t[0][0] && s[r][c+1] == t[0][1] && s[r+1][c] == t[1][0] && s[r+1][c+1] == t[1][1])\n\t\t\tans++;\n\t}\n\t\n\tcnt = 0;\n\tfor (r = 0; r < m; r++) for (c = 0; c < n; c++) {\n\t\tcc = s[r][c];\n\t\tt1 = f(r, c);\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\ts[r][c] = a[i], t2 = f(r, c);\n\t\t\tif (t2 - t1 > cnt) cnt = t2 - t1;\n\t\t}\n\t\ts[r][c] = cc;\n\t}\n\n\tprintf(\"%d\\n\", ans + cnt);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C",
    "code": "// AOJ \t0598: JOI Emblem\n// 2018.1.26 bal4u\n\n#include <stdio.h>\n#include <string.h>\n\nchar s[1005][1005];\nchar e[4];\n\nint calc(int r, int c)\n{\n\tint k = 0;\n\tif (s[r-1][c-1] == e[0] && s[r-1][c] == e[1] && s[r][c-1] == e[2] && s[r][c] == e[3]) k++;\n\tif (s[r-1][c] == e[0] && s[r-1][c+1] == e[1] && s[r][c] == e[2] && s[r][c+1] == e[3]) k++;\n\tif (s[r][c-1] == e[0] && s[r][c] == e[1] && s[r+1][c-1] == e[2] && s[r+1][c] == e[3]) k++;\n\tif (s[r][c] == e[0] && s[r][c+1] == e[1] && s[r+1][c] == e[2] && s[r+1][c+1] == e[3]) k++;\n\treturn k;\n}\n\nint main()\n{\n\tint m, n, i, r, c, f1, f2, ans, cnt;\n\tchar buf[15], cc, a[4] = \"JOI\";\n\n\tfgets(buf, 15, stdin), sscanf(buf, \"%d%d\", &m, &n);\n\tfor (r = 1; r <= m; r++) fgets(s[r]+1, 1005, stdin); memset(s[r], 0, n);\n\tfgets(e, 4, stdin), fgets(buf, 4, stdin), e[2] = buf[0], e[3] = buf[1];\n\n\tans = 0;\n\tfor (r = 1; r < m; r++) for (c = 1; c < n; c++) {\n\t\tif (s[r][c] == e[0] && s[r][c+1] == e[1] && s[r+1][c] == e[2] && s[r+1][c+1] == e[3]) ans++;\n\t}\n\t\n\tcnt = 0;\n\tfor (r = 1; r <= m; r++) for (c = 1; c <= n; c++) {\n\t\tcc = s[r][c];\n\t\tf1 = calc(r, c);\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\ts[r][c] = a[i], f2 = calc(r, c);\n\t\t\tif (f2 - f1 > cnt) cnt = f2 - f1;\n\t\t}\n\t\ts[r][c] = cc;\n\t}\n\tprintf(\"%d\\n\", ans + cnt);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nint i,j,k;\nint ans;\nint bans;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tbans = Check_num();\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] == c[0][0] && field[i][j+1] == c[0][1] && field[i+1][j] == c[1][0] && field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint M,N;\nchar map[1000][1024];\nchar JOI[4][4];\nint cnt[1000][1000];\nint osii[4][1000][1000];\n\nint id(char c) {\n\tswitch(c) {\n\t\tcase 'J': return 0;\n\t\tcase 'O': return 1;\n\t\tcase 'I': return 2;\n\t}\n\treturn 3;\n}\n\nint main(void) {\n\tint i,j,k;\n\tint answer;\n\tint raw_count=0;\n\tif(scanf(\"%d%d\",&M,&N)!=2)return 1;\n\tfor(i=0;i<M;i++) {\n\t\tif(scanf(\"%s\",map[i])!=1)return 1;\n\t}\n\tif(scanf(\"%s%s\",JOI[0],JOI[1])!=2)return 1;\n\tfor(i=1;i<M;i++) {\n\t\tfor(j=1;j<N;j++) {\n\t\t\tint match=0;\n\t\t\tint di,dj;\n\t\t\tint ii,jj;\n\t\t\tfor(di=0;di<=1;di++) {\n\t\t\t\tfor(dj=0;dj<=1;dj++) {\n\t\t\t\t\tif(map[i-di][j-dj]==JOI[1-di][1-dj]) {\n\t\t\t\t\t\tmatch++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tii=di;\n\t\t\t\t\t\tjj=dj;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(match==4) {\n\t\t\t\traw_count++;\n\t\t\t\tcnt[i][j]++;\n\t\t\t\tcnt[i-1][j]++;\n\t\t\t\tcnt[i][j-1]++;\n\t\t\t\tcnt[i-1][j-1]++;\n\t\t\t} else if(match==3) {\n\t\t\t\tosii[id(JOI[1-ii][1-jj])][i-ii][j-jj]++;\n\t\t\t}\n\t\t}\n\t}\n\tanswer=raw_count;\n\tfor(i=0;i<M;i++) {\n\t\tfor(j=0;j<N;j++) {\n\t\t\tfor(k=0;k<3;k++) {\n\t\t\t\tint new_answer=raw_count+osii[k][i][j]-cnt[i][j];\n\t\t\t\tif(new_answer>answer)answer=new_answer;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",answer);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 0598\n  Title:JOI Emblem\n  @kankichi573\n*/\n#include <stdio.h>\n\nint m,n;\nchar hata[1000][1001];\nchar template[2][3];\n\nmain()\n{\n  int i,j,cnt,cnt3,cnt4;\n\n  scanf(\"%d %d\",&m,&n);\n  for(i=0;i<m;i++)\n    scanf(\"%s\",&hata[i][0]);\n  for(i=0;i<2;i++)\n    scanf(\"%s\",&template[i][0]);\n  cnt3=cnt4=0;\n\n  for(i=0;i<m-1;i++)\n    for(j=0;j<n-1;j++)\n    {\n      cnt=0;\n      cnt+=(hata[i][j]==template[0][0])?1:0;\n      cnt+=(hata[i+1][j]==template[1][0])?1:0;\n      cnt+=(hata[i][j+1]==template[0][1])?1:0;\n      cnt+=(hata[i+1][j+1]==template[1][1])?1:0;\n      if(cnt==4)\n\tcnt4++;\n      if(cnt==3)\n\tcnt3++;\n    }\n  printf(\"%d\\n\",cnt4+(cnt3>0?1:0));\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nint i,j,k;\nint ans;\nint bans;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tbans = Check_num();\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tif(mem == f[k])continue;\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] == c[0][0] && field[i][j+1] == c[0][1] && field[i+1][j] == c[1][0] && field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <stdbool.h>\n\n#define S_MAX 1000\n#define N_MAX 100000\n#define M_MAX 100000\n#define INF 2000000000\n#define MOD 1000000007\n#define SMAP(a, b) ((a)!=(b))&&((a)^=((b)^=((a)^= (b))))\n\ntypedef unsigned long long ull;\ntypedef   signed long long dll;\n\ntypedef struct {\n\tint a;\n\tint b;\n\tint c;\n} moneydata;\n\nint n, m;\nint h, w;\nint i, j;\nint k;\n\nchar a[S_MAX][S_MAX + 1];\nchar monsho[2][2 + 1];\n\nint max(int a, int b){\n\treturn (a > b) ? a : b;\n}\n\nint tokeynum(char c){\n\tswitch(c){\n\tcase 'J':\n\t\treturn 0;\n\tcase 'O':\n\t\treturn 1;\n\tcase 'I':\n\t\treturn 2;\n\t}\n\treturn -1;\n}\n\nchar tochar(int n){\n\treturn \"JOI\"[n];\n}\n\nint mdiff(int i, int j){\n\tint s[3] = {0};\n\tint prevkey = tokeynum(a[i][j]);\n\n\tif (i > 0 && j > 0 &&\n\t\ta[i-1][j-1] == monsho[0][0] &&\n\t\ta[i-1][j] == monsho[0][1] &&\n\t\ta[i][j-1] == monsho[1][0]) {\n\t\ts[tokeynum(monsho[1][1])]++;\n\t}\n\tif (i > 0 && j < w-1 &&\n\t\ta[i-1][j] == monsho[0][0] &&\n\t\ta[i-1][j+1] == monsho[0][1] &&\n\t\ta[i][j+1] == monsho[1][1]) {\n\t\ts[tokeynum(monsho[1][0])]++;\n\t}\n\tif (i < h-1 && j > 0 &&\n\t\ta[i][j-1] == monsho[0][0] &&\n\t\ta[i+1][j-1] == monsho[1][0] &&\n\t\ta[i+1][j] == monsho[1][1]) {\n\t\ts[tokeynum(monsho[0][1])]++;\n\t}\n\tif (i < h-1 && j < w-1 &&\n\t\ta[i][j+1] == monsho[0][1] &&\n\t\ta[i+1][j] == monsho[1][0] &&\n\t\ta[i+1][j+1] == monsho[1][1]) {\n\t\ts[tokeynum(monsho[0][0])]++;\n\t}\n\n\treturn max(s[(prevkey + 1) % 3], s[(prevkey + 2) % 3]) - s[prevkey];\n}\n\nvoid solve(){\n\tint result = 0;\n\tint maxdiff = 0;\n\tfor (i = 0; i < h - 1; i++) {\n\t\tfor (j = 0; j < w - 1; j++) {\n\t\t\tif (a[i][j] == monsho[0][0] &&\n\t\t\t\ta[i][j+1] == monsho[0][1] &&\n\t\t\t\ta[i+1][j] == monsho[1][0] &&\n\t\t\t\ta[i+1][j+1] == monsho[1][1]) {\n\t\t\t\tresult++;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (i = 0; i < h; i++) {\n\t\tfor (j = 0; j < w; j++) {\n\t\t\tint tdiff = mdiff(i, j);\n\t\t\tif (tdiff > maxdiff) maxdiff = tdiff;\n\t\t}\n\t}\n\n\tprintf(\"%d\\n\", result + maxdiff);\n\n\treturn;\n}\n\nint main (void) {\n\tscanf(\"%d%d\", &h, &w);\n\tfor (i = 0; i < h; i++) scanf(\"%s\", a[i]);\n\tscanf(\"%s%s\", monsho[0], monsho[1]);\n\n\tsolve();\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nint i,j,k;\nint ans;\nint bans;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tans = Check_num();\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] == c[0][0] && field[i][j+1] == c[0][1] && field[i+1][j] == c[1][0] && field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num+1;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\nchar field[1000][1000];\nint i,j,k;\nint ans = 0;\nint bans = 0;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tscanf(\"%c\",&field[i][j]);\n\t\t}\n\t}\n\tfor(i=0;i<2;i++){\n\t\tfor(j=0;j<2;j++){\n\t\t\tscanf(\"%c\",&c[i][j]);\n\t\t}\n\t}\n\tans = Check_num();\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] == c[i][j] && field[i][j+1] == c[i][j+1] && field[i+1][j] == c[i+1][j] && field[i+1][j+1] == c[i+1][j+1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nint i,j,k;\nint ans = 0;\nint bans = 0;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tans = Check_num();\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] == c[0][0] && field[i][j+1] == c[0][1] && field[i+1][j] == c[1][0] && field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num+1;\n}"
  },
  {
    "language": "C",
    "code": "//安定の時間超過でクッソワロタWWW\n#include <stdio.h>\n#include <stdlib.h>\nchar field[1002][1002];\nchar constfield[1002][1002];\nint i,j,k;\nint ans;\nint bans;\nint depth,len;\nchar c[2][2];\nchar mem;\nint Check_num();\nchar f[3];\nint main(){\n\tf[0] = 'J';\n\tf[1] = 'O';\n\tf[2] = 'I';\n\tscanf(\"%d %d\", &depth,&len);\n\tfor(i=0;i<depth;i++){\n\t\tscanf(\"%s\",&field[i]);\n\t}\n\tfor(i=0;i<2;i++){\n\t\tscanf(\"%s\",&c[i]);\n\t}\n\tbans = Check_num();\n\t//ここの計算量やばくね！？！？\n\tfor(i=0;i<depth;i++){\n\t\tfor(j=0;j<len;j++){\n\t\t\tmem = field[i][j];\n\t\t\tfor(k=0;k<3;k++){\n\t\t\t\tif(mem == f[k])continue;\n\t\t\t\tfield[i][j] = f[k];\n\t\t\t\tans = Check_num();\n\t\t\t\tif(bans < ans){\n\t\t\t\t\tbans = ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfield[i][j] = mem;\n\t\t}\n\t}\n\t//\n\tprintf(\"%d\\n\",bans);\n\treturn 0;\n}\n\nint Check_num(){\n\tint num,i,j;\n\tnum = 0;\n\tfor(i=0;i<depth-1;i++){\n\t\tfor(j=0;j<len-1;j++){\n\t\t\tif(field[i][j] != c[0][0])continue;\n\t\t\tif(field[i][j+1] == c[0][1])continue;\n\t\t\tif(field[i+1][j] == c[1][0])continue;\n\t\t\tif(field[i+1][j+1] == c[1][1]){\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n \nint H,W,total=0,maxm=0;\n \nchar t[1005][1005];\nchar u[5][5];\nchar v[]={'J','O','I'};\n \n \nint check(int y,int x){\n  if(y<0 || x<0)return 0;\n  if(y+1>=H || x+1>=W)return 0;\n   \n  int i,j;\n  for(i=0;i<2;i++)\n    for(j=0;j<2;j++)\n      if(t[y+i][x+j]!=u[i][j])\n        return 0;\n  return 1;\n}\n \nint count(int y,int x){\n  int i,j,cnt=0;\n  for(i=-1;i<=0;i++){\n    for(j=-1;j<=0;j++){\n      cnt+=check(y+i,x+j);\n    }\n  }\n  return cnt;\n}\n \nint main(){\n  int i,j,k,a,b;\n  char tmp;\n   \n  scanf(\"%d %d\",&H,&W);\n  for(i=0;i<H;i++)scanf(\"%s\",t[i]);\n  for(i=0;i<2;i++)scanf(\"%s\",u[i]);\n   \n  for(i=0;i+1<H;i++)\n    for(j=0;j+1<W;j++)\n      total+=check(i,j);\n \n \n  for(i=0;i<H;i++){\n    for(j=0;j<W;j++){\n    \n      a=count(i,j);\n      tmp=t[i][j];\n       \n      for(k=0;k<3;k++){\n        t[i][j]=v[k];\n        b=count(i,j);\n        if(maxm<b-a)maxm=b-a;\n      }\n       \n      t[i][j]=tmp;\n    }\n  }\n  printf(\"%d\\n\",total+maxm);\n  return 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.Comparator;\nimport java.util.PriorityQueue;\n\npublic class Main {\n\tstatic boolean debug = true;\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tUserScanner scan = new UserScanner(System.in);\n\t\tPrintWriter pwriter = new PrintWriter(System.out);\n\n\t\tint m = scan.nextInt();\n\t\tint n = scan.nextInt();\n\t\tFlag fg = new Flag(m, n);\n\t\tfor (int i = 0; i < m; i++)\n\t\t\tfg.addChar(i, scan.next());\n\t\tfg.addEmblem(scan.next(), scan.next());\n\n\t\tpwriter.println(fg.getMaxEmblem());\n\n\t\tpwriter.flush();\n\n\t\tscan.close();\n\t\tSystem.exit(0);\n\t}\n}\n\nclass Flag {\n\t// 'fg' is match counter\n\t// fg[0] is used as match with emblem\n\t// fg[1], fg[2], fg[3] is used as match count if it change to I, O, J\n\n\tint[][][] fg;\n\n\tString[] fc;\n\n\tchar e00, e01, e10, e11; // emblem character\n\tint[] ioj = new int[256]; // used to convert I to 1, O to 2, J to 3\n\n\tpublic Flag(int m, int n) {\n\t\tfg = new int[4][m][n];\n\t\tfc = new String[m];\n\t\tioj['I'] = 1;\n\t\tioj['O'] = 2;\n\t\tioj['J'] = 3;\n\t}\n\n\tpublic int getMaxEmblem() {\n\t\t// scan all flag area to count up fg[]\n\t\tint cnt = setMatchCount();\n\n\t\t// adjust for using white paper\n\t\tcnt += getIncrease();\n\n\t\treturn cnt;\n\t}\n\n\tprivate int getIncrease() {\n\t\tint ret = 0;\n\t\tfor (int m = 0; m < fg[0].length; m++)\n\t\t\tfor (int n = 0; n < fg[0][0].length; n++) {\n\t\t\t\tint ic = Math.max(fg[1][m][n], Math.max(fg[2][m][n], fg[3][m][n]));\n\t\t\t\tic -= fg[0][m][n];\n\t\t\t\tret = Math.max(ret, ic);\n\t\t\t\t// increase match count by change character, but decrease\n\t\t\t\t// already matched\n\t\t\t}\n\t\treturn ret;\n\t}\n\n\tprivate int setMatchCount() {\n\t\tint c = 0;\n\t\tfor (int m = 0; m < fg[0].length - 1; m++)\n\t\t\tfor (int n = 0; n < fg[0][0].length - 1; n++)\n\t\t\t\tc += setMatch(m, n);\n\t\treturn c;\n\t}\n\n\tprivate int setMatch(int m, int n) {\n\t\tchar f00 = fc[m].charAt(n);\n\t\tchar f01 = fc[m].charAt(n + 1);\n\t\tchar f10 = fc[m + 1].charAt(n);\n\t\tchar f11 = fc[m + 1].charAt(n + 1);\n\n\t\tboolean match = false;\n\t\tif (f00 == e00)\n\t\t\tif (f01 == e01)\n\t\t\t\tif (f10 == e10)\n\t\t\t\t\tif (f11 == e11) {\n\t\t\t\t\t\t// all matched with emblem\n\t\t\t\t\t\tfg[0][m][n]++;\n\t\t\t\t\t\tfg[0][m][n + 1]++;\n\t\t\t\t\t\tfg[0][m + 1][n]++;\n\t\t\t\t\t\tfg[0][m + 1][n + 1]++;\n\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t} else\n\t\t\t\t\t\t// 3 character matched\n\t\t\t\t\t\tfg[ioj[e11]][m + 1][n + 1]++;\n\t\t\t\telse if (f11 == e11)\n\t\t\t\t\tfg[ioj[e10]][m + 1][n]++;\n\t\t\t\telse\n\t\t\t\t\t;\n\t\t\telse if (f10 == e10 && f11 == e11)\n\t\t\t\tfg[ioj[e01]][m][n + 1]++;\n\t\t\telse\n\t\t\t\t;\n\t\telse if (f01 == e01 && f10 == e10 && f11 == e11)\n\t\t\tfg[ioj[e00]][m][n]++;\n\t\telse\n\t\t\t;\n\n\t\tif (match)\n\t\t\treturn 1;\n\t\telse\n\t\t\treturn 0;\n\t}\n\n\tpublic void addEmblem(String s0, String s1) {\n\t\te00 = s0.charAt(0);\n\t\te01 = s0.charAt(1);\n\t\te10 = s1.charAt(0);\n\t\te11 = s1.charAt(1);\n\t}\n\n\tpublic void addChar(int m, String s) {\n\t\tfc[m] = new String(s);\n\t}\n\n}\n\nclass UserScanner {\n\tprivate InputStream in;\n\tprivate final byte[] buffer = new byte[1024];\n\tprivate int ptr = 0;\n\tprivate int buflen = 0;\n\n\tpublic UserScanner(InputStream inStream) {\n\t\tin = inStream;\n\t}\n\n\tprivate void read() {\n\t\tptr = 0;\n\t\ttry {\n\t\t\tbuflen = in.read(buffer);\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t\tSystem.exit(9);\n\t\t}\n\t}\n\n\tprivate byte getByte() {\n\t\tif (ptr >= buflen)\n\t\t\tread();\n\t\tif (buflen < 0 || isCtlSpace(buffer[ptr])) {\n\t\t\treturn -1;\n\t\t} else\n\t\t\treturn buffer[ptr++];\n\t}\n\n\tprivate void skipCtlSpace() {\n\t\tfor (; ptr < buflen; ptr++)\n\t\t\tif (!isCtlSpace(buffer[ptr]))\n\t\t\t\treturn;\n\t\tread();\n\t\tskipCtlSpace();\n\t}\n\n\tprivate boolean isCtlSpace(byte b) {\n\t\tif (b <= ' ' || b > '~')\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tpublic void close() {\n\t\ttry {\n\t\t\tin.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t\tSystem.exit(9);\n\t\t}\n\t}\n\n\tpublic String next() {\n\t\tskipCtlSpace();\n\t\tStringBuilder sb = new StringBuilder();\n\t\tbyte b;\n\t\twhile ((b = getByte()) != -1) {\n\t\t\tsb.appendCodePoint(b);\n\t\t}\n\t\treturn sb.toString();\n\t}\n\n\tpublic int nextInt() {\n\t\tskipCtlSpace();\n\t\tint n = 0;\n\t\tboolean minus = false;\n\t\tbyte b;\n\t\twhile ((b = getByte()) != -1) {\n\t\t\tif (b == '-')\n\t\t\t\tminus = true;\n\t\t\telse {\n\t\t\t\tn *= 10;\n\t\t\t\tn += (b - '0');\n\t\t\t}\n\t\t}\n\t\tif (minus)\n\t\t\treturn n * -1;\n\t\telse\n\t\t\treturn n;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint sum=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=0;\nif(i!=0&&j!=0) t+=count[i-1][j-1];\nif(i!=0) t+=count[i-1][j];\nif(j!=0) t+=count[i][j-1];\nt+=count[i][j];\nsum+=t;\n}\n}\nint ans=sum;\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint t=sum;\nif(i!=0&&j!=0) t-=4*count[i-1][j-1];\nif(i!=0) t-=4*count[i-1][j];\nif(j!=0) t-=4*count[i][j-1];\nt-=4*count[i][j];\nflag[i][j]=JOI[k];\nt+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(t,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m-1||y>=n-1) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\nreturn 0;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=numOfEmblems();\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nflag[i][j]=JOI[k];\nans=Math.max(ans,numOfEmblems());\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans);\nout.flush();\n}\n\npublic static int numOfEmblem(){\nint cnt=0;\nfor(int i=0;i<m-1;i++){\nfor(int j=0;j<n-1;j++){\nif(flag[i][j]==emblem[0][0]&&flag[i][j+1]==emblem[0][1]&&flag[i+1][j]==emblem[1][0]&&flag[i+1][j+1]==emblem[1][1]) cnt++;\n}\n}\nreturn cnt;\n}\n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=0,sum=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=0;\nif(i!=0&&j!=0) t+=count[i-1][j-1];\nif(i!=0) t+=count[i-1][j];\nif(j!=0) t+=count[i][j-1];\nt+=count[i][j];\nsum+=t;\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint t=sum;\nif(i!=0&&j!=0) t-=4*count[i-1][j-1];\nif(i!=0) t-=4*count[i-1][j];\nif(j!=0) t-=4*count[i][j-1];\nt-=4*count[i][j];\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m-1||y>=n-1) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\nreturn 0;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n     \n     \npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint m = sc.nextInt();\n\t\tint n = sc.nextInt();\n\t\tchar[][] map = new char[m][];\n\t\tfor(int i = 0; i < m; i++ ) {\n\t\t\tmap[i] = sc.next().toCharArray();\n\t\t}\n\t\tString A = sc.next();\n\t\tString B = sc.next();\n\t\tchar A1 = A.charAt(0);\n\t\tchar A2 = A.charAt(1);\n\t\tchar B1 = B.charAt(0);\n\t\tchar B2 = B.charAt(1);\n\t\tint ck = 0;\n\t\tint[][] count = new int[m][n];\n\t\tfor(int i = 0; i < m-1; i++) {\n\t\t\tfor(int j = 0; j < n-1; j++) {\n\t\t\t\tchar a1 = map[i][j];\n\t\t\t\tchar a2 = map[i][j+1];\n\t\t\t\tchar b1 = map[i+1][j];\n\t\t\t\tchar b2 = map[i+1][j+1];\n\t\t\t\tint cunt = 0;\n\t\t\t\tif(a1 == A1) cunt++;\n\t\t\t\tif(a2 == A2) cunt++;\n\t\t\t\tif(b1 == B1) cunt++;\n\t\t\t\tif(b2 == B2) cunt++;\n\t\t\t\tif(cunt == 4) {\n\t\t\t\t\tcount[i][j]--;\n\t\t\t\t\tcount[i][j+1]--;\n\t\t\t\t\tcount[i+1][j]--;\n\t\t\t\t\tcount[i+1][j+1]--;\n\t\t\t\t\tck++;\n\t\t\t\t}\n\t\t\t\telse if(cunt == 3) {\n\t\t\t\t\tif(a1 != A1) {\n\t\t\t\t\t\tcount[i][j]++;\n\t\t\t\t\t}\n\t\t\t\t\telse if(a2 != A2) {\n\t\t\t\t\t\tcount[i][j+1]++;\n\t\t\t\t\t}\n\t\t\t\t\telse if(b1 != B1) {\n\t\t\t\t\t\tcount[i+1][j]++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcount[i+1][j+1]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint max = 0;\n\t\tfor(int i = 0; i < m; i++) {\n\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\tmax = Math.max(count[i][j], max);\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(ck + max);\n\t\t\n\t\t\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nchar[][] count=new char[m][n];\nint ans=0;\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\ncount[i][j]=_count(i-1,j-1)+_count(i,j-1)+_count(i,j)+_count(i-1,j);\nsum+=count[i][j];\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint cnt=sum-(4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j));\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m||y>=n) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=numOfEmblems();\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nflag[i][j]=JOI[k];\nans=Math.max(ans,numOfEmblems());\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans);\nout.flush();\n}\n\npublic staitc int numOfEmblem(){\nint cnt=0;\nfor(int i=0;i<m-1;i++){\nfor(int j=0;j<n-1;j++){\nif(flag[i][j]==emblem[0][0]&&flag[i][j+1]==emblem[0][1]&&flag[i+1][j]==emblem[1][0]&&flag[i+1][j+1]==emblem[1][1]) cnt++;\n}\n}\nreturn cnt;\n}\n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=ir.next().toCharArray();\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.Comparator;\nimport java.util.PriorityQueue;\n\npublic class Main {\n\tstatic boolean debug = true;\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tUserScanner scan = new UserScanner(System.in);\n\t\tPrintWriter pwriter = new PrintWriter(System.out);\n\n\t\tint m = scan.nextInt();\n\t\tint n = scan.nextInt();\n\t\tFlag fg = new Flag(m, n);\n\t\tfor (int i = 0; i < m; i++)\n\t\t\tfg.addChar(i, scan.next());\n\t\tfg.addEmblem(scan.next(), scan.next());\n\n\t\tpwriter.println(fg.getMaxEmblem());\n\n\t\tpwriter.flush();\n\n\t\tscan.close();\n\t\tSystem.exit(0);\n\t}\n}\n\nclass Flag {\n\tint[][][] fg;\n\tString[] fc;\n\tchar e00, e01, e10, e11;\n\tint[] ioj = new int[256];\n\n\tpublic Flag(int m, int n) {\n\t\tfg = new int[4][m][n];\n\t\tfc = new String[m];\n\t\tioj['I'] = 1;\n\t\tioj['O'] = 2;\n\t\tioj['J'] = 3;\n\t}\n\n\tpublic int getMaxEmblem() {\n\t\tint cnt = setMatchCount();\n\t\tcnt += getIncrease();\n\t\treturn cnt;\n\t}\n\n\tprivate int getIncrease() {\n\t\tint ret = 0;\n\t\tfor (int m = 0; m < fg[0].length; m++)\n\t\t\tfor (int n = 0; n < fg[0][0].length; n++) {\n\t\t\t\tint ic = Math.max(fg[1][m][n], Math.max(fg[2][m][n], fg[3][m][n]));\n\t\t\t\tic -= fg[0][m][n];\n\t\t\t\tret = Math.max(ret, ic);\n\t\t\t}\n\t\treturn ret;\n\t}\n\n\tprivate int setMatchCount() {\n\t\tint c = 0;\n\t\tfor (int m = 0; m < fg[0].length - 1; m++)\n\t\t\tfor (int n = 0; n < fg[0][0].length - 1; n++)\n\t\t\t\tc += setMatch(m, n);\n\t\treturn c;\n\t}\n\n\tprivate int setMatch(int m, int n) {\n\t\tchar f00 = fc[m].charAt(n);\n\t\tchar f01 = fc[m].charAt(n + 1);\n\t\tchar f10 = fc[m + 1].charAt(n);\n\t\tchar f11 = fc[m + 1].charAt(n + 1);\n\n\t\tboolean match = false;\n\t\tif (f00 == e00)\n\t\t\tif (f01 == e01)\n\t\t\t\tif (f10 == e10)\n\t\t\t\t\tif (f11 == e11) {\n\t\t\t\t\t\tfg[0][m][n]++;\n\t\t\t\t\t\tfg[0][m][n + 1]++;\n\t\t\t\t\t\tfg[0][m + 1][n]++;\n\t\t\t\t\t\tfg[0][m + 1][n + 1]++;\n\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t} else\n\t\t\t\t\t\tfg[ioj[e11]][m + 1][n + 1]++;\n\t\t\t\telse if (f11 == e11)\n\t\t\t\t\tfg[ioj[e10]][m + 1][n]++;\n\t\t\t\telse\n\t\t\t\t\t;\n\t\t\telse if (f10 == e10 && f11 == e11)\n\t\t\t\tfg[ioj[e01]][m][n + 1]++;\n\t\t\telse\n\t\t\t\t;\n\t\telse if (f01 == e01 && f10 == e10 && f11 == e11)\n\t\t\tfg[ioj[e00]][m][n]++;\n\t\telse\n\t\t\t;\n\n\t\tif (match)\n\t\t\treturn 1;\n\t\telse\n\t\t\treturn 0;\n\t}\n\n\tpublic void addEmblem(String s0, String s1) {\n\t\te00 = s0.charAt(0);\n\t\te01 = s0.charAt(1);\n\t\te10 = s1.charAt(0);\n\t\te11 = s1.charAt(1);\n\t}\n\n\tpublic void addChar(int m, String s) {\n\t\tfc[m] = new String(s);\n\t}\n\n}\n\nclass UserScanner {\n\tprivate InputStream in;\n\tprivate final byte[] buffer = new byte[1024];\n\tprivate int ptr = 0;\n\tprivate int buflen = 0;\n\n\tpublic UserScanner(InputStream inStream) {\n\t\tin = inStream;\n\t}\n\n\tprivate void read() {\n\t\tptr = 0;\n\t\ttry {\n\t\t\tbuflen = in.read(buffer);\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t\tSystem.exit(9);\n\t\t}\n\t}\n\n\tprivate byte getByte() {\n\t\tif (ptr >= buflen)\n\t\t\tread();\n\t\tif (buflen < 0 || isCtlSpace(buffer[ptr])) {\n\t\t\treturn -1;\n\t\t} else\n\t\t\treturn buffer[ptr++];\n\t}\n\n\tprivate void skipCtlSpace() {\n\t\tfor (; ptr < buflen; ptr++)\n\t\t\tif (!isCtlSpace(buffer[ptr]))\n\t\t\t\treturn;\n\t\tread();\n\t\tskipCtlSpace();\n\t}\n\n\tprivate boolean isCtlSpace(byte b) {\n\t\tif (b <= ' ' || b > '~')\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tpublic void close() {\n\t\ttry {\n\t\t\tin.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t\tSystem.exit(9);\n\t\t}\n\t}\n\n\tpublic String next() {\n\t\tskipCtlSpace();\n\t\tStringBuilder sb = new StringBuilder();\n\t\tbyte b;\n\t\twhile ((b = getByte()) != -1) {\n\t\t\tsb.appendCodePoint(b);\n\t\t}\n\t\treturn sb.toString();\n\t}\n\n\tpublic int nextInt() {\n\t\tskipCtlSpace();\n\t\tint n = 0;\n\t\tboolean minus = false;\n\t\tbyte b;\n\t\twhile ((b = getByte()) != -1) {\n\t\t\tif (b == '-')\n\t\t\t\tminus = true;\n\t\t\telse {\n\t\t\t\tn *= 10;\n\t\t\t\tn += (b - '0');\n\t\t\t}\n\t\t}\n\t\tif (minus)\n\t\t\treturn n * -1;\n\t\telse\n\t\t\treturn n;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\ta = scanner.nextInt();\n\t\tb = scanner.nextInt();\n\t\tstr = new char[a][b];\n\t\tfor (int i = 0; i < a; i++)\n\t\t\tstr[i] = scanner.next().toCharArray();\n\t\tpat = new char[2][2];\n\t\tfor (int i = 0; i < 2; i++)\n\t\t\tpat[i] = scanner.next().toCharArray();\n\t\tint ret = 0;\n\t\tans = 0;\n\t\tmap = new boolean[a][b];\n\t\tfor (int i = 0; i < a - 1; i++) {\n\t\t\tloop: for (int j = 0; j < b - 1; j++) {\n\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\tif (str[i + k][j + l] != pat[k][l])\n\t\t\t\t\t\t\tcontinue loop;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tmap[i][j] = true;\n\t\t\t\tans++;\n\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < a; i++) {\n\t\t\tfor (int j = 0; j < b; j++) {\n\t\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\t\tif (str[i][j] == cs[k])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tchar tmp = str[i][j];\n\t\t\t\t\tstr[i][j] = cs[k];\n\t\t\t\t\tret = Math.max(ret, slove(i, j));\n\t\t\t\t\tstr[i][j] = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(ret + ans);\n\t}\n\n\tprivate int slove(int p, int q) {\n\t\tint ret = 0;\n\t\tfor (int i = p - 1; i <= p; i++) {\n\t\t\tloo: for (int j = q - 1; j <= q; j++) {\n\t\t\t\tif (i < 0 || a - 1 <= i || j < 0 || b - 1 <= j)\n\t\t\t\t\tcontinue;\n\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\tif (str[i + k][j + l] != pat[k][l]) {\n\t\t\t\t\t\t\tif (map[i][j])\n\t\t\t\t\t\t\t\tret--;\n\t\t\t\t\t\t\tcontinue loo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif (!map[i][j])\n\t\t\t\t\tret++;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tint a, b, ans;\n\tboolean[][] map;\n\tchar[][] str, pat;\n\tchar[] cs = { 'J', 'O', 'I' };\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=numOfEmblems();\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nflag[i][j]=JOI[k];\nans=Math.max(ans,numOfEmblems());\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans);\nout.flush();\n}\n\npublic static int numOfEmblem(){\nint cnt=0;\nfor(int i=0;i<m-1;i++){\nfor(int j=0;j<n-1;j++){\nif(flag[i][j]==emblem[0][0]&&flag[i][j+1]==emblem[0][1]&&flag[i+1][j]==emblem[1][0]&&flag[i+1][j+1]==emblem[1][1]) cnt++;\n}\n}\nreturn cnt;\n}\n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=ir.next().toCharArray();\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j];\nsum+=t;\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint cnt=sum-4*(count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j]);\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m||y>=n) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=0,sum=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j];\nsum+=t;\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint cnt=sum-4*(count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j]);\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<=0||y<=0||x>=m-1||y>=n-1) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\nreturn 0;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n     \n     \npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint m = sc.nextInt();\n\t\tint n = sc.nextInt();\n\t\tchar[][] map = new char[m][];\n\t\tfor(int i = 0; i < m; i++ ) {\n\t\t\tmap[i] = sc.next().toCharArray();\n\t\t}\n\t\tint[][] Map = new int[m][n];\n\t\tfor(int i = 0; i < m; i++) {\n\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\tif(map[i][j] == 'O') {\n\t\t\t\t\tMap[i][j] = 1;\n\t\t\t\t}\n\t\t\t\telse if(map[i][j] == 'I') {\n\t\t\t\t\tMap[i][j] = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tString A = sc.next();\n\t\tString B = sc.next();\n\t\tchar AA1 = A.charAt(0);\n\t\tchar AA2 = A.charAt(1);\n\t\tchar BB1 = B.charAt(0);\n\t\tchar BB2 = B.charAt(1);\n\t\tint A1 = 0;\n\t\tint A2 = 0;\n\t\tint B1 = 0;\n\t\tint B2 = 0;\n\t\tif(AA1 == 'O') {\n\t\t\tA1 = 1;\n\t\t}\n\t\telse if(AA1 == 'I') {\n\t\t\tA1 = 2;\n\t\t}\n\t\tif(AA2 == 'O') {\n\t\t\tA2 = 1;\n\t\t}\n\t\telse if(AA2 == 'I') {\n\t\t\tA2 = 2;\n\t\t}\n\t\tif(BB1 == 'O') {\n\t\t\tB1 = 1;\n\t\t}\n\t\telse if(BB1 == 'I') {\n\t\t\tB1 = 2;\n\t\t}\n\t\tif(BB2 == 'O') {\n\t\t\tB2 = 1;\n\t\t}\n\t\telse if(BB2 == 'I') {\n\t\t\tB2 = 2;\n\t\t}\n\t\t\n\t\tint ck = 0;\n\t\tint[][][] count = new int[m][n][3];\n\t\tfor(int i = 0; i < m-1; i++) {\n\t\t\tfor(int j = 0; j < n-1; j++) {\n\t\t\t\tint a1 = Map[i][j];\n\t\t\t\tint a2 = Map[i][j+1];\n\t\t\t\tint b1 = Map[i+1][j];\n\t\t\t\tint b2 = Map[i+1][j+1];\n\t\t\t\tint cunt = 0;\n\t\t\t\tif(a1 == A1) cunt++;\n\t\t\t\tif(a2 == A2) cunt++;\n\t\t\t\tif(b1 == B1) cunt++;\n\t\t\t\tif(b2 == B2) cunt++;\n\t\t\t\tif(cunt == 4) {\n\t\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\t\t\tcount[i][j][k]--;\n\t\t\t\t\t\tcount[i][j+1][k]--;\n\t\t\t\t\t\tcount[i+1][j][k]--;\n\t\t\t\t\t\tcount[i+1][j+1][k]--;\n\t\t\t\t\t}\n\t\t\t\t\tcount[i][j][a1]++;\n\t\t\t\t\tcount[i][j+1][a2]++;\n\t\t\t\t\tcount[i+1][j][b1]++;\n\t\t\t\t\tcount[i+1][j+1][b2]++;\n\t\t\t\t\tck++;\n\t\t\t\t}\n\t\t\t\telse if(cunt == 3) {\n\t\t\t\t\tif(a1 != A1) {\n\t\t\t\t\t\tcount[i][j][A1]++;\n\t\t\t\t\t}\n\t\t\t\t\telse if(a2 != A2) {\n\t\t\t\t\t\tcount[i][j+1][A2]++;\n\t\t\t\t\t}\n\t\t\t\t\telse if(b1 != B1) {\n\t\t\t\t\t\tcount[i+1][j][B1]++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcount[i+1][j+1][B2]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint max = 0;\n\t\tfor(int i = 0; i < m; i++) {\n\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\tmax = Math.max(count[i][j][k], max);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(ck + max);\n\t\t\n\t\t\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=0,sum=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j];\nsum+=t;\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint cnt=sum-4*(count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j]);\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m||y>=n) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=numOfEmblems();\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nflag[i][j]=JOI[k];\nans=Math.max(ans,numOfEmblems());\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans);\nout.flush();\n}\n\npublic static int numOfEmblems(){\nint cnt=0;\nfor(int i=0;i<m-1;i++){\nfor(int j=0;j<n-1;j++){\nif(flag[i][j]==emblem[0][0]&&flag[i][j+1]==emblem[0][1]&&flag[i+1][j]==emblem[1][0]&&flag[i+1][j+1]==emblem[1][1]) cnt++;\n}\n}\nreturn cnt;\n}\n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic char[][] f;\n\tstatic char[][] m = new char[2][];\n\n\tpublic static void main(String[] args) {\n\t\tint M = sc.nextInt();\n\t\tint N = sc.nextInt();\n\t\tf = new char[M + 2][N + 2];\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tString row = sc.next();\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tf[i + 1][j + 1] = row.charAt(j);\n\t\t\t}\n\t\t}\n\t\tm[0] = sc.next().toCharArray();\n\t\tm[1] = sc.next().toCharArray();\n\t\tint max = 0;\n\t\tfor (int i = 1; i <= M; ++i) {\n\t\t\tfor (int j = 1; j <= N; ++j) {\n\t\t\t\tchar orig = f[i][j];\n\t\t\t\tint prev = count(i, j);\n\t\t\t\tint diff = 0;\n\t\t\t\tfor (char c : new char[] { 'J', 'O', 'I' }) {\n\t\t\t\t\tf[i][j] = c;\n\t\t\t\t\tdiff = Math.max(diff, count(i, j) - prev);\n\t\t\t\t}\n\t\t\t\tf[i][j] = orig;\n\t\t\t\tmax = Math.max(max, diff);\n\t\t\t}\n\t\t}\n\t\tint all = 0;\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tif (isJOI(i, j)) ++all;\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(all + max);\n\t}\n\n\tstatic int count(int r, int c) {\n\t\tint ret = 0;\n\t\tif (isJOI(r - 1, c - 1)) ++ret;\n\t\tif (isJOI(r - 1, c)) ++ret;\n\t\tif (isJOI(r, c - 1)) ++ret;\n\t\tif (isJOI(r, c)) ++ret;\n\t\treturn ret;\n\t}\n\n\tstatic boolean isJOI(int r, int c) {\n\t\treturn f[r][c] == m[0][0] && f[r][c + 1] == m[0][1] && f[r + 1][c] == m[1][0] && f[r + 1][c + 1] == m[1][1];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.InputMismatchException;\nimport java.util.Map;\nimport java.util.PriorityQueue;\nimport java.math.BigInteger;\n    \npublic class Main{\n\nstatic final InputStream in=System.in;\nstatic final PrintWriter out=new PrintWriter(System.out);\nstatic final int INF=Integer.MAX_VALUE/2;\nstatic final long LINF=Long.MAX_VALUE/2;\nstatic int m,n;\nstatic char[][] flag;\nstatic char[][] emblem;\nstatic final char[] JOI={'J','O','I'};\n    \npublic static void main(String[] args) throws IOException{\nInputReader ir=new InputReader(in);\nm=ir.nextInt();\nn=ir.nextInt();\nflag=ir.makeCharMap(m,n);\nemblem=ir.makeCharMap(2,2);\nint ans=0,sum=0;\nint[][] count=new int[m][n];\nfor(int i=0;i<m;i++) for(int j=0;j<n;j++)count[i][j]=_count(i,j);\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nint t=count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j];\nsum+=t;\n}\n}\nfor(int i=0;i<m;i++){\nfor(int j=0;j<n;j++){\nfor(int k=0;k<3;k++){\nif(flag[i][j]!=JOI[k]){\nchar c=flag[i][j];\nint cnt=sum-4*(count[i-1][j-1]+count[i][j-1]+count[i][j]+count[i-1][j]);\nflag[i][j]=JOI[k];\nans+=4*_count(i-1,j-1)+4*_count(i-1,j)+4*_count(i,j-1)+4*_count(i,j);\nans=Math.max(cnt,ans);\nflag[i][j]=c;\n}\n}\n}\n}\nout.println(ans/4);\nout.flush();\n}\n\npublic static int _count(int x,int y){\nif(x<0||y<0||x>=m||y>=n) return 0;\nif(flag[x][y]==emblem[0][0]&&flag[x+1][y]==emblem[1][0]&&flag[x][y+1]==emblem[0][1]&&flag[x+1][y+1]==emblem[1][1]) return 1;\nreturn 0;\n} \n\nstatic class InputReader {\nprivate InputStream in;\nprivate byte[] buffer=new byte[1024];\nprivate int curbuf;\nprivate int lenbuf;\n\npublic InputReader(InputStream in) {this.in=in;}\n  \npublic int readByte() {\nif(lenbuf==-1) throw new InputMismatchException();\nif(curbuf>=lenbuf){\ncurbuf= 0;\ntry{\nlenbuf=in.read(buffer);\n}\ncatch (IOException e) {\nthrow new InputMismatchException();\n}\nif(lenbuf<=0)\nreturn -1;\n}\nreturn buffer[curbuf++];\n}\n\npublic boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\nprivate int skip() {int b; while((b = readByte())!=-1&&isSpaceChar(b)); return b;}\n\npublic String next() {\nint b=skip();\nStringBuilder sb=new StringBuilder();\nwhile(!isSpaceChar(b)){\nsb.appendCodePoint(b);\nb=readByte();\n}\nreturn sb.toString();\n}\n \npublic int nextInt() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nint res=0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic long nextLong() {\nint c=readByte();\nwhile (isSpaceChar(c)) c=readByte();\nboolean minus=false;\nif (c=='-') {\nminus=true;\nc=readByte();\n}\nlong res = 0;\ndo{\nif(c<'0'||c>'9') throw new InputMismatchException();\nres=res*10+c-'0';\nc=readByte();\n}while(!isSpaceChar(c));\nreturn (minus)?-res:res;\n}\n\npublic int[] toIntArray(int n){\nint[] a=new int[n];\nfor(int i=0;i<n;i++) a[i]=nextInt();\nreturn a;\n}\n\npublic char[][] makeCharMap(int m,int n){\nchar[][] map=new char[m][n];\nfor(int i=0;i<m;i++) map[i]=next().toCharArray();\nreturn map;\n}\n}\n}"
  },
  {
    "language": "C#",
    "code": "using static System.Math;\nusing System;\n\npublic class hello\n{\n    public static void Main()\n    {\n        string[] line = Console.ReadLine().Trim().Split(' ');\n        var h = int.Parse(line[0]);\n        var w = int.Parse(line[1]);\n        var map = new char[h, w];\n        for (int i = 0; i < h; i++)\n        {\n            var s = Console.ReadLine().Trim();\n            for (int j = 0; j < w; j++) map[i, j] = s[j];\n        }\n        var s12 = Console.ReadLine().Trim() + Console.ReadLine().Trim();\n        var dm = getDM(map, s12, h, w);\n        Console.WriteLine(dm );\n    }\n    static int getDM(char[,] map, string s12, int h, int w)\n    {\n        var dm = 0; var count = 0;\n        for (int i = 0; i < h; i++)\n            for (int j = 0; j < w; j++)\n            {\n                if (i < h - 1 && j < w - 1)\n                    if (s12[0] == map[i, j] &&\n                       s12[1] == map[i, j + 1] &&\n                       s12[2] == map[i + 1, j] &&\n                       s12[3] == map[i + 1, j + 1]) count++;\n                var cj = checkJOI(map, s12, h, w, i, j, 'J');\n                var jo = checkJOI(map, s12, h, w, i, j, 'O');\n                var ji = checkJOI(map, s12, h, w, i, j, 'I');\n                var tm = Max(cj, Max(jo, ji));\n                dm = Max(dm, tm);\n            }\n        return dm + count;\n    }\n    static int checkJOI(char[,] map, string s12, int h, int w, int x, int y, char cc)\n    {\n        var ans = 0;\n        if (x - 1 >= 0 && y - 1 >= 0)\n        {\n            var org = \"\" + map[x - 1, y - 1] + map[x - 1, y] + map[x, y - 1] + map[x, y];\n            var cj = \"\" + map[x - 1, y - 1] + map[x - 1, y] + map[x, y - 1] + cc;\n            if (cj == s12 && org != s12) ans++;\n            if (cj != s12 && org == s12) ans--;\n        }\n        if (x - 1 >= 0 && y + 1 < w)\n        {\n            var org = \"\" + map[x - 1, y] + map[x - 1, y + 1] + map[x, y] + map[x, y + 1];\n            var cj = \"\" + map[x - 1, y] + map[x - 1, y + 1] + cc + map[x, y + 1];\n            if (cj == s12 && org != s12) ans++;\n            if (cj != s12 && org == s12) ans--;\n        }\n        if (x + 1 < h && y - 1 >= 0)\n        {\n            var org = \"\" + map[x, y - 1] + map[x, y] + map[x + 1, y - 1] + map[x + 1, y];\n            var cj = \"\" + map[x, y - 1] + cc + map[x + 1, y - 1] + map[x + 1, y];\n            if (cj == s12 && org != s12) ans++;\n            if (cj != s12 && org == s12) ans--;\n        }\n        if (x + 1 < h && y + 1 < w)\n        {\n            var org = \"\" + map[x, y] + map[x, y + 1] + map[x + 1, y] + map[x + 1, y + 1];\n            var cj = \"\" + cc + map[x, y + 1] + map[x + 1, y] + map[x + 1, y + 1];\n            if (cj == s12 && org != s12) ans++;\n            if (cj != s12 && org == s12) ans--;\n        }\n        return ans;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\n\nnamespace _0598\n{\n\tclass Program\n    {\n        static void Main(string[] args)\n        {\n            int[] x = Console.ReadLine().Split().Select(int.Parse).ToArray();\n            char[,] flag = new char[x[0] + 2,x[1] + 2];\n            for (int i = 0; i < x[0]; i++)\n            {\n                string s = Console.ReadLine();\n                for (int j = 0; j < x[1]; j++) flag[i + 1,j + 1] = s[j];\n            }\n            char[,] emblem = new char[2,2];\n            for (int i = 0; i < 2; i++)\n            {\n                string s = Console.ReadLine();\n                for (int j = 0; j < 2; j++) emblem[i,j] = s[j];\n            }\n            int[,] flagcount = new int[x[0] + 2,x[1] + 2];\n            int count = 0;\n            for (int i = 1; i < x[0] + 1; i++)\n            {\n                for (int j = 1; j < x[1] + 1; j++)\n                {\n                    bool correct = true;\n                    for (int k = 0; k < 2; k++)\n                    {\n                        for (int l = 0; l < 2; l++)\n                        {\n                            if (flag[i + k,j + l] != emblem[k,l]) correct = false;\n                        }\n                    }\n                    if (correct)\n                    {\n                        count++;\n                        for (int k = 0; k < 2; k++)\n                        {\n                            for (int l = 0; l < 2; l++)\n                            {\n                                flagcount[i + k,j + l]++;\n                            }\n                        }\n                    }\n                }\n            }\n            int ret = count;\n            for (int i = 1; i < x[0] + 1; i++)\n            {\n                for (int j = 1; j < x[1] + 1; j++)\n                {\n                    char def = flag[i,j];\n                    char[] JOI = new char[] { 'J','O','I' };\n                    for (int k = 0; k < 3; k++)\n                    {\n                        flag[i,j] = JOI[k];\n                        int now = count - flagcount[i,j];\n                        for (int l = -1; l <= 0; l++)\n                        {\n                            for (int m = -1; m <= 0; m++)\n                            {\n                                bool correct = true;\n                                for (int n = 0; n < 2; n++)\n                                {\n                                    for (int o = 0; o < 2; o++)\n                                    {\n\t\t\t\t\t\t\t\t\t\tif (flag[i + l + n, j + m + o] != emblem[n, o]) correct = false;\n                                    }\n                                }\n\t\t\t\t\t\t\t\tif (correct) now++;\n                            }\n                        }\n                        ret = Math.Max(ret,now);\n                    }\n                    flag[i,j] = def;\n                }\n            }\n\t\t\tConsole.WriteLine(ret);\n        }\n    }\n}\n"
  },
  {
    "language": "Ruby",
    "code": "m, n = gets.split.map &:to_i\nf = (1..m).map { gets.chomp }\ne = gets.chomp.split(\"\") + gets.chomp.split(\"\")\n\nhash = {}\n\ncount = 0\n(0..m-2).each{|i|\n\t(0..n-2).each{|j|\n\t\ta = [\n\t\t\tf[i][j] == e[0],\n\t\t\tf[i][j+1] == e[1],\n\t\t\tf[i+1][j] == e[2],\n\t\t\tf[i+1][j+1] == e[3],\n\t\t]\n\t\tcase a.count{|b| b}\n\t\twhen 4\n\t\t\tcount += 1\n\t\t\t[[i,j], [i,j+1], [i+1,j], [i+1,j+1]].each{|y, x|\n\t\t\t\tpos = [y, x]\n\t\t\t\thash[pos] ||= Hash.new(0)\n\t\t\t\t(%w(J O I) - [f[i][j]]).each{|c|\n\t\t\t\t\thash[pos][c] -= 1\n\t\t\t\t}\n\t\t\t}\n\t\twhen 3\n\t\t\tk = a.index{|b| b}\n\t\t\tpos = [i + k/2, j + k%2]\n\t\t\thash[pos] ||= Hash.new(0)\n\t\t\thash[pos][e[k]] += 1\n\t\tend\n\t}\n}\n\np count + [hash.values.map(&:values).flatten.max || 0, 0].max"
  },
  {
    "language": "Ruby",
    "code": "### constant\n\nCS = ['J', 'O', 'I']\nCHASH = {'J' => 0, 'O' => 1, 'I' => 2}\n\n### main\n\nm, n = gets.strip.split(' ').map(&:to_i)\n\nflags = []\n\nm.times do\n  flags << gets.strip\nend\n#p flags\n\ne00, e01 = gets.strip.split('')\ne10, e11 = gets.strip.split('')\n\ncount = 0\n\nfor y in (0...(m - 1))\n  for x in (0...(n - 1))\n    if flags[y][x] == e00 && flags[y][x + 1] == e01 &&\n        flags[y + 1][x] == e10 && flags[y + 1][x + 1] == e11\n      count += 1\n    end\n  end\nend\n#p count\n\nmax_plus = 0\n\nfor y in (0...m)\n  for x in (0...n)\n    c0 = flags[y][x]\n    pluses = [0] * 3\n\n    for i in (0..2)\n      c = CS[i]\n      if y > 0\n        if x > 0 &&\n            flags[y - 1][x - 1] == e00 && flags[y - 1][x] == e01 &&\n            flags[y][x - 1] == e10 && c == e11\n          pluses[i] += 1\n        end\n        if x < n - 1 &&\n            flags[y - 1][x] == e00 && flags[y - 1][x + 1] == e01 &&\n             c == e10 && flags[y][x + 1] == e11\n          pluses[i] += 1\n        end\n      end\n      if y < m - 1\n        if x > 0 &&\n            flags[y][x - 1] == e00 && c == e01 &&\n            flags[y + 1][x - 1] == e10 && flags[y + 1][x] == e11\n          pluses[i] += 1\n        end\n        if x < n - 1 &&\n            c == e00 && flags[y][x + 1] == e01 &&\n            flags[y + 1][x] == e10 && flags[y + 1][x + 1] == e11\n          pluses[i] += 1\n        end\n      end\n    end\n\n    plus = pluses.max - pluses[CHASH[c0]]\n    max_plus = plus if max_plus < plus\n  end\nend\n#p max_plus\n\nputs (count + max_plus)"
  },
  {
    "language": "Ruby",
    "code": "m, n = gets.split.map &:to_i\nf = (1..m).map { gets.chomp }\ne = gets.chomp.split(\"\") + gets.chomp.split(\"\")\n\nhash = {}\n\ncount = 0\n(0..m-2).each{|i|\n\t(0..n-2).each{|j|\n\t\ta = [\n\t\t\tf[i][j] == e[0],\n\t\t\tf[i][j+1] == e[1],\n\t\t\tf[i+1][j] == e[2],\n\t\t\tf[i+1][j+1] == e[3],\n\t\t]\n\t\tcase a.count{|b| b}\n\t\twhen 4\n\t\t\tcount += 1\n\t\t\t[[i,j], [i,j+1], [i+1,j], [i+1,j+1]].each{|y, x|\n\t\t\t\tpos = [y, x]\n\t\t\t\thash[pos] ||= Hash.new(0)\n\t\t\t\t(%w(J O I) - [f[i][j]]).each{|c|\n\t\t\t\t\thash[pos][c] -= 1\n\t\t\t\t}\n\t\t\t}\n\t\twhen 3\n\t\t\tk = a.index{|b| b}\n\t\t\tpos = [i + k/2, j + k%2]\n\t\t\thash[pos] ||= Hash.new(0)\n\t\t\thash[pos][e[k]] += 1\n\t\tend\n\t}\n}\n\np count + [hash.values.map(&:values).flatten.max, 0].max"
  },
  {
    "language": "Ruby",
    "code": "m, n = gets.split.map &:to_i\nf = (1..m).map { gets.chomp }\ne = gets.chomp.split(\"\") + gets.chomp.split(\"\")\n\nhash = {}\n\ncount = 0\n(0..m-2).each{|i|\n\t(0..n-2).each{|j|\n\t\ta = [\n\t\t\tf[i][j] == e[0],\n\t\t\tf[i][j+1] == e[1],\n\t\t\tf[i+1][j] == e[2],\n\t\t\tf[i+1][j+1] == e[3],\n\t\t]\n\t\tcase a.count{|b| b}\n\t\twhen 4\n\t\t\tcount += 1\n\t\t\t[[i,j], [i,j+1], [i+1,j], [i+1,j+1]].each{|y, x|\n\t\t\t\tpos = [y, x]\n\t\t\t\thash[pos] ||= Hash.new(0)\n\t\t\t\t(%w(J O I) - [f[i][j]]).each{|c|\n\t\t\t\t\thash[pos][c] -= 1\n\t\t\t\t}\n\t\t\t}\n\t\twhen 3\n\t\t\tk = a.index{|b| !b}\n\t\t\tpos = [i + k/2, j + k%2]\n\t\t\thash[pos] ||= Hash.new(0)\n\t\t\thash[pos][e[k]] += 1\n\t\tend\n\t}\n}\n\np count + [hash.values.map(&:values).flatten.max || 0, 0].max"
  },
  {
    "language": "PHP",
    "code": "<?php\n/*\n  AOJ 0598\n  Title:JOI Emblem\n  @kankichi573\n*/\n$result=array();\n$hata=array();\n$template=array();\n\nfscanf(STDIN,\"%d %d\",$m,$n);\n\nfor($i=0;$i<$m;$i++)\n  fscanf(STDIN,\"%s\",$hata[$i]);\nfor($i=0;$i<2;$i++)\n  fscanf(STDIN,\"%s\",$template[$i]);\n$cnt4=0;\n\n\nfor($i=0;$i<$m-1;$i++)\n  for($j=0;$j<$n-1;$j++)\n    {\n      $cnt=0;\n      for($k=0;$k<2;$k++)\n\tfor($l=0;$l<2;$l++)\n\t  $cnt+=(substr($hata[$i+$k],$j+$l,1)==substr($template[$k],$l,1))?1:0;\n      \n      if($cnt==4)\n\t$cnt4++;\n      if($cnt==3)\n\t{\n\tfor($k=0;$k<2;$k++)\n\t  for($l=0;$l<2;$l++)\n\t    if(substr($hata[$i+$k],$j+$l,1)!=substr($template[$k],$l,1))\n\t      {\n\t\tif(isset($result[$i+$k][$j+$l][substr($template[$k],$l,1)]))\n\t\t  $result[$i+$k][$j+$l][substr($template[$k],$l,1)]++;\n\t\telse\n\t\t  $result[$i+$k][$j+$l][substr($template[$k],$l,1)]=1;\n\t      }\n\t}\n    }\n\n$max=0;\nforeach ($result as $key1 => $val1)\n{\n  foreach ($val1   as $key2 => $val2)\n    {\n      foreach($val2 as $key3 => $val3)\n\t{\n\t  $max = max($max,$val3);\n\t}\n    }\n}\n\nprintf(\"%d\\n\",$cnt4+$max);\n\nreturn(0);\n\n?>"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.c.stdio;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\nimport std.c.string;\nimport std.regex;\nimport std.typecons;\n \nvoid main() {\n    int H, W; readf(\"%d %d\\n\", &H, &W);\n    char[][] F;\n    for (int i = 0; i < H; i++) {\n        F ~= cast(char[])readln.chomp;\n    }\n    char[][] P;\n    for (int i = 0; i < 2; i++) {\n        P ~= cast(char[])readln.chomp;\n    }\n    string X = \"JOI\";\n    int Ans = 0;\n    int C() {\n        int Count = 0;\n        bool M(int h, int w) {\n            for (int y = 0; y < 2; y++) \n                for (int x = 0; x < 2; x++) \n                    if (F[h + y][w + x] != P[y][x]) return false;\n            return true;\n        }\n        for (int h = 0; h < H - 1; h++) {\n            for (int w = 0; w < W - 1; w++) {\n                if (M(h, w)) {\n                    Count++;\n                }\n            }\n        }\n        return Count;\n    }\n    for (int h = 0; h < H; h++) {\n        for (int w = 0; w < W; w++) {\n            for (int i = 0; i < 3; i++) {\n                char t = F[h][w];\n                F[h][w] = X[i];\n                Ans = max(Ans, C());\n                F[h][w] = t;\n            }\n        }\n    }\n    printf(\"%d\\n\", Ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.c.stdio;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\nimport std.c.string;\nimport std.regex;\nimport std.typecons;\n \nvoid main() {\n    int H, W; readf(\"%d %d\\n\", &H, &W);\n    char[][] F;\n    for (int i = 0; i < H; i++) {\n        F ~= cast(char[])readln.chomp;\n    }\n    char[][] P;\n    for (int i = 0; i < 2; i++) {\n        P ~= cast(char[])readln.chomp;\n    }\n    string X = \"JOI\";\n    int Ans = 0;\n\n    bool M(int h, int w) {\n        for (int y = 0; y < 2; y++) \n            for (int x = 0; x < 2; x++) {\n                if (h + y < 0 || h + y >= H) return false;\n                if (w + x < 0 || w + x >= W) return false;\n                if (F[h + y][w + x] != P[y][x]) return false;\n            }\n        return true;\n    }\n\n    int C() {\n        int Count = 0;\n        for (int h = 0; h < H - 1; h++) {\n            for (int w = 0; w < W - 1; w++) {\n                if (M(h, w)) {\n                    Count++;\n                }\n            }\n        }\n        return Count;\n    }\n\n    int Old = C();\n\n    for (int h = 0; h < H; h++) {\n        for (int w = 0; w < W; w++) {\n            for (int i = 0; i < 3; i++) {\n                static const  dy = [0, -1, -1, 0],\n                              dx = [-1, 0, -1, 0]; \n                int Diff = 0;\n                for (int j = 0; j < 4; j++) {\n                    if (M(h + dy[j], w + dx[j])) Diff--;\n                }\n                char t = F[h][w];\n                F[h][w] = X[i];\n                for (int j = 0; j < 4; j++) {\n                    if (M(h + dy[j], w + dx[j])) Diff++;\n                }\n                F[h][w] = t;\n                Ans = max(Ans, Old + Diff);\n            }\n        }\n    }\n    printf(\"%d\\n\", Ans);\n}"
  },
  {
    "language": "Python",
    "code": "M, N = map(int, input().split())\nG = \"JOI\".index\nL = [list(map(G, input())) for i in range(M)]\nF = [list(map(G, input())), list(map(G, input()))]\nf = F[0][0] + F[0][1]*3 + F[1][0]*9 + F[1][1]*27\n\nS = [0, 1]\nD = [[-1000]*N for i in range(M)]\nres = 0\nfor i in range(M-1):\n    for j in range(N-1):\n        r = D[i][j] = L[i][j] + L[i][j+1]*3 + L[i+1][j]*9 + L[i+1][j+1]*27\n        if r == f:\n            res += 1\nans = res\nR = [0, 1, 2]\nfor i in range(M):\n    for j in range(N):\n        e = L[i][j]\n        a = D[i-1][j-1]; b = D[i-1][j]; c = D[i][j-1]; d = D[i][j]\n        C = (a == f) + (b == f) + (c == f) + (d == f)\n        cnt = max((a + 27*(p-e) == f) + (b + 9*(p-e) == f) + (c + 3*(p-e) == f) + (d + (p-e) == f) for p in R)\n        ans = max(ans, res + (cnt - C))\nprint(ans)\n"
  },
  {
    "language": "Python",
    "code": "def check(y,x):\n    dy=(0,0,1,1)\n    dx=(0,1,0,1)\n    for i in xrange(4):\n        ny=y+dy[i]\n        nx=x+dx[i]\n        if ny<0 or ny>=m or nx<0 or nx>=n:\n            return False\n    return True\n\nm,n=map(int,raw_input().split())\nf=[[] for _ in xrange(m)]\nfor i in xrange(m):\n    s=raw_input()\n    for j in s:\n        f[i].append(j)\nem=[raw_input() for _ in xrange(2)]\njoi=['J','O','I']\ncnt=0\nnocnt=[[0]*n for _ in xrange(m)]\n\nfor i in xrange(m-1):\n    for j in xrange(n-1):\n        if [f[i][j]+f[i][j+1],f[i+1][j]+f[i+1][j+1]]==em:\n            cnt+=1\n            nocnt[i][j]\n\nul=[[-1,-1],[-1,0],[0,-1],[0,0]]\ndiffcnt=0\nfor i in xrange(m):\n    for j in xrange(n):\n        tmp=f[i][j]\n        for k in xrange(3):\n            f[i][j]=joi[k]\n            if f[i][j]==tmp:\n                continue\n            newcnt=0\n            for l in xrange(4):\n                nowy,nowx=ul[l]\n                nowy+=i\n                nowx+=j\n                if not check(nowy,nowx):continue\n                now=f[nowy][nowx]\n                nxx=f[nowy][nowx+1]\n                nyy=f[nowy+1][nowx]\n                nxy=f[nowy+1][nowx+1]\n                if [now+nxx,nyy+nxy]==em:\n                    newcnt+=1\n                    newcnt-=nocnt[nowy][nowx]\n            diffcnt=max(diffcnt,newcnt)\n        f[i][j]=tmp\n        \nprint(cnt+diffcnt)"
  },
  {
    "language": "Python",
    "code": "def main():\n  \n  n, m = map(int,input().split())\n  ss = [input() for i in range(n)]\n  a1, a2 = input()\n  a3, a4 = input()\n  dic = {\"J\":0, \"O\":1, \"I\":2}\n  \n  n1, n2, n3, n4 = dic[a1], dic[a2], dic[a3], dic[a4]\n  fix = [[[0] * m for i in range(n)] for j in range(3)]\n  \n  ans = 0\n  \n  for x in range(n - 1):\n    for y in range(m - 1):\n      b1, b2, b3, b4 = ss[x][y], ss[x][y + 1], ss[x + 1][y], ss[x + 1][y + 1]\n      if a1 == b1 and a2 == b2 and a3 == b3 and a4 == b4:\n        ans += 1\n        for i in range(3):\n          if i != n1:\n            fix[i][x][y] -= 1\n          if i != n2:\n            fix[i][x][y + 1] -= 1\n          if i != n3:\n            fix[i][x + 1][y] -= 1\n          if i != n4:\n            fix[i][x + 1][y + 1] -= 1\n   \n      elif not (a1 == b1) and a2 == b2 and a3 == b3 and a4 == b4:\n        fix[n1][x][y] += 1\n      elif a1 == b1 and not (a2 == b2) and a3 == b3 and a4 == b4:\n        fix[n2][x][y + 1] += 1\n      elif a1 == b1 and a2 == b2 and not (a3 == b3) and a4 == b4:\n        fix[n3][x + 1][y] += 1\n      elif a1 == b1 and a2 == b2 and a3 == b3 and not (a4 == b4):\n        fix[n4][x + 1][y + 1] += 1\n  \n  rec = 0\n  for i in range(3):\n    fixi = fix[i]\n    for x in range(n):\n      fixix = fixi[x]\n      for y in range(m):\n        if fixix[y] > rec:\n          rec = fixix[y]\n          if rec == 4:\n            break\n      if rec == 4:\n        break\n    if rec == 4:\n      break\n  \n  print(ans + rec)\n\nmain()\n"
  },
  {
    "language": "Python",
    "code": "n, m = map(int,input().split())\nss = [input() for i in range(n)]\na1, a2 = input()\na3, a4 = input()\ndic = {\"J\":0, \"O\":1, \"I\":2}\nn1, n2, n3, n4 = dic[a1], dic[a2], dic[a3], dic[a4]\nfix = [[[0] * m for i in range(n)] for j in range(3)]\n\nans = 0\n\nfor x in range(n - 1):\n  for y in range(m - 1):\n    b1, b2, b3, b4 = ss[x][y], ss[x][y + 1], ss[x + 1][y], ss[x + 1][y + 1]\n    if a1 == b1 and a2 == b2 and a3 == b3 and a4 == b4:\n      ans += 1\n      for i in range(3):\n        if i != n1:\n          fix[i][x][y] -= 1\n      for i in range(3):\n        if i != n2:\n          fix[i][x][y + 1] -= 1\n      for i in range(3):\n        if i != n3:\n          fix[i][x + 1][y] -= 1\n      for i in range(3):\n        if i != n4:\n          fix[i][x + 1][y + 1] -= 1\n \n    elif not (a1 == b1) and a2 == b2 and a3 == b3 and a4 == b4:\n      fix[n1][x][y] += 1\n    elif a1 == b1 and not (a2 == b2) and a3 == b3 and a4 == b4:\n      fix[n2][x][y + 1] += 1\n    elif a1 == b1 and a2 == b2 and not (a3 == b3) and a4 == b4:\n      fix[n3][x + 1][y] += 1\n    elif a1 == b1 and a2 == b2 and a3 == b3 and not (a4 == b4):\n      fix[n4][x + 1][y + 1] += 1\n\nrec = 0\nfor i in range(3):\n  for x in range(n):\n    for y in range(m):\n      if fix[i][x][y] > rec:\n        rec = fix[i][x][y]\n\nprint(ans + rec)\n"
  },
  {
    "language": "Python",
    "code": "h,w=map(int,input().split())\nm = [list(input()) for i in range(h)]\nmon = [0]*2\nmon[0]=list(input())\nmon[1]=list(input())\nar = [None]*(h*w)\nd = [[0,0],[0,1],[0,1],[1,1]]\nwasure = 0\nfor i in range(h-1):\n    for j in range(w-1):\n        ma = 0\n        for k in range(4):\n            if m[i+d[k][0]][j+d[k][1]] == mon[d[k][0]][d[k][1]]:\n                ma +=1\n            else:\n                l = k\n        if ma == 3:\n            moji = mon[d[l][0]][d[l][1]]\n            y = i+d[l][0]\n            x = j+d[l][1]\n            if ar[(y*w)+x] is None:\n                ar[(y*w)+x] = []\n            \n            ar[(y*w)+x].append(moji)\n        elif ma ==4:\n            wasure += 1\n\nans = 0\nare = {'J':0,'O':1,'I':2}\nfor i in range((h*w)):\n    if ar[i] is None:\n        continue\n    sore = [0]*3\n    for j in range(len(ar[i])):\n       sore[are[ar[i][j]]] += 1\n       ans = max(max(sore),ans)\nprint(wasure+ans)"
  },
  {
    "language": "Python",
    "code": "from copy import deepcopy\n\nM,N=map(int,input().split())\nflag=[]\nfor i in range(M):\n    flag.append(list(input()))\nfchange=deepcopy(flag)\nsym=[]\nfor i in range(2):\n    sym.append(list(input()))\nnmatch=0\nfor i in range(M-1):\n    for j in range(N-1):\n        ism=True\n        for k in range(2):\n            for l in range(2):\n                if flag[i+k][j+l]!=sym[k][l]:\n                    ism=False\n        if ism:\n            nmatch+=1\nans=nmatch\nfor i in range(M):\n    for j in range(N):\n        for c in [\"J\",\"O\",\"I\"]:\n            fchange[i][j]=c\n            now=nmatch\n            for k in range(-1,1):\n                for l in range(-1,1):\n                    if 0<=i+k and 0<=j+l and i+k+1<M and j+l+1<N:\n                        isf,isc=True,True\n                        for n in range(2):\n                            for m in range(2):\n                                if flag[i+k+n][j+l+m]!=sym[n][m]:\n                                    isf=False\n                                if fchange[i+k+n][j+l+m]!=sym[n][m]:\n                                    isc=False\n                        if (not isf) and isc:\n                            now+=1\n                        if isf and (not isc):\n                            now-=1\n            ans=max(ans,now)\n            fchange[i][j]=flag[i][j]\nprint(ans)"
  },
  {
    "language": "Python",
    "code": "h,w=map(int,input().split())\nm = [list(input()) for i in range(h)]\nmon = [0]*2\nmon[0]=list(input())\nmon[1]=list(input())\nar = [None]*(h*w)\nd = [[0,0],[0,1],[0,1],[1,1]]\nwasure = 0\nfor i in range(h-1):\n    for j in range(w-1):\n        ma = 0\n        for k in range(4):\n            if m[i+d[k][0]][j+d[k][1]] == mon[d[k][0]][d[k][1]]:\n                ma +=1\n            else:\n                l = k\n        if ma == 3:\n            moji = mon[d[l][0]][d[l][1]]\n            y = i+d[l][0]\n            x = j+d[l][1]\n            if ar[(y*w)+x] is None:\n                ar[(y*w)+x] = []\n            \n            ar[(y*w)+x].append(moji)\n        elif ma ==4:\n            for k in range(4):\n                if ar[((i+d[k][0])*w)+j+d[k][1]] is None:\n                    ar[((i+d[k][0])*w)+j+d[k][1]] = []\n                ar[((i+d[k][0])*w)+j+d[k][1]].append('k')\n            wasure += 1\n\nans = 0\nare = {'J':0,'O':1,'I':2,'k':3}\nfor i in range((h*w)):\n    if ar[i] is None:\n        continue\n    sore = [0]*4\n    for j in range(len(ar[i])):\n       sore[are[ar[i][j]]] += 1\n       if sore[3] < max(sore[0:3]):\n           ans = max(max(sore[0:3])-sore[3],ans)\nprint(wasure+ans)"
  },
  {
    "language": "Python",
    "code": "def solve():\n    from itertools import chain\n    H, W = map(int, input().split())\n    flag = [tuple(input()) for _ in [0]*H]\n    crest = list(input()) + list(input())\n    a = [[0]*W for _ in [0]*H]\n    result = 0\n\n    for y in range(H-1):\n        for x, fl in enumerate(zip(flag[y], flag[y][1:], flag[y+1], flag[y+1][1:])):\n            correct = 0\n            _y = _x = 0\n            for i, (f, c) in enumerate(zip(fl, crest)):\n                if f == c:\n                    correct += 1\n                else:\n                    if i == 1:\n                        _x = 1\n                    elif i == 2:\n                        _y = 1\n                        _x = 0\n                    elif i == 3:\n                        _y = _x = 1\n            if correct == 4:\n                for dy, dx in ((0, 0), (0, 1), (1, 0), (1, 1)):\n                    a[y+dy][x+dx] -= 1\n                result += 1\n            elif correct == 3:\n                a[y+_y][x+_x] += 1\n\n    result += max(max(chain.from_iterable(a)), 0)\n    print(result)\n\n\nif __name__ == \"__main__\":\n    solve()"
  },
  {
    "language": "Python",
    "code": "def solve():\n    from itertools import chain\n    H, W = map(int, input().split())\n    flag = [tuple(input()) for _ in [0]*H]\n    crest = list(input()) + list(input())\n    a = [[0]*W for _ in [0]*H]\n    a2 = [[[] for _ in [0]*W] for _ in [0]*H]\n    result = 0\n\n    for y in range(H-1):\n        for x, fl in enumerate(zip(flag[y], flag[y][1:], flag[y+1], flag[y+1][1:])):\n            correct = 0\n            correct_char = \"\"\n            _y = _x = 0\n            for i, (f, c) in enumerate(zip(fl, crest)):\n                if f == c:\n                    correct += 1\n                else:\n                    if i == 1:\n                        _x = 1\n                    elif i == 2:\n                        _y = 1\n                        _x = 0\n                    elif i == 3:\n                        _y = _x = 1\n                    correct_char = c\n            if correct == 4:\n                for dy, dx in ((0, 0), (0, 1), (1, 0), (1, 1)):\n                    a[y+dy][x+dx] -= 1\n                result += 1\n            elif correct == 3:\n                if not a2[y+_y][x+_x] or correct_char in a2[y+_y][x+_x]:\n                    a[y+_y][x+_x] += 1\n                a2[y+_y][x+_x].append(correct_char)\n\n    result += max(max(chain.from_iterable(a)), 0)\n    print(result)\n\n\nif __name__ == \"__main__\":\n    solve()"
  },
  {
    "language": "Python",
    "code": "h,w=map(int,input().split())\nm = [list(input()) for i in range(h)]\nmon = [0]*2\nmon[0]=list(input())\nmon[1]=list(input())\nar = [None]*(h*w)\nd = [[0,0],[0,1],[1,0],[1,1]]\nwasure = 0\nfor i in range(h-1):\n    for j in range(w-1):\n        ma = 0\n        for k in range(4):\n            if m[i+d[k][0]][j+d[k][1]] == mon[d[k][0]][d[k][1]]:\n                ma +=1\n            else:\n                l = k\n        if ma == 3:\n            moji = mon[d[l][0]][d[l][1]]\n            y = i+d[l][0]\n            x = j+d[l][1]\n            if ar[(y*w)+x] is None:\n                ar[(y*w)+x] = []\n            \n            ar[(y*w)+x].append(moji)\n            # print('san',ar[(y*w)+x],y,x)\n        elif ma ==4:\n            for k in range(4):\n                if ar[((i+d[k][0])*w)+j+d[k][1]] is None:\n                    ar[((i+d[k][0])*w)+j+d[k][1]] = []\n                ar[((i+d[k][0])*w)+j+d[k][1]].append('k')\n                # print(ar[((i+d[k][0])*w)+j+d[k][1]],i+d[k][0],j+d[k][1])\n            wasure += 1\n\nans = 0\nare = {'J':0,'O':1,'I':2,'k':3}\nfor i in range((h*w)):\n    if ar[i] is None:\n        continue\n    sore = [0]*4\n    for j in range(len(ar[i])):\n       sore[are[ar[i][j]]] += 1\n       if sore[3] < max(sore[0:3]):\n           ans = max(max(sore[0:3])-sore[3],ans)\nprint(wasure+ans)\n# print(ar)"
  },
  {
    "language": "Rust",
    "code": "use std::cmp;\n\nfn main(){\n  let mn: Vec<usize> = read_vec();\n  let m = mn[0];\n  let n = mn[1];\n\n  let mut flg: Vec<Vec<char>> = Vec::new();\n  \n  for _ in 0 .. m {\n   let s: String = read();\n   flg.push(s.chars().collect());\n  }\n\n  let mut emb: Vec<Vec<char>> = Vec::new();\n  \n  for _ in 0 .. 2 {\n   let s: String = read();\n   emb.push(s.chars().collect());\n  }\n\n  let mut ct: i32 = 0;\n\n  let mut cv: Vec<(usize, usize, char)> = Vec::new();\n  \n  for i in 0 .. m-1 {\n    for j in 0 .. n-1 {\n      match (flg[i][j] == emb[0][0],\n             flg[i][j+1] == emb[0][1],\n             flg[i+1][j] == emb[1][0],\n             flg[i+1][j+1] == emb[1][1]) {\n             (true, true, true, true) => { ct += 1; },\n             (false, true, true, true) => { cv.push((i, j, emb[0][0])); },\n             (true, false, true, true) => { cv.push((i, j+1, emb[0][1])); },\n             (true, true, false, true) => { cv.push((i+1, j, emb[1][0])); },\n             (true, true, true, false) => { cv.push((i+1, j+1, emb[1][1])); },\n             _ => {},\n      }\n    }\n  }\n\n  let mut df: i32 = 0;\n  \n  for &(i, j, c) in &cv {\n    let cc = flg[i][j];\n    let x = cnt(&flg, &emb, i, j);\n    flg[i][j] = c;\n    let y = cnt(&flg, &emb, i, j);\n    flg[i][j] = cc;\n    df = cmp::max(df, y - x);\n  }\n  \n  println!(\"{}\", ct + df);\n}\n\nfn read<T>() -> T\n  where T: std::str::FromStr,\n        T::Err: std::fmt::Debug\n{\n  let mut buf = String::new();\n  std::io::stdin().read_line(&mut buf).expect(\"failed to read\");\n  buf.trim().parse().unwrap()\n}\n\nfn read_vec<T>() -> Vec<T>\n  where T: std::str::FromStr,\n        T::Err: std::fmt::Debug\n{\n  let mut buf = String::new();\n  std::io::stdin().read_line(&mut buf).expect(\"failed to read\");\n  buf.split_whitespace().map(|e| e.parse().unwrap()).collect()\n}\n\nfn cnt(v: &Vec<Vec<char>>, e: &Vec<Vec<char>>, i: usize, j: usize) -> i32 {\n  let m = v.len();\n  let n = v[0].len();\n  let mut ct: i32 = 0;\n\n  if i > 0 && j > 0 &&\n     v[i-1][j-1] == e[0][0] &&\n     v[i-1][j] == e[0][1] &&\n     v[i][j-1] == e[1][0] &&\n     v[i][j] == e[1][1] {\n       ct += 1;\n     }\n  if i > 0 && j < n - 1 &&\n     v[i-1][j] == e[0][0] &&\n     v[i-1][j+1] == e[0][1] &&\n     v[i][j] == e[1][0] &&\n     v[i][j+1] == e[1][1] {\n       ct += 1;\n     }\n  if i < m - 1 && j > 0 &&\n     v[i][j-1] == e[0][0] &&\n     v[i][j] == e[0][1] &&\n     v[i+1][j-1] == e[1][0] &&\n     v[i+1][j] == e[1][1] {\n       ct += 1;\n     }\n  if i < m - 1 && j < n - 1 &&\n     v[i][j] == e[0][0] &&\n     v[i][j+1] == e[0][1] &&\n     v[i+1][j] == e[1][0] &&\n     v[i+1][j+1] == e[1][1] {\n       ct += 1;\n     }\n     \n   ct\n}\n\n"
  }
]