Implement a Treap data structure that supports insertion, deletion, searching, and printing of keys. The Treap should maintain both the binary search tree property and heap property. You need to perform operations based on the provided algorithm, including inserting nodes with a key and priority, reporting existence of a key, deleting a node, and printing the key order via inorder and preorder traversals.