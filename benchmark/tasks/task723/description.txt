There are N towns numbered 1 to N and M roads. Each road connects two towns bidirectionally and has a specified length. Takahashi travels between towns by car, consuming one liter of fuel for each unit distance. He can fill his tank at towns, but once the tank is empty, he cannot continue traveling. Given a maximum fuel capacity L, the task is to process Q queries to find the minimum number of times he needs to refuel while traveling from a starting town to a target town. If the target town is unreachable, return -1.