[
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = 1;\n\t\trep(j, n) if(i & 1 << j) t *= a[j] / __gcd(t, a[j]);\n\t\tf[i] = m / t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tdouble ans = 0;\n\trep(i, 1 << n){\n\t\tlong double e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tprintf(\"%.9f\\n\", ans);\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#ifdef _WIN32\n#define scanfll(x) scanf(\"%I64d\", x)\n#define printfll(x) printf(\"%I64d\", x)\n#else\n#define scanfll(x) scanf(\"%lld\", x)\n#define printfll(x) printf(\"%lld\", x)\n#endif\n#define rep(i,n) for(long long i = 0; i < (long long)(n); i++)\n#define repi(i,a,b) for(long long i = (long long)(a); i < (long long)(b); i++)\n#define pb push_back\n#define all(x) (x).begin(), (x).end()\n#define fi first\n#define se second\n#define mt make_tuple\n#define mp make_pair\ntemplate<class T1, class T2> bool chmin(T1 &a, T2 b) { return b < a && (a = b, true); }\ntemplate<class T1, class T2> bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\n\nusing ll = long long; using ld = long double; using vll = vector<ll>; using vvll = vector<vll>; using vld = vector<ld>; \nusing vi = vector<int>; using vvi = vector<vi>;\nvll conv(vi& v) { vll r(v.size()); rep(i, v.size()) r[i] = v[i]; return r; }\nusing P = pair<ll, ll>;\n\ntemplate <typename T, typename U> ostream &operator<<(ostream &o, const pair<T, U> &v) {  o << \"(\" << v.first << \", \" << v.second << \")\"; return o; }\ntemplate<size_t...> struct seq{}; template<size_t N, size_t... Is> struct gen_seq : gen_seq<N-1, N-1, Is...>{}; template<size_t... Is> struct gen_seq<0, Is...> : seq<Is...>{};\ntemplate<class Ch, class Tr, class Tuple, size_t... Is>\nvoid print_tuple(basic_ostream<Ch,Tr>& os, Tuple const& t, seq<Is...>){ using s = int[]; (void)s{0, (void(os << (Is == 0? \"\" : \", \") << get<Is>(t)), 0)...}; }\ntemplate<class Ch, class Tr, class... Args> \nauto operator<<(basic_ostream<Ch, Tr>& os, tuple<Args...> const& t) -> basic_ostream<Ch, Tr>& { os << \"(\"; print_tuple(os, t, gen_seq<sizeof...(Args)>()); return os << \")\"; }\nostream &operator<<(ostream &o, const vvll &v) { rep(i, v.size()) { rep(j, v[i].size()) o << v[i][j] << \" \"; cout << endl; } return o; }\ntemplate <typename T> ostream &operator<<(ostream &o, const vector<T> &v) { o << '['; rep(i, v.size()) o << v[i] << (i != v.size()-1 ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T>  ostream &operator<<(ostream &o, const set<T> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const unordered_map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it; o << \"]\";  return o; }\nvoid printbits(ll mask, ll n) { rep(i, n) { cout << !!(mask & (1ll << i)); } cout << endl; }\n#define ldout fixed << setprecision(40) \n\nstatic const double EPS = 1e-14;\nstatic const long long INF = 1e18;\nstatic const long long mo = 1e9+7;\n\nvoid FZT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(!(j & 1 << i)) f[j] += f[j | 1 << i];\n}\n\n// ????????????????????????\n// O(n 2^n)\n//\n// f???2^n??§???????????°????????????\n// f????????????????¨???????????????\\?????????????????????????????¨???f????????????????¨??????????????????????\nvoid FMT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n}\n\nvll f;\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n, m; cin >> n >> m;\n    vll a(n), q(n); \n    rep(i, n) cin >> a[i];\n    rep(i, n) cin >> q[i];\n\n    f = vll(1<<n);\n\n    rep(mask, 1<<n) if (mask) {\n        ll p = 1;\n        rep(j, n) if (mask & (1ll << j)) {\n            ll u = a[j] / __gcd(p, a[j]);\n            if ((double)p * u < 2e18)\n                p *= u;\n            else \n                p = ((ll)1e18)+10;\n        }\n        f[mask] = m / p;\n    }\n\n    FMT(f);\n\n    double ret = 0;\n    rep(mask, 1<<n) {\n        double p = 1;\n        rep(j, n) {\n            p *= (double)(mask & (1ll << j) ? (q[j]) : 100-q[j]) / 100;\n        }\n        ret += abs(f[mask]) * p;\n    }\n    cout << ldout << ret << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\n#define fore(i,a) for(auto &i:a)\n#define all(x) (x).begin(),(x).end()\n//#pragma GCC optimize (\"-O3\")\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\ntypedef long long ll; const int inf = INT_MAX / 2; const ll infl = 1LL << 60;\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\n//---------------------------------------------------------------------------------------------------\ntemplate<int MOD> struct ModInt {\n    static const int Mod = MOD; unsigned x; ModInt() : x(0) { }\n    ModInt(signed sig) { x = sig < 0 ? sig % MOD + MOD : sig % MOD; }\n    ModInt(signed long long sig) { x = sig < 0 ? sig % MOD + MOD : sig % MOD; }\n    int get() const { return (int)x; }\n    ModInt &operator+=(ModInt that) { if ((x += that.x) >= MOD) x -= MOD; return *this; }\n    ModInt &operator-=(ModInt that) { if ((x += MOD - that.x) >= MOD) x -= MOD; return *this; }\n    ModInt &operator*=(ModInt that) { x = (unsigned long long)x * that.x % MOD; return *this; }\n    ModInt &operator/=(ModInt that) { return *this *= that.inverse(); }\n    ModInt operator+(ModInt that) const { return ModInt(*this) += that; }\n    ModInt operator-(ModInt that) const { return ModInt(*this) -= that; }\n    ModInt operator*(ModInt that) const { return ModInt(*this) *= that; }\n    ModInt operator/(ModInt that) const { return ModInt(*this) /= that; }\n    ModInt inverse() const { long long a = x, b = MOD, u = 1, v = 0;\n        while (b) { long long t = a / b; a -= t * b; std::swap(a, b); u -= t * v; std::swap(u, v); }\n        return ModInt(u); }\n    bool operator==(ModInt that) const { return x == that.x; }\n    bool operator!=(ModInt that) const { return x != that.x; }\n    ModInt operator-() const { ModInt t; t.x = x == 0 ? 0 : Mod - x; return t; }\n};\ntemplate<int MOD> ostream& operator<<(ostream& st, const ModInt<MOD> a) { st << a.get(); return st; };\ntemplate<int MOD> ModInt<MOD> operator^(ModInt<MOD> a, unsigned long long k) {\n    ModInt<MOD> r = 1; while (k) { if (k & 1) r *= a; a *= a; k >>= 1; } return r; }\ntemplate<typename T, int FAC_MAX> struct Comb { vector<T> fac, ifac;\n    Comb(){fac.resize(FAC_MAX,1);ifac.resize(FAC_MAX,1);rep(i,1,FAC_MAX)fac[i]=fac[i-1]*i;\n        ifac[FAC_MAX-1]=T(1)/fac[FAC_MAX-1];rrep(i,FAC_MAX-2,1)ifac[i]=ifac[i+1]*T(i+1);}\n    T aPb(int a, int b) { if (b < 0 || a < b) return T(0); return fac[a] * ifac[a - b]; }\n    T aCb(int a, int b) { if (b < 0 || a < b) return T(0); return fac[a] * ifac[a - b] * ifac[b]; }\n    T nHk(int n, int k) { if (n == 0 && k == 0) return T(1); if (n <= 0 || k < 0) return 0;\n        return aCb(n + k - 1, k); }}; // nHk = (n+k-1)Ck : n is separator\ntypedef ModInt<1000000007> mint;\ntypedef long double ld;\nld lginf = -1;\nll mul(ll a, ll b) {\n    if (lginf < 0) lginf = log10l(infl); ld aa = log10l(a), bb = log10l(b);\n    if (lginf <= aa + bb) return infl; return a * b;\n}\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { if (a == infl || b == infl) return infl; return mul(a / gcd(a, b), b); }\n/*---------------------------------------------------------------------------------------------------\n　　　　　　　　　　　 ∧＿∧  \n　　　　　 ∧＿∧ 　（´<_｀ ）　 Welcome to My Coding Space!\n　　　　 （ ´_ゝ`）　/　 ⌒i     \n　　　　／　　　＼　 　  |　|     \n　　　 /　　 /￣￣￣￣/　　|  \n　 ＿_(__ﾆつ/　    ＿/ .| .|＿＿＿＿  \n　 　　　＼/＿＿＿＿/　（u　⊃  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\n\n\n\n\n\nint N; ll M;\nll A[20]; double P[20];\ndouble sm[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) cin >> P[i], P[i] = P[i] / 100;\n    \n    rep(msk, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if (msk & (1 << i)) lc = lcm(lc, A[i]);\n        sm[msk] = M / lc;\n    }\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) sm[j] -= sm[j ^ (1 << i)];\n\n    double ans = 0;\n    rep(msk, 0, 1 << N) {\n        double prop = 1;\n        rep(i, 0, N) {\n            if (msk & (1 << i)) prop *= P[i];\n            else prop *= 1 - P[i];\n        }\n        ans += abs(sm[msk]) * prop;\n    }\n    printf(\"%.10f\\n\", ans);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M;\nint A[22],P[22];\n\nint f[1<<20];\n\nsigned main(){\n    cin>>N>>M;\n    rep(i,N)cin>>A[i];\n    rep(i,N)cin>>P[i];\n\n    rep(i,1<<N){\n        int l=1;\n        rep(j,N){\n            if(!(i>>j&1))continue;\n            int g=__gcd(l,A[j]);\n            int u=A[j]/g;\n            l*=u;continue;\n            if(1.0*u*l<=M)l*=u;\n            else l=M+1;\n        }\n        f[i]=M/l;\n    }\n\n\n    rep(i, N) rep(j, 1 << N) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\n\n    double ans=0.0;\n    rep(i,1<<N){\n        int tmp=abs(f[i]);\n        double p=1.0;\n        rep(j,N){\n            if(i>>j&1)p*=P[j]/100.0;\n            else p*=(100-P[j])/100.0;\n        }\n        ans+=p*(M-tmp);\n    }\n    printf(\"%.20f\\n\",ans);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b) return MA;\n\treturn a*b;\n}\n\nlong long num[1<<20];\nlong double pr[1<<20];\n\nlong long a[20];\nlong double p[20];\n\nint main(){\n\tint N;\n\tlong long M;\n\tscanf(\"%d%lld\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(long double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tlong double ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tlong double tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9llf\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) continue;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 1.0e18+1) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nint n;\nll m;\nll a[20];\nlong double P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\treturn a / g * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tlong double p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts = lcm(s, a[v[i]]);\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nll INF = (1LL<<60);\nll N,M;\nll a[20];\nll p[20];\n\nll lcm(ll a,ll b){\n  ll c=__gcd(a,b);\n  a/=c;\n  if(a>INF/b)return INF;\n  else return a*b;\n}\n\nll calc(int bit){\n  ll k=1;\n  for(int i=0;i<N;i++){\n    if(bit>>i&1)\n      k=lcm(k,a[i]);\n  }\n  return M/k;\n}\n\n\nint main(){\n  cin>>N>>M;\n  for(int i=0;i<N;i++)cin>>a[i];\n  for(int i=0;i<N;i++)cin>>p[i];\n  double ans=0;\n  for(int i=1;i<(1<<N);i++){\n    double rate=1.0,flg=-1.0;\n    for(int j=0;j<N;j++){\n      if(i>>j&1){\n        rate*=(double)p[j] / 100.0;\n        flg*=-1.0;\n      }else{\n        //        rate*=(double)(100-p[j]) / 100.0;\n      }\n    }\n    //    cout<<rate<<' '<<flg<<' '<<calc(i)<<endl;\n    \n    ans+= rate*flg*calc(i);\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b+1) return MA;\n\treturn min(MA,a*b);\n}\n\nlong long num[1<<20];\nlong double pr[1<<20];\n\nlong long a[20];\nlong double p[20];\n\nint main(){\n\tint N;\n\tlong long M;\n\tscanf(\"%d%lld\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(long double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tlong double ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tlong double tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9llf\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <vector>\n#include <algorithm>\n#include <utility>\n\nconstexpr intmax_t  operator \"\"_jd(unsigned long long n) { return n; }\nconstexpr uintmax_t operator \"\"_ju(unsigned long long n) { return n; }\nconstexpr size_t    operator \"\"_zu(unsigned long long n) { return n; }\n// constexpr ptrdiff_t operator \"\"_td(unsigned long long n) { return n; }\n\nintmax_t gcd(intmax_t m, intmax_t n) {\n  while (n) std::swap(m %= n, n);\n  return m;\n}\n\nbool lcm_overflow(intmax_t m, intmax_t n, intmax_t& res) {\n  intmax_t g = gcd(m, n);\n  return __builtin_mul_overflow(m/g, n, &res);\n}\n\nintmax_t g(std::vector<intmax_t> const& a, size_t j, intmax_t m) {\n  intmax_t div = 1;\n  for (size_t i = 0; i < a.size(); ++i)\n    if (j >> i & 1)\n      if (lcm_overflow(div, a[i], div)) return 0;\n\n  return m / div;\n}\n\nint main() {\n  size_t n;\n  intmax_t m;\n  scanf(\"%zu %jd\", &n, &m);\n\n  std::vector<intmax_t> a(n);\n  for (auto& ai: a) scanf(\"%jd\", &ai);\n\n  std::vector<int> p(n);\n  for (auto& pi: p) scanf(\"%d\", &pi);\n\n  std::vector<intmax_t> dp(1_zu << n);\n  for (size_t j = 1; j < dp.size(); ++j)\n    dp[j] = g(a, j, m);\n\n  for (size_t i = 0; i < n; ++i)\n    for (size_t j = 0; j < (1_zu << n); ++j)\n      if (j >> i & 1) dp[j] -= dp[j ^ (1_zu << i)];\n\n  double res = 0;\n  for (size_t j = 0; j < (1_zu << n); ++j) {\n    double pj = 1;\n    for (size_t i = 0; i < n; ++i)\n      pj *= ((j >> i & 1)? p[i]: 100-p[i]) / 100.0;\n\n    intmax_t vj = dp[j];\n    if (!__builtin_parityll(j)) vj = -vj;\n    res += pj * vj;\n  }\n\n  printf(\"%.12f\\n\", res);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<ll> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tll n, m;\n\tcin >> n >> m;\n\tvi a(n);\n\tREP(i, n) cin >> a[i];\n\tvector<ld> p(n);\n\tREP(i, n)\n\t{\n\t\tld a; cin >> a;\n\t\tp[i] = a / 100.0;\n\t}\n\tvector<ll> cnt(1 << n);\n\tREP(i, 1 << n)\n\t{\n\t\tll t = 1;\n\t\tbool f = false;\n\t\tREP(j, n)\n\t\t{\n\t\t\tif (!((i >> j) & 1)) continue;\n\t\t\tll tmp = a[j] / gcd(t, a[j]);\n\t\t\tif (t > LLONG_MAX / tmp) f = true;\n\t\t\telse t *= tmp;\n\t\t}\n\t\tif (f) cnt[i] = 0;\n\t\telse cnt[i] = m / t;\n\t}\n\n\tREP(i, n)REP(j, 1 << n) if (j & 1 << i) cnt[j] -= cnt[j ^ 1 << i];\n\n\tld ans = 0;\n\tREP(i, 1 << n)\n\t{\n\t\tld exp = 1.0;\n\t\tREP(j, n)\n\t\t{\n\t\t\tif ((i >> j) & 1) exp *= p[j];\n\t\t\telse exp *= 1.0 - p[j];\n\t\t}\n\t\tans += exp * (m - abs(cnt[i]));\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <climits>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <set>\n#include <map>\n#include <iostream>\n#include <deque>\n#include <complex>\n#include <string>\n#include <iomanip>\n#include <sstream>\n#include <bitset>\n#include <valarray>\n#include <iterator>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<ll> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) container.begin(), container.end()\n#define RALL(container) container.rbegin(), container.rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\nos<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n// 最大公約数を求める\nll gcd(ll a,ll b){\n\treturn b>0?gcd(b,a%b):a;\n}\n// 最小公倍数を求める\nll lcm(ll a,ll b){\n\ta = a/gcd(a,b);\n\tif(b!=0 && a>LONG_MAX/b) return 0;\n\treturn a*b;\n}\nint n;\nll m;\nmain(){\n\twhile(cin >> n >> m){\n\t\tvi a(n), p(n);\n\t\tREP(i, n) cin >> a[i];\n\t\tREP(i, n) cin >> p[i];\n\t\tvi dp(1<<n);\n\t\tREP(i, 1<<n){\n\t\t\tif(!i) continue;\n\t\t\tll l=1;\n\t\t\tREP(j, n)\n\t\t\t\tif(l && (i>>j)&1) l = lcm(l, a[j]);\n\t\t\tdp[i] = l?m/l:0;\n\t\t}\n\t\tREP(i, n)REP(j, 1<<n) if((j>>i)&1) dp[j] -= dp[j^(1<<i)];\n\t\tdouble ans = 0;\n\t\tREP(i, 1<<n){\n\t\t\tif(!i) continue;\n\t\t\tdouble pr=1.0;\n\t\t\tREP(j, n)\n\t\t\t\tif((i>>j)&1) pr *= p[j]/100.0;\n\t\t\t\telse pr *= (100-p[j])/100.0;\n\t\t\tans += pr * abs(dp[i]);\n\t\t}\n\t\tprintf(\"%.10f\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  Int n,m;\n  cin>>n>>m;\n  vector<Int> a(n),p(n);\n  for(Int i=0;i<n;i++) cin>>a[i];\n  for(Int i=0;i<n;i++) cin>>p[i];\n  vector<Int> dp(1<<n,0);\n  for(Int b=0;b<(1<<n);b++){\n    Int t=1;\n    for(Int i=0;i<n;i++){\n      Int k=a[i]/__gcd(t,a[i]);\n      if((b>>i)&1) t=(t<=m/k?t*k:m+1);\n    }\n    dp[b]=m/t;\n  }\n      \n  for(Int i=0;i<n;i++)\n    for(Int b=0;b<(1<<n);b++)\n      if((b>>i)&1) dp[b]-=dp[b^(1<<i)];\n  \n  double ans=0;\n  for(Int b=0;b<(1<<n);b++){\n    double po=1;\n    for(Int i=0;i<n;i++)\n      if((b>>i)&1) po*=p[i]/100.0;\n      else po*=1.0-(p[i]/100.0);\n    ans+=po*(m-abs(dp[b]));\n  }\n  cout<<fixed<<setprecision(12)<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  while(y){\n    if(x < y) swap(x,y);\n    if(!y) return x;\n    x %= y;\n  }\n  return x;\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  vector<long long int> LCM;\n  vector<double> P_;\n  vector<int> C;\n  LCM.push_back(1);\n  P_.push_back(1.0);\n  C.push_back(0);\n  for(int i = 0; i < n; ++i){\n    long long int s = LCM.size();\n    for(long long int j = 0; j < s; ++j){\n      long long int t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i]/100.0;\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n      C.push_back(c);\n      //cout << t << \" \" << p << \" \" << c << endl;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\ntypedef double ld;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nconst ld eps = 1e-8;\nconst ld pi = acos(-1.0);\ntypedef pair<ld, ld> LDP;\ntypedef pair<ll, ll> LP;\n#define fr first\n#define sc second\n\nstring add(string a, string b) {\n\treverse(a.begin(), a.end());\n\treverse(b.begin(), b.end());\n\tint len = max(a.length(), b.length());\n\tint rest = 0; string res;\n\trep(i, len + 1) {\n\t\tif (i < (int)a.length()) {\n\t\t\trest += a[i] - '0';\n\t\t}\n\t\tif (i < (int)b.length()) {\n\t\t\trest += b[i] - '0';\n\t\t}\n\t\tres.push_back('0' + (rest % 10));\n\t\trest /= 10;\n\t}\n\twhile (res.length() && res[res.length() - 1] == '0')res.erase(res.end() - 1);\n\treverse(res.begin(), res.end());\n\treturn res;\n}\nstring multi0(int m, string a) {\n\tstring res;\n\treverse(a.begin(), a.end());\n\tint len = a.length();\n\tint rest = 0;\n\trep(i, len) {\n\t\trest += m * (a[i] - '0');\n\t\tres.push_back('0' + (rest % 10));\n\t\trest /= 10;\n\t}\n\tif (rest)res.push_back('0' + rest);\n\treverse(res.begin(), res.end());\n\treturn res;\n}\nstring multi(string a, string b) {\n\tint len = a.length(); string res = \"0\";\n\tper(i, len) {\n\t\tint t = a[i] - '0'; int rest = len - i - 1;\n\t\tstring nex = multi0(t, b);\n\t\trep(j, rest) {\n\t\t\tnex.push_back('0');\n\t\t}\n\t\tres = add(res, nex);\n\t}\n\treturn res;\n}\n\nint n; ll m;\nvector<ll> a;\nvector<ld> p;\n\n\nll multi(ll a, ll b) {\n\tstring s = to_string(a), t = to_string(b);\n\tif (s.length() + t.length() < 19)return a * b;\n\tstring st = multi(s, t);\n\tif (st.length() > 18) {\n\t\tif (st != \"1000000000000000000\") {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn a * b;\n}\nll gcd(ll a, ll b) {\n\tif (a < b)swap(a, b);\n\twhile (b) {\n\t\tll r = a % b; a = b; b = r;\n\t}\n\treturn a;\n}\nll lcd(ll a, ll b) {\n\tll g = gcd(a, b);\n\ta /= g;\n\treturn multi(a, b);\n}\nvector<ll> lcm;\n//vector<ld> sp;\nvoid init() {\n\tlcm.resize(1 << n);\n\t//sp.resize(1 << n,1);\n\tlcm[0] = 1;\n\trep1(i, (1 << n)-1) {\n\t\trep(j, n) {\n\t\t\tif (i&(1 << j)) {\n\t\t\t\tlcm[i] = lcd(lcm[i ^ (1 << j)], a[j]);\n\t\t\t\tbreak;\n\t\t\t\t//sp[i] *= p[j];\n\t\t\t}\n\t\t\t/*else {\n\t\t\t\tsp[i] *= 1 - p[j];\n\t\t\t}*/\n\t\t}\n\t}\n}\n\nvector<vector<ld>> v;\nvoid solve() {\n\tcout << fixed << setprecision(8);\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\trep(i, n) {\n\t\tcin >> a[i];\n\t}\n\trep(i, n) {\n\t\tcin >> p[i]; p[i] /= 100.0;\n\t}\n\tinit();\n\tv.resize(1 << n);\n\tld ans = 0;\n\trep1(i, (1 << n) - 1) {\n\t\t//cout << lcm[i] << endl;\n\t\tint tmp = 0; ld z = 1;\n\t\trep(j, n) {\n\t\t\tif (i&(1 << j))tmp++;\n\t\t}\n\t\tv[i].resize(tmp,0);\n\t\tif(lcm[i]!=0)v[i][tmp - 1] = m/lcm[i];\n\t\tif (tmp % 2 == 0)v[i][tmp-1] = -v[i][tmp-1];\n\t\trep(j, n) {\n\t\t\tif (i&(1 << j)) {\n\t\t\t\tint ni = i ^ (1 << j);\n\t\t\t\trep(k, v[ni].size()) {\n\t\t\t\t\tv[i][k] += v[ni][k];\n\t\t\t\t}\n\t\t\t\tz *= p[j];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tz *= (1 - p[j]);\n\t\t\t}\n\t\t}\n\t\tld sum = 0;\n\t\trep(j, tmp-1) {\n\t\t\tld c = tmp - j-1;\n\t\t\tv[i][j] /= c;\n\t\t\tsum += v[i][j];\n\t\t}\n\t\tsum += v[i][tmp - 1];\n\t\t//cout << i << \" \" << sum << endl;\n\t\tans += sum * z;\n\t}\n\tcout << ans << endl;\n}\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tsolve();\n\t//stop\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n#include <climits>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nll gcd(ll a, ll b){\n  return (a % b == 0) ? b : gcd(b, a % b);\n}\n\nint main(){\n  int N;\n  ll M;\n  while(cin >> N >> M){\n    vector<ll> a(N);\n    vector<int> p(N);\n    REP(i, N) cin >> a[i];\n    REP(i, N) cin >> p[i];\n    static ll F[1 << 20] = {};\n    // 包除原理 (チャレンジブック p.264)\n    FOR(S, 1, 1 << N){\n      int sign = (__builtin_popcount(S) % 2 == 0) ? -1 : 1;\n      ll lcm = 1;\n      for (int i = 0; i < N; i++) if(S >> i & 1){\n        lcm /= gcd(lcm, a[i]);\n        if(LLONG_MAX / lcm < a[i]){\n          lcm = LLONG_MAX;\n          break;\n        }\n        lcm *= a[i];\n      }\n      F[S] = sign * (M / lcm);\n    }\n    // 高速ゼータ変換 (http://topcoder.g.hatena.ne.jp/iwiwi/20120422/1335065228)\n    REP(i, N)REP(S, 1 << N){\n      if(0 == (S & (1 << i))){\n        F[S | 1 << i] += F[S];\n      }\n    }\n    double ans = 0;\n    REP(S, 1 << N){\n      double prob = 1;\n      REP(i, N) {\n        if(S >> i & 1) prob *= p[i] / 100.0;\n        else prob *= (100.0 - p[i]) / 100.0;\n      }\n      ans += prob * F[S];\n    }\n    printf(\"%.8lf\\n\", ans);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nint n;\nll m;\nll a[20];\nlong double P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\treturn a / g * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tlong double p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts = lcm(s, a[v[i]]);\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y-1);(X) >=0;--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(10);\n  int i,j,k;\n  int n;\n  ll m,gcd,lcm;\n  cin>>n>>m;\n  vector<ll> a(n);\n  vector<double> p(n);\n  rep(i,n)\n    cin>>a[i];\n  rep(i,n){\n    cin>>p[i];\n    p[i]/=100;\n  }cout<<p;\n  double pro,cnt,re=0;\n  rep(i,1<<n)if(i){\n    pro=1,cnt=m;lcm=1;\n    rep(j,n){\n      if(i>>j&1){\n\tpro*=-p[j];\n\tgcd=__gcd(lcm,a[j]);\n\tcnt/=a[j]/gcd;\n\tif(cnt<1)\n\t  break;\n\tlcm*=a[j]/gcd;\n      }\n    }\n    cout<<pro<<\",\"<<cnt<<endl;\n    re+=pro*floor(cnt);\n  }\n  cout<<-re<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntemplate<class T>\nbool chmax(T& a, const T& b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate<class T>\nbool chmin(T& a, const T& b) {\n    if (b < a) { a = b; return true; }\n    return false;\n}\n\n// std::vector Declaration\ntemplate<typename T>\nvector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T, typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a, make_v<T>(ts...));\n}\n\n// std::vector Declaration and Initialization\ntemplate<typename T>\nvector<T> make_vector(size_t a, T x) { return vector<T>(a, x); }\ntemplate<typename T, typename U, typename... Ts>\nauto make_vector(size_t a, U b, Ts... ts) {\n    return vector<decltype(make_vector<T>(b,ts...))>(a, make_vector<T>(b, ts...));\n}\n\n// std::vector Input\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& v) {\n    for (auto &e : v) is >> e;\n    return is;\n}\n\n// std::vector Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::array Debug\ntemplate<typename T, size_t n>\nostream& operator<<(ostream& os, const array<T, n>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::deque Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const deque<T>& d) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : d) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::pair Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const pair<T, U>& p) {\n    os << \"(\" << p.first << \" \" << p.second << \")\";\n    return os;\n}\n\n// std::set Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const set<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::multiset Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const multiset<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::map Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const map<T, U>& mp) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : mp) {\n        os << (a ? \"\" : \" \");\n        os << e.first << \":\" << e.second;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::tuple Debug\ntemplate<int N, class Tuple>\nvoid out(ostream& os, const Tuple& t){}\ntemplate<int N, class Tuple, class H, class ...Ts>\nvoid out(ostream& os, const Tuple& t) {\n    if (N) os << \" \";\n    os << get<N>(t);\n    out<N+1,Tuple,Ts...>(os, t);\n}\ntemplate<class ...Ts>\nostream& operator<<(ostream& os, const tuple<Ts...>& t) {\n    os << \"(\";\n    out<0,tuple<Ts...>,Ts...>(os, t);\n    os << \")\";\n    return os;\n}\n\n// Debug\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n\n// Weighted edge\ntemplate<typename T>\nstruct edge {\n    int src, to;\n    T cost;\n\n    edge() {}\n    edge(int to, T cost) : src(-1), to(to), cost(cost) {}\n    edge(int src, int to, T cost) : src(src), to(to), cost(cost) {}\n\n    friend ostream& operator<<(ostream& os, const edge& e) {\n        return os << \"(\" << e.src << \"->\" << e.to << \":\" << e.cost << \")\";\n    }\n};\n\nusing LL = int64_t;\n\n#define fs first\n#define sc second\n\nconst int64_t MOD = 1e9+7;\n\n\ntemplate<typename T>\nvector<T> fast_mobius_transform_2(const vector<T>& g) {\n    // Return f(s):\n    // s.t. g(s) = \\sum_{t \\subset s} f(t)\n    // ( e.g. f(s) = \\sum_{t \\subset s} (-1)^|s-t| * g(t) )\n    int n = g.size();\n    vector<T> f = g;\n    for (int i = 0; (1 << i) < n; ++i) {\n        for (int j = 0; j < n; ++j) {\n            if (j >> i & 1) {\n                f[j] -= f[j & ~(1<<i)];\n            }\n        }\n    }\n    return f;\n}\n\n\nLL LCM(LL a, LL b) {\n    return (LL)min(2e18l+10, a / __gcd(a, b) * 1.0l * b);\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    LL n, m; cin >> n >> m;\n    vector<LL> a(n);\n    vector<double> p(n);\n    cin >> a >> p;\n\n    for (int i = 0; i < n; ++i) {\n        p[i] /= 100;\n    }\n\n    vector<LL> g(1<<n);\n\n    for (int bit = 0; bit < 1<<n; ++bit) {\n        LL lcm = 1;\n        for (int i = 0; i < n; ++i) {\n            if (bit >> i & 1) {\n                lcm = LCM(lcm, a[i]);\n            }\n        }\n        g[bit] = m / lcm;\n    }\n\n    auto f = fast_mobius_transform_2(g);\n\n    double ans = 0;\n\n    for (int bit = 0; bit < 1<<n; ++bit) {\n        double prob = 1;\n        for (int i = 0; i < n; ++i) {\n            prob *= (bit >> i & 1 ? p[i] : 1 - p[i]);\n        }\n\n        ans += prob * (m - f[bit] * (__builtin_popcount(bit) & 1 ? -1 : 1));\n    }\n\n\n    cout << ans << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n \nusing ll = long long;\n\nconstexpr ll INF = 2e18;\nconstexpr ll invalid = -1;\n\nll lcm(ll a, ll b) {\n    ll g = __gcd(a, b);\n    a /= g;\n    if(a > INF / b) {\n        return invalid;\n    }\n    return a * b;\n}\n\nint main() {\n    int n;\n    ll m;\n    cin >> n >> m;\n    vector<ll> a(n);\n    vector<double> p(n);\n    for(int i = 0; i < n; ++i) {\n        cin >> a[i];\n    }\n    for(int i = 0; i < n; ++i) {\n        cin >> p[i];\n        p[i] /= 100;\n    }\n\n    double res = 0;\n    for(int S = 1; S < 1 << n; ++S) {\n        int cnt = 0;\n        double q = 1;\n        for(int i = 0; i < n; ++i) {\n            if((S >> i) & 1) {\n                cnt++;\n                q *= p[i];\n            }\n        }\n\n        ll t = 1;\n        for(int i = 0; i < n; ++i) {\n            if((S >> i) & 1) {\n                t = lcm(t, a[i]);\n            }\n            if(t == invalid) {\n                break;\n            }\n        }\n        if(t != invalid) {\n            if(cnt & 1) {\n                res += q * (m / t);\n            } else {\n                res -= q * (m / t);\n            }\n        }\n    }\n\n    cout << fixed << setprecision(10) << res << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong double dp[2 << 20][2], prev_[2 << 20][2];\nlong long n, m, a[22]; long double p[22];\n\nlong long gcd(long long a1, long long b1) {\n\tif (b1 == 0) return a1;\n\treturn gcd(b1, a1%b1);\n}\n\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) { cin >> p[i]; p[i] *= 0.01; }\n\tprev_[0][0] = 1;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t// パターン 1 : 何も取らない\n\t\t\tdp[j][0] += prev_[j][0] * (1.0L - p[i]);\n\t\t\tdp[j][1] += prev_[j][1] * (1.0L - p[i]);\n\n\t\t\t// パターン 2 : 取るが包除はしない\n\t\t\tdp[j][0] += prev_[j][0] * p[i];\n\t\t\tdp[j][1] += prev_[j][1] * p[i];\n\n\t\t\t// パターン 3 : 取って包除もする\n\t\t\tdp[j + (1 << i)][1] += prev_[j][0] * p[i];\n\t\t\tdp[j + (1 << i)][0] += prev_[j][1] * p[i];\n\t\t}\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tprev_[j][0] = dp[j][0]; dp[j][0] = 0;\n\t\t\tprev_[j][1] = dp[j][1]; dp[j][1] = 0;\n\t\t}\n\t}\n\tlong double ans = 0;\n\tfor (int i = 0; i < (1 << n); i++) {\n\t\tlong long F = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif ((i / (1 << j)) % 2 == 0) continue;\n\t\t\tlong long G = gcd(F, a[j]);\n\t\t\tif (m / F < G) { F = (1LL << 60); break; }\n\t\t\tF = F / G * a[j];\n\t\t}\n\t\tlong long A = m / F;\n\t\tans -= 1.0L*A*prev_[i][0];\n\t\tans += 1.0L*A*prev_[i][1];\n\t}\n\tprintf(\"%.12Lf\\n\", 1.0L * m + ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  int n,m;\n  cin>>n>>m;\n  vector<long long int> a(n);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  \n  auto val=[&](int comb){\n    if(comb==0) return 0LL;\n    long long int res=1;\n    for(int i=0;i<n;i++){\n      if(comb&(1<<i)){\n\tdouble buf=double(res)*a[i];\n\tif(buf>1e18+3){\n\t  return 0LL;\n\t}\n\tres*=a[i];\n      }\n    }\n    return m/res;\n  };\n  \n  double res=0;\n  for(int i=0;i<(1<<n);i++){\n    int cnt=0;\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i & (1<<j)){\n\tpos*=double(p[j])/100;\n\tcnt++;\n      }\n    }\n    res+=pos*val(i)*((cnt%2)*2-1);\n  }\n  cout<<fixed<<setprecision(10);\n  cout<<res<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n  if(a < b) {a = b; return true;}\n  return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n  if(a > b) {a = b; return true;}\n  return false;\n}\ntemplate<typename T1, typename T2>\nostream& operator<<(ostream &os, const pair<T1, T2> p) {\n  os << p.first << \":\" << p.second;\n  return os;\n}\ntemplate<class T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n  for(int i=0;i<((int)(v.size()));++i) {\n    if(i) os << \" \";\n    os << v[i];\n  }\n  return os;\n}\nint main() {\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  ll n, m; cin >> n >> m;\n  vll a(n);\n  vector<double> p(n);\n  for(int i=0;i<(n);++i) cin >> a[i];\n  for(int i=0;i<(n);++i) cin >> p[i], p[i] /= 100;\n  vll val(1<<n);\n  for(int i=0;i<(1<<n);++i) {\n    ll now = 1;\n    for(int j=0;j<(n);++j) {\n      if((i>>j)&1) {\n        ll tmp = a[j] / __gcd(now, a[j]);\n        if(now <= 2e18 / tmp) {\n          now *= tmp;\n        } else {\n          now = 2e18+1;\n          break;\n        }\n      }\n    }\n    val[i] = m / now;\n    if(__builtin_popcount(i) % 2 == 0) val[i] = -val[i];\n  }\n  val[0] = 0;\n  for(int j=0;j<(n);++j) {\n    for(int i=0;i<(1<<n);++i) {\n      if((i>>j)&1) val[i] += val[i&~(1<<j)];\n    }\n  }\n  vector<double> prob(1<<n, 1);\n  for(int i=0;i<(1<<n);++i) {\n    for(int j=0;j<(n);++j) {\n      if((i>>j)&1) prob[i] *= p[j];\n      else prob[i] *= 1 - p[j];\n    }\n  }\n  double res = 0;\n  for(int i=0;i<(1<<n);++i) res += val[i] * prob[i];\n  cout << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nint n;\nll m;\nll a[20];\nlong double P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nint keta(ll v) {\n\tint ret = 0;\n\twhile (v) {\n\t\tv /= 10;\n\t\t++ret;\n\t}\n\treturn ret;\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\tll ret = a / g;\n\tif ( keta(ret) + keta(b) >= 19 ) return m+1;\n\treturn ret * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tlong double p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts = lcm(s, a[v[i]]);\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <queue>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n#include <memory>\n#include <random>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing vpll = vector<pll>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=(a)-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\n#define repi(i,a,b) for(int i=a;i<b;i++);\nconst ll mod = 1000000007;\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0> {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>> {\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const {\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\nll pow(ll base, ll i, ll mod) {\n\tll a = 1;\n\twhile (i) {\n\t\tif (i & 1) {\n\t\t\ta *= base;\n\t\t\ta %= mod;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= mod;\n\t\ti /= 2;\n\t}\n\treturn a;\n}\nll gcd(ll a, ll b) {\n\twhile (b) {\n\t\tll c = a%b;\n\t\ta = b;\n\t\tb = c;\n\t}\n\treturn a;\n}\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b)*b;\n}\n#ifdef _MSC_VER\n#include <intrin.h>\n#endif\nint popcnt(unsigned long long a) {\n#ifndef _MSC_VER\n\treturn __builtin_popcntll(a);\n#else\n\treturn _mm_popcnt_u32(a >> 32) + _mm_popcnt_u32(a);\n\ta = (a & 0x5555555555555555) + (a >> 1 & 0x5555555555555555);\n\ta = (a & 0x3333333333333333) + (a >> 2 & 0x3333333333333333);\n\ta = (a & 0x0f0f0f0f0f0f0f0f) + (a >> 4 & 0x0f0f0f0f0f0f0f0f);\n\ta = (a & 0x00ff00ff00ff00ff) + (a >> 8 & 0x00ff00ff00ff00ff);\n\ta = (a & 0x0000ffff0000ffff) + (a >> 16 & 0x0000ffff0000ffff);\n\treturn (a & 0xffffffff) + (a >> 32);\n#endif\n}\nclass unionfind {\n\tvector<int> par, rank, size_;//????????§??????????????¢???????????????????????????rank???????????????size?????????\npublic:\n\tunionfind(int n) :par(n), rank(n), size_(n, 1) {\n\t\tiota(ALL(par), 0);\n\t}\n\tint find(int x) {\n\t\tif (par[x] == x)return x;\n\t\treturn par[x] = find(par[x]);\n\t}\n\tvoid unite(int x, int y) {\n\t\tx = find(x), y = find(y);\n\t\tif (x == y)return;\n\t\tif (rank[x] < rank[y])swap(x, y);\n\t\tpar[y] = x;\n\t\tsize_[x] += size_[y];\n\t\tif (rank[x] == rank[y])rank[x]++;\n\t}\n\tbool same(int x, int y) {\n\t\treturn find(x) == find(y);\n\t}\n\tint size(int x) {\n\t\treturn size_[find(x)];\n\t}\n};\ntemplate<class T, class Func = function<T(T, T)>>\nclass segtree {\n\tvector<T> obj;\n\tint offset;\n\tFunc updater;\n\tT e;\n\tint bufsize(int num) {\n\t\tint i = 1;\n\t\tfor (; num >i; i <<= 1);\n\t\toffset = i - 1;\n\t\treturn (i << 1) - 1;\n\t}\n\tT query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a || b <= l)return e;\n\t\tif (a <= l && r <= b)return obj[k];\n\t\telse return updater(query(a, b, k * 2 + 1, l, (l + r) / 2), query(a, b, k * 2 + 2, (l + r) / 2, r));\n\t}\npublic:\n\tT query(int a, int b) {//[a,b)\n\t\treturn query(a, b, 0, 0, offset + 1);\n\t}\n\tvoid updateall(int l = 0, int r = -1) {\n\t\tif (r < 0)r = offset + 1;\n\t\tl += offset, r += offset;\n\t\tif (l == 0)return;\n\t\tdo {\n\t\t\tl = l - 1 >> 1, r = r - 1 >> 1;\n\t\t\tfor (int i = l; i < r; i++)obj[i] = updater(obj[i * 2 + 1], obj[i * 2 + 2]);\n\t\t} while (l);\n\t}\n\tvoid update(int k, T &a) {\n\t\tk += offset;\n\t\tobj[k] = a;\n\t\twhile (k) {\n\t\t\tk = k - 1 >> 1;\n\t\t\tobj[k] = updater(obj[k * 2 + 1], obj[k * 2 + 2]);\n\t\t}\n\t}\n\tsegtree(int n, T e, const Func &updater = Func()) :obj(bufsize(n), e), e(e), updater(updater) {}\n\tsegtree(vector<T> &vec, T e, const Func &updater = Func()) :obj(bufsize(vec.size()), e), e(e), updater(updater) {\n\t\tcopy(vec.begin(), vec.end(), obj.begin() + offset);\n\t\tupdateall();\n\t}\n\tT& operator[](int n) {\n\t\treturn obj[n + offset];\n\t}\n};\ntemplate<class T = int>\nclass BIT {//????¬????BIT????????????????????????????????°??????????????????\n\tvector<T> bit;\npublic:\n\tBIT(int n) :bit(n + 1, 0) {}\n\tvoid add(int i, T x) {\n\t\twhile (i <= bit.size()) {\n\t\t\tbit[i] += x;\n\t\t\ti += i&-i;\n\t\t}\n\t}\n\tT sum(int i) {\n\t\tT s = 0;\n\t\twhile (i) {\n\t\t\ts += bit[i];\n\t\t\ti &= i - 1;\n\t\t}\n\t\treturn s;\n\t}\n};\ntemplate<class T>\nclass rangeadd {\n\tBIT<T> b0, b1;\n\trangeadd(int n) :b0(n), b1(n) {}\n\tvoid add(int l, int r, T x) {//[l,r)\n\t\tb0.add(l, -x(l - 1));\n\t\tb1.add(l, x);\n\t\tb0.add(r, x*r);\n\t\tb1.add(r, -x);\n\t}\n\tT sum(int i) {\n\t\treturn b0.sum(i) + b1.sum(i)*i;\n\t}\n};\n//end of lib\n//template<class S=void,int ptr_num, class T = char>class trie {\n//\tumap<T, trie<S, ptr_num, T> next;\n//public:\n//\tS key;\n//\ttrie<S, ptr_num, T>* ptr[ptr_num] = {};\n//\ttrie(S &&data) :key(data) {}\n//\ttrie(const S &data) :key(data) {}\n//\tvoid add(T x,S data) {\n//\t\tif (!next.find(x))next.insert(x, data);\n//\t}\n//\ttrie& operator[](T x) {\n//\t\treturn next[x];\n//\t}\n//\tbool find(T x) {\n//\t\tretun next.find(x);\n//\t}\n//};\n//template<class T=char>class AhoCorasick {\n//\ttrie<pair<bool,int>, 2, T> tree;\n//\tAhoCorasick(vector<string> p) {\n//\t\tint num = 0;\n//\t\tvector<decltype(&tree)> que(p.size(),&tree);\n//\t\tfor (int i = 0;; i++) {\n//\t\t\tbool end = 1;\n//\t\t\tint i = 0;\n//\t\t\tfor (auto a : p) {\n//\t\t\t\tif (i >= a.size())break;\n//\t\t\t\tend = ;0\n//\t\t\t\tque[i] = (*que[i])[a[i]];\n//\t\t\t\ti++;\n//\t\t\t}\n//\t\t\tif (end)break;\n//\t\t}\n//\t}\n//};\nint main() {\n\tll n, m;\n\tcin >> n >> m;\n\tvi a(n);\n\tvector<double> p(n);\n\trep(i, n)cin >> a[i];\n\trep(i, n)cin >> p[i];\n\trep(i, n)p[i] /= 100;\n\tvll dp(1 << n);\n\trep(i, 1 << n) {\n\t\tll l = 1;\n\t\trep(j, n)if (i & 1 << j)l = lcm(l, a[j]);\n\t\tdp[i] = m / l*(popcnt(i) % 2 ? 1 : -1);\n\t}\n\tdp[0] = 0;\n\trep(i, n)rep(j, 1 << n)if (j & 1 << i)dp[j] += dp[j ^ 1 << i];\n\tdouble ans = 0;\n\trep(i, 1 << n) {\n\t\tdouble q = 1;\n\t\trep(j, n)q *= (i & 1 << j ? p[j] : 1 - p[j]);\n\t\tans += q*dp[i];\n\t}\n\tcout << fixed << setprecision(10) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<stack>\n#include<map>\n#include<set>\n#include<bitset>\n#include<functional>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)m ; i < (int) n ; ++i )\n#define rep(i,n) REP(i,0,n)\ntypedef long long ll;\ntypedef pair<int,int> pint;\ntypedef pair<ll,int> pli;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<60 ;\nconst ll mod=1e9+7 ;\n\ndouble q[2222222];\nll l[2222222];\n\nll gcd(ll a,ll b){\n    if(a<b)swap(a,b);\n    return (a%b==0?b:gcd(b,a%b));\n}\n\nll lcm(ll a,ll b){\n    ll g=gcd(a,b);\n    a/=g;\n    if((double)a>1e18/b)return (ll)1e18+1;\n    else return a*b;\n}\nint main(){\n    ll n,x;\n    cin>>n>>x;\n    ll a[n];\n    rep(i,n)cin>>a[i];\n    int m=1<<n;\n    rep(i,m){\n        ll g=1;\n        ll cnt=0;\n        rep(j,n)if((1<<j)&i)g=lcm(g,a[j]),cnt++;\n        l[i]=x/g;\n        if(cnt%2)l[i]*=-1;\n    }\n    l[0]=0;\n    rep(j,n)rep(i,m)if((1<<j)&i)l[i]+=l[i^(1<<j)];\n    \n    double p[n];\n    rep(i,n){\n        cin>>p[i];\n        p[i]/=100;\n    }\n    rep(i,m)q[i]=1;\n    rep(i,m)rep(j,n){\n        if((1<<j)&i)q[i]*=p[j];\n        else q[i]*=1.0-p[j];\n    }\n    double ans=0;\n    rep(i,m)ans+=q[i]*l[i];\n    cout<<fixed<<setprecision(10);\n    cout<<-ans<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\n\n#define INF 1LL<<60\nint N; ll M; ll A[20]; int P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) cin >> P[i];\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)){\n            if (lc == INF) break;\n            lc = lcm(lc, A[i]);\n            if (lc < A[i]) lc = INF;\n        }\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    double ans = 0;\n    rep(mask, 0, 1 << N) {\n        double p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= (double)P[i] / 100.0;\n            else p *= (double)(100 - P[i]) / 100.0;\n        }\n\n        ans += (double)abs(f[mask]) * p;\n    }\n    printf(\"%.10f\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M;\nint A[22],P[22];\n\nvector<int> fast_mobius_transform(vector<int> f) {\n    for (int i = 0; (1 << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1 << i) {\n                f[j] -= f[j ^ 1 << i];\n            }\n        }\n    }\n    return f;\n}\nint gcd(int a,int b){\n    return b?gcd(b,a%b):a;\n}\n\nsigned main(){\n    cin>>N>>M;\n    rep(i,N)cin>>A[i];\n    rep(i,N)cin>>P[i];\n\n    vector<int>f(1<<N);\n    f[0]=1;\n    for(int i=1;i<1<<N;i++){\n        int p=32-__builtin_clz(i)-1;\n        int x=f[i^(1<<p)];\n        int g=gcd(x,A[p]);\n        if(1.0*x*A[p]/g>M)f[i]=M+1;\n        else f[i]=x/g*A[p];\n    }\n\n    for(int i=0;i<1<<N;i++)f[i]=M/f[i];\n    f[0]=0;\n    vector<int>g=fast_mobius_transform(f);\n\n    double ans=0.0;\n    rep(i,1<<N){\n        double q=1.0;\n        rep(j,N){\n            if(i>>j&1){\n                q*=P[j]/100.0;\n            }\n            else{\n                q*=(100-P[j])/100.0;\n            }\n        }\n        ans+=q*abs(g[i]);\n    }\n    printf(\"%.20f\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\n\nint main()\n{\n\tint n;\n\tll m;\n\tcin >> n >> m;\n\tvector<ll> a(n);\n\tvector<int> p(n);\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> a[i];\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> p[i];\n\t}\n\tvector<ll> f(1 << n);\n\tfor (int i = 1; i < (1 << n); i++) {\n\t\tll lcm = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (i & (1 << j)) {\n\t\t\t\tll tmp = a[j] / __gcd(lcm, a[j]);\n\t\t\t\tif (tmp > (m + lcm - 1) / lcm) {\n\t\t\t\t\tlcm = m + 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlcm *= tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tf[i] = (__builtin_popcount(i) & 1 ? 1 : -1) * m / lcm;\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tif ((j & (1 << i))) {\n\t\t\t\tf[j] += f[j ^ (1 << i)];\n\t\t\t}\n\t\t}\n\t}\n\tld res = 0;\n\tfor (int i = 0; i < (1 << n); i++) {\n\t\tld x = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (i & (1 << j)) {\n\t\t\t\tx *= (ld)p[j] / 100;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tx *= (ld)(100 - p[j]) / 100;\n\t\t\t}\n\t\t}\n\t\tres += f[i] * x;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing vl = vector<ll>;\ntemplate<class T> using vc = vector<T>;\ntemplate<class T> using vvc = vector<vector<T>>;\n\n#define eb emplace_back\n#define all(x) (x).begin(), (x).end()\n#define rep(i, n) for (ll i = 0; i < (n); i++)\n#define repr(i, n) for (ll i = (n)-1; i >= 0; i--)\n#define repe(i, l, r) for (ll i = (l); i < (r); i++)\n#define reper(i, l, r) for (ll i = (r)-1; i >= (l); i--)\n#define repa(i,n) for (auto& i: n)\n\ntemplate<class T> inline bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\nvoid init() {cin.tie(0);ios::sync_with_stdio(false);cout << fixed << setprecision(15);}\n\n#ifdef DEBUG\ntemplate <class T, class N> void verr(const T& a, const N& n) { rep(i, n) cerr << a[i] << \" \"; cerr << \"\\n\" << flush; }\nll dbgt = 1; void err() { cerr << \"passed \" << dbgt++ << \"\\n\" << flush; }\ntemplate<class H, class... T> void err(H&& h,T&&... t){ cerr<< h << (sizeof...(t)?\" \":\"\\n\") << flush; if(sizeof...(t)>0) err(forward<T>(t)...); }\n#endif\n\nconst ll INF = 5e18;\nconst ld EPS = 1e-11;\nconst ld PI = acos(-1.0L);\nconst ll MOD = 1e9 + 7;\n// const ll MOD = 998244353;\n//--------------------------------------------------------------------------------//\nll A[20];\nld P[20];\nll mob[1 << 20];\n\nll gcd(ll a, ll b){\n    ll r = a % b;\n    while(r){\n        a = b, b = r;\n        r = a % b;\n    }\n    return b;\n}\n\nint main() {\n    init();\n    ld ans = 0;\n    ll N, M;\n    cin >> N >> M;\n    rep(i, N) cin >> A[i];\n    rep(i, N) cin >> P[i], P[i] /= 100.0L;\n\n    rep(bit, 1<<N){\n        ll lc = 1;\n        rep(i,N){\n            if (!(bit >> i & 1)) continue;\n            lc = (ll)min<ld>(M + 1, 1.0L * lc / gcd(lc, A[i]) * A[i]);\n            if (lc == M + 1) break;\n        }\n        // err(bit, lc, M / lc);\n        mob[bit] = M / lc;\n    }\n    \n    rep(i,N)rep(bit,1<<N){\n        if (bit >> i & 1) mob[bit] -= mob[bit ^ 1 << i];\n    }\n\n    rep(bit, 1<<N){\n        ld p = 1;\n        rep(i, N) p *= (bit >> i & 1 ? P[i] : 1.0L - P[i]);\n        // err(p, mob[bit]);\n        ans += p * (M - abs(mob[bit]));\n    }\n\n    cout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nll gcd(ll a,ll b)\n{\n    if(a == 0 || b == 0){\n        return max(a,b);\n    }\n    if(a % b == 0){\n        return b;\n    }else{\n        return gcd(b,a%b);\n    }\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int n;\n    ll m;\n    cin >> n >> m;\n    vl a(n);\n    vd p(n);\n    rep(i,n){\n        cin >> a[i];\n    }\n    rep(i,n){\n        cin >> p[i];\n    }\n    double two[21];\n    two[0] = 1.0;\n    rep(i,20){\n        two[i+1] = two[i] * 2;\n    }\n    double ans = 0;\n    srep(i,1,(1 << n)){\n        double res = 1.0;\n        ll val = 1;\n        bool flag = true;\n        rep(j,n){\n            if((i >> j) & 1){\n                res *= p[j]/100.0;\n                if(flag){\n                    ll g = gcd(val,a[j]);\n                    double ch = val;\n                    if(ch/g*a[j] > m+1000000LL){\n                        flag = false;\n                        break;\n                    }else{\n                        val = val/g*a[j];\n                    }\n                }\n            }\n        }\n        if(flag){\n            // show(val);\n            int num = __builtin_popcount(i);\n            res *= m/val;\n            // show(res);\n            // res *= two[n-num];\n            if(num % 2){\n                ans += res;\n            }else{\n                ans -= res;\n            }\n        }\n    }\n    printf(\"%.12f\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\n\nll a[22];\nll p[22];\n\nll dp[1<<20];\n\nint main(void){\n\tll n,m;\n\tcin >> n >> m;\n\trep(i,n) cin >> a[i];\n\trep(i,n) cin >> p[i];\n\n\trep(i,1<<n){\n\t\tif(i==0) continue;\n\t\tll lcm=1LL;\n\t\trep(j,n) if(i&(1<<j)){\n\t\t\tll g=__gcd(lcm,a[j]);\n\t\t\tif(lcm/g>LONG_MAX/a[j]){\n\t\t\t\tlcm=0LL;\n\t\t\t\tj=n;\n\t\t\t}else\n\t\t\t\tlcm=lcm/g*a[j];\n\t\t}\n\t\tif(lcm<=0)\n\t\t\tdp[i]=0;\n\t\telse\n\t\t\tdp[i]=m/lcm;\n\t}\n\n\trep(i,n)rep(j,1<<n) if(j&(1<<i)) dp[j]-=dp[j^(1<<i)];\n\n\tlong double ans=0.0;\n\n\trep(i,1<<n){\n\t\tlong double pro=1.0;\n\t\trep(j,n){\n\t\t\tif(i&(1<<j))\n\t\t\t\tpro*=1.0*p[j]/100;\n\t\t\telse\n\t\t\t\tpro*=1.0*(100-p[j])/100;\n\t\t}\n\t\tans+=1.0*abs(dp[i])*pro;\n\t}\n\tcout.precision(10);\n\tcout << fixed << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,b) FOR(i,0,(b))\n\ntypedef unsigned long long ull;\n\t\ndouble dp[1<<20][20];\n\ninline ull gcd(ull a,ull b){\n\treturn b?gcd(b,a%b):a;\n}\n\null a[20];\nint p[20];\nint main(){\n\tint n;\n\tull m;\n\tscanf(\"%d%llu\",&n,&m);\n\tREP(i,1<<n)\n\t\tREP(j,n)\n\t\t\tdp[i][j]=0;\n\tREP(i,n)\n\t\tscanf(\"%llu\",a+i);\n\tREP(i,n)\n\t\tscanf(\"%d\",p+i);\n\tFOR(i,1,1<<n){\n\t\tint c=0;\n\t\tREP(j,n) c+=(i>>j)&1;\n\t\tREP(j,n)\n\t\t\tREP(k,c-1)\n\t\t\t\tdp[i][k]+=dp[i^(1<<j)][k];\n\t\tREP(k,c-1)\n\t\t\tdp[i][k]/=(c-1-k);\n\t\tull s=1;\n\t\tREP(j,n)\n\t\t\tif((1<<j)&i){\n\t\t\t\tull g=s>a[j]?gcd(s,a[j]):gcd(a[j],s);\n\t\t\t\ts/=g;\n\t\t\t\tif(s>m/a[j]){\n\t\t\t\t\ts=0;\n\t\t\t\t\tbreak;\n\t\t\t\t}else\n\t\t\t\t\ts*=a[j];\n\t\t\t}\n\t\tif(s)\n\t\t\tdp[i][c-1]=m/s;\n\t}\n\tdouble s=0;\n\tFOR(i,1,1<<n){\n\t\tdouble e=1;\n\t\tREP(j,n)\n\t\t\tif((1<<j)&i)\n\t\t\t\te*=0.01*p[j];\n\t\t\telse\n\t\t\t\te*=0.01*(100-p[j]);\n\t\tdouble f=0;\n\t\tint k=1;\n\t\tREP(j,n){\n\t\t\tf+=dp[i][j]*k;\n\t\t\tk=-k;\n\t\t}\n\t\ts+=f*e;\n\t}\n\tprintf(\"%.8f\\n\",s);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <cmath>\n#include <bitset>\nusing namespace std;\nusing ll = long long;\nusing ld = __float128;\n\ntemplate <typename T>\nT gcd(const T a, const T b)\n{\n    return (b != 0) ? gcd(b, a % b) : a;\n}\n\ntemplate <typename T>\nvector<T> Moebius(vector<T> f)  // Moebius{f}(Y) = \\sum_{X \\subseteq Y} (-1)^{|Y\\X|} f(X)\n{\n    for (int i = 0; (1LL << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1LL << i) {\n                f[j] -= f[j ^ 1LL << i];\n            }\n        }\n    }\n    return f;\n}\n\nint main()\n{\n    int N;\n    cin >> N;\n    ll M;\n    cin >> M;\n    vector<ll> a(N);\n    vector<ld> p(N);\n    for (int i = 0; i < N; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < N; i++) {\n        long double p_;\n        cin >> p_;\n        p[i] = p_ / 100.0;\n    }\n\n    const int maximum = 1 << N;\n    vector<ld> ex(maximum, 1.0);\n    for (int i = 0; i < maximum; i++) {\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                ex[i] *= p[j];\n            }\n        }\n    }\n\n    ex[0] = 0;\n    for (int i = 1; i < maximum; i++) {\n        ll LCM = 1LL;\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                const ll g = gcd(LCM, a[j]);\n                const ll b = a[j] / g;\n                if (log2(LCM) + log2(b) < 63) {\n                    LCM *= b;\n                } else {\n                    ex[i] = 0;\n                    break;\n                }\n            }\n        }\n        ex[i] *= (ld)(M / LCM);\n    }\n    const vector<ld> ans = Moebius(ex);\n    cout << fixed << setprecision(30) << (long double)-ans[maximum - 1] << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define repeat_from(i, m, n) for (int i = (m); (i) < int(n); ++(i))\nusing ll = long long;\nusing namespace std;\ntemplate <typename T> T gcd(T a, T b) { while (a) { b %= a; swap(a, b); } return b; }\n\n/**\n * @brief fast mobius transformation\n * @note for f : 2^n \\to R; \\mu f(Y) = \\sum\\_{X \\subseteq Y} (-1)^{\\|Y \\setminues X\\|} f(X)\n * @see http://pekempey.hatenablog.com/entry/2016/10/30/205852\n * @param T is a group for the operator +\n */\ntemplate <typename T>\nvector<T> fast_mobius_transform(vector<T> f) {\n    int n = f.size();\n    for (int i = 1; i < n; i <<= 1) {\n        repeat (j, n) {\n            if (j & i) {\n                f[j] -= f[j ^ i];\n            }\n        }\n    }\n    return f;\n}\n\nint main() {\n    // input\n    int n; ll m; scanf(\"%d%lld\", &n, &m);\n    vector<ll> a(n); repeat (i, n) scanf(\"%lld\", &a[i]);\n    vector<int> p(n); repeat (i, n) scanf(\"%d\", &p[i]);\n    // solve\n    vector<ll> cnt(1 << n);\n    repeat_from (s, 1, 1 << n) {\n        ll acc = 1;\n        repeat (i, n) if (s & (1 << i)) {\n            ll a_i = a[i] / gcd(acc, a[i]);\n            double estimated = acc *(double) a_i;\n            if (m < estimated) {\n                acc = m+1;\n                break;\n            }\n            acc *= a_i;\n        }\n        cnt[s] = m / acc;\n    }\n    vector<ll> mu_cnt = fast_mobius_transform(cnt);\n    long double result = 0;\n    repeat (s, 1 << n) {\n        long double acc = 1;\n        repeat (i, n) acc *= (s & (1 << i) ? p[i] : 100 - p[i]) /(long double) 100.0;\n        result += abs(mu_cnt[s]) * acc;\n    }\n    // output\n    printf(\"%.10lf\\n\", (double)result);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tdp[0].emplace_back(0);\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[bit].emplace_back(m / g);\n\t\telse dp[bit].emplace_back(-(m / g));\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tdp[bit].emplace_back(dp[bit].back() + dp[bit ^ (1 << i)][sum]);\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * dp[bit].back();\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep1(i,(1<<n)-1){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.12lf\\n\",ret);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll _lcm(ll bit) {\n\tif(bit == 0) return INF * INF + INF;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\t__int128 g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\tif(g > INF * INF) return INF * INF + INF;\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].emplace_back(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].emplace_back(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n__int128 gcd(__int128 a,__int128 b){return (a==0 ? b : gcd(b%a,a));}\n\nint main(){\n  long long int n,m;\n  cin>>n>>m;\n  vector<long long int> a(n);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  \n  auto val=[&](int comb){\n    if(comb==0) return 0LL;\n    __int128 res=1;\n    for(int i=0;i<n;i++){\n      if(comb&(1<<i)){\n\tres*=gcd(res,a[comb]);\n\tif(res>1e18+3){\n\t  return 0LL;\n\t}\n\tres*=a[i];\n      }\n    }\n    return static_cast<long long int>(m/res);\n  };\n  \n  double res=0;\n  for(int i=0;i<(1<<n);i++){\n    int cnt=0;\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i & (1<<j)){\n\tpos*=double(p[j])/100;\n\tcnt++;\n      }\n    }\n    res+=pos*val(i)*((cnt%2)*2-1);\n  }\n  cout<<fixed<<setprecision(10);\n  cout<<res<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nll cnt[(1<<20)+5],m,num[25];\nint n;\ndouble p[25];\nint main(){\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> num[i];\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%lf\",&p[i]); p[i]/=100.;\n\t}\n\tfor(int i=1;i<(1<<n);i++){\n\t\tll N = 1LL; int B = __builtin_popcount(i);\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(!((i>>j)&1)) continue;\n\t\t\tif(8000000000000000000LL/N < num[j]/__gcd(N,num[j])) goto fail;\n\t\t\tN = N/__gcd(N,num[j])*num[j];\n\t\t}\n\t\tif(B%2==1) cnt[i] = m/N;\n\t\telse cnt[i] = -1*(m/N); fail:;\n\t}\n\tfor(int i=0;i<n;i++) for(int j=0;j<(1<<n);j++){\n\t\tif(((j>>i)&1)) cnt[j] += cnt[j^(1<<i)];\n\t}\n\tdouble ans = 0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tdouble prob = 1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(((i>>j)&1)) prob *= p[j];\n\t\t\telse prob *= 1.0-p[j];\n\t\t}\n\t\tans += prob * (double)cnt[i]; //cout << cnt[i] << \" \" << i << endl;\n\t}\n\tprintf(\"%.12f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\tif(a == c/b) return !(c%b);\n\treturn a > c/b;\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n#include <climits>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nll gcd(ll a, ll b){\n  return (a % b == 0) ? b : gcd(b, a % b);\n}\n\nint main(){\n  int N;\n  ll M;\n  while(cin >> N >> M){\n    vector<ll> a(N);\n    vector<int> p(N);\n    REP(i, N) cin >> a[i];\n    REP(i, N) cin >> p[i];\n    static ll F[1 << 20] = {};\n    // 包除原理 (チャレンジブック p.264)\n    FOR(S, 1, 1 << N){\n      int sign = (__builtin_popcount(S) % 2 == 0) ? -1 : 1;\n      ll lcm = 1;\n      for (int i = 0; i < N; i++) if(S >> i & 1){\n        lcm /= gcd(lcm, a[i]);\n        if((double)lcm * a[i] > 1e18){\n          lcm = LLONG_MAX;\n          break;\n        }\n        lcm *= a[i];\n      }\n      F[S] = sign * (M / lcm);\n    }\n    // 高速ゼータ変換 (http://topcoder.g.hatena.ne.jp/iwiwi/20120422/1335065228)\n    REP(i, N)REP(S, 1 << N){\n      if(0 == (S & (1 << i))){\n        F[S | 1 << i] += F[S];\n      }\n    }\n    double ans = 0;\n    REP(S, 1 << N){\n      double prob = 1;\n      REP(i, N) {\n        if(S >> i & 1) prob *= p[i] / 100.0;\n        else prob *= (100.0 - p[i]) / 100.0;\n      }\n      ans += prob * F[S];\n    }\n    printf(\"%.8lf\\n\", ans);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = long long;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\n\nconst int MAX = 1<<20;\nLL N, M;\ndouble num[MAX], prob[MAX];\n\nusing LLL = __int128;\n\nLLL gcd(LLL x, LLL y){\n  if(y == 0) return x;\n  return gcd(y, x%y);\n}\nLLL lcm(LLL x, LLL y){\n  return x / gcd(x, y) * y;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  cin >> N >> M;\n  VL xs(N);\n  vector<double> ps(N);\n  REP(i,N)\n\tcin >> xs[i];\n  REP(i,N){\n\tcin  >> ps[i];\n\tps[i] /= 100.;\n  }\n\n  FOR(b,1,1<<N){\n\tLLL l = 1;\n\tint bc = 0;\n\tREP(i,N){\n\t  if(b>>i&1){\n\t\tif(l <= M)\n\t\t  l = lcm(l, xs[i]);\n\t\t++bc;\n\t  }\n\t  num[b] = (bc%2*2-1) * M / l;\n\t}\n  }\n\n  for(int i=0;i<N;++i){\n\tfor(int b=0;b<(1<<N);++b){\n\t  if((b>>i&1) == 1)\n\t\tnum[b] += num[b^(1<<i)];\n\t}\n  }\n\n  double ans = 0.;\n  REP(b,1<<N){\n\tprob[b] = 1;\n\tREP(i,N){\n\t  prob[b] *= (b>>i&1? ps[i]: 1.-ps[i]);\n\t}\n\tans += prob[b] * num[b];\n  }\n\n  cout << fixed << setprecision(9) << ans << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <set>\n#include <map>\n#include <iomanip>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define MP make_pair\n#define PB push_back\ntypedef long double ld;\ntypedef long long ll;\n\nll gcd(ll a,ll b){\n    if(b==1)return b;\n    if(b==0)return a;\n    if(a<b)return gcd(b,a);\n    if(a%b==0)return b;\n    return gcd(b,a%b);\n}\n\nint main(){\n    ll n,m;\n    cin >> n >> m;\n    vector<ll>a(n);\n    rep(i,n)cin >> a[i];\n    vector<ld>p(n);\n    rep(i,n){\n        int tmp;\n        cin >> tmp;\n        p[i] = (ld)tmp/(ld)100.0;\n    }\n    vector<ld> pp(1<<n,(ld)1.0);\n    vector<int> s(1<<n);\n    vector<ld> dp(n+1);\n    dp[0] = (ld)0.0;\n    rep(bit,1<<n){\n        rep(i,n){\n            if((bit>>i)&1){\n                pp[bit] *= p[i];\n                s[bit]++;\n            }else{\n                pp[bit] *=((ld)1.0-p[i]);\n            }\n        }\n    }\n\n    for(int i=1;i<=n;i++){\n        dp[i] = ((ld)1.0-p[i-1])*dp[i-1];\n        \n        ld tmp= dp[i-1];\n        tmp += (ld)(m/a[i-1]);\n        rep(bit,1<<(i-1)){\n            if(bit==0)continue;\n            ll x = a[i-1];\n            bool flag = 0;\n            rep(j,i-1){\n                if((bit>>j)&1){\n                    ll y = gcd(x,a[j]);\n                    if((ld)x/(ld)y>(ld)(m+100000)/a[j]){\n                        flag = 1;\n                        break;\n                    }else{\n                        x = x/y;\n                        x *= a[j];\n                    } \n                }\n            }\n            if(flag)continue;\n            ld hoge = (ld)(m/x);\n            ld sss = 1.0;\n            for(int k = 0;k<i-1;k++){\n                if(bit>>k&1){\n                    sss *= p[k];\n                }\n            }\n            if(s[bit]%2==0){\n                \n                tmp += sss*hoge;\n            }else{\n                tmp -= sss*hoge;\n            }\n        }\n        dp[i] += tmp*p[i-1];\n    } \n    cout << fixed << setprecision(15) <<  dp[n] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll _lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = _lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].pb(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / _lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / _lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].pb(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<map>\n#include<set>\n#include<bitset>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)m ; i < (int) n ; i++ )\n#define rep(i,n) REP(i,0,n)\ntypedef long long ll;\ntypedef pair<int,int> pint;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<62 ;\nconst ll mod=1e9+7 ;\nint dx[4]={1,0,-1,0} , dy[4]={0,1,0,-1} ;\n\nll gcd(ll x,ll y){\n    if(x<y)swap(x,y);\n    if(x%y==0)return y;\n    else return gcd(y,x%y);\n}\n\nll lcm(ll x,ll y){\n    if(x>=longinf||y>=longinf||x<0||y<0)return -1;\n    ll g=gcd(x,y);\n    if(x/g<longinf/y) return x*y/g;\n    else return -1;\n}\nvector<ll> fast_mobius_transform(vector<ll> f) {\n    for (int i = 0; (1 << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1 << i) {\n                f[j] -= f[j ^ 1 << i];\n            }\n        }\n    }\n    return f;\n}\nint main(){\n   int n;\n   cin>>n;\n   ll m;\n   cin>>m;\n   ll a[n];\n   rep(i,n)cin>>a[i];\n   int N=1<<n;\n   ll dp[N];\n   dp[0]=1;\n   rep(i,N){\n       rep(j,n){\n           if(i&1<<j){\n               dp[i]=lcm(a[j],dp[i^(1<<j)]);\n               break;\n           }\n       }\n   }\n   vector<ll> v;\n   rep(i,N){\n       if(dp[i]<0)v.push_back(0);\n       else v.push_back(m/dp[i]);\n   }\n   v[0]=0;\n   v=fast_mobius_transform(v);\n   v[0]=0;\n   double ans=0;\n   double p[n];\n   rep(i,n){\n       cin>>p[i];\n       p[i]/=100;\n   }\n   rep(i,N){\n       double ret=1.0*abs(v[i]);\n       rep(j,n){\n           if(i&(1<<j))ret*=p[j];\n           else ret*=(1.0-p[j]);\n       }\n       ans+=ret;\n   }\n   cout<<setprecision(12)<<ans<<endl;\n   return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n/*\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  while(y){\n    x %= y;\n    swap(x,y);\n  }\n  return x;\n}\n*/\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  vector<long long int> LCM;\n  vector<double> P_;\n  vector<int> C;\n  LCM.push_back(1);\n  P_.push_back(1.0);\n  C.push_back(0);\n  for(int i = 0; i < n; ++i){\n    long long int s = LCM.size();\n    for(long long int j = 0; j < s; ++j){\n      long long int t = LCM[j]/__gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i]/100.0;\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n      C.push_back(c);\n      //cout << t << \" \" << p << \" \" << c << endl;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep(i,(1<<n)){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tcout.precision(20);\n\tcout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=(1LL<<60);\nll N,M,a[20],p[20];\ndouble ans=0;\n\nll lcm(ll a,ll b){\n  ll c=__gcd(a,b);\n  a/=c;\n  if(a>INF/b)return INF;\n  else return a*b;\n}\n\nvoid dfs(int x,ll k,double rate,int cnt){\n  if(x==N||k==INF){\n    if(cnt%2==1)ans+=(double)(M/k)*rate;\n    else if(cnt>0)ans-=(double)(M/k)*rate;\n  }else{\n    dfs(x+1,k,rate,cnt);\n    dfs(x+1,lcm(k,a[x]),rate*(double)p[x]/100.0,cnt+1);\n  }\n}\n\nint main(){\n  cin>>N>>M;\n  for(int i=0;i<N;i++)cin>>a[i];\n  for(int i=0;i<N;i++)cin>>p[i];\n  dfs(0,1,1.0,0);\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst ll INF=2e18;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nll gcd(ll a,ll b)\n{\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b)\n{\n\tif(a==INF || b==INF) return INF;\n\tif(a/gcd(a,b)>INF/b) return INF;\n\treturn a/gcd(a,b)*b;\n}\n\nint main()\n{\n\tfor(ll n,m;cin>>n>>m && n|m;){\n\t\tvl as(n);\n\t\trep(i,n) cin>>as[i];\n\t\tvd ps(n);\n\t\trep(i,n) cin>>ps[i],ps[i]/=100;\n\t\t\n\t\t// f(S): -1^|S| × (Sのどの要素でも割り切れる1<=x<=mの個数)\n\t\t// g(S): Sのいずれかの要素で割り切れる1<=x<=mの個数\n\t\tvl f(1<<n);\n\t\trepi(i,1,1<<n){\n\t\t\tll l=1;\n\t\t\trep(j,n) if(i>>j&1)\n\t\t\t\tl=lcm(l,as[j]);\n\t\t\tif(l==INF) continue;\n\t\t\t\n\t\t\tint sign=__builtin_popcount(i)&1?1:-1;\n\t\t\tf[i]+=sign*m/l;\n\t\t}\n\t\tvl g=f;\n\t\trep(i,n) rep(j,1<<n)\n\t\t\tif(j>>i&1)\n\t\t\t\tg[j]+=g[j^1<<i];\n\t\t\n\t\tdouble res=0;\n\t\trepi(i,1,1<<n){\n\t\t\tdouble p=1;\n\t\t\trep(j,n) p*=i>>j&1?ps[j]:1-ps[j];\n\t\t\tres+=p*g[i];\n\t\t}\n\t\tprintf(\"%.10f\\n\",res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long c=b;\n\t\tb=a;\n\t\ta=c;\n\t}\n\treturn b;\n}\nlong long v[20];\nint p[20];\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",v+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",p+i);\n\tdouble ret=0;\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long now=b;\n\t\tlong long G=0;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))G=gcd(G,v[j]);\n\t\tnow/=G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now/=v[j]/G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now=-now;\n\t\tdouble A=now;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))A*=0.01*p[j];\n\t\tret+=A;\n\t}\n\tprintf(\"%.9f\\n\",-ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <deque>\n#include <algorithm>\n\nusing namespace std;\ntypedef long long int ll;\ntypedef pair<int, int> P;\n\nll gcd(ll a, ll b){\n\tif(b==0) return a;\n\telse return gcd(b, a%b);\n}\n\nint main()\n{\n\tint n;\n\tll m;\n\tcin>>n>>m;\n\tll a[20];\n\tdouble p[20];\n\tfor(int i=0; i<n; i++){\n\t\tcin>>a[i];\n\t}\n\tfor(int i=0; i<n; i++){\n\t\tcin>>p[i];\n\t}\n\tll c[1048576];\n\tc[0]=0;\n\tfor(int i=1; i<(1<<n); i++){\n\t\tll lcm=1;\n\t\tfor(int j=0; j<n; j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tll g=gcd(lcm, a[j]);\n\t\t\t\tif(lcm/g>m/a[j]){\n\t\t\t\t\tlcm=-1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlcm=lcm/g*a[j];\n\t\t\t}\n\t\t}\n\t\tif(lcm==-1){\n\t\t\tc[i]=0;\n\t\t}else{\n\t\t\tc[i]=m/lcm;\n\t\t}\n\t}\n\tfor(int k=0; k<n; k++){\n\t\tfor(int i=(1<<n)-1; i>=1; i--){\n\t\t\tif(i&(1<<k)) c[i]-=c[i^(1<<k)];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(int i=0; i<(1<<n); i++){\n\t\tdouble p0=1;\n\t\tfor(int j=0; j<n; j++){\n\t\t\tif(i&(1<<j)) p0*=(p[j]/100);\n\t\t\telse p0*=(1-p[j]/100);\n\t\t}\n\t\tans+=((double)(abs(c[i]))*p0);\n\t}\n\tprintf(\"%.9lf\\n\", ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#ifdef _WIN32\n#define scanfll(x) scanf(\"%I64d\", x)\n#define printfll(x) printf(\"%I64d\", x)\n#else\n#define scanfll(x) scanf(\"%lld\", x)\n#define printfll(x) printf(\"%lld\", x)\n#endif\n#define rep(i,n) for(long long i = 0; i < (long long)(n); i++)\n#define repi(i,a,b) for(long long i = (long long)(a); i < (long long)(b); i++)\n#define pb push_back\n#define all(x) (x).begin(), (x).end()\n#define fi first\n#define se second\n#define mt make_tuple\n#define mp make_pair\ntemplate<class T1, class T2> bool chmin(T1 &a, T2 b) { return b < a && (a = b, true); }\ntemplate<class T1, class T2> bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\n\nusing ll = long long; using ld = long double; using vll = vector<ll>; using vvll = vector<vll>; using vld = vector<ld>; \nusing vi = vector<int>; using vvi = vector<vi>;\nvll conv(vi& v) { vll r(v.size()); rep(i, v.size()) r[i] = v[i]; return r; }\nusing P = pair<ll, ll>;\n\ntemplate <typename T, typename U> ostream &operator<<(ostream &o, const pair<T, U> &v) {  o << \"(\" << v.first << \", \" << v.second << \")\"; return o; }\ntemplate<size_t...> struct seq{}; template<size_t N, size_t... Is> struct gen_seq : gen_seq<N-1, N-1, Is...>{}; template<size_t... Is> struct gen_seq<0, Is...> : seq<Is...>{};\ntemplate<class Ch, class Tr, class Tuple, size_t... Is>\nvoid print_tuple(basic_ostream<Ch,Tr>& os, Tuple const& t, seq<Is...>){ using s = int[]; (void)s{0, (void(os << (Is == 0? \"\" : \", \") << get<Is>(t)), 0)...}; }\ntemplate<class Ch, class Tr, class... Args> \nauto operator<<(basic_ostream<Ch, Tr>& os, tuple<Args...> const& t) -> basic_ostream<Ch, Tr>& { os << \"(\"; print_tuple(os, t, gen_seq<sizeof...(Args)>()); return os << \")\"; }\nostream &operator<<(ostream &o, const vvll &v) { rep(i, v.size()) { rep(j, v[i].size()) o << v[i][j] << \" \"; cout << endl; } return o; }\ntemplate <typename T> ostream &operator<<(ostream &o, const vector<T> &v) { o << '['; rep(i, v.size()) o << v[i] << (i != v.size()-1 ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T>  ostream &operator<<(ostream &o, const set<T> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const unordered_map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it; o << \"]\";  return o; }\nvoid printbits(ll mask, ll n) { rep(i, n) { cout << !!(mask & (1ll << i)); } cout << endl; }\n#define ldout fixed << setprecision(40) \n\nstatic const double EPS = 1e-14;\nstatic const long long INF = 1e18;\nstatic const long long mo = 1e9+7;\n\nvoid FZT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(!(j & 1 << i)) f[j] += f[j | 1 << i];\n}\n\n// ????????????????????????\n// O(n 2^n)\n//\n// f???2^n??§???????????°????????????\n// f????????????????¨???????????????\\?????????????????????????????¨???f????????????????¨??????????????????????\nvoid FMT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n}\n\nvll f;\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n, m; cin >> n >> m;\n    vll a(n), q(n); \n    rep(i, n) cin >> a[i];\n    rep(i, n) cin >> q[i];\n\n    f = vll(1<<n);\n\n    rep(mask, 1<<n) if (mask) {\n        ll p = 1;\n        rep(j, n) if (mask & (1ll << j)) {\n            if ((double)p * (double)a[j] > 2e18) {\n                p = ((ll)1e18) + 10;\n                break;\n            }\n            p *= a[j];\n        }\n        f[mask] = m / p;\n    }\n\n    FMT(f);\n\n    double ret = 0;\n    rep(mask, 1<<n) {\n        double p = 1;\n        rep(j, n) {\n            p *= (double)(mask & (1ll << j) ? (q[j]) : 100-q[j]) / 100;\n        }\n        ret += abs(f[mask]) * p;\n    }\n    cout << ldout << ret << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nvector<long long int> a;\n\nvector<long long int> vals;\n\nlong long int val(int comb){\n  if(vals[comb]!=-1) return vals[comb];\n  long long int num=1;\n  for(int i=0;i<n;i++){\n    if(comb&(1<<i)){\n      double buf=double(num)*a[i];\n      if(buf>1e18+3){\n\treturn vals[comb]=0;\n      }\n      num*=a[i];\n    }\n  }\n  return vals[comb]=m/num;\n}\n\nint main(){\n  cin>>n>>m;\n  a.resize(n);\n  vals.resize(1<<n,-1);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  vector<long long int> dp(1<<n,0);\n  dp[0]=0;\n  for(int i=1;i<=n;i++){\n    int comb=(1<<i)-1;\n    while(comb<(1<<n)){\n      //renew dp[comb]\n      for(int j=1;j<i;j++){\n\tint comb2=(1<<j)-1;\n\twhile(comb2<(1<<i)){\n\t  int cnt=0;\n\t  int comb3=0;\n\t  for(int k=0;k<n;k++){\n\t    if(comb&(1<<k)){\n\t      if(comb2&(1<<cnt)){\n\t\tcomb3+=(1<<k);\n\t\tcnt++;\n\t      }\n\t      else cnt++;\n\t    }\n\t  }\n\n\t  dp[comb]+=val(comb3)*((j%2)*2-1);\n\t  int x=comb2&-comb2,y=comb2+x;\n\t  comb2=((comb2&~y)/x>>1)|y;\n\t}\n      }\n      long long int pat=val(comb);\n      dp[comb]+=pat*((i%2)*2-1);\n\n      int x=comb&-comb,y=comb+x;\n      comb=((comb&~y)/x>>1)|y;\n    }\n  }\n  double res=0;\n\n  for(int i=0;i<(1<<n);i++){\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i&(1<<j)){\n\tpos*=(double(p[j])/100);\n      }\n      else{\n\tpos*=(double(100-p[j])/100);\n      }\n    }\n    res+=dp[i]*pos;\n  }\n  cout<<setprecision(10)<<fixed;\n  cout<<res<<endl;\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <cmath>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl;\ntypedef long long ll;\nint n,p[20];\nll m,a[20],inf=1e18,f[1<<20],g[1<<20];\nll gcd(ll x,ll y){\n\tif(x>y) swap(x,y);\n\twhile(x>0){\n\t\ty%=x;\n\t\tswap(x,y);\n\t}\n\treturn y;\n}\nint main(){\n\tcin>>n>>m;\n\trep(i,n) cin>>a[i];\n\trep(i,n) cin>>p[i];\n\trep(i,1<<n){\n\t\tll now=1,cnt=0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tcnt++;\n\t\t\t\tif(m/a[j]<now/gcd(now,a[j])){\n\t\t\t\t\tf[i]=-1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnow=now/gcd(now,a[j])*a[j];\n\t\t\t}\n\t\t}\n\t\tif(f[i]==-1) f[i]=0;\n\t\telse f[i]=(m/now)*(cnt%2 ? -1 : 1);\n\t}\n\tf[0]=0;\n\trep(i,n) for(int j=(1<<n)-1;j>=0;j--) if(((j>>i)&1)==1) f[j]+=f[j-(1<<i)];\n\tdouble ans=0;\n\trep(i,1<<n){\n\t\tdouble pr=1;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1) pr*=(double)p[j]/100.0;\n\t\t\telse pr*=(double)(100.0-p[j])/100.0;\n\t\t}\n//\t\tcout<<i<<\" \"<<pr<<\" \"<<f[i]<<endl;\n\t\tans-=pr*f[i];\n\t}\n\tprintf(\"%.12f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <queue>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n#include <memory>\n#include <random>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing vpll = vector<pll>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=(a)-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\n#define repi(i,a,b) for(int i=a;i<b;i++);\nconst ll mod = 1000000007;\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0> {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>> {\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const {\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\nll pow(ll base, ll i, ll mod) {\n\tll a = 1;\n\twhile (i) {\n\t\tif (i & 1) {\n\t\t\ta *= base;\n\t\t\ta %= mod;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= mod;\n\t\ti /= 2;\n\t}\n\treturn a;\n}\nll gcd(ll a, ll b) {\n\twhile (b) {\n\t\tll c = a%b;\n\t\ta = b;\n\t\tb = c;\n\t}\n\treturn a;\n}\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b)*b;\n}\n#ifdef _MSC_VER\n#include <intrin.h>\n#endif\nint popcnt(unsigned long long a) {\n#ifndef _MSC_VER\n\treturn __builtin_popcountll(a);\n#else\n\treturn _mm_popcnt_u32(a >> 32) + _mm_popcnt_u32(a);\n\ta = (a & 0x5555555555555555) + (a >> 1 & 0x5555555555555555);\n\ta = (a & 0x3333333333333333) + (a >> 2 & 0x3333333333333333);\n\ta = (a & 0x0f0f0f0f0f0f0f0f) + (a >> 4 & 0x0f0f0f0f0f0f0f0f);\n\ta = (a & 0x00ff00ff00ff00ff) + (a >> 8 & 0x00ff00ff00ff00ff);\n\ta = (a & 0x0000ffff0000ffff) + (a >> 16 & 0x0000ffff0000ffff);\n\treturn (a & 0xffffffff) + (a >> 32);\n#endif\n}\nclass unionfind {\n\tvector<int> par, rank, size_;//????????§??????????????¢???????????????????????????rank???????????????size?????????\npublic:\n\tunionfind(int n) :par(n), rank(n), size_(n, 1) {\n\t\tiota(ALL(par), 0);\n\t}\n\tint find(int x) {\n\t\tif (par[x] == x)return x;\n\t\treturn par[x] = find(par[x]);\n\t}\n\tvoid unite(int x, int y) {\n\t\tx = find(x), y = find(y);\n\t\tif (x == y)return;\n\t\tif (rank[x] < rank[y])swap(x, y);\n\t\tpar[y] = x;\n\t\tsize_[x] += size_[y];\n\t\tif (rank[x] == rank[y])rank[x]++;\n\t}\n\tbool same(int x, int y) {\n\t\treturn find(x) == find(y);\n\t}\n\tint size(int x) {\n\t\treturn size_[find(x)];\n\t}\n};\ntemplate<class T, class Func = function<T(T, T)>>\nclass segtree {\n\tvector<T> obj;\n\tint offset;\n\tFunc updater;\n\tT e;\n\tint bufsize(int num) {\n\t\tint i = 1;\n\t\tfor (; num >i; i <<= 1);\n\t\toffset = i - 1;\n\t\treturn (i << 1) - 1;\n\t}\n\tT query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a || b <= l)return e;\n\t\tif (a <= l && r <= b)return obj[k];\n\t\telse return updater(query(a, b, k * 2 + 1, l, (l + r) / 2), query(a, b, k * 2 + 2, (l + r) / 2, r));\n\t}\npublic:\n\tT query(int a, int b) {//[a,b)\n\t\treturn query(a, b, 0, 0, offset + 1);\n\t}\n\tvoid updateall(int l = 0, int r = -1) {\n\t\tif (r < 0)r = offset + 1;\n\t\tl += offset, r += offset;\n\t\tif (l == 0)return;\n\t\tdo {\n\t\t\tl = l - 1 >> 1, r = r - 1 >> 1;\n\t\t\tfor (int i = l; i < r; i++)obj[i] = updater(obj[i * 2 + 1], obj[i * 2 + 2]);\n\t\t} while (l);\n\t}\n\tvoid update(int k, T &a) {\n\t\tk += offset;\n\t\tobj[k] = a;\n\t\twhile (k) {\n\t\t\tk = k - 1 >> 1;\n\t\t\tobj[k] = updater(obj[k * 2 + 1], obj[k * 2 + 2]);\n\t\t}\n\t}\n\tsegtree(int n, T e, const Func &updater = Func()) :obj(bufsize(n), e), e(e), updater(updater) {}\n\tsegtree(vector<T> &vec, T e, const Func &updater = Func()) :obj(bufsize(vec.size()), e), e(e), updater(updater) {\n\t\tcopy(vec.begin(), vec.end(), obj.begin() + offset);\n\t\tupdateall();\n\t}\n\tT& operator[](int n) {\n\t\treturn obj[n + offset];\n\t}\n};\ntemplate<class T = int>\nclass BIT {//????¬????BIT????????????????????????????????°??????????????????\n\tvector<T> bit;\npublic:\n\tBIT(int n) :bit(n + 1, 0) {}\n\tvoid add(int i, T x) {\n\t\twhile (i <= bit.size()) {\n\t\t\tbit[i] += x;\n\t\t\ti += i&-i;\n\t\t}\n\t}\n\tT sum(int i) {\n\t\tT s = 0;\n\t\twhile (i) {\n\t\t\ts += bit[i];\n\t\t\ti &= i - 1;\n\t\t}\n\t\treturn s;\n\t}\n};\ntemplate<class T>\nclass rangeadd {\n\tBIT<T> b0, b1;\n\trangeadd(int n) :b0(n), b1(n) {}\n\tvoid add(int l, int r, T x) {//[l,r)\n\t\tb0.add(l, -x(l - 1));\n\t\tb1.add(l, x);\n\t\tb0.add(r, x*r);\n\t\tb1.add(r, -x);\n\t}\n\tT sum(int i) {\n\t\treturn b0.sum(i) + b1.sum(i)*i;\n\t}\n};\n//end of lib\n//template<class S=void,int ptr_num, class T = char>class trie {\n//\tumap<T, trie<S, ptr_num, T> next;\n//public:\n//\tS key;\n//\ttrie<S, ptr_num, T>* ptr[ptr_num] = {};\n//\ttrie(S &&data) :key(data) {}\n//\ttrie(const S &data) :key(data) {}\n//\tvoid add(T x,S data) {\n//\t\tif (!next.find(x))next.insert(x, data);\n//\t}\n//\ttrie& operator[](T x) {\n//\t\treturn next[x];\n//\t}\n//\tbool find(T x) {\n//\t\tretun next.find(x);\n//\t}\n//};\n//template<class T=char>class AhoCorasick {\n//\ttrie<pair<bool,int>, 2, T> tree;\n//\tAhoCorasick(vector<string> p) {\n//\t\tint num = 0;\n//\t\tvector<decltype(&tree)> que(p.size(),&tree);\n//\t\tfor (int i = 0;; i++) {\n//\t\t\tbool end = 1;\n//\t\t\tint i = 0;\n//\t\t\tfor (auto a : p) {\n//\t\t\t\tif (i >= a.size())break;\n//\t\t\t\tend = ;0\n//\t\t\t\tque[i] = (*que[i])[a[i]];\n//\t\t\t\ti++;\n//\t\t\t}\n//\t\t\tif (end)break;\n//\t\t}\n//\t}\n//};\nint main() {\n\tll n, m;\n\tcin >> n >> m;\n\tvi a(n);\n\tvector<double> p(n);\n\trep(i, n)cin >> a[i];\n\trep(i, n)cin >> p[i];\n\trep(i, n)p[i] /= 100;\n\tvll dp(1 << n);\n\trep(i, 1 << n) {\n\t\tll l = 1;\n\t\trep(j, n)if (i & 1 << j)l = lcm(l, a[j]);\n\t\tdp[i] = m / l*(popcnt(i) % 2 ? 1 : -1);\n\t}\n\tdp[0] = 0;\n\trep(i, n)rep(j, 1 << n)if (j & 1 << i)dp[j] += dp[j ^ 1 << i];\n\tdouble ans = 0;\n\trep(i, 1 << n) {\n\t\tdouble q = 1;\n\t\trep(j, n)q *= (i & 1 << j ? p[j] : 1 - p[j]);\n\t\tans += q*dp[i];\n\t}\n\tcout << fixed << setprecision(10) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\n\nusing ld=long double;\n\nlong long int gcd(long long int l, long long int r) {\n\tif (l > r)return gcd(r, l);\n\telse {\n\t\tif (r%l) {\n\t\t\treturn gcd(l, r%l);\n\n\t\t}\n\t\telse {\n\t\t\treturn l;\n\t\t}\n\t}\n}\n\nint main() {\n\tint N; long long int M;cin>>N>>M;\n\tvector<long long int>as(N);\n\tvector<ld>pers(N);\n\tfor(int i=0;i<N;++i)cin>>as[i];\n\tfor (int i = 0; i < N; ++i) {\n\t\tint p;cin>>p;\n\t\tpers[i]=(ld)(p)/100.0l;\n\t}\n\n\tld ans=0;\n\tfor (int i = 1; i < (1 << N); ++i) {\n\t\tbitset<18>use;\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tif(i&(1<<j))use[j]=true;\n\t\t}\n\t\tlong long int num=1;\n\t\tld aper=1;\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tif (use[j]) {\n\t\t\t\tlong long int agcd(gcd(num, as[j]));\n\t\t\t\tld val = ld(num)*ld(as[j]) / ld(agcd);\n\t\t\t\tif (val > 1e18 + 1e17) {\n\t\t\t\t\tnum = 1e18 + 1e17;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnum = num / agcd*as[j];\n\t\t\t\t}\n\t\t\t\taper*=pers[j];\n\t\t\t}\n\t\t\n\t\t\t\n\t\t}\n\t\tif (use.count() % 2) {\n\t\t\tans+=aper*(M/num);\n\t\t}\n\t\telse {\n\t\t\tans-=aper*(M/num);\n\t\t}\n\t}\n\tcout<<setprecision(10)<<fixed<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\nll a[30];\nld p[30];\nll gcd(ll x, ll y){\n\tif(x<y) swap(x,y);\n\tif(y==0) return x;\n\treturn gcd(x%y,y);\n}\nint main(){\n\tcout.precision(20);\n\tll i,j,n,m;\n\tld ans = 0;\n\tcin >> n >> m;\n\tfor(i=0;i<n;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(i=0;i<n;i++){\n\t\tll x; cin >> x;\n\t\tp[i] = (ld)x/(ld)100;\n\t}\n\tfor(i=1;i<(1<<n);i++){\n\t\tll s = -1,lcm = 1;\n\t\tld pp = 1;\n\t\tfor(j=0;j<n;j++){\n\t\t\tif(1<<j & i){\n\t\t\t\tpp *= p[j]; s *= -1;\n\t\t\t\tll b = (a[j]/gcd(lcm,a[j]));\n\t\t\t\tif((ld)lcm*(ld)b>(ld)m){\n\t\t\t\t\tlcm = m + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlcm *= b;\n\t\t\t}\n\t\t}\n\t\tll val = s*(m/lcm);\n\t\tans += pp*(ld)val;\n\t}\n\tcout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long C=a;\n\t\ta=b;\n\t\tb=C;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tlong long m=1;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tGCD=gcd(m,c[j]);\n\t\t\t\tdouble lcm=(double)m*c[j]/GCD;\n\t\t\t\tif(lcm>(double)b+0.001){\n\t\t\t\t\tm=b+1;break;\n\t\t\t\t}else m=m*c[j]/GCD;\n\t\t\t}\n\t\t}\n\t\tdp[i]=b/m;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%.9f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define MAX_N 40\n#define INF 9000000000000000000\n#define MOD 1000000007\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,double> P;\n\nll n, m;\nll dp[(1<<20)];\nP a[20];\nvector<P> b;\n\nll gcd(ll x, ll y){\n    while(y){\n        x %= y;\n        swap(x,y);\n    }\n    return x;\n}\n\nint main(){\n    cin >> n >> m;\n    rep(i,n) cin >> a[i].first;\n    rep(i,n) cin >> a[i].second;\n    rep(i,n) a[i].second /= 100;\n    sort(a,a+n);\n    ll sanu = -1;\n    double prob = 1.0;\n    rep(i,n){\n        if(i == 0){\n            sanu = a[i].first;\n            prob *= (1-a[i].second);\n            continue;\n        }\n        if(a[i].first == sanu){\n            prob *= (1-a[i].second);\n        } else{\n            b.push_back(P(sanu,1-prob));\n            sanu = a[i].first;\n            prob = 1-a[i].second;\n        }\n    }\n    b.push_back(P(sanu,1-prob));\n    n = b.size();\n    rep(i,(1<<n)){\n        if(i == 0) continue;\n        int cnt = 0;\n        ll hoge = 1;\n        bool ok = true;\n        rep(j,n){\n            if(i&(1<<j)){\n                cnt++;\n                ll g = gcd(hoge,b[j].first);\n                hoge /= g;\n                if(INF/hoge < b[j].first){\n                    ok = false;\n                    break;\n                }\n                hoge = hoge*(b[j].first);\n            }\n        }\n        if(!ok) dp[i] = 0;\n        else dp[i] = m/hoge;\n        if(cnt%2 == 0) dp[i] *= -1;\n    }\n    rep(i,n) rep(j,(1<<n)){\n        if(j&(1<<i)){\n            dp[j] += dp[(j^(1<<i))];\n        }\n    }\n    double ans = 0.0;\n    rep(i,(1<<n)){\n        prob = 1.0;\n        rep(j,b.size()){\n            if(i&(1<<j)){\n                prob *= b[j].second;\n            } else{\n                prob *= (1-b[j].second);\n            }\n        }\n        ans += prob*dp[i];\n    }\n    printf(\"%.9f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  while(y){\n    if(x < y) swap(x,y);\n    if(!y) return x;\n    x %= y;\n  }\n  return x;\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  vector<long long int> LCM;\n  vector<double> P_;\n  vector<int> C;\n  LCM.push_back(1);\n  P_.push_back(1);\n  C.push_back(0);\n  for(int i = 0; i < n; ++i){\n    long long int s = LCM.size();\n    for(long long int j = 0; j < s; ++j){\n      long long int t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i]/100.0;\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n      C.push_back(c);\n      cout << t << \" \" << p << \" \" << c << endl;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n#include <climits>\n\n#include <iostream>\n#include <complex>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n\n#include <functional>\n#include <cassert>\n\ntypedef long long ll;\nusing namespace std;\n\n#define debug(x) cerr << __LINE__ << \" : \" << #x << \" = \" << (x) << endl;\n\n#define mod 1000000007 //1e9+7(prime number)\n#define INF 1000000000 //1e9\n#define LLINF 2000000000000000000LL //2e18\n#define SIZE 100010\n\n/* FastZetaTransform */\n\n// a[1001] = a[1001] + a[1011] + a[1101] + a[1111];\n\nvoid FZT(int n, int *a){\n  for(int i=0;i<n;i++)\n    for(int j=0;j<(1<<n);j++)\n      if(!(j & (1<<i))) a[j] += a[j | (1<<i)]; //総和\n}\n\n// a[1001] = a[1001] + a[1000] + a[0001] + a[0000];\n\nvoid FZT2(int n, ll *a){\n  for(int i=0;i<n;i++)\n    for(int j=0;j<(1<<n);j++)\n      if(j & (1<<i)) a[j] += a[j ^ (1<<i)]; //総和\n}\n\n\nll gcd(ll a, ll b){\n  return __gcd(a,b);\n}\n\nll lcm(ll a, ll b){\n  ll w = a/gcd(a,b);\n  if(w < LLONG_MAX/b) return w*b;\n  return LLINF;\n}\n\nll lower_bit(int t){\n  if(t == 0) return -1;\n  for(int i=0;;i++) {if(t%2) return i; t/=2;}\n}\n\nll lcmmemo[1<<20];\nll dp[1<<20] = {};\n\nint main(){\n  int n, p[30];\n  ll m, a[30];\n  \n  scanf(\"%d%lld\", &n, &m);\n\n  for(int i=0;i<n;i++) scanf(\"%lld\", a+i);\n  for(int i=0;i<n;i++) scanf(\"%d\", p+i);\n\n\n\n  lcmmemo[0] = 1;\n  dp[0] = 0;\n\n  for(int i=1;i<(1<<n);i++){\n    int t = i^(i&(-i));\n    lcmmemo[i] = lcm(lcmmemo[t], a[lower_bit(i)]);\n    dp[i] = m/lcmmemo[i] * (__builtin_popcount(i)%2 ? 1 : -1);\n  }\n\n  FZT2(n, dp);\n\n  double ans = 0;\n  \n  for(int i=0;i<(1<<n);i++){\n    double rate = 1;\n    for(int j=0;j<n;j++){\n      if(i & (1 << j)){\n        rate *= p[j]/100.0;\n      }else{\n        rate *= 1-p[j]/100.0;\n      }\n    }\n    ans += rate * dp[i];\n  }\n\n  printf(\"%.10lf\\n\", ans);\n  \n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstdio>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ULL;\n\nULL gcd(ULL a, ULL b) {\n    if(a < b) swap(a, b);\n    while(b > 0) {\n        ULL tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    int N;\n    ULL M;\n    cin >> N >> M;\n    vector<ULL> as(N);\n    vector<int> ps(N);\n    for(int i = 0; i < N; ++i) {\n        cin >> as[i];\n    }\n    for(int i = 0; i < N; ++i) {\n        cin >> ps[i];\n    }\n\n    long double ans = 0;\n    for(int pat = 1; pat < (1<<N); ++pat) {\n        vector<ULL> nums;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) nums.push_back(as[ord]);\n        }\n        ULL all_gcd = nums[0];\n        for(int i = 1; i < nums.size(); ++i) {\n            all_gcd = gcd(all_gcd, nums[i]);\n        }\n        long long part = M;\n        if(nums.size() > 1) {\n            nums[0] /= all_gcd;\n        }\n        for(int i = 0; i < nums.size(); ++i) {\n            part /= nums[i];\n        }\n        if(nums.size() % 2 == 0) part = -part;\n        //cout << part << endl;\n\n        long double expect = part;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) {\n                expect *= ps[ord]/100.0;\n            } else {\n                //prob *= (1 - ps[ord]/100.0);\n            }\n        }\n        //ans += part * prob;\n        ans += expect;\n    }\n\n    printf(\"%.8f\\n\", (double)ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M;\nint A[22],P[22];\n\nint f[1<<20];\n\nsigned main(){\n    cin>>N>>M;\n    rep(i,N)cin>>A[i];\n    rep(i,N)cin>>P[i];\n\n    rep(i,1<<N){\n        int l=1;\n        rep(j,N){\n            if(!(i>>j&1))continue;\n            int g=__gcd(l,A[j]);\n            int u=A[j]/g;\n            l*=u;continue;\n            if(1.0*u*l<=M)l*=u;\n            else l=M+1;\n        }\n        f[i]=M/l;\n    }\n\n\n    rep(i, N) rep(j, 1 << N) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\n\n    double ans=0.0;\n    rep(i,1<<N){\n        int tmp=abs(f[i]);\n        cout<<tmp<<endl;\n        double p=1.0;\n        rep(j,N){\n            if(i>>j&1)p*=P[j]/100.0;\n            else p*=(100-P[j])/100.0;\n        }\n        ans+=p*(M-tmp);\n    }\n    printf(\"%.20f\\n\",ans);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#ifdef _WIN32\n#define scanfll(x) scanf(\"%I64d\", x)\n#define printfll(x) printf(\"%I64d\", x)\n#else\n#define scanfll(x) scanf(\"%lld\", x)\n#define printfll(x) printf(\"%lld\", x)\n#endif\n#define rep(i,n) for(long long i = 0; i < (long long)(n); i++)\n#define repi(i,a,b) for(long long i = (long long)(a); i < (long long)(b); i++)\n#define pb push_back\n#define all(x) (x).begin(), (x).end()\n#define fi first\n#define se second\n#define mt make_tuple\n#define mp make_pair\ntemplate<class T1, class T2> bool chmin(T1 &a, T2 b) { return b < a && (a = b, true); }\ntemplate<class T1, class T2> bool chmax(T1 &a, T2 b) { return a < b && (a = b, true); }\n\nusing ll = long long; using ld = long double; using vll = vector<ll>; using vvll = vector<vll>; using vld = vector<ld>; \nusing vi = vector<int>; using vvi = vector<vi>;\nvll conv(vi& v) { vll r(v.size()); rep(i, v.size()) r[i] = v[i]; return r; }\nusing P = pair<ll, ll>;\n\ntemplate <typename T, typename U> ostream &operator<<(ostream &o, const pair<T, U> &v) {  o << \"(\" << v.first << \", \" << v.second << \")\"; return o; }\ntemplate<size_t...> struct seq{}; template<size_t N, size_t... Is> struct gen_seq : gen_seq<N-1, N-1, Is...>{}; template<size_t... Is> struct gen_seq<0, Is...> : seq<Is...>{};\ntemplate<class Ch, class Tr, class Tuple, size_t... Is>\nvoid print_tuple(basic_ostream<Ch,Tr>& os, Tuple const& t, seq<Is...>){ using s = int[]; (void)s{0, (void(os << (Is == 0? \"\" : \", \") << get<Is>(t)), 0)...}; }\ntemplate<class Ch, class Tr, class... Args> \nauto operator<<(basic_ostream<Ch, Tr>& os, tuple<Args...> const& t) -> basic_ostream<Ch, Tr>& { os << \"(\"; print_tuple(os, t, gen_seq<sizeof...(Args)>()); return os << \")\"; }\nostream &operator<<(ostream &o, const vvll &v) { rep(i, v.size()) { rep(j, v[i].size()) o << v[i][j] << \" \"; cout << endl; } return o; }\ntemplate <typename T> ostream &operator<<(ostream &o, const vector<T> &v) { o << '['; rep(i, v.size()) o << v[i] << (i != v.size()-1 ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T>  ostream &operator<<(ostream &o, const set<T> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it << (next(it) != m.end() ? \", \" : \"\"); o << \"]\";  return o; }\ntemplate <typename T, typename U>  ostream &operator<<(ostream &o, const unordered_map<T, U> &m) { o << '['; for (auto it = m.begin(); it != m.end(); it++) o << *it; o << \"]\";  return o; }\nvoid printbits(ll mask, ll n) { rep(i, n) { cout << !!(mask & (1ll << i)); } cout << endl; }\n#define ldout fixed << setprecision(40) \n\nstatic const double EPS = 1e-14;\nstatic const long long INF = 1e18;\nstatic const long long mo = 1e9+7;\n\nvoid FZT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(!(j & 1 << i)) f[j] += f[j | 1 << i];\n}\n\n// ????????????????????????\n// O(n 2^n)\n//\n// f???2^n??§???????????°????????????\n// f????????????????¨???????????????\\?????????????????????????????¨???f????????????????¨??????????????????????\nvoid FMT(vll& f) {\n    rep(i, round(log(f.size())/log(2))) rep(j, f.size()) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n}\n\nvll f;\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n, m; cin >> n >> m;\n    vll a(n), q(n); \n    rep(i, n) cin >> a[i];\n    rep(i, n) cin >> q[i];\n\n    f = vll(1<<n);\n\n    rep(mask, 1<<n) if (mask) {\n        ll p = 1;\n        rep(j, n) if (mask & (1ll << j)) {\n            if ((double)p * (double)a[j] > 2e18) {\n                p = ((ll)1e18) + 10;\n                break;\n            }\n            p *= a[j];\n        }\n        printbits(mask, n);\n        cout << p << endl;\n        f[mask] = m / p;\n    }\n\n    FMT(f);\n\n    double ret = 0;\n    rep(mask, 1<<n) {\n        double p = 1;\n        rep(j, n) {\n            p *= (double)(mask & (1ll << j) ? (q[j]) : 100-q[j]) / 100;\n        }\n        ret += abs(f[mask]) * p;\n    }\n    cout << ldout << ret << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define int long long\n#define rep(i,n) for(int i = 0; i < (n); i++)\n#define INF ((long long)1e18)\n#define MOD ((int)1e9+7)\n#define endl \"\\n\"\n\n#define yn(f) ((f)?\"Yes\":\"No\")\n#define YN(f) ((f)?\"YES\":\"NO\")\n\n#define MAX\n\nsigned main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout<<fixed<<setprecision(10);\n\t\n\tint n, m;\n\tdouble ans = 0;\n\tvector<int> a, p, dp;\n\tvector<double> pro;\n\t\n\tcin>>n>>m;\n\t\n\ta.resize(n);\n\tp.resize(n);\n\tpro.resize(1<<n, 1);\n\tdp.resize(1<<n);\n\t\n\tfor(int i = 0; i < n; i++){\n\t\tcin>>a[i];\n\t}\n\t\n\tfor(int i = 0; i < n; i++){\n\t\tcin>>p[i];\n\t}\n\t\n\tfor(int i = 0; i < (1<<n); i++){\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tif((i>>j)&1) pro[i] *= (p[j]/100.0); \n\t\t\telse         pro[i] *= (1.0 - (p[j]/100.0)); \n\t\t}\n\t}\n\t\n\tfor(int i = 1; i < (1<<n); i++){\n\t\t__int128 lcm = 1;\n\t\tint sum = 0, num = 0;\n\t\t\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tif((i>>j)&1){\n\t\t\t\tlcm = lcm/__gcd((int)lcm, a[j])*a[j];\n\t\t\t\tif(lcm > m){\n\t\t\t\t\tlcm = m+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnum++;\n\t\t\t}\n\t\t}\n\t\tif(num%2 == 0) dp[i] = - m/lcm;\n\t\telse dp[i] =  m/lcm;\n\t}\n\t\n\tfor(int j = 0; j < n; j++){\n\t\tfor(int i = 1; i < (1<<n); i++){\n\t\t\tif(i & (1<<j)) dp[i] += dp[i&~(1<<j)];\n\t\t}\n\t}\n\t\n\tfor(int i = 1; i < (1<<n); i++){\n\t\tans += dp[i]*pro[i];\n\t}\n\t\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nll gcd(ll a, ll b) {\n  return b?gcd(b,a%b):a;\n}\n\nll llmax = 2*1e18;\nll mul(ll a, ll b) {\n  if (a>llmax/b) return llmax;\n  return a*b;\n}\n\nll a[20];\ndouble p[20];\nll dp[1<<20];\n\nint main() {\n  int n;\n  ll m;\n  while(cin>>n>>m) {\n    REP(i,n) cin >> a[i];\n    REP(i,n) {\n      cin >> p[i];\n      p[i] /= 100;\n    }\n    REP(S,1<<n) {\n      ll lcm = 1;\n      REP(i,n) {\n        if (S>>i&1) {\n          lcm = mul(lcm/gcd(lcm,a[i]), a[i]);\n          if (lcm > m) break;\n        }\n      }\n      if (S == 0) dp[S] = 0;\n      else {\n        if (__builtin_popcount(S) & 1) dp[S] = m / lcm;\n        else dp[S] = - m / lcm;\n      }\n      // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n    }\n    REP(i,n) {\n      // cout << i << endl;\n      REP(S,1<<n) {\n        if (S>>i&1) {\n          dp[S] += dp[S^(1<<i)];\n        }\n        // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n      }\n    }\n    double ans = 0;\n    REP(S,1<<n) {\n      double P = 1;\n      REP(i,n) {\n        if (S>>i&1) P *= p[i];\n        else P *= 1-p[i];\n      }\n      ans += dp[S] * P;\n    }\n    printf(\"%.10f\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].emplace_back(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].emplace_back(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tcout << bit << \" \" << crt << endl;\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // counting\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) continue;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 1.0e18+1) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long int;\n\nint main() {\n    int N, M; cin >> N >> M;\n    \n    vector<ll> A(N), P(N), MSB(N);\n    for(int i=0; i<N; i++) {\n        cin >> A[i];\n\n        for(int k=0; k<62; k++) {\n            if(A[i] >> k & 1) {\n                MSB[i] = k;\n            }\n        }\n    }\n    for(int i=0; i<N; i++) {\n        cin >> P[i];\n    }\n\n    vector<ll> divisor(1 << N), popcnt(1 << N);\n    for(int bit=0; bit<(1<<N); bit++) {\n        popcnt[bit] = __builtin_popcount(bit);\n\n        bool overflow = false;\n        ll msb_sum = 0, mul = 1;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                msb_sum += MSB[i];\n                if(msb_sum >= 60) {\n                    overflow = true;\n                    break;\n                }\n                else {\n                    mul *= A[i];\n                }\n            }\n        }\n\n        if(!overflow) {\n            divisor[bit] = M / mul;\n        }\n    }\n\n    double ans = 0;\n    for(int bit=1; bit<(1<<N); bit++) {\n        double prob = 1.0;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                prob *= 1.0 * P[i] / 100.0;\n            }\n            else {\n                prob *= 1.0 * (100 - P[i]) / 100.0;\n            }\n        }\n\n        double sum = 0.0;\n        for(int mask=bit; mask>0; mask=(mask-1)&bit) {\n            if(popcnt[mask] % 2) sum += divisor[mask];\n            else sum -= divisor[mask];\n        }\n\n        // printf(\"bit = %d, prob = %.12f, sum = %.12f\\n\", bit, prob, sum);\n        ans += prob * sum;\n    }\n    printf(\"%.12f\\n\", ans);\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long C=a;\n\t\ta=b;\n\t\tb=C;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tlong long m=1;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tGCD=gcd(m,c[j]);\n\t\t\t\tdouble lcm=(double)m/GCD*c[j];\n\t\t\t\tif(lcm>(double)b+0.001){\n\t\t\t\t\tm=b+1;break;\n\t\t\t\t}else m=m/GCD*c[j];\n\t\t\t}\n\t\t}\n\t\tdp[i]=b/m;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%.9f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll _lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].pb(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / _lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / _lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].pb(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long c=b;\n\t\tb=a;\n\t\ta=c;\n\t}\n\treturn b;\n}\nlong long v[20];\nint p[20];\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",v+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",p+i);\n\tdouble ret=0;\n\tfor(int i=1;i<(1<<a);i++){\n\t\tdouble prob=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))prob*=0.01*p[j];//else prob*=0.01*(100-p[j]);\n\t\tlong long now=b;\n\t\tlong long G=0;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))G=gcd(G,v[j]);\n\t\tnow/=G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now/=v[j]/G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now=-now;\n\t\tret+=prob*now;\n\t}\n\tprintf(\"%.9f\\n\",-ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n          //  if(LCM > m) continue;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 1.5e18) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "     #include <bits/stdc++.h>\n\n//    #include <boost/multiprecision/cpp_int.hpp>\n #define int long long\n #define inf  1000000007\n #define pa pair<int,int>\n #define ll long long\n #define pal pair<double,double>\n #define ppap pair<pa,int>\n  #define PI 3.14159265358979323846\n  #define paa pair<int,char>\n  #define  mp make_pair\n  #define  pb push_back\n  #define EPS (1e-10)\n                                          \n    int dx[8]={0,1,0,-1,1,1,-1,-1};\n    int dy[8]={1,0,-1,0,-1,1,1,-1};\n                                            using namespace std;\n                                   \t\t\tclass pa3{\n                                            \tpublic:\n                                            \tint x,y,z;\n                                            \tpa3(int x=0,int y=0,int z=0):x(x),y(y),z(z) {}\n                                            \tbool operator < (const pa3 &p) const{\n                                            \t\tif(x!=p.x) return x<p.x;\n                                            \t\tif(y!=p.y) return y<p.y;\n                                            \t\t return z<p.z;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                   \t\t\t\tbool operator > (const pa3 &p) const{\n                                            \t\tif(x!=p.x) return x>p.x;\n                                            \t\tif(y!=p.y) return y>p.y;\n                                            \t\t return z>p.z;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa3 &p) const{\n                                            \t\treturn x==p.x && y==p.y && z==p.z;\n                                            \t}\n                                            \t\tbool operator != (const pa3 &p) const{\n                                            \t\t\treturn !( x==p.x && y==p.y && z==p.z);\n                                            \t}\n                                            \n                                            };\n                                            \n                                            class pa4{\n                                            \tpublic:\n                                            \tint x;\n                                            \tint y,z,w;\n                                            \tpa4(int x=0,int y=0,int z=0,int w=0):x(x),y(y),z(z),w(w) {}\n                                            \tbool operator < (const pa4 &p) const{\n                                            \t\tif(x!=p.x) return x<p.x;\n                                            \t\tif(y!=p.y) return y<p.y;\n                                            \t\tif(z!=p.z)return z<p.z;\n                                            \t\treturn w<p.w;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator > (const pa4 &p) const{\n                                            \t\tif(x!=p.x) return x>p.x;\n                                            \t\tif(y!=p.y) return y>p.y;\n                                            \t\tif(z!=p.z)return z>p.z;\n                                            \t\treturn w>p.w;\n                                            \t\t//return x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa4 &p) const{\n                                            \t\treturn x==p.x && y==p.y && z==p.z &&w==p.w;\n                                            \t}\n                                            \t\t\n                                            \n                                            };\n                                            class pa2{\n                                            \tpublic:\n                                            \tint x,y;\n                                            \tpa2(int x=0,int y=0):x(x),y(y) {}\n                                            \tpa2 operator + (pa2 p) {return pa2(x+p.x,y+p.y);}\n                                            \tpa2 operator - (pa2 p) {return pa2(x-p.x,y-p.y);}\n                                            \tbool operator < (const pa2 &p) const{\n                                            \t\treturn y != p.y ? y<p.y: x<p.x;\n                                            \t}\n                                            \tbool operator > (const pa2 &p) const{\n                                            \t\treturn x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const pa2 &p) const{\n                                            \t\treturn abs(x-p.x)==0 && abs(y-p.y)==0;\n                                            \t}\n                                            \tbool operator != (const pa2 &p) const{\n                                            \t\treturn !(abs(x-p.x)==0 && abs(y-p.y)==0);\n                                            \t}\n                                            \t\t\n                                            \n                                            };\n                                            \n/*\n                                            class Point{\n                                            \tpublic:\n                                            \tdouble x,y;\n                                            \tPoint(double x=0,double y=0):x(x),y(y) {}\n                                            \tPoint operator + (Point p) {return Point(x+p.x,y+p.y);}\n                                            \tPoint operator - (Point p) {return Point(x-p.x,y-p.y);}\n                                            \tPoint operator * (double a) {return Point(x*a,y*a);}\n                                            \tPoint operator / (double a) {return Point(x/a,y/a);}\n                                            \tdouble absv() {return sqrt(norm());}\n                                            \tdouble norm() {return x*x+y*y;}\n                                            \tbool operator < (const Point &p) const{\n                                            \t\treturn x != p.x ? x<p.x: y<p.y;\n                                            \t}\n                                            \tbool operator == (const Point &p) const{\n                                            \t\treturn fabs(x-p.x)<EPS && fabs(y-p.y)<EPS;\n                                            \t}\n                                            };\n                                            typedef Point Vector;\n                                     #define pl pair<int,pas>\n                                            struct Segment{\n                                            Point p1,p2;\n                                            };\n                                             double dot(Vector a,Vector b){\n                                            \treturn a.x*b.x+a.y*b.y;\n                                            }\n                                            double cross(Vector a,Vector b){\n                                            \treturn a.x*b.y-a.y*b.x;\n                                            }\n                                        \n                bool parareru(Point a,Point b,Point c,Point d){\n                //\tif(abs(cross(a-b,d-c))<EPS)cout<<\"dd \"<<cross(a-b,d-c)<<endl;\n                \treturn abs(cross(a-b,d-c))<EPS;\n                }\n                double distance_ls_p(Point a, Point b, Point c) {\n                  if ( dot(b-a, c-a) < EPS ) return (c-a).absv();\n                  if ( dot(a-b, c-b) < EPS ) return (c-b).absv();\n                  return abs(cross(b-a, c-a)) / (b-a).absv();\n                }\n                bool is_intersected_ls(Segment a,Segment b) {\n                \tif(a.p1==b.p1||a.p2==b.p1||a.p1==b.p2||a.p2==b.p2) return false;\n                \tif(parareru((a.p2),(a.p1),(a.p1),(b.p2))&&parareru((a.p2),(a.p1),(a.p1),(b.p1))){\n                //\t\tcout<<\"sss\"<<endl;\n                \t\tif(dot(a.p1-b.p1,a.p1-b.p2)<EPS) return true;\n                \t\tif(dot(a.p2-b.p1,a.p2-b.p2)<EPS) return true;\n                \t\tif(dot(a.p1-b.p1,a.p2-b.p1)<EPS) return true;\n                \t\tif(dot(a.p1-b.p2,a.p2-b.p2)<EPS) return true;\n                \t\treturn false;\n                \t}\n                  else return ( cross(a.p2-a.p1, b.p1-a.p1) * cross(a.p2-a.p1, b.p2-a.p1) < EPS ) && ( cross(b.p2-b.p1, a.p1-b.p1) * cross(b.p2-b.p1, a.p2-b.p1) < EPS );\n                }\n                 \n                double segment_dis(Segment a,Segment b){\n                \tif(is_intersected_ls(a,b))return 0;\n                \tdouble r=distance_ls_p(a.p1, a.p2, b.p1);\n                \tr=min(r,distance_ls_p(a.p1, a.p2, b.p2));\n                \tr=min(r,distance_ls_p(b.p1, b.p2, a.p2));\n                \tr=min(r,distance_ls_p(b.p1, b.p2, a.p1));\n                \treturn r;\n                }\n                Point intersection_ls(Segment a, Segment b) {\n                  Point ba = b.p2-b.p1;\n                  double d1 = abs(cross(ba, a.p1-b.p1));\n                  double d2 = abs(cross(ba, a.p2-b.p1));\n                  double t = d1 / (d1 + d2);\n                 \n                  return a.p1 + (a.p2-a.p1) * t;\n                }\n */                \n                                string itos( int i ) {\n                                ostringstream s ;\n                                s << i ;\n                                return s.str() ;\n                                }\n                                 \n                                int gcd(int v,int b){\n                                \tif(v>b) return gcd(b,v);\n                                \tif(v==b) return b;\n                                \tif(b%v==0) return v;\n                                \treturn gcd(v,b%v);\n                                }\n                 \n                                double distans(double x1,double y1,double x2,double y2){\n                                \tdouble rr=(x1-x2)*(x1-x2)+(y1-y2)*(y1-y2);\n                                \treturn sqrt(rr);\n                                \t\n                                }\n                                int mod;\nint extgcd(int a, int b, int &x, int &y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int d = extgcd(b, a%b, y, x);\n    y -= a/b * x;\n    return d;\n}\n    \n                                \n                int pr[1000010];\n                int inv[1000010];\n                \n                int beki(int wa,int rr,int warukazu){\n                \tif(rr==0) return 1%warukazu;\n                \tif(rr==1) return wa%warukazu;\n                \twa%=warukazu;\n                \tif(rr%2==1) return ((ll)beki(wa,rr-1,warukazu)*(ll)wa)%warukazu;\n                \tll zx=beki(wa,rr/2,warukazu);\n                \treturn (zx*zx)%warukazu;\n                }\n    double bekid(double w,int r){\n    \tif(r==0) return 1.0;\n    \tif(r==1) return w;\n    \tif(r%2) return bekid(w,r-1)*w;\n    \tdouble f=bekid(w,r/2);\n    \treturn f*f;\n    }\n                \n    \t\t\tint comb(int nn,int rr){\n    \t\t\t\tint r=pr[nn]*inv[rr];\n    \t\t\t\tr%=mod;\n    \t\t\t\tr*=inv[nn-rr];\n    \t\t\t\tr%=mod;\n    \t\t\t\treturn r;\n    \t\t\t}\n                \n                void gya(int ert){\n                \tpr[0]=1;\n                \tfor(int i=1;i<ert;i++){\n                \t\tpr[i]=(pr[i-1]*i)%mod;\n                \t}\n                \tfor(int i=0;i<ert;i++) inv[i]=beki(pr[i],mod-2,mod);\n                \t\n                }\n                \n              //   cin.tie(0);\n    \t\t//\tios::sync_with_stdio(false);\n    \t\t\t//priority_queue<pa3,vector<pa3>,greater<pa3>> pq;            \n                 //sort(ve.begin(),ve.end(),greater<int>());\n    \n                                     //----------------kokomade tenpure------------\n\n\ndouble p[20];\nint a[20];\nint g[1<<20]={},f[1<<20]={};\nint inff=inf*2000000000ll;\ndouble di;\nint lcm(int a,int b){\n\tif(a==inff) return inff;\n\tint g=gcd(a,b);\n\ta/=g;\n\tdouble da=a;\n\tdouble db=b;\n\tif(da*db<inff)return a*b;\n\treturn inff;\n}\n\n signed main(){\n\n    \t       cin.tie(0);\n   \t\t\tios::sync_with_stdio(false);\n\tdi=inff;\n \tint n,m;\n \tcin>>n>>m;\n \t\n \tfor(int i=0;i<n;i++)cin>>a[i];\n \tfor(int j=0;j<n;j++)cin>>p[j];\n \t\n \t\n \tfor(int i=1;i<(1<<n);i++){\n \t\tint r=-1;\n \t\tfor(int j=0;j<n;j++)if(i&(1<<j)){\n \t\t\tif(r==-1) r=a[j];\n \t\t\telse r=lcm(r,a[j]);\n \t\t}\n \t\tf[i]=m/r;\n \t//\tcout<<g[i]<<endl;\n \t}\n \tfor(int i=0;i<n;i++)for(int j=0;j<(1<<n);j++)if(j&(1<<i)){\n \t\tf[j]-=f[j^(1<<i)];\n \t}\n \tfor(int i=0;i<(1<<n);i++){\n \t\tf[i]=abs(f[i]);\n \t//\tcout<<f[i]<<endl;\n \t}\n \tdouble ans=0;\n \tfor(int i=0;i<(1<<n);i++){\n \t\tdouble pr=1;\n \t\tfor(int j=0;j<n;j++){\n \t\t\tif(i&(1<<j)){\n \t\t\t\tpr*=p[j]/100.0;\n \t\t\t}\n \t\t\telse pr*=1-p[j]/100.0;\n \t\t}\n \t\tans+=pr*f[i];\n \t}\n \tprintf(\"%.10lf\\n\",ans);\n \t\n \treturn 0;\n  }\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\nusing namespace std;\ntypedef long long ll;\n#define chmin(a,b) a=min(a,b)\n#define chmax(a,b) a=max(a,b)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define mod 1000000007\n#define mad(a,b) a=(a+b)%mod\nll gcd(ll a,ll b){\n\treturn (b?gcd(b,a%b):a);\n}\nll lcm(ll a,ll b){\n\tif(a==-1||b==-1)return -1;\n\tll g=gcd(a,b);\n\ta/=g;\n\tif(a>(ll)2e18/b)return -1;\n\treturn  a*b;\n}\nll N,M,A[20],P[20];\nll f[(1<<20)],rui[(1<<20)];\n\nvoid solve(vector<ll> v,ll k){\n\tif(k==N){\n\t\treturn;\n\t}\n\tll K=(1<<k);\n\tvector<ll> L,R;\n\tfor(auto t:v){\n\t\tif(t&K)R.push_back(t);\n\t\telse L.push_back(t);\n\t}\n\tsolve(R,k+1);\n\tfor(auto t:R){\n\t\trui[t]=f[t];\n\t}\n\treverse(R.begin(),R.end());\n\tfor(ll d=k+1;d<N;d++){\n\t\tfor(auto t:R)if(t&(1<<d)){\n\t\t\trui[t-(1<<d)]+=rui[t];\n\t\t}\n\t}\n\tfor(auto t:R){\n\t\tf[t-K]-=rui[t];\n\t}\n\tsolve(L,k+1);\n}\n\nll lcms[(1<<20)];\n\nint main(){\n\tcin>>N>>M;\n\trep(i,N)cin>>A[i];\n\trep(i,N)cin>>P[i];\n\tvector<ll> v;\n\tfor(ll i=0;i<(1<<N);i++)v.push_back(i);\n\tlcms[0]=1;\n\tfor(ll i=1;i<(1<<N);i++){\n\t\tfor(ll j=0;j<N;j++)if(i&(1<<j)){\n\t\t\tlcms[i]=lcm(lcms[i-(1<<j)],A[j]);\n\t\t\tbreak;\n\t\t}\n\t\tif(lcms[i]==-1)f[i]=0;\n\t\telse f[i]=M/lcms[i];\n\t}\n\tsolve(v,0);\n\tlong double ans=0;\n\tfor(ll i=0;i<(1<<N);i++){\n\t\tlong double res=1;\n\t\tfor(ll j=0;j<N;j++)if(i&(1<<j)){\n\t\t\tres*=0.01*(100.0-(long double)P[j]);\n\t\t}\n\t\tres=1-res;\n\t\tres*=f[i];\n\t\tans+=res;\n\t}\n\tcout<<fixed<<setprecision(9)<<ans<<endl;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].emplace_back(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].emplace_back(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n//#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<bitset>\n#include<stack>\n#include<memory>\nusing namespace std;\n//using namespace std::chrono;\ntypedef long long int llint;\ntypedef double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n\n/*\ncout<<fixed<<setprecision(20);\ncin.tie(0);\nios::sync_with_stdio(false);\n*/\nconst llint mod=1000000007;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-7;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\n\nint main(void){\n\tcout<<fixed<<setprecision(20);\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tllint n,m,i,bi,j;cin>>n>>m;\n\tstatic llint a[20]={0};\n\tstatic double p[20]={0};\n\tfor(i=0;i<n;i++){cin>>a[i];}\n\tfor(i=0;i<n;i++){cin>>p[i];p[i]/=100;}\n\tstatic double dp[1<<20];\n\tdp[0]=0;\n\tfor(bi=1;bi<(1<<n);bi++){\n\t\tllint alc=1;\n\t\tbool flow=false;\n\t\tint ki=0;\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(!(bi&(1<<i))){continue;}\n\t\t\tki++;\n\t\t\tllint gc=gcd(alc,a[i]);\n\t\t\tdouble miru=((double)(alc))*a[i]/gc;\n\t\t\tif(miru>m*1.5){flow=true;break;}\n\t\t\talc/=gc;alc*=a[i];\n\t\t}\n\t\tif(flow){continue;}\n\t\tdp[bi]=m/alc;\n\t\tif(ki%2==0){dp[bi]*=-1;}\n\t}\n\tfor(i=0;i<n;i++){\n\t\tfor(bi=0;bi<(1<<n);bi++){\n\t\t\tif(bi&(1<<i)){continue;}\n\t\t\tdp[bi+(1<<i)]+=dp[bi];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(bi=0;bi<(1<<n);bi++){\n\t\tdouble gen=dp[bi];\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(bi&(1<<i)){gen*=p[i];}\n\t\t\telse{gen*=1-p[i];}\n\t\t}\n\t\tans+=gen;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(),(c).end()\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\n#define mem(a) memset(a,0,sizeof(a))\n#define pd(a) printf(\"%.10f\\n\",a)\n#define pb(a) push_back(a)\n#define in(a) insert(a)\n#define pi M_PI\n#define R cin>>\n#define F first\n#define S second\n#define C class\n#define ll long long\n#define ln cout<<'\\n'\n#define _(_1,_2,_3,N,...)N\n#define pr(...) _(__VA_ARGS__,pr3,pr2,pr1)(__VA_ARGS__)\ntemplate<C T>void pr1(T a){cout<<a;ln;}\ntemplate<C T,C T2>void pr2(T a,T2 b){cout<<a<<' '<<b;ln;}\ntemplate<C T,C T2,C T3>void pr3(T a,T2 b,T3 c){cout<<a<<' '<<b<<' '<<c;ln;}\ntemplate<C T>void PR(T a,int n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nbool check(int n,int m,int x,int y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<60,dx[4]={-1,0,1,0},dy[4]={0,1,0,-1};\ntypedef pair<int,int> P;\n\nll n,m;\nll lcm(ll x, ll y) {\n  long double d=(long double)x/__gcd(x,y)*y;\n  if(d>m) return 0;\n  return d;\n}\nvoid Main() {\n  cin >> n >> m;\n  ll a[n];\n  double p[n];\n  rep(i,n) R a[i];\n  rep(i,n) {\n    R p[i];\n    p[i]/=100;\n  }\n  double ans=0;\n  REP(t,1,1<<n) {\n    double q=1;\n    ll x=1;\n    rep(i,n) {\n      if(t&(1<<i)) {\n        q*=p[i];\n        x=lcm(x,a[i]);\n      }\n    }\n    if(x) {\n      double d=q*(m/x);\n      if(__builtin_popcount(t)%2) ans+=d;\n      else ans-=d;\n    }\n  }\n  pd(ans);\n}\n\nint main() {\n  ios::sync_with_stdio(0);cin.tie(0);\n  Main();return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <list>\n#include <cmath>\n#include <fstream>\n#include <algorithm>\n#include <string>\n#include <queue>\n#include <set>\n#include <map>\n#include <complex>\n#include <iterator>\n#include <cstdlib>\n#include <cstring>\n#include <sstream>\n#include <stack>\n#include <climits>\n#include <deque>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> pii;\ndouble EPS=1e-10;\ndouble EQ(double a,double b){\n  return abs(a-b)<EPS;\n}\nvoid fast_stream(){\n  cin.tie(0);\n  std::ios_base::sync_with_stdio(0);\n}\ntemplate<class T>\nstring IntToString(T num){\n  string res;stringstream ss;ss<<num;\n  return ss.str();\n}\nll StringToInt(string &str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    res=(res*10+str[i]-'0');\n  return res;\n}\nint N;\nll M;\nll as[101];\ndouble ps[101];\n\nll gcd(ll a,ll b){\n  if(b==0)return a;\n  return gcd(b,a%b);\n}\nll lcm(ll a,ll b){\n  return a/gcd(a,b)*b;\n}\nlong double lcm2(ll a,ll b){\n  return 1.0*a*b/gcd(a,b);\n}\n\nint main(){\n  cin>>N>>M;\n  for(int i=0;i<N;i++)cin>>as[i];\n  for(int i=0;i<N;i++){\n    cin>>ps[i];\n    ps[i]/=100;\n  }\n  double res=0;\n  for(int i=1;i<(1<<N);i++){\n    double per=1;\n    int bitCnt=__builtin_popcount(i);\n    ll m=1;\n    for(int j=0;j<N;j++){\n      if((i>>j)&1){\n\t// Mツづーツ陳エツつヲツつスツづァfin\n\tdouble d=lcm2(m,as[j]);\n\t//cout<<i<<\" \"<<j<<\" \"<<m<<\" \"<<as[j]<<\" \"<<d<<endl;\n\tif(lcm2(m,as[j])>M){\n\t  m=M+1;\n\t  break;\n\t}\n\t//cout<<m<<\" \"<<as[j]<<endl;\n\tm=lcm(m,as[j]);\n\t//cout<<m<<endl;\n\tper*=ps[j];\n      }\n    }\n    //cout<<res<<\" \"<<m<<endl;\n    if(!(bitCnt%2))res-=per*(M/m);\n    else res+=per*(M/m);\n  }\n  printf(\"%.10f\\n\",res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(0);\n  Int n,m;\n  cin>>n>>m;\n  vector<Int> a(n),p(n);\n  for(Int i=0;i<n;i++) cin>>a[i];\n  for(Int i=0;i<n;i++) cin>>p[i];\n  vector<Int> dp(1<<n,0);\n  for(Int b=1;b<(1<<n);b++){\n    Int t=1;\n    for(Int i=0;i<n;i++){\n      if((b>>i)&1){\n\tInt k=a[i]/__gcd(t,a[i]);\n\tt=(t<=m/k?t*k:m+1);\n      }\n      if(t>m) break;\n    }\n    dp[b]=m/t;\n  }\n      \n  for(Int i=0;i<n;i++)\n    for(Int b=0;b<(1<<n);b++)\n      if((b>>i)&1) dp[b]-=dp[b^(1<<i)];\n  \n  double ans=0;\n  for(Int b=0;b<(1<<n);b++){\n    double po=1;\n    for(Int i=0;i<n;i++)\n      if((b>>i)&1) po*=p[i]/100.0;\n      else po*=1.0-(p[i]/100.0);\n    ans+=po*abs(dp[b]);\n  }\n  cout<<fixed<<setprecision(12)<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iomanip>\n#include <iostream>\nusing namespace std;\nint n, p[22]; long long m, a[22], d[1048588];\nlong long gcd(long long x, long long y) {\n\tif (y == 0) return x;\n\treturn gcd(y, x % y);\n}\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) cin >> p[i];\n\td[0] = 1;\n\tdouble v = log10(m);\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 1 << i; j < 2 << i; j++) {\n\t\t\tlong long g = gcd(d[j - (1 << i)], a[i]);\n\t\t\td[j] = d[j - (1 << i)] / g;\n\t\t\tif (log10(d[j]) + log10(a[i]) >= m + 0.01) d[j] = m + 1;\n\t\t\telse d[j] *= a[i];\n\t\t}\n\t}\n\tfor (int i = 0; i < 1 << n; i++) d[i] = m / d[i];\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\tif ((j >> i) & 1) d[j] -= d[j - (1 << i)];\n\t\t}\n\t}\n\tdouble ex = 0.0;\n\tfor (int i = 0; i < 1 << n; i++) {\n\t\tdouble prob = 1.0;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tprob *= 0.01 * ((i >> j) & 1 ? p[j] : 100 - p[j]);\n\t\t}\n\t\tex += prob * (m - abs(d[i]));\n\t}\n\tcout << fixed << setprecision(15) << ex << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep1(i,(1<<n)-1){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.10llf\\n\", ret);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nlong long int n,m;\nvector<long long int> a;\n\nvector<long long int> vals;\n\nlong long int val(int comb){\n  if(comb==0) return 0;\n  if(vals[comb]!=-1) return vals[comb];\n  long long int num=1;\n  for(int i=0;i<n;i++){\n    if(comb&(1<<i)){\n      double buf=double(num)*a[i];\n      if(buf>1e18+3){\n\treturn vals[comb]=0;\n      }\n      num*=a[i];\n    }\n  }\n  return vals[comb]=m/num;\n}\n\nint main(){\n  cin>>n>>m;\n  a.resize(n);\n  vals.resize(1<<n,-1);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  double res=0;\n  for(int i=0;i<(1<<n);i++){\n    double pos=1;\n    int cnt=0;\n    for(int j=0;j<n;j++){\n      if(i&(1<<j)){\n\tcnt++;\n\tpos*=(double(p[j])/100);\n      }\n    }\n    res+=val(i)*pos*((cnt%2)*2-1);\n  }\n  cout<<setprecision(10)<<fixed;\n  cout<<res<<endl;\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n\nusing namespace std;\n\nlong long gcd(long long a,long long b){\n  return a?gcd(b%a,a):b;\n}\n\nint main(){\n  long long n,m;\n  cin>>n>>m;\n  long long a[20],p[20];\n  for(int i=0;i<n;i++){\n    cin>>a[i];\n  }\n  for(int i=0;i<n;i++){\n    cin>>p[i];\n  }\n  double e=0;\n  for(int i=1;i<1<<n;i++){\n    double pr=1;\n    __int128 cm=1;\n    int nb=0;\n    for(int j=0;j<n;j++){\n      if(!(i>>j&1)){\n      }else{\n\tnb++;\n\tpr*=p[j]/100.;\n\tcm=cm*a[j]/gcd(cm,a[j]);\n\tif(cm>m)goto next;\n      }\n    }\n    e+=m/cm*pr*((nb%2)?1:-1);\n  next:\n    ;\n  }\n  cout.precision(9);\n  cout<<fixed<<e<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n;\n    long double m;\n    cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) break;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < m + 1) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iomanip>\n#include<limits>\n#include<thread>\n#include<utility>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\n#include<chrono>\n#include<unordered_set>\n#include<unordered_map>\n#include<fstream>\n#include<list>\n#include<functional>\n#include<bitset>\n#include<complex>\n#include<tuple>\nusing namespace std;\ntypedef unsigned long long int ull;\ntypedef long long int ll;\ntypedef pair<ll,ll> pll;\ntypedef long double D;\n#define F first\n#define S second\nconst ll E=1LL<<60;\nconst ll MOD=1000000007;\n\nll gcd(ll a,ll b){\n    while(a%b){a%=b; swap(a,b);}\n    return b;\n}\n\n\nint main(){\n    ll n,m;\n    cin>>n>>m;\n    vector<ll> A(n);\n    vector<ll> P(n);\n    for(auto &I:A){cin>>I;}\n    for(auto &I:P){cin>>I;}\n    vector<double> p(1LL<<n,1);\n    vector<double> p2(1LL<<n,1);\n    vector<ll> LCM(1LL<<n,1);\n    vector<ll> bitcount(1LL<<n,0);\n    const ll ALL=(1LL<<n)-1;\n    for(ll i=1;i<(1LL<<n);i++){\n        for(int t=0;t<n;t++){\n            if(i>>t&1){\n                p[i]=p[i^(1LL<<t)]*P[t]/100.0;\n                p2[i]=p2[i^(1LL<<t)]*(100-P[t])/100.0;\n                LCM[i]=LCM[i^(1LL<<t)];\n                bitcount[i]=bitcount[i^(1LL<<t)]+1;\n                if(LCM[i]==E){break;}\n                ll g=gcd(LCM[i],A[t]);\n                if(LCM[i]/g<m/A[t] || (LCM[i]/g==m/A[t] && LCM[i]/g*A[t]<=m)){LCM[i]=LCM[i]/g*A[t];}\n                else{LCM[i]=E;}\n                break;\n            }\n        }\n    }\n    for(ll i=1;i<(1LL<<n);i++){\n        LCM[i]=m/LCM[i];\n        if(bitcount[i]&1){LCM[i]*=-1;}\n    }\n    LCM[0]=0;\n    for(int i=0; i<n; i++){\n        for(int s=0; s<1<<n; s++){\n            if ((s>>i&1)==1){\n                LCM[s]+=LCM[s^(1<<i)];\n            }\n        }\n    }\n    \n    double ans=0;\n    for(ll i=1;i<(1LL<<n);i++){\n        LCM[i]=abs(LCM[i]);\n        ans+=LCM[i]*p[i]*p2[ALL^i];\n        //cout<<i<<\" \"<<LCM[i]<<endl;\n    }\n    cout<<fixed<<setprecision(12)<<ans<<endl;\n    \n    \n    \n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<ll> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tll n, m;\n\tcin >> n >> m;\n\tvi a(n);\n\tREP(i, n) cin >> a[i];\n\tvector<ld> p(n);\n\tREP(i, n)\n\t{\n\t\tld a; cin >> a;\n\t\tp[i] = a / 100.0;\n\t}\n\tvector<ll> cnt(1 << n);\n\tREP(i, 1 << n)\n\t{\n\t\tll t = 1;\n\t\tbool f = false;\n\t\tREP(j, n)\n\t\t{\n\t\t\tif (!((i >> j) & 1)) continue;\n\t\t\tll tmp = a[j] / gcd(t, a[j]);\n\t\t\tif (t > LLONG_MAX / tmp) f = true;\n\t\t\telse t *= tmp;\n\t\t}\n\t\tif (f) cnt[i] = 0;\n\t\telse cnt[i] = m / t;\n\t}\n\n\tREP(i, n)REP(j, 1 << n) if (j & 1 << i) cnt[j] -= cnt[j ^ 1 << i];\n\n\tld ans = 0;\n\tREP(i, 1 << n)\n\t{\n\t\tld exp = 1.0;\n\t\tREP(j, n)\n\t\t{\n\t\t\tif ((i >> j) & 1) exp *= p[j];\n\t\t\telse exp *= 1.0 - p[j];\n\t\t}\n\t\tans += exp * (m - abs(cnt[i]));\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\tif(a == c/b) return c%b;\n\treturn a > c/b;\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-8;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\nll gcd(ll a,ll b){\n\tif(!b) return a;\n\treturn gcd(b,a%b);\n}\n\nll n,m;\nvl a,b,dp[2];\n\nint main(){\n\tcin>>n>>m;\n\ta=b=vl(n);\n\tll N=1<<n;\n\tdp[0]=dp[1]=vl(N);\n\tfor(auto &i:a) cin>>i;\n\tfor(auto &i:b) cin>>i;\n\tfor(int i=1;i<N;i++){\n\t\tll t=1;\n\t\tfor(int j=0;j<n;j++) if(i&1<<j){\n\t\t\tll g=gcd(t,a[j]);\n\t\t\tif(a[j]/g<=(m+t-1)/t) t*=a[j]/g;\n\t\t\telse t=m+1;\n\t\t\tif(t>m) break;\n\t\t}\n\t\tint id=0;\n\t\tfor(int j=0;j<n;j++) if(i&1<<j) id^=1;\n\t\tdp[id][i]=m/t;\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tvl DP[2];\n\t\tDP[0]=DP[1]=vl(N);\n\t\tfor(int j=0;j<N;j++){\n\t\t\tDP[0][j]=dp[0][j]+(j&1<<i?dp[0][j-(1<<i)]:0);\n\t\t\tDP[1][j]=dp[1][j]+(j&1<<i?dp[1][j-(1<<i)]:0);\n\t\t}\n\t\tswap(dp,DP);\n\t}\n\tdouble res=0;\n\tfor(int i=1;i<N;i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(i&1<<j) p*=1.0/100*b[j];\n\t\t\telse p*=1.0/100*(100-b[j]);\n\t\t}\n\t\tres+=p*(dp[1][i]-dp[0][i]);\n\t}\n\tcout<<syosu(9)<<res<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n// #define int ll\nusing PII = pair<ll, ll>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n\ntemplate<typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate<typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\n\ntemplate<typename T> vector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value==0>::type\nfill_v(T &t, const V &v) { t=v; }\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value!=0>::type\nfill_v(T &t, const V &v ) { for(auto &e:t) fill_v(e,v); }\n\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n    out<<'('<<a.first<<','<<a.second<<')'; return out;\n}\ntemplate<typename T>\nistream& operator >> (istream& is, vector<T>& vec){\n    for(T& x: vec) {is >> x;} return is;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n    out<<'['; for(T i: a) {out<<i<<',';} out<<']'; return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0}; // DRUL\nconst int INF = 1<<30;\nconst ll LLINF = 1LL<<60;\nconst ll MOD = 1000000007;\n\nll lcm(ll a, ll b) {\n    return (ll)min(2e18l, (long double)a/__gcd(a,b)*b);\n}\n\nsigned main(void)\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n, m;\n    cin >> n >> m;\n    vector<ll> a(n), p(n);\n    REP(i, n) cin >> a[i];\n    REP(i, n) cin >> p[i];\n\n    vector<ll> f(1LL<<n);\n    FOR(mask, 1, 1LL<<n) {\n        ll prod = 1;\n        REP(i, n) if(mask&1<<i) prod = lcm(prod, a[i]);\n        f[mask] = m / prod;\n    }\n    REP(i, n) REP(mask, 1LL<<n) {\n        if(mask&1<<i) f[mask] -= f[mask^(1<<i)];\n    }\n\n    double ret = 0;\n    REP(mask, 1LL<<n) {\n        double prob = 1;\n        REP(i, n) {\n            if(mask&1<<i) prob *= p[i] / 100.0;\n            else prob *= (100 - p[i]) / 100.0;\n        }\n        ret += prob * abs(f[mask]);\n    }\n    cout << fixed << setprecision(9) << ret << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iomanip>\n#include <iostream>\nusing namespace std;\nint n, p[22]; long long m, a[22], d[1048588];\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) cin >> p[i];\n\tfor (int i = 0; i < 1 << n; i++) {\n\t\td[i] = m;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif ((i >> j) & 1) d[i] /= a[j];\n\t\t}\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\tif ((j >> i) & 1) d[j] -= d[j - (1 << i)];\n\t\t}\n\t}\n\tdouble ex = 0.0;\n\tfor (int i = 0; i < 1 << n; i++) {\n\t\tdouble prob = 1.0;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tprob *= 0.01 * ((i >> j) & 1 ? p[j] : 100 - p[j]);\n\t\t}\n\t\tex += prob * (m - abs(d[i]));\n\t}\n\tcout << fixed << setprecision(15) << ex << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\treturn a > c/b;\n}\n\nint64 gcd(int64 a, int64 b){\n\tif(b == 0) return a;\n\treturn gcd(b, a%b);\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1, luz=a[__builtin_ctz(i)];\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !over(mul, a[j]/gcd(a[j], mul), m)) mul *= a[j]/gcd(a[j], mul);\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define rep(i, n) for (int i = 0; i < int(n); i++)\n#define rrep(i, n) for (int i = int(n) - 1; i >= 0; i--)\n#define reps(i, n) for (int i = 1; i <= int(n); i++)\n#define rreps(i, n) for (int i = int(n); i >= 1; i--)\n#define repc(i, n) for (int i = 0; i <= int(n); i++)\n#define rrepc(i, n) for (int i = int(n); i >= 0; i--)\n#define repi(i, a, b) for (int i = int(a); i < int(b); i++)\n#define repic(i, a, b) for (int i = int(a); i <= int(b); i++)\n#define all(a) (a).begin(), (a).end()\n#define bit32(x) (1 << (x))\n#define bit64(x) (1ll << (x))\n#define sz(v) ((int) v.size())\n\nusing namespace std;\n\nusing i64 = long long;\nusing u64 = unsigned long long;\nusing f80 = long double;\nusing vi32 = vector<int>;\nusing vi64 = vector<i64>;\nusing vf80 = vector<f80>;\nusing vstr = vector<string>;\n\nvoid yes() { cout << \"Yes\" << endl; exit(0); }\nvoid no() { cout << \"No\" << endl; exit(0); }\ntemplate <typename T> class pqasc : public priority_queue<T, vector<T>, greater<T>> {};\ntemplate <typename T> class pqdesc : public priority_queue<T, vector<T>, less<T>> {};\ntemplate <typename T> void amax(T &x, T y) { x = max(x, y); }\ntemplate <typename T> void amin(T &x, T y) { x = min(x, y); }\ntemplate <typename T> T exp(T x, i64 n, T e = 1) { T r = e; while (n > 0) { if (n & 1) r *= x; x *= x; n >>= 1; } return r; }\ntemplate <typename T> istream& operator>>(istream &is, vector<T> &v) { for (auto &x : v) is >> x; return is; }\ntemplate <typename T> ostream& operator<<(ostream &os, vector<T> &v) { rep(i, v.size()) { if (i) os << ' '; os << v[i]; } return os; }\nvoid solve(); int main() { ios::sync_with_stdio(0); cin.tie(0); cout << fixed << setprecision(16); solve(); return 0; }\n\nconst int INF = 1001001001;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\n\nu64 gcd(u64 a, u64 b) {\n  if (min(a, b) == 0) {\n    return max(a, b);\n  }\n  if (a % b == 0) {\n    return b;\n  } else {\n    return gcd(b, a % b);\n  }\n}\n\nu64 lcm(u64 a, u64 b) {\n  if (min(a, b) == 0) {\n    return max(a, b);\n  }\n  return a / gcd(a, b) * b;\n}\n\nvoid solve() {\n  int n;\n  u64 m;\n  cin >> n >> m;\n  vector<u64> a(n);\n  vector<f80> p(n);\n  cin >> a >> p;\n  rep(i, n) p[i] /= 100;\n  vector<f80> c(1 << n);\n  auto check = [](u64 a, u64 b, u64 m) {\n    u64 g = gcd(a, b);\n    a /= g;\n    int c = 0;\n    while (a >= 10) c++, a /= 10;\n    while (b >= 10) c++, b /= 10;\n    if (c >= 19) return false;\n    return a * b <= m;\n  };\n  reps(i, (1 << n) - 1) {\n    u64 acc = 0;\n    f80 percent = 1;\n    bool ok = true;\n    rep(j, n) if (i >> j & 1) {\n      if (!check(acc, a[j], m)) {\n        ok = false;\n        break;\n      }\n      acc = lcm(acc, a[j]);\n      percent *= p[j];\n    }\n    if (ok) {\n      c[i] = (m / acc) * percent;\n    }\n  }\n  rep(i, n) rep(s, 1 << n) if (s >> i & 1) {\n    c[s] -= c[s ^ (1 << i)];\n  }\n  cout << abs(c[(1 << n) - 1]) << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ULL;\n\nULL gcd(ULL a, ULL b) {\n    if(a < b) swap(a, b);\n    while(b > 0) {\n        ULL tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    int N;\n    ULL M;\n    cin >> N >> M;\n    vector<ULL> as(N);\n    vector<int> ps(N);\n    for(int i = 0; i < N; ++i) {\n        cin >> as[i];\n    }\n    for(int i = 0; i < N; ++i) {\n        cin >> ps[i];\n    }\n\n    long double ans = 0;\n    for(int pat = 1; pat < (1<<N); ++pat) {\n        vector<ULL> nums;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) nums.push_back(as[ord]);\n        }\n        ULL all_gcd = nums[0];\n        for(int i = 1; i < nums.size(); ++i) {\n            all_gcd = gcd(all_gcd, nums[i]);\n        }\n        long long part = M;\n        if(nums.size() > 1) {\n            nums[0] /= all_gcd;\n        }\n        for(int i = 0; i < nums.size(); ++i) {\n            part /= nums[i];\n        }\n        if(nums.size() % 2 == 0) part = -part;\n        //cout << part << endl;\n\n        long double prob = 1;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) {\n                prob *= ps[ord]/100.0;\n            } else {\n                //prob *= (1 - ps[ord]/100.0);\n            }\n        }\n        ans += part * prob;\n    }\n\n    printf(\"%.8f\\n\", (double)ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// includes\n#include <bits/stdc++.h>\n\n// macros\n#define ll long long int\n#define pb emplace_back\n#define mk make_pair\n#define pq priority_queue\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define rep(i, n) FOR(i, 0, n)\n#define rrep(i, n) for(int i=((int)(n)-1);i>=0;i--)\n#define all(x) (x).begin(),(x).end()\n#define sz(x) ((int)(x).size())\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end())\n#define FI first\n#define SE second\nusing namespace std;\n\n//  types\ntypedef pair<int, int> P;\ntypedef pair<ll, int> Pl;\ntypedef pair<ll, ll> Pll;\ntypedef pair<double, double> Pd;\n \n// constants\nconst int inf = 1e9;\nconst ll linf = 1LL << 50;\nconst double EPS = 1e-10;\nconst int mod = 1e9 + 7;\n\n// solve\ntemplate <class T>bool chmax(T &a, const T &b){if(a < b){a = b; return 1;} return 0;}\ntemplate <class T>bool chmin(T &a, const T &b){if(a > b){a = b; return 1;} return 0;}\ntemplate <typename T> istream &operator>>(istream &is, vector<T> &vec){for(auto &v: vec)is >> v; return is;}\n\n/*\n * f(U) = \\sum_{U\\in T}(-1)^(|T\\U|)f(T)\n * for f(U) = \\sum_{U\\in T}f(T), use f[j | i] -= f[j];\n */\ntemplate <typename T>\nvoid fast_moebius(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j | i] -= f[j];\n      }\n    }\n  }\n}\n\n/*\n * f(U) = \\sum_{U\\in T}f(T)\n * for f(U) = \\sum_{T\\in U}f(T), use f[j | i] += f[j];\n */\ntemplate <typename T>\nvoid fast_zeta(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j] += f[j | i];\n      }\n    }\n  }\n}\n\nint main(int argc, char const* argv[])\n{\n  ios_base::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  ll m;\n  cin >> n >> m;\n  vector<ll> a(n);\n  vector<int> p(n);\n  cin >> a >> p;\n  double res = 0.;\n  vector<ll> f((1 << n), 0);\n  vector<double> pr((1 << n), 0.);\n  for(int i = 0; i < (1 << n); i++){\n    ll tmp = 1;\n    double ptmp = 1.;\n    bool ng = false;\n    for(int j = 0; j < n; j++){\n      if((i >> j) % 2 == 1){\n        tmp *= a[j];\n        if(tmp > m){\n          ng = true;\n          tmp = 1;\n        }\n        ptmp *= (double)p[j] / 100.;\n      }else ptmp *= (1. - (double)p[j] / 100.);\n    }\n    if(i == 0)tmp = 0;\n    if(ng)tmp = 0;\n    f[i] = (tmp > 0 ? m / tmp: 0);\n    pr[i] = ptmp;\n  }\n  fast_moebius(f);\n  for(int i = 0; i < (1 << n); i++)res += pr[i] * (double)(abs(f[i]));\n  cout << setprecision(12);\n  cout << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <iomanip>\n#include <set>\nusing namespace std;\n#define REP(i,n) for (int i=0;i<(n);++i)\n#define rep(i,a,b) for(int i=a;i<(b);++i)\ntemplate<class T> inline bool chmin(T &a, T b){ if(a > b) { a = b; return true;} return false;}\ntemplate<class T> inline bool chmax(T &a, T b){ if(a < b) { a = b; return true;} return false;}\nconstexpr long INF = 1LL << 62;\nconstexpr int MOD = 1e9 + 7;\n\nlong gcd(long a,long b) {return b==0 ? a : gcd(b, a%b);}\nlong lcm(long a,long b) {return min(2e18l + 100, a / gcd(a,b) * 1.0l * b);}\n\nlong n, m, a[20], table[1<<20];\ndouble p[20];\n\nint main() {\n    cin.tie(0); ios_base::sync_with_stdio(false); \n    cin >> n >> m;\n    for(int i=0; i < n; ++i) cin >> a[i];\n    for(int i=0; i < n; ++i) cin >> p[i], p[i] /= 100.0;\n\n    for(int bit = 1; bit < (1<<n); ++bit) {\n        long tmp = 1;\n        for(int i = 0; i < n; ++i) \n            if(bit & (1<<i)) tmp = lcm(tmp, a[i]);\n        table[bit] = m / tmp;\n    }\n\n    for(int i = 0; i < n; ++i) \n        for(int bit = 0; bit < (1<<n); ++bit)\n            if(bit & (1<<i)) table[bit] -= table[bit ^ (1<<i)];\n\n    double ans = 0.0;\n    for(int bit=0; bit < (1<<n); ++bit) {\n        double prob = 1.0;\n        for(int i = 0; i < n; ++i) {\n            if(bit & (1<<i)) prob *= p[i];\n            else prob *= 1-p[i];\n        }\n        ans += abs(table[bit]) * prob;\n    }\n\n    cout << fixed << setprecision(10) << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = 1;\n\t\trep(j, n) if(i & 1 << j){\n\t\t\tll u = a[j] / __gcd(t, a[j]);\n\t\t\tif(1.0 * t * u < 1.5e18) t *= u;\n\t\t\telse t = m + 1;\n\t\t}\n\t\tf[i] = m / t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tlong double ans = 0;\n\trep(i, 1 << n){\n\t\tlong double e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0l;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tcout << fixed << setprecision(20) << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\n#include <queue>\ntypedef long long ll;\n\n#include <cstdio>\ninline int getInt(){ int s; scanf(\"%d\", &s); return s; }\ninline ll getLL(){ ll s; scanf(\"%lld\", &s); return s; }\n#include <set>\nusing namespace std;\n\ntemplate<class T>\nT gcd(T a, T b){\n  if(a > b){ T tmp = b; b = a; a = tmp; }\n  if(a == 0) return b;\n  return gcd(a, b % a);\n}\n\nint main(){\n  const int n = getInt();\n  const ll  m = getLL();\n  vector<ll> a(n);  REP(i,n) a[i] = getLL();\n  vector<int> p(n); REP(i,n) p[i] = getInt();\n\n  double ans = 0.0;\n\n  REP(i,1 << n) if(i){\n    double prob = 1.0;\n    ll mul = 1;\n\n    REP(j,n) if(i & (1 << j)){\n      prob *= p[j] / 100.0;\n\n      if(mul > 0){\n        ll next = mul / gcd(mul, a[j]);\n        if(next > m / a[j]) mul = -1;\n        else mul = next * a[j];\n      }\n    }\n\n    if(mul > 0){\n      if(__builtin_popcount(i) % 2)\n        ans += prob * (m / mul);\n      else\n        ans -= prob * (m / mul);\n    }\n  }\n\n  printf(\"%.9f\\n\", ans);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  Int n,m;\n  cin>>n>>m;\n  vector<Int> a(n),p(n);\n  for(Int i=0;i<n;i++) cin>>a[i];\n  for(Int i=0;i<n;i++) cin>>p[i];\n  vector<Int> dp(1<<n,0);\n  for(Int b=0;b<(1<<n);b++){\n    Int t=1;\n    for(Int i=0;i<n;i++){\n      Int k=a[i]/__gcd(t,a[i]);\n      if((b>>i)&1) t=(t<=m/k?t*k:m+1);\n    }\n    dp[b]=m/t;\n  }\n      \n  for(Int i=0;i<n;i++)\n    for(Int b=0;b<(1<<n);b++)\n      if((b>>i)&1) dp[b]-=dp[b^(1<<i)];\n  \n  double ans=0;\n  for(Int b=0;b<(1<<n);b++){\n    double po=1;\n    for(Int i=0;i<n;i++)\n      if((b>>i)&1) po*=p[i]/100.0;\n      else po*=1.0-(p[i]/100.0);\n    ans+=po*(m-abs(dp[b]));\n  }\n  cout<<fixed<<setprecision(12)<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = 1;\n\t\trep(j, n) if(i & 1 << j) t *= a[j] / __gcd(t, a[j]);\n\t\tf[i] = m / t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tlong double ans = 0;\n\trep(i, 1 << n){\n\t\tlong double e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0l;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tcout << fixed << setprecision(20) << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long c=a;\n\t\ta=b;\n\t\tb=c;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j))GCD=gcd(GCD,c[j]);\n\t\t}\n\t\tlong long v=b/GCD;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))v/=c[j]/GCD;\n\t\tdp[i]=v;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\t//printf(\"%lld \",dp[i]);\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%.9f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <queue>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n#include <memory>\n#include <random>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing vpll = vector<pll>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=(a)-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\n#define repi(i,a,b) for(int i=a;i<b;i++);\nconst ll mod = 1000000007;\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0> {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>> {\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const {\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\nll pow(ll base, ll i, ll mod) {\n\tll a = 1;\n\twhile (i) {\n\t\tif (i & 1) {\n\t\t\ta *= base;\n\t\t\ta %= mod;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= mod;\n\t\ti /= 2;\n\t}\n\treturn a;\n}\nll gcd(ll a, ll b) {\n\twhile (b) {\n\t\tll c = a%b;\n\t\ta = b;\n\t\tb = c;\n\t}\n\treturn a;\n}\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b)*b;\n}\n#ifdef _MSC_VER\n#include <intrin.h>\n#endif\nint popcnt(unsigned long long a) {\n#ifndef _MSC_VER\n\treturn __builtin_popcountll(a);\n#else\n\treturn _mm_popcnt_u32(a >> 32) + _mm_popcnt_u32(a);\n\ta = (a & 0x5555555555555555) + (a >> 1 & 0x5555555555555555);\n\ta = (a & 0x3333333333333333) + (a >> 2 & 0x3333333333333333);\n\ta = (a & 0x0f0f0f0f0f0f0f0f) + (a >> 4 & 0x0f0f0f0f0f0f0f0f);\n\ta = (a & 0x00ff00ff00ff00ff) + (a >> 8 & 0x00ff00ff00ff00ff);\n\ta = (a & 0x0000ffff0000ffff) + (a >> 16 & 0x0000ffff0000ffff);\n\treturn (a & 0xffffffff) + (a >> 32);\n#endif\n}\nclass unionfind {\n\tvector<int> par, rank, size_;//????????§??????????????¢???????????????????????????rank???????????????size?????????\npublic:\n\tunionfind(int n) :par(n), rank(n), size_(n, 1) {\n\t\tiota(ALL(par), 0);\n\t}\n\tint find(int x) {\n\t\tif (par[x] == x)return x;\n\t\treturn par[x] = find(par[x]);\n\t}\n\tvoid unite(int x, int y) {\n\t\tx = find(x), y = find(y);\n\t\tif (x == y)return;\n\t\tif (rank[x] < rank[y])swap(x, y);\n\t\tpar[y] = x;\n\t\tsize_[x] += size_[y];\n\t\tif (rank[x] == rank[y])rank[x]++;\n\t}\n\tbool same(int x, int y) {\n\t\treturn find(x) == find(y);\n\t}\n\tint size(int x) {\n\t\treturn size_[find(x)];\n\t}\n};\ntemplate<class T, class Func = function<T(T, T)>>\nclass segtree {\n\tvector<T> obj;\n\tint offset;\n\tFunc updater;\n\tT e;\n\tint bufsize(int num) {\n\t\tint i = 1;\n\t\tfor (; num >i; i <<= 1);\n\t\toffset = i - 1;\n\t\treturn (i << 1) - 1;\n\t}\n\tT query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a || b <= l)return e;\n\t\tif (a <= l && r <= b)return obj[k];\n\t\telse return updater(query(a, b, k * 2 + 1, l, (l + r) / 2), query(a, b, k * 2 + 2, (l + r) / 2, r));\n\t}\npublic:\n\tT query(int a, int b) {//[a,b)\n\t\treturn query(a, b, 0, 0, offset + 1);\n\t}\n\tvoid updateall(int l = 0, int r = -1) {\n\t\tif (r < 0)r = offset + 1;\n\t\tl += offset, r += offset;\n\t\tif (l == 0)return;\n\t\tdo {\n\t\t\tl = l - 1 >> 1, r = r - 1 >> 1;\n\t\t\tfor (int i = l; i < r; i++)obj[i] = updater(obj[i * 2 + 1], obj[i * 2 + 2]);\n\t\t} while (l);\n\t}\n\tvoid update(int k, T &a) {\n\t\tk += offset;\n\t\tobj[k] = a;\n\t\twhile (k) {\n\t\t\tk = k - 1 >> 1;\n\t\t\tobj[k] = updater(obj[k * 2 + 1], obj[k * 2 + 2]);\n\t\t}\n\t}\n\tsegtree(int n, T e, const Func &updater = Func()) :obj(bufsize(n), e), e(e), updater(updater) {}\n\tsegtree(vector<T> &vec, T e, const Func &updater = Func()) :obj(bufsize(vec.size()), e), e(e), updater(updater) {\n\t\tcopy(vec.begin(), vec.end(), obj.begin() + offset);\n\t\tupdateall();\n\t}\n\tT& operator[](int n) {\n\t\treturn obj[n + offset];\n\t}\n};\ntemplate<class T = int>\nclass BIT {//????¬????BIT????????????????????????????????°??????????????????\n\tvector<T> bit;\npublic:\n\tBIT(int n) :bit(n + 1, 0) {}\n\tvoid add(int i, T x) {\n\t\twhile (i <= bit.size()) {\n\t\t\tbit[i] += x;\n\t\t\ti += i&-i;\n\t\t}\n\t}\n\tT sum(int i) {\n\t\tT s = 0;\n\t\twhile (i) {\n\t\t\ts += bit[i];\n\t\t\ti &= i - 1;\n\t\t}\n\t\treturn s;\n\t}\n};\ntemplate<class T>\nclass rangeadd {\n\tBIT<T> b0, b1;\n\trangeadd(int n) :b0(n), b1(n) {}\n\tvoid add(int l, int r, T x) {//[l,r)\n\t\tb0.add(l, -x(l - 1));\n\t\tb1.add(l, x);\n\t\tb0.add(r, x*r);\n\t\tb1.add(r, -x);\n\t}\n\tT sum(int i) {\n\t\treturn b0.sum(i) + b1.sum(i)*i;\n\t}\n};\n//end of lib\n//template<class S=void,int ptr_num, class T = char>class trie {\n//\tumap<T, trie<S, ptr_num, T> next;\n//public:\n//\tS key;\n//\ttrie<S, ptr_num, T>* ptr[ptr_num] = {};\n//\ttrie(S &&data) :key(data) {}\n//\ttrie(const S &data) :key(data) {}\n//\tvoid add(T x,S data) {\n//\t\tif (!next.find(x))next.insert(x, data);\n//\t}\n//\ttrie& operator[](T x) {\n//\t\treturn next[x];\n//\t}\n//\tbool find(T x) {\n//\t\tretun next.find(x);\n//\t}\n//};\n//template<class T=char>class AhoCorasick {\n//\ttrie<pair<bool,int>, 2, T> tree;\n//\tAhoCorasick(vector<string> p) {\n//\t\tint num = 0;\n//\t\tvector<decltype(&tree)> que(p.size(),&tree);\n//\t\tfor (int i = 0;; i++) {\n//\t\t\tbool end = 1;\n//\t\t\tint i = 0;\n//\t\t\tfor (auto a : p) {\n//\t\t\t\tif (i >= a.size())break;\n//\t\t\t\tend = ;0\n//\t\t\t\tque[i] = (*que[i])[a[i]];\n//\t\t\t\ti++;\n//\t\t\t}\n//\t\t\tif (end)break;\n//\t\t}\n//\t}\n//};\nint main() {\n\tll n, m;\n\tcin >> n >> m;\n\tvll a(n);\n\tvector<double> p(n);\n\trep(i, n)cin >> a[i];\n\trep(i, n)cin >> p[i];\n\trep(i, n)p[i] /= 100;\n\tvll dp(1 << n);\n\trep(i, 1 << n) {\n\t\tll l = 1;\n\t\trep(j, n)if (i & 1 << j) {\n\t\t\tif (1.0*a[j] * l / gcd(l, a[j]) <= m * 2)l = lcm(l, a[j]);\n\t\t\telse l = m * 2;\n\t\t}\n\t\tdp[i] = m / l*(popcnt(i) % 2 ? 1 : -1);\n\t}\n\tdp[0] = 0;\n\trep(i, n)rep(j, 1 << n)if (j & 1 << i)dp[j] += dp[j ^ 1 << i];\n\tdouble ans = 0;\n\trep(i, 1 << n) {\n\t\tdouble q = 1;\n\t\trep(j, n)q *= (i & 1 << j ? p[j] : 1 - p[j]);\n\t\tans += q*abs(dp[i]);\n\t}\n\tcout << fixed << setprecision(10) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef long double ld;\n\nint n; ull m;\null a[20];\nld p[20];\n\null gcd(ull a, ull b) {\n    if (a > b) swap(a, b);\n    if (a == 0) return b;\n    return gcd(b % a, a);\n}\n\null lcm(ull a, ull b) {\n    return a * b / gcd(a, b);\n}\n\nint main() {\n    cin >> n >> m;\n    for (int i = 0; i < n; i++) cin >> a[i];\n    for (int i = 0; i < n; i++) {\n        int _p; cin >> _p;\n        p[i] = _p / 100.0;\n    }\n\n    ld expv = 0; // 期待値, expected value\n    for (int s = 0; s < (1<<n); s++) {\n        int bitcount = 0;\n        ull div_factor = 1;\n        ld pos = 1.0;\n        for (int i = 0; i < n; i++) {\n            if (s & (1<<i)) {\n                bitcount++;\n                div_factor = lcm(div_factor, a[i]);\n                pos *= p[i];\n            }\n        }\n\n        if (bitcount == 0) continue;\n        if (bitcount % 2 == 1) {\n            expv += pos * (m / div_factor);\n        } else {\n            expv -= pos * (m / div_factor);\n        }\n//        cout << pos << ' ' << div_factor << ' ';\n//        cout << expv << endl;\n    }\n\n    cout << setprecision(100) << expv << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <queue>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n#include <memory>\n#include <random>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing vpll = vector<pll>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=(a)-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\n#define repi(i,a,b) for(int i=a;i<b;i++);\nconst ll mod = 1000000007;\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0> {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>> {\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const {\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\nll pow(ll base, ll i, ll mod) {\n\tll a = 1;\n\twhile (i) {\n\t\tif (i & 1) {\n\t\t\ta *= base;\n\t\t\ta %= mod;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= mod;\n\t\ti /= 2;\n\t}\n\treturn a;\n}\nll gcd(ll a, ll b) {\n\twhile (b) {\n\t\tll c = a%b;\n\t\ta = b;\n\t\tb = c;\n\t}\n\treturn a;\n}\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b)*b;\n}\n#ifdef _MSC_VER\n#include <intrin.h>\n#endif\nint popcnt(unsigned long long a) {\n#ifndef _MSC_VER\n\treturn __builtin_popcountll(a);\n#else\n\treturn _mm_popcnt_u32(a >> 32) + _mm_popcnt_u32(a);\n\ta = (a & 0x5555555555555555) + (a >> 1 & 0x5555555555555555);\n\ta = (a & 0x3333333333333333) + (a >> 2 & 0x3333333333333333);\n\ta = (a & 0x0f0f0f0f0f0f0f0f) + (a >> 4 & 0x0f0f0f0f0f0f0f0f);\n\ta = (a & 0x00ff00ff00ff00ff) + (a >> 8 & 0x00ff00ff00ff00ff);\n\ta = (a & 0x0000ffff0000ffff) + (a >> 16 & 0x0000ffff0000ffff);\n\treturn (a & 0xffffffff) + (a >> 32);\n#endif\n}\nclass unionfind {\n\tvector<int> par, rank, size_;//????????§??????????????¢???????????????????????????rank???????????????size?????????\npublic:\n\tunionfind(int n) :par(n), rank(n), size_(n, 1) {\n\t\tiota(ALL(par), 0);\n\t}\n\tint find(int x) {\n\t\tif (par[x] == x)return x;\n\t\treturn par[x] = find(par[x]);\n\t}\n\tvoid unite(int x, int y) {\n\t\tx = find(x), y = find(y);\n\t\tif (x == y)return;\n\t\tif (rank[x] < rank[y])swap(x, y);\n\t\tpar[y] = x;\n\t\tsize_[x] += size_[y];\n\t\tif (rank[x] == rank[y])rank[x]++;\n\t}\n\tbool same(int x, int y) {\n\t\treturn find(x) == find(y);\n\t}\n\tint size(int x) {\n\t\treturn size_[find(x)];\n\t}\n};\ntemplate<class T, class Func = function<T(T, T)>>\nclass segtree {\n\tvector<T> obj;\n\tint offset;\n\tFunc updater;\n\tT e;\n\tint bufsize(int num) {\n\t\tint i = 1;\n\t\tfor (; num >i; i <<= 1);\n\t\toffset = i - 1;\n\t\treturn (i << 1) - 1;\n\t}\n\tT query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a || b <= l)return e;\n\t\tif (a <= l && r <= b)return obj[k];\n\t\telse return updater(query(a, b, k * 2 + 1, l, (l + r) / 2), query(a, b, k * 2 + 2, (l + r) / 2, r));\n\t}\npublic:\n\tT query(int a, int b) {//[a,b)\n\t\treturn query(a, b, 0, 0, offset + 1);\n\t}\n\tvoid updateall(int l = 0, int r = -1) {\n\t\tif (r < 0)r = offset + 1;\n\t\tl += offset, r += offset;\n\t\tif (l == 0)return;\n\t\tdo {\n\t\t\tl = l - 1 >> 1, r = r - 1 >> 1;\n\t\t\tfor (int i = l; i < r; i++)obj[i] = updater(obj[i * 2 + 1], obj[i * 2 + 2]);\n\t\t} while (l);\n\t}\n\tvoid update(int k, T &a) {\n\t\tk += offset;\n\t\tobj[k] = a;\n\t\twhile (k) {\n\t\t\tk = k - 1 >> 1;\n\t\t\tobj[k] = updater(obj[k * 2 + 1], obj[k * 2 + 2]);\n\t\t}\n\t}\n\tsegtree(int n, T e, const Func &updater = Func()) :obj(bufsize(n), e), e(e), updater(updater) {}\n\tsegtree(vector<T> &vec, T e, const Func &updater = Func()) :obj(bufsize(vec.size()), e), e(e), updater(updater) {\n\t\tcopy(vec.begin(), vec.end(), obj.begin() + offset);\n\t\tupdateall();\n\t}\n\tT& operator[](int n) {\n\t\treturn obj[n + offset];\n\t}\n};\ntemplate<class T = int>\nclass BIT {//????¬????BIT????????????????????????????????°??????????????????\n\tvector<T> bit;\npublic:\n\tBIT(int n) :bit(n + 1, 0) {}\n\tvoid add(int i, T x) {\n\t\twhile (i <= bit.size()) {\n\t\t\tbit[i] += x;\n\t\t\ti += i&-i;\n\t\t}\n\t}\n\tT sum(int i) {\n\t\tT s = 0;\n\t\twhile (i) {\n\t\t\ts += bit[i];\n\t\t\ti &= i - 1;\n\t\t}\n\t\treturn s;\n\t}\n};\ntemplate<class T>\nclass rangeadd {\n\tBIT<T> b0, b1;\n\trangeadd(int n) :b0(n), b1(n) {}\n\tvoid add(int l, int r, T x) {//[l,r)\n\t\tb0.add(l, -x(l - 1));\n\t\tb1.add(l, x);\n\t\tb0.add(r, x*r);\n\t\tb1.add(r, -x);\n\t}\n\tT sum(int i) {\n\t\treturn b0.sum(i) + b1.sum(i)*i;\n\t}\n};\n//end of lib\n//template<class S=void,int ptr_num, class T = char>class trie {\n//\tumap<T, trie<S, ptr_num, T> next;\n//public:\n//\tS key;\n//\ttrie<S, ptr_num, T>* ptr[ptr_num] = {};\n//\ttrie(S &&data) :key(data) {}\n//\ttrie(const S &data) :key(data) {}\n//\tvoid add(T x,S data) {\n//\t\tif (!next.find(x))next.insert(x, data);\n//\t}\n//\ttrie& operator[](T x) {\n//\t\treturn next[x];\n//\t}\n//\tbool find(T x) {\n//\t\tretun next.find(x);\n//\t}\n//};\n//template<class T=char>class AhoCorasick {\n//\ttrie<pair<bool,int>, 2, T> tree;\n//\tAhoCorasick(vector<string> p) {\n//\t\tint num = 0;\n//\t\tvector<decltype(&tree)> que(p.size(),&tree);\n//\t\tfor (int i = 0;; i++) {\n//\t\t\tbool end = 1;\n//\t\t\tint i = 0;\n//\t\t\tfor (auto a : p) {\n//\t\t\t\tif (i >= a.size())break;\n//\t\t\t\tend = ;0\n//\t\t\t\tque[i] = (*que[i])[a[i]];\n//\t\t\t\ti++;\n//\t\t\t}\n//\t\t\tif (end)break;\n//\t\t}\n//\t}\n//};\nint main() {\n\tll n, m;\n\tcin >> n >> m;\n\tvll a(n);\n\tvector<double> p(n);\n\trep(i, n)cin >> a[i];\n\trep(i, n)cin >> p[i];\n\trep(i, n)p[i] /= 100;\n\tvll dp(1 << n);\n\trep(i, 1 << n) {\n\t\tll l = 1;\n\t\trep(j, n)if (i & 1 << j)l = lcm(l, a[j]);\n\t\tdp[i] = m / l;\n\t}\n\tdp[0] = 0;\n\trep(i, n)rep(j, 1 << n)if (j & 1 << i)dp[j] -= dp[j ^ 1 << i];\n\tdouble ans = 0;\n\trep(i, 1 << n) {\n\t\tdouble q = 1;\n\t\trep(j, n)q *= (i & 1 << j ? p[j] : 1 - p[j]);\n\t\tans += q*abs(dp[i]);\n\t}\n\tcout << fixed << setprecision(10) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep(i,(1<<n)){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.12lf\\n\",ret+m);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <unordered_map>\n#include <queue>\n#include <set>\n#include <algorithm>\n#include <string>\n#include <math.h>\n#include <limits.h>\n#include <stack>\n#include <complex>\n#include <stdlib.h>\n#include <stdio.h>\n#include <functional>\n#include <cfloat>\n#include <math.h>\n#include <numeric>\n#include <string.h>\n#include <iomanip>\n#include <sys/time.h>\n#include <random>\n\n\n#define fs first\n#define sc second\n#define endl \"\\n\"\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef pair<ll, ll> P;\n\n// a と b の最大公約数を返す\nll gcd(ll a, ll b) {\n    if (b == 0) return a;\n    else return gcd(b, a % b);\n}\n\n\n// 素数判定\nbool is_prime(ll N) {\n    if (N == 1) return false;\n    for (ll i = 2; i * i <= N; ++i) {\n        if (N % i == 0) return false;\n    }\n    return true;\n}\n\n\n// 約数列挙\nvector<ll> enum_divisors(ll N) {\n    vector<ll> res;\n    for (ll i = 1; i * i <= N; ++i) {\n        if (N % i == 0) {\n            res.push_back(i);\n            if (N/i != i) res.push_back(N/i);\n        }\n    }\n    sort(res.begin(), res.end());\n    return res;\n}\n\n\n// 素因数分解\nvector<pair<ll, ll>> prime_factorize(ll N){\n    vector<pair<ll, ll>> res;\n    for(ll i = 2; i * i <= N; i++){\n        if(N % i != 0)  continue;\n        ll ex = 0;\n\n        while(N % i == 0){\n            ex++;\n            N /= i;\n        }\n\n        res.push_back({i, ex});\n    }\n\n    if(N != 1)  res.push_back({N, 1});\n    return res;\n};\n\n\nll lcm(ll a, ll b){\n    ll x = a / gcd(a, b);\n    if(LONG_LONG_MAX / x < b){\n        return LONG_LONG_MAX;\n    }\n    else{\n        return x * b;\n    }\n}\n\n\nint main(){\n    ll n, m;    cin >> n >> m;\n    vector<ll> a(n); vector<double> p(n);\n    for(int i = 0; i < n; i++){\n        cin >> a[i];\n    }\n    for(int i = 0; i < n; i++){\n        cin >> p[i];\n        p[i] /= 100;\n    }\n\n    double res = 0;\n    for(int i = 0; i < (1 << n); i++){\n        int count = 0;\n        double prob = 1.0;\n        ll x = 1;\n        for(int j = 0; j < n; j++){\n            if((i >> j) % 2 == 0)   continue;\n            count++;\n            prob *= p[j];\n            x = lcm(x, a[j]);\n        }\n        if(count == 0)  continue;\n        else if(count % 2 == 1){\n            res += prob * (m / x);\n        }\n        else{\n            res -= prob * (m / x);\n        }\n    }\n\n    printf(\"%.12f\\n\", res);\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\treturn a > c/b;\n}\n\nint64 gcd(int64 a, int64 b){\n\tif(b == 0) return a;\n\treturn gcd(b, a%b);\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1, luz=a[__builtin_ctz(i)];\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1){\n\t\t\t\tluz = gcd(luz, a[j]);\n\t\t\t}\n\t\t}\n\t\tbool divided = 0;\n\t\tif(__builtin_popcount(i) == 1) divided = 1;\n\t\telse a[__builtin_ctz(i)] /= luz;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(!divided) a[__builtin_ctz(i)] *= luz;\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  if(y == 0) return x;\n  return gcd(y,x%y);\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  for(long long int i = 0; i < (1LL << n); ++i){\n    double p = 1.0;\n    for(int j = 0; j < n; ++j){\n      if((i>>j) & 1) p *= P[j]/100.0;\n      else p *= (100 - P[j])/100.0;\n    }\n    long long int s = 0;\n    for(long long int j = i; j > 0; j = (j - 1)&i){\n      long long int t = 1;\n      int c = 0;\n      for(int k = 0; k < n; ++k){\n        if((j>>k) & 1){\n          t = t/gcd(A[k],t)*A[k];\n          ++c;\n        }\n      }\n      if(c){\n        if(c%2){\n          s += m/t;\n        }else{\n          s -= m/t;\n        }\n      }\n    }\n    //cout << i << \" \" << p << \" \" << s << endl;\n    ans += p*s;\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <bitset>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#include <complex>\n#include <string.h>\n#include <numeric>\nusing namespace std;\n\n#define int long long\n#define reps(i,s,n) for(int (i)=(s);(i)<(n);++(i))\n#define rep(i,n) reps(i,0,n)\n#define rept(i,n) rep(i,(n)+1)\n#define repst(i,s,n) reps(i,s,(n)+1)\n#define reprt(i,n,t) for(int (i)=(n);(i)>=(t);--(i))\n#define repr(i,n) reprt(i,n,0)\n#define each(i,v) for(auto &(i):(v))\n#define eachr(i,v) for(auto &(i)=(v).rbegin();(i)!=(v).rend();(i)++)\n#define all(c) (c).begin(),(c).end()\n#define rall(c) (c).rbegin(),(c).rend()\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define tmax(x,y,z) max(x,max(y,z))\n#define tmin(x,y,z) min(x,min(y,z))\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\n#define ln '\\n'\n#define bln(i,n) (((i)==(n)-1)?'\\n':' ')\n#define dbg(x) cout<<#x\" = \"<<(x)<<ln<<flush\n#define dbga(x,n) {cout<<#x\" : \";for(int (i)=0;i<(n);++i){cout<<((x)[i])<<(i==((n)-1)?'\\n':' ')<<flush;}}\n#define zero(a) memset(a,0,sizeof(a))\n#define unq(a) sort(all(a)),a.erase(unique(all(a)),a.end())\n\n//typedef complex<double> P;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<string> vst;\ntypedef vector<pii> vpii;\ntypedef vector<pll> vpll;\ntypedef vector<vector<int> > mat;\n\nconst ll inf = (ll)1e9+10;\nconst ll linf = (ll)1e18+10;\nconst ll mod = (ll)(1e9+7);\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\nconst double eps = 1e-10;\n\nll mop(ll a,ll b,ll m=mod) {ll r=1;a%=m;for(;b;b>>=1){if(b&1)r=r*a%m;a=a*a%m;}return r;}\nbool ool(int x,int y,int h,int w) {return((x<0)||(h<=x)||(y<0)||(w<=y));}\nbool deq(double a,double b) {return abs(a-b)<eps;}\n\nstruct oreno_initializer {\n\toreno_initializer() {\n\t\tcin.tie(0);\n\t\tios::sync_with_stdio(0);\n\t}\n} oreno_initializer;\n\n\n\nll gcd(ll a,ll b) {return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b) {\n\tll g = gcd(a,b);\n\tll res = a/g*b;\n\tif (res/b != a/g) return 1ll<<60;\n\treturn res;\n}\n\nint n, m, a[22], x[22];\ndouble res;\n\nsigned main() {\n\tcin >> n >> m;\n\trep(i,n) cin >> a[i];\n\trep(i,n) cin >> x[i];\n\treps(b,1,1<<n) {\n\t\tdouble p = 1;\n\t\tint lc = 1;\n\t\trep(i,n) if (b>>i&1) {\n\t\t\tp *= 1.*x[i]/100;\n\t\t\tlc = lcm(lc,a[i]);\n\t\t}\n\t\tp *= m/lc;\n\t\tif (__builtin_parity(b)) res += p;\n\t\telse res -= p;\n\t}\n\tprintf(\"%.14lf\\n\",res);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cassert>\n#include <algorithm>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\n#define repi(i,a,b) for(ll i=(a);i<(b);++i)\n#define rep(i,a) repi(i,0,a)\n#define repdi(i,a,b) for(ll i=(a)-1;i>=(b);--i)\n#define repd(i,a) repdi(i,a,0)\n#define itr(it,a) for( auto it = (a).begin(); it != (a).end(); ++it )\n#define all(a) (a).begin(), (a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n\nusing ll = long long;\nusing P = std::pair<ll, ll>;\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\ntemplate<class S, class T>\nstd::ostream& operator<< ( std::ostream& out, const std::pair<S,T>& a )\n{ std::cout << '(' << a.first << \", \" << a.second << ')'; return out; }\n\ntemplate<class T>\nstd::ostream &operator<< ( std::ostream& out, const std::vector<T>& a )\n{ std::cout << '['; rep( i, a.size() ){ std::cout << a[i]; if( i != a.size()-1 ) std::cout << \", \"; } std::cout << ']'; return out; }\n\nll n, m;\nll a[30];\ndouble p[30];\nll dp[1<<21];\n\nll INF = 1e18+10;\n\nll gcd( ll a, ll b )\n{ return b ? gcd(b,a%b) : a; }\n\nll lcm( ll a, ll b )\n{\n  ll d = a/gcd(a,b);\n\n  if( d > (INF+b-1)/b )\n    return -1;\n  else\n    return d*b;\n}\n\nint main()\n{\n  std::cin >> n >> m;\n\n  rep( i, n )\n    std::cin >> a[i];\n\n  rep( i, n )\n    std::cin >> p[i], p[i] /= 100.0;\n\n  rep( i, 1<<n ) if( i )\n  {\n    ll mul = 1;\n\n    rep( j, n ) if( i>>j&1 )\n    {\n      mul = lcm( mul, a[j] );\n\n      if( mul == -1 )\n      {\n        dp[i] = 0;\n\n        goto end;\n      }\n    }\n\n    dp[i] = m/mul;\n\nend:;\n  }\n\n  rep( i, n ) rep( bit, 1<<n ) if( bit>>i&1 )\n    dp[bit] -= dp[bit^(1<<i)];\n  \n  double ans = 0.0;\n\n  rep( i, 1<<n )\n  {\n    double prob = 1.0;\n\n    rep( j, n )\n      prob *= (i>>j&1 ? p[j] : 1.0-p[j]);\n\n    ans += prob*llabs(dp[i]);\n  }\n\n  printf( \"%.12f\\n\", ans );\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nint M;\n\nint lcm(int a,int b)\n{\n   int res=a/__gcd(a,b);\n   //res*b<=M\n   if(res<M/b or (res==M/b and res*b<=M)){\n      res*=b;\n   }else{\n      res=M+1;\n   }\n   return res;\n}\n\nsigned main()\n{\n   int N; cin>>N>>M;\n   vector<int> a(N),p(N);\n   for(int i=0;i<N;i++) cin>>a[i];\n   for(int i=0;i<N;i++) cin>>p[i];\n\n   double ans=0.0;\n   for(int S=1;S<(1<<N);S++){\n      int l=1,c=0;\n      double q=1.0;\n      for(int i=0;i<N;i++){\n         if(~S>>i&1) continue;\n         l=lcm(l,a[i]);\n         c++;\n         q*=1.0*p[i]/100;\n      }\n      int k=M/l;\n      if(c&1) ans+=1.0*k*q;\n      else    ans-=1.0*k*q;\n   }\n   cout<<fixed<<setprecision(10)<<ans<<endl;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long C=a;\n\t\ta=b;\n\t\tb=C;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tlong long m=1;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tGCD=gcd(m,c[j]);\n\t\t\t\tdouble lcm=m*c[j]/GCD;\n\t\t\t\tif(lcm>(double)b+0.001){\n\t\t\t\t\tm=b+1;\n\t\t\t\t}else m=m*c[j]/GCD;\n\t\t\t}\n\t\t}\n\t\tdp[i]=b/m;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M;\nint A[22],P[22];\n\nint f[1<<20];\n\nsigned main(){\n    cin>>N>>M;\n    rep(i,N)cin>>A[i];\n    rep(i,N)cin>>P[i];\n\n    rep(i,1<<N){\n        int l=1;\n        rep(j,N){\n            if(!(i>>j&1))continue;\n            int g=__gcd(l,A[j]);\n            int u=A[j]/g;\n            if(1.0*u*l<=M)l*=u;\n            else l=M+1;\n        }\n        f[i]=M/l;\n    }\n\n\n    rep(i, N) rep(j, 1 << N) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\n\n    double ans=0.0;\n    rep(i,1<<N){\n        int tmp=abs(f[i]);\n        double p=1.0;\n        rep(j,N){\n            if(i>>j&1)p*=P[j]/100.0;\n            else p*=(100-P[j])/100.0;\n        }\n        ans+=p*(M-tmp);\n    }\n    printf(\"%.20f\\n\",ans);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tdp[bit].resize(21);\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit][sum] = (crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit][sum] = (crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit][sum];\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].resize(sum);\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong double dp[1 << 20][2], prev_[1 << 20][2];\nlong long n, m, a[22]; long double p[22];\n\nlong long gcd(long long a1, long long b1) {\n\tif (b1 == 0) return a1;\n\treturn gcd(b1, a1%b1);\n}\n\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) { cin >> p[i]; p[i] *= 0.01; }\n\tprev_[0][0] = 1;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t// パターン 1 : 何も取らない\n\t\t\tdp[j][0] += prev_[j][0] * (1.0L - p[i]);\n\t\t\tdp[j][1] += prev_[j][1] * (1.0L - p[i]);\n\n\t\t\t// パターン 2 : 取るが包除はしない\n\t\t\tdp[j][0] += prev_[j][0] * p[i];\n\t\t\tdp[j][1] += prev_[j][1] * p[i];\n\n\t\t\t// パターン 3 : 取って包除もする\n\t\t\tdp[j + (1 << i)][1] += prev_[j][0] * p[i];\n\t\t\tdp[j + (1 << i)][0] += prev_[j][1] * p[i];\n\t\t}\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tprev_[j][0] = dp[j][0]; dp[j][0] = 0;\n\t\t\tprev_[j][1] = dp[j][1]; dp[j][1] = 0;\n\t\t}\n\t}\n\tlong double ans = 0;\n\tfor (int i = 0; i < (1 << n); i++) {\n\t\tlong long F = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif ((i / (1 << j)) % 2 == 0) continue;\n\t\t\tlong long G = gcd(F, a[j]);\n\t\t\tif (m / F < G) { F = (1LL << 60); break; }\n\t\t\tF = F / G * a[j];\n\t\t}\n\t\tlong long A = m / F;\n\t\tans -= 1.0L*A*prev_[i][0];\n\t\tans += 1.0L*A*prev_[i][1];\n\t}\n\tprintf(\"%.12Lf\\n\", 1.0L * m + ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstdio>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ULL;\n\nULL gcd(ULL a, ULL b) {\n    if(a < b) swap(a, b);\n    while(b > 0) {\n        ULL tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    int N;\n    ULL M;\n    cin >> N >> M;\n    vector<ULL> as(N);\n    vector<int> ps(N);\n    for(int i = 0; i < N; ++i) {\n        cin >> as[i];\n    }\n    for(int i = 0; i < N; ++i) {\n        cin >> ps[i];\n    }\n\n    long double ans = 0;\n    for(int pat = 1; pat < (1<<N); ++pat) {\n        vector<ULL> nums;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) nums.push_back(as[ord]);\n        }\n        ULL all_gcd = nums[0];\n        for(int i = 1; i < nums.size(); ++i) {\n            all_gcd = gcd(all_gcd, nums[i]);\n        }\n        long long part = M;\n        if(nums.size() > 1) {\n            nums[0] /= all_gcd;\n        }\n        for(int i = 0; i < nums.size(); ++i) {\n            part /= nums[i];\n        }\n        if(nums.size() % 2 == 0) part = -part;\n        //cout << part << endl;\n\n        long double prob = 1;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) {\n                prob *= ps[ord];\n            } else {\n                //prob *= (1 - ps[ord]/100.0);\n            }\n        }\n        prob /= pow(100.0, nums.size());\n        ans += part * prob;\n    }\n\n    printf(\"%.8f\\n\", (double)ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; int P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) cin >> P[i];\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 0, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)){\n            if (lc == INF) break;\n            lc = lcm(lc, A[i]);\n            if (lc < A[i]) lc = INF;\n        }\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= (ld)P[i] / 100.0;\n            else p *= (ld)(100 - P[i]) / 100.0;\n        }\n\n        ans += (ld)(M - abs(f[mask])) * p;\n    }\n    printf(\"%.10f\\n\", (double)ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <climits>\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef long double ld;\n\nint n; ull m;\null a[20];\nld p[20];\n\ninline ull gcd(ull a, ull b) {\n    if (a > b) swap(a, b);\n    if (a == 0) return b;\n    return gcd(b % a, a);\n}\n\null lcm(ull a, ull b) {\n    a /= gcd(a, b);\n    if ((double)a * b > 1e18) return 0; // オーバーフロー\n    return a * b;\n}\n\nint main() {\n    cin >> n >> m;\n    for (int i = 0; i < n; i++) cin >> a[i];\n    for (int i = 0; i < n; i++) {\n        int _p; cin >> _p;\n        p[i] = _p / 100.0;\n    }\n\n    ld expv = 0; // 期待値, expected value\n    for (int s = 1; s < (1<<n); s++) {\n        int bitcount = 0;\n        ull div_factor = 1;\n        ld pos = 1.0;\n        for (int i = 0; i < n; i++) {\n            if (s & (1<<i)) {\n//                cout << a[i] << ' ';\n                bitcount++;\n\n                ull _lcm = lcm(div_factor, a[i]);\n                // オーバーフローしたとき\n                // そもそも10**18より大きい数で割り切れる数はm以下には存在しないため無視する\n                if (_lcm == 0) goto loop_end;\n                div_factor = _lcm;\n                pos *= p[i];\n            }\n        }\n//        cout << endl;\n\n        if (bitcount % 2 == 1) {\n            expv += pos * (m / div_factor);\n        } else {\n            expv -= pos * (m / div_factor);\n        }\n//        cout << pos << ' ' << div_factor << ' ';\n//        cout << expv << endl;\nloop_end:\n        continue;\n    }\n\n    printf(\"%.10llf\\n\", expv);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\nusing int64 = long long;\n\ntemplate< typename T >\nvector< T > fast_mobius_transform(vector< T > f) {\n  for(int i = 0; (1 << i) < f.size(); i++) {\n    for(int j = 0; j < f.size(); j++) {\n      if(j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n    }\n  }\n  return f;\n}\n\nint main() {\n  int64 N, M;\n  int64 A[20], P[20];\n  cin >> N >> M;\n  for(int i = 0; i < N; i++) cin >> A[i];\n  for(int i = 0; i < N; i++) cin >> P[i];\n\n\n  vector< int64 > f(1 << N);\n  f[0] = 1;\n  for(int i = 1; i < (1 << N); i++) {\n    int bit;\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) bit = j;\n    }\n    auto g = __gcd(f[i ^ (1 << bit)], A[bit]);\n    f[i] = min((__int128) M + 1, (__int128) f[i ^ (1 << bit)] / g * A[bit]);\n  }\n  for(int i = 0; i < (1 << N); i++) {\n    f[i] = M / f[i];\n  }\n  f[0] = 0;\n  auto beet = fast_mobius_transform(f);\n  double ret = 0.0;\n  for(int i = 0; i < 1 << N; i++) {\n    double uku = 1.0;\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) uku *= P[j] / 100.0;\n      else uku *= (100.0 - P[j]) / 100.0;\n    }\n    ret += llabs(beet[i]) * uku;\n  }\n  cout << fixed << setprecision(10) << ret << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,b) FOR(i,0,(b))\n\ntypedef unsigned long long ull;\n\t\ndouble dp[1<<20],b[1<<20];\nint c[1<<20];\n\ninline ull gcd(ull a,ull b){\n\treturn b?gcd(b,a%b):a;\n}\n\null a[20];\nint p[20];\nint main(){\n\tint n;\n\tull m;\n\tscanf(\"%d%llu\",&n,&m);\n\tREP(i,1<<n) b[i]=0,c[i]=0;\n\tREP(i,n) scanf(\"%llu\",a+i);\n\tREP(i,n) scanf(\"%d\",p+i);\n\tFOR(i,1,1<<n) REP(j,n) c[i]+=(i>>j)&1;\n\tint g=1;\n\tFOR(k,1,n+1){\n\t\tREP(i,1<<n) dp[i]=0;\n\t\tFOR(i,1,1<<n){\n\t\t\tif(c[i]<k)\n\t\t\t\tcontinue;\n\t\t\telse{\n\t\t\t\tif(c[i]==k){\n\t\t\t\t\tull s=1;\n\t\t\t\t\tREP(j,n)\n\t\t\t\t\t\tif((1<<j)&i){\n\t\t\t\t\t\t\tull g=s>a[j]?gcd(s,a[j]):gcd(a[j],s);\n\t\t\t\t\t\t\ts/=g;\n\t\t\t\t\t\t\tif(s>m/a[j]){\n\t\t\t\t\t\t\t\ts=0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}else\n\t\t\t\t\t\t\t\ts*=a[j];\n\t\t\t\t\t\t}\n\t\t\t\t\tif(s)\n\t\t\t\t\t\tdp[i]=m/s;\n\t\t\t\t}else{\n\t\t\t\t\tREP(j,n)\n\t\t\t\t\t\tdp[i]+=dp[i^(1<<j)];\n\t\t\t\t\tdp[i]/=c[i]-k;\n\t\t\t\t}\n\t\t\t\tb[i]+=dp[i]*g;\n\t\t\t}\n\t\t}\n\t\tg=-g;\n\t}\n\tdouble s=0;\n\tFOR(i,1,1<<n){\n\t\tdouble e=1;\n\t\tREP(j,n)\n\t\t\tif((1<<j)&i)\n\t\t\t\te*=0.01*p[j];\n\t\t\telse\n\t\t\t\te*=0.01*(100-p[j]);\n\t\ts+=b[i]*e;\n\t}\n\tprintf(\"%.8f\\n\",s);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long int;\n\nint main() {\n    ll N, M; cin >> N >> M;\n    \n    vector<ll> A(N), P(N), MSB(N);\n    for(int i=0; i<N; i++) {\n        cin >> A[i];\n\n        for(int k=0; k<62; k++) {\n            if(A[i] >> k & 1) {\n                MSB[i] = k;\n            }\n        }\n    }\n    for(int i=0; i<N; i++) {\n        cin >> P[i];\n    }\n\n    vector<ll> divisor(1 << N), popcnt(1 << N);\n    for(int bit=0; bit<(1<<N); bit++) {\n        popcnt[bit] = __builtin_popcountll(bit);\n\n        bool overflow = false;\n        ll msb_sum = 0, mul = 1;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                ll val = A[i] / __gcd(mul, A[i]);\n                if(1.0 * val * mul > 1.2e18) {\n                    overflow = true;\n                    break;\n                }\n                else {\n                    mul = mul * val;\n                }\n            }\n        }\n\n        if(!overflow) {\n            divisor[bit] = M / mul;\n        }\n    }\n\n    divisor[0] = 0;\n    for(int i=0; i<N; i++) {\n        for(int bit=0; bit<(1<<N); bit++) {\n            if(bit >> i & 1) divisor[bit] -= divisor[bit ^ (1 << i)];\n        }\n    }\n\n    long double ans = 0;\n    for(int bit=0; bit<(1<<N); bit++) {\n        long double prob = 1.0;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                prob *= 1.0 * P[i];\n            }\n            else {\n                prob *= 1.0 * (100 - P[i]);\n            }\n        }\n        ll sum = llabs(divisor[bit]);\n        ans += prob * sum;\n    }\n    printf(\"%.12Lf\\n\", ans / pow(100, N));\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst ll INF=2e18;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nll gcd(ll a,ll b)\n{\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b)\n{\n\tif(a==INF || b==INF) return INF;\n\tif(a/gcd(a,b)>INF/b) return INF;\n\treturn a/gcd(a,b)*b;\n}\n\ninline int clz(uint x)\n{\n\tint i=0;\n\tif(!(x&0xffff0000)) i+=16,x<<=16;\n\tif(!(x&0xff000000)) i+=8,x<<=8;\n\tif(!(x&0xf0000000)) i+=4,x<<=4;\n\tif(!(x&0xc0000000)) i+=2,x<<=2;\n\tif(!(x&0x80000000)) i+=1,x<<=1;\n\treturn i+!x;\n}\n\ntemplate<typename T>\nvector<T> Zeta(const vector<T>& g)\n{\n\tint n=31-clz(g.size());\n\tvector<T> f=g;\n\trep(i,n) rep(s,1<<n)\n\t\tif(s>>i&1) f[s]+=f[s^1<<i];\n\treturn f;\n}\n\ntemplate<typename T>\nvector<T> Moebius(const vector<T>& f)\n{\n\tint n=31-clz(f.size());\n\tvector<T> g=f;\n\trep(i,n) rep(s,1<<n)\n\t\tif(s>>i&1) g[s]-=g[s^1<<i];\n\treturn g;\n}\n\nint main()\n{\n\tfor(ll n,m;cin>>n>>m && n|m;){\n\t\tvl as(n);\n\t\trep(i,n) cin>>as[i];\n\t\tvd ps(n);\n\t\trep(i,n) cin>>ps[i],ps[i]/=100;\n\t\t\n\t\t// f(S): -1^|S| × (Sのどの要素でも割り切れる1<=x<=mの個数)\n\t\t// g(S): Sのいずれかの要素で割り切れる1<=x<=mの個数\n\t\tvl f(1<<n);\n\t\trepi(i,1,1<<n){\n\t\t\tll l=1;\n\t\t\trep(j,n) if(i>>j&1)\n\t\t\t\tl=lcm(l,as[j]);\n\t\t\tif(l==INF) continue;\n\t\t\tf[i]+=m/l;\n\t\t}\n\t\tvl g=Moebius(f);\n\t\t\n\t\tdouble res=0;\n\t\trepi(i,1,1<<n){\n\t\t\tdouble p=1;\n\t\t\trep(j,n) p*=i>>j&1?ps[j]:1-ps[j];\n\t\t\tres+=p*abs(g[i]);\n\t\t}\n\t\tprintf(\"%.10f\\n\",res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll lcm(ll bit) {\n\tif(bit == 0) return INF * INF + INF;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\t__int128 g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\tif(g > INF * INF) return INF * INF + INF;\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].emplace_back(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].emplace_back(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep1(i,(1<<n)-1){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.12f\\n\",ret);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b) return MA;\n\treturn a*b;\n}\n\nlong long num[1<<20];\ndouble pr[1<<20];\n\nlong long a[20];\ndouble p[20];\n\nint main(){\n\tint N;\n\tlong long M;\n\tscanf(\"%d%lld\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tdouble tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tdp[0].pb(0);\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[bit].pb(m / g);\n\t\telse dp[bit].pb(-(m / g));\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tdp[bit].pb(dp[bit].back() + dp[bit ^ (1 << i)][sum]);\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * dp[bit].back();\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\ntypedef long long Int;\n\nint n;\nInt m, a[32];\ndouble p[32];\n\ndouble f(Int b) {\n    Int x = 1;\n    rep (i, n) if (b&(1<<i)) {\n        if ((double)x*a[i] > 2e18) return 0;\n        x *= a[i];\n        if (x > m) return 0;\n    }\n    return m / x;\n}\n\nint main() {\n    cin >> n >> m;\n    rep (i, n) cin >> a[i];\n    rep (i, n) cin >> p[i];\n    rep (i, n) p[i] /= 100;\n    double ans = 0;\n    rep (b, 1<<n) if (b) {\n        double q = 1.0;\n        int c = 0;\n        rep (i, n) if (b&(1<<i)) {\n            c++;\n            q *= p[i];\n        }\n        ans += q * f(b) * (c%2 ? 1 : -1);\n    }\n    printf(\"%.12f\\n\", ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long int64;\n\nint64 lcm(int64 x, int64 y)\n{\n  int64 ret = x / __gcd(x, y);\n  if(1.0 * ret * y > 1e18) return (2e18);\n  return (ret * y);\n}\n\n\nint main()\n{\n  int64 N, M, A[20];\n  double P[20];\n\n  cin >> N >> M;\n  for(int i = 0; i < N; i++) {\n    cin >> A[i];\n  }\n  for(int i = 0; i < N; i++) {\n    double s;\n    cin >> s;\n    P[i] = s / 100;\n  }\n\n  double ret = 0.0;\n  for(int i = 1; i < 1 << N; i++) {\n    int64 latte = 1;\n    double fact = 1.0;\n    for(int j = 0; j < N; j++) {\n      if((i >> j) & 1) {\n        latte = lcm(latte, A[j]);\n        fact *= P[j];\n      }\n    }\n    int st = __builtin_popcount(i);\n    if(st & 1) ret += fact * (M / latte);\n    else ret -= fact * (M / latte);\n  }\n  cout << fixed << setprecision(10) << ret << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nll dp[20 + 1][(1ll << 20)];\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[0][bit] = m / g;\n\t\telse dp[0][bit] = - (m / g);\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) dp[i + 1][bit] = dp[i][bit] + dp[i][bit ^ (1 << i)];\n\t\t\telse dp[i + 1][bit] = dp[i][bit];\n\t\t}\n\t\tans += prob * dp[n][bit];\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define MAX_N 40\n#define INF 9000000000000000000\n#define MOD 1000000007\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,double> P;\n\nll n, m;\nll dp[(1<<20)];\nP a[20];\nvector<P> b;\n\nll gcd(ll x, ll y){\n    while(y){\n        x %= y;\n        swap(x,y);\n    }\n    return x;\n}\n\nint main(){\n    cin >> n >> m;\n    rep(i,n) cin >> a[i].first;\n    rep(i,n) cin >> a[i].second;\n    rep(i,n) a[i].second /= 100;\n    sort(a,a+n);\n    int sanu = -1;\n    double prob = 1.0;\n    rep(i,n){\n        if(i == 0){\n            sanu = a[i].first;\n            prob *= (1-a[i].second);\n            continue;\n        }\n        if(a[i].first == sanu){\n            prob *= (1-a[i].second);\n        } else{\n            b.push_back(P(sanu,1-prob));\n            sanu = a[i].first;\n            prob = 1-a[i].second;\n        }\n    }\n    b.push_back(P(sanu,1-prob));\n    n = b.size();\n    rep(i,(1<<n)){\n        if(i == 0) continue;\n        int cnt = 0;\n        ll hoge = 1;\n        bool ok = true;\n        rep(j,n){\n            if(i&(1<<j)){\n                cnt++;\n                ll g = gcd(hoge,b[j].first);\n                hoge /= g;\n                if(INF/hoge < b[j].first/g){\n                    ok = false;\n                    break;\n                }\n                hoge = hoge*(b[j].first/g);\n            }\n        }\n        if(!ok) dp[i] = 0;\n        else dp[i] = m/hoge;\n        if(cnt%2 == 0) dp[i] *= -1;\n    }\n    rep(i,n) rep(j,(1<<n)){\n        if(j&(1<<i)){\n            dp[j] += dp[(j^(1<<i))];\n        }\n    }\n    double ans = 0.0;\n    rep(i,(1<<n)){\n        double prob = 1.0;\n        rep(j,b.size()){\n            if(i&(1<<j)){\n                prob *= b[j].second;\n            } else{\n                prob *= (1-b[j].second);\n            }\n        }\n        ans += prob*dp[i];\n    }\n    printf(\"%.9f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <cmath>\n#include <bitset>\nusing namespace std;\nusing ll = long long;\n\ntemplate <typename T>\nT gcd(const T a, const T b)\n{\n    return (b != 0) ? gcd(b, a % b) : a;\n}\n\ntemplate <typename T>\nvector<T> Moebius(vector<T> f)  // Moebius{f}(Y) = \\sum_{X \\subseteq Y} (-1)^{|Y\\X|} f(X)\n{\n    for (int i = 0; (1LL << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1LL << i) {\n                f[j] -= f[j ^ 1LL << i];\n            }\n        }\n    }\n    return f;\n}\n\nint main()\n{\n    int N;\n    cin >> N;\n    ll M;\n    cin >> M;\n    vector<ll> a(N);\n    vector<long double> p(N);\n    for (int i = 0; i < N; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < N; i++) {\n        cin >> p[i];\n        p[i] /= 100.0;\n    }\n\n    const int maximum = 1 << N;\n    vector<long double> ex(maximum, 1.0);\n    for (int i = 0; i < maximum; i++) {\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                ex[i] *= p[j];\n            }\n        }\n    }\n\n    ex[0] = 0;\n    for (int i = 1; i < maximum; i++) {\n        ll LCM = 1LL;\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                const ll g = gcd(LCM, a[j]);\n                const ll b = a[j] / g;\n                if (log2(LCM) + log2(b) < 63) {\n                    LCM *= b;\n                } else {\n                    ex[i] = 0;\n                    break;\n                }\n            }\n        }\n        ex[i] *= (M / LCM);\n    }\n    const vector<long double> ans = Moebius(ex);\n    cout << fixed << setprecision(15) << -ans[maximum - 1] << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll; typedef long double ld;\n#define INF 1LL<<60\nld lginf = -1;\nll mul(ll a, ll b) { if (lginf < 0) lginf = log10l(INF); ld aa = log10l(a), bb = log10l(b);\n    if (lginf <= aa + bb) return INF; return a * b; }\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { if (a == INF || b == INF) return INF; return mul(a / gcd(a, b), b); }\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; ld P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) {\n        int x; cin >> x;\n        P[i] = x / 100.0;\n    }\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)) lc = lcm(lc, A[i]);\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= P[i];\n            else p *= 1 - P[i];\n        }\n\n        ans += (ld)abs(f[mask]) * p;\n    }\n    printf(\"%.10llf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long gcd(long long x, long long y){\n  if(x < y) swap(x,y);\n  while(y){\n    x %= y;\n    swap(x,y);\n  }\n  return x;\n}\n\nint main(){\n  long long n, m;\n  cin >> n >> m;\n  vector<long long> A(n);\n  vector<double> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i){\n    cin >> P[i];\n    P[i] /= 100.0;\n  }\n  double ans = 0;\n  // vector<long long> LCM;\n  // vector<double> P_;\n  // vector<int> C;\n  // LCM.push_back(1);\n  // P_.push_back(1.0);\n  // C.push_back(0);\n  vector<long long> LCM((1<<n)+1);\n  vector<double> P_((1<<n)+1);\n  vector<int> C((1<<n)+1);\n  LCM[0] = 1;\n  P_[0] = 1;\n  C[0] = 0;\n  long long s = 1;\n  for(int i = 0; i < n; ++i){\n    long long s_ = s;\n    for(long long j = 0; j < s; ++j){\n      if(LCM[j]/gcd(LCM[j],A[i]) > m/A[i]) continue;\n      long long t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i];\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      // LCM.push_back(t);\n      // P_.push_back(p);\n      // C.push_back(c);\n      LCM[s_] = t;\n      P_[s_] = p;\n      C[s_] = c;\n      ++s_;\n      //cout << t << \" \" << p << \" \" << c << endl;\n    }\n    s = s_;\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long int;\n\nint main() {\n    ll N, M; cin >> N >> M;\n    \n    vector<ll> A(N), P(N), MSB(N);\n    for(int i=0; i<N; i++) {\n        cin >> A[i];\n\n        for(int k=0; k<62; k++) {\n            if(A[i] >> k & 1) {\n                MSB[i] = k;\n            }\n        }\n    }\n    for(int i=0; i<N; i++) {\n        cin >> P[i];\n    }\n\n    vector<ll> divisor(1 << N), popcnt(1 << N);\n    for(int bit=0; bit<(1<<N); bit++) {\n        popcnt[bit] = __builtin_popcount(bit);\n\n        bool overflow = false;\n        ll msb_sum = 0, mul = 1;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                msb_sum += MSB[i];\n                if(msb_sum >= 60) {\n                    overflow = true;\n                    break;\n                }\n                else {\n                    mul *= A[i];\n                }\n            }\n        }\n\n        if(!overflow) {\n            divisor[bit] = M / mul;\n        }\n    }\n\n    divisor[0] = 0;\n    for(int i=0; i<N; i++) {\n        for(int bit=0; bit<(1<<N); bit++) {\n            if(bit >> i & 1) divisor[bit] -= divisor[bit ^ (1 << i)];\n        }\n    }\n\n    double ans = 0;\n    for(int bit=1; bit<(1<<N); bit++) {\n        double prob = 1.0;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                prob *= 1.0 * P[i] / 100.0;\n            }\n            else {\n                prob *= 1.0 * (100 - P[i]) / 100.0;\n            }\n        }\n\n        // printf(\"bit = %d, prob = %.12f, sum = %.12f\\n\", bit, prob, sum);\n        // printf(\"bit = %d, odd = %lld, even = %lld\\n\", bit, odd[bit], even[bit]);\n        // ll sum = odd[bit] - even[bit];\n        ll sum = llabs(divisor[bit]);\n        ans += prob * sum;\n    }\n    printf(\"%.12f\\n\", ans);\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) break;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 2*m) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n#include <bits/stdc++.h>\n#define rep(i, n) for(int i=0; i<n; ++i)\n#define all(v) v.begin(), v.end()\n#define rall(v) v.rbegin(), v.rend()\nusing namespace std;\nusing ll = int64_t;\nusing ld = long double;\nusing P = pair<int, int>;\nusing vs = vector<string>;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\ntemplate<class T> using PQ = priority_queue<T>;\ntemplate<class T> using PQG = priority_queue<T, vector<T>, greater<T> >;\nconst int INF = 100010001;\nconst ll LINF = (ll)INF*INF*10;\ntemplate<typename T1, typename T2>\ninline bool chmax(T1 &a, T2 b) {return a < b && (a = b, true);}\ntemplate<typename T1, typename T2>\ninline bool chmin(T1 &a, T2 b) {return a > b && (a = b, true);}\ntemplate<typename T1, typename T2>\nistream &operator>>(istream &is, pair<T1, T2> &p) { return is >> p.first >> p.second;}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) { return os << p.first << ' ' << p.second;}\n\nint64_t gcd(int64_t a, int64_t b) {return b?gcd(b, a%b):a;}\nint64_t lcm(int64_t a, int64_t b) {\n    return (ll)min((ld)a/gcd(a,b)*b, (ld)2e18);\n}\nint64_t extgcd(int64_t a, int64_t b, int64_t &x, int64_t &y) { // ax+by=gcd(a, b)の解を与える\n    int64_t d = a;\n    if(b) {\n        d = extgcd(b, a%b, y, x);\n        y -= (a/b)*x;\n    } else {\n        x = 1; y = 0;\n    }\n    return d;\n}\nint main() {\n    cout << fixed << setprecision(10);\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n;\n    ll m;\n    cin >> n >> m;\n    vector<ll> a(n);\n    vector<ld> p(n);\n    rep(i, n) cin >> a[i];\n    rep(j, n) {\n        cin >> p[j];\n        p[j] /= 100.0;\n    }\n    vector<ll> dp(1<<n);\n    rep(bit, 1<<n) {\n        if(!bit) continue;\n        ll mul = 1;\n        rep(i, n) if((bit>>i)&1) {\n            mul = lcm(mul, a[i]);\n        }\n        dp[bit] = m/mul;\n    }\n    rep(i, n) rep(bit, 1<<n) {\n        if(bit>>i & 1) dp[bit] -= dp[bit^(1<<i)];\n    }\n    ld ans = 0;\n    rep(bit, 1<<n) {\n        ld pr = 1;\n        rep(j, n) {\n            if(bit>>j&1) {\n                pr *= p[j];\n            } else {\n                pr *= 1-p[j];\n            }\n        }\n        ans += pr*abs(dp[bit]);\n    }\n    cout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <cmath>\n#include <bitset>\nusing namespace std;\nusing ll = long long;\n\ntemplate <typename T>\nT gcd(const T a, const T b)\n{\n    return (b != 0) ? gcd(b, a % b) : a;\n}\n\ntemplate <typename T>\nvector<T> Moebius(vector<T> f)  // Moebius{f}(Y) = \\sum_{X \\subseteq Y} (-1)^{|Y\\X|} f(X)\n{\n    for (int i = 0; (1LL << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1LL << i) {\n                f[j] -= f[j ^ 1LL << i];\n            }\n        }\n    }\n    return f;\n}\n\nint main()\n{\n    int N;\n    cin >> N;\n    ll M;\n    cin >> M;\n    vector<ll> a(N);\n    vector<long double> p(N);\n    for (int i = 0; i < N; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < N; i++) {\n        cin >> p[i];\n        p[i] /= 100.0;\n    }\n\n    const int maximum = 1 << N;\n    vector<long double> ex(maximum, 1.0);\n    for (int i = 0; i < maximum; i++) {\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                ex[i] *= p[j];\n            }\n        }\n    }\n\n    for (int i = 0; i < maximum; i++) {\n        ll LCM = 1LL;\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                if (log2(LCM) + log2(a[j]) < 62) {\n                    const ll g = gcd(LCM, a[j]);\n                    const ll b = a[j] / g;\n                    if (log2(LCM) + log2(b) < 62) {\n                        LCM *= b;\n                    } else {\n                        ex[i] = 0;\n                        break;\n                    }\n                } else {\n                    ex[i] = 0;\n                    break;\n                }\n            }\n        }\n        ex[i] *= (M / LCM);\n    }\n    const vector<long double> ans = Moebius(ex);\n    cout << fixed << setprecision(15) << M - ans[maximum - 1] << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\nusing ll = long long;\nll A[20];\ndouble P[20];\nll LCM[1<<20];\ndouble P_[1<<20];\n\nll gcd(ll x, ll y){\n  if(x < y) swap(x,y);\n  while(y) x %= y, swap(x,y);\n  return x;\n}\n\nint main(){\n  ll n, m;\n  cin >> n >> m;\n  // vector<ll> A(n);\n  // vector<double> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i], P[i] /= 100.0;\n  double ans = 0;\n  // vector<ll> LCM;\n  // vector<double> P_;\n  // LCM.push_back(1);\n  // P_.push_back(-1.0);\n  LCM[0] = 1;\n  P_[0] = -1;\n  ll s = 1, s_ = 1;\n  for(int i = 0; i < n; ++i){\n    // ll s = LCM.size();\n    for(ll j = 0; j < s; ++j){\n      if(LCM[j]/gcd(LCM[j],A[i]) > m/A[i]) continue;\n      ll t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = -P_[j]*P[i];\n      ans += m/t*p;\n      // LCM.push_back(t);\n      // P_.push_back(p);\n      LCM[s_] = t;\n      P_[s_] = p;\n      ++s_;\n    }\n    s = s_;\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\ntypedef long double ld;\n#define INF 1LL<<60\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) {\n    if (a == INF) return INF;\n    if (b == INF) return INF;\n    a /= gcd(a, b);\n\n    ld aa = log10l(a);\n    ld bb = log10l(b);\n\n    if (log10l(INF) <= aa + bb) return INF;\n\n    return a * b;\n}\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; ld P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) {\n        int x; cin >> x;\n        P[i] = x / 100.0;\n    }\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)) lc = lcm(lc, A[i]);\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= P[i];\n            else p *= 1 - P[i];\n        }\n\n        ans += (ld)abs(f[mask]) * p;\n    }\n    printf(\"%.10lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tdp[0].emplace_back(0);\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[bit].emplace_back(m / g);\n\t\telse dp[bit].emplace_back(-(m / g));\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tdp[bit].emplace_back(dp[bit].back() + dp[bit ^ (1 << i)][sum]);\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * dp[bit].back();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <cmath>\n#include <bitset>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\n\ntemplate <typename T>\nT gcd(const T a, const T b)\n{\n    return (b != 0) ? gcd(b, a % b) : a;\n}\n\ntemplate <typename T>\nvector<T> Moebius(vector<T> f)  // Moebius{f}(Y) = \\sum_{X \\subseteq Y} (-1)^{|Y\\X|} f(X)\n{\n    for (int i = 0; (1LL << i) < f.size(); i++) {\n        for (int j = f.size() - 1; j >= 0; j--) {\n            if (j & 1LL << i) {\n                f[j] -= f[j ^ 1LL << i];\n            }\n        }\n    }\n    return f;\n}\n\nint main()\n{\n    int N;\n    cin >> N;\n    ll M;\n    cin >> M;\n    vector<ll> a(N);\n    vector<ld> p(N);\n    for (int i = 0; i < N; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < N; i++) {\n        cin >> p[i];\n        p[i] /= 100.0;\n    }\n\n    const int maximum = 1 << N;\n    vector<ld> ex(maximum, 1.0);\n    for (int i = 0; i < maximum; i++) {\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                ex[i] *= p[j];\n            }\n        }\n    }\n    ex[0] = 0;\n    for (int i = 1; i < maximum; i++) {\n        ll LCM = 1LL;\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                const ll g = gcd(LCM, a[j]);\n                const ll b = a[j] / g;\n                if (log2(LCM) + log2(b) < 63) {\n                    LCM *= b;\n                } else {\n                    ex[i] = 0;\n                    break;\n                }\n            }\n        }\n        ex[i] *= (M / LCM);\n    }\n\n    const vector<ld> ans = Moebius(ex);\n    cout << fixed << setprecision(30) << abs(ans[maximum - 1]) << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <set>\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-9\n#define INF 2000000000\n#define sz(x) ((int)(x).size())\n#define fi first\n#define sec second\n#define SORT(x) sort((x).begin(),(x).end())\n#define all(x) (x).begin(),(x).end()\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);(i)++)\n#define repn(i,a,n) for(int (i)=(a);(i)<(int)(n);(i)++)\n#define EQ(a,b) (abs((a)-(b))<eps)\nint n;\nll m;\nll a[25];\nll b[25];\nint p[25];\ndouble r[25];\nll dp[1<<21];\nint main()\n{\n\tscanf(\"%d %lld\",&n,&m);\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tscanf(\"%lld\",&a[i]);\n\t\tb[i]=m/a[i];\n\t}\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tscanf(\"%d\",&p[i]);\n\t\tr[i]=p[i]/100.0;\n\t}\n\tfor(int i=0;i<(1<<n);i++)\n\t{\n\t\tll g=-1ll;\n\t\tbool over=false;\n\t\tfor(int j=0;j<n;j++)\n\t\t{\n\t\t\tif((i>>j)&1)\n\t\t\t{\n\t\t\t\tif(g==-1ll)g=a[j];\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tll A = a[j];\n\t\t\t\t\tll B =g/__gcd(g,a[j]);\n\t\t\t\t\tif(B!=0&&LLONG_MAX/A<B)\n\t\t\t\t\t{\n\t\t\t\t\t\tover = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\telse g = A*B;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(!over&&g!=-1ll)dp[i]=m/g;\n\t}\n\tfor(int i=0;i<n;i++)for(int j=0;j<(1<<n);j++)if(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\t//for(int i=0;i<(1<<n);i++)cout << dp[i] << endl;\n\tdouble ans=0.0;\n\tfor(int i=0;i<(1<<n);i++)\n\t{\n\t\tdouble R = 1.0;\n\t\tfor(int j=0;j<n;j++)\n\t\t{\n\t\t\tif((i>>j)&1)R*=r[j];\n\t\t\telse R*=(1.0-r[j]);\n\t\t}\n\t\tans += R*abs(dp[i]);\n\t}\n\tprintf(\"%.12f\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n/*\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  while(y){\n    x %= y;\n    swap(x,y);\n  }\n  return x;\n}\n*/\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  vector<long long int> LCM;\n  vector<double> P_;\n  vector<int> C;\n  LCM.push_back(1);\n  P_.push_back(1.0);\n  C.push_back(0);\n  for(int i = 0; i < n; ++i){\n    long long int s = LCM.size();\n    for(long long int j = 0; j < s; ++j){\n      long long int t = LCM[j]/__gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i]/100.0;\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n      C.push_back(c);\n      //cout << t << \" \" << p << \" \" << c << endl;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstdio>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ULL;\n\nULL gcd(ULL a, ULL b) {\n    if(a < b) swap(a, b);\n    while(b > 0) {\n        ULL tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    int N;\n    ULL M;\n    cin >> N >> M;\n    vector<ULL> as(N);\n    vector<int> ps(N);\n    for(int i = 0; i < N; ++i) {\n        cin >> as[i];\n    }\n    for(int i = 0; i < N; ++i) {\n        cin >> ps[i];\n    }\n\n    long double ans = 0;\n    for(int pat = 1; pat < (1<<N); ++pat) {\n        vector<ULL> nums;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) nums.push_back(as[ord]);\n        }\n        ULL all_gcd = nums[0];\n        for(int i = 1; i < nums.size(); ++i) {\n            all_gcd = gcd(all_gcd, nums[i]);\n        }\n        long double part = M;\n        if(nums.size() > 1) {\n            nums[0] /= all_gcd;\n        }\n        for(int i = 0; i < nums.size(); ++i) {\n            part /= nums[i];\n        }\n        if(nums.size() % 2 == 0) part = -part;\n        //cout << part << endl;\n\n        long double prob = 1;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) {\n                prob *= ps[ord];\n            } else {\n                //prob *= (1 - ps[ord]/100.0);\n            }\n        }\n        prob /= pow(100.0, nums.size());\n        ans += (long long)part * prob;\n    }\n\n    printf(\"%.8f\\n\", (double)ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// includes\n#include <bits/stdc++.h>\n\n// macros\n#define ll long long int\n#define pb emplace_back\n#define mk make_pair\n#define pq priority_queue\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define rep(i, n) FOR(i, 0, n)\n#define rrep(i, n) for(int i=((int)(n)-1);i>=0;i--)\n#define all(x) (x).begin(),(x).end()\n#define sz(x) ((int)(x).size())\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end())\n#define FI first\n#define SE second\nusing namespace std;\n\n//  types\ntypedef pair<int, int> P;\ntypedef pair<ll, int> Pl;\ntypedef pair<ll, ll> Pll;\ntypedef pair<double, double> Pd;\n \n// constants\nconst int inf = 1e9;\nconst ll linf = 1LL << 50;\nconst double EPS = 1e-10;\nconst int mod = 1e9 + 7;\n\n// solve\ntemplate <class T>bool chmax(T &a, const T &b){if(a < b){a = b; return 1;} return 0;}\ntemplate <class T>bool chmin(T &a, const T &b){if(a > b){a = b; return 1;} return 0;}\ntemplate <typename T> istream &operator>>(istream &is, vector<T> &vec){for(auto &v: vec)is >> v; return is;}\n\n/*\n * f(U) = \\sum_{U\\in T}(-1)^(|T\\U|)f(T)\n * for f(U) = \\sum_{U\\in T}f(T), use f[j | i] -= f[j];\n */\ntemplate <typename T>\nvoid fast_moebius(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j | i] -= f[j];\n      }\n    }\n  }\n}\n\n/*\n * f(U) = \\sum_{U\\in T}f(T)\n * for f(U) = \\sum_{T\\in U}f(T), use f[j | i] += f[j];\n */\ntemplate <typename T>\nvoid fast_zeta(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j] += f[j | i];\n      }\n    }\n  }\n}\n\nostream& operator<<(ostream& dest, __int128_t value) {\n  ostream::sentry s(dest);\n  if(s){\n    __uint128_t tmp = value < 0 ? - value: value;\n    char buf[128];\n    char *d = end(buf);\n    do{\n      --d;\n      *d = \"0123456789\"[tmp % 10];\n      tmp /= 10;\n    }while(tmp != 0);\n    if(value < 0)--d, *d='-';\n    int len = end(buf) - d;\n    if(dest.rdbuf()->sputn(d, len) != len){\n      dest.setstate(ios_base::badbit);\n    }\n  }\n  return dest;\n}\n\n__int128_t to_int128(string s){\n  __int128_t res = 0;\n  for(int i = 0; i < s.size(); i++){\n    res = res * 10 + (s[i] - '0');\n  }\n  return res;\n}\n\nusing uint128 = __int128_t;\n\nint main(int argc, char const* argv[])\n{\n  ios_base::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  ll m;\n  cin >> n >> m;\n  vector<ll> a(n);\n  vector<int> p(n);\n  cin >> a >> p;\n  double res = 0.;\n  vector<uint128> f((1 << n), 0);\n  vector<double> pr((1 << n), 0.);\n  for(int i = 0; i < (1 << n); i++){\n    uint128 tmp = 1;\n    double ptmp = 1.;\n    bool ng = false;\n    if(tmp > m){\n      ng = true;\n      tmp = 0;\n    }\n    for(int j = 0; j < n; j++){\n      if((i >> j) % 2 == 1){\n        tmp *= a[j];\n        if(tmp > m){\n          ng = true;\n          tmp = 0;\n        }\n        ptmp *= (double)p[j] / 100.;\n      }else ptmp *= (1. - (double)p[j] / 100.);\n    }\n    if(i == 0)tmp = 0;\n    if(ng)tmp = 0;\n    f[i] = (tmp > 0 ? m / tmp: 0);\n    pr[i] = ptmp;\n  }\n  fast_moebius(f);\n  for(int i = 0; i < (1 << n); i++)res += pr[i] * (double)(abs((ll)f[i]));\n  cout << setprecision(20);\n  cout << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <memory>\n#include <cstring>\n#include <cassert>\n#include <numeric>\n#include <sstream>\n#include <complex>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <cctype>\n#include <unordered_map>\n#include <unordered_set>\nusing namespace std;\n\n#define REP2(i, m, n) for (int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(S) (S).begin(), (S).end()\n\ntemplate <typename T, typename E>\nostream &operator<<(std::ostream &os, const std::pair<T, E> &p){\n  return os << \"(\" << p.first << \", \" << p.second << \")\";\n}\n\ntypedef long long ll;\n\nconst ll INF = 1000LL * 1000 * 1000 * 1000 * 1000 * 1010;\n\nll gcd(ll u, ll v){\n  return v == 0 ? u : gcd(v, u % v);\n}\n\nll lcm(ll u,  ll v){\n  ll d = gcd(u, v);\n  u /= d;\n  if (INF / u < v){\n    return INF;\n  } else {\n    return u * v;\n  }\n}\n\nll lcm(const vector<ll> &a, int mask){\n  ll res = 1;\n  REP(i, a.size()){\n    if (mask & (1 << i)) res = lcm(res, a[i]);\n  }\n  return res;\n}\n\n\nint main(){\n  ios::sync_with_stdio(false);\n\n  ll n, m;\n  while (cin >> n >> m && n + m){\n    vector<ll> a(n);\n    vector<ll> p(n);\n    \n    REP(i, n) cin >> a[i];\n    REP(i, n) cin >> p[i];\n    \n\n    double res = 0;\n    REP(mask, 1 << n) if (mask){\n      double prob = 1.0;\n      REP(i, n) if (mask & (1 << i)){\n        prob *= (double)p[i] / 100;\n      }\n      \n      if (__builtin_popcountll(mask) % 2 == 1){\n        res += prob * (m / lcm(a, mask));\n      } else {\n        res -= prob * (m / lcm(a, mask));\n      }\n    }\n    printf(\"%.20lf\\n\", res);\n  }\n  return 0;\n  }"
  },
  {
    "language": "C++",
    "code": "#include <stdint.h>\n#include <stdlib.h>\n\n#include <algorithm>\n#include <bitset>\n#include <iostream>\n#include <numeric>\n#include <vector>\nusing namespace std;\nusing default_counter_t = int64_t;\n\n// macro\n#define let auto const&\n#define overload4(a, b, c, d, name, ...) name\n#define rep1(n) \\\n  for (default_counter_t i = 0, end_i = default_counter_t(n); i < end_i; ++i)\n#define rep2(i, n)                                                           \\\n  for (default_counter_t i = 0, end_##i = default_counter_t(n); i < end_##i; \\\n       ++i)\n#define rep3(i, a, b)                                    \\\n  for (default_counter_t i       = default_counter_t(a), \\\n                         end_##i = default_counter_t(b); \\\n       i < end_##i; ++i)\n#define rep4(i, a, b, c)                                 \\\n  for (default_counter_t i       = default_counter_t(a), \\\n                         end_##i = default_counter_t(b); \\\n       i < end_##i; i += default_counter_t(c))\n#define rep(...) overload4(__VA_ARGS__, rep4, rep3, rep2, rep1)(__VA_ARGS__)\n\n#define rrep1(n) \\\n  for (default_counter_t i = default_counter_t(n) - 1; i >= 0; --i)\n#define rrep2(i, n) \\\n  for (default_counter_t i = default_counter_t(n) - 1; i >= 0; --i)\n#define rrep3(i, a, b)                                         \\\n  for (default_counter_t i         = default_counter_t(b) - 1, \\\n                         begin_##i = default_counter_t(a);     \\\n       i >= begin_##i; --i)\n#define rrep4(i, a, b, c)                                          \\\n  for (default_counter_t                                           \\\n           i = (default_counter_t(b) - default_counter_t(a) - 1) / \\\n                   default_counter_t(c) * default_counter_t(c) +   \\\n               default_counter_t(a),                               \\\n           begin_##i = default_counter_t(a);                       \\\n       i >= begin_##i; i -= default_counter_t(c))\n#define rrep(...) \\\n  overload4(__VA_ARGS__, rrep4, rrep3, rrep2, rrep1)(__VA_ARGS__)\n\n#define ALL(f, c, ...)                                           \\\n  (([&](decltype((c)) cccc) {                                    \\\n    return (f)(std::begin(cccc), std::end(cccc), ##__VA_ARGS__); \\\n  })(c))\n\n// function\ntemplate <class C>\nconstexpr C& Sort(C& a) {\n  std::sort(std::begin(a), std::end(a));\n  return a;\n}\ntemplate <class C>\nconstexpr auto& Min(C const& a) {\n  return *std::min_element(std::begin(a), std::end(a));\n}\ntemplate <class C>\nconstexpr auto& Max(C const& a) {\n  return *std::max_element(std::begin(a), std::end(a));\n}\ntemplate <class C>\nconstexpr auto Total(C const& c) {\n  return std::accumulate(std::begin(c), std::end(c), C(0));\n}\ntemplate <typename T>\nauto CumSum(std::vector<T> const& v) {\n  std::vector<T> a(v.size() + 1, T(0));\n  for (std::size_t i = 0; i < a.size() - size_t(1); ++i) a[i + 1] = a[i] + v[i];\n  return a;\n}\ntemplate <typename T>\nconstexpr bool ChMax(T& a, T const& b) {\n  if (a < b) {\n    a = b;\n    return true;\n  }\n  return false;\n}\ntemplate <typename T>\nconstexpr bool ChMin(T& a, T const& b) {\n  if (b < a) {\n    a = b;\n    return true;\n  }\n  return false;\n}\n\nvoid In(void) { return; }\n\ntemplate <typename First, typename... Rest>\nvoid In(First& first, Rest&... rest) {\n  cin >> first;\n  In(rest...);\n  return;\n}\n\ntemplate <class T, typename I>\nvoid VectorIn(vector<T>& v, const I n) {\n  v.resize(size_t(n));\n  rep(i, v.size()) cin >> v[i];\n}\n\nvoid Out(void) {\n  cout << \"\\n\";\n  return;\n}\n\ntemplate <typename First, typename... Rest>\nvoid Out(First first, Rest... rest) {\n  cout << first << \" \";\n  Out(rest...);\n  return;\n}\n\nconstexpr auto yes(const bool c) { return c ? \"yes\" : \"no\"; }\nconstexpr auto Yes(const bool c) { return c ? \"Yes\" : \"No\"; }\nconstexpr auto YES(const bool c) { return c ? \"YES\" : \"NO\"; }\n\n// http://koturn.hatenablog.com/entry/2018/08/01/010000\ntemplate <typename T, typename U>\ninline std::vector<U> MakeNdVector(T n, U val) noexcept {\n  static_assert(std::is_integral<T>::value,\n                \"[MakeNdVector] The 1st argument must be an integer\");\n  return std::vector<U>(std::forward<T>(n), std::forward<U>(val));\n}\n\ntemplate <typename T, typename... Args>\ninline decltype(auto) MakeNdVector(T n, Args&&... args) noexcept {\n  static_assert(std::is_integral<T>::value,\n                \"[MakeNdVector] The 1st argument must be an integer\");\n  return std::vector<decltype(MakeNdVector(std::forward<Args>(args)...))>(\n      std::forward<T>(n), MakeNdVector(std::forward<Args>(args)...));\n}\n\ntemplate <typename T, std::size_t N,\n          typename std::enable_if<(N > 0), std::nullptr_t>::type = nullptr>\nstruct NdvectorImpl {\n  using type = std::vector<typename NdvectorImpl<T, N - 1>::type>;\n};  // struct ndvector_impl\n\ntemplate <typename T>\nstruct NdvectorImpl<T, 1> {\n  using type = std::vector<T>;\n};  // struct ndvector_impl\n\ntemplate <typename T, std::size_t N>\nusing NdVector = typename NdvectorImpl<T, N>::type;\n\n#ifdef USE_STACK_TRACE_LOGGER\n#ifdef __clang__\n#pragma clang diagnostic push\n#pragma clang diagnostic ignored \"-Weverything\"\n#include <glog/logging.h>\n#pragma clang diagnostic pop\n#endif  //__clang__\n#endif  // USE_STACK_TRACE_LOGGER\n\ntemplate <typename T>\nT Gcd(const T a, const T b) {\n  if (b == 0) return a;\n  return Gcd(b, a % b);\n}\n\ntemplate <typename T>\nT Lcm(const T a, const T b) {\n  return a / Gcd(a, b) * b;\n}\n\nsigned main(int argc, char* argv[]) {\n  (void)argc;\n#ifdef USE_STACK_TRACE_LOGGER\n  google::InitGoogleLogging(argv[0]);\n  google::InstallFailureSignalHandler();\n#else\n  (void)argv;\n#endif  // USE_STACK_TRACE_LOGGER\n  int64_t n, m;\n  In(n, m);\n  vector<int64_t> a(n);\n  vector<double> p(n);\n\n  rep(i, n) { In(a[i]); }\n  rep(i, n) {\n    int tmp;\n    In(tmp);\n    p[i] = double(tmp) * 0.01;\n  }\n\n  vector<double> P(int64_t(1) << n, 0.0);\n\n  rep(S, 0, (int64_t(1) << n)) {\n    bitset<20> bs = S;\n    double tmp    = 1.0;\n    rep(i, n) {\n      if (bs[i]) {\n        tmp *= p[i];\n      } else {\n        tmp *= (1.0 - p[i]);\n      }\n    }\n    P[S] = tmp;\n  }\n\n  vector<int64_t> f(int64_t(1) << n, 0);\n\n  rep(S, 1, (int64_t(1) << n)) {\n    bitset<20> bs = S;\n    int64_t l     = bs.count();\n    int64_t sign  = (l % 2 == 1 ? 1 : -1);\n\n    int64_t _lcm  = 1;\n    bool overflow = false;\n    rep(i, n) {\n      if (bs[i]) {\n        int64_t g   = Gcd(a[i], _lcm);\n        int64_t mul = a[i] / g;\n        if (_lcm >= (m + 1 + mul - 1) / mul) {\n          overflow = true;\n          break;\n        }\n        _lcm *= mul;\n      }\n    }\n    if (overflow) continue;\n    int64_t tmp = m / _lcm;\n    f[S]        = sign * tmp;\n  }\n\n  for (int64_t i = 0; i < n; ++i) {\n    // i次元目について累積和を取る\n    rep(S, int64_t(1) << n) {\n      bitset<20> bs = S;\n      if (bs[i]) {\n        f[S] += f[S ^ (1 << i)];\n        // S ^ (1 << i) について\n        // 今 Sのi番目のビットは1なので1を施して0にする\n        // 普通に累積和の cum[1] += cum[0] をしてるだけ\n      }\n    }\n  }\n\n  double ans = 0.0;\n  rep(S, int64_t(1) << n) { ans += P[S] * double(f[S]); }\n  printf(\"%.15f\\n\", ans);\n\n  return EXIT_SUCCESS;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = m;\n\t\trep(j, n) if(i & 1 << j) t /= a[j];\n\t\tf[i] = t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tdouble ans = 0;\n\trep(i, 1 << n){\n\t\tdouble e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tprintf(\"%.9f\\n\", ans);\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\ntypedef long long Int;\n\nInt gcd(Int a, Int b) { return b == 0 ? a : gcd(b, a%b); }\n\nint n;\nInt m, a[32];\ndouble p[32];\n\ndouble f(Int b) {\n    Int x = 1;\n    rep (i, n) if (b&(1<<i)) {\n        const Int g = gcd(x, a[i]);\n        if ((double)x/g*a[i] > 2e18) return 0;\n        x = x/g*a[i];\n        if (x > m) return 0;\n    }\n    return m / x;\n}\n\nint main() {\n    cin >> n >> m;\n    rep (i, n) cin >> a[i];\n    rep (i, n) cin >> p[i];\n    rep (i, n) p[i] /= 100;\n    double ans = 0;\n    rep (b, 1<<n) if (b) {\n        int c = 0;\n        double q = 1.0;\n        rep (i, n) if (b&(1<<i)) {\n            c++;\n            q *= p[i];\n        }\n        ans += q * f(b) * (c%2 ? 1 : -1);\n    }\n    printf(\"%.12f\\n\", ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <cmath>\n#include <bitset>\nusing namespace std;\nusing ll = long long;\n\ntemplate <typename T>\nT gcd(const T a, const T b)\n{\n    return (b != 0) ? gcd(b, a % b) : a;\n}\n\ntemplate <typename T>\nvector<T> Moebius(vector<T> f)  // Moebius{f}(Y) = \\sum_{X \\subseteq Y} (-1)^{|Y\\X|} f(X)\n{\n    for (int i = 0; (1LL << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1LL << i) {\n                f[j] -= f[j ^ 1LL << i];\n            }\n        }\n    }\n    return f;\n}\n\nint main()\n{\n    int N;\n    cin >> N;\n    ll M;\n    cin >> M;\n    vector<ll> a(N);\n    vector<long double> p(N);\n    for (int i = 0; i < N; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < N; i++) {\n        cin >> p[i];\n        p[i] /= 100.0;\n    }\n\n    const int maximum = 1 << N;\n    vector<long double> ex(maximum, 1.0);\n    for (int i = 0; i < maximum; i++) {\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                ex[i] *= p[j];\n            }\n        }\n    }\n\n    ex[0] = 0;\n    for (int i = 1; i < maximum; i++) {\n        ll LCM = 1LL;\n        for (int j = 0; j < N; j++) {\n            if (i & (1 << j)) {\n                const ll g = gcd(LCM, a[j]);\n                const ll b = a[j] / g;\n                if (log2(LCM) + log2(b) < 63) {\n                    LCM *= b;\n                } else {\n                    ex[i] = 0;\n                    break;\n                }\n            }\n        }\n        ex[i] *= (M / LCM);\n    }\n    const vector<long double> ans = Moebius(ex);\n    cout << fixed << setprecision(30) << -ans[maximum - 1] << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<list>\n#include<deque>\n#include<bitset>\n#include<set>\n#include<map>\n#include<cstring>\n#include<sstream>\n#include<complex>\n#include<iomanip>\n#include<numeric>\n#define X first\n#define Y second\n#define pb push_back\n#define rep(X,Y) for (int (X) = 0;(X) < (Y);++(X))\n#define rrep(X,Y) for (int (X) = (Y-1);(X) >=0;--(X))\n#define repe(X,Y) for ((X) = 0;(X) < (Y);++(X))\n#define peat(X,Y) for (;(X) < (Y);++(X))\n#define all(X) (X).begin(),(X).end()\n#define rall(X) (X).rbegin(),(X).rend()\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"{\"; rep(i,t.size()) {os<<t[i]<<\",\";} os<<\"}\"<<endl; return os;}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nint main(){\n  ios_base::sync_with_stdio(false);\n  cout<<fixed<<setprecision(10);\n  int i,j,k;\n  int n;\n  ll m,gcd,lcm;\n  cin>>n>>m;\n  vector<ll> a(n);\n  vector<double> p(n);\n  rep(i,n)\n    cin>>a[i];\n  rep(i,n){\n    cin>>p[i];\n    p[i]/=100;\n  }//cout<<p;\n  double pro,cnt,re=0;\n  rep(i,1<<n)if(i){\n    pro=1,cnt=m;lcm=1;\n    rep(j,n){\n      if(i>>j&1){\n\tpro*=-p[j];\n\tgcd=__gcd(lcm,a[j]);\n\tcnt/=a[j]/gcd;\n\tif(cnt<1)\n\t  break;\n\tlcm*=a[j]/gcd;\n      }\n    }\n    //   cout<<pro<<\",\"<<cnt<<endl;\n    re+=pro*floor(cnt);\n  }\n  cout<<-re<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  while(y){\n    x %= y;\n    swap(x,y);\n  }\n  return x;\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<double> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i){\n    cin >> P[i];\n    P[i] /= 100.0;\n  }\n  double ans = 0;\n  vector<long long int> LCM;\n  vector<double> P_;\n  vector<int> C;\n  LCM.push_back(1);\n  P_.push_back(1.0);\n  C.push_back(0);\n  for(int i = 0; i < n; ++i){\n    long long int s = LCM.size();\n    for(long long int j = 0; j < s; ++j){\n      if(LCM[j]/gcd(LCM[j],A[i]) > m/A[i]) continue;\n      long long int t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = P_[j]*P[i];\n      int c = C[j] + 1;\n      if(c%2) ans += m/t*p;\n      else ans -= m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n      C.push_back(c);\n      //cout << t << \" \" << p << \" \" << c << endl;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<map>\n#include<set>\n#include<bitset>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)m ; i < (int) n ; i++ )\n#define rep(i,n) REP(i,0,n)\ntypedef long long ll;\ntypedef pair<int,int> pint;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<62 ;\nconst ll mod=1e9+7 ;\nint dx[4]={1,0,-1,0} , dy[4]={0,1,0,-1} ;\n\nll gcd(ll x,ll y){\n    if(x<y)swap(x,y);\n    if(x%y==0)return y;\n    else return gcd(y,x%y);\n}\n\nll lcm(ll x,ll y){\n    if(x>=longinf||y>=longinf||x<0||y<0)return -1;\n    ll g=gcd(x,y);\n    if(x/g<longinf/y) return x*y/g;\n    else return -1;\n}\nvector<ll> fast_mobius_transform(vector<ll> f) {\n    for (int i = 0; (1 << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1 << i) {\n                f[j] -= f[j ^ 1 << i];\n            }\n        }\n    }\n    return f;\n}\nll dp[1<<20];\nint main(){\n   int n;\n   cin>>n;\n   ll m;\n   cin>>m;\n   ll a[n];\n   rep(i,n)cin>>a[i];\n   int N=1<<n;\n   cout<<N<<endl;\n   dp[0]=1;\n   rep(i,N){\n       rep(j,n){\n           if(i&(1<<j)){\n               dp[i]=lcm(a[j],dp[i^(1<<j)]);\n               break;\n           }\n       }\n   }\n   vector<ll> v;\n   rep(i,N){\n       if(dp[i]<0)v.push_back(0);\n       else v.push_back(m/dp[i]);\n   }\n   v[0]=0;\n   v=fast_mobius_transform(v);\n   double ans=0;\n   double p[n];\n   rep(i,n){\n       cin>>p[i];\n       p[i]/=100;\n   }\n   rep(i,N){\n       double ret=1.0*abs(v[i]);\n       rep(j,n){\n           if(i&(1<<j))ret*=p[j];\n           else ret*=(1.0-p[j]);\n       }\n       ans+=ret;\n   }\n   cout<<fixed<<setprecision(12)<<ans<<endl;\n   return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\nusing ll = long long;\n\nll gcd(ll x, ll y){\n  if(x < y) swap(x,y);\n  while(y) x %= y, swap(x,y);\n  return x;\n}\n\nint main(){\n  ll n, m;\n  cin >> n >> m;\n  vector<ll> A(n);\n  vector<double> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i], P[i] /= 100.0;\n  double ans = 0;\n  vector<ll> LCM;\n  vector<double> P_;\n  LCM.push_back(1);\n  P_.push_back(-1.0);\n  for(int i = 0; i < n; ++i){\n    ll s = LCM.size();\n    for(ll j = 0; j < s; ++j){\n      if(LCM[j]/gcd(LCM[j],A[i]) > m/A[i]) continue;\n      ll t = LCM[j]/gcd(LCM[j],A[i])*A[i];\n      if(t > m) continue;\n      double p = -P_[j]*P[i];\n      ans += m/t*p;\n      LCM.push_back(t);\n      P_.push_back(p);\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define ALL(x) x.begin(),x.end()\n#define EPS (1e-9)\n#define equals(a,b) (fabs((a)-(b))<EPS)\n\nusing namespace std;\n\ntypedef long long ll;\nbool LTE(double a,double b) { return equals(a,b) || a < b; }\nbool LT(double a,double b) { return !equals(a,b) && a < b; }\n\n#define MAX 21\nint n;\nll m,a[MAX];\ndouble p[MAX];\ndouble PIE[1<<MAX];\nint bc[1<<MAX];\n\nvoid init_PIE() {\n  memset(PIE,-1,sizeof PIE);\n  PIE[0] = 0;\n  REP(i,1,(1<<n)) {\n    ll lcm = 1;\n    rep(j,n) if( (i>>j) & 1 ) {\n      lcm = lcm / __gcd(lcm,a[j]);\n      if( (double)lcm * (double)a[j] > 1e18 ) {\n\tlcm = m + 1;\n\tbreak;\n      }\n      lcm = lcm * a[j];\n    }\n    ll sign = ( ( bc[i] & 1 ) ? +1LL : -1LL );\n    PIE[i] = sign * (ll)( m / lcm );\n  }\n\n  rep(i,n) {\n    rep(j,(1<<n)) {\n      if( ((j>>i)&1) == 1 ) {\n\tPIE[j] += PIE[j^(1<<i)];\n      }\n    }\n  }\n}\n\nvoid compute() {\n  init_PIE();\n  double ans = 0;\n  REP(i,1,(1<<n)) {\n    double P = 1.0;\n    rep(j,n) {\n      if( (i>>j) & 1 ) {\n\tP *= p[j];\n      } else {\n\tP *= ( 1.0 - p[j] );\n      }\n    }\n    ans += ( (double)PIE[i] * P );\n  }\n  printf(\"%.10lf\\n\",ans);\n}\n\nint main() {\n  rep(i,(1<<MAX)) bc[i] = __builtin_popcount(i);\n  cin >> n >> m;\n  rep(i,n) cin >> a[i];\n  rep(i,n) {\n    cin >> p[i];\n    p[i] = p[i] / 100.0;\n  }\n  compute();\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nlong double dp[2 << 20][2], prev_[2 << 20][2];\nlong long n, m, a[22]; long double p[22];\n\nlong long gcd(long long a1, long long b1) {\n\tif (b1 == 0) return a1;\n\treturn gcd(b1, a1%b1);\n}\n\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) { cin >> p[i]; p[i] *= 0.01; }\n\tprev_[0][0] = 1;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t// パターン 1 : 何も取らない\n\t\t\tdp[j][0] += prev_[j][0] * (1.0L - p[i]);\n\t\t\tdp[j][1] += prev_[j][1] * (1.0L - p[i]);\n\n\t\t\t// パターン 2 : 取るが包除はしない\n\t\t\tdp[j][0] += prev_[j][0] * p[i];\n\t\t\tdp[j][1] += prev_[j][1] * p[i];\n\n\t\t\t// パターン 3 : 取って包除もする\n\t\t\tdp[j + (1 << i)][1] += prev_[j][0] * p[i];\n\t\t\tdp[j + (1 << i)][0] += prev_[j][1] * p[i];\n\t\t}\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tprev_[j][0] = dp[j][0]; dp[j][0] = 0;\n\t\t\tprev_[j][1] = dp[j][1]; dp[j][1] = 0;\n\t\t}\n\t}\n\tlong double ans = 0;\n\tfor (int i = 1; i < (1 << n); i++) {\n\t\tlong long F = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif ((i / (1 << j)) % 2 == 0) continue;\n\t\t\tlong long G = gcd(F, a[j]);\n\t\t\tif (log2(1.0L*F) + log2(1.0L*a[j]) - log2(1.0L*G) >= 60) { F = (1LL << 60); break; }\n\t\t\tF = F / G * a[j];\n\t\t}\n\t\tlong long A = m / F;\n\t\tans -= 1.0L*A*prev_[i][0];\n\t\tans += 1.0L*A*prev_[i][1];\n\t}\n\tprintf(\"%.12Lf\\n\", ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#define llint long long\n\nusing namespace std;\n\nllint n, m;\nllint a[25], p[25];\ndouble pro[1<<20];\nllint num[1<<20], num2[1<<20]; \n\nvoid moebius_transform(llint a[], int n)\n{\n\tint S = 1<<n;\n\tfor(int i = 0; i < n; i++){\n\t\tfor(int j = 0; j < S; j++){\n\t\t\tif(!(j&(1<<i))) a[j] -= a[j^(1<<i)];\n\t\t}\n\t}\n}\n\nvoid zeta_transform(llint a[], int n)\n{\n\tint S = 1<<n;\n\tfor(int i = 0; i < n; i++){\n\t\tfor(int j = 0; j < S; j++){\n\t\t\tif(!(j&(1<<i))) a[j] += a[j^(1<<i)];\n\t\t}\n\t}\n}\n\nllint gcd(llint a, llint b)\n{\n\tif(b == 0) return a;\n\treturn gcd(b, a%b);\n}\n\nllint lcm(llint a, llint b)\n{\n\tllint ret = a / gcd(a, b);\n\tif(ret >= m / b + 1) return m+1;\n\treturn ret*b;\n}\n\nint main(void)\n{\n\tcin >> n >> m;\n\tfor(int i = 0; i < n; i++) cin >> a[i];\n\tfor(int i = 0; i < n; i++) cin >> p[i];\n\t\n\tllint S = 1<<n;\n\tfor(int i = 0; i < S; i++){\n\t\tllint l = 1;\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tl = lcm(l, a[j]);\n\t\t\t}\n\t\t}\n\t\tnum[i] = m / l;\n\t}\n\tmoebius_transform(num, n);\n\t\n\tfor(int i = 0; i < S; i++) num2[i] = num[i^(S-1)];\n\tzeta_transform(num2, n);\n\tfor(int i = 0; i < S; i++) num[i] = m - num2[i];\n\t\n\tfor(int i = 0; i < S; i++){\n\t\tdouble mul = 1;\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tif(i&(1<<j)) mul *= p[j]/100.0;\n\t\t\telse mul *= (100-p[j])/100.0;\n\t\t}\n\t\tpro[i] = mul;\n\t}\n\t\n\tdouble ans = 0;\n\tfor(int i = 0; i < S; i++) ans += pro[i] * num[i];\n\tprintf(\"%.11f\\n\", ans);\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nll cnt[(1<<20)+5],m,num[25];\nint n;\nlong double p[25];\nint main(){\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> num[i];\n\tfor(int i=0;i<n;i++){\n\t\tcin >> p[i]; p[i]/=100.;\n\t}\n\tfor(int i=1;i<(1<<n);i++){\n\t\tll N = 1LL; int B = __builtin_popcount(i);\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(!((i>>j)&1)) continue;\n\t\t\tif(8000000000000000000LL/N < num[j]) goto fail;\n\t\t\tN *= num[j];\n\t\t}\n\t\tif(B%2==1) cnt[i] = m/N;\n\t\telse cnt[i] = -1*(m/N); fail:;\n\t}\n\tfor(int i=0;i<n;i++) for(int j=0;j<(1<<n);j++){\n\t\tif(((j>>i)&1)) cnt[j] += cnt[j^(1<<i)];\n\t}\n\tlong double ans = 0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tlong double prob = 1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(((i>>j)&1)) prob *= p[j];\n\t\t\telse prob *= 1.0-p[j];\n\t\t}\n\t\tans += prob * (long double)cnt[i]; //cout << cnt[i] << \" \" << i << endl;\n\t}\n\tcout << setprecision(100) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(0);\n  Int n,m;\n  cin>>n>>m;\n  vector<Int> a(n),p(n);\n  for(Int i=0;i<n;i++) cin>>a[i];\n  for(Int i=0;i<n;i++) cin>>p[i];\n  vector<Int> dp(1<<n,0);\n  for(Int b=0;b<(1<<n);b++){\n    Int t=1;\n    for(Int i=0;i<n;i++){\n      if((b>>i)&1){\n\tInt k=a[i]/__gcd(t,a[i]);\n\tt=(t<=m/k?t*k:m+1);\n      }\n    }\n    dp[b]=m/t;\n  }\n      \n  for(Int i=0;i<n;i++)\n    for(Int b=0;b<(1<<n);b++)\n      if((b>>i)&1) dp[b]-=dp[b^(1<<i)];\n  \n  double ans=0;\n  for(Int b=0;b<(1<<n);b++){\n    double po=1;\n    for(Int i=0;i<n;i++)\n      if((b>>i)&1) po*=p[i]/100.0;\n      else po*=1.0-(p[i]/100.0);\n    ans+=po*(m-abs(dp[b]));\n  }\n  cout<<fixed<<setprecision(12)<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// includes\n#include <bits/stdc++.h>\n\n// macros\n#define ll long long int\n#define pb emplace_back\n#define mk make_pair\n#define pq priority_queue\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define rep(i, n) FOR(i, 0, n)\n#define rrep(i, n) for(int i=((int)(n)-1);i>=0;i--)\n#define all(x) (x).begin(),(x).end()\n#define sz(x) ((int)(x).size())\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end())\n#define FI first\n#define SE second\nusing namespace std;\n\n//  types\ntypedef pair<int, int> P;\ntypedef pair<ll, int> Pl;\ntypedef pair<ll, ll> Pll;\ntypedef pair<double, double> Pd;\n \n// constants\nconst int inf = 1e9;\nconst ll linf = 1LL << 50;\nconst double EPS = 1e-10;\nconst int mod = 1e9 + 7;\n\n// solve\ntemplate <class T>bool chmax(T &a, const T &b){if(a < b){a = b; return 1;} return 0;}\ntemplate <class T>bool chmin(T &a, const T &b){if(a > b){a = b; return 1;} return 0;}\ntemplate <typename T> istream &operator>>(istream &is, vector<T> &vec){for(auto &v: vec)is >> v; return is;}\n\n/*\n * f(U) = \\sum_{U\\in T}(-1)^(|T\\U|)f(T)\n * for f(U) = \\sum_{U\\in T}f(T), use f[j | i] -= f[j];\n */\ntemplate <typename T>\nvoid fast_moebius(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j | i] -= f[j];\n      }\n    }\n  }\n}\n\nostream& operator<<(ostream& dest, __int128_t value) {\n  ostream::sentry s(dest);\n  if(s){\n    __uint128_t tmp = value < 0 ? - value: value;\n    char buf[128];\n    char *d = end(buf);\n    do{\n      --d;\n      *d = \"0123456789\"[tmp % 10];\n      tmp /= 10;\n    }while(tmp != 0);\n    if(value < 0)--d, *d='-';\n    int len = end(buf) - d;\n    if(dest.rdbuf()->sputn(d, len) != len){\n      dest.setstate(ios_base::badbit);\n    }\n  }\n  return dest;\n}\n\n__int128_t to_int128(string s){\n  __int128_t res = 0;\n  for(int i = 0; i < s.size(); i++){\n    res = res * 10 + (s[i] - '0');\n  }\n  return res;\n}\n\nusing uint128 = __int128_t;\n\ntemplate<typename T>\nT gcd(T a, T b) {\n  if(a > b)return gcd(b, a);\n  if(a == 0)return b;\n  return gcd(b % a, a);\n}\n\nint main(int argc, char const* argv[])\n{\n  ios_base::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  ll m;\n  cin >> n >> m;\n  vector<ll> a(n);\n  vector<int> p(n);\n  cin >> a >> p;\n  double res = 0.;\n  vector<ll> f((1 << n), 0);\n  vector<double> pr((1 << n), 0.);\n  for(int i = 0; i < (1 << n); i++){\n    uint128 tmp = 1;\n    double ptmp = 1.;\n    bool ng = false;\n    if(tmp > m){\n      ng = true;\n      tmp = m + 1;\n    }\n    for(int j = 0; j < n; j++){\n      if((i >> j) % 2 == 1){\n        if(!ng)tmp = tmp * (a[j] / gcd(tmp, uint128(a[j])));\n        if(tmp > m){\n          ng = true;\n          tmp = m + 1;\n        }\n        ptmp *= (double)p[j] / 100.;\n      }else ptmp *= (1. - (double)p[j] / 100.);\n    }\n    if(i == 0)tmp = m + 1;\n    if(ng)tmp = m + 1;\n    f[i] = (tmp > 0 ? m / tmp: 0);\n    pr[i] = ptmp;\n  }\n  fast_moebius(f);\n  //for(int i = 0; i < (1 << n); i++)cout << i << \" \" << f[i] << endl;\n  for(int i = 0; i < (1 << n); i++)res += pr[i] * (double)(abs(f[i]));\n  cout << setprecision(20);\n  cout << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b) return MA;\n\treturn a*b;\n}\n\nlong long num[1<<20];\ndouble pr[1<<20];\n\nlong long a[20];\ndouble p[20];\n\nint main(){\n\tint N,M;\n\tscanf(\"%d%d\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tdouble tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e16\n#define mod 1000000007\n\nll n,m;\nll a[22],p[22];\nll f[1<<20];\n\nint main(){\n  cin>>n>>m;\n  rep(i,n)cin>>a[i];\n  rep(i,n)cin>>p[i];\n  rep(i,1<<n){\n    ll lcm=1;\n    rep(j,n){\n      if(!((i>>j)&1))continue;\n      ll g=__gcd(a[j],lcm);\n      ll rest=a[j]/g;\n      if(rest>9e18/lcm){\n        lcm=m+1;\n        break;\n      }else lcm*=rest;\n    }\n    f[i]=m/lcm;\n  }\n  rep(i,n){\n    rep(j,1<<n){\n      if(j&1<<i)f[j]-=f[j^1<<i];\n    }\n  }\n  double res=0;\n  rep(i,1<<n){\n    double prob=1;\n    rep(j,n){\n      if(!((i>>j)&1)) prob*=(double)(100-p[j])/100.0;\n      else prob*=(double)p[j]/100.0;\n    }\n\n    res+=(m-abs(f[i]))*prob;\n  }\n  printf(\"%.10f\\n\", res);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "import java.math.BigDecimal;\nimport java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\tBigDecimal[] p = new BigDecimal[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100), mc);\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tBigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tpro = pro.multiply(p[j], mc);\n\t\t\t\t} else {\n\t\t\t\t\tpro = pro.multiply(BigDecimal.ONE.subtract(p[j], mc), mc);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = ans.add(pro, mc);\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<map>\n#include<set>\n#include<bitset>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)m ; i < (int) n ; i++ )\n#define rep(i,n) REP(i,0,n)\ntypedef long long ll;\ntypedef pair<int,int> pint;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<62 ;\nconst ll mod=1e9+7 ;\nint dx[4]={1,0,-1,0} , dy[4]={0,1,0,-1} ;\n\nll gcd(ll x,ll y){\n    if(x<y)swap(x,y);\n    if(x%y==0)return y;\n    else return gcd(y,x%y);\n}\n\nll lcm(ll x,ll y){\n    if(x>=longinf||y>=longinf||x<0||y<0)return -1;\n    ll g=gcd(x,y);\n    if(x/g<longinf/y) return x*y/g;\n    else return -1;\n}\nvector<ll> fast_mobius_transform(vector<ll> f) {\n    for (int i = 0; (1 << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1 << i) {\n                f[j] -= f[j ^ 1 << i];\n            }\n        }\n    }\n    return f;\n}\nll dp[1<<20];\nint main(){\n   int n;\n   cin>>n;\n   ll m;\n   cin>>m;\n   ll a[n];\n   rep(i,n)cin>>a[i];\n   int N=1<<n;\n   dp[0]=1;\n   rep(i,N){\n       rep(j,n){\n           if(i&(1<<j)){\n               dp[i]=lcm(a[j],dp[i^(1<<j)]);\n               break;\n           }\n       }\n   }\n   vector<ll> v;\n   rep(i,N){\n       if(dp[i]<0)v.push_back(0);\n       else v.push_back(m/dp[i]);\n   }\n   v[0]=0;\n   v=fast_mobius_transform(v);\n   double ans=0;\n   double p[n];\n   rep(i,n){\n       cin>>p[i];\n       p[i]/=100;\n   }\n   rep(i,N){\n       double ret=1.0*abs(v[i]);\n       rep(j,n){\n           if(i&(1<<j))ret*=p[j];\n           else ret*=(1.0-p[j]);\n       }\n       ans+=ret;\n   }\n   cout<<fixed<<setprecision(12)<<ans<<endl;\n   return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<map>\n#include<set>\n#include<bitset>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)m ; i < (int) n ; i++ )\n#define rep(i,n) REP(i,0,n)\ntypedef long long ll;\ntypedef pair<int,int> pint;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<62 ;\nconst ll mod=1e9+7 ;\nint dx[4]={1,0,-1,0} , dy[4]={0,1,0,-1} ;\n\nll gcd(ll x,ll y){\n    if(x<y)swap(x,y);\n    if(x%y==0)return y;\n    else return gcd(y,x%y);\n}\n\nll lcm(ll x,ll y){\n    if(x>=longinf||y>=longinf||x<0||y<0)return -1;\n    ll g=gcd(x,y);\n    if(x/g<longinf/y) return x*(y/g);\n    else return -1;\n}\nvector<ll> fast_mobius_transform(vector<ll> f) {\n    for (int i = 0; (1 << i) < f.size(); i++) {\n        for (int j = 0; j < f.size(); j++) {\n            if (j & 1 << i) {\n                f[j] -= f[j ^ 1 << i];\n            }\n        }\n    }\n    return f;\n}\nll dp[1<<20];\nint main(){\n   int n;\n   cin>>n;\n   ll m;\n   cin>>m;\n   ll a[n];\n   rep(i,n)cin>>a[i];\n   int N=1<<n;\n   dp[0]=1;\n   rep(i,N){\n       rep(j,n){\n           if(i&(1<<j)){\n               dp[i]=lcm(a[j],dp[i^(1<<j)]);\n               break;\n           }\n       }\n   }\n   vector<ll> v;\n   rep(i,N){\n       if(dp[i]<0)v.push_back(0);\n       else v.push_back(m/dp[i]);\n   }\n   v[0]=0;\n   v=fast_mobius_transform(v);\n   double ans=0;\n   double p[n];\n   rep(i,n){\n       cin>>p[i];\n       p[i]/=100;\n   }\n   rep(i,N){\n       double ret=1.0*abs(v[i]);\n       rep(j,n){\n           if(i&(1<<j))ret*=p[j];\n           else ret*=(1.0-p[j]);\n       }\n       ans+=ret;\n   }\n   cout<<fixed<<setprecision(12)<<ans<<endl;\n   return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint n;\nll m;\nll a[20];\ndouble P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\treturn a / g * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tdouble p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts *= a[v[i]];\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <list>\n#include <cmath>\n#include <fstream>\n#include <algorithm>\n#include <string>\n#include <queue>\n#include <set>\n#include <map>\n#include <complex>\n#include <iterator>\n#include <cstdlib>\n#include <cstring>\n#include <sstream>\n#include <stack>\n#include <climits>\n#include <deque>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> pii;\ndouble EPS=1e-10;\ndouble EQ(double a,double b){\n  return abs(a-b)<EPS;\n}\nvoid fast_stream(){\n  cin.tie(0);\n  std::ios_base::sync_with_stdio(0);\n}\ntemplate<class T>\nstring IntToString(T num){\n  string res;stringstream ss;ss<<num;\n  return ss.str();\n}\nll StringToInt(string &str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    res=(res*10+str[i]-'0');\n  return res;\n}\nint N;\nll M;\nll as[101];\ndouble ps[101];\n\nll gcd(ll a,ll b){\n  if(b==0)return a;\n  return gcd(b,a%b);\n}\nll lcm(ll a,ll b){\n  return a/gcd(a,b)*b;\n}\nlong double lcm2(ll a,ll b){\n  return 1.0*a*b/gcd(a,b);\n}\n\nint main(){\n  cin>>N>>M;\n  for(int i=0;i<N;i++)cin>>as[i];\n  for(int i=0;i<N;i++){\n    cin>>ps[i];\n    ps[i]/=100;\n  }\n  double res=0;\n  for(int i=1;i<(1<<N);i++){\n    double per=1;\n    int bitCnt=__builtin_popcount(i);\n    ll m=1;\n    for(int j=0;j<N;j++){\n      if((i>>j)&1){\n        // Mを超えたらfin\n        double d=lcm2(m,as[j]);\n        if(lcm2(m,as[j])>M){\n          m=M+1;\n          break;\n        }\n        m=lcm(m,as[j]);\n        per*=ps[j];\n      }\n    }\n    if(!(bitCnt%2))res-=per*(M/m);\n    else res+=per*(M/m);\n  }\n  printf(\"%.10f\\n\",res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1000000000000000000LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nll gcd(ll x,ll y){\n\tif(y==0)return x;\n\treturn gcd(y,x%y);\n}\n\nll mul(ll x,ll y){\n\tll res=0;\n\twhile(y>0LL){\n\t\tif(res+x>INF)return INF+1LL;\n\t\tif(y&1LL)res+=x;\n\t\tx+=x;\n\t\ty>>=1LL;\n\t}\n\treturn res;\n}\n\nll lcm(ll x,ll y){\n\treturn mul(x/gcd(x,y),y);\n}\n\n\nint n;\nll m;\nll a[21];\ndouble p[21];\ndouble pos[1<<20];\nll val[1<<20];\nvector<ll> vec;\n\nint main(void){\n\tscanf(\"%d%lld\",&n,&m);\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%lld\",&a[i]);\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tint b;\n\t\tscanf(\"%d\",&b);\n\t\tp[i]=(double)b/100.0;\n\t}\n\tfor(int i=0;i<(1<<n);i++){\n\t\tll v=0;\n\t\tdouble po=1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(i>>j & 1){\n\t\t\t\tif(v==0)v=a[j];\n\t\t\t\telse v=lcm(v,a[j]);\n\t\t\t\tpo*=p[j];\n\t\t\t}else{\n\t\t\t}\n\t\t}\n\t\tvec.push_back(v);\n\t\tval[i]=v;\n\t\tpos[i]=po;\n\t}\n\tsort(vec.begin(),vec.end());\n\tvec.erase(unique(vec.begin(),vec.end()),vec.end());\n\tdouble ans=0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tint vi=lower_bound(vec.begin(),vec.end(),val[i])-vec.begin();\n\t\tll cnt=m/val[i];\n\t\tif(__builtin_popcount(i)%2==1)ans+=cnt*pos[i];\n\t\telse{\n\t\t\tans-=cnt*pos[i];\n\t\t}\n\t}\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\n\n#define INF 1LL<<60\nint N; ll M; ll A[20]; int P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) cin >> P[i];\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 0, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)){\n            if (lc == INF) break;\n            lc = lcm(lc, A[i]);\n            if (lc < A[i]) lc = INF;\n        }\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    double ans = 0;\n    rep(mask, 0, 1 << N) {\n        double p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= (double)P[i] / 100.0;\n            else p *= (double)(100 - P[i]) / 100.0;\n        }\n\n        ans += (double)(M - abs(f[mask])) * p;\n    }\n    printf(\"%.10f\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(0);\n  Int n,m;\n  cin>>n>>m;\n  vector<Int> a(n),p(n);\n  for(Int i=0;i<n;i++) cin>>a[i];\n  for(Int i=0;i<n;i++) cin>>p[i];\n  vector<Int> dp(1<<n,0);\n  for(Int b=0;b<(1<<n);b++){\n    Int t=1;\n    for(Int i=0;i<n;i++){\n      Int k=a[i]/__gcd(t,a[i]);\n      if((b>>i)&1) t=(t<=m/k?t*k:m+1);\n    }\n    dp[b]=m/t;\n  }\n      \n  for(Int i=0;i<n;i++)\n    for(Int b=0;b<(1<<n);b++)\n      if((b>>i)&1) dp[b]-=dp[b^(1<<i)];\n  \n  double ans=0;\n  for(Int b=0;b<(1<<n);b++){\n    double po=1;\n    for(Int i=0;i<n;i++)\n      if((b>>i)&1) po*=p[i]/100.0;\n      else po*=1.0-(p[i]/100.0);\n    ans+=po*(m-abs(dp[b]));\n  }\n  cout<<fixed<<setprecision(12)<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double D;\n#define INF 2000000000000000000\nll n,m,a[20],z[1<<20];\nD p[20],ans;\nll gcd(ll x,ll y){\n\tif(x%y==0)return y;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tx/=gcd(max(x,y),min(x,y));\n\tif(x>INF/y)return INF;\n\treturn x*y;\n}\nint main(void){ \n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=0;i<n;i++)scanf(\"%lld\",a+i);\n\tfor(int i=0;i<n;i++){\n\t\tD x;\n\t\tscanf(\"%lf\",&x);\n\t\tp[i]=x/100;\n\t}\n\tfor(int k=1;k<1<<n;k++){\n\t\tll s=1,w=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tif(k>>i&1){\n\t\t\t\tw++;\n\t\t\t\ts=lcm(s,a[i]);\n\t\t\t}\n\t\t}\n\t\tif(w%2)z[k]=m/s;\n\t\telse z[k]=-m/s;\n\t}\n\tfor(int i=0;i<n;i++)for(int k=0;k<1<<n;k++)if(k>>i&1)z[k]+=z[k^(1<<i)];\n\tfor(int k=1;k<1<<n;k++){\n\t\tD o=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tif(k>>i&1)o*=p[i];\n\t\t\telse o*=(1-p[i]);\n\t\t}\n\t\tans+=o*D(z[k]);\n\t}\n\tprintf(\"%.8lf\\n\",ans);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define lint long long\n#define pii pair<int,int>\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(c) (c).begin(),(c).end()\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n#define MINF(a) memset(a,0x3f,sizeof(a))\n#define POW(n) (1LL<<(n))\n#define POPCNT(n) (__builtin_popcount(n))\n#define IN(i,a,b) (a <= i && i <= b)\nusing namespace std;\ntemplate <typename T> inline bool CHMIN(T& a,T b) { if(a>b) { a=b; return 1; } return 0; }\ntemplate <typename T> inline bool CHMAX(T& a,T b) { if(a<b) { a=b; return 1; } return 0; }\ntemplate <typename T> inline void SORT(T& a) { sort(ALL(a)); }\ntemplate <typename T> inline void REV(T& a) { reverse(ALL(a)); }\ntemplate <typename T> inline void UNI(T& a) { sort(ALL(a)); a.erase(unique(ALL(a)),a.end()); }\ntemplate <typename T> inline T LB(vector<T>& v, T a) { return *lower_bound(ALL(v),a); }\ntemplate <typename T> inline int LBP(vector<T>& v, T a) { return lower_bound(ALL(v),a) - v.begin(); }\ntemplate <typename T> inline T UB(vector<T>& v, T a) { return *upper_bound(ALL(v),a); }\ntemplate <typename T> inline int UBP(vector<T>& v, T a) { return upper_bound(ALL(v),a) - v.begin(); }\ntemplate <typename T1, typename T2> ostream& operator<< (ostream& os, const pair<T1,T2>& p) { os << p.first << \" \" << p.second; return os; }\ntemplate <typename T1, typename T2> istream& operator>> (istream& is, pair<T1,T2>& p) { is >> p.first >> p.second; return is; }\ntemplate <typename T> ostream& operator<< (ostream& os, const vector<T>& v) { REP(i,v.size()) { if (i) os << \" \"; os << v[i]; } return os; }\ntemplate <typename T> istream& operator>> (istream& is, vector<T>& v) { for(T& in : v) is >> in; return is; }\ntemplate <typename T = int> vector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate <typename T, typename... Ts> auto make_v(size_t a, Ts... ts) { return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...)); }\ntemplate <typename T, typename V> typename enable_if<is_class<T>::value == 0>::type fill_v(T &t, const V &v) { t = v; }\ntemplate <typename T, typename V> typename enable_if<is_class<T>::value != 0>::type fill_v(T &t, const V &v) { for(auto &e : t) fill_v(e,v); }\nconst lint MOD = 1000000007;\nconst lint INF = 0x3f3f3f3f3f3f3f3f;\nconst double EPS = 1e-10;\n\nlong long gcd(long long a, long long b) {\n    while (b) {\n        long long c = a % b;\n        a = b;\n        b = c;\n    }\n    return a;\n}\n\nconst long long LIMIT = 1LL << 60;  // オーバーフローの閾値\n\nlong long mul(long long a, long long b) {\n    if (a == LIMIT || b == LIMIT) return LIMIT;\n    int res = 0;\n    while (b > 0) {\n        if (b & 1) res += a;\n        if (res > LIMIT) return LIMIT;\n        a += a;\n        b >>= 1;\n    }\n    return res;\n}\n\nlong long lcm_overflow(long long a, long long b) {\n    if (a == LIMIT || b == LIMIT) return LIMIT;\n    return mul(a / gcd(a, b), b);\n}\n\nint n, m;\nint a[20], p[20];\nint V[POW(20)];\n\nvoid _main() {\n    cin >> n >> m;\n    REP(i, n) cin >> a[i];\n    REP(i, n) cin >> p[i];\n    FOR(bit, 1, POW(n)) {\n        int mul = 1;\n        REP(i, n) {\n            if (bit >> i & 1)\n                mul = lcm_overflow(mul, a[i]);\n        }\n        V[bit] = m / mul;\n    }\n\n    REP(i, n) REP(bit, POW(n)) {\n        if (bit >> i & 1)\n            V[bit] -= V[bit ^ (1 << i)];\n    }\n    long double ans = 0;\n    REP(bit, POW(n)) {\n        long double prob = 1.0;\n        REP(i, n) {\n            prob *= (bit >> i & 1 ? p[i] : 100 - p[i]) / 100.0;\n        }\n        ans += prob * abs(V[bit]);\n    }\n    cout << ans << endl;\n}\n\nsigned main(signed argc, char **argv) {\n    if (argc > 1) {\n        if (strchr(argv[1], 'i'))\n            freopen(\"input.txt\", \"r\", stdin);\n        if (strchr(argv[1], 'o'))\n            freopen(\"output.txt\", \"w\", stdout);\n    }\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n    _main();\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  cin.tie(nullptr);\n  ios::sync_with_stdio(false);\n  cout << fixed << setprecision(20);\n  int n;\n  long long m;\n  cin >> n >> m;\n  vector<long long> a(n);\n  for (auto&& e : a) {\n    cin >> e;\n  }\n  vector<double> p(n);\n  for (auto&& e : p) {\n    cin >> e;\n    e /= 100;\n  }\n  vector<long long> c(1 << n);\n  for (int bt = 0; bt < 1 << n; ++bt) {\n    long long l = 1;\n    for (int i = 0; i < n; ++i) {\n      if (bt >> i & 1) {\n        if (l / __gcd(l, a[i]) > m / a[i] + 1) {\n          l = m + 1;\n          break;\n        }\n        l = l / __gcd(l, a[i]) * a[i];\n      }\n    }\n    c[bt] = m / l;\n  }\n  for (int i = 0; i < n; ++i) {\n    for (int bt = 0; bt < 1 << n; ++bt) {\n      if (bt >> i & 1) {\n        c[bt] -= c[bt ^ 1 << i];\n      }\n    }\n  }\n  double res = 0;\n  for (int bt = 0; bt < 1 << n; ++bt) {\n    double pp = 1;\n    for (int i = 0; i < n; ++i) {\n      if (bt >> i & 1) {\n        pp *= p[i];\n      } else {\n        pp *= 1 - p[i];\n      }\n    }\n    if (__builtin_parity(bt)) {\n      res += pp * (m + c[bt]);\n    } else {\n      res += pp * (m - c[bt]);\n    }\n  }\n  cout << res << '\\n';\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long c=a;\n\t\ta=b;\n\t\tb=c;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j))GCD=gcd(GCD,c[j]);\n\t\t}\n\t\tlong long v=b/GCD;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))v/=c[j]/GCD;\n\t\tdp[i]=v;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tlong double ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\t//printf(\"%lld \",dp[i]);\n\t\tlong double p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%.9f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i, a, b) for(int i = a; i < b; i++)\n#define rrep(i, a, b) for(int i = b - 1; i >= a; i--)\n#define ALL(a) a.begin(), a.end()\n#define pii pair<int,int>\n#pragma GCC optimize(\"Ofast\")\n#define pcnt __builtin_popcount\n#define buli(x) __builtin_popcountll(x)\n#define pb push_back\n#define mp make_pair\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n#define isSquare(x) (sqrt(x)*sqrt(x) == x)\ntemplate<class T>bool chmax(T &a, const T &b) {if(a<b){a = b; return 1;} return 0; };\ntemplate<class T>bool chmin(T &a, const T &b) {if(a>b){a = b; return 1;} return 0; };\ninline void IN(void){return;}\ntemplate <typename First, typename... Rest> void IN(First& first, Rest&... rest){cin >> first;IN(rest...);return;}\ninline void OUT(void){cout << \"\\n\";return;}\ntemplate <typename First, typename... Rest> void OUT(First first, Rest... rest){cout << first << \" \";OUT(rest...);return;}\nconst double EPS = 1e-9;\nconst int mod = 1e9 + 7;\nconst int INF = 1e9;\nconst long long LLINF = 1e18;\n// long long lcm(ll a, ll b){return a * b / __gcd(a,b);}\nstruct IoSetup { IoSetup() {\n    cin.tie(nullptr);ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n    cerr << fixed << setprecision(10);\n} } iosetup;\ntemplate< int mod > struct ModInt {\n    int x; ModInt() : x(0) {}\n    ModInt(int64_t y) : x(y >= 0 ? y % mod : (mod - (-y) % mod) % mod) {}\n    ModInt &operator+=(const ModInt &p) {if((x += p.x) >= mod) x -= mod;return *this;}\n    ModInt &operator-=(const ModInt &p) {if((x += mod - p.x) >= mod) x -= mod;return *this;}\n    ModInt &operator*=(const ModInt &p) {x = (int) (1LL * x * p.x % mod);return *this;}\n    ModInt &operator/=(const ModInt &p) {*this *= p.inverse();return *this;}\n    ModInt operator-() const { return ModInt(-x); }\n    ModInt operator+(const ModInt &p) const { return ModInt(*this) += p; }\n    ModInt operator-(const ModInt &p) const { return ModInt(*this) -= p; }\n    ModInt operator*(const ModInt &p) const { return ModInt(*this) *= p; }\n    ModInt operator/(const ModInt &p) const { return ModInt(*this) /= p; }\n    bool operator==(const ModInt &p) const { return x == p.x; }\n    bool operator!=(const ModInt &p) const { return x != p.x; }\n    ModInt inverse() const {int a = x, b = mod, u = 1, v = 0, t;\n    while(b > 0) { t = a / b; swap(a -= t * b, b); swap(u -= t * v, v); }return ModInt(u);}\n    ModInt pow(int64_t n) const {ModInt ret(1), mul(x); while(n > 0) {if(n & 1) ret *= mul;mul *= mul;n >>= 1;}return ret;}\n    friend ostream &operator<<(ostream &os, const ModInt &p) { return os << p.x;}\n    friend istream &operator>>(istream &is, ModInt &a) { int64_t t; is >> t; a = ModInt< mod >(t); return (is); }\n    static int get_mod() { return mod; }\n}; using modint = ModInt< mod >;\nconst int dx[4] = {1, 0, -1, 0};\nconst int dy[4] = {0, 1, 0, -1};\n\nconst int MAX = 20;\nll dp[1 << MAX];\n\nll lcm(ll a, ll b){\n    return (ll)min(2e18l + 10, a / __gcd(a, b) * 1.0l * b);\n}\n\nint main(){\n    iosetup;\n    ll n, m; cin >> n >> m;\n    vector<ll> a(n), p(n);\n    rep(i, 0, n) cin >> a[i];\n    rep(i, 0, n) cin >> p[i];\n    // cerr << \"yes\" << endl;\n    dp[0] = 0;\n    rep(bit, 1, (1 << n)){\n        ll mul = 1;\n        rep(i, 0, n) if(bit >> i & 1) mul = lcm(mul, a[i]);\n        dp[bit] = m / mul;\n    }\n    // cerr << \"yes\" << endl;\n    for(int i = 0; i < n; i++) for(int bit = 0; bit < ( 1 << n); bit++){\n        if(bit >> i & 1) dp[bit] -= dp[bit ^ (1 << i)];\n    }\n    double ans = 0;\n    rep(bit, 0, (1 << n)){\n        double tp = 1;\n        rep(i, 0, n){\n            if(bit >> i & 1) tp *= (double)p[i] / 100.0;\n            else tp *= (100 - p[i]) / 100.0;\n        }\n        // cerr << tp << endl;\n        ans += tp * abs(dp[bit]);\n    }\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\ntemplate<class T> T gcd(T a,T b){ return b ? gcd(b,a % b) : a; }\ntemplate<class T> T lcm(T a,T b){ return a / gcd(a,b) * b; }\n\nsigned main(){\n\tint n,m,a[25];\n\tdouble p[25],ans = 0;\n\tcin >> n >> m;\n\tfor(int i = 0;i < n;i++) cin >> a[i];\n\tfor(int i = 0;i < n;i++){\n\t\tcin >> p[i]; p[i] /= 100;\n\t}\n\tfor(int i = 1;i < (1 << n);i++){\n\t\tint l = 1;\n\t\tdouble q = -1;\n\t\tfor(int j = 0;j < n;j++){\n\t\t\tif(i >> j & 1){\n\t\t\t\tif(l / gcd(l,a[j]) > m / a[j]){\n\t\t\t\t\tq = 0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tl = lcm(l,a[j]);\n\t\t\t\tq *= -p[j];\n\t\t\t}\n\t\t}\n\t\tans += (int)(m / l) * q;\n\t}\n\tprintf(\"%.15lf\\n\",ans);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\nusing namespace std;\ntypedef long long int llint;\ntypedef long double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n//cout<<setprecision(20)\nconst llint mod=1000000007;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>void mineq(T& a,U b){if(a>b){a=b;}}\ntemplate <class T,class U>void maxeq(T& a,U b){if(a<b){a=b;}}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\nint LBI(vector<llint>&ar,llint in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint UBI(vector<llint>&ar,llint in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint main(void){\n\tllint n,m,i;cin>>n>>m;\n\t//包除\n\tlldo ans=0;\n\tllint aa[20]={0};\n\tlldo pp[20]={0};\n\tfor(i=0;i<n;i++){cin>>aa[i];}\n\tfor(i=0;i<n;i++){cin>>pp[i];pp[i]/=100;}\n\tfor(int bi=1;bi<(1<<n);bi++){\n\t\tllint gen=1;\n\t\tlldo per=1;\n\t\tbool ok=true;\n\t\tint guki=0;\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(!(bi&(1<<i))){continue;}\n\t\t\tguki++;\n\t\t\tper*=pp[i];\n\t\t\tllint gc=gcd(gen,aa[i]);\n\t\t\tif(((lldo)gen/gc *aa[i])>2e18){ok=false;break;}\n\t\t\tgen=gen/gc *aa[i];\n\t\t}\n\t\tif(!ok){continue;}\n\t\tllint num=m/gen;\n\t\tif(guki%2==1){ans+=per*num;}\n\t\telse{ans-=per*num;}\n\t}\n\tcout<<setprecision(20)<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nint n;\nll m;\nll a[20];\nlong double P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nint keta(ll v) {\n\tint ret = 0;\n\twhile (v) {\n\t\tv /= 10;\n\t\t++ret;\n\t}\n\treturn ret;\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\tll ret = a / g;\n\tif ( keta(ret) + keta(b) - 1 >= 19 ) return m+1;\n\treturn ret * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tlong double p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts = lcm(s, a[v[i]]);\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << f << \" \" << p << \" \" << m << \" \" << s(m/s) << endl;;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nll lcm(ll bit) {\n\tif(bit == 0) return INF * INF + 1LL;\n\tbitset<31> bi(bit);\n\tvector<ll> v;\n\tREP(i,n) {\n\t\tif(bi[i]) v.pb(a[i]);\n\t}\n\tll g = v[0];\n\tFOR(i,1,v.size()) {\n\t\tll tmp = gcd(g, v[i]);\n\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t}\n\treturn g;\n}\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tFOR(bit,1,(1 << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) prob *= p[i];\n\t\t\telse prob *= (1 - p[i]);\n\t\t}\n\t\tll g = lcm(bit);\n\t\tll crt = 0;\n\t\tif(bi.count() % 2) crt = m / g;\n\t\telse crt = -(m / g);\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tif(sum != 0) {\n\t\t\t\t\tdp[bit].pb(crt + dp[bit ^ (1 << i)][sum - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tll _g = 0;\n\t\t\t\t\tif(!(bi.count() % 2)) _g = (m / lcm(bit ^ (1 << i)));\n\t\t\t\t\telse _g = -(m / lcm(bit ^ (1 << i)));\n\t\t\t\t\tdp[bit].pb(crt + _g);\n\t\t\t\t}\n\t\t\t\tcrt = dp[bit].back();\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * crt;\n\t\tdp[bit].shrink_to_fit();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long C=a;\n\t\ta=b;\n\t\tb=C;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tlong long m=1;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tGCD=gcd(m,c[j]);\n\t\t\t\tdouble lcm=m*GCD;\n\t\t\t\tif(lcm>(double)b+0.001){\n\t\t\t\t\tm=b+1;\n\t\t\t\t}else m=m*c[j]/GCD;\n\t\t\t}\n\t\t}\n\t\tdp[i]=b/m;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = long long;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\n\nconst int MAX = 1<<20;\nLL N, M;\nlong double num[MAX], prob[MAX];\n\nusing LLL = __int128;\n\nLLL gcd(LLL x, LLL y){\n  if(y == 0) return x;\n  return gcd(y, x%y);\n}\nLLL lcm(LLL x, LLL y){\n  return x / gcd(x, y) * y;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  cin >> N >> M;\n  VL xs(N);\n  vector<long double> ps(N);\n  REP(i,N)\n\tcin >> xs[i];\n  REP(i,N){\n\tcin  >> ps[i];\n\tps[i] /= 100.;\n  }\n\n  FOR(b,1,1<<N){\n\tLLL l = 1;\n\tint bc = 0;\n\tREP(i,N){\n\t  if(b>>i&1){\n\t\tif(l <= M)\n\t\t  l = lcm(l, xs[i]);\n\t\t++bc;\n\t  }\n\t  num[b] = (bc%2*2-1) * M / l;\n\t}\n  }\n\n  for(int i=0;i<N;++i){\n\tfor(int b=0;b<(1<<N);++b){\n\t  if((b>>i&1) == 1)\n\t\tnum[b] += num[b^(1<<i)];\n\t}\n  }\n\n  long double ans = 0.;\n  REP(b,1<<N){\n\tprob[b] = 1;\n\tREP(i,N){\n\t  prob[b] *= (b>>i&1? ps[i]: 1.-ps[i]);\n\t}\n\tans += prob[b] * num[b];\n  }\n\n  cout << fixed << setprecision(9) << ans << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint n;\nll m;\nll a[20];\ndouble P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\treturn a / g * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tdouble ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tdouble p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts *= a[v[i]];\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10f\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nll gcd(ll a, ll b) {\n  return b?gcd(b,a%b):a;\n}\n\nll llmax = 2*1e18;\nll mul(ll a, ll b) {\n  if (a>llmax/b) return llmax;\n  return a*b;\n}\n\nll a[20];\ndouble p[20];\nll dp[1<<20];\n\nint main() {\n  int n;\n  ll m;\n  while(cin>>n>>m) {\n    REP(i,n) cin >> a[i];\n    REP(i,n) {\n      cin >> p[i];\n      p[i] /= 100;\n    }\n    REP(S,1<<n) {\n      ll lcm = 1;\n      REP(i,n) {\n        if (S>>i&1) {\n          lcm = mul(lcm/gcd(lcm,a[i]), a[i]);\n          if (lcm > m) break;\n        }\n      }\n      if (S == 0) dp[S] = 0;\n      else {\n        if (__builtin_popcount(S) & 1) dp[S] = m / lcm;\n        else dp[S] = - m / lcm;\n      }\n      // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n    }\n    REP(i,n) {\n      // cout << i << endl;\n      REP(S,1<<n) {\n        if (S>>i&1) {\n          dp[S] += dp[S^(1<<i)];\n        }\n        // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n      }\n    }\n    double ans = 0;\n    REP(S,1<<n) {\n      double P = 1;\n      REP(i,n) {\n        if (S>>i&1) P *= p[i];\n        else P *= 1-p[i];\n      }\n      ans += dp[S] * P;\n    }\n    printf(\"%.10f\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iomanip>\n#include <iostream>\nusing namespace std;\nint n, p[22]; long long m, a[22], d[1048588];\nlong long gcd(long long x, long long y) {\n\tif (y == 0) return x;\n\treturn gcd(y, x % y);\n}\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) cin >> p[i];\n\td[0] = 1;\n\tdouble v = log10(m);\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 1 << i; j < 2 << i; j++) {\n\t\t\tlong long g = gcd(d[j - (1 << i)], a[i]);\n\t\t\td[j] = d[j - (1 << i)] / g;\n\t\t\tif (log10(d[j]) + log10(a[i]) >= v + 0.01) d[j] = m + 1;\n\t\t\telse d[j] *= a[i];\n\t\t}\n\t}\n\tfor (int i = 0; i < 1 << n; i++) d[i] = m / d[i];\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\tif ((j >> i) & 1) d[j] -= d[j - (1 << i)];\n\t\t}\n\t}\n\tdouble ex = 0.0;\n\tfor (int i = 0; i < 1 << n; i++) {\n\t\tdouble prob = 1.0;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tprob *= 0.01 * ((i >> j) & 1 ? p[j] : 100 - p[j]);\n\t\t}\n\t\tex += prob * (m - abs(d[i]));\n\t}\n\tcout << fixed << setprecision(15) << ex << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  while(y){\n    if(x < y) swap(x,y);\n    if(!y) return x;\n    x %= y;\n  }\n  return x;\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  for(long long int i = 1; i < (1LL << n); ++i){\n    double p = 1.0;\n    long long int t = 1;    \n    int c = 0;\n    for(int j = 0; j < n; ++j){\n      if((i>>j) & 1){\n        p *= P[j]/100.0;\n        t = t/gcd(A[j],t)*A[j];\n        ++c;\n        if(t > m){\n          t = 0;\n          break;\n        }\n      }\n    }\n    if(!t) continue;\n    if(c%2){\n      ans += m/t*p;\n    }else{\n      ans -= m/t*p;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b+1) return MA;\n\treturn min(MA,a*b);\n}\n\nlong long num[1<<20];\ndouble pr[1<<20];\n\nlong long a[20];\ndouble p[20];\n\nint main(){\n\tint N;\n\tlong long M;\n\tscanf(\"%d%lld\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tdouble tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cassert>\n#include <cstring>\n#include <cstdio>\n#include <complex>\n#include <cmath>\n#include <algorithm>\n#include <valarray>\n\nusing namespace std;\ntypedef long long ll;\ntypedef __int128 cent;\ntypedef long double R;\n\ncent gcd(cent a, cent b) {\n    if (a == 0) return b;\n    return gcd(b%a, a);\n}\n\nll dp[1<<20];\nint main() {\n    int n;\n    ll m;\n    cin >> n >> m;\n    cent a[20];\n    for (int i = 0; i < n; i++) {\n        ll aa;\n        cin >> aa;\n        a[i] = aa;\n    }\n    for (int i = 0; i < (1<<n); i++) {\n        cent re = 1;\n        for (int j = 0; j < n; j++) {\n            if ((i & (1<<j)) == 0) continue;\n            re = re/gcd(re, a[j])*a[j];\n            if (m < re) break;\n        }\n        dp[i] = m / re;\n    }\n\n\n    for (int i = 0; i < n; i++) {\n        for (int j = 0; j < (1<<n); j++) {\n            if (j & (1<<i)) continue;\n            dp[j] -= dp[j ^ (1<<i)];\n        }\n    }\n\n\n    for (int i = 0; i < n; i++) {\n        for (int j = 0; j < (1<<n); j++) {\n            if (!(j & (1<<i))) continue;\n            dp[j] += dp[j ^ (1<<i)];\n        }\n    }\n\n\n\n    R p[20];\n    for (int i = 0; i < n; i++) {\n        cin >> p[i];\n        p[i] /= 100;\n    }\n    R sm = 0;\n    for (int i = 0; i < (1<<n); i++) {\n        R pp = 1;\n        for (int j = 0; j < n; j++) {\n            if (i & (1<<j)) {\n                pp *= 1-p[j];\n            } else {\n                pp *= p[j];\n            }\n        }\n        sm += pp * (m-dp[i]);\n    }\n    printf(\"%.20Lf\\n\", sm);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\treturn a > c/b;\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <queue>\n#include <tuple>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n#include <memory>\n#include <random>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing vpll = vector<pll>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=(a)-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\n#define repi(i,a,b) for(int i=a;i<b;i++);\nconst ll mod = 1000000007;\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0> {\n\t\tstatic void apply(size_t& seed, Tuple const& tuple) {\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>> {\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const {\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\nll pow(ll base, ll i, ll mod) {\n\tll a = 1;\n\twhile (i) {\n\t\tif (i & 1) {\n\t\t\ta *= base;\n\t\t\ta %= mod;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= mod;\n\t\ti /= 2;\n\t}\n\treturn a;\n}\nll gcd(ll a, ll b) {\n\twhile (b) {\n\t\tll c = a%b;\n\t\ta = b;\n\t\tb = c;\n\t}\n\treturn a;\n}\nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b)*b;\n}\n#ifdef _MSC_VER\n#include <intrin.h>\n#endif\nint popcnt(unsigned long long a) {\n#ifndef _MSC_VER\n\treturn __builtin_popcountll(a);\n#else\n\treturn _mm_popcnt_u32(a >> 32) + _mm_popcnt_u32(a);\n\ta = (a & 0x5555555555555555) + (a >> 1 & 0x5555555555555555);\n\ta = (a & 0x3333333333333333) + (a >> 2 & 0x3333333333333333);\n\ta = (a & 0x0f0f0f0f0f0f0f0f) + (a >> 4 & 0x0f0f0f0f0f0f0f0f);\n\ta = (a & 0x00ff00ff00ff00ff) + (a >> 8 & 0x00ff00ff00ff00ff);\n\ta = (a & 0x0000ffff0000ffff) + (a >> 16 & 0x0000ffff0000ffff);\n\treturn (a & 0xffffffff) + (a >> 32);\n#endif\n}\nclass unionfind {\n\tvector<int> par, rank, size_;//????????§??????????????¢???????????????????????????rank???????????????size?????????\npublic:\n\tunionfind(int n) :par(n), rank(n), size_(n, 1) {\n\t\tiota(ALL(par), 0);\n\t}\n\tint find(int x) {\n\t\tif (par[x] == x)return x;\n\t\treturn par[x] = find(par[x]);\n\t}\n\tvoid unite(int x, int y) {\n\t\tx = find(x), y = find(y);\n\t\tif (x == y)return;\n\t\tif (rank[x] < rank[y])swap(x, y);\n\t\tpar[y] = x;\n\t\tsize_[x] += size_[y];\n\t\tif (rank[x] == rank[y])rank[x]++;\n\t}\n\tbool same(int x, int y) {\n\t\treturn find(x) == find(y);\n\t}\n\tint size(int x) {\n\t\treturn size_[find(x)];\n\t}\n};\ntemplate<class T, class Func = function<T(T, T)>>\nclass segtree {\n\tvector<T> obj;\n\tint offset;\n\tFunc updater;\n\tT e;\n\tint bufsize(int num) {\n\t\tint i = 1;\n\t\tfor (; num >i; i <<= 1);\n\t\toffset = i - 1;\n\t\treturn (i << 1) - 1;\n\t}\n\tT query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a || b <= l)return e;\n\t\tif (a <= l && r <= b)return obj[k];\n\t\telse return updater(query(a, b, k * 2 + 1, l, (l + r) / 2), query(a, b, k * 2 + 2, (l + r) / 2, r));\n\t}\npublic:\n\tT query(int a, int b) {//[a,b)\n\t\treturn query(a, b, 0, 0, offset + 1);\n\t}\n\tvoid updateall(int l = 0, int r = -1) {\n\t\tif (r < 0)r = offset + 1;\n\t\tl += offset, r += offset;\n\t\tif (l == 0)return;\n\t\tdo {\n\t\t\tl = l - 1 >> 1, r = r - 1 >> 1;\n\t\t\tfor (int i = l; i < r; i++)obj[i] = updater(obj[i * 2 + 1], obj[i * 2 + 2]);\n\t\t} while (l);\n\t}\n\tvoid update(int k, T &a) {\n\t\tk += offset;\n\t\tobj[k] = a;\n\t\twhile (k) {\n\t\t\tk = k - 1 >> 1;\n\t\t\tobj[k] = updater(obj[k * 2 + 1], obj[k * 2 + 2]);\n\t\t}\n\t}\n\tsegtree(int n, T e, const Func &updater = Func()) :obj(bufsize(n), e), e(e), updater(updater) {}\n\tsegtree(vector<T> &vec, T e, const Func &updater = Func()) :obj(bufsize(vec.size()), e), e(e), updater(updater) {\n\t\tcopy(vec.begin(), vec.end(), obj.begin() + offset);\n\t\tupdateall();\n\t}\n\tT& operator[](int n) {\n\t\treturn obj[n + offset];\n\t}\n};\ntemplate<class T = int>\nclass BIT {//????¬????BIT????????????????????????????????°??????????????????\n\tvector<T> bit;\npublic:\n\tBIT(int n) :bit(n + 1, 0) {}\n\tvoid add(int i, T x) {\n\t\twhile (i <= bit.size()) {\n\t\t\tbit[i] += x;\n\t\t\ti += i&-i;\n\t\t}\n\t}\n\tT sum(int i) {\n\t\tT s = 0;\n\t\twhile (i) {\n\t\t\ts += bit[i];\n\t\t\ti &= i - 1;\n\t\t}\n\t\treturn s;\n\t}\n};\ntemplate<class T>\nclass rangeadd {\n\tBIT<T> b0, b1;\n\trangeadd(int n) :b0(n), b1(n) {}\n\tvoid add(int l, int r, T x) {//[l,r)\n\t\tb0.add(l, -x(l - 1));\n\t\tb1.add(l, x);\n\t\tb0.add(r, x*r);\n\t\tb1.add(r, -x);\n\t}\n\tT sum(int i) {\n\t\treturn b0.sum(i) + b1.sum(i)*i;\n\t}\n};\n//end of lib\n//template<class S=void,int ptr_num, class T = char>class trie {\n//\tumap<T, trie<S, ptr_num, T> next;\n//public:\n//\tS key;\n//\ttrie<S, ptr_num, T>* ptr[ptr_num] = {};\n//\ttrie(S &&data) :key(data) {}\n//\ttrie(const S &data) :key(data) {}\n//\tvoid add(T x,S data) {\n//\t\tif (!next.find(x))next.insert(x, data);\n//\t}\n//\ttrie& operator[](T x) {\n//\t\treturn next[x];\n//\t}\n//\tbool find(T x) {\n//\t\tretun next.find(x);\n//\t}\n//};\n//template<class T=char>class AhoCorasick {\n//\ttrie<pair<bool,int>, 2, T> tree;\n//\tAhoCorasick(vector<string> p) {\n//\t\tint num = 0;\n//\t\tvector<decltype(&tree)> que(p.size(),&tree);\n//\t\tfor (int i = 0;; i++) {\n//\t\t\tbool end = 1;\n//\t\t\tint i = 0;\n//\t\t\tfor (auto a : p) {\n//\t\t\t\tif (i >= a.size())break;\n//\t\t\t\tend = ;0\n//\t\t\t\tque[i] = (*que[i])[a[i]];\n//\t\t\t\ti++;\n//\t\t\t}\n//\t\t\tif (end)break;\n//\t\t}\n//\t}\n//};\nint main() {\n\tll n, m;\n\tcin >> n >> m;\n\tvll a(n);\n\tvector<double> p(n);\n\trep(i, n)cin >> a[i];\n\trep(i, n)cin >> p[i];\n\trep(i, n)p[i] /= 100;\n\tvll dp(1 << n);\n\trep(i, 1 << n) {\n\t\tll l = 1;\n\t\trep(j, n)if (i & 1 << j)l = lcm(l, a[j]);\n\t\tdp[i] = m / l*(popcnt(i) % 2 ? 1 : -1);\n\t}\n\tdp[0] = 0;\n\trep(i, n)rep(j, 1 << n)if (j & 1 << i)dp[j] += dp[j ^ 1 << i];\n\tdouble ans = 0;\n\trep(i, 1 << n) {\n\t\tdouble q = 1;\n\t\trep(j, n)q *= (i & 1 << j ? p[j] : 1 - p[j]);\n\t\tans += q*dp[i];\n\t}\n\tcout << fixed << setprecision(10) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define double long double\n\n// int g[1<<20];\nint divs[1<<20];\nint dp[1<<20];\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  int n, m;\n  cin >> n >> m;\n\n  int a[20], p[20];\n  for ( int i = 0; i < n; i++ ) {\n    cin >> a[i];\n  }\n  for ( int i = 0; i < n; i++ ) {\n    cin >> p[i];\n  }\n\n  for ( int i = 1; i < (1<<n); i++ ) {\n    int b = __builtin_popcount(i);\n    int g = 1;\n    for ( int j = 0; j < n; j++ ) {\n      if ( (1<<j) & i ) {\n\tif ( g == a[j] ) g = g;\t\n\telse if ( log10(g) + log10(a[j]) >= 18.5 ) {\n\t  g = 2000000000000000000LL;\n\t  break;\n\t}\n\telse g = g*a[j] / __gcd(g, a[j]);\n      }\n    }\n    if ( b%2 ) divs[i] = m/g;\n    else divs[i] = -(m/g);\n    dp[i] = divs[i];    \n  }\n  /* for ( int i = 0; i < (1<<n); i++ ) {\n    cout << dp[i] << endl;\n    } */\n  \n  for ( int j = 0; j < n; j++ ) {\n    for ( int i = 0; i < (1<<n); i++ ) {\n      if ( i & (1<<j) ) dp[i] += dp[i & ~(1<<j)];      \n    }\n  }\n\n  double ans = 0;\n  for ( int i = 1; i < (1<<n); i++ ) {\n    double tmp = 1;    \n    for ( int j = 0; j < n; j++ ) {\n      if ( i & (1<<j) ) tmp *= p[j];\n      else tmp *= (100-p[j]);\n    }\n    tmp /= pow(100, n);    \n    // cout << i << \" \" << dp[i] << \" \" << tmp << \" \" << dp[i]*tmp << endl;\n    ans += dp[i] * tmp;    \n  }\n\n  cout << ans << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "// ref. http://compro.tsutajiro.com/archive/181015_incexc.pdf\n\n#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cmath>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <queue>\n#include <unordered_map>\n#include <vector>\n#include <string.h>\n#include <set>\n\nusing namespace std;\n\n#define COUT(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << endl\n\ntemplate<class T> void printvec(const vector<T>& v) {\n  for (auto x : v) { cout << x << \" \"; }\n  cout << endl;\n}\ntemplate<class T> void printtree(const vector< vector<T> >& tree) {\n  for (long long i = 0; i < tree.size(); ++i) {\n    cout << i + 1 << \": \"; printvec(tree[i]);\n  }\n}\ntemplate<class T, class U> void printmap(const map<T, U>& mp) {\n  for (auto x : mp) { cout << x.first << \"=>\" << x.second << endl; }\n}\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return true; } return false; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return true; } return false; }\n\n#define rep(i, n) for(ll i = 0; i < n; ++i)\n#define all(s) s.begin(), s.end()\n#define sz(x) (ll)(x).size()\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef tuple<ll, ll, ll> triple;\ntypedef double D;\ntypedef vector<ll> vl;\ntypedef vector<P> vp;\n\nconst ll INF = (ll)2e18 + 5;\nconst ll MOD = 1000000007;  // 1e9 + 7\n\nll gcd(ll a, ll b) {\n  if (a < b) { swap(a, b); }\n  if (b == 0) { return a; }\n  return gcd(b, a % b);\n}\n\nll lcm(ll a, ll b) {\n  if (a/gcd(a,b) > INF / b) { // a*b/gcd(a,b) > INF. too large\n    return INF;\n  } else {\n    return a / gcd(a,b) * b;\n  }\n}\n\n// Mevius Transform.\n// - dp.size() == 1ll<<n.\n// - dp must be initialzed by g\nvoid MeviusTransform(vector<ll>& dp, ll n) {\n  rep(i,n)rep(bit,1ll<<n) {\n    if (bit>>i&1) {\n      dp[bit] -= dp[bit^(1ll<<i)];\n    }\n  }\n}\n\nint main(int argc, char** argv) {\n  cin.tie(NULL);\n  cout.tie(NULL);\n  ios_base::sync_with_stdio(false);\n  cout << setprecision(10) << fixed;\n\n  ll n,m;\n  cin >> n >> m;\n  vector<ll> a(n);\n  rep(i,n) {\n    cin >> a[i];\n  }\n  vector<double> p(n);\n  rep(i,n) {\n    cin >> p[i];\n    p[i] /= 100;\n  }\n\n  vector<ll> dp(1ll<<n);\n  // initialzation\n  rep(bit,1ll<<n) {\n    if (bit == 0) { continue; } // Skip empty state bit.\n\n    ll mul = 1; // lcm of all selected values.\n    rep(i,n) {\n      if (bit>>i&1) {\n        mul = lcm(mul,a[i]);\n      }\n    }\n    dp[bit] = m/mul; // count of intersection at bit state.\n  }\n\n  // Mevius Transform\n  MeviusTransform(dp,n);\n\n  // Calculate answer\n  double ans = 0;\n  rep(bit,1ll<<n) {\n    double prob = 1.0; // probability of selected bit state.\n    rep(i,n) {\n      prob *= ((bit>>i&1) ? p[i] : 1-p[i]);\n    }\n    ans += prob * abs(dp[bit]);\n  }\n  cout << ans << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; int P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) cin >> P[i];\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 0, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)){\n            if (lc == INF) break;\n            lc = lcm(lc, A[i]);\n            if (lc < A[i]) lc = INF;\n        }\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= (ld)P[i] / 100.0;\n            else p *= (ld)(100 - P[i]) / 100.0;\n        }\n\n        ans += (ld)(M - abs(f[mask])) * p;\n    }\n    printf(\"%.10f\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nusing ll = long long;\nusing ld = double;\n\nusing T = __int128_t;\n\nT my_gcd(T a, T b)\n{\n    return b ? my_gcd(b, a % b) : a;\n}\n\nT my_lcm(T a, T b)\n{\n    T g = my_gcd(a, b);\n    //cerr << a << \" \" << b << endl;\n    assert(g != 0);\n    __int128_t tmp = a / g * b;\n    if (tmp > (1LL << 60))\n        return (1LL << 60);\n    return tmp;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n, m;\n    cin >> n >> m;\n    vector<ll> a(n);\n    vector<ld> p(n);\n    for (int i = 0; i < n; i++)\n        cin >> a[i];\n    for (int i = 0; i < n; i++)\n        cin >> p[i];\n    ld ret = 0;\n    for (int i = 1; i < (1 << n); i++)\n    {\n        ld pp = 1;\n        ll l = 1;\n        int cnt = 0;\n        for (int j = 0; j < n; j++)\n        {\n            if (((i >> j) & 1) == 0)\n                continue;\n            cnt++;\n            pp *= p[j] / 100;\n            l = my_lcm(l, a[j]);\n        }\n        assert(l != 0);\n        pp *= m / l;\n        if (cnt % 2)\n            ret += pp;\n        else\n            ret -= pp;\n    }\n    cout << fixed << setprecision(10) << ret << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  if(y == 0) return x;\n  return gcd(y,x%y);\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  double ans = 0;\n  for(long long int i = 1; i < (1LL << n); ++i){\n    double p = 1.0;\n    for(int j = 0; j < n; ++j){\n      if((i>>j) & 1) p *= P[j]/100.0;\n    }\n    long long int t = 1;    \n    int c = 0;\n    for(int k = 0; k < n; ++k){\n      if((i>>k) & 1){\n        t = t/gcd(A[k],t)*A[k];\n        ++c;\n      }\n    }\n    if(c%2){\n      ans += m/t*p;\n    }else{\n      ans -= m/t*p;\n    }\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\nlong long int gcd(long long int x, long long int y){\n  if(x < y) swap(x,y);\n  if(y == 0) return x;\n  return gcd(y,x%y);\n}\n\nint main(){\n  long long int n, m;\n  cin >> n >> m;\n  vector<long long int> A(n);\n  vector<int> P(n);\n  for(int i = 0; i < n; ++i) cin >> A[i];\n  for(int i = 0; i < n; ++i) cin >> P[i];\n  vector<double> P_(1<<n);\n  vector<long long int> LCM(1<<n);\n  vector<int> C(1<<n);\n  for(long long int i = 1; i < (1LL << n); ++i){\n    double p = 1.0;\n    for(int j = 0; j < n; ++j){\n      if((i>>j) & 1) p *= P[j]/100.0;\n      //else p *= (100 - P[j])/100.0;\n    }\n    P_[i] = p;\n    long long int t = 1;    \n    int c = 0;\n    for(int k = 0; k < n; ++k){\n      if((i>>k) & 1){\n        t = t/gcd(A[k],t)*A[k];\n        ++c;\n      }\n    }\n    C[i] = c;\n    if(c%2) LCM[i] = t;\n    else LCM[i] = -t;\n  }\n  double ans = 0;\n  for(long long int i = 1; i < (1LL << n); ++i){\n    double p = P_[i];\n    long long int s = 0;\n    if(LCM[i] > 0){\n      s += (m/LCM[i]);//<<(n-C[i]);\n    }else{\n      s -= m/abs(LCM[i]);//<<(n-C[i]);\n    }\n    //cout << i << \" \" << p << \" \" << s << endl;\n    ans += p*s;\n  }\n  printf(\"%.12f\\n\",ans);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nconst long long MA=1000000000000000000ll+1;\n\nlong long gcd(long long a,long long b){\n\tif(a<b) return gcd(b,a);\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nlong long lcm(long long a,long long b){\n\tif(a==MA||b==MA) return MA;\n\tlong long d=gcd(a,b);\n\tb/=d;\n\tif(a>=MA/b) return MA;\n\treturn a*b;\n}\n\nlong long num[1<<20];\nlong double pr[1<<20];\n\nlong long a[20];\nlong double p[20];\n\nint main(){\n\tint N,M;\n\tscanf(\"%d%d\",&N,&M);\n\tfor(int i=0;i<N;i++) scanf(\"%lld\",a+i);\n\tfor(int i=0;i<N;i++){\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tp[i]=(long double)in/100;\n\t}\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tint cnt=0;\n\t\tif(stat==0) num[stat]=0;\n\t\telse{\n\t\t\tlong long d=1;\n\t\t\tfor(int i=0;i<N;i++) if(((stat>>i)&1)==1){\n\t\t\t\tcnt++;\n\t\t\t\td=lcm(d,a[i]);\n\t\t\t}\n\t\t\tnum[stat]=M/d;\n\t\t\tif(cnt%2==0) num[stat]*=-1;\n\t\t}\n\t\tpr[stat]=1;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(((stat>>i)&1)==1) pr[stat]*=p[i];\n\t\t\telse pr[stat]*=(1-p[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<N;i++) for(int j=0;j<(1<<N);j++){\n\t\tif(((j>>i)&1)==1){\n\t\t\tnum[j]+=num[j&(~(1<<i))];\n\t\t}\n\t}\n\tlong double ans=0;\n\tfor(int stat=0;stat<(1<<N);stat++){\n\t\tlong double tmp=pr[stat]*num[stat];\n\t\tans+=tmp;\n\t}\n\tprintf(\"%.9llf\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nll cnt[(1<<20)+5],m,num[25];\nint n;\ndouble p[25];\nint main(){\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> num[i];\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%lf\",&p[i]); p[i]/=100.;\n\t}\n\tfor(int i=1;i<(1<<n);i++){\n\t\tll N = 1LL; int B = __builtin_popcount(i);\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(!((i>>j)&1)) continue;\n\t\t\tif(8000000000000000000LL/N < num[j]) goto fail;\n\t\t\tN *= num[j];\n\t\t}\n\t\tif(B%2==1) cnt[i] = m/N;\n\t\telse cnt[i] = -1*(m/N); fail:;\n\t}\n\tfor(int i=0;i<n;i++) for(int j=0;j<(1<<n);j++){\n\t\tif(((j>>i)&1)) cnt[j] += cnt[j^(1<<i)];\n\t}\n\tdouble ans = 0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tdouble prob = 1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(((i>>j)&1)) prob *= p[j];\n\t\t\telse prob *= 1.0-p[j];\n\t\t}\n\t\tans += prob * (double)cnt[i]; //cout << cnt[i] << \" \" << i << endl;\n\t}\n\tprintf(\"%.12f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\nusing namespace std;\ntypedef long long int llint;\ntypedef long double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n//cout<<setprecision(20)\nconst llint mod=1000000007;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>void mineq(T& a,U b){if(a>b){a=b;}}\ntemplate <class T,class U>void maxeq(T& a,U b){if(a<b){a=b;}}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\nint LBI(vector<llint>&ar,llint in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint UBI(vector<llint>&ar,llint in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint main(void){\n\tllint n,m,i;cin>>n>>m;\n\t//包除\n\tlldo ans=0;\n\tllint aa[20]={0};\n\tlldo pp[20]={0};\n\tfor(i=0;i<n;i++){cin>>aa[i];}\n\tfor(i=0;i<n;i++){cin>>pp[i];pp[i]/=100;}\n\tfor(int bi=1;bi<(1<<n);bi++){\n\t\tllint gen=1;\n\t\tlldo per=1;\n\t\tbool ok=true;\n\t\tint guki=0;\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(!(bi&(1<<i))){continue;}\n\t\t\tguki++;\n\t\t\tper*=pp[i];\n\t\t\tllint gc=gcd(gen,aa[i]);\n\t\t\tif(((lldo)gen/gc *aa[i])>2e18){ok=false;break;}\n\t\t\tgen=gen/gc *aa[i];\n\t\t}\n\t\tllint num=m/gen;\n\t\tif(guki%2==1){ans+=per*num;}\n\t\telse{ans-=per*num;}\n\t}\n\tcout<<setprecision(20)<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <list>\n#include <cmath>\n#include <fstream>\n#include <algorithm>\n#include <string>\n#include <queue>\n#include <set>\n#include <map>\n#include <complex>\n#include <iterator>\n#include <cstdlib>\n#include <cstring>\n#include <sstream>\n#include <stack>\n#include <climits>\n#include <deque>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> pii;\ndouble EPS=1e-10;\ndouble EQ(double a,double b){\n  return abs(a-b)<EPS;\n}\nvoid fast_stream(){\n  cin.tie(0);\n  std::ios_base::sync_with_stdio(0);\n}\ntemplate<class T>\nstring IntToString(T num){\n  string res;stringstream ss;ss<<num;\n  return ss.str();\n}\nll StringToInt(string &str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    res=(res*10+str[i]-'0');\n  return res;\n}\nint N;\nll M;\nll as[101];\ndouble ps[101];\n\nll gcd(ll a,ll b){\n  if(b==0)return a;\n  return gcd(b,a%b);\n}\nll lcm(ll a,ll b){\n  return a*b/gcd(a,b);\n}\nlong double lcm2(ll a,ll b){\n  return 1.0*a*b/gcd(a,b);\n}\n\nint main(){\n  cin>>N>>M;\n  for(int i=0;i<N;i++)cin>>as[i];\n  for(int i=0;i<N;i++){\n    cin>>ps[i];\n    ps[i]/=100;\n  }\n  double res=0;\n  for(int i=1;i<(1<<N);i++){\n    double per=1;\n    int bitCnt=0;\n    ll m=1;\n    for(int j=0;j<N;j++){\n      if((i>>j)&1){\n\tbitCnt++;\n\t// Mツづーツ陳エツつヲツつスツづァfin\n\tif(lcm2(m,as[j])>M){\n\t  m=M+1;\n\t  break;\n\t}\n\tm=lcm(m,as[j]);\n\tper*=ps[j];\n      }\n    }\n    if(!(bitCnt%2))res-=per*(M/m);\n    else res+=per*(M/m);\n  }\n  printf(\"%.10f\\n\",res);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\n\nusing ld=long double;\n\nlong long int gcd(long long int l, long long int r) {\n\tif (l > r)return gcd(r, l);\n\telse {\n\t\tif (r%l) {\n\t\t\treturn gcd(l, r%l);\n\n\t\t}\n\t\telse {\n\t\t\treturn l;\n\t\t}\n\t}\n}\n\nint main() {\n\tint N; long long int M;cin>>N>>M;\n\tvector<long long int>as(N);\n\tvector<ld>pers(N);\n\tfor(int i=0;i<N;++i)cin>>as[i];\n\tfor (int i = 0; i < N; ++i) {\n\t\tint p;cin>>p;\n\t\tpers[i]=(ld)(p)/100.0l;\n\t}\n\n\tld ans=0;\n\tfor (int i = 1; i < (1 << N); ++i) {\n\t\tbitset<18>use;\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tif(i&(1<<j))use[j]=true;\n\t\t}\n\t\tlong long int num=1;\n\t\tld aper=1;\n\t\tfor (int j = 0; j < N; ++j) {\n\t\t\tif (use[j]) {\n\t\t\t\tlong long int agcd(gcd(num, as[j]));\n\t\t\t\tld val = ld(num)*ld(as[j]) / ld(agcd);\n\t\t\t\tif (val > 1e18 + 1e17) {\n\t\t\t\t\tnum = 1e18 + 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnum = num / agcd*as[j];\n\t\t\t\t}\n\t\t\t\taper*=pers[j];\n\t\t\t}\n\t\t\n\t\t\t\n\t\t}\n\t\tif (use.count() % 2) {\n\t\t\tans+=aper*(M/num);\n\t\t}\n\t\telse {\n\t\t\tans-=aper*(M/num);\n\t\t}\n\t}\n\tcout<<setprecision(10)<<fixed<<ans<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tvector<vector<ll>> dp(n + 1,vector<ll>((1ll << n), 0));\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[0][bit] = m / g;\n\t\telse dp[0][bit] = - (m / g);\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) dp[i + 1][bit] = dp[i][bit] + dp[i][bit ^ (1 << i)];\n\t\t\telse dp[i + 1][bit] = dp[i][bit];\n\t\t}\n\t\tans += prob * dp[n][bit];\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep1(i,(1<<n)-1){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.10llf\\n\", ret);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define FORR(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n\n#define CHMIN(a,b) (a)=min((a),(b))\n#define CHMAX(a,b) (a)=max((a),(b))\n\n#define DEBUG(x) cout<<#x<<\": \"<<(x)<<endl\n\nint n;\nll m;\nll a[25];\nint p[25];\n\ndouble P[1<<20];\nll f[1<<20];\nll V[1<<20];\nconst ll INF = 1ll<<60;\n\nint main(){\n\tscanf(\"%d%lld\",&n,&m);\n\tREP(i,n)scanf(\"%lld\",a+i);\n\tREP(i,n)scanf(\"%d\",p+i);\n\t// P\n\tREP(msk,1<<n){\n\t\tP[msk] = 1.0;\n\t\tREP(i,n)P[msk] *= (double)((msk>>i&1)==1 ? p[i] : 100-p[i])/100.0;\n\t}\n\t// f\n\tFOR(msk,1,1<<n){\n\t\tll lcm = 1;\n\t\tREP(i,n)if(msk>>i&1){\n\t\t\tll mul = a[i] / __gcd(a[i], lcm);\n\t\t\t// lcm * mul >= 1<<60\n\t\t\t// mul >= (1<<60) / lcm\n\t\t\tif(mul >= (INF+lcm-1)/lcm){\n\t\t\t\tlcm = INF;\n\t\t\t}else{\n\t\t\t\tlcm = lcm * mul;\n\t\t\t}\n\t\t}\n\t\tf[msk] = m / lcm;\n\t\tif(__builtin_popcount(msk)%2==0)f[msk] = -f[msk];\n\t\t// DEBUG(f[msk]);\n\t}\n\t// V\n\tREP(msk,1<<n)V[msk] = f[msk];\n\tREP(i,n)REP(msk,1<<n)if(msk>>i&1)V[msk]+=V[msk^(1<<i)];\n\t// REP(msk,1<<n)DEBUG(V[msk]);\n\t// ans\n\tdouble ans = 0.0;\n\tREP(msk,1<<n)ans += P[msk]*V[msk];\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = long long;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\n\nconst int MAX = 1<<20;\nLL N, M;\ndouble num[MAX], prob[MAX];\n\nusing LLL = __int128;\n\nLLL gcd(LLL x, LLL y){\n  if(y == 0) return x;\n  return gcd(y, x%y);\n}\nLLL lcm(LLL x, LLL y){\n  return x / gcd(x, y) * y;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  cin >> N >> M;\n  VL xs(N);\n  vector<double> ps(N);\n  REP(i,N)\n\tcin >> xs[i];\n  REP(i,N){\n\tcin  >> ps[i];\n\tps[i] /= 100.;\n  }\n\n  FOR(b,1,1<<N){\n\tLLL l = 1;\n\tint bc = 0;\n\tREP(i,N){\n\t  if(b>>i&1){\n\t\tif(l <= M)\n\t\t  l = lcm(l, xs[i]);\n\t\t++bc;\n\t  }\n\t  num[b] = (bc%2*2-1) * M / l;\n\t}\n  }\n\n  for(int i=0;i<N;++i){\n\tfor(int b=0;b<(1<<N);++b){\n\t  if((b>>i&1) == 1)\n\t\tnum[b] += num[b^(1<<i)];\n\t}\n  }\n\n  double ans = 0.;\n  REP(b,1<<N){\n\tprob[b] = 1;\n\tREP(i,N){\n\t  prob[b] *= (b>>i&1? ps[i]: 1.-ps[i]);\n\t}\n\tans += prob[b] * num[b];\n  }\n\n  cout << fixed << setprecision(9) << ans << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = m;\n\t\trep(j, n) if(i & 1 << j) t /= a[j];\n\t\tf[i] = t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tlong double ans = 0;\n\trep(i, 1 << n){\n\t\tlong double e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0l;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tcout << fixed << setprecision(20) << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\n#include <queue>\ntypedef long long ll;\n\n#include <cstdio>\ninline int getInt(){ int s; scanf(\"%d\", &s); return s; }\ninline ll getLL(){ ll s; scanf(\"%lld\", &s); return s; }\n#include <set>\nusing namespace std;\n\ntemplate<class T>\nT gcd(T a, T b){\n  if(a > b){ T tmp = b; b = a; a = tmp; }\n  if(a == 0) return b;\n  return gcd(a, b % a);\n}\n\nint main(){\n  const int n = getInt();\n  const ll  m = getLL();\n  vector<ll> a(n);  REP(i,n) a[i] = getLL();\n  vector<int> p(n); REP(i,n) p[i] = getInt();\n\n  double ans = 0.0;\n\n  REP(i,1 << n) if(i){\n    double prob = 1.0;\n    ll mul = 1;\n\n    REP(j,n) if(i & (1 << j)){\n      prob *= p[j] / 100.0;\n\n      ll next = mul / gcd(mul, a[j]);\n      if(mul > 0){\n        if(next > m / a[j]) mul = -1;\n        else mul = next * a[j];\n      }\n    }\n\n    if(mul > 0){\n      if(__builtin_popcount(i) % 2)\n        ans += prob * (m / mul);\n      else\n        ans -= prob * (m / mul);\n    }\n  }\n\n  printf(\"%.9f\\n\", ans);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m))return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep(i,(1<<n)){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.12lf\\n\",ret+m);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\n// 最大公約数\nlong long gcd(long long a, long long b){\n    while(b != 0){\n        long long tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main()\n{\n    int n, m;\n    cin >> n >> m;\n\n    vector<long long> a(n);\n    for(int i=0; i<n; ++i)\n        cin >> a[i];\n    vector<double> p(n);\n    for(int i=0; i<n; ++i){\n        int tmp;\n        cin >> tmp;\n        p[i] = tmp / 100.0;\n    }\n\n    double ret = 0.0;\n    for(int i=1; i<(1<<n); ++i){\n        bitset<20> use(i);\n        long long x = 1;\n        for(int j=0; j<n; ++j){\n            if(use[j]){\n                x /= gcd(x, a[j]);\n                if(LLONG_MAX / x < a[j]){\n                    x = -1;\n                    break;\n                }\n                x *= a[j];\n            }\n        }\n\n        if(x == -1)\n            continue;\n        x = m / x;\n\n        double q = 1.0;\n        for(int j=0; j<n; ++j){\n            if(use[j])\n                q *= p[j];\n        }\n\n        if(use.count() % 2 == 0)\n            ret -= x * q;\n        else\n            ret += x * q;\n    }\n\n    printf(\"%.10f\\n\", ret);\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <bitset>\n#include <assert.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<bool> vb;\ntypedef vector<double> vd;\ntypedef pair<ll,ll> P;\ntypedef vector<P> vpl;\ntypedef tuple<ll,ll,ll> tapu;\n#define rep(i,n) for(ll i=0; i<(n); i++)\n#define REP(i,a,b) for(int i=(a); i<(b); i++)\n#define all(x) (x).begin(), (x).end()\n#define rall(x) (x).rbegin(), (x).rend()\nconst int inf = 1<<30;\nconst ll linf = 1LL<<62;\nconst int MAX = 1100000;\nll dy[8] = {0,1,0,-1,1,-1,1,-1};\nll dx[8] = {1,0,-1,0,1,-1,-1,1};\nconst double pi = acos(-1);\nconst double eps = 1e-7;\ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){\n\tif(a>b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){\n\tif(a<b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T1,typename T2> inline void print2(T1 a, T2 b){cout << a << \" \" << b << \"\\n\";}\ntemplate<typename T1,typename T2,typename T3> inline void print3(T1 a, T2 b, T3 c){\n\tcout << a << \" \" << b << \" \" << c << \"\\n\";\n}\n//const int mod = 1e9 + 7;\nconst int mod = 998244353;\n\nll GCD(ll a, ll b){\n\tif(b==0) return a;\n\telse return GCD(b,a%b);\n}\n\nint main(){\n\tll n,m; cin >> n >> m;\n\tvl a(n); rep(i,n) cin >> a[i];\n\tvd p(n);\n\trep(i,n){\n\t\tcin >> p[i];\n\t\tp[i] /= 100.0;\n\t}\n\tvl gc(1<<n,0);\n\tvl f(1<<n,0);\n\trep(bit,1<<n){\n\t\tll cnt = 0;\n\t\trep(i,n){\n\t\t\tif(bit>>i & 1){\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tll nxt = bit | (1<<i);\n\t\t\t\tif(gc[bit] == m+1) gc[nxt] = m+1;\n\t\t\t\telse{\n\t\t\t\t\tll g = GCD(gc[bit], a[i]);\n\t\t\t\t\tif(gc[bit] == 0) gc[nxt] = a[i];\n\t\t\t\t\telse if(gc[bit] / g > m / a[i]) gc[nxt] = m+1;\n\t\t\t\t\telse gc[nxt] = gc[bit] / g * a[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(cnt == 0) f[bit] = 0;\n\t\telse if(cnt & 1) f[bit] = m / gc[bit];\n\t\telse f[bit] = - m / gc[bit];\n\t}\n\trep(i,n){\n\t\trep(bit,1<<n){\n\t\t\tif(bit>>i & 1) f[bit] += f[bit ^ (1<<i)];\n\t\t}\n\t}\n\tdouble ans = 0.0;\n\trep(bit,1<<n){\n\t\tdouble pp = 1.0;\n\t\trep(i,n){\n\t\t\tif(bit>>i & 1) pp *= p[i];\n\t\t\telse pp *= (1.0 - p[i]);\n\t\t}\n\t\tans += pp * f[bit];\n\t}\n\tprintf(\"%.10f\\n\",ans);\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <algorithm>\nusing namespace std;\nusing ll = long long int;\nconst ll MAXV = 1LL << 60;\nll mul(ll A, ll B) {\n    if(A == MAXV or B == MAXV) return MAXV;\n    ll ret = 0;\n    for(; B>0; B>>=1) {\n        if(B & 1) ret += A;\n        if(ret > MAXV) return MAXV;\n        (A += A);\n    }\n    return ret;\n}\n\nll gcd(ll A, ll B) {\n    return B ? gcd(B, A%B) : A;\n}\n\nll lcm(ll A, ll B) {\n    if(A == MAXV or B == MAXV) return MAXV;\n    return mul(A / gcd(A, B), B);\n}\n\nll N, M, A[25], P[25]; long double dp[1 << 20], ans;\nint main() {\n    cin >> N >> M;\n    for(int i=0; i<N; i++) cin >> A[i];\n    for(int i=0; i<N; i++) cin >> P[i];\n    for(int bit=0; bit<(1<<N); bit++) {\n        ll mul = 1;\n        for(int i=0; i<N; i++) if(bit >> i & 1) mul = lcm(mul, A[i]);\n        dp[bit] = M / mul;\n    }\n    for(int i=0; i<N; i++) for(int bit=0; bit<(1<<N); bit++) {\n         if(bit >> i & 1) dp[bit] -= dp[bit ^ (1 << i)];\n    }\n    for(int bit=0; bit<(1<<N); bit++) {\n        long double prob = 1.0;\n        for(int i=0; i<N; i++) prob *= 1.0 * (bit >> i & 1 ? P[i] : 100 - P[i]) / 100.0;\n        ans += prob * (M - abs(dp[bit]));\n    }\n    cout << fixed << setprecision(12) << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\ntypedef long double ld;\n#define INF 1LL<<60\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nld lginf = -1;\nll lcm(ll a, ll b) {\n    if(lginf < 0) lginf = log10l(INF);\n\n    if (a == INF) return INF;\n    if (b == INF) return INF;\n    a /= gcd(a, b);\n\n    ld aa = log10l(a);\n    ld bb = log10l(b);\n\n    if (lginf <= aa + bb) return INF;\n\n    return a * b;\n}\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; ld P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) {\n        int x; cin >> x;\n        P[i] = x / 100.0;\n    }\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)) lc = lcm(lc, A[i]);\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= P[i];\n            else p *= 1 - P[i];\n        }\n\n        ans += (ld)abs(f[mask]) * p;\n    }\n    printf(\"%.10llf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <climits>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <set>\n#include <map>\n#include <iostream>\n#include <deque>\n#include <complex>\n#include <string>\n#include <iomanip>\n#include <sstream>\n#include <bitset>\n#include <valarray>\n#include <iterator>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<ll> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) container.begin(), container.end()\n#define RALL(container) container.rbegin(), container.rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\nos<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n// 最大公約数を求める\nll gcd(ll a,ll b){\n\treturn b>0?gcd(b,a%b):a;\n}\n// 最小公倍数を求める\nll lcm(ll a,ll b){\n\ta = a/gcd(a,b);\n\tif(b!=0 && a>LONG_MAX/b) return 0;\n\treturn a*b;\n}\nint n;\nll m;\nmain(){\n\twhile(cin >> n >> m){\n\t\tvi a(n), p(n);\n\t\tREP(i, n) cin >> a[i];\n\t\tREP(i, n) cin >> p[i];\n\t\tvi dp(1<<n);\n\t\tREP(i, 1<<n){\n\t\t\tif(!i) continue;\n\t\t\tll l=1;\n\t\t\tREP(j, n)\n\t\t\t\tif(l && (i>>j)&1) l = lcm(l, a[j]);\n\t\t\tdp[i] = l?m/l:0;\n\t\t}\n//\t\tREP(i, n)REP(j, 1<<n) if((j>>i)&1) dp[j] -= dp[j^(1<<i)];\n\t\tdouble ans = 0;\n\t\tREP(i, 1<<n){\n\t\t\tif(!i) continue;\n\t\t\tdouble pr=1.0;\n\t\t\tREP(j, n)\n\t\t\t\tif((i>>j)&1) pr *= p[j]/100.0;\n//\t\t\t\telse pr *= (100-p[j])/100.0;\n\t\t\tans += (__builtin_popcount(i)&1?1:-1)*pr * abs(dp[i]);\n\t\t}\n\t\tprintf(\"%.10f\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nll gcd(ll a, ll b) {\n  return b?gcd(b,a%b):a;\n}\n\nll llmax = 1e18+10;\nll mul(ll a, ll b) {\n  if (a>llmax/b) return llmax;\n  return a*b;\n}\n\nll a[20];\ndouble p[20];\nll dp[1<<20];\n\nint main() {\n  int n;\n  ll m;\n  while(cin>>n>>m) {\n    REP(i,n) cin >> a[i];\n    REP(i,n) {\n      cin >> p[i];\n      p[i] /= 100;\n    }\n    REP(S,1<<n) {\n      ll lcm = 1;\n      REP(i,n) {\n        if (S>>i&1) {\n          lcm = mul(lcm/gcd(lcm,a[i]), a[i]);\n          if (lcm > m) break;\n        }\n      }\n      if (S == 0) dp[S] = 0;\n      else {\n        if (__builtin_popcount(S) & 1) dp[S] = m / lcm;\n        else dp[S] = - m / lcm;\n      }\n      // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n    }\n    REP(i,n) {\n      // cout << i << endl;\n      REP(S,1<<n) {\n        if (S>>i&1) {\n          dp[S] += dp[S^(1<<i)];\n        }\n        // cout << bitset<3>(S) << \" \" << dp[S] << endl;\n      }\n    }\n    double ans = 0;\n    REP(S,1<<n) {\n      double P = 1;\n      REP(i,n) {\n        if (S>>i&1) P *= p[i];\n        else P *= 1-p[i];\n      }\n      ans += dp[S] * P;\n    }\n    printf(\"%.10f\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef unsigned long long ULL;\n\nULL gcd(ULL a, ULL b) {\n    if(a < b) swap(a, b);\n    while(b > 0) {\n        ULL tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    int N, M;\n    cin >> N >> M;\n    vector<ULL> as(N);\n    vector<int> ps(N);\n    for(int i = 0; i < N; ++i) {\n        cin >> as[i];\n    }\n    for(int i = 0; i < N; ++i) {\n        cin >> ps[i];\n    }\n\n    long double ans = 0;\n    for(int pat = 1; pat < (1<<N); ++pat) {\n        vector<ULL> nums;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) nums.push_back(as[ord]);\n        }\n        ULL all_gcd = nums[0];\n        for(int i = 1; i < nums.size(); ++i) {\n            all_gcd = gcd(all_gcd, nums[i]);\n        }\n        long long part = M;\n        if(nums.size() > 1) {\n            nums[0] /= all_gcd;\n        }\n        for(int i = 0; i < nums.size(); ++i) {\n            part /= nums[i];\n        }\n        if(nums.size() % 2 == 0) part = -part;\n        //cout << part << endl;\n\n        long double prob = 1;\n        for(int ord = 0; ord < N; ++ord) {\n            if(pat & (1<<ord)) {\n                prob *= ps[ord]/100.0;\n            } else {\n                //prob *= (1 - ps[ord]/100.0);\n            }\n        }\n        ans += part * prob;\n    }\n\n    printf(\"%.8f\\n\", (double)ans);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// includes\n#include <bits/stdc++.h>\n\n// macros\n#define ll long long int\n#define pb emplace_back\n#define mk make_pair\n#define pq priority_queue\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define rep(i, n) FOR(i, 0, n)\n#define rrep(i, n) for(int i=((int)(n)-1);i>=0;i--)\n#define all(x) (x).begin(),(x).end()\n#define sz(x) ((int)(x).size())\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end())\n#define FI first\n#define SE second\nusing namespace std;\n\n//  types\ntypedef pair<int, int> P;\ntypedef pair<ll, int> Pl;\ntypedef pair<ll, ll> Pll;\ntypedef pair<double, double> Pd;\n \n// constants\nconst int inf = 1e9;\nconst ll linf = 1LL << 50;\nconst double EPS = 1e-10;\nconst int mod = 1e9 + 7;\n\n// solve\ntemplate <class T>bool chmax(T &a, const T &b){if(a < b){a = b; return 1;} return 0;}\ntemplate <class T>bool chmin(T &a, const T &b){if(a > b){a = b; return 1;} return 0;}\ntemplate <typename T> istream &operator>>(istream &is, vector<T> &vec){for(auto &v: vec)is >> v; return is;}\n\n/*\n * f(U) = \\sum_{U\\in T}(-1)^(|T\\U|)f(T)\n * for f(U) = \\sum_{U\\in T}f(T), use f[j | i] -= f[j];\n */\ntemplate <typename T>\nvoid fast_moebius(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j | i] -= f[j];\n      }\n    }\n  }\n}\n\n/*\n * f(U) = \\sum_{U\\in T}f(T)\n * for f(U) = \\sum_{T\\in U}f(T), use f[j | i] += f[j];\n */\ntemplate <typename T>\nvoid fast_zeta(vector<T> &f){\n  int n = f.size();\n  for(int i = 1; i < n; i<<=1){\n    for(int j = 0; j < n; j++){\n      if((j & i) == 0){\n        f[j] += f[j | i];\n      }\n    }\n  }\n}\n\nint main(int argc, char const* argv[])\n{\n  ios_base::sync_with_stdio(false);\n  cin.tie(0);\n  int n;\n  ll m;\n  cin >> n >> m;\n  vector<ll> a(n);\n  vector<int> p(n);\n  cin >> a >> p;\n  double res = 0.;\n  vector<ll> f((1 << n), 0);\n  vector<double> pr((1 << n), 0.);\n  for(int i = 0; i < (1 << n); i++){\n    ll tmp = 1;\n    double ptmp = 1.;\n    bool ng = false;\n    for(int j = 0; j < n; j++){\n      if((i >> j) % 2 == 1){\n        tmp *= a[j];\n        if(tmp > m){\n          ng = true;\n          tmp = 1;\n        }\n        ptmp *= (double)p[j] / 100.;\n      }else ptmp *= (1. - (double)p[j] / 100.);\n    }\n    if(i == 0)tmp = 0;\n    if(ng)tmp = 0;\n    f[i] = (tmp > 0 ? m / tmp: 0);\n    pr[i] = ptmp;\n  }\n  fast_moebius(f);\n  for(int i = 0; i < (1 << n); i++)res += pr[i] * (double)(abs(f[i]));\n  cout << setprecision(20);\n  cout << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nll cnt[(1<<20)+5],m,num[25];\nint n;\ndouble p[25];\nint main(){\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> num[i];\n\tfor(int i=0;i<n;i++){\n\t\tcin >> p[i]; p[i]/=100.;\n\t}\n\tfor(int i=1;i<(1<<n);i++){\n\t\tll N = 1LL; int B = __builtin_popcount(i);\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(!((i>>j)&1)) continue;\n\t\t\tif(8000000000000000000LL/N < num[j]) goto fail;\n\t\t\tN *= num[j];\n\t\t}\n\t\tif(B%2==1) cnt[i] = m/N;\n\t\telse cnt[i] = -1*(m/N); fail:;\n\t}\n\tfor(int i=0;i<n;i++) for(int j=0;j<(1<<n);j++){\n\t\tif(((j>>i)&1)) cnt[j] += cnt[j^(1<<i)];\n\t}\n\tdouble ans = 0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tdouble prob = 1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(((i>>j)&1)) prob *= p[j];\n\t\t\telse prob *= 1.0-p[j];\n\t\t}\n\t\tans += prob * cnt[i]; //cout << cnt[i] << \" \" << i << endl;\n\t}\n\tcout << setprecision(12) << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\n// 最大公約数\nlong long gcd(long long a, long long b){\n    while(b != 0){\n        long long tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\nint main()\n{\n    int n;\n    long long m;\n    cin >> n >> m;\n\n    vector<long long> a(n);\n    for(int i=0; i<n; ++i)\n        cin >> a[i];\n    vector<double> p(n);\n    for(int i=0; i<n; ++i){\n        cin >> p[i];\n        p[i] /= 100.0;\n    }\n\n    double ret = 0.0;\n    for(int i=1; i<(1<<n); ++i){\n        bitset<20> use(i);\n        long long x = 1; // 選択された数字の最小公倍数\n        for(int j=0; j<n; ++j){\n            if(use[j]){\n                x /= gcd(x, a[j]);\n                if(LLONG_MAX / x < a[j]){\n                    x = -1;\n                    break;\n                }\n                x *= a[j];\n            }\n        }\n\n        if(x == -1)\n            continue;\n        long long y = m / x; // xで割り切れる整数の個数\n\n        double q = 1.0;\n        for(int j=0; j<n; ++j){\n            if(use[j])\n                q *= p[j];\n        }\n\n        if(use.count() % 2 == 0)\n            ret -= y * q;\n        else\n            ret += y * q;\n    }\n\n    printf(\"%.10f\\n\", ret);\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\n#define HUGE_NUM 2000000000000000000\n\nstruct Info{\n\tll value;\n\tdouble P;\n};\n\nint N;\nint POW[21];\nll M;\nInfo info[21];\n\nll gcd(ll a,ll b){\n\n\tif(b == 0){\n\t\treturn a;\n\t}else{\n\t\treturn gcd(b,a%b);\n\t}\n}\n\nll lcm(ll a,ll b) {\n\tif(a < b)swap(a,b);\n    ll common = gcd(a,b);\n    a /= common;\n    if(a > HUGE_NUM/b) {\n        return -1;\n    }\n    return a*b;\n}\n\nint main(){\n\n\tfor(int i = 0; i < 21; i++)POW[i] = pow(2,i);\n\n\tscanf(\"%d %lld\",&N,&M);\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%lld\",&info[i].value);\n\t}\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%lf\",&info[i].P);\n\t\tinfo[i].P /= 100.0;\n\t}\n\n\tdouble ans = 0,group_P;\n\tint member_num;\n\tll common;\n\tvector<ll> G;\n\n\tfor(int state = 1; state < POW[N]; state++){\n\n\t\tmember_num = 0;\n\t\tgroup_P = 1.0;\n\t\tG.clear();\n\n\t\tfor(int loop = 0; loop < N; loop++){\n\t\t\tif(state & (1 << loop)){\n\n\t\t\t\tgroup_P *= info[loop].P;\n\t\t\t\tmember_num++;\n\t\t\t\tG.push_back(info[loop].value);\n\t\t\t}\n\t\t}\n\n\t\tcommon = 1;\n\n\t\tfor(int i = 0; i < member_num; i++){\n\n\t\t\tcommon = lcm(common,G[i]);\n\t\t\tif(common == -1)break;\n\t\t}\n\t\tif(common == -1)continue;\n\n\t\tif(member_num%2 == 0){\n\n\t\t\tans -= group_P*(M/common);\n\n\t\t}else{\n\n\t\t\tans += group_P*(M/common);\n\n\t\t}\n\t}\n\n\tprintf(\"%.10lf\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst ll INF=2e18;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nll gcd(ll a,ll b)\n{\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b)\n{\n\tif(a==INF || b==INF) return INF;\n\tif(a/gcd(a,b)>INF/b) return INF;\n\treturn a/gcd(a,b)*b;\n}\n\nint main()\n{\n\tfor(ll n,m;cin>>n>>m && n|m;){\n\t\tvi as(n);\n\t\trep(i,n) cin>>as[i];\n\t\tvd ps(n);\n\t\trep(i,n) cin>>ps[i],ps[i]/=100;\n\t\t\n\t\t// f(S): -1^|S| × (Sのどの要素でも割り切れる1<=x<=mの個数)\n\t\t// g(S): Sのいずれかの要素で割り切れる1<=x<=mの個数\n\t\tvl f(1<<n);\n\t\trepi(i,1,1<<n){\n\t\t\tll l=1;\n\t\t\trep(j,n) if(i>>j&1)\n\t\t\t\tl=lcm(l,as[j]);\n\t\t\tif(l==INF) continue;\n\t\t\t\n\t\t\tint sign=__builtin_popcount(i)&1?1:-1;\n\t\t\tf[i]+=sign*m/l;\n\t\t}\n\t\tvl g=f;\n\t\trep(i,n) rep(j,1<<n)\n\t\t\tif(j>>i&1)\n\t\t\t\tg[j]+=g[j^1<<i];\n\t\t\n\t\tdouble res=0;\n\t\trepi(i,1,1<<n){\n\t\t\tdouble p=1;\n\t\t\trep(j,n) p*=i>>j&1?ps[j]:1-ps[j];\n\t\t\tres+=p*g[i];\n\t\t}\n\t\tprintf(\"%.10f\\n\",res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\treturn a > c/b;\n}\n\nint64 gcd(int64 a, int64 b){\n\tif(b == 0) return a;\n\treturn gcd(b, a%b);\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1, luz=-1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1){\n\t\t\t\tif(luz == -1) luz = a[j];\n\t\t\t\telse luz = gcd(luz, a[j]);\n\t\t\t}\n\t\t}\n\t\tbool divided = 0;\n\t\tif(__builtin_popcount(i) == 1) divided = 1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !divided) a[j] /= luz;\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t\tif(i >> j & 1 && !divided){\n\t\t\t\ta[j] *= luz;\n\t\t\t\tdivided = 1;\n\t\t\t}\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define FORR(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n\n#define CHMIN(a,b) (a)=min((a),(b))\n#define CHMAX(a,b) (a)=max((a),(b))\n\n#define DEBUG(x) cout<<#x<<\": \"<<(x)<<endl\n\nint n;\nll m;\nll a[25];\nint p[25];\n\ndouble P[1<<20];\nll f[1<<20];\nll V[1<<20];\nconst ll INF = 1ll<<60;\n\nint main(){\n\tscanf(\"%d%lld\",&n,&m);\n\tREP(i,n)scanf(\"%lld\",a+i);\n\tREP(i,n)scanf(\"%d\",p+i);\n\t// P\n\tREP(msk,1<<n){\n\t\tP[msk] = 1.0;\n\t\tREP(i,n)P[msk] *= (double)((msk>>i&1)==1 ? p[i] : 100-p[i])/100.0;\n\t}\n\t// f\n\tFOR(msk,1,1<<n){\n\t\tll lcm = 1;\n\t\tREP(i,n)if(msk>>i&1){\n\t\t\tll mul = a[i] / __gcd(a[i], lcm);\n\t\t\t// lcm * mul >= 1<<60\n\t\t\t// mul >= (1<<60) / lcm\n\t\t\tCHMIN(mul, (INF+lcm-1)/lcm);\n\t\t\tlcm = lcm * mul;\n\t\t}\n\t\tf[msk] = m / lcm;\n\t\tif(__builtin_popcount(msk)%2==0)f[msk] = -f[msk];\n\t\t// DEBUG(f[msk]);\n\t}\n\t// V\n\tREP(msk,1<<n)V[msk] = f[msk];\n\tREP(i,n)REP(msk,1<<n)if(msk>>i&1)V[msk]+=V[msk^(1<<i)];\n\t// REP(msk,1<<n)DEBUG(V[msk]);\n\t// ans\n\tdouble ans = 0.0;\n\tREP(msk,1<<n)ans += P[msk]*V[msk];\n\tprintf(\"%.9f\\n\",ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\n\nint main()\n{\n\tint n;\n\tll m;\n\tcin >> n >> m;\n\tvector<ll> a(n);\n\tvector<int> p(n);\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> a[i];\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> p[i];\n\t}\n\tvector<ll> f(1 << n), lcm(1 << n, 1);\n\tfor (int i = 1; i < (1 << n); i++) {\n\t\tint t = i & (i - 1);\n\t\tint b = __builtin_ctz(i - t);\n\t\tlcm[i] = lcm[t];\n\t\tll tmp = a[b] / __gcd(lcm[i], a[b]);\n\t\tif (tmp > (m + lcm[i] - 1) / lcm[i]) {\n\t\t\tlcm[i] = m + 1;\n\t\t}\n\t\telse {\n\t\t\tlcm[i] *= tmp;\n\t\t}\n\t\tf[i] = (__builtin_popcount(i) & 1 ? 1 : -1) * m / lcm[i];\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tif ((j & (1 << i))) {\n\t\t\t\tf[j] += f[j ^ (1 << i)];\n\t\t\t}\n\t\t}\n\t}\n\tld res = 0;\n\tfor (int i = 0; i < (1 << n); i++) {\n\t\tld x = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif (i & (1 << j)) {\n\t\t\t\tx *= (ld)p[j] / 100;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tx *= (ld)(100 - p[j]) / 100;\n\t\t\t}\n\t\t}\n\t\tres += f[i] * x;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dp[1<<20];\nlong long c[20];\nint d[20];\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long C=a;\n\t\ta=b;\n\t\tb=C;\n\t}\n\treturn b;\n}\nlong long ABS(long long a){return max(a,-a);}\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",c+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",d+i);\n\tfor(int i=1;i<(1<<a);i++){\n\t\tlong long GCD=0LL;\n\t\tlong long m=1;\n\t\tfor(int j=0;j<a;j++){\n\t\t\tif(i&(1<<j)){\n\t\t\t\tGCD=gcd(m,c[j]);\n\t\t\t\tdouble lcm=m*c[j]/GCD;\n\t\t\t\tif(lcm>(double)b+0.001){\n\t\t\t\t\tm=b+1;\n\t\t\t\t}else m=m*c[j]/GCD;\n\t\t\t}\n\t\t}\n\t\tdp[i]=b/m;\n\t}\n\tfor(int i=0;i<a;i++)\n\t\tfor(int j=0;j<(1<<a);j++)\n\t\t\tif(j&(1<<i))dp[j]-=dp[j^(1<<i)];\n\tdouble ret=0;\n\tfor(int i=0;i<(1<<a);i++){\n\t\tdouble p=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))p*=0.01*d[j];else p*=0.01*(100-d[j]);\n\t\tret+=p*(ABS(dp[i]));\n\t}\n\tprintf(\"%.9f\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long gcd(long long a,long long b){\n\twhile(a){\n\t\tb%=a;\n\t\tlong long c=b;\n\t\tb=a;\n\t\ta=c;\n\t}\n\treturn b;\n}\nlong long v[20];\nint p[20];\nint main(){\n\tint a;\n\tlong long b;\n\tscanf(\"%d%lld\",&a,&b);\n\tfor(int i=0;i<a;i++)scanf(\"%lld\",v+i);\n\tfor(int i=0;i<a;i++)scanf(\"%d\",p+i);\n\tdouble ret=0;\n\tfor(int i=1;i<(1<<a);i++){\n\t\tdouble prob=1;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))prob*=0.01*p[j];//else prob*=0.01*(100-p[j]);\n\t\tlong long now=b;\n\t\tlong long G=0;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))G=gcd(G,v[j]);\n\t\tnow/=G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now/=v[j]/G;\n\t\tfor(int j=0;j<a;j++)if(i&(1<<j))now=-now;\n\t\tret+=prob*now;\n\t}\n\tprintf(\"%f\\n\",-ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\ntypedef pair<P,P> P2;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define fi first\n#define sc second\n#define rep(i,x) for(int i=0;i<x;i++)\n#define SORT(x) sort(x.begin(),x.end())\n#define ERASE(x) x.erase(unique(x.begin(),x.end()),x.end())\n#define POSL(x,v) (lower_bound(x.begin(),x.end(),v)-x.begin())\n#define POSU(x,v) (upper_bound(x.begin(),x.end(),v)-x.begin())\nll cnt[(1<<20)+5],m,num[25];\nint n;\ndouble p[25];\nint main(){\n\tcin >> n >> m;\n\tfor(int i=0;i<n;i++) cin >> num[i];\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%lf\",&p[i]); p[i]/=100.;\n\t}\n\tfor(int i=1;i<(1<<n);i++){\n\t\tll N = 1LL; int B = __builtin_popcount(i);\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(!((i>>j)&1)) continue;\n\t\t\tif(8000000000000000000LL/N < num[j]) goto fail;\n\t\t\tN = N/__gcd(N,num[j])*num[j];\n\t\t}\n\t\tif(B%2==1) cnt[i] = m/N;\n\t\telse cnt[i] = -1*(m/N); fail:;\n\t}\n\tfor(int i=0;i<n;i++) for(int j=0;j<(1<<n);j++){\n\t\tif(((j>>i)&1)) cnt[j] += cnt[j^(1<<i)];\n\t}\n\tdouble ans = 0.0;\n\tfor(int i=1;i<(1<<n);i++){\n\t\tdouble prob = 1.0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif(((i>>j)&1)) prob *= p[j];\n\t\t\telse prob *= 1.0-p[j];\n\t\t}\n\t\tans += prob * (double)cnt[i]; //cout << cnt[i] << \" \" << i << endl;\n\t}\n\tprintf(\"%.12f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#include<string>\n#include<stack>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> P;\ntypedef pair<int,P> P1;\n\n#define fr first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define rep(i,x) for(int i=0;i<x;i++)\n#define rep1(i,x) for(int i=1;i<=x;i++)\n#define rrep(i,x) for(int i=x-1;i>=0;i--)\n#define rrep1(i,x) for(int i=x;i>0;i--)\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\n#define mp1(a,b,c) P1(a,P(b,c))\n\nconst int INF=1000000000;\nconst int dir_4[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nconst int dir_8[8][2]={{1,0},{1,1},{0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1}};\n\nint digit_sum(int n){\n\tint ret = 0;\n\twhile(n > 0){\n\t\tret += n%2;\n\t\tn >>= 1;\n\t}\n\treturn ret;\n}\n\nll n,m;\nll a[22];\nld p[22];\nll gcd(ll x,ll y){\n\tif(y == 0)return x;\n\treturn gcd(y,x%y);\n}\nll lcm(ll x,ll y){\n\tif(x == -1)return x;\n\tx /= gcd(x,y);\n\tif(log((ld)x)+log((ld)y) > log((ld)m)+1)return -1;\n\treturn x*y;\n}\n\nint main(){\n\tcin >> n >> m;\n\trep(i,n)cin >> a[i];\n\trep(i,n)cin >> p[i];\n\trep(i,n)p[i] /= 100.0;\n\t\n\tld ret = 0.0;\n\trep1(i,(1<<n)-1){\n\t\tll LCM = 1;\n\t\tld pp = 1.0;\n\t\trep(j,n){\n\t\t\tif((i>>j)&1){\n\t\t\t\tLCM = lcm(LCM,a[j]);\n\t\t\t\tpp *= p[j];\n\t\t\t}\n\t\t}\n\t\tif(LCM != -1)ret += ((digit_sum(i)%2==1)?1.0:(-1.0))*(m/LCM)*pp;\n\t}\n\t\n\tprintf(\"%.10llf\\n\", ret);\n\t\n\t//cout.precision(20);\n\t//cout << ret+m << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) break;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 1.5e18) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define MAX_N 40\n#define INF 9000000000000000000\n#define MOD 1000000007\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,double> P;\n\nll n, m;\nll dp[(1<<20)];\nP a[20];\nvector<P> b;\n\nll gcd(ll x, ll y){\n    while(y){\n        x %= y;\n        swap(x,y);\n    }\n    return x;\n}\n\nint main(){\n    cin >> n >> m;\n    rep(i,n) cin >> a[i].first;\n    rep(i,n) cin >> a[i].second;\n    rep(i,n) a[i].second /= 100;\n    sort(a,a+n);\n    ll sanu = -1;\n    double prob = 1.0;\n    rep(i,n){\n        if(i == 0){\n            sanu = a[i].first;\n            prob *= (1-a[i].second);\n            continue;\n        }\n        if(a[i].first == sanu){\n            prob *= (1-a[i].second);\n        } else{\n            b.push_back(P(sanu,1-prob));\n            sanu = a[i].first;\n            prob = 1-a[i].second;\n        }\n    }\n    b.push_back(P(sanu,1-prob));\n    n = b.size();\n    rep(i,(1<<n)){\n        if(i == 0) continue;\n        int cnt = 0;\n        ll hoge = 1;\n        bool ok = true;\n        rep(j,n){\n            if(i&(1<<j)){\n                cnt++;\n                ll g = gcd(hoge,b[j].first);\n                hoge /= g;\n                if(INF/hoge < b[j].first/g){\n                    ok = false;\n                    break;\n                }\n                hoge = hoge*(b[j].first/g);\n            }\n        }\n        if(!ok) dp[i] = 0;\n        else dp[i] = m/hoge;\n        if(cnt%2 == 0) dp[i] *= -1;\n    }\n    rep(i,n) rep(j,(1<<n)){\n        if(j&(1<<i)){\n            dp[j] += dp[(j^(1<<i))];\n        }\n    }\n    double ans = 0.0;\n    rep(i,(1<<n)){\n        double prob = 1.0;\n        rep(j,b.size()){\n            if(i&(1<<j)){\n                prob *= b[j].second;\n            } else{\n                prob *= (1-b[j].second);\n            }\n        }\n        ans += prob*dp[i];\n    }\n    printf(\"%.9f\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????????????? < rep(j, 0, n) if(j & (1 << i)) f[j] -= f[j ^ (1 << i)]; >\n ????????????????????????????????? <rep(j, 0, n) if(j & (1 << i)) f[j] += f[j ^ (1 << i)];>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<long double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<long double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) continue;\n            if((i>>j)&1){\n                ll tmp = a[j] / gcd(LCM,a[j]);\n                if(1.0 * tmp * LCM < 1.5e18) LCM*=tmp;\n                else LCM = m+1;\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    long double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i])); // ??¶???????????¨???\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nll n, m, a[20], p[20], f[1 << 20];\n\nint main(){\n\tcin >> n >> m;\n\trep(i, n) cin >> a[i];\n\trep(i, n) cin >> p[i];\n\trep(i, 1 << n){\n\t\tll t = 1;\n\t\trep(j, n) if(i & 1 << j) t *= a[j] / __gcd(t, a[j]);\n\t\tf[i] = m / t;\n\t}\n\trep(i, n) rep(j, 1 << n) if(j & 1 << i) f[j] -= f[j ^ 1 << i];\n\t\n\tdouble ans = 0;\n\trep(i, 1 << n){\n\t\tlong double e = 1;\n\t\trep(j, n) e *= (i & 1 << j ? p[j] : 100 - p[j]) / 100.0;\n\t\tans += e * (m - abs(f[i]));\n\t}\n\tcout << fixed << setprecision(20) << ans << endl;\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1e9 + 7;\nconst ll INF = 1LL << 60;\nconst double PI = 3.141592653589793238;\nconst double EPS = 1e-10;\nll gcd(ll a, ll b) {\n\treturn b ? gcd(b, a % b) : a;\n}\n\nll lcm(ll a, ll b) {\n\treturn (ll)min(2e18l + 10, a / gcd(a, b) *1.0l* b);\n}\nll a[20];\ndouble p[20];\ndouble dp[1 << 20];\nint main() {\n\tint n;\n\tll m;\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) {\n\t\tcin >> p[i];\n\t\tp[i] /= 100;\n\t}\n\tfor (int bit = 1; bit < (1 << n); bit++) {\n\t\tll mul = 1;\n\t\tfor (int i = 0; i < n; i++) if (bit&(1 << i)) mul = lcm(mul, a[i]);\n\t\tdp[bit] = m / mul;\n\t}\n\tfor (int i = 0; i < n; i++) for (int bit = 0; bit < (1 << n); bit++) {\n\t\tif (bit&(1 << i)) dp[bit] -= dp[bit ^ (1 << i)];\n\t}\n\tdouble ans = 0;\n\tfor (int bit = 0; bit < (1 << n); bit++) {\n\t\tdouble prob = 1.0;\n\t\tfor (int i = 0; i < n; i++) if (bit&(1 << i)) prob *= p[i]; else prob *= 1 - p[i];\n\t\tans += prob * abs(dp[bit]);\n\t}\n\tprintf(\"%.15lf\\n\", ans);\n }\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nconst ll INF = 114514810;\nconst ll MOD = 1000000007;\nconst double EPS = 1e-8;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\nint dx[] = { -1, 0, 0, 1 }; int dy[] = { 0, -1, 1, 0 };\nbool valid(int x, int y, int h, int w) { return (x >= 0 && y >= 0 && x < h&&y < w); }\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nll n, m;\nll a[20]; int p[20];\ndouble ans;\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\n\nvoid calc(vi v)\n{\n\tif (v.size() == 0) return;\n\tdouble exp = 1;\n\tREP(i, n)\n\t{\n\t\tif (find(ALL(v), i) != v.end())\n\t\t{\n\t\t\texp *= p[i] / 100.0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\texp *= (100 - p[i]) / 100.0;\n\t\t}\n\t}\n\tll sum = 0;\n\tREP(i, 1 << v.size())\n\t{\n\t\tvi w;\n\t\tREP(j, v.size())\n\t\t{\n\t\t\tif ((i >> j) & 1 == 1) w.push_back(j);\n\t\t}\n\t\tif (w.size() == 0) continue;\n\t\tll lc = 1;\n\t\tREP(j, w.size())\n\t\t{\n\t\t\tlc = lcm(lc, a[v[w[j]]]);\n\t\t}\n\t\tsum += m / lc*(w.size() % 2 == 1 ? 1 : -1);\n\t}\n\tans += sum*exp;\n}\n\nvoid solve(int i, vi v)\n{\n\tif (i == n)\n\t{\n\t\tcalc(v);\n\t}\n\telse\n\t{\n\t\tsolve(i + 1, v);\n\t\tv.push_back(i);\n\t\tsolve(i + 1, v);\n\t}\n}\n\nint main()\n{\n\tcin >> n >> m;\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tans = 0;\n\tvi v;\n\tsolve(0, v);\n\n\tcout << D10 << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n#include <climits>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nll gcd(ll a, ll b){\n  return (a % b == 0) ? b : gcd(b, a % b);\n}\n\nint main(){\n  int N;\n  ll M;\n  while(cin >> N >> M){\n    vector<ll> a(N);\n    vector<int> p(N);\n    REP(i, N) cin >> a[i];\n    REP(i, N) cin >> p[i];\n    int F[1 << 20] = {};\n    // 包除原理 (チャレンジブック p.264)\n    FOR(S, 1, 1 << N){\n      int sign = (__builtin_popcount(S) % 2 == 0) ? -1 : 1;\n      ll lcm = 1;\n      for (int i = 0; i < N; i++) if(S >> i & 1){\n        lcm /= gcd(lcm, a[i]);\n        if(LLONG_MAX / lcm < a[i]){\n          lcm = LLONG_MAX;\n          break;\n        }\n        lcm *= a[i];\n      }\n      F[S] = sign * (M / lcm);\n    }\n    // 高速ゼータ変換 (http://topcoder.g.hatena.ne.jp/iwiwi/20120422/1335065228)\n    REP(i, N)REP(S, 1 << N){\n      if(0 == (S & (1 << i))){\n        F[S | 1 << i] += F[S];\n      }\n    }\n    double ans = 0;\n    REP(S, 1 << N){\n      double prob = 1;\n      REP(i, N) {\n        if(S >> i & 1) prob *= p[i] / 100.0;\n        else prob *= (100.0 - p[i]) / 100.0;\n      }\n      ans += prob * F[S];\n    }\n    printf(\"%.8lf\\n\", ans);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  long long int n,m;\n  cin>>n>>m;\n  vector<long long int> a(n);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  \n  auto val=[&](int comb){\n    if(comb==0) return 0LL;\n    long long int res=1;\n    for(int i=0;i<n;i++){\n      if(comb&(1<<i)){\n\tdouble buf=double(res)*a[i];\n\tif(buf>1e18+3){\n\t  return 0LL;\n\t}\n\tres*=a[i];\n      }\n    }\n    return m/res;\n  };\n  \n  double res=0;\n  for(int i=0;i<(1<<n);i++){\n    int cnt=0;\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i & (1<<j)){\n\tpos*=double(p[j])/100;\n\tcnt++;\n      }\n    }\n    res+=pos*val(i)*((cnt%2)*2-1);\n  }\n  cout<<fixed<<setprecision(10);\n  cout<<res<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // counting\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if((i>>j)&1){\n                LCM = lcm(LCM,a[j]);\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i]));\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nlong long int n,m;\nvector<long long int> a;\n\nvector<long long int> vals;\n\nlong long int val(int comb){\n  if(vals[comb]!=-1) return vals[comb];\n  long long int num=1;\n  for(int i=0;i<n;i++){\n    if(comb&(1<<i)){\n      double buf=double(num)*a[i];\n      if(buf>1e18+3){\n\treturn vals[comb]=0;\n      }\n      num*=a[i];\n    }\n  }\n  return vals[comb]=m/num;\n}\n\nint main(){\n  cin>>n>>m;\n  a.resize(n);\n  vals.resize(1<<n,-1);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  vector<long long int> dp(1<<n,0);\n  dp[0]=0;\n  for(int i=1;i<=n;i++){\n    int comb=(1<<i)-1;\n    while(comb<(1<<n)){\n      //renew dp[comb]\n      for(int j=1;j<i;j++){\n\tint comb2=(1<<j)-1;\n\twhile(comb2<(1<<i)){\n\t  int cnt=0;\n\t  int comb3=0;\n\t  for(int k=0;k<n;k++){\n\t    if(comb&(1<<k)){\n\t      if(comb2&(1<<cnt)){\n\t\tcomb3+=(1<<k);\n\t\tcnt++;\n\t      }\n\t      else cnt++;\n\t    }\n\t  }\n\n\t  dp[comb]+=val(comb3)*((j%2)*2-1);\n\t  int x=comb2&-comb2,y=comb2+x;\n\t  comb2=((comb2&~y)/x>>1)|y;\n\t}\n      }\n      long long int pat=val(comb);\n      dp[comb]+=pat*((i%2)*2-1);\n\n      int x=comb&-comb,y=comb+x;\n      comb=((comb&~y)/x>>1)|y;\n    }\n  }\n  double res=0;\n\n  for(int i=0;i<(1<<n);i++){\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i&(1<<j)){\n\tpos*=(double(p[j])/100);\n      }\n      else{\n\tpos*=(double(100-p[j])/100);\n      }\n    }\n    res+=dp[i]*pos;\n  }\n  cout<<setprecision(10)<<fixed;\n  cout<<res<<endl;\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n <url:https://github.com/kei1107/algorithm/blob/master/template/template_for_problems.cpp>\n ?????????============================================================\n n????????´??°a1, a2, ???, an??¨n????????´??°p1, p2, ???, pn?????´??°m?????????????????????\n k???????????´??°ak???pk[%]????¢??????§?????¶?????¨??????????????????k(1 ??? k ??? n)?????????????????????\n 0?????\\???n?????\\????????´??°??????????????????1??\\???m??\\????????´??°????????§???\n ?????°????????´??°????°?????????¨???1?????§?????????????????????????????°????????????????±??????????\n =================================================================\n ?§£??¬=============================================================\n ????????????( := ????????????????????????)\n ================================================================\n \n \n <reference:http://d.hatena.ne.jp/simezi_tan/20130522/1369203086>\n \n ???????????????????????????\n */\n\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ll n,m; cin >> n >> m;\n    vector<ll> a(n);\n    vector<double> p(n);\n    for(auto &x:a) cin >> x;\n    for(auto &x:p) {\n        cin >> x;\n        x/=100;\n    }\n    \n    // Preprocessing\n    // probability\n    // ??????????±???????????????????????????£??????????????????\n    vector<double> dp1((1<<n),1.0);\n    for(int i = 0; i < n;i ++){\n        for(int j = 0; j < (1<<n);j++){\n            if((j>>i)&1){\n                dp1[j] *= p[i];\n            }else{\n                dp1[j] *= (1-p[i]);\n            }\n        }\n    }\n    \n    // counting\n    \n    // ????????????????????????\n    /* ?????????????????? +=??¨?????? -=???????????°??????*/\n    vector<ll> dp2((1<<n),0);\n    for(int i = 0; i <(1<<n);i++){\n        ll LCM = 1;\n        for(int j = 0; j < n;j++){\n            if(LCM > m) continue;\n            if((i>>j)&1){\n                LCM = lcm(LCM,a[j]);\n            }\n        }\n        dp2[i] = m/LCM;\n    }\n    for(int i = 0; i < n;i++){\n        for(int j = 0;j < (1<<n);j++){\n            if((j>>i)&1){\n                dp2[j] -= dp2[j^1 << i];\n            }\n        }\n    }\n    \n    double res = 0;\n    for(int i = 0; i < (1<<n);i++){\n        res += dp1[i] * (m - abs(dp2[i]));\n    }\n    cout << fixed << setprecision(10) << res << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint n;\nll m;\nll a[20];\nlong double P[20];\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll lcm(ll a, ll b) {\n\tll g = gcd(a, b);\n\treturn a / g * b;\n}\n\n/*\nll count(vector<int>& v) {\n\tll ret = 0;\n\tint N = v.size();\n\tfor (int k = 1; k < (1 << N); ++k) {\n\t\tll s = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tif (k & (1 << i)) s *= a[v[i]];\n\t\t}\n\t\tret += (__builtin_popcount(k) % 2 ? 1 : -1) * (m / s);\n\t}\n\treturn ret;\n}\n*/\n\nint main() {\n\tcin >> n >> m;\n\tint N = 1 << n;\n\tfor (int i = 0; i < n; ++i) cin >> a[i];\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> P[i];\n\t\tP[i] /= 100;\n\t}\n\n\tlong double ans = 0;\n\tfor (int k = 1; k < N; ++k) {\n\t\tvector<int> v;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) v.push_back(i);\n\t\t}\n\t\tlong double p = 1;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tif (k & (1 << i)) p *= P[i];\n//\t\t\telse p *= 1 - P[i];\n\t\t}\n\t\tll s = 1;\n\t\tfor (int i = 0; i < v.size(); ++i) {\n\t\t\ts *= a[v[i]];\n\t\t}\n\n\t\tint f = __builtin_popcount(k) % 2 ? 1 : -1;\n//\t\tcout << k << \" \" << p << \" \" << v.size() << \" \" << count(v) << endl;\n\t\tans += f * p * (m / s);\n\t}\n\tprintf(\"%.10Lf\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing ld = long double;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\nint64 n, m;\nvector<int64> a;\nvector<ld> p;\nvector<int64> dp;\n\nbool over(int64 a, int64 b, int64 c){\n\treturn a > c/b;\n}\n\nint64 gcd(int64 a, int64 b){\n\tif(b == 0) return a;\n\treturn gcd(b, a%b);\n}\n\nint main(void){\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i, n) cin >> a[i];\n\tREP(i, n) cin >> p[i];\n\tdp.resize(1 << n, 0);\n\tFOR(i, 1, 1 << n){\n\t\tbool ok = true;\n\t\tint64 mul = 1, luz=-1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1){\n\t\t\t\tif(luz == -1) luz = a[j];\n\t\t\t\telse luz = gcd(luz, a[j]);\n\t\t\t}\n\t\t}\n\t\tbool divided = 0;\n\t\tif(__builtin_popcount(i) == 1) divided = 1;\n\t\tREP(j, n){\n\t\t\tif(i >> j & 1 && !divided){\n\t\t\t\ta[j] /= luz;\n\t\t\t\tdivided = 1;\n\t\t\t}\n\t\t\tif(i >> j & 1 && !over(mul, a[j], m)) mul *= a[j];\n\t\t\telse if(i >> j & 1 && over(mul, a[j], m)) ok = false;\n\t\t}\n\t\tif(ok) dp[i] = m/mul;\n\t\telse dp[i] = 0;\n\t}\n\n\tREP(i, n){\n\t\tREP(j, 1 << n) if(j >> i & 1) dp[j] -= dp[j^(1 << i)];\n\t}\n\tld res = 0;\n\tREP(i, 1 << n){\n\t\tdp[i] = abs(dp[i]);\n\t\tld po = 1;\n\t\tREP(j, n){\n\t\t\tpo *= (i >> j & 1 ? p[j] : 100-p[j])/100;\n\t\t}\n\t\tres += dp[i]*po;\n\t}\n\tcout << fixed << setprecision(10) << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint64_t gcd(int64_t a, int64_t b) {\n  if (a<b) return gcd(b,a);\n  if (b) return gcd(b,a%b);\n  return a;\n}\n\nint64_t lcm(int64_t a, int64_t b) {\n  return a/gcd(a,b)*b;\n}\n\nint main() {\n  int64_t n,m;\n  cin>>n>>m;\n  vector<int64_t> a(n), p(n);\n  REP(i,n) cin>>a[i];\n  REP(i,n) cin>>p[i];\n  vector<int64_t> f(1<<n,m);\n  vector<long double> e(1<<n,1);\n  REP(i,1<<n){\n    int64_t li = 1;\n    REP(j,n) {\n      if ((i>>j)&1) {\n        f[i] /= a[j]/gcd(li, a[j]);\n        if (f[i] == 0) break;\n        li *= a[j]/gcd(li, a[j]);\n      }\n    }\n  }\n  f[0] = 0;\n  long double res = 0.0;\n  REP(i,n) {\n    REP(j,1<<n){\n      if((j>>i)&1) {\n        e[j] *= 0.01 * p[i];\n        f[j]-=f[j^(1<<i)];\n      } else {\n        e[j] *= 0.01 * (100 - p[i]);\n      }\n    }\n  }\n  REP(i,1<<n) {\n    res += e[i] * abs(f[i]);\n  }\n  cout << setprecision(10) << fixed << res << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> l_l;\ntypedef pair<int, int> i_i;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\n\nll LCM[1 << 20];\nll dp[1<<20];\nll n, m;\nll a[20];\nlong double p[20];\n\nll MyLCM(ll a, ll b) {\n    ll g = __gcd(a, b);\n    if(a / g > 2e18 / b) return 2e18;\n    else return a / g * b;\n}\n\nint main() {\n    //cout.precision(10);\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> n >> m;\n    for(int i = 0; i < n; i++) {\n        cin >> a[i];\n    }\n    for(int i = 0; i < n; i++) {\n        cin >> p[i];\n        p[i] /= 100;\n    }\n    for(int bits = 0; bits < (1 << n); bits++) {\n        LCM[bits] = 1;\n        for(int i = 0; i < n; i++) {\n            if(bits & (1 << i)) {\n                LCM[bits] = MyLCM(LCM[bits], a[i]);\n            }\n        }\n        dp[bits] = m / LCM[bits];\n        //cerr << bits << \" \" << LCM[bits] << \" \" << dp[bits] << endl;\n    }\n    for(int i = 0; i < n; i++) {\n        for(int j = 0; j < (1 << n); j++) {\n            if(!(j & (1 << i))) {\n                dp[j] -= dp[j | (1 << i)];\n            }\n        }\n    }\n    for(int bits = 0; bits < (1 << n); bits++) {\n        //cerr << bits << \" \" << LCM[bits] << \" \" << dp[bits] << endl;\n    }\n    long double ans = 0.0;\n    for(int bits = 0; bits < (1 << n); bits++) {\n        long double compliment = 1;\n        for(int i = 0; i < n; i++) {\n            if(bits & (1 << i)) compliment *= (1 - p[i]);\n        }\n        ans += (1 - compliment) * dp[bits];\n    }\n    cout << fixed << setprecision(100) << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst ll INF=2e18;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nll gcd(ll a,ll b)\n{\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b)\n{\n\tif(a==INF || b==INF) return INF;\n\tif(a/gcd(a,b)>INF/b) return INF;\n\treturn a/gcd(a,b)*b;\n}\n\nint main()\n{\n\tfor(int n,m;cin>>n>>m && n|m;){\n\t\tvi as(n);\n\t\trep(i,n) cin>>as[i];\n\t\tvd ps(n);\n\t\trep(i,n) cin>>ps[i],ps[i]/=100;\n\t\t\n\t\t// f(S): -1^|S| × (Sのどの要素でも割り切れる1<=x<=mの個数)\n\t\t// g(S): Sのいずれかの要素で割り切れる1<=x<=mの個数\n\t\tvl f(1<<n);\n\t\trepi(i,1,1<<n){\n\t\t\tll l=1;\n\t\t\trep(j,n) if(i>>j&1)\n\t\t\t\tl=lcm(l,as[j]);\n\t\t\tif(l==INF) continue;\n\t\t\t\n\t\t\tint sign=__builtin_popcount(i)&1?1:-1;\n\t\t\tf[i]+=sign*m/l;\n\t\t}\n\t\tvl g=f;\n\t\trep(i,n) rep(j,1<<n)\n\t\t\tif(j>>i&1)\n\t\t\t\tg[j]+=g[j^1<<i];\n\t\t\n\t\tdouble res=0;\n\t\trepi(i,1,1<<n){\n\t\t\tdouble p=1;\n\t\t\trep(j,n) p*=i>>j&1?ps[j]:1-ps[j];\n\t\t\tres+=p*g[i];\n\t\t}\n\t\tprintf(\"%.10f\\n\",res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long int;\n\nint main() {\n    ll N, M; cin >> N >> M;\n    \n    vector<ll> A(N), P(N), MSB(N);\n    for(int i=0; i<N; i++) {\n        cin >> A[i];\n\n        for(int k=0; k<62; k++) {\n            if(A[i] >> k & 1) {\n                MSB[i] = k;\n            }\n        }\n    }\n    for(int i=0; i<N; i++) {\n        cin >> P[i];\n    }\n\n    vector<ll> divisor(1 << N), popcnt(1 << N);\n    for(int bit=0; bit<(1<<N); bit++) {\n        popcnt[bit] = __builtin_popcountll(bit);\n\n        bool overflow = false;\n        ll msb_sum = 0, mul = 1;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                msb_sum += MSB[i];\n                if(msb_sum >= 61) {\n                    // printf(\"msb_sum = %lld\\n\", msb_sum);\n                    overflow = true;\n                    break;\n                }\n                else {\n                    mul = mul * A[i] / __gcd(mul, A[i]);\n                }\n            }\n        }\n\n        if(!overflow) {\n            // printf(\"mul = %lld\\n\", mul);\n            divisor[bit] = M / mul;\n        }\n    }\n\n    divisor[0] = 0;\n    for(int i=0; i<N; i++) {\n        for(int bit=0; bit<(1<<N); bit++) {\n            if(bit >> i & 1) divisor[bit] -= divisor[bit ^ (1 << i)];\n        }\n    }\n\n    long double ans = 0;\n    for(int bit=0; bit<(1<<N); bit++) {\n        long double prob = 1.0;\n        for(int i=0; i<N; i++) {\n            if(bit >> i & 1) {\n                prob *= 1.0 * P[i];\n            }\n            else {\n                prob *= 1.0 * (100 - P[i]);\n            }\n        }\n\n        // printf(\"bit = %d, prob = %.12f, sum = %.12f\\n\", bit, prob, sum);\n        // printf(\"bit = %d, odd = %lld, even = %lld\\n\", bit, odd[bit], even[bit]);\n        // ll sum = odd[bit] - even[bit];\n        ll sum = llabs(divisor[bit]);\n        ans += prob * sum;\n    }\n    printf(\"%.12Lf\\n\", ans / pow(100, N));\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll gcd(ll a, ll b) {\n\tif (b == 0) return a;\n\treturn gcd(b, a % b);\n}\nll n, m;\nvector<ll> a;\nvector<ld> p;\nvector<ll> dp[(1ll << 20)];\n\nld solve() {\n\tcin >> n >> m;\n\ta.resize(n); p.resize(n);\n\tREP(i,n) cin >> a[i]; REP(i,n) cin >> p[i]; REP(i,n) p[i] /= 100;\n\tld ans = 0;\n\tdp[0].pb(0);\n\tFOR(bit,1,(1ll << n)) {\n\t\tbitset<31> bi(bit);\n\t\tld prob = 1; vector<ll> v;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tv.pb(a[i]); \n\t\t\t\tprob *= p[i];\n\t\t\t} else prob *= (1 - p[i]);\n\t\t}\n\t\tll g = v[0];\n\t\tFOR(i,1,v.size()) {\n\t\t\tll tmp = gcd(g, v[i]);\n\t\t\tg = tmp * (g / tmp) * (v[i] / tmp);\n\t\t}\n\t\tif(bi.count() % 2) dp[bit].pb(m / g);\n\t\telse dp[bit].pb(-(m / g));\n\t\tll sum = 0;\n\t\tREP(i,n) {\n\t\t\tif(bi[i]) {\n\t\t\t\tdp[bit].pb(dp[bit].back() + dp[bit ^ (1 << i)][sum]);\n\t\t\t\tsum++;\n\t\t\t}\n\t\t}\n\t\tans += prob * dp[bit].back();\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(39) << solve() << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n__int128 gcd(__int128 a,__int128 b){return (a==0 ? b : gcd(b%a,a));}\n\nint main(){\n  long long int n,m;\n  cin>>n>>m;\n  vector<long long int> a(n);\n  for(int i=0;i<n;i++) cin>>a[i];\n  vector<int> p(n);\n  for(int i=0;i<n;i++) cin>>p[i];\n  \n  auto val=[&](int comb){\n    if(comb==0) return 0LL;\n    __int128 res=1;\n    for(int i=0;i<n;i++){\n      if(comb&(1<<i)){\n\tres=(res*a[i]/gcd(res,a[i]));\n\tif(res>1e18+3){\n\t  return 0LL;\n\t}\n      }\n    }\n    return static_cast<long long int>(m/res);\n  };\n  \n  double res=0;\n  for(int i=0;i<(1<<n);i++){\n    int cnt=0;\n    double pos=1;\n    for(int j=0;j<n;j++){\n      if(i & (1<<j)){\n\tpos*=double(p[j])/100;\n\tcnt++;\n      }\n    }\n    res+=pos*val(i)*((cnt%2)*2-1);\n  }\n  cout<<fixed<<setprecision(10);\n  cout<<res<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nll gcd(ll a, ll b){\n  return (a % b == 0) ? b : gcd(b, a % b);\n}\n\nint main(){\n  int N;\n  ll M;\n  while(cin >> N >> M){\n    vector<ll> a(N);\n    vector<int> p(N);\n    REP(i, N) cin >> a[i];\n    REP(i, N) cin >> p[i];\n    int F[1 << 20] = {};\n    // 包除原理 (チャレンジブック p.264)\n    FOR(S, 1, 1 << N){\n      int sign = (__builtin_popcount(S) % 2 == 0) ? -1 : 1;\n      ll lcm = 1;\n      for (int i = 0; i < N; i++) if(S >> i & 1){\n        lcm /= gcd(lcm, a[i]);\n        if(LLONG_MAX / lcm < a[i]){\n          lcm = LLONG_MAX;\n          break;\n        }\n        lcm *= a[i];\n      }\n      F[S] = sign * (M / lcm);\n    }\n    // 高速ゼータ変換 (http://topcoder.g.hatena.ne.jp/iwiwi/20120422/1335065228)\n    REP(i, N)REP(S, 1 << N){\n      if(0 == (S & (1 << i))){\n        F[S | 1 << i] += F[S];\n      }\n    }\n    double ans = 0;\n    REP(S, 1 << N){\n      double prob = 1;\n      REP(i, N) {\n        if(S >> i & 1) prob *= p[i] / 100.0;\n        else prob *= (100.0 - p[i]) / 100.0;\n      }\n      ans += prob * F[S];\n    }\n    printf(\"%.8lf\\n\", ans);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong double dp[2 << 20][2], prev_[2 << 20][2];\nlong long n, m, a[22]; long double p[22];\n\nlong long gcd(long long a1, long long b1) {\n\tif (b1 == 0) return a1;\n\treturn gcd(b1, a1%b1);\n}\n\nint main() {\n\tcin >> n >> m;\n\tfor (int i = 0; i < n; i++) cin >> a[i];\n\tfor (int i = 0; i < n; i++) { cin >> p[i]; p[i] *= 0.01; }\n\tprev_[0][0] = 1;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t// パターン 1 : 何も取らない\n\t\t\tdp[j][0] += prev_[j][0] * (1.0L - p[i]);\n\t\t\tdp[j][1] += prev_[j][1] * (1.0L - p[i]);\n\n\t\t\t// パターン 2 : 取るが包除はしない\n\t\t\tdp[j][0] += prev_[j][0] * p[i];\n\t\t\tdp[j][1] += prev_[j][1] * p[i];\n\n\t\t\t// パターン 3 : 取って包除もする\n\t\t\tdp[j + (1 << i)][1] += prev_[j][0] * p[i];\n\t\t\tdp[j + (1 << i)][0] += prev_[j][1] * p[i];\n\t\t}\n\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\tprev_[j][0] = dp[j][0]; dp[j][0] = 0;\n\t\t\tprev_[j][1] = dp[j][1]; dp[j][1] = 0;\n\t\t}\n\t}\n\tlong double ans = 0;\n\tfor (int i = 1; i < (1 << n); i++) {\n\t\tlong long F = 1;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tif ((i / (1 << j)) % 2 == 0) continue;\n\t\t\tlong long G = gcd(F, a[j]);\n\t\t\tif (log2(1.0L*F) + log2(1.0L*a[j]) - log2(1.0L*G) >= 60) { F = (1LL << 60); break; }\n\t\t\tF = F / G * a[j];\n\t\t}\n\t\tlong long A = m / F;\n\t\tans -= 1.0L*A*prev_[i][0];\n\t\tans += 1.0L*A*prev_[i][1];\n\t}\n\tprintf(\"%.12Lf\\n\", ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\ntypedef long long ll;\ntypedef long double ld;\n#define INF 1LL<<60\nll gcd(ll a, ll b) { return a ? gcd(b%a, a) : b; }\nll lcm(ll a, ll b) {\n    if (a == INF) return INF;\n    if (b == INF) return INF;\n    a /= gcd(a, b);\n\n    ld aa = log10l(a);\n    ld bb = log10l(b);\n\n    if (log10l(INF) <= aa + bb) return INF;\n\n    return a * b;\n}\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\ntypedef long double ld;\n#define INF 1LL<<60\nint N; ll M; ll A[20]; ld P[20];\nll f[1 << 20];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> M;\n    rep(i, 0, N) cin >> A[i];\n    rep(i, 0, N) {\n        int x; cin >> x;\n        P[i] = x / 100.0;\n    }\n\n    // f[mask] := ??¨?????????mask??¨?????§????????????????????°\n    rep(mask, 1, 1 << N) {\n        ll lc = 1;\n        rep(i, 0, N) if(mask & (1 << i)) lc = lcm(lc, A[i]);\n        f[mask] = M / lc;\n    }\n\n    // ????????????????????????????????\\??????????????????????????????\n    // f[mask] := ??¨?????????mask?????????????????§????????????????????°\n    rep(i, 0, N) rep(j, 0, 1 << N) if (j & (1 << i)) f[j] -= f[j ^ (1 << i)];\n\n    ld ans = 0;\n    rep(mask, 0, 1 << N) {\n        ld p = 1;\n        rep(i, 0, N) {\n            if (mask & (1 << i)) p *= P[i];\n            else p *= 1 - P[i];\n        }\n\n        ans += (ld)abs(f[mask]) * p;\n    }\n    printf(\"%.10llf\\n\", ans);\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2446: Enumeration\n// 2017.11.26 bal4u@uu\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\nlong long a[22];\nint p[22];\n\nlong long gcd(long long a, long long b)\n{\n\tlong long r;\n\twhile (b != 0) r = a % b, a = b, b = r;\n\treturn a;\n}\n\nint main()\n{\n\tint n, i, j, f, lim;\n\tlong long m, t;\n\tdouble ans, pp;\n\n\tscanf(\"%d%lld\", &n, &m);\n\tfor (i = 0; i < n; i++) scanf(\"%lld\", a+i);\n\tfor (i = 0; i < n; i++) scanf(\"%d\", p+i);\n\t\n\tans = 0;\n\tfor (lim = 1 << n, i = 1; i < lim; i++) {\n\t\tf = 0, pp = 1;\n\t\tfor (t = 1, j = 0; j < n; j++) if ((i >> j) & 1) {\n\t\t\tf++, pp *= p[j] / 100.0;\n\t\t\tt /= gcd(t, a[j]);\n\t\t\tif (t > (1LL<<62)/a[j]) { t = -1; break; }\n\t\t\tt *= a[j];\n\t\t}\n\t\tif (t > 0) {\n\t\t\tif (f & 1) ans += pp * (m / t);\n\t\t\telse       ans -= pp * (m / t);\n\t\t}\n\t}\n\tprintf(\"%.10lf\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2446: Enumeration\n// 2017.11.26 bal4u@uu\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\nlong long a[22];\nint p[22];\n\nlong long gcd(long long a, long long b)\n{\n\tlong long r;\n\twhile (b != 0) r = a % b, a = b, b = r;\n\treturn a;\n}\n\nint main()\n{\n\tint n, i, j, f, lim;\n\tlong long m, t;\n\tdouble ans, pp;\n\n\tscanf(\"%d%lld\", &n, &m);\n\tfor (i = 0; i < n; i++) scanf(\"%lld\", a+i);\n\tfor (i = 0; i < n; i++) scanf(\"%d\", p+i);\n\t\n\tans = 0;\n\tfor (lim = 1 << n, i = 1; i < lim; i++) {\n\t\tf = 0, pp = 1;\n\t\tfor (j = 0; j < n; j++) if ((i >> j) & 1) { f++, pp *= p[j]/100.0; }\n\t\tfor (t = 1, j = 0; j < n; j++) {\n\t\t\tif ((i >> j) & 1) {\n//\t\t\t\tt = t / gcd(t, a[j]) * a[j];\n\t\t\t\tt /= gcd(t, a[j]);\n\t\t\t\tif (t > (1LL<<62)/a[j]) { t = -1; break; }\n\t\t\t\tt *= a[j];\n\t\t\t}\n\t\t}\n\t\tif (t > 0) {\n\t\t\tif (f & 1) ans += pp * (m / t);\n\t\t\telse       ans -= pp * (m / t);\n\t\t}\n\t}\n\tprintf(\"%.10lf\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 2445\n  Title:Enumeration\n  @kankichi573\n*/\n#include <stdio.h>\n#include <float.h>\n\nint n,m,a[20],p[20];  \n\nint gcd(int a, int b)\n{\n        int c;\n        while (b > 0) {\n                c = a % b;\n                a = b;\n                b = c;\n        }\n        return a;\n}\nint lcm(int a, int b)\n{\n  return a/gcd(a,b)*b;\n}\n\nint get_parity(int bit_pattern)\n{\n  int i,ret;\n\n  for(i=ret=0;i<n;i++)\n    ret += (bit_pattern & (1<<i))?1:0;\n  return((ret & 1)?1:(-1));\n}\n\nint bit_count(int bit_pattern)\n{\n  int i,ret;\n\n  for(i=ret=0;i<n;i++)\n    ret += (bit_pattern & (1<<i))?1:0;\n  return(ret);\n}\n\ndouble prob(int p[],int bit_pattern)\n{\n  int i;\n  double ret;\n\n  for(i=0,ret=1.0;i<n;i++)\n    if(bit_pattern & (1<<i))\n      ret *= (p[i]/100.0);\n    else\n      ret *= ((100-p[i])/100.0);\n  return(ret);\n}\n \n\nint lcms(int a[],int bit_pattern)\n{\n  int i,ret;\n  for(i=0,ret=1;i<n;i++)\n    if(bit_pattern & (1<<i))\n      ret = lcm(ret,a[i]);\n  return(ret);\n}\n\nint divisor_count(int a[],int m,int bit_pattern)\n{\n  int i,ret,all1;\n\n  all1=((1<<n)-1);\n\n  for(i=1,ret=0;i<(1<<n);i++)\n    if((i &  (all1 ^ bit_pattern)) == 0) ///\n      {\n\t//printf(\"%d(%d)[%d]|\",i,get_parity(i),m/lcms(a,i));\n\tret += m/lcms(a,i)*get_parity(i);\n      }\n  return(ret);\n}\n\nmain()\n{\n  int i;\n  double ret;\n  n=16;\n\n  scanf(\"%d %d\",&n,&m);\n  for(i=0;i<n;i++)\n    scanf(\"%d\",&a[i]);\n  for(i=0;i<n;i++)\n    scanf(\"%d\",&p[i]);\n\n  for(i=1,ret=0;i<(1<<n);i++)\n    {\n#ifdef DEBUG\n      printf(\"%d %d|\",i,lcms(a,i));\n      printf(\"%d|\",divisor_count(a,m,i));\n      printf(\"%lf\\n\",prob(p,i));\n#endif\n      ret += divisor_count(a,m,i)*prob(p,i);\n    }\n  \n  printf(\"%lf\\n\",ret);\n  return(0);\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\tlong g = gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a / gcd(a, b) * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\n\t\tdouble[] p = new double[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextDouble() / 100.0;\n\n\t\tlong[] cnt = new long[1 << n];\n\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif ((i & (1 << j)) > 0) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif ((j & (1 << i)) > 0) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tdouble pro = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif ((i & (1 << j)) > 0) {\n\t\t\t\t\tpro *= p[j];\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (1 - p[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += Math.abs(cnt[i]) * pro;\n\t\t}\n\t\tSystem.out.println(ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta = a / gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a / gcd(a, b) * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = a[y] * lcm[i ^ x] / gcd(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = m / lcm[i];\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tout.println(ret);\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.math.BigDecimal;\nimport java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\tBigDecimal[] p = new BigDecimal[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100), mc);\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tBigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tpro = pro.multiply(p[j], mc);\n\t\t\t\t} else {\n\t\t\t\t\tpro = pro.multiply(BigDecimal.ONE.subtract(p[j], mc), mc);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = ans.add(pro, mc);\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.lang.*;\nimport java.math.*;\nimport java.io.*;\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\n \n// Enumeration\n// 2012/09/19\npublic class Main{\n    Scanner sc=new Scanner(System.in);\n \n    int n;\n    long m;\n    long[] a;\n    int[] p;\n \n    void run(){\n        n=sc.nextInt();\n        m=sc.nextLong();\n        a=new long[n];\n        for(int i=0; i<n; i++){\n            a[i]=sc.nextLong();\n        }\n        p=new int[n];\n        for(int i=0; i<n; i++){\n            p[i]=sc.nextInt();\n        }\n        solve();\n    }\n \n    void solve(){\n        long[] f=new long[1<<n];\n        for(int s=0; s<1<<n; s++){\n            long lcm=1;\n            for(int i=0; i<n; i++){\n                if((s>>i&1)==1){\n                    lcm=lcm(lcm, a[i]);\n                }\n            }\n            if(lcm!=0){\n                f[s]=m/lcm;\n            }\n        }\n        f[0]=0;\n \n        for(int i=0; i<n; i++){\n            for(int s=0; s<1<<n; s++){\n                if((s>>i&1)==1){\n                    f[s]-=f[s^(1<<i)];\n                }\n            }\n        }\n \n        double ans=0;\n        for(int s=0; s<1<<n; s++){\n            f[s]=abs(f[s]);\n            double E=f[s];\n            for(int i=0; i<n; i++){\n                if((s>>i&1)==1){\n                    E*=p[i]/100.0;\n                }else{\n                    E*=(100-p[i])/100.0;\n                }\n            }\n            ans+=E;\n        }\n        println(String.format(\"%f\", ans));\n    }\n \n    long gcd(long a, long b){\n        return a==0?b:gcd(b%a, a);\n    }\n \n    long lcm(long a, long b){\n        if(overflow(a/gcd(a, b), b)){\n            return 0;\n        }else{\n            return a/gcd(a, b)*b;\n        }\n    }\n \n    // a*b\n    boolean overflow(long a, long b){\n        return b!=0&&a>Long.MAX_VALUE/b;\n    }\n \n    void println(String s){\n        System.out.println(s);\n    }\n \n    public static void main(String[] args){\n        new Main().run();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\t// BigDecimal[] p = new BigDecimal[n];\n\t\t// for (int i = 0; i < n; i++)\n\t\t// p[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100),\n\t\t// mc);\n\t\tint[] p = new int[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextInt();\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\t\t// BigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\t// BigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tdouble pro = Math.abs(cnt[i]);\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\t// pro = pro.multiply(p[j], mc);\n\t\t\t\t\tpro *= p[j] / 100.0;\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (100 - p[j]) / 100.0;\n\t\t\t\t\t// pro = pro.multiply(BigDecimal.ONE.subtract(p[j], mc),\n\t\t\t\t\t// mc);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += pro;\n//\t\t\tans = ans.add(pro, mc);\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\t// BigDecimal[] p = new BigDecimal[n];\n\t\t// for (int i = 0; i < n; i++)\n\t\t// p[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100),\n\t\t// mc);\n\t\tint[] p = new int[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextInt();\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\t\t// BigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\t// BigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tdouble pro = Math.abs(cnt[i]);\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\t// pro = pro.multiply(p[j], mc);\n\t\t\t\t\tpro *= p[j] / 100.0;\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (100 - p[j]) / 100.0;\n\t\t\t\t\t// pro = pro.multiply(BigDecimal.ONE.subtract(p[j], mc),\n\t\t\t\t\t// mc);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += pro;\n//\t\t\tans = ans.add(pro, mc);\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\tint[] p = new int[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextInt();\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += (m / l)*(Math.pow(-1, 1+Integer.bitCount(i)));\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] += cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tdouble pro = Math.abs(cnt[i]);\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tpro *= p[j] / 100.0;\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (100 - p[j]) / 100.0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += pro;\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.MathContext;\nimport java.math.RoundingMode;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Enumeration {\n\tpublic static void main(String[] args) {\n\t\tnew Enumeration().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\t\tMathContext mc = new MathContext(25, RoundingMode.HALF_EVEN);\n\n\t\t// BigDecimal[] p = new BigDecimal[n];\n\t\t// for (int i = 0; i < n; i++)\n\t\t// p[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100),\n\t\t// mc);\n\t\tint[] p = new int[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextInt();\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\t\t// BigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\t// BigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tdouble pro = Math.abs(cnt[i]);\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\t// pro = pro.multiply(p[j], mc);\n\t\t\t\t\tpro *= p[j] / 100.0;\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (100 - p[j]) / 100.0;\n\t\t\t\t\t// pro = pro.multiply(BigDecimal.ONE.subtract(p[j], mc),\n\t\t\t\t\t// mc);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += pro;\n//\t\t\tans = ans.add(pro, mc);\n\n\t\t}\n\t\tSystem.out.printf(\"%.10f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\tlong g = gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a / gcd(a, b) * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = false;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = a[y] * lcm[i ^ x] / gcd(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = m / lcm[i];\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tArrays.fill(pro, 1.0);\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif ((i & 1 << j) != 0) {\n\t\t\t\t\tlcm[i] = lcm(a[j], lcm[i ^ 1 << j]);\n\t\t\t\t\tpro[i] *= p[j] / 100.0;\n\t\t\t\t} else\n\t\t\t\t\tpro[i] *= 1 - p[j] / 100.0;\n\t\t\t}\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = lcm[i] == 0 ? 0 : m / lcm[i];\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (b != 0 && a > Long.MAX_VALUE / b)\n\t\t\treturn (long) 0;\n\t\treturn a * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = a[y] * lcm[i ^ x] / gcd(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\ttr(pro);\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = m / lcm[i];\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\ttr(dp);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\ttr(dp);\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tout.println(ret);\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\n\t\tdouble[] p = new double[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = sc.nextDouble() / 100.0;\n\n\t\tint[] cnt = new int[1 << n];\n\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif ((i & (1 << j)) > 0) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif ((j & (1 << i)) > 0) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdouble ans = 0;\n\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tdouble pro = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif ((i & (1 << j)) > 0) {\n\t\t\t\t\tpro *= p[j];\n\t\t\t\t} else {\n\t\t\t\t\tpro *= (1 - p[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += Math.abs(cnt[i]) * pro;\n\t\t}\n\t\tSystem.out.println(ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta = a / gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a / gcd(a, b) * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigDecimal;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid run() {\n\t\tsolver();\n\t}\n\n\tvoid solver() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tlong m = sc.nextLong();\n\n\t\tlong[] a = new long[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\ta[i] = sc.nextLong();\n\n\t\tBigDecimal[] p = new BigDecimal[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tp[i] = (new BigDecimal(sc.nextInt())).divide(BigDecimal.valueOf(100));\n\n\t\tlong[] cnt = new long[1 << n];\n\t\tfor (int i = 1; i < (1 << n); i++) {\n\t\t\tlong l = 1;\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tl = lcm(l, a[j]);\n\t\t\t\t\tif (l == 0)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (l != 0)\n\t\t\t\tcnt[i] += m / l;\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < (1 << n); j++) {\n\t\t\t\tif (((j >> i) & 1) == 1) {\n\t\t\t\t\tcnt[j] -= cnt[j ^ (1 << i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBigDecimal ans = new BigDecimal(0);\n\t\tfor (int i = 0; i < (1 << n); i++) {\n\t\t\tBigDecimal pro = BigDecimal.valueOf(Math.abs(cnt[i]));\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tif (((i >> j) & 1) == 1) {\n\t\t\t\t\tpro = pro.multiply(p[j]);\n\t\t\t\t} else {\n\t\t\t\t\tpro = pro.multiply(BigDecimal.ONE.subtract(p[j]));\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = ans.add(pro);\n\n\t\t}\n\t\tSystem.out.printf(\"%.5f\\n\", ans);\n\t}\n\n\tlong gcd(long a, long b) {\n\t\tif (a < b) {\n\t\t\tlong tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\t\t}\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\telse\n\t\t\treturn gcd(b, a % b);\n\t}\n\n\tlong lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn a * b;\n\t}\n\n\tvoid tr(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = true;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.lang.*;\nimport java.math.*;\nimport java.io.*;\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\n\n// Enumeration\n// 2012/09/19\npublic class Main{\n\tScanner sc=new Scanner(System.in);\n\n\tint n;\n\tlong m;\n\tlong[] a;\n\tint[] p;\n\n\tvoid run(){\n\t\tn=sc.nextInt();\n\t\tm=sc.nextLong();\n\t\ta=new long[n];\n\t\tfor(int i=0; i<n; i++){\n\t\t\ta[i]=sc.nextLong();\n\t\t}\n\t\tp=new int[n];\n\t\tfor(int i=0; i<n; i++){\n\t\t\tp[i]=sc.nextInt();\n\t\t}\n\t\tsolve();\n\t}\n\n\tvoid solve(){\n\t\tlong[] f=new long[1<<n];\n\t\tfor(int s=0; s<1<<n; s++){\n\t\t\tlong lcm=1;\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tif((s>>i&1)==1){\n\t\t\t\t\tlcm=lcm(lcm, a[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(lcm!=0){\n\t\t\t\tf[s]=m/lcm;\n\t\t\t}\n\t\t}\n\t\tf[0]=0;\n\n\t\tfor(int i=0; i<n; i++){\n\t\t\tfor(int s=0; s<1<<n; s++){\n\t\t\t\tif((s>>i&1)==1){\n\t\t\t\t\tf[s]-=f[s^(1<<i)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdouble ans=0;\n\t\tfor(int s=0; s<1<<n; s++){\n\t\t\tf[s]=abs(f[s]);\n\t\t\tdouble E=f[s];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tif((s>>i&1)==1){\n\t\t\t\t\tE*=p[i]/100.0;\n\t\t\t\t}else{\n\t\t\t\t\tE*=(100-p[i])/100.0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans+=E;\n\t\t}\n\t\tprintln(String.format(\"%f\", ans));\n\t}\n\n\tlong gcd(long a, long b){\n\t\treturn a==0?b:gcd(b%a, a);\n\t}\n\n\tlong lcm(long a, long b){\n\t\tif(overflow(a/gcd(a, b), b)){\n\t\t\treturn 0;\n\t\t}else{\n\t\t\treturn a/gcd(a, b)*b;\n\t\t}\n\t}\n\n\t// a*b\n\tboolean overflow(long a, long b){\n\t\treturn b!=0&&a>Long.MAX_VALUE/b;\n\t}\n\n\tvoid println(String s){\n\t\tSystem.out.println(s);\n\t}\n\n\tpublic static void main(String[] args){\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic boolean debug = false;\n\n\tstatic void solve() {\n\t\tint n = ir.nextInt();\n\t\tlong m = ir.nextLong();\n\t\tlong[] a = ir.nextLongArray(n);\n\t\tint[] p = ir.nextIntArray(n);\n\t\tlong[] lcm = new long[1 << n];\n\t\tdouble[] pro = new double[1 << n];\n\t\tpro[0] = 1.0;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tpro[0] *= 1.0 - p[i] / 100.0;\n\t\tlcm[0] = 1;\n\t\tfor (int i = 1; i < 1 << n; i++) {\n\t\t\tint x = Integer.highestOneBit(i);\n\t\t\tint y = Integer.numberOfTrailingZeros(x);\n\t\t\tlcm[i] = lcm(a[y], lcm[i ^ x]);\n\t\t\tpro[i] = pro[i ^ x] * (double) p[y] / (100 - p[y]);\n\t\t}\n\t\tlong[][] dp = new long[2][1 << n];\n\t\tfor (int i = 0; i < 1 << n; i++)\n\t\t\tdp[n & 1][i] = Math.max(0, m / lcm[i]);\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1][j] = dp[i & 1 ^ 1][j];\n\t\t\t\tif ((j & 1 << i) == 0)\n\t\t\t\t\tdp[i & 1][j] -= dp[i & 1 ^ 1][j | 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1 ^ 1], 0);\n\t\t}\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 1 << n; j++) {\n\t\t\t\tdp[i & 1 ^ 1][j] = dp[i & 1][j];\n\t\t\t\tif ((j & 1 << i) != 0)\n\t\t\t\t\tdp[i & 1 ^ 1][j] += dp[i & 1][j ^ 1 << i];\n\t\t\t}\n\t\t\tArrays.fill(dp[i & 1], 0);\n\t\t}\n\t\tdouble ret = 0.0;\n\t\tfor (int i = 0; i < 1 << n; i++) {\n\t\t\tret += (m - dp[n & 1][((1 << n) - 1) ^ i]) * pro[i];\n\t\t}\n\t\tDecimalFormat df = new DecimalFormat(\"0.00000000\");\n\t\tout.println(df.format(ret));\n\t}\n\n\tstatic long gcd(long a, long b) {\n\t\tif (b == 0)\n\t\t\treturn a;\n\t\treturn gcd(b, a % b);\n\t}\n\n\tstatic long lcm(long a, long b) {\n\t\ta /= gcd(a, b);\n\t\tif (a * b / b != a)\n\t\t\treturn (long) 2e18;\n\t\treturn a * b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n\n\tstatic void tr(Object... o) {\n\t\tif (debug)\n\t\t\tout.println(Arrays.deepToString(o));\n\t}\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\nusing System.Collections.Generic;\nusing Debug = System.Diagnostics.Debug;\nusing SB = System.Text.StringBuilder;\n//using System.Numerics;\n//using static System.Math;\nusing System.IO;\nusing Number = System.Int64;\nnamespace Program {\n    public class Solver {\n\n        public void Solve() {\n            var n = ri;\n            var m = rl;\n            var a = Enumerate(n, x => rl);\n            var p = Enumerate(n, x => ri / 100.0);\n            var dp = new long[1 << n];\n            var ep = new double[1 << n];\n            for (int i = 1; i < 1 << n; i++) {\n                long x = 1;\n                double q = 1;\n                for (int j = 0; j < n; j++)\n                    if ((i >> j & 1) == 1) {\n                        var gcd = MathEx.GCD(x, a[j]);\n                        x /= gcd;\n                        if (1.0 * x * a[j] > m) x = m + 1;\n                        else x *= a[j];\n                        q *= p[j];\n                    }\n                    else q *= 1 - p[j];\n                dp[i] = m / x;\n                ep[i] = q;\n            }\n            for (int i = 0; i < n; i++)\n                for (int j = 0; j < 1 << n; j++)\n                    if ((j >> i & 1) == 1) dp[j] -= dp[j ^ (1 << i)];\n            var sum = 0.0;\n            for (int i = 0; i < 1 << n; i++)\n                sum += ep[i] * Math.Abs(dp[i]);\n            Console.WriteLine(\"{0:0.000000000}\", sum);\n        }\n\n\n\n        const long INF = 1L << 60;\n        //int[] dx = { -1, 0, 1, 0 };\n        //int[] dy = { 0, 1, 0, -1 };\n        //*\n        int ri { get { return sc.Integer(); } }\n        long rl { get { return sc.Long(); } }\n        double rd { get { return sc.Double(); } }\n        string rs { get { return sc.Scan(); } }\n        //*/\n\n        public IO.StreamScanner sc = new IO.StreamScanner(Console.OpenStandardInput());\n        static T[] Enumerate<T>(int n, Func<int, T> f) { var a = new T[n]; for (int i = 0; i < n; ++i) a[i] = f(i); return a; }\n        static public void Swap<T>(ref T a, ref T b) { var tmp = a; a = b; b = tmp; }\n    }\n}\n\n#region main\nstatic class Ex {\n    static public string AsString(this IEnumerable<char> ie) { return new string(ie.ToArray()); }\n    static public string AsJoinedString<T>(this IEnumerable<T> ie, string st = \" \") {\n        return string.Join(st, ie.Select(x => x.ToString()).ToArray());\n        //return string.Join(st, ie);\n    }\n    static public void Main() {\n        Console.SetOut(new System.IO.StreamWriter(Console.OpenStandardOutput()) { AutoFlush = false });\n        var solver = new Program.Solver();\n        solver.Solve();\n        Console.Out.Flush();\n    }\n}\n#endregion\n#region Ex\nnamespace Program.IO {\n    using System.IO;\n    using System.Text;\n    using System.Globalization;\n    public class Printer: StreamWriter {\n        public override IFormatProvider FormatProvider { get { return CultureInfo.InvariantCulture; } }\n        public Printer(Stream stream) : base(stream, new UTF8Encoding(false, true)) { }\n    }\n    public class StreamScanner {\n        public StreamScanner(Stream stream) { str = stream; }\n        public readonly Stream str;\n        private readonly byte[] buf = new byte[1024];\n        private int len, ptr;\n        public bool isEof = false;\n        public bool IsEndOfStream { get { return isEof; } }\n        private byte read() {\n            if (isEof) return 0;\n            if (ptr >= len) { ptr = 0; if ((len = str.Read(buf, 0, 1024)) <= 0) { isEof = true; return 0; } }\n            return buf[ptr++];\n        }\n        public char Char() { byte b = 0; do b = read(); while ((b < 33 || 126 < b) && !isEof); return (char)b; }\n\n        public string Scan() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b >= 33 && b <= 126; b = (char)read())\n                sb.Append(b);\n            return sb.ToString();\n        }\n        public string ScanLine() {\n            var sb = new StringBuilder();\n            for (var b = Char(); b != '\\n' && b != 0; b = (char)read())\n                if (b != '\\r') sb.Append(b);\n            return sb.ToString();\n        }\n        public long Long() { return isEof ? long.MinValue : long.Parse(Scan()); }\n        public int Integer() { return isEof ? int.MinValue : int.Parse(Scan()); }\n        public double Double() { return isEof ? double.NaN : double.Parse(Scan(), CultureInfo.InvariantCulture); }\n    }\n}\n#endregion\n#region gcd,lcm\nstatic public partial class MathEx {\n    static public int GCD(int n, int m) { return (int)GCD((long)n, m); }\n    static public long GCD(long n, long m) {\n        n = Math.Abs(n); m = Math.Abs(m);\n        while (n != 0) {\n            m %= n;\n            if (m == 0) return n;\n            n %= m;\n        }\n        return m;\n    }\n    static public long LCM(long n, long m) { return (n / GCD(n, m)) * m; }\n    static public long GCD(params long[] a) {\n        var gcd = a[0];\n        foreach (var x in a)\n            gcd = GCD(gcd, x);\n        return gcd;\n    }\n\n}\n#endregion\n"
  },
  {
    "language": "Ruby",
    "code": "def gcd(m, n)\n    if m < n\n        gcd(n, m)\n    elsif n == 0\n        m\n    else\n        gcd(n, m % n)\n    end\nend\n\ndef lcm(m, n)\n    m * n / gcd(m, n)\nend\n\nn, m = gets.split.map(&:to_i)\nnum = gets.split.map(&:to_i)\nprob = gets.split.map(&:to_i).map {|x| x / 100.0}\n\nexp = 0\n(1..2**n-1).each do |x|\n    a = (0..n-1).select {|i| x[i] == 1}\n    q = a.map {|i| prob[i]}.inject(:*)\n    k = m / a.map {|i| num[i]}.inject{|s,x| lcm(s, x)}\n    exp += (a.size.odd? ? 1 : -1) * k * q\nend\nprintf(\"%.9f\\n\", exp)"
  },
  {
    "language": "Ruby",
    "code": "def gcd(m, n)\n    if m < n\n        gcd(n, m)\n    elsif n == 0\n        m\n    else\n        gcd(n, m % n)\n    end\nend\n\ndef lcm(m, n)\n    m * n / gcd(m, n)\nend\n\nn, m = gets.split.map(&:to_i)\nnum = gets.split.map(&:to_i)\nprob = gets.split.map(&:to_i).map {|x| x / 100.0}\n\nexp = 0\n\nqs = [1]\nlcms = [1]\n\n(1..2**n-1).each do |x|\n    a = (0..n-1).select {|i| x[i] == 1}\n    i = a[0]\n    y = x & (x - 1)\n    qs[x] = qs[y] * prob[i]\n    lcms[x] = lcm(lcms[y], num[i])\n    k = m / lcms[x]\n    exp += (a.size.odd? ? 1 : -1) * k * qs[x]\nend\nprintf(\"%.9f\\n\", exp)"
  },
  {
    "language": "D",
    "code": "void main() {\n  import std.stdio, std.string, std.conv, std.algorithm;\n  import std.numeric, std.math;\n\n  int n;\n  long m;\n  rd(n, m);\n  auto a = readln.split.to!(long[]);\n  auto p = readln.split.to!(int[]);\n\n  auto dp = new long[](1 << n);\n  foreach (bit; 1 .. (1 << n)) {\n    auto mul = 1L;\n    foreach (i; 0 .. n) {\n      if (bit & (1 << i)) {\n        auto g = gcd(mul, a[i]), b = mul / g;\n        if (1.0 * b * a[i] > m) {\n          mul = m + 1;\n          break;\n        }\n        mul = mul / g * a[i];\n      }\n    }\n    dp[bit] = m / mul;\n  }\n  foreach (i; 0 .. n) {\n    foreach (bit; 0 .. (1 << n)) {\n      if ((bit & (1 << i))) {\n        dp[bit] -= dp[bit ^ (1 << i)];\n      }\n    }\n  }\n  auto ans = 0.0;\n  foreach (bit; 0 .. (1 << n)) {\n    auto q = 1.0;\n    foreach (i; 0 .. n) {\n      if (bit & (1 << i)) {\n        q *= p[i] / 100.0;\n      } else {\n        q *= (100 - p[i]) / 100.0;\n      }\n    }\n    ans += (dp[bit].abs) * q;\n  }\n  writefln(\"%.18f\", ans);\n\n}\n\nvoid rd(T...)(ref T x) {\n  import std.stdio : readln;\n  import std.string : split;\n  import std.conv : to;\n\n  auto l = readln.split;\n  assert(l.length == x.length);\n  foreach (i, ref e; x)\n    e = l[i].to!(typeof(e));\n}\n\n"
  },
  {
    "language": "D",
    "code": "void main() {\n  import std.stdio, std.string, std.conv, std.algorithm;\n  import std.numeric, std.math;\n\n  int n;\n  long m;\n  rd(n, m);\n  auto a = readln.split.to!(long[]);\n  auto p = readln.split.to!(int[]);\n\n  auto dp = new long[](1 << n);\n  foreach (bit; 1 .. (1 << n)) {\n    auto mul = 1L;\n    foreach (i; 0 .. n) {\n      if (bit & (1 << i)) {\n        auto g = gcd(mul, a[i]), b = mul / g;\n        if (1.0 * b * a[i] > m) {\n          mul = m + 1;\n          break;\n        }\n        mul = mul / g * a[i];\n      }\n    }\n    dp[bit] = m / mul;\n  }\n  foreach (i; 0 .. n) {\n    foreach (bit; 0 .. (1 << n)) {\n      if ((bit & (1 << i)) == 0) {\n        dp[bit ^ (1 << i)] -= dp[bit];\n      }\n    }\n  }\n  auto ans = 0.0;\n  foreach (bit; 0 .. (1 << n)) {\n    auto q = 1.0;\n    foreach (i; 0 .. n) {\n      if (bit & (1 << i)) {\n        q *= p[i] / 100.0;\n      } else {\n        q *= (100 - p[i]) / 100.0;\n      }\n    }\n    ans += (dp[bit].abs) * q;\n  }\n  writefln(\"%.18f\", ans);\n\n}\n\nvoid rd(T...)(ref T x) {\n  import std.stdio : readln;\n  import std.string : split;\n  import std.conv : to;\n\n  auto l = readln.split;\n  assert(l.length == x.length);\n  foreach (i, ref e; x)\n    e = l[i].to!(typeof(e));\n}\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    n,m = LI()\n    a = LI()\n    p = [c / 100.0 for c in LI()]\n    d = collections.defaultdict(lambda: 1.0)\n    e = collections.defaultdict(lambda: 1)\n\n    r = 0\n    for k in range(1,1<<n):\n        t = [i for i in range(n) if k & (1 << i)]\n        l = k & (k-1)\n        d[k] = d[l] * p[t[0]]\n        e[k] = e[l] * a[t[0]] // fractions.gcd(a[t[0]], e[l])\n        o = m // e[k]\n        if len(t) % 2 == 1:\n            r += o * d[k]\n        else:\n            r -= o * d[k]\n\n\n    return '{:0.8f}'.format(r)\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    n,m = LI()\n    a = LI()\n    p = LI()\n    fm = {}\n    def f(k):\n        if k in fm:\n            return fm[k]\n        g = 1\n        for i in range(n):\n            if k & (1 << i):\n                g *= a[i] // fractions.gcd(g, a[i])\n        fm[k] = m // g\n        return fm[k]\n\n    r = 0\n    for k in range(1,1<<n):\n        t = []\n        b = 1.0\n        for i in range(n):\n            if k & (1 << i):\n                t.append(1 << i)\n                b *= p[i]\n            else:\n                b *= 100 - p[i]\n            b /= 100\n\n        c = 0\n        tl = len(t)\n        for l in range(1,1<<tl):\n            o = 0\n            lc = 0\n            for j in range(tl):\n                if l & (1 << j):\n                    o |= t[j]\n                    lc += 1\n            if lc % 2 == 1:\n                c += f(o)\n            else:\n                c -= f(o)\n        r += b * c\n    # print(fm)\n\n    return '{:0.8f}'.format(r)\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nwrite = sys.stdout.write\ndef solve():\n    N, M = map(int, readline().split())\n    *A, = map(int, readline().split())\n    *P, = map(int, readline().split())\n    def lcm(m, n):\n        m0 = m; n0 = n\n        while n:\n            m, n = n, m % n\n        return m0//m*n0\n    N2 = 1 << N\n    Q = [1]*N2\n    L = [1]*N2\n    C = [0]*N2\n    for i in range(N):\n        L[1 << i] = A[i]\n        Q[1 << i] = P[i] / 100\n    ans = 0\n    for state in range(1, N2):\n        b = state & -state\n        L[state] = lcm(L[state ^ b], L[b])\n        C[state] = C[state ^ b] + 1\n        Q[state] = Q[state ^ b] * Q[b]\n        if C[state] % 2:\n            ans += Q[state] * (M // L[state])\n        else:\n            ans -= Q[state] * (M // L[state])\n    write(\"%.16f\\n\" % ans)\nsolve()\n"
  },
  {
    "language": "Python",
    "code": "def GCD(x, y):\n    if y == 0:\n        return x\n    return GCD(y, x % y)\n\n\ndef CountBitFlag(T):\n    T = (T & 0x55555555) + ((T >> 1) & 0x55555555)\n    T = (T & 0x33333333) + ((T >> 2) & 0x33333333)\n    T = (T & 0x0F0F0F0F) + ((T >> 4) & 0x0F0F0F0F)\n    T = (T & 0x00FF00FF) + ((T >> 8) & 0x00FF00FF)\n    T = (T & 0x0000FFFF) + ((T >> 16) & 0x0000FFFF)\n    return T\n\n\nN, M = map(int, input().split())\nA = tuple(map(int, input().split()))\nP = tuple(map(int, input().split()))\n\nProb = [1.0] * (1 << N)\nLCM = [1] * (1 << N)\nans = 0\n\nfor bit in range(1, 1 << N):\n    top = (bit & -bit).bit_length() - 1\n    l = bit & (bit - 1)\n    Prob[bit] = Prob[l] * P[top] / 100\n    LCM[bit] = LCM[l] // GCD(LCM[l], A[top]) * A[top]\n    if CountBitFlag(bit) % 2 == 1:\n        ans += M // LCM[bit] * Prob[bit]\n    else:\n        ans -= M // LCM[bit] * Prob[bit]\n\nprint(\"{:.8f}\".format(ans))\n"
  }
]