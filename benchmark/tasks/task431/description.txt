Takahashi-kun and Akiko-chan decided to tour a "long and narrow place" in New York. There are n horse carriages that travel from a start point to a goal point along this line. Each carriage moves at a different constant speed defined by parameters Si. There are m "slightly wider areas" located along the line where two carriages can pass each other. You need to write a program to minimize the time taken from the departure of the first carriage until all carriages reach the goal point, adhering to the given rules concerning the departure timing and the width of the areas.