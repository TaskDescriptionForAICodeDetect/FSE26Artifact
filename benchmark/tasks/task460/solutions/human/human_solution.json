[
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\n#define MOD 1000000007\n\nint main() {\n    string a, b, c;\n    while (cin >> a && a != \"0\"){\n        cin >> b >> c;\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n        int n = a.length();\n        vector<vector<ll> > dp(n+1, VL(2));\n        dp[0][0] = 1;\n        REP(i,n) REP(j,2){\n            int lower = (i == n-1 ? 1: 0);\n            FOR(ai,lower,9) FOR(bi,lower,9) FOR(ci,lower,9){\n                if (a[i] != '?' && ai != a[i] - '0') continue;\n                if (b[i] != '?' && bi != b[i] - '0') continue;\n                if (c[i] != '?' && ci != c[i] - '0') continue;\n                int x = ai + bi + j;\n                if (x % 10 != ci) continue;\n                dp[i+1][x/10] = (dp[i+1][x/10] + dp[i][j]) % MOD;\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, n) for (int i = 0; i < (n); i++)\nusing namespace std;\nusing ll = long long;\n\ntemplate<class T> inline bool chmax(T &a, T b) {\n  if (a < b) {\n    a = b;\n    return true;\n  }\n  return false;\n}\n\nvector<int> d = {1, 2, 3, 4, 5, 6, 7, 8, 9, 0};\nconst ll mod = 1e9 + 7;\n\nint main() {\n  while (1) {\n    string a, b, c;\n    cin >> a;\n    \n    if (a == \"0\") break;\n    cin >> b >> c;\n    \n    reverse(a.begin(), a.end());\n    reverse(b.begin(), b.end());\n    reverse(c.begin(), c.end());\n\n    int sz = (int)a.size();\n\n    ll dp[51][2] = {0};\n    dp[0][0] = 1;\n\n    for (int i = 0; i < sz; i++) {\n      \n      vector<int> dx = d;\n      if (i == sz - 1) dx.pop_back();\n      if (a[i] != '?') dx = {a[i] - '0'};\n      \n      for (int x : dx) {\n        \n        vector<int> dy = d;\n        if (i == sz - 1) dy.pop_back();\n        if (b[i] != '?') dy = {b[i] - '0'};\n        \n        for (int y : dy) {\n          \n          vector<int> dz = d;\n          if (i == sz - 1) dz.pop_back();\n          if (c[i] != '?') dz = {c[i] - '0'};\n          \n          for (int z : dz) {\n            if ((x + y) % 10 == z) {\n              dp[i + 1][(x + y) / 10] += dp[i][0];\n              dp[i][0] %= mod;\n            }\n            if ((x + y + 1) % 10 == z) {\n              dp[i + 1][(x + y + 1) / 10] += dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n        }\n      }\n    }\n\n    cout << dp[sz][0] % mod << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\n#define MOD 1000000007\n\nint main(){\n  string a,b,c;\n  LL dp[50][10][10][10][2];\n  LL total[2];\n  while(1){\n    cin >> a;\n    if(a==\"0\") return 0;\n    cin >> b >> c;\n    if(a.length()==1){\n      for(int i=0;i<a.length();i++){\n        for(int j=0;j<10;j++){\n          for(int k=0;k<10;k++){\n            for(int l=0;l<10;l++){\n              dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n            }\n          }\n        }\n      }\n      for(int i=1;i<10;i++){\n        for(int j=1;j<10;j++){\n          for(int k=1;k<10;k++){\n            if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n              &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n              &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n                if((i+j)%10==k){\n                  dp[a.length()-1][i][j][k][(i+j)/10]=1;\n                }\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n          }\n        }\n      }\n      cout << total[0] << endl;\n      continue;\n    }\n    for(int i=0;i<a.length();i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n          }\n        }\n      }\n    }\n    for(int i=0;i<10;i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n            &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n            &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n              if((i+j)%10==k){\n                dp[a.length()-1][i][j][k][(i+j)/10]=1;\n              }\n          }\n        }\n      }\n    }\n    total[0]=total[1]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n          total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n        }\n      }\n    }\n    for(int i=a.length()-2;i>0;i--){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            if((a[i]=='?'||a[i]=='0'+j)\n              &&(b[i]=='?'||b[i]=='0'+k)\n              &&(c[i]=='?'||c[i]=='0'+l)\n            ){\n              for(int m=0;m<2;m++){\n                if((j+k+m)%10==l){\n                  dp[i][j][k][l][(j+k+m)/10]=total[m];\n                  //printf(\"(%d %d %d %d %d) %d\\n\",i,j,k,l,m,dp[i][j][k][l][(j+k+m)/10]);\n                }\n              }\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[i][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[i][j][k][l][1])%MOD;\n          }\n        }\n      }\n    }\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          if((a[0]=='?'||a[0]=='0'+j)\n            &&(b[0]=='?'||b[0]=='0'+k)\n            &&(c[0]=='?'||c[0]=='0'+l)\n          ){\n            for(int m=0;m<2;m++){\n              if((j+k+m)%10==l){\n                dp[0][j][k][l][(j+k+m)/10]=total[m];\n              }\n            }\n          }\n        }\n      }\n    }\n    total[0]=0;\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          total[0]=(total[0]+dp[0][j][k][l][0])%MOD;\n        }\n      }\n    }\n    cout << total[0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "                                        #include <bits/stdc++.h>\n                                        #include<iostream>\n                                        #include<cstdio>\n                                        #include<vector>\n                                        #include<queue>\n                                        #include<map>\n                                        #include<cstring>\n                                        #include<string>\n                                        #include <math.h>\n                                        #include<algorithm>\n                                    //    #include <boost/multiprecision/cpp_int.hpp>\n                                        #include<functional>\n                                #define int long long\n                                        #define inf  1000000007\n                                        #define pa pair<int,int>\n                                        #define ll long long\n                                        #define pal pair<double,pa>\n                                        #define ppa pair<int,int>\n                                        #define ppap pair<int,pa>\n                                        #define ssa pair<string,int>\n                                        #define  mp make_pair\n                                        #define  pb push_back\n                                        #define EPS (1e-12)\n                                        #define equals(a,b) (fabs((a)-(b))<EPS)\n                                  #define VI vector<int>\n                                        using namespace std;\n                                        \n                                  class pas{\n                                    \tpublic:\n                                    \tint x,y;\n                                    \tpas(int x=0,int y=0):x(x),y(y) {}\n                                    \tpas operator + (pas p) {return pas(x+p.x,y+p.y);}\n                                    \tpas operator - (pas p) {return pas(x-p.x,y-p.y);}\n                                    \tpas operator * (int a) {return pas(x*a,y*a);}\n                                    \tpas operator / (int a) {return pas(x/a,y/a);}\n                                    //\tdouble absv() {return sqrt(norm());}\n                                    \tint norm() {return x*x+y*y;}\n                                    \tbool operator < (const pas &p) const{\n                                   \t\treturn x != p.x ? x<p.x: y<p.y;\n                                   \t}\n                                  //\t\tbool operator < (const pas &p) const{\n                                    //\t\treturn y != p.y ? y<p.y: x<p.x;\n                                    //\t}\n                                    \tbool operator == (const pas &p) const{\n                                    \t\treturn x==p.x && y==p.y;\n                                    \t}\n                                    };\n\n                                        class Point{\n                                        \tpublic:\n                                        \tdouble x,y;\n                                        \tPoint(double x=0,double y=0):x(x),y(y) {}\n                                        \tPoint operator + (Point p) {return Point(x+p.x,y+p.y);}\n                                        \tPoint operator - (Point p) {return Point(x-p.x,y-p.y);}\n                                        \tPoint operator * (double a) {return Point(x*a,y*a);}\n                                        \tPoint operator / (double a) {return Point(x/a,y/a);}\n                                        \tdouble absv() {return sqrt(norm());}\n                                        \tdouble norm() {return x*x+y*y;}\n                                        \tbool operator < (const Point &p) const{\n                                        \t\treturn x != p.x ? x<p.x: y<p.y;\n                                        \t}\n                                        \tbool operator == (const Point &p) const{\n                                        \t\treturn fabs(x-p.x)<EPS && fabs(y-p.y)<EPS;\n                                        \t}\n                                        };\n                                        typedef Point Vector;\n                                 #define pl pair<int,pas>\n                                        struct Segment{\n                                        Point p1,p2;\n                                        };\n                                        \nstruct star{\nSegment se[5];\n};\n                                         double dot(Vector a,Vector b){\n                                        \treturn a.x*b.x+a.y*b.y;\n                                        }\n                                        double cross(Vector a,Vector b){\n                                        \treturn a.x*b.y-a.y*b.x;\n                                        }\n                                    \n            bool parareru(Point a,Point b,Point c,Point d){\n            //\tif(abs(cross(a-b,d-c))<EPS)cout<<\"dd \"<<cross(a-b,d-c)<<endl;\n            \treturn abs(cross(a-b,d-c))<EPS;\n            }\n            double distance_ls_p(Point a, Point b, Point c) {\n              if ( dot(b-a, c-a) < EPS ) return (c-a).absv();\n              if ( dot(a-b, c-b) < EPS ) return (c-b).absv();\n              return abs(cross(b-a, c-a)) / (b-a).absv();\n            }\n            bool is_intersected_ls(Segment a,Segment b) {\n            \tif(a.p1==b.p1||a.p2==b.p1||a.p1==b.p2||a.p2==b.p2) return false;\n            \tif(parareru((a.p2),(a.p1),(b.p1),(b.p2))&&parareru((a.p2),(a.p1),(b.p1),(b.p1))){\n            //\t\tcout<<\"sss\"<<endl;\n            \t\tif(dot(a.p1-b.p1,a.p1-b.p2)<EPS) return true;\n            \t\tif(dot(a.p2-b.p1,a.p2-b.p2)<EPS) return true;\n            \t\tif(dot(a.p1-b.p1,a.p2-b.p1)<EPS) return true;\n            \t\tif(dot(a.p1-b.p2,a.p2-b.p2)<EPS) return true;\n            \t\treturn false;\n            \t}\n              else return ( cross(a.p2-a.p1, b.p1-a.p1) * cross(a.p2-a.p1, b.p2-a.p1) < EPS ) && ( cross(b.p2-b.p1, a.p1-b.p1) * cross(b.p2-b.p1, a.p2-b.p1) < EPS );\n            }\n            double segment_len(Segment a){\n            \t\n            \treturn (a.p1-a.p2).absv();\n            }\n            double segment_dis(Segment a,Segment b){\n            \tif(is_intersected_ls(a,b))return 0;\n            \tdouble r=distance_ls_p(a.p1, a.p2, b.p1);\n            \tr=min(r,distance_ls_p(a.p1, a.p2, b.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p1));\n            \treturn r;\n            }\n            Point intersection_ls(Segment a, Segment b) {\n              Point ba = b.p2-b.p1;\n              double d1 = abs(cross(ba, a.p1-b.p1));\n              double d2 = abs(cross(ba, a.p2-b.p1));\n              double t = d1 / (d1 + d2);\n             \n              return a.p1 + (a.p2-a.p1) * t;\n            }\n\t\t\tpair<Point,Point> circle_intersection(Point c1,double r1,Point c2,double r2){\n\t\t\t\tdouble d=(c1-c2).absv();\n\t\t\t\tdouble h=(r1*r1-r2*r2+d*d)/2.0/d;\n\t\t\t\tdouble l=sqrt(r1*r1-h*h);\n\t\t\t//\tcout<<d<<\" \"<<h<<\" \"<<l<<endl;\n\t\t\t\tPoint asi=c1+(c2-c1)*h/((c2-c1).absv());\n\t\t\t\tVector r1r2=(c2-c1)/((c2-c1).absv());\n\t\t\t\tVector sui={r1r2.y,-r1r2.x};\n\t\t\t//\tcout<<sui.x<<\" \"<<sui.y<<endl;\n\t\t\t\tpair<Point,Point> z=mp(asi+sui*l,asi-sui*l);\n\t\t\t\tif(z.first.x>z.second.x) swap(z.first,z.second);\n\t\t\t\treturn z;\n\t\t\t}\ndouble dist(star s1,star s2){\n\tdouble ans=10000000000.0;\n\t\n\tfor(int i=0;i<5;i++)for(int j=0;j<5;j++){\n\t\tif( is_intersected_ls(s1.se[i],s2.se[j])) {\n\t\t\t\n//\t\t\tcout<<s1.se[i].p1.x<<\" \"<<s1.se[i].p1.y<<endl;\n//\t\t\tcout<<s1.se[i].p2.x<<\" \"<<s1.se[i].p2.y<<endl;\n//\t\t\tcout<<s2.se[j].p1.x<<\" \"<<s2.se[j].p1.y<<endl;\n//\t\t\tcout<<s2.se[j].p2.x<<\" \"<<s2.se[j].p2.y<<endl;\n\t\treturn 0.0;\n\t\t}\n\t\tans=min(ans,segment_dis(s1.se[i],s2.se[j]));\n//\t\tcout<<\"   \"<<i<<\" \"<<j<<\" \"<<segment_dis(s1.se[i],s2.se[j])<<endl;\n\t}\n\treturn ans;\n}\nint gcd(int x,int y){\n\tif(x<y) return gcd(y,x);\n\tif(x==y) return x;\n\tif(x%y==0) return y;\n\treturn gcd(y,x%y);\n}\n class pa2{\n                                            public:\n                                            int x,y;\n                                            pa2(int x=0,int y=0):x(x),y(y) {}\n                                            pa2 operator + (pa2 p) {return pa2(x+p.x,y+p.y);}\n                                            pa2 operator - (pa2 p) {return pa2(x-p.x,y-p.y);}\n                                            bool operator < (const pa2 &p) const{\n                                                return x != p.x ? x<p.x: y<p.y;\n                                            }\n\t\t\t\t\t\t\t\t\t\t \t bool operator > (const pa2 &p) const{\n                                                return x != p.x ? x>p.x: y>p.y;\n                                            }\n                                            bool operator == (const pa2 &p) const{\n                                                return abs(x-p.x)==0 && abs(y-p.y)==0;\n                                            }\n                                            bool operator != (const pa2 &p) const{\n                                                return !(abs(x-p.x)==0 && abs(y-p.y)==0);\n                                            }\n                                                 \n                                         \n                                        };\n                                        \nstring s,t,w;\nint l;\nint memo[100][3];\nint dfs(int r,int ku){\n\tif(r==l && ku==0) return 1;\n\tif(r==l && ku==1) return 0;\n\tif(ku>1|| ku<0)return 0;\n\tif(memo[r][ku]>=0) return memo[r][ku];\n\t//if(s[r]=='?' && t[r]!='?') swap(s[r],t[r]);\n\t\n\tint cn1=0,cn2=0;\n\t//cout<<s[0]<<\" \"<<t[0]<<\" \"<<w[0]<<endl; \n\tfor(int i=0;i<=9;i++)for(int j=0;j<=9;j++)for(int k=0;k<=9;k++){\n\t\t//cout<<i<<\" \"<<j<<\" \"<<k<<endl;\n\t\tif(r==0 && i*j*k==0) continue;\n\t\tif(s[r]!='?' && s[r]-'0'!=i) continue;\n\t\tif(t[r]!='?' && t[r]-'0'!=j) continue;\n\t\tif(w[r]!='?' && w[r]-'0'!=k) continue;\n\t\t\n\t\tif(ku==0){\n\t\t\tif(i+j>=10) continue;\n\t\t\tif(i+j==k)cn1++;\n\t\t\tif(i+j+1==k) cn2++;\n\t\t}\n\t\tif(ku==1){\n\t\t\tif(i+j<9) continue;\n\t\t\tif(i+j==k+10) cn1++;\n\t\t\tif(i+j+1==k+10)cn2++;\n\t\t}\n\t\t\n\t}\n\t\n\tint d=0;\n\td+= cn1*(dfs(r+1,0))%inf;\n\td%=inf;\n\td+= cn2*(dfs(r+1,1))%inf;\n\td%=inf;\n\tmemo[r][ku]=d;\n\t//cout<<r<<\" \"<<ku<<\" \"<<d<<endl;\n\treturn d;\n}\n\n\n     signed main(){\n\n     \twhile(1){\n     \tcin>>s;\n     \t\tif(s==\"0\")return 0;\n     \t\tcin>>t>>w;\n     \t\tfor(int i=0;i<60;i++)memo[i][0]=-1,memo[i][1]=-1;\n     \t\tl=s.length();\n     \t\tcout<<dfs(0,0)%inf<<endl;\n   \n     \t}\n           \treturn 0;\n           }\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int,int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-11;\nconst ld pi = acos(-1.0);\nint main() {\n\tstring a, b, c;\n\twhile (cin >> a) {\n\t\tif (a == \"0\")break;\n\t\tcin >> b >> c;\n\t\treverse(a.begin(), a.end());\n\t\treverse(b.begin(), b.end());\n\t\treverse(c.begin(), c.end());\n\t\tll cnt[51][2] = {};\n\t\tcnt[0][0] = 1;\n\t\tint len = a.length();\n\t\trep(i, len) {\n\t\t\tll cnt1 = 0; ll cnt2 = 0;\n\t\t\trep(x, 10) {\n\t\t\t\trep(y, 10) {\n\t\t\t\t\trep(z, 10) {\n\t\t\t\t\t\tif (a[i] != '?'&&a[i]-'0' != x)continue;\n\t\t\t\t\t\tif (b[i] != '?'&&b[i]-'0' != y)continue;\n\t\t\t\t\t\tif (c[i] != '?'&&c[i]-'0' != z)continue;\n\t\t\t\t\t\tif (i == len - 1 && (x == 0 || y == 0 || z == 0))continue;\n\t\t\t\t\t\tif (x + y == z)cnt1++;\n\t\t\t\t\t\tif (x + y == 10 + z)cnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt[i + 1][0] += cnt[i][0] * cnt1; cnt[i + 1][0] %= MOD;\n\t\t\tcnt[i + 1][1] += cnt[i][0] * cnt2; cnt[i + 1][1] %= MOD;\n\t\t\tcnt1 = 0; cnt2 = 0;\n\t\t\trep(x, 10) {\n\t\t\t\trep(y, 10) {\n\t\t\t\t\trep(z, 10) {\n\t\t\t\t\t\tif (a[i] != '?'&&a[i]-'0' != x)continue;\n\t\t\t\t\t\tif (b[i] != '?'&&b[i]-'0' != y)continue;\n\t\t\t\t\t\tif (c[i] != '?'&&c[i]-'0' != z)continue;\n\t\t\t\t\t\tif (i == len - 1 && (x == 0 || y == 0 || z == 0))continue;\n\t\t\t\t\t\tif (x + y +1== z)cnt1++;\n\t\t\t\t\t\tif (x + y +1== 10 + z)cnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt[i + 1][0] += cnt[i][1] * cnt1; cnt[i + 1][0] %= MOD;\n\t\t\tcnt[i + 1][1] += cnt[i][1] * cnt2; cnt[i + 1][1] %= MOD;\n\t\t}\n\t\tcout << cnt[len][0] << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//http://logfiles.hatenablog.com/entry/20160520/1463764819\n//勉強させて頂いた記事\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll LongINF=1e13+7;\nconst int INF=1e9+7;\nconst int dx[]={0,1,0,-1};\nconst int dy[]={1,0,-1,0};\n\ntemplate<class T> inline bool chmin(T& a, T b) {if (a > b) {a = b;return true;}return false;}\ntemplate<class T> inline bool chmax(T& a, T b) {if (a < b) {a = b;return true;}return false;}\ntemplate <class T, class Y>T GCD(T a, Y b){if(a<b){int c=a;a=b;b=c;}if (a % b == 0){return b;}return GCD(b, a % b);}\nvoid clear(queue<pair<int, int>> &q){queue<pair<int, int>> empty;swap(q, empty);} //queueの中身の型は適時変更を忘れない\n\n#define REP(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) REP(i,0,n)\n#define pb push_back\n#define rv reverse\n\n/*\n数え上げの問題\ndp[i]はi桁目までの、?の通りだが、可能かどうかがわからない。\nなので、[j]を付け足し、1~9の数を識別可能にする？\n要旨としてはi桁目までで?入れ替えで作れる数字を記録し、結果的に足してできる数を出力？\n\nA,B,Cのどれなのか区別がつかないため、dp[i][o][j]とした。\n\nA+B=Cの判定法は、最終的にできた、A,B,Cを用いれば良い\n\nある桁が出来るかどうかは、一通りでは？\nつまりdpの中身にはtrue,falseが出来る\ndpの中身がt,fの時は大体無駄が多いので、別のものを持たせられないか考える。\n例えば、出来た値とか\n\ndpテーブルは通りを格納する。理由は下述の通り。\n\nそもそもdpというのは、ある時点での計算結果を元に次の結果を出すというものである。\nそのため、ある計算結果がそれまでの結果に影響を及ぼさないのはどこかを考える\nこの時、A+B=Cの過程で、下桁から計算していくと結果を確定させながら答えを求めることができる。\n末桁が、A+B=Cとすればもとまっていく？\nこの時考慮しなければいけないのが繰り上がりだが、繰り上がりは別途管理？\n繰り上がりは1だけである。\n\n桁DPを用いて行いたい。でもN以下とかではない\n\n粘ったが、場合分けをうまくできずギブ\n\n*/\n\nint main(){\n    vector<string> S(3);\n\n    while(cin>>S[0]){\n        if(S[0]==\"0\")break;\n        cin>>S[1]>>S[2];\n\n        rep(i,3)reverse(S[i].begin(),S[i].end());//リバースして、反対側から考える。\n\n        int L=S[0].size();\n\n        vector<vector<int> > va(L),vb(L),vc(L);//条件を満たす数を羅列するための配列？\n        //記事内でも場合分けに使うとされているのできっとそう\n        //場合分けをある桁のときに使うであろう数をA,B,Cごとに配列を用いて管理するという知見を得た。\n        //配列を用いて管理することで、面倒な場合分けを縮こめることができる。楽ができる\n        string a=S[0],b=S[1],c=S[2];\n\n        rep(i,L){\n            if(a[i]=='?')REP(k,i==L-1,10)va[i].pb(k);\n            else va[i].pb(a[i]-'0');\n\n            if(b[i]=='?')REP(k,i==L-1,10)vb[i].pb(k);\n            else vb[i].pb(b[i]-'0');\n\n            if(c[i]=='?')REP(k,i==L-1,10)vc[i].pb(k);\n            else vc[i].pb(c[i]-'0');\n        }\n\n        vector<vector<ll> >dp(52,vector<ll>(3,0));\n        dp[0][0]=1;\n\n        rep(i,L)rep(carry,2){//carryは繰り上がり考慮\n            for(auto& da:va[i])for(auto& db: vb[i])for(auto& dc: vc[i]){\n                int num=(da+db+carry)%10;//ありうる数の下桁を取り出している。\n                int ncr=(da+db+carry)/10;//桁上がりの数を取り出している。最大値18+1だと思うので、carryは1上限にしても通る気がするが果たして\n\n                if(num==dc){\n                    dp[i+1][ncr]+=dp[i][carry];\n                    dp[i+1][ncr]%=INF;\n                }\n            }\n        }\n        cout<<dp[L][0]<<endl;\n    }\n    return 0;\n}\n\n//a=97,z=122\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n\nusing namespace std;\n\nint main(){\n  string A,B,C;\n  while(1){\n    cin >> A;\n    if(A==\"0\")break;\n    cin >> B >> C;\n\n    unsigned long N=A.size();\n    unsigned long long P[2][N+1];\n    P[0][0]=1;\n    P[1][0]=0;\n    \n    for(int n=0;n<N;++n){\n      int unknown=0;\n      unsigned long sub[2][2];\n      string a,b,c;\n      sub[0][0]=0;\n      sub[0][1]=0;\n      sub[1][0]=0;\n      sub[1][1]=0;\n      a=A[N-n-1];\n      b=B[N-n-1];\n      c=C[N-n-1];\n      if(a==\"?\")unknown++;\n      if(b==\"?\")unknown++;\n      if(c==\"?\")unknown++;\n      for(int i=0;i<2;++i){\n\tswitch(unknown){\n\tcase 0:\n\t  if((i+atoi(a.c_str())+atoi(b.c_str()))%10!=atoi(c.c_str())){\n\t    sub[i][0]=0;\n\t    sub[i][1]=0;\n\t  } else if(i+atoi(a.c_str())+atoi(b.c_str())>=10) {\n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 1:\n\t  if(c==\"?\"){\n\t    if(i+atoi(a.c_str())+atoi(b.c_str())<10){\n\t      sub[i][0]=1;\n\t      sub[i][1]=0;\n\t    }else{\n\t      sub[i][0]=0;\n\t      sub[i][1]=1;\n\t    }\n\t  } else if( atoi(a.c_str())>atoi(c.c_str()) || atoi(b.c_str())>atoi(c.c_str())){ \n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 2:\n\t  if(a==\"?\"&&b==\"?\"){\n\t    sub[i][0]=atoi(c.c_str())+1-i;\n\t    sub[i][1]=10-sub[i][0];\n\t  } else { \n\t    sub[i][1]=atoi(a.c_str())+atoi(b.c_str())+i;\n\t    sub[i][0]=10-sub[i][1];\n\t  }\n\t  break;\n\t  \n\tcase 3:\n\t  sub[0][0]=55;\n\t  sub[0][1]=45;\n\t  sub[1][0]=45;\n\t  sub[1][1]=55;\n\t  break;\n\t}\n      }\n\n      if(n==N-1){\n\tsub[0][1]=0;\n\tsub[1][1]=0;\n\tfor(int i=0;i<2;++i){\n\t  switch(unknown){\n\t  case 1:\n\t    if(i+atoi(a.c_str())==atoi(c.c_str()) ||\n\t       i+atoi(b.c_str())==atoi(c.c_str()) ||\n\t       i+atoi(a.c_str())+atoi(b.c_str())>9){\n\t      sub[i][0]=0;\n\t    }\n\t    break;\n\t  case 2:\n\t    if(a==\"?\"&&b==\"?\"){\n\t      if(atoi(c.c_str())-i-1>0)sub[i][0]=atoi(c.c_str())-i-1;\n\t      else sub[i][0]=0;\n\t    } else {\n\t      if(9-atoi(a.c_str())-atoi(b.c_str())-i>0) sub[i][0]=9-atoi(a.c_str())-atoi(b.c_str())-i;\n\t      else sub[i][0]=0;\n\t    }\n\t    break;\n\t  case 3:\n\t    sub[0][0]=36;\n\t    sub[1][0]=28;\n\t    break;\n\t  }\n\t}\n\t//cout << sub[0][0] << \" \" << sub[0][1] << \" \"<< sub[1][0] << \" \"<< sub[1][1] << \" \" << endl;;\n      }\n     \n      P[0][n+1]=((P[0][n]*sub[0][0])%1000000007+(P[1][n]*sub[1][0])%1000000007)%1000000007;\n      P[1][n+1]=((P[0][n]*sub[0][1])%1000000007+(P[1][n]*sub[1][1])%1000000007)%1000000007;\n    }\n    \n    for(int j=0;j<=N;++j){\n      for(int i=0;i<2;++i){\n     \tcout << P[i][j] << \" \";\n      }\n      cout << endl;\n    }\n   \n    cout << P[0][N]%1000000007 << endl;\n  }\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nvs str;\nint len;\n\nvi vals;\n\n#define F first\n#define S second\n\npii dfs(int pos, int offset, int num){\n    if(pos == 3){\n        if(vals[2] == vals[0] + vals[1] + offset){\n            return mp(1, 0);\n        }\n        else if(vals[2] == (vals[0] + vals[1] + offset) % 10){\n            return mp(0, 1);\n        }\n        else return mp(0, 0);\n    }\n\n    pii ret = mp(0, 0);\n\n    if(str[pos][num] != '?'){\n        vals[pos] = str[pos][num] - '0';\n\n        pii diff = dfs(pos + 1, offset, num);\n        ret.F += diff.F;\n        ret.S += diff.S;\n    }\n    else{\n        rep(i, 10){\n            if(num == 0 && i == 0) continue;\n\n            vals[pos] = i;\n\n            pii diff = dfs(pos + 1, offset, num);\n            ret.F += diff.F;\n            ret.S += diff.S;\n        }\n    }\n\n    return ret;\n}\n\nconstexpr int MOD = 1000000007;\n\nsigned main(void){\n    vals = vi(3);\n    for(str = vs(3); cin >> str[0], str[0] != \"0\";){\n        len = str[0].size();\n        cin >> str[1] >> str[2];\n\n        vvi dp(len + 1, vi(2));\n        dp[len][0] = 1;\n\n        for(int i = len - 1; i >= 0; i--){\n            rep(j, 2){\n                pii diff = dfs(0, j, i);\n\n                (dp[i][0] += dp[i + 1][j] * diff.F) %= MOD;\n                (dp[i][1] += dp[i + 1][j] * diff.S) %= MOD;\n            }\n        }\n\n        cout << dp[0][0] << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing P = pair<int, int>;\nusing vi = vector<int>;\nusing vvi = vector<vector<int>>;\nusing vll = vector<ll>;\nusing vvll = vector<vector<ll>>;\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\ntemplate<typename T>\nvoid printv(const vector<T>& s) {\n  for(int i=0;i<(int)(s.size());++i) {\n    cout << s[i];\n    if(i == (int)(s.size())-1) cout << endl;\n    else cout << \" \";\n  }\n}\nint main() {\n  cin.tie(0);\n  cout << fixed << setprecision(10);\n  while(1) {\n    string s; cin >> s;\n    if(s == \"0\") break;\n    string t, u; cin >> t >> u;\n    int n = s.size();\n    vector<int> a(n), b(n), c(n);\n    for(int i=0;i<n;++i) {\n      if(s[i] == '?') a[i] = -1;\n      else a[i] = s[i] - '0';\n    }\n    for(int i=0;i<n;++i) {\n      if(t[i] == '?') b[i] = -1;\n      else b[i] = t[i] - '0';\n    }\n    for(int i=0;i<n;++i) {\n      if(u[i] == '?') c[i] = -1;\n      else c[i] = u[i] - '0';\n    }\n    reverse(a.begin(), a.end());\n    reverse(b.begin(), b.end());\n    reverse(c.begin(), c.end());\n    vvll dp(n+1, vll(2, 0));\n    dp[0][0] = 1;\n    for(int d=0;d<n;++d) {\n      for(int i=0;i<=9;++i) {\n        if(d == n-1 && i == 0) continue;\n        for(int j=0;j<=9;++j) {\n          if(d == n-1 && j == 0) continue;\n          for(int k=0;k<=9;++k) {\n            if(d == n-1 && k == 0) continue;\n            if((a[d] == -1 || a[d] == i) &&\n                (b[d] == -1 || b[d] == j) &&\n                (c[d] == -1 || c[d] == k)) {\n              if((i + j) % 10 == k) dp[d+1][(i + j) / 10] += dp[d][0];\n              if((i + j + 1) % 10 == k) dp[d+1][(i + j + 1) / 10] += dp[d][1];\n              dp[d+1][0] %= MOD;\n              dp[d+1][1] %= MOD;\n            }\n          }\n        }\n      }\n    }\n    cout << dp[n][0] << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\n#include <cctype>\n\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n//constexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1000000007;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\nconst long double PI = acos((long double)(-1));\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef long double ld;\n\nstruct mint {\n\tlong long x;\n\tmint(long long x = 0) :x((x% mod + mod) % mod) {}\n\tmint& operator+=(const mint a) {\n\t\tif ((x += a.x) >= mod) x -= mod;\n\t\treturn *this;\n\t}\n\tmint& operator-=(const mint a) {\n\t\tif ((x += mod - a.x) >= mod) x -= mod;\n\t\treturn *this;\n\t}\n\tmint& operator*=(const mint a) {\n\t\t(x *= a.x) %= mod;\n\t\treturn *this;\n\t}\n\tmint operator+(const mint a) const {\n\t\tmint res(*this);\n\t\treturn res += a;\n\t}\n\tmint operator-(const mint a) const {\n\t\tmint res(*this);\n\t\treturn res -= a;\n\t}\n\tmint operator*(const mint a) const {\n\t\tmint res(*this);\n\t\treturn res *= a;\n\t}\n\tmint pow(ll t) const {\n\t\tif (!t) return 1;\n\t\tmint a = pow(t >> 1);\n\t\ta *= a;\n\t\tif (t & 1) a *= *this;\n\t\treturn a;\n\t}\n\n\t// for prime mod\n\tmint inv() const {\n\t\treturn pow(mod - 2);\n\t}\n\tmint& operator/=(const mint a) {\n\t\treturn (*this) *= a.inv();\n\t}\n\tmint operator/(const mint a) const {\n\t\tmint res(*this);\n\t\treturn res /= a;\n\t}\n};\n\nint cnv(char c) {\n\tif (c == '?') return inf;\n\telse return c - '0';\n}\n\nvoid solve() {\n\tstring s[3]; cin >> s[0]; if (s[0] == \"0\") exit(0);\n\tcin >> s[1] >> s[2];\n\tfor (int i = 0; i < 3; i++) reverse(s[i].begin(), s[i].end());\n\tint n = s[0].size();\n\tvector<vector<mint>> dp(n + 1, vector<mint>(2));\n\tdp[0][0] = 1;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < 10; j++) {\n\t\t\tif (i + 1 == n and j == 0) continue;\n\t\t\tif (cnv(s[0][i]) != inf and cnv(s[0][i]) != j) continue;\n\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\tif (i + 1 == n and k == 0) continue;\n\t\t\t\tif (cnv(s[1][i]) != inf and cnv(s[1][i]) != k) continue;\n\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\tint sm = j + k + l;\n\t\t\t\t\tint r = sm % 10;\n\t\t\t\t\tint f = sm / 10;\n\t\t\t\t\tif (i + 1 == n and r == 0) continue;\n\t\t\t\t\tif (cnv(s[2][i]) == inf or cnv(s[2][i]) == r) {\n\t\t\t\t\t\tdp[i + 1][f] += dp[i][l];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << dp[n][0].x << \"\\n\";\n}\n\nint main()\n{\n\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tsolve();\n\t}\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <utility>\n#include <set>\n#include <map>\n#include <queue>\n#include <stack>\n#include <deque>\n#include <algorithm>\nusing namespace std;\ntypedef long double ld;\ntypedef long long ll;\ntypedef vector<int> vint;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<double, double> pdd;\n#define rep(i,n)\tfor(int i=0;i<n;i++)\n#define srep(i,a,n)\tfor(int i=a;i<n;i++)\n#define REP(i,n)\tfor(int i=0;i<=n;i++)\n#define rrep(i,n)\tfor(int i=n-1;i>=0;i--)\n#define all(a)\tbegin(a),end(a)\n#define mp(a,b)\tmake_pair(a,b)\n#define fst\tfirst\n#define scn second\n\nconst ll inf = (ll)1e18;\nconst ll mod = (ll)1e9 + 7;\nconst ld eps = 1e-9;\n\nll dp[100][2];\n\nint main() {\n\twhile (true) {\n\t\tstring a;\tcin >> a;\n\t\tif (a == \"0\")\tbreak;\n\t\tstring b, c;\tcin >> b >> c;\n\t\tif (c.size() != max(c.size(), max(a.size(), b.size()))) {\n\t\t\tcout << 0 << endl;\n\t\t\tcontinue;\n\t\t}\n\t\twhile (a.size() < c.size())\ta = \"0\" + a;\n\t\twhile (b.size() < c.size())\tb = \"0\" + b;\n\t\tint n = c.size();\n\t\trep(i, n)\tdp[i][0] = dp[i][1] = 0;\n\t\tsrep(i, 1, 10){\n\t\t\tif (a[0] != '?'&&i != a[0] - '0')\tcontinue;\n\t\t\tsrep(j, 1, 10){\n\t\t\t\tif (b[0] != '?'&&j != b[0] - '0')\tcontinue;\n\t\t\t\tsrep(k, 1, 10) {\n\t\t\t\t\tif (c[0] != '?'&&k != c[0] - '0')\tcontinue;\n\t\t\t\t\tif (k == i + j) {\n\t\t\t\t\t\tdp[0][0]++;\n\t\t\t\t\t}\n\t\t\t\t\telse if (k == i + j + 1) {\n\t\t\t\t\t\tdp[0][1]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsrep(i, 1, n) {\n\t\t\trep(x, 10) {\n\t\t\t\tif (a[i] != '?'&&x != a[i] - '0')\tcontinue;\n\t\t\t\trep(y, 10) {\n\t\t\t\t\tif (b[i] != '?'&&y != b[i] - '0')\tcontinue;\n\t\t\t\t\trep(z, 10) {\n\t\t\t\t\t\tif (c[i] != '?'&&z != c[i] - '0')\tcontinue;\n\t\t\t\t\t\tif (z == (x + y) % 10) {\n\t\t\t\t\t\t\tdp[i][0] = (dp[i][0] + dp[i - 1][(x + y) / 10]) % mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (z == (x + y + 1) % 10) {\n\t\t\t\t\t\t\tdp[i][1] = (dp[i][1] + dp[i - 1][(x + y + 1) / 10]) % mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n-1][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n\tstring s,t,u;\n\twhile(cin >> s,s!=\"0\"){\n\t\tcin >> t >> u;\n\t\tint n = s.length();\n\t\ts += '$';\n\t\tt += '$';\n\t\tu += '$';\n\t\treverse(s.begin(),s.end());\n\t\treverse(t.begin(),t.end());\n\t\treverse(u.begin(),u.end());\n\n\t\tlong long dp[100][2] = {};\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 1;i <= n;i++){\n\t\t\tchar a = s[i],b = t[i],c = u[i];\n\t\t\tint q = 0;\n\t\t\tif(a == '?')q++;\n\t\t\tif(b == '?')q++;\n\t\t\tif(c == '?')q++;\n\t\t\tint p = a - '0' + b - '0';\n\t\t\tswitch(q){\n\t\t\t\tint x,y;\n\t\t\t\tcase 0:\n\t\t\t\t\tx = p % 10;\n\t\t\t\t\ty = p / 10;\n\t\t\t\t\tif(x == c - '0' && y == 0)dp[i][0] += dp[i-1][0];\n\t\t\t\t\tif(x == c - '0' && y == 1)dp[i][1] += dp[i-1][0];\n\t\t\t\t\tif(x != c - '0' && y == 0)dp[i][0] += dp[i-1][1];\n\t\t\t\t\tif(x != c - '0' && y == 1)dp[i][1] += dp[i-1][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tif(p < 9)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(p == 9)dp[i][0] += dp[i-1][0],dp[i][1] += dp[i-1][1];\n\t\t\t\t\t\tif(p > 9)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tint d = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(d < c)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(d == c)dp[i][0] += dp[i-1][0],dp[i][1] = dp[i-1][1];\n\t\t\t\t\t\tif(d > c)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tx = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * max(0,10 - (x + 1 + j));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (10 - (x + j));\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (x + j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\ty = c - '0';\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y - 1 + j);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y + 1 + j);\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (10 - (y + 1 + j));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif(i == n){\n\t\t\t\t\t\tdp[i][0] += dp[i-1][0] * 36 + dp[i-1][1] * 28;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdp[i][0] += dp[i-1][0] * 55 + dp[i-1][1] * 45;\n\t\t\t\t\tdp[i][1] += dp[i-1][0] * 45 + dp[i-1][1] * 55;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdp[i][0] %= 1000000007,dp[i][1] %= 1000000007;\n\t\t}\n\t\tcout << dp[n][0] << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\nconst int M = 1000000007;\n\nint main(){\n    string s[3];\n    while(cin >> s[0], s[0][0] != '0'){\n        rep(i,2) cin >> s[i + 1];\n        rep(i,3) reverse(all(s[i]));\n\n        int n = s[0].size();\n        long long dp[55][2] = {{0}};\n        dp[0][0] = 1;\n        rep(i,n){\n            vector<int> a[3];\n            rep(j,3){\n                if(s[j][i] == '?'){\n                    if(i == n - 1){\n                        a[j] = vector<int>(9);\n                        iota(all(a[j]), 1);\n                    } else {\n                        a[j] = vector<int>(10);\n                        iota(all(a[j]), 0);\n                    }\n                }else{\n                    a[j].emplace_back(s[j][i] - '0');\n                }\n            }\n            for(auto j:a[0]){\n                for(auto k:a[1]){\n                    for(auto l:a[2]){\n                        if((j + k) % 10 == l) (dp[i + 1][(j + k) / 10] += dp[i][0]) %= M;\n                        if((j + k + 1) % 10 == l) (dp[i + 1][(j + k + 1) / 10] += dp[i][1]) %= M;\n                    }\n                }\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for(int i=0; i<(int)(n); ++i)\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nvoid add(int& x, int y){\n    x = (x + y) % MOD;\n}\n\nbool match(char c, int k){\n    if(c == '?') return true;\n    return c - '0' == k;\n}\n\nint main(){\n    string s, t, w;\n    while(cin >> s >> t >> w){\n        int n = s.size();\n        int cur[2] = {};\n        cur[0] = 1;\n        reverse(s.begin(), s.end());\n        reverse(t.begin(), t.end());\n        reverse(w.begin(), w.end());\n        for(int i = 0; i < n; i++){\n            int next[2] = {};\n            for(int x = (i < n - 1 ? 0 : 1); x < 10; x++) if(match(s[i], x)) {\n                for(int y = (i < n - 1 ? 0 : 1); y < 10; y++) if(match(t[i], y)) {\n                    for(int a = 0; a < 2; a++){\n                        int z = (x + y + a) % 10;\n                        if(z == 0 && i == n - 1) continue;\n                        int b = (x + y + a) / 10;\n                        if(match(w[i], z)) {\n                            add(next[b], cur[a]);\n                        }\n                    }\n                }\n            }\n            memcpy(cur, next, sizeof(cur));\n        }\n        cout << cur[0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\n\n\nconst int MOD = 1000000007;\n\nstring str1, str2, str3;\nlong long dp[55][2];\n\nint main() {\n    //freopen(\"/Users/macuser/Documents/Programming/Contest/test.in\", \"r\", stdin);\n    while (cin >> str1 >> str2 >> str3) {\n        if (str1 == \"0\") break;\n        \n        reverse(str1.begin(), str1.end());\n        reverse(str2.begin(), str2.end());\n        reverse(str3.begin(), str3.end());        \n        int n = str3.size();\n        \n        dp[0][0] = 1; dp[0][1] = 0;\n        for (int i = 0; i < n; ++i) {\n            int no_no = 0, no_up = 0, up_no = 0, up_up = 0;\n            \n            int start = 0;\n            if (i == n-1) start = 1;\n            \n            for (int a = start; a < 10; ++a) {\n                if (str1[i] != '?' && str1[i] != (char)(a + '0')) continue;\n                \n                for (int b = start; b < 10; ++b) {\n                    if (str2[i] != '?' && str2[i] != (char)(b + '0')) continue;\n                    \n                    for (int c = start; c < 10; ++c) {\n                        if (str3[i] != '?' && str3[i] != (char)(c + '0')) continue;\n                        \n                        if (a + b == c) ++no_no;\n                        else if (a + b + 1 == c) ++up_no;\n                        else if (a + b == c + 10) ++no_up;\n                        else if (a + b + 1 == c + 10) ++up_up;\n                    }\n                }\n            }\n            \n            dp[i+1][0] = (dp[i][0] * no_no + dp[i][1] * up_no) % MOD;\n            dp[i+1][1] = (dp[i][0] * no_up + dp[i][1] * up_up) % MOD;\n        }\n        \n        cout << dp[n][0] << endl;\n    }              \n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\nauthor: Hayato Kawakita\ndate: 2020/05/18 17:40\nvertict: AC\nURL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2182&lang=jp\n所要時間：10分\n左から見て行けば解ける。（類題を解いたことがあるので、そちらもあとで紹介として、載せます。\n*/\n\n#include <bits/stdc++.h>\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n#define repr(i, n) for (int i = (n); i >= 0; --i)\n#define FOR(i, m, n) for (int i = (m); i < (n); ++i)\n#define FORR(i, m, n) for (int i = (m); i >= (n); --i)\n#define equals(a, b) (fabs((a) - (b)) < EPS)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\nconst ll mod = 1000000007;\n//const ll mod = 998244353;\nconst int inf = 1e9 + 10;\nconst ll INF = 1e18;\nconst ld EPS = 1e-10;\nconst int dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nconst int dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\n\nstring a, b, c;\n\nvoid solve() {\n  reverse(a.begin(), a.end());\n  reverse(b.begin(), b.end());\n  reverse(c.begin(), c.end());\n  int n = a.length();\n\n  vector<vector<ll>> dp(n + 1, vector<ll>(2, 0));\n  dp[0][0] = 1;\n  rep(i, n) {\n    int xx = (a[i] == '?' ? -1 : a[i] - '0');\n    int yy = (b[i] == '?' ? -1 : b[i] - '0');\n    int zz = (c[i] == '?' ? -1 : c[i] - '0');\n    rep(x, 10) {\n      if (xx != -1 && xx != x) continue;\n      if (i == n - 1 && x == 0) continue;\n      rep(y, 10) {\n        if (yy != -1 && yy != y) continue;\n        if (i == n - 1 && y == 0) continue;\n        rep(z, 10) {\n          if (zz != -1 && zz != z) continue;\n          if (i == n - 1 && z == 0) continue;\n          rep(j, 2) {\n            if (x + y + j == z) dp[i + 1][0] = (dp[i + 1][0] + dp[i][j]) % mod;\n            if (x + y + j == z + 10) dp[i + 1][1] = (dp[i + 1][1] + dp[i][j]) % mod;\n          }\n        }\n      }\n    }\n  }\n  cout << dp[n][0] << '\\n';\n}\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout << fixed << setprecision(25);\n\n  while (1) {\n    cin >> a;\n    if (a == \"0\") return 0;\n    cin >> b >> c;\n\n    solve();\n  }\n\n\n\n\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\nusing namespace std;\ntypedef long long ll;\n\nconst ll mod = 1000000007;\n\nll dp[55][2];\n\nint main(){\n  string a,b,c;\n  while(cin >> a,a!=\"0\"){\n    cin >> b >> c;\n    int n = a.size();\n    \n    memset(dp,0,sizeof(dp));\n    dp[n][0] = 1;\n    rrep(i,n){\n      rep(j,10){\n\tif(i==0 && j==0)continue;\n\tif(a[i]!='?' && a[i]-'0'!=j)continue;\n\trep(k,10){\n\t  if(i==0 && k==0)continue;\n\t  if(b[i]!='?' && b[i]-'0'!=k)continue;\n\t  \n\t  rep(carry,2){\n\t    int nxtv = (j+k+carry)%10, nxtc = (j+k+carry)/10;\n\t    if(i==0 && nxtv==0)continue;\n\t    if(c[i]!='?' && c[i]-'0'!=nxtv)continue;\n\t    \n\t    (dp[i][nxtc] += dp[i+1][carry]) %= mod;\n\t  }\n\t}\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define ll long long int\nconst int MOD = (int)1e+9 + 7;\nint main(){\n\tstring s1,s2,s3;\n\twhile(cin>>s1,s1[0]!='0'){\n\t\tcin >> s2 >> s3;\n\t\tvector<vector<ll> > dp(s2.size()+1,vector<ll>(20,0));\n\t\tREP(i,10)dp[s2.size()][i]++;\n\t\tfor(int di=s2.size()-1;di>=0;di--){\n\t\t\tif(s1[di] == s2[di] && s2[di] == s3[di] && s1[di] == '?'){//all ?\n\t\t\t\tif(di==0){\n\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\tfor(int j=1;j<10;j++){\n\t\t\t\t\t\t\tdp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\tdp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\tREP(j,10){\n\t\t\t\t\t\t\tdp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\tdp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(s1[di] == s2[di] && s1[di] == '?'){//a and b are ?\n\t\t\t\t\tif(di==0){\n\t\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\t\tfor(int j=1;j<10;j++){\n\t\t\t\t\t\t\t\tif(i+j == s3[di]-'0' || i+j == s3[di]-'0'+10)dp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\t\telse if(i+j+1 == s3[di]-'0' || i+j+1 == s3[di]-'0'+10)dp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\t\tREP(j,10){\n\t\t\t\t\t\t\t\tif(i+j == s3[di]-'0' || i+j == s3[di]-'0'+10)dp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\t\telse if(i+j+1 == s3[di]-'0' || i+j+1 == s3[di]-'0'+10)dp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts3[di] = '0' + (s1[di] + s2[di] -'0'-'0')%10;\n\t\t\t\t}else if((s1[di] == s3[di] || s2[di] == s3[di]) && s3[di] == '?'){//a and c are ?\n\t\t\t\t\tif(s1[di]=='?')swap(s1[di],s2[di]);\n\t\t\t\t\tif(di==0){\n\t\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\t\n\t\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(s3[di] == '?'){//c is ?\n\t\t\t\t\tdp[di][s1[di]-'0'+s2[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\tdp[di][s1[di]-'0'+s2[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t}else if(s1[di] == '?' || s2[di] == '?'){//c is defined and ? exit\n\t\t\t\t\tif(s1[di]=='?')swap(s1[di],s2[di]);\n\t\t\t\t\tif(s3[di] - s1[di]<0){\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][9];\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][19];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(s3[di]-s1[di] > 0)dp[di][s3[di]-'0'] += dp[di+1][9];\n\t\t\t\t\t\tif(s3[di]-s1[di] > 1)dp[di][s3[di]-'0'] += dp[di+1][19];\n\t\t\t\t\t}\n\t\t\t\t}else{//all defined\n\t\t\t\t\tif(s1[di] + s2[di] -'0' - '0' == s3[di]- '0')\n\t\t\t\t\t\tdp[di][s3[di]-'0'] += dp[di+1][9];\n\t\t\t\t\telse if(s1[di] + s2[di] - '0' - '0' == s3[di] - '0' - 1)\n\t\t\t\t\t\tdp[di][s3[di]-'0'] += dp[di+1][19];\n\t\t\t\t\telse if(s1[di] - '0' + s2[di] - '0' - 10 == s3[di] - '0')\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][9];\n\t\t\t\t\telse\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][19];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(di != 0 || s3[0] == '?'){\n\t\t\t\tREP(i,19){\n\t\t\t\t\tdp[di][i+1] += dp[di][i]%MOD;\n\t\t\t\t}\n\t\t\t\tdp[di][19] -= dp[di][9];\n\t\t\t}\n\t\t}\n\t\tif(s3[0] == '?'){\n\t\t\tif(s1[0] != '?')\n\t\t\t\tcout << (dp[0][9] - dp[0][s1[0]-'0']) % MOD << endl;//a is defined\n\t\t\telse\n\t\t\t\tcout << dp[0][9] % MOD << endl;\n\t\t}else{ cout << dp[0][s3[0]-'0'] % MOD << endl;}//a aand b are ? or c is defined\n\t}\n\treturn 0;\n}\n\t\t\t\t\n\t\t\t\t\t"
  },
  {
    "language": "C++",
    "code": "#define _GLIBCXX_DEBUG\n#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for (int i = 0;i < (n);i++)\nusing ll = long long;\nconst ll MOD=1000000007;\nconst long long INF = 1LL << 60;\nconst double pi=acos(-1.0);\n\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return true; } return false; }\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return true; } return false; }\n\nstring A,B,C;\nvector<ll> table0;\nvector<ll> table1;\nll N;\n\nll dp0(ll);\nll dp1(ll);\n\nll dp0(ll n)\n{\n  if(n<0) return 1;\n  if(table0.at(n)>0) return table0.at(n);\n  int a=A.at(n)-'0',b=B.at(n)-'0',c=C.at(n)-'0';\n  if(c!='?'-'0')\n  {\n    if(a!='?'-'0')\n    {\n      if(b!='?'-'0')\n      {\n        if(a+b==c)\n        {\n          table0.at(n)+=dp0(n-1);\n        }\n        if(a+b+1==c)\n        {\n          table0.at(n)+=dp1(n-1);\n        }\n      }\n      else\n      {\n        if(a<=c) table0.at(n)+=dp0(n-1);\n        if(a<c) table0.at(n)+=dp1(n-1);\n      }\n    }\n    else\n    {\n      if(b!='?'-'0')\n      {\n        if(b<=c) table0.at(n)+=dp0(n-1);\n        if(b<c) table0.at(n)+=dp1(n-1);\n      }\n      else\n      {\n        if(n==N-1) c-=2;\n        table0.at(n)+=(c+1)*dp0(n-1);\n        table0.at(n)+=c*dp1(n-1);\n        if(c<0) table0.at(n)=0;\n      }\n    }\n  }\n  else\n  {\n    if(a!='?'-'0')\n    {\n      if(b!='?'-'0')\n      {\n        if(a+b<10) table0.at(n)+=dp0(n-1);\n        if(a+b+1<10) table0.at(n)+=dp1(n-1);\n      }\n      else\n      {\n        if(n==N-1) a++;\n        table0.at(n)+=(10-a)*dp0(n-1);\n        table0.at(n)+=(10-1-a)*dp1(n-1);\n        if(a>=10) table0.at(n)=0;\n      }\n    }\n    else\n    {\n      if(b!='?'-'0')\n      {\n        if(n==N-1) b++;\n        table0.at(n)+=(10-b)*dp0(n-1);\n        table0.at(n)+=(10-1-b)*dp1(n-1);\n        if(b>=10) table0.at(n)=0;\n      }\n      else\n      {\n        if(n==N-1)\n        {\n          table0.at(n)+=36*dp0(n-1);\n          table0.at(n)+=28*dp1(n-1);\n        }  \n        else\n        {\n          table0.at(n)+=55*dp0(n-1);\n          table0.at(n)+=45*dp1(n-1);\n        }\n      }\n    }\n  }\n  table0.at(n)%=MOD;\n  return table0.at(n);\n}\n\nll dp1(ll n)\n{\n  if(n<0) return 0;\n  if(table1.at(n)>0) return table1.at(n);\n  int a=A.at(n)-'0',b=B.at(n)-'0',c=C.at(n)-'0';\n  if(c!='?'-'0')\n  {\n    if(a!='?'-'0')\n    {\n      if(b!='?'-'0')\n      {\n        if(a+b==10+c) table1.at(n)+=dp0(n-1);\n        if(a+b+1==10+c) table1.at(n)+=dp1(n-1);\n      }\n      else\n      {\n        if(a>c) table1.at(n)+=dp0(n-1);\n        if(a>=c) table1.at(n)+=dp1(n-1);\n      }\n    }\n    else\n    {\n      if(b!='?'-'0')\n      {\n        if(b>c) table1.at(n)+=dp0(n-1);\n        if(b>=c) table1.at(n)+=dp1(n-1);\n      }\n      else\n      {\n        table1.at(n)+=(10-1-c)*dp0(n-1);\n        table1.at(n)+=(10-c)*dp1(n-1);\n      }\n    }\n  }\n  else\n  {\n    if(a!='?'-'0')\n    {\n      if(b!='?'-'0')\n      {\n        if(a+b>=10) table1.at(n)+=dp0(n-1);\n        if(a+b+1>=10) table1.at(n)+=dp1(n-1);\n      }\n      else\n      {\n        table1.at(n)+=a*dp0(n-1);\n        table1.at(n)+=(a+1)*dp1(n-1);\n      }\n    }\n    else\n    {\n      if(b!='?'-'0')\n      {\n        table1.at(n)+=b*dp0(n-1);\n        table1.at(n)+=(b+1)*dp1(n-1);\n      }\n      else\n      {\n        table1.at(n)+=45*dp0(n-1);\n        table1.at(n)+=55*dp1(n-1);\n      }\n    }\n  }\n  table1.at(n)%=MOD;\n  return table1.at(n);\n}  \n      \n        \n\nint main() \n{\n  while(true)\n  {\n    cin>>A;\n    if(A==\"0\") break;\n    cin>>B>>C;\n    N=A.size();\n    reverse(A.begin(),A.end());\n    reverse(B.begin(),B.end());\n    reverse(C.begin(),C.end());\n    table0=vector<ll>(N,0);\n    table1=vector<ll>(N,0);\n    \n    cout<<dp0(N-1)<<endl;\n  }  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nconst int INF=INT_MAX,MOD=1e9+7;\n\n\n\ndfs(int r,int q){\n\tint A;\n\tint B;\n\tint C;\n\tint sono;\n\tint kazu=0;\n\tif(q==n){\n\t\tif(r!=1)\n\t\tcount++;\n\t}\n\n\tif(q==n-1){\n\t\tkazu=1;\n\tfor(int i1= kazu; i1<9; i1++){\n\tfor(int i2= kazu; i2<9; i2++){\n\t\tfor(int i3= kazu; i3<9; i3++){\n\t\t\tA = i1;\n\t\t\tB = i2;\n\t\t\tC = i3;\n\t\t\tif(a[q]!='?')\n\t\t\tA = a[q]-'0';\n\t\t\tif(b[q]!='?')\n\t\t\tB = b[q]-'0';\n\t\t\tif(c[q]!='?')\n\t\t\tC = c[q]-'0';\n\n\t\t\tif((A+B+r)%10 == C){\n\t\t\t\tsono = (A+B+r)/C;\n\t\t\t\tdfs(sono,q+1);\n\t\t\t}\n\t\t}\n\t}\n\t}\n\t}\n}\nint main(){\n\tstring a,b,c;\n\twhile(cin>>a>>b>>c&&a!=\"0\"){\n\t\tint count =0;\n\t\tint n=a.size();\n\t\tint math[3][n]; int pattern[3][n];\n\t\treverse(a,a+n);reverse(b,b+n);reverse(c,c+n);\n\t\trep(i,n) math[0][i]=a[i]-'0';\n\t\trep(i,n) math[1][i]=b[i]-'0';\n\t\trep(i,n) math[2][i]=c[i]-'0';\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;)\n\t\t\tif([i]=='?'-'0'){\n\n\t\t\t}\n\t\t}\ndfs(0,0);\ncout << count << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//#define int long long\n#define reps(i,s,n) for(int (i)=(s);(i)<(n);++(i))\n#define rep(i,n) reps(i,0,n)\n#define rept(i,n) rep(i,(n)+1)\n#define repst(i,s,n) reps(i,s,(n)+1)\n#define reprt(i,n,t) for(int (i)=(n);(i)>=(t);--(i))\n#define repr(i,n) reprt(i,n,0)\n#define each(itr,v) for(auto &(itr):(v))\n#define all(c) (c).begin(),(c).end()\n#define rall(c) (c).rbegin(),(c).rend()\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define tmax(x,y,z) max(x,max(y,z))\n#define tmin(x,y,z) min(x,min(y,z))\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\n#define ln '\\n'\n#define bln(i,n) (((i)==(n)-1)?'\\n':' ')\n#define dbg(x) cout<<#x\" = \"<<(x)<<ln<<flush\n#define dbga(x,n) {cout<<#x\" : \";for(int (i)=0;i<(n);++i){cout<<((x)[i])<<(i==((n)-1)?'\\n':' ')<<flush;}}\n#define zero(a) memset(a,0,sizeof(a))\n#define unq(a) sort(all(a)),a.erase(unique(all(a)),a.end())\n\ntypedef long double ld;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<string> vst;\ntypedef vector<bool> vb;\ntypedef vector<ld> vld;\ntypedef vector<pii> vpii;\ntypedef vector<pll> vpll;\ntypedef vector<vector<int> > mat;\n\nconst ll inf = (ll)1e9+10;\nconst ll linf = (ll)1e18+10;\nconst ll mod = (ll)(1e9+7);\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\nconst double eps = 1e-10;\n\nll mop(ll a,ll b,ll m=mod) {ll r=1;a%=m;for(;b;b>>=1){if(b&1)r=r*a%m;a=a*a%m;}return r;}\nll gcd(ll a,ll b) {return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b) {return a*b/gcd(a,b);}\nbool ool(int x,int y,int h,int w) {return((x<0)||(h<=x)||(y<0)||(w<=y));}\n\nstruct oreno_initializer {\n\toreno_initializer() {\n\t\tcin.tie(0);\n\t\tios::sync_with_stdio(0);\n\t}\n} oreno_initializer;\n\n// ━━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…\n// .｡.:( ^ω^)・ﾟ＋.｡.:( ^ω^)・ﾟ＋.｡.:( ^ω^)・ﾟ＋.｡.:( ^ω^)・ﾟ＋.｡.:( ^ω^)・ﾟ＋\n// ・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・‥…━━━☆・\n\n// dp[i][j]: 小さい方からi桁目までを繰り上がりあり(j==1)なし(j==0)で埋める組み合わせの数\n// 求めるものはdp[n][0] 8通り場合分けは遷移がかなりややこしい ?の個数でまとまりそう\n// i==n-1のとき0は使っちゃいけない、C[i]==9かつj==1もあり得ない\n\nint n;\nconst char q = '?';\nll dp[55][2];\nstring a, b, c;\n\nvoid rec(int sx, int sy, int sz, int x, int y, int z, int id, int l) {\n\tif (l==0) {\n\t\tif (sx) reps(i,(id==n-1),10) rec(sx,sy,sz,i,y,z,id,l+1);\n\t\telse rec(sx,sy,sz,a[n-id-1]-'0',y,z,id,l+1);\n\t} else if (l==1) {\n\t\tif (sy) reps(i,(id==n-1),10) rec(sx,sy,sz,x,i,z,id,l+1);\n\t\telse rec(sx,sy,sz,x,b[n-id-1]-'0',z,id,l+1);\n\t} else if (l==2) {\n\t\tif (sz) reps(i,(id==n-1),10) rec(sx,sy,sz,x,y,i,id,l+1);\n\t\telse rec(sx,sy,sz,x,y,c[n-id-1]-'0',id,l+1);\n\t} else {\n\t\tif (x+y==z) (dp[id+1][0] += dp[id][0]) %= mod;\n\t\telse if (x+y+1==z) (dp[id+1][0] += dp[id][1]) %= mod;\n\t\telse if ((x+y)%10==z) (dp[id+1][1] += dp[id][0]) %= mod;\n\t\telse if ((x+y+1)%10==z) (dp[id+1][1] += dp[id][1]) %= mod;\n\t}\n}\n\nsigned main() {\n\twhile (1) {\n\t\tcin >> a;\n\t\tif (a==\"0\") break;\n\t\tcin >> b >> c;\n\t\tn = a.size();\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][0] = 1;\n\t\t\n\t\trep(i,n) {\n\t\t\tchar x = a[n-i-1], y = b[n-i-1], z = c[n-i-1];\n\t\t\tint sx = (x==q), sy = (y==q), sz = (z==q);\n\t\t\trec(sx,sy,sz,0,0,0,i,0);\n\t\t\t//cout << dp[i+1][0] << ' ' << dp[i+1][1] << ln;\n\t\t}\n\t\tcout << dp[n][0] << ln;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\n\n\n\nconst int mod = 1000000007;\nstruct Mod {\npublic:\n  int num;\n  Mod() : num(0) { ; }\n  Mod(long long int n) : num((n % mod + mod) % mod) { ; }\n  Mod(int n) : num((n % mod + mod) % mod) { ; }\n  operator int() { return num; }\n};\n\nMod operator+(const Mod a, const Mod b) { return Mod((a.num + b.num) % mod); }\nMod operator+(const long long int a, const Mod b) { return Mod(a) + b; }\nMod operator+(const Mod a, const long long int  b) { return b + a; }\nMod operator++(Mod &a) { return a + Mod(1); }\nMod operator-(const Mod a, const Mod b) { return Mod((mod + a.num - b.num) % mod); }\nMod operator-(const long long int a, const Mod b) { return Mod(a) - b; }\nMod operator--(Mod &a) { return a - Mod(1); }\nMod operator*(const Mod a, const Mod b) { return Mod(((long long)a.num * b.num) % mod); }\nMod operator*(const long long int a, const Mod b) { return Mod(a)*b; }\nMod operator*(const Mod a, const long long int b) { return Mod(b)*a; }\nMod operator*(const Mod a, const int b) { return Mod(b)*a; }\nMod operator+=(Mod &a, const Mod b) { return a = a + b; }\nMod operator+=(long long int &a, const Mod b) { return a = a + b; }\nMod operator-=(Mod &a, const Mod b) { return a = a - b; }\nMod operator-=(long long int &a, const Mod b) { return a = a - b; }\nMod operator*=(Mod &a, const Mod b) { return a = a * b; }\nMod operator*=(long long int &a, const Mod b) { return a = a * b; }\nMod operator*=(Mod& a, const long long int &b) { return a = a * b; }\nMod operator^(const Mod a, const int n) {\n  if (n == 0) return Mod(1);\n  Mod res = (a * a) ^ (n / 2);\n  if (n % 2) res = res * a;\n  return res;\n}\nMod mod_pow(const Mod a, const int n) {\n  if (n == 0) return Mod(1);\n  Mod res = mod_pow((a * a), (n / 2));\n  if (n % 2) res = res * a;\n  return res;\n}\nMod inv(const Mod a) { return a ^ (mod - 2); }\nMod operator/(const Mod a, const Mod b) {\n  assert(b.num != 0);\n  return a * inv(b);\n}\nMod operator/(const long long int a, const Mod b) {\n  assert(b.num != 0);\n  return Mod(a) * inv(b);\n}\nMod operator/=(Mod &a, const Mod b) {\n  assert(b.num != 0);\n  return a = a * inv(b);\n}\n\n#define MAX_MOD_N 1024000\n\nMod fact[MAX_MOD_N], factinv[MAX_MOD_N];\nvoid init() {\n  fact[0] = Mod(1); factinv[0] = 1;\n  for (int i = 0; i < MAX_MOD_N - 1; ++i) {\n    fact[i + 1] = fact[i] * Mod(i + 1);\n    factinv[i + 1] = factinv[i] / Mod(i + 1);\n  }\n}\nMod comb(const int a, const int b) {\n  return fact[a] * factinv[b] * factinv[a - b];\n}\n\nint main() {\n  \n  /*int N; cin >> N;\n  vector<int>as;\n  vector<int>num(10001);\n  for (int i = 0; i < N; ++i) {\n    int a; scanf(\"%d\", &a);\n    num[a]++;\n  }\n  vector<long long int>nums;\n  for (int i = 0; i < 10001; ++i) {\n    if (num[i] > 1) {\n      string st(to_string(i)+to_string(i));\n      nums.push_back(stoll(st));\n      if (num[i] >= 3) {\n        nums.push_back(stoi(st));\n        nums.push_back(stoi(st));\n      }\n    }\n    else if (num[i]) {\n      for (int j = 0; j < 10001; ++j) {\n        if (i == j)continue;\n        if (num[j]) {\n          int atime = min(3,num[i] * num[j]);\n          string st(to_string(i) + to_string(j));\n          for (int i = 0; i < atime; ++i) {\n\n            nums.push_back(stoll(st));\n          }\n        }\n      }\n    }\n  }\n  for (int i = 0; i < 2; ++i) {\n\n    auto it = min_element(nums.begin(), nums.end());\n    nums.erase(it);\n  }\n  auto it = min_element(nums.begin(), nums.end());\n  cout << *it << endl;\n  return 0;*/\n  while (1) {\n    vector<string> sts(3); cin >> sts[0];\n    if (sts[0] == \"0\")break;\n    cin>> sts[1] >> sts[2];\n\n    Mod dp[2000][2];\n    dp[sts[0].size()][0] = 1;\n    for (int keta = sts[0].size() - 1; keta >= 0; --keta) {\n      vector<char>cs(3);\n      cs[0] = sts[0][keta];\n      cs[1] = sts[1][keta];\n      cs[2] = sts[2][keta];\n      vector<int>froms(3);\n      vector<int>tos(3);\n      for (int i = 0; i < 3; ++i) {\n        if (cs[i] == '?') {\n          froms[i] = 0;\n          if (keta == 0)froms[i] = 1;\n          tos[i] = 9;\n        }\n        else {\n          froms[i] = cs[i] - '0';\n          if (keta == 0)froms[i] = max(froms[i], 1);\n          tos[i] = cs[i] - '0';\n        }\n      }\n      for (int agari = 0; agari < 2; ++agari) {\n        for (int a = froms[0]; a <= tos[0]; ++a) {\n          for (int b = froms[1]; b <= tos[1]; ++b) {\n            for (int c = froms[2]; c <= tos[2]; ++c) {\n              if (a + b + agari == c) {\n                dp[keta][0] += dp[keta + 1][agari];\n              }\n              else if (a + b + agari == c + 10) {\n                dp[keta][1] += dp[keta + 1][agari];\n              }\n            }\n          }\n        }\n      }\n    }\n    Mod ans = dp[0][0];\n    cout << ans << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\n#define MOD 1000000007\n\nint n;\nint dp[52][2];\nstring a, b, c;\n\nint main(){\n  while(cin >> a >> b >> c){\n    n = a.size();\n\n    memset(dp, 0, sizeof(dp));\n    dp[0][0] = 1;\n\n    for(int i = 0; i < n; i++){\n      for(int j = 0; j < 2; j++){\n        if(dp[i][j] == 0) continue;\n\n        int idx = n - i - 1;\n\n        for(int ai = 0; ai < 10; ai++){\n          if(a[idx] != '?' && a[idx] - '0' != ai) continue;\n          if(idx == 0 && ai == 0) continue;\n\n          for(int bi = 0; bi < 10; bi++){\n            if(b[idx] != '?' && b[idx] - '0' != bi) continue;\n            if(idx == 0 && bi == 0) continue;\n\n            for(int ci = 0; ci < 10; ci++){\n              if(c[idx] != '?' && c[idx] - '0' != ci) continue;\n              if(idx == 0 && ci == 0) continue;\n              if((ai + bi + j) % 10 != ci) continue;\n\n              int nj = (ai + bi + j) / 10;\n\n              dp[i + 1][nj] += dp[i][j];\n              dp[i + 1][nj] %= MOD;\n            }\n          }\n        }\n      }\n    }\n\n    cout << dp[n][0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nconstexpr int MOD = 1e9+7;\n\nstring a, b, c;\nll dp[51][3];\n\nint main() {\n\n  while(cin >> a) {\n    if(a == \"0\") break;\n    cin >> b >> c;\n    reverse(all(a));\n    reverse(all(b));\n    reverse(all(c));\n    int n = a.size();\n    vector<vector<int>> va(n), vb(n), vc(n);\n    rep(i, n) {\n      if(a[i] == '?')\n        REP(k, i==n-1, 10) va[i].push_back(k);\n      else\n        va[i].push_back(a[i]-'0');\n\n      if(b[i] == '?')\n        REP(k, i==n-1, 10) vb[i].push_back(k);\n      else\n        vb[i].push_back(b[i]-'0');\n\n      if(c[i] == '?')\n        REP(k, i==n-1, 10) vc[i].push_back(k);\n      else\n        vc[i].push_back(c[i]-'0');\n    }\n\n    zero(dp);\n    dp[0][0] = 1;\n\n    rep(i, n) rep(carry, 3) {\n      for(auto& da: va[i]) for(auto& db: vb[i]) for(auto& dc: vc[i]) {\n        int num = (da + db + carry) % 10;\n        int ncr = (da + db + carry) / 10;\n        if(num == dc) {\n          dp[i+1][ncr] += dp[i][carry];\n          dp[i+1][ncr] %= MOD;\n        }\n      }\n    }\n\n    cout << dp[n][0] << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nbool in_range(int a, int b){\n  return a >= 0 && a < b;\n}\n\nint main(){\n  string A;\n  while(cin >> A, A != \"0\"){\n    string B, C;\n    cin >> B >> C;\n    int n = A.length(), mod = 1e9 + 7;\n    vector< vector<long long int> > dp(n, vector<long long int>(2,0));\n    for(int i = n-1; i >= 0; --i){\n      if(C[i] != '?'){\n        int c = C[i] - '0';\n        if(A[i] != '?' && B[i] != '?'){\n          int a = A[i] - '0', b = B[i] - '0';\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(a + b == c){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && a + b + 1 == c){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(a + b == 10 + c){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && a + b + 1 == 10 + c){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(A[i] != '?'){//B[i] == '?'\n          int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(b,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              dp[i][0] += 1;\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b-1,10)){\n            if(i == 0 && b == 1) continue;\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(b_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b_-1,10)){\n            if(i == 0 && b_ == 1) continue;\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(B[i] != '?'){//A[i] == '?'\n          int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(a,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a-1,10)){\n            if(i == 0 && a == 1) continue;\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(a_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a_-1,10)){\n            if(i == 0 && a_ == 1) continue;\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else{//A[i] == B[i] == '?'\n          for(int a = 0; a < 10; ++a){\n            for(int b = 0; b < 10; ++b){\n              if(i == 0 && (a == 0 || b == 0)) continue;//leading zero\n              if(a + b == c){\n                if(i < n-1){\n                  dp[i][0] += dp[i+1][0];\n                  dp[i][0] %= mod;\n                }else{\n                  ++dp[i][0];\n                  dp[i][0] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c){\n                dp[i][0] += dp[i+1][1];\n                dp[i][0] %= mod;\n              }\n              if(a + b == c + 10){\n                if(i < n-1){\n                  dp[i][1] += dp[i+1][0];\n                  dp[i][1] %= mod;\n                }else{\n                  ++dp[i][1];\n                  dp[i][1] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c + 10){\n                dp[i][1] += dp[i+1][1];\n                dp[i][1] %= mod;\n              }\n            }\n          }\n        }\n      }else{//C[i] == '?'\n        for(int c = 0; c < 10; ++c){\n          if(i == 0 && c == 0) continue;\n          if(A[i] != '?' && B[i] != '?'){\n            int a = A[i] - '0', b = B[i] - '0';\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(a + b == c){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && a + b + 1 == c){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(a + b == 10 + c){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && a + b + 1 == 10 + c){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(A[i] != '?'){//B[i] == '?'\n            int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(b,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                dp[i][0] += 1;\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b-1,10)){\n              if(i == 0 && b == 1) continue;\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(b_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b_-1,10)){\n              if(i == 0 && b_ == 1) continue;\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(B[i] != '?'){//A[i] == '?'\n            int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(a,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a-1,10)){\n              if(i == 0 && a == 1) continue;\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(a_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a_-1,10)){\n              if(i == 0 && a_ == 1) continue;\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else{//A[i] == B[i] == '?'\n            for(int a = 0; a < 10; ++a){\n              for(int b = 0; b < 10; ++b){\n                if(i == 0 && (a == 0 || b == 0)) continue;//leading zero\n                if(a + b == c){\n                  if(i < n-1){\n                    dp[i][0] += dp[i+1][0];\n                    dp[i][0] %= mod;\n                  }else{\n                    ++dp[i][0];\n                    dp[i][0] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c){\n                  dp[i][0] += dp[i+1][1];\n                  dp[i][0] %= mod;\n                }\n                if(a + b == c + 10){\n                  if(i < n-1){\n                    dp[i][1] += dp[i+1][0];\n                    dp[i][1] %= mod;\n                  }else{\n                    ++dp[i][1];\n                    dp[i][1] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c + 10){\n                  dp[i][1] += dp[i+1][1];\n                  dp[i][1] %= mod;\n                }\n              }\n            }\n          } \n        }\n      }\n    }\n    //for(int i = 0; i < n; ++i) cout << dp[i][0] << \" \";cout << endl;\n    //for(int i = 0; i < n; ++i) cout << dp[i][1] << \" \";cout << endl;\n\n    cout << dp[0][0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define INF 100000000\n#define EPS 1e-10\n#define MOD 1000000007\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef long long ll;\n\nstring a, b, c;\nll dp[2][100];\n\nll calc(int dif, int rank){\n\tll ret = 0;\n\tif(rank == -1){\n\t\tif(dif == 0) return 1;\n\t\telse return 0;\n\t}\n\tif(dp[dif][rank] != -1) return dp[dif][rank];\n\tif(a[rank] != '?' && b[rank] != '?'){\n\t\tint A = a[rank]-'0', B = b[rank]-'0';\n\t\tif(c[rank] == '?' || (A+B+dif)%10 == c[rank]-'0'){\n\t\t\tif(A+B+dif >= 10) ret = calc(1,rank-1);\n\t\t\telse ret = calc(0,rank-1);\n\t\t}\n\t\tdp[dif][rank] = ret;\n\t\treturn ret;\n\t}\n\tif(a[rank] == '?' && b[rank] != '?') swap(a[rank],b[rank]);\n\tif(a[rank] != '?' && b[rank] == '?'){\n\t\tint A = a[rank]-'0';\n\t\tfor(int B = 0; B <= 9; B++){\n\t\t\tif(rank == 0 && B == 0) continue;\n\t\t\tif(c[rank] == '?' || (A+B+dif)%10 == c[rank]-'0'){\n\t\t\t\tif(A+B+dif >= 10) ret += calc(1,rank-1);\n\t\t\t\telse ret += calc(0,rank-1);\n\t\t\t}\n\t\t}\n\t\tdp[dif][rank] = ret%MOD;\n\t\treturn ret%MOD;\n\t}\n\tfor(int A = 0; A <= 9; A++){\n\t\tif(rank == 0 && A == 0) continue;\n\t\tfor(int B = 0; B <= 9; B++){\n\t\t\tif(rank == 0 && B == 0) continue;\n\t\t\tif(c[rank] == '?' || (A+B+dif)%10 == c[rank]-'0'){\n\t\t\t\tif(A+B+dif >= 10) ret += calc(1,rank-1);\n\t\t\t\telse ret += calc(0,rank-1);\n\t\t\t}\n\t\t}\n\t}\n\tdp[dif][rank] = ret%MOD;\n\treturn ret%MOD;\n}\n\nvoid solve(){\n\trep(i,2) rep(j,100) dp[i][j] = -1;\n\tcout << calc(0,a.size()-1) << endl;\n}\n\nint main(){\n\twhile(cin >> a >> b >> c){\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\n/*\ntemplate<class... T>\nostream& operator<<(ostream& os, tuple<T...>& t) {\n\tfor (size_t i = 0; i < tuple_size< tuple<T...> >::value; ++i) {\n\t\tif (i) os << \" \";\n\t\tos << get<0>(t);\n\t}\n\treturn os;\n}\n*/\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nll mod = 1e9+7;\n\nll dp[100][2];\nll add(ll a, ll b) {\n\treturn (a + b) % mod;\n}\nvector<int> f(string s) {\n\tvector<int> res;\n\tREP(i, s.size()) {\n\t\tres.pb(s[i] == '?' ? -1 : s[i]-'0');\n\t}\n\treturn res;\n}\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\tstring s1, s2, s3;\n\twhile ( cin >> s1, s1 != \"0\" ) {\n\t\tcin >> s2 >> s3;\n\t\tint N = s1.size();\n\t\tvector<int> v1, v2, v3;\n\t\tv1 = f(s1);\n\t\tv2 = f(s2);\n\t\tv3 = f(s3);\n\t\tfill(dp[0], dp[100], 0); dp[0][0] = 1;\n\t\tREP(i, N) REP(j, 2) {\n\t\t\tif (dp[i][j] == 0) continue;\n\t\t\tREP(a, 10) REP(b, 10) REP(ab, 2) {\n\t\t\t\tint c = a + b + ab;\n\t\t\t\tint k = 0;\n\t\t\t\tif (c >= 10) c %= 10, k = 1;\n\t\t\t\tif (v1[i] != -1 && a != v1[i]) continue;\n\t\t\t\tif (v2[i] != -1 && b != v2[i]) continue;\n\t\t\t\tif (v3[i] != -1 && c != v3[i]) continue;\n\t\t\t\tif (i == 0 && (a == 0 || b == 0 || c == 0)) continue;\n\t\t\t\tif (j != k) continue;\n//\t\t\t\tcout << i << \" \" << j << \" \" << \" \" << ab << \" \" << a << \" \" << b << \" \" << c << endl;\n\t\t\t\tdp[i+1][ab] = add(dp[i+1][ab], dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tll ans = dp[N][0];\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n#include <fstream>\n#include <cassert>\nusing namespace std;\n\n//common\ntypedef int  i32;\ntypedef long long i64,ll;\ntypedef vector<int> vi; typedef pair<int,int> pii; typedef vector<pair<int,int> > vpii;\ntypedef long long ll; typedef vector<long long> vl; typedef pair<long long,long long> pll; typedef vector<pair<long long,long long> > vpll;\ntypedef vector<string> vs; typedef long double ld;\n\n#define BR \"\\n\"\n#define ALL(c) (c).begin(),(c).end()\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define EACH(it,o) for(auto it = (o).begin(); it != (o).end(); ++it)\n#define IN(l,v,r) ((l)<=(v) && (v)<(r))\n\n//config\n//#undef NDEBUG\n//#define INF 1<<30\n//#define EPS 1e-8\n//const ll MOD =100000007;\n\n//debug\n#ifdef NDEBUG\n#define DUMP(x)\n#define DUMPLN(x)\n#define DEBUG(x)\n#define DEBUGLN(x)\n#define LINE()\n#define LINELN()\n#define CHECK(exp,act)\n#define STOP(e)\n#else\n#define DUMP(x)  cerr << #x << \" = \" << (x)\n#define DUMPLN(x)  DUMP(x) <<endl\n#define DEBUG(x) DUMP(x) << LINE() << \" \" << __FILE__\n#define DEBUGLN(x) DEBUG(x)<<endl\n#define LINE()    cerr<< \" (L\" << __LINE__ << \")\"\n#define LINELN()    LINE()<<endl\n#define CHECK(exp,act)  if(exp!=act){DUMPLN(exp);DEBUGLN(act);}\n#define STOP(e)  CHECK(e,true);if(!(e)) exit(1);\n#endif\n\ntemplate<class T> inline string toString(const vector<T>& x) {\n\tstringstream ss;\n\tREP(i,x.size()){\n\t\tif(i!=0)ss<<\" \";\n\t\tss<< x[i];\n\t}\n\treturn ss.str();\n}\n\ntemplate<class T> inline string toString(const vector<vector<T> >& map) {\n\tstringstream ss;\n\tREP(i,map.size()){\n\t\tif(i!=0)ss<<BR;\n\t\tss<< toString(map[i]);\n\t}\n\treturn ss.str();\n}\ntemplate<class K,class V>  string toString(map<K,V>& x) {\n\tstring res;stringstream ss;\n\tfor(auto& p:x)ss<< p.first<<\":\" << p.second<<\" \";\n\treturn ss.str();\n}\n\nstring BITtoString(int bit){\n    stringstream ss;\n    while(bit!=0){ss<<(bit%2);bit/=2;}\n    string res=ss.str();reverse(ALL(res));\n    return res;\n}\n\ntemplate<typename T,typename V> inline T pmod(T v,V MOD){\n\treturn (v%MOD+MOD)%MOD;\n}\n\n#define nextInt(n) scanf(\"%d\",&n)\n#define nextLong(n) scanf(\"%lld\",&n)\n#define nextDouble(n) scanf(\"%lf\",&n)\n\nll MOD=1000000007;\nclass Main{\npublic:\n\n\tstring A,B,C;\n\tbool input(){\n\t\tcin >> A;if(A==\"0\")return false;\n\t\tcin >> B >> C;\n\t\treturn true;\n\t}\n\n\tint solve(){\n\t\tint sz=A.size();\n\t\tvector<vector<ll>> dp(sz+1,vector<ll>(2));\n\t\tdp[sz][0]=1;\n\n\t\tfor(int i=sz-1;i>=0;i--){\n\t\t\tREP(up,2)for(int a=0;a<=9;a++)for(int b=0;b<=9;b++)for(int c=0;c<=9;c++){\n\t\t\t\tif(a+'0'!=A[i] && A[i]!='?')continue;\n\t\t\t\tif(b+'0'!=B[i] && B[i]!='?')continue;\n\t\t\t\tif(c+'0'!=C[i] && C[i]!='?')continue;\n\t\t\t\tif(i==0)if(a==0 || b==0 || c==0)continue;\n\n\t\t\t\tREP(pup,2)if(a+b+pup==c+10*up)\n\t\t\t\t\tdp[i][up]=pmod(dp[i][up]+dp[i+1][pup],MOD);\n\t\t\t}\n\t\t}\n\t\treturn dp[0][0];\n\t}\n\n\tvoid run(){\n\t\twhile(true){\n\t\t\tif(!input())break;\n\t\t\tcout << solve()<<endl;\n\t\t}\n\t}\n};\n\n int main(){\n\t//ios::sync_with_stdio(false);\n \tMain().run();\n \treturn 0;\n }"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst long long MOD=1e9+7;\n\ntemplate<uint_fast64_t Modulus> class modint{\n    using u64=uint_fast64_t;\n    public:\n    u64 a;\n    constexpr modint(const u64 x=0) noexcept:a(((x%Modulus)+Modulus)%Modulus){}\n    constexpr u64 &value() noexcept{return a;}\n    constexpr const u64 &value() const noexcept{return a;}\n    constexpr modint &operator+=(const modint &rhs) noexcept{\n        a+=rhs.a;\n        if (a>=Modulus) a-=Modulus;\n        return *this;\n    }\n    constexpr modint operator+(const modint &rhs) const noexcept{\n        return modint(*this)+=rhs;\n    }\n    constexpr modint &operator++() noexcept{\n        return ++a,*this;\n    }\n    constexpr modint operator++(int) noexcept{\n        modint t=*this; return ++a,t;\n    }\n    constexpr modint &operator-=(const modint &rhs) noexcept{\n        if (a<rhs.a) a+=Modulus;\n        a-=rhs.a;\n        return *this;\n    }\n    constexpr modint operator-(const modint &rhs) const noexcept{\n        return modint(*this)-=rhs;\n    }\n    constexpr modint &operator--() noexcept{\n        return --a,*this;\n    }\n    constexpr modint operator--(int) noexcept{\n        modint t=*this; return --a,t;\n    }\n    constexpr modint &operator*=(const modint &rhs) noexcept{\n        a=a*rhs.a%Modulus;\n        return *this;\n    }\n    constexpr modint operator*(const modint &rhs) const noexcept{\n        return modint(*this)*=rhs;\n    }\n    constexpr modint &operator/=(modint rhs) noexcept{\n        u64 exp=Modulus-2;\n        while(exp){\n            if (exp&1) *this*=rhs;\n            rhs*=rhs; exp>>=1;\n        }\n        return *this;\n    }\n    constexpr modint operator/(const modint &rhs) const noexcept{\n        return modint(*this)/=rhs;\n    }\n    constexpr modint operator-() const noexcept{\n        return modint(Modulus-a);\n    }\n    constexpr bool operator==(const modint &rhs) const noexcept{\n        return a==rhs.a;\n    }\n    constexpr bool operator!=(const modint &rhs) const noexcept{\n        return a!=rhs.a;\n    }\n    constexpr bool operator!() const noexcept{return !a;}\n    friend constexpr modint pow(modint rhs,long long exp) noexcept{\n        modint res{1};\n        while(exp){\n            if (exp&1) res*=rhs;\n            rhs*=rhs; exp>>=1;\n        }\n        return res;\n    }\n    template<class T> friend constexpr modint operator+(T x,modint y) noexcept{\n        return modint(x)+y;\n    }\n    template<class T> friend constexpr modint operator-(T x,modint y) noexcept{\n        return modint(x)-y;\n    }\n    template<class T> friend constexpr modint operator*(T x,modint y) noexcept{\n        return modint(x)*y;\n    }\n    template<class T> friend constexpr modint operator/(T x,modint y) noexcept{\n        return modint(x)/y;\n    }\n    friend ostream &operator<<(ostream &s,const modint &rhs) noexcept{\n        return s << rhs.a;\n    }\n    friend istream &operator>>(istream &s,modint &rhs) noexcept{\n        u64 a; rhs=modint{(s >> a,a)}; return s;\n    }\n};\n\nusing mint=modint<MOD>;\n\nstring A,B,C;\n\nvoid solve(){\n    reverse(A.begin(),A.end());\n    reverse(B.begin(),B.end());\n    reverse(C.begin(),C.end());\n    int n=A.size();\n    vector<vector<mint>> dp(n+1,vector<mint>(2,0));\n    dp[0][0]=1;\n    for (int i=0;i<n;++i){\n        for (int j=0;j<2;++j){\n            for (int k=(i==n-1?1:0);k<10;++k){\n                if (A[i]!='?'&&k!=A[i]-'0') continue;\n                for (int l=(i==n-1?1:0);l<10;++l){\n                    if (B[i]!='?'&&l!=B[i]-'0') continue;\n                    for (int m=(i==n-1?1:0);m<10;++m){\n                        if (C[i]!='?'&&m!=C[i]-'0') continue;\n                        if ((j+k+l)%10==m){\n                            dp[i+1][(j+k+l)/10]+=dp[i][j];\n                        }\n                    }\n                }\n            }\n        }\n    }\n    cout << dp[n][0] << '\\n';\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> A,A!=\"0\"){\n        cin >> B >> C;\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\n#define int long long\ntypedef pair<int,int> P;\nstring s[3];\nint c;\nP ch(int p,int x){\n  P a;a=P(0,0);\n  r(i,10)if(c+i)if(s[0][p]=='?'||s[0][p]==i+'0')\n    r(j,10)if(c+j)if(s[1][p]=='?'||s[1][p]==j+'0'){\n      int t=i+j+x;\n      if(s[2][p]!='?'&&t%10!=s[2][p]-'0')continue;\n      if(t>9)a.fi++;\n      else a.se++;\n    }\n  return a;\n}\nmain(){\n  while(cin>>s[0],s[0]!=\"0\"){\n    cin>>s[1]>>s[2];c=1;\n    r(i,3)reverse(s[i].begin(),s[i].end());\n    int sum1=1,sum2=0,t;\n    r(i,s[0].size()){\n      if(i==s[0].size()-1)c--;\n      P a1=ch(i,0),a2=ch(i,1);\n      t=sum1*a1.se+sum2*a2.se;\n      sum2=(sum1*a1.fi+sum2*a2.fi)%1000000007;\n      sum1=t%1000000007;\n    }\n    cout<<sum1<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <map>\nusing namespace std;\n\ntypedef pair<int, int> pii;\nconst long long int MOD = 1000000007;\nlong long int dp[60][2];\n\npii calc(int a, int b, int c, bool x, bool y, bool z, int p, map<pair<pii, int>, int> &mp) {\n    if(mp.count(make_pair(make_pair(a, b), c))) return make_pair(0, 0);\n    mp[make_pair(make_pair(a, b), c)]++;\n\n    pii ret(0, 0);\n    if(((a+b+p)%10) == c) {\n        if((a+b+p)>=10) ret.first++;\n        else ret.second++;\n    }\n\n    if(a < 9 && !x) {\n        pii tmp = calc(a+1, b, c, x, y, z, p, mp);\n        ret.first += tmp.first;\n        ret.second += tmp.second;\n    }\n    if(b < 9 && !y) {\n        pii tmp = calc(a, b+1, c, x, y, z, p, mp);\n        ret.first += tmp.first;\n        ret.second += tmp.second;\n    }\n    if(c < 9 && !z) {\n        pii tmp = calc(a, b, c+1, x, y, z, p, mp);\n        ret.first += tmp.first;\n        ret.second += tmp.second;\n    }\n    return ret;\n}\n\nint main() {\n    string a, b, c;\n    while(cin >> a) {\n        if(a == \"0\") break;\n        cin >> b >> c;\n        int N = a.length();\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n\n        memset(dp, 0, sizeof(dp));\n        dp[0][0] = 1;\n        for(int i=0; i<N; i++) {\n            for(int j=0; j<2; j++) {\n                int cnt[2] = {};\n                int p = isdigit(a[i]) ? a[i] - '0' : (i==N-1);\n                int q = isdigit(b[i]) ? b[i] - '0' : (i==N-1);\n                int r = isdigit(c[i]) ? c[i] - '0' : (i==N-1);\n                map<pair<pii, int>, int> mp;\n                pii tmp = calc(p, q, r, isdigit(a[i]), isdigit(b[i]), isdigit(c[i]), j, mp);\n                cnt[0] = tmp.second;\n                cnt[1] = tmp.first;\n\n                for(int k=0; k<2; k++) {\n                    (dp[i+1][k] += dp[i][j] * cnt[k]) %= MOD;\n                }\n            }\n        }\n\n        printf(\"%lld\\n\", dp[N][0]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n\nusing namespace std;\n\ntypedef long long int ll;\nconst int MOD = 1e9 + 7, N = 50;\nll dp[N][2];\n\nint main(){\n\tstring a, b, c;\n\tint n, s;\n\twhile(cin >> a){\n\t\tfill(dp[0], dp[N], (ll)0);\n\t\tif(a[0] == '0') break;\n\t\tcin >> b >> c;\n\t\tn = a.length();\n\t\tfor(int i = 0;i < n;++i){\n\t\t\tint idx = n - i - 1;\n\t\t\tfor(int j = 0;j < (i == 0 ? 1 : 2);++j){\n\t\t\t\tint cc = 0, nc = 0;\n\t\t\t\tfor(int x = 0;x < 10;++x){\n\t\t\t\t\tif(a[idx] != '?' && (a[idx] - '0') != x) continue;\n\t\t\t\t\tif(!idx && !x) continue;\n\t\t\t\t\tfor(int y = 0;y < 10;++y){\n\t\t\t\t\t\tif(b[idx] != '?' && (b[idx] - '0') != y) continue;\n\t\t\t\t\t\tif(!idx && !y) continue;\n\t\t\t\t\t\tfor(int z = 0;z < 10;++z){\n\t\t\t\t\t\t\tif(c[idx] != '?' && (c[idx] - '0') != z) continue;\n\t\t\t\t\t\t\ts = x + y + j;\n\t\t\t\t\t\t\tif(s == z) ++nc;\n\t\t\t\t\t\t\telse if(s % 10 == z) ++cc;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(i){\n\t\t\t\t\tdp[i][0] += (nc * dp[i - 1][j]) % MOD;\n\t\t\t\t\tdp[i][1] += (cc * dp[i - 1][j]) % MOD;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[i][0] += nc;\n\t\t\t\t\tdp[i][1] += cc;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i][0] %= MOD;\n\t\t\tdp[i][1] %= MOD;\n\t\t}\n\t\t/*\n\t\tfor(int i = 0;i < n;++i){\n\t\t\tcout << dp[i][0] << \" \" << dp[i][1] << endl;\n\t\t}\n\t\t*/\n\t\tcout << dp[n - 1][0] << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define M 1000000007\n#define N 55\nusing namespace std;\ntypedef long long ll;\nstring num[3];\nll d[N][2],ans;\n\nstring get_num(int x,int y){\n  string res;\n  if(num[y][x]!='?')res+=num[y][x];\n  else res+=\"0123456789\";\n  return res;\n}\n\nvoid update(int x){\n  string a=get_num(x,0);\n  string b=get_num(x,1);\n  string c=get_num(x,2);\n\n  ll A=0,B=0,C=0,D=0;\n  for(int i=0;i<a.size();i++){\n    for(int j=0;j<b.size();j++){\n      for(int k=0;k<c.size();k++){\n\tint sum=a[i]-'0'+b[j]-'0';\n\tint Ans=c[k]-'0';\n\tif(!x&&(a[i]=='0'||b[j]=='0'||c[k]=='0'))continue;\n\tif(sum%10==Ans){\n\t  if(sum<10)A++;\n\t  else B++;\n\t}\n\tif((sum+1)%10==Ans){\n\t  if(sum+1<10)C++;\n\t  else D++;\n\t}\n      }\n    }\n  }\n  \n  if(!x)ans=(d[x][0]*A+d[x][1]*C)%M;\n  else{\n    d[x-1][0]=(d[x][0]*A+d[x][1]*C)%M;\n    d[x-1][1]=(d[x][0]*B+d[x][1]*D)%M;\n  }\n}\n\nint main(){\n  while(1){\n    cin>>num[0];\n    if(num[0]==\"0\")break;\n    cin>>num[1]>>num[2];\n\n    memset(d,0,sizeof(d));\n    d[num[0].size()-1][0]=1;\n    \n    for(int i=num[0].size()-1;i>=0;i--)update(i);\n    \n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nll solve1() {\n    if (A[0] == '?' && B[0] == '?') {\n        int cnt = 0;\n        if (C[0] == '?') {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j < 10) ++cnt;\n                }\n            }\n        } else {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j == C[0] - '0') ++cnt;\n                }\n            }\n        }\n        return cnt;\n    }\n    else if(A[0] == '?' || B[0] == '?') {\n        if (A[0] == '?') swap(A[0], B[0]);\n        if (C[0] == '?') {\n            int d = C[0] - A[0];\n            if (d <= 0) return 0;\n            else return 9 - (A[0] - '0');\n        } else {\n            if (C[0] - '0' - A[0] - '0' > 0) {\n                return 1;\n            } else {\n                return 0;\n            }\n        }\n    }\n    else {\n        if (C[0] == '?') {\n            int x = A[0] - '0' + B[0] - '0';\n            return 0 < 1 && x < 10;\n        } else {\n            return A[0] - '0' + B[0] - '0' == C[0] - '0';\n        }\n    }\n}\n\nint main() {\n    while (cin >> A, A != \"0\") {\n        cin >> B >> C;\n\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        int n = B.size();\n        \n        if (n == 1) {\n            cout << solve1() << endl;\n            continue;\n        } \n        \n        ll dp[55][2] = { 0 };\n\n        dp[0][0] = 1;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < 2; j++) {\n                int q = 0, s = 0, t = 0;\n                if (A[i] == '?') q++;\n                else s += A[i] - '0';\n                if (B[i] == '?') q++;\n                else s += B[i] - '0';\n                if (C[i] != '0') t = C[i] - '0';\n                if (q == 2) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        for (int b = 0; b <= 9; b++) {\n                            if (i == n - 1 && b == 0) continue;\n                            if (i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n                            if ((C[i] == '?' || (a + b + j) % 10 == t)) {\n                                if (a + b + j >= 10) {\n                                    (dp[i + 1][1] += dp[i][j]) %= MOD;\n                                } else {\n                                    (dp[i + 1][0] += dp[i][j]) %= MOD;\n                                }\n                            }\n                        }\n                    }\n                } else if (q == 1) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        if ((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n                        if (C[i] == '?' || (s + a + j) % 10 == t) {\n                            if (s + a + j >= 10) {\n                                (dp[i + 1][1] += dp[i][j]) %= MOD;\n                            } else {\n                                (dp[i + 1][0] += dp[i][j]) %= MOD;\n                            }\n                        }\n                    }\n                } else { // q == 0\n                    if ((i == n - 1 && (s + j) % 10 == 0)) continue;\n                    if (C[i] == '?' || (s + j) % 10 == t) {\n                        if ((s + j) >= 10) {\n                            (dp[i + 1][1] += dp[i][j]) %= MOD;\n                        } else {\n                            (dp[i + 1][0] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n            }// for j\n        }// for i\n        cout << dp[n][0] << endl;\n    }// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nconst int INF=INT_MAX,MOD=1e9+7;\n\n\n\nvoid dfs(int r,int q){\n\tint A;\n\tint B;\n\tint C;\n\tint sono;\n\tint kazu=0;\n\tif(q==n){\n\t\tif(r!=1)\n\t\tcount++;\n\t}\n\n\tif(q==n-1){\n\t\tkazu=1;\n\tfor(int i1= kazu; i1<9; i1++){\n\tfor(int i2= kazu; i2<9; i2++){\n\t\tfor(int i3= kazu; i3<9; i3++){\n\t\t\tA = i1;\n\t\t\tB = i2;\n\t\t\tC = i3;\n\t\t\tif(a[q]!='?')\n\t\t\tA = a[q]-'0';\n\t\t\tif(b[q]!='?')\n\t\t\tB = b[q]-'0';\n\t\t\tif(c[q]!='?')\n\t\t\tC = c[q]-'0';\n\n\t\t\tif((A+B+r)%10 == C){\n\t\t\t\tsono = (A+B+r)/C;\n\t\t\t\tdfs(sono,q+1);\n\t\t\t}\n\t\t}\n\t}\n\t}\n\t}\n}\nint main(){\n\tstring a,b,c;\n\twhile(cin>>a>>b>>c&&a!=\"0\"){\n\t\tint count =0;\n\t\tint n=a.size();\n\t\tint math[3][n]; int pattern[3][n];\n\t\treverse(a,a+n);reverse(b,b+n);reverse(c,c+n);\n\t\trep(i,n) math[0][i]=a[i]-'0';\n\t\trep(i,n) math[1][i]=b[i]-'0';\n\t\trep(i,n) math[2][i]=c[i]-'0';\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;)\n\t\t\tif([i]=='?'-'0'){\n\n\t\t\t}\n\t\t}\ndfs(0,0);\ncout << count << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = ll(1e9 + 7);\nstring A, B, C;\n\nint N;\nll dp[51][2][2];\n\nint main(){\n    while(cin >> A, A != \"0\"){\n        cin >> B >> C;\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        N = A.size();\n        memset(dp, 0, sizeof dp);\n        int sle = 1;\n        dp[0][0][sle] = 1;\n        for(int i = 0; i < N; i++){\n            for(int c = 0; c < 2; c++){\n                for(int le = 0; le < 2; le++){\n                    //cerr << i << \" \" << c << \" \" << le << \" \" << dp[i][c][le] << endl;\n\n                    if(dp[i][c][le] == 0) continue;\n\n                    int fixa = -1, fixb = -1;\n                    if(isdigit(A[i])) fixa = A[i] - '0';\n                    if(isdigit(B[i])) fixb = B[i] - '0';\n                    for(int a = 0; a < 10; a++){\n                        if(fixa != -1 && a != fixa) continue;\n                        if(i == N - 1 && a == 0) continue;\n                        for(int b = 0; b < 10; b++){\n                            if(fixb != -1 && b != fixb) continue;\n                            if(i == N - 1 && b == 0) continue;\n\n                            int s = a + b + c;\n                            int x = s % 10;\n\n                            //cerr << \"\\t\" <<  a << \" \" << b << \" \" << x << endl;\n                            if(isdigit(C[i]) && C[i] - '0' != x) continue;\n                            int cc = isdigit(C[i]) ? C[i] - '0' : 9;\n\n                            int ncarry = s / 10;\n                            int nle = 0;\n                            if(le){\n                                nle = (x <= cc);\n                            }\n                            else{\n                                nle = (x < cc);\n                            }\n                            \n\n                            dp[i + 1][ncarry][nle] += dp[i][c][le];\n                            dp[i + 1][ncarry][nle] %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << dp[N][0][1] << endl;\n        //return 0;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nconst int mod = 1000000007;\nstring a, b, c;\nint main() {\n\twhile (cin >> a >> b >> c) {\n\t\treverse(a.begin(), a.end());\n\t\treverse(b.begin(), b.end());\n\t\treverse(c.begin(), c.end());\n\t\tint n = a.size();\n\t\tvector<vector<int> > dp(n + 1, vector<int>(20, 0)); dp[0][0] = 1;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j <= 9; j++) {\n\t\t\t\tif (i + 1 == n && j == 0) continue;\n\t\t\t\tif (a[i] != '?' && a[i] != j + 48) continue;\n\t\t\t\tfor (int k = 0; k <= 9; k++) {\n\t\t\t\t\tif (i + 1 == n && k == 0) continue;\n\t\t\t\t\tif (b[i] != '?' && b[i] != k + 48) continue;\n\t\t\t\t\tfor (int l = 0; l <= 19; l++) {\n\t\t\t\t\t\tint w = j + k + l / 10;\n\t\t\t\t\t\tif (c[i] != '?' && c[i] != w % 10 + 48) continue;\n\t\t\t\t\t\tdp[i + 1][w] += dp[i][l];\n\t\t\t\t\t\tdp[i + 1][w] %= mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ret = 0;\n\t\tfor (int i = 1; i <= 9; i++) ret += dp[n][i], ret %= mod;\n\t\tcout << ret << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tstring s, t, u;\n\twhile (cin >> s, s != \"0\") {\n\t\tcin >> t >> u;\n\t\tlong long int dp[51][10][10][10][2] = {};\n\t\tdp[0][0][0][0][0] = 1;\n\t\treverse(s.begin(), s.end());\n\t\treverse(t.begin(), t.end());\n\t\treverse(u.begin(), u.end());\n\t\tfor (int i = 0; i < s.size(); i++) {\n\t\t\tfor (int j = 0; j < 10; j++) {\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tfor (int l = 0; l < 10; l++) {\n\t\t\t\t\t\tfor (int m = 0; m < 2; m++) {\n\t\t\t\t\t\t\tfor (int a = 0; a < 10; a++) {\n\t\t\t\t\t\t\t\tif (i + 1 == s.size() && a == 0)continue;\n\t\t\t\t\t\t\t\tif (s[i] != a + '0'&&s[i] != '?')continue;\n\t\t\t\t\t\t\t\tfor (int b = 0; b < 10; b++) {\n\t\t\t\t\t\t\t\t\tif (i + 1 == s.size() && b == 0)continue;\n\t\t\t\t\t\t\t\t\tif (t[i] != b + '0'&&t[i] != '?')continue;\n\t\t\t\t\t\t\t\t\tint c = (a + b + m) % 10;\n\t\t\t\t\t\t\t\t\tint d = (a + b + m) / 10;\n\t\t\t\t\t\t\t\t\tif (u[i] != c + '0'&&u[i] != '?')continue;\n\t\t\t\t\t\t\t\t\tdp[i + 1][a][b][c][d] += dp[i][j][k][l][m];\n\t\t\t\t\t\t\t\t\tdp[i + 1][a][b][c][d] %= MOD;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlong long int ans = 0;\n\t\tfor (int i = 0; i < 10; i++) {\n\t\t\tfor (int j = 0; j < 10; j++) {\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tans += dp[s.size()][i][j][k][0];\n\t\t\t\t\tans %= MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MOD = 1e9 + 7;\n\nint n;\nint a[64], b[64], c[64];\nint dp[64][2];\n\nvoid conv(string &s, int a[])\n{\n\tfor (int i = 0; i < n; i++){\n\t\tif (s[i] == '?') a[i] = -1;\n\t\telse a[i] = s[i] - '0';\n\t}\n}\n\nint calc(int d, int m)\n{\n\tif (d == n) return !m;\n\tif (~dp[d][m]) return dp[d][m];\n\t\n\tint res = 0;\n\t\n\tfor (int i = !d; i <= 9; i++){\n\t\tfor (int j = !d; j <= 9; j++){\n\t\t\tfor (int k = !d; k <= 9; k++){\n\t\t\t\tif ((~a[d]) && a[d] != i) continue;\n\t\t\t\tif ((~b[d]) && b[d] != j) continue;\n\t\t\t\tif ((~c[d]) && c[d] != k) continue;\n\t\t\t\tint kk = m * 10 + k;\n\t\t\t\tif (i + j != kk && i + j + 1 != kk) continue;\n\t\t\t\tint nm = kk - i - j;\n\t\t\t\tres = (res + calc(d + 1, nm)) % MOD;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn dp[d][m] = res;\n}\n\nint main()\n{\n\tstring sa, sb, sc;\n\twhile (cin >> sa >> sb >> sc){\n\t\tn = sa.size();\n\t\tconv(sa, a);\n\t\tconv(sb, b);\n\t\tconv(sc, c);\n\t\t\n\t\tmemset(dp, -1, sizeof(dp));\n\t\tprintf(\"%d\\n\", calc(0, 0));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n    string A,B,C;\n    while(cin>>A,A[0]!='0'){\n        cin>>B>>C;\n        int len=A.size();\n        int dp[len+1][2];\n        fill(dp[0],dp[len+1],0);\n        dp[0][0]=1;\n        for(int i=1;i<=len;i++){\n            int a,b,c;\n            a=(A[len-i]=='?'?-1:A[len-i]-'0');\n            b=(B[len-i]=='?'?-1:B[len-i]-'0');\n            c=(C[len-i]=='?'?-1:C[len-i]-'0');\n            for(int ai=0;ai<10;ai++){\n                if(a!=-1&&ai!=a) continue;\n                if(i==len&&ai==0) continue;\n                for(int bi=0;bi<10;bi++){\n                    if(b!=-1&&bi!=b) continue;\n                    if(i==len&&bi==0) continue;\n                    int ci=ai+bi;\n                    if(c==-1){\n                        if(ci<10){\n                            dp[i][0]+=dp[i-1][0];\n                            dp[i][0]%=1000000007;\n                        }else{\n                            dp[i][1]+=dp[i-1][0];\n                            dp[i][1]%=1000000007;\n                        }\n                    }else{\n                        if(ci<10&&c==ci){\n                            dp[i][0]+=dp[i-1][0];\n                            dp[i][0]%=1000000007;\n                        }else if(ci>=10&&c==ci-10){\n                            dp[i][1]+=dp[i-1][0];\n                            dp[i][1]%=1000000007;\n                        }\n                    }\n                    ci++;\n                    if(c==-1){\n                        if(ci<10){\n                            dp[i][0]+=dp[i-1][1];\n                            dp[i][0]%=1000000007;\n                        }else{\n                            dp[i][1]+=dp[i-1][1];\n                            dp[i][1]%=1000000007;\n                        }\n                    }else{\n                        if(ci<10&&c==ci){\n                            dp[i][0]+=dp[i-1][1];\n                            dp[i][0]%=1000000007;\n                        }else if(ci>=10&&c==ci-10){\n                            dp[i][1]+=dp[i-1][1];\n                            dp[i][1]%=1000000007;\n                        }\n                    }\n                }\n            }\n            // cout<<dp[i][0]<<' '<<dp[i][1]<<endl;\n        }\n        cout<<dp[len][0]<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1){\n    string a,b,c;\n    cin>>a;\n    if(a==\"0\")break;\n    cin>>b>>c;\n    reverse(begin(a),end(a));\n    reverse(begin(b),end(b));\n    reverse(begin(c),end(c));\n    int n=a.size();\n    vector<vector<int>> dp(n+1,vector<int>(2,0));\n    dp[0][0] = 1;\n    REP(i,n) {\n      int m[10][10];\n      REP(j,10)REP(k,10)m[j][k]=1;\n      if(i==n-1)\n        REP(j,10)\n          m[0][j]=m[j][0]=0;\n      if(a[i] != '?'){\n        int ai= a[i]-'0';\n        REP(j,10)REP(k,10) {\n          if(j==ai)continue;\n          m[j][k]=0;\n        }\n      }\n      if(b[i] != '?'){\n        int bi= b[i]-'0';\n        REP(j,10)REP(k,10) {\n          if(j==bi)continue;\n          m[k][j]=0;\n        }\n      }\n      vector<int> cv;\n      if(c[i]!='?') {\n        cv.push_back(c[i]-'0');\n      } else {\n        REP(j,10) cv.push_back(j);\n      }\n      for(int ci:cv){\n        REP(j,10)REP(k,10){\n          if(m[j][k]){\n            if (j+k==ci) dp[i+1][0] += dp[i][0];\n            dp[i+1][0] %= 1000000007;\n            if (j+k+1==ci) dp[i+1][0] += dp[i][1];\n            dp[i+1][0] %= 1000000007;\n            if (j+k==ci+10) dp[i+1][1] += dp[i][0];\n            dp[i+1][1] %= 1000000007;\n            if (j+k+1==ci+10) dp[i+1][1] += dp[i][1];\n            dp[i+1][1] %= 1000000007;\n          }\n        }\n      }\n    }\n    cout<<dp[n][0]<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\n#define MOD 1000000007\n\nint main(){\n  string a,b,c;\n  while(1){\n    cin >> a;\n    if(a==\"0\") return 0;\n    cin >> b >> c;\n    LL dp[50][10][10][10][2];\n    LL total[2];\n    for(int i=0;i<a.length();i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n          }\n        }\n      }\n    }\n    for(int i=0;i<10;i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n            &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n            &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n              if((i+j)%10==k){\n                dp[a.length()-1][i][j][k][(i+j)/10]=1;\n              }\n          }\n        }\n      }\n    }\n    total[0]=total[1]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n          total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n        }\n      }\n    }\n    if(a.length()==1){\n      cout << total[0] << endl;\n      continue;\n    }\n    for(int i=a.length()-2;i>0;i--){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            if((a[i]=='?'||a[i]=='0'+j)\n              &&(b[i]=='?'||b[i]=='0'+k)\n              &&(c[i]=='?'||c[i]=='0'+l)\n            ){\n              for(int m=0;m<2;m++){\n                if((j+k+m)%10==l){\n                  dp[i][j][k][l][(j+k+m)/10]=total[m];\n                  //printf(\"(%d %d %d %d %d) %d\\n\",i,j,k,l,m,dp[i][j][k][l][(j+k+m)/10]);\n                }\n              }\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[i][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[i][j][k][l][1])%MOD;\n          }\n        }\n      }\n    }\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          if((a[0]=='?'||a[0]=='0'+j)\n            &&(b[0]=='?'||b[0]=='0'+k)\n            &&(c[0]=='?'||c[0]=='0'+l)\n          ){\n            for(int m=0;m<2;m++){\n              if((j+k+m)%10==l){\n                dp[0][j][k][l][(j+k+m)/10]=total[m];\n              }\n            }\n          }\n        }\n      }\n    }\n    total[0]=0;\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          total[0]=(total[0]+dp[0][j][k][l][0])%MOD;\n        }\n      }\n    }\n    cout << total[0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\nusing namespace std;\n#define mod 1000000007\nstring A, B, C; long long dp[70][3];\nint main() {\n\twhile (true) {\n\t\tcin >> A; if (A == \"0\")break;\n\t\tcin >> B >> C;\n\t\tfor (int i = 0; i < 210; i++)dp[i / 3][i % 3] = 0;\n\t\treverse(A.begin(), A.end()); int A1 = A.size();\n\t\treverse(B.begin(), B.end()); int B1 = B.size();\n\t\treverse(C.begin(), C.end()); int C1 = C.size();\n\t\twhile (A.size() < 60)A = A + '0';\n\t\twhile (B.size() < 60)B = B + '0';\n\t\twhile (C.size() < 60)C = C + '0';\n\t\tdp[0][0] = 1;\n\t\tfor (int i = 0; i < 60; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tint a = 0, b = 0, c = 0;\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tfor (int l = 0; l < 10; l++) {\n\t\t\t\t\t\tint m = j + k + l;\n\t\t\t\t\t\tif ((k != (int)(A[i] - '0') && A[i] != '?') || (i == A1 - 1 && k == 0))continue;\n\t\t\t\t\t\tif ((l != (int)(B[i] - '0') && B[i] != '?') || (i == B1 - 1 && l == 0))continue;\n\t\t\t\t\t\tif ((m % 10 != (int)(C[i] - '0') && C[i] != '?') || (i == C1 - 1 && m % 10 == 0))continue;\n\t\t\t\t\t\tif (m >= 0 && m < 10)a++;\n\t\t\t\t\t\tif (m >= 10 && m < 20)b++;\n\t\t\t\t\t\tif (m >= 20 && m < 30)c++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i + 1][0] += dp[i][j] * a; dp[i + 1][0] %= mod;\n\t\t\t\tdp[i + 1][1] += dp[i][j] * b; dp[i + 1][1] %= mod;\n\t\t\t\tdp[i + 1][2] += dp[i][j] * c; dp[i + 1][2] %= mod;\n\t\t\t}\n\t\t}\n\t\tcout << (dp[60][0] + dp[60][1] + dp[60][2]) % mod << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nbool in_range(int a, int b){\n  return a >= 0 && a < b;\n}\n\nint main(){\n  string A;\n  while(cin >> A, A != \"0\"){\n    string B, C;\n    cin >> B >> C;\n    int n = A.length(), mod = 1e9 + 7;\n    vector< vector<long long int> > dp(n, vector<long long int>(2,0));\n    for(int i = n-1; i >= 0; --i){\n      if(C[i] != '?'){\n        int c = C[i] - '0';\n        if(A[i] != '?' && B[i] != '?'){\n          int a = A[i] - '0', b = B[i] - '0';\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(a + b == c){\n            if(i < n-1) dp[i][0] = dp[i+1][0];\n            else dp[i][0] = 1;\n          }else if(i < n-1 && a + b + 1 == c){\n            dp[i][0] = dp[i+1][1];\n          }else if(a + b == 10 + c){\n            if(i < n-1) dp[i][1] = dp[i+1][0];\n            else dp[i][1] = 1;\n          }else if(i < n-1 && a + b + 1 == 10 + c){\n            dp[i][1] = dp[i+1][1];\n          }else{\n            break;\n          }\n        }else if(A[i] != '?'){//B[i] == '?'\n          int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(b,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              dp[i][0] += 1;\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(b_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(B[i] != '?'){//A[i] == '?'\n          int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(a,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(a_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else{//A[i] == B[i] == '?'\n          for(int a = 0; a < 10; ++a){\n            for(int b = 0; b < 10; ++b){\n              if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n              if(a + b == c){\n                if(i < n-1){\n                  dp[i][0] += dp[i+1][0];\n                  dp[i][0] %= mod;\n                }else{\n                  ++dp[i][0];\n                  dp[i][0] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c){\n                dp[i][0] += dp[i+1][1];\n                dp[i][0] %= mod;\n              }\n              if(a + b == c + 10){\n                if(i < n-1){\n                  dp[i][1] += dp[i+1][0];\n                  dp[i][1] %= mod;\n                }else{\n                  ++dp[i][1];\n                  dp[i][1] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c + 10){\n                dp[i][1] += dp[i+1][1];\n                dp[i][1] %= mod;\n              }\n            }\n          }\n        }\n      }else{//C[i] == '?'\n        for(int c = 0; c < 10; ++c){\n          if(n > 1 && i == 0 && c == 0) continue;\n          if(A[i] != '?' && B[i] != '?'){\n            int a = A[i] - '0', b = B[i] - '0';\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(a + b == c){\n              if(i < n-1) dp[i][0] = dp[i+1][0];\n              else dp[i][0] = 1;\n            }else if(i < n-1 && a + b + 1 == c){\n              dp[i][0] = dp[i+1][1];\n            }else if(a + b == 10 + c){\n              if(i < n-1) dp[i][1] = dp[i+1][0];\n              else dp[i][1] = 1;\n            }else if(i < n-1 && a + b + 1 == 10 + c){\n              dp[i][1] = dp[i+1][1];\n            }else{\n              break;\n            }\n          }else if(A[i] != '?'){//B[i] == '?'\n            int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(b,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                dp[i][0] += 1;\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(b_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(B[i] != '?'){//A[i] == '?'\n            int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(a,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(a_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else{//A[i] == B[i] == '?'\n            for(int a = 0; a < 10; ++a){\n              for(int b = 0; b < 10; ++b){\n                if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n                if(a + b == c){\n                  if(i < n-1){\n                    dp[i][0] += dp[i+1][0];\n                    dp[i][0] %= mod;\n                  }else{\n                    ++dp[i][0];\n                    dp[i][0] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c){\n                  dp[i][0] += dp[i+1][1];\n                  dp[i][0] %= mod;\n                }\n                if(a + b == c + 10){\n                  if(i < n-1){\n                    dp[i][1] += dp[i+1][0];\n                    dp[i][1] %= mod;\n                  }else{\n                    ++dp[i][1];\n                    dp[i][1] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c + 10){\n                  dp[i][1] += dp[i+1][1];\n                  dp[i][1] %= mod;\n                }\n              }\n            }\n          } \n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstring a[3];\nint n,mod=1e9+7;\nint dp[100][3][20];\n\nint change(char ch){\n  return ch-'0';\n}\n\nvoid add(int &a,int b){\n  a=(a+b)%mod;\n}\n\nvoid init(){\n  for(int i=0;i<100;i++){\n    for(int j=0;j<3;j++){\n      for(int k=0;k<20;k++){\n        dp[i][j][k]=-1;\n      }\n    }\n  }\n}\n\nint rec(int x,int y,int z){\n  if(x==-1)return 1;\n  if(dp[x][y][z]!=-1)return dp[x][y][z];\n\n  if(y==2){\n    if(a[2][x]=='?'){\n      if(x==0&&z>=10)return 0;\n      else return rec(x-1,0,z/10);\n    }else{\n      if(change(a[2][x])!=z%10)return 0;\n      else return rec(x-1,0,z/10);\n    }\n  }\n  \n  int res=0;\n  if(a[y][x]!='?'){\n    return rec(x,y+1,z+change(a[y][x]));\n  }else{\n    for(int i=0;i<10;i++){\n      if(i==0&&x==0)continue;\n      add(res,rec(x,y+1,z+i));\n    }\n  }\n  return dp[x][y][z]=res;\n}\n\nint main(){\n  while(1){\n    cin>>a[0];\n    if(a[0]==\"0\")break;\n    cin>>a[1]>>a[2];\n    n=a[0].size();\n    init();\n    cout<<rec(n-1,0,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long ll;\nconst ll mod=(1e9)+7;\nstring A,B,C;\n\nll mem[100][10],used[100][10];\nll dfs(int idx,int pre){\n  if(idx==-1) return pre==0;\n  if(used[idx][pre]++)return mem[idx][pre];\n  \n  ll res=0,u[10][10][10]={},f=idx==0;\n  for(int i=f;i<10;i++)\n    for(int j=f;j<10;j++)\n      for(int k=f;k<10;k++){\n\tint a=A[idx]=='?'? i:A[idx]-'0';\n\tint b=B[idx]=='?'? j:B[idx]-'0';\n\tint c=C[idx]=='?'? k:C[idx]-'0';\n\tif(u[a][b][c]++||(a+b+pre)%10!=c) continue;\n\tres=(res+dfs(idx-1,(a+b+pre)/10))%mod;\n      }\n  return mem[idx][pre] = res;\n}\n\nint main(){\n  while(1){\n    cin>>A;\n    if(A==\"0\")break;\n    cin>>B>>C;\n    memset(used,0,sizeof(used));\n    cout <<dfs(A.size()-1,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nconst ll mod=1000000007;\nll dp[51][2];\n\nint main(void){\n\tstring a,b,c;\n\twhile(cin >> a){\n\t\tif(a==\"0\")\n\t\t\tbreak;\n\t\tcin >> b  >> c;\n\t\trep(i,50)rep(j,2) dp[i][j]=0;\n\t\tint n=a.size();\n\t\tdp[n][0]=1LL;\n\t\tfor(int i=n-1;i>=0;--i)rep(j,2){\n\t\t\tll cur[2]={0,0};\n\t\t\tint start=(i==0);\n\t\t\tif(a[i]=='?'&&b[i]=='?'){\n\t\t\t\trange(aa,start,10)range(bb,start,10){\n\t\t\t\t\tint sum=j+aa+bb;\n\t\t\t\t\tif(c[i]=='?'||(sum%10==(c[i]-'0')))\n\t\t\t\t\t\tcur[sum>=10]++;\n\t\t\t\t}\n\t\t\t}else if(a[i]=='?'){\n\t\t\t\trange(aa,start,10){\n\t\t\t\t\tint bb=b[i]-'0';\n\t\t\t\t\tint sum=j+aa+bb;\n\t\t\t\t\tif(c[i]=='?'||(sum%10==(c[i]-'0')))\n\t\t\t\t\t\tcur[sum>=10]++;\n\t\t\t\t}\n\t\t\t}else if(b[i]=='?'){\n\t\t\t\trange(bb,start,10){\n\t\t\t\t\tint aa=a[i]-'0';\n\t\t\t\t\tint sum=j+aa+bb;\n\t\t\t\t\tif(c[i]=='?'||(sum%10==(c[i]-'0')))\n\t\t\t\t\t\tcur[sum>=10]++;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tint aa=a[i]-'0';\n\t\t\t\tint bb=b[i]-'0';\n\t\t\t\tint sum=j+aa+bb;\n\t\t\t\tif(c[i]=='?'||(sum%10==(c[i]-'0')))\n\t\t\t\t\tcur[sum>=10]++;\n\t\t\t}\n\n\t\t\trep(k,2) dp[i][k]=(dp[i][k]+dp[i+1][j]*cur[k])%mod;\n\t\t}\n\t\tcout << dp[0][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\nusing namespace std;\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return true; } return false; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return true; } return false; }\n\nconst int D = 1000000007;\n\n// input\nstring A, B, C;\n\nint main() {\n    while (true) {\n\n        // input\n        cin >> A ;\n        if (A == \"0\") break;\n        cin >> B >> C;\n\n        // reverse A, B, C\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        int N = A.size();\n\n        // DP table\n        vector<vector<int>> dp(N+1, vector<int>(2, 0));\n\n        // initial condition\n        dp[0][0] = 1;\n\n        // DP loop\n        for (int i = 0; i < N; i++) {\n            for (int ai = 0; ai <= 9; ai++) {\n                for (int bi = 0; bi <= 9; bi++) {\n                    for (int ci = 0; ci <= 9; ci++) {\n                        if (A[i] != '?' && A[i] != ai + '0') continue;\n                        if (B[i] != '?' && B[i] != bi + '0') continue;\n                        if (C[i] != '?' && C[i] != ci + '0') continue;\n\n                        if (i == N - 1 && ai * bi * ci == 0) continue;\n\n                        if (ai + bi     == ci     ) dp[i + 1][0] += dp[i][0];\n                        if (ai + bi + 1 == ci     ) dp[i + 1][0] += dp[i][1];\n                        if (ai + bi     == ci + 10) dp[i + 1][1] += dp[i][0];\n                        if (ai + bi + 1 == ci + 10) dp[i + 1][1] += dp[i][1];\n\n                        dp[i + 1][0] %= D;\n                        dp[i + 1][1] %= D;\n                    }\n                }\n            }\n        }\n\n        // output answer\n        cout << dp[N][0] << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdlib>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\n#define REP(i, a, b) for(int i = a; i < (int)(b); ++i)\n#define rep(i, n) REP(i, 0, n)\n\nconstexpr int mod = 1000000007;\n\ninline bool valid(char c, int x) {\n\treturn c == '?' || c - '0' == x;\n}\n\nint main() {\n\tfor(string A, B, C; cin >> A && A != \"0\";) {\n\t\tcin >> B >> C;\n\n\t\tconst int n = A.size();\n\t\tvector<int> dp(2, 0);\n\t\tdp[0] = 1;\n\n\t\tfor(int i = n - 1; i >= 0; --i) {\n\t\t\tvector<int> next(2, 0);\n\n\t\t\tREP(a, i == 0, 10) {\n\t\t\t\tif(!valid(A[i], a)) continue;\n\n\t\t\t\tREP(b, i == 0, 10) {\n\t\t\t\t\tif(!valid(B[i], b)) continue;\n\n\t\t\t\t\trep(carry, 2) {\n\t\t\t\t\t\tconst int sum = a + b + carry;\n\t\t\t\t\t\tif(!valid(C[i], sum % 10)) continue;\n\t\t\t\t\t\t(next[sum / 10] += dp[carry]) %= mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdp = move(next);\n\t\t}\n\n\t\tcout << dp[0] << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll MOD = 1000000007;\nint main(){\n  string a,b,c;\n  while(cin >> a,a!=\"0\"){\n    cin >> b >> c;\n    ll n=a.size()-1;\n    ll i,j,k;\n    ll ans[81][2]={{}};\n    ans[n+1][0]=1;\n    for(i=n;i>0;i--){\n      if(a[i]!='?'){\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(a[i]+b[i]-'0'==c[i]) ans[i][0]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]-1) ans[i][0]=ans[i+1][1];\n\t    if(a[i]+b[i]-'0'==c[i]+10) ans[i][1]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]+10-1) ans[i][1]=ans[i+1][1];\n\t  }else{\n\t    if(a[i]-'0'+b[i]-'0'<10) ans[i][0]+=ans[i+1][0];\n\t    else ans[i][1]+=ans[i+1][0];\n\t    if(a[i]-'0'+b[i]-'0'+1<10) ans[i][0]+=ans[i+1][1];\n\t    else ans[i][1]+=ans[i+1][1];\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    if(a[i]==c[i]){\n\t      ans[i][0]+=ans[i+1][0];\n\t      ans[i][1]+=ans[i+1][1];\n\t    }else if(a[i]<c[i]){\n\t      ans[i][0]+=ans[i+1][0]+ans[i+1][1];\n\t    }else{\n\t      ans[i][1]+=ans[i+1][0]+ans[i+1][1];\n\t    }\n\t  }else{\n\t    k=a[i]-'0';\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+1));\n\t    ans[i][1]+=ans[i+1][1]*(k+1);\n\t    ans[i][0]+=ans[i+1][0]*(10-k);\n\t    ans[i][1]+=ans[i+1][0]*k;\n\t  }\n\t}\n      }else{\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(b[i]==c[i]){\n\t      ans[i][0]+=ans[i+1][0];\n\t      ans[i][1]+=ans[i+1][1];\n\t    }else if(b[i]<c[i]){\n\t      ans[i][0]+=ans[i+1][0]+ans[i+1][1];\n\t    }else{\n\t      ans[i][1]+=ans[i+1][0]+ans[i+1][1];\n\t    }\n\t  }else{\n\t    k=b[i]-'0';\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+1));\n\t    ans[i][1]+=ans[i+1][1]*(k+1);\n\t    ans[i][0]+=ans[i+1][0]*(10-k);\n\t    ans[i][1]+=ans[i+1][0]*k;\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    k=c[i]-'0';\n\t    ans[i][0]+=ans[i+1][0]*(k+1);\n\t    ans[i][1]+=ans[i+1][0]*(10-(k+1));\n\t    ans[i][0]+=ans[i+1][1]*(10-k);\n\t    ans[i][1]+=ans[i+1][1]*k;\n\t  }else{\n\t    ans[i][0]+=ans[i+1][0]*55+ans[i+1][1]*45;\n\t    ans[i][1]+=ans[i+1][0]*45+ans[i+1][1]*55;\n\t  }\n\t}\n      }\n      ans[i][0]%=MOD;\n      ans[i][1]%=MOD;\n      //cout << ans[i][0] << \":\" << ans[i][1] << endl;\n    }\n\n\n    \n    i=0;\n    if(a[i]!='0'&&b[i]!='0'&&c[i]!='0'){\n      if(a[i]!='?'){\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(a[i]+b[i]-'0'==c[i]) ans[i][0]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]-1) ans[i][0]=ans[i+1][1];\n\t  }else{\n\t    if(a[i]-'0'+b[i]-'0'<10) ans[i][0]+=ans[i+1][0];\n\t    if(a[i]-'0'+b[i]-'0'+1<10) ans[i][0]+=ans[i+1][1];\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    if(a[i]<c[i])ans[i][0]+=ans[i+1][0];\n\t    if(a[i]+1<c[i])ans[i][0]+=ans[i+1][1];\n\t  }else{\n\t    k=a[i]-'0';\n\t    ans[i][0]+=ans[i+1][0]*(10-(k+1));\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+2));\n\t  }\n\t}\n      }else{\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(b[i]<c[i])ans[i][0]+=ans[i+1][0];\n\t    if(b[i]+1<c[i])ans[i][0]+=ans[i+1][1];\n\t  }else{\n\t    k=b[i]-'0';\n\t    ans[i][0]+=ans[i+1][0]*(10-(k+1));\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+2));\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    k=c[i]-'0';\n\t    ans[i][0]+=ans[i+1][0]*(10-(k+1));\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+2));\n\t  }else{\n\t    ans[i][0]+=ans[i+1][0]*36+ans[i+1][1]*28;\n\t  }\n\t}\n      }\n    }\n\n    cout << ans[0][0]%MOD << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string.h>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000001\nusing namespace std;\n\nint main(){\n\n\tll dp_nashi[12][12][12];\n\tll dp_ari[12][12][12];\n\n\n\tfor(int i = 0; i <= 11; i++){\n\t\tfor(int k = 0; k <= 11; k++){\n\t\t\tfor(int p = 0; p <= 11; p++){\n\t\t\t\tdp_nashi[i][k][p] = 0;\n\t\t\t\tdp_ari[i][k][p] = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor(int first = 0; first <= 9; first++){\n\t\tfor(int second = 0; second <= 9; second++){\n\t\t\tfor(int third = 0; third <= 9; third++){\n\n\t\t\t\tif(first+second == third){\n\t\t\t\t\tdp_nashi[first][second][third]++;\n\t\t\t\t}else if(first+second == 10+third){\n\t\t\t\t\tdp_ari[first][second][third]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfor(int a = 0; a <= 9; a++){\n\t\tfor(int b = 0; b <= 9; b++){\n\t\t\tfor(int c = 0; c <= 9; c++){\n\n\t\t\t\tdp_nashi[a][b][10] += dp_nashi[a][b][c];\n\t\t\t\tdp_ari[a][b][10] += dp_ari[a][b][c];\n\n\t\t\t\tdp_nashi[a][10][b] += dp_nashi[a][c][b];\n\t\t\t\tdp_ari[a][10][b] += dp_ari[a][c][b];\n\n\t\t\t\tdp_nashi[10][a][b] += dp_nashi[c][a][b];\n\t\t\t\tdp_ari[10][a][b] += dp_ari[c][a][b];\n\n\t\t\t\tdp_nashi[10][10][c] += dp_nashi[a][b][c];\n\t\t\t\tdp_ari[10][10][c] += dp_ari[a][b][c];\n\n\t\t\t\tdp_nashi[10][c][10] += dp_nashi[a][c][b];\n\t\t\t\tdp_ari[10][c][10] += dp_ari[a][c][b];\n\n\t\t\t\tdp_nashi[c][10][10] += dp_nashi[c][a][b];\n\t\t\t\tdp_ari[c][10][10] += dp_ari[c][a][b];\n\n\t\t\t\tdp_nashi[10][10][10] += dp_nashi[a][b][c];\n\t\t\t\tdp_ari[10][10][10] += dp_ari[a][b][c];\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\tfor(int a = 1; a <= 8; a++){\n\t\tfor(int b = 1; b <= 8; b++){\n\t\t\tif(a + b >= 10)continue;\n\t\t\tfor(int c = 2; c <= 9; c++){\n\t\t\t\tif(a+b == c){\n\t\t\t\t\tdp_nashi[11][11][11] += dp_nashi[a][b][c];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfor(int a = 1; a <= 9; a++){\n\t\tfor(int b = 1; b <= 9; b++){\n\t\t\tfor(int c = 0; c <= 9; c++){\n\n\t\t\t\tdp_nashi[11][11][c] += dp_nashi[a][b][c];\n\t\t\t\tdp_ari[11][11][c] += dp_ari[a][b][c];\n\n\t\t\t\tdp_nashi[11][c][11] += dp_nashi[a][c][b];\n\t\t\t\tdp_ari[11][c][11] += dp_ari[a][c][b];\n\n\t\t\t\tdp_nashi[c][11][11] += dp_nashi[c][a][b];\n\t\t\t\tdp_ari[c][11][11] += dp_ari[c][a][b];\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfor(int a = 1; a <= 9; a++){\n\t\tfor(int b = 0; b <= 9; b++){\n\t\t\tfor(int c = 0; c <= 9; c++){\n\n\t\t\t\tdp_nashi[11][b][c] += dp_nashi[a][b][c];\n\t\t\t\tdp_ari[11][b][c] += dp_ari[a][b][c];\n\n\t\t\t\tdp_nashi[b][11][c] += dp_nashi[b][a][c];\n\t\t\t\tdp_ari[b][11][c] += dp_ari[b][a][c];\n\n\t\t\t\tdp_nashi[b][c][11] += dp_nashi[b][c][a];\n\t\t\t\tdp_ari[b][c][11] += dp_ari[b][c][a];\n\t\t\t}\n\t\t}\n\t}\n\n\tchar first[51],second[51],third[51];\n\tll ans;\n\tll first_length,second_length,third_length,limit;\n\n\twhile(true){\n\t\tscanf(\"%s\",first);\n\t\tif(first[0] == '0')break;\n\n\t\tscanf(\"%s\",second);\n\t\tscanf(\"%s\",third);\n\n\t\tfor(first_length = 0; first[first_length] != '\\0';first_length++);\n\t\tfor(second_length = 0;second[second_length] != '\\0';second_length++);\n\t\tfor(third_length = 0;third[third_length] != '\\0';third_length++);\n\n\t\tif(third_length - max(first_length,second_length) > 1 || (third_length-max(first_length,second_length) == 1 && third[0] >= '2' && third[0] <= '9') ||\n\t\t\t\tmax(first_length,second_length) > third_length){\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\tans = 1;\n\n\t\tlimit = third_length-1;\n\n\t\tll first_num,second_num,third_num,nashi_num,ari_num,pre_nashi_num = 1,pre_ari_num = 0;\n\t\tll check_first,check_second,check_third;\n\n\t\tbool isKuriagariOK;\n\n\t\tfor(int digit = 0; digit <= limit; digit++){\n\n\t\t\tif(digit <= first_length-1){\n\t\t\t\tif(first[(first_length-1)-digit] != '?'){\n\t\t\t\t\tfirst_num = first[(first_length-1)-digit]-'0';\n\t\t\t\t}else{\n\t\t\t\t\tif(digit < first_length-1){\n\t\t\t\t\t\tfirst_num = 10;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfirst_num = 11;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tfirst_num = 0;\n\t\t\t}\n\n\t\t\tif(digit <= second_length-1){\n\t\t\t\tif(second[(second_length-1)-digit] != '?'){\n\t\t\t\t\tsecond_num = second[(second_length-1)-digit]-'0';\n\t\t\t\t}else{\n\t\t\t\t\tif(digit < second_length-1){\n\t\t\t\t\t\tsecond_num = 10;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tsecond_num = 11;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tsecond_num = 0;\n\t\t\t}\n\n\t\t\tif(third[(third_length-1)-digit] != '?'){\n\t\t\t\tthird_num = third[(third_length-1)-digit] - '0';\n\t\t\t}else{\n\t\t\t\tif(digit < third_length-1){\n\t\t\t\t\tthird_num = 10;\n\t\t\t\t}else{\n\t\t\t\t\tthird_num = 11;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(digit == third_length-1){\n\t\t\t\tisKuriagariOK = false;\n\t\t\t}else{\n\t\t\t\tisKuriagariOK = true;\n\t\t\t}\n\t\t\tfor(int tmp = digit+1; tmp <= (third_length-1);tmp++){\n\n\t\t\t\tif(tmp <= first_length-1){\n\t\t\t\t\tif(first[(first_length-1)-tmp] != '?'){\n\t\t\t\t\t\tcheck_first = first[(first_length-1)-tmp]-'0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp < first_length-1){\n\t\t\t\t\t\t\tcheck_first = 10;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcheck_first = 11;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tcheck_first = 0;\n\t\t\t\t}\n\n\t\t\t\tif(tmp <= second_length-1){\n\t\t\t\t\tif(second[(second_length-1)-tmp] != '?'){\n\t\t\t\t\t\tcheck_second = second[(second_length-1)-tmp]-'0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp < second_length-1){\n\t\t\t\t\t\t\tcheck_second = 10;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcheck_second = 11;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tcheck_second = 0;\n\t\t\t\t}\n\n\t\t\t\tif(tmp <= third_length-1){\n\t\t\t\t\tif(third[(third_length-1)-tmp] != '?'){\n\t\t\t\t\t\tcheck_third = third[(third_length-1)-tmp]-'0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp < third_length-1){\n\t\t\t\t\t\t\tcheck_third = 10;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcheck_third = 11;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tcheck_third = 0;\n\t\t\t\t}\n\n\t\t\t\tif(check_first >= 10 && check_second >= 10 && check_third >= 10){\n\t\t\t\t\tbreak;\n\t\t\t\t}else if(check_first >= 10 && check_second >= 10 && check_third <= 9){ //??X\n\n\t\t\t\t\tif(third != 0){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else if(check_first >= 10 && check_second <= 9 && check_third >= 10){ //?X?\n\n\t\t\t\t\tif(check_second != 9){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else if(check_first <= 9 && check_second >= 10 && check_third >= 10){ //X??\n\n\t\t\t\t\tif(check_first != 9){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else if(check_first >= 10 && check_second <= 9 && check_third <= 9){ //?XX\n\n\t\t\t\t\tif(check_second+1 <= check_third){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else if(check_first <= 9 && check_second >= 10 && check_third <= 9){ //X?X\n\t\t\t\t\tif(check_first+1 <= check_third){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t}else if(check_first <= 9 && check_second <= 9 && check_third >= 10){ //XX?\n\n\t\t\t\t\tif(check_first+check_second+1 <= 9){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else{ //first <= 9 && second <= 9 && third <= 9\n\t\t\t\t\tif(check_first+check_second+1 <= check_third){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmp == third_length-1){\n\t\t\t\t\t\t\tisKuriagariOK = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tari_num = 0;\n\t\t\tnashi_num = 0;\n\n\t\t\tif(pre_nashi_num == 0){\n\t\t\t\tif(first_num <= 8){\n\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[first_num+1][second_num][third_num]%MOD;\n\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t}else if(first_num == 9){\n\t\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t}else if(first_num == 10){ //first >= 10\n\n\t\t\t\t\tfor(ll a = 1; a <= 9; a++){\n\t\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[a][second_num][third_num]%MOD;\n\t\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t}else{ //first == 11\n\n\t\t\t\t\tfor(ll a = 2; a <= 9; a++){\n\t\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[a][second_num][third_num]%MOD;\n\t\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\tif(first_num <= 8){\n\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[first_num+1][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}else if(first_num == 9){\n\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}else if(first_num == 10){ //first >= 10\n\n\t\t\t\t\t\tfor(ll a = 1; a <= 9; a++){\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfor(int a = 2; a <= 9; a++){\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t}else{ //pre_nashi_num > 0\n\t\t\t\tnashi_num += pre_nashi_num*dp_nashi[first_num][second_num][third_num]%MOD;\n\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\tif(pre_ari_num > 0){\n\t\t\t\t\tif(first_num <= 8){\n\t\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[first_num+1][second_num][third_num]%MOD;\n\t\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t\t}else if(first_num == 9){\n\t\t\t\t\t\tif(isKuriagariOK){\n\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}else if(first_num == 10){ // first >= 10\n\n\t\t\t\t\t\tfor(ll a = 1; a <= 9; a++){\n\t\t\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isKuriagariOK){\n\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //first_num == 11\n\n\t\t\t\t\t\tfor(ll a = 2; a <= 9; a++){\n\t\t\t\t\t\t\tnashi_num += pre_ari_num*dp_nashi[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tnashi_num = (nashi_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_nashi[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(isKuriagariOK){\n\t\t\t\t\tari_num += pre_nashi_num*dp_ari[first_num][second_num][third_num]%MOD;\n\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\tif(pre_ari_num > 0){\n\t\t\t\t\t\tif(first_num <= 8){\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[first_num+1][second_num][third_num]%MOD;\n\t\t\t\t\t\t}else if(first_num == 9){\n\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}else if(first_num == 10){ // first >= 10\n\n\t\t\t\t\t\t\tfor(ll a = 1; a <= 9; a++){\n\t\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tfor(ll a = 2; a <= 9; a++){\n\t\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[a][second_num][third_num]%MOD;\n\t\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tari_num += pre_ari_num*dp_ari[0][second_num][third_num]%MOD;\n\t\t\t\t\t\t\tari_num = (ari_num+MOD)%MOD;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(nashi_num == 0 && ari_num == 0){\n\t\t\t\tans = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tans = (nashi_num+ari_num)%MOD;\n\n\t\t\tpre_nashi_num = nashi_num%MOD;\n\t\t\tpre_ari_num = ari_num%MOD;\n\t\t}\n\n\n\t\tprintf(\"%lld\\n\",ans%MOD);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nbool in_range(int a, int b){\n  return a >= 0 && a < b;\n}\n\nint main(){\n  string A;\n  while(cin >> A, A != \"0\"){\n    string B, C;\n    cin >> B >> C;\n    int n = A.length(), mod = 1e9 + 7;\n    vector< vector<long long int> > dp(n, vector<long long int>(2,0));\n    for(int i = n-1; i >= 0; --i){\n      if(C[i] != '?'){\n        int c = C[i] - '0';\n        if(A[i] != '?' && B[i] != '?'){\n          int a = A[i] - '0', b = B[i] - '0';\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(a + b == c){\n            if(i < n-1) dp[i][0] = dp[i+1][0];\n            else dp[i][0] = 1;\n          }else if(i < n-1 && a + b + 1 == c){\n            dp[i][0] = dp[i+1][1];\n          }else if(a + b == 10 + c){\n            if(i < n-1) dp[i][1] = dp[i+1][0];\n            else dp[i][1] = 1;\n          }else if(i < n-1 && a + b + 1 == 10 + c){\n            dp[i][1] = dp[i+1][1];\n          }else{\n            break;\n          }\n        }else if(A[i] != '?'){//B[i] == '?'\n          int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(b,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              dp[i][0] += 1;\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(b_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(B[i] != '?'){//A[i] == '?'\n          int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(a,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(a_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else{//A[i] == B[i] == '?'\n          for(int a = 0; a < 10; ++a){\n            for(int b = 0; b < 10; ++b){\n              if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n              if(a + b == c){\n                if(i < n-1){\n                  dp[i][0] += dp[i+1][0];\n                  dp[i][0] %= mod;\n                }else{\n                  ++dp[i][0];\n                  dp[i][0] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c){\n                dp[i][0] += dp[i+1][1];\n                dp[i][0] %= mod;\n              }\n              if(a + b == c + 10){\n                if(i < n-1){\n                  dp[i][1] += dp[i+1][0];\n                  dp[i][1] %= mod;\n                }else{\n                  ++dp[i][1];\n                  dp[i][1] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c + 10){\n                dp[i][1] += dp[i+1][1];\n                dp[i][1] %= mod;\n              }\n            }\n          }\n        }\n      }else{//C[i] == '?'\n        for(int c = 0; c < 10; ++c){\n          if(A[i] != '?' && B[i] != '?'){\n            int a = A[i] - '0', b = B[i] - '0';\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(a + b == c){\n              if(i < n-1) dp[i][0] = dp[i+1][0];\n              else dp[i][0] = 1;\n            }else if(i < n-1 && a + b + 1 == c){\n              dp[i][0] = dp[i+1][1];\n            }else if(a + b == 10 + c){\n              if(i < n-1) dp[i][1] = dp[i+1][0];\n              else dp[i][1] = 1;\n            }else if(i < n-1 && a + b + 1 == 10 + c){\n              dp[i][1] = dp[i+1][1];\n            }else{\n              break;\n            }\n          }else if(A[i] != '?'){//B[i] == '?'\n            int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(b,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                dp[i][0] += 1;\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(b_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(B[i] != '?'){//A[i] == '?'\n            int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(a,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(a_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else{//A[i] == B[i] == '?'\n            for(int a = 0; a < 10; ++a){\n              for(int b = 0; b < 10; ++b){\n                if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n                if(a + b == c){\n                  if(i < n-1){\n                    dp[i][0] += dp[i+1][0];\n                    dp[i][0] %= mod;\n                  }else{\n                    ++dp[i][0];\n                    dp[i][0] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c){\n                  dp[i][0] += dp[i+1][1];\n                  dp[i][0] %= mod;\n                }\n                if(a + b == c + 10){\n                  if(i < n-1){\n                    dp[i][1] += dp[i+1][0];\n                    dp[i][1] %= mod;\n                  }else{\n                    ++dp[i][1];\n                    dp[i][1] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c + 10){\n                  dp[i][1] += dp[i+1][1];\n                  dp[i][1] %= mod;\n                }\n              }\n            }\n          } \n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144 * 4LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n\n#define int ll\n\nvoid solve(){\n\twhile (true) {\n\t\tstring a;\n\t\tcin >> a;\n\t\tif (a == \"0\") return;\n\t\tstring b, c;\n\t\tcin >> b >> c;\n\t\tint dp[2] = {1,0};\n\t\tfor (int i = b.length() - 1; i >= 0; --i) {\n\t\t\tint new_dp[2] = {};\n\t\t\tREP(q, 2) {\n\t\t\t\tREP(j, 10) {\n\t\t\t\t\tif (a[i] != '?' && a[i] - '0' != j) continue;\n\t\t\t\t\tif (i == 0 && j == 0) continue;\n\t\t\t\t\tREP(t, 10) {\n\t\t\t\t\t\tif (b[i] != '?' && b[i] - '0' != t) continue;\n\t\t\t\t\t\tif (i == 0 && t == 0) continue;\n\t\t\t\t\t\tint hoge = j + t + q;\n\t\t\t\t\t\tif (c[i] == '?' || c[i] - '0' == hoge % 10) {\n\t\t\t\t\t\t\tnew_dp[hoge / 10] += dp[q];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst int mod = 1000000007;\n\t\t\tREP(q, 2) {\n\t\t\t\tdp[q] = new_dp[q] % mod;\n\t\t\t}\n\t\t}\n\t\tcout << dp[0] << endl;\n\t}\n}\n\n#undef int\n\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nconst int mod = 1e9 + 7;\n\nstring A, B, C;\nint dp[55][2];\n\nint solve(int digit, int carry)\n{\n  if(digit == A.size()) return !carry;\n  int &ret = dp[digit][carry];\n  if(~ret) return ret;\n  ret = 0;\n  rep(i, 10) {\n    if(digit == A.size()-1 && i == 0) continue;\n    if(A[digit]-'0' != i && A[digit] != '?') continue;\n    rep(j, 10) {\n      if(digit == B.size()-1 && j == 0) continue;\n      if(B[digit]-'0' != j && B[digit] != '?') continue;\n      if(digit == C.size()-1 && (i + j + carry) % 10 == 0) continue;\n      if((i + j + carry) % 10 != C[digit]-'0' && C[digit] != '?') continue;\n      ret = (ret + solve(digit+1, (i + j + carry) / 10)) % mod;\n    }\n  }\n  return ret;\n}\n\nint main()\n{\n  while(cin >> A, A != \"0\") {\n    cin >> B >> C;\n    reverse(all(A));\n    reverse(all(B));\n    reverse(all(C));\n    memset(dp, -1, sizeof(dp));\n    cout << solve(0, 0) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nll solve1() {\n    if (A[0] == '?' && B[0] == '?') {\n        int cnt = 0;\n        if (C[0] == '?') {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j < 10) ++cnt;\n                }\n            }\n        } else {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j == C[0] - '0') ++cnt;\n                }\n            }\n        }\n        return cnt;\n    }\n    else if(A[0] == '?' || B[0] == '?') {\n        if (A[0] == '?') swap(A[0], B[0]);\n        if (C[0] == '?') {\n            int d = C[0] - A[0];\n            if (d <= 0) return 0;\n            else return 9 - (A[0] - '0');\n        } else {\n            if (C[0] - '0' - A[0] - '0' > 0) {\n                return 1;\n            } else {\n                return 0;\n            }\n        }\n    }\n    else {\n        if (C[0] == '?') {\n            int x = A[0] - '0' + B[0] - '0';\n            return 0 < x && x < 10;\n        } else {\n            return A[0] - '0' + B[0] - '0' == C[0] - '0';\n        }\n    }\n}\n\nint main() {\n    while (cin >> A, A != \"0\") {\n        cin >> B >> C;\n\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        int n = B.size();\n        /*\n        if (n == 1) {\n            cout << solve1() << endl;\n            continue;\n        } */\n        \n        ll dp[55][2] = { 0 };\n\n        dp[0][0] = 1;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < 2; j++) {\n                int q = 0, s = 0, t = 0;\n                if (A[i] == '?') q++;\n                else s += A[i] - '0';\n                if (B[i] == '?') q++;\n                else s += B[i] - '0';\n                if (C[i] != '0') t = C[i] - '0';\n                if (q == 2) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        for (int b = 0; b <= 9; b++) {\n                            if (i == n - 1 && b == 0) continue;\n                            if (i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n                            if ((C[i] == '?' || (a + b + j) % 10 == t)) {\n                                if (a + b + j >= 10) {\n                                    (dp[i + 1][1] += dp[i][j]) %= MOD;\n                                } else {\n                                    (dp[i + 1][0] += dp[i][j]) %= MOD;\n                                }\n                            }\n                        }\n                    }\n                } else if (q == 1) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        if ((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n                        if (C[i] == '?' || (s + a + j) % 10 == t) {\n                            if (s + a + j >= 10) {\n                                (dp[i + 1][1] += dp[i][j]) %= MOD;\n                            } else {\n                                (dp[i + 1][0] += dp[i][j]) %= MOD;\n                            }\n                        }\n                    }\n                } else { // q == 0\n                    if ((i == n - 1 && (s + j) % 10 == 0)) continue;\n                    if (C[i] == '?' || (s + j) % 10 == t) {\n                        if ((s + j) >= 10) {\n                            (dp[i + 1][1] += dp[i][j]) %= MOD;\n                        } else {\n                            (dp[i + 1][0] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n            }// for j\n        }// for i\n        cout << dp[n][0] << endl;\n    }// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    REP(i, 55) dp[i][0] = dp[i][1] = 0;\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if((A+B)%10==C) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if((A+B+1)%10==C) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        if(i!=0 && C>=B) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=B+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>B+1) dp[i][0] += dp[i+1][1];\n        if(C<=(B+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=B) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i!=0 && C>=A) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>A) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=A+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>A+1) dp[i][0] += dp[i+1][1];\n        if(C<=(A+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=A) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(A+B>=10) dp[i][1] += dp[i+1][0];\n        else dp[i][0] += dp[i+1][0];\n        if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n        else dp[i][1] += dp[i+1][0];\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if((j+k)%10==C) {\n              if(j+k>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+k+1)%10) {\n            if((j+k+1)%10==C) {\n              if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int mod = 1e9 + 7;\n\nint n;\nstring s, t, u;\n\nunordered_map<int, int> memo[2];\n\nint dfs(int p, bool up = false) {\n\tif (p == n) return !up;\n\tif (memo[up].count(p)) return memo[up][p];\n\tint id = n - 1 - p;\n\tint res = 0;\n\tfor (int i = 0; i < 10; i++) if (s[id] == '?' || i == s[id] - '0') {\n\t\tfor (int j = 0; j < 10; j++) if (t[id] == '?' || j == t[id] - '0') {\n\t\t\tint d = (i + j + up) % 10;\n\t\t\tbool nu = i + j + up >= 10;\n\t\t\tif (id == 0 && (i == 0 || j == 0 || d == 0)) continue;\n\t\t\tif (u[id] == '?' || d == u[id] - '0') {\n\t\t\t\tres = (res + dfs(p + 1, nu)) % mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn memo[up][p] = res;\n}\n\nint main()\n{\n\tios::sync_with_stdio(false), cin.tie(0);\n\twhile (cin >> s, s != \"0\") {\n\t\tcin >> t >> u;\n\t\tn = s.size();\n\t\tcout << dfs(0) << endl;\n\t\tfor (int i = 0; i < 2; i++) memo[i].clear();\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nlong M=1e9+7;\nlong dp[55][2];\nstring a,b,c;\nmain()\n{\n\twhile(cin>>a,a!=\"0\")\n\t{\n\t\tcin>>b>>c;\n\t\tfor(int i=0;i<=a.size();i++)dp[i][0]=dp[i][1]=0;\n\t\tdp[0][0]=1;\n\t\tfor(int i=0;i<a.size();i++)\n\t\t{\n\t\t\tfor(int A=a[i]=='?'?!i:a[i]-'0';A<=(a[i]=='?'?9:a[i]-'0');A++)\n\t\t\t\tfor(int B=b[i]=='?'?!i:b[i]-'0';B<=(b[i]=='?'?9:b[i]-'0');B++)\n\t\t\t\t\tfor(int C=c[i]=='?'?!i:c[i]-'0';C<=(c[i]=='?'?9:c[i]-'0');C++)\n\t\t\t{\n\t\t\t\tif((A+B)%10==C)\n\t\t\t\t{\n\t\t\t\t\tdp[i+1][0]=(dp[i+1][0]+dp[i][A+B>=10])%M;\n\t\t\t\t}\n\t\t\t\tif((A+B+1)%10==C)\n\t\t\t\t{\n\t\t\t\t\tdp[i+1][1]=(dp[i+1][1]+dp[i][A+B+1>=10])%M;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<dp[a.size()][0]<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\n#define MOD 1000000007\ntypedef long long ll;\n\nint main()\n{\n\twhile (1)\n\t{\n\t\tstring A, B, C;\n\t\tcin >> A;\n\t\tif (A.length() == 1 && A[0] == '0') return 0;\n\t\tcin >> B >> C;\n\n\t\tll ans = 1;\n\t\tll plus1 = 0;\n\t\trrep(i, A.length() - 1, 0)\n\t\t{\n\t\t\tll n_ans = 0, n_plus1 = 0;\n\n\t\t\trep(a, 0, 10)\n\t\t\t{\n\t\t\t\tint aa;\n\t\t\t\tif (i != 0)\n\t\t\t\t{\n\t\t\t\t\tif (A[i] != '?')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (a > 0) break;\n\t\t\t\t\t\taa = A[i] - '0';\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\taa = a;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (a == 0) continue;\n\t\t\t\t\tif (A[i] != '?')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (a > 1) break;\n\t\t\t\t\t\taa = A[i] - '0';\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\taa = a;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trep(b, 0, 10)\n\t\t\t\t{\n\t\t\t\t\tint bb;\n\t\t\t\t\tif(i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (B[i] != '?')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (b > 0) break;\n\t\t\t\t\t\t\tbb = B[i] - '0';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbb = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (b == 0) continue;\n\t\t\t\t\t\tif (B[i] != '?')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (b > 1) break;\n\t\t\t\t\t\t\tbb = B[i] - '0';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbb = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trep(ii, 0, 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tint sum = aa + bb + ii;\n\t\t\t\t\t\t\n\t\t\t\t\t\tint cc = sum % 10;\n\t\t\t\t\t\tif (C[i] != '?')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tint c = C[i] - '0';\n\t\t\t\t\t\t\tif (c != cc) continue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (ii == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (10 <= sum)\n\t\t\t\t\t\t\t\tn_plus1 += ans;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tn_ans += ans;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (10 <= sum)\n\t\t\t\t\t\t\t\tn_plus1 += plus1;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tn_ans += plus1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tans = n_ans % MOD;\n\t\t\tplus1 = n_plus1 % MOD;\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nll dp[128][2];\nstring A,B,C;\n\nll dfs(int n, int over){\n  if(n<0){\n    if(over) return 0;\n    return 1;\n  }\n  //  cout << n << \" \" << over << endl;\n  ll &res = dp[n][over];\n  if(res >= 0) return res;\n  res = 0;\n  int a = A[n]-'0', b = B[n]-'0', c = C[n]-'0';\n  if(A[n]!='?'&&B[n]!='?'&&C[n]!='?'){\n    //    cout << n << \" \" << over << \" \" << A[n] << B[n] << C[n] << endl;\n    if((a+b)%10==c && (a+b)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n    if((a+b+1)%10==c && (a+b+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n  }else if(A[n]!='?'&&B[n]!='?'){\n    if((a+b)/10 == over) res = (res+dfs(n-1, 0)+dfs(n-1, 1))%MOD;\n  }else if(C[n]!='?'){\n    if(A[n]!='?'||B[n]!='?'){\n      if(b < 10) swap(a, b);\n      for(int i=(n==A.size()-1?1:0);i<10;i++){\n\t//\tcout << a << \" \" << i << \" \" << ((a+i)%10==c) << \" \" << over << endl;\n\tif((a+i)%10 == c && (a+i)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\tif((a+i+1)%10 == c && (a+i+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n      }\n    }else{\n      for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++){\n\t  if((i+j)%10 == c && (i+j)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\t  if((i+j+1)%10 == c && (i+j+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t}\n    }\n  }else if(A[n]!='?'||B[n]!='?'){\n    if(b<10) swap(a,b);\n    for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++){\n\t//\tcout << i << \" \" << j << \" \" << ((a+i)%10==j) << \" \" << ((a+i)/10==over) << endl;\n\t//\tcout << i << \" \" << j << \" \" << ((a+i+1)%10==j) << \" \" << ((a+i)/10 == over) << endl;\n\n\tif((a+i)%10 == j && (a+i)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\tif((a+i+1)%10 == j && (a+i+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t//\tif(n==3&&(((a+i)%10 == j && (a+i)/10 == over) || ((a+i+1)%10 == j && (a+i+1)/10 == over)))\n\t//\t  cout << n << \" \" << i << \" \" << j << \" \" << res << endl;\n      }\n  }else{\n    for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++) for(int k=(n==A.size()-1?1:0);k<10;k++){\n\t  if((i+j)%10 == k && (i+j)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\t  if((i+j+1)%10 == k && (i+j+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t}\n  }\n\n  return res;\n}\n\nint main(){\n  while(cin >> A, A!=\"0\"){\n    cin >> B >> C;\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    memset(dp, -1, sizeof(dp));\n    cout << dfs(A.size()-1, 0)%MOD << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n\nusing namespace std;\n\nint main(){\n  string A,B,C;\n  while(1){\n    cin >> A;\n    if(A==\"0\")break;\n    cin >> B >> C;\n\n    int N=A.size();\n    unsigned long P[2][N+1];\n    P[0][0]=1;\n    P[1][0]=0;\n    \n    for(int n=0;n<N;++n){\n      int unknown=0;\n      unsigned long sub[2][2];\n      string a,b,c;\n      a=A[N-n-1];\n      b=B[N-n-1];\n      c=C[N-n-1];\n      if(a==\"?\")unknown++;\n      if(b==\"?\")unknown++;\n      if(c==\"?\")unknown++;\n      for(int i=0;i<2;++i){\n\tswitch(unknown){\n\tcase 0:\n\t  if(i+atoi(a.c_str())+atoi(b.c_str())==atoi(c.c_str())){\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  } else if(i+atoi(a.c_str())+atoi(b.c_str())-10==atoi(c.c_str())) {\n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=0;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 1:\n\t  if(c==\"?\"){\n\t    if(i+atoi(a.c_str())+atoi(b.c_str())<10){\n\t      sub[i][0]=1;\n\t      sub[i][1]=0;\n\t    }else{\n\t      sub[i][0]=0;\n\t      sub[i][1]=1;\n\t    }\n\t  } else if( atoi(a.c_str())>atoi(c.c_str()) || atoi(b.c_str())>atoi(c.c_str())){ \n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 2:\n\t  sub[i][1]=atoi(a.c_str())+atoi(b.c_str())+atoi(c.c_str())+i;\n\t  sub[i][0]=10-sub[i][1];\n\t  break;\n\t  \n\tcase 3:\n\t  sub[0][0]=45;\n\t  sub[0][1]=55;\n\t  sub[1][0]=36;\n\t  sub[1][1]=64;\n\t  break;\n\t}\n      }\n\n      if(n==N-1){\n\tsub[0][1]=0;\n\tsub[1][1]=0;\n\tfor(int i=0;i<2;++i){\n\t  switch(unknown){\n\t  case 1:\n\t    if(i+atoi(a.c_str())==atoi(c.c_str()) || i+atoi(b.c_str()) == atoi(c.c_str())){\n\t      sub[i][0]=0;\n\t    }\n\t    break;\n\t  case 2:\n\t    if(sub[i][0]>0)sub[i][0]--;\n\t    break;\n\t  case 3:\n\t    sub[0][0]=36;\n\t    sub[1][0]=28;\n\t    break;\n\t  }\n\t}\n\tcout << sub[0][0] << \" \" << sub[0][1] << \" \"<< sub[1][0] << \" \"<< sub[1][1] << \" \" << endl;;\n      }\n     \n      P[0][n+1]=P[0][n]*sub[0][0]+P[1][n]*sub[1][0];\n      P[1][n+1]=P[0][n]*sub[0][1]+P[1][n]*sub[1][1];\n    }\n    \n    for(int j=0;j<=N;++j){\n      for(int i=0;i<2;++i){\n    \tcout << P[i][j] << \" \";\n      }\n      cout << endl;\n    }\n    cout << P[0][N] << endl;\n  }\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <valarray>\n#include <string>\n#include <algorithm>\n#include <set>\ntypedef unsigned long long ull;\ntypedef long long ll;\n\n#define rep(i,n) for(ull i = 0;i<(n);i++)\n#define rep1(i,n) for(ull i = 1;i<=(n);i++)\n#define revrep(i,n) for(ull i = (n-1);i>=0;i--)\n#define all(n) (n).begin(),(n).end()\n#define show(x) (cout << \"debug \" << #x << \":\" << x << endl, x);\n#define showvec(x) cout << endl << \"debug \" << #x << \";\" << endl; \\\n\tfor(ull __i = 0;__i < x.size();__i++){ \\\n\t\tfor(ull __j = 0;__j<x[0].size();__j++){ \\\n\t\t\tcout << x[__i][__j] << \" \"; \\\n\t\t} \\\n\t\tcout << endl; \\\n\t} \\\n\tcout << endl;\nusing namespace std;\n#define MOD 1000000007\n\null patternNum(bool last, char p, char q, char r, bool cu, bool cn){\n\tull ans = 0;\n\tint fst = (last ? 1 : 0);\n\tfor(int a = fst;a < 10;a++){\n\t\tif(p != '?'){\n\t\t\ta = p - '0';\n\t\t}\n\t\tfor(int b = fst;b < 10;b++){\n\t\t\tif(q != '?'){\n\t\t\t\tb = q - '0';\n\t\t\t}\n\t\t\tfor(int c = fst;c < 10;c++){\n\t\t\t\tif(r != '?'){\n\t\t\t\t\tc = r - '0';\n\t\t\t\t}\n\t\t\t\tull tmp = a + b + (cu ? 1 : 0);\n\t\t\t\tif(tmp % 10 == c){\n\t\t\t\t\tif(tmp >= 10 && cn){\n\t\t\t\t\t\tans++;\n\t\t\t\t\t}\n\t\t\t\t\tif(tmp < 10 && !cn){\n\t\t\t\t\t\tans++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(r != '?'){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(q != '?'){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(p != '?'){\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tull c0[52],c1[52];\n\tstring A,B,C;\n\twhile(cin >> A, A != \"0\"){\n\t\tcin >> B >> C;\n\t\trep(i,52){\n\t\t\tc0[i] = c1[i] = 0;\n\t\t}\n\t\tfor(int p = A.size()-1;p>=0;p--){\n\t\t\tif(p == A.size()-1 && A.size() != 1){\n\t\t\t\tc0[p] = patternNum(false,A[p],B[p],C[p],false,false) % MOD;\n\t\t\t\tc1[p] = patternNum(false,A[p],B[p],C[p],false,true) % MOD;\n\t\t\t}else if(p != 0){\n\t\t\t\tc0[p] = patternNum(false,A[p],B[p],C[p],false,false) * c0[p+1] + patternNum(false,A[p],B[p],C[p],true,false) * c1[p+1];\n\t\t\t\tc0[p] %= MOD;\n\t\t\t\tc1[p] = patternNum(false,A[p],B[p],C[p],false,true) * c0[p+1] + patternNum(false,A[p],B[p],C[p],true,true) * c1[p+1];\n\t\t\t\tc1[p] %= MOD;\n\t\t\t}else if(p == 0 && A.size() != 1){\n\t\t\t\tc0[p] = patternNum(true,A[p],B[p],C[p],false,false) * c0[p+1] + patternNum(true,A[p],B[p],C[p],true,false) * c1[p+1];\n\t\t\t\tc0[p] %= MOD;\n\t\t\t\tc1[p] = 0;\n\t\t\t}else{\n\t\t\t\tc0[0] = patternNum(true,A[p],B[p],C[p],false,false);\n\t\t\t}\n\t\t}\n\t\tcout << c0[0] + c1[0] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\n#define MOD 1000000007\n\nint main(){\n  string a,b,c;\n  while(1){\n    cin >> a;\n    if(a==\"0\") return 0;\n    cin >> b >> c;\n    LL dp[50][10][10][10][2];\n    LL total[2];\n    for(int i=0;i<10;i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          dp[a.length()-1][i][j][k][0]=dp[a.length()-1][i][j][k][1]=0;\n          if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n            &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n            &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n              if((i+j)%10==k){\n                dp[a.length()-1][i][j][k][(i+j)/10]=1;\n              }\n          }\n        }\n      }\n    }\n    total[0]=total[1]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n          total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n        }\n      }\n    }\n    if(a.length()==1){\n      cout << total[0] << endl;\n      continue;\n    }\n    for(int i=a.length()-2;i>0;i--){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            if((a[i]=='?'||a[i]=='0'+j)\n              &&(b[i]=='?'||b[i]=='0'+k)\n              &&(c[i]=='?'||c[i]=='0'+l)\n            ){\n              for(int m=0;m<2;m++){\n                if((j+k+m)%10==l){\n                  dp[i][j][k][l][(j+k+m)/10]=total[m];\n                  //printf(\"(%d %d %d %d %d) %d\\n\",i,j,k,l,m,dp[i][j][k][l][(j+k+m)/10]);\n                }\n              }\n            }else{\n              dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[i][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[i][j][k][l][1])%MOD;\n          }\n        }\n      }\n    }\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          if((a[0]=='?'||a[0]=='0'+j)\n            &&(b[0]=='?'||b[0]=='0'+k)\n            &&(c[0]=='?'||c[0]=='0'+l)\n          ){\n            for(int m=0;m<2;m++){\n              if((j+k+m)%10==l){\n                dp[0][j][k][l][(j+k+m)/10]=total[m];\n              }\n            }\n          }else{\n            dp[0][j][k][l][0]=dp[0][j][k][l][1]=0;\n          }\n        }\n      }\n    }\n    total[0]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[0][j][k][l][0])%MOD;\n        }\n      }\n    }\n    cout << total[0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nconst int MOD = 1e9+7;\n\nstring A, B, C;\nint N;\nvector<vector<int> > dp;\n\nint dfs(int n, int r) {\n  if ( dp[n][r] >= 0 ) return dp[n][r];\n  if ( n == N-1 ) {\n    int ret = 0;\n    for ( int i = 1; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 1; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( i+j+r >= 10 ) continue;\t\n\tif ( C[n] == '?' ) {\n\t  ret++;\n\t} else {\n\t  if ( C[n]-'0' == i+j+r ) ret++;\t  \n\t}\n\tret %= MOD;\n      }\n    }\n    return dp[n][r] = ret;\n  } else {\n    int ret = 0;\n    for ( int i = 0; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 0; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( C[n] == '?' ) {\n\t  ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t} else {\n\t  if ( C[n]-'0' == (i+j+r)%10 ) ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t}\n      }\n    }\n\n    return dp[n][r] = (ret%MOD);    \n  }\n}\n\nsigned main() {\n  while ( cin >> A, A != \"0\" ) {\n    cin >> B >> C;\n    N = A.size();\n    dp = vector<vector<int> >(N+1, vector<int>(3, -1));    \n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());    \n    reverse(C.begin(), C.end());\n\n    cout << dfs(0, 0)%MOD << endl;    \n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n\tstring s,t,u;\n\twhile(cin >> s,s!=\"0\"){\n\t\tcin >> t >> u;\n\t\tint n = s.length();\n\t\ts += '$';\n\t\tt += '$';\n\t\tu += '$';\n\t\treverse(s.begin(),s.end());\n\t\treverse(t.begin(),t.end());\n\t\treverse(u.begin(),u.end());\n\n\t\tlong long dp[100][2] = {};\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 1;i <= n;i++){\n\t\t\tchar a = s[i],b = t[i],c = u[i];\n\t\t\tint q = 0;\n\t\t\tif(a == '?')q++;\n\t\t\tif(b == '?')q++;\n\t\t\tif(c == '?')q++;\n\t\t\tint p = a - '0' + b - '0';\n\t\t\tswitch(q){\n\t\t\t\tint x,y;\n\t\t\t\tbool f,g;\n\t\t\t\tcase 0:\n\t\t\t\t\tx = p % 10;\n\t\t\t\t\ty = p / 10;\n\t\t\t\t\tf = (x != c - '0'),g = (y != 0);\n\t\t\t\t\tdp[i][g] += dp[i-1][f];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tif(p < 9)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(p == 9)dp[i][0] += dp[i-1][0],dp[i][1] += dp[i-1][1];\n\t\t\t\t\t\tif(p > 9)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tint d = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(d < c)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(d == c)dp[i][0] += dp[i-1][0],dp[i][1] = dp[i-1][1];\n\t\t\t\t\t\tif(d > c)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tx = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * max(0,10 - (x + 1 + j));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (10 - (x + j));\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (x + j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\ty = c - '0';\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y - 1 + j);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y + 1 + j);\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (10 - (y + 1 + j));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif(i == n){\n\t\t\t\t\t\tdp[i][0] += dp[i-1][0] * 36 + dp[i-1][1] * 28;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdp[i][0] += dp[i-1][0] * 55 + dp[i-1][1] * 45;\n\t\t\t\t\tdp[i][1] += dp[i-1][0] * 45 + dp[i-1][1] * 55;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdp[i][0] %= 1000000007,dp[i][1] %= 1000000007;\n\t\t}\n\t\tcout << dp[n][0] << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n\nconst int mod=1000000007;\nstring a,b,c;\n\nstring fillX(string s)\n{\n    string ret=s;\n    while(ret.size()<51) ret=\"X\"+ret;\n    return ret;\n}\n\nint dp[51][2];\nint dfs(int now, int carry)\n{\n    if(dp[now][carry]>=0) return dp[now][carry];\n    if(now==0)\n    {\n        if(carry==0) return 1;\n        else return 0;\n    }\n\n    int ret=0;\n\n    if(a[now]=='?' && b[now]=='?')\n    {\n        int idxa=0,idxb=0;\n        if(a[now-1]=='X') idxa=1;\n        if(b[now-1]=='X') idxb=1;\n        for(int i=idxa; i<=9; ++i)for(int j=idxb; j<=9; ++j)\n        {\n            int val=i+j+carry;\n            if(c[now]=='X')\n            {\n                if(val==0) ret+=dfs(now-1,val/10);\n            }\n            else if(c[now]=='?')\n            {\n                if(c[now-1]=='X')\n                {\n                    if(val%10!=0) (ret+=dfs(now-1,val/10))%=mod;\n                }\n                else (ret+=dfs(now-1,val/10))%=mod;\n            }\n            else\n            {\n                if(c[now]-'0'==val%10) (ret+=dfs(now-1,val/10))%=mod;\n            }\n        }\n    }\n    else if(a[now]=='?')\n    {\n        int val_b=b[now]-'0';\n        if(b[now]=='X') val_b=0;\n\n        int idxa=0;\n        if(a[now-1]=='X') idxa=1;\n        for(int i=idxa; i<=9; ++i)\n        {\n            int val=i+val_b+carry;\n            if(c[now]=='X')\n            {\n                if(val==0) ret+=dfs(now-1,val/10);\n            }\n            else if(c[now]=='?')\n            {\n                if(c[now-1]=='X')\n                {\n                    if(val%10!=0) (ret+=dfs(now-1,val/10))%=mod;\n                }\n                else (ret+=dfs(now-1,val/10))%=mod;\n            }\n            else\n            {\n                if(c[now]-'0'==val%10) (ret+=dfs(now-1,val/10))%=mod;\n            }\n        }\n    }\n    else if(b[now]=='?')\n    {\n        int val_a=a[now]-'0';\n        if(a[now]=='X') val_a=0;\n\n        int idxb=0;\n        if(b[now-1]=='X') idxb=1;\n        for(int j=idxb; j<=9; ++j)\n        {\n            int val=val_a+j+carry;\n            if(c[now]=='X')\n            {\n                if(val==0) ret+=dfs(now-1,val/10);\n            }\n            else if(c[now]=='?')\n            {\n                if(c[now-1]=='X')\n                {\n                    if(val%10!=0) (ret+=dfs(now-1,val/10))%=mod;\n                }\n                else (ret+=dfs(now-1,val/10))%=mod;\n            }\n            else\n            {\n                if(c[now]-'0'==val%10) (ret+=dfs(now-1,val/10))%=mod;\n            }\n        }\n\n    }\n    else\n    {\n        int val_a=a[now]-'0', val_b=b[now]-'0';\n        if(a[now]=='X') val_a=0;\n        if(b[now]=='X') val_b=0;\n\n        int val=val_a+val_b+carry;\n        if(c[now]=='X')\n        {\n            if(val==0) ret+=dfs(now-1,val/10);\n        }\n        else if(c[now]=='?')\n        {\n            if(c[now-1]=='X')\n            {\n                if(val%10!=0) (ret+=dfs(now-1,val/10))%=mod;\n            }\n            else (ret+=dfs(now-1,val/10))%=mod;\n        }\n        else\n        {\n            if(c[now]-'0'==val%10) (ret+=dfs(now-1,val/10))%=mod;\n        }\n    }\n\n    return dp[now][carry]=ret;\n}\n\nint main()\n{\n    while(cin >>a)\n    {\n        if(a==\"0\") break;\n        cin >>b >>c;\n\n        a=fillX(a);\n        b=fillX(b);\n        c=fillX(c);\n\n        memset(dp,-1,sizeof(dp));\n        cout << dfs(50,0) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\n\n\n\nconst int mod = 1000000007;\nstruct Mod {\npublic:\n\tint num;\n\tMod() : num(0) { ; }\n\tMod(long long int n) : num((n % mod + mod) % mod) { ; }\n\tMod(int n) : num((n % mod + mod) % mod) { ; }\n\toperator int() { return num; }\n};\n\nMod operator+(const Mod a, const Mod b) { return Mod((a.num + b.num) % mod); }\nMod operator+(const long long int a, const Mod b) { return Mod(a) + b; }\nMod operator++(Mod &a) { return a + Mod(1); }\nMod operator-(const Mod a, const Mod b) { return Mod((mod + a.num - b.num) % mod); }\nMod operator-(const long long int a, const Mod b) { return Mod(a) - b; }\nMod operator--(Mod &a) { return a - Mod(1); }\nMod operator*(const Mod a, const Mod b) { return Mod(((long long)a.num * b.num) % mod); }\nMod operator*(const long long int a, const Mod b) { return Mod(a)*b; }\nMod operator+=(Mod &a, const Mod b) { return a = a + b; }\nMod operator+=(long long int &a, const Mod b) { return a = a + b; }\nMod operator-=(Mod &a, const Mod b) { return a = a - b; }\nMod operator-=(long long int &a, const Mod b) { return a = a - b; }\nMod operator*=(Mod &a, const Mod b) { return a = a * b; }\nMod operator*=(long long int &a, const Mod b) { return a = a * b; }\nMod operator^(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = (a * a) ^ (n / 2);\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod mod_pow(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = mod_pow((a * a), (n / 2));\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod inv(const Mod a) { return a ^ (mod - 2); }\nMod operator/(const Mod a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a * inv(b);\n}\nMod operator/(const long long int a, const Mod b) {\n\tassert(b.num != 0);\n\treturn Mod(a) * inv(b);\n}\nMod operator/=(Mod &a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a = a * inv(b);\n}\n\n#define MAX_MOD_N 1024000\n\nMod fact[MAX_MOD_N], factinv[MAX_MOD_N];\nvoid init() {\n\tfact[0] = Mod(1); factinv[0] = 1;\n\tfor (int i = 0; i < MAX_MOD_N - 1; ++i) {\n\t\tfact[i + 1] = fact[i] * Mod(i + 1);\n\t\tfactinv[i + 1] = factinv[i] / Mod(i + 1);\n\t}\n}\nMod comb(const int a, const int b) {\n\treturn fact[a] * factinv[b] * factinv[a - b];\n}\n\nint main() {\n\twhile (1) {\n\t\tstring st[3]; cin >> st[0];\n\t\tif (st[0] == \"0\")break;\n\t\tcin>> st[1] >> st[2];\n\t\tMod dp[51][10];\n\t\tdp[st[0].size()-1][0] = 1;\n\t\tfor (int i = st[0].size()-1; i > 0; --i) {\n\t\t\tchar a, b, c; a = st[0][i];\n\t\t\tb = st[1][i]; c = st[2][i];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 0; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 0; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 0; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10==z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\n\t\t\t\t\t\t\t\tdp[i-1][amari] += dp[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tMod ans = 0;\n\t\t{\n\t\t\tchar a, b, c; a = st[0][0];\n\t\t\tb = st[1][0]; c = st[2][0];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 1; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 1; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 1; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10 == z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\nif(!amari)\t\t\t\t\t\t\t\tans += dp[0][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tcout << ans << endl;\n\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\n#define MOD 1000000007\n\nint main(){\n  string a,b,c;\n  while(1){\n    cin >> a;\n    if(a==\"0\") return 0;\n    cin >> b >> c;\n    LL dp[50][10][10][10][2];\n    LL total[2];\n    for(int i=0;i<10;i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          dp[a.length()-1][i][j][k][0]=dp[a.length()-1][i][j][k][1]=0;\n          if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n            &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n            &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n              if((i+j)%10==k){\n                dp[a.length()-1][i][j][k][(i+j)/10]=1;\n              }\n          }\n        }\n      }\n    }\n    total[0]=total[1]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n          total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n        }\n      }\n    }\n    if(a.length()==1){\n      cout << total[0] << endl;\n      continue;\n    }\n    for(int i=a.length()-2;i>0;i--){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n            if((a[i]=='?'||a[i]=='0'+j)\n              &&(b[i]=='?'||b[i]=='0'+k)\n              &&(c[i]=='?'||c[i]=='0'+l)\n            ){\n              for(int m=0;m<2;m++){\n                if((j+k+m)%10==l){\n                  dp[i][j][k][l][(j+k+m)/10]=total[m];\n                  //printf(\"(%d %d %d %d %d) %d\\n\",i,j,k,l,m,dp[i][j][k][l][(j+k+m)/10]);\n                }\n              }\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[i][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[i][j][k][l][1])%MOD;\n          }\n        }\n      }\n    }\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          dp[0][j][k][l][0]=dp[0][j][k][l][1]=0;\n          if((a[0]=='?'||a[0]=='0'+j)\n            &&(b[0]=='?'||b[0]=='0'+k)\n            &&(c[0]=='?'||c[0]=='0'+l)\n          ){\n            for(int m=0;m<2;m++){\n              if((j+k+m)%10==l){\n                dp[0][j][k][l][(j+k+m)/10]=total[m];\n              }\n            }\n          }\n        }\n      }\n    }\n    total[0]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[0][j][k][l][0])%MOD;\n        }\n      }\n    }\n    cout << total[0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\n#define M 1000000007\n\nll mem[55][2];\n\nint n;\nstring a,b,c;\n\nll dfs(int digit,int carry){\n\tif(digit==-1)return (carry==1?0:1);\n\tif(mem[digit][carry]!=-1)return mem[digit][carry];\n\tll res=0;\n\n\trep(an,10){\n\t\tif(a[digit]!='?'&&a[digit]-'0'!=an)continue;\n\t\tif(digit==0&&an==0)continue;\n\t\trep(bn,10){\n\t\t\tif(b[digit]!='?'&&b[digit]-'0'!=bn)continue;\n\t\t\tif(digit==0&&bn==0)continue;\n\t\t\trep(cn,10){\n\t\t\t\tif(c[digit]!='?'&&c[digit]-'0'!=cn)continue;\n\t\t\t\tif(digit==0&&cn==0)continue;\n\t\t\t\tif((an+bn+carry)%10==cn)res=(res+dfs(digit-1,(an+bn+carry)/10))%M;\n\t\t\t}\n\t\t}\n\t}\n\treturn mem[digit][carry]=res;\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>a;\n\t\tif(a[0]=='0')break;\n\t\tcin>>b>>c;\n\t\tn=a.length();\n\t\tmemset(mem,-1,sizeof(mem));\n\t\tcout<<dfs(n-1,0)<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n#define mod 1000000007\nstring A, B, C; long long dp[60][3];\nint main() {\n\twhile (true) {\n\t\tcin >> A; if (A == \"0\")break;\n\t\tcin >> B >> C;\n\t\tfor (int i = 0; i < 180; i++)dp[i / 3][i % 3] = 0;\n\t\treverse(A.begin(), A.end()); int A1 = A.size();\n\t\treverse(B.begin(), B.end()); int B1 = B.size();\n\t\treverse(C.begin(), C.end()); int C1 = C.size();\n\t\twhile (A.size() < 50)A = A + '0';\n\t\twhile (B.size() < 50)B = B + '0';\n\t\twhile (C.size() < 50)C = C + '0';\n\t\tdp[0][0] = 1;\n\t\tfor (int i = 0; i < 50; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tint a = 0, b = 0, c = 0;\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tfor (int l = 0; l < 10; l++) {\n\t\t\t\t\t\tint m = j + k + l;\n\t\t\t\t\t\tif ((k != (int)(A[i] - '0') && A[i] != '?') || (i == A1 - 1 && k == 0))continue;\n\t\t\t\t\t\tif ((l != (int)(B[i] - '0') && B[i] != '?') || (i == B1 - 1 && l == 0))continue;\n\t\t\t\t\t\tif ((m % 10 != (int)(C[i] - '0') && C[i] != '?') || (i == C1 - 1 && m % 10 == 0))continue;\n\t\t\t\t\t\tif (m >= 0 && m < 10)a++;\n\t\t\t\t\t\tif (m >= 10 && m < 20)b++;\n\t\t\t\t\t\tif (m >= 20 && m < 30)c++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i + 1][0] += dp[i][j] * a; dp[i + 1][0] %= mod;\n\t\t\t\tdp[i + 1][1] += dp[i][j] * b; dp[i + 1][1] %= mod;\n\t\t\t\tdp[i + 1][2] += dp[i][j] * c; dp[i + 1][2] %= mod;\n\t\t\t}\n\t\t}\n\t\tcout << (dp[50][0] + dp[50][1] + dp[50][2]) % mod << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\n\nconst int mod = 1e9+7;\n\nint main(){\n    string a, b, c;\n    while(cin >> a, a != \"0\"){\n        cin >> b >> c;\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n        int n = a.length();\n        vector<vector<int>> dp(n+1, vector<int>(2, 0));\n        dp[0][0] = 1;\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < 2; j++){\n                if(dp[i][j] == 0)   continue;\n                for(int k = 0; k < 10; k++){\n                    if(i == n-1 && k == 0)  continue;\n                    if(a[i] != '?' && a[i]-'0' != k)    continue;\n                    for(int l = 0; l < 10; l++){\n                        if(i == n-1 && l == 0)  continue;\n                        if(b[i] != '?' && b[i]-'0' != l)    continue;\n                        if(c[i] == '?' || (j+k+l)%10 == c[i]-'0'){\n                            dp[i+1][(j+k+l)/10] += dp[i][j];\n                            dp[i+1][(j+k+l)/10] %= mod;\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\n#define MOD 1000000007\n\nint main(){\n  string a,b,c;\n  while(1){\n    cin >> a;\n    if(a==\"0\") return 0;\n    cin >> b >> c;\n    LL dp[50][10][10][10][2];\n    LL total[2];\n    for(int i=0;i<10;i++){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          dp[a.length()-1][i][j][k][0]=dp[a.length()-1][i][j][k][1]=0;\n          if((a[a.length()-1]=='?'||a[a.length()-1]=='0'+i)\n            &&(b[a.length()-1]=='?'||b[a.length()-1]=='0'+j)\n            &&(c[a.length()-1]=='?'||c[a.length()-1]=='0'+k)){\n              if((i+j)%10==k){\n                dp[a.length()-1][i][j][k][(i+j)/10]=1;\n              }\n          }\n        }\n      }\n    }\n    total[0]=total[1]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[a.length()-1][j][k][l][0])%MOD;\n          total[1]=(total[1]+dp[a.length()-1][j][k][l][1])%MOD;\n        }\n      }\n    }\n    for(int i=a.length()-2;i>0;i--){\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            if((a[i]=='?'||a[i]=='0'+j)\n              &&(b[i]=='?'||b[i]=='0'+k)\n              &&(c[i]=='?'||c[i]=='0'+l)\n            ){\n              for(int m=0;m<2;m++){\n                if((j+k+m)%10==l){\n                  dp[i][j][k][l][(j+k+m)/10]=total[m];\n                  //printf(\"(%d %d %d %d %d) %d\\n\",i,j,k,l,m,dp[i][j][k][l][(j+k+m)/10]);\n                }\n              }\n            }else{\n              dp[i][j][k][l][0]=dp[i][j][k][l][1]=0;\n            }\n          }\n        }\n      }\n      total[0]=total[1]=0;\n      for(int j=0;j<10;j++){\n        for(int k=0;k<10;k++){\n          for(int l=0;l<10;l++){\n            total[0]=(total[0]+dp[i][j][k][l][0])%MOD;\n            total[1]=(total[1]+dp[i][j][k][l][1])%MOD;\n          }\n        }\n      }\n    }\n    for(int j=1;j<10;j++){\n      for(int k=1;k<10;k++){\n        for(int l=1;l<10;l++){\n          if((a[0]=='?'||a[0]=='0'+j)\n            &&(b[0]=='?'||b[0]=='0'+k)\n            &&(c[0]=='?'||c[0]=='0'+l)\n          ){\n            for(int m=0;m<2;m++){\n              if((j+k+m)%10==l){\n                dp[0][j][k][l][(j+k+m)/10]=total[m];\n              }\n            }\n          }else{\n            dp[0][j][k][l][0]=dp[0][j][k][l][1]=0;\n          }\n        }\n      }\n    }\n    total[0]=0;\n    for(int j=0;j<10;j++){\n      for(int k=0;k<10;k++){\n        for(int l=0;l<10;l++){\n          total[0]=(total[0]+dp[0][j][k][l][0])%MOD;\n        }\n      }\n    }\n    cout << total[0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconstexpr long long MOD = 1000000007LL;\n\n\ntemplate <uint_fast64_t Modulus>\nstruct ModInt {\n    using u64 = uint_fast64_t;\n    u64 val;\n    constexpr ModInt(const int x = 0) noexcept : val(x >= 0 ? x%Modulus : x%(int)Modulus+Modulus){}\n    constexpr const u64& value() const noexcept { return val; }\n    constexpr ModInt operator-() const noexcept { return val ? Modulus-val : 0; }\n    constexpr ModInt operator+(const ModInt& rhs) const noexcept { return ModInt(*this) += rhs; }\n    constexpr ModInt operator-(const ModInt& rhs) const noexcept { return ModInt(*this) -= rhs; }\n    constexpr ModInt operator*(const ModInt& rhs) const noexcept { return ModInt(*this) *= rhs; }\n    constexpr ModInt operator/(const ModInt& rhs) const noexcept { return ModInt(*this) /= rhs; }\n    constexpr bool operator==(const ModInt& rhs) const noexcept { return val == rhs.val; }\n    constexpr bool operator!=(const ModInt& rhs) const noexcept { return val != rhs.val; }\n    constexpr ModInt& operator+=(const ModInt& rhs) noexcept {\n        val += rhs.val;\n        if(val >= Modulus) val -= Modulus;\n        return *this;\n    }\n    constexpr ModInt& operator-=(const ModInt& rhs) noexcept {\n        if(val < rhs.val) val += Modulus;\n        val -= rhs.val;\n        return *this;\n    }\n    constexpr ModInt& operator*=(const ModInt& rhs) noexcept {\n        val = val*rhs.val%Modulus;\n        return *this;\n    }\n    constexpr ModInt& operator/=(const ModInt& rhs) noexcept {\n        *this *= rhs.inverse();\n        return *this;\n    }\n    constexpr ModInt inverse() const noexcept {\n        int a = val, b = Modulus, u = 1, v = 0;\n        while(b){\n            int t = a/b;\n            a -= t*b; swap(a, b);\n            u -= t*v; swap(u, v);\n        }\n        return ModInt(u);\n    }\n    constexpr ModInt pow(u64 n) const noexcept {\n        ModInt res(1), mul(val);\n        while(n > 0){\n            if(n&1) res *= mul;\n            mul *= mul;\n            n >>= 1;\n        }\n        return res;\n    }\n    friend constexpr ModInt operator+(const int lhs, const ModInt& rhs) noexcept { return rhs+lhs; }\n    friend constexpr ModInt operator*(const int lhs, const ModInt& rhs) noexcept { return rhs*lhs; }\n    friend ostream& operator<<(ostream& os, const ModInt& rhs){ return os << rhs.val; }\n    friend istream& operator>>(istream& is, ModInt& rhs){\n        u64 t;\n        is >> t;\n        rhs = ModInt<Modulus>(t);\n        return is;\n    }\n};\nusing modint = ModInt<MOD>;\n\n\nstring A, B, C;\nmodint mem[60][2];\n\n\nbool jdg(int x, int y, int z, int k){\n    int a = A[k]-'0';\n    int b = B[k]-'0';\n    int c = C[k]-'0';\n    if(A[k] == '?') a = x;\n    if(B[k] == '?') b = y;\n    if(C[k] == '?') c = z;\n    if(a != x) return false;\n    if(b != y) return false;\n    if(c != z) return false;\n    return true;\n}\n\n\nmodint rec(int k = 0, bool t = false){\n    if(k == A.size()) return !t;\n    modint& res = mem[k][t];\n    if(res != -1) return res;\n    res = 0;\n    int x = (k == 0);\n    for(int a = x;a < 10;++a) for(int b = x;b < 10;++b) for(int c = x;c < 10;++c) if(jdg(a, b, c, k)){\n        int d = c;\n        if(t) d += 10;\n        if(a+b == d) res += rec(k+1, false);\n        else if(a+b+1 == d) res += rec(k+1, true);\n    }\n    return res;\n}\n\n\nsigned main(){\n    while(cin >> A, A[0]-'0'){\n        cin >> B >> C;\n        for_each(mem, mem+60, [](auto& ary){ fill(ary, ary+2, -1); });\n        cout << rec() << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\nusing namespace std;\n#define mod 1000000007\nstring A, B, C; long long dp[60][3];\nint main() {\n\twhile (true) {\n\t\tcin >> A; if (A == \"0\")break;\n\t\tcin >> B >> C;\n\t\tfor (int i = 0; i < 180; i++)dp[i / 3][i % 3] = 0;\n\t\treverse(A.begin(), A.end()); int A1 = A.size();\n\t\treverse(B.begin(), B.end()); int B1 = B.size();\n\t\treverse(C.begin(), C.end()); int C1 = C.size();\n\t\twhile (A.size() < 50)A = A + '0';\n\t\twhile (B.size() < 50)B = B + '0';\n\t\twhile (C.size() < 50)C = C + '0';\n\t\tdp[0][0] = 1;\n\t\tfor (int i = 0; i < 50; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tint a = 0, b = 0, c = 0;\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tfor (int l = 0; l < 10; l++) {\n\t\t\t\t\t\tint m = j + k + l;\n\t\t\t\t\t\tif ((k != (int)(A[i] - '0') && A[i] != '?') || (i == A1 - 1 && k == 0))continue;\n\t\t\t\t\t\tif ((l != (int)(B[i] - '0') && B[i] != '?') || (i == B1 - 1 && l == 0))continue;\n\t\t\t\t\t\tif ((m % 10 != (int)(C[i] - '0') && C[i] != '?') || (i == C1 - 1 && m % 10 == 0))continue;\n\t\t\t\t\t\tif (m >= 0 && m < 10)a++;\n\t\t\t\t\t\tif (m >= 10 && m < 20)b++;\n\t\t\t\t\t\tif (m >= 20 && m < 30)c++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i + 1][0] += dp[i][j] * a; dp[i + 1][0] %= mod;\n\t\t\t\tdp[i + 1][1] += dp[i][j] * b; dp[i + 1][1] %= mod;\n\t\t\t\tdp[i + 1][2] += dp[i][j] * c; dp[i + 1][2] %= mod;\n\t\t\t}\n\t\t}\n\t\tcout << (dp[50][0] + dp[50][1] + dp[50][2]) % mod << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\n#define int long long\ntypedef pair<int,int> P;\nstring s[3];\nint c;\nP ch(int p,int x){\n  P a;a=P(0,0);\n  r(i,10)if(c+i)if(s[0][p]=='?'||s[0][p]==i+'0')\n    r(j,10)if(c+j)if(s[1][p]=='?'||s[1][p]==j+'0'){\n      int t=i+j+x;\n      if(s[2][p]!='?'&&t%10!=s[2][p]-'0')continue;\n      if(t>9)a.fi++;\n      else a.se++;\n    }\n  return a;\n}\nmain(){\n  while(cin>>s[0],s[0]!=\"0\"){\n    cin>>s[1]>>s[2];c=1;\n    r(i,3)reverse(s[i].begin(),s[i].end());\n    int sum1=1,sum2=0,t;\n    r(i,s[0].size()){\n      if(i==s[0].size()-1)c--;\n      P a1=ch(i,0),a2=ch(i,1);\n      t=sum1*a1.se+sum2*a2.se;\n     //////////////////////////////////////////////// sum2=(sum1*a1.fi+sum2*a2.fi)%1000000007;\n      sum1=t%1000000007;\n    }\n    cout<<sum1<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <string>\n#include <cassert>\nusing namespace std;\n\n#define all(c) begin(c), end(c)\n\nconst int MOD = 1e9 + 7;\nstring A, B, C;\nint a[55], b[55], c[55];\n\nint main() {\n    while (cin >> A >> B >> C && A != \"0\") {\n        reverse(all(A));\n        reverse(all(B));\n        reverse(all(C));\n        int n = A.size();\n        for (size_t i = 0; i < n; i++) {\n            a[i] = isdigit(A[i]) ? A[i] - '0' : -1;\n            b[i] = isdigit(B[i]) ? B[i] - '0' : -1;\n            c[i] = isdigit(C[i]) ? C[i] - '0' : -1;\n        }\n        \n        int dp[55][2] = {};\n        dp[0][0] = 1;\n        for (size_t i = 0; i < n; i++) {\n            for (size_t j = 0; j < 2; j++) {\n                for (size_t ia = 0; ia < 10; ia++) {\n                    for (size_t ib = 0; ib < 10; ib++) {\n                        for (size_t ic = 0; ic < 10; ic++) {\n                            if (a[i] != -1 && ia != a[i]) continue;\n                            if (b[i] != -1 && ib != b[i]) continue;\n                            if (c[i] != -1 && ic != c[i]) continue;\n                            if (i == n - 1 && (ia == 0 || ib == 0 || ic == 0)) continue;\n                            int dig = ia + ib + j;\n                            if (dig % 10 != ic) continue;\n                            (dp[i + 1][dig >= 10] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nconst int MOD = 1e9+7;\n\nstring A, B, C;\nint N;\nvector<vector<int> > dp;\n\nint dfs(int n, int r) {\n  if ( dp[n][r] >= 0 ) return dp[n][r];\n  if ( n == N-1 ) {\n    int ret = 0;\n    for ( int i = 1; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 1; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( i+j+r >= 10 ) continue;\t\n\tif ( C[n] == '?' ) {\n\t  ret++;\n\t} else {\n\t  if ( C[n]-'0' == i+j+r ) ret++;\t  \n\t}\n\tret %= MOD;\n      }\n    }\n    return dp[n][r] = ret;\n  } else {\n    int ret = 0;\n    for ( int i = 0; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 0; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( C[n] == '?' ) {\n\t  ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t} else {\n\t  if ( C[n]-'0' == (i+j+r)%10 ) ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t}\n      }\n    }\n\n    return dp[n][r] = (ret%MOD);    \n  }\n}\n\nsigned main() {\n  while ( cin >> A, A != \"0\" ) {\n    cin >> B >> C;\n    N = A.size();\n    dp = vector<vector<int> >(N+1, vector<int>(3, -1));    \n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());    \n    reverse(C.begin(), C.end());\n\n    cout << dfs(0, 0)%MOD << endl;    \n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    REP(i, 55) dp[i][0] = dp[i][1] = 0;\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if((A+B)%10==C) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if((A+B+1)%10==C) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if((j+B)%10==C) {\n              if(j+B>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+B+1)%10) {\n            if((j+B+1)%10==C) {\n              if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if((j+A)%10==C) {\n              if(j+A>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+A+1)%10) {\n            if((j+A+1)%10==C) {\n              if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(i || (A+B)%10) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if(i || (A+B+1)%10) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if((j+k)%10==C) {\n              if(j+k>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+k+1)%10) {\n            if((j+k+1)%10==C) {\n              if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1000000007;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 200010;\n\ntemplate<int_fast64_t MOD> struct modint{\n    using i64=int_fast64_t;\n    i64 a;\n    modint(const i64 a_=0): a(a_){\n        if(a>MOD) a%=MOD;\n        else if(a<0) (a%=MOD)+=MOD;\n    }\n    modint inv(){\n        i64 t=1, n=MOD-2, x=a;\n        while(n){\n            if(n&1) (t*=x)%=MOD;\n            (x*=x)%=MOD;\n            n>>=1;\n        }\n        modint ret(t);\n        return ret;\n    }\n    bool operator==(const modint x) const{return a==x.a;}\n    bool operator!=(const modint x) const{return a!=x.a;}\n    modint operator+(const modint x) const{\n        return modint(*this)+=x;\n    }\n    modint operator-(const modint x) const{\n        return modint(*this)-=x;\n    }\n    modint operator*(const modint x) const{\n        return modint(*this)*=x;\n    }\n    modint operator/(const modint x) const{\n        return modint(*this)/=x;\n    }\n    modint operator^(const lint x) const{\n        return modint(*this)^=x;\n    }\n    modint &operator+=(const modint &x){\n        a+=x.a;\n        if(a>=MOD) a-=MOD;\n        return *this;\n    }\n    modint &operator-=(const modint &x){\n        a-=x.a;\n        if(a<0) a+=MOD;\n        return *this;\n    }\n    modint &operator*=(const modint &x){\n        (a*=x.a)%=MOD;\n        return *this;\n    }\n    modint &operator/=(modint x){\n        (a*=x.inv().a)%=MOD;\n        return *this;\n    }\n    modint &operator^=(lint n){\n        i64 ret=1;\n        while(n){\n            if(n&1) (ret*=a)%=MOD;\n            (a*=a)%=MOD;\n            n>>=1;\n        }\n        a=ret;\n        return *this;\n    }\n    modint operator-() const{\n        return modint(0)-*this;\n    }\n    modint &operator++(){\n        return *this+=1;\n    }\n    modint &operator--(){\n        return *this-=1;\n    }\n    bool operator<(const modint x) const{\n        return a<x.a;\n    }\n};\n\nusing mint=modint<1000000007>;\n\nvector<mint> fact;\nvector<mint> revfact;\n\nvoid setfact(int n){\n    fact.resize(n+1); revfact.resize(n+1);\n    fact[0] = 1;\n    rep(i, n) fact[i+1] = fact[i] * mint(i+1);\n\n    revfact[n] = fact[n].inv();\n    for(int i=n-1; i>=0; i--) revfact[i] = revfact[i+1] * mint(i+1);\n}\n\nmint getC(int n, int r){\n    if(n<r) return 0;\n    return fact[n] * revfact[r] * revfact[n-r];\n}\n\nstring a, b, c;\n\nvoid solve(){\n    int n = a.size();\n    mint dp[n+1][2];\n    dp[0][0] = 1;\n    rep(i, n)rep(j, 2)if(dp[i][j] != 0){\n        rep(x, 10)if((a[i] == '?' || a[i]-'0' == x) && !(i == n-1 && x == 0)){\n            rep(y, 10)if((b[i] == '?' || b[i]-'0' == y) && !(i == n-1 && y == 0)){\n                int z = x + y + j;\n                if((c[i] == '?' || c[i]-'0' == z % 10) && !(i == n-1 && z % 10 == 0)){\n                    dp[i+1][z >= 10] += dp[i][j];\n                }\n            }\n        }\n    }\n    printf(\"%lld\\n\", dp[n][0].a);\n}\n\nint main(){\n    while(cin >> a && a != \"0\"){\n        cin >> b >> c;\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\nbool thr(string s,int num, int idx) {\n\tif (idx != 0) {\n\t\tif (s[idx] == '?' || s[idx] == num + '0') {\n\t\t\treturn true;\n\t\t}\n\t}\n\telse {\n\t\tif ((s[idx] == '?'&&num!=0) || s[idx] == num + '0') {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\nint main() {\n\tstring s1, s2, s3;\n\twhile (cin >> s1, s1 != \"0\") {\n\t\tcin >> s2 >> s3;\n\t\tlong long nc = 1;\n\t\tlong long yc = 0;\n\t\tREP(i, s1.length()) {\n\t\t\tint keta = s1.length() - 1 - i;\n\t\t\tlong long ncnt = 0;\n\t\t\tlong long ycnt = 0;\n\t\t\tREP(j, 10) {\n\t\t\t\tif (thr(s1,j,keta))\n\t\t\t\t\tREP(k, 10) {\n\t\t\t\t\tif (thr(s2, k, keta))\n\t\t\t\t\t\tREP(l, 10) {\n\t\t\t\t\t\tif (thr(s3, l, keta)) {\n\t\t\t\t\t\t\tif ((j + k) % 10 == l)\n\t\t\t\t\t\t\t\tif (j + k < 10)\n\t\t\t\t\t\t\t\t\tncnt += nc;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tycnt += nc;\n\t\t\t\t\t\t\tif ((j + k+1) % 10 == l)\n\t\t\t\t\t\t\t\tif (j + k+1 < 10)\n\t\t\t\t\t\t\t\t\tncnt += yc;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tycnt += yc;\n\t\t\t\t\t\t\tncnt %= 1000000007;\n\t\t\t\t\t\t\tycnt %= 1000000007;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tnc = ncnt;\n\t\t\tyc = ycnt;\n\t\t}\n\t\tcout << nc << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nbool in_range(int a, int b){\n  return a >= 0 && a < b;\n}\n\nint main(){\n  string A;\n  while(cin >> A, A != \"0\"){\n    string B, C;\n    cin >> B >> C;\n    int n = A.length(), mod = 1e9 + 7;\n    vector< vector<long long int> > dp(n, vector<long long int>(2,0));\n    for(int i = n-1; i >= 0; --i){\n      if(C[i] != '?'){\n        int c = C[i] - '0';\n        if(A[i] != '?' && B[i] != '?'){\n          int a = A[i] - '0', b = B[i] - '0';\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(a + b == c){\n            if(i < n-1) dp[i][0] = dp[i+1][0];\n            else dp[i][0] = 1;\n          }else if(i < n-1 && a + b + 1 == c){\n            dp[i][0] = dp[i+1][1];\n          }else if(a + b == 10 + c){\n            if(i < n-1) dp[i][1] = dp[i+1][0];\n            else dp[i][1] = 1;\n          }else if(i < n-1 && a + b + 1 == 10 + c){\n            dp[i][1] = dp[i+1][1];\n          }\n        }else if(A[i] != '?'){//B[i] == '?'\n          int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(b,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              dp[i][0] += 1;\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(b_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }\n            else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(B[i] != '?'){//A[i] == '?'\n          int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n          if(i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(a,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(a_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else{//A[i] == B[i] == '?'\n          for(int a = 0; a < 10; ++a){\n            for(int b = 0; b < 10; ++b){\n              if(i == 0 && (a == 0 || b == 0)) continue;//leading zero\n              if(a + b == c){\n                if(i < n-1){\n                  dp[i][0] += dp[i+1][0];\n                  dp[i][0] %= mod;\n                }else{\n                  ++dp[i][0];\n                  dp[i][0] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c){\n                dp[i][0] += dp[i+1][1];\n                dp[i][0] %= mod;\n              }\n              if(a + b == c + 10){\n                if(i < n-1){\n                  dp[i][1] += dp[i+1][0];\n                  dp[i][1] %= mod;\n                }else{\n                  ++dp[i][1];\n                  dp[i][1] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c + 10){\n                dp[i][1] += dp[i+1][1];\n                dp[i][1] %= mod;\n              }\n            }\n          }\n        }\n      }else{//C[i] == '?'\n        for(int c = 0; c < 10; ++c){\n          if(A[i] != '?' && B[i] != '?'){\n            int a = A[i] - '0', b = B[i] - '0';\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(a + b == c){\n              if(i < n-1) dp[i][0] = dp[i+1][0];\n              else dp[i][0] = 1;\n            }else if(i < n-1 && a + b + 1 == c){\n              dp[i][0] = dp[i+1][1];\n            }else if(a + b == 10 + c){\n              if(i < n-1) dp[i][1] = dp[i+1][0];\n              else dp[i][1] = 1;\n            }else if(i < n-1 && a + b + 1 == 10 + c){\n              dp[i][1] = dp[i+1][1];\n            }\n          }else if(A[i] != '?'){//B[i] == '?'\n            int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(b,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                dp[i][0] += 1;\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(b_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }\n              else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(B[i] != '?'){//A[i] == '?'\n            int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n            if(i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(a,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(a_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else{//A[i] == B[i] == '?'\n            for(int a = 0; a < 10; ++a){\n              for(int b = 0; b < 10; ++b){\n                if(i == 0 && (a == 0 || b == 0)) continue;//leading zero\n                if(a + b == c){\n                  if(i < n-1){\n                    dp[i][0] += dp[i+1][0];\n                    dp[i][0] %= mod;\n                  }else{\n                    ++dp[i][0];\n                    dp[i][0] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c){\n                  dp[i][0] += dp[i+1][1];\n                  dp[i][0] %= mod;\n                }\n                if(a + b == c + 10){\n                  if(i < n-1){\n                    dp[i][1] += dp[i+1][0];\n                    dp[i][1] %= mod;\n                  }else{\n                    ++dp[i][1];\n                    dp[i][1] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c + 10){\n                  dp[i][1] += dp[i+1][1];\n                  dp[i][1] %= mod;\n                }\n              }\n            }\n          } \n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD DEKAI\n#define DEKAI (int)(1e9+7)\n#define rep(i,n) lps(i,0,n)\n#define lp(i,n) lps(i,0,n)\n#define lps(i,j,n) for(int i = j; i < n; i++)\n#define atoi(c) c-'0'\n\nint main(){ \n  string A,B,C;\n  int a,b,c;\n  long long int plus1[55],plus0[55],pl11,pl10,pl01,pl00;\n  while(1){\n    cin>>A;\n    if(A==\"0\") break;\n    cin>>B>>C;\n    for(int i=0;i<55;i++){\n      plus1[i]=plus0[i]=0;\n    }\n    plus1[A.size()]=0;\n    plus0[A.size()]=1;\n    for(int i=A.size()-1;i>=0;i--){\n      pl11=pl10=pl01=pl00=0;\n      for(int j=0;j<=9;j++){\n\tif(A[i]!='?') j=atoi(A[i]);\n\telse if(j==0 && i==0) continue;\n\tfor(int k=0;k<=9;k++){\n\t  if(B[i]!='?') k=atoi(B[i]);\n\t  else if(k==0 && i==0) continue;\n\t  //insert birou\n\t  if(C[i]!='?'){\n\t    if((j+k)>9){\n\t       if((j+k)%10==atoi(C[i])) pl01++;\n\t       if((j+k+1)%10==atoi(C[i])) pl11++;\n\t    }else if((j+k)==9){\n\t      if((j+k+1)%10==atoi(C[i])) pl11++;\n\t      if((j+k)%10==atoi(C[i])) pl00++;\n\t    }else{\n\t      if((j+k+1)%10==atoi(C[i])) pl10++;\n\t      if((j+k)%10==atoi(C[i])) pl00++;\n\t    }\n\t  }else{\n\t    if((j+k)>9){\n\t      pl11++;\n\t      pl01++;\n\t    }else if((j+k)==9){\n\t      pl11++;\n\t      pl00++;\n\t    }else{\n\t      pl10++;\n\t      pl00++;\n\t    }\n\t  }\n\t  //insaato abobu\n\t  if(B[i]!='?') break;\n\t}\n\tif(A[i]!='?') break;\n      }\n      plus1[i]=((pl11*plus1[i+1])%DEKAI+(pl01*plus0[i+1])%DEKAI)%DEKAI;\n      plus0[i]=((pl10*plus1[i+1])%DEKAI+(pl00*plus0[i+1])%DEKAI)%DEKAI;\n    }  \n    cout<<plus0[0]<<endl;\n  }\n  \n  \n  return 0;\n}\n  \n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring A,B,C;\n\n\nint start(const string &A,int p){\n\tif( A.size() <= p ) return 0;\n\tif( A[p] != '?' ) return A[p] - '0';\n\tif( A.size() == p+1 ) return 1;\n\treturn 0;\n}\nint end(const string &A,int p){\n\tif( A.size() <= p ) return 0;\n\tif( A[p] != '?' ) return A[p] - '0';\n\treturn 9;\n}\n\nint dp[52][2];\nint dfs(int p,int carry){\n\tif( dp[p][carry] != -1 ) return dp[p][carry];\n\tif( p == max({A.size(),B.size(),C.size()}) ){\n\t\treturn carry == 0;\n\t}\n\tint ans = 0;\n\tfor(int i = start(A,p) ; i <= end(A,p) ; i++){\n\t\tfor(int j = start(B,p) ; j <= end(B,p) ; j++){\n\t\t\tfor(int k = start(C,p) ; k <= end(C,p) ; k++){\n\t\t\t\tif( (i + j + carry) % 10 == k ){\n\t\t\t\t\tans += dfs(p+1,(i + j + carry) >= 10);\n\t\t\t\t\tif( ans >= 1000000007 )\n\t\t\t\t\t\tans -= 1000000007;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn dp[p][carry] = ans;\n}\nint main(){\n\twhile(cin >> A >> B >> C){\n\t\tmemset(dp,-1,sizeof(dp));\n\t\treverse(A.begin(),A.end());\n\t\treverse(B.begin(),B.end());\n\t\treverse(C.begin(),C.end());\n\t\tcout << dfs(0,0) << endl;\n\t}\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define all(v) (v).begin(),(v).end()\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\n#define pb push_back\n#define fi first\n#define se second\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nconst int mod=1000000007;\nstring A,B,C;\n\nint dp[100][2];\n\ninline void add(int &a,int b){\n    a+=b;\n    if(a>=mod)a-=mod;\n}\nsigned main(){\n    while(cin>>A,A!=\"0\"){\n        cin>>B>>C;\n        reverse(all(A));reverse(all(B));reverse(all(C));\n\n        memset(dp,0,sizeof(dp));\n        dp[0][0]=1;\n        for(int i=0;i<A.size();i++){\n            for(int j=0;j<2;j++){\n                rep(k,10)rep(l,10){\n                    if(i+1==A.size()&&(k==0||l==0))continue;\n                    if(A[i]!='?'&&A[i]-'0'!=k)continue;\n                    if(B[i]!='?'&&B[i]-'0'!=l)continue;\n                    if(C[i]!='?'&&C[i]-'0'!=(k+l+j)%10)continue;\n                    add(dp[i+1][(k+l+j)/10],dp[i][j]);\n                }\n            }\n        }\n        cout<<dp[A.size()][0]<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint mod=1e9+7;\nvoid add(int& x,int y){\n\tx+=y;\n\tif(x>=mod) x-=mod;\n}\nint main(){\n\twhile(true){\n\t\tstring a,b,c;\n\t\tcin>>a;\n\t\tif(a[0]=='0') break;\n\t\tcin>>b>>c;\n\t\tint N=a.size();\n\t\tint x=1,y=0;\t//kuriagari 0, 1\n\t\tfor(int i=N-1;i>=0;i--){\n\t\t\tint nx=0,ny=0;\n\t\t\trep(j,10){\n\t\t\t\tif( (a[i]!='?'&&a[i]!='0'+j) || (i==0&&j==0) ) continue;\n\t\t\t\trep(k,10){\n\t\t\t\t\tif( (b[i]!='?'&&b[i]!='0'+k) || (i==0&&k==0) ) continue;\n\t\t\t\t\t{\n\t\t\t\t\t\tint l=j+k;\n\t\t\t\t\t\tif(c[i]!='?'&&c[i]!='0'+(l%10)) ;\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(l>=10) add(ny,x);\n\t\t\t\t\t\t\telse add(nx,x);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\tint l=j+k+1;\n\t\t\t\t\t\tif(c[i]!='?'&&c[i]!='0'+(l%10)) ;\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(l>=10) add(ny,y);\n\t\t\t\t\t\t\telse add(nx,y);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tx=nx,y=ny;\n\t\t}\n\t\tcout<<x<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntemplate<class T>\nbool chmax(T& a, const T& b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate<class T>\nbool chmin(T& a, const T& b) {\n    if (b < a) { a = b; return true; }\n    return false;\n}\n\n// std::vector Declaration\ntemplate<typename T>\nvector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T, typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a, make_v<T>(ts...));\n}\n\n// std::vector Declaration and Initialization\ntemplate<typename T>\nvector<T> make_vector(size_t a, T x) { return vector<T>(a, x); }\ntemplate<typename T, typename U, typename... Ts>\nauto make_vector(size_t a, U b, Ts... ts) {\n    return vector<decltype(make_vector<T>(b,ts...))>(a, make_vector<T>(b, ts...));\n}\n\n// std::vector Input\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& v) {\n    for (auto &e : v) is >> e;\n    return is;\n}\n\n// std::vector Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::array Debug\ntemplate<typename T, size_t n>\nostream& operator<<(ostream& os, const array<T, n>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::deque Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const deque<T>& d) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : d) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::pair Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const pair<T, U>& p) {\n    os << \"(\" << p.first << \" \" << p.second << \")\";\n    return os;\n}\n\n// std::set Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const set<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::multiset Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const multiset<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::map Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const map<T, U>& mp) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : mp) {\n        os << (a ? \"\" : \" \");\n        os << e.first << \":\" << e.second;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::tuple Debug\ntemplate<int N, class Tuple>\nvoid out(ostream& os, const Tuple& t){}\ntemplate<int N, class Tuple, class H, class ...Ts>\nvoid out(ostream& os, const Tuple& t) {\n    if (N) os << \" \";\n    os << get<N>(t);\n    out<N+1,Tuple,Ts...>(os, t);\n}\ntemplate<class ...Ts>\nostream& operator<<(ostream& os, const tuple<Ts...>& t) {\n    os << \"(\";\n    out<0,tuple<Ts...>,Ts...>(os, t);\n    os << \")\";\n    return os;\n}\n\n// Debug\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n\n// Weighted edge\ntemplate<typename T>\nstruct edge {\n    int src, to;\n    T cost;\n\n    edge() {}\n    edge(int to, T cost) : src(-1), to(to), cost(cost) {}\n    edge(int src, int to, T cost) : src(src), to(to), cost(cost) {}\n\n    friend ostream& operator<<(ostream& os, const edge& e) {\n        return os << \"(\" << e.src << \"->\" << e.to << \":\" << e.cost << \")\";\n    }\n};\n\nusing LL = int64_t;\n\n#define fs first\n#define sc second\n\nconst int64_t MOD = 1e9+7;\n\n\ntemplate<int64_t mod>\nstruct modint {\n    using LL = int64_t;\n    LL val;\n    modint(LL val=0) : val(((val % mod) + mod) % mod) {}\n\n    const modint operator+() const { return *this; }\n    const modint operator-() const { return (-val + mod) % mod; }\n    const modint inv() const { return pow(mod-2); }\n\n    modint& operator+=(const modint& rhs) {\n        (val += rhs.val) %= mod;\n        return *this;\n    }\n    modint& operator-=(const modint& rhs) {\n        return *this += -rhs;\n    }\n    modint& operator*=(const modint& rhs) {\n        (val *= rhs.val) %= mod;\n        return *this;\n    }\n    modint& operator/=(const modint& rhs) {\n        return *this *= rhs.inv();\n    }\n\n    const modint operator+(const modint& rhs) const {\n        return modint(*this) += rhs;\n    }\n    const modint operator-(const modint& rhs) const {\n        return modint(*this) -= rhs;\n    }\n    const modint operator*(const modint& rhs) const {\n        return modint(*this) *= rhs;\n    }\n    const modint operator/(const modint& rhs) const {\n        return modint(*this) /= rhs;\n    }\n\n    const modint pow(LL n) const {\n        modint ret = 1, tmp = val;\n        while (n > 0) {\n            if (n & 1) ret *= tmp;\n            tmp *= tmp; n >>= 1;\n        }\n        return ret;\n    }\n\n    bool operator==(const modint& rhs) const { return val == rhs.val; }\n    bool operator!=(const modint& rhs) const { return !(*this == rhs); }\n\n    friend const modint operator+(const LL& lhs, const modint& rhs) {\n        return modint(lhs) + rhs;\n    }\n    friend const modint operator-(const LL& lhs, const modint& rhs) {\n        return modint(lhs) - rhs;\n    }\n    friend const modint operator*(const LL& lhs, const modint& rhs) {\n        return modint(lhs) * rhs;\n    }\n    friend const modint operator/(const LL& lhs, const modint& rhs) {\n        return modint(lhs) / rhs;\n    }\n\n    friend bool operator==(const LL& lhs, const modint& rhs) {\n        return modint(lhs) == rhs;\n    }\n    friend bool operator!=(const LL& lhs, const modint& rhs) {\n        return modint(lhs) != rhs;\n    }\n\n    friend ostream& operator<<(ostream& os, const modint& a) {\n        return os << a.val;\n    }\n    friend istream& operator>>(istream& is, modint& a) {\n        LL tmp; is >> tmp;\n        a = tmp;\n        return is;\n    }\n};\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    using Int = modint<MOD>;\n\n    while (true) {\n        string A, B, C;\n        cin >> A; if (A == \"0\") break;\n        cin >> B >> C;\n\n        int n = A.size();\n        auto dp = make_v<Int>(2,n+1);\n        dp[0][0] = 1;\n        for (int i = 0; i < n; ++i) {\n            for (int k = 0; k < 2; ++k) {\n                int a = A[n-1-i] == '?',\n                    b = B[n-1-i] == '?',\n                    c = C[n-1-i] == '?';\n                for (int p = 0; p < (a ? 10 : 1); ++p) {\n                    for (int q = 0; q < (b ? 10 : 1); ++q) {\n                        for (int r = 0; r < (c ? 10 : 1); ++r) {\n\n                            int P = (a ? p : A[n-1-i] - '0'),\n                                Q = (b ? q : B[n-1-i] - '0'),\n                                R = (c ? r : C[n-1-i] - '0');\n\n                            int sum = k + P + Q;\n                            if (sum % 10 != R) continue;\n                            if (i == n-1 and (P == 0 or Q == 0 or R == 0))\n                                continue;\n                            dp[sum / 10][i+1] += dp[k][i];\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[0][n] << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nstring A, B, C;\nll dp[51][20];\nconst int MOD = 1000000007;\n\nvoid show() {\n    int N = A.size();\n    for (int i = 0; i <= N; ++i) {\n        for (int j = 0; j < 19; ++j) {\n            printf(\"%d \", dp[i][j]);\n        }\n        cout << endl;\n    }\n    cout << endl;\n}\n\nvoid solve() {\n    int N = A.size();\n    dp[0][0] = 1;\n    for (int i = 0; i <= N; ++i) {\n        char a = A[N - 1 - i];\n        int a_ini = a != '?' ? a - '0' : N - 1 - i == 0 ? 1 : 0;\n        int a_end = a != '?' ? 1 + a_ini : 10;\n        char b = B[N - 1 - i];\n        int b_ini = b != '?' ? b - '0' : N - 1 - i == 0 ? 1 : 0;\n        int b_end = b != '?' ? 1 + b_ini : 10;\n        char c = C[N - 1 - i];\n        int c_ans = c != '?' ? c - '0' : -1;\n\n        for (int l = 0; l <= 19; ++l) {\n            ll past = dp[i][l];\n            if (past == 0)  continue;\n            for (int j = a_ini; j < a_end; ++j) {\n                for (int k = b_ini; k < b_end; ++k) {\n                    int ab = 10 <= l ? 1 + j + k : j + k;\n                    if (c_ans == -1 || ab % 10 == c_ans) {\n                        dp[i+1][ab] += past % MOD;\n                    }\n                }\n            }\n        }\n    }\n    if (C[0] != '?') cout << dp[N][C[0] - '0'] << endl;\n    else {\n        ll sum = 0;\n        for (int i = 1; i < 10; ++i) {\n            sum += dp[N][i] % MOD;\n        }\n        cout << sum % MOD << endl;\n    }\n}\n\nint main() {\n    while(true) {\n        cin >> A;\n        cin >> B;\n        cin >> C;\n        if (A == \"0\") break;\n        memset(dp, 0, sizeof(dp));\n        solve();\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long llint;\nconst llint MOD = 1e9 + 7;\nllint dp[110][2];\n\nint main() {\n  string a, b, c;\n  while (true) {\n    cin >> a;\n    if (a == \"0\") break;\n    cin >> b >> c;\n    reverse(a.begin(), a.end());\n    reverse(b.begin(), b.end());\n    reverse(c.begin(), c.end());\n    for (int i = 0; i < 110; i++) {\n      for (int j = 0; j < 2; j++) {\n        dp[i][j] = 0;\n      }\n    }\n\n    dp[0][0] = 1;\n    for (int i = 0; i < c.size(); i++) {\n      if (c[i] == '?') {\n        if (a[i] == '?') {\n          if (b[i] == '?') {                  // a=?, b=?, c=?\n            for (int p = 0; p <= 9; p++) {    // a\n              for (int q = 0; q <= 9; q++) {  // b\n                if (i + 1 == c.size() && p == 0) continue;\n                if (i + 1 == c.size() && q == 0) continue;\n\n                dp[i + 1][(p + q > 9)] += dp[i][0];\n                dp[i + 1][(p + q + 1 > 9)] += dp[i][1];\n                dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n              }\n            }\n          } else {\n            int q = b[i] - '0';\n            for (int p = 0; p <= 9; p++) {  // a\n              if (i + 1 == c.size() && p == 0) continue;\n              dp[i + 1][(p + q > 9)] += dp[i][0];\n              dp[i + 1][(p + q + 1 > 9)] += dp[i][1];\n              dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n            }\n          }\n        } else {\n          int p = a[i] - '0';\n          if (b[i] == '?') {                // b=?, c=?\n            for (int q = 0; q <= 9; q++) {  // b\n              if (i + 1 == c.size() && q == 0) continue;\n              dp[i + 1][(p + q > 9)] += dp[i][0];\n              dp[i + 1][(p + q + 1 > 9)] += dp[i][1];\n              dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n            }\n          } else {\n            int p = a[i] - '0';\n            int q = b[i] - '0';\n            dp[i + 1][(p + q > 9)] += dp[i][0];\n            dp[i + 1][(p + q + 1 > 9)] += dp[i][1];\n            dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n          }\n        }\n      } else {\n        int num = c[i] - '0';\n        if (a[i] == '?') {\n          if (b[i] == '?') {                  // a=?, b=?\n            for (int p = 0; p <= 9; p++) {    // a\n              for (int q = 0; q <= 9; q++) {  // b\n                if (i + 1 == c.size() && p == 0) continue;\n                if (i + 1 == c.size() && q == 0) continue;\n                if (p + q <= 9) {\n                  if (p + q == num) dp[i + 1][0] += dp[i][0];\n                  if ((p + q + 1) <= 9) {\n                    if (p + q + 1 == num) dp[i + 1][0] += dp[i][1];\n                  } else {\n                    if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n                  }\n                } else {\n                  if ((p + q) % 10 == num) dp[i + 1][1] += dp[i][0];\n                  if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n                }\n                dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n              }\n            }\n          } else {\n            int q = b[i] - '0';\n            for (int p = 0; p <= 9; p++) {  // a\n              if (i + 1 == c.size() && p == 0) continue;\n              if (p + q <= 9) {\n                if (p + q == num) dp[i + 1][0] += dp[i][0];\n                if ((p + q + 1) <= 9) {\n                  if (p + q + 1 == num) dp[i + 1][0] += dp[i][1];\n                } else {\n                  if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n                }\n              } else {\n                if ((p + q) % 10 == num) dp[i + 1][1] += dp[i][0];\n                if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n              }\n              dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n            }\n          }\n        } else {\n          if (b[i] == '?') {\n            int p = a[i] - '0';\n            for (int q = 0; q <= 9; q++) {\n              if (i + 1 == c.size() && q == 0) continue;\n              if (p + q <= 9) {\n                if (p + q == num) dp[i + 1][0] += dp[i][0];\n                if ((p + q + 1) <= 9) {\n                  if (p + q + 1 == num) dp[i + 1][0] += dp[i][1];\n                } else {\n                  if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n                }\n              } else {\n                if ((p + q) % 10 == num) dp[i + 1][1] += dp[i][0];\n                if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n              }\n\n              dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n            }\n\n          } else {\n            int p, q;\n            p = a[i] - '0';\n            q = b[i] - '0';\n            if (p + q <= 9) {\n              if (p + q == num) dp[i + 1][0] += dp[i][0];\n\n              if ((p + q + 1) <= 9) {\n                if (p + q + 1 == num) dp[i + 1][0] += dp[i][1];\n              } else {\n                if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n              }\n            } else {\n              if ((p + q) % 10 == num) dp[i + 1][1] += dp[i][0];\n              if ((p + q + 1) % 10 == num) dp[i + 1][1] += dp[i][1];\n            }\n            dp[i + 1][0] %= MOD, dp[i + 1][1] %= MOD;\n          }\n        }\n      }\n    }\n\n    cout << dp[c.size()][0] << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tint n = B.size();\n\n\t\tll dp[55][2] = { 0 };\n\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tfor(int j = 0; j < 2; j++) {\n\t\t\t\tint q = 0, s = 0, t = 0;\n\t\t\t\tif(A[i] == '?') q++;\n\t\t\t\telse s += A[i] - '0';\n\t\t\t\tif(B[i] == '?') q++;\n\t\t\t\telse s += B[i] - '0';\n\t\t\t\tif(C[i] != '0') t = C[i] - '0';\n\n\t\t\t\tif(q == 2) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tfor(int b = 0; b <= 9; b++) {\n\t\t\t\t\t\t\tif(i == n - 1 && b == 0) continue;\n\t\t\t\t\t\t\tif(i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n\t\t\t\t\t\t\tif((C[i] == '?' || (a + b + j) % 10 == t)) {\n\t\t\t\t\t\t\t\tif(a + b + j >= 10) {\n\t\t\t\t\t\t\t\t\t(dp[i + 1][1] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t(dp[i + 1][0] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(q == 1) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tif((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n\t\t\t\t\t\tif(C[i] == '?' || (s + a + j) % 10 == t) {\n\t\t\t\t\t\t\tif(s + a + j >= 10) {\n\t\t\t\t\t\t\t\t(dp[i + 1][1] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t(dp[i + 1][0] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // q == 0\n\t\t\t\t\tif((i == n - 1 && (s + j) % 10 == 0)) continue;\n\t\t\t\t\tif(C[i] == '?' || (s + j) % 10 == t) {\n\t\t\t\t\t\tif((s + j) >= 10) {\n\t\t\t\t\t\t\t(dp[i + 1][1] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t(dp[i + 1][0] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}// for j\n\t\t}// for i\n\t\tcout << dp[n][0] << endl;\n\t}// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <cstdlib>\n#include <algorithm>\n#include <set>\n#include <map>\n#define llint long long\n#define mod 1000000007\n\nusing namespace std;\ntypedef pair<llint, llint> P;\n\nstring s, t, u;\nllint dp[55][3];\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> s;\n\t\tif(s == \"0\") break;\n\t\tcin >> t >> u;\n\t\tllint n = s.size();\n\t\t\n\t\treverse(s.begin(), s.end());\n\t\treverse(t.begin(), t.end());\n\t\treverse(u.begin(), u.end());\n\t\t\n\t\tfor(int i = 0; i <= n; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tdp[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 1;\n\t\t\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tfor(int j = 0; j < 10; j++){\n\t\t\t\tif(s[i] != '?' && s[i]-'0' != j) continue;\n\t\t\t\tif(i == n-1 && j == 0) continue;\n\t\t\t\tfor(int k = 0; k < 10; k++){\n\t\t\t\t\tif(t[i] != '?' && t[i]-'0' != k) continue;\n\t\t\t\t\tif(i == n-1 && k == 0) continue;\n\t\t\t\t\tfor(int l = 0; l < 10; l++){\n\t\t\t\t\t\tif(u[i] != '?' && u[i]-'0' != l) continue;\n\t\t\t\t\t\tif(i == n-1 && l == 0) continue;\n\t\t\t\t\t\tfor(int m = 0; m < 3; m++){\n\t\t\t\t\t\t\tllint c = (j+k+m)/10, d = (j+k+m)%10;\n\t\t\t\t\t\t\tif(d != l) continue;\n\t\t\t\t\t\t\t(dp[i+1][c] += dp[i][m]) %= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t/*for(int i = 0; i <= n; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tcout << dp[i][j] << \" \";\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}*/\n\t\tcout << dp[n][0] << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <utility>\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdlib>\n\nusing namespace std;\n\n#define ALL(c) c.begin(),c.end()\n#define RALL(c) c.rbegin(),c.rend()\n#define SORT(x) sort((x).begin(),(x).end())\n#define REP(i,x,y) for(int i=(x);i<(y);++i)\n#define MP(a,b) make_pair((a),(b))\n#define debug(x) #x << \"=\" << (x)\n \n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define dump(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define dump(x)\n#endif\n\ntypedef long long int ll;\ntypedef pair<int,int> pii;\n//template<typename T> using vec=std::vector<T>;\n\nconst int INF=1<<30;\nconst long long int INF_=1LL<<58;\nconst double EPS=1e-9;\nconst int dx[]={1,0,-1,0},dy[]={0,1,0,-1};\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n\tos << \"[\";\n\tfor (const auto &v : vec) {\n\t\tos << v << \",\";\n\t}\n\tos << \"]\";\n\treturn os;\n}\n\nconst int mod=1000000007;\nstring A,B,C;\nll memo[50][2];\n\nll DFS(int dig,int carry){\n\tif(dig==-1) return carry==0;\n\t\n\tll &res=memo[dig][carry];\n\tif(res!=-1) return res;\n\tres=0;\n\tREP(a,0,10) REP(b,0,10){\n\t\tif(A[dig]!='?'&&A[dig]!='0'+a) continue;\n\t\tif(B[dig]!='?'&&B[dig]!='0'+b) continue;\n\t\tif(dig==0&&(a==0||b==0)) continue;\n\n\t\tint c=(a+b+carry)%10,d=(a+b+carry)/10;\n\t\tif(C[dig]!='?'&&C[dig]!='0'+c) continue;\n\n\t\tres+=DFS(dig-1,d);\n\t\tres%=mod;\n\t}\n\t\n\treturn res;\n}\n\nvoid Solve(){\n\twhile(true){\n\t\tcin >> A; if(A[0]=='0') break;\n\t\tcin >> B >> C;\n\n\t\tfill_n((ll*)memo,50*2,-1);\n\t\tcout << DFS(A.size()-1,0) << endl;\n\t}\n}\n\nint main(){\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\tSolve();\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\n\nconst int mod = 1e9 + 7;\nstring A, B, C;\nint dp[51][2][10][10];\n\nbool f(string s, int i, int x) {\n  return s[i] == '?' || (s[i] - '0') == x;\n}\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  \n  while (cin >> A >> B >> C, A != \"0\") {\n    fill_n((int*)dp, 51 * 2 * 10 * 10, 0);\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    int n = A.size();\n    dp[0][0][0][0] = 1;\n    for (int d = 0; d < n; d++) {\n      for (int c = 0; c < 2; c++) {\n        for (int a = 0; a < 10; a++) {\n          for (int b = 0; b < 10; b++) {\n            if (!dp[d][c][a][b]) continue;\n            for (int i = 0; i < 10; i++) {\n              for (int j = 0; j < 10; j++) {\n                if (!(f(A, d, i) && f(B, d, j))) continue;\n                int carry = c + a + b > 9;\n                if (C[d] != '?' && (i + j + carry) % 10 != (C[d] - '0')) continue;\n                (dp[d + 1][carry][i][j] += dp[d][c][a][b]) %= mod;\n              }\n            }\n          }\n        }\n      }\n    }\n    int ans = 0;\n    for (int c = 0; c < 2; c++) {\n      for (int a = 1; a < 10; a++) {\n        for (int b = 1; b < 10; b++) {\n          if (c + a + b > 9) continue;\n          (ans += dp[n][c][a][b]) %= mod;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\n\n\n\nconst int mod = 1000000007;\nstruct Mod {\npublic:\n\tint num;\n\tMod() : num(0) { ; }\n\tMod(long long int n) : num((n % mod + mod) % mod) { ; }\n\tMod(int n) : num((n % mod + mod) % mod) { ; }\n\toperator int() { return num; }\n};\n\nMod operator+(const Mod a, const Mod b) { return Mod((a.num + b.num) % mod); }\nMod operator+(const long long int a, const Mod b) { return Mod(a) + b; }\nMod operator++(Mod &a) { return a + Mod(1); }\nMod operator-(const Mod a, const Mod b) { return Mod((mod + a.num - b.num) % mod); }\nMod operator-(const long long int a, const Mod b) { return Mod(a) - b; }\nMod operator--(Mod &a) { return a - Mod(1); }\nMod operator*(const Mod a, const Mod b) { return Mod(((long long)a.num * b.num) % mod); }\nMod operator*(const long long int a, const Mod b) { return Mod(a)*b; }\nMod operator+=(Mod &a, const Mod b) { return a = a + b; }\nMod operator+=(long long int &a, const Mod b) { return a = a + b; }\nMod operator-=(Mod &a, const Mod b) { return a = a - b; }\nMod operator-=(long long int &a, const Mod b) { return a = a - b; }\nMod operator*=(Mod &a, const Mod b) { return a = a * b; }\nMod operator*=(long long int &a, const Mod b) { return a = a * b; }\nMod operator^(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = (a * a) ^ (n / 2);\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod mod_pow(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = mod_pow((a * a), (n / 2));\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod inv(const Mod a) { return a ^ (mod - 2); }\nMod operator/(const Mod a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a * inv(b);\n}\nMod operator/(const long long int a, const Mod b) {\n\tassert(b.num != 0);\n\treturn Mod(a) * inv(b);\n}\nMod operator/=(Mod &a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a = a * inv(b);\n}\n\n#define MAX_MOD_N 1024000\n\nMod fact[MAX_MOD_N], factinv[MAX_MOD_N];\nvoid init() {\n\tfact[0] = Mod(1); factinv[0] = 1;\n\tfor (int i = 0; i < MAX_MOD_N - 1; ++i) {\n\t\tfact[i + 1] = fact[i] * Mod(i + 1);\n\t\tfactinv[i + 1] = factinv[i] / Mod(i + 1);\n\t}\n}\nMod comb(const int a, const int b) {\n\treturn fact[a] * factinv[b] * factinv[a - b];\n}\n\nint main() {\n\twhile (1) {\n\t\tstring st[3]; cin >> st[0];\n\t\tif (st[0] == \"0\")break;\n\t\tcin>> st[1] >> st[2];\n\t\tMod dp[51][10];\n\t\tdp[st[0].size()][0] = 1;\n\t\tfor (int i = st[0].size()-1; i > 0; --i) {\n\t\t\tchar a, b, c; a = st[0][i];\n\t\t\tb = st[1][i]; c = st[2][i];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 0; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 0; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 0; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10==z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\n\t\t\t\t\t\t\t\tdp[i][amari] += dp[i+1][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tMod ans = 0;\n\t\t{\n\t\t\tchar a, b, c; a = st[0][0];\n\t\t\tb = st[1][0]; c = st[2][0];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 1; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 1; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 1; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10 == z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\n\t\t\t\t\t\t\t\tans += dp[0][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tcout << ans << endl;\n\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//Name: Restore Calculation\n//Level: 3\n//Category: 動的計画法,DP\n//Note: \n\n/**\n * dp[i][j] = i桁目以降のパターン数(i桁目はi-1桁目にj繰り上げる)\n * とすると、\n *   dp[i][0] = (和が9以下になる組み合わせ) × dp[i+1][0] + (和が8以下になる組み合わせ) × dp[i+1][1]\n *   dp[i][1] = (和が10以上になる組み合わせ) × dp[i+1][0] + (和が9以上になる組み合わせ) × dp[i+1][1]\n * で計算できる。\n * 既存の文字と整合性が取れるものだけを採用するように注意。\n *\n * オーダーは O(|S| D^2)。\n * ただしDは数字の種類数で、D = 10。\n */\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\nconst long long MOD = 1000000007;\nbool solve(bool first) {\n    string s1, s2, sum;\n    if(!(cin >> s1 >> s2 >> sum)) return false;\n    if(s1 == \"0\") return false;\n\n    const int S = s1.size();\n    vector<vector<long long>> dp(S+1, vector<long long>(2, 0));\n    dp[S][0] = 1;\n    for(int i = S-1; i >= 0; --i) {\n        for(int a = (i==0); a <= 9; ++a) {\n            if(s1[i] != '?' && s1[i] != a+'0') continue;\n            for(int b = (i==0); b <= 9; ++b) {\n                if(s2[i] != '?' && s2[i] != b+'0') continue;\n                const int s = (a + b) % 10;\n\n                if(a+b <= 9) {\n                    if(sum[i] == '?' || sum[i] == s+'0') {\n                        dp[i][0] += dp[i+1][0];\n                    }\n                }\n                if(a+b <= 8) {\n                    if(sum[i] == '?' || sum[i] == s+1+'0') {\n                        dp[i][0] += dp[i+1][1];\n                    }\n                }\n                if(a+b >= 10) {\n                    if(sum[i] == '?' || sum[i] == s+'0') {\n                        dp[i][1] += dp[i+1][0];\n                    }\n                }\n                if(a+b >= 9) {\n                    if(sum[i] == '?' || sum[i] == (s+1)%10+'0') {\n                        dp[i][1] += dp[i+1][1];\n                    }\n                }\n                dp[i][0] %= MOD;\n                dp[i][1] %= MOD;\n            }\n        }\n    }\n    cout << dp[0][0] << endl;\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n\n    bool first = true;\n    while(solve(first)) {\n        first = false;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nstring A,B,C;\nint dp[100][2];\n\nint main() {\n  while( cin >> A, A != \"0\" ) {\n    cin >> B >> C;\n    reverse(A.begin(),A.end());\n    reverse(B.begin(),B.end());\n    reverse(C.begin(),C.end());\n    memset(dp,0,sizeof dp);\n    dp[0][0] = 1;\n    int n = (int)A.size();\n    rep(i,n) {\n      rep(carry,2) {\n        rep(c,10) {\n          if( C[i] != '?' && c != (C[i]-'0') ) continue;\n          if( i == n-1 && c == 0 ) continue;\n          rep(a,10) {\n            if( A[i] != '?' && a != (A[i]-'0') ) continue;\n            if( i == n-1 && a == 0 ) continue;\n            rep(b,10) {\n              if( B[i] != '?' && b != (B[i]-'0') ) continue;\n              if( i == n-1 && b == 0 ) continue;\n              if( ( a + b + carry ) % 10 != c ) continue;\n              int next_carry = ( a + b + carry >= 10 );\n              ( dp[i+1][next_carry] += dp[i][carry] ) %= MOD;\n            }\n          }\n        }\n      }\n    }\n    cout << dp[n][0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<int,string> tp;\n//typedef vector<tp> vt;\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nconst int inf=1e9;\nconst ll INF=2e18;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nstring a,b,c;\nll MOD=1000000007;\nint main(){\n\twhile(cin>>a,a!=\"0\"){\n\t\tcin>>b>>c;\n\t\tll now[2]={1,0};\n\t\tfor(int q=a.size()-1;q>=0;q--){\n\t\t\tll next[2]={0,0};\n\t\t\trep(i,10)rep(j,10)rep(k,10)rep(l,2){\n\t\t\t\tif(a[q]!='?'&&a[q]-'0'!=i)continue;\n\t\t\t\tif(b[q]!='?'&&b[q]-'0'!=j)continue;\n\t\t\t\tif(c[q]!='?'&&c[q]-'0'!=k)continue;\n\t\t\t\tif(!(q||i&&j&&k))continue;\n\t\t\t\tif((i+j+l)%10==k){\n\t\t\t\t\tif(i+j+l>=10)(next[1]+=now[l])%=MOD;\n\t\t\t\t\telse (next[0]+=now[l])%=MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnow[0]=next[0];\n\t\t\tnow[1]=next[1];\n//\t\t\tcout<<now[0]<<\" \"<<now[1]<<endl;\n\t\t}\n\t\tcout<<now[0]<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int mod = 1e9 + 7;\n\nstring A, B, C;\nint dp[51][2];\n\nint rec(int idx, bool up)\n{\n  if(idx == -1) return(!up);\n  if(~dp[idx][up]) return(dp[idx][up]);\n  int ret = 0;\n  for(int i = idx == 0; i <= 9; i++) {\n    if(A[idx] == i || A[idx] == '?') {\n      for(int j = idx == 0; j <= 9; j++) {\n        if(B[idx] == j || B[idx] == '?') {\n          if((idx != 0 || (i + j + up) % 10 != 0) && (C[idx] == (i + j + up) % 10 || C[idx] == '?')) {\n            (ret += rec(idx - 1, (i + j + up) >= 10)) %= mod;  \n          }\n        }\n      }\n    }\n  }\n  return(dp[idx][up] = ret);  \n}\n\nint main()\n{\n  while(cin >> A, A != \"0\") {\n    cin >> B;\n    cin >> C;\n    for(int i = 0; i < A.size(); i++) if(isdigit(A[i])) A[i] -= '0';\n    for(int i = 0; i < B.size(); i++) if(isdigit(B[i])) B[i] -= '0';\n    for(int i = 0; i < C.size(); i++) if(isdigit(C[i])) C[i] -= '0';\n    memset(dp, -1, sizeof(dp));\n    cout << rec(A.size() - 1, 0) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nint main()\n{\n\tchar A[64], B[64], C[64];\n\n\twhile (scanf(\"%s\", A) && A[0] != '0'){\n\t\tscanf(\"%s\", B);\n\t\tscanf(\"%s\", C);\n\n\t\tint dp[64][10][10][2];\n\t\tmemset(dp, 0, sizeof(dp));\n\n\t\tint L = strlen(A);\n\n\t\tfor (int i = (L == 1); i <= 9; i++){\n\t\t\tfor (int j = (L == 1); j <= 9; j++){\n\t\t\t\tif ((A[L - 1] == '?' || A[L - 1] == i + '0') &&\n\t\t\t\t\t(B[L - 1] == '?' || B[L - 1] == j + '0') &&\n\t\t\t\t\t(C[L - 1] == '?' || C[L - 1] == ((i + j) % 10) + '0')){\n\t\t\t\t\t\tdp[L - 1][i][j][0] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (int d = L - 2; d >= 0; d--){\n\t\t\tfor (int i = (d == 0); i <= 9; i++){\n\t\t\t\tfor (int j = (d == 0); j <= 9; j++){\n\t\t\t\t\tif ((A[d] == '?' || A[d] == i + '0') &&\n\t\t\t\t\t\t(B[d] == '?' || B[d] == j + '0')){\n\t\t\t\t\t\tfor (int k = 0; k <= 9; k++){\n\t\t\t\t\t\t\tfor (int l = 0; l <= 9; l++){\n\t\t\t\t\t\t\t\tif (C[d] == '?' || C[d] - '0' == (i + j + (k + l) / 10) % 10){\n\t\t\t\t\t\t\t\t\tdp[d][i][j][(k + l) / 10] = (dp[d][i][j][(k + l) / 10] + dp[d + 1][k][l][0]) % MOD;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (C[d] == '?' || C[d] - '0' == (i + j + (k + l + 1) / 10) % 10){\n\t\t\t\t\t\t\t\t\tdp[d][i][j][(k + l + 1) / 10] = (dp[d][i][j][(k + l + 1) / 10] + dp[d + 1][k][l][1]) % MOD;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tfor (int i = 0; i <= 9; i++){\n\t\t\tfor (int j = 0; i + j <= 9; j++){\n\t\t\t\tans = (ans + dp[0][i][j][0]) % MOD;\n\t\t\t\tif (i + j + 1 <= 9) ans = (ans + dp[0][i][j][1]) % MOD;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nconst lint MOD = 1e9 + 7;\n\nvector<int> rec(int K, bool head, bool third) {\n    if (K == 0) return {0};\n\n    auto res = rec(K - 1, head, false);\n    vector<int> ret;\n\n    // head -> 1 ~ 9 (A, B) or 0 ~ 8 (C)\n    for (int d = head && !third; d <= 9 - (head && third); ++d) {\n        for (auto i : res) {\n            ret.push_back(i + d);\n        }\n    }\n    return ret;\n}\n\nbool solve() {\n    string A[3];\n    for (int i = 0; i < 3; ++i) {\n        cin >> A[i];\n        if (i == 0 && A[i] == \"0\") return false;\n    }\n\n    for (char& c : A[2]) {\n        if (c != '?') c = '9' - c + '0';\n    }\n    int N = A[0].length();\n\n    vector<vector<lint>> dp(N + 1, vector<lint>(3, 0));\n    dp[0][0] = 1;\n    for (int n = 1; n <= N; ++n) {\n        int h = 0, num = 0;\n        bool third = false;\n\n        for (int i = 0; i < 3; ++i) {\n            char c = A[i][n - 1];\n            if (c == '?') {\n                ++h;\n                if (i == 2) third = true;\n            } else {\n                num += c - '0';\n            }\n        }\n\n        auto pos = rec(h, n == 1, third);\n\n        for (auto p : pos) {\n            for (int d = 0; d < 3; ++d) {\n                int sum = p + d + num;\n                if ((sum % 10) != 9) continue;\n                \n                int r = sum / 10;\n                (dp[n][d] += dp[n - 1][r]) %= MOD;\n            }\n        }\n    }\n\n    cout << dp[N][0] << endl;\n    return true;\n}\n\nint main() {\n    while (solve()){}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=55,INF=1<<30;\nll dp[MAX][2];\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        string A,B,C;cin>>A>>B>>C;\n        if(A==\"0\") break;\n        int N=A.size();\n        memset(dp,0,sizeof(dp));\n        dp[N][0]=1;\n        \n        for(int i=N-1;i>=0;i--){\n            for(int k=0;k<2;k++){\n                for(int a=0;a<10;a++){\n                    for(int b=0;b<10;b++){\n                        for(int c=0;c<10;c++){\n                            if(A[i]!='?'&&int(A[i]-'0')!=a) continue;\n                            if(B[i]!='?'&&int(B[i]-'0')!=b) continue;\n                            if(C[i]!='?'&&int(C[i]-'0')!=c) continue;\n                            \n                            if(i==0){\n                                if(a==0||b==0||c==0) continue;\n                            }\n                            \n                            if((a+b+k)%10==c){\n                                dp[i][(a+b+k-c)/10]+=dp[i+1][k];\n                                dp[i][(a+b+k-c)/10]%=mod;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        \n        cout<<dp[0][0]<<endl;\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define CALL(a,b,carry,c) // cerr << \"i=\" << i << \" a=\" << a << \" b=\" << b << \" carry=\" << carry << \" c=\" << c << endl\nconst int MOD = (int)1000000007;\nstring A, B, C;\nint NA, NB, NC;\nint dp[51][2];\nint solve(int i, int carry) {\n  if(i >= max({NA, NB, NC})) return carry == 0 ? 1 : 0;\n  int &ret = dp[i][carry];\n  if(ret != -1) return ret;\n  ret = 0;\n  int a, b;\n  if(i < NC && C[i] == '?') {\n    if (i >= NA) {\n      a = 0;\n      if(i >= NB) {\n        b = 0;\n        CALL(a,b,carry,'?');\n        ret += solve(i + 1, (a + b + carry) / 10);\n        ret %= MOD;\n      }\n      else if(B[i] != '?') {\n        b = B[i] - '0';\n        CALL(a,b,carry,'?');\n        ret += solve(i + 1, (a + b + carry) / 10);\n      }\n      else {\n        int bstart = (i == NB - 1) ? 1 : 0;\n        for(b = bstart; b <= 9; ++b) {\n          CALL(a,b,carry,'?');\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n    }\n    else if(A[i] != '?') {\n      a = A[i] - '0';\n      if(i >= NB) {\n        b = 0;\n        CALL(a,b,carry,'?');\n        ret += solve(i + 1, (a + b + carry) / 10);\n        ret %= MOD;\n      }\n      else if(B[i] != '?') {\n        b = B[i] - '0';\n        CALL(a,b,carry,'?');\n        ret += solve(i + 1, (a + b + carry) / 10);\n        ret %= MOD;\n      }\n      else {\n        int bstart = (i == NB - 1) ? 1 : 0;\n        for(b = bstart; b <= 9; ++b) {\n          CALL(a,b,carry,'?');\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n    }\n    else {\n      int astart = (i == NB - 1) ? 1 : 0;\n      for(a = astart; a <= 9; ++a) {\n        if(i >= NB) {\n          b = 0;\n          CALL(a,b,carry,'?');\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n        else if(B[i] != '?') {\n          b = B[i] - '0';\n          CALL(a,b,carry,'?');\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n        else {\n          int bstart = (i == NB - 1) ? 1 : 0;\n          for(b = bstart; b <= 9; ++b) {\n            CALL(a,b,carry,'?');\n            ret += solve(i + 1, (a + b + carry) / 10);\n            ret %= MOD;\n          }\n        }\n      }\n    }\n  }\n  else {\n    int c = (i >= NC) ? 0 : C[i] - '0';\n    if (i >= NA) {\n      a = 0;\n      if(i >= NB) {\n        b = 0;\n        if((a + b + carry) % 10 == c) {\n          CALL(a,b,carry,c);\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n      else if(B[i] != '?') {\n        b = B[i] - '0';\n        if((a + b + carry) % 10 == c) {\n          CALL(a,b,carry,c);\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n      else {\n        int bstart = (i == NB - 1) ? 1 : 0;\n        for(b = bstart; b <= 9; ++b) {\n          if((a + b + carry) % 10 == c) {\n            CALL(a,b,carry,c);\n            ret += solve(i + 1, (a + b + carry) / 10);\n            ret %= MOD;\n          }\n        }\n      }\n    }\n    else if(A[i] != '?') {\n      a = A[i] - '0';\n      if(i >= NB) {\n        b = 0;\n        if((a + b + carry) % 10 == c) {\n          CALL(a,b,carry,c);\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n      else if(B[i] != '?') {\n        b = B[i] - '0';\n        if((a + b + carry) % 10 == c) {\n          CALL(a,b,carry,c);\n          ret += solve(i + 1, (a + b + carry) / 10);\n          ret %= MOD;\n        }\n      }\n      else {\n        int bstart = (i == NB - 1) ? 1 : 0;\n        for(b = bstart; b <= 9; ++b) {\n          if((a + b + carry) % 10 == c) {\n            CALL(a,b,carry,c);\n            ret += solve(i + 1, (a + b + carry) / 10);\n            ret %= MOD;\n          }\n        }\n      }\n    }\n    else {\n      int astart = (i == NB - 1) ? 1 : 0;\n      for(a = astart; a <= 9; ++a) {\n        if(i >= NB) {\n          b = 0;\n          if((a + b + carry) % 10 == c) {\n            CALL(a,b,carry,c);\n            ret += solve(i + 1, (a + b + carry) / 10);\n            ret %= MOD;\n          }\n        }\n        else if(B[i] != '?') {\n          b = B[i] - '0';\n          if((a + b + carry) % 10 == c) {\n            CALL(a,b,carry,c);\n            ret += solve(i + 1, (a + b + carry) / 10);\n            ret %= MOD;\n          }\n        }\n        else {\n          int bstart = (i == NB - 1) ? 1 : 0;\n          for(b = bstart; b <= 9; ++b) {\n            if((a + b + carry) % 10 == c) {\n              CALL(a,b,carry,c);\n              ret += solve(i + 1, (a + b + carry) / 10);\n              ret %= MOD;\n            }\n          }\n        }\n      }\n    }\n  }\n  return ret;\n}\nsigned main() {\n  while(true) {\n    cin >> A;\n    if(A == \"0\") break;\n    cin >> B >> C;\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    NA = A.size(), NB = B.size(), NC = C.size();\n    memset(dp, -1, sizeof(dp));\n    cout << solve(0, 0) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if(A+B==C) {\n          dp[i][0] += dp[i+1][0];\n        } else if((A+B)%10==C) {\n          dp[i][1] += dp[i+1][0];\n        }\n        if(A+B+1==C) {\n          dp[i][0] += dp[i+1][1];\n        } else if((A+B+1)%10==C) {\n          dp[i][1] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        if(i!=0 && C>=B) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=B+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>B+1) dp[i][0] += dp[i+1][1];\n        if(C<=(B+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=B) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i!=0 && C>=A) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>A) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=A+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>A+1) dp[i][0] += dp[i+1][1];\n        if(C<=(A+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=A) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(i!=0 && A+B>=10) dp[i][1] += dp[i+1][0];\n        if(i==0 && A+B>10) dp[i][1] += dp[i+1][0];\n        if(i!=0 && A+B<10) dp[i][0] += dp[i+1][0];\n        if(i==0 && A+B<10 && A+B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && A+B+1>=10) dp[i][1] += dp[i+1][1];\n        if(i==0 && A+B+1>10) dp[i][1] += dp[i+1][1];\n        if(i!=0 && A+B+1<10) dp[i][0] += dp[i+1][1];\n        if(i==0 && A+B+1<10 && A+B+1) dp[i][0] += dp[i+1][1];\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i) dp[i][0] += dp[i+1][0]*(C+1);\n        else dp[i][0] += dp[i+1][0]*C;\n        if(i) dp[i][0] += dp[i+1][1]*C;\n        else dp[i][0] += dp[i+1][1]*max(0LL, C-1);\n        dp[i][1] += dp[i+1][0]*(9-C);\n        if(i==0 && C==0) dp[i][1] += dp[i+1][1]*9;\n        else dp[i][1] += dp[i+1][1]*(10-C);\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define MOD 1000000007\ntypedef long long ll;\n \nstring A,B,C;\n \nvoid reverse(){\n    reverse(A.begin(),A.end());\n    reverse(B.begin(),B.end());\n    reverse(C.begin(),C.end());\n}\n \nint main(){\n    while(cin >> A, A != \"0\"){\n\tcin >> B >> C;\n\treverse();\n\tint size = A.size();\n\tll dp[51][2];\n\tmemset(dp,0,sizeof(dp));\n\tdp[0][0] = 1;\n\tfor(int p = 0 ; p < size ; p++){\n\t    for(int i = 0 ; i < 10 ; i++){\n\t\tif(A[p] != '?' && (A[p]-'0') != i){\n\t\t    continue;\n\t\t}\n\t\tif(p == size-1 && i == 0) continue;\n\t\tfor(int j = 0 ; j < 10 ; j++){\n\t\t    if(B[p] != '?' && (B[p]-'0') != j){\n\t\t\tcontinue;\n\t\t    }\n\t\t    if(p == size-1 && j == 0) continue;\n\t\t    for(int k = 0 ; k < 2 ; k++){\n\t\t\tint l = (i + j + k) % 10;\n\t\t\tint nk = (i + j + k >= 10);\n\t\t\tif(C[p] != '?' && (C[p]-'0') != l){\n\t\t\t    continue;\n\t\t\t}\n\t\t\tdp[p+1][nk] += dp[p][k];\n\t\t\tdp[p+1][nk] %= MOD;\n\t\t    }\n\t\t}\n\t    }\n\t}\n\tcout << dp[size][0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// >>> TEMPLATES\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing i32 = int32_t;\nusing i64 = int64_t;\nusing u32 = uint32_t;\nusing u64 = uint64_t;\n#define int ll\n#define double ld\n#define rep(i,n) for (int i = 0; i < (int)(n); i++)\n#define rep1(i,n) for (int i = 1; i <= (int)(n); i++)\n#define repR(i,n) for (int i = (int)(n)-1; i >= 0; i--)\n#define rep1R(i,n) for (int i = (int)(n); i >= 1; i--)\n#define loop(i,a,B) for (int i = a; i B; i++)\n#define loopR(i,a,B) for (int i = a; i B; i--)\n#define all(x) (x).begin(), (x).end()\n#define allR(x) (x).rbegin(), (x).rend()\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fst first\n#define snd second\ntemplate <class Int> auto constexpr inf = numeric_limits<Int>::max()/2-1;\nauto constexpr INF32 = inf<int32_t>;\nauto constexpr INF64 = inf<int64_t>;\nauto constexpr INF   = inf<int>;\n#ifdef LOCAL\n#include \"debug.hpp\"\n#else\n#define dump(...) (void)(0)\n#define say(x) (void)(0)\n#define debug if (0)\n#endif\ntemplate <class T> using pque_max = priority_queue<T>;\ntemplate <class T> using pque_min = priority_queue<T, vector<T>, greater<T> >;\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nostream& operator<<(ostream& os, T const& v) { bool f = true; for (auto const& x : v) os << (f ? \"\" : \" \") << x, f = false; return os; }\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nistream& operator>>(istream& is, T &v) { for (auto& x : v) is >> x; return is; }\ntemplate <class T, class S> ostream& operator<<(ostream& os, pair<T,S> const& p) { return os << \"(\" << p.first << \", \" << p.second << \")\"; }\ntemplate <class T, class S> istream& operator>>(istream& is, pair<T,S>& p) { return is >> p.first >> p.second; }\nstruct IOSetup { IOSetup() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(15); } } iosetup;\ntemplate <class F> struct FixPoint : private F {\n    constexpr FixPoint(F&& f) : F(forward<F>(f)) {}\n    template <class... T> constexpr auto operator()(T&&... x) const { return F::operator()(*this, forward<T>(x)...); }\n};\nstruct MakeFixPoint {\n    template <class F> constexpr auto operator|(F&& f) const { return FixPoint<F>(forward<F>(f)); }\n};\n#define MFP MakeFixPoint()|\n#define def(name, ...) auto name = MFP [&](auto &&name, __VA_ARGS__)\ntemplate <class T, size_t d> struct vec_impl {\n    using type = vector<typename vec_impl<T,d-1>::type>;\n    template <class... U> static type make_v(size_t n, U&&... x) { return type(n, vec_impl<T,d-1>::make_v(forward<U>(x)...)); }\n};\ntemplate <class T> struct vec_impl<T,0> { using type = T; static type make_v(T const& x = {}) { return x; } };\ntemplate <class T, size_t d = 1> using vec = typename vec_impl<T,d>::type;\ntemplate <class T, size_t d = 1, class... Args> auto make_v(Args&&... args) { return vec_impl<T,d>::make_v(forward<Args>(args)...); }\ntemplate <class T> void quit(T const& x) { cout << x << endl; exit(0); }\ntemplate <class T, class U> constexpr bool chmin(T& x, U const& y) { if (x > y) { x = y; return true; } return false; }\ntemplate <class T, class U> constexpr bool chmax(T& x, U const& y) { if (x < y) { x = y; return true; } return false; }\ntemplate <class It> constexpr auto sumof(It b, It e) { return accumulate(b,e,typename iterator_traits<It>::value_type{}); }\ntemplate <class T> int sz(T const& x) { return x.size(); }\ntemplate <class C, class T> int lbd(C const& v, T const& x) {\n    return lower_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class T> int ubd(C const& v, T const& x) {\n    return upper_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class F> int ppt(C const& v, F f) {\n    return partition_point(v.begin(), v.end(), f)-v.begin();\n}\n// <<<\n// >>> modint\ntemplate <int32_t md>\nclass modint {\n    static_assert(md > 0, \"\");\n    using M = modint;\n    using ll = int64_t;\n    int32_t x;\npublic:\n    static constexpr int32_t mod = md;\n    constexpr modint(ll x = 0) : x((x%=mod) < 0 ? x+mod : x) { }\n    constexpr ll val() const { return x; }\n    constexpr explicit operator ll() const { return x; }\n    constexpr bool operator==(M const& r) const { return x == r.x; }\n    constexpr bool operator!=(M const& r) const { return x != r.x; }\n    constexpr M operator+() const { return *this; }\n    constexpr M operator-() const { return M()-*this; }\n    constexpr M& operator+=(M const& r) { ll t = ll(x) + r.x; if (t >= mod) t -= mod; x = t; return *this; }\n    constexpr M& operator-=(M const& r) { ll t = ll(x) + mod-r.x; if (t >= mod) t -= mod; x = t; return *this; }\n    constexpr M& operator*=(M const& r) { return *this = *this * r; }\n    constexpr M operator*(M const& r) const { M t; t.x = (ll(x)*r.x) % mod; return t; }\n    constexpr M& operator/=(M const& r) { return *this *= r.inv(); }\n    constexpr M operator+(M const& r) const { return M(*this) += r; }\n    constexpr M operator-(M const& r) const { return M(*this) -= r; }\n    constexpr M operator/(M const& r) const { return M(*this) /= r; }\n    friend constexpr M operator+(ll x, M const& y) { return M(x)+y; }\n    friend constexpr M operator-(ll x, M const& y) { return M(x)-y; }\n    friend constexpr M operator*(ll x, M const& y) { return M(x)*y; }\n    friend constexpr M operator/(ll x, M const& y) { return M(x)/y; }\n    constexpr M pow(ll n) const {\n        if (n < 0) return inv().pow(-n);\n        M v = *this, r = 1;\n        for (; n > 0; n >>= 1, v *= v) if (n&1) r *= v;\n        return r;\n    }\n    constexpr M inv() const {\n        assert(x > 0);\n        ll t = 1, v = x, q = 0, r = 0;\n        while (v != 1) {\n            q = mod / v; r = mod % v;\n            if (r * 2 < v) {\n                t *= -q; t %= mod; v = r;\n            } else {\n                t *= q + 1; t %= mod; v -= r;\n            }\n        }\n        if (t < 0) t += mod;\n        M y; y.x = t; return y;\n    }\n#ifdef LOCAL\n    friend string to_s(M r) { return to_s(r.val(), mod); }\n#endif\n    friend ostream& operator<<(ostream& os, M r) { return os << r.val(); }\n    friend istream& operator>>(istream& is, M &r) { int64_t x; is >> x; r = x; return is; }\n};\n// <<<\n//constexpr int64_t MOD = 998244353;\nconstexpr int64_t MOD = 1e9+7;\nusing mint = modint<(int32_t)MOD>;\n\nint32_t main() {\n    while (true) {\n        string A,B,C;\n        cin >> A;\n        if (A == \"0\") break;\n        cin >> B >> C;\n        const int n = A.size();\n\n        auto dp = make_v<mint,2>(2,n+1);\n        dp[0][0] = 1;\n        rep (i,n) rep (j,2) {\n            rep (x,10) rep (y,10) {\n                if (A[i] != '?' && A[i] != '0'+x) continue;\n                if (B[i] != '?' && B[i] != '0'+y) continue;\n                int sum = x+y+j;\n                int c = sum/10, z = sum%10;\n                if (C[i] != '?' && C[i] != '0'+z) continue;\n                if (i == 0 && (x == 0 || y == 0 || z == 0)) continue;\n                dp[j][i+1] += dp[c][i];\n            }\n        }\n\n        cout << dp[0][n] << \"\\n\";\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cassert>\n#include <functional>\n#include <algorithm>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <iterator>\n#include <queue>\n#include <utility>\n\nusing namespace std;\n#define whole(xs) xs.begin(), xs.end()\n#define MOD 1000000007\n\nstring A, B, C;\nbool input() {\n    cin >> A; \n    if (A == \"0\") return false;\n    cin >> B >> C;\n    return true;\n}\n\nint Cache[51][2];\nint dfs(int index, int x) {\n    int Ans = 0;\n    if (index == A.size()) return x == 0;\n    if (Cache[index][x] >= 0) return Cache[index][x];\n    for (int a = 0; a <= 9; a++) {\n        if (index == A.size() - 1 && a == 0) continue;\n        if (A[index] != '?' && A[index] != a + '0') continue;\n        for (int b = 0; b <= 9; b++) {\n            if (index == A.size() - 1 && b == 0) continue;\n            if (B[index] != '?' && B[index] != b + '0') continue;\n            int c1 = a + b + x;\n            int x1 = c1 >= 10;\n            int c = c1 % 10;\n            if (index == A.size() - 1 && c == 0) continue;\n            if (C[index] != '?' && C[index] != c + '0') continue;\n            Ans = (Ans + dfs(index + 1, x1)) % MOD;\n        }\n    }\n    return Cache[index][x] = Ans;\n}\n\nvoid solve() {\n    memset(Cache, -1, sizeof(Cache));\n    reverse(whole(A));\n    reverse(whole(B));\n    reverse(whole(C));\n    cout << dfs(0, 0) << endl;\n}\n\nint main() {\n    while (input()) {\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n\tstring s,t,u;\n\twhile(cin >> s,s!=\"0\"){\n\t\tcin >> t >> u;\n\t\tint n = s.length();\n\t\ts += '$';\n\t\tt += '$';\n\t\tu += '$';\n\t\treverse(s.begin(),s.end());\n\t\treverse(t.begin(),t.end());\n\t\treverse(u.begin(),u.end());\n\n\t\tlong long dp[100][2] = {};\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 1;i <= n;i++){\n\t\t\tchar a = s[i],b = t[i],c = u[i];\n\t\t\tint q = 0;\n\t\t\tif(a == '?')q++;\n\t\t\tif(b == '?')q++;\n\t\t\tif(c == '?')q++;\n\t\t\tint p = a - '0' + b - '0';\n\t\t\tswitch(q){\n\t\t\t\tint x,y;\n\t\t\t\tcase 0:\n\t\t\t\t\tx = p % 10;\n\t\t\t\t\ty = p / 10;\n\t\t\t\t\tif(x == c - '0' && y == 0)dp[i][0] += dp[i-1][0];\n\t\t\t\t\tif(x == c - '0' && y == 1)dp[i][1] += dp[i-1][0];\n\t\t\t\t\tif(x != c - '0' && y == 0)dp[i][0] += dp[i-1][1];\n\t\t\t\t\tif(x != c - '0' && y == 1)dp[i][1] += dp[i-1][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tif(p < 9)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(p == 9)dp[i][0] += dp[i-1][0],dp[i][1] += dp[i-1][1];\n\t\t\t\t\t\tif(p > 9)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tint d = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(d < c)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(d == c)dp[i][0] += dp[i-1][0],dp[i][1] = dp[i-1][1];\n\t\t\t\t\t\tif(d > c)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tx = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * max(0,10 - (x + 1 + j));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (10 - (x + j));\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (x + j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\ty = c - '0';\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y - 1 + c);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y + 1 + j);\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (10 - (y + 1 + j));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif(i == n){\n\t\t\t\t\t\tdp[i][0] += dp[i-1][0] * 36 + dp[i-1][1] * 28;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdp[i][0] += dp[i-1][0] * 55 + dp[i-1][1] * 45;\n\t\t\t\t\tdp[i][1] += dp[i-1][0] * 45 + dp[i-1][1] * 55;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdp[i][0] %= 1000000007,dp[i][1] %= 1000000007;\n\t\t}\n\t\tcout << dp[n][0] << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; ll w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-9;\n\nint main() {\n\tfor (;;) {\n\t\tstring A; cin >> A;\n\t\tif (A == \"0\") break;\n\t\tstring B, C; cin >> B >> C;\n\t\tint n = A.length();\n\t\tvector<ll> dp(2); dp[0] = 1;\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tvector<ll> _dp(2);\n\t\t\tint x = (i == 0 ? 1 : 0);\n\t\t\tfor (int a = x; a <= 9; a++) {\n\t\t\t\tfor (int b = x; b <= 9; b++) {\n\t\t\t\t\tif (A[i] != '?' && A[i] != '0' + a) continue;\n\t\t\t\t\tif (B[i] != '?' && B[i] != '0' + b) continue;\n\t\t\t\t\tfor (int k = 0; k <= 1; k++) {\n\t\t\t\t\t\tint c = a + b + k;\n\t\t\t\t\t\tif (c % 10 < x) continue;\n\t\t\t\t\t\tif (C[i] != '?' && C[i] != '0' + c % 10) continue;\n\t\t\t\t\t\t_dp[c / 10] += dp[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t_dp[0] %= MOD; _dp[1] %= MOD;\n\t\t\tdp = _dp;\n\t\t}\n\t\tcout << dp[0] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\nusing namespace std;\nconst int MOD = (int)1e9 + 7;\n#define rep(i, n) for (int i = 0; i < n; i++)\n\nint main() {\n    string A, B, C;\n    while (cin >> A, A != \"0\") {\n        cin >> B >> C;\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        int n = A.length();\n        vector<vector<int>> canA(n), canB(n), canC(n);\n        rep(i, n) {\n            if (A[i] == '?') {\n                for (int j = (i == n-1); j < 10; j++) {\n                    canA[i].push_back(j);\n                }\n            } else {\n                canA[i].push_back(A[i] - '0');\n            }\n        }\n        rep(i, n) {\n            if (B[i] == '?') {\n                for (int j = (i == n-1); j < 10; j++) {\n                    canB[i].push_back(j);\n                }\n            } else {\n                canB[i].push_back(B[i] - '0');\n            }\n        }\n        rep(i, n) {\n            if (C[i] == '?') {\n                for (int j = (i == n-1); j < 10; j++) {\n                    canC[i].push_back(j);\n                }\n            } else {\n                canC[i].push_back(C[i] - '0');\n            }\n        }\n\n        // dp[digit][carry] := cnt\n        vector<vector<int>> dp = vector<vector<int>>(n + 1, vector<int>(2, 0));\n        dp[0][0] = 1;\n        rep(i, n) rep(carry, 2) {\n            for (int ca: canA[i]) for (int cb: canB[i]) for (int cc: canC[i]) {\n                int res = (ca + cb + carry) % 10;\n                int ncr = (ca + cb + carry) / 10;\n                if (res == cc) {\n                    (dp[i + 1][ncr] += dp[i][carry]) %= MOD;\n                }\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<ll(n);++i)\n#define RREP(i,n) for(ll i=ll(n)-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<ll(n);++i)\n#define RFOR(i,m,n) for(ll i=ll(n)-1;i>=ll(m);--i)\n#define ALL(v) (v).begin(),(v).end()\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconstexpr int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconstexpr int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\n\nusing ll = long long;\nusing vi = vector<int>;\nusing vl = vector<ll>;\nusing vvi = vector<vi>;\nusing vvl = vector<vl>;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\ntemplate <class T> bool chmin(T& a, const T& b) { if (a > b) { a = b; return true; } return false; }\ntemplate <class T> bool chmax(T& a, const T& b) { if (a < b) { a = b; return true; } return false; }\n\n#include \"bits/stdc++.h\"\ntemplate<int mod, bool isPrime = false >\nclass  Mint {\n\tusing ll = long long;\n\tll value;\npublic:\n\tconstexpr Mint() : value(0) {};\n\tconstexpr Mint(ll x) : value(x) {\n\t\tvalue %= mod;\n\t\tif (value < 0)value += mod;\n\t}\n\tconstexpr Mint(const Mint& other) : value(other.value) {}\n\n\tll get() const { return value; }\n\n\tconstexpr Mint pow(ll n) {\n\t\tMint ret(1), tmp(value);\n\t\twhile (n) {\n\t\t\tif (n & 1)ret *= tmp;\n\t\t\tn >>= 1;\n\t\t\ttmp *= tmp;\n\t\t}\n\t\treturn ret;\n\t}\n\tconstexpr bool operator == (const Mint& a) const {\n\t\treturn value == a.value;\n\t}\n\tconstexpr bool operator != (const Mint& a) const {\n\t\treturn value != a.value;\n\t}\n\tconstexpr Mint& operator =(const Mint& a) {\n\t\tvalue = a.value;\n\t\treturn *this;\n\t}\n\tconstexpr Mint& operator +=(const Mint& a) {\n\t\tif ((value += a.value) >= mod)value -= mod;\n\t\treturn *this;\n\t}\n\tconstexpr Mint& operator -=(const Mint& a) {\n\t\tif ((value += mod - a.value) >= mod)value -= mod;\n\t\treturn *this;\n\t}\n\tconstexpr Mint& operator *=(const Mint& a) {\n\t\tvalue = value * a.value % mod;\n\t\treturn *this;\n\t}\n\n\tconstexpr Mint& operator /=(const Mint& a) {\n\t\treturn *this *= inv(a);\n\t}\n\tconstexpr Mint operator +(const Mint& a) const {\n\t\treturn Mint(*this) += a;\n\t}\n\tconstexpr Mint operator -(const Mint& a) const {\n\t\treturn Mint(*this) -= a;\n\t}\n\tconstexpr Mint operator *(const Mint& a) const {\n\t\treturn Mint(*this) *= a;\n\t}\n\tconstexpr Mint operator /(const Mint& a) const {\n\t\treturn Mint(*this) /= a;\n\t}\n};\ntemplate<int mod, bool isPrime> std::ostream& operator << (std::ostream& os, const Mint<mod, isPrime>& m) { os << m.get(); return os; }\ntemplate<int mod, bool isPrime> std::istream& operator >> (std::istream& is, Mint<mod, isPrime>& m) { is >> m.get();  return is; }\n\ntemplate<int mod>\nconstexpr Mint<mod, true> inv(const Mint<mod, true>& m) {\n\tlong long a = m.get(), b = mod, u = 1, v = 0;\n\twhile (b) {\n\t\tlong long t = a / b;\n\t\ta -= t * b; std::swap(a, b);\n\t\tu -= t * v; std::swap(u, v);\n\t}\n\treturn Mint<mod, true>(u);\n}\n\ntemplate<int mod, bool isPrime>\nconstexpr Mint<mod, isPrime> operator +(long long lhs, const Mint<mod, isPrime>& a) {\n\treturn Mint<mod, isPrime>(lhs + a.get());\n}\n\ntemplate<int mod, bool isPrime>\nconstexpr Mint<mod, isPrime> operator -(long long lhs, const Mint<mod, isPrime>& a) {\n\treturn Mint<mod, isPrime>(lhs - a.get());\n}\n\ntemplate<int mod, bool isPrime>\nconstexpr Mint<mod, isPrime> operator *(long long lhs, const Mint<mod, isPrime>& a) {\n\treturn Mint<mod, isPrime>(lhs % mod * a.get());\n}\n\nconstexpr int default_mod = 1000000007;\nusing mint = Mint<default_mod, true>;\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tstring a, b, c;\n\twhile (cin >> a) {\n\t\tif (a[0] == '0')break;\n\t\tcin >> b >> c;\n\t\treverse(ALL(a));\n\t\treverse(ALL(b));\n\t\treverse(ALL(c));\n\t\tint n = a.size();\n\t\tvector<vector<mint>> dp(n + 1, vector<mint>(2, 0));\n\t\tdp[0][0] = 1;\n\t\tREP(i, n) {\n\t\t\tint k = i == n - 1;\n\t\t\tREP(j, 2) {\n\t\t\t\tFOR(A, k, 10) {\n\t\t\t\t\tif (a[i] != '?' && a[i] - '0' != A)continue;\n\n\t\t\t\t\tFOR(B, k, 10) {\n\t\t\t\t\t\tif (b[i] != '?' && b[i] - '0' != B)continue;\n\t\t\t\t\t\tFOR(C, k, 10) {\n\t\t\t\t\t\t\tif (c[i] != '?' && c[i] - '0' != C)continue;\n\t\t\t\t\t\t\tif ((A + B + j) % 10 == C) {\n\t\t\t\t\t\t\t\tdp[i + 1][(A + B + j) / 10] += dp[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n][0] << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\n#include<string.h>\nusing namespace std;\nlong long mod=1000000007;\nchar A[60];\nchar B[60];\nchar C[60];\nlong long dp[60][2];\nint main(){\n\twhile(1){\n\t\tscanf(\"%s\",A);\n\t\tif(A[0]=='0')break;\n\t\tscanf(\"%s%s\",B,C);\n\t\tfor(int i=0;i<60;i++)dp[i][0]=dp[i][1]=0;\n\t\tint n=strlen(A);\n\t\tdp[n][0]=1;\n\t\tfor(int i=n-1;i>=0;i--){\n\t\t\tint t11=0;\n\t\t\tint t12=0;\n\t\t\tint t21=0;\n\t\t\tint t22=0;\n\t\t\tfor(int j=0;j<10;j++){\n\t\t\t\tif(i==0&&j==0)continue;\n\t\t\t\tif(A[i]!='?'&&j!=A[i]-'0')continue;\n\t\t\t\tfor(int k=0;k<10;k++){\n\t\t\t\t\tif(i==0&&k==0)continue;\n\t\t\t\t\tif(B[i]!='?'&&k!=B[i]-'0')continue;\n\t\t\t\t\tif(C[i]!='?'&&(j+k)%10!=C[i]-'0')continue;\n\t\t\t\t\tif(j+k>=10)t12++;\n\t\t\t\t\telse t11++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=0;j<10;j++){\n\t\t\t\tif(i==0&&j==0)continue;\n\t\t\t\tif(A[i]!='?'&&j!=A[i]-'0')continue;\n\t\t\t\tfor(int k=0;k<10;k++){\n\t\t\t\t\tif(i==0&&k==0)continue;\n\t\t\t\t\tif(B[i]!='?'&&k!=B[i]-'0')continue;\n\t\t\t\t\tif(C[i]!='?'&&(j+k+1)%10!=C[i]-'0')continue;\n\t\t\t\t\tif(j+k+1>=10)t22++;\n\t\t\t\t\telse t21++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp[i][0]=(dp[i+1][0]*t11+dp[i+1][1]*t21)%mod;\n\t\t\tdp[i][1]=(dp[i+1][0]*t12+dp[i+1][1]*t22)%mod;\n\t\t//\tprintf(\"%d: %lld %lld\\n\",i,dp[i][0],dp[i][1]);\n\t\t}\n\t\tprintf(\"%lld\\n\",dp[0][0]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define M 1000000007\n#define N 55\nusing namespace std;\ntypedef long long ll;\nstring num[3];\nll d[N][2],ans;\n\nstring get_num(int x,int y){\n  string res;\n  if(num[y][x]!='?')res+=num[y][x];\n  else res+=\"0123456789\";\n  return res;\n}\n\nvoid update(int x){\n  string a=get_num(x,0);\n  string b=get_num(x,1);\n  string c=get_num(x,2);\n\n  ll A=0,B=0,C=0,D=0;\n  for(int i=0;i<a.size();i++){\n    for(int j=0;j<b.size();j++){\n      for(int k=0;k<c.size();k++){\n\tint sum=a[i]-'0'+b[j]-'0';\n\tint Ans=c[k]-'0';\n\tif(!x&&(a[i]=='0'||b[j]=='0'||c[k]=='0'))continue;\n\tif(sum%10==Ans){\n\t  if(sum<10)A++;\n\t  else B++;\n\t}\n\tif((sum+1)%10==Ans){\n\t  if(sum+1<10)C++;\n\t  else D++;\n\t}\n      }\n    }\n  }\n  \n  if(!x)ans=(d[x][0]*A+d[x][1]*C)%M;\n  else{\n    d[x-1][0]=(d[x][0]*A+d[x][1]*C)%M;\n    d[x-1][1]=(d[x][0]*B+d[x][1]*D)%M;\n  }\n}\n\nint main(){\n  while(1){\n    cin>>num[0];\n    if(num[0]==\"0\")break;\n    cin>>num[1]>>num[2];\n\n    memset(d,0,sizeof(d));\n    d[num[0].size()-1][0]=1;\n    \n    for(int i=num[0].size()-1;i>=0;i--)update(i);\n    \n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing vb=vector<bool>;\nusing vvb=vector<vb>;\nusing vd=vector<double>;\nusing vvd=vector<vd>;\nusing vi=vector<int>;\nusing vvi=vector<vi>;\nusing vl=vector<ll>;\nusing vvl=vector<vl>;\nusing pll=pair<ll,ll>;\nusing tll=tuple<ll,ll>;\nusing tlll=tuple<ll,ll,ll>;\nusing vs=vector<string>;\n#define all(a) a.begin(),a.end()\n#define rall(a) a.rbegin(),a.rend()\n#define rep(i,n) range(i,0,n)\n#define rrep(i,n) for(ll i=(n)-1;i>=0;i--)\n#define range(i,a,n) for(ll i=(a);i<(n);i++)\n#define LINF ((ll)1ll<<60)\n#define INF ((int)1<<30)\n#define EPS (1e-9)\n#define MOD (1000000007ll)\n#define fcout(a) cout<<setprecision(a)<<fixed\n#define fs first\n#define sc second\n#define PI (3.1415926535897932384)\n\nint dx[]={1,0,-1,0,1,-1,-1,1},dy[]={0,1,0,-1,1,1,-1,-1};\ntemplate<class T>bool chmax(T&a,T b){if(a<b){a=b; return true;}return false;}\ntemplate<class T>bool chmin(T&a,T b){if(a>b){a=b; return true;}return false;}\ntemplate<class S>S sum(vector<S>&a){return accumulate(all(a),S());}\ntemplate<class S>S max(vector<S>&a){return *max_element(all(a));}\ntemplate<class S>S min(vector<S>&a){return *min_element(all(a));}\nll max(int a,ll b){return max((ll)a,b);} ll max(ll a,int b){return max(a,(ll)b);}\nint sgn(const double&r){return (r>EPS)-(r<-EPS);} // a>0  : sgn(a)>0\nint sgn(const double&a,const double&b){return sgn(a-b);} // b<=c : sgn(b,c)<=0\n\ntemplate<class T>void puta(T&&t){cout<<t<<\"\\n\";}\ntemplate<class H,class...T>void puta(H&&h,T&&...t){cout<<h<<' ';puta(t...);}\ntemplate<class S,class T>void tf(bool b,S t,T f){if(b)puta(t);else puta(f);}\nvoid YN(bool b){tf(b,\"YES\",\"NO\");}\nvoid Yn(bool b){tf(b,\"Yes\",\"No\");}\nvoid yn(bool b){tf(b,\"yes\",\"no\");}\ntemplate<class S,class T>ostream&operator<<(ostream&os,pair<S,T>p){os<<\"[\"<<p.first<<\", \"<<p.second<<\"]\";return os;};\ntemplate<class S>auto&operator<<(ostream&os,vector<S>t){bool a=1;for(auto s:t){os<<(a?\"\":\" \")<<s;a=0;}return os;}\ntemplate<class S>auto&operator>>(istream&is,vector<S>&t){for(S&a:t)cin>>a;return is;}\n\n/*他のライブラリを入れる場所*/\n\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    string a,b,c;\n    while(cin>>a, a!=\"0\"){\n        cin>>b>>c;\n        ll n = a.size();\n        vvl dp(n+1, vl(2,0));\n        dp[n][0]=1;\n        rrep(i,n){\n            ll up=0,keep=0;\n            rep(p,10)if(a[i]=='?' or a[i]-'0' == p)if(i or p)\n            rep(q,10)if(b[i]=='?' or b[i]-'0' == q)if(i or q){\n                rep(r,2){\n                    if(c[i]=='?' or c[i]-'0' == (p+q+r)%10)if(i or (p+q+r<10 and p+q+r)){\n                        // puta(p,q,r,dp[i+1][r]);\n                        if(p+q+r>=10)dp[i][1]=(dp[i][1]+dp[i+1][r])%MOD;\n                        else dp[i][0]=(dp[i][0]+dp[i+1][r])%MOD;\n                    }\n                }\n            }\n            // puta(dp[i]);\n        }\n        puta(dp[0][0]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long int ll;\nconst int INF = 1000000000;\nconst int MOD = 1000000007;\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n#define rep(i,n) REP(i, 0, n)\nconst char q = '?';\nint dp[51][2];//?????????n - i - 1????????§????????¨????????´????????°(j == 0 ? ??°??????????????????: ??°????????????)\nint main(){\n    ios::sync_with_stdio(false);\n    string a, b, c;\n    while(cin >> a && a != \"0\"){\n        cin >> b >> c;\n        int n = a.size();\n        memset(dp, 0, sizeof(dp));\n        dp[n][0] = 1;\n        for(int keta = n - 1; keta >= 0; --keta){\n            rep(k, 10){\n                int kk = k;\n                if(a[keta] != q){\n                    kk = a[keta] - '0';\n                    k = 9;\n                }\n                if(!keta && !kk) continue;\n                rep(i, 10){\n                    int ii = i;\n                    if(b[keta] != q){\n                        ii = b[keta] - '0';\n                        i = 9;\n                    }\n                    if(!keta && !ii) continue;\n                    rep(j, 10){\n                        int jj = j;\n                        if(c[keta] != q){\n                            jj = c[keta] - '0';\n                            j = 9;\n                        }\n                        if(!keta && !jj) continue;\n                        int temp = dp[keta][0];\n                        if(kk + ii == jj) dp[keta][0] += dp[keta + 1][0];\n                        if(kk + ii + 1 == jj) dp[keta][0] += dp[keta + 1][1];\n                        if(kk + ii - 10 == jj) dp[keta][1] += dp[keta + 1][0];\n                        if(kk + ii - 9 == jj) dp[keta][1] += dp[keta + 1][1];\n                        dp[keta][0] %= MOD;\n                        dp[keta][1] %= MOD;\n                        //if(temp < dp[keta][0]) cout << kk << ' ' << ii << ' ' << jj << endl;\n                    }\n                }\n            }\n        }\n        //rep(i, n) rep(j, 2) cout << dp[i][j] << endl;\n        cout << dp[0][0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\nstring A, B, C;\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tint n = B.size();\n\n\t\tll dp[55][2] = { 0 };\n\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tfor(int j = 0; j < 2; j++) {\n\t\t\t\tint q = 0, s = 0, t = 0;\n\t\t\t\tif(A[i] == '?') q++;\n\t\t\t\telse s += A[i] - '0';\n\t\t\t\tif(B[i] == '?') q++;\n\t\t\t\telse s += B[i] - '0';\n\t\t\t\tif(C[i] != '0') t = C[i] - '0';\n\n\t\t\t\tif(q == 2) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tfor(int b = 0; b <= 9; b++) {\n\t\t\t\t\t\t\tif(i == n - 1 && (a == 0 || b == 0)) continue;\n\t\t\t\t\t\t\tif(i == n - 1 && (a + b + j) % 10 == 0) continue;\n\t\t\t\t\t\t\tif(C[i] == '?' || (a + b + j) % 10 == t) {\n\t\t\t\t\t\t\t\tint nj = a + b + j >= 10;\n\t\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(q == 1) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tif(i == n - 1 && (s + a + j) % 10 == 0) continue;\n\t\t\t\t\t\tif(C[i] == '?' || (s + a + j) % 10 == t) {\n\t\t\t\t\t\t\tint nj = s + a + j >= 10;\n\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // q == 0\n\t\t\t\t\tif((i == n - 1 && (s + j) % 10 == 0)) continue;\n\t\t\t\t\tif(C[i] == '?' || (s + j) % 10 == t) {\n\t\t\t\t\t\tint nj = (s + j) >= 10;\n\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}// for j\n\t\t}// for i\n\t\tcout << dp[n][0] << endl;\n\t}// while\n}// main"
  },
  {
    "language": "C++",
    "code": "/*\n * 2566.cc: Restore Calculation\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 50;\n\ntypedef long long ll;\nconst ll MOD = 1000000007;\n\n/* typedef */\n\n/* global variables */\n\nint as[MAX_N], bs[MAX_N], cs[MAX_N];\nll dp[MAX_N + 1][2];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  for (;;) {\n    string sa, sb, sc;\n    cin >> sa;\n    if (sa == \"0\") break;\n    cin >> sb >> sc;\n\n    int n = sa.size();\n    for (int i = 0, j = n - 1; i < n; i++, j--) {\n      as[j] = (sa[i] == '?') ? -1 : sa[i] - '0';\n      bs[j] = (sb[i] == '?') ? -1 : sb[i] - '0';\n      cs[j] = (sc[i] == '?') ? -1 : sc[i] - '0';\n    }\n    //for (int i = 0; i < n; i++) printf(\"%d\", as[i]); putchar('\\n');\n    //for (int i = 0; i < n; i++) printf(\"%d\", bs[i]); putchar('\\n');\n    //for (int i = 0; i < n; i++) printf(\"%d\", cs[i]); putchar('\\n');\n\n    memset(dp, 0, sizeof(dp));\n    dp[0][0] = 1;\n\n    for (int i = 0; i < n; i++)\n      for (int j = 0; j < 2; j++)\n\tif (dp[i][j] > 0) {\n\t  int mina = (i == n - 1) ? 1 : 0;\n\t  for (int a = mina; a <= 9; a++)\n\t    if (as[i] < 0 || as[i] == a) {\n\t      int minb = (i == n - 1) ? 1 : 0;\n\t      for (int b = minb; b <= 9; b++) \n\t\tif (bs[i] < 0 || bs[i] == b) {\n\t\t  int c = a + b + j;\n\t\t  int cr = c / 10;\n\t\t  c %= 10;\n\t\t  if ((cs[i] < 0 || cs[i] == c) && (i < n - 1 || c != 0)) {\n\t\t    dp[i + 1][cr] = (dp[i + 1][cr] + dp[i][j]) % MOD;\n\t\t    //printf(\"[%d] %d+%d+(%d)=(%d)%d (%d,%d,%d)\\n\",\n\t\t    //i, a, b, j, cr, c, as[i], bs[i], cs[i]);\n\t\t  }\n\t\t}\n\t    }\n\t}\n\n    printf(\"%lld\\n\", dp[n][0]);\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\ntypedef long long int lli;\nconst lli mod = 1e9+7;\n\nvoid search(vector<int> &in, vector<lli> &out, int c, int st){\n\tif(in[0]!=-1 && in[1]!=-1 && in[2]!=-1){\n\t\tif(in[0]+in[1]+c == in[2]) out[0]++;\n\t\tif(in[0]+in[1]+c == in[2]+10) out[1]++;\n\t\treturn;\n\t}\n\tfor(int i=0; i<3; i++){\n\t\tif(in[i] == -1){\n\t\t\tfor(int d=st; d<=9; d++){\n\t\t\t\tin[i] = d;\n\t\t\t\tsearch(in, out, c, st);\n\t\t\t\tin[i] = -1;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nint main(){\n\twhile(1){\n\t\tstring str[3];\n\t\tcin >> str[0];\n\t\tif(str[0]==\"0\") break;\n\t\tcin >> str[1] >> str[2];\n\t\tint n=str[0].length();\n\t\t\n\t\tvector<vector<lli> > pos_c(n, vector<lli>(2, 0));\n\t\tvector<vector<lli> > pos_nc(n, vector<lli>(2, 0));\n\t\tfor(int i=0; i<n; i++){\n\t\t\tvector<int> in(3);\n\t\t\tfor(int j=0; j<3; j++){\n\t\t\t\tin[j] = (str[j][n-i-1] == '?')? -1: str[j][n-i-1]-'0';\n\t\t\t}\n\t\t\tsearch(in, pos_nc[i], 0, (i==n-1)?1: 0);\n\t\t\tsearch(in, pos_c[i],  1, (i==n-1)?1: 0);\n\t\t}\n\t\t\n\t\tvector<vector<lli> > dp = pos_nc;\n\t\tfor(int i=0; i<n-1; i++){\n\t\t\tdp[i+1][0] = (dp[i][0]*pos_nc[i+1][0] +dp[i][1]*pos_c[i+1][0])%mod;\n\t\t\tdp[i+1][1] = (dp[i][0]*pos_nc[i+1][1] +dp[i][1]*pos_c[i+1][1])%mod;\n\t\t}\n\t\tcout << dp[n-1][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <vector>\n#include <string>\n#include <set>\n#include <unordered_set>\n#include <map>\n#include <unordered_map>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <functional>\n#include <iterator>\n#include <limits>\n#include <numeric>\n#include <utility>\n#include <cmath>\n#include <cassert>\n#include <cstdio>\n\nusing namespace std; using namespace placeholders;\n\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector< int > VI;\ntypedef vector< vector< int > > VVI;\ntypedef vector< string > VS;\ntypedef stringstream SS;\ntypedef pair< int, int > PII;\ntypedef vector< pair< int, int > > VPII;\n#define VT( T ) vector< T >\n#define VVT( T ) vector< vector< T > >\n#define LIM( T ) numeric_limits< T >\n\ntemplate < typename T > inline istream& operator>>( istream &s, vector< T > &v ){ for ( T &t : v ) { s >> t; } return s; }\ntemplate < typename T > inline ostream& operator<<( ostream &s, const vector< T > &v ){ for ( int i = 0; i < int( v.size() ); ++i ){ s << ( \" \" + !i ) << v[i]; } return s; }\ntemplate < typename T > inline T fromString( const string &s ) { T res; istringstream iss( s ); iss >> res; return res; };\ntemplate < typename T > inline string toString( const T &a ) { ostringstream oss; oss << a; return oss.str(); };\n\n#define REP2( i, n ) REP3( i, 0, n )\n#define REP3( i, m, n ) for ( int i = ( int )( m ); i < ( int )( n ); ++i )\n#define GET_REP( a, b, c, F, ... ) F\n#define REP( ... ) GET_REP( __VA_ARGS__, REP3, REP2 )( __VA_ARGS__ )\n#define FOR( e, c ) for ( auto &e : c )\n#define ALL( c ) ( c ).begin(), ( c ).end()\n#define AALL( a, t ) ( t* )a, ( t* )a + sizeof( a ) / sizeof( t )\n#define DRANGE( c, p ) ( c ).begin(), ( c ).begin() + p, ( c ).end()\n\n#define SZ( v ) ( (int)( v ).size() )\n#define PB push_back\n#define EM emplace\n#define EB emplace_back\n#define BI back_inserter\n\n#define EXIST( c, e ) ( ( c ).find( e ) != ( c ).end() )\n\n#define MP make_pair\n#define fst first\n#define snd second\n\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n\nconstexpr int MOD = 1000000007;\n\nint main()\n{\n\tcin.tie( 0 );\n\tios::sync_with_stdio( false );\n\n\tfor ( string A, B, C; cin >> A >> B >> C; )\n\t{\n\t\tconst int L = SZ( A );\n\n\t\tVVI dp( L + 1, VI( 2 ) );\n\t\tdp[0][0] = 1;\n\n\t\tREP( i, L )\n\t\t{\n\t\t\tconst int pos = L - 1 - i;\n\n\t\t\tREP( j, 2 )\n\t\t\t{\n\t\t\t\tREP( a, i + 1 == L ? 1 : 0, 10 )\n\t\t\t\t{\n\t\t\t\t\tREP( b, i + 1 == L ? 1 : 0, 10 )\n\t\t\t\t\t{\n\t\t\t\t\t\tif ( A[ pos ] != '?' && A[ pos ] != a + '0' ||\n\t\t\t\t\t\t\t\tB[ pos ] != '?' && B[ pos ] != b + '0' ||\n\t\t\t\t\t\t\t\tC[ pos ] != '?' && C[ pos ] != ( a + b + j ) % 10 + '0' )\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst int nj = 10 <= a + b + j;\n\t\t\t\t\t\t( dp[ i + 1 ][ nj ] += dp[i][j] ) %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << dp[L][0] << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nll solve1() {\n    if (A[0] == '?' && B[0] == '?') {\n        int cnt = 0;\n        if (C[0] == '?') {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j < 10) ++cnt;\n                }\n            }\n        } else {\n            for (size_t i = 1; i < 10; i++) {\n                for (size_t j = 1; j < 10; j++) {\n                    if (i + j == C[0] - '0') ++cnt;\n                }\n            }\n        }\n        return cnt;\n    }\n    else if(A[0] == '?' || B[0] == '?') {\n        if (A[0] == '?') swap(A[0], B[0]);\n        if (C[0] == '?') {\n            int d = C[0] - A[0];\n            if (d <= 0) return 0;\n            else return 9 - (A[0] - '0');\n        } else {\n            if (C[0] - '0' - A[0] - '0' > 0) {\n                return 1;\n            } else {\n                return 0;\n            }\n        }\n    }\n    else {\n        if (C[0] == '?') {\n            int x = A[0] - '0' + B[0] - '0';\n            return 0 < 1 && x < 10;\n        } else {\n            return A[0] - '0' + B[0] - '0' == C[0] - '0';\n        }\n    }\n}\n\nint main() {\n    while (cin >> A, A != \"0\") {\n        cin >> B >> C;\n\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        int n = B.size();\n        \n        if (n == 1) {\n            cout << solve1() << endl;\n            continue;\n        } \n        \n        ll dp[55][2] = { 0 };\n\n        dp[0][0] = 1;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < 2; j++) {\n                int q = 0, s = 0, t = 0;\n                if (A[i] == '?') q++;\n                else s += A[i] - '0';\n                if (B[i] == '?') q++;\n                else s += B[i] - '0';\n                if (C[i] != '0') t = C[i] - '0';\n                if (q == 2) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        for (int b = 0; b <= 9; b++) {\n                            if (i == n - 1 && b == 0) continue;\n                            if (i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n                            if ((C[i] == '?' || (a + b + j) % 10 == t)) {\n                                if (a + b + j >= 10) {\n                                    (dp[i + 1][1] += dp[i][j]) %= MOD;\n                                } else {\n                                    (dp[i + 1][0] += dp[i][j]) %= MOD;\n                                }\n                            }\n                        }\n                    }\n                } else if (q == 1) {\n                    for (int a = 0; a <= 9; a++) {\n                        if (i == n - 1 && a == 0) continue;\n                        if ((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n                        if (C[i] == '?' || (s + a + j) % 10 == t) {\n                            if (s + a + j >= 10) {\n                                (dp[i + 1][1] += dp[i][j]) %= MOD;\n                            } else {\n                                (dp[i + 1][0] += dp[i][j]) %= MOD;\n                            }\n                        }\n                    }\n                } else { // q == 0\n                    if ((i == n - 1 && (s + j) % 10 == 0)) continue;\n                    if (C[i] == '?' || (s + j) % 10 == t) {\n                        if ((s + j) >= 10) {\n                            (dp[i + 1][1] += dp[i][j]) %= MOD;\n                        } else {\n                            (dp[i + 1][0] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n            }// for j\n        }// for i\n        cout << dp[n][0] << endl;\n    }// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    REP(i, 55) dp[i][0] = dp[i][1] = 0;\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if((A+B)%10==C) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if((A+B+1)%10==C) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        if(i!=0 && C>=B) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=B+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>B+1) dp[i][0] += dp[i+1][1];\n        if(C<=(B+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=B) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i!=0 && C>=A) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>A) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=A+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>A+1) dp[i][0] += dp[i+1][1];\n        if(C<=(A+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=A) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(i || (A+B)%10) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if(i || (A+B+1)%10) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if((j+k)%10==C) {\n              if(j+k>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+k+1)%10) {\n            if((j+k+1)%10==C) {\n              if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <string>\n#include <algorithm>\nusing namespace std;\n#define all(c) begin(c), end(c)\n#define rep(i,n) for(int i = 0; i < (int)(n); ++i)\n\nconst int MOD = 1e9 + 7;\nstring A, B, C;\nint a[55], b[55], c[55];\n\nint main() {\n    while (cin >> A >> B >> C && A != \"0\") {\n        reverse(all(A));\n        reverse(all(B));\n        reverse(all(C));\n        int n = A.size();\n        rep(i,n){\n            a[i] = isdigit(A[i]) ? A[i] - '0' : -1;\n            b[i] = isdigit(B[i]) ? B[i] - '0' : -1;\n            c[i] = isdigit(C[i]) ? C[i] - '0' : -1;\n        }\n        \n        int dp[55][2] = {};\n        dp[0][0] = 1;\n        rep(i, n)rep(j, 2)rep(ia, 10)rep(ib, 10)rep(ic, 10) {\n            if (a[i] != -1 && ia != a[i]) continue;\n            if (b[i] != -1 && ib != b[i]) continue;\n            if (c[i] != -1 && ic != c[i]) continue;\n            if (i == n - 1 && (ia == 0 || ib == 0 || ic == 0)) continue;\n            int dig = ia + ib + j;\n            if (dig % 10 != ic) continue;\n            (dp[i + 1][dig >= 10] += dp[i][j]) %= MOD;\n        }\n        cout << dp[n][0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 1000000100\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\nstatic const int MOD = 1000000007;\nint dp[51][2];\n\nint main(){\n  char numbers[3][55];\n  while(~scanf(\"%s\",numbers[0])){\n    if(numbers[0][0] == '0') break;\n    \n    memset(dp,0,sizeof(dp));\n    for(int i=1;i<3;i++){\n      scanf(\"%s\",numbers[i]);\n    }\n\n    int N=strlen(numbers[0]);\n    reverse(numbers[0],numbers[0]+N);\n    reverse(numbers[1],numbers[1]+N);\n    reverse(numbers[2],numbers[2]+N);\n\n    dp[0][0] = 1;\n    for(int x=0;x<N;x++){\n      int left = 0;\n      int right = -1;\n      int q_count = 0;\n\n      for(int y=0;y<2;y++){\n        if(numbers[y][x] != '?'){\n          left += numbers[y][x] - '0';\n        }\n        else{\n          q_count++;\n        }\n      }\n\n      if(numbers[2][x] != '?'){\n        right = numbers[2][x] - '0';\n      }\n\n      for(int carry = 0; carry < 2; carry++){\n        //num of ? eq 2\n        if(q_count == 2){\n          for(int i=0; i<10;i++){\n            for(int j=0; j<10;j++){\n              if(x == N - 1 && (i==0 || j==0)) continue;\n              //C is not known\n              if(right == -1){\n                dp[x+1][(i+j+carry) / 10] += dp[x][carry] % MOD;\n                dp[x+1][(i+j+carry) / 10] %= MOD;\n              }\n              //C is known\n              else if((i+j+carry) % 10 == right){\n                dp[x+1][(i+j+carry) / 10] += dp[x][carry] % MOD;\n                dp[x+1][(i+j+carry) / 10] %= MOD;\n              }\n            }\n          }\n        }\n        \n        //num of ? eq 1\n        if(q_count == 1){\n          for(int i=0; i<10;i++){\n            if(x == N - 1 && i==0) continue;\n            //C is not known\n            if(right == -1){\n              dp[x+1][(i+left+carry) / 10] += dp[x][carry] % MOD;\n              dp[x+1][(i+left+carry) / 10] %= MOD;\n            }\n            //C is known\n            else if((i+left+carry) % 10 == right){\n              dp[x+1][(i+left+carry) / 10] += dp[x][carry] % MOD;\n              dp[x+1][(i+left+carry) / 10] %= MOD;\n            }\n          }\n        }\n        \n        //num of ? eq 0\n        if(q_count == 0){\n          if(right != -1 && (left + carry) % 10 == right){\n            dp[x+1][(left+carry) / 10] += dp[x][carry] % MOD;\n            dp[x+1][(left+carry) / 10] %= MOD;\n          }\n          if(right == -1){\n            if(x == N - 1 && (left+carry) % 10 == 0) continue;\n            dp[x+1][(left+carry) / 10] += dp[x][carry] % MOD;\n            dp[x+1][(left+carry) / 10] %= MOD;\n          }\n        }\n      }\n      \n    }\n\n    printf(\"%d\\n\",(dp[strlen(numbers[0])][0] % MOD));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=long long;\nconst ll MOD=1e9+7;\nll solve(int n,vector<int> a,vector<int> b,vector<int> c){\n    vector<vector<int>> dp(n+1,vector<int>(2,0));\n    dp[0][0]=1;\n    for(int i=0;i<n;i++){\n        int lb=(i==0 ? 1 : 0);\n        for(int an=lb;an<10;an++){\n            if(a[i]!=-1 && an!=a[i]) continue;\n            for(int bn=lb;bn<10;bn++){\n                if(b[i]!=-1 && bn!=b[i]) continue;\n                //cerr<<\"#\"<<i<<\" \"<<an<<\" \"<<bn<<endl;\n                int digit=(an+bn)%10;\n                int carry=(an+bn)/10;\n                if(c[i]==-1 || digit==c[i]){\n                    dp[i+1][0]+=dp[i][carry];\n                    dp[i+1][0]%=MOD;\n                }\n                digit=(an+bn+1)%10;\n                carry=(an+bn+1)/10;\n                if(c[i]==-1 || digit==c[i]){\n                    dp[i+1][1]+=dp[i][carry];\n                    dp[i+1][1]%=MOD;\n                }\n            }\n        }\n    }\n    return dp[n][0]%MOD;\n}\n\nint tonum(char x){\n    if(isdigit(x)) return x-'0';\n    else return -1;\n}\nint main(){\n    string abuf,bbuf,cbuf;\n    \n    while(cin>>abuf>>bbuf>>cbuf,abuf!=\"0\"){\n        int n=abuf.size();\n        vector<int> a(n),b(n),c(n);\n        for(int i=0;i<n;i++){\n            a[i]=tonum(abuf[i]);\n            b[i]=tonum(bbuf[i]);\n            c[i]=tonum(cbuf[i]);\n        }\n        cout<<solve(n,a,b,c)<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nconst ll mod = 1000000007;\nll dp[55][2];\n\nint main() {\n\tcin.tie(0)->sync_with_stdio(0);\n\tcin.exceptions(cin.failbit);\n\n\tfor (;;) {\n\t\tstring a, b, c;\n\t\tcin >> a; if (a == \"0\") break;\n\t\tcin >> b >> c;\n\n\t\treverse(all(a));\n\t\treverse(all(b));\n\t\treverse(all(c));\n\n\t\tint n = a.size();\n\n\t\t// reset\n\t\trep(i, 0, 55) rep(j, 0, 2) dp[i][j] = 0;\n\t\tdp[0][0] = 1;\n\n\t\trep(i, 0, n) {\n\t\t\trep(na, a[i] == '?' ? (i == n - 1 ? 1 : 0) : a[i] - '0', a[i] == '?' ? 10 : a[i] - '0' + 1)\n\t\t\trep(nb, b[i] == '?' ? (i == n - 1 ? 1 : 0) : b[i] - '0', b[i] == '?' ? 10 : b[i] - '0' + 1)\n\t\t\trep(carry, 0, 2) if (dp[i][carry]) {\n\t\t\t\tif (c[i] == '?' || (na + nb + carry) % 10 == c[i] - '0') {\n\t\t\t\t\tdp[i + 1][(na + nb + carry) / 10] += dp[i][carry];\n\t\t\t\t\tdp[i + 1][(na + nb + carry) / 10] %= mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << dp[n][0] << endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <set>\n#include <map>\n#include <string>\n#include <stack>\n#include <queue>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <bitset>\n#include <complex>\n#include <unistd.h>\n#include <cassert>\n#include <cctype>\n#include <random>\n#define _USE_MATH_DEFINES\n#define _GLIBCXX_DEBUG\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> plglg;\ntypedef pair<double, ll> pdlg;\ntypedef tuple<int, int, int> tiii;\ntypedef tuple<ll, ll, ll> tlglglg;\ntypedef tuple<double, double, double> tddd;\ntypedef complex<double> xy_t;\n#define REP(i, x, y) for(ll i = x; i < y; i++)\n#define PER(i, x, y) for(ll i = x; i > y; i--)\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\ndouble pi = 3.141592653589793;\nll mod = 1000000007;\nint intmax = 2147483647;\nint intmin = -2147483648;\nll llmax = 9223372036854775807;\nll llmin = -9223372036854775807;\nint iinf = intmax / 8;\nll inf = llmax / 8;\ndouble eps = 1e-11;\n\nll multiply(ll x, ll y) {\n    return (x % mod) * (y % mod) % mod;\n}\n\nll dp[60][2];\n\nint main() {\n    while (1) {\n        string A, B, C;\n        cin >> A;\n        if (A == \"0\") {\n            break;\n        }\n        cin >> B >> C;\n        ll len = A.size();\n        REP(i, 0, 60) {\n            fill(dp[i], dp[i] + 2, 0);\n        }\n        dp[0][0] = 1;\n        dp[0][1] = 0;\n        REP(i, 0, len) {\n            ll rem = len - 1 - i;\n            //cout << A[rem] << \" \" << B[rem] << \" \" << C[rem] << endl;\n            if (C[rem] == '?') {\n                if (A[rem] == '?') {\n                    if (B[rem] == '?') {\n                        if (rem != 0) {\n                            dp[i + 1][0] += multiply(dp[i][0], 55) + multiply(dp[i][1], 45);\n                            dp[i + 1][1] += multiply(dp[i][0], 45) + multiply(dp[i][1], 55);\n                        } else {\n                            dp[i + 1][0] += multiply(dp[i][0], 36) + multiply(dp[i][1], 28);\n                            dp[i + 1][1] += multiply(dp[i][0], 45) + multiply(dp[i][1], 63);\n                        }\n                    } else {\n                        ll b = B[rem] - '0';\n                        if (rem != 0) {\n                            if (b <= 8) {\n                                dp[i + 1][0] += dp[i][0] + dp[i][1];\n                            } else {\n                                dp[i + 1][0] += dp[i][0];\n                                dp[i + 1][1] += dp[i][1];\n                            }\n                        }\n                        REP(j, 1, 10) {\n                            if (b + j <= 8) {\n                                dp[i + 1][0] += dp[i][0] + dp[i][1];\n                            } else if (b + j == 9) {\n                                dp[i + 1][0] += dp[i][0];\n                                dp[i + 1][1] += dp[i][1];\n                            } else {\n                                dp[i + 1][1] += dp[i][0] + dp[i][1];\n                            }\n                        }\n                    }\n                } else {\n                    ll a = A[rem] - '0';\n                    if (B[rem] == '?') {\n                        if (rem != 0) {\n                            if (a <= 8) {\n                                dp[i + 1][0] += dp[i][0] + dp[i][1];\n                            } else {\n                                dp[i + 1][0] += dp[i][0];\n                                dp[i + 1][1] += dp[i][1];\n                            }\n                        }\n                        REP(j, 1, 10) {\n                            if (a + j <= 8) {\n                                dp[i + 1][0] += dp[i][0] + dp[i][1];\n                            } else if (a + j == 9) {\n                                dp[i + 1][0] += dp[i][0];\n                                dp[i + 1][1] += dp[i][1];\n                            } else {\n                                dp[i + 1][1] += dp[i][0] + dp[i][1];\n                            }\n                        }\n                    } else {\n                        ll b = B[rem] - '0';\n                        if (a + b <= 8) {\n                            dp[i + 1][0] += dp[i][0] + dp[i][1];\n                        } else if (a + b == 9) {\n                            dp[i + 1][0] += dp[i][0];\n                            dp[i + 1][1] += dp[i][1];\n                        } else {\n                            dp[i + 1][1] += dp[i][0] + dp[i][1];\n                        }\n                    }\n                }\n            } else {\n                ll c = C[rem] - '0';\n                if (A[rem] == '?') {\n                    if (B[rem] == '?') {\n                        if (rem != 0) {\n                            dp[i + 1][0] += multiply(dp[i][0], c + 1) + multiply(dp[i][1], c);\n                        } else {\n                            if (c >= 2) {\n                                dp[i + 1][0] += multiply(dp[i][0], c - 1) + multiply(dp[i][1], c - 2);\n                            }\n                        }\n                        ll tmp = 9 - c;\n                        ll tmpb = 9 - (c - 1);\n                        dp[i + 1][1] += multiply(dp[i][0], tmp) + multiply(dp[i][1], tmpb);\n                    } else {\n                        ll b = B[rem] - '0';\n                        if (rem != 0) {\n                            if (0 <= c - b) {\n                                dp[i + 1][0] += dp[i][0];\n                            }\n                            if (0 <= c - 1 - b) {\n                                dp[i + 1][0] += dp[i][1];\n                            }\n                        } else {\n                            if (0 < c - b) {\n                                dp[i + 1][0] += dp[i][0];\n                            }\n                            if (0 < c - 1 - b) {\n                                dp[i + 1][0] += dp[i][1];\n                            }\n                        }\n                        if (10 + c - b <= 9) {\n                            dp[i + 1][1] += dp[i][0];\n                        }\n                        if (10 + c - 1 - b <= 9) {\n                            dp[i + 1][1] += dp[i][1];\n                        }\n                    }\n                } else {\n                    ll a = A[rem] - '0';\n                    if (B[rem] == '?') {\n                        if (rem != 0) {\n                            if (0 <= c - a) {\n                                dp[i + 1][0] += dp[i][0];\n                            }\n                            if (0 <= c - 1 - a) {\n                                dp[i + 1][0] += dp[i][1];\n                            }\n                        } else {\n                            if (0 < c - a) {\n                                dp[i + 1][0] += dp[i][0];\n                            }\n                            if (0 < c - 1 - a) {\n                                dp[i + 1][0] += dp[i][1];\n                            }\n                        }\n                        if (10 + c - a <= 9) {\n                            dp[i + 1][1] += dp[i][0];\n                        }\n                        if (10 + c - 1 - a <= 9) {\n                            dp[i + 1][1] += dp[i][1];\n                        }\n                    } else {\n                        ll b = B[rem] - '0';\n                        if (a + b == c) {\n                            dp[i + 1][0] += dp[i][0];\n                        }\n                        if (a + b == c - 1) {\n                            dp[i + 1][0] += dp[i][1];\n                        }\n                        if (a + b == c + 10) {\n                            dp[i + 1][1] += dp[i][0];\n                        }\n                        if (a + b == c - 1 + 10) {\n                            dp[i + 1][1] += dp[i][1];\n                        }\n                    }\n                }\n            }\n            dp[i + 1][0] = dp[i + 1][0] % mod;\n            dp[i + 1][1] = dp[i + 1][1] % mod;\n        }\n        // REP(i, 0, len + 1) {\n        //     cout << dp[i][0] << \" \";\n        // }\n        // cout << endl;\n        // REP(i, 0, len + 1) {\n        //     cout << dp[i][1] << \" \";\n        // }\n        // cout << endl;\n        ll ans = dp[len][0];\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nll dp[128][2];\nstring A,B,C;\n\nll dfs(int n, int over){\n  if(n<0){\n    if(over) return 0;\n    return 1;\n  }\n  ll &res = dp[n][over];\n  if(res >= 0) return res;\n  //  cout << n << \" \" << over << endl;\n  res = 0;\n  int a = A[n]-'0', b = B[n]-'0', c = C[n]-'0';\n  if(A[n]!='?'&&B[n]!='?'&&C[n]!='?'){\n    //    cout << n << \" \" << over << \" \" << A[n] << B[n] << C[n] << endl;\n    if((a+b)%10==c && (a+b)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n    if((a+b+1)%10==c && (a+b+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n  }else if(A[n]!='?'&&B[n]!='?'){\n    if((a+b)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n    if((a+b+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n  }else if(C[n]!='?'){\n    if(A[n]!='?'||B[n]!='?'){\n      if(b < 10) swap(a, b);\n      for(int i=(n==A.size()-1?1:0);i<10;i++){\n\t//\tcout << a << \" \" << i << \" \" << ((a+i)%10==c) << \" \" << over << endl;\n\tif((a+i)%10 == c && (a+i)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\tif((a+i+1)%10 == c && (a+i+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n      }\n    }else{\n      for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++){\n\t  if((i+j)%10 == c && (i+j)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\t  if((i+j+1)%10 == c && (i+j+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t}\n    }\n  }else if(A[n]!='?'||B[n]!='?'){\n    if(b<10) swap(a,b);\n    for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++){\n\t//\tcout << i << \" \" << j << \" \" << ((a+i)%10==j) << \" \" << ((a+i)/10==over) << endl;\n\t//\tcout << i << \" \" << j << \" \" << ((a+i+1)%10==j) << \" \" << ((a+i)/10 == over) << endl;\n\n\tif((a+i)%10 == j && (a+i)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\tif((a+i+1)%10 == j && (a+i+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t//\tif(n==3&&(((a+i)%10 == j && (a+i)/10 == over) || ((a+i+1)%10 == j && (a+i+1)/10 == over)))\n\t//\t  cout << n << \" \" << i << \" \" << j << \" \" << res << endl;\n      }\n  }else{\n    for(int i=(n==A.size()-1?1:0);i<10;i++) for(int j=(n==A.size()-1?1:0);j<10;j++) for(int k=(n==A.size()-1?1:0);k<10;k++){\n\t  if((i+j)%10 == k && (i+j)/10 == over) res = (res+dfs(n-1, 0))%MOD;\n\t  if((i+j+1)%10 == k && (i+j+1)/10 == over) res = (res+dfs(n-1, 1))%MOD;\n\t  //\t  if(n==32 && (((i+j)%10 == k && (i+j)/10 == over)) || (((i+j+1)%10 == k && (i+j+1)/10 == over)))\n\t  //\t    cout << n << \" \" << i << \" \" << j << \" \" << k << \" \" << res << endl;\n\t}\n  }\n\n  return res;\n}\n\nint main(){\n  while(cin >> A, A!=\"0\"){\n    cin >> B >> C;\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    memset(dp, -1, sizeof(dp));\n    cout << dfs(A.size()-1, 0)%MOD << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = ll(1e9 + 7);\nstring A, B, C;\n\nint N;\nll dp[51][2][2];\n\nint main(){\n    while(cin >> A, A != \"0\"){\n        cin >> B >> C;\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        N = A.size();\n        memset(dp, 0, sizeof dp);\n        int sle = 1;\n        dp[0][0][sle] = 1;\n        for(int i = 0; i < N; i++){\n            for(int c = 0; c < 2; c++){\n                for(int le = 0; le < 2; le++){\n                    //cerr << i << \" \" << c << \" \" << le << \" \" << dp[i][c][le] << endl;\n\n                    if(dp[i][c][le] == 0) continue;\n\n                    int fixa = -1, fixb = -1;\n                    if(isdigit(A[i])) fixa = A[i] - '0';\n                    if(isdigit(B[i])) fixb = B[i] - '0';\n                    for(int a = 0; a < 10; a++){\n                        if(fixa != -1 && a != fixa) continue;\n                        if(i == N - 1 && a == 0) continue;\n                        for(int b = 0; b < 10; b++){\n                            if(fixb != -1 && b != fixb) continue;\n                            if(i == N - 1 && b == 0) continue;\n\n                            int s = a + b + c;\n                            int x = s % 10;\n\n                            //cerr << \"\\t\" <<  a << \" \" << b << \" \" << x << endl;\n                            if(isdigit(C[i]) && C[i] - '0' != x) continue;\n                            int cc = isdigit(C[i]) ? C[i] - '0' : 9;\n\n                            int ncarry = s / 10;\n                            int nle = 0;\n                            if(le){\n                                nle = (x <= cc);\n                            }\n                            else{\n                                nle = (x < cc);\n                            }\n                            \n\n                            dp[i + 1][ncarry][nle] += dp[i][c][le];\n                            dp[i + 1][ncarry][nle] %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << dp[N][0][1] << endl;\n        //return 0;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <string>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\nll dp[51][2];\nstring str[3];\nint l[3],r[3];\nint main(void){\n\twhile(1){\n\t\tcin >> str[0];\n\t\tif(str[0]==\"0\")break;\n\t\tcin >> str[1];\n\t\tcin >> str[2];\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][0]=1;\n\t\tfor(int i=0;i<str[2].size();i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tl[j]=r[j]=0;\n\t\t\t\tif(str[j].size()>i){\n\t\t\t\t\tif(str[j][str[j].size()-i-1]>='0' && str[j][str[j].size()-i-1]<='9'){\n\t\t\t\t\t\tl[j]=str[j][str[j].size()-i-1]-'0';\n\t\t\t\t\t\tr[j]=str[j][str[j].size()-i-1]-'0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tl[j]=0;\n\t\t\t\t\t\tr[j]=9;\n\t\t\t\t\t\tif(str[j].size()==i+1)l[j]=1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int n=0;n<2;n++){\n\t\t\t\tfor(int j=l[0];j<=r[0];j++){\n\t\t\t\t\tfor(int k=l[1];k<=r[1];k++){\n\t\t\t\t\t\tfor(int m=l[2];m<=r[2];m++){\n\t\t\t\t\t\t\tif((n+j+k)%10==m){\n\t\t\t\t\t\t\t\tdp[i+1][(n+j+k)/10]=(dp[i+1][(n+j+k)/10]+dp[i][n])%MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",dp[str[2].size()][0]); \n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll MOD = 1000000007;\nint main(){\n  string a,b,c;\n  while(cin >> a,a!=\"0\"){\n    cin >> b >> c;\n    ll n=a.size()-1;\n    ll i,j,k;\n    ll ans[85][2]={{}};\n    ans[n+1][0]=1;\n    for(i=n;i>0;i--){\n      if(a[i]!='?'){\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(a[i]+b[i]-'0'==c[i]) ans[i][0]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]-1) ans[i][0]=ans[i+1][1];\n\t    if(a[i]+b[i]-'0'==c[i]+10) ans[i][1]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]+10-1) ans[i][1]=ans[i+1][1];\n\t  }else{\n\t    if(a[i]-'0'+b[i]-'0'<10) ans[i][0]+=ans[i+1][0];\n\t    else ans[i][1]+=ans[i+1][0];\n\t    if(a[i]-'0'+b[i]-'0'+1<10) ans[i][0]+=ans[i+1][1];\n\t    else ans[i][1]+=ans[i+1][1];\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    if(a[i]==c[i]){\n\t      ans[i][0]+=ans[i+1][0];\n\t      ans[i][1]+=ans[i+1][1];\n\t    }else if(a[i]<c[i]){\n\t      ans[i][0]+=ans[i+1][0]+ans[i+1][1];\n\t    }else{\n\t      ans[i][1]+=ans[i+1][0]+ans[i+1][1];\n\t    }\n\t  }else{\n\t    k=a[i]-'0';\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+1));\n\t    ans[i][1]+=ans[i+1][1]*(k+1);\n\t    ans[i][0]+=ans[i+1][0]*(10-k);\n\t    ans[i][1]+=ans[i+1][0]*k;\n\t  }\n\t}\n      }else{\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(b[i]==c[i]){\n\t      ans[i][0]+=ans[i+1][0];\n\t      ans[i][1]+=ans[i+1][1];\n\t    }else if(b[i]<c[i]){\n\t      ans[i][0]+=ans[i+1][0]+ans[i+1][1];\n\t    }else{\n\t      ans[i][1]+=ans[i+1][0]+ans[i+1][1];\n\t    }\n\t  }else{\n\t    k=b[i]-'0';\n\t    ans[i][0]+=ans[i+1][1]*(10-(k+1));\n\t    ans[i][1]+=ans[i+1][1]*(k+1);\n\t    ans[i][0]+=ans[i+1][0]*(10-k);\n\t    ans[i][1]+=ans[i+1][0]*k;\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    k=c[i]-'0';\n\t    ans[i][0]+=ans[i+1][0]*(k+1);\n\t    ans[i][1]+=ans[i+1][0]*(10-(k+1));\n\t    ans[i][0]+=ans[i+1][1]*k;\n\t    ans[i][1]+=ans[i+1][1]*(10-k);\n\t  }else{\n\t    ans[i][0]+=ans[i+1][0]*55+ans[i+1][1]*45;\n\t    ans[i][1]+=ans[i+1][0]*45+ans[i+1][1]*55;\n\t  }\n\t}\n      }\n      ans[i][0]%=MOD;\n      ans[i][1]%=MOD;\n      //cout << ans[i][0] << \":\" << ans[i][1] << endl;\n    }\n\n\n    \n    i=0;\n    if(a[i]!='0'&&b[i]!='0'&&c[i]!='0'){\n      if(a[i]!='?'){\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(a[i]+b[i]-'0'==c[i]) ans[i][0]=ans[i+1][0];\n\t    if(a[i]+b[i]-'0'==c[i]-1) ans[i][0]=ans[i+1][1];\n\t  }else{\n\t    if(a[i]-'0'+b[i]-'0'<10) ans[i][0]+=ans[i+1][0];\n\t    if(a[i]-'0'+b[i]-'0'+1<10) ans[i][0]+=ans[i+1][1];\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    if(a[i]<c[i])ans[i][0]+=ans[i+1][0];\n\t    if(a[i]+1<c[i])ans[i][0]+=ans[i+1][1];\n\t  }else{\n\t    k=a[i]-'0';\n\t    if(0<(10-(k+1))) ans[i][0]+=ans[i+1][0]*(10-(k+1));\n\t    if(0<(10-(k+2))) ans[i][0]+=ans[i+1][1]*(10-(k+2));\n\t  }\n\t}\n      }else{\n\tif(b[i]!='?'){\n\t  if(c[i]!='?'){\n\t    if(b[i]<c[i])ans[i][0]+=ans[i+1][0];\n\t    if(b[i]+1<c[i])ans[i][0]+=ans[i+1][1];\n\t  }else{\n\t    k=b[i]-'0';\n\t    if(0<(10-(k+1))) ans[i][0]+=ans[i+1][0]*(10-(k+1));\n\t    if(0<(10-(k+2))) ans[i][0]+=ans[i+1][1]*(10-(k+2));\n\t  }\n\t}else{\n\t  if(c[i]!='?'){\n\t    k=c[i]-'0';\n\t    if(0<k-1) ans[i][0]+=ans[i+1][0]*(k-1);\n\t    if(0<k-2) ans[i][0]+=ans[i+1][1]*(k-2);\n\t  }else{\n\t    ans[i][0]+=ans[i+1][0]*36+ans[i+1][1]*28;\n\t  }\n\t}\n      }\n    }\n    //cout << ans[i][0] << \":\" << ans[i][1] << endl;\n    cout << ans[0][0]%MOD << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <fstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n#include <queue>\n#include <stack>\n#include <array>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <cstdint>\n#include <functional>\n#include <iomanip>\n#include <numeric>\n#include <assert.h>\n#include <bitset>\n#include <list>\n#include <cmath>\n#include <complex>\n\nusing namespace std;\n\n\ntemplate<typename T>\nvoid fillall(T& arr, const T& v) {\n\tarr = v;\n}\ntemplate<typename T, size_t N, class U>\nvoid fillall(T(& arr)[N], const U& v) {\n\tfor (auto& r: arr)fillall(r, v);\n}\n\nchar A[55];\nchar B[55];\nchar C[55];\nconst int64_t MOD = 1000000007;\nint64_t func(int i, int p);\nint64_t check(int i, char a, char b, char c, int p)\n{\n\tif ((a + b) == c + p * 10) {\n\t\treturn func(i, 0);\n\t}\n\tif ((a + b + 1) == c + p * 10) {\n\t\treturn func(i, 1);\n\t}\n\treturn 0;\n}\nint64_t dp[55][2];\nint64_t func(int i, int p)\n{\n\tauto& memo = dp[i][p];\n\tif (A[i] == '\\0') {\n\t\tif (p == 0) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\tif (memo != -1) {\n\t\treturn memo;\n\t}\n\n\tmemo = 0;\n\tfor (int a = 0; a < 10; ++a)\n\t{\n\t\tif (i == 0 && a == 0) { continue; }\n\t\tif (!(A[i] == '?' || A[i] == a+ '0')) { continue; }\n\t\tfor (int b = 0; b < 10; ++b)\n\t\t{\n\t\t\tif (i == 0 && b == 0) { continue; }\n\t\t\tif (!(B[i] == '?' || B[i] == b + '0')) { continue; }\n\t\t\tfor (int c = 0; c < 10; ++c)\n\t\t\t{\n\t\t\t\tif (i == 0 && c == 0) { continue; }\n\t\t\t\tif (!(C[i] == '?' || C[i] == c + '0')) { continue; }\n\n\n\t\t\t\tmemo += check(i+1, a, b, c, p);\n\t\t\t\tmemo %= MOD;\n\t\t\t}\n\t\t}\n\t}\n\treturn memo;\n}\n\n\n\nint main()\n{\n\tfor (;;)\n\t{\n\t\tfillall(dp, (int64_t )-1);\n\t\tcin >> A;\n\t\tif (A[0] == '0') { break; }\n\t\tcin >> B >> C;\n\t\t//for (size_t i = 0; A[i] != '\\0'; i++)\n\t\t//{\n\t\t//\tif (A[i] != '?') { A[i] -= '0'; }\n\t\t//\tif (B[i] != '?') { B[i] -= '0'; }\n\t\t//\tif (C[i] != '?') { C[i] -= '0'; }\n\t\t//}\n\n\t\tcout << (func(0, 0)) % MOD << endl;\n\t}\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\n\n\n\nconst int mod = 1000000007;\nstruct Mod {\npublic:\n\tint num;\n\tMod() : num(0) { ; }\n\tMod(long long int n) : num((n % mod + mod) % mod) { ; }\n\tMod(int n) : num((n % mod + mod) % mod) { ; }\n\toperator int() { return num; }\n};\n\nMod operator+(const Mod a, const Mod b) { return Mod((a.num + b.num) % mod); }\nMod operator+(const long long int a, const Mod b) { return Mod(a) + b; }\nMod operator++(Mod &a) { return a + Mod(1); }\nMod operator-(const Mod a, const Mod b) { return Mod((mod + a.num - b.num) % mod); }\nMod operator-(const long long int a, const Mod b) { return Mod(a) - b; }\nMod operator--(Mod &a) { return a - Mod(1); }\nMod operator*(const Mod a, const Mod b) { return Mod(((long long)a.num * b.num) % mod); }\nMod operator*(const long long int a, const Mod b) { return Mod(a)*b; }\nMod operator+=(Mod &a, const Mod b) { return a = a + b; }\nMod operator+=(long long int &a, const Mod b) { return a = a + b; }\nMod operator-=(Mod &a, const Mod b) { return a = a - b; }\nMod operator-=(long long int &a, const Mod b) { return a = a - b; }\nMod operator*=(Mod &a, const Mod b) { return a = a * b; }\nMod operator*=(long long int &a, const Mod b) { return a = a * b; }\nMod operator^(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = (a * a) ^ (n / 2);\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod mod_pow(const Mod a, const int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = mod_pow((a * a), (n / 2));\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod inv(const Mod a) { return a ^ (mod - 2); }\nMod operator/(const Mod a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a * inv(b);\n}\nMod operator/(const long long int a, const Mod b) {\n\tassert(b.num != 0);\n\treturn Mod(a) * inv(b);\n}\nMod operator/=(Mod &a, const Mod b) {\n\tassert(b.num != 0);\n\treturn a = a * inv(b);\n}\n\n#define MAX_MOD_N 1024000\n\nMod fact[MAX_MOD_N], factinv[MAX_MOD_N];\nvoid init() {\n\tfact[0] = Mod(1); factinv[0] = 1;\n\tfor (int i = 0; i < MAX_MOD_N - 1; ++i) {\n\t\tfact[i + 1] = fact[i] * Mod(i + 1);\n\t\tfactinv[i + 1] = factinv[i] / Mod(i + 1);\n\t}\n}\nMod comb(const int a, const int b) {\n\treturn fact[a] * factinv[b] * factinv[a - b];\n}\n\nint main() {\n\twhile (1) {\n\t\tstring st[3]; cin >> st[0];\n\t\tif (st[0] == \"0\")break;\n\t\tcin>> st[1] >> st[2];\n\t\tMod dp[51][10];\n\t\tdp[st[0].size()][0] = 1;\n\t\tfor (int i = st[0].size()-1; i > 0; --i) {\n\t\t\tchar a, b, c; a = st[0][i];\n\t\t\tb = st[1][i]; c = st[2][i];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 0; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 0; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 0; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10==z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\n\t\t\t\t\t\t\t\tdp[i][amari] += dp[i+1][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tMod ans = 0;\n\t\t{\n\t\t\tchar a, b, c; a = st[0][0];\n\t\t\tb = st[1][0]; c = st[2][0];\n\t\t\tint al, ar, bl, br, cl, cr;\n\t\t\tif (a == '?') {\n\t\t\t\tal = 1; ar = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tal = a - '0';\n\t\t\t\tar = a - '0';\n\t\t\t}\n\t\t\tif (b == '?') {\n\t\t\t\tbl = 1; br = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbl = b - '0';\n\t\t\t\tbr = b - '0';\n\t\t\t}\n\t\t\tif (c == '?') {\n\t\t\t\tcl = 1; cr = 9;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcl = c - '0';\n\t\t\t\tcr = c - '0';\n\t\t\t}\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tfor (int x = al; x <= ar; ++x) {\n\t\t\t\t\tfor (int y = bl; y <= br; ++y) {\n\t\t\t\t\t\tfor (int z = cl; z <= cr; ++z) {\n\t\t\t\t\t\t\tif ((j + x + y) % 10 == z) {\n\t\t\t\t\t\t\t\tint amari = (x + y + j) / 10;\nif(!amari)\t\t\t\t\t\t\t\tans += dp[0][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tcout << ans << endl;\n\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n#include<deque>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define LINF (ll)INF*INF\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(int i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\n#define int ll //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef vector<pii> vp;\ntypedef deque<int> di;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\nsigned main(void) {\n    int i,j;\n    string a,b,c;\n    while(cin >> a, a != \"0\"){\n        cin >> b;\n        cin >> c;\n        reverse(all(a));\n        reverse(all(b));\n        reverse(all(c));\n        int n = a.size();\n        vector<vi> dp(n+1,vi(2,0));\n        dp[0][0]++;\n        rep(i,n)rep(j,2)if(dp[i][j]){\n            rep(x,10)rep(y,10){\n                if(i == n-1 && (!x || !y))continue;\n                if(a[i] != '?' && a[i] - '0' != x)continue;\n                if(b[i] != '?' && b[i] - '0' != y)continue;\n                if(c[i] != '?' && c[i] - '0' != (x + y + j)%10)continue;\n                (dp[i+1][(x+y+j)/10] += dp[i][j]) %= MOD;\n            }\n        }\n\n        cout << dp[n][0] << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long lli;\n\nconst lli mod = 1000000007LL;\nconst lli MAXN = 100;\nlli N;\nstring A, B, C;\nlli dp[MAXN][2];\n\nint main() {\n  while(cin >> A && A != \"0\") {\n    cin >> B >> C;\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    N = A.size();\n    memset(dp, 0, sizeof(dp));\n    dp[0][0] = 1;\n    for(lli i = 0; i < N; ++i) {\n      for(lli j = 0; j < 2; ++j) {\n        if(!dp[i][j]) continue;\n        vector<lli> a, b;\n        if(A[i] == '?') {\n          for(lli d = i+1==N; d <= 9; ++d) a.push_back(d);\n        } else {\n          a.push_back(A[i]-'0');\n        }\n        if(B[i] == '?') {\n          for(lli d = i+1==N; d <= 9; ++d) b.push_back(d);\n        } else {\n          b.push_back(B[i]-'0');\n        }\n        for(lli s = 0; s < a.size(); ++s) {\n          for(lli t = 0; t < b.size(); ++t) {\n            lli c = a[s] + b[t] + j;\n            lli nj = c / 10;\n            c %= 10;\n            if(C[i] != '?' && C[i]-'0' != c) continue;\n            if(i+1 == N && c == 0) continue;\n            ( dp[i+1][nj] += dp[i][j] ) %= mod;\n          }\n        }\n      }\n    }\n    cout << dp[N][0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = ll(1e9 + 7);\nstring A, B, C;\n\nint N;\nll dp[51][2][2];\n\nint main(){\n    while(cin >> A, A != \"0\"){\n        cin >> B >> C;\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        N = A.size();\n        memset(dp, 0, sizeof dp);\n        int sle = 1;\n        dp[0][0][sle] = 1;\n        for(int i = 0; i < N; i++){\n            for(int c = 0; c < 2; c++){\n                for(int le = 0; le < 2; le++){\n                    //cerr << i << \" \" << c << \" \" << le << \" \" << dp[i][c][le] << endl;\n\n                    if(dp[i][c][le] == 0) continue;\n\n                    int fixa = -1, fixb = -1;\n                    if(isdigit(A[i])) fixa = A[i] - '0';\n                    if(isdigit(B[i])) fixb = B[i] - '0';\n                    for(int a = 0; a < 10; a++){\n                        if(fixa != -1 && a != fixa) continue;\n                        if(i == N - 1 && a == 0) continue;\n                        for(int b = 0; b < 10; b++){\n                            if(fixb != -1 && b != fixb) continue;\n                            if(i == N - 1 && b == 0) continue;\n\n                            int s = a + b + c;\n                            int x = s % 10;\n\n                            //cerr << \"\\t\" <<  a << \" \" << b << \" \" << x << endl;\n                            if(isdigit(C[i]) && C[i] - '0' != x) continue;\n                            int cc = isdigit(C[i]) ? C[i] - '0' : 9;\n\n                            int ncarry = s / 10;\n                            int nle = 0;\n                            if(le){\n                                nle = (x <= cc);\n                            }\n                            else{\n                                nle = (x < cc);\n                            }\n                            \n\n                            dp[i + 1][ncarry][nle] += dp[i][c][le];\n                            dp[i + 1][ncarry][nle] %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << dp[N][0][1] << endl;\n        //return 0;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nconstexpr int MOD = 1e9+7;\n\nusing ll = long long;\n\nint main() {\n    string A, B, C;\n    while(cin >> A, A != \"0\") {\n        cin >> B >> C;\n        reverse(A.begin(), A.end());\n        reverse(B.begin(), B.end());\n        reverse(C.begin(), C.end());\n\n        vector<vector<ll>> dp(2, vector<ll>(A.size()+1, 0));\n        dp[0][0] = 1;\n        for(int i=0; i<A.size(); ++i) {\n            char a = A[i], b = B[i], c = C[i]; \n            int an = A[i]-'0', bn = B[i]-'0', cn = C[i]-'0';\n            int check = 0;\n            int l = (i == A.size()-1 ? 1 : 0);\n            for(int j=0; j<2; ++j) {\n                if(dp[j][i] == 0) {\n                    continue;\n                }\n                if(a != '?' && b != '?') {\n                    if(c != '?' && (a-'0' + b-'0' + j)%10 != c-'0') {\n                        continue;\n                    } else {\n                        (dp[(an+bn+j)/10][i+1] += dp[j][i]) %= MOD;\n                    }\n                } else if(a != '?' || b != '?') {\n                    int num = (a != '?' ? an : bn);\n                    if(c != '?') {\n                        for(int k=l; k<10; ++k) {\n                            if(cn == (num + k + j)%10) {\n                                (dp[(num+k+j)/10][i+1] += dp[j][i]) %= MOD;\n                                break;\n                            }\n                        }\n                    } else {\n                        for(int k=l; k<10; ++k) {\n                            (dp[(num+k+j)/10][i+1] += dp[j][i]) %= MOD;\n                        }\n                    }\n                } else {\n                    if(c != '?') {\n                        for(int k=l; k<10; ++k) {\n                            for(int m=l; m<10; ++m) {\n                                if(cn == (k+m+j)%10) {\n                                    (dp[(k+m+j)/10][i+1] += dp[j][i]) %= MOD;\n                                }\n                            }\n                        }\n                    } else {\n                        for(int k=l; k<10; ++k) {\n                            for(int m=l; m<10; ++m) {\n                                (dp[(k+m+j)/10][i+1] += dp[j][i]) %= MOD;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[0][A.size()] << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define mod 1000000007\nusing namespace std;\n\nstring s[3];\nlong long dp[2][51];\n\nvoid solve(){\n\tint t = s[0].size();\n\trep(i,2) rep(j,51) dp[i][j] = 0;\n\tfor(int i = t-1; i >= 0; i--){\n\t\trep(j,10){\n\t\t\tif(s[0][i] != '?') j = s[0][i]-'0';\n\t\t\tif(i == 0 && j == 0) continue;\n\t\t\trep(k,10){\n\t\t\t\tif(s[1][i] != '?') k = s[1][i]-'0';\n\t\t\t\tif(i == 0 && k == 0) continue;\n\t\t\t\trep(l,10){\n\t\t\t\t\tif(s[2][i] != '?') l = s[2][i]-'0';\n\t\t\t\t\tif(i == 0 && l == 0) continue;\n\t\t\t\t\t\n\t\t\t\t\tif(i == t-1){\n\t\t\t\t\t\tif(j+k == l) dp[0][i]++;\n\t\t\t\t\t\tif(j+k == l+10) dp[1][i]++;\n\t\t\t\t\t} else{\n\t\t\t\t\t\tif(j+k == l){\n\t\t\t\t\t\t\tdp[0][i] += dp[0][i+1];\n\t\t\t\t\t\t\tif(dp[0][i] > mod) dp[0][i] -= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j+k == l-1){\n\t\t\t\t\t\t\tdp[0][i] += dp[1][i+1];\n\t\t\t\t\t\t\tif(dp[0][i] > mod) dp[0][i] -= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j+k == l+10){\n\t\t\t\t\t\t\tdp[1][i] += dp[0][i+1];\n\t\t\t\t\t\t\tif(dp[1][i] > mod) dp[1][i] -= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j+k == l+10-1){\n\t\t\t\t\t\t\tdp[1][i] += dp[1][i+1];\n\t\t\t\t\t\t\tif(dp[1][i] > mod) dp[1][i] -= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(s[2][i] != '?') break;\n\t\t\t\t}\n\t\t\t\tif(s[1][i] != '?') break;\n\t\t\t}\n\t\t\tif(s[0][i] != '?') break;\n\t\t}\n\t}\n\tcout << dp[0][0] << endl;\n}\n\nint main(){\n\twhile(cin >> s[0] >> s[1] >> s[2]){\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tint n = B.size();\n\n\t\tll dp[55][2] = { 0 };\n\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tfor(int j = 0; j < 2; j++) {\n\t\t\t\tint q = 0, s = 0, t = 0;\n\t\t\t\tif(A[i] == '?') q++;\n\t\t\t\telse s += A[i] - '0';\n\t\t\t\tif(B[i] == '?') q++;\n\t\t\t\telse s += B[i] - '0';\n\t\t\t\tif(C[i] != '0') t = C[i] - '0';\n\n\t\t\t\tif(q == 2) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tfor(int b = 0; b <= 9; b++) {\n\t\t\t\t\t\t\tif(i == n - 1 && b == 0) continue;\n\t\t\t\t\t\t\tif(i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n\t\t\t\t\t\t\tif((C[i] == '?' || (a + b + j) % 10 == t)) {\n\t\t\t\t\t\t\t\tint nj = a + b + j >= 10;\n\t\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(q == 1) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tif((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n\t\t\t\t\t\tif(C[i] == '?' || (s + a + j) % 10 == t) {\n\t\t\t\t\t\t\tif(s + a + j >= 10) {\n\t\t\t\t\t\t\t\t(dp[i + 1][1] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t(dp[i + 1][0] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // q == 0\n\t\t\t\t\tif((i == n - 1 && (s + j) % 10 == 0)) continue;\n\t\t\t\t\tif(C[i] == '?' || (s + j) % 10 == t) {\n\t\t\t\t\t\tif((s + j) >= 10) {\n\t\t\t\t\t\t\t(dp[i + 1][1] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t(dp[i + 1][0] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}// for j\n\t\t}// for i\n\t\tcout << dp[n][0] << endl;\n\t}// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-10;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\nint n;\nll dp[55][2];\nstring a, b, c;\n\nll solve(int i, int j)\n{\n\tif (dp[i][j] >= 0) return dp[i][j];\n\tchar l = a[i], m = b[i], r = c[i];\n\tint x = l - '0', y = m - '0', z = r - '0';\n\tll res;\n\tif (i == 0)\n\t{\n\t\tif (l == '?'&&m == '?'&&r == '?')\t   // ?+?=?\n\t\t{\n\t\t\tif (j == 0) res = 36;\n\t\t\telse res = 28;\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r != '?') // x+y=z\n\t\t{\n\t\t\tif (j + x + y == z) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // ?+?=z\n\t\t{\n\t\t\tif (j == 0) res = z - 1;\n\t\t\telse res = max(0, z - 2);\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r == '?') // x+y=?\n\t\t{\n\t\t\tif (x + y + j < 10) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (r == '?')\t\t\t\t\t   // x+?=? || ?+y=?\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0) res = 9 - x;\n\t\t\telse res = max(0, 8 - x);\n\t\t}\n\t\telse\t\t\t\t\t\t\t\t   // x+?=z || ?+y=z\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j + x < z) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (l == '?'&&m == '?'&&r == '?')\t   // ?+?=?\n\t\t{\n\t\t\tif(j==0) res = solve(i - 1, 0) * 55 + solve(i - 1, 1) * 45;\n\t\t\telse res = solve(i - 1, 0) * 45 + solve(i - 1, 1) * 55;\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r != '?') // x+y=z\n\t\t{\n\t\t\tif ((j + x + y) % 10 == z) res = solve(i - 1, (j + x + y) / 10);\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // ?+?=z\n\t\t{\n\t\t\tif(j==0) res = solve(i - 1, 0)*(z + 1) + solve(i - 1, 1)*(9 - z);\n\t\t\telse res = solve(i - 1, 0)*z + solve(i - 1, 1)*(10 - z);\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r == '?') // x+y=?\n\t\t{\n\t\t\tif (x + y + j < 10) res = solve(i - 1, 0);\n\t\t\telse res = solve(i - 1, 1);\n\t\t}\n\t\telse if (r == '?')\t\t\t\t\t   // x+?=? || ?+y=?\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0) res = solve(i - 1, 0)*(10 - x) + solve(i - 1, 1)*x;\n\t\t\telse res = solve(i - 1, 0)*(9 - x) + solve(i - 1, 1)*(x + 1);\n\t\t}\n\t\telse\t\t\t\t\t\t\t\t   // x+?=z || ?+y=z\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0)\n\t\t\t{\n\t\t\t\tif (x <= z) res = solve(i - 1, 0);\n\t\t\t\telse res = solve(i - 1, 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (x+1 <= z) res = solve(i - 1, 0);\n\t\t\t\telse res = solve(i - 1, 1);\n\t\t\t}\n\t\t}\n\t}\n\treturn dp[i][j] = res%MOD;\n}\n\nint main()\n{\n\twhile (cin >> a >> b >> c, a != \"0\")\n\t{\n\t\tn = a.size();\n\t\tMS(dp, -1);\n\t\tcout << solve(n - 1, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nusing ll = long long;\nusing ld = long double;\nusing P = pair<int, int>;\nconstexpr ld EPS = 1e-12;\nconstexpr int INF = numeric_limits<int>::max() / 2;\nconstexpr int MOD = 1e9 + 7;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    string a, b, c;\n    while (cin >> a, a != \"0\")\n    {\n        cin >> b >> c;\n        int n = a.length();\n        vector<vector<ll>> dp(n + 1, vector<ll>(2, 0));\n        dp[0][0] = 1;\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n        a = \"$\" + a;\n        b = \"$\" + b;\n        c = \"$\" + c;\n        for (int i = 1; i <= n; i++)\n        {\n            int st = 0;\n            if (i == n)\n                st++;\n            int a1, a2, b1, b2, c1, c2;\n            if (a[i] == '?')\n            {\n                a1 = st;\n                a2 = 9;\n            }\n            else\n            {\n                a1 = a[i] - '0';\n                a2 = a[i] - '0';\n            }\n            if (b[i] == '?')\n            {\n                b1 = st;\n                b2 = 9;\n            }\n            else\n            {\n                b1 = b[i] - '0';\n                b2 = b[i] - '0';\n            }\n            if (c[i] == '?')\n            {\n                c1 = st;\n                c2 = 9;\n            }\n            else\n            {\n                c1 = c[i] - '0';\n                c2 = c[i] - '0';\n            }\n            for (int j = a1; j <= a2; j++)\n            {\n                for (int k = b1; k <= b2; k++)\n                {\n                    int gt = (j + k) % 10;\n                    if (j + k >= 10)\n                    {\n                        if (c1 <= gt && gt <= c2)\n                        {\n                            dp[i][1] += dp[i - 1][0];\n                            dp[i][1] %= MOD;\n                        }\n                    }\n                    else\n                    {\n                        if (c1 <= gt && gt <= c2)\n                        {\n                            dp[i][0] += dp[i - 1][0];\n                            dp[i][0] %= MOD;\n                        }\n                    }\n\n                    gt = (j + k + 1) % 10;\n                    if (j + k + 1 >= 10)\n                    {\n                        if (c1 <= gt && gt <= c2)\n                        {\n                            dp[i][1] += dp[i - 1][1];\n                            dp[i][1] %= MOD;\n                        }\n                    }\n                    else\n                    {\n                        if (c1 <= gt && gt <= c2)\n                        {\n                            dp[i][0] += dp[i - 1][1];\n                            dp[i][0] %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(1){\n        string a,b,c;\n        cin>>a;\n        if(a == \"0\")break;\n        cin>>b>>c;\n        int n=a.size();\n        reverse(a.begin(),a.end());\n        reverse(b.begin(),b.end());\n        reverse(c.begin(),c.end());\n        int dp[54][2];\n        for(int i=0;i<n+1;i++)for(int j=0;j<2;j++)dp[i][j]=0;\n        dp[0][0]=1;\n        for(int i=0;i<n;i++){\n            for(int j=0;j<10;j++){\n                if(a[i]!='?'){\n                    if(j)break;\n                    j=a[i]-'0';\n                }\n                if(i==n-1&&!j)continue;\n                for(int k=0;k<10;k++){\n                if(b[i]!='?'){\n                    if(k)break;\n                    k=b[i]-'0';\n                }\n                if(i==n-1&&!k)continue;\n                for(int l=0;l<10;l++){\n                if(c[i]!='?'){\n                    if(l)break;\n                    l=c[i]-'0';\n                }\n                if(i==n-1&&!l)continue;\n                if((j+k)%10==l){\n                    dp[i+1][(j+k)/10]+=dp[i][0];\n                }\n                if((j+k+1)%10==l){\n                    dp[i+1][(j+k+1)/10]+=dp[i][1];\n                }\n                dp[i+1][0]%=mod;\n                dp[i+1][1]%=mod;\n                }\n            }\n        }\n      }\n      cout<<dp[n][0]<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nconst int mod = 1000000007;\n\nint cntq(char a, char b, char c) {\n  int ret = 0;\n  if (a == '?') ret++;\n  if (b == '?') ret++;\n  if (c == '?') ret++;\n  return ret;\n}\n\nint main() {\n  string a, b, c;\n  while (cin >> a, cin >> b, cin >> c, a != \"0\") {\n    int l = a.length();\n\n    // その桁で繰り上がりが生じない場合/生じる場合を分ける\n    vector<vector<long long>> dp(l + 1, vector<long long>(2, 0));\n\n    dp[l] = {1, 0};  // 一番下の桁に0 0 0があるとみなす\n\n    for (int i = l - 1; i >= 0; i--) {\n      int an = a[i] - '0';\n      int bn = b[i] - '0';\n      int cn = c[i] - '0';\n      if (i > 0) {\n        switch (cntq(a[i], b[i], c[i])) {\n          case 0: {\n            int carry = int(an + bn > cn);\n            int diff = (cn - (an + bn) + 10) % 10;\n            if (diff == 0 || diff == 1) {\n              dp[i][carry] = dp[i + 1][diff];\n            }\n          } break;\n          case 1: {\n            if (a[i] == '?') {\n              // その桁で繰り上がりが発生するかしないかは定まる\n              dp[i][cn - bn >= 0 ? 0 : 1] +=\n                  dp[i + 1][0];  // 下の桁で繰り上がりが発生しなかった場合\n              dp[i][cn - bn >= 1 ? 0 : 1] +=\n                  dp[i + 1][1];  // 下の桁で繰り上がりが発生した場合\n            } else if (b[i] == '?') {\n              dp[i][cn - an >= 0 ? 0 : 1] += dp[i + 1][0];\n              dp[i][cn - an >= 1 ? 0 : 1] += dp[i + 1][1];\n            } else {\n              dp[i][an + bn < 10 ? 0 : 1] += dp[i + 1][0];\n              dp[i][an + bn + 1 < 10 ? 0 : 1] += dp[i + 1][1];\n            }\n          } break;\n          case 2: {\n            if (a[i] != '?') {\n              // ?の埋め方は（下の繰り上がりの有無それぞれ）10通りあるので、繰り上がりのあるなしで配分\n              dp[i][0] =\n                  (10 - an) * dp[i + 1][0] + (10 - an - 1) * dp[i + 1][1];\n              dp[i][1] = an * dp[i + 1][0] + (an + 1) * dp[i + 1][1];\n            } else if (b[i] != '?') {\n              dp[i][0] =\n                  (10 - bn) * dp[i + 1][0] + (10 - bn - 1) * dp[i + 1][1];\n              dp[i][1] = bn * dp[i + 1][0] + (bn + 1) * dp[i + 1][1];\n            } else {\n              dp[i][0] = (cn + 1) * dp[i + 1][0] + cn * dp[i + 1][1];\n              dp[i][1] =\n                  (10 - cn - 1) * dp[i + 1][0] + (10 - cn) * dp[i + 1][1];\n            }\n          } break;\n          case 3: {\n            dp[i][0] = 55 * dp[i + 1][0] + 45 * dp[i + 1][1];\n            dp[i][1] = 45 * dp[i + 1][0] + 55 * dp[i + 1][1];\n          }\n        }\n      } else {\n        // 最上位のみ、0が使えないので分ける\n        switch (cntq(a[i], b[i], c[i])) {\n          case 0: {\n            int carry = int(an + bn > cn);\n            int diff = cn - (an + bn) % 10;\n            if (diff == 0 || diff == 1) {\n              dp[i][carry] = dp[i + 1][diff];\n            }\n          } break;\n          case 1: {\n            if (a[i] == '?') {\n              // ?=0になるやつはdp[0][1]に押し込んでしまう\n              dp[i][cn - bn > 0 ? 0 : 1] += dp[i + 1][0];\n              dp[i][cn - bn > 1 ? 0 : 1] += dp[i + 1][1];\n            } else if (b[i] == '?') {\n              dp[i][cn - an > 0 ? 0 : 1] += dp[i + 1][0];\n              dp[i][cn - an > 1 ? 0 : 1] += dp[i + 1][1];\n            } else {\n              dp[i][an + bn < 10 ? 0 : 1] += dp[i + 1][0];\n              dp[i][an + bn + 1 < 10 ? 0 : 1] += dp[i + 1][1];\n            }\n          } break;\n          case 2: {\n            if (a[i] != '?') {\n              // dp[0][0]だけ更新する\n              dp[i][0] =\n                  (9 - an) * dp[i + 1][0] + max(0, 9 - an - 1) * dp[i + 1][1];\n            } else if (b[i] != '?') {\n              dp[i][0] =\n                  (9 - bn) * dp[i + 1][0] + max(0, 9 - bn - 1) * dp[i + 1][1];\n            } else {\n              dp[i][0] =\n                  (cn - 1) * dp[i + 1][0] + max(0, cn - 2) * dp[i + 1][1];\n            }\n          } break;\n          case 3: {\n            // dp[0][0]だけ更新する\n            dp[i][0] = 36 * dp[i + 1][0] + 28 * dp[i + 1][1];\n          }\n        }\n      }\n      dp[i][0] %= mod;\n      dp[i][1] %= mod;\n    }\n    /*\n    for (int i = 0; i <= l; i++) cerr << dp[i][0] << ' ';\n    cerr << endl;\n    for (int i = 0; i <= l; i++) cerr << dp[i][1] << ' ';\n    cerr << endl;\n    */\n\n    cout << dp[0][0] << endl;  //文字数固定なので繰り上がりはなし\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = ll(1e9 + 7);\nstring A, B, C;\n\nint N;\nll dp[51][2];\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tN = A.size();\n\t\tmemset(dp, 0, sizeof dp);\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < N; i++) {\n\t\t\tfor(int c = 0; c < 2; c++) {\n\t\t\t\tfor(int le = 0; le < 2; le++) {\n\t\t\t\t\t//cerr << i << \" \" << c << \" \" << le << \" \" << dp[i][c][le] << endl;\n\n\t\t\t\t\tif(dp[i][c] == 0) continue;\n\n\t\t\t\t\tint fixa = -1, fixb = -1;\n\t\t\t\t\tif(isdigit(A[i])) fixa = A[i] - '0';\n\t\t\t\t\tif(isdigit(B[i])) fixb = B[i] - '0';\n\t\t\t\t\tfor(int a = 0; a < 10; a++) {\n\t\t\t\t\t\tif(fixa != -1 && a != fixa) continue;\n\t\t\t\t\t\tif(i == N - 1 && a == 0) continue;\n\t\t\t\t\t\tfor(int b = 0; b < 10; b++) {\n\t\t\t\t\t\t\tif(fixb != -1 && b != fixb) continue;\n\t\t\t\t\t\t\tif(i == N - 1 && b == 0) continue;\n\n\t\t\t\t\t\t\tint s = a + b + c;\n\t\t\t\t\t\t\tint x = s % 10;\n\n\t\t\t\t\t\t\t//cerr << \"\\t\" <<  a << \" \" << b << \" \" << x << endl;\n\t\t\t\t\t\t\tif(isdigit(C[i]) && C[i] - '0' != x) continue;\n\t\t\t\t\t\t\tint cc = isdigit(C[i]) ? C[i] - '0' : 9;\n\n\t\t\t\t\t\t\tint ncarry = s / 10;\n\n\t\t\t\t\t\t\tdp[i + 1][ncarry] += dp[i][c];\n\t\t\t\t\t\t\tdp[i + 1][ncarry] %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << dp[N][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint main(){\n\tstring s,t,u;\n\twhile(cin >> s,s!=\"0\"){\n\t\tcin >> t >> u;\n\t\tint n = s.length();\n\t\ts += '$';\n\t\tt += '$';\n\t\tu += '$';\n\t\treverse(s.begin(),s.end());\n\t\treverse(t.begin(),t.end());\n\t\treverse(u.begin(),u.end());\n\n\t\tlong long dp[100][2] = {};\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 1;i <= n;i++){\n\t\t\tchar a = s[i],b = t[i],c = u[i];\n\t\t\tint q = 0;\n\t\t\tif(a == '?')q++;\n\t\t\tif(b == '?')q++;\n\t\t\tif(c == '?')q++;\n\t\t\tint p = a - '0' + b - '0';\n\t\t\tswitch(q){\n\t\t\t\tint x,y;\n\t\t\t\tcase 0:\n\t\t\t\t\tx = p % 10;\n\t\t\t\t\ty = p / 10;\n\t\t\t\t\tif(x == c - '0' && y == 0)dp[i][0] += dp[i-1][0];\n\t\t\t\t\tif(x == c - '0' && y == 1)dp[i][1] += dp[i-1][0];\n\t\t\t\t\tif(x != c - '0' && y == 0)dp[i][0] += dp[i-1][1];\n\t\t\t\t\tif(x != c - '0' && y == 1)dp[i][1] += dp[i-1][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tx = p / 10;\n\t\t\t\t\t\ty = (p+1) / 10;\n\t\t\t\t\t\tif(p < 9)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(p == 10)dp[i][0] += dp[i-1][0],dp[i][1] += dp[i-1][1];\n\t\t\t\t\t\tif(p > 10)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tint d = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(d < c)dp[i][0] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t\tif(d == c)dp[i][0] += dp[i-1][0],dp[i][1] = dp[i-1][1];\n\t\t\t\t\t\tif(d > c)dp[i][1] += dp[i-1][0] + dp[i-1][1];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tif(c == '?'){\n\t\t\t\t\t\tx = (a == '?' ? b - '0' : a - '0');\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * max(0,10 - (x + 1 + j));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (10 - (x + j));\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (x + j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\ty = c - '0';\n\t\t\t\t\t\tif(i == n){\n\t\t\t\t\t\t\tfor(int j = 0;j < 2;j++)\n\t\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y - 1 + c);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int j = 0;j < 2;j++){\n\t\t\t\t\t\t\tdp[i][0] += dp[i-1][j] * (y + 1 + j);\n\t\t\t\t\t\t\tdp[i][1] += dp[i-1][j] * (10 - (y + 1 + j));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif(i == n){\n\t\t\t\t\t\tdp[i][0] += dp[i-1][0] * 36 + dp[i-1][1] * 28;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdp[i][0] += dp[i-1][0] * 55 + dp[i-1][1] * 45;\n\t\t\t\t\tdp[i][1] += dp[i-1][0] * 45 + dp[i-1][1] * 55;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdp[i][0] %= 1000000007,dp[i][1] %= 1000000007;\n\t\t}\n\t\tcout << dp[n][0] << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1000000007;\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  string A, B, C;\n  while(cin>>A, A != \"0\"){\n\tcin >> B >> C;\n\tint D = SZ(A);\n\tvector<LL> c(2, 0), c_(2, 0);\n\tc_[0] = 1;\n\tfor(int d=D-1;d>=0;--d){\n\t  c[0] = c[1] = 0;\n\t  for(int i1=(A[d]!='?'?A[d]-'0':0);\n\t\t  i1<(A[d]!='?'?A[d]-'0'+1:10);++i1){\n\t\tif(d==0 && i1 == 0) continue;\n\t\tfor(int i2=(B[d]!='?'?B[d]-'0':0);\n\t\t\ti2<(B[d]!='?'?B[d]-'0'+1:10);++i2){\n\t\t  if(d==0 && i2 == 0) continue;\n\t\t  for(int i3=(C[d]!='?'?C[d]-'0':0);\n\t\t\t  i3<(C[d]!='?'?C[d]-'0'+1:10);++i3){\n\t\t\tif(d==0 && i3 == 0) continue;\n\t\t\tif((i1+i2)%10 == i3){\n\t\t\t  if(i1+i2 >= 10) c[1] = (c[1] + c_[0]) % MOD;\n\t\t\t  else c[0] = (c[0] + c_[0]) % MOD;\n\t\t\t}\n\t\t\telse if((i1+i2+1)%10 == i3){\n\t\t\t  if((i1+i2+1) >= 10) c[1] = (c[1] + c_[1]) % MOD;\n\t\t\t  else c[0] = (c[0] + c_[1]) % MOD;\n\t\t\t}\n\t\t  }\n\t\t}\n\t  }\n\t  REP(i,2) c_[i] = c[i];\n\t}\n\tcout << c[0] << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define ll long long\nconst int MOD = (int)1e9 + 7;\nint main(){\n\tstring s1,s2,s3;\n\twhile(cin>>s1,s1[0]!='0'){\n\t\tcin >> s2 >> s3;\n\t\tvector<vector<ll> > dp(s2.size()+1,vector<ll>(20,0));\n\t\tREP(i,10)dp[s2.size()][i]++;\n\t\tfor(int di=s2.size()-1;di>=0;di--){\n\t\t\tif(s1[di] == s2[di] && s2[di] == s3[di] && s1[di] == '?'){//all ?\n\t\t\t\tif(di==0){\n\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\tfor(int j=1;j<10;j++){\n\t\t\t\t\t\t\tdp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\tdp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\tREP(j,10){\n\t\t\t\t\t\t\tdp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\tdp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(s1[di] == s2[di] && s1[di] == '?'){//a and b are ?\n\t\t\t\t\tif(di==0){\n\t\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\t\tfor(int j=1;j<10;j++){\n\t\t\t\t\t\t\t\tif(i+j == s3[di]-'0' || i+j == s3[di]-'0'+10)dp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\t\telse if(i+j+1 == s3[di]-'0' || i+j+1 == s3[di]-'0'+10)dp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\t\tREP(j,10){\n\t\t\t\t\t\t\t\tif(i+j == s3[di]-'0' || i+j == s3[di]-'0'+10)dp[di][i+j] += dp[di+1][9] % MOD;\n\t\t\t\t\t\t\t\telse if(i+j+1 == s3[di]-'0' || i+j+1 == s3[di]-'0'+10)dp[di][i+j+1] += dp[di+1][19] % MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(s3[di] == '?')s3[di] = '0' + (s1[di] + s2[di] -'0'-'0')%10;\n\t\t\t\t}else if((s1[di] == s3[di] || s2[di] == s3[di]) && s3[di] == '?'){//a and c are ?\n\t\t\t\t\tif(s1[di]=='?')swap(s1[di],s2[di]);\n\t\t\t\t\tif(di==0){\n\t\t\t\t\t\tfor(int i=1;i<10;i++){\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\t\n\t\t\t\t\t\tREP(i,10){\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\t\t\tdp[di][i+s1[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(s3[di] == '?'){//c is ?\n\t\t\t\t\tdp[di][s1[di]-'0'+s2[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\tdp[di][s1[di]-'0'+s2[di]-'0'+1] += dp[di+1][19]%MOD;\n\t\t\t\t}else if(s1[di] == '?' || s2[di] == '?'){//c is defined and ? exit\n\t\t\t\t\tif(s1[di]=='?')swap(s1[di],s2[di]);\n\t\t\t\t\tif(s3[di] - s1[di]<0){\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][9]%MOD;\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][19]%MOD;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(di != 0 ||s3[di]-s1[di] > 0)dp[di][s3[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\t\tif(di != 0 ||s3[di]-s1[di] > 1)dp[di][s3[di]-'0'] += dp[di+1][19]%MOD;\n\t\t\t\t\t}\n\t\t\t\t}else{//all defined\n\t\t\t\t\tif(s1[di] + s2[di] -'0' - '0' == s3[di]- '0')\n\t\t\t\t\t\tdp[di][s3[di]-'0'] += dp[di+1][9]%MOD;\n\t\t\t\t\telse if(s1[di] + s2[di] - '0' - '0' == s3[di] - '0' - 1)\n\t\t\t\t\t\tdp[di][s3[di]-'0'] += dp[di+1][19]%MOD;\n\t\t\t\t\telse if(s1[di] - '0' + s2[di] - '0' - 10 == s3[di] - '0')\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][9]%MOD;\n\t\t\t\t\telse\n\t\t\t\t\t\tdp[di][s3[di]-'0'+10] += dp[di+1][19]%MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(di != 0 || s3[0] == '?'){\n\t\t\t\tREP(i,19){\n\t\t\t\t\tdp[di][i+1] = (dp[di][i+1]%MOD + dp[di][i]%MOD + MOD)%MOD;\n\t\t\t\t\t}\n\t\t\t\tdp[di][19] = (dp[di][19]%MOD - dp[di][9]%MOD + MOD)%MOD;\n\t\t\t}\n\t\t}\n\t\t/*\t\tREP(i,20)\n\t\t\tcout << dp[0][i] << \" \";\n\t\tcout << endl;*/\n\t\tif(s3[0] == '?'){\n\t\t\tif(s1[0] != '?')\n\t\t\t\tcout << ((dp[0][9] - dp[0][s1[0]-'0']) + MOD) % MOD << endl;//a is defined\n\t\t\telse\n\t\t\t\tcout << (dp[0][9] + MOD) % MOD << endl;\n\t\t}else{ cout << (dp[0][s3[0]-'0'] + MOD) % MOD << endl;}//a and b are ? or c is defined\n\t}\n\treturn 0;\n}\n\t\t\t\t\n\t\t\t\t\t"
  },
  {
    "language": "C++",
    "code": "                                        #include <bits/stdc++.h>\n                                        #include<iostream>\n                                        #include<cstdio>\n                                        #include<vector>\n                                        #include<queue>\n                                        #include<map>\n                                        #include<cstring>\n                                        #include<string>\n                                        #include <math.h>\n                                        #include<algorithm>\n                                    //    #include <boost/multiprecision/cpp_int.hpp>\n                                        #include<functional>\n                                #define int long long\n                                        #define inf  1000000007\n                                        #define pa pair<int,int>\n                                        #define ll long long\n                                        #define pal pair<double,pa>\n                                        #define ppa pair<int,int>\n                                        #define ppap pair<int,pa>\n                                        #define ssa pair<string,int>\n                                        #define  mp make_pair\n                                        #define  pb push_back\n                                        #define EPS (1e-12)\n                                        #define equals(a,b) (fabs((a)-(b))<EPS)\n                                  #define VI vector<int>\n                                        using namespace std;\n                                        \n                                  class pas{\n                                    \tpublic:\n                                    \tint x,y;\n                                    \tpas(int x=0,int y=0):x(x),y(y) {}\n                                    \tpas operator + (pas p) {return pas(x+p.x,y+p.y);}\n                                    \tpas operator - (pas p) {return pas(x-p.x,y-p.y);}\n                                    \tpas operator * (int a) {return pas(x*a,y*a);}\n                                    \tpas operator / (int a) {return pas(x/a,y/a);}\n                                    //\tdouble absv() {return sqrt(norm());}\n                                    \tint norm() {return x*x+y*y;}\n                                    \tbool operator < (const pas &p) const{\n                                   \t\treturn x != p.x ? x<p.x: y<p.y;\n                                   \t}\n                                  //\t\tbool operator < (const pas &p) const{\n                                    //\t\treturn y != p.y ? y<p.y: x<p.x;\n                                    //\t}\n                                    \tbool operator == (const pas &p) const{\n                                    \t\treturn x==p.x && y==p.y;\n                                    \t}\n                                    };\n\n                                        class Point{\n                                        \tpublic:\n                                        \tdouble x,y;\n                                        \tPoint(double x=0,double y=0):x(x),y(y) {}\n                                        \tPoint operator + (Point p) {return Point(x+p.x,y+p.y);}\n                                        \tPoint operator - (Point p) {return Point(x-p.x,y-p.y);}\n                                        \tPoint operator * (double a) {return Point(x*a,y*a);}\n                                        \tPoint operator / (double a) {return Point(x/a,y/a);}\n                                        \tdouble absv() {return sqrt(norm());}\n                                        \tdouble norm() {return x*x+y*y;}\n                                        \tbool operator < (const Point &p) const{\n                                        \t\treturn x != p.x ? x<p.x: y<p.y;\n                                        \t}\n                                        \tbool operator == (const Point &p) const{\n                                        \t\treturn fabs(x-p.x)<EPS && fabs(y-p.y)<EPS;\n                                        \t}\n                                        };\n                                        typedef Point Vector;\n                                 #define pl pair<int,pas>\n                                        struct Segment{\n                                        Point p1,p2;\n                                        };\n                                        \nstruct star{\nSegment se[5];\n};\n                                         double dot(Vector a,Vector b){\n                                        \treturn a.x*b.x+a.y*b.y;\n                                        }\n                                        double cross(Vector a,Vector b){\n                                        \treturn a.x*b.y-a.y*b.x;\n                                        }\n                                    \n            bool parareru(Point a,Point b,Point c,Point d){\n            //\tif(abs(cross(a-b,d-c))<EPS)cout<<\"dd \"<<cross(a-b,d-c)<<endl;\n            \treturn abs(cross(a-b,d-c))<EPS;\n            }\n            double distance_ls_p(Point a, Point b, Point c) {\n              if ( dot(b-a, c-a) < EPS ) return (c-a).absv();\n              if ( dot(a-b, c-b) < EPS ) return (c-b).absv();\n              return abs(cross(b-a, c-a)) / (b-a).absv();\n            }\n            bool is_intersected_ls(Segment a,Segment b) {\n            \tif(a.p1==b.p1||a.p2==b.p1||a.p1==b.p2||a.p2==b.p2) return false;\n            \tif(parareru((a.p2),(a.p1),(b.p1),(b.p2))&&parareru((a.p2),(a.p1),(b.p1),(b.p1))){\n            //\t\tcout<<\"sss\"<<endl;\n            \t\tif(dot(a.p1-b.p1,a.p1-b.p2)<EPS) return true;\n            \t\tif(dot(a.p2-b.p1,a.p2-b.p2)<EPS) return true;\n            \t\tif(dot(a.p1-b.p1,a.p2-b.p1)<EPS) return true;\n            \t\tif(dot(a.p1-b.p2,a.p2-b.p2)<EPS) return true;\n            \t\treturn false;\n            \t}\n              else return ( cross(a.p2-a.p1, b.p1-a.p1) * cross(a.p2-a.p1, b.p2-a.p1) < EPS ) && ( cross(b.p2-b.p1, a.p1-b.p1) * cross(b.p2-b.p1, a.p2-b.p1) < EPS );\n            }\n            double segment_len(Segment a){\n            \t\n            \treturn (a.p1-a.p2).absv();\n            }\n            double segment_dis(Segment a,Segment b){\n            \tif(is_intersected_ls(a,b))return 0;\n            \tdouble r=distance_ls_p(a.p1, a.p2, b.p1);\n            \tr=min(r,distance_ls_p(a.p1, a.p2, b.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p1));\n            \treturn r;\n            }\n            Point intersection_ls(Segment a, Segment b) {\n              Point ba = b.p2-b.p1;\n              double d1 = abs(cross(ba, a.p1-b.p1));\n              double d2 = abs(cross(ba, a.p2-b.p1));\n              double t = d1 / (d1 + d2);\n             \n              return a.p1 + (a.p2-a.p1) * t;\n            }\n\t\t\tpair<Point,Point> circle_intersection(Point c1,double r1,Point c2,double r2){\n\t\t\t\tdouble d=(c1-c2).absv();\n\t\t\t\tdouble h=(r1*r1-r2*r2+d*d)/2.0/d;\n\t\t\t\tdouble l=sqrt(r1*r1-h*h);\n\t\t\t//\tcout<<d<<\" \"<<h<<\" \"<<l<<endl;\n\t\t\t\tPoint asi=c1+(c2-c1)*h/((c2-c1).absv());\n\t\t\t\tVector r1r2=(c2-c1)/((c2-c1).absv());\n\t\t\t\tVector sui={r1r2.y,-r1r2.x};\n\t\t\t//\tcout<<sui.x<<\" \"<<sui.y<<endl;\n\t\t\t\tpair<Point,Point> z=mp(asi+sui*l,asi-sui*l);\n\t\t\t\tif(z.first.x>z.second.x) swap(z.first,z.second);\n\t\t\t\treturn z;\n\t\t\t}\ndouble dist(star s1,star s2){\n\tdouble ans=10000000000.0;\n\t\n\tfor(int i=0;i<5;i++)for(int j=0;j<5;j++){\n\t\tif( is_intersected_ls(s1.se[i],s2.se[j])) {\n\t\t\t\n//\t\t\tcout<<s1.se[i].p1.x<<\" \"<<s1.se[i].p1.y<<endl;\n//\t\t\tcout<<s1.se[i].p2.x<<\" \"<<s1.se[i].p2.y<<endl;\n//\t\t\tcout<<s2.se[j].p1.x<<\" \"<<s2.se[j].p1.y<<endl;\n//\t\t\tcout<<s2.se[j].p2.x<<\" \"<<s2.se[j].p2.y<<endl;\n\t\treturn 0.0;\n\t\t}\n\t\tans=min(ans,segment_dis(s1.se[i],s2.se[j]));\n//\t\tcout<<\"   \"<<i<<\" \"<<j<<\" \"<<segment_dis(s1.se[i],s2.se[j])<<endl;\n\t}\n\treturn ans;\n}\nint gcd(int x,int y){\n\tif(x<y) return gcd(y,x);\n\tif(x==y) return x;\n\tif(x%y==0) return y;\n\treturn gcd(y,x%y);\n}\n class pa2{\n                                            public:\n                                            int x,y;\n                                            pa2(int x=0,int y=0):x(x),y(y) {}\n                                            pa2 operator + (pa2 p) {return pa2(x+p.x,y+p.y);}\n                                            pa2 operator - (pa2 p) {return pa2(x-p.x,y-p.y);}\n                                            bool operator < (const pa2 &p) const{\n                                                return x != p.x ? x<p.x: y<p.y;\n                                            }\n\t\t\t\t\t\t\t\t\t\t \t bool operator > (const pa2 &p) const{\n                                                return x != p.x ? x>p.x: y>p.y;\n                                            }\n                                            bool operator == (const pa2 &p) const{\n                                                return abs(x-p.x)==0 && abs(y-p.y)==0;\n                                            }\n                                            bool operator != (const pa2 &p) const{\n                                                return !(abs(x-p.x)==0 && abs(y-p.y)==0);\n                                            }\n                                                 \n                                         \n                                        };\n                                        \nstring s,t,w;\nint l;\n\nint dfs(int r,int ku){\n\tif(r==l && ku==0) return 1;\n\tif(r==l && ku==1) return 0;\n\tif(ku>1|| ku<0)return 0;\n\t\n\t//if(s[r]=='?' && t[r]!='?') swap(s[r],t[r]);\n\t\n\tint cn1=0,cn2=0;\n\t//cout<<s[0]<<\" \"<<t[0]<<\" \"<<w[0]<<endl; \n\tfor(int i=0;i<=9;i++)for(int j=0;j<=9;j++)for(int k=0;k<=9;k++){\n\t\t//cout<<i<<\" \"<<j<<\" \"<<k<<endl;\n\t\tif(r==0 && i*j*k==0) continue;\n\t\tif(s[r]!='?' && s[r]-'0'!=i) continue;\n\t\tif(t[r]!='?' && t[r]-'0'!=j) continue;\n\t\tif(w[r]!='?' && w[r]-'0'!=k) continue;\n\t\t\n\t\tif(ku==0){\n\t\t\tif(i+j>=10) continue;\n\t\t\tif(i+j==k)cn1++;\n\t\t\tif(i+j+1==k) cn2++;\n\t\t}\n\t\tif(ku==1){\n\t\t\tif(i+j<9) continue;\n\t\t\tif(i+j==k+10) cn1++;\n\t\t\tif(i+j+1==k+10)cn2++;\n\t\t}\n\t\t\n\t}\n\t\n\tint d=0;\n\td+= cn1*(dfs(r+1,0))%inf;\n\td%=inf;\n\td+= cn2*(dfs(r+1,1))%inf;\n\td%=inf;\n//\tcout<<r<<\" \"<<ku<<\" \"<<d<<endl;\n\treturn d;\n}\n\n\n     signed main(){\n\n     \twhile(1){\n     \tcin>>s;\n     \t\tif(s==\"0\")return 0;\n     \t\tcin>>t>>w;\n     \t\tl=s.length();\n     \t\tcout<<dfs(0,0)%inf<<endl;\n   \n     \t}\n           \treturn 0;\n           }\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nconst int MOD = 1e9+7;\n\nstring A, B, C;\nint N;\nvector<vector<int> > dp;\n\nint dfs(int n, int r) {\n  if ( dp[n][r] >= 0 ) return dp[n][r];\n  if ( n == N-1 ) {\n    int ret = 0;\n    for ( int i = 1; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 1; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( i+j+r >= 10 ) continue;\t\n\tif ( C[n] == '?' ) {\n\t  ret++;\n\t} else {\n\t  if ( C[n]-'0' == i+j+r ) ret++;\t  \n\t}\n\tret %= MOD;\n      }\n    }\n    return dp[n][r] = ret;\n  } else {\n    int ret = 0;\n    for ( int i = 0; i <= 9; i++ ) {\n      if ( A[n] != '?' && A[n]-'0' != i ) continue;      \n      for ( int j = 0; j <= 9; j++ ) {\n\tif ( B[n] != '?' && B[n]-'0' != j ) continue;\n\tif ( C[n] == '?' ) {\n\t  ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t} else {\n\t  if ( C[n]-'0' == (i+j+r)%10 ) ret += dfs(n+1, (i+j+r)/10);\n\t  ret %= MOD;\t  \n\t}\n      }\n    }\n\n    return dp[n][r] = (ret%MOD);    \n  }\n}\n\nsigned main() {\n  while ( cin >> A, A != \"0\" ) {\n    cin >> B >> C;\n    N = A.size();\n    dp = vector<vector<int> >(N+1, vector<int>(3, -1));    \n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());    \n    reverse(C.begin(), C.end());\n\n    cout << dfs(0, 0)%MOD << endl;    \n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tint n = B.size();\n\n\t\tll dp[55][2] = { 0 };\n\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tfor(int j = 0; j < 2; j++) {\n\t\t\t\tint q = 0, s = 0, t = 0;\n\t\t\t\tif(A[i] == '?') q++;\n\t\t\t\telse s += A[i] - '0';\n\t\t\t\tif(B[i] == '?') q++;\n\t\t\t\telse s += B[i] - '0';\n\t\t\t\tif(C[i] != '0') t = C[i] - '0';\n\n\t\t\t\tif(q == 2) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tfor(int b = 0; b <= 9; b++) {\n\t\t\t\t\t\t\tif(i == n - 1 && (a == 0 || b == 0)) continue;\n\t\t\t\t\t\t\tif(i == n - 1 && ((a + b + j) % 10 == 0)) continue;\n\t\t\t\t\t\t\tif((C[i] == '?' || (a + b + j) % 10 == t)) {\n\t\t\t\t\t\t\t\tint nj = a + b + j >= 10;\n\t\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(q == 1) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tif((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n\t\t\t\t\t\tif(C[i] == '?' || (s + a + j) % 10 == t) {\n\t\t\t\t\t\t\tint nj = s + a + j >= 10;\n\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // q == 0\n\t\t\t\t\tif((i == n - 1 && (s + j) % 10 == 0)) continue;\n\t\t\t\t\tif(C[i] == '?' || (s + j) % 10 == t) {\n\t\t\t\t\t\tint nj = (s + j) >= 10;\n\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}// for j\n\t\t}// for i\n\t\tcout << dp[n][0] << endl;\n\t}// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#include <climits>\n#include <numeric>\n#include <cstring>\nusing namespace std;\n\ntypedef long long LL;\n#define ALL(v) (v).begin(),(v).end()\n\n#define MOD 1000000007LL\n\nint main(){\n\tstring a, b, c;\n\tLL dp1[20] = {}, dp2[2] = {};\n\n\twhile(cin >> a >> b >> c){\n\t\tdp2[0] = 1;\n\t\tdp2[1] = 0;\n\n\t\tfor(int i = a.size() - 1; i >= 0; --i){\n\t\t\tmemset(dp1, 0, sizeof dp1);\n\n\t\t\tfor(int p = !i; p <= 9; ++p)\n\t\t\tfor(int q = !i; q <= 9; ++q){\n\t\t\t\tif(a[i] != '?' && p + '0' != a[i]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(b[i] != '?' && q + '0' != b[i]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor(int k = 0; k < 2; ++k){\n\t\t\t\t\tLL &x = dp1[p + q + k];\n\t\t\t\t\tx = (x + dp2[k]) % MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint dig = c[i] - '0';\n\t\t\tif(c[i] == '?'){\n\t\t\t\tdp2[0] = accumulate(dp1, dp1 + 10, 0LL) % MOD;\n\t\t\t\tdp2[1] = accumulate(dp1 + 10, dp1 + 20, 0LL) % MOD;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdp2[0] = dp1[dig];\n\t\t\t\tdp2[1] = dp1[dig + 10];\n\t\t\t}\n\t\t\t\n\t\t\tif(i == 0){\n\t\t\t\tLL ans = 0;\n\t\t\t\tif(c[0] == '?'){\n\t\t\t\t\tans = accumulate(dp1 + 1, dp1 + 10, 0LL) % MOD;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tans = dp1[dig];\n\t\t\t\t}\n\t\t\t\tcout << ans << endl;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\n#include <bitset>\n\nusing namespace std;\n#define int long long int\nconst int INF = 1001001001001001LL;\nconst int MOD = 1000000007;\n\nsigned main(){\n    \n    while(1){\n        string a, b, c; cin >> a;\n        if(a == \"0\") break;\n        cin >> b >> c;\n        reverse(a.begin(), a.end());\n        reverse(b.begin(), b.end());\n        reverse(c.begin(), c.end());\n        int n = (int)a.size();\n        vector<vector<int> > dp(n + 1, vector<int> (2, 0));\n        dp[0][0] = 1LL;\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < 2; j++){\n                if(dp[i][j] == 0) continue;\n\n                for(char x = '0'; x <= '9'; x++) for(char y = '0'; y <= '9'; y++) for(char z = '0'; z <= '9'; z++){\n                    if(a[i] != '?' && a[i] != x) continue;\n                    if(b[i] != '?' && b[i] != y) continue;\n                    if(c[i] != '?' && c[i] != z) continue;\n                    if(i == n - 1){\n                        if(x == '0' || y == '0' || z == '0') continue;\n                    }\n\n                    int numa = (int)(x - '0');\n                    int numb = (int)(y - '0');\n                    int numc = (int)(z - '0');\n                    int left = numa + numb + j;\n                    int right = numc;\n                    int nxtj = (10 <= left);\n                    left %= 10;\n                    if(left != right) continue;\n                    dp[i + 1][nxtj] += dp[i][j];\n                    dp[i + 1][nxtj] %= MOD;\n                }\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> Pii;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\nconst int inf = 1e9;\nconst int mod = 1e9 + 7;\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    string A, B, C;\n    while (cin >> A >> B >> C) {\n        int N = A.size();\n\n        A += \"#\";\n        B += \"#\";\n        C += \"#\";\n        reverse(all(A));\n        reverse(all(B));\n        reverse(all(C));\n\n        // dp[i][j] = i?????????????¬????????????°????????????(j = 1) or ??°??????????????????(j = 0) ???????????´????????°\n        VV dp(N + 1, V(2, 0));\n        dp[0][0] = 1;\n        rep2(i, 1, N + 1) {\n            rep(j, 2) {\n                rep(a, 10) {\n                    if (A[i] != '?' && a != A[i] - '0') continue;\n                    if (i == N && a == 0) continue;\n                    rep(b, 10) {\n                        if (B[i] != '?' && b != B[i] - '0') continue;\n                        if (i == N && b == 0) continue;\n                        rep(c, 10) {\n                            if (C[i] != '?' && c != C[i] - '0') continue;\n                            if (i == N && c == 0) continue;\n\n                            if ((a + b + j) % 10 == c) {\n                                (dp[i][(a + b + j) / 10] += dp[i - 1][j]) %= mod;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << dp[N][0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nconst int M=1000000007;\n\nint main(){\n\twhile(1){\n\t\tchar a[64],b[64],c[64];\n\t\tscanf(\"%s%s%s\",a,b,c);\n\t\tif(a[0]=='0') break;\n\n\t\tint len=strlen(a);\n\t\tint dp[64][2]={}; // dp[x][y] := ( x 桁目以下の部分問題についての解 with x 桁目の carry が y )\n\t\tdp[len][0]=1;\n\t\tfor(int x=len-1;x>=0;x--){\n\t\t\trep(i,10) if((x>0 || i>0) && (a[x]=='?' || a[x]==i+'0'))\n\t\t\trep(j,10) if((x>0 || j>0) && (b[x]=='?' || b[x]==j+'0'))\n\t\t\trep(k,10) if((x>0 || k>0) && (c[x]=='?' || c[x]==k+'0')) {\n\t\t\t\t// 一つ下の桁からの carry がないとき\n\t\t\t\tif((i+j)%10==k){\n\t\t\t\t\tdp[x][(i+j)/10]+=dp[x+1][0];\n\t\t\t\t\tdp[x][(i+j)/10]%=M;\n\t\t\t\t}\n\t\t\t\t// 一つ下の桁からの carry があるとき\n\t\t\t\tif((i+j+1)%10==k){\n\t\t\t\t\tdp[x][(i+j+1)/10]+=dp[x+1][1];\n\t\t\t\t\tdp[x][(i+j+1)/10]%=M;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%d\\n\",dp[0][0]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\n\nconst ll MOD = 1e9+7;\n\nll dp[60][2];\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    string A,B,C;\n    \n    while(cin >> A){\n        if(A == \"0\") break;\n        cin >> B >> C;\n        \n        reverse(A.begin(),A.end());\n        reverse(B.begin(),B.end());\n        reverse(C.begin(),C.end());\n        \n        fill(*dp,*dp+60*2,0);\n        dp[0][0] = 1;\n        int len = (int)A.length();\n        for(int i = 0; i < len;i++){\n            for(int j = 0; j < 2;j++){\n                if(dp[i][j] == 0) continue;\n                \n                int Al,Ar,Bl,Br,Cl,Cr;\n                Al = Bl = Cl = 0;\n                Ar = Br = Cr = 9;\n                \n                \n                if(A[i] != '?'){\n                    Al = Ar = A[i] - '0';\n                }\n                if(B[i] != '?'){\n                    Bl = Br = B[i] - '0';\n                }\n                if(C[i] != '?'){\n                    Cl = Cr = C[i] - '0';\n                }\n                \n//                cout << \" ======\" << endl;\n//                cout << i << \" \" << j <<  endl;\n//                cout << Al << \" \" << Ar << \" \" << Bl << \" \" << Br << \" \" << Cl << \" \" << Cr << endl;\n                for(int a = Al; a <= Ar; a++){\n                    if(i+1 == len && a == 0) continue;\n                    for(int b = Bl; b <= Br; b++){\n                        if(i+1 == len && b == 0) continue;\n                        for(int c = Cl; c <= Cr;c++){\n                            if(i+1 == len && c == 0) continue;\n                            if(a+b+j==c){\n                                (dp[i+1][0] += dp[i][j])%=MOD;\n                            }\n                            if(a+b+j==10+c){\n                                (dp[i+1][1] += dp[i][j])%=MOD;\n                            }\n                        }\n                    }\n                }\n            }\n//            cout << dp[i][0] << \" \" << dp[i][1] << endl;\n//            cout << dp[i+1][0] << \" \" << dp[i+1][1] << endl;\n//            cout << \" ====== \" << endl;\n        }\n//        cout << dp[len][0] << \" \" << dp[len][1] << endl;\n        cout << dp[len][0] << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\n#define N 1000000007\n\nusing namespace std;\n\ntypedef unsigned long long int BigInt;\n\nint s2d(string s, int d) {\n    if (d < (int)s.length()) {\n        char c = s[s.length()-d-1];\n        if (c == '?') {\n            return -1;\n        }\n        return c-'0';\n    }\n    return 0;\n}\n\nBigInt count_ways(string a, string b, string c) {\n    BigInt dp[2][61];\n    dp[0][0] = 1;\n    dp[1][0] = 0;\n    for (unsigned int i=1; i<=60; i++) {\n        int x = s2d(a, i-1);\n        int y = s2d(b, i-1);\n        int z = s2d(c, i-1);\n        dp[0][i] = 0;\n        dp[1][i] = 0;\n        for (int xi=0; xi<10; xi++) {\n            if (x >= 0 && xi != x) {\n                continue;\n            }\n            if (a.length() == i && xi == 0) {\n                continue;\n            }\n            for (int yi=0; yi<10; yi++) {\n                if (y >= 0 && yi != y) {\n                    continue;\n                }\n                if (b.length() == i && yi == 0) {\n                    continue;\n                }\n                for (int zi=0; zi<10; zi++) {\n                    if (z >= 0 && zi != z) {\n                        continue;\n                    }\n                    if (c.length() == i && zi == 0) {\n                        continue;\n                    }\n                    switch (xi+yi-zi) {\n                        case 0:\n                            dp[0][i] += dp[0][i-1];\n                            break;\n                        case -1:\n                            dp[0][i] += dp[1][i-1];\n                            break;\n                        case 10:\n                            dp[1][i] += dp[0][i-1];\n                            break;\n                        case 9:\n                            dp[1][i] += dp[1][i-1];\n                            break;\n                    }\n                    dp[0][i] = dp[0][i]%N;\n                    dp[1][i] = dp[1][i]%N;\n                }\n            }\n        }\n    }\n    return dp[0][60];\n}\n\nint main() {\n    string a, b, c;\n    while (true) {\n        cin >> a;\n        if (a == \"0\") {\n            return 0;\n        }\n        cin >> b >> c;\n        cout << count_ways(a, b, c) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD DEKAI\n#define DEKAI (int)(1e9+7)\n#define rep(i,n) lps(i,0,n)\n#define lp(i,n) lps(i,0,n)\n#define lps(i,j,n) for(int i = j; i < n; i++)\n#define atoi(c) c-'0'\n\nint main(){ \n  string A,B,C;\n  int a,b,c;\n  long long int plus1[55],plus0[55],pl11,pl10,pl01,pl00;\n  while(1){\n    cin>>A;\n    if(A==\"0\") break;\n    cin>>B>>C;\n    for(int i=0;i<55;i++){\n      plus1[i]=plus0[i]=0;\n    }\n    plus1[A.size()]=0;\n    plus0[A.size()]=1;\n    for(int i=A.size()-1;i>=0;i--){\n      pl11=pl10=pl01=pl00=0;\n      for(int j=0;j<=9;j++){\n\tif(A[i]!='?') j=atoi(A[i]);\n\telse if(j==0 && i==0) continue;\n\tfor(int k=0;k<=9;k++){\n\t  if(B[i]!='?') k=atoi(B[i]);\n\t  else if(k==0 && i==0) continue;\n\t  //insert birou\n\t  if(C[i]!='?'){\n\t    if((j+k)>9){\n\t       if((j+k)%10==atoi(C[i])) pl01++;\n\t       if((j+k+1)%10==atoi(C[i])) pl11++;\n\t    }else if((j+k)==9){\n\t      if((j+k+1)%10==atoi(C[i])) pl11++;\n\t      if((j+k)%10==atoi(C[i])) pl00++;\n\t    }else{\n\t      if((j+k+1)%10==atoi(C[i])) pl10++;\n\t      if((j+k)%10==atoi(C[i])) pl00++;\n\t    }\n\t  }else{\n\t    if((j+k)>9){\n\t      pl11++;\n\t      pl01++;\n\t    }else if((j+k)==9){\n\t      pl11++;\n\t      pl00++;\n\t    }else{\n\t      pl10++;\n\t      pl00++;\n\t    }\n\t  }\n\t  //insaato abobu\n\t  if(B[i]!='?') break;\n\t}\n\tif(A[i]!='?') break;\n      }\n      plus1[i]=((pl11*plus1[i+1])%DEKAI+(pl01*plus0[i+1])%DEKAI)%DEKAI;\n      plus0[i]=((pl10*plus1[i+1])%DEKAI+(pl00*plus0[i+1])%DEKAI)%DEKAI;\n    }  \n    cout<<plus0[0]<<endl;\n  }\n  \n  \n  return 0;\n}\n  \n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = ll(1e9 + 7);\nstring A, B, C;\n\nint N;\nll dp[51][2];\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tN = A.size();\n\t\tmemset(dp, 0, sizeof dp);\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < N; i++) {\n\t\t\tfor(int c = 0; c < 2; c++) {\n\t\t\t\t//cerr << i << \" \" << c << \" \" << le << \" \" << dp[i][c][le] << endl;\n\n\t\t\t\tif(dp[i][c] == 0) continue;\n\n\t\t\t\tint fixa = -1, fixb = -1;\n\t\t\t\tif(isdigit(A[i])) fixa = A[i] - '0';\n\t\t\t\tif(isdigit(B[i])) fixb = B[i] - '0';\n\t\t\t\tfor(int a = 0; a < 10; a++) {\n\t\t\t\t\tif(fixa != -1 && a != fixa) continue;\n\t\t\t\t\tif(i == N - 1 && a == 0) continue;\n\t\t\t\t\tfor(int b = 0; b < 10; b++) {\n\t\t\t\t\t\tif(fixb != -1 && b != fixb) continue;\n\t\t\t\t\t\tif(i == N - 1 && b == 0) continue;\n\n\t\t\t\t\t\tint s = a + b + c;\n\t\t\t\t\t\tint x = s % 10;\n\n\t\t\t\t\t\t//cerr << \"\\t\" <<  a << \" \" << b << \" \" << x << endl;\n\t\t\t\t\t\tif(isdigit(C[i]) && C[i] - '0' != x) continue;\n\n\t\t\t\t\t\tint ncarry = s / 10;\n\n\t\t\t\t\t\tdp[i + 1][ncarry] += dp[i][c];\n\t\t\t\t\t\tdp[i + 1][ncarry] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << dp[N][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = (ll)1e9 + 7;\n\nstring A, B, C;\n\nint main() {\n\twhile(cin >> A, A != \"0\") {\n\t\tcin >> B >> C;\n\n\t\treverse(A.begin(), A.end());\n\t\treverse(B.begin(), B.end());\n\t\treverse(C.begin(), C.end());\n\n\t\tint n = B.size();\n\n\t\tll dp[55][2] = { 0 };\n\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tfor(int j = 0; j < 2; j++) {\n\t\t\t\tint q = 0, s = 0, t = 0;\n\t\t\t\tif(A[i] == '?') q++;\n\t\t\t\telse s += A[i] - '0';\n\t\t\t\tif(B[i] == '?') q++;\n\t\t\t\telse s += B[i] - '0';\n\t\t\t\tif(C[i] != '0') t = C[i] - '0';\n\n\t\t\t\tif(q == 2) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tfor(int b = 0; b <= 9; b++) {\n\t\t\t\t\t\t\tif(i == n - 1 && b == 0) continue;\n\t\t\t\t\t\t\tif(i == n - 1 && (t == 0 || (a + b + j) % 10 == 0)) continue;\n\t\t\t\t\t\t\tif((C[i] == '?' || (a + b + j) % 10 == t)) {\n\t\t\t\t\t\t\t\tint nj = a + b + j >= 10;\n\t\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(q == 1) {\n\t\t\t\t\tfor(int a = 0; a <= 9; a++) {\n\t\t\t\t\t\tif(i == n - 1 && a == 0) continue;\n\t\t\t\t\t\tif((i == n - 1 && (s + a + j) % 10 == 0)) continue;\n\t\t\t\t\t\tif(C[i] == '?' || (s + a + j) % 10 == t) {\n\t\t\t\t\t\t\tint nj = s + a + j >= 10;\n\t\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // q == 0\n\t\t\t\t\tif((i == n - 1 && (s + j) % 10 == 0)) continue;\n\t\t\t\t\tif(C[i] == '?' || (s + j) % 10 == t) {\n\t\t\t\t\t\tint nj = (s + j) >= 10;\n\t\t\t\t\t\t(dp[i + 1][nj] += dp[i][j]) %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}// for j\n\t\t}// for i\n\t\tcout << dp[n][0] << endl;\n\t}// while\n}// main"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstring a[3];\nint n,mod=1e9+7;\nint dp[100][3][20];\n\nint change(char ch){\n  return ch-'0';\n}\n\nvoid add(int &a,int b){\n  a=(a+b)%mod;\n}\n\nvoid init(){\n  for(int i=0;i<100;i++){\n    for(int j=0;j<3;j++){\n      for(int k=0;k<20;k++){\n        dp[i][j][k]=-1;\n      }\n    }\n  }\n}\n\nint rec(int x,int y,int z){\n  if(x==-1){\n    if(z==0)return 1;\n    else return 0;\n  }\n\n  if(dp[x][y][z]!=-1)return dp[x][y][z];\n\n  if(y==2){\n    if(a[2][x]=='?'){\n      return rec(x-1,0,z/10);\n    }else{\n      if(change(a[2][x])!=z%10)return 0;\n      else return rec(x-1,0,z/10);\n    }\n  }\n  \n  int res=0;\n  if(a[y][x]!='?'){\n    return rec(x,y+1,z+change(a[y][x]));\n  }else{\n    for(int i=0;i<10;i++){\n      if(i==0&&x==0)continue;\n      add(res,rec(x,y+1,z+i));\n    }\n  }\n  return dp[x][y][z]=res;\n}\n\nint main(){\n  while(1){\n    cin>>a[0];\n    if(a[0]==\"0\")break;\n    cin>>a[1]>>a[2];\n    n=a[0].size();\n    init();\n    cout<<rec(n-1,0,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-10;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\nint n;\nll dp[55][2];\nstring a, b, c;\n\nll solve(int i, int j)\n{\n\tif (dp[i][j] >= 0) return dp[i][j];\n\tchar l = a[i], m = b[i], r = c[i];\n\tint x = l - '0', y = m - '0', z = r - '0';\n\tll res;\n\tif (i == 0)\n\t{\n\t\tif (l == '?'&&m == '?'&&r == '?')\t   // ?+?=?\n\t\t{\n\t\t\tif (j == 0) res = 36;\n\t\t\telse res = 28;\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r != '?') // x+y=z\n\t\t{\n\t\t\tif (j + x + y == z) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // ?+?=z\n\t\t{\n\t\t\tif (j == 0) res = z - 1;\n\t\t\telse res = max(0, z - 2);\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // x+y=?\n\t\t{\n\t\t\tif (x + y + j < 10) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (r == '?')\t\t\t\t\t   // x+?=? || ?+y=?\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0) res = 9 - x;\n\t\t\telse res = max(0, 8 - x);\n\t\t}\n\t\telse\t\t\t\t\t\t\t\t   // x+?=z || ?+y=z\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j + x < z) res = 1;\n\t\t\telse res = 0;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (l == '?'&&m == '?'&&r == '?')\t   // ?+?=?\n\t\t{\n\t\t\tif(j==0) res = solve(i - 1, 0) * 55 + solve(i - 1, 1) * 45;\n\t\t\telse res = solve(i - 1, 0) * 45 + solve(i - 1, 1) * 55;\n\t\t}\n\t\telse if (l != '?'&&m != '?'&&r != '?') // x+y=z\n\t\t{\n\t\t\tif ((j + x + y) % 10 == z) res = solve(i - 1, (j + x + y) / 10);\n\t\t\telse res = 0;\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // ?+?=z\n\t\t{\n\t\t\tif(j==0) res = solve(i - 1, 0)*(z + 1) + solve(i - 1, 1)*(9 - z);\n\t\t\telse res = solve(i - 1, 0)*z + solve(i - 1, 1)*(10 - z);\n\t\t}\n\t\telse if (l == '?'&&m == '?'&&r != '?') // x+y=?\n\t\t{\n\t\t\tif (x + y + j < 10) res = solve(i - 1, 0);\n\t\t\telse res = solve(i - 1, 1);\n\t\t}\n\t\telse if (r == '?')\t\t\t\t\t   // x+?=? || ?+y=?\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0) res = solve(i - 1, 0)*(10 - x) + solve(i - 1, 1)*x;\n\t\t\telse res = solve(i - 1, 0)*(9 - x) + solve(i - 1, 1)*(x + 1);\n\t\t}\n\t\telse\t\t\t\t\t\t\t\t   // x+?=z || ?+y=z\n\t\t{\n\t\t\tif (l == '?') swap(x, y);\n\t\t\tif (j == 0)\n\t\t\t{\n\t\t\t\tif (x <= z) res = solve(i - 1, 0);\n\t\t\t\telse res = solve(i - 1, 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (x+1 <= z) res = solve(i - 1, 0);\n\t\t\t\telse res = solve(i - 1, 1);\n\t\t\t}\n\t\t}\n\t}\n\treturn dp[i][j] = res%MOD;\n}\n\nint main()\n{\n\twhile (cin >> a >> b >> c, a != \"0\")\n\t{\n\t\tn = a.size();\n\t\tMS(dp, -1);\n\t\tcout << solve(n - 1, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nbool in_range(int a, int b){\n  return a >= 0 && a < b;\n}\n\nint main(){\n  string A;\n  while(cin >> A, A != \"0\"){\n    string B, C;\n    cin >> B >> C;\n    int n = A.length(), mod = 1e9 + 7;\n    vector< vector<long long int> > dp(n, vector<long long int>(2,0));\n    for(int i = n-1; i >= 0; --i){\n      if(C[i] != '?'){\n        int c = C[i] - '0';\n        if(A[i] != '?' && B[i] != '?'){\n          int a = A[i] - '0', b = B[i] - '0';\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(a + b == c){\n            if(i < n-1) dp[i][0] = dp[i+1][0];\n            else dp[i][0] = 1;\n          }else if(i < n-1 && a + b + 1 == c){\n            dp[i][0] = dp[i+1][1];\n          }else if(a + b == 10 + c){\n            if(i < n-1) dp[i][1] = dp[i+1][0];\n            else dp[i][1] = 1;\n          }else if(i < n-1 && a + b + 1 == 10 + c){\n            dp[i][1] = dp[i+1][1];\n          }\n        }else if(A[i] != '?'){//B[i] == '?'\n          int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(b,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              dp[i][0] += 1;\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(b_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }\n            else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(b_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else if(B[i] != '?'){//A[i] == '?'\n          int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n          if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n          if(in_range(a,10)){\n            if(i < n-1){\n              dp[i][0] += dp[i+1][0];\n              dp[i][0] %= mod;\n            }else{\n              ++dp[i][0];\n              dp[i][0] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a-1,10)){\n            dp[i][0] += dp[i+1][1];\n            dp[i][0] %= mod;\n          }\n          if(in_range(a_,10)){\n            if(i < n-1){\n              dp[i][1] += dp[i+1][0];\n              dp[i][1] %= mod;\n            }else{\n              ++dp[i][1];\n              dp[i][1] %= mod;\n            }\n          }\n          if(i < n-1 && in_range(a_-1,10)){\n            dp[i][1] += dp[i+1][1];\n            dp[i][1] %= mod;\n          }\n        }else{//A[i] == B[i] == '?'\n          for(int a = 0; a < 10; ++a){\n            for(int b = 0; b < 10; ++b){\n              if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n              if(a + b == c){\n                if(i < n-1){\n                  dp[i][0] += dp[i+1][0];\n                  dp[i][0] %= mod;\n                }else{\n                  ++dp[i][0];\n                  dp[i][0] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c){\n                dp[i][0] += dp[i+1][1];\n                dp[i][0] %= mod;\n              }\n              if(a + b == c + 10){\n                if(i < n-1){\n                  dp[i][1] += dp[i+1][0];\n                  dp[i][1] %= mod;\n                }else{\n                  ++dp[i][1];\n                  dp[i][1] %= mod;\n                }\n              }\n              if(i < n-1 && a + b + 1 == c + 10){\n                dp[i][1] += dp[i+1][1];\n                dp[i][1] %= mod;\n              }\n            }\n          }\n        }\n      }else{//C[i] == '?'\n        for(int c = 0; c < 10; ++c){\n          if(A[i] != '?' && B[i] != '?'){\n            int a = A[i] - '0', b = B[i] - '0';\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(a + b == c){\n              if(i < n-1) dp[i][0] = dp[i+1][0];\n              else dp[i][0] = 1;\n            }else if(i < n-1 && a + b + 1 == c){\n              dp[i][0] = dp[i+1][1];\n            }else if(a + b == 10 + c){\n              if(i < n-1) dp[i][1] = dp[i+1][0];\n              else dp[i][1] = 1;\n            }else if(i < n-1 && a + b + 1 == 10 + c){\n              dp[i][1] = dp[i+1][1];\n            }\n          }else if(A[i] != '?'){//B[i] == '?'\n            int a = A[i] - '0', b = c - a, b_ = c - a + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(b,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                dp[i][0] += 1;\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(b_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }\n              else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(b_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else if(B[i] != '?'){//A[i] == '?'\n            int b = B[i] - '0', a = c - b, a_ = c - b + 10;\n            if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;\n            if(in_range(a,10)){\n              if(i < n-1){\n                dp[i][0] += dp[i+1][0];\n                dp[i][0] %= mod;\n              }else{\n                ++dp[i][0];\n                dp[i][0] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a-1,10)){\n              dp[i][0] += dp[i+1][1];\n              dp[i][0] %= mod;\n            }\n            if(in_range(a_,10)){\n              if(i < n-1){\n                dp[i][1] += dp[i+1][0];\n                dp[i][1] %= mod;\n              }else{\n                ++dp[i][1];\n                dp[i][1] %= mod;\n              }\n            }\n            if(i < n-1 && in_range(a_-1,10)){\n              dp[i][1] += dp[i+1][1];\n              dp[i][1] %= mod;\n            }\n          }else{//A[i] == B[i] == '?'\n            for(int a = 0; a < 10; ++a){\n              for(int b = 0; b < 10; ++b){\n                if(n > 1 && i == 0 && (a == 0 || b == 0)) continue;//leading zero\n                if(a + b == c){\n                  if(i < n-1){\n                    dp[i][0] += dp[i+1][0];\n                    dp[i][0] %= mod;\n                  }else{\n                    ++dp[i][0];\n                    dp[i][0] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c){\n                  dp[i][0] += dp[i+1][1];\n                  dp[i][0] %= mod;\n                }\n                if(a + b == c + 10){\n                  if(i < n-1){\n                    dp[i][1] += dp[i+1][0];\n                    dp[i][1] %= mod;\n                  }else{\n                    ++dp[i][1];\n                    dp[i][1] %= mod;\n                  }\n                }\n                if(i < n-1 && a + b + 1 == c + 10){\n                  dp[i][1] += dp[i+1][1];\n                  dp[i][1] %= mod;\n                }\n              }\n            }\n          } \n        }\n      }\n    }\n    /*\n    for(int i = 0; i < n; ++i) cout << dp[i][0] << \" \" ;\n    cout << endl;\n    for(int i = 0; i < n; ++i) cout << dp[i][1] << \" \" ;\n    cout << endl;\n    */\n    cout << dp[0][0] << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    REP(i, 55) dp[i][0] = dp[i][1] = 0;\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if((A+B)%10==C) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if((A+B+1)%10==C) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][0] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        if(i!=0 && C>=B) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=B+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>B+1) dp[i][0] += dp[i+1][1];\n        if(C<=(B+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=B) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i!=0 && C>=A) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>A) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=A+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>A+1) dp[i][0] += dp[i+1][1];\n        if(C<=(A+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=A) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(i || (A+B)%10) {\n          if(A+B>=10) dp[i][1] += dp[i+1][0];\n          else dp[i][0] += dp[i+1][0];\n        }\n        if(i || (A+B+1)%10) {\n          if(A+B+1>=10) dp[i][1] += dp[i+1][1];\n          else dp[i][1] += dp[i+1][0];\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if((j+k)%10==C) {\n              if(j+k>=10) dp[i][1] += dp[i+1][0];\n              else dp[i][0] += dp[i+1][0];\n            }\n          }\n          if(i || (j+k+1)%10) {\n            if((j+k+1)%10==C) {\n              if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n              else dp[i][0] += dp[i+1][1];\n            }\n          }\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst long long MOD = 1000000007;\nint main(){\n  while (1){\n    string A;\n    cin >> A;\n    if (A == \"0\"){\n      break;\n    }\n    string B;\n    cin >> B;\n    string C;\n    cin >> C;\n    int N = A.size();\n    vector<vector<long long>> dp(N + 1, vector<long long>(2, 0));\n    dp[N][0] = 1;\n    for (int i = N - 1; i >= 0; i--){\n      for (int j = 0; j <= 9; j++){\n        for (int k = 0; k <= 9; k++){\n          for (int l = 0; l <= 9; l++){\n            if (!(i == 0 && (j == 0 || k == 0 || l == 0))){\n              for (int m = 0; m < 2; m++){\n                if (A[i] == '?' || A[i] == '0' + j){\n                  if (B[i] == '?' || B[i] == '0' + k){\n                    if (C[i] == '?' || C[i] == '0' + l){\n                      int sum = j + k + m;\n                      if (sum % 10 == l){\n                        dp[i][sum / 10] += dp[i + 1][m];\n                        dp[i][sum / 10] %= MOD;\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <valarray>\n#include <string>\n#include <algorithm>\n#include <set>\ntypedef unsigned long long ull;\ntypedef long long ll;\n\n#define rep(i,n) for(ull i = 0;i<(n);i++)\n#define rep1(i,n) for(ull i = 1;i<=(n);i++)\n#define revrep(i,n) for(ull i = (n-1);i>=0;i--)\n#define all(n) (n).begin(),(n).end()\n#define show(x) (cout << \"debug \" << #x << \":\" << x << endl, x);\n#define showvec(x) cout << endl << \"debug \" << #x << \";\" << endl; \\\n\tfor(ull __i = 0;__i < x.size();__i++){ \\\n\t\tfor(ull __j = 0;__j<x[0].size();__j++){ \\\n\t\t\tcout << x[__i][__j] << \" \"; \\\n\t\t} \\\n\t\tcout << endl; \\\n\t} \\\n\tcout << endl;\nusing namespace std;\n#define MOD 1000000007\n\null patternNum(bool last, char p, char q, char r, bool cu, bool cn){\n\tull ans = 0;\n\tint fst = (last ? 1 : 0);\n\tfor(int a = fst;a < 10;a++){\n\t\tif(p != '?'){\n\t\t\ta = p - '0';\n\t\t}\n\t\tfor(int b = fst;b < 10;b++){\n\t\t\tif(q != '?'){\n\t\t\t\tb = q - '0';\n\t\t\t}\n\t\t\tfor(int c = fst;c < 10;c++){\n\t\t\t\tif(r != '?'){\n\t\t\t\t\tc = r - '0';\n\t\t\t\t}\n\t\t\t\tull tmp = a + b + (cu ? 1 : 0);\n\t\t\t\tif(tmp % 10 == c){\n\t\t\t\t\tif(tmp >= 10 && cn){\n\t\t\t\t\t\tans++;\n\t\t\t\t\t}\n\t\t\t\t\tif(tmp < 10 && !cn){\n\t\t\t\t\t\tans++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(r != '?'){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(q != '?'){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(p != '?'){\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tull c0[52],c1[52];\n\tstring A,B,C;\n\twhile(cin >> A, A != \"0\"){\n\t\tcin >> B >> C;\n\t\trep(i,52){\n\t\t\tc0[i] = c1[i] = 0;\n\t\t}\n\t\tfor(int p = A.size()-1;p>=0;p--){\n\t\t\tif(p == A.size()-1 && A.size() != 1){\n\t\t\t\tc0[p] = patternNum(false,A[p],B[p],C[p],false,false) % MOD;\n\t\t\t\tc1[p] = patternNum(false,A[p],B[p],C[p],false,true) % MOD;\n\t\t\t}else if(p != 0){\n\t\t\t\tc0[p] = patternNum(false,A[p],B[p],C[p],false,false) * c0[p+1] + patternNum(false,A[p],B[p],C[p],true,false) * c1[p+1];\n\t\t\t\tc0[p] %= MOD;\n\t\t\t\tc1[p] = patternNum(false,A[p],B[p],C[p],false,true) * c0[p+1] + patternNum(false,A[p],B[p],C[p],true,true) * c1[p+1];\n\t\t\t\tc1[p] %= MOD;\n\t\t\t}else{\n\t\t\t\tc0[p] = patternNum(true,A[p],B[p],C[p],false,false) * c0[p+1] + patternNum(true,A[p],B[p],C[p],true,false) * c1[p+1];\n\t\t\t\tc0[p] %= MOD;\n\t\t\t\tc1[p] = 0;\n\t\t\t}\t\n\t\t}\n\t\tcout << c0[0] + c1[0] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\n#define all(c) begin(c), end(c)\n\nconst int MOD = 1e9 + 7;\nstring A, B, C;\nint a[55], b[55], c[55];\n\nint main() {\n    while (cin >> A >> B >> C && A != \"0\") {\n        reverse(all(A));\n        reverse(all(B));\n        reverse(all(C));\n        int n = A.size();\n        for (size_t i = 0; i < n; i++) {\n            a[i] = isdigit(A[i]) ? A[i] - '0' : -1;\n            b[i] = isdigit(B[i]) ? B[i] - '0' : -1;\n            c[i] = isdigit(C[i]) ? C[i] - '0' : -1;\n        }\n        \n        int dp[55][2] = {};\n        dp[0][0] = 1;\n        for (size_t i = 0; i < n; i++) {\n            for (size_t j = 0; j < 2; j++) {\n                for (size_t ia = 0; ia < 10; ia++) {\n                    for (size_t ib = 0; ib < 10; ib++) {\n                        for (size_t ic = 0; ic < 10; ic++) {\n                            if (a[i] != -1 && ia != a[i]) continue;\n                            if (b[i] != -1 && ib != b[i]) continue;\n                            if (c[i] != -1 && ic != c[i]) continue;\n                            if (i == n - 1 && (ia == 0 || ib == 0 || ic == 0)) continue;\n                            int dig = ia + ib + j;\n                            if (dig % 10 != ic) continue;\n                            (dp[i + 1][dig >= 10] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n\n            }\n        }\n        cout << dp[n][0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<list>\n#include<bitset>\n#include<stack>\n#include<memory>\nusing namespace std;\nusing namespace std::chrono;\ntypedef long long int llint;\ntypedef double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*cout<<fixed<<setprecision(20);cin.tie(0);ios::sync_with_stdio(false);*/\nconst llint mod=1000000007;\nconst llint big=2.19e18+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nbool solve(void){\n\tstring S,T,U;\n\tcin>>S;if(S==\"0\"){return false;}\n\tcin>>T>>U;\n\tREV(S);REV(T);REV(U);\n\t//繰り上がりは0か1か\n\tllint dp=1,ep=0;\n\tfor(int i=0;i<S.size();i++){\n\t\tllint ddp=0,eep=0;\n\t\tfor(int x=0;x<10;x++){\n\t\t\tif(S[i]!='?'&&S[i]-'0'!=x){continue;}\n\t\t\tif(i+1==S.size()&&x==0){continue;}\n\t\t\tfor(int y=0;y<10;y++){\n\t\t\t\tif(T[i]!='?'&&T[i]-'0'!=y){continue;}\n\t\t\t\tif(i+1==T.size()&&y==0){continue;}\n\t\t\t\tint ds=(x+y)%10;\n\t\t\t\tif(U[i]=='?'||U[i]-'0'==ds){\n\t\t\t\t\tif(x+y>=10){eep+=dp;}\n\t\t\t\t\telse{ddp+=dp;}\n\t\t\t\t}\n\t\t\t\tint es=(x+y+1)%10;\n\t\t\t\tif(U[i]=='?'||U[i]-'0'==es){\n\t\t\t\t\tif(x+y+1>=10){eep+=ep;}\n\t\t\t\t\telse{ddp+=ep;}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdp=ddp%mod;\n\t\tep=eep%mod;\n\t\t//cerr<<dp<<\" \"<<ep<<endl;\n\t}\n\tcout<<dp<<endl;\n\treturn true;\n}\n\nint main(void){\n\twhile(solve()){}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n#define mod 1000000007\nstring A, B, C; long long dp[60][3];\nint main() {\n\twhile (true) {\n\t\tcin >> A; if (A == \"0\")break;\n\t\tcin >> B >> C;\n\t\tfor (int i = 0; i < 180; i++)dp[i / 3][i % 3] = 0;\n\t\treverse(A.begin(), A.end()); int A1 = A.size();\n\t\treverse(B.begin(), B.end()); int B1 = B.size();\n\t\treverse(C.begin(), C.end()); int C1 = C.size();\n\t\twhile (A.size() < 50)A = A + '0';\n\t\twhile (B.size() < 50)B = B + '0';\n\t\twhile (C.size() < 50)C = C + '0';\n\t\tdp[0][0] = 1;\n\t\tfor (int i = 0; i < 50; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tint a = 0, b = 0, c = 0;\n\t\t\t\tfor (int k = 0; k < 10; k++) {\n\t\t\t\t\tfor (int l = 0; l < 10; l++) {\n\t\t\t\t\t\tint m = j + k + l;\n\t\t\t\t\t\tif ((k != (int)(A[i] - '0') && A[i] != '?') || (i == A1 - 1 && k == 0))continue;\n\t\t\t\t\t\tif ((l != (int)(B[i] - '0') && B[i] != '?') || (i == B1 - 1 && l == 0))continue;\n\t\t\t\t\t\tif ((m % 10 != (int)(C[i] - '0') && C[i] != '?') || (i == C1 - 1 && m % 10 == 0))continue;\n\t\t\t\t\t\tif (m >= 0 && m < 10)a++;\n\t\t\t\t\t\tif (m >= 10 && m < 20)b++;\n\t\t\t\t\t\tif (m >= 20 && m < 30)c++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i + 1][0] += dp[i][j] * a; dp[i + 1][0] %= mod;\n\t\t\t\tdp[i + 1][1] += dp[i][j] * b; dp[i + 1][1] %= mod;\n\t\t\t\tdp[i + 1][2] += dp[i][j] * c; dp[i + 1][2] %= mod;\n\t\t\t}\n\t\t}\n\t\tcout << (dp[50][0] + dp[50][1] + dp[50][2]) % mod << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MOD 1000000007\ntypedef long long ll;\n\nstring A,B,C;\n\nvoid reverse(){\n  reverse(A.begin(),A.end());\n  reverse(B.begin(),B.end());\n  reverse(C.begin(),C.end());\n}\n\nint main(){\n  while(cin >> A, A != \"0\"){\n    cin >> B >> C;\n    reverse();\n    int size = A.size();\n    ll dp[51][2];\n    memset(dp,0,sizeof(dp));\n    dp[0][0] = 1;\n    for(int p = 0 ; p < size ; p++){\n      for(int i = 0 ; i < 10 ; i++){\n        if(A[p] != '?' && (A[p]-'0') != i){\n          continue;\n        }\n        if(p == size-1 && i == 0){ continue; }\n        for(int j = 0 ; j < 10 ; j++){\n          if(B[p] != '?' && (B[p]-'0') != j){\n            continue;\n          }\n          if(p == size-1 && j == 0){ continue; }\n          for(int k = 0 ; k < 2 ; k++){\n            int l = (i + j + k) % 10;\n            int nk = (i + j + k >= 10);\n            if(C[p] != '?' && (C[p]-'0') != l){\n              continue;\n            }\n            dp[p+1][nk] += dp[p][k];\n            dp[p+1][nk] %= MOD;\n          }\n        }\n      }\n    }\n    cout << dp[size][0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int,int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-11;\nconst ld pi = acos(-1.0);\nint main() {\n\tstring a, b, c;\n\twhile (cin >> a) {\n\t\tif (a == \"0\")break;\n\t\tcin >> b >> c;\n\t\treverse(a.begin(), a.end());\n\t\treverse(b.begin(), b.end());\n\t\treverse(c.begin(), c.end());\n\t\tint len = a.length();\n\t\tll cnt[51][2] = {};\n\t\tcnt[0][0] = 1;\n\t\trep(i, len) {\n\t\t\tll cnt1 = 0; ll cnt2 = 0;\n\t\t\trep(x, 10) {\n\t\t\t\trep(y, 10) {\n\t\t\t\t\trep(z, 10) {\n\t\t\t\t\t\tif (a[i] != '?'&&a[i] - '0' != x)continue;\n\t\t\t\t\t\tif (b[i] != '?'&&b[i] - '0' != y)continue;\n\t\t\t\t\t\tif (c[i] != '?'&&c[i] - '0' != z)continue;\n\t\t\t\t\t\tif (i == len - 1 && (x == 0 || y == 0 || z == 0))continue;\n\t\t\t\t\t\tif (x + y == z)cnt1++;\n\t\t\t\t\t\tif (x + y == 10 + z)cnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt[i + 1][0] += cnt[i][0] * cnt1; cnt[i + 1][0] %= MOD;\n\t\t\tcnt[i + 1][1] += cnt[i][0] * cnt2; cnt[i + 1][1] %= MOD;\n\t\t\tcnt1 = 0; cnt2 = 0;\n\t\t\trep(x, 10) {\n\t\t\t\trep(y, 10) {\n\t\t\t\t\trep(z, 10) {\n\t\t\t\t\t\tif (a[i] != '?'&&a[i] - '0' != x)continue;\n\t\t\t\t\t\tif (b[i] != '?'&&b[i] - '0' != y)continue;\n\t\t\t\t\t\tif (c[i] != '?'&&c[i] - '0' != z)continue;\n\t\t\t\t\t\tif (i == len - 1 && (x == 0 || y == 0 || z == 0))continue;\n\t\t\t\t\t\tif (x + y + 1== z)cnt1++;\n\t\t\t\t\t\tif (x + y + 1== 10 + z)cnt2++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcnt[i + 1][0] += cnt[i][1] * cnt1; cnt[i + 1][0] %= MOD;\n\t\t\tcnt[i + 1][1] += cnt[i][1] * cnt2; cnt[i + 1][1] %= MOD;\n\t\t}\n\t\tcout << cnt[len][0] << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#define NDEBUG\n#include <algorithm>\n#include <cstddef>\n#include <cstdint>\n#include <iostream>\n#include <vector>\n\nnamespace n91 {\n\nusing i8 = std::int_fast8_t;\nusing i32 = std::int_fast32_t;\nusing i64 = std::int_fast64_t;\nusing u8 = std::uint_fast8_t;\nusing u32 = std::uint_fast32_t;\nusing u64 = std::uint_fast64_t;\nusing isize = std::ptrdiff_t;\nusing usize = std::size_t;\n\nstruct rep {\n  struct itr {\n    usize i;\n    constexpr itr(const usize i) noexcept : i(i) {}\n    void operator++() noexcept { ++i; }\n    constexpr usize operator*() const noexcept { return i; }\n    constexpr bool operator!=(const itr x) const noexcept { return i != x.i; }\n  };\n  const itr f, l;\n  constexpr rep(const usize f, const usize l) noexcept\n      : f(std::min(f, l)), l(l) {}\n  constexpr auto begin() const noexcept { return f; }\n  constexpr auto end() const noexcept { return l; }\n};\nstruct revrep {\n  struct itr {\n    usize i;\n    constexpr itr(const usize i) noexcept : i(i) {}\n    void operator++() noexcept { --i; }\n    constexpr usize operator*() const noexcept { return i; }\n    constexpr bool operator!=(const itr x) const noexcept { return i != x.i; }\n  };\n  const itr f, l;\n  constexpr revrep(const usize f, const usize l) noexcept\n      : f(l - 1), l(std::min(f, l) - 1) {}\n  constexpr auto begin() const noexcept { return f; }\n  constexpr auto end() const noexcept { return l; }\n};\ntemplate <class T> auto md_vec(const usize n, const T &value) {\n  return std::vector<T>(n, value);\n}\ntemplate <class... Args> auto md_vec(const usize n, Args... args) {\n  return std::vector<decltype(md_vec(args...))>(n, md_vec(args...));\n}\ntemplate <class T> constexpr T difference(const T &a, const T &b) noexcept {\n  return a < b ? b - a : a - b;\n}\ntemplate <class T> void chmin(T &a, const T &b) noexcept {\n  if (b < a)\n    a = b;\n}\ntemplate <class T> void chmax(T &a, const T &b) noexcept {\n  if (a < b)\n    a = b;\n}\ntemplate <class T> T scan() {\n  T ret;\n  std::cin >> ret;\n  return ret;\n}\n\n} // namespace n91\n#include <cstdint>\n\nnamespace n91 {\n\nconstexpr std::uint_fast64_t totient(std::uint_fast64_t x) noexcept {\n  using u64 = std::uint_fast64_t;\n  u64 ret = x;\n  for (u64 i = static_cast<u64>(2); i * i <= x; ++i) {\n    if (x % i == static_cast<u64>(0)) {\n      ret -= ret / i;\n      x /= i;\n      while (x % i == static_cast<u64>(0)) {\n        x /= i;\n      }\n    }\n  }\n  if (x != static_cast<u64>(1)) {\n    ret -= ret / x;\n  }\n  return ret;\n}\n\ntemplate <std::uint_fast64_t Modulus,\n          std::uint_fast64_t InverseExp =\n              totient(Modulus) - static_cast<std::uint_fast64_t>(1)>\nclass modint {\n  using u64 = std::uint_fast64_t;\n\n  static_assert(Modulus < static_cast<u64>(1) << static_cast<u64>(32),\n                \"Modulus must be less than 2**32\");\n\n  u64 a;\n\n  constexpr modint &negate() noexcept {\n    if (a != static_cast<u64>(0)) {\n      a = Modulus - a;\n    }\n    return *this;\n  }\n\npublic:\n  constexpr modint(const u64 x = static_cast<u64>(0)) noexcept\n      : a(x % Modulus) {}\n  constexpr u64 &value() noexcept { return a; }\n  constexpr const u64 &value() const noexcept { return a; }\n  constexpr modint operator+() const noexcept { return modint(*this); }\n  constexpr modint operator-() const noexcept { return modint(*this).negate(); }\n  constexpr modint operator+(const modint rhs) const noexcept {\n    return modint(*this) += rhs;\n  }\n  constexpr modint operator-(const modint rhs) const noexcept {\n    return modint(*this) -= rhs;\n  }\n  constexpr modint operator*(const modint rhs) const noexcept {\n    return modint(*this) *= rhs;\n  }\n  constexpr modint operator/(const modint rhs) const noexcept {\n    return modint(*this) /= rhs;\n  }\n  constexpr modint &operator+=(const modint rhs) noexcept {\n    a += rhs.a;\n    if (a >= Modulus) {\n      a -= Modulus;\n    }\n    return *this;\n  }\n  constexpr modint &operator-=(const modint rhs) noexcept {\n    if (a < rhs.a) {\n      a += Modulus;\n    }\n    a -= rhs.a;\n    return *this;\n  }\n  constexpr modint &operator*=(const modint rhs) noexcept {\n    a = a * rhs.a % Modulus;\n    return *this;\n  }\n  constexpr modint &operator/=(modint rhs) noexcept {\n    u64 exp = InverseExp;\n    while (exp) {\n      if (exp % static_cast<u64>(2) != static_cast<u64>(0)) {\n        *this *= rhs;\n      }\n      rhs *= rhs;\n      exp /= static_cast<u64>(2);\n    }\n    return *this;\n  }\n  constexpr bool operator==(const modint rhs) const noexcept {\n    return a == rhs.a;\n  }\n  constexpr bool operator!=(const modint rhs) const noexcept {\n    return a != rhs.a;\n  }\n};\n\ntemplate <class T, std::uint_fast64_t v> class modint_constant {\npublic:\n  static constexpr T value = static_cast<T>(v);\n\n  using value_type = T;\n};\n\n} // namespace n91\n\n#include <algorithm>\n#include <array>\n#include <iostream>\n#include <utility>\n\nnamespace n91 {\n\nvoid main_() {\n  using mint = modint<1000000007>;\n  while (true) {\n    std::string a, b, c;\n    std::cin >> a;\n    if (a == \"0\") {\n      return;\n    }\n    const usize n = a.size();\n    std::cin >> b >> c;\n    std::reverse(a.begin(), a.end());\n    std::reverse(b.begin(), b.end());\n    std::reverse(c.begin(), c.end());\n    std::vector<std::array<mint, 2>> dp(n + 1);\n    dp[0][0] = 1;\n    const auto lb = [](const char c) { return c == '?' ? 0 : c - '0'; };\n    const auto ub = [](const char c) { return c == '?' ? 9 : c - '0'; };\n    for (const auto i : rep(0, n)) {\n      for (int ad = lb(a[i]); ad <= ub(a[i]); ++ad) {\n        if (ad == 0 && i == n - 1) {\n          continue;\n        }\n        for (int bd = lb(b[i]); bd <= ub(b[i]); ++bd) {\n          if (bd == 0 && i == n - 1) {\n            continue;\n          }\n          for (int cd = lb(c[i]); cd <= ub(c[i]); ++cd) {\n            if (cd == 0 && i == n - 1) {\n              continue;\n            }\n            for (int car = 0; car <= 1; ++car) {\n              const int sum = ad + bd + car;\n              if (sum % 10 == cd) {\n                dp[i + 1][sum / 10] += dp[i][car];\n              }\n            }\n          }\n        }\n      }\n    }\n    std::cout << dp[n][0].value() << std::endl;\n  }\n}\n\n} // namespace n91\n\nint main() {\n  n91::main_();\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <tuple>\n#include <queue>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\nusing pll = pair<ll, ll>;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing ti3 = tuple<int, int, int>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\nint dp[2][51];\nint main() {\n\tstring a, b, c;\n\twhile (cin >> a, a != \"0\") {\n\t\tcin >> b >> c;\n\t\tvector<vll> dp(2, vll(51));\n\t\tdp[0][0] = 1;\n\t\treverse(ALL(a));\n\t\treverse(ALL(b));\n\t\treverse(ALL(c));\n\t\trep(i, a.length()) {\n\t\t\trep(j, 2) {\n\t\t\t\tint x = (a[i] == '?' ? (i == a.length() - 1 ? 1 : 0) : a[i] - '0');\n\t\t\t\tdo {\n\t\t\t\t\tint y = b[i] == '?' ? (i == a.length() - 1 ? 1 : 0) : b[i] - '0';\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (c[i] == '?' || (x + y + j) % 10 == c[i] - '0')dp[x + y + j>9][i + 1] =(dp[x + y + j>9][i + 1]+ dp[j][i])%(ll)(1e9+7);\n\t\t\t\t\t\ty++;\n\t\t\t\t\t} while (b[i] == '?'&&y != 10);\n\t\t\t\t\tx++;\n\t\t\t\t} while (a[i] == '?'&&x < 10);\n\t\t\t}\n\t\t}\n\t\tcout << dp[0][a.length()] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) REP(i, 0, n)\n#define REP(i, s, e) for(int  i = (int)(s); i < (int)(e); ++i)\n#define all(r) (r).begin(), (r).end()\n\ntypedef long long ll;\nll MOD = 1e9 + 7;\n\nconst int MAX_N = 55;\n\nll dp[MAX_N][2];\n\nint main() {\n  string a, b, c;\n  while(cin >> a) {\n    if(a == \"0\") break;\n    cin >> b >> c;\n    rep(i, MAX_N) rep(j, 2) dp[i][j] = 0;\n    dp[0][0] = 1;\n    reverse(all(a));\n    reverse(all(b));  \n    reverse(all(c));\n    int n = a.size();\n    rep(i, n) {\n      rep(ai, 10) {\n\tif(i == n-1 && ai == 0) continue;\n\tif(a[i] != '?') {\n\t  if(a[i] != '0' + ai) continue;\n\t}\n\trep(bi, 10) {\n\t  if( i == n-1 && bi == 0) continue;\n\t  if(b[i] != '?') {\n\t    if(b[i] != '0' + bi) continue;\n\t  }\n\t  {\n\t    int sum = ai + bi;\n\t    bool f = sum >= 10;\n\t    if(sum >= 10) sum -= 10;\n\t    if(i == n-1 && sum == 0) continue;\n\t    if(c[i] == '?' || c[i] == '0' + sum) (dp[i+1][f] += dp[i][0]) %= MOD;\n\t  }\n\t  {\n\t    int sum = ai + bi + 1;\n\t    bool f = sum >= 10;\n\t    if(sum >= 10) sum -= 10;\n\t    if(i == n-1 && sum == 0) continue; \n\t    if(c[i] == '?' || c[i] == '0' + sum) (dp[i+1][f] += dp[i][1]) %= MOD;\n\t  }\n\t}\n      }\n      \n    }\n    cout << dp[n][0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n\nusing namespace std;\n\nint main(){\n  string A,B,C;\n  while(1){\n    cin >> A;\n    if(A==\"0\")break;\n    cin >> B >> C;\n    unsigned long N=A.size();\n    unsigned long long P[2][N+1];\n    P[0][0]=1;\n    P[1][0]=0;\n    for(int n=0;n<N;++n){\n      int unknown=0;\n      unsigned long sub[2][2];\n      string a,b,c;\n      sub[0][0]=0;\n      sub[0][1]=0;\n      sub[1][0]=0;\n      sub[1][1]=0;\n      a=A[N-n-1];\n      b=B[N-n-1];\n      c=C[N-n-1];\n      if(a==\"?\")unknown++;\n      if(b==\"?\")unknown++;\n      if(c==\"?\")unknown++;\n      for(int i=0;i<2;++i){\n\tswitch(unknown){\n\tcase 0:\n\t  if((i+atoi(a.c_str())+atoi(b.c_str()))%10!=atoi(c.c_str())){\n\t    sub[i][0]=0;\n\t    sub[i][1]=0;\n\t  } else if(i+atoi(a.c_str())+atoi(b.c_str())>=10) {\n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 1:\n\t  if(c==\"?\"){\n\t    if(i+atoi(a.c_str())+atoi(b.c_str())<10){\n\t      sub[i][0]=1;\n\t      sub[i][1]=0;\n\t    }else{\n\t      sub[i][0]=0;\n\t      sub[i][1]=1;\n\t    }\n\t  } else if( i+atoi(a.c_str())>atoi(c.c_str()) || i+atoi(b.c_str())>atoi(c.c_str())){ \n\t    sub[i][0]=0;\n\t    sub[i][1]=1;\n\t  } else {\n\t    sub[i][0]=1;\n\t    sub[i][1]=0;\n\t  }\n\t  break;\n\n\tcase 2:\n\t  if(a==\"?\"&&b==\"?\"){\n\t    sub[i][0]=atoi(c.c_str())+1-i;\n\t    sub[i][1]=10-sub[i][0];\n\t  } else { \n\t    sub[i][1]=atoi(a.c_str())+atoi(b.c_str())+i;\n\t    sub[i][0]=10-sub[i][1];\n\t  }\n\t  break;\n\t  \n\tcase 3:\n\t  sub[0][0]=55;\n\t  sub[0][1]=45;\n\t  sub[1][0]=45;\n\t  sub[1][1]=55;\n\t  break;\n\t}\n      }\n      if(n==N-1){\n\tsub[0][1]=0;\n\tsub[1][1]=0;\n\tfor(int i=0;i<2;++i){\n\t  switch(unknown){\n\t  case 1:\n\t    if(i+atoi(a.c_str())==atoi(c.c_str()) ||\n\t       i+atoi(b.c_str())==atoi(c.c_str()) ||\n\t       i+atoi(a.c_str())+atoi(b.c_str())>9){\n\t      sub[i][0]=0;\n\t    }\n\t    break;\n\t  case 2:\n\t    if(a==\"?\"&&b==\"?\"){\n\t      if(atoi(c.c_str())-i-1>0)sub[i][0]=atoi(c.c_str())-i-1;\n\t      else sub[i][0]=0;\n\t    } else {\n\t      if(9-atoi(a.c_str())-atoi(b.c_str())-i>0) sub[i][0]=9-atoi(a.c_str())-atoi(b.c_str())-i;\n\t      else sub[i][0]=0;\n\t    }\n\t    break;\n\t  case 3:\n\t    sub[0][0]=36;\n\t    sub[1][0]=28;\n\t    break;\n\t  }\n\t}\n      }\n      P[0][n+1]=(P[0][n]*sub[0][0]+P[1][n]*sub[1][0])%1000000007;\n      P[1][n+1]=(P[0][n]*sub[0][1]+P[1][n]*sub[1][1])%1000000007;\n    }\n    cout << P[0][N] << endl;\n  }\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\n#define rep(i, n) for(int i = 0; i < (n); ++i)\n\nusing namespace std;\n\nconst int mod = 1e9 + 7;\n\ntypedef long long ll;\n\nint n;\nchar a[51];\nchar b[51];\nchar c[51];\nint dp[51][2];\n\nint add(int a, int b){\n\treturn (a + b) % mod;\n}\n\nint main(){\n\twhile(scanf(\"%s\", a), scanf(\"%s%s\", b, c) != EOF){\n\t\tn = strlen(a);\n\t\trep(i, n + 1){\n\t\t\tfill_n(dp[i], 2, 0);\n\t\t}\n\t\tdp[0][0] = 1;\n\t\tfor(int i = 1; i <= n; ++i){\n\t\t\trep(s, 10){\n\t\t\t\tint p = a[n - i] == '?' ? s : a[n - i] - '0';\n\t\t\t\trep(t, 10){\n\t\t\t\t\tint q = b[n - i] == '?' ? t : b[n - i] - '0';\n\t\t\t\t\trep(u, 10){\n\t\t\t\t\t\tint r = c[n - i] == '?' ? u : c[n - i] - '0';\n\t\t\t\t\t\tif(i == n && (!p || !q || !r)){\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif((p + q) % 10 == r){\n\t\t\t\t\t\t\tdp[i][(p + q) / 10] = add(dp[i][(p + q) / 10], dp[i - 1][0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if((p + q + 1) % 10 == r){\n\t\t\t\t\t\t\tdp[i][(p + q + 1) / 10] = add(dp[i][(p + q + 1) / 10], dp[i - 1][1]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(c[n - i] != '?'){\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(b[n - i] != '?'){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\t\n\t\t\t\t}\n\n\t\t\t\tif(a[n - i] != '?'){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// printf(\"%d %d\\n\", dp[i][0], dp[i][1]);\n\t\t}\n\t\tprintf(\"%d\\n\", dp[n][0]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconstexpr int INF=1e9;\nconstexpr int MOD=1e9+7;\nconstexpr double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename Ostream,typename Container>\nOstream& operator<<(Ostream& os,const Container& c){\n\tos<<'[';\n\tfor(auto i=begin(c);i!=end(c);++i)\n\t\tos<<(i==begin(c)?\"\":\" \")<<*i;\n\treturn os<<']';\n}\n\nint main()\n{\n\tfor(array<string,3> ss;cin>>ss[0]>>ss[1]>>ss[2];){\n\t\tint n=ss[0].size();\n\t\trep(i,3) reverse(all(ss[i]));\n\t\t\n\t\tvvi dp(2,vi(n+1)); dp[0][0]=1;\n\t\trep(i,n){\n\t\t\tvvi cs(3);\n\t\t\trep(j,3){\n\t\t\t\tif(ss[j][i]=='?')\n\t\t\t\t\tcs[j]=i==n-1?vi{1,2,3,4,5,6,7,8,9}:vi{0,1,2,3,4,5,6,7,8,9};\n\t\t\t\telse\n\t\t\t\t\tcs[j].push_back(ss[j][i]-'0');\n\t\t\t}\n\t\t\trep(carry,2){\n\t\t\t\tfor(int c0:cs[0]) for(int c1:cs[1]) for(int c2:cs[2]){\n\t\t\t\t\tif(carry+c0+c1==c2)\n\t\t\t\t\t\t(dp[0][i+1]+=dp[carry][i])%=MOD;\n\t\t\t\t\tif(carry+c0+c1==10+c2)\n\t\t\t\t\t\t(dp[1][i+1]+=dp[carry][i])%=MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<dp[0][n]<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long ll;\nconst ll mod=(1e9)+7;\nstring A,B,C;\n\nll mem[100][10],used[100][10];\nll dfs(int idx,int pre){\n  if(idx==-1) return pre==0;\n  if(used[idx][pre]++)return mem[idx][pre];\n  \n  ll res=0,u[10][10][10]={},f=idx==0;\n  for(int i=f;i<10;i++)\n    for(int j=f;j<10;j++)\n      for(int k=f;k<10;k++){\n\tint a=A[idx]=='?'? i:A[idx]-'0';\n\tint b=B[idx]=='?'? j:B[idx]-'0';\n\tint c=C[idx]=='?'? k:C[idx]-'0';\n\tif(u[a][b][c]++||(a+b+pre)%10!=c) continue;\n\tres=(res+dfs(idx-1,(a+b+pre)/10))%mod;\n      }\n  return mem[idx][pre] = res;\n}\n\nint main(){\n  while(1){\n    cin>>A;\n    if(A==\"0\")break;\n    cin>>B>>C;\n    memset(used,0,sizeof(used));\n    cout <<dfs(A.size()-1,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max() / 32 * 15 + 208;\n\nint main() {\n    string s;\n    while(cin >> s, s != \"0\"){\n        string t, u;\n        cin >> t >> u;\n        reverse(s.begin(),s.end());\n        reverse(t.begin(),t.end());\n        reverse(u.begin(),u.end());\n        int n = s.size();\n        vector<vector<int>> dp(n+1, vector<int>(4));\n        dp[0][0] = 1;\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < 4; ++j) {\n                for (int k = (i == n-1); k <= 9; ++k) {\n                    if(s[i] != '?' && s[i] -'0' != k) continue;\n                    for (int l = (i == n-1); l <= 9; ++l) {\n                        if(t[i] != '?' && t[i] -'0' != l) continue;\n                        for (int m = (i == n-1); m <= 9; ++m) {\n                            if(u[i] != '?' && u[i] -'0' != m) continue;\n                            if((j+k+l)%10 != m) continue;\n                            (dp[i+1][(j+k+l)/10] += dp[i][j]) %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[n][0] << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\n#define int ll\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nvs str;\nint len;\n\nvi vals;\n\n#define F first\n#define S second\n\npii dfs(int pos, int offset, int num){\n    if(pos == 3){\n        if(vals[2] == vals[0] + vals[1] + offset){\n            return mp(1, 0);\n        }\n        else if(vals[2] == (vals[0] + vals[1] + offset) % 10){\n            return mp(0, 1);\n        }\n        else return mp(0, 0);\n    }\n\n    pii ret = mp(0, 0);\n\n    if(str[pos][num] != '?'){\n        vals[pos] = str[pos][num] - '0';\n\n        pii diff = dfs(pos + 1, offset, num);\n        ret.F += diff.F;\n        ret.S += diff.S;\n    }\n    else{\n        rep(i, 10){\n            if(num == 0 && i == 0) continue;\n\n            vals[pos] = i;\n\n            pii diff = dfs(pos + 1, offset, num);\n            ret.F += diff.F;\n            ret.S += diff.S;\n        }\n    }\n\n    return ret;\n}\n\nconstexpr int MOD = 1000000007;\n\nsigned main(void){\n    vals = vi(3);\n    for(str = vs(3); cin >> str[0], str[0] != \"0\";){\n        len = str[0].size();\n        cin >> str[1] >> str[2];\n\n        vvi dp(len + 1, vi(2));\n        dp[len][0] = 1;\n\n        for(int i = len - 1; i >= 0; i--){\n            rep(j, 2){\n                pii diff = dfs(0, j, i);\n\n                (dp[i][0] += (dp[i + 1][j] * diff.F) % MOD) %= MOD;\n                (dp[i][1] += (dp[i + 1][j] * diff.S) % MOD) %= MOD;\n            }\n        }\n\n        cout << dp[0][0] << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n\nusing namespace std;\n\nint main(){\n  for(string A;cin>>A,A!=\"0\";){\n    string B,C;\n    cin>>B>>C;\n    int dp[51][2]={1};\n    int len=A.size();\n    for(int i=0;i<A.size();i++){\n      for(int j=0;j<2;j++){\n\tint last=i==A.size()-1;\n\tfor(int k=last;k<=9;k++){\n\t  if(A[len-1-i]!='?'&&A[len-1-i]!='0'+k)continue;\n\t  for(int l=last;l<=9;l++){\n\t    if(B[len-1-i]!='?'&&B[len-1-i]!='0'+l)continue;\n\t    for(int m=last;m<=9;m++){\n\t      if(C[len-1-i]!='?'&&C[len-1-i]!='0'+m)continue;\n\t      int s=k+l+j;\n\t      if(s%10!=m)continue;\n\t      dp[i+1][s/10]=(dp[i+1][s/10]+dp[i][j])%(1000000007);\n\t      \n\t    }\n\t  }\n\t}\n      }\n    }\n    cout<<dp[A.size()][0]<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(v.begin(),v.end());v.erase(unique(v.begin(),v.end()),v.end());\n#define pb push_back\n\nstring a,b,c;\nll n;\nll memo[50][2];\n\nll dfs(ll pos, ll carry) {\n\tif(pos==n) {\n\t\tif(!carry) return 1;\n\t\telse return 0;\n\t}\n\tif(memo[pos][carry]!=-1) return memo[pos][carry];\n\tll ret=0;\n\tREP(i,10) REP(j,10) REP(k,10) {\n\t\tif(a[pos]!='?'&&a[pos]-'0'!=i) continue;\n\t\tif(b[pos]!='?'&&b[pos]-'0'!=j) continue;\n\t\tif(c[pos]!='?'&&c[pos]-'0'!=k) continue;\n\t\tif(pos==0&&(i==0||j==0||k==0)) continue;\n\t\tll g=k;\n\t\tif(carry) g+=10;\n\t\tif(i+j+1==g) ret+=dfs(pos+1,1);\n\t\tif(i+j==g) ret+=dfs(pos+1,0);\n\t}\n\treturn memo[pos][carry]=ret%MOD;\n}\n\nll solve() {\n\tn=(ll)a.size();\n\tREP(i,50) REP(j,2) memo[i][j]=-1;\n\treturn dfs(0,0);\n}\n\nint main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile(1) {\n\t\tcin>>a;\n\t\tif(a==\"0\") break;\n\t\tcin>>b>>c;\n\t\tcout<<solve()<<endl;\n\t}\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long ll;\nconst ll mod=(1e9)+7;\nstring A,B,C;\n\nll mem[100][11],used[100][11];\n\nll dfs(int idx,int pre){\n  if(idx==-1) return pre==0;\n  if(used[idx][pre]++)return mem[idx][pre];\n  ll res=0;\n  \n  int u[10][10][10]={};\n  for(int i=idx==0;i<10;i++)\n    for(int j=idx==0;j<10;j++)\n      for(int k=idx==0;k<10;k++){\n\tint a=A[idx]=='?'? i:A[idx]-'0';\n\tint b=B[idx]=='?'? j:B[idx]-'0';\n\tint c=C[idx]=='?'? k:C[idx]-'0';\n\tif(u[a][b][c]++||(a+b+pre)%10!=c) continue;\n\tres=(res+dfs(idx-1,(a+b+pre)/10))%mod;\n      }\n  return mem[idx][pre] = res;\n}\n\nint main(){\n  while(1){\n    cin>>A;\n    if(A==\"0\")break;\n    cin>>B>>C;\n    memset(used,0,sizeof(used));\n    cout <<dfs(A.size()-1,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n#define int ll\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define PB push_back\n\nconst ll LLINF = (1LL<<60);\nconst int INF = (1LL<<30);\nconst int MOD = 1000000007;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate <typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a){\n  out<<'('<<a.first<<','<<a.second<<')';\n  return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n  out<<'[';\n  REP(i, a.size()) {out<<a[i];if(i!=a.size()-1)out<<',';}\n  out<<']';\n  return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\ntemplate<unsigned MOD>\nclass ModInt {\npublic:\n  unsigned x;\n  ModInt(): x(0) { }\n  ModInt(signed y) : x(y >= 0 ? y % MOD : MOD - (-y) % MOD) {}\n  unsigned get() const { return x; }\n\n  // 逆数\n  ModInt inv() const {\n    ll a = 1, p = x, e = MOD-2;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // e乗\n  ModInt pow(ll e) {\n    ll a = 1, p = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n  // 2のx乗\n  ModInt pow2() {\n    ll a = 1, p = 2, e = x;\n    while(e > 0) {\n      if(e%2 == 0) {p = (p*p) % MOD; e /= 2;}\n      else {a = (a*p) % MOD; e--;}\n    }\n    a %= MOD;\n    return ModInt(a);\n  }\n\n  // Comparators\n  bool operator <(ModInt b) { return x < b.x; }\n  bool operator >(ModInt b) { return x > b.x; }\n  bool operator<=(ModInt b) { return x <= b.x; }\n  bool operator>=(ModInt b) { return x >= b.x; }\n  bool operator!=(ModInt b) { return x != b.x; }\n  bool operator==(ModInt b) { return x == b.x; }\n\n  // increment, decrement\n  ModInt operator++() { x++; return *this; }\n  ModInt operator--() { x--; return *this; }\n\n  // Basic Operations\n  ModInt &operator+=(ModInt that) {\n    x = ((ll)x+that.x)%MOD;\n    return *this;\n  }\n  ModInt &operator-=(ModInt that) {\n    x = ((((ll)x-that.x)%MOD)+MOD)%MOD;\n    return *this;\n  }\n  ModInt &operator*=(ModInt that) {\n    x = (ll)x * that.x % MOD;\n    return *this;\n  }\n  // O(log(mod))かかるので注意\n  ModInt &operator/=(ModInt that) {\n    x = (ll)x * that.inv() % MOD;\n    return *this;\n  }\n  ModInt &operator%=(ModInt that) {\n    x = (ll)x % that.x;\n    return *this;\n  }\n  ModInt operator+(ModInt that)const{return ModInt(*this) += that;}\n  ModInt operator-(ModInt that)const{return ModInt(*this) -= that;}\n  ModInt operator*(ModInt that)const{return ModInt(*this) *= that;}\n  ModInt operator/(ModInt that)const{return ModInt(*this) /= that;}\n  ModInt operator%(ModInt that)const{return ModInt(*this) %= that;}\n};\ntypedef ModInt<1000000007> mint;\n// Input/Output\nostream &operator<<(ostream& os, mint a) { return os << a.x; }\nistream &operator>>(istream& is, mint &a) { return is >> a.x; }\n\nmint dp[55][2];\nsigned main(void)\n{\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  while(true) {\n    string a, b, c;\n    cin >> a;\n    if(a==\"0\") break;\n    cin >> b >> c;\n\n    int n = a.size();\n    REP(i, 55) dp[i][0] = dp[i][1] = 0;\n    dp[n][0] = 1;\n    for(int i=n-1; i>=0; --i) {\n      int A=a[i]-'0', B = b[i]-'0', C = c[i]-'0';\n      if(a[i]!='?'&&b[i]!='?'&&c[i]!='?') {\n        if(A+B==C) {\n          dp[i][0] += dp[i+1][0];\n        } else if((A+B)%10==C) {\n          dp[i][1] += dp[i+1][0];\n        }\n        if(A+B+1==C) {\n          dp[i][0] += dp[i+1][1];\n        } else if((A+B+1)%10==C) {\n          dp[i][1] += dp[i+1][1];\n        }\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]!='?') {\n        if(i!=0 && C>=B) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=B+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>B+1) dp[i][0] += dp[i+1][1];\n        if(C<=(B+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=B) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i!=0 && C>=A) dp[i][0] += dp[i+1][0];\n        if(i==0 && C>A) dp[i][0] += dp[i+1][0];\n        if(i!=0 && C>=A+1) dp[i][0] += dp[i+1][1];\n        if(i==0 && C>A+1) dp[i][0] += dp[i+1][1];\n        if(C<=(A+9)%10) dp[i][1] += dp[i+1][0];\n        if(C<=A) dp[i][1] += dp[i+1][1];\n      } else if(a[i]!='?'&&b[i]!='?'&&c[i]=='?') {\n        if(i!=0 && A+B>=10) dp[i][1] += dp[i+1][0];\n        if(i==0 && A+B>10) dp[i][1] += dp[i+1][0];\n        if(i!=0 && A+B<10) dp[i][0] += dp[i+1][0];\n        if(i==0 && A+B<10 && A+B) dp[i][0] += dp[i+1][0];\n        if(i!=0 && A+B+1>=10) dp[i][1] += dp[i+1][1];\n        if(i==0 && A+B+1>10) dp[i][1] += dp[i+1][1];\n        if(i!=0 && A+B+1<10) dp[i][0] += dp[i+1][1];\n        if(i==0 && A+B+1<10 && A+B+1) dp[i][0] += dp[i+1][1];\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]!='?') {\n        if(i) dp[i][0] += dp[i+1][0]*(C+1);\n        else dp[i][0] += dp[i+1][0]*C;\n        if(i) dp[i][0] += dp[i+1][1]*C;\n        else dp[i][0] += dp[i+1][1]*max(0LL, C-1);\n        dp[i][1] += dp[i+1][0]*(9-C);\n        if(i==0 && C==0) dp[i][1] += dp[i+1][1]*9;\n        else dp[i][1] += dp[i+1][1]*(10-C);\n      } else if(a[i]=='?'&&b[i]!='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+B)%10) {\n            if(j+B>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+B+1)%10) {\n            if(j+B+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]!='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) {\n          if(i==0 && j==0) continue;\n          if(i || (j+A)%10) {\n            if(j+A>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+A+1)%10) {\n            if(j+A+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][1] += dp[i+1][1];\n          }\n        }\n      } else if(a[i]=='?'&&b[i]=='?'&&c[i]=='?') {\n        REP(j, 10) REP(k, 10) {\n          if(i==0 && (j==0 || k==0)) continue;\n          if(i || (j+k)%10) {\n            if(j+k>=10) dp[i][1] += dp[i+1][0];\n            else dp[i][0] += dp[i+1][0];\n          }\n          if(i || (j+k+1)%10) {\n            if(j+k+1>=10) dp[i][1] += dp[i+1][1];\n            else dp[i][0] += dp[i+1][1];\n          }\n        }\n      }\n    }\n    cout << dp[0][0] << endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\ntypedef long long int lli;\nconst lli mod = 1e9+7;\n\nvoid search(vector<int> &in, vector<lli> &out, int c, int st){\n\tif(in[0]!=-1 && in[1]!=-1 && in[2]!=-1){\n\t\tif(in[0]+in[1]+c == in[2]) out[0]++;\n\t\tif(in[0]+in[1]+c == in[2]+10) out[1]++;\n\t\treturn;\n\t}\n\tfor(int i=0; i<3; i++){\n\t\tif(in[i] == -1){\n\t\t\tfor(int d=st; d<=9; d++){\n\t\t\t\tin[i] = d;\n\t\t\t\tsearch(in, out, c, st);\n\t\t\t\tin[i] = -1;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nint main(){\n\twhile(1){\n\t\tstring str[3];\n\t\tcin >> str[0];\n\t\tif(str[0]==\"0\") break;\n\t\tcin >> str[1] >> str[2];\n\t\tint n=str[0].length();\n\t\t\n\t\tvector<vector<lli> > pos_c(n, vector<lli>(2, 0));\n\t\tvector<vector<lli> > pos_nc(n, vector<lli>(2,0));\n\t\tfor(int i=0; i<n; i++){\n\t\t\tvector<int> in(3);\n\t\t\tfor(int j=0; j<3; j++){\n\t\t\t\tin[j] = (str[j][n-i-1] == '?')? -1: str[j][n-i-1]-'0';\n\t\t\t}\n\t\t\tsearch(in, pos_nc[i], 0, (i==n-1)?1: 0);\n\t\t\tsearch(in, pos_c[i],  1, (i==n-1)?1: 0);\n\t\t}\n\t\t\n\t\tlli ans=0;\n\t\tfor(int i=0; i<(1<<(n-1)); i++){\n\t\t\tlli subans=1;\n\t\t\tbool carry = false;\n\t\t\tfor(int j=0; j<n; j++){\n\t\t\t\tint uc = ((i& (1<<j))==0)? 0: 1;\n\t\t\t\tlli possible = carry? pos_c[j][uc]: pos_nc[j][uc];\n\t\t\t\tsubans = (subans *possible) %mod;\n\t\t\t\tcarry = ((i& (1<<j))==0)? false: true;\n\t\t\t}\n\t\t\tans = (ans +subans) %mod;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n \nint main() {\n  \n  int mod = 1000000007;\n  \n  while (true) {\n    \n    string A, B, C;\n    cin >> A;\n    if (A == \"0\") break;\n    cin >> B >> C;\n    \n    int n = A.size();\n    reverse(A.begin(), A.end());\n    reverse(B.begin(), B.end());\n    reverse(C.begin(), C.end());\n    \n    vector<vector<int>> dp(n+1, vector<int>(2, 0));\n    dp.at(0).at(0) = 1;\n\n     for(int i = 0; i < n; i++){\n       \n       for(int j = 0; j < 2; j++){\n         if(dp.at(i).at(j) == 0) continue;\n         \n         for(int k = 0; k < 10; k++){\n           if(i == n-1 && k == 0) continue;\n           if(A.at(i) != '?' && A.at(i)-'0' != k) continue;\n           \n           for(int l = 0; l < 10; l++){\n             if(i == n-1 && l == 0) continue;\n             if(B.at(i) != '?' && B.at(i)-'0' != l) continue;\n             \n             if(C.at(i) == '?' || (j+k+l)%10 == C.at(i)-'0'){\n               dp.at(i+1).at( (j+k+l)/10 ) += dp.at(i).at(j);\n               dp.at(i+1).at( (j+k+l)/10 ) %= mod;\n            }\n             \n          }\n           \n        }\n         \n      }\n       \n    }\n\n  \n    cout << dp.at(n).at(0) << endl;\n    \n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#define mod 1000000007\nusing namespace std;\n\nint main()\n{ \n  string a,b,c;\n  long long dp[51][2];\n  \n  while(1){\n    cin>>a;\n    if(a==\"0\")break;\n    cin>>b>>c;\n\n    memset(dp,0,sizeof(dp));\n    dp[a.length()][0]=1;\n\n    for(int l=a.length()-1;l>=0;l--){\n      int A,B,C;\n      for(int i=0;i<10;i++){\n\tfor(int j=0;j<10;j++){\n\t  for(int k=0;k<10;k++){\n\t    A=i,B=j,C=k;\n\t    if(a[l]!='?')A=(a[l]-'0');\n\t    if(b[l]!='?')B=(b[l]-'0');\n\t    if(c[l]!='?')C=(c[l]-'0');\n            if(l==0 && (A==0 || B==0 || C==0))continue;\n\t    if((A+B)%10==C){\n\t      if((A+B)/10==0)dp[l][0]+=dp[l+1][0];\n\t      else dp[l][1]+=dp[l+1][0];\n\t    }\n\t    if((A+B+1)%10==C){\n\t      if((A+B+1)/10==0)dp[l][0]+=dp[l+1][1];\n\t      else dp[l][1]+=dp[l+1][1];\n\t    }\n\t    dp[l][0]%=mod;\n\t    dp[l][1]%=mod;\n\t    if(c[l]!='?')break;\n\t  }\n\t  if(b[l]!='?')break;\n\t}\n\tif(a[l]!='?')break;\n      }\n      //cout<<dp[l][0]<<\" \"<<dp[l][1]<<endl;\n    }\n    cout<<dp[0][0]<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <memory>\n#include <cstring>\n#include <cassert>\n#include <numeric>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <cctype>\n#include <unordered_map>\n#include <unordered_set>\nusing namespace std;\n\n#define REP2(i, m, n) for (int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(S) (S).begin(), (S).end()\ntypedef long long ll;\n\nll memo[60][2];\nconst ll mod = 1000 * 1000 * 1000 + 7;\n\nint rec(int pos, int carry, const string &A, const string &B, const string &C){\n  if (pos == -1){\n    return carry == 0;\n  }\n\n  if (memo[pos][carry] != -1){\n    return memo[pos][carry];\n  }\n\n  ll &res = memo[pos][carry] = 0;\n\n  REP(a, 10){\n    REP(b, 10){\n      if (A[pos] != '?' && A[pos] != '0' + a) continue;\n      if (B[pos] != '?' && B[pos] != '0' + b) continue;\n      if (pos == 0 && (a == 0 || b == 0)) continue;\n\n      int c = (a + b + carry) / 10;\n      int d = (a + b + carry) % 10;\n\n      if (C[pos] == '?' || C[pos] == '0' + d){\n        res += rec(pos - 1, c, A, B, C);\n        res %= mod;\n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  ios::sync_with_stdio(false);\n\n  string A, B, C;\n  while (cin >> A && A != \"0\"){\n    cin >> B >> C;\n    memset(memo, -1, sizeof(memo));\n\n    cout << rec(A.size() - 1, 0, A, B, C) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-9;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\nclass Graph{\n\tprivate:\n\tint n;\n\tvector<vector<pair<int,double>>> g;\n\tpublic:\n\tvd DIJ(int s){\n\t\tpriority_queue<pair<double,int>> q;\n\t\tvd d(n,inf);\n\t\td[s]=0;\n\t\tq.push(make_pair(0,s));\n\t\twhile(!q.empty()){\n\t\t\tauto p=q.top();\n\t\t\tq.pop();\n\t\t\tint v=p.second;\n\t\t\tif(d[v]<-p.first) continue;\n\t\t\tfor(auto i:g[v]){\n\t\t\t\tint u=i.first;\n\t\t\t\tdouble D=d[v]+i.second;\n\t\t\t\tif(d[u]>D){\n\t\t\t\t\td[u]=D;\n\t\t\t\t\tq.push({-D,u});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn d;\n\t}\n\tGraph(int v){\n\t\tn=v;\n\t\tg=vector<vector<pair<int,double>>>(v);\n\t}\n\tvoid add_edge(int s,int t,double c){\n//\t\tcout<<s<<' '<<t<<' '<<syosu(9)<<c<<endl;\n\t\tg[s].push_back(make_pair(t,c));\n\t}\n};\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tstring a,b,c;\n\t\tcin>>a;\n\t\tif(a==\"0\") break;\n\t\tcin>>b>>c;\n\t\tint n=a.size();\n\t\tvi dp(3);\n\t\tdp[0]++;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tvi DP(3);\n\t\t\tfor(int j=0;j<10;j++) for(int k=0;k<10;k++) for(int l=0;l<10;l++){\n\t\t\t\tif(a[i]!='?'&&a[i]-'0'!=j) continue;\n\t\t\t\tif(b[i]!='?'&&b[i]-'0'!=k) continue;\n\t\t\t\tif(c[i]!='?'&&c[i]-'0'!=l) continue;\n\t\t\t\tif(i==0&&j==0) continue;\n\t\t\t\tif(i==0&&k==0) continue;\n\t\t\t\tif(i==0&&l==0) continue;\n\t\t\t\tfor(int I=0;I<3;I++){\n\t\t\t\t\tint t=10*I+l-j-k;\n\t\t\t\t\tif(0<=t&&t<3) (DP[t]+=dp[I])%=mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp=DP;\n\t\t}\n\t\tcout<<dp[0]<<endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\n#define int long long\ntypedef pair<int,int> P;\nstring s[3];\nint c;\nP ch(int p,int x){\n  P a;a=P(0,0);\n  r(i,10)if(c+i)if(s[0][p]=='?'||s[0][p]==i+'0')\n    r(j,10)if(c+j)if(s[1][p]=='?'||s[1][p]==j+'0'){\n      int t=i+j+x;\n      if(s[2][p]!='?'&&t%10!=s[2][p]-'0')continue;\n      if(t>9)a.fi++;\n      else a.se++;\n    }\n  return a;\n}\nmain(){\n  while(cin>>s[0],s[0]!=\"0\"){\n    cin>>s[1]>>s[2];c=1;\n    r(i,3)reverse(s[i].begin(),s[i].end());\n    int sum1=1,sum2=0,t;\n    r(i,s[0].size()){\n      if(i==s[0].size()-1)c--;\n      P a1,a2;t=0;\n      a1=ch(i,0);\n      a2=ch(i,1);\n      t=sum1*a1.se+sum2*a2.se;\n      sum2=sum1*a1.fi+sum2*a2.fi;\n      sum1=t;\n      sum1=sum1%1000000007;\n      sum2=sum2%1000000007;\n    }\n    cout<<sum1<<endl;\n  }\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n\nchar A[105],B[105],C[105];\nint dp[105][2],d,c,i,j,a,b;\nconst int M=1000000007;\nint main()\n{\n\tfor(;scanf(\"%s%s%s\",A,B,C),A[0]!='0';)\n\t{\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[strlen(A)][0]=1;\n\t\tfor(d=strlen(A)-1;d>=0;d--)\n\t\t\tfor(c=0;c<2;c++)\n\t\t\t{\n\t\t\t\tif(A[d]=='?')\n\t\t\t\t{\n\t\t\t\t\tfor(a=d==0?1:0;a<=9;a++)\n\t\t\t\t\t\tif(B[d]=='?')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(b=d==0?1:0;b<=9;b++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(C[d]=='?'||C[d]-'0'==(a+b+c)%10)\n\t\t\t\t\t\t\t\t\tdp[d][a+b+c>9?1:0]=(dp[d][a+b+c>9?1:0]+dp[d+1][c])%M;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tb=B[d]-'0';\n\t\t\t\t\t\t\tif(C[d]=='?'||C[d]-'0'==(a+b+c)%10)\n\t\t\t\t\t\t\t\tdp[d][a+b+c>9?1:0]=(dp[d][a+b+c>9?1:0]+dp[d+1][c])%M;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ta=A[d]-'0';\n\t\t\t\t\tif(B[d]=='?')\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(b=d==0?1:0;b<=9;b++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(C[d]=='?'||C[d]-'0'==(a+b+c)%10)\n\t\t\t\t\t\t\t\tdp[d][a+b+c>9?1:0]=(dp[d][a+b+c>9?1:0]+dp[d+1][c])%M;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tb=B[d]-'0';\n\t\t\t\t\t\tif(C[d]=='?'||C[d]-'0'==(a+b+c)%10)\n\t\t\t\t\t\t\tdp[d][a+b+c>9?1:0]=(dp[d][a+b+c>9?1:0]+dp[d+1][c])%M;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\tprintf(\"%d\\n\",dp[0][0]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<math.h>\n#include<string.h>\n#include<stdbool.h>\n#include<assert.h>\n#include<ctype.h>\ntypedef long long ll;\ntypedef long double ld;\n#define rep(i,l,r)for(ll i=(l);i<(r);i++)\n#define repp(i,l,r,k)for(ll i=(l);i<(r);i+=(k))\n#define rrep(i,l,r)for(ll i=(l);i>=(r);i--)\n#define INF (1LL<<60)\n#define MOD1 1000000007\n#define MOD2 998244353\n#define MAX_N (1 << 20)\n#define YES printf(\"Yes\\n\")\n#define NO printf(\"No\\n\")\n#define PN printf(\"\\n\")\n#define charsize 100005 //10^5+5\n#define PI 3.141592653589793238\n\nvoid swap(ll *a, ll *b){ll c;c=*b;*b=*a;*a= c;}\nvoid cin(ll *n){ scanf(\"%lld\",&(*n)); }\nll max2(ll a,ll b){return a>=b?a:b;}\nll min2(ll a,ll b){return a>=b?b:a;}\nll min3(ll a, ll b, ll c){return (a<=b && a<=c) ? a : b<=c ? b : c;}\nll max3(ll a, ll b, ll c){return (a>=b && a>=c) ? a : b>=c ? b : c;}\nll minn(ll n, ll a[]){ll b=INF;rep(i,0,n) b=min2(b,a[i]);return b;}\nll maxn(ll n, ll a[]){ll b=-INF;rep(i,0,n) b=max2(b,a[i]);return b;}\nll POW(ll a, ll b){ll c=1;rep(i,0,b) c*=a;return c;}\ndouble POW_d(double a, double b){double c=1;rep(i,0,b) c*=a;return c;}\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\nll mod_MOD1(ll n){n+= n<0?((-n)/MOD1+1)*MOD1:0; return n%=MOD1;}\nll mod_p(ll n ,ll p){n+= n<0?((-n)/p+1)*p:0; return n%=p;}\nll change_into_num(char s[] , ll len, ll p){ return !p ? 0 : POW(10,p-1)*(s[len-p]-'0') + change_into_num(s,len,p-1); }\nll digits(ll a, ll b){return a/b?1+digits(a/b,b):1;}\nll base(ll n, ll a, ll i){return i==1?n%a:base(n/a,a,i-1);}\nll is_inArr1(ll x, ll n){ return ( x<0 || x>=n ) ? 0 : 1 ; }\nll is_inArr2(ll y, ll x, ll h, ll w){ return ( y<0 || y>=h || x<0 || x>=w ) ? 0 : 1 ; }\n\n\nvoid lr_lower( int *l, int *r, ll am, ll val , int type ){ (type<3) ? ( am < val ?  ( *l = (*l+*r)/2 ) : ( *r= (*l+*r)/2 ) ) : ( am <= val ? ( *l = (*l+*r)/2 ) : ( *r= (*l+*r)/2 ) ); }\nvoid lr_upper( int *l, int *r, ll am, ll val , int type ){ (type<3) ? ( am <= val ?  ( *l = (*l+*r)/2 ) : ( *r= (*l+*r)/2 ) ) : ( am < val ? ( *l = (*l+*r)/2 ) : ( *r= (*l+*r)/2 ) ); }\nint cmp_lower( ll a, ll b, int type ){ return (type==1) ? ( a==b ? 1 : 0 ) : (type==2) ? ( a>=b ? 1 : 0 ) : ( a>b ? 1 : 0 ) ; }\nint cmp_upper( ll a, ll b, int type ){ return (type==1) ? ( a==b ? 1 : 0 ) : (type==2) ? ( a<=b ? 1 : 0 ) : ( a<b ? 1 : 0 ) ; }\n// return smallest p  which meets  a[p]==val :1  >=:2   >:3\nll lower_bound( ll a[], int l, int r, ll val , int type ){  while(r-l>1) lr_lower(&l,&r,a[ (l+r)/2 ],val,type);  return cmp_lower(a[l],val,type) ? l : cmp_lower(a[r],val,type) ? r : -1;  }\n// return biggest p  which meets   a[p]==val :1  <=:2   <:3\nll upper_bound( ll a[], int l, int r, ll val , int type ){  while(r-l>1) lr_upper(&l,&r,a[ (l+r)/2 ],val,type); return cmp_upper(a[r],val,type) ? r : cmp_upper(a[l],val,type) ? l : -1; }\n// count i  which meets ai==x\nll count(ll a[], int l, int r, ll x){  int p = lower_bound(a,l,r,x,1);  return p==-1 ? 0 : upper_bound(a,p,r,x,1)-p+1; }\n\nll *factors[2] , fac_cnt=0 , is_factor_prepared=0;\nll factor_pre(){  rep(i,0,1){ if(is_factor_prepared++) return 0; }  ll tmp=(1e6)/2+1, fac_tmp[tmp];  rep(i,0,tmp){fac_tmp[i]=i?2*i+1:2;}  rep(i,1,tmp){if(fac_tmp[i]){  repp(j,3,tmp/(2*i+1)+1,2 ){  if( j*(2*i+1)<tmp ) fac_tmp[ (j*(2*i+1)-1)/2 ]=0;  }  }else continue;}  rep(i,0,tmp){if(fac_tmp[i]){  rep(j,0,2){ factors[j] = realloc( factors[j] , sizeof(ll)*( fac_cnt +1 ) );  factors[j][j?fac_cnt++:fac_cnt]=j?0:fac_tmp[i];  }  } }  return 0;  }\nll factor(ll n, ll new_common_plus){ factor_pre();  rep(i,0,fac_cnt){ ll cnt=0; rep(j,0,1){ while( ( cnt+= n %factors[0][i]==0 ? 1 : 0 )  && (n/=factors[0][i]) %factors[0][i]==0 ) continue; } factors[1][i]= new_common_plus==1 ? cnt :  new_common_plus==2 ? max2(factors[1][i],cnt) : factors[1][i]+cnt ;  if( factors[0][i]> n ) break; } return n; }\nll judge_prime(ll n){ factor_pre(); rep(i,0,fac_cnt){ if(n<factors[0][i]*factors[0][i] || n==factors[0][i]) break; else if(n%factors[0][i]==0) n/=n; }  return n==1?0:1; }\n\nll *mf_arr,*inv_arr,*finv_arr,is_minv_made=0,is_mf_made=0,num_of_inv=2*1e6+10;\nll makeinv(ll n , ll mod){  rep(i,0,1){if(is_minv_made++) return 0;}  inv_arr = realloc(inv_arr, sizeof(ll)*2 );  finv_arr = realloc(finv_arr, sizeof(ll)*2 );  inv_arr[1]=1;finv_arr[0]=finv_arr[1]=1;  rep(i,2,n+1){  inv_arr = realloc(inv_arr, sizeof(ll)*(i+1) );  finv_arr = realloc(finv_arr, sizeof(ll)*(i+1) );  inv_arr[i]= mod - inv_arr[mod%i] * (mod / i) % mod;  finv_arr[i] = finv_arr[i - 1] * inv_arr[i] % mod;  }  return 0; }\nll make_mf(ll n, ll mod){  rep(i,0,1){ if(is_mf_made++) return 0; }  mf_arr = realloc(mf_arr, sizeof(ll)*2 );  ll x=1;  mf_arr[0]=mf_arr[1]=x;  rep(i,2,n+1){   x=x*i%mod;  mf_arr = realloc(mf_arr, sizeof(ll)*(i+1) );  mf_arr[i]=x; }  return 0;  }\nll m_inv(ll x, ll mod, ll is_fac ){ makeinv(num_of_inv,mod);  return is_fac?finv_arr[x]:inv_arr[x]; }\nll m_f(ll x, ll mod){  make_mf(num_of_inv,mod);  return mf_arr[x];  }\nll mod_nck(ll n, ll k, ll mod){ return m_f(n,mod)*m_inv(k,mod,1)%mod*m_inv(n-k,mod,1)%mod; }\nll m_p(ll r,ll n,ll mod){  ll t=1,s=r;  while(n>0){ t = (n&1) ? t*s%mod : t;  s=s*s%mod; n>>=1; }  return r?t:0;  }\nll m_mul2(ll a, ll b, ll mod){ return a*b%mod; }\nll m_mul3(ll a, ll b, ll c, ll mod){ return m_mul2(a*b%mod,c,mod); }\nll m_mul4(ll a, ll b, ll c, ll d, ll mod){ return m_mul3(a*b%mod,c,d,mod); }\nll m_mul5(ll a, ll b, ll c, ll d, ll e, ll mod){ return m_mul4(a*b%mod,c,d,e,mod); }\n\nint upll(const void*a, const void*b){return*(ll*)a<*(ll*)b?-1:*(ll*)a>*(ll*)b?1:0;}\nint downll(const void*a, const void*b){return*(ll*)a<*(ll*)b?1:*(ll*)a>*(ll*)b?-1:0;}\nint cmp_string( const void * a , const void * b ) {  return strcmp( (char *)a , (char *)b ); }  // qsort((void*)s,n,sizeof(s[0]),int_sort );\nint cmp_char(const void * a, const void * b) { return *(char *)a - *(char *)b;}\nvoid sortup(ll*a,int n){qsort(a,n,sizeof(ll),upll);}\nvoid sortdown(ll*a,int n){qsort(a,n,sizeof(ll),downll);}\nvoid sort_string(int n,int size,char s[][size]){ qsort( (void*)s , n , sizeof(s[0]) , cmp_string ); }\nvoid sort_char(char *s){ qsort( (void *)s , strlen(s) , sizeof(char) , cmp_char ); }\nll unique_string(ll n ,ll size, char s[][size]){ ll ans=1; rep(i,1,n) if( strcmp(s[i],s[i-1]) ) ans++; return ans; }\nll unique_num(ll n , ll a[]){ ll ans=1; rep(i,1,n) if( a[i]!=a[i-1] ) ans++; return ans; }\n\ntypedef struct{ ll a , b;}fr;\nint cmp1( const void *p, const void *q ) { return ((fr*)p) ->a - ((fr*)q)->a;}\nint cmp2( const void *p, const void *q ) { return ((fr*)q) ->a - ((fr*)p)->a;}\nvoid strsortup(fr*a,int n){qsort(a,n,sizeof(fr),cmp1);}\nvoid strsortdown(fr*a,int n){qsort(a,n,sizeof(fr),cmp2);}\n\n\n\n\nchar a[3][1151154];\n// char b[1151154];\n// char c[1151154];\nint main(void){\n    // fgets(s,sizeof(s),stdin); \n    // ll ans=0;\n    while(1){\n        scanf(\"%s\",a[0]);\n        if(a[0][0]=='0') break;\n        scanf(\"%s\",a[1]);\n        scanf(\"%s\",a[2]);\n        ll n=strlen(a[0]);\n        ll dp[55][2]={};\n        dp[n][0]=1;\n        rrep(i,n-1,0){\n            ll e=0;\n            rep(j,0,3){\n                if(a[j][i]=='?') e++;\n            }\n            if(!e){\n                if( (a[0][i]-'0'+a[1][i]-'0')%10==a[2][i]-'0' ){\n                    if(a[0][i]-'0'+a[1][i]-'0'>9) dp[i][1]=dp[i+1][0];\n                    else dp[i][0]=dp[i+1][0];\n                }else if( (a[0][i]-'0'+a[1][i]-'0'+1)%10==a[2][i]-'0' ){\n                    // printf(\"%lld\\n\",i);\n                    if(a[0][i]-'0'+a[1][i]-'0'+1>9) dp[i][1]=dp[i+1][1];\n                    else dp[i][0]=dp[i+1][1];\n                }\n            }\n            if(e==1){\n                if(a[2][i]=='?'){\n                    if((a[0][i]-'0'+a[1][i]-'0')<9){\n                        dp[i][0]=dp[i+1][0]+dp[i+1][1];\n                    }\n                    if((a[0][i]-'0'+a[1][i]-'0')==9){\n                        dp[i][0]=dp[i+1][0];\n                        dp[i][1]=dp[i+1][1];\n                    }\n                    if((a[0][i]-'0'+a[1][i]-'0')>9){\n                        dp[i][1]=dp[i+1][0]+dp[i+1][1];\n                    }\n                }else{\n                    ll t;\n                    if(a[0][i]=='?') t=a[1][i]-'0';\n                    else t=a[0][i]-'0';\n                    if(t<a[2][i]-'0'){\n                        dp[i][0]=dp[i+1][0]+dp[i+1][1];\n                    }\n                    if(t==a[2][i]-'0'){\n                        if(i) dp[i][0]=dp[i+1][0];\n                        dp[i][1]=dp[i+1][1];\n                    }\n                    if(t>a[2][i]-'0'){\n                        dp[i][1]=dp[i+1][0]+dp[i+1][1];\n                    }\n                }\n            }\n            if(e==2){\n                ll t;\n                if(a[2][i]=='?'){\n                    if(a[0][i]=='?') t=a[1][i]-'0';\n                    else t=a[0][i]-'0';\n                    // printf(\"%lld\\n\",t);\n                    dp[i][1]=dp[i+1][0]*t+dp[i+1][1]*(t+1);\n                    if(i) dp[i][0]=dp[i+1][0]*(10-t)+dp[i+1][1]*(9-t);\n                    else dp[i][0]=dp[i+1][0]*(9-t)+ max2(0, dp[i+1][1]*(8-t) );\n                }else{\n                    t=a[2][i]-'0';\n                    dp[i][1]=dp[i+1][0]*(9-t)+dp[i+1][1]*(10-t);\n                    if(i) dp[i][0]=dp[i+1][0]*(t+1)+dp[i+1][1]*(t);\n                    else dp[i][0]= max2(0, dp[i+1][0]*(t-1) ) + max2(0, dp[i+1][1]*(t-2) );\n                }\n            }\n            if(e==3){\n                rep(t,0,10){\n                    dp[i][1]+=dp[i+1][0]*(9-t)+dp[i+1][1]*(10-t);\n                    if(i) dp[i][0]+=dp[i+1][0]*(t+1)+dp[i+1][1]*(t);\n                    else dp[i][0]+= max2(0, dp[i+1][0]*(t-1) ) + max2(0, dp[i+1][1]*(t-2) );\n                }\n            }\n            dp[i][0]%=MOD1;\n            dp[i][1]%=MOD1;\n        }\n        // rep(i,0,n){\n        //     printf(\"%lld %lld\\n\",dp[i][0],dp[i][1]);            \n        // }   \n        printf(\"%lld\\n\",dp[0][0]);\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C",
    "code": "// AOJ 2566: Restore Calculation\n// 2018.1.8 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\n#define M 1000000007\n\nint sz;\nint a[52][10], b[52][10], c[52][10];\nint ha[52], hb[52], hc[52];\nint dp[52][2];\n\nvoid pb(int a[52][10], int *h, char *p)\n{\n\tint i, j, k;\n\tchar *q = p;\n\n\twhile (*p > ' ') p++; sz = p-q;\n\ti = 0; while (--p >= q) {\n\t\th[i] = 0;\n\t\tif (*p != '?') a[i][0] = *p & 0xf, h[i]++;\n\t\telse { k = (p == q), j = 10-k; while (j--) a[i][j] = k, k++, h[i]++; }\n\t\ti++;\n\t}\n}\n\nint main()\n{\n\tint i, k, aa, bb, cc, sum, dig, ca;\n\tchar buf[55];\n\n\twhile (fgets(buf, 55, stdin) && *buf != '0') {\n\t\tpb(a, ha, buf);\n\t\tfgets(buf, 55, stdin), pb(b, hb, buf);\n\t\tfgets(buf, 55, stdin), pb(c, hc, buf);\n\n\t\tmemset(dp, 0, sizeof(dp));\n\t    dp[0][0] = 1;\n\n\t\tfor (i = 0; i < sz; i++) for (k = 0; k < 2; k++) {\n\t\t\tfor (aa = 0; aa < ha[i]; aa++) for (bb = 0; bb < hb[i]; bb++) for (cc = 0; cc < hc[i]; cc++) {\n\t\t        sum = a[i][aa] + b[i][bb] + k;\n\t\t\t\tdig = sum % 10, ca = sum / 10;\n\t\t\t\tif (dig == c[i][cc]) {\n\t\t\t\t\tdp[i+1][ca] += dp[i][k];\n\t\t\t\t\tif (dp[i+1][ca] >= M) dp[i+1][ca] -= M;\n\t\t        }\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", dp[sz][0]);\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\n#define MOD_BY 1000000007\n#define BUFFER_SIZE 100\n\nchar A[BUFFER_SIZE];\nchar B[BUFFER_SIZE];\nchar C[BUFFER_SIZE];\n\n/* [pos][carry] */\nint memo[BUFFER_SIZE][2];\n\nint search(int pos,int carry) {\n\tint ret=0;\n\tint a,b;\n\tint amin,amax,bmin,bmax;\n\tif(pos<0)return (carry==0?1:0);\n\tif(memo[pos][carry]>0)return memo[pos][carry]-1;\n\tif(A[pos]=='?'){amin=0;amax=9;} else amin=amax=A[pos]-'0';\n\tif(B[pos]=='?'){bmin=0;bmax=9;} else bmin=bmax=B[pos]-'0';\n\tfor(a=amin;a<=amax;a++) {\n\t\tfor(b=bmin;b<=bmax;b++) {\n\t\t\tint c=a+b+carry;\n\t\t\tint cv=c%10,cc=c/10;\n\t\t\t/* zero at first digit is not arrowed */\n\t\t\tif(pos==0 && (a==0 || b==0 || cv==0))continue;\n\t\t\tif(C[pos]=='?' || C[pos]==cv+'0') {\n\t\t\t\tret+=search(pos-1,cc);\n\t\t\t\tif(ret>=MOD_BY)ret-=MOD_BY;\n\t\t\t}\n\t\t}\n\t}\n\tmemo[pos][carry]=ret+1;\n\treturn ret;\n}\n\nint main(void) {\n\twhile(scanf(\"%s\",A)==1) {\n\t\tint i;\n\t\tif(A[0]=='0')break;\n\t\tif(scanf(\"%s%s\",B,C)!=2)break;\n\t\tfor(i=0;i<BUFFER_SIZE;i++) {\n\t\t\tmemo[i][0]=memo[i][1]=0;\n\t\t}\n\t\tfor(i=0;A[i]!='\\0';i++);\n\t\tprintf(\"%d\\n\",search(i-1,0));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic long MOD = 1000000007;\n\tstatic char[] A, B, C;\n\n\tpublic static void main(String[] args) {\n\t\twhile (sc.hasNext()) {\n\t\t\tA = sc.next().toCharArray();\n\t\t\tif (!sc.hasNext()) break;\n\t\t\tB = sc.next().toCharArray();\n\t\t\tC = sc.next().toCharArray();\n\t\t\tSystem.out.println(solve());\n\t\t}\n\t}\n\n\tstatic long solve() {\n\t\tlong[][] dp = new long[2][A.length + 1];\n\t\tdp[0][A.length] = 1;\n\t\tfor (int i = A.length - 1; i >= 0; --i) {\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tif (A[i] != '?' && A[i] - '0' != j) continue;\n\t\t\t\tfor (int k = 0; k < 10; ++k) {\n\t\t\t\t\tif (B[i] != '?' && B[i] - '0' != k) continue;\n\t\t\t\t\tif (i == 0 && (j == 0 || k == 0)) continue;\n\t\t\t\t\tfor (int carry = 0; carry <= 1; ++carry) {\n\t\t\t\t\t\tint sum = j + k + carry;\n\t\t\t\t\t\tif (C[i] != '?' && sum % 10 != C[i] - '0') continue;\n\t\t\t\t\t\tdp[sum / 10][i] += dp[carry][i + 1];\n\t\t\t\t\t\tdp[sum / 10][i] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dp[0][0];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic long MOD = 1_000_000_007;\n\tstatic char[] A, B, C;\n\n\tpublic static void main(String[] args) {\n\t\twhile (sc.hasNext()) {\n\t\t\tA = sc.next().toCharArray();\n\t\t\tif (A.equals(\"0\")) continue;\n\t\t\tB = sc.next().toCharArray();\n\t\t\tC = sc.next().toCharArray();\n\t\t\tSystem.out.println(solve());\n\t\t}\n\t}\n\n\tstatic long solve() {\n\t\tlong[][] dp = new long[2][A.length + 1];\n\t\tdp[0][A.length] = 1;\n\t\tfor (int i = A.length - 1; i >= 0; --i) {\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tif (A[i] != '?' && A[i] - '0' != j) continue;\n\t\t\t\tfor (int k = 0; k < 10; ++k) {\n\t\t\t\t\tif (B[i] != '?' && B[i] - '0' != k) continue;\n\t\t\t\t\tif (i == 0 && (j == 0 || k == 0)) continue;\n\t\t\t\t\tfor (int carry = 0; carry <= 1; ++carry) {\n\t\t\t\t\t\tint sum = j + k + carry;\n\t\t\t\t\t\tif (C[i] != '?' && sum % 10 != C[i] - '0') continue;\n\t\t\t\t\t\tdp[sum / 10][i] += dp[carry][i + 1];\n\t\t\t\t\t\tdp[sum / 10][i] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dp[0][0];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic long MOD = 1000000007;\n\tstatic char[] A, B, C;\n\n\tpublic static void main(String[] args) {\n\t\twhile (sc.hasNext()) {\n\t\t\tA = sc.next().toCharArray();\n\t\t\tif (A.equals(\"0\")) continue;\n\t\t\tB = sc.next().toCharArray();\n\t\t\tC = sc.next().toCharArray();\n\t\t\tSystem.out.println(solve());\n\t\t}\n\t}\n\n\tstatic long solve() {\n\t\tlong[][] dp = new long[2][A.length + 1];\n\t\tdp[0][A.length] = 1;\n\t\tfor (int i = A.length - 1; i >= 0; --i) {\n\t\t\tfor (int j = 0; j < 10; ++j) {\n\t\t\t\tif (A[i] != '?' && A[i] - '0' != j) continue;\n\t\t\t\tfor (int k = 0; k < 10; ++k) {\n\t\t\t\t\tif (B[i] != '?' && B[i] - '0' != k) continue;\n\t\t\t\t\tif (i == 0 && (j == 0 || k == 0)) continue;\n\t\t\t\t\tfor (int carry = 0; carry <= 1; ++carry) {\n\t\t\t\t\t\tint sum = j + k + carry;\n\t\t\t\t\t\tif (C[i] != '?' && sum % 10 != C[i] - '0') continue;\n\t\t\t\t\t\tdp[sum / 10][i] += dp[carry][i + 1];\n\t\t\t\t\t\tdp[sum / 10][i] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dp[0][0];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static final long MOD = 1000000007;\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tchar[] aa = sc.next().toCharArray();\n\t\t\tif (aa[0] == '0') {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchar[] bb = sc.next().toCharArray();\n\t\t\tchar[] cc = sc.next().toCharArray();\n\t\t\tint n = aa.length;\n\t\t\tlong[][] dp = new long[n+1][2];\n\t\t\tdp[0][0] = 1;\n\t\t\tfor(int i=1;i<=n;i++) {\n\t\t\t\tint da = aa[n-i] == '?' ? -1 : aa[n-i] - '0';\n\t\t\t\tint db = bb[n-i] == '?' ? -1 : bb[n-i] - '0';\n\t\t\t\tint dc = cc[n-i] == '?' ? -1 : cc[n-i] - '0';\n\t\t\t\tfor(int j=0;j<2;j++) {\n\t\t\t\t\tfor(int carry=0;carry<2;carry++) {\n\t\t\t\t\t\tint patterns = 0;\n\t\t\t\t\t\tfor(int a=0;a<10;a++) {\n\t\t\t\t\t\t\tif (da != -1 && da != a) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor(int b=0;b<10;b++) {\n\t\t\t\t\t\t\t\tif (db != -1 && db != b) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tint c = a + b + carry;\n\t\t\t\t\t\t\t\tif ((j == 0 && c >= 10) || (j == 1 && c < 10)) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (i == n) {\n\t\t\t\t\t\t\t\t\tif (a * b * c == 0) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (dc == -1 || dc == c%10) {\n\t\t\t\t\t\t\t\t\tpatterns++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][j] += dp[i-1][carry] * patterns % MOD;\n\t\t\t\t\t\tdp[i][j] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//System.out.println(Arrays.deepToString(dp));\n\t\t\tSystem.out.println(dp[n][0]);\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint mod = 1000000007;\n\n\tboolean isOk(char ch, int val) {\n\t\treturn ch == '?' || ch - '0' == val;\n\t}\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tString A = in.next();\n\t\t\tif (A.matches(\"0\")) break;\n\t\t\tString B = in.next();\n\t\t\tString C = in.next();\n\t\t\t\n\t\t\tint n = A.length();\n\t\t\tint[][] dp = new int[2][n+1];\n\t\t\tdp[0][0] = 1;\n\t\t\t\n\t\t\tfor (int i = 0; i < n; i++) for (int j = 0; j < 2; j++) {\n\t\t\t\tif (dp[j][i] == 0) continue;\n\t\t\t\t\n\t\t\t\tint start = (i == n - 1) ? 1 : 0;\n\t\t\t\tfor (int a = start; a < 10; a++) if (isOk(A.charAt(n-i-1), a)) {\n\t\t\t\t\tfor (int b = start; b < 10; b++) if (isOk(B.charAt(n-i-1), b)) {\n\t\t\t\t\t\tint c = (a + b + j) % 10;\n\t\t\t\t\t\tint nj = (a + b + j) >= 10 ? 1 : 0;\n\t\t\t\t\t\tif (isOk(C.charAt(n-i-1), c)) {\n\t\t\t\t\t\t\tdp[nj][i+1] = (dp[nj][i+1] + dp[j][i]) % mod;\n//\t\t\t\t\t\t\tSystem.out.println(a + \" \" + b + \" \" + c + \" : \" + \"(\" + nj + \" \" + (i+1) + \" ) \" + dp[nj][i+1] + \" <- (\" + j + \" \" + i + \") \" + dp[j][i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(dp[0][n]);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tint[][] nextIntMap(int n, int m) {\n\t\t\tint[][] map = new int[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = in.nextIntArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong[][] nextLongMap(int n, int m) {\n\t\t\tlong[][] map = new long[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = in.nextLongArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble[][] nextDoubleMap(int n, int m) {\n\t\t\tdouble[][] map = new double[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = in.nextDoubleArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.Arrays;\nimport java.util.StringJoiner;\nimport java.util.StringTokenizer;\n\npublic class Main {\n\n    static String A, B, C;\n\n    public static void main(String[] args) {\n        FastScanner sc = new FastScanner(System.in);\n\n        while(true) {\n            A = sc.next();\n\n            if( A.equals(\"0\") ) break;\n\n            B = sc.next();\n            C = sc.next();\n\n            System.out.println( solve() );\n        }\n    }\n\n    static int solve() {\n        int N = A.length();\n        int[][] dp = new int[N+1][2];\n        dp[N][0] = 1;\n        for (int i = N-1; i >= 0; i--) {\n            // a + b = c\n            char a = A.charAt(i);\n            char b = B.charAt(i);\n            char c = C.charAt(i);\n            int from = i == 0 ? 1 : 0;\n            for (int x = from; x <= 9; x++) {\n                if( a != '?' && (a-'0') != x ) continue;\n\n                for (int y = from; y <= 9; y++) {\n                    if( b != '?' && (b-'0') != y ) continue;\n\n                    for (int z = from; z <= 9; z++) {\n                        if( c != '?' && (c-'0') != z ) continue;\n\n                        if( x + y == z ) {\n                            dp[i][0] += dp[i+1][0];\n                            dp[i][0] %= MOD;\n                        }\n\n                        if( x + y == z+10 ) {\n                            dp[i][1] += dp[i+1][0];\n                            dp[i][1] %= MOD;\n                        }\n\n                        if( x + y + 1 == z ) {\n                            dp[i][0] += dp[i+1][1];\n                            dp[i][0] %= MOD;\n                        }\n\n                        if( x + y + 1 == z+10 ) {\n                            dp[i][1] += dp[i+1][1];\n                            dp[i][1] %= MOD;\n                        }\n                    }\n                }\n            }\n        }\n\n        return dp[0][0]; // 繰り上がってないほう\n    }\n\n    static int MOD = 1_000_000_007;\n\n    @SuppressWarnings(\"unused\")\n    static class FastScanner {\n        private BufferedReader reader;\n        private StringTokenizer tokenizer;\n\n        FastScanner(InputStream in) {\n            reader = new BufferedReader(new InputStreamReader(in));\n            tokenizer = null;\n        }\n\n        String next() {\n            if (tokenizer == null || !tokenizer.hasMoreTokens()) {\n                try {\n                    tokenizer = new StringTokenizer(reader.readLine());\n                } catch (IOException e) {\n                    throw new RuntimeException(e);\n                }\n            }\n            return tokenizer.nextToken();\n        }\n\n        String nextLine() {\n            if (tokenizer == null || !tokenizer.hasMoreTokens()) {\n                try {\n                    return reader.readLine();\n                } catch (IOException e) {\n                    throw new RuntimeException(e);\n                }\n            }\n            return tokenizer.nextToken(\"\\n\");\n        }\n\n        long nextLong() {\n            return Long.parseLong(next());\n        }\n\n        int nextInt() {\n            return Integer.parseInt(next());\n        }\n\n        int[] nextIntArray(int n) {\n            int[] a = new int[n];\n            for (int i = 0; i < n; i++) a[i] = nextInt();\n            return a;\n        }\n\n        int[] nextIntArray(int n, int delta) {\n            int[] a = new int[n];\n            for (int i = 0; i < n; i++) a[i] = nextInt() + delta;\n            return a;\n        }\n\n        long[] nextLongArray(int n) {\n            long[] a = new long[n];\n            for (int i = 0; i < n; i++) a[i] = nextLong();\n            return a;\n        }\n    }\n\n    static void writeLines(int[] as) {\n        PrintWriter pw = new PrintWriter(System.out);\n        for (int a : as) pw.println(a);\n        pw.flush();\n    }\n\n    static void writeLines(long[] as) {\n        PrintWriter pw = new PrintWriter(System.out);\n        for (long a : as) pw.println(a);\n        pw.flush();\n    }\n\n    static void writeSingleLine(int[] as) {\n        PrintWriter pw = new PrintWriter(System.out);\n        for (int i = 0; i < as.length; i++) {\n            if (i != 0) pw.print(\" \");\n            pw.print(as[i]);\n        }\n        pw.println();\n        pw.flush();\n    }\n\n    static int max(int... as) {\n        int max = Integer.MIN_VALUE;\n        for (int a : as) max = Math.max(a, max);\n        return max;\n    }\n\n    static int min(int... as) {\n        int min = Integer.MAX_VALUE;\n        for (int a : as) min = Math.min(a, min);\n        return min;\n    }\n\n    static void debug(Object... args) {\n        StringJoiner j = new StringJoiner(\" \");\n        for (Object arg : args) {\n            if (arg == null) j.add(\"null\");\n            else if (arg instanceof int[]) j.add(Arrays.toString((int[]) arg));\n            else if (arg instanceof long[]) j.add(Arrays.toString((long[]) arg));\n            else if (arg instanceof double[]) j.add(Arrays.toString((double[]) arg));\n            else if (arg instanceof Object[]) j.add(Arrays.toString((Object[]) arg));\n            else j.add(arg.toString());\n        }\n        System.err.println(j.toString());\n    }\n\n    static void printSingleLine(int[] array) {\n        PrintWriter pw = new PrintWriter(System.out);\n        for (int i = 0; i < array.length; i++) {\n            if (i != 0) pw.print(\" \");\n            pw.print(array[i]);\n        }\n        pw.println();\n        pw.flush();\n    }\n\n    static int lowerBound(int[] array, int value) {\n        int lo = 0, hi = array.length, mid;\n        while (lo < hi) {\n            mid = (hi + lo) / 2;\n            if (array[mid] < value) lo = mid + 1;\n            else hi = mid;\n        }\n        return lo;\n    }\n\n    static int upperBound(int[] array, int value) {\n        int lo = 0, hi = array.length, mid;\n        while (lo < hi) {\n            mid = (hi + lo) / 2;\n            if (array[mid] <= value) lo = mid + 1;\n            else hi = mid;\n        }\n        return lo;\n    }\n}\n\n"
  },
  {
    "language": "Ruby",
    "code": "module Memoizable\n\tdef memoize(name)\n\t\toriginal = \"__original_#{name}__\"\n\t\t([Class, Module].include?(self.class) ? self : self.class).class_eval {\n\t\t\talias_method(original, name)\n\t\t\tprivate(original)\n\t\t\tcache = {}\n\t\t\tdefine_method(name){|*args|\n\t\t\t\tcache[args] ||= send(original, *args)\n\t\t\t}\n\t\t}\n\tend \nend\ninclude Memoizable \n\ndef f(x, y, z, carry, i)\n\tif i > x.size\n\t\treturn carry == 0 ? 1 : 0\n\tend\n\n\ta = (x[-i] == ?? ? (0..9).to_a : [x[-i].to_i])\n\ta.delete(0) if i == x.size\n\tb = (y[-i] == ?? ? (0..9).to_a : [y[-i].to_i])\n\tb.delete(0) if i == y.size\n\tc = (z[-i] == ?? ? (0..9).to_a : [z[-i].to_i])\n\tc.delete(0) if i == z.size\n\n\tsum = 0\n\ta.each do |u|\n\t\tb.each do |v|\n\t\t\tc.each do |w|\n\t\t\t\to = u + v - w + carry\n\t\t\t\tnext if o % 10 > 0\n\t\t\t\tsum += f(x, y, z, o / 10, i + 1)\n\t\t\tend\n\t\tend\n\tend\n\n\tsum % 1_000_000_007\nend\n\nmemoize :f\n\nloop do\n\tx = gets.chomp\n\tbreak if x == \"0\"\n\ty = gets.chomp\n\tz = gets.chomp\n\tp f(x, y, z, 0, 1)\nend"
  },
  {
    "language": "Ruby",
    "code": "# Header {{{\ndef assert(p)\n  raise 'Assertion Failed' unless p\nend\n\n# Constants {{{\nINF = 10**9\n# }}}\n\n# IO {{{\nclass MyIO\n  def initialize\n    @input = $stdin\n    @output = $stdout\n  end\n\n  # @param filename [String]\n  def set_input(filename)\n    @input = File.open(filename, 'r')\n  end\n\n  def set_output(filename)\n    @output = File.open(filename, 'w')\n  end\n\n  def int\n    gets.to_i\n  end\n\n  def ints\n    split.map(&:to_i)\n  end\n\n  def split\n    @input.gets.chomp.split(' ')\n  end\n  alias_method :strings, :split\n\n  def gets\n    @input.gets.chomp\n  end\n\n  def puts(*args)\n    @output.puts(*args)\n  end\nend\n\nio = MyIO.new\n# }}}\n\n# Algorithms {{{\n\ndef lower_bound(arr, val)\n  assert(arr.is_a?(Array))\n  low, high = 0, arr.size\n  while high - low > 1\n    mid = (low + high) / 2\n    if arr[mid] < val\n      low = mid\n    else\n      high = mid\n    end\n  end\n  if arr[low] >= val\n    low\n  else\n    high\n  end\nend\n\ndef upper_bound(arr, val)\n  assert(arr.is_a?(Array))\n  low, high = 0, arr.size\n  while high - low > 1\n    mid = (low + high) / 2\n    if arr[mid] <= val\n      low = mid\n    else\n      high = mid\n    end\n  end\n  if arr[low] > val\n    low\n  else\n    high\n  end\nend\n\n# }}}\n\n# }}}\n\n# io.set_input('inputs/0.txt')\n\nMOD = 1_000_000_007\n\nwhile true\n  a = io.gets\n  break if a == '0'\n  b, c = io.gets, io.gets\n\n  # dp[pos][carried][carry] = combinations % MOD\n  dp = Array.new(a.length) { Array.new(2) { Array.new(2, 0) } }\n  a.reverse!\n  b.reverse!\n  c.reverse!\n  a.length.times do |i|\n    (0..9).each do |ad|\n      next if (a[i] != '?' && a[i].to_i != ad) || (i == a.length - 1 && ad == 0)\n      (0..9).each do |bd|\n        next if (b[i] != '?' && b[i].to_i != bd) || (i == a.length - 1 && bd == 0)\n        (0..9).each do |cd|\n          next if (c[i] != '?' && c[i].to_i != cd) || (i == a.length - 1 && cd == 0)\n          carried = nil\n          if (ad + bd + 1) % 10 == cd\n            carried = 1\n          elsif (ad + bd) % 10 == cd\n            carried = 0\n          else\n            next\n          end\n          next if i == 0 && carried == 1\n\n          carry = ad + bd + carried >= 10 ? 1 : 0\n          if i == 0\n            dp[i][carried][carry] += 1\n          else\n            dp[i][carried][carry] = (dp[i][carried][carry] + dp[i-1][0][carried] + dp[i-1][1][carried]) % MOD\n          end\n        end\n      end\n    end\n  end\n\n  io.puts (dp[a.length - 1][0][0] + dp[a.length - 1][1][0]) % MOD\nend\n\n# vim: foldmethod=marker"
  },
  {
    "language": "Ruby",
    "code": "# Header {{{\ndef assert(p)\n  raise 'Assertion Failed' unless p\nend\n\n# Constants {{{\nINF = 10**9\n# }}}\n\n# IO {{{\nclass MyIO\n  def initialize\n    @input = $stdin\n    @output = $stdout\n  end\n\n  # @param filename [String]\n  def set_input(filename)\n    @input = File.open(filename, 'r')\n  end\n\n  def set_output(filename)\n    @output = File.open(filename, 'w')\n  end\n\n  def int\n    gets.to_i\n  end\n\n  def ints\n    split.map(&:to_i)\n  end\n\n  def split\n    @input.gets.chomp.split(' ')\n  end\n  alias_method :strings, :split\n\n  def gets\n    @input.gets.chomp\n  end\n\n  def puts(*args)\n    @output.puts(*args)\n  end\nend\n\nio = MyIO.new\n# }}}\n\n# Algorithms {{{\n\ndef lower_bound(arr, val)\n  assert(arr.is_a?(Array))\n  low, high = 0, arr.size\n  while high - low > 1\n    mid = (low + high) / 2\n    if arr[mid] < val\n      low = mid\n    else\n      high = mid\n    end\n  end\n  if arr[low] >= val\n    low\n  else\n    high\n  end\nend\n\ndef upper_bound(arr, val)\n  assert(arr.is_a?(Array))\n  low, high = 0, arr.size\n  while high - low > 1\n    mid = (low + high) / 2\n    if arr[mid] <= val\n      low = mid\n    else\n      high = mid\n    end\n  end\n  if arr[low] > val\n    low\n  else\n    high\n  end\nend\n\n# }}}\n\n# }}}\n\nio.set_input('inputs/0.txt')\n\nMOD = 1_000_000_007\n\nwhile true\n  a = io.gets\n  break if a == '0'\n  b, c = io.gets, io.gets\n\n  # dp[pos][carried][carry] = combinations % MOD\n  dp = Array.new(a.length) { Array.new(2) { Array.new(2, 0) } }\n  a.reverse!\n  b.reverse!\n  c.reverse!\n  a.length.times do |i|\n    (0..9).each do |ad|\n      next if (a[i] != '?' && a[i].to_i != ad) || (i == a.length - 1 && ad == 0)\n      (0..9).each do |bd|\n        next if (b[i] != '?' && b[i].to_i != bd) || (i == a.length - 1 && bd == 0)\n        (0..9).each do |cd|\n          next if (c[i] != '?' && c[i].to_i != cd) || (i == a.length - 1 && cd == 0)\n          carried = nil\n          if (ad + bd + 1) % 10 == cd\n            carried = 1\n          elsif (ad + bd) % 10 == cd\n            carried = 0\n          else\n            next\n          end\n          next if i == 0 && carried == 1\n\n          carry = ad + bd + carried >= 10 ? 1 : 0\n          if i == 0\n            dp[i][carried][carry] += 1\n          else\n            dp[i][carried][carry] = (dp[i][carried][carry] + dp[i-1][0][carried] + dp[i-1][1][carried]) % MOD\n          end\n        end\n      end\n    end\n  end\n\n  io.puts (dp[a.length - 1][0][0] + dp[a.length - 1][1][0]) % MOD\nend\n\n# vim: foldmethod=marker"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/env python\n\nfrom collections import deque\nimport itertools as it\nimport sys\n\nsys.setrecursionlimit(1000000)\n\nINF = 1000000007\n\nwhile True:\n    A = raw_input()\n    if A == '0':\n        break\n    B = raw_input()\n    C = raw_input()\n    A = A[::-1]\n    B = B[::-1]\n    C = C[::-1]\n\n    if not max(len(A), len(B)) in [len(C), len(C) + 1]:\n        print 0\n        continue\n    \n    while len(A) < len(C):\n        A += '0'\n    \n    while len(B) < len(C):\n        B += '0'\n    \n    print A, B, C\n\n    rem0 = 1\n    rem1 = 0\n    for index in range(len(C)):\n        nex0 = 0\n        nex1 = 0\n\n        if A[index] == '?':\n            la = range(max(0, index - len(C) + 2), 10)\n        else:\n            la = [int(A[index])]\n        \n        if B[index] == '?':\n            lb = range(max(0, index - len(C) + 2), 10)\n        else:\n            lb = [int(B[index])]\n        \n        if C[index] == '?':\n            lc = range(max(0, index - len(C) + 2), 10)\n        else:\n            lc = [int(C[index])]\n        \n        for a, b, c in it.product(la, lb, lc):\n            if a + b == c:\n                nex0 += rem0\n            if a + b == 10 + c:\n                nex1 += rem0\n            if a + b == c - 1:\n                nex0 += rem1\n            if a + b == 10 + c - 1:\n                nex1 += rem1\n        rem0 = nex0 % INF\n        rem1 = nex1 % INF\n    print rem0\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/env python\n\nfrom collections import deque\nimport itertools as it\nimport sys\n\nsys.setrecursionlimit(1000000)\n\nINF = 1000000007\n\nwhile True:\n    A = raw_input()\n    if A == '0':\n        break\n    B = raw_input()\n    C = raw_input()\n    A = A[::-1]\n    B = B[::-1]\n    C = C[::-1]\n\n    if not max(len(A), len(B)) in [len(C), len(C) + 1]:\n        print 0\n        continue\n    \n    while len(A) < len(C):\n        A += '0'\n    \n    while len(B) < len(C):\n        B += '0'\n    \n    rem0 = 1\n    rem1 = 0\n    for index in range(len(C)):\n        nex0 = 0\n        nex1 = 0\n\n        if A[index] == '?':\n            la = range(max(0, index - len(C) + 2), 10)\n        else:\n            la = [int(A[index])]\n        \n        if B[index] == '?':\n            lb = range(max(0, index - len(C) + 2), 10)\n        else:\n            lb = [int(B[index])]\n        \n        if C[index] == '?':\n            lc = range(max(0, index - len(C) + 2), 10)\n        else:\n            lc = [int(C[index])]\n        \n        for a, b, c in it.product(la, lb, lc):\n            if a + b == c:\n                nex0 += rem0\n            if a + b == 10 + c:\n                nex1 += rem0\n            if a + b == c - 1:\n                nex0 += rem1\n            if a + b == 10 + c - 1:\n                nex1 += rem1\n        rem0 = nex0 % INF\n        rem1 = nex1 % INF\n    print rem0\n"
  },
  {
    "language": "Python",
    "code": "INF = 10 ** 10\nMOD = 10 ** 9 + 7\n\ndef solve(A,B,C):\n    A = A[::-1]\n    B = B[::-1]\n    C = C[::-1]\n    before =[1,0,0]\n    N = len(A)\n    for i in range(N):\n        dp = [0]*3\n        s = 0\n        if i == N - 1:\n            s += 1\n        for j in range(3):\n            for a in range(s,10):\n                if A[i] != '?' and int(A[i]) != a:\n                    continue\n                for b in range(s,10):\n                    if B[i] != '?' and int(B[i]) != b:\n                        continue\n                    for c in range(s,10):\n                        if C[i] != '?' and int(C[i]) != c:\n                            continue\n                        if (j + a + b)%10 != c:\n                            continue\n                        dp[(j + a + b)//10] += before[j]\n                        dp[(j + a + b)//10] %= MOD\n        before = dp\n    ans = before[0]\n    print(ans)\n\ndef main():\n    while True:\n        A = input()\n        if A == '0':\n            return\n        B = input()\n        C = input()\n        solve(A,B,C)\nif __name__ == '__main__':\n    main()\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        a = S()\n        if a == '0':\n            break\n        b = S()\n        c = S()\n        ml = max([len(a),len(b),len(c)])\n        if len(a) < ml:\n            a = '0' * (ml-len(a)) + a\n        if len(b) < ml:\n            b = '0' * (ml-len(b)) + b\n        if len(c) < ml:\n            c = '0' * (ml-len(c)) + c\n\n        r = [[0,0] for _ in range(ml+1)]\n        r[0][0] = 1\n        for i in range(ml):\n            ai = a[ml-i-1]\n            bi = b[ml-i-1]\n            ci = c[ml-i-1]\n            r0 = [0,0]\n            r1 = [0,0]\n            si = 0\n            if i == ml - 1:\n                si = 1\n            al = range(si,10)\n            if ai != '?':\n                al = [int(ai)]\n            bl = range(si,10)\n            if bi != '?':\n                bl = [int(bi)]\n            cl = range(si,10)\n            if ci != '?':\n                cl = [int(ci)]\n\n            for ac,bc,cc in itertools.product(al,bl,cl):\n                abc = ac+bc\n                if abc % 10 == cc:\n                    if abc > 9:\n                        r0[1] += 1\n                    else:\n                        r0[0] += 1\n                elif (abc+1) % 10 == cc:\n                    if abc > 8:\n                        r1[1] += 1\n                    else:\n                        r1[0] += 1\n            r[i+1][0] += r0[0] * r[i][0]\n            r[i+1][0] += r1[0] * r[i][1]\n            r[i+1][1] += r0[1] * r[i][0]\n            r[i+1][1] += r1[1] * r[i][1]\n\n        rr.append(r[ml][0] % mod)\n\n\n    return '\\n'.join(map(str,rr))\n\n\n\nprint(main())\n\n"
  }
]