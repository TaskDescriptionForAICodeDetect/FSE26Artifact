[
  {
    "language": "Scala",
    "code": "object Main extends App {\n\n  import scala.io.StdIn._\n\n  solve\n  def solve: Unit = {\n    val Array(n, m) = readLine.trim.split(' ')\n    if (n == \"0\") return\n    val value = m.toBasedInt(n.toInt)\n    println(List(31, 29, 23, 19, 17, 13, 11, 7, 5, 3, 2).filter(n.toInt % _ == 0).map{prime ⇒ countFactorInFactorial(value, prime) / countPrimeFactor(n.toInt, prime)}.min)\n    solve\n  }\n  implicit class ToBase(val str: String) extends AnyVal {\n    def toBasedInt(base: Int): Long = {\n      str.foldLeft(0L){\n          case (a, b) if b.isDigit ⇒ a * base + b.asDigit\n          case (a, b) ⇒ a * base + b - 'A' + 10\n        }\n      }\n  }\n  def countPrimeFactor(value: Int, prime: Int): Int = {\n    value % prime match {\n      case 0 ⇒ 1 + countPrimeFactor(value / prime, prime)\n      case _ ⇒ 0\n    }\n  }\n  def countFactorInFactorial(value: Long, prime: Long): Long = {\n    value match {\n      case 0 ⇒ 0\n      case _ ⇒ value / prime + countFactorInFactorial(value / prime, prime)\n    }\n  }\n  implicit class Extension[T](val value :T) extends AnyVal {\n    @inline\n    def let[A](@inline func: T ⇒ A): A = func(value)\n    @inline\n    def also(@inline func: T ⇒ Unit): T = {func(value); value}\n    @inline\n    def takeIf(@inline predicate: T ⇒ Boolean): Option[T] = Some(value).filter(predicate)\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint N, M;\n\nint count(int n) {\n    int total = 0;\n    while (M >= n) {\n        total += (M / n);\n        M /= n;\n    }\n    return total;\n}\n\nlong long to_l(string s) {\n    long long n = 0;\n    for (int i = 0; i < s.size(); i++) {\n        if (isdigit(s[i])) {    \n            n = n * N + (s[i] - '0');\n        } else {\n            n = n * N + (s[i] - 'A' + 10);\n        }\n    }\n    return n;\n}\n\nint main() {\n    string M_;\n    while (cin >> N >> M_) {\n        if (N == 0 && M_ == \"0\") break;\n        M = to_l(M_);\n        int ans = 0;\n        switch (N) {\n            case 8:\n                ans = count(2) / 3;\n                break;\n            case 9:\n                ans = count(3) / 2;\n                break;\n            case 10:\n                ans = count(5);\n                break;\n            case 11:\n                ans = count(11);\n                break;\n            case 12:\n                ans = count(2) / 2;\n                break;\n            case 13:\n                ans = count(13);\n                break;\n            case 14:\n                ans = count(7);\n                break;\n            case 15:\n                ans = count(5);\n                break;\n            case 16:\n                ans = count(2) / 4;\n                break;\n            case 17:\n                ans = count(17);\n                break;\n            case 18:\n                ans = count(3) / 2;\n                break;\n            case 19:\n                ans = count(19);\n                break;\n            case 20:\n                ans = count(5);\n                break;\n            case 21:\n                ans = count(7);\n                break;\n            case 22:\n                ans = count(11);\n                break;\n            case 23:\n                ans = count(23);\n                break;\n            case 24:\n                ans = count(2) / 3;\n                break;\n            case 25:\n                ans = count(5) / 2;\n                break;\n            case 26:\n                ans = count(13);\n                break;\n            case 27:\n                ans = count(3) / 3;\n                break;\n            case 28:\n                ans = count(7);\n                break;\n            case 29:\n                ans = count(29);\n                break;\n            case 30:\n                ans = count(5);\n                break;\n            case 31:\n                ans = count(31);\n                break;\n            case 32:\n                ans = count(2) / 5;\n                break;\n            case 33:\n                ans = count(11);\n                break;\n            case 34:\n                ans = count(17);\n                break;\n            case 35:\n                ans = count(7);\n                break;\n            case 36:\n                ans = count(3) / 2;\n                break;\n        }\n        cout << ans << endl;\n//        for (int i = 0; i < 36; i++) {\n//            cout << count(i) << ' ';\n//        }\n//        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstdlib>\n#include <climits>\n\nusing namespace std;\n\nvoid solve()\n{\n\tint N;\n\tstring M;\n\twhile(cin >> N >> M, N)\n\t{\n\t\tunsigned long long m = strtoll(&M[0],NULL,N);\n\t\tvector<int> v,s;\n\t\tfor(int i = 2; i <= N; ++i)\n\t\t{\n\t\t\tif(N % i != 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tv.push_back(i);\n\t\t\ts.push_back(0);\n\n\t\t\twhile(N % i == 0)\n\t\t\t{\n\t\t\t\t++s[v.size() - 1];\n\t\t\t\tN /= i;\n\t\t\t}\n\t\t}\n\n\t\tunsigned long long ans = 999999999999ULL;\n\t\tfor(int i = 0; i < v.size(); ++i)\n\t\t{\n\t\t\tunsigned long long tmp = m;\n\t\t\tunsigned long long zero = 0;\n\t\t\twhile(tmp /= v[i])\n\t\t\t{\n\t\t\t\tzero += tmp;\n\t\t\t}\n\t\t\tans = min(ans, zero / s[i]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main(void)\n{\n  solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n#include <string.h>\n\nusing namespace std;\nvector<int> prime;\nbool isPrime[100001];\n\nvoid PrimeCalc()\n{\n\tmemset(isPrime, 1, sizeof(isPrime));\n\tisPrime[0] = isPrime[1] = false;\n\tfor(int i = 2; i <= 100000; ++i)\n\t{\n\t\tif(isPrime[i])\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\tfor(int j = 2 * i; j <= 100000; j += i)\n\t\t\t{\n\t\t\t\tisPrime[j] = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid solve()\n{\n\tPrimeCalc();\n\tint N;\n\twhile(cin >> N, N)\n\t{\n\t\tstring M;\n\t\tcin >> M;\n\t\tmap<int, int> decimal_factor;\n\t\tint t = N;\n\t\tfor(int i = 0; i < prime.size() && prime[i] <= 36; ++i)\n\t\t{\n\t\t\twhile(t % prime[i] == 0)\n\t\t\t{\n\t\t\t\t++decimal_factor[prime[i]];\n\t\t\t\tt /= prime[i];\n\t\t\t}\n\t\t}\n\t\tint to = 1;\n\t\tint k = 1;\n\t\tfor(int i = M.size() - 1; i >= 0; --i)\n\t\t{\n\t\t\tif('A' <= M[i] && M[i] <= 'Z')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - 'A' + 10);\n\t\t\t}\n\t\t\telse if('1' <= M[i] && M[i] <= '9')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - '0');\n\t\t\t}\n\t\t\tk *= N;\n\t\t}\n\t\tmap<int, int> factor;\n\t\tfor(int i = 2; i <= to; ++i)\n\t\t{\n\t\t\tt = i;\n\t\t\tfor(int j = 0; prime[j] * prime[j] <= to; ++j)\n\t\t\t{\n\t\t\t\tif(t == 1)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\twhile(t % prime[j] == 0)\n\t\t\t\t{\n\t\t\t\t\t++factor[prime[j]];\n\t\t\t\t\tt /= prime[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint min_exist = 999999999;\n\t\tmap<int, int>::iterator it = decimal_factor.begin();\n\t\tmap<int, int>::iterator it2 = factor.begin();\n\t\twhile(it != decimal_factor.end() && it2 != factor.end())\n\t\t{\n\t\t\tif(it2->first < it->first)\n\t\t\t{\n\t\t\t\twhile(it2->first < it->first && it2 != factor.end())\n\t\t\t\t{\n\t\t\t\t\t++it2;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile(it2->first > it->first && it != decimal_factor.end())\n\t\t\t\t{\n\t\t\t\t\t++it;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\tif(it2->first == it->first && it2->second / it->second < min_exist)\n\t\t\t{\n\t\t\t\tmin_exist = it2->second / it->second;\n\t\t\t}\n\t\t\t++it;\n\t\t\t++it2;\n\t\t}\n\t\tcout << min_exist << endl;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#define int long long\n#define INF 4e+18\nusing namespace std;\n\nsigned main(){\n\tint n,tmp = 0;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\ttmp = 0;\n\tfor(int i = 0;i < m.length();i++){\n\t\tif('0' <= m[i] && m[i] <= '9'){\n\t\t\ttmp = tmp * n + m[i] - '0';\n\t\t}else {\n\t\t\ttmp = tmp * n + 10 + m[i] - 'A';\n\t\t}\n\t}\n\tmap<int,int> insuu;\n\tfor(int i = 2;i * i <= n;i++){\n\t\twhile(n % i == 0) {\n\t\t\tinsuu[i]++;\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) insuu[n]++;\n\tint mi = INF;\n\tfor(auto it = insuu.begin();it != insuu.end();it++){\n\t\tint t = tmp,cnt = 0;\n\t\twhile(t){\n\t\t\tcnt += t / it->first;\n\t\t\tt /= it->first;\n\t\t}\n\t\tmi = min(mi,cnt / it->second);\n\t}\n\tcout << mi << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<iostream>\n\nusing namespace std;\n\ntypedef\tunsigned long long\tull;\n\nint main(){\n\tint f[128];\n\tfor(int i='0';i<='9';i++)\tf[i]=i-'0';\n\tfor(int i='A';i<='Z';i++)\tf[i]=i-'A'+10;\n\n\tint base;\n\tstring s;\n\tfor(;cin>>base>>s,base;){\n\t\tull num=0;\n\t\tfor(int i=0;i<s.length();i++)\tnum=num*base+f[s[i]];\n\n\t\tconst int p[]={31,29,23,19,17,13,11,7,5,3,2};\n\t\tint pcnt[11]={};\n\t\tfor(int b=base,i=0;b>1;){\n\t\t\tif(b%p[i]==0)\tb/=p[i],pcnt[i]++;\n\t\t\telse\ti++;\n\t\t}\n\n\t\tull zcnt=1ULL<<63;\n\t\tfor(int i=0;i<11;i++){\n\t\t\tif(pcnt[i]>0){\n\t\t\t\tull num2=num,zcnt2=0;\n\t\t\t\twhile(num2)\tzcnt2+=num2/p[i],num2/=p[i];\n\t\t\t\tzcnt=min(zcnt,zcnt2/pcnt[i]);\n\t\t\t}\n\t\t}\n\t\tcout<<zcnt<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint d; string s;\nint p[11] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\nint main() {\n\twhile (cin >> d >> s, d) {\n\t\tlong long v = 0;\n\t\tfor (int i = 0; i < s.size(); i++) v = v * d + (s[i] <= '9' ? s[i] - 48 : s[i] - 55);\n\t\tlong long ret = 9191919191919191919;\n\t\tfor (int i = 0; i < 11 && p[i] <= d; i++) {\n\t\t\tint e = 0, f = d;\n\t\t\twhile (f % p[i] == 0) f /= p[i], e++;\n\t\t\tif (e) {\n\t\t\t\tlong long w = v, x = 0;\n\t\t\t\twhile (w) w /= p[i], x += w;\n\t\t\t\tret = min(ret, x / e);\n\t\t\t}\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid factorize(vector<ll> &p,vector<ll> &cnt,ll x) {\n    p.clear(); cnt.clear();\n    if(x == 1 || x == 0) {\n        p.push_back(1);\n        cnt.push_back(1);\n        return;\n    }\n\n    int pp = 2;\n    while(true) {\n        if(x <= 1) break;\n        if(x % pp == 0) {\n            p.push_back(pp);\n            cnt.push_back(0);\n            while(x%pp == 0) {\n                cnt[cnt.size()-1]++;\n                x /= pp;\n            }\n        }\n        pp++;\n    }\n    return;\n}\n\nint main() {\n    int base;\n    string a;\n    while(cin>>base>>a) {\n        if(base == 0 && a == \"0\") break;\n        unsigned long long m = 0;\n        for(int i=0; i<a.length(); ++i) {\n            m *= base;\n            if(a[i] <= '9') m += a[i] - '0';\n            else m += a[i] - 'A' + 10;\n        }\n\n        // cout<<base<<\" \"<<m<<endl;\n        vector<ll> p,cnt;\n        factorize(p,cnt,base);\n        // for(int i=0; i<p.size(); ++i) cout<<p[i]<<\" : \"<<cnt[i]<<endl;\n\n        vector<ll> pp(p.size(), 0);\n        for(int i=0; i<p.size(); ++i) {\n            ll n = p[i];\n            while(n <= m) {\n                pp[i] += m/n;\n                n *= p[i];\n            }\n        }\n\n        ll ans = 1ll<<62;\n        for(int i=0; i<p.size(); ++i) {\n            // cout<<p[i]<<\" \"<<pp[i]/cnt[i]<<endl;\n            ans = min(ans, pp[i]/cnt[i]);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-2;\nconst int inf=1e17;\nint main(){\n\tll n;\n\tstring s;\n\twhile(cin>>n>>s,n){\n\t\tll m=strtoll(&s[0],NULL,n);\n\t\tvi a,b;\n\t\tloop(i,2,n+1){\n\t\t\tif(n%i)continue;\n\t\t\ta.pb(i);\n\t\t\tb.pb(0);\n\t\t\twhile(n%i==0)b[b.size()-1]++,n/=i;\n\t\t}\n\t\tll out=inf;\n\t\trep(i,a.size()){\n\t\t\tll tmp=m;\n\t\t\tll t=0;\n\t\t\twhile(tmp){\n\t\t\t\ttmp/=a[i];\n\t\t\t\tt+=tmp;\n\t\t\t}\n\t\t\tout=min(out,t/b[i]);\n\t\t}\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\ntypedef long long ll;\n\nll mypow(ll n,ll a){\n  if (n == 0)return 1;\n  ll ret = mypow(n/2,a);\n  ret=ret*ret;\n  if (n%2 == 1)ret*=a;\n  return ret;\n}\n\nll val[255];\n//div=27 46 -> 27 47\nll compute(string &a,ll div,int base){\n  /*\n  ll nowbase=1;\n  ll ret=0;\n  for(int i=a.size()-1;i>=0;i--){\n    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(val[a[i]]*nowbase)/div;\n    nowbase*=base;\n  }\n  */\n  \n  ll nowbase=mypow((int)a.size()-1,base);\n  ll ret=0;\n  ll rem=0;\n  //  for(int i=a.size()-1;i>=0;i--){\n  for(int i=0;i<a.size();i++){\n    //    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n    //      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(rem+val[a[i]]*nowbase)/div;\n    rem=(val[a[i]]*nowbase)%div;\n    nowbase/=base;\n  }\n  //cout << ret <<\" \" << div << endl;\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  //  check();\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n  int in;\n  string inp;\n  while(cin>>in>>inp && in){\n    int p=0;\n    fact(in,base,basenum,p);\n\n    rep(i,p){\n      ll now=base[i];\n      cnt[i]=0;\n      while(true){\n\tll tmp = compute(inp,now,in);\n\tif (tmp == 0)break;\n\tcnt[i]+=tmp;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <climits>\nusing namespace std;\n\nunsigned long long to(string w , int base){\n\tunsigned long long ans = 0;\n\tfor(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n\treturn ans;\n}\n\nmap<int,int> factor(int n){\n\tmap<int,int> w;\n\tfor(int i = 2 ; i*i<=n ; i++)\n\t\twhile(n%i==0) w[i]++ , n /= i;\n\tif(n!=1) w[n]++;\n\treturn w;\n}\nint main(){\n\tint n;\n\tstring m;\n\twhile(cin >> n >> m && (n||m!=\"0\") ){\n\t\tunsigned long long v = to(m,n) , ans = ULLONG_MAX;\n\t\tmap<int,int> r = factor(n);\n\t\tfor( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n\t\t\tint a = it->first;\n\t\t\tint d = it->second;\n\t\t\tunsigned long long t = v;\n\t\t\tunsigned long long ok = 0;\n\t\t\twhile(t){ ok += (t / a) ; t /= a;}\n\t\t\tans = min(ok / d , ans);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n      if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n    }    \n\n    ll ans=0;\n\n    for(long double i=5;i<=s-0.1;i*=5){\n      ans+=s/(ll)i;\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<cassert>\n#include<climits>\n\n#define IINF (INT_MAX)\n#define ULLINF (ULLONG_MAX)\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef pair<ull,ull> ull2;\n\null N;\nstring M;\n\nmap<ull,int> prime_factor(ull n){\n  map<ull,int> res;\n  for(int i=2;i*i<=n;i++){\n    while(n % i == 0){\n      ++res[i];\n      n /= i;\n    }\n  }\n  if(n != 1ULL)res[n] = 1ULL;\n  return res;\n}\n\null StoULL(){\n  ull ret = 0;\n  for(int i=0;i<M.size();i++){\n    ret *= N;\n    ull tmp = (('0'<=M[i]&&M[i]<='9')?(M[i]-'0'):(M[i]-'A')+10ULL);\n    ret += tmp;\n  }\n  return ret;\n}\n\null calc(ull value,ull2 tmp){\n  ull ret = 0;\n  ull pf = tmp.first;\n  ull denom = tmp.second;\n  while(value){\n    ret += value / pf;\n    value /= pf;\n  }\n  return ret/denom;\n}\n\nvoid compute(){\n  map<ull,int> ppf = prime_factor(N);\n  vector<ull2> pf;\n\n  for(map<ull,int>::iterator it = ppf.begin() ; it != ppf.end() ; it++ ){\n    pf.push_back(ull2((it->first),(it->second)));\n  }\n\n  ull value = StoULL();\n  //cout << \"value = \" << value << endl;\n  ull ans = ULLINF;\n\n  for(int i=0;i<pf.size();i++){\n    ans = min(ans,calc(value,pf[i]));\n  }\n\n  cout << ans << endl;\n\n}\n\nint main(){\n  cout << ULLINF << endl;\n  while(cin >> N >> M,(N!=0 || M!=\"0\")){\n\n    compute();\n\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, int> prime_factor(ll n){\n\tmap<ll, int> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tmap<ll, int> factor = prime_factor(N);\n\t\tmap<ll, int> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tint ans = INF;\n\t\tfor(map<ll,int>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst ll INF = 1000000000000000000LL;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, ll> prime_factor(ll n){\n\tmap<ll, ll> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tif(N == 0 && M == \"0\")break;\n\t\tif(M == \"0\"){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<ll, ll> factor = prime_factor(N);\n\t\tmap<ll, ll> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tif(M != \"0\" && L == 0) while(true);\n\t\tll ans = INF;\n\t\tfor(map<ll,ll>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number){\n\t\tif(base == 0 && number == \"0\") break;\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\t//baseÉ½ÂÌföª é©¨è\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k] != 0){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k] != 0){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min >= fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t\t//cout << min << \" new_min \" << endl;\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//±Ìû@¾ÆI[o[t[\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\t/*if(min == num){\n\t\t\tmin = 0;\n\t\t}*/\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nlong long toInt(string s, int n)\n{\n    long long ret = 0;\n    for(unsigned i=0; i<s.size(); ++i){\n        ret *= n;\n        if(isdigit(s[i]))\n            ret += s[i] - '0';\n        else\n            ret += s[i] - 'A' + 10;\n    }\n    return ret;\n}\n\nint main()\n{\n    for(;;){\n        int n;\n        string s;\n        cin >> n >> s;\n        if(n == 0)\n            return 0;\n\n        long long m = toInt(s, n);\n        long long ret = 0;\n        for(long long i=5; i<=m; i*=5)\n            ret += m / i;\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstdlib>\n#include <climits>\n\nusing namespace std;\n\nvoid solve()\n{\n\tint N;\n\tstring M;\n\twhile(cin >> N >> M, N)\n\t{\n\t\tunsigned long long m = strtoll(&M[0],NULL,N);\n\t\tvector<int> v,s;\n\t\tint t = N;\n\t\tfor(int i = 2; i <= N; ++i)\n\t\t{\n\t\t\tif(t % i != 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tv.push_back(i);\n\t\t\ts.push_back(0);\n\n\t\t\twhile(t % i == 0)\n\t\t\t{\n\t\t\t\t++s[v.size() - 1];\n\t\t\t\tt /= i;\n\t\t\t}\n\t\t}\n\n\t\tunsigned long long ans = 999999999999ULL;\n\t\tfor(int i = 0; i < v.size(); ++i)\n\t\t{\n\t\t\tunsigned long long tmp = m;\n\t\t\tunsigned long long zero = 0;\n\t\t\twhile(tmp /= v[i])\n\t\t\t{\n\t\t\t\tzero += tmp;\n\t\t\t}\n\t\t\tans = min(ans, zero / s[i]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main(void)\n{\n  solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <bitset>\n#include <numeric>\n#include <utility>\n#include <iomanip>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vint;\ntypedef vector<long long> vll;\ntypedef pair<int,int> pint;\ntypedef pair<long long, long long> pll;\n\n#define MP make_pair\n#define PB push_back\n#define ALL(s) (s).begin(),(s).end()\n#define EACH(i, s) for (__typeof__((s).begin()) i = (s).begin(); i != (s).end(); ++i)\n#define COUT(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << endl\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, pair<T1,T2> P) \n{ return s << '<' << P.first << \", \" << P.second << '>'; }\ntemplate<class T> ostream& operator << (ostream &s, vector<T> P) \n{ for (int i = 0; i < P.size(); ++i) { if (i > 0) { s << \" \"; } s << P[i]; } return s << endl; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, map<T1,T2> P) \n{ EACH(it, P) { s << \"<\" << it->first << \"->\" << it->second << \"> \"; } return s << endl; }\n\n\nlong long N;\nstring M;\n\nmap<long long, long long> prime_factor(long long n) {\n    map<long long, long long> res;\n    for (long long i = 2; i*i <= n; ++i) {\n        while (n%i == 0) {\n            ++res[i];\n            n /= i;\n        }\n    }\n    if (n != 1) res[n] = 1;\n    return res;\n}\n\nint main() {\n    while (cin >> N >> M) {\n        if (N == 0) break;\n        \n        long long num = 0;\n        for (int i = 0; i < M.size(); ++i) {\n            num *= N;\n            if (M[i] <= '9') num += M[i] - '0';\n            else num += M[i] - 'A' + 10;\n        }\n        \n        //COUT(num);\n        \n        map<ll, ll> ma = prime_factor(N);\n        long long res = 1LL<<62;\n        \n        //COUT(res);\n        \n        EACH(it, ma) {\n            long long pr = it->first;\n            long long ex = it->second;\n            \n            long long tmp = 0;\n            long long tnum = num;\n            while (tnum) {\n                tmp += tnum / pr;\n                tnum /= pr;\n            }\n            \n            //cout << pr << \" : \" << tmp << endl;\n            \n            chmin(res, tmp/ex);\n        }\n        \n        cout << res << endl;\n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <memory.h>\n#include <queue>\n#include <cstdio>\n#include <cstdlib>\n#include <map>\n#include <cmath>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i< n; i++)\ntypedef unsigned long long ll;\ntypedef pair<int, int> P;\nconst ll LM = 1LL<<63;\n\nll tonum(string s, int N){\n  ll res = 0;\n  int n = s.size();\n  rep(i, n){\n    ll m = (isdigit(s[i])) ? s[i] - '0' : s[i] - 'A' + 10;\n    res = res * (ll)N + m;\n  }\n  return res;\n}\n\nll get_cnt(ll M, ll i, ll cnt){\n  ll res = 0;\n  ll num = 1;\n  while(num < LM / i){\n    num *= i;\n    res += M / num;\n  }\n  return res / cnt;\n}\n\nint main(){\n  ll N, M;\n  string s;\n  while(cin >> N >> s && (N || s != \"0\")){\n    M = tonum(s,N);\n    ll res = LM;\n    for(ll i = 2; i * i <= N; i++){\n      if(N%i == 0){\n\tll cnt = 0;\n\twhile(N % i == 0) {\n\t  cnt++;\n\t  N /= i;\n\t}\n\tres = min(res, get_cnt(M, i, cnt));\n      }\n    }\n    if(N > 1) res = min(res, get_cnt(M, N, 1));\n    cout << res << endl;\n  }\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef unsigned long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nmap<int, int> factorize(ll n) {  // O(ツ」n)\n  map<int, int> res;\n  for (int i=2; i*i<=n; ++i) {\n    int cnt = 0;\n    while (n%i==0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt) {\n      res[i] = cnt;\n    }\n  }\n  if (n!=1) res[n] = 1;\n  return res;\n}\n\nint main() {\n  int N; string M;\n  while(cin >> N >> M, N) {\n    ll num = strtoll(M.c_str(), NULL, N);\n    map<int, int> factor = factorize(N);\n    int ans = INF;\n    FOR(it, factor) {\n      ll now = it->first;\n      int cnt = 0;\n      while(1) {\n        cnt += num / now;\n        if (now>(double)num/it->first+EPS) break;\n        now *= it->first;\n      }\n      //cout << it->first << \" \" << it->second << \" \" << cnt << endl;\n       ans = min(ans, cnt/it->second);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n      if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n    }\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s*=n,s+=m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s*=n,s+=m[i]-'A'+10;\n    }\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\ntypedef long long ll;\n\nll mypow(ll n,ll a){\n  if (n == 0)return 1;\n  ll ret = mypow(n/2,a);\n  ret=ret*ret;\n  if (n%2 == 1)ret*=a;\n  return ret;\n}\n\nll val[255];\n//div=27 46 -> 27 47\nll compute(string &a,ll div,int base){\n  /*\n  ll nowbase=1;\n  ll ret=0;\n  for(int i=a.size()-1;i>=0;i--){\n    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(val[a[i]]*nowbase)/div;\n    nowbase*=base;\n  }\n  */\n  \n  ll nowbase=mypow((int)a.size()-1,base);\n  ll ret=0;\n  ll rem=0;\n  //  for(int i=a.size()-1;i>=0;i--){\n  for(int i=0;i<a.size();i++){\n    //    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n    //      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(rem+val[a[i]]*nowbase)/div;\n    rem=(val[a[i]]*nowbase)%div;\n    nowbase/=base;\n  }\n  //cout << ret <<\" \" << div << endl;\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  //  check();\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n  int in;\n  string inp;\n  while(cin>>in>>inp && in){\n    if (inp == \"0\"){\n      cout << 1 << endl;\n      continue;\n    }\n    int p=0;\n    fact(in,base,basenum,p);\n\n    rep(i,p){\n      ll now=base[i];\n      cnt[i]=0;\n      while(true){\n\tll tmp = compute(inp,now,in);\n\tif (tmp == 0)break;\n\tcnt[i]+=tmp;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n\n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=int(a)-1;i>=int(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n\n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n\ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n\nusing namespace std;\nusing ll=long long;\n\nll convert(char c){\n\tif(isdigit(c))\n\t\treturn c - '0';\n\telse\n\t\treturn c -'A'+10;\n}\n\nconst int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\nint main(void){\n\tll n;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\t\tll num[11]={0};\t\t\n\t\tll mten=0LL;\n\n\t\tfor(auto &d:m) mten=n*mten+convert(d);\n\t\trep(i,11){\n\t\t\tll cur=prime[i];\n\t\t\twhile(cur<mten) num[i]+=mten/cur,cur*=prime[i];\n\t\t}\n\t\tll ans=-1LL;\n\t\trep(i,11){\n\t\t\tll cur=n,coef=0LL;\n\t\t\twhile(cur%prime[i]==0) cur/=prime[i],coef++;  \n\t\t\tif(coef==0) continue;\n\t\t\tif(ans==-1)\n\t\t\t\tans=num[i]/coef;\n\t\t\telse\n\t\t\t\tchmin(ans,num[i]/coef);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    memset(prime_factor,0,sizeof(prime_factor));\n    for(int i = 2; i * i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        prime_factor[base / i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n\n    if(res == numeric_limits<unsigned long long>::max()) res = 0;    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int NUM_P = 11;\nconst int pnums[NUM_P] = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31};\n\nconst long long LINF = 1LL << 62;\n\n/* typedef */\n\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef vector<pii> vpii;\n\n/* global variables */\n\nint n;\nll m;\n\n/* subroutines */\n\ninline int ch2int(char ch) {\n  if (ch >= '0' && ch <= '9') return ch - '0';\n  return ch - 'A' + 10;\n}\n\nvoid prime_decomp(int k, vpii& pds) {\n  pds.clear();\n\n  for (int pi = 0; k > 1; pi++) {\n    int pn = pnums[pi];\n    if (k % pn == 0) {\n      int fi = 0;\n      while (k % pn == 0)\n\tk /= pn, fi++;\n      pds.push_back(pii(pn, fi));\n    }\n  }\n}\n\nvoid print_pds(vpii& pds) {\n  for (int i = 0; i < pds.size(); i++) {\n    if (i > 0) cout << '*';\n    cout << pds[i].first << '^' << pds[i].second;\n  }\n  cout << endl;\n}\n\n/* main */\n\nint main() {\n  for (;;) {\n    cin >> n;\n    if (n == 0) break;\n\n    string mstr;\n    cin >> mstr;\n\n    m = 0;\n    for (int i = 0; i < mstr.length(); i++)\n      m = m * n + ch2int(mstr[i]);\n    //cout << m << endl;\n\n    vpii pds;\n    prime_decomp(n, pds);\n    //print_pds(pds);\n\n    ll min_numz = LINF;\n    \n    for (int i = 0; i < pds.size(); i++) {\n      int pn = pds[i].first;\n      ll pns = 0;\n      for (ll pexp = pn; pexp <= m; pexp *= pn)\n\tpns += m / pexp;\n      //printf(\"%lld: %d = %lld\\n\", m, pn, pns);\n\n      ll numz = pns / pds[i].second;\n      if (min_numz > numz) min_numz = numz;\n    }\n\n    cout << min_numz << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\ntypedef long long ll;\n\nll mypow(ll n,ll a){\n  if (n == 0)return 1;\n  ll ret = mypow(n/2,a);\n  ret=ret*ret;\n  if (n%2 == 1)ret*=a;\n  return ret;\n}\n\nll val[255];\n//div=27 46 -> 27 47\nll compute(string &a,ll div,int base){\n  /*\n  ll nowbase=1;\n  ll ret=0;\n  for(int i=a.size()-1;i>=0;i--){\n    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(val[a[i]]*nowbase)/div;\n    nowbase*=base;\n  }\n  */\n  \n  ll nowbase=mypow((int)a.size()-1,base);\n  ll ret=0;\n  ll rem=0;\n  //  for(int i=a.size()-1;i>=0;i--){\n  for(int i=0;i<a.size();i++){\n    //    cout << i <<\" \" << a[i] <<\" \"<< val[a[i]]*nowbase <<\n    //      \" \" << div << \" \"<< (val[a[i]]+nowbase)/div <<endl;\n    ret+=(rem+val[a[i]]*nowbase)/div;\n    rem =(rem+val[a[i]]*nowbase)%div;\n    nowbase/=base;\n  }\n  //cout << ret <<\" \" << div << endl;\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  //  check();\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n  int in;\n  string inp;\n  while(cin>>in>>inp && in){\n    if (inp == \"0\"){\n      cout << 1 << endl;\n      continue;\n    }\n    int p=0;\n    fact(in,base,basenum,p);\n\n    rep(i,p){\n      ll now=base[i];\n      cnt[i]=0;\n      while(true){\n\tll tmp = compute(inp,now,in);\n\tif (tmp == 0)break;\n\tcnt[i]+=tmp;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\nint p[]={2,3,5,7,11,13,17,19,23,29,31};\nint main(){\n\tint n,nfac[11];\n\tll m,fac[11];\n\tstring b;\n\twhile(cin>>n>>b,n){\n\t\tm=0;\n\t\trep(i,11)nfac[i]=fac[i]=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tll ans=4611686018427387904LL;\n\t\trep(i,11){\n\t\t\twhile(n%p[i]==0)n/=p[i],nfac[i]++;\n\t\t\tif(nfac[i]){\n\t\t\t\tfor(ll j=p[i];j<=m;j*=p[i])fac[i]+=m/j;\n\t\t\t\tif(ans>fac[i]/nfac[i])ans=fac[i]/nfac[i];\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\ntypedef long long ll;\n\nll mypow(ll n,ll a){\n  if (n == 0)return 1;\n  ll ret = mypow(n/2,a);\n  ret=ret*ret;\n  if (n%2 == 1)ret*=a;\n  return ret;\n}\n\nll val[255];\n//div=27 46 -> 27 47\nll compute(string &a,ll div,int base){\n  ll nowbase=mypow((int)a.size()-1,base);\n  ll ret=0;\n  ll rem=0;\n  for(int i=0;i<a.size();i++){\n    ret+=(rem+val[a[i]]*nowbase)/div;\n    rem =(rem+val[a[i]]*nowbase)%div;\n    nowbase/=base;\n  }\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  //  check();\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n  int in;\n  string inp;\n  while(cin>>in>>inp && in){\n    int p=0;\n    fact(in,base,basenum,p);\n\n    rep(i,p){\n      ll now=base[i];\n      cnt[i]=0;\n      while(true){\n\tll tmp = compute(inp,now,in);\n\tif (tmp == 0)break;\n\tcnt[i]+=tmp;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\nusing namespace std;\n\nunsigned long long to(string w , int base){\n\tunsigned long long ans = 0;\n\tfor(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n\treturn ans;\n}\n\nmap<int,int> factor(int n){\n\tmap<int,int> w;\n\tfor(int i = 2 ; n != 1 ; i++)\n\t\twhile(n%i==0) w[i]++ , n /= i;\n\treturn w;\n}\nint main(){\n\tint n;\n\tstring m;\n\twhile(cin >> n >> m && (n||m!=\"0\") ){\n\t\tunsigned long long v = to(m,n) , ans = 1ll<<60;\n\t\tmap<int,int> r = factor(n);\n\t\tfor( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n\t\t\tint a = it->first;\n\t\t\tint d = it->second;\n\t\t\tunsigned long long t = v;\n\t\t\tunsigned long long ok = 0;\n\t\t\twhile(t){ ok += (t / a) ; t /= a;}\n\t\t\tans = min(ok / d , ans);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tint loop=(log((long double)m)/log((long double)a));\n\t\t\twhile(loop--){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n\n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=int(a)-1;i>=int(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n\n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n\ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n\nusing namespace std;\nusing ll=long long;\n\nll convert(char c){\n\tif(isdigit(c))\n\t\treturn c - '0';\n\telse\n\t\treturn c -'A'+10;\n}\n\nconst int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\nint main(void){\n\tll n;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\t\tll num[11]={0};\t\t\n\t\tll mten=0LL;\n\n\t\tfor(auto &d:m) mten=n*mten+convert(d);\n\t\trep(i,11){\n\t\t\tll cur=prime[i];\n\t\t\twhile(1){\n\t\t\t\tnum[i]+=mten/cur;\n\t\t\t\tif(cur>mten/prime[i]) break;\n\t\t\t\tcur*=prime[i];\n\t\t\t}\n\t\t}\n\t\tll ans=-1LL;\n\t\trep(i,11){\n\t\t\tll cur=n,coef=0LL;\n\t\t\twhile(cur%prime[i]==0) cur/=prime[i],coef++;  \n\t\t\tif(coef==0) continue;\n\t\t\tif(ans==-1)\n\t\t\t\tans=num[i]/coef;\n\t\t\telse\n\t\t\t\tchmin(ans,num[i]/coef);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main() {\n\tint N;\n\tstring M;\n\twhile (cin >> N >> M, N||M[0]!='0') {\n\t\tunsigned long long num = 0;\n\t\tfor (int i=0; i<M.size(); i++) {\n\t\t\tint t = M[i]-'0';\n\t\t\tif (t > 9) {\n\t\t\t\tt = 10 + (M[i]-'A');\n\t\t\t}\n\t\t\tnum *= N;\n\t\t\tnum += t;\n\t\t}\n\n\t\tlong long ans = 0;\n\t\tdo {\n\t\t\tnum /= 5;\n\t\t\tans += num;\n\t\t} while (num > 4);\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num,kaijyou;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number && (base != 0 || number != \"0\")){\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k]){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k]){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min > fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//ツつアツづ個陛サツ法ツつセツづオツーツバツーツフツδ債ー\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\tif(min == num){\n\t\t\tmin = 0;\n\t\t}\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, int> prime_factor(ll n){\n\tmap<ll, int> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M,N){\n\t\tmap<ll, int> factor = prime_factor(N);\n\t\tmap<ll, int> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tint ans = INF;\n\t\tfor(map<ll,int>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\n#define RANK       first\n#define NUM        second\n\ntypedef long long ll;\n\nll val[255];\n\nll convert(string &in,ll base){\n  ll now = 1;\n  ll ret=0;\n  for(int i=in.size()-1;i>=0;i--){\n    ret+=(val[in[i]])*now;\n    now*=base;\n  }\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n  ll in;string inp;\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n\n  while(cin>>in>>inp && in){\n    ll tmp = convert(inp,in);\n    ll ans = 0;\n    int p=0;\n    fact(in,base,basenum,p);\n    \n    rep(i,p){\n      cnt[i]=0;\n      ll now = base[i];\n      while(true){\n\tif (tmp/now == 0)break;\n\tcnt[i]+=tmp/now;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<cassert>\n#include<climits>\n\n#define IINF (INT_MAX)\n#define ULLINF (ULLONG_MAX)\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef pair<ull,ull> ull2;\n\null N;\nstring M;\n\nmap<ull,int> prime_factor(ull n){\n  map<ull,int> res;\n  for(int i=2;i*i<=n;i++){\n    while(n % i == 0){\n      ++res[i];\n      n /= i;\n    }\n  }\n  if(n != 1ULL)res[n] = 1ULL;\n  return res;\n}\n\null StoULL(){\n  ull ret = 0;\n  for(int i=0;i<M.size();i++){\n    ret *= N;\n    ull tmp = (('0'<=M[i]&&M[i]<='9')?(M[i]-'0'):(M[i]-'A')+10ULL);\n    ret += tmp;\n  }\n  return ret;\n}\n\null calc(ull value,ull2 tmp){\n  ull ret = 0;\n  ull pf = tmp.first;\n  ull denom = tmp.second;\n  while(value){\n    ret += value / pf;\n    value /= pf;\n  }\n  return ret/denom;\n}\n\nvoid compute(){\n  map<ull,int> ppf = prime_factor(N);\n  vector<ull2> pf;\n\n  for(map<ull,int>::iterator it = ppf.begin() ; it != ppf.end() ; it++ ){\n    pf.push_back(ull2((it->first),(it->second)));\n  }\n\n  ull value = StoULL();\n  //cout << \"value = \" << value << endl;\n  ull ans = ULLINF;\n\n  for(int i=0;i<pf.size();i++){\n    ans = min(ans,calc(value,pf[i]));\n  }\n\n  cout << ans << endl;\n\n}\n\nint main(){\n  //cout << ULLINF << endl;\n  while(cin >> N >> M,(N!=0 || M!=\"0\")){\n\n    compute();\n\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nunsigned long long ctoll(char);\nunsigned long long rj(unsigned long long,unsigned long long,unsigned long long) ;\n\nint main(){\n  while(1){\n    unsigned long long n;\n    string m;\n    cin >> n >> m;\n    if(n==0&&m==\"0\")break;\n    unsigned long long a=0;\n    unsigned long long c=0;\n    for(unsigned long long i=m.size()-1,j=0;;i--,j++){\n      a+=rj(ctoll(m[i]),n,j);\n      if(i==0)break;\n    }\n    //cout << a << endl;\n    for(unsigned long long i=5;;i*=5){\n      c+=a/i;\n      if(a/5<i)break;\n    }\n    cout << c << endl;\n  }\n  return 0;\n}\nunsigned long long ctoll(char ch){\n  if(ch>='0'&&ch<='9')return ch-'0';\n  return ch-'A'+10;\n}\n\nunsigned long long rj(unsigned long long x,unsigned long long a,unsigned long long b){\n  unsigned long long y=1;\n  for(unsigned long long i=0;i<b;i++){\n    y*=a;\n  }\n  return y*x;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s*=n,s+=m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s*=n,s+=m[i]-'A'+10;\n    }\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\n\nusing namespace std;\n\nint main(){\n\n\tlong long int number,ans,table[37],work,tmp;\n\tint base;\n\tchar exp[13];\n\n\twhile(true){\n\t\tscanf(\"%d %s\",&base,exp);\n\t\tif(base == 0 && exp[0] == '0')break;\n\n\t\tfor(int i = 0; i <= base; i++)table[i] = 0;\n\n\t\twork = base;\n\t\tfor(int i = 2; i <= base; i++){\n\t\t\twhile(work%i == 0){\n\t\t\t\ttable[i]++;\n\t\t\t\twork /= i;\n\t\t\t}\n\t\t}\n\n\t\tnumber = 0;\n\n\t\tfor(int i = 0; exp[i] != '\\0'; i++){\n\t\t\tif(exp[i] >= '0' && exp[i] <= '9'){\n\t\t\t\tnumber = base*number + (exp[i] - '0');\n\t\t\t}else{\n\t\t\t\tnumber = base*number + (10+(exp[i] - 'A'));\n\t\t\t}\n\t\t}\n\n\t\tans = 9223372036854775807;\n\t\tfor(int i = 2; i <= base; i++){\n\t\t\tif(table[i] > 0){\n\t\t\t\twork = 0;\n\t\t\t\ttmp = number;\n\t\t\t\twhile(tmp > 0){\n\t\t\t\t\twork += tmp/i;\n\t\t\t\t\ttmp /= i;\n\t\t\t\t}\n\t\t\t\twork /= table[i];\n\t\t\t\tans = min(ans,work);\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid factorize(vector<ll> &p,vector<ll> &cnt,ll x) {\n    p.clear(); cnt.clear();\n    if(x == 1) {\n        p.push_back(1);\n        cnt.push_back(1);\n        return;\n    }\n\n    int pp = 2;\n    while(true) {\n        if(x <= 1) break;\n        if(x % pp == 0) {\n            p.push_back(pp);\n            cnt.push_back(0);\n            while(x%pp == 0) {\n                cnt[cnt.size()-1]++;\n                x /= pp;\n            }\n        }\n        pp++;\n    }\n    return;\n}\n\nint main() {\n    int base;\n    string a;\n    while(cin>>base>>a) {\n        if(base == 0 && a == \"0\") break;\n        ll m = 0;\n        for(int i=0; i<a.length(); ++i) {\n            m *= base;\n            if(a[i] <= '9') m += a[i] - '0';\n            else m += a[i] - 'A' + 10;\n        }\n\n        // cout<<base<<\" \"<<m<<endl;\n        vector<ll> p,cnt;\n        factorize(p,cnt,base);\n        // for(int i=0; i<p.size(); ++i) cout<<p[i]<<\" : \"<<cnt[i]<<endl;\n\n        vector<ll> pp(p.size(), 0);\n        for(int i=0; i<p.size(); ++i) {\n            ll n = p[i];\n            while(n < m) {\n                pp[i] += m/n;\n                n *= p[i];\n            }\n        }\n\n        ll ans = 1ll<<62;\n        for(int i=0; i<p.size(); ++i) {\n            // cout<<p[i]<<\" \"<<pp[i]/cnt[i]<<endl;\n            ans = min(ans, pp[i]/cnt[i]);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid factorize(vector<ll> &p,vector<ll> &cnt,ll x) {\n    p.clear(); cnt.clear();\n    if(x == 1 || x == 0) {\n        p.push_back(1);\n        cnt.push_back(1);\n        return;\n    }\n\n    int pp = 2;\n    while(true) {\n        if(x <= 1) break;\n        if(x % pp == 0) {\n            p.push_back(pp);\n            cnt.push_back(0);\n            while(x%pp == 0) {\n                cnt[cnt.size()-1]++;\n                x /= pp;\n            }\n        }\n        pp++;\n    }\n    return;\n}\n\nint main() {\n    int base;\n    string a;\n    while(cin>>base>>a) {\n        if(base == 0 && a == \"0\") break;\n        unsigned long long m = 0;\n        for(int i=0; i<a.length(); ++i) {\n            m *= base;\n            if(a[i] <= '9') m += a[i] - '0';\n            else m += a[i] - 'A' + 10;\n        }\n\n        // cout<<base<<\" \"<<m<<endl;\n        vector<ll> p,cnt;\n        factorize(p,cnt,base);\n        // for(int i=0; i<p.size(); ++i) cout<<p[i]<<\" : \"<<cnt[i]<<endl;\n\n        vector<ll> pp(p.size(), 0);\n        for(int i=0; i<p.size(); ++i) {\n            ll n = p[i];\n            while(n < m) {\n                pp[i] += m/n;\n                n *= p[i];\n            }\n        }\n\n        ll ans = 1ll<<62;\n        for(int i=0; i<p.size(); ++i) {\n            // cout<<p[i]<<\" \"<<pp[i]/cnt[i]<<endl;\n            ans = min(ans, pp[i]/cnt[i]);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<cassert>\n#include<climits>\n\n#define IINF (INT_MAX)\n#define ULLINF (ULLONG_MAX)\n\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef pair<ull,ull> ull2;\n\null N;\nstring M;\n\nmap<ull,int> prime_factor(ull n){\n  map<ull,int> res;\n  for(int i=2;i*i<=n;i++){\n    while(n % i == 0){\n      ++res[i];\n      n /= i;\n    }\n  }\n  if(n != 1ULL)res[n] = 1ULL;\n  return res;\n}\n\null StoULL(){\n  ull ret = 0;\n  for(int i=0;i<M.size();i++){\n    ret *= N;\n    ull tmp = (('0'<=M[i]&&M[i]<='9')?(M[i]-'0'):(M[i]-'A')+10ULL);\n    ret += tmp;\n  }\n  return ret;\n}\n\null calc(ull value,ull2 tmp){\n  ull ret = 0;\n  ull pf = tmp.first;\n  ull denom = tmp.second;\n  while(value){\n    ret += value / pf;\n    value /= pf;\n  }\n  return ret/denom;\n}\n\nvoid compute(){\n  map<ull,int> ppf = prime_factor(N);\n  vector<ull2> pf;\n\n  for(map<ull,int>::iterator it = ppf.begin() ; it != ppf.end() ; it++ ){\n    pf.push_back(ull2((it->first),(it->second)));\n  }\n\n  ull value = StoULL();\n  //cout << \"value = \" << value << endl;\n  ull ans = ULLINF;\n\n  for(int i=0;i<pf.size();i++){\n    ans = min(ans,calc(value,pf[i]));\n  }\n\n  cout << ans << endl;\n\n}\n\nint main(){\n  //cout << ULLINF << endl;\n  while(cin >> N >> M,(N!=0 || M!=\"0\")){\n\n    compute();\n\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nunsigned long long ctoll(char);\nunsigned long long rj(unsigned long long,unsigned long long,unsigned long long) ;\n\nint main(){\n  while(1){\n    unsigned long long n;\n    string m;\n    cin >> n >> m;\n    if(n==0&&m==\"0\")break;\n    unsigned long long a=0;\n    unsigned long long c=0;\n    for(unsigned long long i=m.size()-1,j=0;;i--,j++){\n      a+=rj(ctoll(m[i]),n,j);\n      if(i==0)break;\n    }\n    //cout << a << endl;\n    unsigned long long b=a/5;\n    c+=b;\n    while(1){\n      b/=5;\n      if(b==0)break;\n      c+=b;\n    }\n    cout << c << endl;\n  }\n  return 0;\n}\nunsigned long long ctoll(char ch){\n  if(ch>='0'&&ch<='9')return ch-'0';\n  return ch-'A'+10;\n}\n\nunsigned long long rj(unsigned long long x,unsigned long long a,unsigned long long b){\n  unsigned long long y=1;\n  for(unsigned long long i=0;i<b;i++){\n    y*=a;\n  }\n  return y*x;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint d; char s[13];\nint p[11] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\nint main() {\n\twhile (scanf(\"%d%s\", &d, s), d) {\n\t\tlong long v = 0;\n\t\tfor (int i = 0; i < strlen(s); i++) v = v * d + (s[i] <= '9' ? s[i] - 48 : s[i] - 55);\n\t\tlong long ret = 9191919191919191919;\n\t\tfor (int i = 0; i < 11 && p[i] <= d; i++) {\n\t\t\tint e = 0, f = d;\n\t\t\twhile (f % p[i] == 0) f /= p[i], e++;\n\t\t\tif (e) {\n\t\t\t\tlong long w = v, x = 0;\n\t\t\t\twhile (w) w /= p[i], x += w;\n\t\t\t\tret = min(ret, x / e);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define F first\n#define S second\ntypedef unsigned long long ll;\ntypedef pair<ll,ll> P;\n\nvector<P> D(ll n) {\n  vector<P> v;\n  for(ll i=2; i*i<=n; i++) {\n    P p=P(0,i);\n    while(n%i==0) {\n      n/=i;\n      p.F++;\n    }\n    if(p.F) v.push_back(p);\n  }\n  if(n>1) v.push_back(P(1,n));\n  return v;\n}\n\nll N(char c) {\n  if(isdigit(c)) return c-'0';\n  return (c-'A')+10;\n}\n\nll C(string s,ll n) {\n  ll x=0,y=1;\n  for(int i=s.size()-1; i>=0; i--) {\n    x+=N(s[i])*y;\n    y*=n;\n  }\n  return x;\n}\n\nint main() {\n  ll n;\n  string s;\n  while(cin >> n >> s && n) {\n    vector<P> v=D(n);\n    ll m=C(s,n);\n    ll ans=1uLL<<63;\n    for(int i=0; i<v.size(); i++) {\n      P p=v[i];\n      ll z=0,x=p.S;\n      while(1) {\n        z+=m/x;\n        if(x*p.S>m||x*p.S/p.S!=x) break;\n        x*=p.S;\n      }\n      ans=min(ans,z/p.F);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] &&  fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long num = conv(base,fact);\n    int count[6] = {};\n    while(num > 0){\n      unsigned long long tmp = num;\n      while(tmp % 2 == 0){\n        tmp /= 2;\n        count[2]++;\n      }\n      while(tmp % 5 == 0){\n        tmp /= 5;\n        count[5]++;\n      }\n      num--;\n    }\n\n    printf(\"%d\\n\",min(count[2],count[5]));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\n\nint PRIMES_COUNT = 11;\nint PRIMES[] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\n\nint main(){\n\twhile(true){\n\t\tint base;\n\t\tstring digits;\n\t\tcin >> base >> digits;\n\t\tif(base == 0){ break; }\n\t\tll w = 1ll, input = 0;\n\t\tfor(int i = digits.size() - 1; i >= 0; --i, w *= base){\n\t\t\tif('0' <= digits[i] && digits[i] <= '9'){\n\t\t\t\tinput += (digits[i] - '0') * w;\n\t\t\t}else{\n\t\t\t\tinput += (digits[i] - 'A' + 10) * w;\n\t\t\t}\n\t\t}\n\t\tvector<ll> counts(PRIMES_COUNT, 0);\n\t\tfor(int i = 0; i < PRIMES_COUNT; ++i){\n\t\t\tll tmp = input;\n\t\t\twhile(tmp % PRIMES[i] == 0){\n\t\t\t\ttmp /= PRIMES[i];\n\t\t\t\tcounts[i] += tmp;\n\t\t\t}\n\t\t}\n\t\tcout << min(counts[0], counts[2]) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] &&  fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long num = conv(base,fact);\n    unsigned long long res = 0;\n    while(num > 0){\n      res += num / 5ULL;\n      num /= 5ULL;\n    }\n    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef unsigned long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nmap<ll, ll> factorize(ll n) {  // O(ツ」n)\n  map<ll, ll> res;\n  for (int i=2; i*i<=n; ++i) {\n    int cnt = 0;\n    while (n%i==0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt) {\n      res[i] = cnt;\n    }\n  }\n  if (n!=1) res[n] = 1;\n  return res;\n}\n\nint main() {\n  int N; string M;\n  int AAA = 0;\n  while(cin >> N >> M, N) {\n    ll num = strtoll(M.c_str(), NULL, N);\n    map<ll, ll> factor = factorize(N);\n    ll ans = 1LL<<62;\n    FOR(it, factor) {\n      ll now = it->first;\n      ll cnt = 0;\n      while(1) {\n        cnt += num / now;\n        if (now>num/it->first+EPS) break;\n        now *= it->first;\n      }\n      //cout << it->first << \" \" << it->second << \" \" << cnt << endl;\n       ans = min(ans, cnt/it->second);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main() {\n\tint N;\n\tstring M;\n\twhile (cin >> N >> M, N||M[0]!='0') {\n\t\tlong long num = 0;\n\t\tfor (int i=0; i<M.size(); i++) {\n\t\t\tint t = M[i]-'0';\n\t\t\tif (t > 9) {\n\t\t\t\tt = 10 + (M[i]-'A');\n\t\t\t}\n\t\t\tnum *= N;\n\t\t\tnum += t;\n\t\t}\n\n\t\tint ans = 0;\n\t\tdo {\n\t\t\tnum /= 5;\n\t\t\tans += num;\n\t\t} while (num > 4);\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll b = 1;\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i])*b;\n    b *= base;\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  long double end = num;\n  long double now = base;\n  ll res = 0;\n  ll b = base;\n  while(now <= end){\n    res += num/b;\n    // if(num/base > b+1) break;\n    b *= base;\n    now *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n\n  while(cin >> N >> M && N && M != \"0\"){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n\n   \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n   \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[[i]&&m[i]<='9' )s*=n,s+=m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s*=n,s+=m[i]-'A'+10;\n    }\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid factorize(vector<ll> &p,vector<ll> &cnt,ll x) {\n    p.clear(); cnt.clear();\n    if(x <= 1) {\n        p.push_back(1);\n        cnt.push_back(1);\n        return;\n    }\n\n    ll lim = (ll)sqrt(x);\n    ll pp = 2;\n    while(true) {\n        if(x <= 1) break;\n        if(pp > lim) {\n            p.push_back(x);\n            cnt.push_back(1);\n            break;\n        }\n        if(x % pp == 0) {\n            p.push_back(pp);\n            cnt.push_back(0);\n            while(x%pp == 0) {\n                cnt[cnt.size()-1]++;\n                x /= pp;\n            }\n        }\n        pp++;\n    }\n    return;\n}\n\nint main() {\n    int base;\n    string a;\n    while(cin>>base>>a, base) {\n        unsigned long long m = 0;\n        for(int i=0; i<a.length(); ++i) {\n            m *= base;\n            if(a[i] <= '9') m += a[i] - '0';\n            else m += a[i] - 'A' + 10;\n        }\n\n        vector<ll> p,cnt;\n        factorize(p,cnt,base);\n\n        vector<ll> pp(p.size(), 0);\n        for(int i=0; i<p.size(); ++i) {\n            ll n = p[i];\n            while(n <= m) {\n                pp[i] += m/n;\n                n *= p[i];\n            }\n        }\n\n        ll ans = 1ll<<62;\n        for(int i=0; i<p.size(); ++i) ans = min(ans, pp[i]/cnt[i]);\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef unsigned long long ll;\nint p[]={2,3,5,7,11,13,17,19,23,29,31};\nint main(){\n\tint n,nfac[11];\n\tll m,fac[11];\n\tstring b;\n\twhile(cin>>n>>b,n){\n\t\tm=0;\n\t\trep(i,11)nfac[i]=fac[i]=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tll ans=1184595334580404209LL;\n\t\trep(i,11){\n\t\t\twhile(n%p[i]==0)n/=p[i],nfac[i]++;\n\t\t\tif(nfac[i]){\n\t\t\t\tfor(ll j=p[i];j<=m;j*=p[i])fac[i]+=m/j;\n\t\t\t\tif(ans>fac[i]/nfac[i])ans=fac[i]/nfac[i];\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n  while(cin>>n>>m){\n    ll s=0;\n    for(int i=0;i<m.size();i++){\n      if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n      if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n    }\n    ll ans=0;\n    for(ll i=5;1<=s/i;i*=5){\n      ans+=s/i;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nvector<P> D(ll n) {\n  vector<P> v;\n  for(ll i=2; i*i<=n; i++) {\n    P p=P(0,i);\n    while(n%i==0) {\n      n/=i;\n      p.F++;\n    }\n    if(p.F) v.push_back(p);\n  }\n  if(n>1) v.push_back(P(1,n));\n  return v;\n}\n\nll N(char c) {\n  if(isdigit(c)) return c-'0';\n  return (c-'A')+10;\n}\n\nll C(string s,ll n) {\n  ll x=0,y=1;\n  for(int i=s.size()-1; i>=0; i--) {\n    x+=N(s[i])*y;\n    y*=n;\n  }\n  return x;\n}\n\nint main() {\n  ll n;\n  string s;\n  while(cin >> n >> s && n) {\n    vector<P> v=D(n);\n    ll m=C(s,n);\n    ll ans=1LL<<60;\n    for(int i=0; i<v.size(); i++) {\n      P p=v[i];\n      ll z=0,x=p.S;\n      while(1) {\n        z+=m/x;\n        if(x*p.S>m||x*p.S/p.S!=x) break;\n        x*=p.S;\n      }\n      ans=min(ans,z/p.F);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tint loop=(log10((long double)m)/log10((long double)a))+0.000001;\n\t\t\twhile(loop--){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-2;\nconst ll inf=1e17;\nint main(){\n\tll n;\n\tstring s;\n\twhile(cin>>n>>s,n){\n\t\tll m=strtoll(&s[0],NULL,n);\n\t\tvi a,b;\n\t\tloop(i,2,n+1){\n\t\t\tif(n%i)continue;\n\t\t\ta.pb(i);\n\t\t\tb.pb(0);\n\t\t\twhile(n%i==0)b[b.size()-1]++,n/=i;\n\t\t}\n\t\tll out=inf;\n\t\trep(i,a.size()){\n\t\t\tll tmp=m;\n\t\t\tll t=0;\n\t\t\twhile(tmp){\n\t\t\t\ttmp/=a[i];\n\t\t\t\tt+=tmp;\n\t\t\t}\n\t\t\tout=min(out,t/b[i]);\n\t\t}\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n,s=0;\n  string m;\n  cin>>n>>m;\n  for(int i=0;i<m.size();i++){\n    if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n    if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n  }\n  ll ans=0;\n  for(ll i=5;1<=s/i;i*=5){\n    ans+=s/i;\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#define int long long\n#define INF 4e+18\nusing namespace std;\n\nsigned main(){\n\tint n,tmp = 0;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\ttmp = 0;\n\tfor(int i = 0;i < m.length();i++){\n\t\tif('0' <= m[i] && m[i] <= '9'){\n\t\t\ttmp = tmp * n + m[i] - '0';\n\t\t}else {\n\t\t\ttmp = tmp * n + 10 + m[i] - 'A';\n\t\t}\n\t}\n\tmap<int,int> insuu;\n\tfor(int i = 2;i * i <= n;i++){\n\t\twhile(n % i == 0) {\n\t\t\tinsuu[i]++;\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) insuu[n]++;\n\tint mi = INF;\n\tfor(auto it = insuu.begin();it != insuu.end();it++){\n\t\tint t = tmp,cnt = 0;\n\t\twhile(t){\n\t\t\tcnt += t / it->first;\n\t\t\tt /= it->first;\n\t\t}\n\t\tmi = min(mi,cnt / it->second);\n\t}\n\tcout << mi << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s=s*n+m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s=s*n+m[i]-'A'+10;\n    }\n    assert(m.size()<=12&&n<=36);\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=(s/(ll)(i+0.5));\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nvector<pair<int, int> > PrimeFactor(int n) {\n  vector<pair<int, int> > ret;\n  FOREQ(i, 2, n) {\n    int cnt = 0;\n    while (n % i == 0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt != 0) {\n      ret.push_back(make_pair(i, cnt));\n    }\n  }\n  return ret;\n}\n\nll calc(ll m, ll v) {\n  if (m < v) { return 0; }\n  return m / v + calc(m / v, v);\n}\n\nll convert(string s, ll base) {\n  ll ret = 0;\n  FORIT(it, s) {\n    ll v = 0;\n    if (isdigit(*it)) { v = *it - '0'; }\n    else { v = *it - 'A' + 10; }\n    ret = ret * 10 + v;\n  }\n  return ret;\n}\n\nll n;\nstring str;\nint main() {\n  while (cin >> n >> str, n) {\n    ll m = convert(str, n);\n    vector<pair<int, int> > factor = PrimeFactor(n);\n    ll ans = 1LL << 60;\n    FORIT(it, factor) {\n      ans = min(ans, calc(m, it->first) / it->second);\n    }\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 802;\nusing namespace std;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\nlong long convtodec(string t, long long B){\n  long long ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  long long int N,B;\n  long long base;\n  string num;\n  while(cin>>base>>num){\n    long long int trzero;\n    int digs;\n    double dnod=0.0;\n    \n    N = convtodec(num,base);\n    B = base;\n    \n    //cout << N << ' ' << B << endl;\n    \n    if( N == 0 ){printf(\"0\\n\");continue;}\n    \n    for(int i = 1; i <= N; ++i){\n      dnod += log10(i);\n    }\n    digs = (int)(ceil(1e-10+dnod/log10(B)));\n    /*\n      if(dnod - floor(dnod) < 1e-14)\n      dnod++;\n      else\n      dnod = floor( dnod + 1 );\n    */\n    \n    map<long long int, long long int> mb;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      while(B>1&&B%vprimes[i]==0){\n\tB/=vprimes[i];\n\t++mb[vprimes[i]];\n      }\n    }\n    vector<long long int> mbcomb;\n    for(map<long long int,long long int>::iterator itm = mb.begin();\n\titm != mb.end();\n\titm++){\n      long long int s=0;\n      \n      for(int i = 1; i <= N; ++i){\n\tlong long int t=i;\n\twhile(t>1&&t%itm->first==0){\n\t  t/=itm->first;\n\t  ++s;\n\t}\n      }\n      mbcomb.push_back(s/itm->second);\n    }\n    \n    trzero=mbcomb[0];\n    for(int i = 1; i < (int)mbcomb.size(); ++i){\n      trzero = min( trzero, mbcomb[i] );\n    }\n\n    if(N<=1)digs=1;\n    cout<<trzero<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tif(a==2){\n\t\t\t\twhile(a<=m){\n\t\t\t\t\tcnt+=(m/a);\n\t\t\t\t\ta*=it->first;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint loop=(log((long double)m)/log((long double)a));\n\t\t\t\twhile(loop--){\n\t\t\t\t\tcnt+=(m/a);\n\t\t\t\t\ta*=it->first;\n\t\t\t\t}\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nint N; string M;\nint p[50]; long long power[20];\ninline long long div(long long k, int m) {\n\tlong long sum = 0;\n\twhile (k >= 1) {\n\t\tk /= m; sum += k;\n\t}\n\treturn sum;\n}\nint main() {\n\twhile (true) {\n\t\tcin >> N >> M; power[0] = 1;\n\t\tfor (int i = 0; i < 50; i++)p[i] = 0;\n\t\tfor (int i = 1; i < M.size(); i++)power[i] = power[i - 1] * N;\n\t\tif (N == 0)break;\n\t\tlong long C = 0;\n\t\tfor (int i = 0; i < M.size(); i++) {\n\t\t\tint V = (char)(M[i] - '0'); if (M[i] >= 'A')V = (char)(M[i] - 'A') + 10;\n\t\t\tC += power[M.size() - 1 - i] * V;\n\t\t}\n\t\tint L = N;\n\t\tfor (int i = 2; i <= L; i++) {\n\t\t\twhile (L%i == 0) {\n\t\t\t\tL /= i; p[i]++;\n\t\t\t}\n\t\t}\n\t\tlong long minx = 1LL << 62;\n\t\tfor (int i = 2; i <= N; i++) {\n\t\t\tif (p[i] == 0)continue;\n\t\t\tminx = min(minx, div(C, i) / p[i]);\n\t\t}\n\t\tcout << minx << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    for(int i = 2; i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 36; i >= 2; i--){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n      break;\n    }\n\n    if(res == numeric_limits<unsigned long long>::max()) res = 0;    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint N, M;\n\nint count(int n) {\n    int total = 0;\n    int m = M;\n    while (m >= n) {\n        total += (m / n);\n        m /= n;\n    }\n    return total;\n}\n\nlong long to_l(string s) {\n    long long n = 0;\n    for (int i = 0; i < s.size(); i++) {\n        if (isdigit(s[i])) {    \n            n = n * N + (s[i] - '0');\n        } else {\n            n = n * N + (s[i] - 'A' + 10);\n        }\n    }\n    return n;\n}\n\nint main() {\n    string M_;\n    while (cin >> N >> M_) {\n        if (N == 0 && M_ == \"0\") break;\n        M = to_l(M_);\n        int ans = 0;\n        switch (N) {\n            case 8:\n                ans = count(2) / 3;\n                break;\n            case 9:\n                ans = count(3) / 2;\n                break;\n            case 10:\n                ans = min(count(2), count(5));\n                break;\n            case 11:\n                ans = count(11);\n                break;\n            case 12:\n                ans = min(count(2) / 2, count(3));\n                break;\n            case 13:\n                ans = count(13);\n                break;\n            case 14:\n                ans = count(7);\n                break;\n            case 15:\n                ans = min(count(3), count(5));\n                break;\n            case 16:\n                ans = count(2) / 4;\n                break;\n            case 17:\n                ans = count(17);\n                break;\n            case 18:\n                ans = min(count(2), count(3) / 2);\n                break;\n            case 19:\n                ans = count(19);\n                break;\n            case 20:\n                ans = min(count(2)/2, count(5));\n                break;\n            case 21:\n                ans = min(count(3), count(7));\n                break;\n            case 22:\n                ans = min(count(2), count(11));\n                break;\n            case 23:\n                ans = count(23);\n                break;\n            case 24:\n                ans = min(count(2) / 3, count(3));\n                break;\n            case 25:\n                ans = count(5) / 2;\n                break;\n            case 26:\n                ans = min(count(2), count(13));\n                break;\n            case 27:\n                ans = count(3) / 3;\n                break;\n            case 28:\n                ans = min(count(2) / 2, count(7));\n                break;\n            case 29:\n                ans = count(29);\n                break;\n            case 30:\n                ans = min(min(count(2), count(3)), count(5));\n                break;\n            case 31:\n                ans = count(31);\n                break;\n            case 32:\n                ans = count(2) / 5;\n                break;\n            case 33:\n                ans = min(count(3), count(11));\n                break;\n            case 34:\n                ans = min(count(2), count(17));\n                break;\n            case 35:\n                ans = min(count(5), count(7));\n                break;\n            case 36:\n                ans = min(count(2) / 2, count(3) / 2);\n                break;\n        }\n        cout << ans << endl;\n//        for (int i = 0; i < 36; i++) {\n//            cout << count(i) << ' ';\n//        }\n//        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll b = 1;\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i])*b;\n    b *= base;\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  long double end = num;\n  long double now = base;\n  ll res = 0;\n  ll b = base;\n  while(now <= end){\n    res += num/b;\n    if(num/base+1 < b) break;\n    b *= base;\n    now *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n\n  while(cin >> N >> M && N && M != \"0\"){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n\n   \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n   \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nint N; string M;\nint p[50];\nlong long div(long long k, int m) {\n\tlong long sum = 0;\n\twhile (k >= 1) {\n\t\tk /= m; sum += k;\n\t}\n\treturn sum;\n}\nint main() {\n\twhile (true) {\n\t\tcin >> N >> M;\n\t\tfor (int i = 0; i < 50; i++)p[i] = 0;\n\t\tif (N == 0)break;\n\t\tlong long C = 0;\n\t\tfor (int i = 0; i < M.size(); i++) {\n\t\t\tint V = (char)(M[i] - '0'); if (M[i] >= 'A')V = (char)(M[i] - 'A') + 10;\n\t\t\tC += (long long)pow((long long)N, M.size() - i - 1)*V;\n\t\t}\n\t\tint L = N;\n\t\tfor (int i = 2; i <= L; i++) {\n\t\t\twhile (L%i == 0) {\n\t\t\t\tL /= i; p[i]++;\n\t\t\t}\n\t\t}\n\t\tlong long minx = 1LL << 62;\n\t\tfor (int i = 2; i <= N; i++) {\n\t\t\tif (p[i] == 0)continue;\n\t\t\tminx = min(minx, div(C, i) / p[i]);\n\t\t}\n\t\tcout << minx << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n#include <climits>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst ll INF = 1000000000000000000LL;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, ll> prime_factor(ll n){\n\tmap<ll, ll> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tif(N == 0 && M == \"0\")break;\n\t\tif(M == \"0\"){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<ll, ll> factor = prime_factor(N);\n\t\tmap<ll, ll> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tif(L == 0) while(true);\n\t\tll ans = LLONG_MAX;\n\t\tfor(map<ll,ll>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t\tif(L / i < it->first) break;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n#include<stack>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\ntypedef vector<string> vstring;\ntypedef vector<pint> vpint;\ntypedef stringstream SS;\n\n#ifdef DEBUG\n#define debug cout\n#else\nSS ss;\n#define debug ss\n#endif\n\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define repn(i,m,n) for(int i=(m);i<(n);++i)\n#define repd(i,n) for(int i=(n)-1;i>=0;--i)\n#define repnd(i,m,n) for(int i=(n)-1;i>=(m);--i)\n#define rep0(i,n) for(i=0;i<(n);++i)\n#define repn0(i,m,n) for(i=(m);i<(n);++i)\n#define repd0(i,n) for(i=(n)-1;i>=0;--i)\n#define repnd0(i,m,n) for(i=(n)-1;i>=(m);--i)\n#define repc(i,n) for(int i=0;i<=(n);++i)\n#define repcn(i,m,n) for(int i=(m);i<=(n);++i)\n#define repcd(i,n) for(int i=(n);i>=0;--i)\n#define repcnd(i,m,n) for(int i=(n);i>=(m);--i)\n#define repc0(i,n) for(i=0;i<=(n);++i)\n#define repcn0(i,m,n) for(i=(m);i<=(n);++i)\n#define repcd0(i,n) for(i=(n);i>=0;--i)\n#define repcnd0(i,m,n) for(i=(n);i>=(m);--i)\n#define all(n) n.begin(),n.end()\n#define sz(n) ((int)(n).size())\n#define IL for(;;)\n#define MP make_pair\n#define PB push_back\n#define X second\n#define Y first\n#define p_queue(n) priority_queue<n,vector<n>,greater<n> >\n#define PUTLINE debug<<\"LINE:\"<<__LINE__<<endl;\n\nconst int INF = 2147483647/3;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\n\nconst int dx[]={1,-1,0,0,1,1,-1,-1,0};\nconst int dy[]={0,0,1,-1,1,-1,1,-1,0};\n\nint dig(char c){\n\tif(isdigit(c))return c-'0';\n\treturn c-'A'+10;\n}\n\nint main() {\n\tInt n,m,nn,mm,res,r;\n\tvpint p;\n\tstring str;\n\tIL{\n\t\tcin>>n>>str;\n\t\tif(n==0)break;\n\t\tm=0;\n\t\trep(i,sz(str)){\n\t\t\tm=m*n+dig(str[i]);\n\t\t}\n\t\tnn=n;\n\t\tp.clear();\n\t\tfor(int i=2;nn!=1;++i){\n\t\t\tif(nn%i==0){\n\t\t\t\tint count=0;\n\t\t\t\twhile(nn%i==0){\n\t\t\t\t\t++count;\n\t\t\t\t\tnn/=i;\n\t\t\t\t}\n\t\t\t\tp.PB(MP(i,count));\n\t\t\t}\n\t\t}\n\t\tres=INF;\n\t\trep(j,sz(p)){\n\t\t\tmm=m;\n\t\t\tr=0;\n\t\t\twhile(mm>0){\n\t\t\t\tmm/=p[j].first;\n\t\t\t\tr+=mm;\n\t\t\t}\n\t\t\tchmin(res,r/p[j].second);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s=s*n+m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s=s*n+m[i]-'A'+10;\n    }\n    assert(m.size()<=12&&n<=36);\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=(s/(ll)(i+0.5));\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\n#pragma warning(disable : 4996)\nusing namespace std;\nint N; char M[15];\nint p[50]; long long power[20];\ninline long long div(long long k, int m) {\n\tlong long sum = 0;\n\twhile (k >= 1) {\n\t\tk /= m; sum += k;\n\t}\n\treturn sum;\n}\nint main() {\n\twhile (true) {\n\t\tscanf(\"%d%s\", &N, M); power[0] = 1;\n\t\tfor (int i = 0; i < 50; i++)p[i] = 0;\n\t\tfor (int i = 1; i < strlen(M); i++)power[i] = power[i - 1] * N;\n\t\tif (N == 0)break;\n\t\tlong long C = 0;\n\t\tfor (int i = 0; i < strlen(M); i++) {\n\t\t\tint V = (char)(M[i] - '0'); if (M[i] >= 'A')V = (char)(M[i] - 'A') + 10;\n\t\t\tC += power[strlen(M) - 1 - i] * V;\n\t\t}\n\t\tint L = N;\n\t\tfor (int i = 2; i <= L; i++) {\n\t\t\twhile (L%i == 0) {\n\t\t\t\tL /= i; p[i]++;\n\t\t\t}\n\t\t}\n\t\tlong long minx = 1LL << 62;\n\t\tfor (int i = 2; i <= N; i++) {\n\t\t\tif (p[i] == 0)continue;\n\t\t\tminx = min(minx, div(C, i) / p[i]);\n\t\t}\n\t\tprintf(\"%lld\\n\", minx);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint main(){\n\tint n,m,mxdiv,divprime,ans; string b;\n\tbool p[99]={0}; for(int i=2;i*i<=99;i++)if(!p[i])for(int j=i+i;j<=99;j+=i)p[j]=1;\n\twhile(cin>>n>>b,n){\n\t\tmxdiv=m=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tcerr<<\"n= \"<<n<<\" ,m=\"<<m<<endl;\n\t\tfor(int i=n;i>1;i--)if(!p[i]&&n%i==0){\n\t\t\tint div=i;\n\t\t\twhile(n%(div*i)==0)div*=i;\n\t\t\tif(mxdiv<div)mxdiv=div,divprime=i;\n\t\t}\n\t\tcerr<<\"mxdiv= \"<<mxdiv<<endl;\n\t\tans=0;\n\t\tfor(int i=divprime;i<=m;i*=divprime)ans+=m/i;\n\t\tint multime=1;for(int i=divprime;i<mxdiv;multime++)i*=divprime;\n\t\tcerr<<\"ans= \"<<ans<<\" ,multime= \"<<multime<<endl;\n\t\t\n\t\tcout<<ans/multime<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=10000000000000000000ULL;\n\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=2;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tlong double a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\twhile(a<=m){\n\t\t\t\tcnt+=(m/a+0.001);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n#include <string.h>\n\nusing namespace std;\nvector<int> prime;\nbool isPrime[100001];\n\nvoid PrimeCalc()\n{\n\tmemset(isPrime, 1, sizeof(isPrime));\n\tisPrime[0] = isPrime[1] = false;\n\tfor(int i = 2; i <= 100000; ++i)\n\t{\n\t\tif(isPrime[i])\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\tfor(int j = 2 * i; j <= 100000; j += i)\n\t\t\t{\n\t\t\t\tisPrime[j] = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid solve()\n{\n\tPrimeCalc();\n\tint N;\n\twhile(cin >> N, N)\n\t{\n\t\tstring M;\n\t\tcin >> M;\n\t\tmap<int, int> decimal_factor;\n\t\tint t = N;\n\t\tfor(int i = 0; i < prime.size() && prime[i] <= 36; ++i)\n\t\t{\n\t\t\tif(t == 1)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile(t % prime[i] == 0)\n\t\t\t{\n\t\t\t\t++decimal_factor[prime[i]];\n\t\t\t\tt /= prime[i];\n\t\t\t}\n\t\t}\n\t\tint to = 1;\n\t\tint k = 1;\n\t\tfor(int i = M.size() - 1; i >= 0; --i)\n\t\t{\n\t\t\tif('A' <= M[i] && M[i] <= 'Z')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - 'A' + 10);\n\t\t\t}\n\t\t\telse if('1' <= M[i] && M[i] <= '9')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - '0');\n\t\t\t}\n\t\t\tk *= N;\n\t\t}\n\t\tmap<int, int> factor;\n\t\tfor(int i = 2; i <= to; ++i)\n\t\t{\n\t\t\tt = i;\n\t\t\tfor(int j = 0; prime[j] * prime[j] <= to; ++j)\n\t\t\t{\n\t\t\t\tif(t == 1)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\twhile(t % prime[j] == 0)\n\t\t\t\t{\n\t\t\t\t\t++factor[prime[j]];\n\t\t\t\t\tt /= prime[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint min_exist = 999999999;\n\t\tmap<int, int>::iterator it = factor.begin();\n\t\twhile(it != factor.end())\n\t\t{\n\t\t\tif(decimal_factor[it->first] > 0 && it->second / decimal_factor[it->first] < min_exist)\n\t\t\t{\n\t\t\t\tmin_exist = it->second / decimal_factor[it->first];\n\t\t\t}\n\t\t\t++it;\n\t\t}\n\t\tcout << min_exist << endl;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number){\n\t\tif(base == 0 && number == \"0\") break;\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k]){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k] != 0){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min > fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//ツつアツづ個陛サツ法ツつセツづオツーツバツーツフツδ債ー\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\tif(min == num){\n\t\t\tmin = 0;\n\t\t}\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tint loop=(log((long double)m)/log((long double)a))+0.000001;\n\t\t\twhile(loop--){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\n\nusing namespace std;\n\nint main(){\n\n\tunsigned long long int number,base,ans;\n\tint length;\n\tchar exp[13];\n\n\twhile(true){\n\t\tscanf(\"%lld %s\",&base,exp);\n\t\tif(base == 0 && exp[0] == '0')break;\n\n\t\tnumber = 0;\n\t\tfor(length = 0;exp[length] != '\\0';length++);\n\n\t\tfor(int i = 0; i < length; i++){\n\t\t\tif(exp[i] >= '0' && exp[i] <= '9'){\n\t\t\t\tnumber += pow(base,length-1-i)*(exp[i] - '0');\n\t\t\t}else{\n\t\t\t\tnumber += pow(base,length-1-i)*(10 + exp[i] - 'A');\n\t\t\t}\n\t\t}\n\n\t\tans = 0;\n\t\tfor(int i = 1; pow(5,i) <= number;i++){\n\t\t\tans += number/pow(5,i);\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 37;\nusing namespace std;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\nlong long convtodec(string t, long long B){\n  long long ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\nlong long ipow(long long t, int p){\n  long long ret = 1;\n  for(int i = 0; i < p; ++i){\n    ret *= t;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  long long int N,B;\n  long long base;\n  string num;\n  while(cin>>base>>num){\n    N = convtodec(num,base);\n    B = base;\n    \n    if( N == 0 ){printf(\"0\\n\");continue;}\n    \n    long long num[vprimes.size()];\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      num[i] = 0;\n      int maxpow = 1;\n      while(N>ipow(vprimes[i],maxpow)){\n\t++maxpow;\n      }\n      --maxpow;\n      long long presum = 0;\n      //cout << vprimes[i] << ' ' << maxpow << endl; \n      for(int p = maxpow; p >= 1; --p){\n\tlong long tnum = (N / ipow(vprimes[i],p)) - presum;\n\tpresum += tnum;\n\tnum[i] += p * tnum;\n      }\n      //cout << num[i] << endl;\n    }\n\n    long long res = 1LL<<62;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      int e = 0;\n      long long tB = B;\n      while(tB % vprimes[i] == 0){\n\t++e;\n\ttB /= vprimes[i];\n      }\n      if( e > 0 ){\n\tres = min(res, num[ i ] / e);\n      }\n    }\n    if( res == 1LL<<62 ) res = 0;\n\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(long long i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef unsigned long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-2;\nconst ll inf=1e19;\nint main(){\n\tll n;\n\tstring s;\n\twhile(cin>>n>>s,n){\n\t\tll m=strtoll(&s[0],NULL,n);\n\t\tvi a,b;\n\t\tloop(i,2,n+1){\n\t\t\tif(n%i)continue;\n\t\t\ta.pb(i);\n\t\t\tb.pb(0);\n\t\t\twhile(n%i==0)b[b.size()-1]++,n/=i;\n\t\t}\n\t\tll out=inf;\n\t\trep(i,a.size()){\n\t\t\tll tmp=m;\n\t\t\tll t=0;\n\t\t\twhile(tmp){\n\t\t\t\ttmp/=a[i];\n\t\t\t\tt+=tmp;\n\t\t\t}\n\t\t\tout=min(out,t/b[i]);\n\t\t}\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst ll INF = 1000000000000000000LL;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, ll> prime_factor(ll n){\n\tmap<ll, ll> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tif(N == 0 && M == \"0\")break;\n\t\tif(M == \"0\"){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<ll, ll> factor = prime_factor(N);\n\t\tmap<ll, ll> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tif(L == 0) while(true);\n\t\tll ans = INF;\n\t\tfor(map<ll,ll>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t\tif(L / i < it->first) break;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    memset(prime_factor,0,sizeof(prime_factor));\n    for(int i = 2; i * i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        prime_factor[base / i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n\n    if(res == numeric_limits<unsigned long long>::max()) res = 0;    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\twhile(a<=m){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(ll i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\nint main(){\n\tll n,m,mxdiv,divprime,ans; string b;\n\tbool p[99]={0}; for(ll i=2;i*i<=99;i++)if(!p[i])for(ll j=i+i;j<=99;j+=i)p[j]=1;\n\twhile(cin>>n>>b,n){\n\t\tmxdiv=m=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\t//cerr<<\"n= \"<<n<<\" ,m=\"<<m<<endl;\n\t\tfor(ll i=n;i>1;i--)if(!p[i]&&n%i==0){\n\t\t\tll div=i;\n\t\t\twhile(n%(div*i)==0)div*=i;\n\t\t\tif(mxdiv<div)mxdiv=div,divprime=i;\n\t\t}\n\t\t//cerr<<\"mxdiv= \"<<mxdiv<<endl;\n\t\tans=0;\n\t\tfor(ll i=divprime;i<=m;i*=divprime)ans+=m/i;\n\t\tll multime=1;for(ll i=divprime;i<mxdiv;multime++)i*=divprime;\n\t\t//cerr<<\"ans= \"<<ans<<\" ,multime= \"<<multime<<endl;\n\t\t\n\t\tcout<<ans/multime<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s*=n,s+=m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s*=n,s+=m[i]-'A'+10;\n    }\n    assert(m.size()<=12&&n<=36);\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num,kaijyou;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number && base != 0 && number != \"0\"){\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k]){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k]){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min > fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//ツつアツづ個陛サツ法ツつセツづオツーツバツーツフツδ債ー\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 37;\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\null convtodec(string t, ull B){\n  ull ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\null ipow(ull t, int p){\n  ull ret = 1;\n  for(int i = 0; i < p; ++i){\n    ret *= t;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  ull N,B;\n  ull base;\n  string num;\n  while(cin>>base>>num){\n    if( base == 0 ) break;\n    if( base == 0 && num[0] == '0' ) break;\n\n    N = convtodec(num,base);\n    B = base;\n\n    //cout << N << ' ' << B << endl;\n\n    ull num[vprimes.size()];\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      num[i] = 0;\n      int maxpow = 1;\n      while(N>ipow(vprimes[i],maxpow)){\n\t++maxpow;\n      }\n      \n      --maxpow;\n      if(maxpow==0)maxpow = 1;\n      ull presum = 0;\n      for(int p = maxpow; p >= 1; --p){\n\tull tnum = (N / ipow(vprimes[i],p)) - presum;\n\tpresum += tnum;\n\tnum[i] += p * tnum;\n      }\n      //cout << vprimes[i] << ' ' << num[i] << endl;\n    }\n\n    ull res = 1LL<<62;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      int e = 0;\n      ull tB = B;\n      while(tB % vprimes[i] == 0){\n\t++e;\n\ttB /= vprimes[i];\n      }\n      if( e > 0 ){\n\tres = min(res, num[ i ] / e);\n      }\n    }\n    if( res == 1LL<<62 ) res = 0;\n\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<stack>\n#include<map>\n#include<set>\n#include<queue>\n#include<cstdio>\n#include<climits>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<sstream>\n#include<numeric>\n#include<cassert>\n\n#define f first\n#define s second\n#define mp make_pair\n\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n#define rep(i,s,n) for(int i=(s); i<(int)(n); i++)\n#define FOR(i,c) for(__typeof((c).begin()) i=(c).begin(); i!=(c).end(); i++)\n#define ALL(c) (c).begin(), (c).end()\n#define IN(x,s,g) ((x) >= (s) && (x) < (g))\n#define ISIN(x,y,w,h) (IN((x),0,(w)) && IN((y),0,(h)))\n#define print(x) printf(\"%d\\n\",x)\n\nusing namespace std;\n\ntypedef unsigned int uint;\ntypedef unsigned long long ll;\n\nconst int _dx[] = {0,1,0,-1};\nconst int _dy[] = {-1,0,1,0};\n\nint getInt(){\n  int ret = 0,c;\n  c = getchar();\n  while(!isdigit(c)) c = getchar();\n  while(isdigit(c)){\n    ret *= 10;\n    ret += c - '0';\n    c = getchar();\n  }\n  return ret;\n}\n\ninline int toInt(char c){\n  if(isdigit(c)) return c - '0';\n  return c - 'A' + 10;\n}\n\nll decode(char *num, int base){\n  ll ret = 0;\n  while(*num){\n    ret *= base;\n    ret += toInt(*num++);\n  }\n  return ret;\n}\n\nint main(){\n  int base;\n  char num[32];\n\n  while(scanf(\"%d%s\",&base,num),base){\n    ll dec = decode(num, base);\n    ll ans = (1ll)<<63;\n\n    for(int d = 2; ; d++){\n      if(base % d == 0){\n        int cnt = 0;\n        while(base % d == 0){\n          base /= d;\n          cnt++;\n        }\n\n        ll tmp = dec;\n        ll a = 0;\n        while(tmp){\n          tmp /= d;\n          a += tmp;\n        }\n        ans = min(ans, a/cnt);\n        //printf(\"dec:%llu d:%d cnt:%d base:%d a:%llu\\n\",dec,d,cnt,base,a);\n      }\n\n      if(base == 1) break;\n    }\n\n    printf(\"%llu\\n\",ans);\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <climits>\nusing namespace std;\n\nunsigned long long to(string w , int base){\n\tunsigned long long ans = 0;\n\tfor(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n\treturn ans;\n}\n\nmap<int,int> factor(int n){\n\tmap<int,int> w;\n\tfor(int i = 2 ; i*i<=n ; i++)\n\t\twhile(n%i==0) w[i]++ , n /= i;\n\tif(n!=1) w[n]++;\n\treturn w;\n}\nint main(){\n\tint n;\n\tstring m;\n\twhile(cin >> n >> m && n){\n\t\tunsigned long long v = to(m,n) , ans = -1;\n\t\tmap<int,int> r = factor(n);\n\t\tfor( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n\t\t\tint a = it->first;\n\t\t\tint d = it->second;\n\t\t\tunsigned long long t = v;\n\t\t\tunsigned long long ok = 0;\n\t\t\twhile(t){ ok += (t / a) ; t /= a;}\n\t\t\tans = min(ok / d , ans);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n\n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=int(a)-1;i>=int(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n\n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n\ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n\nusing namespace std;\nusing ll=long long;\n\nll convert(char c){\n\tif(isdigit(c))\n\t\treturn c - '0';\n\telse\n\t\treturn c -'A'+10;\n}\n\nconst int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\nint main(void){\n\tll n;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\t\tll num[11]={0};\n\t\t\n\t\tll mten=0LL;\n\n\t\tfor(auto &d:m) mten=n*mten+convert(d);\n\t\trep(i,11){\n\t\t\tll cur=prime[i];\n\t\t\twhile(cur<mten) num[i]+=mten/cur,cur*=prime[i];\n\t\t}\n\t\tll ans=-1LL;\n\t\trep(i,11){\n\t\t\tif(n%prime[i]) continue;\n\t\t\tll cur=n,coef=0LL;\n\t\t\twhile(cur%prime[i]==0) cur/=prime[i],coef++;  \n\t\t\tif(ans==-1)\n\t\t\t\tans=num[i]/coef;\n\t\t\telse\n\t\t\t\tchmin(ans,num[i]/coef);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tlong double a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\twhile(a<=m){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nlong long ctoll(char);\nlong long rj(long long,long long,long long) ;\n\nint main(){\n  while(1){\n    long long n;\n    string m;\n    cin >> n >> m;\n    if(n==0&&m==\"0\")break;\n    long long a=0;\n    long long c=0;\n    for(long long i=m.size()-1,j=0;i>=0;i--,j++){\n      a+=rj(ctoll(m[i]),n,j);\n    }\n    for(long long i=5;;i*=5){\n      c+=a/i;\n      if(a/5+4<i)break;\n    }\n    cout << c << endl;\n  }\n  return 0;\n}\nlong long ctoll(char ch){\n  if(ch>='0'&&ch<='9')return ch-'0';\n  return ch-'A'+10;\n}\n\nlong long rj(long long x,long long a,long long b){\n  long long y=1;\n  for(long long i=0;i<b;i++){\n    y*=a;\n  }\n  return y*=x;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main()\n{\n\tint b; string str;\n\twhile(cin >> b >> str, b||str!=\"0\")\n\t{\n\t\tlong long m=0;\n\t\tfor(int i=0; i<str.size(); i++)\n\t\t{\n\t\t\tm*=b;\n\t\t\tif('0'<=str[i] && str[i]<='9') m+=(str[i]-'0');\n\t\t\tif('A'<=str[i] && str[i]<='Z') m+=(str[i]-'A'+10);\n\t\t}\n\n\t\tlong long a=0,d=1;\n\t\tfor(int i=0; i<26; i++)\n\t\t{\n\t\t\td*=5; a+=(m/d);\n\t\t}\n\n\t\tcout << a << endl;\n\t}\n\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-2;\nconst int inf=1e17;\nint main(){\n\tint n;\n\tstring s;\n\twhile(cin>>n>>s,n){\n\t\tint m=strtoll(&s[0],NULL,n);\n\t\tvi a,b;\n\t\tloop(i,2,n+1){\n\t\t\tif(n%i)continue;\n\t\t\ta.pb(i);\n\t\t\tb.pb(0);\n\t\t\twhile(n%i==0)b[b.size()-1]++,n/=i;\n\t\t}\n\t\tll out=inf;\n\t\trep(i,a.size()){\n\t\t\tll tmp=m;\n\t\t\tll t=0;\n\t\t\twhile(tmp){\n\t\t\t\ttmp/=a[i];\n\t\t\t\tt+=tmp;\n\t\t\t}\n\t\t\tout=min(out,t/b[i]);\n\t\t}\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\nint p[]={2,3,5,7,11,13,17,19,23,29,31};\nint main(){\n\tint n,nfac[11];\n\tll m,fac[11];\n\tstring b;\n\twhile(cin>>n>>b,n){\n\t\tm=0;\n\t\trep(i,11)nfac[i]=fac[i]=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tll ans=(1LL)<<62;\n\t\trep(i,11){\n\t\t\twhile(n%p[i]==0)n/=p[i],nfac[i]++;\n\t\t\tif(nfac[i]){\n\t\t\t\tfor(ll j=p[i];j<=m;j*=p[i])fac[i]+=m/j;\n\t\t\t\tif(ans>fac[i]/nfac[i])ans=fac[i]/nfac[i];\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nint main(){\n  int n;\n  string m;\n  while(cin >> n >> m, n||m!=\"0\"){\n    long long M = 0,k = 1;\n    for(int i=(int)m.size()-1;i>=0;i--){\n      if('0'<= m[i] && m[i]<='9')M += (m[i]-'0')*k;\n      else M += (m[i]-'A' + 10)*k;\n      k *= n;\n    }\n\n    int f[11];\n    int pr[] = {2,3,5,7,11,13,17,19,23,29,31};\n    \n    for(int i=0;i<11;i++){\n      int tmp = n;\n      f[i] = 0;\n      while(!(tmp%pr[i])){\n\ttmp/=pr[i];\n\tf[i]++;\n      }\n    }\n\n    long long ans = 1LL<<62;\n    for(int i=0;i<11;i++){\n      if(f[i]){\n\tlong long tmp = M,sum = 0;\n\twhile(pr[i]<=tmp){\n\t  sum += tmp/pr[i];\n\t  tmp /= pr[i];\n\t}\n\tans = min(ans, sum/f[i]);\n      }\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n\n\nusing namespace std;\n\ntypedef long long ll;\n\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll b = 1;\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i])*b;\n    b *= base;\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  ll res = 0;\n  ll b = base;\n  while(b <= num){\n    res += num/b;\n    b *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n\n  while(cin >> N >> M && N && M != \"0\"){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n\n   \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n   \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int unsigned long long\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\n \ntypedef pair<int,int>P;\n \nint sosu[]={2,3,5,7,11,13,17,19,23,29,31,37},so=12;\n \nint con(int n,string s){\n  int res=0;\n  for(int i=0;i<s.size();i++){\n \n    res*=n;\n     \n    if(isalpha(s[i])){\n      res+=(s[i]-'A')+10;\n    }\n    else{\n      res+=(s[i]-'0');\n    }\n \n  }\n  return res;\n}\n \nvector<int> bunkai(int n){\n  vector<int>v;\n  r(i,so){\n    while(n%sosu[i]==0){\n      n/=sosu[i];\n      v.push_back(sosu[i]);\n    }\n  }\n  return v;\n}\n \nsigned main(){\n int N;\n  string s;\n  while( cin>>N>>s , N ){\n    int n=N;\n    int p=con(n,s);//cout<<p<<endl;\n \n    vector<int>v=bunkai(n);\n     \n    vector<P>vec,vel;\n \n    r(i,v.size()){\n      int res=0;\n      __int128 x=1;\n      if(i&&v[i-1]==v[i])continue;\n      __int128 pp=p;\n      for(int j=1;;j++){\n     \n        x*=v[i];\n \n        if(x>pp)break;\n     \n        res+=p/x;\n      }\n      vec.push_back(P(res,v[i]));\n    }\n     \n    r(i,so){\n      int res=0;\n      r(j,v.size()){\n        if(sosu[i]==v[j])res++;\n      }\n      if(res==0)continue;\n      //cout<<sosu[i]<<' '<<res<<endl;\n      //cout<<p/sosu[i]<<endl;\n      vel.push_back(P(res,sosu[i]));\n    }\n \n    unsigned long long ans=ULLONG_MAX;\n    r(i,vec.size()){\n      ans=min(ans,(unsigned long long)(vec[i].first/vel[i].first));\n    }\n \n    cout<<ans<<endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\n#define ALL(C)     (C).begin(),(C).end()\n#define pb         push_back\n#define mp         make_pair\ntypedef long long ll;\n\nll mypow(ll n,ll a){\n  if (n == 0)return 1;\n  ll ret = mypow(n/2,a);\n  ret=ret*ret;\n  if (n%2 == 1)ret*=a;\n  return ret;\n}\n\nll val[255];\n\nll compute(string &a,ll div,int base){\n  ll nowbase=1;\n  ll ret=0;\n  for(int i=a.size()-1;i>=0;i--){\n    ret+=(val[a[i]]*nowbase)/div;\n    nowbase*=base;\n  }\n  return ret;\n}\n\nvoid fact(int n,int *base,int *basenum,int &p){\n  for(int i=2;i<=n;i++){\n    if (n%i == 0){\n      base[p]=i;\n      basenum[p]=0;\n      while(true){\n\tif (n/i == 0 || n%i != 0)break;\n\tn/=i;\n\tbasenum[p]++;\n      }\n      p++;\n    }\n  }\n}\n\nll count(int p,int *basenum,ll *cnt){\n  ll ret=(1LL<<62);\n  rep(i,p){\n    ret=min(ret,cnt[i]/basenum[i]);\n  }\n  return ret;\n}\n\nmain(){\n  //  check();\n  for(int i=0;i<10;i++){\n    val['0'+i]=i;\n  }\n  for(int i='A';i<='Z';i++){\n    val[i]=i-'A' + 10;\n  }\n\n  int base[100];\n  int basenum[100];\n  ll cnt[100];\n  int num[100];\n  int in;\n  string inp;\n  while(cin>>in>>inp && in){\n    int p=0;\n    fact(in,base,basenum,p);\n\n    rep(i,p){\n      ll now=base[i];\n      cnt[i]=0;\n      while(true){\n\tll tmp = compute(inp,now,in);\n\tif (tmp == 0)break;\n\tcnt[i]+=tmp;\n\tnow*=base[i];\n      }\n    }\n    cout << count(p,basenum,cnt) << endl;\n\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num,kaijyou;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number && (base != 0 || number != \"0\")){\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k]){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k]){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min > fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//ツつアツづ個陛サツ法ツつセツづオツーツバツーツフツδ債ー\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\tif(min == num){\n\t\t\tmin = 0;\n\t\t}\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    memset(prime_factor,0,sizeof(prime_factor));\n    for(int i = 2; i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n\n    if(res == numeric_limits<unsigned long long>::max()) res = 0;    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tlong double a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\twhile(a<=m){\n\t\t\t\tcnt+=(m/a+0.001);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <climits>\n#include <string>\nusing namespace std;\n \nunsigned long long to(string w , int base){\n    unsigned long long ans = 0;\n    for(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n    return ans;\n}\n \nmap<int,int> factor(int n){\n    map<int,int> w;\n    for(int i = 2 ; i*i<=n ; i++)\n        while(n%i==0) w[i]++ , n /= i;\n    if(n!=1) w[n]++;\n    return w;\n}\n \nint main(){\n    int n;\n    string m;\n    while(cin >> n >> m, n){\n        unsigned long long v = to(m,n) , ans = -1;\n        map<int,int> r = factor(n);\n        for( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n            int a = it->first;\n            int d = it->second;\n            unsigned long long t = v;\n            unsigned long long ok = 0;\n            while(t){ ok += (t / a) ; t /= a;}\n            ans = min(ok / d , ans);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tif(m==0){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tint loop=(log((long double)m)/log((long double)a)+(1e-10));\n\t\t\twhile(loop--){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n#include <memory.h>\n#include <queue>\n#include <cstdio>\n#include <cstdlib>\n#include <map>\n#include <cmath>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i< n; i++)\ntypedef unsigned long long ll;\ntypedef pair<int, int> P;\nconst ll LM = 1LL<<63;\n\nll tonum(string s){\n  ll res = 0;\n  int n = s.size();\n  rep(i, n){\n    ll m = (isdigit(s[i])) ? s[i] - '0' : s[i] - 'A' + 10;\n    res = res * 10LL + m;\n  }\n  return res;\n}\n\nll get_cnt(ll M, ll i, ll cnt){\n  ll res = 0;\n  ll num = 1;\n  while(num < LM / i){\n    num *= i;\n    res += M / num;\n  }\n  return res / cnt;\n}\n\nint main(){\n  ll N, M;\n  string s;\n  while(cin >> N >> s && (N || s != \"0\")){\n    M = tonum(s);\n    ll res = LM;\n    for(ll i = 2; i * i <= N; i++){\n      if(N%i == 0){\n\tll cnt = 0;\n\twhile(N % i == 0) {\n\t  cnt++;\n\t  N /= i;\n\t}\n\tres = min(res, get_cnt(M, i, cnt));\n      }\n    }\n    if(N > 1) res = min(res, get_cnt(M, N, 1));\n    cout << res << endl;\n  }\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 37;\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\null convtodec(string t, ull B){\n  ull ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\null ipow(ull t, int p){\n  ull ret = 1;\n  for(int i = 0; i < p; ++i){\n    ret *= t;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  ull N,B;\n  ull base;\n  string num;\n  while(cin>>base>>num){\n    if( base == 0 ) break;\n    if( base == 0 && num[0] == '0' ) break;\n\n    N = convtodec(num,base);\n    B = base;\n    \n    //cout << N << ' ' << B << endl;\n\n    if( N == 0 ){printf(\"0\\n\");continue;}\n    \n    ull num[vprimes.size()];\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      num[i] = 0;\n      int maxpow = 1;\n      while(N>ipow(vprimes[i],maxpow)){\n\t++maxpow;\n      }\n      --maxpow;\n      ull presum = 0;\n      for(int p = maxpow; p >= 1; --p){\n\tull tnum = (N / ipow(vprimes[i],p)) - presum;\n\tpresum += tnum;\n\tnum[i] += p * tnum;\n      }\n    }\n\n    ull res = 1LL<<62;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      int e = 0;\n      ull tB = B;\n      while(tB % vprimes[i] == 0){\n\t++e;\n\ttB /= vprimes[i];\n      }\n      if( e > 0 ){\n\tres = min(res, num[ i ] / e);\n      }\n    }\n    if( res == 1LL<<62 ) res = 0;\n\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[30];\nint p[30];\nint q[30];\nint main(){\n\tint a;\n\twhile(scanf(\"%d%s\",&a,str),a){\n\t\tint b=a;\n\t\tint sz=0;\n\t\tfor(int i=0;i<30;i++)q[i]=0;\n\t\tfor(int i=2;i*i<=b;i++){\n\t\t\tif(b%i==0){\n\t\t\t\tp[sz++]=i;\n\t\t\t\twhile(b%i==0){\n\t\t\t\t\tb/=i;\n\t\t\t\t\tq[sz-1]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(b>1){p[sz++]=b;q[sz-1]=1;}\n\t\tlong long val=0;\n\t\tfor(int i=0;str[i];i++){\n\t\t\tval*=a;\n\t\t\tif(str[i]>='A'&&str[i]<='Z')val+=str[i]-'A'+10;\n\t\t\telse val+=str[i]-'0';\n\t\t}\n\t\tlong long ret=(1LL<<62);\n\t\tfor(int i=0;i<sz;i++){\n\t\t\tlong long tmp=0;\n\t\t\tlong long now=val;\n\t\t\twhile(now){\n\t\t\t\ttmp+=now/p[i];\n\t\t\t\tnow/=p[i];\n\t\t\t}\n\t\t\tret=min(ret,tmp/q[i]);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> void chmin(T1 &a,T2 b){if(a>b) a=b;};\ntemplate<typename T1,typename T2> void chmax(T1 &a,T2 b){if(a<b) a=b;};\n\n\nsigned main(){\n  Int n;\n  string s;\n  \n  while(cin>>n>>s,n){\n    using ull = unsigned long long;\n    ull m=0;\n\n    auto calc=[](char c){if(isdigit(c)) return c-'0';return c-'A'+10;};\n  \n    for(Int i=0;i<(Int)s.size();i++){\n      m=m*n+calc(s[i]);\n    }\n\n    using P = pair<Int, Int>;\n    vector<P> vp;\n    Int k=n;\n    for(Int i=2;i<=50;i++){\n      if(k%i) continue;\n      vp.emplace_back(i,0);\n      while(k%i==0) k/=i,vp.back().second++;\n    }\n  \n    ull ans=m;\n\n    for(auto p:vp){\n      ull k=p.first;\n      ull res=0;\n      while(k<=m){\n\tres+=m/k;\n\tif(k>=ULLONG_MAX/p.first-1) break;\n\tk*=p.first;\n      }\n      chmin(ans,res/p.second);\n    }\n  \n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#define int long long\n#define INF 1e+18\nusing namespace std;\n\nsigned main(){\n\tint n,tmp = 0;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\ttmp = 0;\n\tfor(int i = 0;i < m.length();i++){\n\t\tif('0' <= m[i] && m[i] <= '9'){\n\t\t\ttmp = tmp * n + m[i] - '0';\n\t\t}else {\n\t\t\ttmp = tmp * n + 10 + m[i] - 'A';\n\t\t}\n\t}\n\tmap<int,int> insuu;\n\tfor(int i = 2;i * i <= n;i++){\n\t\twhile(n % i == 0) {\n\t\t\tinsuu[i]++;\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) insuu[n]++;\n\tint mi = INF;\n\tfor(auto it = insuu.begin();it != insuu.end();it++){\n\t\tint t = tmp,cnt = 0;\n\t\twhile(t){\n\t\t\tcnt += t / it->first;\n\t\t\tt /= it->first;\n\t\t}\n\t\tmi = min(mi,cnt / it->second);\n\t}\n\tcout << mi << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint d; char s[13];\nint p[11] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\nint main() {\n\twhile (scanf(\"%d%s\", &d, s), d) {\n\t\tlong long v = 0;\n\t\tfor (int i = 0; i < strlen(s); i++) v = v * d + (s[i] <= '9' ? s[i] - 48 : s[i] - 55);\n\t\tlong long ret = 9191919191919191919;\n\t\tfor (int i = 0; i < 11 && p[i] <= d; i++) {\n\t\t\tint e = 0, f = d;\n\t\t\twhile (f % p[i] == 0) f /= p[i], e++;\n\t\t\tif (e) {\n\t\t\t\tlong long w = v, x = 0;\n\t\t\t\twhile (w) w /= p[i], x += w;\n\t\t\t\tret = min(ret, x / e);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\", ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//28\n#include<iostream>\n#include<cctype>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  int m;\n  char n[13];\n  while(cin>>m>>n,m){\n    long long nd=0;\n    for(int i=0;n[i];i++){\n      nd*=m;\n      nd+=isdigit(n[i])?n[i]-'0':n[i]-'A'+10;\n    }\n    long long t=1LL<<62;\n    int mt=m;\n    for(int i=2;i<=36;i++){\n      int p=0;\n      while(mt%i==0){\n\tp++;\n\tmt/=i;\n      }\n      if(p){\n\tlong long tn=nd;\n\tlong long np=0;\n\twhile(tn){\n\t  tn/=i;\n\t  np+=tn;\n\t}\n\tt=min(t,np/p);\n      }\n    }\n    cout<<t<<endl;\n  }\n  return 0;\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef unsigned long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\nmap<ll, ll> factorize(ll n) {  // O(ツ」n)\n  map<ll, ll> res;\n  for (int i=2; i*i<=n; ++i) {\n    int cnt = 0;\n    while (n%i==0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt) {\n      res[i] = cnt;\n    }\n  }\n  if (n!=1) res[n] = 1;\n  return res;\n}\n\nint main() {\n  int N; string M;\n  while(cin >> N >> M, N) {\n    ll num = strtoll(M.c_str(), NULL, N);\n    //cout << num << endl;\n    map<ll, ll> factor = factorize(N);\n    ll ans = 1LL<<62;\n    FOR(it, factor) {\n      ll now = it->first;\n      ll cnt = 0;\n      while(1) {\n        cnt += num / now;\n        if (now>(double)num/it->first+EPS) break;\n        now *= it->first;\n      }\n      //cout << it->first << \" \" << it->second << \" \" << cnt << endl;\n       ans = min(ans, cnt/it->second);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 37;\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\null convtodec(string t, ull B){\n  ull ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\null ipow(ull t, int p){\n  ull ret = 1;\n  for(int i = 0; i < p; ++i){\n    ret *= t;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  ull N,B;\n  ull base;\n  string num;\n  while(cin>>base>>num){\n    if( base == 0 ) break;\n    if( base == 0 && num[0] == '0' ) break;\n\n    N = convtodec(num,base);\n    B = base;\n\n    //cout << N << ' ' << B << endl;\n\n    ull num[vprimes.size()];\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      num[i] = 0;\n      int maxpow = 1;\n      while(N>=ipow(vprimes[i],maxpow)){\n\t++maxpow;\n      }\n      --maxpow;\n\n      ull presum = 0;\n      for(int p = maxpow; p >= 1; --p){\n\tull tnum = (N / ipow(vprimes[i],p)) - presum;\n\tpresum += tnum;\n\tnum[i] += p * tnum;\n      }\n      //cout << vprimes[i] << ' ' << num[i] << endl;\n    }\n\n    ull res = 1LL<<62;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      int e = 0;\n      ull tB = B;\n      while(tB % vprimes[i] == 0){\n\t++e;\n\ttB /= vprimes[i];\n      }\n      if( e > 0 ){\n\tres = min(res, num[ i ] / e);\n      }\n    }\n    if( res == 1LL<<62 ) res = 0;\n\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<stack>\n#include<map>\n#include<set>\n#include<queue>\n#include<cstdio>\n#include<climits>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<sstream>\n#include<numeric>\n#include<cassert>\n\n#define f first\n#define s second\n#define mp make_pair\n\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n#define rep(i,s,n) for(int i=(s); i<(int)(n); i++)\n#define FOR(i,c) for(__typeof((c).begin()) i=(c).begin(); i!=(c).end(); i++)\n#define ALL(c) (c).begin(), (c).end()\n#define IN(x,s,g) ((x) >= (s) && (x) < (g))\n#define ISIN(x,y,w,h) (IN((x),0,(w)) && IN((y),0,(h)))\n#define print(x) printf(\"%d\\n\",x)\n\nusing namespace std;\n\ntypedef unsigned int uint;\ntypedef unsigned long long ll;\n\nconst int _dx[] = {0,1,0,-1};\nconst int _dy[] = {-1,0,1,0};\n\nint getInt(){\n  int ret = 0,c;\n  c = getchar();\n  while(!isdigit(c)) c = getchar();\n  while(isdigit(c)){\n    ret *= 10;\n    ret += c - '0';\n    c = getchar();\n  }\n  return ret;\n}\n\ninline int toInt(char c){\n  if(isdigit(c)) return c - '0';\n  return c - 'A' + 10;\n}\n\nll decode(char *num, int base){\n  ll ret = 0;\n  while(*num){\n    ret *= base;\n    ret += toInt(*num++);\n  }\n  return ret;\n}\n\nint main(){\n  int base;\n  char num[32];\n\n  while(scanf(\"%d%s\",&base,num),base){\n    ll dec = decode(num, base);\n    int ans = INT_MAX;\n\n    for(int d = 2; ; d++){\n      if(base % d == 0){\n        int cnt = 0;\n        while(base % d == 0){\n          base /= d;\n          cnt++;\n        }\n\n        ll tmp = dec;\n        int a = 0;\n        while(tmp){\n          tmp /= d;\n          a += tmp;\n        }\n        ans = min(ans, a/cnt);\n        //printf(\"dec:%lld d:%d cnt:%d base:%d a:%d\\n\",dec,d,cnt,base,a);\n      }\n\n      if(base == 1) break;\n    }\n\n    print(ans);\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n \nusing namespace std;\n \ntypedef unsigned long long ll;\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i]);\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  long double end = num;\n  long double now = base;\n  ll res = 0;\n  ll b = base;\n  while(now <= end){\n    res += num/b;\n    if(num/base+1 < b) break;\n    b *= base;\n    now *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n  while(cin >> N >> M && N){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])\n\t-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n    \n    \n    \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n    \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nvector<pair<int, int> > PrimeFactor(int n) {\n  vector<pair<int, int> > ret;\n  FOREQ(i, 2, n) {\n    int cnt = 0;\n    while (n % i == 0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt != 0) {\n      ret.push_back(make_pair(i, cnt));\n    }\n  }\n  return ret;\n}\n\nll calc(ll m, ll v) {\n  if (m < v) { return 0; }\n  return m / v + calc(m / v, v);\n}\n\nll convert(string s, ll base) {\n  ll ret = 0;\n  FORIT(it, s) {\n    ll v = 0;\n    if (isdigit(*it)) { v = *it - '0'; }\n    else { v = *it - 'A' + 10; }\n    ret = ret * base + v;\n  }\n  return ret;\n}\n\nll n;\nstring str;\nint main() {\n  while (cin >> n >> str, n) {\n    ll m = convert(str, n);\n    vector<pair<int, int> > factor = PrimeFactor(n);\n    ll ans = 1LL << 60;\n    FORIT(it, factor) {\n      ans = min(ans, calc(m, it->first) / it->second);\n    }\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main()\n{\n\tunsigned long long b; string str;\n\twhile(cin >> b >> str, b||str!=\"0\")\n\t{\n\t\tunsigned long long m=0;\n\t\tfor(int i=0; i<str.size(); i++)\n\t\t{\n\t\t\tm*=b;\n\t\t\tif('0'<=str[i] && str[i]<='9') m+=(str[i]-'0');\n\t\t\tif('A'<=str[i] && str[i]<='Z') m+=(str[i]-'A'+10);\n\t\t}\n\n\t\tunsigned long long a=0,d=1;\n\t\tfor(int i=0; i<26; i++)\n\t\t{\n\t\t\td*=5; a+=(m/d);\n\t\t}\n\t\tcout << a << endl;\n\t}\n\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint N, M;\n\nint count[32];\n\nvoid count_prime(int M, int prime) {\n    while (M % prime == 0) {\n        M /= prime;\n        count[prime]++;\n    }\n}\n\nint to_i(string s) {\n    int n = 0;\n    for (int i = 0; i < s.size(); i++) {\n        if (isdigit(s[i])) {    \n            n = n * N + (s[i] - '0');\n        } else {\n            n = n * N + (s[i] - 'A' + 10);\n        }\n    }\n    return n;\n}\n\nint main() {\n    string M_;\n    while (cin >> N >> M_) {\n        if (N == 0 && M_ == \"0\") break;\n        M = to_i(M_);\n        memset(count, 0, sizeof(count));\n        for (int i = M; i > 0; i--) {\n            count_prime(i, 2);\n            count_prime(i, 3);\n            count_prime(i, 5);\n            count_prime(i, 7);\n            count_prime(i, 11);\n            count_prime(i, 13);\n            count_prime(i, 17);\n            count_prime(i, 19);\n            count_prime(i, 23);\n            count_prime(i, 29);\n            count_prime(i, 31);\n        }\n        int ans = 0;\n        switch (N) {\n            case 8:\n                ans = count[2] / 3;\n                break;\n            case 9:\n                ans = count[3] / 2;\n                break;\n            case 10:\n                ans = min(count[2], count[5]);\n                break;\n            case 11:\n                ans = count[11];\n                break;\n            case 12:\n                ans = min(count[2] / 2, count[3]);\n                break;\n            case 13:\n                ans = count[13];\n                break;\n            case 14:\n                ans = min(count[2], count[7]);\n                break;\n            case 15:\n                ans = min(count[3], count[5]);\n                break;\n            case 16:\n                ans = count[2] / 4;\n                break;\n            case 17:\n                ans = count[17];\n                break;\n            case 18:\n                ans = min(count[2], count[3] / 2);\n                break;\n            case 19:\n                ans = count[19];\n                break;\n            case 20:\n                ans = min(count[2] / 2, count[5]);\n                break;\n            case 21:\n                ans = min(count[3], count[7]);\n                break;\n            case 22:\n                ans = min(count[2], count[11]);\n                break;\n            case 23:\n                ans = count[23];\n                break;\n            case 24:\n                ans = min(count[2] / 3, count[3]);\n                break;\n            case 25:\n                ans = count[5] / 2;\n                break;\n            case 26:\n                ans = min(count[2], count[13]);\n                break;\n            case 27:\n                ans = count[3] / 3;\n                break;\n            case 28:\n                ans = min(count[2] / 2, count[7]);\n                break;\n            case 29:\n                ans = count[29];\n                break;\n            case 30:\n                ans = min(min(count[2], count[3]), count[5]);\n                break;\n            case 31:\n                ans = count[31];\n                break;\n            case 32:\n                ans = count[2] / 5;\n                break;\n            case 33:\n                ans = min(count[3], count[11]);\n                break;\n            case 34:\n                ans = min(count[2], count[17]);\n                break;\n            case 35:\n                ans = min(count[5], count[7]);\n                break;\n            case 36:\n                ans = min(count[2] / 2, count[3] / 2);\n                break;\n        }\n        cout << ans << endl;\n//        for (int i = 0; i < 36; i++) {\n//            cout << count[i] << ' ';\n//        }\n//        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\n//ifstream ifs(\"input.txt\");\n//ofstream ofs(\"output.txt\");\n//#define cin ifs\n//#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tif(a==2){\n\t\t\t\twhile(a<=m){\n\t\t\t\t\tcnt+=(m/a);\n\t\t\t\t\ta*=it->first;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint loop=(log((long double)m)/log((long double)a)+0.0001);\n\t\t\t\twhile(loop--){\n\t\t\t\t\tcnt+=(m/a);\n\t\t\t\t\ta*=it->first;\n\t\t\t\t}\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    memset(prime_factor,0,sizeof(prime_factor));\n    for(int i = 2; i * i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        prime_factor[base / i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int NUM_P = 11;\nconst int pnums[NUM_P] = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31};\n\nconst unsigned long long LINF = ~1ULL;\n\n/* typedef */\n\ntypedef pair<int,int> pii;\ntypedef unsigned long long ull;\ntypedef vector<pii> vpii;\n\n/* global variables */\n\nint n;\null m;\n\n/* subroutines */\n\ninline int ch2int(char ch) {\n  if (ch >= '0' && ch <= '9') return ch - '0';\n  return ch - 'A' + 10;\n}\n\nvoid prime_decomp(int k, vpii& pds) {\n  pds.clear();\n\n  for (int pi = 0; k > 1; pi++) {\n    int pn = pnums[pi];\n    if (k % pn == 0) {\n      int fi = 0;\n      while (k % pn == 0)\n\tk /= pn, fi++;\n      pds.push_back(pii(pn, fi));\n    }\n  }\n}\n\nvoid print_pds(vpii& pds) {\n  for (int i = 0; i < pds.size(); i++) {\n    if (i > 0) cout << '*';\n    cout << pds[i].first << '^' << pds[i].second;\n  }\n  cout << endl;\n}\n\n/* main */\n\nint main() {\n  for (;;) {\n    cin >> n;\n    if (n == 0) break;\n\n    string mstr;\n    cin >> mstr;\n\n    m = 0;\n    for (int i = 0; i < mstr.length(); i++)\n      m = m * n + ch2int(mstr[i]);\n    //cout << m << endl;\n\n    vpii pds;\n    prime_decomp(n, pds);\n    //print_pds(pds);\n\n    ull min_numz = LINF;\n    \n    for (int i = 0; i < pds.size(); i++) {\n      int pn = pds[i].first;\n      ull pns = 0;\n      for (ull pexp = pn; pexp <= m; pexp *= pn)\n\tpns += m / pexp;\n      //printf(\"%lld: %d = %lld\\n\", m, pn, pns);\n\n      ull numz = pns / pds[i].second;\n      if (min_numz > numz) min_numz = numz;\n    }\n\n    cout << min_numz << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nsigned main(){\n  int n;\n  string m;\n  while(cin>>n>>m,n){\n    int res=0;\n    for(int i=0;i<(int)m.size();i++){\n      res*=n;\n      if(isdigit(m[i])) res+=m[i]-'0';\n      else res+=m[i]-'A'+10;\n    }\n    int ans=1LL<<60LL;\n    int k=n;\n    for(int i=2;i<=n;i++){\n      if(k%i) continue;\n      int tmp=0,r=0;\n      while(k%i==0) k/=i,r++;\n      for(int j=i;j<=res;j*=i)\n\ttmp+=res/j;\n      ans=min(ans,tmp/r);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    memset(prime_factor,0,sizeof(prime_factor));\n    for(int i = 2; i * i <= base; i++){\n      while(base != 0 && base % i == 0){\n        prime_factor[i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nint string_to_int(char);\n\nint main(){\n\tint base;\n\tlong long int num,kaijyou;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number && (base != 0 || number != \"0\")){\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\tnum += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k]){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k] != 0){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min > fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//ツつアツづ個陛サツ法ツつセツづオツーツバツーツフツδ債ー\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\tif(min == num){\n\t\t\tmin = 0;\n\t\t}\n\t\tcout << min << endl;\n\t}\n}\n\nint string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#define int long long\n#define INF 1e+18\nusing namespace std;\n\nsigned main(){\n\tint n,tmp = 0;\n\tstring m;\n\twhile(cin >> n >> m,n){\n\ttmp = 0;\n\tfor(int i = 0;i < m.length();i++){\n\t\tif('0' <= m[i] && m[i] <= '9'){\n\t\t\ttmp = tmp * n + m[i] - '0';\n\t\t}else {\n\t\t\ttmp = tmp * n + 10 + m[i] - 'A';\n\t\t}\n\t}\n\tmap<int,int> insuu;\n\tfor(int i = 2;i * i <= n;i++){\n\t\twhile(n % i == 0) {\n\t\t\tinsuu[i]++;\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) insuu[n]++;\n\tint mi = INF;\n\tfor(auto it = insuu.begin();it != insuu.end();it++){\n\t\tint t = tmp,cnt = 0;\n\t\twhile(t){\n\t\t\tcnt += t / it->first;\n\t\t\tt /= it->first;\n\t\t}\n\t\tmi = min(mi,cnt / it->second);\n\t}\n\tcout << mi << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll b = 1;\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i])*b;\n    b *= base;\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  long double end = num;\n  long double now = base;\n  ll res = 0;\n  ll b = base;\n  while(now <= end){\n    res += num/b;\n    if(num/base < b) break;\n    b *= base;\n    now *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n\n  while(cin >> N >> M && N && M != \"0\"){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n\n   \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n   \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\n\nint PRIMES_COUNT = 11;\nint PRIMES[] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\n\nint main(){\n\twhile(true){\n\t\tint base;\n\t\tstring digits;\n\t\tcin >> base >> digits;\n\t\tif(base == 0){ break; }\n\t\tll w = 1ll, input = 0;\n\t\tfor(int i = digits.size() - 1; i >= 0; --i, w *= base){\n\t\t\tif('0' <= digits[i] && digits[i] <= '9'){\n\t\t\t\tinput += (digits[i] - '0') * w;\n\t\t\t}else{\n\t\t\t\tinput += (digits[i] - 'A' + 10) * w;\n\t\t\t}\n\t\t}\n\t\tvector<ll> counts(PRIMES_COUNT, 0);\n\t\tfor(int i = 0; i < PRIMES_COUNT; ++i){\n\t\t\tll tmp = input;\n\t\t\twhile(tmp >= PRIMES[i]){\n\t\t\t\ttmp /= PRIMES[i];\n\t\t\t\tcounts[i] += tmp;\n\t\t\t}\n\t\t}\n\t\tll result = 0x7fffffffffffffffll;\n\t\tfor(int i = 0; i < PRIMES_COUNT; ++i){\n\t\t\tint tmp = base, div = 0;\n\t\t\twhile(tmp % PRIMES[i] == 0){\n\t\t\t\ttmp /= PRIMES[i];\n\t\t\t\t++div;\n\t\t\t}\n\t\t\tif(div != 0){ result = min(result, counts[i] / div); }\n\t\t}\n\t\tcout << result << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdlib>\n#include <climits>\nusing namespace std;\n\ntypedef unsigned long long ll;\n\nint main(void){\n\tint N;\n\tstring M;\n\n\twhile(cin>>N>>M, N){\n\t\tll m = strtoll(&M[0],NULL,N);\n\t\tint n = N;\n\t\tvector<int> v,s;\n\n\t\tfor(int i=2;i<=n;i++){\n\t\t\tif(n % i != 0) continue;\n\n\t\t\tv.push_back(i);\n\t\t\ts.push_back(0);\n\t\t\twhile(n % i == 0){\n\t\t\t\ts[v.size()-1]++;\n\t\t\t\tn /= i;\n\t\t\t}\n\t\t}\n\n\t\tll ans = ULLONG_MAX;\n\t\tfor(int i=0;i<v.size();i++){\n\t\t\tll tmp = m;\n\t\t\tll zero = 0;\n\t\t\twhile(tmp /= v[i]) zero += tmp;\n\t\t\tans = min(ans,zero/s[i]);\n\t\t}\n\n\t\tcout<<ans<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nlong long int string_to_int(char);\nlong long int power(int,int);\n\nint main(){\n\tint base;\n\tlong long int num;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number){\n\t\tif(base == 0 && number == \"0\") break;\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\t//num += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\tnum += power(base,j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\t//baseÉ½ÂÌföª é©¨è\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k] != 0){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\t//for(;count_prime[k]>0;count_prime[k]--){\n\t\t\t\twhile(num_copy / prime[k] != 0){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min >= fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t\t//cout << min << \" new_min \" << endl;\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//±Ìû@¾ÆI[o[t[\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\t/*if(min == num){\n\t\t\tmin = 0;\n\t\t}*/\n\t\tcout << min << endl;\n\t}\n}\n\nlong long int string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(long long int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}\n\nlong long int power(int a,int b){\n\tif(b == 0){\n\t\treturn 1;\n\t}\n\telse{\n\t\tlong long int t=1;\n\t\tfor(int k = 0;k<b;k++){\n\t\t\tt *= a;\n\t\t}\n\t\treturn t;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\n#include<algorithm>\n \nusing namespace std;\n \ntypedef unsigned long long ll;\n\nll toNum(char c){\n  if(c >= 'A') return c-'A'+10;\n  return c-'0';\n}\n\nll convert(const string& s, ll base){\n  ll res = 0;\n  for(int i = 0; i < (int)s.length(); i++){\n    res *= base;\n    res += toNum(s[i]);\n  }\n  return res;\n}\n\nvector<int> prime_factor(int n){\n  vector<int> res;\n  for(int i = 2; i*i <= n; i++){\n    while(n % i == 0){\n      res.push_back(i);\n      n /= i;\n    }\n  }\n  if(n != 1) res.push_back(n);\n  sort(res.begin(),res.end());\n  return res;\n}\n\nll find(ll num, ll base){\n  long double end = num;\n  long double now = base;\n  ll res = 0;\n  ll b = base;\n  while(now <= end){\n    res += num/b;\n    if(num/base+1 < b) break;\n    b *= base;\n    now *= base;\n  }\n  return res;\n}\n\nvector<int> make(int N){\n  vector<int> v = prime_factor(N);\n  v.erase(unique(v.begin(),v.end()), v.end());\n  return v;\n}\n\nint main(){\n  int N;\n  string M;\n  while(cin >> N >> M && N){\n    vector<int> v = prime_factor(N);\n    vector<int> prime = make(N);\n    vector<ll> need(prime.size(), 0);\n    \n    for(int i = 0; i < (int)prime.size(); i++){\n      need[i] = upper_bound(v.begin(),v.end(),prime[i])\n\t-lower_bound(v.begin(),v.end(),prime[i]);\n    }\n    \n    \n    \n    vector<ll> have(prime.size(),0);\n    ll tmp = convert(M,N);\n    for(int i = 0; i < (int)prime.size(); i++){\n      have[i] = find(tmp, prime[i]);\n    }\n    \n    for(int i = 0; i < (int)prime.size(); i++) have[i]/=need[i];\n    ll ans = have[0];\n    for(int i = 0; i < (int)prime.size(); i++) ans = min(ans, have[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <climits>\nusing namespace std;\n\nunsigned long long to(string w , int base){\n\tunsigned long long ans = 0;\n\tfor(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n\treturn ans;\n}\n\nmap<int,int> factor(int n){\n\tmap<int,int> w;\n\tfor(int i = 2 ; i*i<=n ; i++)\n\t\twhile(n%i==0) w[i]++ , n /= i;\n\tif(n!=1) w[n]++;\n\treturn w;\n}\nint main(){\n\tint n;\n\tstring m;\n\twhile(cin >> n >> m && n){\n\t\tunsigned long long v = to(m,n) , ans = ULLONG_MAX;\n\t\tmap<int,int> r = factor(n);\n\t\tfor( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n\t\t\tint a = it->first;\n\t\t\tint d = it->second;\n\t\t\tunsigned long long t = v;\n\t\t\tunsigned long long ok = 0;\n\t\t\twhile(t){ ok += (t / a) ; t /= a;}\n\t\t\tans = min(ok / d , ans);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nP D(ll n) {\n  vector<P> v;\n  for(ll i=2; i*i<=n; i++) {\n    P p=P(0,i);\n    while(n%i==0) {\n      n/=i;\n      p.F++;\n    }\n    if(p.F) v.push_back(p);\n  }\n  if(n>1) v.push_back(P(1,n));\n  sort(v.begin(),v.end(),greater<P>());\n  return v[0];\n}\n\nll N(char c) {\n  if(isdigit(c)) return c-'0';\n  return (c-'A')+10;\n}\n\nll C(string s,ll n) {\n  ll x=0,y=1;\n  for(int i=s.size()-1; i>=0; i--) {\n    x+=N(s[i])*y;\n    y*=n;\n  }\n  return x;\n}\n\nint main() {\n  ll n;\n  string s;\n  while(cin >> n >> s && n) {\n    P p=D(n);\n    ll m=C(s,n);\n    ll ans=0,x=p.S;\n    while(1) {\n      ans+=m/x;\n      if(x*p.S>m||x*p.S/p.S!=x) break;\n      x*=p.S;\n    }\n    cout << ans/p.F << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<cassert>\n#include<climits>\n\n#define IINF (INT_MAX)\n#define ULLINF (ULLONG_MAX)\n\nusing namespace std;\n\ntypedef unsigned long long ull;\n\null N;\nstring M;\n\nmap<ull,int> prime_factor(ull n){\n  map<ull,int> res;\n  for(int i=2;i*i<=n;i++){\n    while(n % i == 0){\n      ++res[i];\n      n /= i;\n    }\n  }\n  if(n != 1ULL)res[n] = 1ULL;\n  return res;\n}\n\null StoULL(){\n  ull ret = 0;\n  for(int i=0;i<M.size();i++){\n    ret *= N;\n    ull tmp = (('0'<=M[i]&&M[i]<='9')?(M[i]-'0'):(M[i]-'A')+N);\n    ret += tmp;\n  }\n  return ret;\n}\n\null calc(ull value,ull pf)\n{\n  ull ret = 0;\n  while(value > 1){\n    ret += value / pf;\n    value /= pf;\n  }\n  return ret;\n}\n\nvoid compute(){\n  map<ull,int> ppf = prime_factor(N);\n  vector<ull> pf;\n\n  for(map<ull,int>::iterator it = ppf.begin() ; it != ppf.end() ; it++ ){\n    pf.push_back((it->first)*(it->second));\n  }\n\n  ull value = StoULL();\n  //cout << \"value = \" << value << endl;\n  ull ans = ULLINF;\n\n  for(int i=0;i<pf.size();i++){\n    ans = min(ans,calc(value,pf[i]));\n  }\n\n  cout << ans << endl;\n\n}\n\nint main(){\n  //cout << ULLINF << endl;\n  while(cin >> N >> M,(N!=0 || M!=\"0\")){\n\n    compute();\n\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <cstdlib>\n\nusing namespace std;\n\nlong long N, M;\n\nlong long count(int n) {\n    long long total = 0;\n    long long m = M;\n    while (m >= n) {\n        total += (m / n);\n        m /= n;\n    }\n    return total;\n}\n\nlong long to_l(string s) {\n    long long n = 0;\n    for (int i = 0; i < s.size(); i++) {\n        if (isdigit(s[i])) {    \n            n = n * N + (s[i] - '0');\n        } else {\n            n = n * N + (s[i] - 'A' + 10);\n        }\n    }\n    return n;\n}\n\nint main() {\n    string M_;\n    while (cin >> N >> M_) {\n        if (N == 0 && M_ == \"0\") break;\n        M = to_l(M_);\n        long long ans = 0;\n        switch (N) {\n            case 8:\n                ans = count(2) / 3;\n                break;\n            case 9:\n                ans = count(3) / 2;\n                break;\n            case 10:\n                ans = min(count(2), count(5));\n                break;\n            case 11:\n                ans = count(11);\n                break;\n            case 12:\n                ans = min(count(2) / 2, count(3));\n                break;\n            case 13:\n                ans = count(13);\n                break;\n            case 14:\n                ans = min(count(2), count(7));\n                break;\n            case 15:\n                ans = min(count(3), count(5));\n                break;\n            case 16:\n                ans = count(2) / 4;\n                break;\n            case 17:\n                ans = count(17);\n                break;\n            case 18:\n                ans = min(count(2), count(3) / 2);\n                break;\n            case 19:\n                ans = count(19);\n                break;\n            case 20:\n                ans = min(count(2)/2, count(5));\n                break;\n            case 21:\n                ans = min(count(3), count(7));\n                break;\n            case 22:\n                ans = min(count(2), count(11));\n                break;\n            case 23:\n                ans = count(23);\n                break;\n            case 24:\n                ans = min(count(2) / 3, count(3));\n                break;\n            case 25:\n                ans = count(5) / 2;\n                break;\n            case 26:\n                ans = min(count(2), count(13));\n                break;\n            case 27:\n                ans = count(3) / 3;\n                break;\n            case 28:\n                ans = min(count(2) / 2, count(7));\n                break;\n            case 29:\n                ans = count(29);\n                break;\n            case 30:\n                ans = min(min(count(2), count(3)), count(5));\n                break;\n            case 31:\n                ans = count(31);\n                break;\n            case 32:\n                ans = count(2) / 5;\n                break;\n            case 33:\n                ans = min(count(3), count(11));\n                break;\n            case 34:\n                ans = min(count(2), count(17));\n                break;\n            case 35:\n                ans = min(count(5), count(7));\n                break;\n            case 36:\n                ans = min(count(2) / 2, count(3) / 2);\n                break;\n        }\n        cout << ans << endl;\n//        for (int i = 0; i < 36; i++) {\n//            cout << count(i) << ' ';\n//        }\n//        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n      if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n    }    \n\n    ll ans=0;\n    for(long double i=5;i<=s+0.1;i*=5){\n      ans+=s/(ll)(i+0.1);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst ll INF = 1000000000000000000LL;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, ll> prime_factor(ll n){\n\tmap<ll, ll> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M,N){\n\t\tmap<ll, ll> factor = prime_factor(N);\n\t\tmap<ll, ll> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tll ans = INF;\n\t\tfor(map<ll,ll>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <climits>\n#include <string>\nusing namespace std;\n\nunsigned long long to(string w , int base){\n\tunsigned long long ans = 0;\n\tfor(int i = 0 ; i < w.size() ; i++) ans = ans * base + (w[i] >= 'A' ? w[i] - 'A' + 10 : w[i] - '0');\n\treturn ans;\n}\n\nmap<int,int> factor(int n){\n\tmap<int,int> w;\n\tfor(int i = 2 ; i*i<=n ; i++)\n\t\twhile(n%i==0) w[i]++ , n /= i;\n\tif(n!=1) w[n]++;\n\treturn w;\n}\n\nint main(){\n\tint n;\n\tstring m;\n\twhile(cin >> n >> m, n){\n\t\tunsigned long long v = to(m,n) , ans = -1;\n\t\tmap<int,int> r = factor(n);\n\t\tfor( map<int,int>::iterator it = r.begin() ; it != r.end() ; ++it){\n\t\t\tint a = it->first;\n\t\t\tint d = it->second;\n\t\t\tunsigned long long t = v;\n\t\t\tunsigned long long ok = 0;\n\t\t\twhile(t){ ok += (t / a) ; t /= a;}\n\t\t\tans = min(ok / d , ans);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1ULL;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] && fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long init = conv(base,fact);\n    unsigned long long prime_factor[37] = {};\n    for(int i = 2; i <= base; i++){\n      while(base % i == 0){\n        prime_factor[i]++;\n        base /= i;\n      }\n    }\n\n    unsigned long long res = numeric_limits<unsigned long long>::max();\n    for(unsigned long long i = 2; i <= 36; i++){\n      if(prime_factor[i] == 0) continue;\n      unsigned long long count = 0;\n      unsigned long long tmp = init;\n\n      while(tmp > 0){\n        count += tmp / i;\n        tmp /= i;\n      }\n      res = min(res,count / prime_factor[i]);\n    }\n\n    if(res == numeric_limits<unsigned long long>::max()) res = 0;    \n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nint N; string M;\nint p[50]; long long power[20];\nlong long div(long long k, int m) {\n\tlong long sum = 0;\n\twhile (k >= 1) {\n\t\tk /= m; sum += k;\n\t}\n\treturn sum;\n}\nint main() {\n\twhile (true) {\n\t\tcin >> N >> M; power[0] = 1;\n\t\tfor (int i = 0; i < 50; i++)p[i] = 0;\n\t\tfor (int i = 1; i < M.size(); i++)power[i] = power[i - 1] * N;\n\t\tif (N == 0)break;\n\t\tlong long C = 0;\n\t\tfor (int i = 0; i < M.size(); i++) {\n\t\t\tint V = (char)(M[i] - '0'); if (M[i] >= 'A')V = (char)(M[i] - 'A') + 10;\n\t\t\tC += power[M.size() - 1 - i] * V;\n\t\t}\n\t\tint L = N;\n\t\tfor (int i = 2; i <= L; i++) {\n\t\t\twhile (L%i == 0) {\n\t\t\t\tL /= i; p[i]++;\n\t\t\t}\n\t\t}\n\t\tlong long minx = 1LL << 62;\n\t\tfor (int i = 2; i <= N; i++) {\n\t\t\tif (p[i] == 0)continue;\n\t\t\tminx = min(minx, div(C, i) / p[i]);\n\t\t}\n\t\tcout << minx << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ll;\n\nint main(){\n  ll n;\n  string m;\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<m.size();i++){\n      if(isdigit(m[i]))s*=n,s+=m[i]-'0';\n      if(isalpha(m[i]))s*=n,s+=m[i]-'A'+10;\n    }\n    \n    ll ans=0;\n    for(ll i=5;1<=s/i;i*=5){\n      ans+=s/i;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include \"math.h\"\n\nusing namespace std;\n\nlong long int string_to_int(char);\nlong long int power(int,int);\n\nint main(){\n\tint base;\n\tlong long int num;\n\tstring number;\n\tlong int prime[11]={2,3,5,7,11,13,17,19,23,29,31};\n\tlong int count_prime[11],fact_prime[11];\n\t//0->2,1->3,...10->31\n\twhile(cin >> base >> number){\n\t\tif(base == 0 && number == \"0\") break;\n\t\t//cout << base << \" \" << number << endl;\n\t\tint length = number.length();\n//\t\tfor(int i=0;i<length;i++){\n//\t\t\tcout << string_to_int(number[i]) << endl;\n//\t\t}\n//\t\tcout << length << endl;\n\t\tnum = 0;\n\t\tfor(int j=length;j>0;j--){\n\t\t\t//cout << number[length-j-1] << \"---\" << pow(double(base),j) << endl;\n\t\t\t//num += pow(double(base),j-1)*string_to_int(number[length-j]);\n\t\t\tnum += power(base,j-1)*string_to_int(number[length-j]);\n\t\t\t//cout << num << endl;\n\t\t}\n\t\t//cout << num << endl;\n\t\t\n\t\t\n\t\tint base_copy = base;\n\t\tlong long int min = num;\n\n\t\tfor(int k=0;k<11;k++){\n\t\t\tcount_prime[k] = 0;\n\t\t\t//baseÉ½ÂÌföª é©¨è\n\t\t\twhile(base_copy%prime[k] == 0){\n\t\t\t\t++count_prime[k];\n\t\t\t\tbase_copy /= prime[k];\n\t\t\t\t//cout << base_copy << endl;\n\t\t\t}\n\t\t\tif(count_prime[k] != 0){\n\t\t\t\tfact_prime[k] = 0;\n\t\t\t\tlong long int num_copy = num;\n\t\t\t\twhile(num_copy / prime[k] != 0){\n\t\t\t\t\tfact_prime[k] += num_copy/prime[k];\n\t\t\t\t\tnum_copy /= prime[k];\n\t\t\t\t\t//cout << \n\t\t\t\t}\n\t\t\t\tif(min >= fact_prime[k]/count_prime[k]){\n\t\t\t\t\tmin = fact_prime[k]/count_prime[k];\n\t\t\t\t\t//cout << min << \" new_min \" << endl;\n\t\t\t\t}\n\t\t\t\t//cout << k << \" \" << fact_prime[k]/count_prime[k] << endl;\n\t\t\t}\n\t\t\t//cout << k << \" \" << count_prime[k] << endl;\n\t\t}\n\t\t//±Ìû@¾ÆI[o[t[\n\t\t/*kaijyou = 1;\n\t\tint count = 0;\n\t\tfor(long long int k=1;k<num;k++){\n\t\t\tkaijyou *= k;\n\t\t\twhile(kaijyou % base == 0 && kaijyou != 0){\n\t\t\t\tkaijyou /= base;\n\t\t\t\t++count;\n\t\t\t\tcout << kaijyou << \" \" << k << endl;\n\t\t\t}\n\t\t}*/\n\t\t/*if(min == num){\n\t\t\tmin = 0;\n\t\t}*/\n\t\tcout << min << endl;\n\t}\n}\n\nlong long int string_to_int(char letter){\n\tchar letters[36] = {'0','1','2','3','4','5','6','7','8','9',\n\t\t'A','B','C','D','E','F','G','H','I','J','K','L','M','N',\n\t\t'O','P','Q','R','S','T','U','V','W','X','Y','Z'};\n\tfor(long long int i=0;i<36;i++){\n\t\tif(letter == letters[i]){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 0;\n}\n\nlong long int power(int a,int b){\n\tif(b == 0){\n\t\treturn 1;\n\t}\n\telse{\n\t\tlong long int t=1;\n\t\tfor(int k = 0;k<b;k++){\n\t\t\tt *= a;\n\t\t}\n\t\treturn t;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <cmath>\n#include <cctype>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint ctoi(char c) {\n  if(isdigit(c)) {\n    return c - '0';\n  } else {\n    return toupper(c) - 'A' + 10;\n  }\n}\n\n\nint N;\nstring M;\nbool isPrime[10000];\nvector<int> prime;\n\nvoid makePrime() {\n  prime.clear();\n  fill(isPrime, isPrime+10000, true);\n  isPrime[0] = isPrime[1] = false;\n  for(int i = 2; i < 10000; ++i) {\n    if(!isPrime[i]) continue;\n    prime.push_back(i);\n    for(int j = i*2; j < 10000; j += i) isPrime[j] = false;\n  }\n}\n\nint pow(int n, int x) {\n  return (int)(pow((double)n, (double)x)+0.5);\n}\n\nint nto10() {\n  int res = 0;\n  for(int i = 0; i < M.length(); ++i) {\n    res += ctoi(M[i]) * pow(N, M.length()-1-i);\n  }\n  return res;\n}\n\nvoid calc(int n, int v[50]) {\n  int pos = 0;\n  if(n == 1 || n == 0) return;\n  while(!isPrime[n]) {\n    if(n % prime[pos] != 0) {\n      ++pos;\n      continue;\n    }\n    if(prime[pos] < 50) ++v[prime[pos]];\n    n /= prime[pos];\n  }\n  if(n < 50) ++v[n];\n}\n\nvoid solve() {\n  int m = nto10();\n  int v[50];\n  fill(v, v+50, 0);\n  calc(N, v);\n  int cnt[50];\n  fill(cnt, cnt+50, 0);\n  for(int i = m; i >= 1; --i) {\n    calc(i, cnt);\n  }\n\n  int ans = 9999999;\n\n  for(int i = 2; i < 50; ++i) {\n    if(v[i] == 0) continue;\n    ans = min(ans, cnt[i]/v[i]);\n  }\n  cout << ans << endl;\n}\n\nmain() {\n  makePrime();\n  while((cin >> N >> M)) {\n    if(N == 0 && M == \"0\") break;\n    solve();\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <fstream>\n#include <cmath>\n\nusing namespace std;\n\ntypedef unsigned long long ll;\nconst ll INF=18000000000000000000ULL;\n\nifstream ifs(\"input.txt\");\nofstream ofs(\"output.txt\");\n#define cin ifs\n#define cout ofs\n\nmap<int,int> prime_decompos(int a){\n\tmap<int,int> res;\n\tfor(int i=2;i*i<=a;i++){\n\t\tif(a%i==0){\n\t\t\tres[i]++;\n\t\t\ta/=i;\n\t\t\ti--;\n\t\t}\n\t}\n\tif(a!=1)res[a]++;\n\treturn res;\n}\n\nint main(){\n\tint n;\n\tll m;\n\tstring str;\n\twhile(cin>>n>>str&&!(n==0&&str==\"0\")){\n\t\tll mul=1;\n\t\tm=0;\n\t\tfor(int i=str.size()-1;i>=0;i--){\n\t\t\tll a=str[i]-'0';\n\t\t\tif(str[i]>='A'&&str[i]<='Z')a=10+str[i]-'A';\n\t\t\tm+=a*mul;\n\t\t\tmul*=n;\n\t\t}\n\t\tif(m==0){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<int,int> np=prime_decompos(n);\n\t\tll res=INF;\n\t\tfor(map<int,int>::iterator it=np.begin();it!=np.end();it++){\n\t\t\tll a=it->first;\n\t\t\tint b=it->second;\n\t\t\tll cnt=0;\n\t\t\tint loop=(log((long double)m)/log((long double)a)+(1e-10));\n\t\t\twhile(loop--){\n\t\t\t\tcnt+=(m/a);\n\t\t\t\ta*=it->first;\n\t\t\t}\n\t\t\tres=min(res,cnt/b);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, int> prime_factor(ll n){\n\tmap<ll, int> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nll convert(string M, int N){\n\tll res = 0;\n\tREP(i,M.size()){\n\t\tif(isdigit(M[i])){\n\t\t\tres = res * N + (M[i]-'0');\n\t\t}else{\n\t\t\tres = res * N + (M[i]-'A'+10);\n\t\t}\n\t}\n\treturn res;\n}\n\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tmap<ll, int> factor = prime_factor(N);\n\t\tmap<ll, int> cnt;\n\t\tll L = convert(M, N);\n\t\tint ans = INF;\n\t\tfor(map<ll,int>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n \nvector<P> D(ll n) {\n  vector<P> v;\n  for(ll i=2; i*i<=n; i++) {\n    P p=P(0,i);\n    while(n%i==0) {\n      n/=i;\n      p.F++;\n    }\n    if(p.F) v.push_back(p);\n  }\n  if(n>1) v.push_back(P(1,n));\n  return v;\n}\n \nll N(char c) {\n  if(isdigit(c)) return c-'0';\n  return (c-'A')+10;\n}\n \nll C(string s,ll n) {\n  ll x=0,y=1;\n  for(int i=s.size()-1; i>=0; i--) {\n    x+=N(s[i])*y;\n    y*=n;\n  }\n  return x;\n}\n \nint main() {\n  ll n;\n  string s;\n  while(cin >> n >> s && n) {\n    vector<P> v=D(n);\n    ll m=C(s,n),ans=1LL<<62;\n    for(int i=0; i<v.size(); i++) {\n      P p=v[i];\n      ll z=0,x=p.S;\n      while(1) {\n        z+=m/x;\n        if(x*p.S>m||x*p.S/p.S!=x) break;\n        x*=p.S;\n      }\n      ans=min(ans,z/p.F);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(ll i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\nint main(){\n\tll n,m,mxdiv,divprime,ans; string b;\n\tbool p[99]={0}; for(ll i=2;i*i<=99;i++)if(!p[i])for(ll j=i+i;j<=99;j+=i)p[j]=1;\n\twhile(cin>>n>>b,n){\n\t\tmxdiv=m=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tcerr<<\"n= \"<<n<<\" ,m=\"<<m<<endl;\n\t\tfor(ll i=n;i>1;i--)if(!p[i]&&n%i==0){\n\t\t\tll div=i;\n\t\t\twhile(n%(div*i)==0)div*=i;\n\t\t\tif(mxdiv<div)mxdiv=div,divprime=i;\n\t\t}\n\t\tcerr<<\"mxdiv= \"<<mxdiv<<endl;\n\t\tans=0;\n\t\tfor(ll i=divprime;i<=m;i*=divprime)ans+=m/i;\n\t\tll multime=1;for(ll i=divprime;i<mxdiv;multime++)i*=divprime;\n\t\tcerr<<\"ans= \"<<ans<<\" ,multime= \"<<multime<<endl;\n\t\t\n\t\tcout<<ans/multime<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nunsigned long long ctoll(char);\nunsigned long long rj(unsigned long long,unsigned long long,unsigned long long) ;\n\nint main(){\n  while(1){\n    unsigned long long n;\n    string m;\n    cin >> n >> m;\n    if(n==0&&m==\"0\")break;\n    unsigned long long a=0;\n    unsigned long long c=0;\n    for(unsigned long long i=m.size()-1,j=0;;i--,j++){\n      a+=rj(ctoll(m[i]),n,j);\n      if(i==0)break;\n    }\n    for(unsigned long long i=5;;i*=5){\n      c+=a/i;\n      if(a/5+4<i)break;\n    }\n    cout << c << endl;\n  }\n  return 0;\n}\nunsigned long long ctoll(char ch){\n  if(ch>='0'&&ch<='9')return ch-'0';\n  return ch-'A'+10;\n}\n\nunsigned long long rj(unsigned long long x,unsigned long long a,unsigned long long b){\n  unsigned long long y=1;\n  for(unsigned long long i=0;i<b;i++){\n    y*=a;\n  }\n  return y*=x;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\n\nint PRIMES_COUNT = 11;\nint PRIMES[] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\n\nint main(){\n\twhile(true){\n\t\tint base;\n\t\tstring digits;\n\t\tcin >> base >> digits;\n\t\tif(base == 0){ break; }\n\t\tll w = 1ll, input = 0;\n\t\tfor(int i = digits.size() - 1; i >= 0; --i, w *= base){\n\t\t\tif('0' <= digits[i] && digits[i] <= '9'){\n\t\t\t\tinput += (digits[i] - '0') * w;\n\t\t\t}else{\n\t\t\t\tinput += (digits[i] - 'A' + 10) * w;\n\t\t\t}\n\t\t}\n\t\tvector<ll> counts(PRIMES_COUNT, 0);\n\t\tfor(int i = 0; i < PRIMES_COUNT; ++i){\n\t\t\tll tmp = input;\n\t\t\twhile(tmp >= PRIMES[i]){\n\t\t\t\ttmp /= PRIMES[i];\n\t\t\t\tcounts[i] += tmp;\n\t\t\t}\n\t\t}\n\t\tcout << min(counts[0], counts[2]) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nint toInt(string s, int n)\n{\n    int ret = 0;\n    for(unsigned i=0; i<s.size(); ++i){\n        ret *= n;\n        if(isdigit(s[i]))\n            ret += s[i] - '0';\n        else\n            ret += s[i] - 'A' + 10;\n    }\n    return ret;\n}\n\nint main()\n{\n    for(;;){\n        int n;\n        string s;\n        cin >> n >> s;\n        if(n == 0)\n            return 0;\n\n        int m = toInt(s, n);\n        int ret = 0;\n        for(int i=1; i<=m; ++i){\n            int x = i;\n            while(x % 5 == 0){\n                ++ ret;\n                x /= 5;\n            }\n        }\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint main(){\n\tint n,m,mxdiv,divprime,ans; string b;\n\tbool p[99]={0}; for(int i=2;i*i<=99;i++)if(!p[i])for(int j=i+i;j<=99;j+=i)p[j]=1;\n\twhile(cin>>n>>b,n){\n\t\tmxdiv=m=0;\n\t\trep(i,b.size())m*=n,m+=('0'<=b[i]&&b[i]<='9'?b[i]-'0':b[i]-'A'+10);\n\t\tcerr<<\"n= \"<<n<<\" ,m=\"<<m<<endl;\n\t\tfor(int i=n;i>1;i--)if(!p[i]&&n%i==0){\n\t\t\tint div=i;\n\t\t\twhile(n%(div*i)==0)div*=i;\n\t\t\tif(mxdiv<div)mxdiv=div,divprime=i;\n\t\t}\n\t\tcerr<<\"mxdiv= \"<<mxdiv<<endl;\n\t\tans=0;\n\t\tfor(int i=divprime;i<=m;i*=divprime)ans+=m/i;\n\t\tcerr<<\"ans= \"<<ans<<endl;\n\t\tint multime=0;for(int i=1;i<mxdiv;multime++)i*=divprime;\n\t\tcout<<ans/multime<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<cassert>\n\nconst int MAX_P = 37;\nusing namespace std;\n\nvector<int> vprimes;\nbool isPrime[MAX_P];\n\nvoid MakePrime(){\n  isPrime[0]=false;\n  isPrime[1]=false;\n  isPrime[2]=true;\n  for(int i = 2; i < MAX_P; ++i){\n    isPrime[i] = true;\n  }\n  for(int i = 2; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      for(int j = 2; i * j < MAX_P; ++j) {\n\tisPrime[i*j] = false;\n      }\n    }\n  }\n  for(int i = 0; i < MAX_P; ++i){\n    if( isPrime[i] ){\n      vprimes.push_back( i );\n    }\n  }\n}\n\nlong long convtodec(string t, long long B){\n  long long ret = 0;\n  for(int i = 0; i < (int)t.length(); ++i){\n    int d = 0;\n    if(t[i]>='A'&&t[i]<='Z')d=t[i]-'A'+10;\n    else d=t[i]-'0';\n    //cout << t[0] << ' ' << d << endl;\n    ret *= B;\n    ret += d;\n  }\n  return ret;\n}\n\nlong long ipow(long long t, int p){\n  long long ret = 1;\n  for(int i = 0; i < p; ++i){\n    ret *= t;\n  }\n  return ret;\n}\n\nint main(){\n  MakePrime();\n  long long int N,B;\n  long long base;\n  string num;\n  while(cin>>base>>num){\n    if( base == 0 && num == \"0\" ) break;\n    N = convtodec(num,base);\n    B = base;\n    \n    if( N == 0 ){printf(\"0\\n\");continue;}\n    \n    long long num[vprimes.size()];\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      num[i] = 0;\n      int maxpow = 1;\n      while(N>ipow(vprimes[i],maxpow)){\n\t++maxpow;\n      }\n      --maxpow;\n      long long presum = 0;\n      //cout << vprimes[i] << ' ' << maxpow << endl; \n      for(int p = maxpow; p >= 1; --p){\n\tlong long tnum = (N / ipow(vprimes[i],p)) - presum;\n\tpresum += tnum;\n\tnum[i] += p * tnum;\n      }\n      //cout << num[i] << endl;\n    }\n\n    long long res = 1LL<<62;\n    for(int i = 0; i < (int)vprimes.size(); ++i){\n      int e = 0;\n      long long tB = B;\n      while(tB % vprimes[i] == 0){\n\t++e;\n\ttB /= vprimes[i];\n      }\n      if( e > 0 ){\n\tres = min(res, num[ i ] / e);\n      }\n    }\n    if( res == 1LL<<62 ) res = 0;\n\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <string>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nvector<pair<int, int> > PrimeFactor(int n) {\n  vector<pair<int, int> > ret;\n  FOREQ(i, 2, n) {\n    int cnt = 0;\n    while (n % i == 0) {\n      n /= i;\n      cnt++;\n    }\n    if (cnt != 0) {\n      ret.push_back(make_pair(i, cnt));\n    }\n  }\n  return ret;\n}\n\nll calc(ll m, ll v) {\n  if (m < v) { return 0; }\n  return m / v + calc(m / v, v);\n}\n\nll convert(string s, ll base) {\n  ll ret = 0;\n  FORIT(it, s) {\n    ll v = 0;\n    if (isdigit(*it)) { v = *it - '0'; }\n    else { v = *it - 'A' + 10; }\n    ret = ret * base + v;\n  }\n  return ret;\n}\n\nll n;\nstring str;\nint main() {\n  while (cin >> n >> str, n) {\n    ll m = convert(str, n);\n    vector<pair<int, int> > factor = PrimeFactor(n);\n    ll ans = 1LL << 62;\n    FORIT(it, factor) {\n      ans = min(ans, calc(m, it->first) / it->second);\n    }\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <cstdlib>\n\nusing namespace std;\n\nint N, M;\n\nint count(int n) {\n    int total = 0;\n    int m = M;\n    while (m >= n) {\n        total += (m / n);\n        m /= n;\n    }\n    return total;\n}\n\nlong long to_l(string s) {\n    long long n = 0;\n    for (int i = 0; i < s.size(); i++) {\n        if (isdigit(s[i])) {    \n            n = n * N + (s[i] - '0');\n        } else {\n            n = n * N + (s[i] - 'A' + 10);\n        }\n    }\n    return n;\n}\n\nint main() {\n    string M_;\n    while (cin >> N >> M_) {\n        if (N == 0 && M_ == \"0\") break;\n        M = to_l(M_);\n        int ans = 0;\n        switch (N) {\n            case 8:\n                ans = count(2) / 3;\n                break;\n            case 9:\n                ans = count(3) / 2;\n                break;\n            case 10:\n                ans = min(count(2), count(5));\n                break;\n            case 11:\n                ans = count(11);\n                break;\n            case 12:\n                ans = min(count(2) / 2, count(3));\n                break;\n            case 13:\n                ans = count(13);\n                break;\n            case 14:\n                ans = min(count(2), count(7));\n                break;\n            case 15:\n                ans = min(count(3), count(5));\n                break;\n            case 16:\n                ans = count(2) / 4;\n                break;\n            case 17:\n                ans = count(17);\n                break;\n            case 18:\n                ans = min(count(2), count(3) / 2);\n                break;\n            case 19:\n                ans = count(19);\n                break;\n            case 20:\n                ans = min(count(2)/2, count(5));\n                break;\n            case 21:\n                ans = min(count(3), count(7));\n                break;\n            case 22:\n                ans = min(count(2), count(11));\n                break;\n            case 23:\n                ans = count(23);\n                break;\n            case 24:\n                ans = min(count(2) / 3, count(3));\n                break;\n            case 25:\n                ans = count(5) / 2;\n                break;\n            case 26:\n                ans = min(count(2), count(13));\n                break;\n            case 27:\n                ans = count(3) / 3;\n                break;\n            case 28:\n                ans = min(count(2) / 2, count(7));\n                break;\n            case 29:\n                ans = count(29);\n                break;\n            case 30:\n                ans = min(min(count(2), count(3)), count(5));\n                break;\n            case 31:\n                ans = count(31);\n                break;\n            case 32:\n                ans = count(2) / 5;\n                break;\n            case 33:\n                ans = min(count(3), count(11));\n                break;\n            case 34:\n                ans = min(count(2), count(17));\n                break;\n            case 35:\n                ans = min(count(5), count(7));\n                break;\n            case 36:\n                ans = min(count(2) / 2, count(3) / 2);\n                break;\n        }\n        cout << ans << endl;\n//        for (int i = 0; i < 36; i++) {\n//            cout << count(i) << ' ';\n//        }\n//        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s*=n,s+=m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s*=n,s+=m[i]-'A'+10;\n    }\n    assert(m.size()<=12);\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main() {\n\tint N;\n\tstring M;\n\twhile (cin >> N >> M, N||M[0]!='0') {\n\t\tlong long num = 0;\n\t\tfor (int i=0; i<M.size(); i++) {\n\t\t\tint t = M[i]-'0';\n\t\t\tif (t > 9) {\n\t\t\t\tt = 10 + (M[i]-'A');\n\t\t\t}\n\t\t\tnum *= N;\n\t\t\tnum += t;\n\t\t}\n\n\t\tlong long  ans = 0;\n\t\tfor (long long  i=5; i<=num; i+=5) {\n\t\t\tlong long it = i;\n\t\t\tdo {\n\t\t\t\tans++;\n\t\t\t\tit /= 5;\n\t\t\t} while (it%5==0);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nlong long toInt(string s, int n)\n{\n    long long ret = 0;\n    for(unsigned i=0; i<s.size(); ++i){\n        ret *= n;\n        if(isdigit(s[i]))\n            ret += s[i] - '0';\n        else\n            ret += s[i] - 'A' + 10;\n    }\n    return ret;\n}\n\nint main()\n{\n    for(;;){\n        int n;\n        string s;\n        cin >> n >> s;\n        if(n == 0)\n            return 0;\n\n        long long m = toInt(s, n);\n        int ret = 0;\n        for(long long i=5; i<=m; i*=5)\n            ret += m / i;\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\n\ntemplate<typename T1,typename T2> void chmin(T1 &a,T2 b){if(a>b) a=b;};\ntemplate<typename T1,typename T2> void chmax(T1 &a,T2 b){if(a<b) a=b;};\n\n\nsigned main(){\n  int n;\n  string s;\n  \n  while(cin>>n>>s,n){\n    using ull = unsigned long long;\n    ull m=0;\n\n    auto calc=[](char c){if(isdigit(c)) return c-'0';return c-'A'+10;};\n  \n    for(int i=0;i<(int)s.size();i++){\n      m=m*n+calc(s[i]);\n    }\n\n    using P = pair<int, int>;\n    vector<P> vp;\n    int k=n;\n    for(int i=2;i<=50;i++){\n      if(k%i) continue;\n      vp.emplace_back(i,0);\n      while(k%i==0) k/=i,vp.back().second++;\n    }\n  \n    ull ans=m;\n\n    for(auto p:vp){\n      ull k=p.first;\n      ull res=0;\n      while(k<=m){\n\tres+=m/k;\n\tif(k>=ULLONG_MAX/p.first-1) break;\n\tk*=p.first;\n      }\n      chmin(ans,res/p.second);\n    }\n  \n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n#include <string.h>\n#include <cstdlib>\n#include <climits>\n\nusing namespace std;\nvector<int> prime;\nbool isPrime[100001];\n\nvoid PrimeCalc()\n{\n\tmemset(isPrime, 1, sizeof(isPrime));\n\tisPrime[0] = isPrime[1] = false;\n\tfor(int i = 2; i <= 100000; ++i)\n\t{\n\t\tif(isPrime[i])\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\tfor(int j = 2 * i; j <= 100000; j += i)\n\t\t\t{\n\t\t\t\tisPrime[j] = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid solve()\n{\n\tPrimeCalc();\n\tint N;\n\twhile(cin >> N, N)\n\t{\n\t\tstring M;\n\t\tcin >> M;\n\t\tmap<int, unsigned long long> decimal_factor;\n\t\tint t = N;\n\t\tfor(int i = 0; i < prime.size() && prime[i] <= 36; ++i)\n\t\t{\n\t\t\tif(t == 1)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile(t % prime[i] == 0)\n\t\t\t{\n\t\t\t\t++decimal_factor[prime[i]];\n\t\t\t\tt /= prime[i];\n\t\t\t}\n\t\t}\n\t\tunsigned long long m = strtoll(&M[0],NULL,N);\n\t\tmap<int, unsigned long long> factor;\n\t\tfor(unsigned long long i = 2; i <= m; ++i)\n\t\t{\n\t\t\tt = i;\n\t\t\tfor(int j = 0; prime[j] * prime[j] <= m; ++j)\n\t\t\t{\n\t\t\t\tif(t == 1)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\twhile(t % prime[j] == 0)\n\t\t\t\t{\n\t\t\t\t\t++factor[prime[j]];\n\t\t\t\t\tt /= prime[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tunsigned long long min_exist = 99999999999;\n\t\tmap<int, unsigned long long>::iterator it = factor.begin();\n\t\twhile(it != factor.end())\n\t\t{\n\t\t\tif(decimal_factor[it->first] > 0 && it->second / decimal_factor[it->first] < min_exist)\n\t\t\t{\n\t\t\t\tmin_exist = it->second / decimal_factor[it->first];\n\t\t\t}\n\t\t\t++it;\n\t\t}\n\t\tcout << min_exist << endl;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nint N; char M[15];\nint p[50]; long long power[20];\ninline long long div(long long k, int m) {\n\tlong long sum = 0;\n\twhile (k >= 1) {\n\t\tk /= m; sum += k;\n\t}\n\treturn sum;\n}\nint main() {\n\twhile (true) {\n\t\tscanf(\"%d%s\", &N, M); power[0] = 1;\n\t\tfor (int i = 0; i < 50; i++)p[i] = 0;\n\t\tfor (int i = 1; i < strlen(M); i++)power[i] = power[i - 1] * N;\n\t\tif (N == 0)break;\n\t\tlong long C = 0;\n\t\tfor (int i = 0; i < strlen(M); i++) {\n\t\t\tint V = (char)(M[i] - '0'); if (M[i] >= 'A')V = (char)(M[i] - 'A') + 10;\n\t\t\tC += power[strlen(M) - 1 - i] * V;\n\t\t}\n\t\tint L = N;\n\t\tfor (int i = 2; i <= L; i++) {\n\t\t\twhile (L%i == 0) {\n\t\t\t\tL /= i; p[i]++;\n\t\t\t}\n\t\t}\n\t\tlong long minx = 1LL << 62;\n\t\tfor (int i = 2; i <= N; i++) {\n\t\t\tif (p[i] == 0)continue;\n\t\t\tminx = min(minx, div(C, i) / p[i]);\n\t\t}\n\t\tprintf(\"%d\\n\", minx);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst ll INF = 1000000000000000000LL;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\nmap<ll, ll> prime_factor(ll n){\n\tmap<ll, ll> res;\n\tfor(int i = 2; (ll)i * i <= n; i++){\n\t\twhile(n % i == 0){\n\t\t\t++res[i];\n\t\t\tn /= i;\n\t\t}\n\t}\n\tif(n != 1) res[n] = 1;\n\treturn res;\n}\nint main(){\n\tint N;\n\tstring M;\n\twhile(cin>>N>>M){\n\t\tif(N == 0 && M == \"0\")break;\n\t\tif(M == \"0\"){\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tmap<ll, ll> factor = prime_factor(N);\n\t\tmap<ll, ll> cnt;\n\t\tll L = strtoll(M.c_str(), NULL, N);\n\t\tif(L == 0) while(true);\n\t\tll ans = LLONG_MAX;\n\t\tfor(map<ll,ll>::iterator it = factor.begin(); it!=factor.end(); it++){\n\t\t\tfor(ll i = it->first; i <= L ; i *= it->first){\n\t\t\t\tcnt[it->first] += L / i;\n\t\t\t\tif(L / i < it->first) break;\n\t\t\t}\n\t\t\tcnt[it->first] /= it->second;\n\t\t\tans = min(cnt[it->first], ans);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nvoid integerFactorization(int n, vector<int>& base, vector<int>& expo)\n{\n    base.clear();\n    expo.clear();\n    int a = 2;\n    while(a * a <= n){\n        int b = 0;\n        while(n % a == 0){\n            ++ b;\n            n /= a;\n        }\n        if(b > 0){\n            base.push_back(a);\n            expo.push_back(b);\n        }\n        ++ a;\n    }\n    if(n > 1 || base.size() == 0){\n        base.push_back(n);\n        expo.push_back(1);\n    }\n}\n\nlong long toInt(string s, int n)\n{\n    long long ret = 0;\n    for(unsigned i=0; i<s.size(); ++i){\n        ret *= n;\n        if(isdigit(s[i]))\n            ret += s[i] - '0';\n        else\n            ret += s[i] - 'A' + 10;\n    }\n    return ret;\n}\n\nint main()\n{\n    for(;;){\n        int n;\n        string s;\n        cin >> n >> s;\n        if(n == 0)\n            return 0;\n\n        vector<int> base, expo;\n        integerFactorization(n, base, expo);\n\n        long long m = toInt(s, n);\n\n        long long ret = LLONG_MAX;\n        for(unsigned i=0; i<base.size(); ++i){\n            long long m2 = m;\n            long long tmp = 0;\n            while(m2 > 0){\n                tmp += m2 / base[i];\n                m2 /= base[i];\n            }\n            ret = min(ret, tmp / expo[i]);\n        }\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int unsigned long long\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\n \ntypedef pair<int,int>P;\n \nint sosu[]={2,3,5,7,11,13,17,19,23,29,31,37},so=12;\n \nint con(int n,string s){\n  int res=0;\n  for(int i=0;i<s.size();i++){\n \n    res*=n;\n     \n    if(isalpha(s[i])){\n      res+=(s[i]-'A')+10;\n    }\n    else{\n      res+=(s[i]-'0');\n    }\n \n  }\n  return res;\n}\n \nvector<int> bunkai(int n){\n  vector<int>v;\n  r(i,so){\n    while(n%sosu[i]==0){\n      n/=sosu[i];\n      v.push_back(sosu[i]);\n    }\n  }\n  return v;\n}\n \nsigned main(){\n int N;\n  string s;\n  while( cin>>N>>s , N ){\n    int n=N;\n    int p=con(n,s);//cout<<p<<endl;\n \n    vector<int>v=bunkai(n);\n     \n    vector<P>vec,vel;\n \n    r(i,v.size()){\n      int res=0;\n      __int128 x=1;\n      if(i&&v[i-1]==v[i])continue;\n      __int128 pp=p;\n      for(int j=1;;j++){\n     \n        x*=v[i];\n \n        if(x>pp)break;\n     \n        res+=p/x;\n      }\n      vec.push_back(P(res,v[i]));\n    }\n     \n    r(i,so){\n      int res=0;\n      r(j,v.size()){\n        if(sosu[i]==v[j])res++;\n      }\n      if(res==0)continue;\n      //cout<<sosu[i]<<' '<<res<<endl;\n      //cout<<p/sosu[i]<<endl;\n      vel.push_back(P(res,sosu[i]));\n    }\n \n    unsigned long long ans=ULLONG_MAX;\n    r(i,vec.size()){\n      ans=min(ans,(unsigned long long)(vec[i].first/vel[i].first));\n    }\n \n    cout<<ans<<endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "//28\n#include<iostream>\n#include<cctype>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  int m;\n  char n[13];\n  while(cin>>m>>n,m){\n    long long nd=0;\n    for(int i=0;n[i];i++){\n      nd*=m;\n      nd+=isdigit(n[i])?n[i]-'0':n[i]-'A'+10;\n    }\n    int t=1<<30;\n    int mt=m;\n    for(int i=2;i<=36;i++){\n      int p=0;\n      while(mt%i==0){\n\tp++;\n\tmt/=i;\n      }\n      if(p){\n\tlong long tn=nd;\n\tint np=0;\n\twhile(tn){\n\t  tn/=i;\n\t  np+=tn;\n\t}\n\tt=min(t,np/p);\n      }\n    }\n    cout<<t<<endl;\n  }\n  return 0;\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n#include <string.h>\n\nusing namespace std;\nvector<int> prime;\nbool isPrime[100001];\n\nvoid PrimeCalc()\n{\n\tmemset(isPrime, 1, sizeof(isPrime));\n\tisPrime[0] = isPrime[1] = false;\n\tfor(int i = 2; i <= 100000; ++i)\n\t{\n\t\tif(isPrime[i])\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\tfor(int j = 2 * i; j <= 100000; j += i)\n\t\t\t{\n\t\t\t\tisPrime[j] = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid solve()\n{\n\tPrimeCalc();\n\tint N;\n\twhile(cin >> N, N)\n\t{\n\t\tstring M;\n\t\tcin >> M;\n\t\tmap<int, unsigned long long> decimal_factor;\n\t\tint t = N;\n\t\tfor(int i = 0; i < prime.size() && prime[i] <= 36; ++i)\n\t\t{\n\t\t\tif(t == 1)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile(t % prime[i] == 0)\n\t\t\t{\n\t\t\t\t++decimal_factor[prime[i]];\n\t\t\t\tt /= prime[i];\n\t\t\t}\n\t\t}\n\t\tunsigned long long to = 1;\n\t\tunsigned long long k = 1;\n\t\tfor(int i = M.size() - 1; i >= 0; --i)\n\t\t{\n\t\t\tif('A' <= M[i] && M[i] <= 'Z')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - 'A' + 10);\n\t\t\t}\n\t\t\telse if('1' <= M[i] && M[i] <= '9')\n\t\t\t{\n\t\t\t\tto *= k * (M[i] - '0');\n\t\t\t}\n\t\t\tk *= N;\n\t\t}\n\t\tmap<int, unsigned long long> factor;\n\t\tfor(unsigned long long i = 2; i <= to; ++i)\n\t\t{\n\t\t\tt = i;\n\t\t\tfor(int j = 0; prime[j] * prime[j] <= to; ++j)\n\t\t\t{\n\t\t\t\tif(t == 1)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\twhile(t % prime[j] == 0)\n\t\t\t\t{\n\t\t\t\t\t++factor[prime[j]];\n\t\t\t\t\tt /= prime[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint min_exist = 999999999;\n\t\tmap<int, unsigned long long>::iterator it = factor.begin();\n\t\twhile(it != factor.end())\n\t\t{\n\t\t\tif(decimal_factor[it->first] > 0 && it->second / decimal_factor[it->first] < min_exist)\n\t\t\t{\n\t\t\t\tmin_exist = it->second / decimal_factor[it->first];\n\t\t\t}\n\t\t\t++it;\n\t\t}\n\t\tcout << min_exist << endl;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n \nint tx[] = {0,1,0,-1};\nint ty[] = {-1,0,1,0};\n \nstatic const double EPS = 1e-8;\n\nunsigned long long conv(int base,const string& fact){\n  unsigned long long res = 0;\n  unsigned long long digit = 1;\n  for(int i = fact.size() - 1; i >= 0; i--){\n    if('A' <= fact[i] &&  fact[i] <= 'Z'){\n      res += (fact[i] - 'A' + 10) * digit;\n      digit *= base;\n    }\n    else{\n      res += (fact[i] - '0') * digit;\n      digit *= base;\n    }\n  }\n  return res;\n}\n\nint main(){\n  int base;\n  string fact;\n  while(cin >> base >> fact){\n    if(base == 0 && fact == \"0\") break;\n    unsigned long long num = conv(base,fact);\n    int res = 0;\n    while(num / 5 > 0){\n      res += num / 5;\n      num /= 5;\n    }\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<climits>\nusing namespace std;\ntypedef long long ll;\n#define inRange(x,a,b) (a <= x && x <= b)\n\nint main(){\n    int n;\n    string m;\n    vector<int> p({2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31});\n    while(cin >> n >> m, n){\n        vector<int> base(11, 0);\n        vector<ll> cnt(11, 0);\n        int cp = n;\n        for(int i = 0; i < 11; i++){\n            while(cp%p[i] == 0)  base[i]++, cp /= p[i];\n        }\n        ll val = 0;\n        for(int i = 0; i < m.length(); i++){\n            val *= n;\n            if(inRange(m[i],'0','9'))   val += m[i]-'0';\n            else                        val += 10+m[i]-'A';\n        }\n        for(int i = 0; i < 11; i++){\n            ll x = val;\n            while(x){\n                cnt[i] += x/p[i];\n                x /= p[i];\n            }\n        }\n\n        ll ans = LLONG_MAX;\n        for(int i = 0; i < 11; i++){\n            if(base[i] == 0)    continue;\n            ans = min(ans, cnt[i]/base[i]);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n#include<stack>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\ntypedef vector<string> vstring;\ntypedef vector<pint> vpint;\ntypedef stringstream SS;\n\n#ifdef DEBUG\n#define debug cout\n#else\nSS ss;\n#define debug ss\n#endif\n\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define repn(i,m,n) for(int i=(m);i<(n);++i)\n#define repd(i,n) for(int i=(n)-1;i>=0;--i)\n#define repnd(i,m,n) for(int i=(n)-1;i>=(m);--i)\n#define rep0(i,n) for(i=0;i<(n);++i)\n#define repn0(i,m,n) for(i=(m);i<(n);++i)\n#define repd0(i,n) for(i=(n)-1;i>=0;--i)\n#define repnd0(i,m,n) for(i=(n)-1;i>=(m);--i)\n#define repc(i,n) for(int i=0;i<=(n);++i)\n#define repcn(i,m,n) for(int i=(m);i<=(n);++i)\n#define repcd(i,n) for(int i=(n);i>=0;--i)\n#define repcnd(i,m,n) for(int i=(n);i>=(m);--i)\n#define repc0(i,n) for(i=0;i<=(n);++i)\n#define repcn0(i,m,n) for(i=(m);i<=(n);++i)\n#define repcd0(i,n) for(i=(n);i>=0;--i)\n#define repcnd0(i,m,n) for(i=(n);i>=(m);--i)\n#define all(n) n.begin(),n.end()\n#define sz(n) ((int)(n).size())\n#define IL for(;;)\n#define MP make_pair\n#define PB push_back\n#define X second\n#define Y first\n#define p_queue(n) priority_queue<n,vector<n>,greater<n> >\n#define PUTLINE debug<<\"LINE:\"<<__LINE__<<endl;\n\nconst Int INF = 4000000000000000000LL;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\n\nconst int dx[]={1,-1,0,0,1,1,-1,-1,0};\nconst int dy[]={0,0,1,-1,1,-1,1,-1,0};\n\nInt dig(char c){\n\tif(isdigit(c))return c-'0';\n\treturn c-'A'+10;\n}\n\nint main() {\n\tInt n,m,nn,mm,res,r;\n\tvector<pair<Int,Int> > p;\n\tstring str;\n\tIL{\n\t\tcin>>n>>str;\n\t\tif(n==0)break;\n\t\tm=0;\n\t\trep(i,sz(str)){\n\t\t\tm=m*n+dig(str[i]);\n\t\t}\n\t\tnn=n;\n\t\tp.clear();\n\t\tfor(Int i=2;nn!=1;++i){\n\t\t\tif(nn%i==0){\n\t\t\t\tInt count=0;\n\t\t\t\twhile(nn%i==0){\n\t\t\t\t\t++count;\n\t\t\t\t\tnn/=i;\n\t\t\t\t}\n\t\t\t\tp.PB(MP(i,count));\n\t\t\t}\n\t\t}\n\t\tres=INF;\n\t\trep(j,sz(p)){\n\t\t\tmm=m;\n\t\t\tr=0;\n\t\t\twhile(mm>0){\n\t\t\t\tmm/=p[j].first;\n\t\t\t\tr+=mm;\n\t\t\t}\n\t\t\tchmin(res,r/p[j].second);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<iostream>\n\nusing namespace std;\n\nint main(){\n\tint f[128];\n\tfor(int i='0';i<='9';i++)\tf[i]=i-'0';\n\tfor(int i='A';i<='Z';i++)\tf[i]=i-'A'+10;\n\n\tint base;\n\tstring s;\n\tfor(;cin>>base>>s,base;){\n\t\tlong long num=0;\n\t\tfor(int i=0;i<s.length();i++)\tnum=num*base+f[s[i]];\n\n\t\tconst int p[]={31,29,23,19,17,13,11,7,5,3,2};\n\t\tint pcnt[11]={};\n\t\tfor(int b=base,i=0;b>1;){\n\t\t\tif(b%p[i]==0)\tb/=p[i],pcnt[i]++;\n\t\t\telse\ti++;\n\t\t}\n\n\t\tlong long zcnt=1LL<<60;\n\t\tfor(int i=0;i<11;i++){\n\t\t\tif(pcnt[i]>0){\n\t\t\t\tlong long num2=num,zcnt2=0;\n\t\t\t\twhile(num2)\tzcnt2+=num2/p[i],num2/=p[i];\n\t\t\t\tzcnt=min(zcnt,zcnt2/pcnt[i]);\n\t\t\t}\n\t\t}\n\t\tcout<<zcnt<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  ll n;\n  string m;\n\n  while(cin>>n>>m,n){\n    ll s=0;\n    for(int i=0;i<(int)m.size();i++){\n      if('0'<=m[i]&&m[i]<='9')s=s*n+m[i]-'0';\n      if('A'<=m[i]&&m[i]<='Z')s=s*n+m[i]-'A'+10;\n    }\n    assert(m.size()<=12&&n<=36);\n    ll ans=0;\n    for(long double i=5;i<=s+0.5;i*=5){\n      ans+=s/(ll)(i+0.5);\n    }\n    cout<<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\n\nusing namespace std;\n\nint main(){\n\n\tunsigned long long int number,base,ans,table[37],work;\n\tint length;\n\tchar exp[13];\n\n\twhile(true){\n\t\tscanf(\"%lld %s\",&base,exp);\n\t\tif(base == 0 && exp[0] == '0')break;\n\n\t\tfor(unsigned long long int i = 0; i <= base; i++)table[i] = 0;\n\n\t\twork = base;\n\t\tfor(int i = 2; i <= 31; i++){\n\t\t\twhile(work%i == 0){\n\t\t\t\ttable[i]++;\n\t\t\t\twork /= i;\n\t\t\t}\n\t\t}\n\n\t\tnumber = 0;\n\t\tfor(length = 0;exp[length] != '\\0';length++);\n\n\t\tfor(int i = 0; i < length; i++){\n\t\t\tif(exp[i] >= '0' && exp[i] <= '9'){\n\t\t\t\tnumber += pow(base,length-1-i)*(exp[i] - '0');\n\t\t\t}else{\n\t\t\t\tnumber += pow(base,length-1-i)*(10 + exp[i] - 'A');\n\t\t\t}\n\t\t}\n\n\t\tans = 9223372036854775807;\n\t\tfor(unsigned long long int i = 2; i <= base; i++){\n\t\t\tif(table[i] > 0){\n\t\t\t\twork = 0;\n\t\t\t\tfor(int k = 1;pow(i,k) <= number;k++){\n\t\t\t\t\twork += number/pow(i,k);\n\t\t\t\t}\n\t\t\t\twork /= table[i];\n\t\t\t\tans = min(ans,work);\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid factorize(vector<ll> &p,vector<ll> &cnt,ll x) {\n    p.clear(); cnt.clear();\n    if(x <= 1) {\n        p.push_back(1);\n        cnt.push_back(1);\n        return;\n    }\n\n    ll lim = (ll)sqrt(x);\n\n    if(x%2 == 0) {\n        p.push_back(2);\n        cnt.push_back(0);\n        while(x%2 == 0) {\n            cnt[0]++;\n            x /= 2;\n        }\n    }\n\n    ll pp = 3;\n    while(true) {\n        if(x <= 1) break;\n        if(pp > lim) {\n            p.push_back(x);\n            cnt.push_back(1);\n            break;\n        }\n        if(x % pp == 0) {\n            p.push_back(pp);\n            cnt.push_back(0);\n            while(x%pp == 0) {\n                cnt[cnt.size()-1]++;\n                x /= pp;\n            }\n        }\n        pp += 2;\n    }\n    return;\n}\n\nint main() {\n    int base;\n    string a;\n    while(cin>>base>>a, base) {\n        unsigned long long m = 0;\n        for(int i=0; i<a.length(); ++i) {\n            m *= base;\n            if(a[i] <= '9') m += a[i] - '0';\n            else m += a[i] - 'A' + 10;\n        }\n\n        vector<ll> p,cnt;\n        factorize(p,cnt,base);\n\n        vector<ll> pp(p.size(), 0);\n        for(int i=0; i<p.size(); ++i) {\n            ll n = p[i];\n            while(n <= m) {\n                pp[i] += m/n;\n                n *= p[i];\n            }\n        }\n\n        ll ans = 1ll<<62;\n        for(int i=0; i<p.size(); ++i) ans = min(ans, pp[i]/cnt[i]);\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  long long i,j,r,n,min,d[2][50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%lld %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=r=0;i<40;i++)d[0][i]=0;\n    min=1e18;\n    for(i=2;i<=j;i++){\n      if(j%i==0)r++;\n      else continue;\n      d[1][r]=i;\n      while(j%i==0){\n\tj/=i;\n\td[0][r]++;\n      }\n    }//printf(\"a\\n\");\n    //for(i=1;i<=r;i++)printf(\"%lld %lld\\n\",d[1][i],d[0][i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%lld\\n\",m);\n    for(i=1;i<=r;i++){\n      a=0;\n      for(j=d[1][i];j<=m;j*=d[1][i])a+=m/j;\n      a/=d[0][i];//printf(\"%d %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",a);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "long long a,b,c,strtoll();i,j,z;main(m,p){for(;scanf(\"%d%s\",&m,p)*m;printf(\"%d\\n\",z))for(z=1e9,i=2,a=strtoll(p,0,m);m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "C",
    "code": "long long a,b,c,z,strtoll();i,j;main(m,p){for(;scanf(\"%d%s\",&m,p),a=strtoll(p,0,m);printf(\"%lld\\n\",z))for(z=9e18,i=2;m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "C",
    "code": "// Aizu 2086: !\n// 2017.9.22 bal4u@uu\n\n#include <stdio.h>\n\nint pm[11] = {2,3,5,7,11,13,17,19,23,29,31};\nint base[38][4], exp[38][4], len[38];\n\nint main()\n{\n\tint n, i, j, k, a, b;\n\tchar ms[15], *p;\n\tlong long m, ans, x, y;\n\n\tfor (i = 2; i <= 36; i++) {\n\t\tfor (j = 0; j < 11; j++) {\n\t\t\tif ((a = pm[j]) > i) break;\n\t\t\tif (i % a == 0) {\n\t\t\t\tb = i, k = 0; while (b % a == 0) b /= a, k++;\n\t\t\t\tbase[i][len[i]] = a, exp[i][len[i]++] = k;\n\t\t\t}\n\t\t}\n\t}\n#if 0\n\tfor (i = 2; i <= 36; i++) {\n\t\tprintf(\"%2d:\", i);\n\t\tfor (j = 0; j < len[i]; j++) printf(\" %d(%d)\", base[i][j], exp[i][j]);\n\t\tprintf(\"\\n\");\n\t}\n#endif\n\n\twhile (scanf(\"%d%s\", &n, &ms) && n) {\n\t\tm = 0, p = ms; while (*p) {\n\t\t\tm *= n, m += ((*p >= 'A') ? *p-'A'+10 : *p-'0');\n\t\t\tp++;\n\t\t}\n\t\tfor (ans = (1LL << 62), i = 0; i < len[n]; i++) {\n\t\t\tx = m, a = base[n][i], y = 0;\n\t\t\twhile (x /= a) y += x;\n\t\t\ty /= exp[n][i];\tif (y < ans) ans = y;\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  long long i,j,r,n,min,d[2][50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%lld %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=r=0;i<40;i++)d[0][i]=0;\n    min=2*1e18;\n    for(i=2;i<=j;i++){\n      if(j%i==0)r++;\n      else continue;\n      d[1][r]=i;\n      while(j%i==0){\n\tj/=i;\n\td[0][r]++;\n      }\n    }//printf(\"a\\n\");\n    for(i=1;i<=r;i++)printf(\"%lld %lld\\n\",d[1][i],d[0][i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%lld\\n\",m);\n    for(i=1;i<=r;i++){\n      a=0;\n      for(j=d[1][i];j<=m;j*=d[1][i])a+=m/j;\n      a/=d[0][i];//printf(\"%lld %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",min);\n  }\n  return 0;\n}\n      "
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nint main(){\n  int i,j,n,m,a,d[50],min;\n  char s[5000],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%d %s\",&n,s),n){\n    j=n;\n    for(i=0;i*i<n;i++){\n      while(j%i==0){\n\tj/=i;\n\td[i]++;\n      }\n    }\n    for(i=strlen(s)-1;i>0;i--){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }\n    for(i=0;i*i<n;i++){\n      if(d[i]==0)continue;\n      a=0;\n      for(j=i;j<n;j*=i)a+=m/j;\n      a/=d[i];\n      if(min>a)min=a;\n    }\n  \n  printf(\"%d\\n\",a);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  int i,j,n,min,d[50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%d %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=0;i<40;i++)d[i]=0;\n    min=1000000000;\n    for(i=2;i<=j;i++){\n      while(j%i==0){\n\tj/=i;\n\td[i]++;\n      }\n    }//printf(\"a\\n\");\n    //for(i=0;i<n;i++)printf(\"%d %d\\n\",i,d[i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%d\\n\",m);\n    for(i=0;i<=n;i++){\n      if(d[i]==0)continue;\n      a=0;\n      for(j=i;j<=m;j*=i)a+=m/j;\n      a/=d[i];//printf(\"%d %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",a);\n  }\n  return 0;\n}\n      "
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  long long i,j,r,n,min,d[2][50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%lld %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=r=0;i<40;i++)d[0][i]=0;\n    min=2*1e18;\n    for(i=2;i<=j;i++){\n      if(j%i==0)r++;\n      else continue;\n      d[1][r]=i;\n      while(j%i==0){\n\tj/=i;\n\td[0][r]++;\n      }\n    }//printf(\"a\\n\");\n    // for(i=1;i<=r;i++)printf(\"%lld %lld\\n\",d[1][i],d[0][i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%lld\\n\",m);\n    for(i=1;i<=r;i++){\n      a=0;\n      for(j=d[1][i];j<=m;j*=d[1][i])a+=m/j;\n      a/=d[0][i];//printf(\"%lld %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",min);\n  }\n  return 0;\n}\n      "
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 2086\n  Title:!\n  @kankichi573\n*/\n#include <stdio.h>\n#include <string.h>\n#define min(x,y) (((x)<(y))?(x):(y))\n\nint N;\nchar M[12];\nchar primes[]={2,3,5,7,11,13,17,19,23,29,31};\nint biggest_prime(int x)\n{\n  int i;\n  for(i=10;i>=0;i--)\n    {\n      //printf(\"%d %d::\",primes[i],x % primes[i]);\n      if((x % primes[i])==0)\n\treturn(primes[i]);\n    }\n  return(-1);\n}\n// (24,2)=>3\n// (16,2)=>4\nint biggest_prime_times(int x,int p)\n{\n  if((x % p)!=0)\n    return(0);\n  return(1+biggest_prime_times(x/p,p));\n}\nint myatoi(char c)\n{\n  if(isdigit(c))\n    return(c-'0');\n  else\n    return(c-'A'+10);\n}\nunsigned long long todecimal(char x[],int base)\n{\n  int i,l;\n  unsigned long long ret;\n  l=strlen(x);\n  ret=0;\n  for(i=0;i<l;i++)\n    {\n      ret *= base;\n      ret += myatoi(x[i]);\n    }\n  return(ret);\n}\n\n\nunsigned long long devide_times(unsigned long long n,int d)\n{\n  unsigned long long ret,dd;\n  ret=0;dd=d;\n  while(dd <= n)\n    {\n      ret += n/dd;\n      dd *= d;\n    }\n\n  return(ret);\n}\nmain()\n{\n  unsigned long long ret;\n  int bp; // prime\n\n  //printf(\"%llu\\n\",devide_times(100,5));\n  \n  while(scanf(\"%d %s\",&N,M) && (N || M[0]!='0'))\n    {\n      if(N==12)\n\t{\n\t  ret=min(devide_times(todecimal(M,N),2)/2,\n\t\t  devide_times(todecimal(M,N),3));\n\t}\n      else if(N==24)\n\t{\n\t  ret=min(devide_times(todecimal(M,N),2)/3,\n\t\t  devide_times(todecimal(M,N),3));\n\t}\n      else\n\t{\n\t  bp=biggest_prime(N);\n\t  ret=devide_times(todecimal(M,N),bp)/biggest_prime_times(N,bp);\n\t}\n      printf(\"%llu\\n\",ret);\n    }\n  \n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "long long a,b,c;i,j,z;main(m,p){for(;scanf(\"%d%s\",&m,p)*m;printf(\"%d\\n\",z))for(z=1e9,i=2,a=strtoll(p,0,m);m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "C",
    "code": "long long a,b,c,z,strtoll();i,j;main(m,p){for(;scanf(z=\"%d%s\",&m,p),a=strtoll(p,0,m);printf(\"%lld\\n\",z))for(i=2;m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  long long i,j,n,min,d[50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%lld %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=0;i<40;i++)d[i]=0;\n    min=1e18;\n    for(i=2;i<=j;i++){\n      while(j%i==0){\n\tj/=i;\n\td[i]++;\n      }\n    }//printf(\"a\\n\");\n    //for(i=0;i<n;i++)printf(\"%d %d\\n\",i,d[i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%d\\n\",m);\n    for(i=0;i<=n;i++){\n      if(d[i]==0)continue;\n      a=0;\n      for(j=i;j<=m;j*=i)a+=m/j;\n      a/=d[i];//printf(\"%d %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",a);\n  }\n  return 0;\n}\n    "
  },
  {
    "language": "C",
    "code": "long long a,b,c,z,strtoll();i,j;main(m,p){for(;scanf(\"%d%s\",&m,p)*m;printf(\"%lld\\n\",z))for(z=9e18,i=2,a=strtoll(p,0,m);m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nint main(){\n  int i,j,n,m,a,d[50],min;\n  char s[5000],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%d %s\",&n,s),n){\n    j=n;\n    m=0;\n    min=1000000000;\n    for(i=2;i<=j;i++){\n      while(j%i==0){\n\tj/=i;\n\td[i]++;\n      }\n    }//printf(\"a\\n\");\n    //for(i=0;i<n;i++)printf(\"%d %d\\n\",i,d[i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%d\\n\",m);\n    for(i=0;i<=n;i++){\n      if(d[i]==0)continue;\n      a=0;\n      for(j=i;j<=m;j*=i)a+=m/j;\n      a/=d[i];//printf(\"%d %d\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%d\\n\",a);\n  }\n  return 0;\n}\n      "
  },
  {
    "language": "C",
    "code": "// Aizu 2086: !\n// 2017.9.22 bal4u@uu\n\n#include <stdio.h>\n\nint pm[11] = {2,3,5,7,11,13,17,19,23,29,31};\nint base[38][4], exp[38][4], len[38];\n\nint main()\n{\n\tint n, m, i, j, k, a, b, ans;\n\tchar ms[15], *p;\n\n\tfor (i = 2; i <= 36; i++) {\n\t\tfor (j = 0; j < 11; j++) {\n\t\t\tif ((a = pm[j]) > i) break;\n\t\t\tif (i % a == 0) {\n\t\t\t\tb = i, k = 0; while (b % a == 0) b /= a, k++;\n\t\t\t\tbase[i][len[i]] = a, exp[i][len[i]++] = k;\n\t\t\t}\n\t\t}\n\t}\n#if 0\n\tfor (i = 2; i <= 36; i++) {\n\t\tprintf(\"%2d:\", i);\n\t\tfor (j = 0; j < len[i]; j++) printf(\" %d(%d)\", base[i][j], exp[i][j]);\n\t\tprintf(\"\\n\");\n\t}\n#endif\n\n\twhile (scanf(\"%d%s\", &n, &ms) && n) {\n\t\tm = 0, p = ms; while (*p) {\n\t\t\tm = m * n + ((*p >= 'A') ? *p-'A'+10 : *p-'0');\n\t\t\tp++;\n\t\t}\n\t\tans = 0x7ffffff; for (i = 0; i < len[n]; i++) {\n\t\t\ta = base[n][i], k = 0;\n\t\t\tfor (j = m; j >= 2; j--) {\n\t\t\t\tb = j; while (b % a == 0) b /= a, k++;\n\t\t\t}\n\t\t\tk /= exp[n][i];\tif (k < ans) ans = k;\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nunsigned long long m,a;\nint main(){\n  long long i,j,n,min,d[50]={0};\n  char s[50],c[]={\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"};\n  while(scanf(\"%lld %s\",&n,s),n){\n    j=n;\n    m=0;\n    for(i=0;i<40;i++)d[i]=0;\n    min=1000000000;\n    for(i=2;i<=j;i++){\n      while(j%i==0){\n\tj/=i;\n\td[i]++;\n      }\n    }//printf(\"a\\n\");\n    //for(i=0;i<n;i++)printf(\"%d %d\\n\",i,d[i]);\n    for(i=0;s[i];i++){\n      m*=n;\n      for(j=0;c[j]-s[i];j++);\n      m+=j;\n    }//printf(\"%d\\n\",m);\n    for(i=0;i<=n;i++){\n      if(d[i]==0)continue;\n      a=0;\n      for(j=i;j<=m;j*=i)a+=m/j;\n      a/=d[i];//printf(\"%d %lld\\n\",i,a);\n      if(min>a)min=a;\n    }\n  \n  printf(\"%lld\\n\",a);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "long long a,b,c,z,strtoll();i,j;main(m,p){for(;i=scanf(\"%d%s\",&m,p),m;printf(\"%lld\\n\",z))for(z=9e18,a=strtoll(p,0,m);m>1;++i)if(m%i<1){for(c=j=0;m%i<1;++j)m/=i;for(b=a;b;)c+=b/=i;z>c/j?z=c/j:0;}}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//!\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[] p = {2,3,5,7,11,13,17,19,23,29,31};\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tchar[] s = sc.next().toCharArray();\n\t\t\tif(n==0)break;\n\t\t\tlong X = 0;\n\t\t\tfor(char c:s){\n\t\t\t\tlong x = 'A'<=c?(c-'A'+10):(c-'0');\n\t\t\t\tX = X*n+x;\n\t\t\t}\n\t\t\tlong[] need = new long[11];\n\t\t\tint N = n;\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tif(N%p[i]==0){\n\t\t\t\t\tN/=p[i];\n\t\t\t\t\tneed[i--]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong[] num = new long[11];\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tlong x = X;\n\t\t\t\twhile(x>1){\n\t\t\t\t\tnum[i]+=x/p[i];\n\t\t\t\t\tx/=p[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong res = Long.MAX_VALUE;\n\t\t\tfor(int i=0;i<11;i++)if(0<need[i])res=Math.min(res, num[i]/need[i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//!\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[] p = {2,3,5,7,11,13,17,19,23,29,31};\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tchar[] s = sc.next().toCharArray();\n\t\t\tif(n==0)break;\n\t\t\tlong X = 0;\n\t\t\tfor(char c:s){\n\t\t\t\tlong x = 'A'<=c?(c-'A'+10):(c-'0');\n\t\t\t\tX = X*n+x;\n\t\t\t}\n\t\t\tlong[] need = new long[11];\n\t\t\tint N = n;\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tif(N%p[i]==0){\n\t\t\t\t\tN/=p[i];\n\t\t\t\t\tneed[i--]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong[] num = new long[11];\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tlong x = X;\n\t\t\t\twhile(x>1){\n\t\t\t\t\tnum[i]+=x/p[i];\n\t\t\t\t\tx/=p[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong res = 1L<<60;\n\t\t\tfor(int i=0;i<11;i++)if(0<need[i])res=Math.min(res, num[i]/need[i]);\n\t\t\tStringBuffer sb = new StringBuffer(\"\");\n\t\t\twhile(res>0){\n\t\t\t\tlong x = res%n;\n\t\t\t\tsb.append(10<=x?(char)(x-10+'A'):x);\n\t\t\t\tres/=n;\n\t\t\t}\n\t\t\tif(sb.length()==0)sb.append(0);\n\t\t\tSystem.out.println(sb.reverse());\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//!\npublic class Main{\n\n\tvoid run(){\n//\t\tSystem.out.println(1L<<60);\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[] p = {2,3,5,7,11,13,17,19,23,29,31};\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tchar[] s = sc.next().toCharArray();\n\t\t\tif(n==0)break;\n\t\t\tlong X = 0;\n\t\t\tfor(char c:s){\n\t\t\t\tlong x = 'A'<=c?(c-'A'+10):(c-'0');\n\t\t\t\tX = X*n+x;\n\t\t\t}\n\t\t\tlong[] need = new long[11];\n\t\t\tint N = n;\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tif(N%p[i]==0){\n\t\t\t\t\tN/=p[i];\n\t\t\t\t\tneed[i--]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong[] num = new long[11];\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tlong x = X;\n\t\t\t\twhile(x>1){\n\t\t\t\t\tnum[i]+=x/p[i];\n\t\t\t\t\tx/=p[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong res = Long.MAX_VALUE;\n\t\t\tfor(int i=0;i<11;i++)if(0<need[i])res=Math.min(res, num[i]/need[i]);\n//\t\t\tSystem.out.println(res);\n\t\t\tStringBuffer sb = new StringBuffer(\"\");\n\t\t\twhile(res>0){\n\t\t\t\tlong x = res%n;\n\t\t\t\tsb.append(10<=x?(char)(x-10+'A'):x);\n\t\t\t\tres/=n;\n\t\t\t}\n\t\t\tif(sb.length()==0)sb.append(0);\n\t\t\tSystem.out.println(sb.reverse());\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\n    public static void main(String[] args) throws java.io.IOException {\n        Scanner scan = new Scanner(System.in);\n        while (true) {\n            long m;\n            int n = scan.nextInt();\n            if (n == 0)\n                break;\n            m = Long.parseLong(scan.next(), n);\n\n            int f = 0;\n            int t = 0;\n            for (long i = m; i >= 2; i--) {\n                long k = i;\n                while (k % 10 == 0) {\n                    t++;f++;\n                    k /= 10;\n                }\n                while (k % 2 == 0) {\n                    t++;\n                    k /= 2;\n                }\n                while (k % 5 == 0) {\n                    f++;\n                    k /= 5;\n                }\n            }\n            int ans = Math.min(t, f);\n            System.out.println(ans);\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\n    public static void main(String[] args) throws java.io.IOException {\n        Scanner scan = new Scanner(System.in);\n        while (true) {\n            long m;\n            int n = scan.nextInt();\n            if (n == 0)\n                break;\n            m = Long.parseLong(scan.next(), n);\n\n            int f = 0;\n            int t = 0;\n            for (long i = m; i >= 2; i--) {\n                long k = i;\n                while (k % 2 == 0) {\n                    t++;\n                    k /= 2;\n                }\n                while (k % 5 == 0) {\n                    f++;\n                    k /= 5;\n                }\n            }\n            int ans = Math.min(t, f);\n            System.out.println(ans);\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n \n         \n        public static void main(String[] args) throws java.io.IOException{\n            Scanner scan = new Scanner(System.in);\n            while(true){\n            long  m;\n            int n=scan.nextInt();\n            if(n==0)break;\n            m=Long.parseLong(scan.next(), n);\n            \n            int f=0;\n            int t=0;\n            for(long i=m;i>=2;i--){\n                long k=i;\n                while(k%2==0 || k%5==0){\n                \tif(k%2==0){t++;k/=2;}\n                \tif(k%5==0){f++;k/=5;}\n                }\n            }\n            int ans = Math.min(t,f);\n            System.out.println(ans);\n            }\n        }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//!\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[] p = {2,3,5,7,11,13,17,19,23,29,31};\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tchar[] s = sc.next().toCharArray();\n\t\t\tif(n==0)break;\n\t\t\tlong X = 0;\n\t\t\tfor(char c:s){\n\t\t\t\tlong x = 'A'<=c?(c-'A'+10):(c-'0');\n\t\t\t\tX = X*n+x;\n\t\t\t}\n\t\t\tlong[] need = new long[11];\n\t\t\tint N = n;\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tif(N%p[i]==0){\n\t\t\t\t\tN/=p[i];\n\t\t\t\t\tneed[i--]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong[] num = new long[11];\n\t\t\tfor(int i=0;i<11;i++){\n\t\t\t\tlong x = X;\n\t\t\t\twhile(x>1){\n\t\t\t\t\tnum[i]+=x/p[i];\n\t\t\t\t\tx/=p[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong res = Long.MAX_VALUE;\n\t\t\tfor(int i=0;i<11;i++)if(0<need[i])res=Math.min(res, num[i]/need[i]);\n\t\t\tStringBuffer sb = new StringBuffer(\"\");\n\t\t\twhile(res>0){\n\t\t\t\tlong x = res%n;\n\t\t\t\tsb.append((char)(10<=x?x-10+'A':x+'0'));\n\t\t\t\tres/=n;\n\t\t\t}\n\t\t\tif(sb.length()==0)sb.append(0);\n\t\t\tSystem.out.println(sb.reverse());\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nh={2=>[[2, 1]], 3=>[[3, 1]], 4=>[[2, 2]], 5=>[[5, 1]], 6=>[[2, 1], [3, 1]], 7=>[[7, 1]], 8=>[[2, 3]], 9=>[[3, 2]], 10=>[[2, 1], [5, 1]], 11=>[[11, 1]], 12=>[[2, 2], [3, 1]], 13=>[[13, 1]], 14=>[[2, 1], [7, 1]], 15=>[[3, 1], [5, 1]], 16=>[[2, 4]], 17=>[[17, 1]], 18=>[[2, 1], [3, 2]], 19=>[[19, 1]], 20=>[[2, 2], [5, 1]], 21=>[[3, 1], [7, 1]], 22=>[[2, 1], [11, 1]], 23=>[[23, 1]], 24=>[[2, 3], [3, 1]], 25=>[[5, 2]], 26=>[[2, 1], [13, 1]], 27=>[[3, 3]], 28=>[[2, 2], [7, 1]], 29=>[[29, 1]], 30=>[[2, 1], [3, 1], [5, 1]], 31=>[[31, 1]], 32=>[[2, 5]], 33=>[[3, 1], [11, 1]], 34=>[[2, 1], [17, 1]], 35=>[[5, 1], [7, 1]], 36=>[[2, 2], [3, 2]]}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "while 1\n  x = gets.split(' ')\n  n = x[0].to_i\n  m = x[1].to_s\n  if(n==0)\n    break\n  end\n  res = 0\n  for i in 0..(m.length-1)\n    res*=n\n    if(m[i]=='0')\n      res+=0\n    end\n    if(m[i]=='1')\n      res+=1\n    end\n    if(m[i]=='2')\n      res+=2\n    end\n    if(m[i]=='3')\n      res+=3\n    end\n    if(m[i]=='4')\n      res+=4\n    end\n    if(m[i]=='5')\n      res+=5\n    end\n    if(m[i]=='6')\n      res+=6\n    end\n    if(m[i]=='7')\n      res+=7\n    end\n    if(m[i]=='8')\n      res+=8\n    end\n    if(m[i]=='9')\n      res+=9\n    end\n    if(m[i]=='A')\n      res+=10\n    end\n    if(m[i]=='B')\n      res+=11\n    end\n    if(m[i]=='C')\n      res+=12\n    end\n    if(m[i]=='D')\n      res+=13\n    end\n    if(m[i]=='E')\n      res+=14\n    end\n    if(m[i]=='F')\n      res+=15\n    end\n    if(m[i]=='G')\n      res+=16\n    end\n    if(m[i]=='H')\n      res+=17\n    end\n    if(m[i]=='I')\n      res+=18\n    end\n    if(m[i]=='J')\n      res+=19\n    end\n    if(m[i]=='K')\n      res+=20\n    end\n    if(m[i]=='L')\n      res+=21\n    end\n    if(m[i]=='M')\n      res+=22\n    end\n    if(m[i]=='N')\n      res+=23\n    end\n    if(m[i]=='O')\n      res+=24\n    end\n    if(m[i]=='P')\n      res+=25\n    end\n    if(m[i]=='Q')\n      res+=26\n    end\n    if(m[i]=='R')\n      res+=27\n    end\n    if(m[i]=='S')\n      res+=28\n    end\n    if(m[i]=='T')\n      res+=29\n    end\n    if(m[i]=='U')\n      res+=30\n    end\n    if(m[i]=='V')\n      res+=31\n    end\n    if(m[i]=='W')\n      res+=32\n    end\n    if(m[i]=='X')\n      res+=33\n    end\n    if(m[i]=='Y')\n      res+=34\n    end\n    if(m[i]=='Z')\n      res+=35\n    end\n  end\n  ans = 2**100\n  k = n\n  for i in 2..n\n    if k%i == 0\n      tmp = 0\n      r = 0\n      while k%i==0\n        k/=i\n        r+=1\n    end\n      j=i\n      while j<=res\n        tmp+=res/j\n        j*=i\n      end\n      ans = [ans,tmp/r].min()\n    end\n  end\n  puts ans\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'prime'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "h={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n    l=l.split\n    n=l[0].to_i;m=l[1].to_i(n)\n    p h[n].map{|a,b|z=m;r=0;r+=(z/=a) while z>0;r/b}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=99999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tif x>r.div(b) then x=r.div(b) end\n\t}\n\tp x\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tif x>r.div(b) then x=r.div(b) end\n\t}\n\tp x\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nwhile(l=gets.split)!=[\"0\",\"0\"]\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp n.prime_division.map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do z=(z/a).to_i;r+=z end\n\t\t(r/b).to_i\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'prime'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp.split)!=[0,0]\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/=b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'prime'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/=b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'prime'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp.split)[0]>0\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/=b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nh={2=>[[2,1]],3=>[[3,1]],4=>[[2,2]],5=>[[5,1]],6=>[[2,1],[3,1]],7=>[[7,1]],8=>[[2,3]],9=>[[3,2]],10=>[[2,1],[5,1]],11=>[[11,1]],12=>[[2,2],[3,1]],13=>[[13,1]],14=>[[2,1],[7,1]],15=>[[3,1],[5,1]],16=>[[2,4]],17=>[[17,1]],18=>[[2,1],[3,2]],19=>[[19,1]],20=>[[2,2],[5,1]],21=>[[3,1],[7,1]],22=>[[2,1],[11,1]],23=>[[23,1]],24=>[[2,3],[3,1]],25=>[[5,2]],26=>[[2,1],[13,1]],27=>[[3,3]],28=>[[2,2],[7,1]],29=>[[29,1]],30=>[[2,1],[3,1],[5,1]],31=>[[31,1]],32=>[[2,5]],33=>[[3,1],[11,1]],34=>[[2,1],[17,1]],35=>[[5,1],[7,1]],36=>[[2,2],[3,2]]}\nwhile(l=gets.split)!=[\"0\",\"0\\n\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp n.prime_division.map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nh={2=>[[2,1]],3=>[[3,1]],4=>[[2,2]],5=>[[5,1]],6=>[[2,1],[3,1]],7=>[[7,1]],8=>[[2,3]],9=>[[3,2]],10=>[[2,1],[5,1]],11=>[[11,1]],12=>[[2,2],[3,1]],13=>[[13,1]],14=>[[2,1],[7,1]],15=>[[3,1],[5,1]],16=>[[2,4]],17=>[[17,1]],18=>[[2,1],[3,2]],19=>[[19,1]],20=>[[2,2],[5,1]],21=>[[3,1],[7,1]],22=>[[2,1],[11,1]],23=>[[23,1]],24=>[[2,3],[3,1]],25=>[[5,2]],26=>[[2,1],[13,1]],27=>[[3,3]],28=>[[2,2],[7,1]],29=>[[29,1]],30=>[[2,1],[3,1],[5,1]],31=>[[31,1]],32=>[[2,5]],33=>[[3,1],[11,1]],34=>[[2,1],[17,1]],35=>[[5,1],[7,1]],36=>[[2,2],[3,2]]}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets)!=\"0 0\\n\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets)!=\"0 0\\n\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=9999999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tif x>r.div(b) then x=r.div(b) end\n\t}\n\tp x\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'prime'\nwhile true\n\tl=gets.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp n.prime_division.map{|a,b|\n\t\tz=m\n\t\tr=0\n\t\twhile z>0 do\n\t\t\tr+=(z/=a)\n\t\tend\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nh={2=>[[2, 1]], 3=>[[3, 1]], 4=>[[2, 2]], 5=>[[5, 1]], 6=>[[2, 1], [3, 1]], 7=>[[7, 1]], 8=>[[2, 3]], 9=>[[3, 2]], 10=>[[2, 1], [5, 1]], 11=>[[11, 1]], 12=>[[2, 2], [3, 1]], 13=>[[13, 1]], 14=>[[2, 1], [7, 1]], 15=>[[3, 1], [5, 1]], 16=>[[2, 4]], 17=>[[17, 1]], 18=>[[2, 1], [3, 2]], 19=>[[19, 1]], 20=>[[2, 2], [5, 1]], 21=>[[3, 1], [7, 1]], 22=>[[2, 1], [11, 1]], 23=>[[23, 1]], 24=>[[2, 3], [3, 1]], 25=>[[5, 2]], 26=>[[2, 1], [13, 1]], 27=>[[3, 3]], 28=>[[2, 2], [7, 1]], 29=>[[29, 1]], 30=>[[2, 1], [3, 1], [5, 1]], 31=>[[31, 1]], 32=>[[2, 5]], 33=>[[3, 1], [11, 1]], 34=>[[2, 1], [17, 1]], 35=>[[5, 1], [7, 1]], 36=>[[2, 2], [3, 2]]}\nwhile true\n\tl=gets.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp h[n].map{|a,b|\n\t\tz=m\n\t\tr=0\n\t\twhile z>0 do\n\t\t\tr+=(z/=a)\n\t\tend\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=9999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tif x>r.div(b) then x=r.div(b) end\n\t}\n\tp x\nend"
  },
  {
    "language": "Ruby",
    "code": "require 'prime'\nloop {\n    n, m = gets.split\n    n = n.to_i\n    break if n == 0\n    m = m.to_i(n)  \n    a = []\n    Prime.prime_division(n).each{|q, k|\n        l = 0\n        f = q\n        while f <= m\n            l += m / f\n            f *= q \n        end\n        a << l / k\n    }\n    p a.min\n} "
  },
  {
    "language": "Ruby",
    "code": "require'prime'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n    l=l.split\n    n=l[0].to_i;m=l[1].to_i(n)\n    p h[n].map{|a,b|z=m;r=0;r+=(z/=a) while z>0;r/b}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=99999999999999999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tx=[x,r.div(b)].min\n\t}\n\tp x\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nh={2=>[[2,1]],3=>[[3,1]],4=>[[2,2]],5=>[[5,1]],6=>[[2,1],[3,1]],7=>[[7,1]],8=>[[2,3]],9=>[[3,2]],10=>[[2,1],[5,1]],11=>[[11,1]],12=>[[2,2],[3,1]],13=>[[13,1]],14=>[[2,1],[7,1]],15=>[[3,1],[5,1]],16=>[[2,4]],17=>[[17,1]],18=>[[2,1],[3,2]],19=>[[19,1]],20=>[[2,2],[5,1]],21=>[[3,1],[7,1]],22=>[[2,1],[11,1]],23=>[[23,1]],24=>[[2,3],[3,1]],25=>[[5,2]],26=>[[2,1],[13,1]],27=>[[3,3]],28=>[[2,2],[7,1]],29=>[[29,1]],30=>[[2,1],[3,1],[5,1]],31=>[[31,1]],32=>[[2,5]],33=>[[3,1],[11,1]],34=>[[2,1],[17,1]],35=>[[5,1],[7,1]],36=>[[2,2],[3,2]]}\nwhile true\n\tl=gets.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z/=a) end\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tr.div b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={2=>[[2, 1]], 3=>[[3, 1]], 4=>[[2, 2]], 5=>[[5, 1]], 6=>[[2, 1], [3, 1]], 7=>[[7, 1]], 8=>[[2, 3]], 9=>[[3, 2]], 10=>[[2, 1], [5, 1]], 11=>[[11, 1]], 12=>[[2, 2], [3, 1]], 13=>[[13, 1]], 14=>[[2, 1], [7, 1]], 15=>[[3, 1], [5, 1]], 16=>[[2, 4]], 17=>[[17, 1]], 18=>[[2, 1], [3, 2]], 19=>[[19, 1]], 20=>[[2, 2], [5, 1]], 21=>[[3, 1], [7, 1]], 22=>[[2, 1], [11, 1]], 23=>[[23, 1]], 24=>[[2, 3], [3, 1]], 25=>[[5, 2]], 26=>[[2, 1], [13, 1]], 27=>[[3, 3]], 28=>[[2, 2], [7, 1]], 29=>[[29, 1]], 30=>[[2, 1], [3, 1], [5, 1]], 31=>[[31, 1]], 32=>[[2, 5]], 33=>[[3, 1], [11, 1]], 34=>[[2, 1], [17, 1]], 35=>[[5, 1], [7, 1]], 36=>[[2, 2], [3, 2]]}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nwhile(l=gets.split)!=[\"0\",\"0\"]\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tp n.prime_division.map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do z=(z/a).to_i;r+=z end\n\t\tr/b\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.chomp)!=\"0 0\"\n\tl=l.split\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tp h[n].map{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div(a)) end\n\t\tr.div(b)\n\t}.min\nend"
  },
  {
    "language": "Ruby",
    "code": "#!/usr/bin/ruby\nrequire 'mathn'\nh={};2.step(36){|i|h[i]=i.prime_division}\nwhile(l=gets.split)!=[\"0\",\"0\"]\t\n\tn=l[0].to_i;m=l[1].to_i(n)\n\tif n==0 then break end\n\tx=99999999999999999999\n\th[n].each{|a,b|\n\t\tz=m;r=0\n\t\twhile z>0 do r+=(z=z.div a) end\n\t\tif x>r.div(b) then x=r.div(b) end\n\t}\n\tp x\nend"
  },
  {
    "language": "Python",
    "code": "import string\n\ndef conv(base, num):\n    ret = 0\n    for n in str(num):\n        if n in string.ascii_letters:\n            n = ord(n) - ord(\"A\") + 10\n        else:\n            n = int(n)\n        ret = ret * base + n\n    return ret\n\ndef get_fact(n):\n    ret = []\n    for i in xrange(2, n / 2 + 1):\n        cnt = 0\n        while n % i == 0:\n            cnt += 1\n            n /= i\n        if cnt != 0:\n            ret.append((i, cnt))\n    return ret\n\nwhile True:\n    base, num = raw_input().split()\n    if (base, num) == (\"0\", \"0\"):\n        break\n    base = int(base)\n    num = conv(base, num)\n    fact = get_fact(base)\n    ans = 1 << 30\n    for f,n in fact:\n        ff = f\n        cnt = 0\n        while ff <= num:\n            cnt += num / ff\n            ff *= f\n        ans = min(ans, cnt / n)\n    print ans"
  },
  {
    "language": "Python",
    "code": "import string\nINF = 1 << 30\n\ndef conv(base, num):\n    ret = 0\n    for n in str(num):\n        if n in string.ascii_letters:\n            n = ord(n) - ord(\"A\") + 10\n        else:\n            n = int(n)\n        ret = ret * base + n\n    return ret\n\ndef get_fact(n):\n    ret = []\n    for i in xrange(2, n + 1):\n        cnt = 0\n        while n % i == 0:\n            cnt += 1\n            n /= i\n        if cnt != 0:\n            ret.append((i, cnt))\n    return ret\n\nwhile True:\n    base, num = raw_input().split()\n    if (base, num) == (\"0\", \"0\"):\n        break\n    base = int(base)\n    num = conv(base, num)\n    fact = get_fact(base)\n    ans = [] #tmp\n    for f,n in fact:\n        ff = f\n        cnt = 0\n        while ff <= num:\n            cnt += num / ff\n            ff *= f\n        ans.append(cnt / n)\n    print min(ans)"
  },
  {
    "language": "Python",
    "code": "import string\nINF = 1 << 30\n\ndef conv(base, num):\n    ret = 0\n    for n in str(num):\n        if n in string.ascii_letters:\n            n = ord(n) - ord(\"A\") + 10\n        else:\n            n = int(n)\n        ret = ret * base + n\n    return ret\n\ndef get_fact(n):\n    ret = []\n    for i in xrange(2, n + 1):\n        cnt = 0\n        while n % i == 0:\n            cnt += 1\n            n /= i\n        if cnt != 0:\n            ret.append((i, cnt))\n    return ret\n\nwhile True:\n    base, num = raw_input().split()\n    if (base, num) == (\"0\", \"0\"):\n        break\n    base = int(base)\n    num = conv(base, num)\n    fact = get_fact(base)\n    ans = INF\n    for f,n in fact:\n        ff = f\n        cnt = 0\n        while ff <= num:\n            cnt += num / ff\n            ff *= f\n        ans = min(ans, cnt / n)\n    print ans if ans != INF else 0"
  },
  {
    "language": "Python",
    "code": "import string\n\nwhile(1):\n    [N,M]=raw_input().split()\n    N=int(N)\n    if N==0: break\n    S=string.digits+string.ascii_uppercase\n\n    prime=[2,3,5,7,11,13,17,19,23,29,31]\n    pc   =[0 for i in range(len(prime))]\n    ans=999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n    for i in range(len(prime)):\n        n=N\n        while(1):\n            if n%prime[i]==0:\n                n/=prime[i]\n                pc[i]+=1\n            else:\n                break\n    L=0\n    for i in range(1,len(M)+1):\n        c=M[-i]\n        L += S.index(c)*N**(i-1)\n    \n    for i in range(len(prime)):\n        p=prime[i]\n        if pc[i]!=0:\n            k=1\n            tmp=0\n            while(p**k<=L):\n                e=L/p**k\n                tmp+= e\n                k+=1\n            tmp/=pc[i]\n        ans=min(ans,tmp)\n    print ans\n    "
  },
  {
    "language": "Python",
    "code": "import string\n\ndef conv(base, num):\n    ret = 0\n    for n in str(num):\n        if n in string.ascii_letters:\n            n = ord(n) - ord(\"A\") + 10\n        else:\n            n = int(n)\n        ret = ret * base + n\n    return ret\n\ndef get_fact(n):\n    ret = []\n    for i in xrange(2, n + 1):\n        cnt = 0\n        while n % i == 0:\n            cnt += 1\n            n /= i\n        if cnt != 0:\n            ret.append((i, cnt))\n    return ret\n\nwhile True:\n    base, num = raw_input().split()\n    if (base, num) == (\"0\", \"0\"):\n        break\n    base = int(base)\n    num = conv(base, num)\n    fact = get_fact(base)\n    ans = 1 << 30\n    for f,n in fact:\n        ff = f\n        cnt = 0\n        while ff <= num:\n            cnt += num / ff\n            ff *= f\n        ans = min(ans, cnt / n)\n    print ans"
  },
  {
    "language": "Python",
    "code": "import string\n\nwhile(1):\n    [N,M]=raw_input().split()\n    N=int(N)\n    if N==0: break\n    S=string.digits+string.ascii_uppercase\n\n    prime=[2,3,5,7,11,13,17,19,23,29,31]\n    pc   =[0 for i in range(len(prime))]\n    ans=999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n    for i in range(len(prime)):\n        n=N\n        while(1):\n            if n%prime[i]==0:\n                n/=prime[i]\n                pc[i]+=1\n            else:\n                break\n    L=0\n    for i in range(1,len(M)+1):\n        c=M[-i]\n        L += S.index(c)*N**(i-1)\n    \n    for i in range(len(prime)):\n        k=1\n        p=prime[i]\n        if pc[i]!=0:\n            tmp=0\n            while(p**k<L):\n                e=L/p**k\n                tmp+= e\n                k+=1\n            tmp/=pc[i]\n        ans=min(ans,tmp)\n    print ans\n    "
  },
  {
    "language": "Python",
    "code": "import string\n\nwhile(1):\n    [N,M]=raw_input().split()\n    N=int(N)\n    if N==0: break\n    S=string.digits+string.ascii_uppercase\n\n    prime=[2,3,5,7,11,13,17,19,23,29,31]\n    pc   =[0 for i in range(len(prime))]\n    ans=999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n    for i in range(len(prime)):\n        n=N\n        while(1):\n            if n%prime[i]==0:\n                n/=prime[i]\n                pc[i]+=1\n            else:\n                break\n    L=0\n    for i in range(1,len(M)+1):\n        c=M[-i]\n        L += S.index(c)*N**(i-1)\n    \n    for i in range(len(prime)):\n        p=prime[i]\n        if pc[i]!=0:\n            k=1\n            tmp=0\n            while(p**k<=L):\n                e=L/p**k\n                tmp+= e\n                k+=1\n            tmp/=pc[i]\n            ans=min(ans,tmp)\n    print ans\n    "
  }
]