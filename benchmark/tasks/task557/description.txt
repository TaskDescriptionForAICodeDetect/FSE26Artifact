Ghosts are lined up in a straight line from left to right. Initially, the i-th ghost is facing left if U_i is 'L' or right if U_i is 'R'. They are very timid, and they want to avoid looking at scary ghosts. You can instruct each ghost to turn around. Turning around is scary, so the i-th ghost generates a fear level A_i when turning. A ghost facing left will turn right and a ghost facing right will turn left. There are M constraints given: the S_i-th ghost is scared of the T_i-th ghost. If in the final state, the S_i-th ghost faces the T_i-th ghost, a fear level B_i is generated. The task is to determine the minimum total fear level that occurs when you give optimal instructions.