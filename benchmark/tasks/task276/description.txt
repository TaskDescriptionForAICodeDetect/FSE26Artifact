Your task is to layout words from a given text into a grid with W columns while adhering to several formatting rules. The words must be placed in their original order without reordering. Each word must be separated by at least one space, and the number of columns occupied by a word must equal the number of characters in that word. Lines must be justified to both sides, with the first word starting at the first column and the last word of a line ending at the last column, except for the last line. The goal is to minimize the length of the longest contiguous spaces between words in the layout.