Given a straight tunnel crowded with ants moving in both directions, write a program to determine which ant is the last to leave the tunnel and how long it takes for all ants to exit. The task involves simulating the movement of ants that either pass each other or turn around if they encounter a narrow section. The input consists of data describing the number of ants, the length of the tunnel, and their initial directions and positions. The output should include the time before all ants leave and which ant is last to exit.