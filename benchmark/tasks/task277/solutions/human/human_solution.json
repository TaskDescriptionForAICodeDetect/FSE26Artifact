[
  {
    "language": "Scala",
    "code": "import scala.io.StdIn\n\n\nobject Main {\n  def main(args: Array[String]): Unit = {\n    while(true) {\n      val num :: length :: _ = StdIn.readLine().split(\" \").toList.map(_.toInt)\n      if(num == 0) {\n        return\n      }\n\n      l = length\n\n      val ants = (1 to num) map { i =>\n        val dir :: pos :: _ = StdIn.readLine().split(\" \").toList\n        (dir, pos.toInt)\n      }\n      println(solve(ants))\n    }\n  }\n  var l: Int = 0\n\n  def solve(ants: Seq[(String, Int)]): String = {\n    val antsWithIndex = ants.zipWithIndex.map{ case ((di, po), id) => (di, po, id + 1) }\n    val odds = antsWithIndex.filter(_._2 % 2 == 1)\n    val evens = antsWithIndex.filter(_._2 % 2 == 0)\n\n    val or = solve2(odds, 0)\n    val er = solve2(evens, 0)\n\n    if(or._1 > er._1) {\n      s\"${or._1} ${or._2}\"\n    } else {\n      s\"${er._1} ${er._2}\"\n    }\n  }\n\n  def solve2(ants: Seq[(String, Int, Int)], carry: Int):(Int, Int) = {\n    if(ants.size == 0) { (-1, -1) }\n    else if(ants.size == 1) {\n      val a = ants.head\n      val time = if(a._1 == \"R\") {\n        l - a._2\n      } else {\n        a._2\n      }\n      (time + carry, a._3)\n    } else if(ants.size == 2) {\n      val a1 = ants(0)\n      val a2 = ants(1)\n\n      (a1._1, a2._1) match {\n        case (\"L\", \"L\") =>\n          (a2._2 + carry, a2._3)\n        case (\"R\", \"R\") =>\n          (l - a1._2 + carry, a1._3)\n        case (\"R\", \"L\") =>\n          val suc = (a2._2 - a1._2) / 2\n          solve2( Seq((\"L\", a1._2 + suc, a1._3), (\"R\", a2._2 - suc, a2._3)), carry + suc)\n        case _ =>\n          (a1._2, l - a2._2) match {\n            case (x1, x2) if x1 == x2 => (carry + x1, a1._3)\n            case (x1, x2) if x1 < x2 => (carry + x2, a2._3)\n            case (x1, x2) if x1 > x2 => (carry + x1, a1._3)\n          }\n      }\n    }\n    //else if(ants.head._1 == \"L\") { solve2(ants.tail, carry) }\n    //else if (ants.last._1 == \"R\") { solve2(ants.init, carry) }\n    else {\n      val collable = ants.sliding(2).flatMap{ s =>\n        if(s(0)._1 == \"R\" && s(1)._1 == \"L\") {\n          Some((s(1)._2 - s(0)._2) / 2)\n        } else None\n      }.toSeq\n      if(collable.isEmpty) {\n        val max = ants.map{ case (di, po, in) =>\n          val res = if(di == \"R\") { l - po } else po\n          (res, in)\n        }.maxBy(_._1)\n        return (max._1 + carry, max._2)\n      }\n\n      val coll = collable.min\n\n      val suc = ants.flatMap{ case (di, po, in) =>\n        val newpo = if(di == \"R\") { po + coll } else { po - coll }\n        if(1 <= newpo && newpo <= l - 1) {\n          Some((di, newpo, in))\n        } else None\n      }\n\n      val flip = suc.map(_._2).groupBy(a => a).toList.filter(_._2.size > 1).map(_._1).toSet\n\n      val next = suc.map {\n        case x@(di, po, in) =>\n          if(flip(po)) {\n            val newdi = if(di == \"R\") \"L\" else \"R\"\n            (newdi, po, in)\n          } else x\n      }\n\n      solve2(next, carry + coll)\n    }\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import scala.io.StdIn\n\n\nobject Main {\n  def main(args: Array[String]): Unit = {\n    while(true) {\n      val num :: length :: _ = StdIn.readLine().split(\" \").toList.map(_.toInt)\n      if(num == 0) {\n        return\n      }\n\n      l = length\n\n      val ants = (1 to num) map { i =>\n        val dir :: pos :: _ = StdIn.readLine().split(\" \").toList\n        (dir, pos.toInt)\n      }\n      println(solve(ants))\n    }\n  }\n  var l: Int = 0\n\n  def solve(ants: Seq[(String, Int)]): String = {\n    val antsWithIndex = ants.zipWithIndex.map{ case ((di, po), id) => (di, po, id + 1) }\n    val odds = antsWithIndex.filter(_._2 % 2 == 1)\n    val evens = antsWithIndex.filter(_._2 % 2 == 0)\n\n    val or = solve2(odds, 0)\n    val er = solve2(evens, 0)\n\n    if(or._1 > er._1) {\n      s\"${or._1} ${or._2}\"\n    } else {\n      s\"${er._1} ${er._2}\"\n    }\n  }\n\n  def solve2(ants: Seq[(String, Int, Int)], carry: Int):(Int, Int) = {\n    if(ants.size == 0) { (-1, -1) }\n    else if(ants.size == 1) {\n      val a = ants.head\n      val time = if(a._1 == \"R\") {\n        l - a._2\n      } else {\n        a._2\n      }\n      (time + carry, a._3)\n    } else if(ants.size == 2) {\n      val a1 = ants(0)\n      val a2 = ants(1)\n\n      (a1._1, a2._1) match {\n        case (\"L\", \"L\") =>\n          (a2._2 + carry, a2._3)\n        case (\"R\", \"R\") =>\n          (l - a1._2 + carry, a1._3)\n        case (\"R\", \"L\") =>\n          val suc = (a2._2 - a1._2) / 2\n          solve2( Seq((\"L\", a1._2 + suc, a1._3), (\"R\", a2._2 - suc, a2._3)), carry + suc)\n        case _ =>\n          (a1._2, l - a2._2) match {\n            case (x1, x2) if x1 == x2 => (carry + x1, a1._3)\n            case (x1, x2) if x1 < x2 => (carry + x2, a2._3)\n            case (x1, x2) if x1 > x2 => (carry + x1, a1._3)\n          }\n      }\n    }\n    else if(ants.head._1 == \"L\") { solve2(ants.tail, carry) }\n    else if (ants.last._1 == \"R\") { solve2(ants.init, carry) }\n    else {\n      val sl = ants.sliding(2)\n      val coll = sl.flatMap{ s =>\n        if(s(0)._1 == \"R\" && s(1)._1 == \"L\") {\n          Some((s(1)._2 - s(0)._2) / 2)\n        } else None\n      }.min\n\n      val suc = ants.flatMap{ case (di, po, in) =>\n        val newpo = if(di == \"R\") { po + coll } else { po - coll }\n        if(1 <= newpo && newpo <= l - 1) {\n          Some((di, newpo, in))\n        } else None\n      }\n\n      val flip = suc.map(_._2).groupBy(a => a).toList.filter(_._2.size > 1).map(_._1).toSet\n\n      val next = suc.map {\n        case x@(di, po, in) =>\n          if(flip(po)) {\n            val newdi = if(di == \"R\") \"L\" else \"R\"\n            (newdi, po, in)\n          } else x\n      }\n\n      solve2(next, carry + coll)\n    }\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import scala.io.StdIn\n\n\nobject Main {\n  def main(args: Array[String]): Unit = {\n    while(true) {\n      val num :: length :: _ = StdIn.readLine().split(\" \").toList.map(_.toInt)\n      if(num == 0) {\n        return\n      }\n\n      l = length\n\n      val ants = (1 to num) map { i =>\n        val dir :: pos :: _ = StdIn.readLine().split(\" \").toList\n        (dir, pos.toInt)\n      }\n      println(solve(ants))\n    }\n  }\n  var l: Int = 0\n\n  def solve(ants: Seq[(String, Int)]): String = {\n    val antsWithIndex = ants.zipWithIndex.map{ case ((di, po), id) => (di, po, id + 1) }\n    val odds = antsWithIndex.filter(_._2 % 2 == 1)\n    val evens = antsWithIndex.filter(_._2 % 2 == 0)\n\n    val or = solve2(odds, 0)\n    val er = solve2(evens, 0)\n\n    if(or._1 == er._1) {\n      val i = if(or._3 == \"L\") or._2 else er._2\n      s\"${or._1} ${i}\"\n    } else if(or._1 > er._1) {\n      s\"${or._1} ${or._2}\"\n    } else {\n      s\"${er._1} ${er._2}\"\n    }\n  }\n\n  def solve2(ants: Seq[(String, Int, Int)], carry: Int):(Int, Int, String) = {\n    if(ants.size == 0) { (-1, -1, \"R\") }\n    else if(ants.size == 1) {\n      val a = ants.head\n      if(a._1 == \"R\") {\n        (l - a._2 + carry, a._3, \"R\")\n      } else {\n        (a._2 + carry, a._3, \"L\")\n      }\n    } else if(ants.size == 2) {\n      val a1 = ants(0)\n      val a2 = ants(1)\n\n      (a1._1, a2._1) match {\n        case (\"L\", \"L\") =>\n          (a2._2 + carry, a2._3, \"L\")\n        case (\"R\", \"R\") =>\n          (l - a1._2 + carry, a1._3, \"R\")\n        case (\"R\", \"L\") =>\n          val suc = (a2._2 - a1._2) / 2\n          solve2( Seq((\"L\", a1._2 + suc, a1._3), (\"R\", a2._2 - suc, a2._3)), carry + suc)\n        case _ => // L R\n          (a1._2, l - a2._2) match {\n            case (x1, x2) if x1 == x2 => (carry + x1, a1._3, \"L\")\n            case (x1, x2) if x1 < x2 => (carry + x2, a2._3, \"R\")\n            case (x1, x2) if x1 > x2 => (carry + x1, a1._3, \"L\")\n          }\n      }\n    }\n    else {\n      val collable = ants.sliding(2).flatMap{ s =>\n        if(s(0)._1 == \"R\" && s(1)._1 == \"L\") {\n          Some((s(1)._2 - s(0)._2) / 2)\n        } else None\n      }.toSeq\n      if(collable.isEmpty) {\n        val moved = ants.map{ case (di, po, in) =>\n          val res = if(di == \"R\") { l - po } else po\n          (res + carry, in, di)\n        }\n        val max = moved.map(_._1).max\n        return moved.filter(_._1 == max).head\n      }\n\n      val coll = collable.min\n\n      val suc = ants.flatMap{ case (di, po, in) =>\n        val newpo = if(di == \"R\") { po + coll } else { po - coll }\n        if(1 <= newpo && newpo <= l - 1) {\n          Some((di, newpo, in))\n        } else None\n      }\n\n      val flip = suc.map(_._2).groupBy(a => a).toList.filter(_._2.size > 1).map(_._1).toSet\n\n      val next = suc.map {\n        case x@(di, po, in) =>\n          if(flip(po)) {\n            val newdi = if(di == \"R\") \"L\" else \"R\"\n            (newdi, po, in)\n          } else x\n      }\n\n      solve2(next, carry + coll)\n    }\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import scala.io.StdIn\n\n\nobject Main {\n  def main(args: Array[String]): Unit = {\n    while(true) {\n      val num :: length :: _ = StdIn.readLine().split(\" \").toList.map(_.toInt)\n      if(num == 0) {\n        return\n      }\n\n      l = length\n\n      val ants = (1 to num) map { i =>\n        val dir :: pos :: _ = StdIn.readLine().split(\" \").toList\n        (dir, pos.toInt)\n      }\n      println(solve(ants))\n    }\n  }\n  var l: Int = 0\n\n  def solve(ants: Seq[(String, Int)]): String = {\n    val antsWithIndex = ants.zipWithIndex.map{ case ((di, po), id) => (di, po, id + 1) }\n    val odds = antsWithIndex.filter(_._2 % 2 == 1)\n    val evens = antsWithIndex.filter(_._2 % 2 == 0)\n\n    val or = solve2(odds, 0)\n    val er = solve2(evens, 0)\n\n    if(or._1 > er._1) {\n      s\"${or._1} ${or._2}\"\n    } else {\n      s\"${er._1} ${er._2}\"\n    }\n  }\n\n  def solve2(ants: Seq[(String, Int, Int)], carry: Int):(Int, Int) = {\n    if(ants.size == 0) { (-1, -1) }\n    else if(ants.size == 1) {\n      val a = ants.head\n      val time = if(a._1 == \"R\") {\n        l - a._2\n      } else {\n        a._2\n      }\n      (time + carry, a._3)\n    } else if(ants.size == 2) {\n      val a1 = ants(0)\n      val a2 = ants(1)\n\n      (a1._1, a2._1) match {\n        case (\"L\", \"L\") =>\n          (a2._2 + carry, a2._3)\n        case (\"R\", \"R\") =>\n          (l - a1._2 + carry, a1._3)\n        case (\"R\", \"L\") =>\n          val suc = (a2._2 - a1._2) / 2\n          solve2( Seq((\"L\", a1._2 + suc, a1._3), (\"R\", a2._2 - suc, a2._3)), carry + suc)\n        case _ =>\n          (a1._2, l - a2._2) match {\n            case (x1, x2) if x1 == x2 => (carry + x1, a1._3)\n            case (x1, x2) if x1 < x2 => (carry + x2, a2._3)\n            case (x1, x2) if x1 > x2 => (carry + x1, a1._3)\n          }\n      }\n    }\n    //else if(ants.head._1 == \"L\") { solve2(ants.tail, carry) }\n    //else if (ants.last._1 == \"R\") { solve2(ants.init, carry) }\n    else {\n      val collable = ants.sliding(2).flatMap{ s =>\n        if(s(0)._1 == \"R\" && s(1)._1 == \"L\") {\n          Some((s(1)._2 - s(0)._2) / 2)\n        } else None\n      }.toSeq\n      if(collable.isEmpty) {\n        val max = ants.map{ case (di, po, in) =>\n          val res = if(di == \"R\") { l - po } else po\n          (res, in)\n        }.maxBy(_._1)\n        return (max._1 + carry, max._2)\n      }\n\n      val coll = collable.min\n\n      val suc = ants.flatMap{ case (di, po, in) =>\n        val newpo = if(di == \"R\") { po + coll } else { po - coll }\n        if(1 <= newpo && newpo <= l - 1) {\n          Some((di, newpo, in))\n        } else None\n      }\n\n      val flip = suc.map(_._2).groupBy(a => a).toList.filter(_._2.size > 1).map(_._1).toSet\n\n      val next = suc.map {\n        case x@(di, po, in) =>\n          if(flip(po)) {\n            val newdi = if(di == \"R\") \"L\" else \"R\"\n            (newdi, po, in)\n          } else x\n      }\n\n      solve2(next, carry + coll)\n    }\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import scala.io.StdIn\n\n\nobject Main {\n  def main(args: Array[String]): Unit = {\n    while(true) {\n      val num :: length :: _ = StdIn.readLine().split(\" \").toList.map(_.toInt)\n      if(num == 0) {\n        return\n      }\n\n      l = length\n\n      val ants = (1 to num) map { i =>\n        val dir :: pos :: _ = StdIn.readLine().split(\" \").toList\n        (dir, pos.toInt)\n      }\n      println(solve(ants))\n    }\n  }\n  var l: Int = 0\n\n  def solve(ants: Seq[(String, Int)]): String = {\n    val antsWithIndex = ants.zipWithIndex.map{ case ((di, po), id) => (di, po, id + 1) }\n    val odds = antsWithIndex.filter(_._2 % 2 == 1)\n    val evens = antsWithIndex.filter(_._2 % 2 == 0)\n\n    val or = solve2(odds, 0)\n    val er = solve2(evens, 0)\n\n    if(or._1 > er._1) {\n      s\"${or._1} ${or._2}\"\n    } else {\n      s\"${er._1} ${er._2}\"\n    }\n  }\n\n  def solve2(ants: Seq[(String, Int, Int)], carry: Int):(Int, Int) = {\n    if(ants.size == 0) { (-1, -1) }\n    else if(ants.size == 1) {\n      val a = ants.head\n      val time = if(a._1 == \"R\") {\n        l - a._2\n      } else {\n        a._2\n      }\n      (time + carry, a._3)\n    } else if(ants.size == 2) {\n      val a1 = ants(0)\n      val a2 = ants(1)\n\n      (a1._1, a2._1) match {\n        case (\"L\", \"L\") =>\n          (a2._2 + carry, a2._3)\n        case (\"R\", \"R\") =>\n          (l - a1._2 + carry, a1._3)\n        case (\"R\", \"L\") =>\n          val suc = (a2._2 - a1._2) / 2\n          solve2( Seq((\"L\", a1._2 + suc, a1._3), (\"R\", a2._2 - suc, a2._3)), carry + suc)\n        case _ =>\n          (a1._2, l - a2._2) match {\n            case (x1, x2) if x1 == x2 => (carry + x1, a1._3)\n            case (x1, x2) if x1 < x2 => (carry + x2, a2._3)\n            case (x1, x2) if x1 > x2 => (carry + x1, a1._3)\n          }\n      }\n    }\n    else if(ants.head._1 == \"L\") { solve2(ants.tail, carry) }\n    else if (ants.last._1 == \"R\") { solve2(ants.init, carry) }\n    else {\n      val sl = ants.sliding(2)\n      val coll = sl.flatMap{ s =>\n        if(s(0)._1 == \"R\" && s(1)._1 == \"L\") {\n          Some((s(1)._2 - s(0)._2) / 2)\n        } else None\n      }.max\n\n      val suc = ants.flatMap{ case (di, po, in) =>\n        val newpo = if(di == \"R\") { po + coll } else { po - coll }\n        if(1 <= newpo && newpo <= l - 1) {\n          Some((di, newpo, in))\n        } else None\n      }\n\n      val flip = suc.map(_._2).groupBy(a => a).toList.filter(_._2.size == 2).map(_._1).toSet\n\n      val next = suc.map {\n        case x@(di, po, in) =>\n          if(flip(po)) {\n            val newdi = if(di == \"R\") \"L\" else \"R\"\n            (newdi, po, in)\n          } else x\n      }\n\n      solve2(next, carry + coll)\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstruct ant{int x,d,s,i;};\nint main(){\n  int n,l;\n  cin >> n >> l;\n  while(n!=0){\n    int i,j,k;\n    ant as[30];\n    bool f[30];\n    char c;\n    for(i=0;i<n;i++){\n      cin >> c >> as[i].x;\n      if(c=='R') as[i].d=1;\n      else as[i].d=-1;\n      as[i].s=1;\n      as[i].i=i;\n      f[i]=false;\n    }\n    k=1;\n    bool fl=true;\n    while(fl){\n      fl=false;\n      for(i=0;i<n;i++) {\n\tif(!f[i]) {\n\t  as[i].x+=as[i].d;\n\t  if(as[i].x<=0||as[i].x>=l) f[i]=true;\n\t  else as[i].s++;\n\t  fl=true;\n\t}\n      }\n      for(i=0;i<n;i++) {\n\tif(f[i]) continue;\n\tfor(j=i+1;j<n;j++) {\n\t  if(f[j]) continue;\n\t  if(as[i].x==as[j].x) swap(as[i].i,as[j].i);\n\t}\n      }\n    }\n    int o=0,id=0;\n    for(i=0;i<n;i++) {\n      //cout << o << as[i].d << \":\" << as[i].i<<endl;\n      if(o<=as[i].s){\n\tif(o==as[i].s&&as[i].d==1) continue;\n\t\n\to=as[i].s;id=as[i].i;\n      }\n    }\n    cout << o <<\" \" << id+1 << endl;\n    cin >> n >> l;\n  }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct Ant{\n    int index;\n    int dir;\n    int pos;  \n};\n\nint solve(int n,int l){\n    vector<Ant> ant(n);\n    for(int i=0;i<n;i++){\n        char d;\n        int pos;\n        cin>>d>>pos;\n        ant[i].index=i+1;\n        ant[i].pos=pos;\n        if(d=='R'){\n            ant[i].dir=1;\n        }\n        else{\n            ant[i].dir=-1;\n        }\n    }\n    \n    int cnt=n;\n    for(int t=1;;t++){\n        int res=-1;\n        for(int i=0;i<n;i++){\n            if(ant[i].index==-1) continue;\n            ant[i].pos+=ant[i].dir;\n        }\n        \n        for(int i=0;i<n;i++){\n            if(ant[i].index==-1) continue;\n            if(ant[i].pos==0){                \n                cnt--;\n                res=ant[i].index;\n                if(cnt==0){\n                    cout<<t<<\" \"<<res<<endl;\n                    return 0;\n                }\n                ant[i].index=-1;\n                continue;\n            }\n            else if(ant[i].pos==l){\n                cnt--;\n                if(cnt==0){\n                    if(res==-1) cout<<t<<\" \"<<ant[i].index<<endl;\n                    else cout<<t<<\" \"<<res<<endl;\n                    return 0;\n                }\n                ant[i].index=-1;\n                continue;\n            }\n            for(int j=i+1;j<n;j++){\n                if(ant[i].pos==ant[j].pos){\n                    ant[i].dir=-ant[i].dir;\n                    ant[j].dir=-ant[j].dir;\n                }\n            }\n        }\n    }\n    return 0;\n}\n\nint main(){\n    int n,l;\n    while(cin>>n>>l,n){\n        solve(n,l);\n    }\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct Ant {\n\tint id, pos, dir;\n\tAnt(){}\n\tAnt(int id, int pos, int dir): id(id), pos(pos), dir(dir){}\n};\n\nint n, l;\nvector<Ant> a;\n\nvoid solve()\n{\n\tvector<pair<int, int>> v;\n\tfor (int t = 1; a.size(); t++){\n\t\tsort(a.begin(), a.end(), [](const Ant &a, const Ant &b){\n\t\t\treturn a.pos == b.pos ? a.dir < b.dir : a.pos > b.pos;\n\t\t});\n\t\tfor (int i = 0; i < a.size(); i++){\n\t\t\tauto &A = a[i];\n\t\t\tA.pos += A.dir;\n\t\t\tif (A.pos == 0 || A.pos == l){\n\t\t\t\tv.emplace_back(make_pair(t, A.id));\n\t\t\t\ta.erase(a.begin() + i--);\n\t\t\t}\n\t\t}\n\t\tsort(a.begin(), a.end(), [](const Ant &a, const Ant &b){\n\t\t\treturn a.pos == b.pos ? a.dir < b.dir : a.pos < b.pos;\n\t\t});\n\t\tfor (int i = 0; i + 1 < a.size(); i++){\n\t\t\tif (a[i].pos == a[i + 1].pos){\n\t\t\t\tswap(a[i].dir, a[i + 1].dir);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"\t%d %d\\n\", v.back().first, v.back().second);\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d\", &n, &l), n){\n\t\ta.clear();\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tstring d;\n\t\t\tint p;\n\t\t\tcin >> d >> p;\n\t\t\ta.push_back(Ant(i + 1, p, d == \"R\" ? 1 : -1));\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// Author :\n// Date :\n// Problem:\n// Solution:\n// Comment:\n\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <cmath>\n#include <cstring>\n\n#define pp push\n#define pb push_back\n#define mp make_pair\n#define xx first\n#define yy second\n\nusing namespace std;\n\nvoid play(int n , int l){\n    int pos[105][2]={0};\n    int time=0;\n    int left = n;\n    string dir;\n    int loc;\n    int ans;\n    \n    for(int i = 1 ; i <= n ; i++){\n        cin >> dir >> loc;\n        if(dir == \"R\") pos[loc][0] = i;\n        else pos[loc][1] = i;\n    }\n    \n    //cout << left << endl << endl;;\n    string str;\n    while(left > 0){\n        int moved[100] = {0};\n        for(int i = 1 ; i<=l ; i++){\n            if(pos[i][1] != 0 && moved[pos[i][1]] == 0){ // Left\n                //cout << \"L \" << pos[i][1]<< endl;\n                \n                moved[pos[i][1]] = 1;\n                pos[i-1][1] = pos[i][1];\n                pos[i][1] = 0;\n            }\n            /*\n            if(pos[i][0] != 0 && pos[i+2][1] != 0 && moved[pos[i][0]] == 0 && moved[pos[i+2][1]] == 0){ // Collide\n                cout << \"Col \" << pos[i][0] << \" \" << pos[i+2][1] << endl;\n                moved[pos[i][0]] = 1;\n                moved[pos[i+2][1]] = 1;\n                pos[i+1][1] = pos[i][0];\n                pos[i][0] = 0;\n                pos[i+1][0] = pos[i+2][1];\n                pos[i+2][1] = 0;\n            }\n            /*\n            if(pos[i][0] != 0 && pos[i+1][1] != 0 && moved[pos[i][0]] == 0 && moved[pos[i+1][1]] == 0){ // Pass\n                cout << \"Pass \" << pos[i][0] << \" \" << pos[i+1][1] << endl;\n                moved[pos[i][0]] = 1;\n                moved[pos[i+1][1]] = 1;\n                pos[i+1][0] = pos[i][0];\n                pos[i][1] = pos[i+1][1];\n                \n                pos[i+1][1] = 0;\n                pos[i][0] = 0;\n            }\n            */\n            \n        }\n        for(int i = l; i >= 1 ; i--){\n            if(pos[i][0] != 0 && moved[pos[i][0]] == 0){ // Right\n                //cout << \"R \" << pos[i][0] << endl;\n                moved[pos[i][0]] = 1;\n                pos[i+1][0] = pos[i][0];\n                pos[i][0] = 0;\n            }\n        }\n        \n        for(int i = 1 ; i<=l ; i++){\n            if(pos[i][0] && pos[i][1]){\n                swap(pos[i][0],pos[i][1]);\n            }\n        }\n        if(pos[l][0]){\n                if(left == 1) ans = pos[l][0];\n                //cout << \"LeaveR \" << pos[l][0] << endl;\n                pos[l][0] = 0;\n                left--;\n        }\n        if(pos[0][1]){\n                if(left == 1) ans = pos[0][1];\n                //cout << \"LeaveL \" << pos[0][1] << endl; \n                pos[0][1] = 0;\n                left--;\n        }\n        time++;\n        //cout << endl << endl;\n        //cout << left << endl;\n        //cin >> str;\n    }\n    \n    cout << time << \" \" << ans << endl;\n}\nmain(){\n    int n,l;\n    \n    while(true){\n        cin >> n >> l;\n        if( n == 0) break;\n        \n        play(n,l);\n    }\n    \n    #ifdef GEREL\n        for(;;);\n    #endif\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repeat(i, j, n) for(int i = (j); i < (n); i++)\n#define all(v) begin(v), end(v)\n\nusing ll = long long;\n\nusing namespace std;\n\nvoid solve(int N, int L){\n\tvector<pair<int, int>> dp(N); // dir, pos\n\tfor(auto &a:dp){\n\t\tstring s; cin >> s;\n\t\tint d;\n\t\tif(s == \"R\"){\n\t\t\td = 1;\n\t\t}\n\t\telse{\n\t\t\td = -1;\n\t\t}\n\t\tint p; cin >> p;\n\t\ta.first = d;\n\t\ta.second = p;\n\t}\n\n\tint t = 0;\n\twhile(true){\n\t\tbool f = false;\n\t\tint last_ant = -1;\n\t\trep(i, dp.size()){\n\t\t\tauto &a = dp[i];\n\t\t\tif(0 < a.second and a.second < L){\n\t\t\t\tf = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(0 == a.second){\n\t\t\t\tlast_ant = i;\n\t\t\t}\n\t\t\tif(last_ant == -1 and L == a.second){\n\t\t\t\tlast_ant = i;\n\t\t\t}\n\t\t}\n\t\tif(not f){\n\t\t\tcout << t << \" \" << last_ant+1 << endl;\n\t\t\tbreak;\n\t\t}\n\n\t\tmap<int, int> memo;\n\t\trep(i,dp.size()){\n\t\t\tauto &a = dp[i];\n\t\t\ta.second += a.first;\n\t\t\tif(memo.count(a.second) == 0){\n\t\t\t\tmemo[a.second] = i;\n\t\t\t}\n\t\t\telse{\n\t\t\t\ta.first *= -1;\n\t\t\t\tdp[memo[a.second]].first *= -1;\n\t\t\t}\n\t\t}\n\t\t++t;\n\t}\n}\n\nint main() {\n\twhile(true){\n\t\tint N, L; cin >> N >> L;\n\t\tif(N == 0 and L == 0) break;\n\t\tsolve(N, L);\n\t}\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<char, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint n,l;\nPPI ants[22];\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>n>>l;\n\t\tif(n==0)break;\n\t\trep(i,n){\n\t\t\tcin>>ants[i].fi.fi>>ants[i].fi.se;\n\t\t\tants[i].se=i;\n\t\t}\n\t\tint last=0,cnt=0;\n\t\trepl(t,1,l+1){\n\t\t\trep(i,n){\n\t\t\t\tif(ants[i].fi.fi=='L'){\n\t\t\t\t\tants[i].fi.se--;\n\t\t\t\t\tif(ants[i].fi.se==0){\n\t\t\t\t\t\tlast=t;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tants[i].fi.se++;\n\t\t\t\t\tif(ants[i].fi.se==l){\n\t\t\t\t\t\tlast=t;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt==n)break;\n\t\t\trep(i,n)rep(j,i){\n\t\t\t\tif(ants[i].fi.se==ants[j].fi.se){\n\t\t\t\t\tswap(ants[i].se,ants[j].se);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint idx;\n\t\trep(i,n){\n\t\t\tif(ants[i].fi.se==l)idx=ants[i].se;\n\t\t}\n\t\trep(i,n){\n\t\t\tif(ants[i].fi.se==0)idx=ants[i].se;\n\t\t}\n\t\tcout<<last<<\" \"<<idx+1<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//Name: The Last Ant\n//Level: 2\n//Category: シミュレーション\n//Note:\n\n/**\n * 細いところにいるアリを管理して1秒ずつシミュレーションする。\n * 2匹のアリが衝突するとき、隣り合ったセルにいた場合は、1秒後にはすれ違っているので問題ない。\n * 1つ離れたマスにいた場合は、移動後に向きを反転する。\n *\n * 向きの反転を考えた場合でも、アリを区別しなければそのまますれ違ったのと同じなので、\n * 全てのアリが脱出するまでの時間は高々l秒である。\n * したがって、この愚直なシミュレーションで間に合う。\n *\n * オーダーは O(NL)。\n */\n#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nbool solve() {\n    int N, L;\n    if(!(cin >> N >> L)) return false;\n    if(!N && !L) return false;\n\n    vector<vector<pair<int,int>>> ants(L+1), buf(L+1);\n    for(int i = 0; i < N; ++i) {\n        char c;\n        int x;\n        cin >> c >> x;\n        ants[x].emplace_back(i, c == 'L' ? -1 : 1);\n    }\n\n    int rem = N;\n    int last = -1;\n    int turn = 0;\n    while(rem) {\n        ++turn;\n        for(int i = 0; i < L+1; ++i) {\n            buf[i].clear();\n        }\n        for(int i = 0; i < L+1; ++i) {\n            for(const auto &ant : ants[i]) {\n                buf[i + ant.second].push_back(ant);\n            }\n        }\n        for(int i = 0; i < L+1; ++i) {\n            if(buf[i].size() == 2) {\n                buf[i][0].second *= -1;\n                buf[i][1].second *= -1;\n            }\n        }\n        if(buf.back().size() > 0) {\n            last = buf.back()[0].first;\n            buf.back().clear();\n            --rem;\n        }\n        if(buf[0].size() > 0) {\n            last = buf[0][0].first;\n            buf[0].clear();\n            --rem;\n        }\n        ants.swap(buf);\n    }\n    cout << turn << ' ' << last+1 << endl;\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n\n    while(solve()) ;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nchar T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;\nint main(){\nwhile(1){\nM=0;\nmemset(y,0,3996);\ncin>>b>>l;if(!l){break;}\nfor(i=1;i<=b;i++){\ncin>>T>>x[i];\nif(T=='L'){d[i]=0;M=max(M,x[i]);}\nelse{d[i]=1;M=max(M,l-x[i]);}\n}\nN=0;\nfor(i=1;i<M+2;i++){\nmemset(z,0,sizeof(z));\nfor(j=b;j>0; j--) {\nif(!y[j]) {\nif(!d[j]){\nx[j]--;\n}\nelse{\nx[j]++;\n}\nif(x[j]<0||x[j]>l){\ny[j]=1;\n}\nelse{\nz[x[j]]++;\n}\nif(M+1==i){\nif(N){\nif(x[j]<0){N=j;}\n}\nelse{\nN=j;\n}\n}\n}\n}\nfor(j=b;j>0;j--){\nif(z[x[j]]>1){\nif(d[j]){d[j]=0;}\nelse{d[j]=1;}\n}\n}\n}\nprintf(\"%d %d\\n\",M,N);\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nmain()\n{\n\tint n,l;\n\twhile(cin>>n>>l,n)\n\t{\n\t\tvector<pair<int,int> >now(l,make_pair(-1,0));\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tchar c;int m;cin>>c>>m;\n\t\t\tnow[m].first=c=='L'?0:1;\n\t\t\tnow[m].second=i+1;\n\t\t}\n\t\tbool flag=true;\n\t\tint cnt=1;\n\t\twhile(flag)\n\t\t{\n\t\t\tcnt++;\n\t\t\tvector<pair<int,int> >nex(l,make_pair(-1,0));\n\t\t\tfor(int i=1;i<l;i++)\n\t\t\t{\n\t\t\t\tif(now[i].second==0)continue;\n\t\t\t\tif(now[i].first!=1)\n\t\t\t\t{\n\t\t\t\t\tif(i==1)continue;\n\t\t\t\t\telse if(now[i-2].first<=0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnex[i-1].first=0;\n\t\t\t\t\t\tnex[i-1].second=now[i].first==0?now[i].second:now[i].second%100;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(now[i].first!=0)\n\t\t\t\t{\n\t\t\t\t\tif(i==l-1)continue;\n\t\t\t\t\telse if(i>=l-2||now[i+2].first==1||now[i+2].first==-1)\n\t\t\t\t\t{\n\t\t\t\t\t\tnex[i+1].first=1;\n\t\t\t\t\t\tnex[i+1].second=now[i].first==1?now[i].second:now[i].second/100;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnex[i+1].first=2;\n\t\t\t\t\t\tnex[i+1].second=(now[i].first==1?now[i].second:now[i].second/100)\n\t\t\t\t\t\t\t+now[i+2].second%100*100;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tnow=nex;\n\t\t\tflag=false;\n\t\t\tfor(int i=2;i<l-1;i++)flag|=now[i].second>0;\n\t\t}\n\t\tcout<<cnt<<\" \";\n\t\tif(now[1].second>0)\n\t\t{\n\t\t\tcout<<now[1].second<<endl;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcout<<now[l-1].second<<endl;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n// #include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i=(int)(a); i<(int)(b); ++i)\n#define REP(i, n) for(int i=0; i<(int)(n); ++i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nstruct ant {\n  char d;\n  int p;\n};\n\nint main() {\n  int n, l;\n  while(cin >> n >> l, n | l) {\n    vector<ant> ants(n);\n    REP(i, n){\n      cin >> ants[i].d >> ants[i].p;\n      ants[i].d = ants[i].d == 'L' ? -1 : 1;\n    }\n\n    int field[l + 1];\n    for(int t = 1;; t++) {\n      fill_n((int *)field, l + 1, -1);\n      int last = -1;\n      bool update = false;\n\n      REP(i, n){\n        if(ants[i].p <=0 || ants[i].p >= l) continue;\n        ants[i].p += ants[i].d;\n        if(ants[i].p <=0 || ants[i].p >= l) {\n          // LOG(\"out : %d at %d --- %d\\n\", i + 1, t, ants[i].p);\n          if(last == -1 || ants[last].p != 0) {\n            last = i;\n          }\n          continue;\n        }\n        update = true;\n        int p = ants[i].p;\n        if (field[p] == -1) {\n          field[p] = i;\n        }else{\n          ants[field[p]].d *= -1;\n          ants[i].d *= -1;\n        }\n      }\n      if(!update) {\n        printf(\"%d %d\\n\", t, last + 1);\n        break;\n      }\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nint main() {\n    int n, l;\n    while (cin >> n >> l && n){\n        VI p(n), v(n);\n        REP(i,n){\n            char c;\n            cin >> c >> p[i];\n            if (c == 'R') v[i] = 1;\n            else v[i] = -1;\n        }\n        FOR(t,1,l){\n            map<int, int> a;\n            REP(i,n){\n                p[i] += v[i];\n                a[p[i]]++;\n            }\n            FOR(i,1,l-1){\n                if (a[i] >= 2){\n                    REP(j,n){\n                        if (p[j] == i) v[j] *= -1;\n                    }\n                }\n            }\n            bool f = 1;\n            REP(i,n) if (p[i] > 0 && p[i] < l) f = 0;\n            if (f){\n                int ans;\n                REP(i,n) if (p[i] == l) ans = i+1;\n                REP(i,n) if (p[i] == 0) ans = i+1;\n                cout << t << \" \" << ans << endl;\n                break;\n            }\n        }\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX 110\n\nbool check(int ant[MAX],int L){\n  for(int i = 0 ; i < L ; i++){\n    if(ant[i] != 0) return false;\n  }\n  return true;\n}\n\nint main(){\n  int N,L,p;\n  char d;\n  while(cin >> N >> L, N){\n    int ant[MAX]={0};\n    vector<int> tunnel[MAX],id[MAX];\n    L--;\n    for(int i = 0 ; i < N ; i++){\n      cin >> d >> p;\n      ant[p-1]++;\n      id[p-1].push_back(i+1);\n      tunnel[p-1].push_back((d == 'L' ? 1 : 2));\n    }\n    int t = 0,last;\n    while(!check(ant,L)){\n      vector<int> next[MAX],nid[MAX];\n      last = -1;\n      for(int i = 0 ; i < L ; i++){\n        next[i].clear();\n        nid[i].clear();\n        if(ant[i] && last == -1){\n          last = id[i][0];\n        }\n      }\n      for(int i = 0 ; i < L ; i++){\n        while(tunnel[i].size()){\n          if(tunnel[i][0] == 1){\n            tunnel[i].erase(tunnel[i].begin());\n            if(i-1 >= 0){\n              next[i-1].push_back(1);\n              nid[i-1].push_back(id[i][0]);\n              id[i].erase(id[i].begin());\n            }\n          }else if(tunnel[i][0] == 2){\n            tunnel[i].erase(tunnel[i].begin());\n            if(i+1 < L){\n              next[i+1].push_back(2);\n              nid[i+1].push_back(id[i][0]);\n              id[i].erase(id[i].begin());\n            }\n          }\n        }\n      }\n      for(int i = 0 ; i < L ; i++){\n        tunnel[i] = next[i];\n        id[i] = nid[i];\n        if(tunnel[i].size() == 2){\n          swap(tunnel[i][0],tunnel[i][1]);\n        }\n        ant[i] = tunnel[i].size();\n      }\n      t++;\n    }\n    cout << t << \" \" << last << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  int n, l;\n  while(cin >> n >> l, n || l){\n    l *= 2;\n    int ant[20];\n    for(int i = 0; i < n; i++){\n      char d; int p;\n      cin >> d >> p;\n      if(d == 'R') ant[i] = p*2;\n      else ant[i] = -p*2;\n    }\n    int m = n, out = -1; \n    for(int t = 0; ; t++){\n      if(m == 0){\n\tcout << t/2 << \" \" << out + 1 << endl;\n\tbreak;\n      } else {\n\tint now = -1;\n\tint tunnel[201];\n\tmemset(tunnel, -1, sizeof(tunnel));\n\tfor(int i = 0; i < n; i++){\n\t  if(ant[i] == 114514) continue;\n\t  ant[i] += 1;\n\t  if(ant[i] == 0 || ant[i] == l){\n\t    ant[i] = 114514;\n\t    m--;\n\t    if(now == -1 || ant[i] == 0) now = i;\n\t  } else {\n\t    if(tunnel[abs(ant[i])] == -1) tunnel[abs(ant[i])] = i;\n\t    else ant[i] *= -1, ant[tunnel[abs(ant[i])]] *= -1;\n\t  }\n\t}\n\tout = now;\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n\n#define int ll\nvoid solve(){\n\twhile (true) {\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (n == 0) return;\n\t\tvector<pair<int, int>> going[200][200];\n\t\tREP(i, n) {\n\t\t\tstring a;\n\t\t\tcin >> a;\n\t\t\tint b;\n\t\t\tcin >> b;\n\t\t\tint c = 1;\n\t\t\tif (a == \"L\") {\n\t\t\t\tc = -1;\n\t\t\t}\n\t\t\tgoing[0][b].push_back(mp(i + 1, c));\n\t\t}\n\t\tfor (int q = 0;; ++q) {\n\t\t\tint ok = 0;\n\t\t\tfor (int j = 1; j < l; ++j) {\n\t\t\t\tif (going[q][j].size() == 2) {\n\t\t\t\t\tswap(going[q][j][0].first, going[q][j][1].first);\n\t\t\t\t}\n\t\t\t\tREP(t, going[q][j].size()) {\n\t\t\t\t\tok = 1;\n\t\t\t\t\tgoing[q + 1][j + going[q][j][t].second].push_back(going[q][j][t]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ok == 0) {\n\t\t\t\tcout << q << \" \";\n\t\t\t\tif (going[q][0].size() != 0) {\n\t\t\t\t\tcout << going[q][0][0].first << endl;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << going[q][l][0].first << endl;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n#undef int\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool cmp(array<int,3> a,array<int,3> b){\n\treturn a[1] < b[1];\n}\nint main(){\n\tint n,l;\n\twhile(cin >> n >> l && n){\n\t\tvector< array<int,3> > sim(n);\n\t\tfor(int i = 0 ; i < n ; i++){\n\t\t\tchar c;\n\t\t\tcin >> c;\n\t\t\tint p;\n\t\t\tcin >> p;\n\t\t\tp *= 2;\n\t\t\tsim[i] = {c=='R'?1:-1,p,i+1};\n\t\t}\n\t\tint tm = 0,last=-1;\n\t\twhile( sim.size() ){\n\t\t\tfor(int i = 0 ; i < sim.size() ; i++){\n\t\t\t\tfor(int j = i+1 ; j < sim.size() ; j++){\n\t\t\t\t\tif( sim[i][1] == sim[j][1] && sim[j][1] % 2 == 0){\n\t\t\t\t\t\tswap(sim[i][0],sim[j][0]);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( auto &x : sim ){\n\t\t\t\tx[1] += x[0];\n\t\t\t}\n\t\t\tsort(sim.begin(),sim.end(),cmp);\n\t\t\tvector< array<int,3> > newSim;\n\n\t\t\tfor(int i = sim.size() -1 ; i >= 0 ; i--){\n\t\t\t\tauto x = sim[i];\n\t\t\t\tif( x[1] != 0 && x[1] != 2*l ){\n\t\t\t\t\tnewSim.push_back(x);\n\t\t\t\t}else{\n\t\t\t\t\tlast = x[2];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tsim = newSim;\n\t\t\ttm++;\n\t\t}\n\t\tcout << tm/2 << \" \" << last << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nstruct ant { int loc; char dir; };\nant a[20]; int n, l; int memo;\nvoid move() {\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tif (a[i].loc == 1)memo = i;\n\t\tif (a[i].dir == 'R')a[i].loc++;\n\t\telse a[i].loc--;\n\t}\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tRep(j, i + 1, n) {\n\t\t\tif (a[i].loc == a[j].loc)swap(a[i].dir, a[j].dir);\n\t\t}\n\t}\n\treturn;\n}\nbool antfall() {\n\trep(i, n) {\n\t\tif (a[i].loc != 0 && a[i].loc != l)return false;\n\t}\n\treturn true;\n}\nint main() {\n\twhile (cin >> n >> l, n) {\n\t\tchar d; int p;\n\t\trep(i, n) {\n\t\t\tcin >> d >> p;\n\t\t\ta[i] = { p,d };\n\t\t}\n\t\tint turn;\n\t\tfor (turn = 1; turn < 105; turn++) {\n\t\t\tmove();\n\t\t\tif (antfall())break;\n\t\t}\n\t\tcout << turn << \" \" << memo+1 << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, a, b) for (int i = a; i < (b); ++i)\n#define trav(a, x) for (auto& a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nint main() {\n\t//cin.sync_with_stdio(false); cin.tie(0);\n\t//cin.exceptions(cin.failbit);\n\n\tfor (;;) {\n\t\tint n, l; cin >> n >> l; if (!n) break;\n\t\tvector<char> d(n); vector<int> p(n);\n\t\trep(i, 0, n) cin >> d[i] >> p[i];\n\n\t\tint left = n;\n\n\t\tfor (int t = 0;; t++) {\n\t\t\tvector<int> b(205), lefts;\n\t\t\trep(i, 0, n) if (p[i] != 0 && p[i] != l) {\n\t\t\t\tif (d[i] == 'L') p[i]--; else p[i]++;\n\t\t\t\tb[p[i]]++;\n\t\t\t\tif (p[i] == 0 || p[i] == l) lefts.push_back(i), left--;\n\t\t\t}\n\t\t\trep(i, 0, n) {\n\t\t\t\tif (b[p[i]] == 2) d[i] ^= 'L' ^ 'R';\n\t\t\t}\n\t\t\t//printf(\"%d - \", t); rep(i, 0, n) { printf(\"%d:%d(%c) \", i, p[i], d[i]); } puts(\"\");\n\t\t\tif (left == 0) {\n\t\t\t\t//cerr << \"Lefts: \" << left << \",\" << lefts.size() << endl;\n\t\t\t\tcout << t + 1 << \" \";\n\t\t\t\tif (lefts.size() == 1) {\n\t\t\t\t\tcout << lefts.front() + 1 << endl;\n\t\t\t\t} else {\n\t\t\t\t\tcout << (p[lefts.front()] == 0 ? lefts.front() + 1 : lefts.back() + 1) << endl;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nstruct ant { int loc; char dir; };\nant a[20]; int n, l; int memo;\nvoid move() {\n\tbool f = true;\n\trep(i, n) {\n\t\tif (a[i].loc == 1) {\n\t\t\tmemo = i; f = false;\n\t\t}\n\t\telse if (a[i].loc == l - 1 && f) {\n\t\t\tmemo = i;\n\t\t}\n\t}\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tif (a[i].dir == 'R')a[i].loc++;\n\t\telse a[i].loc--;\n\t}\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tRep(j, i + 1, n) {\n\t\t\tif (a[i].loc == a[j].loc)swap(a[i].dir, a[j].dir);\n\t\t}\n\t}\n\treturn;\n}\nbool antfall() {\n\trep(i, n) {\n\t\tif (a[i].loc != 0 && a[i].loc != l)return false;\n\t}\n\treturn true;\n}\nint main() {\n\twhile (cin >> n >> l, n) {\n\t\tchar d; int p;\n\t\trep(i, n) {\n\t\t\tcin >> d >> p;\n\t\t\ta[i] = { p,d };\n\t\t}\n\t\tint turn;\n\t\tfor (turn = 1; turn < 105; turn++) {\n\t\t\tmove();\n\t\t\tif (antfall())break;\n\t\t}\n\t\tcout << turn << \" \" << memo+1 << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nint main() {\n\tint n, l;\n\twhile (cin >> n >> l, n) {\n\t\tvector<pii> ants(n);\n\t\tREP(i, n) {\n\t\t\tchar d;\n\t\t\tcin >> d >> ants[i].second;\n\t\t\tif (d == 'R') {\n\t\t\t\tants[i].first = 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tants[i].first = -1;\n\t\t\t}\n\t\t}\n\n\t\tint left = n, sec = 0, ans = -1;\n\t\twhile (true) {\n\t\t\tsec++;\n\t\t\tans = -1;\n\t\t\tREP(i, n) {\n\t\t\t\tants[i].second += ants[i].first;\n\t\t\t}\n\n\t\t\tREP(i, n) {\n\t\t\t\tif (ants[i].first != 0) {\n\t\t\t\t\tif (ants[i].second == 0) {\n\t\t\t\t\t\tans = i + 1;\n\t\t\t\t\t\tants[i].first = 0;\n\t\t\t\t\t\tleft--;\n\t\t\t\t\t}\n\t\t\t\t\telse if (ants[i].second == l) {\n\t\t\t\t\t\tif (ans == -1) {\n\t\t\t\t\t\t\tans = i + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tants[i].first = 0;\n\t\t\t\t\t\tleft--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (n != 1) {\n\t\t\t\tREP(i, n) {\n\t\t\t\t\tFOR(j, i, n - 1) {\n\t\t\t\t\t\tif (ants[i].second == ants[j].second && ants[i].first != 0) {\n\t\t\t\t\t\t\tants[i].first *= -1;\n\t\t\t\t\t\t\tants[j].first *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (left == 0) {\n\t\t\t\tcout << sec << \" \" << ans << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcerr << \"sec : \" << sec << endl;\n\t\t\tREP(i, n) {\n\t\t\t\tcerr << i + 1 << \" : \" << ants[i].first << \" \" << ants[i].second << endl;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD 1000000007\n//#define MOD 998244353\n#define INF 1000000010\n#define EPS 1e-9\n#define F first\n#define S second\n\n#define debug(x) cout<<x<<endl;\n#define repi(i,x,n) for(int i=x;i<n;i++)\n#define rep(i,n) repi(i,0,n)\n#define lp(i,n) repi(i,0,n)\n#define repn(i,n) for(int i=n;i>=0;i--)\n#define int long long\n#define endl \"\\n\"\n\ntypedef pair<int,char> PII;\ntypedef pair<int,string> PIS;\ntypedef pair<string,int> PSI;\n\n\nsigned main(){\n  cin.tie(0);\t\n  // ios::sync_with_stdio(false);\n  while(1){\n    int n,l;\n    cin>>n>>l;\n    if(n==0) break;\n    vector<pair<PII,int> > ant;\n    ant.resize(n);\n    rep(i,n){\n      cin>>ant[i].F.S>>ant[i].F.F;\n      ant[i].S=i+1;\n    }\n    \n    int ans1=0;\n    pair<int,int> ans2={0,0};\n    bool x=true;\n    sort(ant.begin(),ant.end());\n    while(x){\n      ans1++;\n     \n      \n      \n      rep(i,ant.size() ){\n\tif(ant[i].F.S=='R'){\n\t  ant[i].F.F++;\n\t  if(ant[i].F.F==l && ans2.F<ans1){\n\t    ans2=make_pair(ans1,ant[i].S);\n\t  }\n\t}else{\n\t  ant[i].F.F--;\n\t  if(ant[i].F.F==0){\n\t    ans2=make_pair(ans1,ant[i].S);\n\t  }\n\t}\n      }\n       sort(ant.begin(),ant.end());\n      rep(i,ant.size()-1 ){\n\tif(ant[i].F.F==ant[i+1].F.F){\n\t  // cout<<i<<endl;\n\t  if(ant[i].F.S=='R'){\n\t    ant[i].F.S='L';\n\t    ant[i+1].F.S='R';\n\t  }else{\n\t    ant[i].F.S='R';\n\t    ant[i+1].F.S='L';\n\t  }\n\t}\n      }\n      /*rep(i,ant.size() ){\n\tcout<<\"(\"<<ant[i].F.F<<ant[i].F.S<<\" \"<<ant[i].S<<\") \";\n\t}\n\tcout<<endl;*/\n      rep(i,ant.size() ){\n\tif(ant[i].F.F > 0 && ant[i].F.F < l) break;\n\telse if(i == ant.size()-1){\n\t  //cout<<\"A\"<<endl;\n\t  x=false;\n\t}\n      }\n    }\n    cout<<ans1<<\" \"<<ans2.S<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstruct dat{\n\tint d,p,id;\n\tbool operator<(const dat& a) {\n\t\treturn p<a.p;\n\t}\n};\n\nint main() {\n\tint n,l;\n\twhile(cin >> n >> l,n) {\n\t\tvector<dat> dats(n);\n\t\tfor(int i=0;i<n;++i) {\n\t\t\tchar d;\n\t\t\tcin >> d >> dats[i].p;\n\t\t\tdats[i].d=(d=='L'?1:0);\n\t\t\tdats[i].id=i+1;\n\t\t}\n\t\tint sec=0,ans;\n\t\twhile(true) {\n\t\t\tans=0;\n\t\t\t++sec;\n\t\t\tbool flag=true;\n\t\t\tfor(int i=0;i<n;++i) {\n\t\t\t\tif(dats[i].p==0||dats[i].p==l) continue;\n\t\t\t\tif(dats[i].d) --dats[i].p;\n\t\t\t\telse ++dats[i].p;\n\t\t\t\tif(dats[i].p==0||dats[i].p==l) {\n\t\t\t\t\tif(ans==0||(ans&&dats[i].p==0)) ans=dats[i].id;\n\t\t\t\t} else flag=false;\n\t\t\t}\n\t\t\tif(flag) break;\n\t\t\tsort(dats.begin(),dats.end());\n\t\t\tfor(int i=0;i<n;++i) {\n\t\t\t\tif(dats[i].p==0) continue;\n\t\t\t\tif(dats[i].p==l) break;\n\t\t\t\tif(i>0&&dats[i-1].p==dats[i].p) {\n\t\t\t\t\tdats[i-1].d=1-dats[i-1].d;\n\t\t\t\t\tdats[i].d=1-dats[i].d;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << sec << \" \" << ans << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n// #include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i=(int)(a); i<(int)(b); ++i)\n#define REP(i, n) for(int i=0; i<(int)(n); ++i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nstruct ant {\n  char d;\n  int p;\n};\n\nint main() {\n  int n, l;\n  while(cin >> n >> l, n | l) {\n    vector<ant> ants(n);\n    REP(i, n){\n      cin >> ants[i].d >> ants[i].p;\n      ants[i].d = ants[i].d == 'L' ? -1 : 1;\n    }\n\n    int field[l + 1];\n    for(int t = 1;; t++) {\n      fill_n((int *)field, l + 1, -1);\n      int last = -1;\n      bool update = false;\n\n      REP(i, n){\n        if(ants[i].p <=0 || ants[i].p >= l) continue;\n        ants[i].p += ants[i].d;\n        if(ants[i].p <=0 || ants[i].p >= l) {\n          // LOG(\"out : %d at %d --- %d\\n\", i + 1, t, ants[i].p);\n          if(last == -1 || ants[last].p != 0) {\n            last = i;\n          }\n          continue;\n        }\n        update = true;\n        int p = ants[i].p;\n        if (field[p] == -1) {\n          field[p] = i;\n        }else{\n          ants[field[p]].d *= -1;\n          ants[i].d *= -1;\n        }\n      }\n      if(!update) {\n        printf(\"%d %d\\n\", t, last + 1);\n        break;\n      }\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct Ant {\n    int i;\n    char d;\n    int p;\n};\n\nvoid solve(int l, deque<Ant> ants) {\n    deque<Ant> t; // initial\n    t = ants;\n    \n    int step = 0;\n    while (!ants.empty()) {\n        step ++;\n\n        for (int i=0; i<(int)ants.size(); ++i) {\n            if (ants[i].d == 'L') ants[i].p --;\n            else  ants[i].p ++;\n        }\n        sort(ants.begin(), ants.end(), [](const Ant &a, const Ant &b) {\n            return a.p < b.p;\n        });\n        for (int i=0; i<(int)ants.size()-1; ++i) {\n            if (ants[i].p == ants[i+1].p) {\n                swap(ants[i].d, ants[i+1].d);\n            }\n        }\n\n        if (((int)ants.size() == 1 && (ants.front().p <= 0 || l <= ants.back().p)) ||\n            ((int)ants.size() == 2 && (ants.front().p <= 0 && l <= ants.back().p))) {\n            cout << step << \" \" << ants[0].i+1 << endl;\n            return ;\n        }\n        if (ants.front().p <= 0) ants.pop_front();\n        if (ants.back().p >= l) ants.pop_back();\n    }\n}\n\nint main() {\n    int n, l;\n    while (cin >> n >> l) {\n        if (!n) break;\n\n        deque<Ant> ants;\n        for (int i=0; i<n; ++i) {\n            char d;\n            int p;\n            cin >> d >> p;\n            ants.push_back((Ant){i, d, p});\n        }\n        solve(l, ants);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nint g_height, g_width;\nbool in_field(P p) {\n\treturn (0 <= p.Y && p.Y < g_height) && (0 <= p.X && p.X < g_width);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\nclass Ant {\n\tpublic:\n\t\tint id;\n\t\tchar direction;\n\t\tAnt(int _id, char _direction) : id(_id), direction(_direction) {\n\t\t}\n};\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint n, l;\n\twhile(cin >> n >> l, n | l) {\n\t\tvector< vector<Ant> > ants(l + 1, vector<Ant>());\n\t\tint n_ants = n;\n\t\tREP (i, n) {\n\t\t\tchar d; int p; cin >> d >> p;\n\t\t\tAnt a(i+1, d);\n\t\t\tants[p].PB(a);\n\t\t}\n\n\t\tint sec = 0;\n\t\tAnt ans(0, ' ');\n\t\twhile (n_ants) {\n\t\t\tsec++;\n\t\t\tvector< vector<Ant> > next_ants(l + 1, vector<Ant>());\n\t\t\t// REP (i, l + 1) {\n\t\t\tfor (int i = l; i >= 0; --i) {\n\t\t\t\tif (i == l && ants[i].size()) {\n\t\t\t\t\tans = ants[i][0];\n\t\t\t\t\tn_ants--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (i == 0 && ants[i].size()) {\n\t\t\t\t\tans = ants[i][0];\n\t\t\t\t\tn_ants--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tEACH (ants[i], itr) {\n\t\t\t\t\tAnt& ant = *itr;\n\t\t\t\t\tif (ant.direction == 'L') {\n\t\t\t\t\t\tnext_ants[i-1].PB(ant);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext_ants[i+1].PB(ant);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tREP (i, l + 1) {\n\t\t\t\tassert(next_ants[i].size() <= 2);\n\t\t\t\tif (next_ants[i].size() == 2) {\n\t\t\t\t\tEACH (next_ants[i], itr) {\n\t\t\t\t\t\t(*itr).direction = (*itr).direction == 'L' ? 'R' : 'L';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tants = next_ants;\n\t\t}\n\n\t\tcout << sec - 1 << \" \" << ans.id << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main() {\n\n  while( true ) {\n\n    long long int n, l;\n    cin >> n >> l;\n    if ( n == 0 ) break;\n\n    vector< pair< long long int, long long int > > v;\n\n    for ( long long int i = 0; i < n; i++ ) {\n\n      char c;\n      long long int in;\n      cin >> c >> in;\n\n      if ( c == 'R' ) {\n\tv.push_back( make_pair( in, 1 ) );\n      }else {\n\t  v.push_back( make_pair( in, -1 ) );\n      }\n\n    }\n\n    long long int ans = 0;\n    long long int cnt;\n\n    for ( long long int j = 0; j <= 100; j++ ) {\n\n      long long int t[101] = {};\n\n      for ( long long int i = 0; i < n; i++ ) {\n\tif ( v[i].second != 0 ) {\n\t  v[i].first += v[i].second;\n\t  if ( v[i].first == 0 || v[i].first == l ) {\n\t    v[i].second = 0;\n\t    if ( v[i].first == 0 ) {\n\t      if ( ans <= j + 1 ) {\n\t\tans = j + 1;\n\t\tcnt = i + 1;\n\t      }\n\t    }else {\n\t      if ( ans < j + 1 ) {\n\t\tans = j + 1;\n\t\tcnt = i + 1;\n\t      }\n\t    }\n\t  }else if ( t[ v[i].first ] != 0 ) {\n\t    v[i].second *= -1;\n\t    v[ t[ v[i].first ] - 1 ].second *= -1;\n\t  }else {\n\t    t[ v[i].first ] = i + 1;\n\t  }\n\t}\n      }\n\n    }\n\n    cout << ans << \" \" << cnt << endl;\n\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "// by team3\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cctype>\n#include <climits>\n#include <cassert>\n#include <iostream>\n#include <iomanip>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <complex>\n\nusing namespace std;\n\n#define rep(i,n) for (int i = 0; i < (n); ++i)\n#define For(i,s,t) for (int i = (s); i <= (t); ++i)\n#define foreach(i,c) for (__typeof(c.begin()) i = c.begin(); i != c.end(); ++i)\n\ntypedef long long LL;\ntypedef pair<int, int> Pii;\n\nconst int inf = 0x3f3f3f3f;\nconst LL infLL = 0x3f3f3f3f3f3f3f3fLL;\nconst int maxn = 30;\n\nstruct node {int id, way, p, time;};\nnode d[maxn];\nint id[maxn], dd[maxn];\nint n, l;\n\nvoid init()\n{\n    char s[2];\n    int tmp;\n    for (int i = 1; i <= n; ++i)\n    {\n        scanf(\"%s%d\", s, &tmp);\n        d[i] = (node){i, 0, tmp, 0};\n        if (s[0] == 'R') d[i].way = 1;\n        d[i].id = i;\n        if (d[i].way == 0) d[i].time = d[i].p;\n        else d[i].time = l - d[i].p;\n        dd[i] = d[i].way;\n    }\n}\n\nvoid solve()\n{\n    // cout << endl;\n    int ans1 = 0, tmp1 = 0;\n    for (int i = 1; i <= n; ++i)\n        if (d[i].time > ans1)\n            ans1 = d[i].time;\n    // For(i,1,n) cout << d[i].id << \" \" << d[i].way << \" \" << d[i].time << endl;\n    // cout << endl;\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= n; ++j) {\n            if (d[i].way == 1 && d[j].way == 0 && d[i].p < d[j].p) {\n                if ((d[j].p - d[i].p) % 2 == 0) {\n                    swap(d[i].way, d[j].way);\n                    swap(d[i].time, d[j].time);\n                }\n            }\n        }\n    // For(i,1,n) cout << d[i].id << \" \" << d[i].way << \" \" << d[i].time << endl;\n    // cout << endl;\n    int ans2 = -1;\n    for (int i = 1; i <= n; ++i) {\n        if (d[i].time == ans1)\n        {\n            if (d[i].way == 0)\n                ans2 = d[i].id;\n            else if (ans2 == -1)\n                ans2 = d[i].id;\n        }\n    }\n    cout << ans1 <<  ' ' << ans2 << endl;\n}\n\nint main()\n{\n    while (scanf(\"%d%d\", &n, &l) == 2 && n)\n    {\n        init();\n        solve();\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<tuple>\n\nusing namespace std;\n\nint main(){\n  for(int n,l;cin>>n>>l,n|l;){\n    vector<tuple<int,int,int> > v;\n    for(int i=0;i<n;i++){\n      char d;\n      int p;\n      cin>>d>>p;\n      v.emplace_back(i+1,(d=='R')-(d=='L'),p);\n    }\n    int la,ra;\n    int lt=-1,rt=-1;\n    for(int i=0;!v.empty();i++){\n      int pop[123]={};\n      for(auto it=v.begin();it!=v.end();){\n\tif(get<2>(*it)==0){\n\t  la=get<0>(*it);\n\t  lt=i;\n\t  it=v.erase(it);\n\t}else if(get<2>(*it)==l){\n\t  ra=get<0>(*it);\n\t  rt=i;\n\t  it=v.erase(it);\n\t}else{\n\t  get<2>(*it)+=get<1>(*it);\n\t  pop[get<2>(*it)]++;\n\t  ++it;\n\t}\n      }\n      for(auto &e:v){\n\tif(pop[get<2>(e)]>1){\n\t  get<1>(e)*=-1;\n\t}\n      }\n    }\n    cout<<max(lt,rt)<<' '<<((lt<rt)?ra:la)<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\nstruct Data {\n  int x,dir,index;\n};\n\nint n,l,cnt[1000];\n\nvoid compute(vector<Data> vec){\n  int timer = 0, ant = -1;\n  while( !vec.empty() ){\n    ++timer;\n    rep(i,l+1) cnt[i] = 0;\n    vector<Data> nvec = vec;\n    rep(i,nvec.size()) {\n      nvec[i].x += nvec[i].dir;\n      ++cnt[nvec[i].x];\n    }\n    vector<Data> inner,outer;\n    rep(i,nvec.size()) {\n      if( nvec[i].x == 0 || nvec[i].x == l ) {\n\touter.push_back(nvec[i]);\n      } else {\n\tinner.push_back(nvec[i]);\n      }\n    }\n    \n    rep(i,l+1) if( cnt[i] >= 2 ){\n      rep(j,inner.size()) if( inner[j].x == i ) {\n\tinner[j].dir *= -1;\n      }\n    }\n\n    vec = inner;\n    if( vec.empty() ) {\n      if( outer.size() == 1 ) ant = outer[0].index + 1;\n      else {\n\tassert( outer.size() == 2 );\n\trep(i,outer.size()) if( outer[i].x == 0 ) {\n\t  ant = outer[i].index + 1;\n\t  break;\n\t}\n      }\n    }\n  }\n  cout << timer << \" \" << ant << endl;\n}\n\nint main(){\n  while( cin >> n >> l, n|l ) {\n    vector<Data> vec(n);\n    rep(i,n){\n      char d;\n      cin >> d >> vec[i].x;\n      vec[i].dir = ((d=='L')?-1:1);\n      vec[i].index = i;\n    }\n    compute(vec);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\nsigned main(){\n   cin.tie(0);\n  ios::sync_with_stdio(false);\n\n\n  while(true){\n    char d;\n    int n, l ,p, con = 0;\n    vector<int> L, R;\n\n    cin>>n>>l;\n\n    if(!n &&!l) break;\n    \n    con = n;\n    L.resize(l*2+2, 0);\n    R.resize(l*2+2, 0);\n\n    \n    for(int i = 0; i < n; i++){\n      cin>>d>>p;\n\n      if(d == 'L') L[p*2] = i+1;\n      else if(d == 'R') R[p*2] = i+1;\n    }\n\n    for(int time = 1; ; time++){// cout<<time<<\" \"<<con<<endl;\n      L[0] = R[l*2] = 0;\n      \n      //for(int i = 1; i < l*2; i++){\n      //cout<<(L[i]?L[i]:R[i])<<\" \";\n      // }cout<<endl;\n\n       \n      for(int i = 1; i < l*2; i++){\n\tL[i-1] = L[i];\n\tR[l*2-i+1] = R[l*2-i];\n      }\n      \n      for(int i = 1; i < l*2; i++){\n        if(i%2 == 0 && L[i] && R[i]){\n\t  swap(L[i],R[i]);\n\t} \n      }\n      for(int i = 1; i < l*2; i++){\n\tL[i-1] = L[i];\n\tR[l*2-i+1] = R[l*2-i];\n      }\n      // for(int i = 1; i < l*2; i++){\n      // cout<<(L[i]?L[i]:R[i])<<\" \";\n      // }cout<<endl;\n\n       for(int i = 1; i < l*2; i++){\n\t if(i%2 == 0 && L[i] && R[i]){\n\t   swap(L[i],R[i]);\n\t } \n       }\n       \n      if(L[0])con--;\n      if(R[l*2])con--;\n\n      if(!con){\n\tif(L[0]) cout<<time<<\" \"<<L[0]<<endl;\n\telse cout<<time<<\" \"<<R[l*2]<<endl;\n\n        break;\n      }\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LB(vec,n) lower_bound(vec.begin(),vec.end(),n)\nusing namespace std;\n\nint main(){\n\twhile(true){\n\t\tint n,l;cin >> n >> l;\n\t\tif(n == 0)break;\n\t\tvector<pair<char,int> > ant(n);\n\t\tint anstime = 0;\n\t\tfor(int i = 0; i < n; ++i){\n\t\t\tchar d; cin >> d;\n\t\t\tint p; cin >> p;\n\t\t\tpair<char,int> pa(d,p);\n\t\t\tant[i] = pa;\n\t\t}\n\t\tint time = 0;\n\t\t//for(int i = 0; i < n; ++i){\tcout << ant[i].first << \" \" << ant[i].second << endl;}\n\t\twhile(true){\n\t\t\t//if(time == 1)break;\n\t\t\tbool flag = true;\n\t\t\tfor(int i = 0; i < n; ++i){\n\t\t\t\tif(ant[i].first == 'L' && ant[i].second> 0){\n\t\t\t\t\tflag = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse if(ant[i].first == 'R' && ant[i].second < l){\n\t\t\t\t\tflag = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag)break;\n\t\t\tfor(int i = 0; i < n; ++i){\n\t\t\t\tif(ant[i].first == 'L'){\n\t\t\t\t\tant[i].second--;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tant[i].second++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0; i < n-1; ++i){\n\t\t\t\tfor(int j = i+1; j < n; ++j){\n\t\t\t\t\tif(ant[i].second == ant[j].second){\n\t\t\t\t\t\tswap(ant[i].first, ant[j].first);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttime++;\n\t\t}\n\t\t//for(int i = 0; i < n; ++i){\tcout << ant[i].first << \" \" << ant[i].second << endl;}\n\t\tint rlast =200, llast = -100;\n\t\tint rnum,lnum;\n\t\tfor(int i = 0; i < n; ++i){\n\t\t\tif(ant[i].first == 'L' && ant[i].second > llast ){\n\t\t\t\tllast = ant[i].second;\n\t\t\t\tlnum = i+1;\n\t\t\t}\n\t\t\telse if(ant[i].first == 'R' && ant[i].second < rlast){\n\t\t\t\trlast = ant[i].second;\n\t\t\t\trnum = i+1;\n\t\t\t}\n\t\t}\n\t\tcout << time << \" \";\n\t\tif(llast >= l - rlast){\n\t\t\tcout << lnum << endl;\n\t\t}\n\t\telse{\n\t\t\tcout << rnum << endl;\n\t\t}\n\t}\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nint tunnel[2][101];\n\nint sim(int length)\n{\n\tint ret[2]={-1,-1};\n\t//左向き\n\tfor(int i=0;i<length+1;i++)\n\t{\n\t\tif(tunnel[0][i]!=-1)\n\t\t{\n\t\t\ttunnel[0][i-1]=tunnel[0][i];\n\t\t\ttunnel[0][i]=-1;\n\t\t}\n\t\tif(tunnel[0][0]!=-1)\n\t\t{\n\t\t\tret[0]=tunnel[0][0];\n\t\t\ttunnel[0][0]=-1;\n\t\t}\n\t}\n\t//右向き\n\tfor(int i=length;i>-1;i--)\n\t{\n\t\tif(tunnel[1][i]!=-1)\n\t\t{\n\t\t\ttunnel[1][i+1]=tunnel[1][i];\n\t\t\ttunnel[1][i]=-1;\n\t\t}\n\t\tif(tunnel[1][length]!=-1)\n\t\t{\n\t\t\tret[1]=tunnel[1][length];\n\t\t\ttunnel[1][length]=-1;\n\t\t}\n\t}\n\t//鉢合わせ判定\n\tfor(int i=0;i<length+1;i++)\n\t{\n\t\tif(tunnel[0][i]!=-1 && tunnel[1][i]!=-1)\n\t\t{\n\t\t\tint tmp=tunnel[0][i];\n\t\t\ttunnel[0][i]=tunnel[1][i];\n\t\t\ttunnel[1][i]=tmp;\n\t\t}\n\t}\n\tif(ret[0]==-1)\n\t\treturn ret[1];\n\telse\n\t\treturn ret[0];\n}\n\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,l;\n\t\tint dir[20];\n\t\tfill(tunnel[0],tunnel[2],-1);\n\t\tcin>>n>>l;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tchar d;\n\t\t\tint p;\n\t\t\tcin>>d>>p;\n\t\t\tif(d=='L')\n\t\t\t\tdir[i]=0;\n\t\t\telse\n\t\t\t\tdir[i]=1;\n\t\t\ttunnel[dir[i]][p]=i;\n\t\t}\n\n\t\tint ans=0;\n\t\tint last=0;\n\t\twhile(1)\n\t\t{\n\t\t\tbool f=true;\n\t\t\tans++;\n\t\t\tlast=sim(l);\n\t\t\t//終了判定\n\t\t\tfor(int i=0;i<2;i++)\n\t\t\t{\n\t\t\t\tfor(int j=1;j<l+1;j++)\n\t\t\t\t{\n\t\t\t\t\tif(tunnel[i][j]!=-1)\n\t\t\t\t\t{\n\t\t\t\t\t\tf=false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!f)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(f)\n\t\t\t{\n\t\t\t\tcout<<ans<<\" \"<<last+1<<endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  int n, l;\n  while(cin >> n >> l, n || l){\n    l *= 2;\n    int ant[20];\n    for(int i = 0; i < n; i++){\n      char d; int p;\n      cin >> d >> p;\n      if(d == 'R') ant[i] = p*2;\n      else ant[i] = -p*2;\n    }\n    int m = n, out = -1; \n    for(int t = 0; ; t++){\n      //cout << \"TIME: \" << t << endl;\n      if(m == 0){\n\tcout << t/2 << \" \" << out + 1 << endl;\n\tbreak;\n      } else {\n\tint now = -1;\n\tint tunnel[201];\n\tmemset(tunnel, -1, sizeof(tunnel));\n\tfor(int i = 0; i < n; i++){ \n\t  if(ant[i] == 114514) continue;\n\t  //cout << \"ANT: \" << i+1 << \" \" << ant[i] << endl;\n\t  ant[i] += 1;\n\t  if(ant[i] == 0 || ant[i] == l){\n\t    m--;\n\t    if(now == -1 || ant[i] == 0) now = i;\n\t    ant[i] = 114514;\n\t  } else {\n\t    if(tunnel[abs(ant[i])] == -1) tunnel[abs(ant[i])] = i;\n\t    else if(abs(ant[i])%2 == 0) ant[i] *= -1, ant[tunnel[abs(ant[i])]] *= -1;\n\t  }\n\t}\n\tout = now;\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tint n, l;\n\twhile(cin >> n >> l) {\n\t\tif(n == 0 && l == 0) break;\n\n\t\tvector<char> dir(n);\n\t\tvector<int> p(n);\n\t\trep(i, n) {\n\t\t\tcin >> dir[i] >> p[i];\n\t\t}\n\n\t\tint cnt = 0, id = -1, next[105];\n\t\tbool used[25];\n\t\tmemset(used, 0, sizeof(used));\n\n\t\twhile(true) {\n\t\t\tmemset(next, 0, sizeof(next));\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(dir[i] == 'R') p[i]++;\n\t\t\t\telse p[i]--;\n\n\t\t\t\tnext[p[i]]++;\n\t\t\t}\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(next[p[i]] == 2) {\n\t\t\t\t\tdir[i] = (dir[i] == 'R' ? 'L' : 'R');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(int i = n-1; i >= 0; i--) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(p[i] == 0 || p[i] == l) {\n\t\t\t\t\tused[i] = true;\n\t\t\t\t\tid = i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbool flag = true;\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tflag = false;\n\t\t\t}\n\n\t\t\tif(flag) break;\n\t\t\tcnt++;\n\t\t}\n\n\t\tcout << cnt + 1 << \" \" << id + 1 << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <iterator>\n#include <cmath>\n\nusing namespace std;\n\nint main(){\n\t\n\tint n, l;\n\t\n\twhile(true){\n\t\tcin >> n >> l;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tstring d[30];\n\t\tint p[30] = {};\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tcin >> d[i] >> p[i];\n\t\t}\n\t\tint ans = 0;\n\t\tint num;\n\t\tfor(int i = n - 1; i > 0; i--){\n\t\t\tif(d[i][0] == 'L'){\n\t\t\t\tans = p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j > 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'L'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tif(d[i][0] == 'R'){\n\t\t\t\tif(ans >= l - p[i]){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tans = l - p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'R'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = n - 1; j > 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \" << num << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstring>\n#include <string>\n#include <cstdlib>\n#include <cstdio>\nusing namespace std;\ntypedef pair<int, int> pii;\ntypedef long long int ll;\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define RREP(i,x) for(int i=(x);i>=0;i--)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();++i)\n\nint n,l;\nvector<pii> ants;\n\nvoid solve(){\n\tfor(int t=1;;t++){\n\t\tREP(i, n){\n\t\t\tants[i].first += ants[i].second;\n//\t\t\tcout << ants[i].first << \" \";\n\t\t}\n\n\t\tint inner = 0;\n\t\tREP(i, n){\n\t\t\tif(0 <= ants[i].first && ants[i].first < l) inner++;\n\t\t\tfor(int j=i+1;j<n;j++)\n\t\t\t\tif(ants[i].first == ants[j].first) swap(ants[i].second, ants[j].second);\n\t\t}\n\t\tif(!inner){\n\t\t\tREP(i, n){\n\t\t\t\tif(-1 == ants[i].first){\n\t\t\t\t\tcout << t << \" \" << i+1 << endl;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(i, n){\n\t\t\t\tif(l == ants[i].first){\n\t\t\t\t\tcout << t << \" \" << i+1 << endl;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nmain(){\n\tint i,j;\n\twhile(cin >> n >> l, n){\n\t\tl --;\n\t\tants.clear();\n\t\tREP(i, n){\n\t\t\tint p;char c;\n\t\t\tcin >> c >> p;\n\t\t\tants.push_back(pii(p-1, (c=='L'?-1:1)));\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n, l; cin >> n >> l && (n|l); ) {\n    l = l * 2 + 1;\n    vector<int> p(n), v(n), f(n);\n    for(int i = 0; i < n; ++i) {\n      char d;\n      cin >> d >> p[i];\n      p[i] *= 2;\n      v[i] = (d == 'L') ? -1 : 1;\n    }\n    int a, b;\n    for(int t = 1, k = 0; k < n; ++t) {\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        p[i] += v[i];\n      }\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        for(int j = i+1; j < n; ++j) {\n          if(f[j]) continue;\n          if(p[i] == p[j]) {\n            v[i] *= -1; v[j] *= -1;\n          }\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == l) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n      cout << a << \" \" << b << endl;\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == 0) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n    }\n    cout << a << \" \" << b << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\ntypedef pair<int, int> P;\ntypedef pair<int, P> PP;\ntypedef vector<PP> V;\n\nclass Ant {\n    public:\n        char d;\n        int p;\n};\n\nP compute(int n, int l, Ant ants[]) {\n    int index[20];\n    P residual_time[20];\n    V exchanges;\n    for (int i=0; i<n; i++) {\n        index[i] = i;\n    }\n    for (int i=0; i<n; i++) {\n        for (int j=i+1; j<n; j++) {\n            int delta = ants[j].p-ants[i].p;\n            if (ants[i].d != 'R' || ants[j].d != 'L') {\n                continue;\n            }\n            if ((ants[i].p+ants[j].p)%2 == 1) {\n                continue;\n            }\n            exchanges.push_back(PP(delta, P(i, j)));\n        }\n    }\n    sort(exchanges.begin(), exchanges.end());\n    for (int k=0; k<(int)exchanges.size(); k++) {\n        int i = exchanges[k].second.first;\n        int j = exchanges[k].second.second;\n        int tmp = index[i];\n        index[i] = index[j];\n        index[j] = tmp;\n    }\n    for (int i=0; i<n; i++) {\n        if (ants[i].d == 'R') {\n            residual_time[i] = P(l-ants[i].p, i);\n        }\n        else {\n            residual_time[i] = P(ants[i].p, i);\n        }\n    }\n    sort(residual_time, residual_time+n);\n    return P(residual_time[n-1].first, index[residual_time[n-1].second]);\n}\n\nint main() {\n    int n, l;\n    Ant ants[20];\n    P answer;\n    while (true) {\n        cin >> n >> l;\n        if (n == 0) {\n            return 0;\n        }\n        for (int i=0; i<n; i++) {\n            cin >> ants[i].d >> ants[i].p;\n        }\n        answer = compute(n, l, ants);\n        cout << answer.first << ' ' << answer.second+1 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#define llint long long\n\nusing namespace std;\ntypedef pair<llint, char> P;\ntypedef pair<P, llint> R;\n\nllint n, l;\nvector<R> ovec, evec;\n\nR calc(vector<R> &vec)\n{\n\tllint lmax = 0, rmax = 0, lcnt = 0, rcnt = 0;\n\tfor(int i = 0; i < vec.size(); i++){\n\t\tif(vec[i].first.second == 'L') lmax = max(lmax, vec[i].first.first), lcnt++;\n\t\telse rmax = max(rmax, l-vec[i].first.first), rcnt++;\n\t}\n\tR ret = R(P(0, 0), 0);\n\tret.first.first = max(lmax, rmax);\n\tif(lmax >= rmax) ret.second = vec[lcnt-1].second, ret.first.second = 1;\n\telse ret.second = vec[(int)vec.size()-rcnt].second, ret.first.second = 0;\n\t\n\treturn ret;\n}\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> n >> l;\n\t\tif(n == 0) break;\n\t\t\n\t\tovec.clear(), evec.clear();\n\t\tchar c; llint p;\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\tcin >> c >> p;\n\t\t\tif(p % 2) ovec.push_back(R(P(p, c), i));\n\t\t\telse evec.push_back(R(P(p, c), i));\n\t\t}\n\t\t\n\t\tR ans = max(calc(ovec), calc(evec));\n\t\tcout << ans.first.first << \" \" << ans.second << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cassert>\n#include <iostream>\n#include <numeric>\n#include <sstream>\n#include <tuple>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n    constexpr int EMPTY = -99;\n    while (true) {\n        int n, l;\n        cin >> n >> l;\n        if (n == 0 && l == 0) {\n            break;\n        }\n        vector<pair<int, int>> v(l + 1, make_pair(EMPTY, EMPTY));\n        for (int i = 0; i < n; ++i) {\n            char c;\n            int p;\n            cin >> c >> p;\n            if (c == 'L') {\n                v[p].first = i;\n            }\n            else {\n                v[p].second = i;\n            }\n        }\n\n        auto move_ = [EMPTY, l](const vector<pair<int, int>>& v) {\n            vector<pair<int, int>> r(v.size(), make_pair(EMPTY, EMPTY));\n            for (int i = 0; i < v.size(); ++i) {\n                // cout << \"r[\" << (i - 1) << \"] = (\" << v[i].first << \", \"\n                //     << r[i - 1].second << \")\" << endl;\n                // cout << \"r[\" << (i + 1) << \"] = (\" << v[i + 1].first << \", \"\n                //     << v[i].second << \")\" << endl;\n                if (i > 0) {\n                    r[i - 1] = make_pair(v[i].first, r[i - 1].second);\n                }\n                if (i < l) {\n                    r[i + 1] = make_pair(r[i + 1].first, v[i].second);\n                }\n                // if (v[i].first != EMPTY) {\n                //    assert(i - 1 >= 0);\n                //}\n                // if (v[i].second != EMPTY) {\n                //    assert(i +1 < r.size());\n                //}\n            }\n            for (auto&& i : r) {\n                if (i.first != EMPTY && i.second != EMPTY) {\n                    swap(i.first, i.second);\n                }\n            }\n\n            return r;\n        };\n\n        int count = 0;\n        while (true) {\n            auto p = [](int x) {\n                stringstream ss;\n                ss << x;\n                return x == EMPTY ? \" \" : ss.str();\n            };\n            // cout << count << \" \";\n            // for (auto&& i : v) {\n            //    cout << \"(\" << p(i.first) << \", \" << p(i.second) << \")\";\n            //}\n            // cout << endl;\n            vector<pair<int, int>> result;\n            result = move_(v);\n            int left = result[0].first;\n            int right = result[l].second;\n            // cout << \"to \";\n            // for (auto&& i : result) {\n            //    cout << \"(\" << p(i.first) << \", \" << p(i.second) << \")\";\n            //}\n            // cout << endl;\n            count += 1;\n            result[0] = result[l] = make_pair(EMPTY, EMPTY);\n            // cout << \"to \";\n            // for (auto&& i : result) {\n            //    cout << \"(\" << p(i.first) << \", \" << p(i.second) << \")\";\n            //}\n            // cout << endl;\n            bool end_ = accumulate(begin(result), end(result), true,\n                                   [](bool b, const pair<int, int>& a) {\n                                       return b && a.first == EMPTY &&\n                                              a.second == EMPTY;\n                                   });\n            // cout << \"exit \" << end_ << endl;\n            if (end_) {\n                if (l == EMPTY) {\n                    cout << count + 1 << \" \"\n                         << (left == EMPTY ? right + 1 : left + 1) << endl;\n                }\n                else {\n                    cout << count << \" \"\n                         << (left == EMPTY ? right + 1 : left + 1) << endl;\n                }\n                break;\n            }\n            v = result;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\n#define mp make_pair\n\nint main(){\n    int n,l;\n    while(cin>>n>>l && n){\n        typedef pair<int,pair<char,int>> P;\n        vector<P> v(n);\n        rep(i,n){\n            char d; int p;\n            cin>>d>>p;\n            v[i]=mp(p,mp(d,i+1));\n        }\n\n        int t=0;\n        int ans=1e9;\n        while(1){\n            ans=1e9;\n            rep(i,v.size()){\n                ans = min(ans,v[i].second.second);\n                if(v[i].second.first=='L')v[i].first--;\n                else v[i].first++;\n            }\n            sort(v.begin(),v.end());\n            rep(i,v.size()-1){\n                if(v[i].first==v[i+1].first){\n                    swap(v[i].second.second,v[i+1].second.second);\n                }\n            }\n            rep(i,v.size()){\n                if(v[i].first<0 || v[i].first>=l){\n                    v[i].first=-10000;\n                } else {\n                    ans = min(ans, v[i].second.second);\n                }\n            }\n            auto it=remove_if(v.begin(),v.end(),[](const P& a){\n                    return a.first==-10000;\n                });\n            v.erase(it,v.end());\n\n            if(v.size()==0)break;\n            t++;\n        }\n        cout << t << \" \" << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct Ant {\n\tint id, pos, dir;\n\tAnt(){}\n\tAnt(int id, int pos, int dir): id(id), pos(pos), dir(dir){}\n};\n\nint n, l;\nvector<Ant> a;\n\nvoid solve()\n{\n\tvector<pair<int, int>> v;\n\tfor (int t = 1; a.size(); t++){\n\t\tsort(a.begin(), a.end(), [](const Ant &a, const Ant &b){\n\t\t\treturn a.pos == b.pos ? a.dir < b.dir : a.pos > b.pos;\n\t\t});\n\t\tfor (int i = 0; i < a.size(); i++){\n\t\t\tauto &A = a[i];\n\t\t\tA.pos += A.dir;\n\t\t\tif (A.pos == 0 || A.pos == l){\n\t\t\t\tv.emplace_back(make_pair(t, A.id));\n\t\t\t\ta.erase(a.begin() + i--);\n\t\t\t}\n\t\t}\n\t\tsort(a.begin(), a.end(), [](const Ant &a, const Ant &b){\n\t\t\treturn a.pos == b.pos ? a.dir < b.dir : a.pos < b.pos;\n\t\t});\n\t\tfor (int i = 0; i + 1 < a.size(); i++){\n\t\t\tif (a[i].pos == a[i + 1].pos){\n\t\t\t\tswap(a[i].dir, a[i + 1].dir);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\", v.back().first, v.back().second);\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d\", &n, &l), n){\n\t\ta.clear();\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tstring d;\n\t\t\tint p;\n\t\t\tcin >> d >> p;\n\t\t\ta.push_back(Ant(i + 1, p, d == \"R\" ? 1 : -1));\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint n, m;\nint main() {\n\twhile (cin >> n >> m, n | m) {\n\t\tm *= 2;\n\t\tvector<char> d(n); vector<int> v(n);\n\t\tfor (int i = 0; i < n; i++) cin >> d[i] >> v[i], v[i] *= 2;\n\t\tfor (int t = 0; ; t++) {\n\t\t\tbool ok = false;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tif (0 < v[i] && v[i] < m) ok = true;\n\t\t\t}\n\t\t\tif (!ok) {\n\t\t\t\tint s = 0;\n\t\t\t\tvector<pair<int, int> > w;\n\t\t\t\tfor (int i = 0; i < n; i++) w.push_back(make_pair(v[i], i + 1));\n\t\t\t\tsort(w.begin(), w.end());\n\t\t\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\t\t\tif (w[i].first == 0 || w[i].first == m) s = w[i].second;\n\t\t\t\t}\n\t\t\t\tcout << t << ' ' << s << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tif (d[i] == 'R') v[i]++;\n\t\t\t\telse v[i]--;\n\t\t\t}\n\t\t\tvector<char> e = d;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tbool ok = false;\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tif (e[i] != e[j] && v[i] == v[j]) ok = true;\n\t\t\t\t}\n\t\t\t\tif (ok) {\n\t\t\t\t\tif (d[i] == 'L') d[i] = 'R';\n\t\t\t\t\telse d[i] = 'L';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\nusing namespace std;\nusing LL = long long;\n\nusing P = pair<pair<int, bool>, int>;\n\npair<int, int>f(vector<P>vec, int l)\n{\n\tvector<P>las = vec;\n\tif (vec.size() == 0)\n\t{\n\t\treturn make_pair(-1, -1);\n\t}\n\tfor (P& p : vec)\n\t{\n\t\tif (!p.first.second)\n\t\t{\n\t\t\tp.first.first = l - p.first.first;\n\t\t}\n\t}\n\tsort(vec.begin(), vec.end());\n\tint lef = 0, rht = vec.size() - 1;\n\tfor (int i = 0; i < (int)vec.size() - 1; ++i)\n\t{\n\t\tif (vec[i].first.second)\n\t\t{\n\t\t\tlef++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trht--;\n\t\t}\n\t}\n\tint ans1 = vec[vec.size() - 1].first.first;\n\tint ans2 = las[lef].second;\n\treturn make_pair(ans1, ans2);\n}\n\nint main(void)\n{\n\tfor (;;)\n\t{\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (!n)break;\n\t\tvector<P>odd, evn;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tchar c; int v;\n\t\t\tcin >> c >> v;\n\t\t\tif (v % 2)\n\t\t\t{\n\t\t\t\todd.push_back({ { v,c == 'L' } ,i + 1 });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tevn.push_back({ { v,c == 'L' },i + 1 });\n\t\t\t}\n\t\t}\n\t\tauto p1 = f(odd, l);\n\t\tauto p2 = f(evn, l);\n\t\tif (p1.first > p2.first)\n\t\t{\n\t\t\tcout << p1.first << \" \" << p1.second << endl;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcout << p2.first << \" \" << p2.second << endl;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;char T,l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;main(){while(1){M=0;memset(y,0,999);cin>>b>>l;if(!l){break;}for(i=1;i<=b;i++){cin>>T>>x[i];if(T=='L'){d[i]=0;M=max(M,x[i]);}else{d[i]=1;M=max(M,l-x[i]);}}N=0;for(i=1;i<M+2;i++){memset(z,0,sizeof(z));for(j=b;j>0;j--) {if(!y[j]) {if(!d[j]){x[j]--;}else{x[j]++;}if(x[j]<0||x[j]>l){y[j]=1;}z[x[j]]++;if(M<i){if(N){if(x[j]<0){N=j;}}else{N=j;}}}}for(j=b;j>0;j--){if(z[x[j]]>1){if(d[j]){d[j]=0;}else{d[j]=1;}}}}printf(\"%d %d\\n\",M,N);}}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nint n,l;\nchar d[200];\nint p[200];\n\nint main(){\n  while(1){\n    cin>>n>>l;\n    if(n==0&&l==0)break;\n    int maxm=0,id=0;\n    for(int i=0;i<n;i++){\n      cin>>d[i]>>p[i];\n      int a=p[i];\n      if(d[i]=='R')a=l-a;\n      if(a==maxm&&d[i]=='L'){\n\tid=i;\n      }else if(a>maxm){\n\tmaxm=a;\n\tid=i;\n      }\n    }\n    \n    vector<int> vec;\n    int cnt=0;\n    \n    if(d[id]=='L'){\n      for(int i=id;i>=0;i--){\n\tint e=abs(p[id]-p[i]);\n\tif(e%2==1)continue;\n\tif(d[i]=='R')cnt++;\n\tvec.push_back(i);\n      }\n    }else{\n      for(int i=id;i<n;i++){\n\tint e=abs(p[id]-p[i]);\n\tif(e%2==1)continue;\n\tif(d[i]=='L')cnt++;\n\tvec.push_back(i);\n      }\n    }\n    cout<<maxm<<' '<<vec[cnt]+1<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main() {\n    int n, l;\n    while (cin >> n >> l, n) {\n        using P = pair<pair<int, char>, int>;\n        #define pos first.first\n        #define dir first.second\n        #define idx second\n        vector<P> ants(n);\n        for (int i = 0; i < n; i++) {\n            P &p = ants[i];\n            cin >> p.dir >> p.pos;\n            p.idx = i + 1;\n        }\n        int cnt = 0;\n        pair<char, int> lst;\n        while (!ants.empty()) {\n            cnt++;\n            for (auto &p: ants) {\n                if (p.dir == 'L') p.pos--;\n                else p.pos++;\n            }\n            sort(ants.begin(), ants.end());\n            for (int i = 0; i < ants.size() - 1; i++) {\n                if (ants[i].pos == ants[i + 1].pos) {\n                    ants[i].dir = 'R';\n                    ants[i + 1].dir = 'L';\n                }\n            }\n            lst = {'Z', -1};\n            for (auto it = ants.begin(); it != ants.end(); ++it) {\n                if (it->pos < 1 || l <= it->pos) {\n                    lst = min(lst, {it->dir, it->idx}); ants.erase(it); it--;\n                }\n            }\n        }\n        cout << cnt << \" \" << lst.second << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n#include <queue>\n#include <stack>\n#include <array>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <cstdint>\n#include <functional>\n#include <iomanip>\n#include <numeric>\n#include <assert.h>\n#include <bitset>\n#include <list>\n#include <cmath>\n\nint N, L;\nchar direc[100][10];\nint posion[100];\nint posionnow[201];\nint main()\n{\n\tusing namespace std;\n\n\twhile (true)\n\t{\n\t\tcin >> N >> L;\n\t\tif (N == 0 && L == 0) {\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (int i = 0; i < N; i++)\n\t\t{\n\t\t\tcin >> direc[i] >> posion[i];\n\t\t}\n\n\t\tint time = 0;\n\t\tint count = 0;\n\t\tint nowover = -1;\n\t\twhile (count < N) {\n\t\t\t++time;\n\n\t\t\tnowover = -1;\n\t\t\tfor (int i = 0; i < 201; i++)\n\t\t\t{\n\t\t\t\tposionnow[i] = -1;\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < N; i++)\n\t\t\t{\n\t\t\t\tif ((posion[i] <= 0 || posion[i] >= L)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (direc[i][0] == 'L') {\n\t\t\t\t\t--posion[i];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t++posion[i];\n\t\t\t\t}\n\n\t\t\t\tif (posionnow[posion[i]] != -1) {\n\t\t\t\t\tif (direc[i][0] == 'L') {\n\t\t\t\t\t\tdirec[i][0] = 'R';\n\t\t\t\t\t\tdirec[posionnow[posion[i]]][0] = 'L';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdirec[i][0] = 'L';\n\t\t\t\t\t\tdirec[posionnow[posion[i]]][0] = 'R';\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tposionnow[posion[i]] = i;\n\t\t\t\t}\n\n\t\t\t\tif ((posion[i] <= 0 || posion[i] >= L)) {\n\t\t\t\t\t++count;\n\t\t\t\t\tif (nowover == -1 || direc[nowover][0] == 'R') {\n\t\t\t\t\t\tnowover = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tcout << time << ' ' << nowover + 1 << endl;\n\t}\n\treturn 0;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstring>\nint n,l,p[30],no[30];\nbool out[30];\nchar d[30];\nvoid work() {\n\tfor (int i = 1; i <= n; ++i)\n\t\tno[i] = i;\n\tint ans =  0;\n\tmemset(out,0,sizeof(out));\n\tfor (int i = 1; i <= n; ++i) \n\t\tif (d[i] == 'R') ans = std::max(ans,l - p[i]);\n\t\telse ans = std::max(ans,p[i]);\n\tfor (int T = 1; T < ans; ++T) {\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tif (!out[i]) {\n\t\t\t\tif (d[i] == 'R') ++p[i];\n\t\t\t\telse --p[i];\n\t\t\t}\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tif (p[i] == 0 || p[i] == l) out[i] = true;\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tfor (int j = i + 1; j <= n; ++j)\n\t\t\t\tif (!out[i] && !out[j] && p[i] == p[j])\n\t\t\t\t\tstd::swap(no[i],no[j]);\n\t}\n\tprintf(\"%d \",ans);\n\tint ansno = 0,t = 0;\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (!out[i]) {\n\t\t\tif (ansno == 0) ansno = no[i];\n\t\t\telse if (d[i] == 'L') ansno = no[i];\n\t\t}\n\t//printf(\"%d\\n\",t);\n\tprintf(\"%d\\n\",ansno);\n}\nint main() {\n\twhile (scanf(\"%d%d\",&n,&l) != EOF) {\n\t\tif (n == 0 && l == 0) break;\n\t\tchar s[3];\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tscanf(\"%s%d\",s,p + i);\n\t\t\td[i] = s[0];\n\t\t}\n\t\twork();\n\t}\n}\n\t\t\t"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nusing ll = long long;\nusing ld = long double;\nusing P = pair<int, int>;\nconstexpr ld EPS = 1e-12;\nconstexpr int INF = numeric_limits<int>::max() / 2;\nconstexpr int MOD = 1e9 + 7;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int n, l;\n    while (cin >> n >> l, n || l)\n    {\n        vector<int> d(n);\n        vector<vector<int>> pos(l + 10);\n        for (int i = 0; i < n; i++)\n        {\n            string s;\n            cin >> s;\n            if (s == \"L\")\n                d[i] = 0;\n            else\n                d[i] = 1;\n            int p;\n            cin >> p;\n            pos[p].push_back(i);\n        }\n        bool update = true;\n        int res = 0, last;\n        while (true)\n        {\n            update = false;\n            int left = 0, right = 0;\n            vector<vector<int>> tmp = pos;\n            for (int i = 1; i <= l - 1; i++)\n            {\n                pos[i].clear();\n            }\n            for (int i = 1; i <= l - 1; i++)\n            {\n                for (int j = 0; j < (int)tmp[i].size(); j++)\n                {\n                    update = true;\n                    int idx = tmp[i][j];\n                    if (d[idx])\n                    {\n                        // R\n                        pos[i + 1].push_back(idx);\n                        if (i + 1 == l)\n                            right = idx + 1;\n                    }\n                    else\n                    {\n                        pos[i - 1].push_back(idx);\n                        if (i - 1 == 0)\n                            left = idx + 1;\n                    }\n                }\n            }\n            if(left){\n                last = left;\n            }\n            else if(right){\n                last = right;\n            }\n            for (int i = 1; i <= l - 1; i++)\n            {\n                if (pos[i].size() < 2)\n                    continue;\n                int st = pos[i][0], gt = pos[i][1];\n                d[st] = 1 - d[st];\n                d[gt] = 1 - d[gt];\n            }\n            if (!update)\n                break;\n            res++;\n        }\n        cout << res << \" \" << last << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool cmp(array<int,3> a,array<int,3> b){\n\treturn a[1] < b[1];\n}\nint main(){\n\tint n,l;\n\twhile(cin >> n >> l && n){\n\t\tvector< array<int,3> > sim(n);\n\t\tfor(int i = 0 ; i < n ; i++){\n\t\t\tchar c;\n\t\t\tcin >> c;\n\t\t\tint p;\n\t\t\tcin >> p;\n\t\t\tp *= 2;\n\t\t\tsim[i] = array<int,3>{c=='R'?1:-1,p,i+1};\n\t\t}\n\t\tint tm = 0,last=-1;\n\t\twhile( sim.size() ){\n\t\t\tfor(int i = 0 ; i < sim.size() ; i++){\n\t\t\t\tfor(int j = i+1 ; j < sim.size() ; j++){\n\t\t\t\t\tif( sim[i][1] == sim[j][1] && sim[j][1] % 2 == 0){\n\t\t\t\t\t\tswap(sim[i][0],sim[j][0]);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( auto &x : sim ){\n\t\t\t\tx[1] += x[0];\n\t\t\t}\n\t\t\tsort(sim.begin(),sim.end(),cmp);\n\t\t\tvector< array<int,3> > newSim;\n\n\t\t\tfor(int i = sim.size() -1 ; i >= 0 ; i--){\n\t\t\t\tauto x = sim[i];\n\t\t\t\tif( x[1] != 0 && x[1] != 2*l ){\n\t\t\t\t\tnewSim.push_back(x);\n\t\t\t\t}else{\n\t\t\t\t\tlast = x[2];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tsim = newSim;\n\t\t\ttm++;\n\t\t}\n\t\tcout << tm/2 << \" \" << last << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define MAX 110\n \nbool check(int ant[MAX],int L){\n    for(int i = 0 ; i < L ; i++){\n\tif(ant[i] != 0) return false;\n    }\n    return true;\n}\n \nint main(){\n    int N,L,p;\n    char d;\n    while(cin >> N >> L, N){\n\tint ant[MAX]={0};\n\tvector<int> tunnel[MAX],id[MAX];\n\tL--;\n\tfor(int i = 0 ; i < N ; i++){\n\t    cin >> d >> p;\n\t    ant[p-1]++;\n\t    id[p-1].push_back(i+1);\n\t    tunnel[p-1].push_back((d == 'L' ? 1 : 2));\n\t}\n\tint t = 0,last;\n\twhile(!check(ant,L)){\n\t    vector<int> next[MAX],nid[MAX];\n\t    last = -1;\n\t    for(int i = 0 ; i < L ; i++){\n\t\tnext[i].clear();\n\t\tnid[i].clear();\n\t\tif(ant[i] && last == -1){\n\t\t    last = id[i][0];\n\t\t}\n\t    }\n\t    for(int i = 0 ; i < L ; i++){\n\t\twhile(tunnel[i].size()){\n\t\t    if(tunnel[i][0] == 1){\n\t\t\ttunnel[i].erase(tunnel[i].begin());\n\t\t\tif(i-1 >= 0){\n\t\t\t    next[i-1].push_back(1);\n\t\t\t    nid[i-1].push_back(id[i][0]);\n\t\t\t    id[i].erase(id[i].begin());\n\t\t\t}\n\t\t    }else if(tunnel[i][0] == 2){\n\t\t\ttunnel[i].erase(tunnel[i].begin());\n\t\t\tif(i+1 < L){\n\t\t\t    next[i+1].push_back(2);\n\t\t\t    nid[i+1].push_back(id[i][0]);\n\t\t\t    id[i].erase(id[i].begin());\n\t\t\t}\n\t\t    }\n\t\t}\n\t    }\n\t    for(int i = 0 ; i < L ; i++){\n\t\ttunnel[i] = next[i];\n\t\tid[i] = nid[i];\n\t\tif(tunnel[i].size() == 2){\n\t\t    swap(tunnel[i][0],tunnel[i][1]);\n\t\t}\n\t\tant[i] = tunnel[i].size();\n\t    }\n\t    t++;\n\t}\n\tcout << t << \" \" << last << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main () \n{\n    int num_ant, length;\n    \n    while (1)\n    {\n        std::cin >> num_ant >> length;\n        \n        if (num_ant == 0 && length == 0) break;\n        \n        int direction[num_ant];\n        int position[num_ant];\n        char temp;\n        int  tag;\n        \n        // input\n        for (int i = 0; i < num_ant; i++)\n        {\n            std::cin >> temp >> position[i];\n            if (temp == 'R') direction[i] = 1;\n            else direction[i] = -1;\n        }\n        \n        // simulate\n        bool goal[110] = {0};\n        bool flag = false;\n        int t = 0;\n        \n        while (!flag)\n        {\n            t++;\n            int conflict[110] = {0};\n            int point[110] = {0};\n            flag = true;\n            \n            for (int j = 0; j < num_ant; j++) \n            {\n                if (goal[j] == false)\n                {\n                    position[j] += direction[j];\n                    \n                    if (conflict[position[j]] != 0)\n                    {\n                        direction[j] *= -1;\n                        direction[point[position[j]]] *= -1;\n                    }\n                    else\n                    {\n                        conflict[position[j]]++;\n                        point[position[j]] = j;\n                    }\n                    \n                    if (position[j] == 0 || position[j] == length)\n                    {\n                        goal[j] = true;\n                        if (position[j] == 0 )\n                        {\n                            tag = j;\n                        }\n                        else if (position[j] == length && conflict[0] == 0)\n                        {\n                            tag = j;\n                        }\n                    }\n                }\n            }\n            \n            // confirming\n            for (int k = 0; k < num_ant; k++) \n            {\n                if (goal[k] != true) flag = false;\n            }\n            \n        }\n        \n        std::cout << t << \" \" << tag + 1 << std::endl;\n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint n,l;\nchar d[250];\nint p[250];\nbool goal[250];\n\nint main(){\n\twhile(1){\n\t\tint n,l;\n\t\tcin >> n >> l;\n\t\tif(n==0&&l==0) break;\n\t\tREP(i,n){\n\t\t\tcin >> d[i] >> p[i];\n\t\t\tgoal[i] = false;\n\t\t}\n\t\tint rest = n;\n\t\tint leftgoal;\n\t\tll int goaltime = 0;\n\t\twhile(rest!=0){\n\t\t\tgoaltime++;\n\t\t\tvector<int> posd[500];\n\t\t\tREP(i,500) posd[i].clear();\n\t\t\tREP(i,n){\n\t\t\t\t//cout << d[i] << \" \" << p[i] << endl;\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tif(goal[i]) continue;\n\t\t\t\tif(p[i]<=0||p[i]==l) continue;\n\t\t\t\tif(d[i]=='L') p[i]--;\n\t\t\t\telse p[i]++;\n\t\t\t\t//cout << p[i] << endl;\n\t\t\t\tposd[p[i]].pb(i);\n\t\t\t}\n\t\t\tREP(i,l+1){\n\t\t\t\tif(posd[i].size()==2){\n\t\t\t\t\tswap(d[posd[i][1]],d[posd[i][0]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tif(p[i]==0){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\tleftgoal = i;\n\t\t\t\t\trest--;\n\t\t\t\t}\n\t\t\t\tif(p[i]==l){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\trest--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << goaltime << \" \" << leftgoal+1 << endl;\n\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <set>\n#include <map>\n#include <string>\n#include <stack>\n#include <queue>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <bitset>\n#include <complex>\n#include <unistd.h>\n#include <cassert>\n#include <cctype>\n#include <random>\n#define _USE_MATH_DEFINES\n#define _GLIBCXX_DEBUG\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> plglg;\ntypedef tuple<int, int, int> tiii;\ntypedef tuple<ll, ll, ll> tlglglg;\ntypedef complex<double> xy_t;\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\ndouble pi = 3.141592653589793;\nll mod = 1000000007;\nint intmax = 2147483647;\nint intmin = -2147483648;\nll llmax = 9223372036854775807;\nll llmin = -9223372036854775807;\nint iinf = intmax / 8;\nll inf = llmax / 8;\ndouble eps = 1e-11;\n\nint main() {\n    while (1) {\n        int n, l;\n        cin >> n >> l;\n        if (n == 0) {\n            break;\n        }\n        vector<pii> len[2];\n        vector<bool> b[2];\n        for (int i = 0; i < n; i++) {\n            string dir;\n            int dis;\n            cin >> dir >> dis;\n            if (dir == \"R\") {\n                len[0].push_back(pii(dis, i + 1));\n                b[0].push_back(true);\n            } else {\n                len[1].push_back(pii(dis, i + 1));\n                b[1].push_back(true);\n            }\n        }\n        for (int i = 0; i < 2; i++) {\n            sort(len[i].begin(), len[i].end());\n        }\n        int time = 0;\n        bool dir;\n        int rlen = len[0].size();\n        int llen = len[1].size();\n        int rmax = (rlen > 0) ? l - len[0][0].first : -1;\n        int lmax = (llen > 0) ? len[1][llen - 1].first : -1;\n        int now;\n        if (lmax >= rmax) {\n            time = lmax;\n            dir = false;\n            b[1][llen - 1] = false;\n            now = llen - 1;\n        } else {\n            time = rmax;\n            dir = true;\n            b[0][0] = false;\n            now = 0;\n        }\n        while (1) {\n            if (dir) {\n                int pos = len[0][now].first;\n                int num = -1;\n                for (int i = 0; i < llen; i++) {\n                    if (len[1][i].first <= pos) {\n                        continue;\n                    }\n                    if (!b[1][i]) {\n                        break;\n                    }\n                    if ((len[1][i].first - pos) % 2 == 0) {\n                        num = i;\n                    }\n                }\n                if (num == -1) {\n                    break;\n                } else {\n                    now = num;\n                    dir = !dir;\n                    b[1][num] = false;\n                }\n            } else {\n                int pos = len[1][now].first;\n                int num = -1;\n                bool ok = false;\n                for (int i = 0; i < rlen; i++) {\n                    if (!b[0][i]) {\n                        num = i;\n                        ok = false;\n                        continue;\n                    }\n                    if (len[0][i].first >= pos) {\n                        break;\n                    }\n                    if ((pos - len[0][i].first) % 2 == 0) {\n                        num = i;\n                        ok = true;\n                        break;\n                    }\n                }\n                if (!ok) {\n                    break;\n                } else {\n                    now = num;\n                    dir = !dir;\n                    b[0][num] = false;\n                }\n            }\n        }\n        if (dir) {\n            cout << time << \" \" << len[0][now].second << endl;\n        } else {\n            cout << time << \" \" << len[1][now].second << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\twhile (cin >> N >> M, N) {\n\t\tvector<char>c(N);\n\t\tvector<int>v(N);\n\t\tint ans = 0;\n\t\tint idx = 0;\n\t\tvector<int>odd;\n\t\tvector<int>even;\n\t\tint oddl = 0, oddr = 0, evenl = 0, evenr = 0;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tcin >> c[i] >> v[i];\n\t\t\tif (v[i] & 1) {\n\t\t\t\todd.push_back(i);\n\t\t\t\tif (c[i] == 'L')oddl++;\n\t\t\t\telse oddr++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\teven.push_back(i);\n\t\t\t\tif (c[i] == 'L')evenl++;\n\t\t\t\telse evenr++;\n\t\t\t}\n\t\t\tif (c[i] == 'L') {\n\t\t\t\tif (ans <= v[i]) {\n\t\t\t\t\tans = v[i];\n\t\t\t\t\tidx = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (ans < M - v[i]) {\n\t\t\t\t\tans = M - v[i];\n\t\t\t\t\tidx = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \";\n\t\tif (v[idx] & 1) {\n\t\t\tif (c[idx] == 'L')cout << odd[oddl - 1] + 1 << endl;\n\t\t\telse cout << odd[oddl] + 1 << endl;\n\t\t}\n\t\telse {\n\t\t\tif (c[idx] == 'L')cout << even[evenl - 1] + 1 << endl;\n\t\t\telse cout << even[evenl] + 1 << endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <cstdio>\nint main(){\n\tint N,L;\n\tfor(;scanf(\"%d%d\",&N,&L),L;){\n\t\tstd::vector<std::pair<int,int> >v(N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tchar c;\n\t\t\tscanf(\" %c%d\",&c,&v[i].second);\n\t\t\tv[i].first=c=='L'?-1:1;\n\t\t}\n\t\tint rl,rr,f=1,t=0;\n\t\tfor(;f;t++){\n\t\t\trl=rr=f=0;\n\t\t\tfor(int i=0;i<N;i++)if(v[i].second!=0&&v[i].second!=L){\n\t\t\t\tv[i].second+=v[i].first;\n\t\t\t\tif(v[i].second==0)rl=i+1;\n\t\t\t\tif(v[i].second==L)rr=i+1;\n\t\t\t}\n\t\t\tfor(int i=0;i<N;i++)if(v[i].second!=0&&v[i].second!=L){\n\t\t\t\tf=1;\n\t\t\t\tfor(int j=i+1;j<N;j++)if(v[i].second==v[j].second){\n\t\t\t\t\tv[i].first*=-1;\n\t\t\t\t\tv[j].first*=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\",t,rl?rl:rr);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for(int i=0; i<(int)(n); ++i)\n\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nint main(){\n    int N, L;\n    while(cin >> N >> L && N){\n        vector<int> d(N);\n        vector<int> p(N);\n        REP(i, N) {\n            char c;\n            cin >> c >> p[i];\n            d[i] = (c == 'L' ? -1 : 1);\n        }\n        vector<P> vp(N, P(-1, -1));\n        for(int t = 0; ; t++){\n            bool update = false;\n            REP(i, N){\n                if(p[i] > 0 && p[i] < L){\n                    p[i] += d[i];\n                    update = true;\n                }else if(vp[i].first == -1){\n                    vp[i] = P(t, -p[i]);\n                }\n            }\n            //REP(i, N) cout << p[i] << \" \"; cout << endl;\n            if(!update) break;\n            REP(i, N) REP(j, i){\n                if(p[i] == p[j]){\n                    d[i] *= -1;\n                    d[j] *= -1;\n                }\n            }\n        }\n        P max_vp(-1, -1);\n        REP(i, N) max_vp = max(max_vp, vp[i]);\n        P ans;\n        REP(i, N) if(max_vp == vp[i]) ans = P(vp[i].first, i + 1);\n        printf(\"%d %d\\n\", ans.first, ans.second);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint ansTime;\nint dx[] = {-1, 1};\nint n, l;\nint d[22], p[22];\n\nvoid solve(){\n  int ansAnt = -1;\n  int rem = n;\n  int tm = 1;\n\n  while(rem > 0){\n    int nd[22], np[22];\n\n    for(int i = 0; i < n; i++){\n      if(p[i] == 0 || p[i] == l){\n        nd[i] = d[i];\n        np[i] = p[i];\n        continue;\n      }\n\n      bool flg = false;\n\n      for(int j = 0; j < n; j++){\n        if(i == j) continue;\n        if(p[i] == p[j]){\n          flg = true;\n          break;\n        }\n      }\n\n      nd[i] = flg ? !d[i] : d[i];\n      np[i] = p[i] + dx[nd[i]];\n\n      if(np[i] == 0 || np[i] == l){\n        rem--;\n        if(tm != ansTime || np[i] == l && ansAnt != -1) continue;\n        ansAnt = i + 1;\n      }\n    }\n\n    for(int i = 0; i < n; i++){\n      d[i] = nd[i];\n      p[i] = np[i];\n    }\n\n    tm++;\n  }\n\n  cout << ansTime << \" \" << ansAnt << endl;\n}\n\nint main(){\n  while(cin >> n >> l){\n    if(n == 0) break;\n\n    ansTime = 0;\n\n    for(int i = 0; i < n; i++){\n      char dir;\n      cin >> dir >> p[i];\n\n      if(dir == 'L'){\n        d[i] = 0;\n        ansTime = max(ansTime, p[i]);\n      }\n      else{\n        d[i] = 1;\n        ansTime = max(ansTime, l - p[i]);\n      }\n    }\n\n    solve();\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n  int n;\n  cin >> n;\n  cout << n << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <sstream>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <list>\n#include <iomanip>\n#include <set>\n#include <cctype>\n#include <bitset>\nusing namespace std;\ntypedef string::const_iterator State;\nconst int MOD=1000000007;\nconst int INF=1000000000;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nint n,l;\nint p[25];\nchar d[25];\nint t[25];\nbool escape[25];\nint main(int argc,char const* argv[])\n{\n  while(cin >> n >> l && n)\n    {\n      memset(t,0,sizeof(t));\n      memset(escape,false,sizeof(escape));\n      int anst=-1;\n      int ansindex;\n      for(int i=0;i<n;i++)\n\t{\n\t  cin >> d[i] >> p[i];\n\t}\n      while(1)\n\t{\n\t  bool clear=true;\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(!escape[i])\n\t\t{\n\t\t  if(d[i]=='R')\n\t\t    {\n\t\t      p[i]++;\n\t\t      t[i]++;\n\t\t    }\n\t\t  else if(d[i]=='L')\n\t\t    {\n\t\t      p[i]--;\n\t\t      t[i]++;\n\t\t    }\n\t\t}\n\t    }\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(p[i]==0 || p[i]==l) escape[i]=true;\n\t      for(int j=i+1;j<n;j++)\n\t\t{\n\t\t  if(escape[i] || escape[j]) continue;\n\t\t  if(p[i]==p[j])\n\t\t    {\n\t\t      if(d[i]=='R') d[i]='L';\n\t\t      else if(d[i]=='L') d[i]='R';\n\t\t      if(d[j]=='R') d[j]='L';\n\t\t      else if(d[j]=='L') d[j]='R';\n\t\t    }\n\t\t}\n\t    }\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(!escape[i]) clear=false;\n\t    }\n\t  if(clear) break;\n\t}\n      for(int i=0;i<n;i++)\n\t{\n\t  //cout << t[i] << endl;\n\t  if(t[i]>anst)\n\t    {\n\t      anst=t[i];\n\t      ansindex=i+1;\n\t    }\n\t}\n      for(int i=0;i<n;i++)\n\t{\n\t  if(t[i]==anst && p[i]==0)\n\t    {\n\t      anst=t[i];\n\t      ansindex=i+1;\n\t    }\n\t}\n      cout << anst << ' ' << ansindex << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define ALL(a) (a).begin(), (a).end()\n#define ll long long\n\nusing namespace std;\n\nbool play(vector<set<int> > &m){\n\tfor(auto e : m)if(e.size() != 0)return true;\n\treturn false;\n}\n\nsigned main(){\n\twhile(true){\n\t\tint n,l; cin >> n >> l;\n\t\tif(n == 0)break;\n\t\tvector<int> d(n), p(n);\n\t\tvector<set<int> > m(l);\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tchar tmp;\n\t\t\tcin >> tmp >> p[i];\n\t\t\td[i] = tmp == 'R' ? 1 : -1;\n\t\t\tp[i]--;\n\t\t\tm[p[i]].insert(i);\n\t\t}\n\t\tint last = -1, cnt = 0;\n\t\twhile(play(m)){\n\t\t\tfor(int i = 0; i < l; i++){\n//\t\t\t\tfor(auto e : m[i])cerr << e << \":\";\n//\t\t\t\tcerr << \"---\";\n\t\t\t}\n//\t\t\tcerr << endl;\n\t\t\tvector<set<int> > next(l);\n\t\t\tfor(int i = l-1; i >= 0; i--){\n\t\t\t\tfor(auto e : m[i]){\n\t\t\t\t\tif(0 <= i+d[e] && i+d[e] < l-1){\n//\t\t\t\t\t\tcerr << i << \":\" << e << \"->\" << (i+d[e]) << endl;\n\t\t\t\t\t\tnext[i+d[e]].insert(e);\n\t\t\t\t\t}\n\t\t\t\t\telse if(i+d[e] >= l-1){\n\t\t\t\t\t\tlast = e;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlast = e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0; i < l; i++){\n//\t\t\t\tfor(auto e : next[i])cerr << e << \":\";\n//\t\t\t\tcerr << \"---\";\n\t\t\t\tassert(next[i].size() <= 2);\n\t\t\t\tif(next[i].size() == 2){\n\t\t\t\t\tfor(auto e : next[i])d[e] *= -1;\n\t\t\t\t}\n\t\t\t}\n//\t\t\tcerr << endl;\n\t\t\tswap(next, m);\n\t\t\tcnt++;\n\t\t}\n\t\tcout << cnt << \" \" << (last+1) << endl;\n\t\t\t\t\t\n\n\n\t\t\t\t\n\t\t\t\n\t}\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\n\nint lant[128], rant[128];\n\nint main()\n{\n  int n, l;\n  while(1){\n    cin >> n >> l;\n    if(n == 0 && l == 0) break;\n    memset(lant, -1, sizeof(lant));\n    memset(rant, -1, sizeof(rant));    \n    int d[32];\n    int res = 0, ant = 0;\n    rep(i, n){\n      string s; int p;\n      cin >> s >> p;\n      if(s == \"L\") lant[p] = i;\n      else rant[p] = i;\n    }\n\n    rep(time, l){\n      for(int i=l;i>0;i--){\n\tif(rant[i] != -1 && lant[i] != -1){\n\t  swap(rant[i], lant[i]);\n\t}\n\tif(i==l-1 && rant[i] != -1){\n\t  res = time;\n\t  ant = rant[i]; rant[i] = -1;\n\t  //\t  cout << time << \" \" << ant << endl;\n\t  continue;\n\t}\n\trant[i+1] = rant[i]; rant[i] = -1;\n      }\n\n      for(int i=1;i<=l;i++){\n\tif(i==1 && lant[i] != -1){\n\t  res = time;\n\t  ant = lant[i]; lant[i] = -1;\n\t  //\t  cout << time << \" \" << ant  << endl;\n\t  continue;\n\t}\n\tlant[i-1] = lant[i]; lant[i] = -1;\n      }\n    }\n    cout << res+1 << \" \" << ant+1 << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint main(void){\n\n  while(1){\n    int n;\n    int l;\n    cin >> n;\n    cin >> l;\n    if(n == 0 && l == 0){return 0;}\n\n    char d[n];\n    int p[n];\n\n    for(int i = 0 ; i < n ; i++){\n      cin >> d[i];\n      cin >> p[i];\n    }\n\n    int xn[l + 1][2]; // 0が左向き，1が右向き\n    int nextxn[l + 1][2]; // 0が左向き，1が右向き\n\n    for(int pos = 0 ; pos < l + 1 ; pos++){\n      nextxn[pos][0] = -1;\n      nextxn[pos][1] = -1;\n    }\n\n    for(int i = 0 ; i < n ; i++){\n      if(d[i] == 'L'){\n        nextxn[p[i]][0] = i;\n      }else if(d[i] == 'R'){\n        nextxn[p[i]][1] = i;\n      }\n    }\n\n    int last;\n    int time = 0;\n\n    while( n != 0 ){\n\n      for(int pos = 0 ; pos < l + 1 ; pos++){\n        xn[pos][0] = nextxn[pos][0];\n        xn[pos][1] = nextxn[pos][1];\n      }\n\n      for(int pos = 0 ; pos < l + 1 ; pos++){\n        nextxn[pos][0] = -1;\n        nextxn[pos][1] = -1;\n      }\n\n      if(xn[l-1][1] != -1){\n        last = xn[l-1][1];\n        n--;\n      }\n\n      if(xn[1][0] != -1){\n        last = xn[1][0];\n        n--;\n      }\n\n\n      if(xn[1][1] != -1){\n        if(xn[3][0] != -1){\n          nextxn[2][0] = xn[1][1];\n        }else{\n          nextxn[2][1] = xn[1][1];\n        }\n      }\n\n      for(int pos = 2 ; pos < l - 1 ; pos++){\n        if(xn[pos][0] != -1){\n          if(xn[pos - 2][1] != -1){\n            nextxn[pos - 1][1] = xn[pos][0];\n          }else{\n            nextxn[pos - 1][0] = xn[pos][0];\n          }\n        }\n\n        if(xn[pos][1] != -1){\n          if(xn[pos + 2][0] != -1){\n            nextxn[pos + 1][0] = xn[pos][1];\n          }else{\n            nextxn[pos + 1][1] = xn[pos][1];\n          }\n        }\n      }\n\n      if(xn[l - 1][0] != -1){\n        if(xn[l - 3][1] != -1){\n          nextxn[l - 2][1] = xn[l - 1][0];\n        }else{\n          nextxn[l - 2][0] = xn[l - 1][0];\n        }\n      }\n\n      time++;\n    }\n    cout << time << \" \" << last + 1 << endl;\n\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n\n#define MP make_pair\n \nint main() {\n  \n  int N, L;\n  while(cin >> N >> L && (N|L)) {\n    vector<pair<int, int> > v;\n    rep(i, N) {\n      char d; int p; cin >> d >> p;\n      v.push_back(MP(d == 'R' ? +1 : -1, p));\n    }\n    \n    int time = 0;\n    int ans = -1;\n    int remain = N;\n    while(remain > 0) {\n      int ch[2200] = {};\n      int *check = ch+1100;\n      rep(i, N) {\n        v[i].second += v[i].first;\n        check[v[i].second] ++; \n      }\n      \n      rep(i, N) {\n        if(check[v[i].second] == 2) {\n          v[i].first *= -1;\n        }\n      }\n\n      bool f = 0;\n      rep(i, N) {\n        if(v[i].second == 0) {\n          remain --;\n          f = 1;\n          ans = i+1;\n        }\n        if(v[i].second == L) {\n          remain --;\n          if(!f) { ans = i+1; }\n        }\n      }\n      time ++;\n    }\n    cout << time << \" \" << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define DEBUG(x) cerr << #x << \" = \" << x << endl\n\nint main() {\n    while(true) {\n        int N, L; cin >> N >> L;\n        if(N == 0 && L == 0) break;\n        vector<int> pos(N);\n        // L=-1, R=1\n        vector<int> dir(N);\n        for(int i = 0; i < N; i++) {\n            int p; char d;\n            cin >> d >> p;\n            pos[i] = p;\n            dir[i] = (d == 'R') ? 1 : -1;\n        }\n        int last = 0;\n        int lastsecond = 0;\n        int second = 0;\n        int lastPos = (int)1e9;\n        vector<int> live(N, 1);\n        while(true) {\n            second++;\n            vector<int> on(L + 1, 0);\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    pos[i] += dir[i];\n                    on[pos[i]]++;\n                }\n            }\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    if(on[pos[i]] >= 2) {\n                        dir[i] *= -1;\n                    }\n                }\n            }\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    if(pos[i] == 0 || pos[i] == L) {\n                        live[i] = 0;\n                        if(second == lastsecond) {\n                            if(pos[i] < lastPos) {\n                                last = i;\n                                lastsecond = second;\n                                lastPos = pos[i];\n                            }\n                        }\n                        else {\n                            last = i;\n                            lastsecond = second;\n                            lastPos = pos[i];\n                        }\n                    }\n                }\n            }\n            bool f = false;\n            for(int i = 0; i < N; i++) {\n                if(live[i]) f = true;\n            }\n            if(!f) break;\n        }\n        cout << lastsecond << ' ' << last + 1 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n#define rep(i,x,y) for(int i=(x);i<(y);i++)\n\nstruct S {\n\tbool flag;\n\tbool turnend;\n\tint id;\n\tchar dir;\n\n\tS()\n\t{\n\n\t}\n\n\tS(bool f)\n\t{\n\t\tflag = f;\n\t\tturnend = false;\n\t}\n};\n\nint main()\n{\n\twhile (true) {\n\t\tint n, l;\n\n\t\tcin >> n >> l;\n\n\t\tif (n == 0 && l == 0) {\n\t\t\tbreak;\n\t\t}\n\n\t\tvector<vector<S>> tunnel(l + 1, vector<S>(4, S(false)));\n\n\t\trep(i, 0, n) {\n\t\t\tchar d;\n\t\t\tint p;\n\n\t\t\tcin >> d >> p;\n\n\t\t\ttunnel[p][0].flag = true;\n\t\t\ttunnel[p][0].id = i + 1;\n\t\t\ttunnel[p][0].dir = d;\n\t\t}\n\n\t\tint turn = 0;\n\n\t\twhile (n != 0) {\n\t\t\tturn++;\n\n\t\t\trep(i, 0, l + 1) {\n\t\t\t\trep(j, 0, 4) {\n\t\t\t\t\ttunnel[i][j].turnend = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//?§????\n\t\t\trep(i, 1, l) {\n\t\t\t\trep(j, 0, 4) {\n\t\t\t\t\tif (tunnel[i][j].flag == false) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tunnel[i][j].turnend == true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tunnel[i][j].dir == 'R') {\n\t\t\t\t\t\tif (tunnel[i + 1][0].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i + 1][0]);\n\t\t\t\t\t\t\ttunnel[i + 1][0].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (tunnel[i + 1][1].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i + 1][1]);\n\t\t\t\t\t\t\ttunnel[i + 1][1].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (tunnel[i + 1][2].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i + 1][2]);\n\t\t\t\t\t\t\ttunnel[i + 1][2].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i + 1][3]);\n\t\t\t\t\t\t\ttunnel[i + 1][3].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (tunnel[i - 1][0].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i - 1][0]);\n\t\t\t\t\t\t\ttunnel[i - 1][0].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (tunnel[i - 1][1].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i - 1][1]);\n\t\t\t\t\t\t\ttunnel[i - 1][1].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (tunnel[i - 1][2].flag == false) {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i - 1][2]);\n\t\t\t\t\t\t\ttunnel[i - 1][2].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tswap(tunnel[i][j], tunnel[i - 1][3]);\n\t\t\t\t\t\t\ttunnel[i - 1][3].turnend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//????????¢???\n\t\t\trep(i, 1, l) {\n\t\t\t\trep(j, 0, 4) {\n\t\t\t\t\tif (tunnel[i][j].flag == true) {\n\t\t\t\t\t\trep(k, j + 1, 4) {\n\t\t\t\t\t\t\tif (tunnel[i][k].flag == true) {\n\t\t\t\t\t\t\t\tswap(tunnel[i][j].dir, tunnel[i][k].dir);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//??´?????????????\\´??????????????????\n\t\t\tif (tunnel[l][0].flag == true) {\n\t\t\t\tif (n == 1) {\n\t\t\t\t\tcout << turn << \" \" << tunnel[l][0].id << endl;\n\t\t\t\t}\n\t\t\t\ttunnel[l][0].flag = false;\n\t\t\t\tn--;\n\t\t\t}\n\n\t\t\tif (tunnel[0][0].flag == true) {\n\t\t\t\tif (n == 1) {\n\t\t\t\t\tcout << turn << \" \" << tunnel[0][0].id << endl;\n\t\t\t\t}\n\t\t\t\ttunnel[0][0].flag = false;\n\t\t\t\tn--;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main () \n{\n    int num_ant, length;\n    \n    while (1)\n    {\n        std::cin >> num_ant >> length;\n        \n        if (num_ant == 0 && length == 0) break;\n        \n        char temp;\n        int position[num_ant];\n        int direction[num_ant];\n        \n        // input\n        for (int i = 0; i < num_ant; i++)\n        {\n            std::cin >> temp >> position[i];\n            if (temp == 'R') direction[i] =  1;\n            else             direction[i] = -1;\n        }\n        \n        // simulation\n        int t = 0;\n        int tag;\n        bool flag = false;\n        while (!flag)\n        {\n            t++;\n            int dummy[220] = {0};\n            //int conflict[110] = {0};\n            int *conflict = &dummy[110];\n            int point[110] = {0};\n            flag = true;\n            \n            for (int i = 0; i < num_ant; i++)\n            {\n                // renew position\n                position[i] += direction[i];\n                \n                // ditecting conflict\n                if (conflict[position[i]] != 0) \n                {\n                    direction[i] *= -1;\n                    direction[point[position[i]]] *= -1;\n                }\n                else if (0 < position[i] && position[i] < length)\n                {\n                    conflict[position[i]]++;\n                    point[conflict[position[i]]] = i;\n                }\n            }\n            \n            // confirming\n            for (int j = 0; j < num_ant; j++) \n            {\n                if (0 < position[j] && position[j] < length) flag = false;\n            }\n            \n            if (flag)\n            {\n                for (int k = 0; k < num_ant; k++) \n                {\n                    if (position[k] == 0 || position[k] == length)\n                    {\n                        tag = k;\n                        break;\n                    }\n                }\n            }\n            \n        }\n        \n        std::cout << t << \" \" << tag + 1 << std::endl;\n        \n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<(n);i++)\nusing namespace std;\ntypedef pair<int,int>P;\n\nint d[20],p[20];\nchar s[2];\nint main(){\n\tint n,l;\n\twhile(scanf(\"%d%d\",&n,&l),n){\n\t\tvector<P>v;\n\t\trep(i,n){\n\t\t\tscanf(\"%s%d\",s,&p[i]);\n\t\t\tif(s[0]=='L')d[i]=-1;\n\t\t\telse d[i]=1;\n\t\t\tv.push_back(P(p[i],i));\n\t\t}\n\t\tint cnt=0,a;\n\t\twhile(!v.empty()){\n\t\t\tcnt++;\n\t\t\tvector<P>u;\n\t\t\tint A=-1;\n\t\t\trep(i,v.size()){\n\t\t\t\tP p=v[i];\n\t\t\t\tp.first+=d[p.second];\n\t\t\t\tif(p.first==0||p.first==l){\n\t\t\t\t\tif(A==-1||p.first==0)A=p.second;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tu.push_back(p);\n\t\t\t}\n\t\t\ta=A;\n\t\t\tsort(u.begin(),u.end());\n\t\t\trep(i,int(u.size())-1){\n\t\t\t\tif(u[i].first==u[i+1].first){\n\t\t\t\t\td[u[i].second]=-d[u[i].second];\n\t\t\t\t\td[u[i+1].second]=-d[u[i+1].second];\n\t\t\t\t}\n\t\t\t}\n\t\t\tv=u;\n\t\t}\n\t\tprintf(\"%d %d\\n\",cnt,a+1);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vvvi = vector<vvi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \";\n        a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n\n    for (;;) {\n        int N, L; cin >> N >> L;\n        if (N == 0) break;\n\n        vector<char> D(N);\n        vi P(N);\n        int ma = 0, maxId = -1;\n        REP(i, N) {\n            cin >> D[i] >> P[i];\n            if (D[i] == 'L') {\n                if (ma <= P[i]) {\n                    ma = P[i];\n                    maxId = i;\n                }\n            }\n            if (D[i] == 'R') {\n                if (ma < L - P[i]) {\n                    ma = L - P[i];\n                    maxId = i;\n                }\n            }\n        }\n\n        vi a(N);\n        iota(ALL(a), 0);\n        REP(k, ma) {\n            REP(i, N) {\n                if (D[i] == 'L') --P[i];\n                if (D[i] == 'R') ++P[i];\n            }\n            REP(i, N) {\n                FOR(j, i+1, N) {\n                    if (P[i] == P[j]) {\n                        swap(a[i], a[j]);\n                    }\n                }\n            }\n        }\n\n        cout << ma << ' ' << a[maxId] + 1 << endl;\n    }\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int MAX_N=21;\n\nint n,l;\nchar d[MAX_N];\nint p[MAX_N];\n\nvoid solve(){\n    int ansl,ansr,ok=1,cnt=0;\n    while(ok){\n        ++cnt;\n        ansl=ansr=0;\n        for (int i=0;i<n;++i){\n            if (p[i]==0||p[i]==l) continue;\n            p[i]+=(d[i]=='L'?-1:1);\n            if (p[i]==0) ansl=i+1;\n            if (p[i]==l) ansr=i+1;\n        }\n        for (int i=0;i<n;++i){\n            if (0<p[i]&&p[i]<l){\n                for (int j=i+1;j<n;++j){\n                    if (p[i]==p[j]){\n                        d[i]=(d[i]=='L'?'R':'L');\n                        d[j]=(d[j]=='L'?'R':'L');\n                    }\n                }\n            }\n        }\n        ok=0;\n        for (int i=0;i<n;++i){\n            if (0<p[i]&&p[i]<l) ok=1;\n        }\n    }\n    cout << cnt << ' ' << (ansl?ansl:ansr) << '\\n';\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> n >> l,n){\n        for (int i=0;i<n;++i) cin >> d[i] >> p[i];\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <cstring>\nusing namespace std;\nint mp[2][101];\nint n,l;\n\nvoid solve(){\n  int sec=0,ant;\n  while(1){\n    sec++;\n    for(int i=l;i>=1;i--)if(mp[0][i-1]>=0&&mp[0][i]>=0)mp[0][i]=mp[0][i-1]; //to right\n    for(int i=0;i<l;i++)if(mp[1][i+1]>=0&&mp[1][i]>=0)mp[1][i]=mp[1][i+1];  //to left\n    for(int i=1;i<=l;i++)if((mp[0][i]>0&&mp[1][i]>0)||(mp[0][i]<0&&mp[1][i]<0)) swap(mp[0][i],mp[1][i]); //check\n    int flg;\n    for(flg=1;flg<l&&mp[0][flg]==0&&mp[1][flg]==0;flg++);\n    if(flg==l)break;\n  }\n  if(mp[0][l]>0)ant=mp[0][l];\n  if(mp[1][0]>0)ant=mp[1][0];\n  cout << sec <<\" \"<<ant<<endl;\n}\n\nint main(){\n  while(1){\n    cin >>n>>l;\n    if(n==0&&l==0)break;\n    memset(mp,0,sizeof(mp));\n    for(int i=0;i<n;i++){\n      char c;\n      int a,flg=0;\n      cin >>c>>a;\n      if(c=='L') flg=1;\n      mp[flg][a]=i+1;\n    }\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1) {\n    int n,l;\n    cin>>n>>l;\n    if(!n)break;\n    vector<tuple<int, int, int>> ant;\n    REP(i,n) {\n      string d;\n      int p;\n      cin>>d>>p;\n      ant.emplace_back(p, d==\"L\" ? -1 : 1, i);\n    }\n    REP(i,150) {\n      REP(j,n) {\n        int p,d,k;\n        tie(p,d,k) = ant[j];\n        p += d;\n        ant[j] = make_tuple(p,d,k);\n      }\n      sort(begin(ant),end(ant));\n      REP(j,n-1) {\n        auto p1 = ant[j];\n        auto p2 = ant[j+1];\n        if (get<0>(p1) == get<0>(p2)) {\n          swap(get<2>(ant[j]),get<2>(ant[j+1]));\n        }\n      }\n      bool isin = false;\n      int isinid = 0;\n      int isinp = 10000;\n      REP(j,n) {\n        int p = get<0>(ant[j]);\n        if (0 < p && p < l) {\n          isin = true;\n        } else if (p == 0 || p == l) {\n          if (isinp > p) {\n            isinid = get<2>(ant[j]);\n            isinp = p;\n          }\n        }\n      }\n      if (!isin) {\n        cout << i+1 << ' ' << isinid+1 << endl;\n        break;\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[100][2];\nint at[100];\nint wolf[200];\nint main(){\n\tint a,b;\n\twhile(scanf(\"%d%d\",&a,&b),a){\n\t\tfor(int i=0;i<a;i++){\n\t\t\tscanf(\"%s%d\",str[i],at+i);\n\t\t}\n\t\tfor(int t=1;;t++){\n\t\t\tfor(int i=0;i<b;i++)wolf[i]=0;\n\t\t\tfor(int i=0;i<a;i++){\n\t\t\t\tif(str[i][0]=='L'){\n\t\t\t\t\tat[i]--;\n\t\t\t\t\tif(at[i]>0)wolf[at[i]]++;\n\t\t\t\t}else{\n\t\t\t\t\tat[i]++;\n\t\t\t\t\tif(at[i]<b)wolf[at[i]]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<a;i++){\n\t\t\t\tif(0<at[i]&&at[i]<b&&wolf[at[i]]>1){\n\t\t\t\t\tif(str[i][0]=='L')str[i][0]='R';\n\t\t\t\t\telse str[i][0]='L';\n\t\t\t\t}\n\t\t\t}\n\t\t\tbool ok=true;\n\t\t\tfor(int i=0;i<a;i++){\n\t\t\t\tif(at[i]>0&&at[i]<b){\n\t\t\t\t\tok=false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ok){\n\t\t\t\tprintf(\"%d \",t);\n\t\t\t\tint l=-1;\n\t\t\t\tint r=-1;\n\t\t\t\tfor(int i=0;i<a;i++){\n\t\t\t\t\tif(at[i]==0)l=i;\n\t\t\t\t\tif(at[i]==b)r=i;\n\t\t\t\t}\n\t\t\t\tif(~l)printf(\"%d\\n\",l+1);\n\t\t\t\telse printf(\"%d\\n\",r+1);\n\t\t\t\tbreak;\n;\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max() / 32 * 15 + 208;\n\nint main() {\n    int n, l;\n    while(cin >> n >> l, n){\n        array<int, 150> a{}, b{};\n        for (int i = 0; i < n; ++i) {\n            char c; int d;\n            cin >> c >> d;\n            if(c == 'L') a[d] = i+1;\n            else b[d] = i+1;\n        }\n        int last = 0, t = 0;\n        while(true){\n            if (max(*max_element(a.begin(),a.end()), *max_element(b.begin(),b.end())) == 0) break;\n            for (int i = l; i > 0; --i) {\n                b[i] = b[i-1];\n            }\n            for (int i = 0; i < l; ++i) {\n                a[i] = a[i+1];\n            }\n            if(b[l] > 0) last = b[l];\n            if(a[0] > 0) last = a[0];\n\n            for (int i = 1; i < l; ++i) {\n                if(a[i] > 0 && b[i] > 0) swap(a[i], b[i]);\n            }\n            t++;\n        }\n        printf(\"%d %d\\n\", t-1, last);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define EXIST2(s,e) (find(ALL(s),(e))!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n\nint main(){\n\tint n,l;\n\twhile(cin>>n>>l,n|l){\n\t\tvi d(n),p(n);\n\t\tREP(i,n){\n\t\t\tchar dd;\n\t\t\tcin>>dd>>p[i];\n\t\t\tif(dd=='L'){\n\t\t\t\td[i]=-1;\n\t\t\t}else{\n\t\t\t\td[i]=1;\n\t\t\t}\n\t\t}\n\t\tbool not_yet=true;\n\t\tint cnt=0;\n\t\tint last=-1;\n\t\twhile(not_yet){\n\t\t\tcnt++;\n\t\t\tnot_yet=false;\n\t\t\tbool left=false;\n\t\t\tREP(i,n){\n\t\t\t\tif(p[i]>0&&p[i]<l){\n\t\t\t\t\tp[i]+=d[i];\n\t\t\t\t\tif(p[i]>0&&p[i]<l){\n\t\t\t\t\t\tnot_yet=true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(!left){\n\t\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\t}else if(p[i]==0){\n\t\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tleft=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tFOR(j,i+1,n){\n\t\t\t\t\tif(p[i]==p[j]){\n\t\t\t\t\t\td[i]*=-1;\n\t\t\t\t\t\td[j]*=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<cnt<<\" \"<<last+1<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tint n, l;\n\twhile(cin >> n >> l) {\n\t\tif(n == 0 && l == 0) break;\n\n\t\tvector<char> dir(n);\n\t\tvector<int> p(n);\n\t\trep(i, n) {\n\t\t\tcin >> dir[i] >> p[i];\n\t\t}\n\n\t\tint cnt = 0, id = -1, next[105];\n\t\tbool used[25];\n\t\tmemset(used, 0, sizeof(used));\n\n\t\twhile(true) {\n\t\t\tmemset(next, 0, sizeof(next));\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(dir[i] == 'R') p[i]++;\n\t\t\t\telse p[i]--;\n\n\t\t\t\tnext[p[i]]++;\n\t\t\t}\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(next[p[i]] == 2) {\n\t\t\t\t\tdir[i] = (dir[i] == 'R' ? 'L' : 'R');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(p[i] == l) {\n\t\t\t\t\tused[i] = true;\n\t\t\t\t\tid = i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tif(p[i] == 0) {\n\t\t\t\t\tused[i] = true;\n\t\t\t\t\tid = i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbool flag = true;\n\t\t\trep(i, n) {\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tflag = false;\n\t\t\t}\n\n\t\t\tif(flag) break;\n\t\t\tcnt++;\n\t\t}\n\n\t\tcout << cnt + 1 << \" \" << id + 1 << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nstruct ant { int loc; char dir; };\nant a[20]; int n, l; int memo;\nvoid move() {\n\tbool f = true;\n\trep(i, n) {\n\t\tif (a[i].loc == 1) {\n\t\t\tmemo = i; f = false;\n\t\t}\n\t\telse if (a[i].loc == l - 1 && f) {\n\t\t\tmemo = i;\n\t\t}\n\t}\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tif (a[i].dir == 'R')a[i].loc++;\n\t\telse a[i].loc--;\n\t}\n\trep(i, n) {\n\t\tif (a[i].loc == 0 || a[i].loc == l)continue;\n\t\tRep(j, i + 1, n) {\n\t\t\tif (a[i].loc == a[j].loc)swap(a[i].dir, a[j].dir);\n\t\t}\n\t}\n\treturn;\n}\nbool antfall() {\n\trep(i, n) {\n\t\tif (a[i].loc != 0 && a[i].loc != l)return false;\n\t}\n\treturn true;\n}\nint main() {\n\twhile (cin >> n >> l, n) {\n\t\tchar d; int p;\n\t\trep(i, n) {\n\t\t\tcin >> d >> p;\n\t\t\ta[i] = { p,d };\n\t\t}\n\t\tint turn;\n\t\tfor (turn = 1; turn < 105; turn++) {\n\t\t\tmove();\n\t\t\tif (antfall())break;\n\t\t}\n\t\tcout << turn << \" \" << memo+1 << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define M_PI 3.14159265358979323846\n\nusing namespace std;\n\n//typedef\n//-------------------------#include <bits/stdc++.h>\n\n#define M_PI 3.14159265358979323846\n\nusing namespace std;\n\n//conversion\n//------------------------------------------\ninline int toInt(string s)\n{\n    int v;\n    istringstream sin(s);\n    sin >> v;\n    return v;\n}\ntemplate <class T>\ninline string toString(T x)\n{\n    ostringstream sout;\n    sout << x;\n    return sout.str();\n}\ninline int readInt()\n{\n    int x;\n    scanf(\"%d\", &x);\n    return x;\n}\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<int, PII> TIII;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\n\n//container util\n\n//------------------------------------------\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SQ(a) ((a) * (a))\n#define EACH(i, c) for (typeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort((c).begin(), (c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i, s, n) for (int i = s; i < (int)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n//#define MOD 1000000007\n\n#define rep(i, a, b) for (int i = a; i < (b); ++i)\n#define trav(a, x) for (auto &a : x)\n#define all(x) x.begin(), x.end()\n#define sz(x) (int)(x).size()\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\nconst double EPS = 1E-8;\n\n#define chmin(x, y) x = min(x, y)\n#define chmax(x, y) x = max(x, y)\nconst int INF = 2147483647;\n\nconst int MAX = 510000;\nconst int MOD = 1000000007;\n\nlong long fac[MAX], finv[MAX], inv[MAX];\n\n// テーブルを作る前処理\nvoid COMinit()\n{\n    fac[0] = fac[1] = 1;\n    finv[0] = finv[1] = 1;\n    inv[1] = 1;\n    for (int i = 2; i < MAX; i++)\n    {\n        fac[i] = fac[i - 1] * i % MOD;\n        inv[i] = MOD - inv[MOD % i] * (MOD / i) % MOD;\n        finv[i] = finv[i - 1] * inv[i] % MOD;\n    }\n}\n\n// 二項係数計算\nlong long COM(int n, int k)\n{\n    if (n < k)\n        return 0;\n    if (n < 0 || k < 0)\n        return 0;\n    return fac[n] * (finv[k] * finv[n - k] % MOD) % MOD;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(15);\n\n    int n, l;\n    while (cin >> n >> l)\n    {\n        if (n == 0 && l == 0)\n            break;\n\n        int mx = 0;\n        vector<char> d(n);\n        vector<int> p(n);\n        bool out[25] = {false};\n        for (int i = 0; i < n; i++)\n        {\n            cin >> d[i] >> p[i];\n        }\n\n        int ans = 0;\n        int num = 0;\n        while (1)\n        {\n            bool check = true;\n\n            for (int i = 0; i < n; i++)\n            {\n                if (!out[i])\n                    check = false;\n            }\n\n            if (check)\n                break;\n\n            int ll = -1, rr = -1;\n            for (int i = 0; i < n; i++)\n            {\n                if (out[i])\n                    continue;\n\n                if (d[i] == 'R')\n                {\n                    p[i]++;\n                    if (p[i] == l)\n                    {\n                        out[i] = true;\n                        rr = i + 1;\n                    }\n                }\n                else if (d[i] == 'L')\n                {\n                    p[i]--;\n                    if (p[i] == 0)\n                    {\n                        out[i] = true;\n                        ll = i + 1;\n                    }\n                }\n            }\n            //cout << ll << \" \" << rr << endl;\n            if (ll != -1 && rr != -1)\n            {\n                num = ll;\n            }\n            else if (ll != -1)\n            {\n                num = ll;\n            }\n            else if (rr != -1)\n                num = rr;\n\n            for (int i = 0; i < n; i++)\n            {\n                if (out[i])\n                    continue;\n                for (int j = i + 1; j < n; j++)\n                {\n                    if (out[j])\n                        continue;\n\n                    if (p[i] == p[j])\n                    {\n                        if (d[i] == 'R')\n                            d[i] = 'L';\n                        else\n                            d[i] = 'R';\n\n                        if (d[j] == 'R')\n                            d[j] = 'L';\n                        else\n                            d[j] = 'R';\n                    }\n                }\n            }\n\n            ans++;\n        }\n        cout << ans << \" \" << num << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define P pair<char,int>\n#define fir first\n#define sec second\n#define PA pair<int,int>\n\n\nvoid f(int n,int l){\n    P a[10000]={};\n    queue<PA> q;\n\n    for(int i=0;i<n;i++){\n        char d;\n        int p;\n        cin>>d>>p;\n        a[i].fir=d;\n        a[i].sec=p;\n    }\n    int sum=0,last=0,time=0,latime=0;\n    while(sum<n){\n        for(int i=0;i<n;i++){\n            if(a[i].fir=='R') a[i].sec++;\n            if(a[i].fir=='L') a[i].sec--;\n        }\n        for(int i=0;i<n;i++){\n            for(int j=0;j<n;j++){\n                if(a[i].fir=='L'&&a[j].fir=='R'&&\n                        a[i].sec==a[j].sec){\n                    a[i].fir='R';\n                    a[j].fir='L';\n                }\n            }\n        }\n        for(int i=0;i<n;i++){\n            if(a[i].sec==0||a[i].sec==l){\n                sum++;\n                if(n==sum&&latime==time&&a[i].sec==l) continue;\n                last = i+1;\n                latime=time;\n            }\n        }\n        time++;\n    }\n\n    cout<<time<<' '<<last<<endl;\n}\n\n\n\nsigned main(){\n    int n,l;\n    while(1){\n        cin>>n>>l;\n        if(!n) break;\n        f(n,l);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\nusing namespace std;\nint cou;\nint n,l;\nstruct ant{\n  bool toRight;\n  int position;\n};\nant ants[20];\nint main() {\n  while(true){\n    cin >> n >> l;\n    if(n==0&&l==0) return 0;\n    rep(i,n){\n      ants[i] = ant();\n      char c;\n      cin >> c;\n      if(c=='R'){\n        ants[i].toRight = true;\n      }else{\n        ants[i].toRight = false;\n      }\n      cin >> ants[i].position;\n    }\n    cou = n;\n    int leftout;\n    int rightout;\n    for(int t = 1;true;t++){\n      leftout = -1;\n      rightout = -1;\n      rep(i,n){\n        if(ants[i].position==0||ants[i].position==l) continue;\n        if(ants[i].toRight){\n          ants[i].position++;\n        }else{\n          ants[i].position--;\n        }\n        if(ants[i].position==0){\n          cou--;\n          leftout = i;\n        }\n        if(ants[i].position==l){\n          cou--;\n          rightout = i;\n        }\n      }\n      if(cou==0){\n        if(leftout!=-1){\n          cout << t << \" \" << leftout+1 << endl;\n        }else{\n          cout << t << \" \" << rightout+1 << endl;\n        }\n        break;\n      }\n      rep(i,n){\n        if(ants[i].position==0||ants[i].position==l) continue;\n        REP(j,i+1,n){\n          if(ants[i].position==ants[j].position){\n            ants[i].toRight = !ants[i].toRight;\n            ants[j].toRight = !ants[j].toRight;\n          }\n        }\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <functional>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define int long long int\n\ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconstexpr ll INF = 1001001001001001LL;\nconstexpr ll MOD = 1000000007LL;\n\nint N, L;\nint coord[30], dir[30];\n\nsigned main() {\n    while(cin >> N >> L, N || L) {\n        string d; int p;\n        rep(i,0,N) {\n            cin >> d >> p;\n            coord[i] = p;\n            dir[i] = (d == \"L\");\n        }\n        int ma = -1, idx = 0, sec = 0;\n        while(1) {\n            sec++;\n            rep(i,0,N) {\n                if(coord[i] < 0) continue;\n                coord[i] += (1 * (dir[i] ? -1 : 1));\n            }\n            rep(i,0,N) rep(j,i+1,N) {\n                if(coord[i] == coord[j]) {\n                    dir[i] ^= 1;\n                    dir[j] ^= 1;\n                }\n            }\n\n            int cnt = 0;\n            rep(i,0,N) {\n                if(coord[i] == 0) {\n                    ma = sec;\n                    idx = i+1;\n                    coord[i] = -1;\n                }\n                if(coord[i] == L) {\n                    if(ma != sec) {\n                        ma = sec;\n                        idx = i+1;\n                    }\n                    coord[i] = -1;\n                }\n                if(coord[i] < 0) cnt++;\n            }\n\n            if(cnt == N) break;\n        }\n        printf(\"%lld %lld\\n\", ma, idx);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stack>\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <string>\n#include <algorithm>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#define INF 2100000000\n#define eps 1e-8\n#define mem(a,b) memset((a),(b),sizeof((a)))\n#define lld long long\n\nusing namespace std;\n\nint n, l;\nstruct s{\n    int pos;\n    int dir;\n    int out;\n    int id;\n    bool operator <(const s &I) const {\n        if(out != I.out) return out < I.out;\n        if(pos == I.pos) return dir < I.dir;\n        return pos < I.pos;\n    }\n    int gettime(const s &I) const {\n        if(dir == I.dir) return INF;\n        if(dir == 0 && pos <= I.pos) return INF;\n        if(dir == 1 && pos >= I.pos) return INF;\n        return abs(pos - I.pos) / 2;\n    }\n    int outdis() const {\n        if(dir == 0) return pos;\n        else return (l) * 2 - pos;\n    }\n    void move(int ll) {\n        if(dir == 0) pos -= ll;\n        else pos += ll;\n    }\n    void changedir() {\n        if(pos % 2) return;\n        dir = 1 - dir;\n    }\n}num[29];\nint cnt;\n\nint MAIN() {\n    cnt = n;\n    char str[19];\n    mem(num, 0);\n    for(int i = 0; i < n; i++) {\n        scanf(\"%s%d\", str, &num[i].pos);\n        num[i].id = i + 1;\n        if(str[0] == 'L') num[i].dir = 0;\n        else num[i].dir = 1;\n        num[i].pos *= 2;\n    }\n    int ans = 0;\n    int ans2 = 0;\n    while(cnt) {\n        sort(num, num + n);\n        int t = INF;\n        for(int i = 0; i < cnt - 1; i++) {\n            t = min(t, num[i].gettime(num[i + 1]));\n        }\n        for(int i = 0; i < cnt; i++) t = min(t, num[i].outdis());\n        for(int i = 0; i < cnt; i++) num[i].move(t);\n        sort(num, num + n);\n        ans += t;\n        if(num[cnt - 1].pos == (l) * 2) {\n            if(cnt == 1) {\n                ans2 = num[cnt - 1].id;\n                break;\n            } else {\n                num[cnt - 1].out = 1;\n                cnt--;\n            }\n        }\n        for(int i = cnt - 1; i >= 1; i--) {\n            if(num[i].pos == num[i - 1].pos) {\n                num[i].changedir();\n                num[i - 1].changedir();\n            }\n        }\n        if(num[0].pos == 0) {\n            if(cnt == 1) {\n                ans2 = num[0].id;\n                break;\n            } else {\n                cnt--;\n                num[0].out = 1;\n            }\n        }\n    }\n    printf(\"%d %d\\n\", ans / 2, ans2);\n    return 0;\n}\n\nint main()\n{\n    int cases;\n    while(~scanf(\"%d%d\", &n, &l)) {\n        if(n == 0 && l == 0) break;\n        MAIN();\n    }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\n\ntypedef pair<int,int> PII;\ntypedef long long LL;\n#define CLR(a,b) memset(a,b,sizeof(a))\n#define MP make_pair\n#define FI first\n#define SE second\n\nconst int N = 1000;\nPII a[2][N][2];\nbool in[N];\nint n,l;\nint last[2];\nint time[2];\nint t = 0;\n\nvoid update(int p, int who,int t)\n{\n    if(p == 0){\n        last[0] = who;\n        time[0] = t;\n        in[who] = 0;\n    }\n    if(p == l){\n        last[1] = who;\n        time[1] = t;\n        in[who] = 0;\n    }\n}\nvoid solve()\n{\n    CLR(last,0);\n    CLR(time,0);\n    for(int i = 1; i <= n ; i++)in[i] = 1;\n    for(int i = 1; i <= t ;i ++){\n        CLR(a[i & 1] , 0);\n        for (int j = 1; j < l ; j++){\n            for(int k = 0; k <= 1; k++){\n                PII cur = a[!(i&1)][j][k];\n                if(cur.FI != 0 && in[cur.FI]){\n                    if(a[i&1][j+cur.SE][0].FI == 0){\n                        a[i&1][j+cur.SE][0] = MP(cur.FI, cur.SE);\n                    }else{\n                        a[i&1][j+cur.SE][1] = MP(cur.FI, -cur.SE);\n                        a[i&1][j+cur.SE][0].SE = -a[i&1][j+cur.SE][0].SE;\n                    }\n                    update(j+cur.SE,cur.FI,i);\n                }\n            }\n        }\n    }\n    int ans = time[0] >= time[1] ? last[0] : last[1];\n    printf(\"%d %d\\n\",t,ans);\n}\nint main()\n{\n   // freopen(\"input.txt\",\"r\",stdin);\n    while(~scanf(\"%d%d\",&n,&l) && (n||l)){\n        t = 0;\n        CLR(a, 0);\n        CLR(in,0);\n        for(int i = 1 ; i <= n ; i++){\n            int p;\n            char s;\n            scanf(\" %c%d\",&s,&p);\n            int d = (s == 'L')? -1 : 1 ;\n            if(d == -1) t = max(t , p);\n            else t = max(t, l-p);\n            a[0][p][0] = MP( i , d );\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n\nclass Ant{\npublic:\n  char dir;\n  int pos;\n  Ant(char _d,int _p) : dir(_d), pos(_p) {}\n  Ant() : dir('\\0'), pos(-1) {}\n};\n\nint main(){\n  int total_ants;\n  int tunnel_length;\n  while(scanf(\"%d %d\",&total_ants,&tunnel_length)){\n    if(total_ants == 0) break;\n\n    Ant ants[101];\n    for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n      char dir[2];\n      int pos;\n      scanf(\"%s %d\",dir,&pos);\n      ants[ant_idx] = Ant(dir[0],pos);\n    }\n\n    int last_time = 0;\n    int last_ant = 0;\n    for(int time=1;time <= tunnel_length * total_ants;time++){\n      int collapse[101];\n      memset(collapse,0,sizeof(collapse));\n      int rem = 0;\n      for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n        if(ants[ant_idx].pos == 0\n           || ants[ant_idx].pos == tunnel_length) continue;\n\n        rem |= (1 << ant_idx);\n        if(ants[ant_idx].dir == 'R'){\n          collapse[ants[ant_idx].pos + 1] |= (1 << ant_idx);\n        }\n\n        else if(ants[ant_idx].dir == 'L'){\n          collapse[ants[ant_idx].pos - 1] |= (1 << ant_idx);\n        }\n      }\n\n      if(rem == 0) break;\n\n      for(int i=1;i<tunnel_length;i++){\n        if(__builtin_popcount(collapse[i]) >= 2){\n          for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n            if(collapse[i] & (1 << ant_idx)){\n              ants[ant_idx].pos += (ants[ant_idx].dir == 'R' ? 1 : -1);\n              ants[ant_idx].dir = (ants[ant_idx].dir == 'R' ? 'L' : 'R');\n              rem &= ~(1 << ant_idx);\n            }\n          }          \n        }\n      }\n\n      int tmp_ant = -1;\n      for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n        if(rem & (1<< ant_idx)){\n          if(ants[ant_idx].dir == 'R'){\n            ants[ant_idx].pos++;\n            if(ants[ant_idx].pos == tunnel_length){\n              if(tmp_ant == -1){\n                tmp_ant = ant_idx;\n              }\n            }\n          }\n          else if(ants[ant_idx].dir == 'L'){\n            ants[ant_idx].pos--;\n            if(ants[ant_idx].pos == 0){\n              tmp_ant = ant_idx;\n            }\n          }\n        }\n      }\n\n      last_ant = tmp_ant;\n      last_time = max(last_time,time);\n    }\n    \n    printf(\"%d %d\\n\",last_time,last_ant + 1);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define range(i, a, n) for(int (i) = (a); (i) < (n); (i)++)\n#define rep(i, n) for(int (i) = 0; (i) < (n); (i)++)\nusing namespace std;\nstruct Ant {\n    int pos, idx;\n    char dir;\n};\n\nint main(void){\n    for(int n, l; cin >> n >> l, n;){\n        vector<Ant> ant(n);\n        for(auto & e : ant) cin >> e.dir >> e.pos;\n        rep(i, n) ant[i].idx = i + 1;\n\n        int rest = 0, resi;\n        set<int> s;\n        rep(i, n) s.insert(i + 1);\n        while(s.size() != 0){\n            rep(i, n){\n                rep(j, n){\n                    if(ant[j].pos - ant[i].pos == 2 and\n                            ant[i].dir == 'R' and\n                            ant[j].dir == 'L'){\n                        swap(ant[i].idx, ant[j].idx);\n                    }\n                }\n            }\n\n            rep(i, n){\n                int dx = ant[i].dir == 'R' ? 1:-1;\n                ant[i].pos += dx;\n                if(ant[i].pos == 0 or ant[i].pos == l){\n                    s.erase(ant[i].idx);\n                    resi = ant[i].idx;\n                }\n            }\n\n            rest++;\n        }\n\n        cout << rest << \" \" << resi << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <numeric>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n    constexpr int EMPTY = -99;\n    while (true) {\n        int n, l;\n        cin >> n >> l;\n        if (n == 0 && l == 0) {\n            break;\n        }\n        // 0 と l はトンネルの端っこ\n        // fst：左向き，snd：右向き\n        vector<pair<int, int>> v(l + 1, make_pair(EMPTY, EMPTY));\n        // アリさんは1から数える\n        for (int i = 1; i <= n; ++i) {\n            char c;\n            int p;\n            cin >> c >> p;\n            if (c == 'L') {\n                v[p].first = i;\n            }\n            else {\n                v[p].second = i;\n            }\n        }\n\n        // アリさんの次の位置を求める\n        auto move_ = [EMPTY, l](const vector<pair<int, int>>& v) {\n            vector<pair<int, int>> r(v.size(), make_pair(EMPTY, EMPTY));\n            for (int i = 0; i < v.size(); ++i) {\n                // 左に移動\n                if (i > 0) {\n                    r[i - 1] = make_pair(v[i].first, r[i - 1].second);\n                }\n                // 右に移動\n                if (i < l) {\n                    r[i + 1] = make_pair(r[i + 1].first, v[i].second);\n                }\n            }\n            for (auto&& i : r) {\n                // 同じ位置にいる場合は衝突してるので，向きを変更\n                if (i.first != EMPTY && i.second != EMPTY) {\n                    swap(i.first, i.second);\n                }\n            }\n\n            return r;\n        };\n\n        int count = 0;\n        while (true) {\n            auto result = move_(v);\n            // 今出て行ったアリさんを記録\n            int left = result[0].first;\n            int right = result[l].second;\n            count += 1;\n            // 出て行ったアリさんを実際にどかす\n            result[0] = result[l] = make_pair(EMPTY, EMPTY);\n            // トンネルに誰もいなければ終了\n            if (accumulate(begin(result), end(result), true,\n                           [](bool b, const pair<int, int>& a) {\n                               return b && a.first == EMPTY &&\n                                      a.second == EMPTY;\n                           })) {\n                // 左優先\n                cout << count << \" \" << (left == EMPTY ? right : left) << endl;\n                break;\n            }\n            v = result;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <numeric>\n#include <sstream>\n#include <tuple>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n    constexpr int EMPTY = -99;\n    auto move_ = [EMPTY](const vector<pair<int, int>>& v) {\n        vector<pair<int, int>> r(v.size(), make_pair(EMPTY, EMPTY));\n        int exitL = EMPTY;\n        int exitR = EMPTY;\n        for (size_t i = 0; i < v.size(); ++i) {\n            if (i == 0 && v[i].first != EMPTY) {\n                exitL = v[i].first;\n                continue;\n            }\n            else if (i == v.size() - 1 && v[i].second != EMPTY) {\n                exitR = v[i].second;\n                continue;\n            }\n            if (v[i].first != EMPTY) {\n                r[i - 1] = make_pair(v[i].first, r[i - 1].second);\n            }\n            if (v[i].second != EMPTY) {\n                r[i + 1] = make_pair(r[i + 1].first, v[i].second);\n            }\n        }\n        for (auto&& i : r) {\n            if (i.first != EMPTY && i.second != EMPTY) {\n                swap(i.first, i.second);\n            }\n        }\n\n        return make_tuple(exitL, exitR, r);\n    };\n    while (true) {\n        int n, l;\n        cin >> n >> l;\n        if (n == 0 && l == 0) {\n            break;\n        }\n        vector<pair<int, int>> v(l, make_pair(EMPTY, EMPTY));\n        for (int i = 0; i < n; ++i) {\n            char c;\n            int p;\n            cin >> c >> p;\n            if (c == 'L') {\n                v[p].first = i;\n            }\n            else {\n                v[p].second = i;\n            }\n        }\n\n        int count = 0;\n        while (true) {\n            // auto p = [](int x) {\n            //    stringstream ss;\n            //    ss << x;\n            //    return x == EMPTY ? \" \" : ss.str();\n            //};\n            // for (auto&& i : v) {\n            //    cout << \"(\" << p(i.first) << \", \" << p(i.second) << \")\";\n            //}\n            // cout << endl;\n            int l, r;\n            vector<pair<int, int>> result;\n            tie(l, r, result) = move_(v);\n            bool end_ = accumulate(begin(result), end(result), true,\n                                   [](bool b, const pair<int, int>& a) {\n                                       return b && a.first == EMPTY &&\n                                              a.second == EMPTY;\n                                   });\n            // cout << \"exit \" << l << \" \" << r << endl;\n            if (end_) {\n                if (l == EMPTY) {\n                    cout << count + 1 << \" \" << (l == EMPTY ? r + 1 : l + 1)\n                         << endl;\n                }\n                else {\n                    cout << count << \" \" << (l == EMPTY ? r + 1 : l + 1)\n                         << endl;\n                }\n                break;\n            }\n            v = result;\n            count += 1;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\n\nusing lint = long long;\n\nstruct Ant {\n    int dir, x, id;\n    Ant(int dir = 0, int x = 0, int id = 0)\n        : dir(dir), x(x), id(id) {}\n};\n\nbool solve() {\n    int n, l;\n    cin >> n >> l;\n    if (n == 0) return false;\n\n    vector<Ant> ants(n);\n    {\n        int id = 1;\n        for (auto& a : ants) {\n            char d;\n            cin >> d >> a.x;\n            a.dir = (d == 'R' ? 1 : -1);\n            a.id = id++;\n        }\n    }\n\n    vector<Ant> last;\n    int t;\n    for (t = 0; !ants.empty(); ++t) {\n        last.clear();\n\n        for (auto& a : ants) a.x += a.dir;\n\n        for (int i = 0; i < ants.size(); ++i) {\n            for (int j = i + 1; j < ants.size(); ++j) {\n                if (ants[i].x == ants[j].x) {\n                    swap(ants[i].id, ants[j].id);\n                }\n            }\n        }\n\n        for (auto it = ants.begin(); it != ants.end();) {\n            if (it->x == 0 || it->x == l) {\n                last.push_back(*it);\n                it = ants.erase(it);\n            } else {\n                ++it;\n            }\n        }\n    }\n\n    sort(last.begin(), last.end(), [](Ant a, Ant b) {\n        return a.x < b.x;\n    });\n\n    cout << t << ' ' << last.front().id << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define N 101\nusing namespace std;\n\nint main(){\n  int n,r,l,p,dat[N][2],ans,t;\n  char d;\n  while(1){\n    cin>>n>>l;\n    if(!n&&!l) break;\n    for(int i=0;i<=l;i++) dat[i][0]=dat[i][1]=0;\n    for(int i=0;i<n;i++){\n      cin>>d>>p;\n      if(d=='L') dat[p][0]=i+1;\n      else dat[p][1]=i+1;\n    }\n    r=n;\n    t=0;\n    while(1){\n      if((r==1&&(dat[0][0]||dat[l][1]))||(r==2&&(dat[0][0]&&dat[l][1]))){\n\tif(dat[0][0]&&dat[l][1]) ans=dat[0][0];\n\telse ans=dat[0][0]+dat[l][1];\n\tbreak;\n      }\n      if(dat[0][0]) r--,dat[0][0]=0;\n      if(dat[l][1]) r--,dat[l][1]=0;\n      for(int i=0;i<l;i++)\n\tif(dat[i+1][0]) dat[i][0]=dat[i+1][0],dat[i+1][0]=0;\n      for(int i=l;i>0;i--)\n\tif(dat[i-1][1]) dat[i][1]=dat[i-1][1],dat[i-1][1]=0;\n      for(int i=0;i<l;i++)\n\tif(dat[i][0]&&dat[i][1]) swap(dat[i][0],dat[i][1]);\n      t++;\n    }\n    cout<<t<<' '<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define R(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\ntemplate<typename T>\nvector<T> make_v(size_t a){return vector<T>(a);}\n\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value!=0>::type\nfill_v(U &u,const V... v){u=U(v...);}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value==0>::type\nfill_v(U &u,const V... v){\n  for(auto &e:u) fill_v<T>(e,v...);\n}\n\nint main(void) {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int64 n, l;\n    while (cin >> n >> l && n + l) {\n        vector<int64> d(n), p(n);\n        REP(i, n) {\n            char c;\n            cin >> c >> p[i];\n            d[i] = c == 'R' ? 1 : -1;\n        }\n        int turn = 0, res = -1;\n        while (1) {\n            int c = 0;\n            vector<int> cnt(l+1, 0);\n            REP(i, n) {\n                if (p[i] == 0 || p[i] >= l) continue;\n                p[i] += d[i];\n                if (p[i] == 0) res = i;\n                if (p[i] == l && res == -1) res = i;\n                cnt[p[i]]++;\n            }\n            FOR(i, 1, l) {\n                if (cnt[i] == 2) {\n                    REP(j, n) {\n                        if (p[j] == i) {\n                            d[j] *= -1;\n                        }\n                    }\n                }\n                if (cnt[i])\n                    c++;\n            }\n            turn++;\n            if (c == 0) break;\n            res = -1;\n        }\n        cout << turn << \" \" << res+1 << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define _overload3(_1, _2, _3, name, ...) name\n#define _rep(i, n) repi(i, 0, n)\n#define repi(i, a, b) for (int i = (a); i < (b); ++i)\n#define rep(...) _overload3(__VA_ARGS__, repi, _rep, )(__VA_ARGS__)\n#define ALL(x) x.begin(), x.end()\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\nrandom_device rnd;\nmt19937 mt(rnd());\nusing ll = long long;\nusing lld = long double;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<ll>;\nusing VVL = vector<VL>;\nusing PII = pair<int, int>;\nconst int IINF = 1 << 30;\nconst ll INF = 1ll << 60;\nconst ll MOD = 1000000007;\n\nvoid solve(int n, int l)\n{\n    vector<char> dir(n);\n    VI pos(n);\n\n    rep(i, n) cin >> dir[i] >> pos[i];\n\n    bool flag = true;\n    int ans = 0;\n    int id = -1;\n\n    while (flag)\n    {\n        flag = false;\n        rep(i, n)\n        {\n            if (pos[i] == 0 || pos[i] >= l)\n            {\n                continue;\n            }\n            if (dir[i] == 'R')\n            {\n                pos[i]++;\n                if (flag == false)\n                {\n                    id = i + 1;\n                }\n                flag = true;\n            }\n            else\n            {\n                id = i + 1;\n                pos[i]--;\n                flag = true;\n            }\n        }\n        rep(i, n) rep(j, i + 1, n)\n        {\n            if (pos[i] == pos[j])\n            {\n                swap(dir[i], dir[j]);\n            }\n        }\n        ans++;\n    }\n    cout << ans - 1 << \" \" << id << endl;\n}\n\nint main()\n{\n    int n, l;\n    while (cin >> n >> l, n)\n    {\n        solve(n, l);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nchar T; int l, a, b, x[1000], d[1000], M, N, y[1000], z[1000];\nint main() {\n\twhile (true) {\n\t\tM = 0;\n\t\tmemset(y, 0, sizeof(y));\n\t\tcin >> b >> l; if (!l) { break; }\n\t\tfor (int i = 1; i <= b; i++) {\n\t\t\tcin >> T >> x[i];\n\t\t\tif (T == 'L') { d[i] = 0; M = max(M, x[i]); }\n\t\t\telse { d[i] = 1; M = max(M, l - x[i]); }\n\t\t}\n\t\tN = 0;\n\t\tfor (int i = 1; i <= M; i++) {\n\t\t\tmemset(z, 0, sizeof(z));\n\t\t\tfor (int j = b; j >= 1; j--) {\n\t\t\t\tif (y[j] == 0) {\n\t\t\t\t\tif (d[j] == 0) {\n\t\t\t\t\t\tx[j]--;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx[j]++;\n\t\t\t\t\t}\n\t\t\t\t\tif (x[j]<0 || x[j]>l) {\n\t\t\t\t\t\ty[j] = 1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tz[x[j]]++;\n\t\t\t\t\t}\n\t\t\t\t\tif (M == i) {\n\t\t\t\t\t\tN = j;\n\t\t\t\t\t\tif (N) {\n\t\t\t\t\t\t\tif (x[j] == 0) { N = j; }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int j = b; j >= 1; j--) {\n\t\t\t\tif (z[x[j]] >= 2) {\n\t\t\t\t\tif (d[j]) { d[j] = 0; }\n\t\t\t\t\telse { d[j] = 1; }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << M << ' ' << N << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(),(c).end()\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\n#define pb(a) push_back(a)\n#define pr(a) cout<<(a)<<endl\n#define PR(a,b) cout<<(a)<<\" \"<<(b)<<endl\n#define R cin>>\n#define F first\n#define S second\n#define ll long long\nbool check(int n,int m,int x,int y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<60,dx[4]={-1,0,1,0},dy[4]={0,1,0,-1};\ntypedef pair<int,int> P;\n\nint main() {\n  int n,m;\n  while(cin >> n >> m && n) {\n    P a[n];\n    rep(i,n) {\n      char c;\n      cin >> c >> a[i].F;\n      if(c=='R') a[i].S=1;\n      else a[i].S=-1;\n    }\n    int ans=0,x;\n    rep(t,m) {\n      int y=-1,c=0;\n      rep(i,n) a[i].F+=a[i].S;\n      rep(i,n) {\n\tREP(j,i+1,n) {\n\t  if(a[i].F==a[j].F && a[i].S!=a[j].S) swap(a[i].S,a[j].S);\n\t}\n\tif(a[i].F>=0 && a[i].F<=m) c++;\n\tif(a[i].F==0) y=i;\n\tif(a[i].F==m && y==-1) y=i;\n      }\n      if(!c) break;\n      ans++;\n      if(y!=-1) x=y+1;\n    }\n    PR(ans,x);\n  }\t\t \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tint n, l;\n\twhile (cin >> n >> l, n) {\n\t\tvector<pii> vpii;\n\t\tvector<pii> cvpii;\n\t\tREP(i, n) {\n\t\t\tchar c;\n\t\t\tint idx;\n\t\t\tcin >> c >> idx;\n\t\t\tif (c == 'L')\n\t\t\t\tvpii.push_back({ 0,idx });\n\t\t\telse\n\t\t\t\tvpii.push_back({ 1,idx });\n\t\t}\n\t\tint cnt = n;\n\t\tint sec = 0;\n\t\tint ans = 0;\n\t\twhile (cnt) {\n\t\t\tcvpii.clear();\n\t\t\tsec++;\n\t\t\tREP(i, n) {\n\t\t\t\tint moved = vpii[i].second;\n\t\t\t\tif (vpii[i].second != 0 || vpii[i].second != l) {\n\n\t\t\t\t\tif (vpii[i].first == 0)\n\t\t\t\t\t\tmoved--;\n\t\t\t\t\telse\n\t\t\t\t\t\tmoved++;\n\t\t\t\t}\n\t\t\t\tcvpii.push_back({ vpii[i].first,moved });\n\t\t\t\tREP(j, cvpii.size() - 1)\n\t\t\t\t\tif (cvpii[j].second == moved) {\n\t\t\t\t\t\tcvpii[j].first = (cvpii[j].first + 1) % 2;\n\t\t\t\t\t\tcvpii[cvpii.size() - 1].first = (cvpii[cvpii.size() - 1].first + 1) % 2;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tbool douji = false;\n\t\t\tif (cnt == 2)\n\t\t\t\tdouji = true;\n\t\t\tREP(j, cvpii.size())\n\t\t\t\tif (vpii[j].second != 0 || vpii[j].second != l)\n\t\t\t\t\tif (cvpii[j].second == 0 || cvpii[j].second == l)\n\t\t\t\t\t\tcnt--;\n\t\t\tif (cnt == 0) {\n\t\t\t\tif (!douji)\n\t\t\t\t\tREP(j, cvpii.size())\n\t\t\t\t\tif (vpii[j].second != 0 || vpii[j].second != l)\n\t\t\t\t\t\tif (cvpii[j].second == 0 || cvpii[j].second == l)\n\t\t\t\t\t\t\tans = (j + 1);\n\t\t\t\tif (douji)\n\t\t\t\t\tREP(j, cvpii.size())\n\t\t\t\t\tif (vpii[j].second != 0 || vpii[j].second != l)\n\t\t\t\t\t\tif (cvpii[j].second == 0)\n\t\t\t\t\t\t\tans = (j + 1);\n\t\t\t}\n\t\t\telse\n\t\t\t\tvpii = cvpii;\n\t\t}\n\t\tcout << sec << ' ' << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <memory>\n#include <cstring>\n#include <cassert>\n#include <numeric>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <cctype>\n#include <unordered_map>\n#include <unordered_set>\nusing namespace std;\n\n#define REP2(i, m, n) for (int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(S) (S).begin(), (S).end()\ntypedef long long ll;\n\nint main(){\n  ios::sync_with_stdio(false);\n\n  int N, L;\n  while (cin >> N >> L && N + L> 0){\n    L *= 2;\n    vector<int> d(N);\n    vector<int> p(N);\n    REP(i, N){\n      char dir;\n      cin >> dir >> p[i];\n      d[i] = dir == 'R' ? 1 : -1;\n      p[i] *= 2;\n    }\n\n    int time = 0;\n    int last = 0;\n\n    while (true){\n      bool update = false;\n      int  goal   = -1;\n      \n      REP(i, N) if (0 < p[i] && p[i] < L){\n        p[i] += d[i];\n        update = true;\n        \n        if ((p[i] == L && goal == -1) || p[i] == 0){\n          goal = i + 1;\n        }\n      }\n      \n      if (!update){\n        break;\n      } else {\n        last = goal;\n        time++;\n\n        REP(i, N) REP(j, i){\n          if (p[i] == p[j] && 0 < p[i] && p[i] < L && p[i] % 2 == 0){\n            assert(d[i] != d[j]);\n            swap(d[i], d[j]);\n          }\n        }\n      }\n    }\n\n    cout << time / 2 << \" \" << last << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <tuple>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define whole(x) begin(x), end(x)\nusing namespace std;\n\nint main() {\n    while (true) {\n        // input\n        int n, l; scanf(\"%d%d\", &n, &l);\n        if (n == 0 and l == 0) break;\n        vector<char> d(n);\n        vector<int> p(n);\n        repeat (i, n) {\n            scanf(\" %c%d\", &d[i], &p[i]);\n        }\n        // solve\n        vector<int> t(n);\n        repeat (i, n) {\n            t[i] = (d[i] == 'L' ? p[i] : l - p[i]);\n        }\n        vector<int> xs(n);\n        iota(whole(xs), 0);\n        sort(whole(xs), [&](int i, int j) {\n            return make_tuple(t[i], d[i] == 'L') < make_tuple(t[j], d[j] == 'L');\n        });\n        bool last_parity = p[xs.back()] % 2;\n        xs.erase(remove_if(whole(xs), [&](int i) {\n            return p[i] % 2 != last_parity;\n        }), xs.end());\n        sort(whole(xs), [&](int i, int j) {\n            return make_tuple(t[i], d[i] == 'L') < make_tuple(t[j], d[j] == 'L');\n        });\n        auto last_i = xs.begin();\n        repeat (i, xs.size() - 1) {\n            if (d[xs[i]] == 'L') {\n                ++ last_i;\n            }\n        }\n        // output\n        int last_t = *max_element(whole(t));\n        printf(\"%d %d\\n\", last_t, *last_i + 1);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <stdint.h>\n\ntypedef uint32_t u32;\ntypedef uint64_t u64;\n\nint n, l;\nchar d[128];\nint  p[128];\nint last_l;\nint last_r;\n\nbool check_finish() {\n  for(int i = 0; i < n; ++i) {\n    if( p[i] != 0 and p[i] != l ) {\n      return false;\n    }\n  }\n  return true;\n}\n\nint main() {\n  \n  for(;;) {\n    std::cin >> n >> l;\n    if( n == 0 and l == 0 ) break;\n    for(int i = 0; i < n; ++i) {\n      std::cin >> d[i] >> p[i];\n    }\n\n    int t = 0;\n    for(;;) {\n      if( check_finish() ) {\n        std::cout << t << \" \" << (last_l != 0 ? last_l : last_r) << std::endl;\n        break;\n      }\n      int count[128] = {};\n      last_l = last_r = 0;\n      for(int i = n - 1; i >= 0; --i) {\n        if( p[i] == 0 or p[i] == l ) continue;\n        if( d[i] == 'L' ) {\n          p[i] -= 1;\n          if( p[i] == 0 ) last_l = i + 1;\n        }\n        if( d[i] == 'R' ) {\n          p[i] += 1;\n          if( p[i] == l ) last_r = i + 1;\n        }\n        count[p[i]] += 1;\n      }\n      for(int i = 0; i < l; ++i) {\n        if( count[i] >= 2 ) {\n          int id1 = 0, id2 = 0;\n          for(int j = 0; j < n; ++j) {\n            if( p[j] == i ) {\n              id1 = j;\n              break;\n            }\n          }\n          for(int j = n - 1; j >= 0; --j) {\n            if( p[j] == i ) {\n              id2 = j;\n              break;\n            }\n          }\n          d[id1] = 'R' + 'L' - d[id1];\n          d[id2] = 'R' + 'L' - d[id2];\n        }\n      }\n      t += 1;\n    }\n  }\n   \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define INF 1001000100010001000\n#define MOD 1000000007\n#define EPS 1e-10\n#define int long long\n#define rep(i, N) for (int i = 0; i < N; i++)\n#define Rep(i, N) for (int i = 1; i < N; i++)\n#define For(i, a, b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define mp make_pair\n#define i_i pair<int, int>\n#define vi vector<int>\n#define vvi vector<vi >\n#define vb vector<bool>\n#define vvb vector<vb >\n#define vp vector< i_i >\n#define all(a) (a).begin(), (a).end()\n#define Int(x) int x; scanf(\"%lld\", &x);\n#define int2(x, y) int x, y; scanf(\"%lld %lld\", &x, &y);\n \n//int dxy[5] = {0, 1, 0, -1, 0};\n// assign\n\n\nint length, n;\nint l[102], r[102];\n\nsigned main()\n{\n    while (cin >> n >> length, (n|length)) {\n        memset(r, 0, sizeof(r));\n        memset(l, 0, sizeof(l));\n        rep(i, n) {\n            char tmpc;\n            int tmp;\n            cin >> tmpc >> tmp;\n            if (tmpc == 'L') {\n                l[tmp] = i+1;\n            } else {\n                r[tmp] = i+1;\n            }\n        }\n            //rep(i, length+1) { cout << l[i] << \" \"; } cout << endl;\n            //rep(i, length+1) { cout << r[i] << \" \"; } cout << endl;\n        int fl = n;\n        int ans_num = 0, ans_time = 0;\n        while (fl) {\n            rep(i, length) {\n                if (l[i]) {\n                    l[i-1] = l[i];\n                    l[i] = 0;\n                }\n            }\n            for (int i = length-1; i >= 0; i--) {\n                if (r[i]) {\n                    r[i+1] = r[i];\n                    r[i] = 0;\n                }\n            }\n            //rep(i, length+1) { cout << l[i] << \" \"; } cout << endl;\n            //rep(i, length+1) { cout << r[i] << \" \"; } cout << endl;\n            rep(i, length+1) {\n                if (r[i] && l[i]) {\n                    int tmp = r[i];\n                    r[i] = l[i];\n                    l[i] = tmp;\n                }\n            }\n            if (r[length]) {\n                fl--;\n                ans_num = r[length];\n                r[length] = 0;\n            }\n            if (l[0]) {\n                fl--;\n                ans_num = l[0];\n                l[0] = 0;\n            } \n            ans_time++;\n        }\n        cout << ans_time << \" \" << ans_num << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint n, l;\nint a[25], d[25];\n\nvoid solve() {\n\tint t = 0, la = -1;\n\t\n\twhile (1) {\n\t\tt++;\n\t\t\n\t\tbool end = true;\n\t\tbool last = false;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tif (a[i] <= 0 || a[i] >= l) continue;\n\t\t\ta[i] += d[i];\n\t\t\t\n\t\t\tif (!last && a[i] <= 0) {\n\t\t\t\tla = i + 1;\n\t\t\t\tlast = true;\n\t\t\t}\n\t\t\tif (!last && a[i] >= l) {\n\t\t\t\tla = i + 1;\n\t\t\t}\n\t\t\t\n\t\t\tif (0 < a[i] && a[i] < l) end = false;\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tif (a[i] <= 0 || a[i] >= l) continue;\n\t\t\tfor (int j = i + 1; j < n; j++) {\n\t\t\t\tif (a[j] <= 0 || a[j] >= l) continue;\n\t\t\t\tif (a[i] == a[j]) {\n\t\t\t\t\tswap(d[i], d[j]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (end) break;\n\t}\n\t\n\tcout << t << \" \" << la << endl;\n}\n\nint main() {\n\twhile (1) {\n\t\tcin >> n >> l; if (n == 0 && l == 0) break;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tchar c; cin >> c;\n\t\t\tif (c == 'R') d[i] = 1;\n\t\t\telse d[i] = -1;\n\t\t\tcin >> a[i];\n\t\t}\n\t\t\n\t\tsolve();\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define REP(i, n) rep(i, 0, n)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define int long long\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\ntypedef pair<int, int> P;\nconst int mod = 1000000007;\nconst int INF = 1e12;\n\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n, l;\n    while(1){\n        cin >> n >> l;\n        if(n == 0 && l == 0) break;\n        vector<int> d(n), a(n);\n        vector<vector<int> > now(l + 1, vector<int>());\n        vector<vector<int> > next(l + 1, vector<int>());\n        int t = 0, idx = 0;\n        rep(i, 0, n){\n            char c;\n            cin >> c >> a[i];\n            now[a[i]].push_back(i);\n            if(c == 'R'){\n                d[i] = 1;\n                chmax(t, l - a[i]);\n            }else{\n                d[i] = 0;\n                chmax(t, a[i]);\n            }\n        }\n        rep(i, 0, t){\n            rep(j, 0, l + 1) next[j].clear();\n            repb(j, l - 1, 1){\n                if(now[j].size() == 2){\n                    swap(d[now[j][0]], d[now[j][1]]);\n                    swap(a[now[j][0]], a[now[j][1]]);\n                }\n                rep(k, 0, now[j].size()){\n                    if(d[now[j][k]] == 1){\n                        next[j + 1].push_back(now[j][k]);\n                        if(j + 1 == l) idx = now[j][k];\n                    }else{\n                        next[j - 1].push_back(now[j][k]);\n                        if(j - 1 == 0) idx = now[j][k];\n                    }\n                }\n            }\n            swap(now, next);\n        }\n        cout << t << ' ' << idx + 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\nstruct ant {\n\tint id;\n\tbool goleft;\n\tint place;\n};\n\nstruct attack {\n\tint id0;\n\tint id1;\n\tint time;\n};\n\nint main() {\n\twhile (1) {\n\t\tint N, L; cin >> N >> L;\n\t\tif (!N)break;\n\t\tpair<int, int>ans(-1, -1);\n\t\tvector<ant>lants;\n\t\tvector<ant>rants;\n\t\tvector<pair<int, int>>ants;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tchar c; int a; cin >> c >> a;\n\t\t\tants.push_back(make_pair(a, i));\n\t\t\tif (c == 'L') {\n\t\t\t\tlants.push_back(ant{ i,true,a });\n\t\t\t\tif (ans.first <= a) {\n\t\t\t\t\tans = make_pair(a, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\trants.push_back(ant{ i,false,a });\n\t\t\t\tif (ans.first < L-a) {\n\t\t\t\t\tans = make_pair(L-a, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(ants.begin(), ants.end());\n\t\tvector<int>perms(N);\n\t\tiota(perms.begin(), perms.end(), 0);\n\t\t/*for (int i = 0; i < ants.size(); ++i) {\n\t\t\tperms[i] = ants[i].second;\n\t\t}*/\n\t\tvector<attack>attacks;\n\t\tvector<vector<int>>times(lants.size(), vector<int>(rants.size(), -1));\n\t\tfor (int l = 0; l < lants.size(); ++l) {\n\t\t\tfor (int r = 0; r < rants.size(); ++r) {\n\t\t\t\tif (lants[l].place > rants[r].place) {\n\t\t\t\t\tif (!((lants[l].place - rants[r].place)%2)) {\n\t\t\t\t\t\tattacks.push_back(attack{ lants[l].id,rants[r].id,(lants[l].place-rants[r].place ) });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(attacks.begin(), attacks.end(), [](const attack&l, const attack&r) {return l.time < r.time; });\n\n\t\tfor (int i = 0; i < attacks.size(); ++i) {\n\t\t\tswap(perms[attacks[i].id0], perms[attacks[i].id1]);\n\t\t}\n\t\tcout <<  ans.first << \" \" << perms[ans.second]+1 << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,L;\nchar d[22];\nint p[22];\n\nvoid solve() {\n    rep(i,N) cin>>d[i]>>p[i];\n    rep(i,N) {\n        if(d[i]=='R') d[i]=1;\n        else d[i]=-1;\n    }\n    int t=0;\n    int ans;\n\n    while(1) {\n        rep(i,N) {\n            p[i]+=d[i];\n        }\n        rep(i,N) rep(j,N) {\n            if(j<=i) continue;\n            if(p[i]==p[j]) {\n                d[i]*=-1;\n                d[j]*=-1;\n            }\n        }\n        rep(i,N) if(p[i]==L) ans=i;\n        rep(i,N) if(p[i]==0) ans=i;\n\n        bool f=true;\n        rep(i,N) f&=(p[i]>L || p[i]<0);\n        if(f) break;\n\n        t++;\n    }\n    cout<<t<<\" \"<<ans+1<<endl;\n}\n\nint main() {\n    while(cin>>N>>L) {\n        if(N+L==0) break;\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nchar T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;\nmain(){\nwhile(1){\nM=0;\nmemset(y,0,999);\ncin>>b>>l;if(!l){break;}\nfor(i=1;i<=b;i++){\ncin>>T>>x[i];\nif(T=='L'){d[i]=0;M=max(M,x[i]);}\nelse{d[i]=1;M=max(M,l-x[i]);}\n}\nN=0;\nfor(i=1;i<M+2;i++){\nmemset(z,0,sizeof(z));\nfor(j=b;j>0;j--) {\nif(!y[j]) {\nif(!d[j]){\nx[j]--;\n}\nelse{\nx[j]++;\n}\nif(x[j]<0||x[j]>l){\ny[j]=1;\n}\nz[x[j]]++;\nif(M>i){\nif(N){\nif(x[j]<0){N=j;}\n}\nelse{\nN=j;\n}\n}\n}\n}\nfor(j=b;j>0;j--){\nif(z[x[j]]>1){\nif(d[j]){d[j]=0;}\nelse{d[j]=1;}\n}\n}\n}\nprintf(\"%d %d\\n\",M,N);\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nint main(){\n\n  while(true){\n    int n, l; cin>> n>> l;\n    if(n==0 and l==0) break;\n    vector<int> rtun(l+1, -1);\n    vector<int> ltun(l+1, -1);\n    rep(i, n){\n      char dir; int pos; cin>> dir>> pos;\n      if(dir=='R') rtun[pos]=i+1;\n      if(dir=='L') ltun[pos]=i+1;\n    }\n\n    int rem=n, t=0;\n    while(true){\n      t++;\n      // 右向きのアリを動かす\n      for(int i=l-1; i>=1; i--){\n        const auto idx=rtun[i];\n        if(idx>=0){\n          if(i+1==l){\n            if((--rem)==0){\n              cout<< t<< \" \"<< idx<< endl;\n              goto heaven;\n            }\n          }else{\n            rtun[i+1]=idx;\n          }\n          rtun[i]=-1;\n        }\n      }\n      // 左向きのアリを動かす\n      for(int i=1; i<l; i++){\n        const auto idx=ltun[i];\n        if(idx>=0){\n          if(i==1){\n            if((--rem)==0){\n              cout<< t<< \" \"<< idx<< endl;\n              goto heaven;\n            }\n          }else{\n            ltun[i-1]=idx;\n          }\n          ltun[i]=-1;\n        }\n      }\n      // 反転\n      rep(i, l){\n        const auto lidx=ltun[i], ridx=rtun[i];\n        if(lidx>=0 and ridx>=0){\n          swap(ltun[i], rtun[i]);\n        }\n      }\n    }\n    heaven:;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint n, l;\n\twhile (cin >> n >> l, n | l) {\n\t\tvector<char> d(n);\n\t\tvector<int> p(n);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tcin >> d[i] >> p[i];\n\t\t}\n\t\tfor (int t = 1; ; t++) {\n\t\t\tbool end = true;\n\t\t\tint L = -1, R = -1;\n\t\t\tvector<int> pos(l), num(l);\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tif (p[i] == -1) continue;\n\t\t\t\tif (d[i] == 'L') {\n\t\t\t\t\tp[i]--;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tp[i]++;\n\t\t\t\t}\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tL = i + 1;\n\t\t\t\t\tp[i] = -1;\n\t\t\t\t}\n\t\t\t\telse if (p[i] == l) {\n\t\t\t\t\tR = i + 1;\n\t\t\t\t\tp[i] = -1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tend = false;\n\t\t\t\t\tif (pos[p[i]]) swap(d[num[p[i]]], d[i]);\n\t\t\t\t\tpos[p[i]]++;\n\t\t\t\t\tnum[p[i]] = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (end) {\n\t\t\t\tcout << t << ' ' << (L != -1 ? L : R) << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n, l; cin >> n >> l && (n|l); ) {\n    vector<int> p(n), v(n), f(n);\n    for(int i = 0; i < n; ++i) {\n      char d;\n      cin >> d >> p[i];\n      v[i] = (d == 'L') ? -1 : 1;\n    }\n    int a, b;\n    for(int t = 1, k = 0; k < n; ++t) {\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        p[i] += v[i];\n      }\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        for(int j = i+1; j < n; ++j) {\n          if(f[j]) continue;\n          if(p[i] == p[j]) {\n            v[i] *= -1; v[j] *= -1;\n          }\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == l) {\n          f[i] = true;\n          ++k;\n          a = t; b = i+1;\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == 0) {\n          f[i] = true;\n          ++k;\n          a = t; b = i+1;\n        }\n      }\n    }\n    cout << a << \" \" << b << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nstruct ant\n{\n    int pos;\n    int dir;\n    int num;\n};\n\nbool cmp(ant a,ant b)\n{\n    return a.pos<b.pos;\n}\n\nint main()\n{\n    int n,l;\n    while (1)\n    {\n        scanf(\"%d%d\",&n,&l);\n        if (!n && !l) break;\n        ant a[25];\n        char str[2];\n        int i,j;\n        for (i=0;i<n;i++)\n        {\n            scanf(\"%s%d\",str,&a[i].pos);\n            a[i].num=i+1;\n            if (str[0]=='R') a[i].dir=0;\n            else a[i].dir=1;\n        }\n        sort(a,a+n,cmp);\n        \n        for (i=n-1;i>=0;i--)\n        {\n            if (a[i].dir==1) continue;\n            for (j=i+1;j<n;j++)\n            {\n                if (a[j].dir==0) continue;\n                int mod=(a[i].pos+a[j].pos)%2;\n                if (!mod)\n                {\n                    int temp=a[i].num;\n                    a[i].num=a[j].num;\n                    a[j].num=temp;\n                }\n            }\n        }\n        int rightmax=0;\n        int leftmax=0;\n        int rightrec=0,leftrec=0;\n        for (i=0;i<n;i++)\n            if (a[i].dir==0)\n            {\n                rightmax=l-a[i].pos;\n                rightrec=a[i].num;\n                break;\n            }\n        for (i=n-1;i>=0;i--)\n            if (a[i].dir==1)\n            {\n                leftmax=a[i].pos;\n                leftrec=a[i].num;\n                break;\n            }\n        if (rightmax>leftmax)\n            printf(\"%d %d\\n\",rightmax,rightrec);\n        else if (leftmax>rightmax)\n            printf(\"%d %d\\n\",leftmax,leftrec);\n        else\n            printf(\"%d %d\\n\",leftmax,leftrec);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\nusing namespace std;\nusing LL = long long;\n\nusing P = pair<pair<int, bool>, int>;\n\npair<pair<int, int>, int>f(vector<P>vec, int l)\n{\n\tvector<P>las = vec;\n\tif (vec.size() == 0)\n\t{\n\t\treturn make_pair(make_pair(-1, -1), -1);\n\t}\n\tfor (P& p : vec)\n\t{\n\t\tif (!p.first.second)\n\t\t{\n\t\t\tp.first.first = l - p.first.first;\n\t\t}\n\t}\n\tsort(vec.begin(), vec.end());\n\tint lef = 0, rht = vec.size() - 1;\n\tfor (int i = 0; i < (int)vec.size() - 1; ++i)\n\t{\n\t\tif (vec[i].first.second)\n\t\t{\n\t\t\tlef++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trht--;\n\t\t}\n\t}\n\tint ans1 = vec[vec.size() - 1].first.first;\n\tint ans2 = las[lef].second;\n\tbool dir = vec[vec.size() - 1].first.second;\n\treturn make_pair(make_pair(ans1, dir), ans2);\n}\n\nint main(void)\n{\n\tfor (;;)\n\t{\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (!n)break;\n\t\tvector<P>odd, evn;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tchar c; int v;\n\t\t\tcin >> c >> v;\n\t\t\tif (v % 2)\n\t\t\t{\n\t\t\t\todd.push_back({ { v,c == 'L' } ,i + 1 });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tevn.push_back({ { v,c == 'L' },i + 1 });\n\t\t\t}\n\t\t}\n\t\tauto p1 = f(odd, l);\n\t\tauto p2 = f(evn, l);\n\t\tif (p1.first > p2.first)\n\t\t{\n\t\t\tcout << p1.first.first << \" \" << p1.second << endl;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcout << p2.first.first << \" \" << p2.second << endl;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nusing Ant = tuple<int, int, int>;\n\nint forward(int n, int l, const vector<Ant>& ants, vector<int>& meet) {\n    int dt = l;\n    rep(i, n) {\n        int p, d, k1; tie(p, d, k1) = ants[i];\n        if (meet[i] != -1) continue;\n        if (d == 1) {\n            int j = i + 1;\n            for (; j < n; ++j) {\n                int q, b, k2; tie(q, b, k2) = ants[j];\n                if (b == 1 || (q - p) & 1) continue;\n                meet[i] = j; meet[j] = i;\n                chmin(dt, (q - p) / 2);\n                break;\n            }\n            if (j == n) chmin(dt, l - p);\n        }\n        else {\n            int j = i - 1;\n            for (; j >= 0; --j) {\n                int q, b, k2; tie(q, b, k2) = ants[j];\n                if (b == -1 || (p - q) & 1) continue;\n                meet[i] = j; meet[j] = i;\n                chmin(dt, (p - q) / 2);\n                break;\n            }\n            if (j == -1) chmin(dt, p);\n        }\n    }\n    return dt;\n}\n\nstring solve(int n, int l, vector<Ant>& ants) {\n    int t = 0, last = -1;\n    for (; n; n = int(ants.size())) {\n        vector<int> meet(n, -1);\n        int dt = forward(n, l, ants, meet);\n        bool leave_left = false;\n        vector<Ant> nxt;\n        rep(i, n) {\n            int p, d, k1; tie(p, d, k1) = ants[i];\n            int np = p + dt * d;\n            if (d == 1) {\n                if (np == l) { if (!leave_left) last = k1; }\n                else if (meet[i] == -1) nxt.emplace_back(np, d, k1);\n                else {\n                    int q, b, k2; tie(q, b, k2) = ants[meet[i]];\n                    nxt.emplace_back(np, q - p > dt * 2 ? d : -d, k1);\n                }\n            }\n            else {\n                if (np == 0) last = k1, leave_left = true;\n                else if (meet[i] == -1) nxt.emplace_back(np, d, k1);\n                else {\n                    int q, b, k2; tie(q, b, k2) = ants[meet[i]];\n                    nxt.emplace_back(np, p - q > dt * 2 ? d : -d, k1);\n                }\n            }\n        }\n        ants.swap(nxt);\n        t += dt;\n    }\n    stringstream ss;\n    ss << t << ' ' << last;\n    return ss.str();\n}\n\nint main() {\n    for (int n, l; cin >> n >> l, n | l;) {\n        vector<Ant> ants;\n        rep(i, n) {\n            char d; int p;\n            cin >> d >> p;\n            ants.emplace_back(p, d == 'L' ? -1 : 1, i + 1);\n        }\n        cout << solve(n, l, ants) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n#define int long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,a,b) for(int i=a;i<b;i++)\n#define REP(i,a,b) for(int i=a;i<=b;i++)\n#define rev(i,n) for(int i=n-1;i>=0;i--)\n#define vi vector<int>\n#define vvi vector<vi>\n#define pb push_back\n#define pi pair<int,int>\n#define vp vector<pair<int,int>>\n#define mp make_pair\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define MEMSET(a) memset(a,0,sizeof(a))\n#define inf (1ll<<60)\n#define Yes(f) cout<<(f?\"Yes\":\"No\")<<endl\n#define yes(f) cout<<(f?\"yes\":\"no\")<<endl\n#define YES(f) cout<<(f?\"YES\":\"NO\")<<endl\n#define SORT(v) sort(all(v))\n#define RSORT(v) sort(all(v), greater<int>())\n#define VI(a,n) vi a(n); rep(i,n)cin>>a[i];\n#define sq(n) (n)*(n)\n\nusing namespace std;\n\nconst int mod=1e9+7;\n\nvoid run();\n\nvoid init() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout<<fixed<<setprecision(0);\n}\n\nsigned main(){\n    init();\n    run();\n    return 0;\n}\n\nvoid run(){\n    int n,l;\n    while(cin>>n>>l,n){\n        string d;\n        vi left(l+1),right(l+1);\n        int p;\n        rep(i,n){\n            cin>>d>>p;\n            if(d==\"L\")left[p]=i+1;\n            else right[p]=i+1;\n        }\n        int anst=0,ansn=0;\n        while(n){\n            rep(i,l){\n                if(left[i]){\n                    left[i-1]=left[i];\n                    left[i]=0;\n                }\n            }\n            for(int i=l-1;i>0;i--){\n                if(right[i]){\n                    right[i+1]=right[i];\n                    right[i]=0;\n                }\n            }\n            Rep(i,1,l){\n                if(left[i]&&right[i])swap(left[i],right[i]);\n            }\n            if(right[l]){\n                n--;\n                ansn=right[l];\n                right[l]=0;\n            }\n            if(left[0]){\n                n--;\n                ansn=left[0];\n                left[0]=0;\n            }\n            anst++;\n        }\n        cout<<anst<<\" \"<<ansn<<endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main () \n{\n    int num_ant, length;\n    \n    while (1)\n    {\n        std::cin >> num_ant >> length;\n        \n        if (num_ant == 0 && length == 0) break;\n        \n        char temp;\n        int position[num_ant];\n        int direction[num_ant];\n        \n        // input\n        for (int i = 0; i < num_ant; i++)\n        {\n            std::cin >> temp >> position[i];\n            if (temp == 'R') direction[i] =  1;\n            else             direction[i] = -1;\n        }\n        \n        // simulation\n        int t = 0;\n        int tag;\n        bool flag = false;\n        while (!flag)\n        {\n            t++;\n            int conflict[110] = {0};\n            int point[110] = {0};\n            flag = true;\n            \n            for (int i = 0; i < num_ant; i++)\n            {\n                // renew position\n                position[i] += direction[i];\n                \n                // ditecting conflict\n                if (conflict[position[i]] != 0) \n                {\n                    direction[i] *= -1;\n                    direction[point[position[i]]] *= -1;\n                }\n                else if (0 < position[i] && position[i] < length)\n                {\n                    conflict[position[i]]++;\n                    point[conflict[position[i]]] = i;\n                }\n            }\n            \n            // confirming\n            for (int j = 0; j < num_ant; j++) \n            {\n                if (0 < position[j] && position[j] < length) flag = false;\n            }\n            \n            if (flag)\n            {\n                for (int k = 0; k < num_ant; k++) \n                {\n                    if (position[k] == 0 || position[k] == length)\n                    {\n                        tag = k;\n                        break;\n                    }\n                }\n            }\n            \n        }\n        \n        std::cout << t << \" \" << tag + 1 << std::endl;\n        \n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define fs first\n#define sc second\nusing namespace std;\ntypedef pair<char,int> P;\nconst int INF = 1e8;\n\nint n,l, id[30], sum;\nP ant[30];\n\nint main(){\n  while(cin >> n >> l, n){\n    l <<= 1;\n    rep(i,n){\n      cin >> ant[i].fs >> ant[i].sc; ant[i].sc <<= 1;\n      id[i] = i;\n    }\n\n    sum = 0;\n    while(true){\n      int pos = -1, t = INF;\n      rep(i,n-1){\n\tif(ant[id[i]].fs == 'R' && ant[id[i+1]].fs == 'L'){\n\t  int d = ant[id[i+1]].sc - ant[id[i]].sc; d>>=1;\n\t  if(pos < 0 || t > d){\n\t    pos = i; t = d;\n\t  }\n\t}\n      }\n\n      if(pos<0){\n\tint len = 0, res = 0;\n\trep(i,n){\n\t  if(ant[id[i]].fs == 'L'){\n\t    if(len < ant[id[i]].sc){\n\t      len = ant[id[i]].sc; res = id[i];\n\t    }\n\t  }else{\n\t    if(len < l - ant[id[i]].sc){\n\t      len = l - ant[id[i]].sc; res = id[i];\n\t    }\n\t  }\n\t}\n\tcout << (sum + len)/2 << \" \" << res+1 << endl;\n\tbreak;\n      }\n\n      rep(i,n){\n\tif(ant[id[i]].fs == 'L')ant[id[i]].sc -= t;\n\telse ant[id[i]].sc += t;\n      }\n      if(ant[id[pos]].sc&1)swap(id[pos],id[pos+1]);\n      else swap(ant[id[pos]].fs,ant[id[pos+1]].fs);\n      sum += t;\n    }\n  }\n}\n\t       "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define each(a, b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout <<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout <<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout <<\" \"<<kbrni;cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int>P;\n\nconst int MAX_N = 100005;\n\nint main()\n{\n    while(1){\n        int n,l;\n        cin >> n >> l;\n        if(n == 0 && l == 0){\n            break;\n        }\n        vector<P> vec(n);\n        rep(i,n){\n            char c;\n            cin >> c;\n            int p;\n            cin >> p;\n            if(c == 'R'){\n                vec[i] = P(p,0);\n            }else{\n                vec[i] = P(p,1);\n            }\n        }\n        int cnt = 0;\n        int tm = 0;\n        int la;\n        int flag[21];\n        rep(i,21){\n            flag[i] = i;\n        }\n        while(1){\n            tm++;\n            vector<P> fall;\n            rep(i,n){\n                if(vec[i].fi == 0 || vec[i].fi == l){\n                    continue;\n                }\n                if(i <= n-2 && vec[i].fi == vec[i+1].fi){\n                    vec[i].fi--;\n                    vec[i].se = 1;\n                    vec[i+1].fi++;\n                    vec[i+1].se = 0;\n                    if(vec[i].fi == 0 || vec[i+1].fi == l){\n                        cnt++;\n                    }\n                    i++;\n                }else if(i <= n-2 && vec[i+1].fi-vec[i].fi == 1 && vec[i].se == 0 && vec[i+1].se == 1){\n                    vec[i].se = 1;\n                    vec[i+1].se = 0;\n                    swap(flag[i],flag[i+1]);\n                    i++;\n                }else{\n                    if(vec[i].se){\n                        vec[i].fi--;\n                    }else{\n                        vec[i].fi++;\n                    }\n                    if(vec[i].fi == 0){\n                        cnt++;\n                        fall.pb(P(0,flag[i]+1));\n                    }else if(vec[i].fi == l){\n                        cnt++;\n                        fall.pb(P(1,flag[i]+1));\n                    }\n                }\n            }\n            if(cnt == n){\n                sort(all(fall));\n                cout << tm << \" \" << fall[0].se << endl;\n                break;\n            }\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define range(i, a, n) for(int (i) = (a); (i) < (n); (i)++)\n#define rep(i, n) for(int (i) = 0; (i) < (n); (i)++)\nusing namespace std;\nstruct Ant {\n    int pos, idx;\n    char dir;\n};\n\nint main(void){\n    for(int n, l; cin >> n >> l, n;){\n        vector<Ant> ant(n);\n        for(auto & e : ant) cin >> e.dir >> e.pos;\n        rep(i, n) ant[i].idx = i + 1;\n\n        int rest = 0, resi;\n        set<int> s;\n        rep(i, n) s.insert(i + 1);\n        while(s.size() != 0){\n            rep(i, n){\n                rep(j, n){\n                    if(ant[j].pos - ant[i].pos == 2 and\n                            ant[i].dir == 'R' and\n                            ant[j].dir == 'L'){\n                        swap(ant[i].idx, ant[j].idx);\n                    }\n                }\n            }\n\n            bool left = false;\n            rep(i, n){\n                int dx = ant[i].dir == 'R' ? 1:-1;\n                ant[i].pos += dx;\n                if(ant[i].pos == 0 or ant[i].pos == l){\n                    if(not left or ant[i].pos == 0){\n                        resi = ant[i].idx;\n                        left = true;\n                    }\n                    s.erase(ant[i].idx);\n                }\n            }\n\n            rest++;\n        }\n\n        cout << rest << \" \" << resi << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\t\n\tfor(int n,l;cin>>n>>l,n;){\n\t\tint p[20],r[20];\n\t\tfor(int i=0;i<n;i++){\n\t\t\tchar c;\n\t\t\tcin>>c>>p[i];\n\t\t\tr[i]=(c=='R'?1:-1);\n\t\t}\n\t\tfor(int ans=0;;ans++){\n\t\t\tint f=1,li=9999,ri=9999;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(0<p[i]&&p[i]<l)f=0;\n\t\t\t\telse if(p[i]==0)li=i;\n\t\t\t\telse if(p[i]==l)ri=i;\n\t\t\t}\n\t\t\tif(f){\n\t\t\t\tcout<<ans<<\" \"<<(li!=9999?li:ri)+1<<endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tint flg[100]={};\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tp[i]+=r[i];\n\t\t\t\tif(0<p[i] && p[i]<l)flg[p[i]]++;\n\t\t\t}\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(0<p[i] && p[i]<l){\n\t\t\t\t\tif(flg[p[i]]>1)r[i]*=(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n/*\n??????????????????????????£??????????????????????????????????????????????????£????????????????????????????????????????????????????????????\n??????????????????????????????????????????????????\\????????????????????????????§???????????????¨??????????????????1cm/s???????????§?§?????????????\n???????????????????????£?????¨????????????????????????????????????????????¨?????????????????????????????????????????????????????????????´°?????????????????????\n?????????????????????????????¨?????§???????????????????????????????´°???????????§????????£?????¨?????????????????????????????????????????????????§??????????\n???????????????????????????????????????????????£?????°???????????¨?????????????????????????????????????????????\n\n???????????????????????´??°????????????(cm)??§????????????????????????????´°?????????????????????????????£????????´??°???????????¢????????????\n?????????????´°?????????????????§???????????????????????????????????????????????????????????????????????????????????????????´°???????????§???????§?????????????\n??°???????????????????????\\??£????????????????????????????????¨??????????????????????????????????????????????????¨???????????????????????????????????????????????¨?????§?????????\n????????????????????????????????????????????????????????????????????????????????¨????????????????????°????????????????????¨??????\n\n???B.1???6cm????????????????????§???????????????2s?????§???????????????????????????????????????????????§?????????\n????????????1?????????????????¨?????????????????????3?????????????´°??????????????????????§??????????????????????cm???2cm???5cm???????????????????????????????????????\n0.5s??????????????¨???????????????????????§??§???????????????????????????????????????????????????????????????2s??????????????¨??????????´°???????????§??§??????????????????\n???????????????\n\n\nInput\nn l\nd1 p1\nd2 p2\n...\ndn pn\n\n1?????????????????°n(1<=n<=20)???????????????????????????l(n+1<=l<=100)\n?¶????n???????????????i?????????d(1<=i<=n)????????????????????????p(1<=i<=n)\n\n????????????p????????????????????????????????´??°???????????????????????????\n??????????????????????????????????????????????????§?????\\?????¨?????????\n\n??????????????????????????????n = 0 && l == 0\n\n\nOutput\n??????????????????????????????????????¨??????????????????????????????????????§??????????????????????????????????????£?????????\n??????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????????????????????????????????????´???????????´??????????????????????????????????????????????????????\n\n*/\nint main() {\n\tint N, L;\n\twhile (cin >> N >> L, N || L) {\n\t\tvector<int> V[2];\n\t\tV[0].resize(L + 2);\n\t\tV[1].resize(L + 2);\n\n\t\tfor (int i = 1; i <= N; i++) {\n\t\t\tchar d; int p;\n\t\t\tcin >> d >> p;\n\t\t\tif (d == 'R') {\n\t\t\t\tV[1][p] = i;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tV[0][p] = i;\n\t\t\t}\n\t\t}\n\t\tbool flag = true;\n\t\tint ans = -1;\n\t\tint t = -1;\n\t\tfor (int k = 0; k <= L; k++) {\n\t\t\tfor (int i = 1; i <= L + 1; i++)\n\t\t\t\tV[0][i - 1] = V[0][i];\n\t\t\tfor (int i = L + 1; i > 0; i--)\n\t\t\t\tV[1][i] = V[1][i - 1];\n\t\t\tfor (int i = 1; i <= L; i++) {\n\t\t\t\tif (V[0][i] > 0 && V[1][i] > 0) {\n\t\t\t\t\tint tmp = V[0][i];\n\t\t\t\t\tV[0][i] = V[1][i];\n\t\t\t\t\tV[1][i] = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (V[0][1] > 0) t = k + 2, ans = V[0][1];\n\t\t\telse if (V[1][L - 1] > 0) t = k + 2, ans = V[1][L - 1];\n\t\t}\n\t\tcout << t << \" \" << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <iterator>\n#include <cmath>\n\nusing namespace std;\n\nint main(){\n\t\n\tint n, l;\n\t\n\twhile(true){\n\t\tcin >> n >> l;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tstring d[30];\n\t\tint p[30] = {};\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tcin >> d[i] >> p[i];\n\t\t}\n\t\tint ans = 0;\n\t\tint num;\n\t\tfor(int i = n - 1; i >= 0; i--){\n\t\t\tif(d[i][0] == 'L'){\n\t\t\t\tans = p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j >= 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'L'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tif(d[i][0] == 'R'){\n\t\t\t\tif(ans >= l - p[i]){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tans = l - p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'R'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = n - 1; j >= 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \" << num << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define whole(x) begin(x), end(x)\nusing namespace std;\n\nint main() {\n    while (true) {\n        // input\n        int n, l; scanf(\"%d%d\", &n, &l);\n        if (n == 0 and l == 0) break;\n        vector<char> d(n);\n        vector<int> p(n);\n        repeat (i, n) {\n            scanf(\" %c%d\", &d[i], &p[i]);\n        }\n        // solve\n        vector<int> t(n);\n        repeat (i, n) {\n            t[i] = (d[i] == 'L' ? p[i] : l - p[i]);\n        }\n        auto cmp = [&](int i, int j) {\n            return make_pair(t[i], d[i] == 'L') < make_pair(t[j], d[j] == 'L');\n        };\n        vector<int> xs(n);\n        iota(whole(xs), 0);\n        bool last_parity = p[*max_element(whole(xs), cmp)] % 2;\n        xs.erase(remove_if(whole(xs), [&](int i) {\n            return p[i] % 2 != last_parity;\n        }), xs.end());\n        sort(whole(xs), cmp);\n        int last_j = 0;\n        repeat (i, xs.size() - 1) {\n            if (d[xs[i]] == 'L') {\n                ++ last_j;\n            }\n        }\n        sort(whole(xs));\n        last_j = xs[last_j];\n        // output\n        int last_t = *max_element(whole(t));\n        printf(\"%d %d\\n\", last_t, last_j + 1);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main(){\n  while(true){\n    int n, l;\n    cin >> n >> l;\n    if(n == 0) break;\n\n    vector<char> dirs(n);\n    vector<int> pos(n);\n    for(int i=0;i<n;i++){\n      cin >> dirs[i] >> pos[i];\n    }\n    int cnt = 0;\n    for(int t=1;t<=l+2;t++){\n      vector<pair<int, int>> deads;\n      for(int i=n-1;i>=0;i--){\n        pos[i] += dirs[i] == 'L' ? -1 : 1;\n        if(pos[i] == 0 || pos[i] == l){\n          cnt++;\n          deads.emplace_back(pos[i], i);\n        }\n      }\n      for(int i=0;i<n;i++){\n        for(int j=i+1;j<n;j++){\n          if(pos[i] == pos[j]){\n            swap(dirs[i], dirs[j]);\n          }\n        }\n      }\n      if(cnt == n){\n        assert(deads.size() <= 2);\n        if(deads.size() == 1){\n          cout << t << \" \" << deads[0].second + 1 << endl;\n        }else{\n          cout << t << \" \" << min(deads[0], deads[1]).second + 1 << endl;\n        }\n        break;\n      }\n    }\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint A[2][101],p,i,n,l;\nchar d;\n\nmain(){\n\twhile(cin>>n>>l,n||l){\n\t\tmemset(A,0,sizeof(A));\n\t\trep(j,n){\n\t\t\tcin>>d>>p;\n\t\t\tA[d=='L'][p]=j+1;\n\t\t}\n\t\ti=0;\n\t\twhile(++i){\n\t\t\tbool end=1;\n\t\t\tfor(int j=l;j>=1;j--){ A[0][j]=A[0][j-1];A[0][j-1]=0;}\n\t\t\trep(j,l){ A[1][j]=A[1][j+1];A[1][j+1]=0;}\n\t\t\trep(j,l+1) if(A[0][j]&&A[1][j])swap(A[0][j],A[1][j]);\n\t\t\tfor(int j=l-1;j>=1;j--)if(A[0][j]||A[1][j])end=0,p=A[0][j]?A[0][j]:A[1][j];\n\t\t\tif(end)break;\n\t\t}\n\t\tprintf(\"%d %d\\n\",i,p);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <algorithm>\nusing namespace std;\nusing P = pair<int, int>;\n\nint main() {\n    int n, l;\n    while(cin >> n >> l, n) {\n        vector<P> v(n);\n        for(int i=0; i<n; ++i) {\n            char c; int pos;\n            cin >> c >> pos;\n            v[i].second = c == 'R' ? 1 : -1;\n            v[i].first = pos;\n        }\n        int id = -1, length = 0;\n        while(true) {\n            int ret_id = -1;\n            for(int i=0; i<n; ++i) {\n                if(v[i].first == -1) {\n                    continue;\n                }\n                v[i].first += v[i].second;\n            }\n            for(int i=0; i<n; ++i) {\n                if(v[i].first == 0 || v[i].first == l) {\n                    if(v[i].first == 0 || ret_id == -1 && v[i].first == l) {\n                        ret_id = i+1;\n                    }\n                    v[i].first = -1;\n                    continue;\n                }\n                for(int j=i+1; j<n; ++j) {\n                    if(v[i].first == v[j].first) {\n                        v[i].second = -v[i].second;\n                        v[j].second = -v[j].second;\n                    }\n                }\n            }\n            id = ret_id;\n            length++;\n            if(all_of(v.begin(), v.end(), [](auto const& p) { return p.first == -1; })) {\n                break;\n            }\n        }\n        cout << length << \" \" << id<< endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "// implement 7min\n#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <queue>\n#include <string>\n#include <map>\n#include <set>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nint n, l;\npair<int, int> ants[100];\n\n\nint main() {\n  while (scanf(\"%d %d\", &n, &l) > 0 && n) {\n    REP(i, n) {\n      char c;\n      int p;\n      scanf(\" %c %d\", &c, &p);\n      int dir = c == 'L' ? -1 : 1;\n      ants[i] = make_pair(dir, p);\n    }\n    int ans_sec = 0;\n    int ans_ant = -1;\n    int rest = n;\n    while (rest > 0) {\n      ans_sec++;\n      map<int, int> hist;\n      REP(i, n) {\n        ants[i].second += ants[i].first;\n        hist[ants[i].second]++;\n      }\n      REP(i, n) {\n        if (hist[ants[i].second] >= 2) {\n          ants[i].first *= -1;\n        }\n        if (ants[i].second == 0 || ants[i].second == l) {\n          rest--;\n          if (ans_ant == -1 || ants[ans_ant].second != 0) {\n            ans_ant = i;\n          }\n        }\n      }\n    }\n    printf(\"%d %d\\n\", ans_sec, ans_ant + 1);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nchar T; int l, a, b, x[1000], d[1000], M, N, y[1000], z[1000];\nint main() {\n\twhile (true) {\n\t\tM = 0;\n\t\tmemset(y, 0, sizeof(y));\n\t\tcin >> b >> l; if (!l) { break; }\n\t\tfor (int i = 1; i <= b; i++) {\n\t\t\tcin >> T >> x[i];\n\t\t\tif (T == 'L') { d[i] = 0; M = max(M, x[i]); }\n\t\t\telse { d[i] = 1; M = max(M, l - x[i]); }\n\t\t}\n\t\tN = 0;\n\t\tfor (int i = 1; i <= M + 1; i++) {\n\t\t\tmemset(z, 0, sizeof(z));\n\t\t\tfor (int j = b; j >= 1; j--) {\n\t\t\t\tif (y[j] == 0) {\n\t\t\t\t\tif (d[j] == 0) {\n\t\t\t\t\t\tx[j]--;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx[j]++;\n\t\t\t\t\t}\n\t\t\t\t\tif (x[j]<0 || x[j]>l) {\n\t\t\t\t\t\ty[j] = 1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tz[x[j]]++;\n\t\t\t\t\t}\n\t\t\t\t\tif (M+1 == i) {\n\t\t\t\t\t\tif (N) {\n\t\t\t\t\t\t\tif (x[j] < 0) { N = j; }\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tN = j;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int j = b; j >= 1; j--) {\n\t\t\t\tif (z[x[j]] >= 2) {\n\t\t\t\t\tif (d[j]) { d[j] = 0; }\n\t\t\t\t\telse { d[j] = 1; }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << M << ' ' << N << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\n\nint main(void) {\n    int i,j;\n    int n, l;\n    while(cin >> n >> l,n){\n        int v[105][2][2] = {};//ind,d(L:1,R:0)\n        rep(i,n){\n            string d;\n            int p;\n            cin >> d >> p;\n            v[p][0][0] = i+1;\n            v[p][0][1] = (d==\"L\");\n        }\n        rep(t,l+1){\n            int u[105][2][2] = {};\n            int left = v[1][0][0]?v[1][0][0]:v[l-1][0][0];//左から出る蟻のindex\n            rep(i,l)rep(j,2)if(v[i][j][0]){\n                if(v[i][j][1]){//左に移動\n                    if(i==1)continue;\n                    if(u[i-1][0][0] == 0){\n                        u[i-1][0][0] = v[i][j][0];\n                        u[i-1][0][1] = v[i][j][1];\n                    }else{\n                        u[i-1][1][0] = v[i][j][0];\n                        u[i-1][1][1] = v[i][j][1];\n                    }\n                }else{//右に移動\n                    if(i == l-1)continue;\n                    if(u[i+1][0][0] == 0){\n                        u[i+1][0][0] = v[i][j][0];\n                        u[i+1][0][1] = v[i][j][1];\n                    }else{\n                        u[i+1][1][0] = v[i][j][0];\n                        u[i+1][1][1] = v[i][j][1];\n                    }\n                }\n            }\n            rep(i,l)if(u[i][0][0] && u[i][1][0]){\n                swap(u[i][0][1],u[i][1][1]);\n            }\n            int cnt = 0;\n            rep(i,l+1)rep(j,2){\n                if(u[i][j][0]) cnt++;\n                rep(k,2){\n                    v[i][j][k] = u[i][j][k];\n                }\n            }\n            if(cnt == 0){\n                cout << t+1 << \" \" << left << endl;\n                break;\n            }\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\nusing namespace std;\nusing LL = long long;\n\nusing P = pair<pair<int, bool>, int>;\n\npair<int, int>f(vector<P>vec, int l)\n{\n\tif (vec.size() == 0)\n\t{\n\t\treturn make_pair(-1, -1);\n\t}\n\tfor (P& p : vec)\n\t{\n\t\tif (!p.first.second)\n\t\t{\n\t\t\tp.first.first = l - p.first.first;\n\t\t}\n\t}\n\tsort(vec.begin(), vec.end());\n\tint lef = 0, rht = vec.size() - 1;\n\tfor (int i = 0; i < (int)vec.size() - 1; ++i)\n\t{\n\t\tif (vec[i].first.second)\n\t\t{\n\t\t\tlef++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trht--;\n\t\t}\n\t}\n\treturn make_pair(vec[vec.size() - 1].first.first, vec[lef].second);\n}\n\nint main(void)\n{\n\tfor (;;)\n\t{\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (!n)break;\n\t\tvector<P>odd, evn;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tchar c; int v;\n\t\t\tcin >> c >> v;\n\t\t\tif (v % 2)\n\t\t\t{\n\t\t\t\todd.push_back({ { v,c == 'L' } ,i + 1 });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tevn.push_back({ { v,c == 'L' },i + 1 });\n\t\t\t}\n\t\t}\n\t\tauto p1 = f(odd, l);\n\t\tauto p2 = f(evn, l);\n\t\tif (p1.first > p2.first)\n\t\t{\n\t\t\tcout << p1.first << \" \" << p1.second << endl;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcout << p2.first << \" \" << p2.second << endl;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <map>\nusing namespace std;\n\nint main(){\n  int n, l;\n  while(cin >> n >> l, n){\n    vector< pair<int,char> > V;\n    vector<int> Odd, Even;\n    int t = 0, p;\n    char d;\n    for(int i = 0; i < n; ++i){\n      cin >> d >> p;\n      if(d == 'R') t = max(t,l-p);\n      else t = max(t,p);\n      V.emplace_back(p,d);\n      if(p%2) Odd.push_back(i+1);\n      else Even.push_back(i+1);\n    }\n    cout << t << \" \";\n    int c = 0, id = 0;\n    for(int i = 0; i < n; ++i){\n      if(V[i].second == 'R') V[i].first += t-1;\n      else V[i].first -= t-1;\n    }\n    sort(V.begin(),V.end());\n    int odd = 0, even = 0;\n    for(int i = 0; i < n; ++i){\n      if(V[i].first > 0){\n        if(((V[i].first-t+1)%2+2)%2) cout << Odd[odd] << endl;\n        else cout << Even[even] << endl;\n        break;\n      }else{\n        if(((V[i].first-t+1)%2+2)%2) ++odd;\n        else ++even;\n      }\n      /*\n      cout << V[i].first << \" \" ;\n      */\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\ntypedef pair<int, int> P;\ntypedef pair<int, P> PP;\ntypedef vector<PP> V;\n\nclass Ant {\n    public:\n        char d;\n        int p;\n};\n\nP compute(int n, int l, Ant ants[]) {\n    int index[20];\n    P residual_time[20];\n    V exchanges;\n    for (int i=0; i<n; i++) {\n        index[i] = i;\n        if (ants[i].d == 'R') {\n            residual_time[i] = P(l-ants[i].p, i);\n        }\n        else {\n            residual_time[i] = P(ants[i].p, i);\n        }\n    }\n    sort(residual_time, residual_time+n);\n    for (int i=0; i<n; i++) {\n        for (int j=i+1; j<n; j++) {\n            int delta = ants[j].p-ants[i].p;\n            if (ants[i].d != 'R' || ants[j].d != 'L') {\n                continue;\n            }\n            if (delta%2 == 1) {\n                continue;\n            }\n            exchanges.push_back(PP(delta, P(i, j)));\n        }\n    }\n    sort(exchanges.begin(), exchanges.end());\n    for (int k=0; k<(int)exchanges.size(); k++) {\n        int i = exchanges[k].second.first;\n        int j = exchanges[k].second.second;\n        int tmp = index[i];\n        index[i] = index[j];\n        index[j] = tmp;\n    }\n    if (n > 1 && residual_time[n-1].first == residual_time[n-2].first) {\n        if (ants[residual_time[n-1].second].d == 'R') {\n            return P(residual_time[n-2].first, index[residual_time[n-2].second]);\n        }\n    }\n    return P(residual_time[n-1].first, index[residual_time[n-1].second]);\n}\n\nint main() {\n    int n, l;\n    Ant ants[20];\n    P answer;\n    while (true) {\n        cin >> n >> l;\n        if (n == 0) {\n            return 0;\n        }\n        for (int i=0; i<n; i++) {\n            cin >> ants[i].d >> ants[i].p;\n        }\n        answer = compute(n, l, ants);\n        cout << answer.first << ' ' << answer.second+1 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n//constexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1000000007;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\nconst long double PI = acos((long double)(-1));\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef long double ld;\n\nvoid solve() {\n    int n, l; cin >> n >> l; if (n == 0) exit(0);\n    vector<int> d(n), p(n);\n    for (int i = 0; i < n; i++) {\n        char c; cin >> c >> p[i];\n        if (c == 'R') d[i] = 1;\n        else d[i] = -1;\n    }\n    int lv = 0;\n    int lp = p[0];\n    for (int t = 1;; t++) {\n        for (int i = 0; i < n; i++) {\n            p[i] += d[i];\n        }\n        for (int i = 0; i < n; i++) {\n            for (int j = i + 1; j < n; j++) {\n                if (p[i] == p[j]) {\n                    d[i] *= -1;\n                    d[j] *= -1;\n                }\n            }\n        }\n\n        bool ok = true;\n        for (int i = 0; i < n; i++) {\n            if (p[i] > 0 and p[i] < l) {\n                ok = false;\n\n            }\n        }\n        if (ok) {\n            cout << t << \" \"<< lv + 1 <<\"\\n\";\n            return;\n        }\n        else {\n            lv = -1;\n            lp = inf;\n            for (int i = 0; i < n; i++) {\n                if (p[i] > 0 and p[i] < l) {\n                    if (chmin(lp, p[i])) {\n                        lv = i;\n                    }\n                    else if (lp == p[i] and d[i] == -1) lv = i;\n                }\n            }\n        }\n       \n    }\n}\n\nint main()\n{\n\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    \n\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tsolve();\n\t}\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n  \nusing namespace std;\n\nint n, l;\nint tunnel[101][2];\n// tunnel[i][0]????????????i???????????¨???????????????????????????????????¨????????¢????????????\n\nvoid solve()\n{\n    int leftnum = 0, t = 0;\n    while(1){\n        t++;\n        // ???????????????????????????\n        if(tunnel[l - 1][1] != 0){\n            leftnum++;\n            if(leftnum == n){\n                cout << t << \" \" << tunnel[l - 1][1] << endl;\n                return;\n            }\n            tunnel[l - 1][1] = 0;\n        }\n        for(int i = l - 2; i > 0; i--){\n            tunnel[i + 1][1] = tunnel[i][1];\n            tunnel[i][1] = 0;\n        }\n        // ???????????????????????????\n        if(tunnel[1][0] != 0){\n            leftnum++;\n            if(leftnum == n){\n                cout << t << \" \" << tunnel[1][0] << endl;\n                return;\n            }\n            tunnel[1][0] = 0;\n        }\n        for(int i = 2; i < l; i++){\n            if(tunnel[i][0] == 0) continue;\n            if(tunnel[i - 1][1] != 0){\n                tunnel[i - 1][0] = tunnel[i - 1][1];\n                tunnel[i - 1][1] = tunnel[i][0];\n            } else {\n                tunnel[i - 1][0] = tunnel[i][0];\n            }\n            tunnel[i][0] = 0;\n        }\n    }\n    return;\n}\n\nint main()\n{\n    while(1){\n        cin >> n >> l;\n        if(n == 0 && l == 0) break;\n        for(int i = 0; i < l; i++){\n            for(int j = 0; j < 2; j++){\n                tunnel[i][j] = 0;\n            }\n        }\n        char d;\n        int p;\n        for(int i = 0; i < n; i++){\n            cin >> d >> p;\n            if(d == 'L') tunnel[p][0] = i + 1;\n            else tunnel[p][1] = i + 1;\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n\nint main(){\n    int n,l;\n    while(~scanf(\"%d %d\",&n,&l) && n){\n        vvi v(n);\n        int t=-1;\n        rep(i,n){\n            char d; int p;\n            cin>>d>>p;\n            v[i]={p,d=='R' ? 1 : -1,i+1};\n            t=max(t, (d=='L' ? p : l-p));\n        }\n        int ans;\n        while(1){\n            rep(i,v.size()) v[i][0]+=v[i][1];\n            v.erase(remove_if(v.begin(),v.end(),[l](const vi& a){\n                        return a[0]==0 || a[0]==l;\n                    }),v.end());\n            if(v.size()==0) break;\n            sort(v.begin(),v.end());\n            ans=v.front()[2];\n            rep(i,v.size()-1){\n                if(v[i][0]==v[i+1][0]){\n                    swap(v[i][2],v[i+1][2]);\n                }\n            }\n        }\n        printf(\"%d %d\\n\",t,ans);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n\nclass Ant{\npublic:\n  char dir;\n  int pos;\n  Ant(char _d,int _p) : dir(_d), pos(_p) {}\n  Ant() : dir('\\0'), pos(-1) {}\n};\n\nint main(){\n  int total_ants;\n  int tunnel_length;\n  while(scanf(\"%d %d\",&total_ants,&tunnel_length)){\n    if(total_ants == 0) break;\n\n    Ant ants[101];\n    for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n      char dir[2];\n      int pos;\n      scanf(\"%s %d\",dir,&pos);\n      ants[ant_idx] = Ant(dir[0],pos);\n    }\n\n    int last_time = 0;\n    int last_ant = 0;\n    for(int time=1;time <= tunnel_length * total_ants;time++){\n      int collapse[101];\n      memset(collapse,0,sizeof(collapse));\n      int rem = 0;\n      for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n        if(ants[ant_idx].pos == 0\n           || ants[ant_idx].pos == tunnel_length) continue;\n\n        rem |= (1 << ant_idx);\n        if(ants[ant_idx].dir == 'R'){\n          collapse[ants[ant_idx].pos + 1] |= (1 << ant_idx);\n        }\n\n        else if(ants[ant_idx].dir == 'L'){\n          collapse[ants[ant_idx].pos - 1] |= (1 << ant_idx);\n        }\n      }\n\n      if(rem == 0) break;\n\n      for(int i=1;i<tunnel_length;i++){\n        if(__builtin_popcount(collapse[i]) >= 2){\n          for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n            if(collapse[i] & (1 << ant_idx)){\n              ants[ant_idx].pos += (ants[ant_idx].dir == 'R' ? 1 : -1);\n              ants[ant_idx].dir = (ants[ant_idx].dir == 'R' ? 'L' : 'R');\n              rem &= ~(1 << ant_idx);\n            }\n          }          \n        }\n      }\n\n      for(int ant_idx=0; ant_idx < total_ants; ant_idx++){\n        if(rem & (1<< ant_idx)){\n          if(ants[ant_idx].dir == 'R'){\n            ants[ant_idx].pos++;\n          }\n          else if(ants[ant_idx].dir == 'L'){\n            ants[ant_idx].pos--;\n            if(ants[ant_idx].pos == 0){\n              last_ant = ant_idx;\n            }\n          }\n        }\n      }\n      last_time = max(last_time,time);\n    }\n    \n    printf(\"%d %d\\n\",last_time,last_ant + 1);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint n, m;\nint main() {\n\twhile (cin >> n >> m, n | m) {\n\t\tm *= 2;\n\t\tvector<char> d(n); vector<int> v(n);\n\t\tfor (int i = 0; i < n; i++) cin >> d[i] >> v[i], v[i] *= 2;\n\t\tfor (int t = 0; ; t++) {\n\t\t\tbool ok = false;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tif (0 < v[i] && v[i] < m) ok = true;\n\t\t\t}\n\t\t\tif (!ok) {\n\t\t\t\tint s = 0;\n\t\t\t\tvector<pair<int, int> > w;\n\t\t\t\tfor (int i = 0; i < n; i++) w.push_back(make_pair(v[i], i + 1));\n\t\t\t\tsort(w.begin(), w.end());\n\t\t\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\t\t\tif (w[i].first == 0 || w[i].first == m) s = w[i].second;\n\t\t\t\t}\n\t\t\t\tcout << t / 2 << ' ' << s << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tif (d[i] == 'R') v[i]++;\n\t\t\t\telse v[i]--;\n\t\t\t}\n\t\t\tvector<char> e = d;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tbool ok = false;\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tif (e[i] != e[j] && v[i] == v[j]) ok = true;\n\t\t\t\t}\n\t\t\t\tif (ok && v[i] % 2 == 0) {\n\t\t\t\t\tif (d[i] == 'L') d[i] = 'R';\n\t\t\t\t\telse d[i] = 'L';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define FOR(i,m,n) for(int i=(int)m;i<(int)n;i++)\n#define F first\n#define S second\n#define P pair<int,int>\n#define PI pair<P,int>\n#define all(v) v.begin(),v.end()\n\n\nvoid f(int n,int l){\n  vector<char> d(n);\n  vector<int> p(n);\n  rep(i,n){\n    cin>>d[i]>>p[i];\n  }\n\n  vector<int> sec(n);\n  int m=n;\n  int s=0;\n  while(m){\n    //cout<<m<<endl;\n    vector<int> next(n);\n    rep(i,n){\n      if(p[i]==-1||p[i]==0||p[i]==l){\n        next[i]=-1;\n      }else{\n        if(d[i]=='L'){\n          next[i]=p[i]-1;\n        }else{\n          next[i]=p[i]+1;\n        }\n        if(next[i]==0||next[i]==l){\n          m--;\n          sec[i]=s+1;\n        }\n      }\n    }\n    rep(i,n){\n     //cout<<next[i]<<' ';\n      FOR(j,i+1,n){\n        if(next[i]==-1||next[j]==-1) continue;\n        if(next[i]==next[j]){\n          d[i]=(d[i]=='L'?'R':'L');\n          d[j]=(d[j]=='L'?'R':'L');\n        }\n      }\n    }\n    //cout<<endl;\n    p=next;\n    s++;\n  }\n\n  vector<PI> ans(n);\n  rep(i,n){\n    PI p;\n    p.F.F=sec[i];\n    p.F.S=(d[i]=='L'?1:0);\n    p.S=i;\n    ans[i]=p;\n    //cout<<p.F.F<<' '<<p.F.S<<' '<<p.S<<endl;\n  }\n  \n  sort(all(ans));\n  reverse(all(ans));\n  \n\n  cout<<ans[0].F.F<<' '<<ans[0].S+1<<endl;\n}\n\n\n\nsigned main(){\n\n  int n,l;\n  while(true){\n    cin>>n>>l;\n    if(n==0) break;\n    f(n,l);\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <algorithm>\n#include <cstring>\n#include <functional>\n#include <cmath>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define fs first\n#define sc second\n#define pb push_back\n#define show(x) cout << #x << \" \" << x << endl\nint main(){\n\twhile(true){\n\t\tint n,l,p[20];\n\t\tchar d[20];\n\t\tcin>>n>>l;\n\t\tif(n==0) break;\n\t\trep(i,n) cin>>d[i]>>p[i];\n\t\tint cnt=n,lst=-1,id=0;\n\t\tbool out[20];\n\t\trep(i,n) out[i]=0;\n\t\tfor(int t=1;;t++){\n\t\t\trep(i,n){\n\t\t\t\tif(out[i]) continue;\n\t\t\t\tif(d[i]=='R') p[i]++;\n\t\t\t\telse p[i]--;\n\t\t\t}\n\t\t\trep(i,n) rep(j,i){\n\t\t\t\tif(out[i]||out[j]) continue;\n\t\t\t\tif(p[i]==p[j]) swap(d[i],d[j]);\n\t\t\t}\n\t\t\trep(i,n) if(!out[i]&&(p[i]==0||p[i]==l)){\n\t\t\t\tout[i]=true;\n\t\t\t\tif(lst<t||p[i]==0) id=i;\n\t\t\t\tlst=t;\n\t\t\t\tcnt--;\n\t\t\t}\n\t\t\tif(cnt==0){\n\t\t\t\tcout<<t<<\" \"<<id+1<<endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//\n//\n//  Codeforces: ganariya\n//  AtCoder: ganariya2525\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMHBYYYWMMMM#BYYTTTYWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMB9O1==?????zzCC111>>;;;;;;;;;;;<?TMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMM9Olll=l======??????????>>>>>>;;;;;;;;;:;?TMMMMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMMMM9ttlllllllll=l=======?????????>>>>>>;;;;;;;;;;?TMMMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMMMBOttOtttttltlllllllll=======??????????>>>>>>>;;;;;;?TMMMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMMMBttwOtttttttttttttlllllllll========?????????>>>>>>;;;;;<TMMMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMMBrwZrttttttttttttttttttlllllllllll======???????????>>>>>>;;?HMMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMMSw0trtrrtrtrttrtttttttttttttlllOllllll========????<<zz??>>>>>>ZMMMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMMMX0ttrtrOOttrttrttOOttttttttttttltwllllllllll========??wy?????>>>vZMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMM0ttrI+wV1rtttttttwZtttttttltttOwylOXOllllllllllll=l====1dkz???????vZdMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMSrrwrtwZCjttttttttwSttOlllltllllwtXOlZkOlllllllllllllll==z+dk===?????X2JMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMBrtwwtrw0<jttttttttOXllOttltllttllOZwHOtXkyltlllllllllllllll<+XZ======?dk?JMMMMMMMMMMMM\n//  MMMMMMMMMMMMStwdZtwXC<+ttttttOOOd6ltZlltllllttllStWWOOHWytttttltltOllltllz:zHllll===zX=?dMMMMMMMMMMM\n//  MMMMMMMMMMBrwdKOtwW3;;zrttttwZwXRlldOllltltlltttwlXvktdXWytltttttttOttlttl<<dklllllllZ===dMMMMMMMMMM\n//  MMMMMMMMM8tQM#ttwW3;;;1trttwSwfUOlORltllltlllllldtX>dktDOWOtlttltttOOttltO<;+WOllllllXlllzMMMMMMMMMM\n//  MMMMMMMM9OdM#Ottd$;;;;;<?1z0OKjRltd0llltOllllllldZX>?WOw_WWOtttttttttOttI<;;<dkttttllllllldMMMMMMMMM\n//  MMMMMMM9wMMMSttwS<;;;;>;;;J<j>(I<?U111zltllllllld0X>~dkwl(WkttlttlOOwWk<;;:;;zHttttttwOllllMMMMMMMMM\n//  MMMMMMBdMMM8tttdI+zttttttdSXt~dlzXwlllzzOzzzzzlldkW<~?kOk~?sx++++jdHmH6+++<;;jdZtttttdkOtlldMMMMMMMM\n//  MMMMM#dMMM#tttw0+tttttttdKdf((RsdfRllllldZllltlldWK~~_W0w_~OWOlOdgg9ZtOWOtttz+wktttttdpktttwMMMMMMMM\n//  MMMMMWMMMMSlttdIttttttOdWHH>~(IzWDRll=llzRlllzlldk$>++dkd<~_XkdgH9tttttdktttt+OkrttrtdfpkttOMMMMMMMM\n//  MMMMNWMMM#Zttlk=tttttOXWWd$_.(IdW1R=llll=SlllzOldK<_._(kd6+-(MM9lltttttrWktttztWZttrwXppWttrMMMMMMMM\n//  MMMMNMMMM#lltwDzttllOXyW0X:..(OXk<Rl=ll=lwOlllOld3<``.(Rd>~?CdklllltttttXdXttzOWktrwwWpfpkrtMMMMMMMM\n//  MMMMMMMMM@ltldIzlttOXyW$w$```(OyD(Rl==llldZ=llIlw;~```-Xd:~~~~UkylltttAyHdgSrzObRtOXwpfppWrrMMMMMMMM\n//  MMMMMMMMM@llldtlllldVyW+d>```.wZ$ wl==lI=wRl=ll=w<```` dd_..~~(RZXOQdggHH9ZwrzwHWrdXXppfppkrMMMMMMMM\n//  MMMMMMMMM#llldlltlwyyyD(S-...,Wk] zI=l=llzWzl=l=P~```` jZ``...~zQkH@MBUtrZtrtldHRdSdpfpffpkwMMMMMMMM\n//  MMMMNMMMMNZllXtllldVyW3(Mf=<ONMHP~(k===l=zdk=lld3```...(C````..(M96lttttrrtrrtdHWHXpfpppfpRwMMMMMMMM\n//  MMMMMMMMMMNzzWZllzyyyy(W@`  =~MWK6 jz=lzlzvRz=lZ`.I+JgkWm&-. `..(ZltlttttrtttrWWHppfppfpppSdMMMMMMMM\n//  MMMMMMMMMMMkAWRllzVyyS_(b    .MNHU-(Uz=lI={XkzO>.dVT7<TMHMNHHx-.(kwZyltttrtrrdHHpfppfpffpp0dMMMMMMMM\n//  MMMMMMMMMMMMKyWzOzyyyk.`<!  hdWMH]``(S==t=l(kX2 ?_`    WMMHH#HH+.XwkwOttttrwrZ~(HfpfpppfpWwXMMMMMMMM\n//  MMMMMMMMMMMMMHWROOyyyW;` `. (WVM#b```(0=zzz wX!```  a.dM#NM@N(4WhXkXkWtttttwd3O_(HpffpfpfWwSMMMMMMMM\n//  MMMMMMMMMMMMNZvWzXXyyXP```-_ ?o+?!````.4=Z=`(:````  HpbNNMHHH (C=XXyWZWttrdwf:(>.dfppffppSXSMMMMMMMM\n//  MMMMMMMMMMMMMRzuHzXyZXH.``````````````` ?zz ``````` ZKvTHHbWt `` XZyyHZWOdSZ<::~`(fpfpfffXp0WMMMMMMM\n//  MMMMMMMMMMMMMKzyyHvyZZW____.`````````````.I_```````` ?nJzX7^````.WXWyyHyWKZ<:::_`Jffpfpfpfp0WMMMMMMM\n//  MMMMMMMMMMMMM@zZyZWwWyXo-_~(~ ```````````` `````````````` _`````.WXkyyVWmWc::<~ .HffppfffffkXMMMMMMM\n//  MMMMMMMMMMMMMKzZZZZXkUXr~....```````....```````````` ...  ````..JXWWyyW83vXx~..WfffVfWVffffkdMMMMMMM\n//  MMMMMMMMMMMMMRzZZZZZZZZb````````````<````````````./<~._<_.____`(WfdyW3<:~~(XWkVVVVVVVHVVVVV0dMMMMMMM\n//  MMMMMMMMMMMMMSzZZZZZZZWX-```````````````````````````.......~~._j9jX=_~~_(XZyVHHkyyyyWHyyykykOMMMMMMM\n//  MMMMMMMMMMMMMSzuuuuuZXWZW,```````````````````````````````.``..(3<! ...JWyyXWyyyWHkyyWHyyyHyklMMMMMMM\n//  MMMMMMMMMMMMNXzuuuXXuXSuuXh,```````` .... ```````````````````_~ .JWyyyyZyy0HyyZyyZyZXWZZZWHZIdMMMMMM\n//  MMMMMMMMMMMMNwtuuuXkuXXuuuuXh,``````(:::~<?71(,``````````````.(UMNUkZZZZZZZHZZ0ZZZZZWWZZZWNXIdMMMMMM\n//  MMMMMMMMMMMMNKOzuzXkuXuuuuuXuXW, ```` _~~~:~~(}```````````.(YC;::<kCfZZZZXO#ZZVZZZZZMZZuuMMNXzMMMMMM\n//  MMMMMMMMMMMMHKOzzuXkzdzzzzuXXzuuU&.``````````````````` .JY>::::;;J=:dZuZuZd#uuruuuud#uuuXMMMNXdMMMMM\n//  MMMMMMMMMMMMMNOvzzXkvMRzzzzXKzuzzzXh, `````````````..JC<;:;;:;;+7<:~(HHuXIdNuuzuuuXMSuuuWMMMMROMMMMM\n//  MMMMMMMMMMMMMNvvvrdkvM#vzzzzHzzzzzuzzUG. ``` ...JdY<:;:;:::;;+v<~~~:(HpHmzMNXZzuzzd#zzzdMMMMMMRdMMMM\n//  MMMMMMMMMMMMMNwrrvdRrMNwvvvvdRvvvzwkzzzzXWWHY=~~O+::::::::<+<~~~~~~~dppppWMMkZzzzwM#zzdMMMMMMMMNMMMM\n//  MMMMMMMMMMMMMM#rrrwRrMMbOrrOZNkrvvvXwvvvvvwX;.~._W_:::::(?!~~~~~~~~(HpppppppHWdvwM#XwdMMMMMMMMMMNMMM\n//  MMMMMMMMMMMMMMNyrrrRrWMMmzOrzdNyrrrZNvrwQWWfb....(r~~_J>_.....~.~~-dpfpffpfpppWHHMNdMMMMMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMNrtrStdMMMNxzrzMNmrrrdNWfVfffP._-.(~_J!............JpfpffpfpfffpppWNppppHMMMMMMMMMMMM\n//  MMMMMMMMMMMMMMMMNOtXtdMMMMMNxzZMMNmgHyVVVVVW%..?/(.,(x-..........(HfffpffpffpffWHHffpffppfVyyWMMMMMM\n\n\n//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <unordered_map>\n#include <climits>\n#include <set>\n#include <unordered_set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <queue>\n#include <random>\n#include <complex>\n#include <regex>\n#include <locale>\n#include <random>\n#include <type_traits>\n\nusing namespace std;\n\n#define SHOW_VECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOW_MAP(v){std::cerr << #v << endl; for(const auto& xxx: v){std::cerr << xxx.first << \" \" << xxx.second << \"\\n\";}}\n\nusing LL = long long;\n\n//~~~~~~~~~~~~~~~~~~~~~_(＾～＾ ｣ ∠)_~~~~~~~~~~~~~~~~~~~~~\n\nstruct Ant {\n\n    int pos;\n    int id;\n    int L;\n\n    bool left;\n    bool finish;\n\n    Ant(char c, int _pos, int _id, int _L) {\n        if (c == 'L') left = true;\n        if (c == 'R') left = false;\n        pos = _pos;\n        id = _id;\n        L = _L;\n        finish = false;\n    }\n\n    void move() {\n        if (left) pos--;\n        else pos++;\n    }\n\n    void change() {\n        left = !left;\n    }\n\n};\n\nint main() {\n\n    while (true) {\n\n        int N, L;\n        cin >> N >> L;\n\n        if (N == 0 || L == 0) break;\n\n        vector<Ant> ants;\n        for (int i = 0; i < N; i++) {\n            char ch;\n            int pos;\n            cin >> ch >> pos;\n            ants.push_back(Ant(ch, pos, i, L));\n        }\n\n        int t = 0;\n        vector<pair<int, bool>> ans;\n        vector<int> times;\n        map<int, int> to;\n        while (true) {\n            if (ans.size() == N) break;\n\n            t++;\n\n            for (int i = 0; i < N; i++) {\n                if (!ants[i].finish) {\n                    ants[i].move();\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                if (!ants[i].finish) {\n                    if (ants[i].pos == 0 || ants[i].pos == L) {\n                        ants[i].finish = true;\n                        ans.push_back(make_pair(ants[i].id, ants[i].left));\n                        times.push_back(t);\n                        to[ants[i].id] = times.size() - 1;\n                    }\n                }\n            }\n\n            map<int, int> m;\n            for (int i = 0; i < N; i++) {\n                if (!ants[i].finish) {\n                    m[ants[i].pos]++;\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                if (!ants[i].finish) {\n                    if (m[ants[i].pos] > 1) {\n                        ants[i].change();\n                    }\n                }\n            }\n        }\n\n        int maxT = times.back();\n        int cnt = count(times.begin(), times.end(), maxT);\n\n        if (cnt == 1) {\n            cout << maxT << \" \" << ans.back().first + 1 << endl;\n        } else {\n            int left_id = -1;\n            for (int i = 0; i < N; i++) {\n                if (ants[i].left && times[to[ants[i].id]] == maxT) {\n                    left_id = i;\n                }\n            }\n            cout << maxT << \" \" << left_id + 1 << endl;\n        }\n    }\n\n    return 0;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint pos[22];\nint dir[22];\nint last[22];\nbool pri[22];\n\nint main(void){\n\tint n,l;\n\twhile(cin >> n >> l){\n\t\tif(n==0)\n\t\t\tbreak;\n\n\t\tfor(int i=1;i<=n;++i){\n\t\t\tchar d;\n\t\t\tcin >> d >> pos[i];\n\t\t\tdir[i]=(d=='R')?1:-1;\n\t\t}\n\n\t\tfor(int t=1;;++t){\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t\tpos[i]+=dir[i];\n\n\t\t\tfor(int i=1;i<=n;++i){\n\t\t\t\tif(pos[i]==0||l==pos[i]){\n\t\t\t\t\tif(pos[i]==0)\n\t\t\t\t\t\tpri[i]=true;\n\t\t\t\t\telse\n\t\t\t\t\t\tpri[i]=false;\n\t\t\t\t\tlast[i]=t,pos[i]=-1,dir[i]=0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t\tfor(int j=i+1;j<=n;++j)\n\t\t\t\t\tif(pos[i]==pos[j])\n\t\t\t\t\t\tswap(dir[i],dir[j]);\n\n\t\t\tbool finished=true;\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t\tif(pos[i]!=-1)\n\t\t\t\t\tfinished=false;\n\n\t\t\tif(finished)\n\t\t\t\tbreak;\n\n\t\t}\n\t\tint cmax=0,ans=0;\n\t\tfor(int i=1;i<=n;++i){\n\t\t\tif(last[i]>cmax||(cmax==last[i]&&pri[i]))\n\t\t\t\tcmax=last[i],ans=i;\n\t\t}\n\t\tcout << cmax << \" \" << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint main() {\n    int N, d[32], x[32], X, i, OUT, t, cur[128], last_t, last;\n    char tmp;\n\n    while (cin >> N >> X && (N || X)) {\n        for (i=1; i<=N; i++) {\n            cin >> tmp >> x[i];\n            d[i] = ( tmp=='L' ? -1 : 1);\n        }\n    \n        OUT = t = last_t = last = 0;\n        while (OUT < N) {\n            memset(cur, 0, sizeof(cur));\n            for (i=1; i<=N; i++) if (x[i] > 0 && x[i] < X) {\n                x[i] += d[i];\n                if (cur[x[i]]) { d[cur[x[i]]] *= -1; d[i] *= -1; }\n                cur[x[i]] = i;\n                if (x[i] == 0 || x[i] == X) {\n                    OUT++;\n                    if ( last_t < t+1 || (last_t == t+1 && d[i] == -1) ) { last_t = t+1; last = i; }\n                }\n            }\n            t++;\n        }\n        cout << t << ' ' << last << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main () \n{\n    int num_ant, length;\n    \n    while (1)\n    {\n        std::cin >> num_ant >> length;\n        \n        if (num_ant == 0 && length == 0) break;\n        \n        char temp;\n        int position[num_ant];\n        int direction[num_ant];\n        \n        // input\n        for (int i = 0; i < num_ant; i++)\n        {\n            std::cin >> temp >> position[i];\n            if (temp == 'R') direction[i] =  1;\n            else             direction[i] = -1;\n        }\n        \n        // simulation\n        int t = 0;\n        int tag;\n        bool flag = false;\n        while (!flag)\n        {\n            t++;\n            int dummy[220] = {0};\n            //int conflict[110] = {0};\n            int *conflict = &dummy[110];\n            //int point[110] = {0};\n            int *point = &dummy[110];\n            flag = true;\n            \n            for (int i = 0; i < num_ant; i++)\n            {\n                // renew position\n                position[i] += direction[i];\n                \n                // ditecting conflict\n                if (conflict[position[i]] != 0) \n                {\n                    direction[i] *= -1;\n                    direction[point[position[i]]] *= -1;\n                }\n                else if (0 < position[i] && position[i] < length)\n                {\n                    conflict[position[i]]++;\n                    point[conflict[position[i]]] = i;\n                }\n            }\n            \n            // confirming\n            for (int j = 0; j < num_ant; j++) \n            {\n                if (0 < position[j] && position[j] < length) flag = false;\n            }\n            \n            if (flag)\n            {\n                for (int k = 0; k < num_ant; k++) \n                {\n                    if (position[k] == 0 || position[k] == length)\n                    {\n                        tag = k;\n                        break;\n                    }\n                }\n            }\n            \n        }\n        \n        std::cout << t << \" \" << tag + 1 << std::endl;\n        \n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tfor(int n,l;cin>>n>>l && n|l;){\n\t\tvector<char> ds(n);\n\t\tvector<int> ps(n);\n\t\tfor(int i=0;i<n;i++) cin>>ds[i]>>ps[i],ps[i]*=2;\n\t\tint res=-1,last=-1;\n\t\tfor(int t=0;;t++){\n\t\t\tif(count(begin(ds),end(ds),'#')==n){\n\t\t\t\tres=t;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast=find_if(begin(ds),end(ds),[](char c){return c!='#';})-begin(ds);\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++) if(ds[i]!='#'){\n\t\t\t\tif(ds[i]=='L') ps[i]--;\n\t\t\t\tif(ds[i]=='R') ps[i]++;\n\t\t\t\tif(ps[i]==0 || ps[i]==2*l) ds[i]='#';\n\t\t\t}\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\tfor(int j=i+1;j<n;j++)\n\t\t\t\t\tif(ds[i]!='#' && ds[j]!='#' && ps[i]==ps[j] && ps[i]%2==0)\n\t\t\t\t\t\tswap(ds[i],ds[j]);\n\t\t}\n\t\tcout<<res/2<<' '<<last+1<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nvoid solve()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint n, l;\n\twhile (cin >> n >> l, n || l)\n\t{\n\t\tvector<int> ant(n);\n\t\tvector<int> direction(n);\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tchar d;\n\t\t\tint p;\n\t\t\tcin >> d >> p;\n\t\t\tif (d == 'R')\n\t\t\t{\n\t\t\t\tdirection[i] = 1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdirection[i] = -1;\n\t\t\t}\n\t\t\tant[i] = p;\n\t\t}\n\t\tint step = 0;\n\t\tint goal = 0;\n\t\twhile (goal < n)\n\t\t{\n\t\t\tfor (int i = 0; i < n; ++i)\n\t\t\t{\n\t\t\t\tif (ant[i] == 0 || ant[i] == l)\n\t\t\t\t{\n\t\t\t\t\t++goal;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < l; ++i)\n\t\t\t{\n\t\t\t\tint cnt = 0;\n\t\t\t\tfor (int j = 0; j < n; ++j)\n\t\t\t\t{\n\t\t\t\t\tif (ant[j] == i)\n\t\t\t\t\t{\n\t\t\t\t\t\t++cnt;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cnt == 2)\n\t\t\t\t{\n\t\t\t\t\tfor (int j = 0; j < n; ++j)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (ant[j] == i)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdirection[j] = -direction[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < n; ++i)\n\t\t\t{\n\t\t\t\tant[i] += direction[i];\n\t\t\t}\n\t\t\t++step;\n\t\t}\n\t\tcout << --step << \" \";\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tif (ant[i] == -1)\n\t\t\t{\n\t\t\t\tcout << i + 1 << endl;\n\t\t\t\tgoto END;\n\t\t\t}\n\t\t}\t\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tif (ant[i] == l + 1)\n\t\t\t{\n\t\t\t\tcout << i + 1 << endl;\n\t\t\t\tgoto END;\n\t\t\t}\n\t\t}\n\tEND:\n\t\t;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main(){\n  while(1){\n    int n,l;\n    cin >> n >> l;\n    if(n==0) break;\n\n    vector<int> dir(n), pos(n);\n    int step=0;\n    for(int i=0; i<n; i++){\n      char d;\n      int p;\n      cin >> d >> p;\n      if(d=='L'){\n        dir[i] = -1;\n        step = max(step, p);\n      }else{\n        dir[i] = 1;\n        step = max(step, l-p);\n      }\n      pos[i] = p*2;\n    }\n\n    for(int i=0; i<step*2; i++){\n      for(int j=0; j<n; j++){\n        pos[j] += dir[j];\n      }\n      for(int j=0; j<n; j++){\n        for(int k=j+1; k<n; k++){\n          if(i%2==1 && pos[j]==pos[k]){\n            dir[j] = -dir[j];\n            dir[k] = -dir[k];\n          }\n        }\n      }\n    }\n\n    int ans = 0;\n    for(int i=0; i<n; i++){\n      if(pos[i] == l*2) ans = i;\n    }\n    for(int i=0; i<n; i++){\n      if(pos[i] == 0) ans = i;\n    }\n    cout << step << \" \" << ans+1 << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\n#define pos first.first\n#define dir first.second\n#define ind second\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint main(void){\n    for(int n, l; cin >> n >> l, n;){\n        vector< pair< pair<int, char>, int > > ants(n);\n\n        rep(i, n){\n            cin >> ants[i].dir >> ants[i].pos;\n            ants[i].ind = i + 1;\n        }\n\n        int res;\n        int cnt = 0;\n        while(1){\n            sort(all(ants));\n\n            bool run = false;\n            rep(i, n){\n                if(0 < ants[i].pos && ants[i].pos < l){\n                    run = true;\n                }\n            }\n            if(!run){\n                rep(i, n){\n                    if(ants[i].pos == 0 || ants[i].pos == l){\n                        res = ants[i].ind;\n                        break;\n                    }\n                }\n                break;\n            }\n\n            rep(i, n){\n                range(j, i + 1, n){\n                    if(ants[j].pos - ants[i].pos == 2 && ants[i].dir == 'R' && ants[j].dir == 'L'){\n                        swap(ants[i].ind, ants[j].ind);\n                    }\n                }\n            }\n\n            rep(i, n){\n                int diff = ants[i].dir == 'R' ? 1:-1;\n                ants[i].pos += diff;\n            }\n\n            cnt++;\n        }\n\n        cout << cnt << \" \" << res << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#include <vector>\n \nusing namespace std;\n\n#define RIGHT 1\n#define LEFT -1\n\nstruct ant {\n\tbool isOut;\n\tint vp;\n\tint pos;\n\tint outTime;\n};\n\nbool isAllOut( vector< ant > *a ) {\n\tbool b = true;\n\tfor( int i = 0; i < a->size(); i ++ )\n\t\tb &= a->at(i).isOut;\n\treturn b;\n}\n\nvoid bumpCheck( vector< ant > *a ) {\n\tfor( int i = 0; i < a->size(); i++ )\n\t\tfor( int j = 0; j < i; j ++ ) {\n\t\t\tif( a->at(i).isOut | a->at(j).isOut ) continue;\n\t\t\tif( a->at(i).pos == a->at(j).pos && a->at(i).pos % 2 == 0 ) {\n\t\t\t\ta->at(i).vp *= -1;\n\t\t\t\ta->at(j).vp *= -1;\n\t\t\t}\n\t\t}\n\n}\n\nvoid outCheck( int l, vector< ant > *a, int time ) {\n\tfor( int i = 0; i < a->size(); i++ ) {\n\t\tif( a->at(i).isOut ) \n\t\t\tcontinue;\n\t\tif( a->at(i).pos < 0 || a->at(i).pos > 2 * l ) {\n\t\t\ta->at(i).outTime = time;\n\t\t\ta->at(i).isOut = true;\n\t\t}\n\t}\n}\n\nvoid antsProcess( vector< ant > *a ) {\n\tfor( int i = 0; i < a->size(); i++ ) {\n\t\tif( a->at(i).isOut ) continue;\n\t\ta->at(i).pos += a->at(i).vp;\n\t}\n}\n\nint main(void){\n\n\twhile( true ) {\n\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif( !( n | l ) ) break; \n\n\t\tant newant;\n\t\tnewant.isOut = false;\n\t\tvector< ant > ants( n, newant );\n\n\t\tfor( int i = 0; i < n; i++ ) {\n\n\t\t\tchar ch;\n\t\t\tcin >> ch >> ants[i].pos;\n\t\t\tants[i].pos *= 2;\n\n\t\t\tswitch( ch ) {\n\t\t\t\tcase 'R':\n\t\t\t\t\tants[i].vp = RIGHT;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'L':\n\t\t\t\t\tants[i].vp = LEFT;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tint cnt = 0;\n\t\t//シュミレーション\n\t\twhile( !isAllOut( &ants ) ) {\n\t\t\tantsProcess( &ants );\n\t\t\tbumpCheck( &ants );\n\t\t\toutCheck( l, &ants , cnt );\n\t\t\tcnt ++;\n\t\t}\n\n\t\tint ans = 0, max = 0;\n\t\tfor( int i = 0; i < n; i ++ ) {\n\t\t\tif( max < ants[i].outTime ) {\n\t\t\t\tmax = ants[i].outTime;\n\t\t\t\tans = i + 1;\n\t\t\t} else if( max == ants[i].outTime && ants[i].pos < 0 ) {\n\t\t\t\tans = i + 1;\n\t\t\t}\n\t\t}\n\n\t\tcout << cnt / 2 << \" \" << ans << endl;\n\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nstruct P {\n  char dir;\n  int pos, t;\n  P() { t = 0; }\n  P(char d, int p, int t) : dir(d), pos(p), t(t) {}\n};\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  \n  int n, l;\n  while (cin >> n >> l, n) {\n    vector<P> now(n), next = now;\n    for (int i = 0; i < n; i++) {\n      cin >> now[i].dir >> now[i].pos;\n    }\n\n    while (true) {\n      bool update = false;\n      for (int i = 0; i < n; i++) {\n        int pos = now[i].pos;\n        if (pos == 0 || pos == l) {\n          next[i] = now[i];\n        } else {\n          if (now[i].dir == 'R') {\n            next[i] = P('R', pos + 1, now[i].t + 1);\n            for (int j = 0; j < n; j++) {\n              if (pos + 2 < l && now[j].dir == 'L' && now[j].pos == pos + 2) next[i] = P('L', pos + 1, now[i].t + 1);\n            }\n          } else {\n            next[i] = P('L', pos - 1, now[i].t + 1);\n            for (int j = 0; j < n; j++) {\n              if (pos - 2 > 0 && now[j].dir == 'R' && now[j].pos == pos - 2) next[i] = P('R', pos - 1, now[i].t + 1);\n            }\n          }\n          update = true;\n        }\n      }\n      swap(now, next);\n      if (!update) break;\n    }\n\n    int ansl = -1, ansr = -1;\n    for (int i = 0; i < n; i++) {\n      if (now[i].dir == 'L' && (ansl < 0 || now[i].t > now[ansl].t)) ansl = i;\n      if (now[i].dir == 'R' && (ansr < 0 || now[i].t > now[ansr].t)) ansr = i;\n    }\n    \n    int tl = ansl < 0 ? 0 : now[ansl].t, tr = ansr < 0 ? 0 : now[ansr].t;\n    if (tl >= tr) cout << tl << \" \" << ansl + 1 << endl;\n    else cout << tr << \" \" << ansr + 1 << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint N, L;\nint Left[101], Right[101];\n\nbool Check()\n{\n  for(int i = 1; i <= L; i++) {\n    if(Left[i] != 0) return(true);\n    if(Right[i] != 0) return(true);\n  }\n  return(false);\n}\n\nint main()\n{\n  while(cin >> N >> L, N) {\n    for(int i = 0; i < N; i++) {\n      char c;\n      int d;\n      cin >> c >> d;\n      if(c == 'L') Left[d] = i + 1;\n      else Right[d] = i + 1;\n    }\n    int last, time;\n    for(time = 0; Check(); ++time) {\n      for(int i = L; i > 0; i--) {\n        Right[i] = Right[i - 1];\n      }\n      for(int i = 0; i < L; i++) {\n        Left[i] = Left[i + 1];\n      }\n      if(Right[L] > 0) last = Right[L];\n      if(Left[0] > 0) last = Left[0];\n      for(int i = 1; i < L; i++) {\n        if(Left[i] > 0 && Right[i] > 0) swap(Left[i], Right[i]);\n      }\n    }\n    cout << --time << \" \" << last << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tint n,l;\n\twhile(1){\n\t\tcin>>n>>l;\tif(n==0)break;\n\t\tvector<pair<char,int>>A(n);\n\t\tfor(int i=0;i<n;i++){\n\t\t\tcin>>A[i].first>>A[i].second;\n\t\t}\n\n\t\tint ans=0,num=0,time=0;;\n\t\tbool flag=true;\n\t\twhile(flag){\n\t\t\t++time;\tflag=false;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(A[i].second==-1)continue;\n\t\t\t\t// move\n\t\t\t\tflag=true;\n\t\t\t\tif(A[i].first=='R')A[i].second++;\n\t\t\t\telse A[i].second--;\n\t\t\t}\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\t// check\n\t\t\t\tif(0<A[i].second && A[i].second<l){\n\t\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\t\tif(i==j)continue;\n\t\t\t\t\t\telse if(A[i].second==A[j].second){\n\t\t\t\t\t\t\t//printf(\"%d: (%d,%d)\\n\",A[i].second,i+1,j+1);\n\t\t\t\t\t\t\tif(A[i].first=='R')A[i].first='L';\n\t\t\t\t\t\t\telse A[i].first='R';\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(A[i].second==0){\n\t\t\t\t\tA[i].second=-1;\n\t\t\t\t\tans=time;\n\t\t\t\t\tnum=i+1;\n\t\t\t\t}else if(A[i].second==l){\n\t\t\t\t\tA[i].second=-1;\n\t\t\t\t\tif(ans!=time){\n\t\t\t\t\t\tans=time;\n\t\t\t\t\t\tnum=i+1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<\" \"<<num<<endl;\n\t}\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-9;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\n\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tint n,m;\n\t\tcin>>n>>m;\n\t\tif(n==0) break;\n\t\tvvi a(m+1);\n\t\tvi b(n);\n\t\tfor(int i=0;i<n;i++){\n\t\t\tchar c;\n\t\t\tint x;\n\t\t\tcin>>c>>x;\n\t\t\ta[x].push_back(i);\n\t\t\tb[i]=(c=='R'?1:-1);\n\t\t}\n\t\tint res=0;\n\t\twhile(1){\n\t\t\tres++;\n\t\t\tvvi c(m+1);\n\t\t\tfor(int j=1;j<m;j++) if(!a[j].empty()){\n\t\t\t\tfor(auto k:a[j]){\n\t\t\t\t\tc[j+b[k]].push_back(k);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=1;j<m;j++) if(c[j].size()>=2){\n\t\t\t\tb[c[j][0]]*=-1;\n\t\t\t\tb[c[j][1]]*=-1;\n\t\t\t}\n\t\t\ta=c;\n\t\t\tint num=0;\n\t\t\tfor(int i=1;i<m;i++) num+=a[i].size();\n//\t\t\tcout<<res<<endl;\n\t\t\tif(num==0){\n\t\t\t\tcout<<res<<' '<<(a[0].empty()?a[m][0]:a[0][0])+1<<endl;\n\t\t\t\tbreak;\n\t\t\t}\n/*\t\t\tfor(int i=0;i<=m;i++){\n\t\t\t\tcout<<i<<':';\n\t\t\t\tfor(auto j:a[i]) cout<<j<<' ';\n\t\t\t\tcout<<endl;\n\t\t\t}*/\n/*\t\t\tif(!a[0].empty()||!a[m+1].empty()){\n\t\t\t\tcout<<res<<' '<<(a[0].empty()?a[m+1][0]:a[0][0])+1<<endl;\n\t\t\t\tbreak;\n\t\t\t}*/\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long llint;\ntypedef pair<int, int> P;\n\nint main() {\n  int n, l;\n  while (true) {\n    cin >> n >> l;\n    if (l == 0) break;\n    vector<int> d(n), p(n);\n    for (int i = 0; i < n; i++) {\n      char c;\n      cin >> c >> p[i];\n      if (c == 'R')\n        d[i] = 1;\n      else\n        d[i] = -1;\n    }\n    int cnt = 0;\n    vector<P> ans(n, P(0, 0));\n    while (true) {\n      cnt++;\n      vector<int> dd(n), pp(n);\n      for (int i = 0; i < n; i++) {\n        if (p[i] == 0 || p[i] == l) continue;\n        if (d[i] == 1) {\n          pp[i] = p[i] + 1;\n          dd[i] = d[i];\n          for (int j = 0; j < n; j++) {\n            if (i == j) continue;\n            if (p[i] + 2 == p[j]) {\n              if (d[j] == -1) {\n                dd[i] = (-1) * d[i];\n              }\n            }\n          }\n        } else {\n          pp[i] = p[i] - 1;\n          dd[i] = d[i];\n          for (int j = 0; j < n; j++) {\n            if (i == j) continue;\n            if (p[i] - 2 == p[j]) {\n              if (d[j] == 1) {\n                dd[i] = (-1) * d[i];\n              }\n            }\n          }\n        }\n      }\n      bool f = true;\n      for (int i = 0; i < n; i++) {\n        d[i] = dd[i];\n        p[i] = pp[i];\n        // cout << p[i] << \" \" << d[i] << endl;\n        if (p[i] == 0 || p[i] == l) {\n          if (ans[i].first == 0) {\n            ans[i].first = cnt;\n            ans[i].second = p[i];\n          }\n          continue;\n        }\n        f = false;\n      }\n      if (f) break;\n    }\n    int resid = 0, res = 0;\n    for (int i = 0; i < n; i++) {\n      if (res < ans[i].first) {\n        res = ans[i].first;\n        resid = i;\n      } else if (res == ans[i].first) {\n        if (ans[i].second == 0) {\n          res = ans[i].first;\n          resid = i;\n        }\n      }\n    }\n    cout << res << \" \" << resid + 1 << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define DEBUG(x) cerr << #x << \" = \" << x << endl\n\nint main() {\n    while(true) {\n        int N, L; cin >> N >> L;\n        if(N == 0 && L == 0) break;\n        vector<int> pos(N);\n        // L=-1, R=1\n        vector<int> dir(N);\n        for(int i = 0; i < N; i++) {\n            int p; char d;\n            cin >> d >> p;\n            pos[i] = p;\n            dir[i] = (d == 'R') ? 1 : -1;\n        }\n        int last = 0;\n        int lastsecond = 0;\n        int second = 0;\n        int lastPos = (int)1e9;\n        vector<int> live(N, 1);\n        while(true) {\n            second++;\n            vector<int> on(L + 1, 0);\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    pos[i] += dir[i];\n                    on[pos[i]]++;\n                }\n            }\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    if(on[pos[i]] >= 2) {\n                        dir[i] *= -1;\n                    }\n                }\n            }\n            for(int i = 0; i < N; i++) {\n                if(live[i]) {\n                    if(pos[i] == 0 || pos[i] == L) {\n                        live[i] = 0;\n                        if(second == lastsecond) {\n                            if(pos[i] < lastPos) {\n                                last = i;\n                                lastsecond = second;\n                                lastPos = pos[i];\n                            }\n                        }\n                        else {\n                            last = i;\n                            lastsecond = second;\n                            lastPos = pos[i];\n                        }\n                    }\n                }\n            }\n            bool f = false;\n            for(int i = 0; i < N; i++) {\n                if(live[i]) f = true;\n            }\n            if(!f) break;\n        }\n        cout << lastsecond << ' ' << last + 1 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint n,l;\nchar d[250];\nint p[250];\nbool goal[250];\n\nint main(){\n\twhile(1){\n\t\tint n,l;\n\t\tcin >> n >> l;\n\t\tif(n==0&&l==0) break;\n\t\tREP(i,n){\n\t\t\tcin >> d[i] >> p[i];\n\t\t\tgoal[i] = false;\n\t\t}\n\t\tint rest = n;\n\t\tint leftgoal;\n\t\tll int goaltime = 0;\n\t\twhile(rest!=0){\n\t\t\tgoaltime++;\n\t\t\tvector<int> posd[500];\n\t\t\tREP(i,500) posd[i].clear();\n\t\t\tREP(i,n){\n\t\t\t\t//cout << d[i] << \" \" << p[i] << endl;\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tif(goal[i]) continue;\n\t\t\t\tif(p[i]<=0||p[i]==l) continue;\n\t\t\t\tif(d[i]=='L') p[i]--;\n\t\t\t\telse p[i]++;\n\t\t\t\t//cout << p[i] << endl;\n\t\t\t\tposd[p[i]].pb(i);\n\t\t\t}\n\t\t\tREP(i,l+1){\n\t\t\t\tif(posd[i].size()==2){\n\t\t\t\t\tswap(d[posd[i][1]],d[posd[i][0]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tif(p[i]==0){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\tleftgoal = i;\n\t\t\t\t\trest--;\n\t\t\t\t}\n\t\t\t\tif(p[i]==l){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\trest--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << goaltime << \" \" << leftgoal+1 << endl;\n\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\nusing namespace std;\n\nstruct Info{\n\tInfo(){\n\t\tto_left_id = to_right_id = -1;\n\t}\n\tvoid init(){\n\t\tto_left_id = to_right_id = -1;\n\t}\n\tint to_left_id,to_right_id;\n};\n\nvoid func(int N,int L){\n\n\tInfo info[L+1],work[L+1];\n\n\tint ant_loc;\n\tchar dist[2];\n\n\tfor(int ant_id = 1; ant_id <= N; ant_id++){\n\t\tscanf(\"%s %d\",dist,&ant_loc);\n\n\t\tif(dist[0] == 'L'){\n\t\t\tinfo[ant_loc].to_left_id = ant_id;\n\t\t}else{\n\t\t\tinfo[ant_loc].to_right_id = ant_id;\n\t\t}\n\t}\n\n\tint count,sum_time = 0,final_ant,final_time = 0;\n\n\twhile(true){\n\n\t\tfor(int i = 1; i <= L-1; i++)work[i].init();\n\n\t\tcount = 0;\n\t\tfor(int i = 1; i <= L-1; i++){\n\t\t\tif(info[i].to_left_id != -1 && info[i].to_right_id != -1){\n\t\t\t\tcount += 2;\n\n\t\t\t\twork[i+1].to_right_id = info[i].to_left_id;\n\t\t\t\twork[i-1].to_left_id = info[i].to_right_id;\n\n\t\t\t}else if(info[i].to_left_id != -1 && info[i].to_right_id == -1){\n\t\t\t\tcount++;\n\t\t\t\twork[i-1].to_left_id = info[i].to_left_id;\n\t\t\t\tif(i == 1){\n\t\t\t\t\tfinal_ant = info[i].to_left_id;\n\t\t\t\t\tfinal_time = sum_time;\n\t\t\t\t}\n\t\t\t}else if(info[i].to_left_id == -1 && info[i].to_right_id != -1){\n\t\t\t\tcount++;\n\t\t\t\twork[i+1].to_right_id = info[i].to_right_id;\n\t\t\t\tif(i == L-1 && final_time < sum_time){\n\t\t\t\t\tfinal_ant = info[i].to_right_id;\n\t\t\t\t\tfinal_time = sum_time;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(count == 0)break;\n\t\tsum_time++;\n\n\t\tfor(int i = 1; i <= L-1; i++){\n\t\t\tinfo[i].to_left_id = work[i].to_left_id;\n\t\t\tinfo[i].to_right_id = work[i].to_right_id;\n\t\t}\n\t}\n\n\tprintf(\"%d %d\\n\",sum_time,final_ant);\n\n}\n\nint main(){\n\n\tint N,L;\n\twhile(true){\n\t\tscanf(\"%d %d\",&N,&L);\n\t\tif(N == 0 && L == 0)break;\n\n\t\tfunc(N,L);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\ntypedef struct Ant{\n  int position;\n  bool left;\n}Ant;\n\nint main(){\n  int n,l;\n  char c;\n  while(cin>>n>>l,n){\n    Ant a[n];\n    for(int i=0;i<n;i++){\n      cin>>c>>a[i].position;\n      if(c == 'L')\n\ta[i].left = true;\n      else\n\ta[i].left = false;\n    }\n    bool flag=false;\n    int ans=0;\n    int num;\n\n    while(1){\n      if(flag == true)\n\tbreak;\n      //cout<<\"KJLJ\"<<endl;\n      flag = true;\n      ans++;\n\n      //for(int i=0;i<n;i++){\n\t//cout<<\"a[\"<<i<<\"].left\" << a[i].left<<endl;\n      //}\n\n      for(int i=0;i<n;i++){\n\tif(a[i].left==false && (a[i].position!=l && a[i].position!=0)){\n\t  a[i].position++;\n\t  flag = false;\n\t  num = i;\n\t  //cout<<\"i \"<<i<<\" ant pos \"<<a[i].position<<\" flag \"<<a[i].left<<endl;\n\t}\n      }\n      \n      for(int i=0;i<n;i++){\n\tif(a[i].left == true && a[i].position != l && a[i].position!=0){\n\t  a[i].position--;\n\t  flag = false;\n\t  num = i;\n\t  //cout<<\"i \"<<i<<\" ant pos \"<<a[i].position<<\" flag \"<<a[i].left<<endl;\n\t}\n\t//for i end\n      }\n      for(int j=0;j<n && flag == false;j++){\n\tfor(int k=j+1;k<n;k++){\n\t  if(a[j].position == a[k].position){\n\t    //cout<<\"j \"<<j<<\" k \"<<k<<endl;\n\t    a[j].left = !a[j].left;\n\t    a[k].left = !a[k].left;\n\t  }\n\t}\n      }\n      //while(1) end\n    }\n    cout<<ans-1<<\" \"<<num+1<<endl;\n  }  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <sstream>\n#include <list>\n#include <iomanip>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nstruct Point\n{\n  double x,y;\n  Point(){x=0;y=0;}\n  Point(double d_x,double d_y){x=d_x,y=d_y;}\n  double operator*(Point obj){return obj.x*x+obj.y*y;}\n  double operator%(Point obj){return obj.y*x-obj.x*y;}\n  Point operator*(double b){Point tmp;tmp.x=x*b;tmp.y=y*b;return tmp;}\n  Point operator/(double b){Point tmp;tmp.x=x/b;tmp.y=y/b;return tmp;}\n  Point operator+(Point obj){Point tmp;tmp.x=x+obj.x;tmp.y=y+obj.y;return tmp;}\n  Point operator-(){Point tmp;tmp.x=-x;tmp.y=-y;return tmp;}\n  Point operator-(Point obj){Point tmp;tmp.x=x-obj.x;tmp.y=y-obj.y;return tmp;}\n  Point operator-=(Point obj){x-=obj.x;y-=obj.y;return *this;}\n  Point operator+=(Point obj){x+=obj.x;y+=obj.y;return *this;}\n  Point operator/=(double b){x=x/b;y=y/b;return *this;}\n  Point operator*=(double b){x=x*b;y=y*b;return *this;}\n  double size(){return hypot(x,y);}\n  Point unit(){return Point(x/size(),y/size());}\n  Point normal(){return Point(y,-x);}\n  double atan(){return atan2(y,x);}\n};\n\nbool operator<(Point a,Point b){return a.x!=b.x?a.x<b.x:a.y<b.y;}\nbool operator>(Point a,Point b){return b<a;}\nbool operator<=(Point a,Point b){return !(b<a);}\nbool operator>=(Point a,Point b){return !(a<b);}\nbool operator==(Point a,Point b){return (a-b).size()<eps;}\nbool operator!=(Point a,Point b){return !(a==b);}\n\nbool equal(double a,double b){return abs(a-b)<eps;}\ndouble cross(Point a,Point b){return a%b;}\ndouble dot(Point a,Point b){return a*b;}\n\nint ccw(Point a,Point b,Point c)\n{\n  b=b-a;\n  c=c-a;\n  if(b%c>0) return +1;\n  else if(b%c<0)return -1;\n  else if(b*c<0) return +2;\n  else if(b.size()<c.size()) return -2;\n  else return 0;\n}\n\nint n,l;\nstruct params\n{\n  int now;\n  int dist;\n  bool clear=false;\n  int t=0;\n};\n\nint main(int argc,char const* argv[])\n{\n  string tmp;\n  while(1)\n    {\n      cin >> n >> l;\n      if(!n) break;\n      vector<params> ants(n);\n      for(int i=0;i<n;i++)\n\t{\n\t  char tmp;\n\t  cin >> tmp >> ants[i].now;\n\t  if(tmp=='L')\n\t    {\n\t      ants[i].dist=0;\n\t    }\n\t  else\n\t    {\n\t      ants[i].dist=1;\n\t    }\n\t}\n      while(1)\n\t{\n\t  bool end=true;\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(ants[i].clear) continue;\n\t      ants[i].t++;\n\t      if(ants[i].dist==0) ants[i].now--;\n\t      else ants[i].now++;\n\t      if(ants[i].now<=0 || ants[i].now>=l) ants[i].clear=true;\n\t    }\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      for(int j=i+1;j<n;j++)\n\t\t{\n\t\t  if(ants[i].now==ants[j].now)\n\t\t    {\n\t\t      ants[i].dist=(ants[i].dist+1)%2;\n\t\t      ants[j].dist=(ants[j].dist+1)%2;\n\t\t    }\n\t\t}\n\t    }\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(ants[i].clear==false) end=false;\n\t    }\n\t  if(end) break;\n\t}\n      int lasttime=0,lastid;\n      for(int i=0;i<n;i++)\n\t{\n\t  if(ants[i].t>lasttime)\n\t    {\n\t      lasttime=ants[i].t;\n\t      lastid=i+1;\n\t    }\n\t  else if(lasttime==ants[i].t && ants[i].now==0)\n\t    {\n\t      lastid=i+1;\n\t    }\n\t}\n      cout << lasttime << ' ' << lastid << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nchar T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;\nmain(){\nwhile(1){\nM=0;\nmemset(y,0,999);\ncin>>b>>l;if(!l){break;}\nfor(i=1;i<=b;i++){\ncin>>T>>x[i];\nif(T=='L'){d[i]=0;M=max(M,x[i]);}\nelse{d[i]=1;M=max(M,l-x[i]);}\n}\nN=0;\nfor(i=1;i<M+2;i++){\nmemset(z,0,sizeof(z));\nfor(j=b;j>0;j--) {\nif(!y[j]) {\nif(!d[j]){\nx[j]--;\n}\nelse{\nx[j]++;\n}\nif(x[j]<0||x[j]>l){\ny[j]=1;\n}\nz[x[j]]++;\nif(M<i){\nif(N){\nif(x[j]<0){N=j;}\n}\nelse{\nN=j;\n}\n}\n}\n}\nfor(j=b;j>0;j--){\nif(z[x[j]]>1){\nif(d[j]){d[j]=0;}\nelse{d[j]=1;}\n}\n}\n}\nprintf(\"%d %d\\n\",M,N);\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing pii = pair<int,int>;\nusing ll = long long;\n#define rep(i, j) for(int i=0; i < (int)(j); i++)\n#define repeat(i, j, k) for(int i = (j); i < (int)(k); i++)\n#define all(v) v.begin(),v.end()\n#define debug(x) cerr << #x << \" : \" << x << endl\n\ntemplate<class T> bool set_min(T &a, const T &b) { return a > b  ? a = b, true : false; }\ntemplate<class T> bool set_max(T &a, const T &b) { return a < b  ? a = b, true : false; }\n// vector\ntemplate<class T> istream&\noperator >> (istream &is , vector<T> &v) { for(T &a : v) is >> a; return is; }\ntemplate<class T> ostream&\noperator << (ostream &os , const vector<T> &v) { for(const T &t : v) os << \"\\t\" << t; return os << endl; }\n// pair\ntemplate<class T, class U> ostream&\noperator << (ostream &os , const pair<T, U> &v) { return os << \"<\" << v.first << \", \" << v.second << \">\"; }\n\nconst int INF = 1 << 30;\nconst ll INFL = 1LL << 60;\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(true) {\n        int N, L; cin >> N >> L;\n        if(N == 0) return 0;\n        L *= 2;\n        vector<int> D(N);\n        vector<vector<int>> G[2];\n        rep(i, 2) G[i].resize(L);\n        rep(i, N) {\n            char d;\n            int p;\n            cin >> d >> p;\n            p *= 2;\n            D[i] = d == 'L' ? -1 : 1;\n            G[0][p].push_back(i);\n        }\n        int left = N;\n        int time = 0;\n        while(left > 0) {            \n            int now = time % 2;\n            int nxt = (now + 1) % 2;\n            rep(i, L) G[nxt][i].clear();\n            // go\n            for(int i = L - 1; i > 0 ; i--) {\n                while(G[now][i].size()) {\n                    int idx = G[now][i].back(); G[now][i].pop_back();\n                    int nxt_p = i + D[idx];\n                    if(nxt_p == 0 or nxt_p ==L) {\n                        left--;\n                        if(left == 0) {\n                            cout << time / 2 + 1 << \" \" << idx + 1 << endl;\n                        }\n                    } else {\n                        G[nxt][nxt_p].push_back(idx);\n                    }\n                }\n            }\n            // check        \n            for(int i = 0; i < L; i += 2) {\n                assert(G[nxt][i].size() <= 2);\n                if(G[nxt][i].size() == 2) {\n                    swap(D[G[nxt][i][0]], D[G[nxt][i][1]]);\n                }\n            }\n            time++;\n        }    \n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <memory>\n#include <cstring>\n#include <cassert>\n#include <numeric>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <cctype>\n#include <unordered_map>\n#include <unordered_set>\nusing namespace std;\n\n#define REP2(i, m, n) for (int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(S) (S).begin(), (S).end()\ntypedef long long ll;\n\nint main(){\n  ios::sync_with_stdio(false);\n\n  int N, L;\n  while (cin >> N >> L && N + L> 0){\n    L *= 2;\n    vector<int> d(N);\n    vector<int> p(N);\n    REP(i, N){\n      char dir;\n      cin >> dir >> p[i];\n      d[i] = dir == 'R' ? 1 : -1;\n      p[i] *= 2;\n    }\n\n    int time = 0;\n    int last = 0;\n\n    while (true){\n      bool update = false;\n      int  goal   = -1;\n      \n      REP(i, N) if (0 < p[i] && p[i] < L){\n        p[i] += d[i];\n        update = true;\n        \n        if ((p[i] == L && goal == -1) || p[i] == 0){\n          goal = i + 1;\n        }\n      }\n      \n      if (!update){\n        break;\n      } else {\n        last = goal;\n        time++;\n\n        REP(i, N) REP(j, i){\n          if (p[i] == p[j] && 0 < p[i] && p[i] < L && p[i] % 2 == 0){\n            assert(d[i] != d[j]);\n            swap(d[i], d[j]);\n          }\n        }\n      }\n    }\n\n    cout << time / 2 << \" \" << last << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\n\nvoid solve(int n, int l) {\n    map<int, int> pos;\n    vector<char> dir(n);\n    char d;\n    int p;\n    for (int i = 0; i < n; i++) {\n        cin >> d >> p;\n        dir[i] = d;\n        pos[i] = p;\n    }\n    int last_ant;\n    int elapsed = 0;\n    vector<vector<int> > tunnel(l + 1);\n    while (true) {\n        int cnt = 0;\n        for (int i = 0; i < n; i++) {\n            if (dir[i] == 'L') pos[i]--;\n            else if (dir[i] == 'R') pos[i]++;\n            else cnt++;\n        }\n        if (cnt == n) break;\n        for (int i = 0; i <= l; i++) tunnel[i].clear();\n        for (int i = 0; i < n; i++) {\n            if (dir[i] == 'N') continue;\n            tunnel[pos[i]].push_back(i);\n        }\n        for (int i = 1; i < l; i++) {\n            if (tunnel[i].size() == 2) {\n                for (int j = 0; j < 2; j++) {\n                    if (dir[tunnel[i][j]] == 'L') {\n                        dir[tunnel[i][j]] = 'R';\n                    }\n                    else if (dir[tunnel[i][j]] == 'R') {\n                        dir[tunnel[i][j]] = 'L';\n                    }\n                }\n            }\n        }\n        if (tunnel[l].size() == 1) {\n            dir[tunnel[l][0]] = 'N';\n            last_ant = tunnel[l][0];\n        }\n        if (tunnel[0].size() == 1) {\n            dir[tunnel[0][0]] = 'N';\n            last_ant = tunnel[0][0];\n        }\n        elapsed++;\n    }\n    cout << elapsed << ' ' << last_ant + 1 << endl;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int N, L;\n    while (true) {\n        cin >> N >> L;\n        if (N == 0 && L == 0) break;\n        solve(N, L);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\nusing namespace std;\nint cou;\nint n,l;\nstruct ant{\n  bool toRight;\n  int position;\n};\nant ants[20];\nint main() {\n  while(true){\n    cin >> n >> l;\n    if(n==0&&l==0) return 0;\n    rep(i,n){\n      ants[i] = ant();\n      char c;\n      cin >> c;\n      if(c=='R'){\n        ants[i].toRight = true;\n      }else{\n        ants[i].toRight = false;\n      }\n      cin >> ants[i].position;\n    }\n    cou = n;\n    int leftout;\n    int rightout;\n    for(int t = 1;true;t++){\n      leftout = -1;\n      rightout = -1;\n      rep(i,n){\n        if(ants[i].position==0||ants[i].position==l) continue;\n        if(ants[i].toRight){\n          ants[i].position++;\n        }else{\n          ants[i].position--;\n        }\n        if(ants[i].position==0){\n          cou--;\n          leftout = i;\n        }\n        if(ants[i].position==l){\n          cou--;\n          rightout = i;\n        }\n      }\n      if(cou==0){\n        if(leftout!=-1){\n          cout << t << \" \" << leftout+1 << endl;\n        }else{\n          cout << t << \" \" << rightout+1 << endl;\n        }\n        break;\n      }\n      rep(i,n){\n        if(ants[i].position==0||ants[i].position==l) continue;\n        REP(j,i+1,n){\n          if(ants[i].position==ants[j].position){\n            ants[i].toRight = !ants[i].toRight;\n            ants[j].toRight = !ants[j].toRight;\n          }\n        }\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nvoid solve(int N, int L, VV &a) {\n    int cnt = N;\n    int lastAnt = -1;\n    int t = 0;\n    while (true) {\n        t++;\n        VV b(L, V(2, 0));\n\n        // move\n        rrep(x, L) {\n            rep(k, 2) {\n                if (a[x][k] == 0) continue;\n                int nx = x + (k == 0 ? +1 : -1);\n                if (nx < 0 || nx >= L) {\n                    cnt--;\n                    lastAnt = a[x][k];\n                }\n                else {\n                    b[nx][k] = a[x][k];\n                }\n            }\n        }\n\n        if (cnt == 0) {\n            cout << t << \" \" << lastAnt << endl;\n            return;\n        }\n\n        // collision\n        rep(x, L) {\n            if (b[x][0] > 0 && b[x][1] > 0) {\n                swap(b[x][0], b[x][1]);\n            }\n        }\n\n        a = b;\n    }\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    int N, L;\n    while (cin >> N >> L, N) {\n        L--;\n        VV a(L, V(2, 0));\n        rep(i, N) {\n            char c;\n            int x;\n            cin >> c >> x;\n            x--;\n            a[x][c == 'L'] = i + 1;\n        }\n\n        solve(N, L, a);\n    }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define loop(n, i) for(int i=0;i<n;i++)\n#define all(v) v.begin(),v.end()\n#define HERE cout << \"HERE: \" << __LINE__ << endl;\n#define INSP(v) cout << v << \" at \" << __LINE__ << endl;\n\nusing namespace std;\ntypedef long long ll;\ntypedef tuple<int, int, int> T;\n\nint main()\n{\n    while (1) {\n        int n, l; cin >> n >> l;\n        if (!n) break;\n\n        vector<T> crr;\n        loop (n, i) {\n            char d; int p; cin >> d >> p;\n            int id = d == 'L' ? -1 : 1;\n            crr.emplace_back(p, i, id);\n        }\n        sort(all(crr));\n\n        int time = 0;\n        while (1) {\n            if (crr.size() <= 2) {\n                int ok = 1;\n                for (T a : crr) {\n                    int p = get<0>(a);\n                    ok = ok && (p == 0 || p == l);\n                }\n                if (ok) {\n                    cout << time << \" \" << get<1>(crr[0])+1 << endl;\n                    break;\n                }\n            }\n            vector<T> next;\n            for (T a : crr) {\n                int p = get<0>(a), id = get<1>(a), d = get<2>(a);\n                if (p+d >= 0 && p+d <= l) {\n                    next.emplace_back(p+d, id, d);\n                }\n            }\n            sort(all(next));\n            loop (next.size()-1, i) {\n                if (get<0>(next[i]) == get<0>(next[i+1])) {\n                    next[i] = T{\n                        get<0>(next[i]),\n                        get<1>(next[i]),\n                        -get<2>(next[i])\n                    };\n                    next[i+1] = T{\n                        get<0>(next[i+1]),\n                        get<1>(next[i+1]),\n                        -get<2>(next[i+1])\n                    };\n                }\n            }\n            crr = next;\n            time++;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <numeric>\n#include <tuple>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define whole(x) begin(x), end(x)\nusing namespace std;\n\nint main() {\n    while (true) {\n        // input\n        int n, l; scanf(\"%d%d\", &n, &l);\n        if (n == 0 and l == 0) break;\n        vector<char> d(n);\n        vector<int> p(n);\n        repeat (i, n) {\n            scanf(\" %c%d\", &d[i], &p[i]);\n        }\n        // solve\n        vector<int> t(n);\n        repeat (i, n) {\n            t[i] = (d[i] == 'L' ? p[i] : l - p[i]);\n        }\n        vector<int> xs(n);\n        iota(whole(xs), 0);\n        sort(whole(xs), [&](int i, int j) {\n            return make_tuple(t[i], d[i] == 'L') < make_tuple(t[j], d[j] == 'L');\n        });\n        bool last_parity = p[xs.back()] % 2;\n        xs.erase(remove_if(whole(xs), [&](int i) {\n            return p[i] % 2 != last_parity;\n        }), xs.end());\n        auto last_i = xs.begin();\n        repeat (i, xs.size() - 1) {\n            if (d[xs[i]] == 'L') {\n                ++ last_i;\n            }\n        }\n        // output\n        int last_t = *max_element(whole(t));\n        printf(\"%d %d\\n\", last_t, *last_i + 1);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// ACM-ICPCアジア地区予選2013 B. The Last Ant\n\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nvoid solve(vector< pair<int,int> >& vp, int l){\n\tint leaveCnt = 0, lastID = 0;\n\tfor(int t=1; ;++t){\n\t\tfor(int i=0;i<vp.size();i++){\n\t\t\tif(vp[i].second != -1)\n\t\t\t\tvp[i].second += vp[i].first;\n\t\t}\n\t\tfor(int i=0;i<vp.size();i++){\n\t\t\tfor(int j=i+1;j<vp.size();j++){\n\t\t\t\tif(vp[i].second == vp[j].second) swap(vp[i], vp[j]);\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<vp.size();i++){\n\t\t\tif(vp[i].second == l){\n\t\t\t\tvp[i].second = -1;\n\t\t\t\tlastID = i+1;\n\t\t\t\tleaveCnt++;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<vp.size();i++){\n\t\t\tif(vp[i].second == 0){\n\t\t\t\tvp[i].second = -1;\n\t\t\t\tlastID = i+1;\n\t\t\t\tleaveCnt++;\n\t\t\t}\n\t\t}\n\t\tif(leaveCnt == vp.size()){\n\t\t\tcout << t << \" \" << lastID << endl;\n\t\t\treturn ;\n\t\t}\n\t}\n}\n\nint main(){\n\tint n, l;\n\twhile(cin >> n >> l && n){\n\t\tvector< pair<int,int> > vp(n);\n\t\tfor(int i=0;i<n;i++){\n\t\t\tstring s; int p; cin >> s >> p;\n\t\t\tvp[i] = make_pair(s==\"L\" ? -1 : 1, p);\n\t\t}\n\t\tsolve(vp, l);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nstruct ant{\n  int p;\n  int d;\n  int id;\n};\n\nint main(){\n  while(1){\n    int n,l;\n    cin >> n >> l;\n    if(n==0) return 0;\n    vector<ant> pos(n);\n    char c;\n    rep(i,n){\n      cin >> c >> pos[i].p;\n      pos[i].d=(c=='R'?1:-1);\n      pos[i].id=i+1;\n    }\n    int count=n,t=0;\n    while(1){\n      t++;\n      int num=-1;\n      rep(i,n){\n        pos[i].p+=pos[i].d;\n      }\n      sort(all(pos),[](ant &l, ant &r){\n        return l.p<r.p;\n      });\n      rep(i,n-1){\n        if(pos[i].p==pos[i+1].p){\n          pos[i].d*=-1;\n          pos[i+1].d*=-1;\n        }\n      }\n      rep(i,n){\n        if((pos[i].p==0&&pos[i].d==-1)||(pos[i].p==l&&pos[i].d==1)){\n          if(num==-1) num=pos[i].id;\n          count--;\n          pos[i].p=100000;\n          pos[i].d=0;\n        }\n      }\n      if(count==0){\n        cout << t SP num << endl;\n        break;\n      }\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int n, l;\n    cin >> n >> l;\n    if (n == 0 && l == 0){\n      break;\n    }\n    vector<char> d(n);\n    vector<int> p(n);\n    for (int i = 0; i < n; i++){\n      cin >> d[i] >> p[i];\n    }\n    vector<int> a(n);\n    for (int i = 0; i < n; i++){\n      a[i] = i + 1;\n    }\n    int t = 0;\n    vector<int> ans;\n    while (1){\n      t++;\n      for (int i = 0; i < n; i++){\n        if (d[i] == 'L'){\n          p[i]--;\n        }\n        if (d[i] == 'R'){\n          p[i]++;\n        }\n      }\n      for (int i = 0; i < n - 1; i++){\n        if (p[i] > p[i + 1]){\n          swap(p[i], p[i + 1]);\n          swap(d[i], d[i + 1]);\n          swap(a[i], a[i + 1]);\n        }\n      }\n      for (int i = 0; i < n - 1; i++){\n        if (p[i] == p[i + 1] && d[i] == 'R' && d[i + 1] == 'L'){\n          swap(d[i], d[i + 1]);\n        }\n      }\n      for (int i = 0; i < n; i++){\n        if (p[i] == l){\n          ans.push_back(a[i]);\n        }\n      }\n      for (int i = 0; i < n; i++){\n        if (p[i] == 0){\n          ans.push_back(a[i]);\n        }\n      }\n      if (ans.size() == n){\n        break;\n      }\n    }\n    cout << t << ' ' << ans[n - 1] << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct Ant{\n    int num;\n    char direc;\n    Ant(){}\n    Ant(int num, char direc):num(num),direc(direc){}\n    bool operator<(const Ant& a) const{ return num < a.num; }\n    bool operator>(const Ant& a) const{ return num > a.num; }\n};\n\nint main(){\n    \n    while(1){\n        int n, l; cin >> n >> l;\n        if(!n) break;\n        vector<vector<set<Ant> > > tunnel(2, vector<set<Ant> > (l + 1));\n    \n        \n        for(int i = 1; i <= n; i++){\n            char d; cin >> d;\n            int loc; cin >> loc;\n            tunnel[0][loc].insert(Ant(i, d));\n        }\n\n        int t = 0;\n        int now = 0;\n        int next = 1;\n        for(;;){\n\n            /*de\n            cout << endl;\n            for(int i = 0; i <= l; i++){\n                cout << i << \": \";\n                for(auto ant : tunnel[now][i]){\n                    cout << \"(\" << ant.num << \", \" << ant.direc << \") \";\n                }\n                cout << endl;\n            }*/\n\n\n            int cnt_ant = 0;\n            for(int i = 1; i < l; i++){\n                cnt_ant += (int)tunnel[now][i].size();\n            }\n            if(cnt_ant == 0){\n                if(tunnel[now][0].size() == 1){\n                    for(auto ant : tunnel[now][0]){\n                        cout << t << \" \" << ant.num << endl;\n                    }\n                }else{\n                    for(auto ant : tunnel[now][l]){\n                        cout << t << \" \" << ant.num << endl;\n                    }\n                }\n\n                break;\n            }\n\n            for(int i = 1; i < l; i++){\n                for(auto ant : tunnel[now][i]){\n                    if(ant.direc == 'R'){\n                        tunnel[next][i + 1].insert(ant);\n                    }else{\n                        tunnel[next][i - 1].insert(ant);\n                    }\n                }\n            }\n\n            for(int i = 1; i < l; i++){\n                if(tunnel[next][i].size() == 2){\n                    set<Ant> tmp;\n                    for(auto ant : tunnel[next][i]){\n                        if(ant.direc == 'L') ant.direc = 'R';\n                        else ant.direc = 'L';\n                        tmp.insert(ant);\n                    }\n                    tunnel[next][i] = tmp;\n                }\n            }\n\n            t++;\n            swap(now, next);\n            for(int i = 0; i <= l; i++) tunnel[next][i].clear();\n        }\n\n\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nvoid push(int m[101][2], int cp[101][2], int i, int j, int x){\n    if(cp[i + x][0] == 0){\n        cp[i + x][0] = m[i][j];\n    }else{\n        cp[i + x][1] = m[i][j];\n    }\n}\n\nint main(){\n    int n, l;\n    while(cin >> n >> l, n||l){\n        int m[101][2] = {0};\n        rep(i,n){\n            int p;\n            char c;\n            cin >> c >> p;\n            if(c == 'R') m[p][0] = i + 1;\n            else m[p][0] = -1 * (i + 1);\n        }\n\n        int time = 0;\n        int last_ant = -1;\n        while(n){\n            int cp[101][2] = {0};\n            //rep(i,l + 1){ cout << m[i][0] << ' '; }cout << endl;\n            rep(i,l + 1){\n                rep(j,2){\n                    if(m[i][j] > 0){\n                        push(m, cp, i, j, 1);\n                    }else if(m[i][j] < 0){\n                        push(m, cp, i, j, -1);\n                    }\n                }\n            }\n            rep(i,l + 1){\n                if(cp[i][0] != 0 && cp[i][1] != 0){\n                    cp[i][0]*=-1;\n                    cp[i][1]*=-1;\n                }\n            }\n            if(cp[l][0] != 0){\n                n--;\n                if(n == 0) last_ant = cp[l][0];\n                cp[l][0] = 0;\n            }\n            if(cp[0][0] != 0){\n                n--;\n                if(n == 0) last_ant = cp[0][0];\n                cp[0][0] = 0;\n            }\n            memcpy(m, cp, sizeof(m));\n            time++;\n        }\n        cout << time << ' ' << abs(last_ant) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N, L;\n\nint p[21];\nint d[21];\n\nint main() {\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    while(true) {\n        cin >> N >> L;\n        if(N == 0) break;\n        int out = 0;\n        for(int i = 1; i <= N; i++) {\n            char di;\n            cin >> di;\n            if(di == 'L') d[i] = 0;\n            else d[i] = 1;\n            cin >> p[i];\n            //cerr << d[i] << ' ' << p[i] << endl;\n        }\n        for(int timer = 1; ; timer++) {\n            //cerr << timer << ' ' << out << endl;\n            for(int i = 1; i <= N; i++) {\n                if(d[i] == -1) continue;\n                if(d[i] == 0) p[i]--;\n                if(d[i] == 1) p[i]++;\n            }\n            int ans = -1;\n            for(int i = 1; i <= N; i++) {\n                if(d[i] == -1) continue;\n                for(int j = i + 1; j <= N; j++) {\n                    if(d[j] == -1) continue;\n                    if(p[i] == p[j]) {\n                        d[i] = 1 - d[i];\n                        d[j] = 1 - d[j];\n                    }\n                }\n            }\n            for(int i = 1; i <= N; i++) {\n                if(d[i] == -1) continue;\n                if(p[i] == L) {\n                    d[i] = -1;\n                    ans = i;\n                    out++;\n                    //cerr << timer << ' ' << i << endl;\n                }\n            }\n            for(int i = 1; i <= N; i++) {\n                if (d[i] == -1) continue;\n                if (p[i] == 0) {\n                    d[i] = -1;\n                    ans = i;\n                    out++;\n                    //cerr << timer << ' ' << i << endl;\n                }\n            }\n            if(out == N) {\n                cout << timer << ' ' << ans << endl;\n                break;\n            }\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n#include <vector>\n#include <algorithm>\n#include <set>\n#include <queue>\n#include <map>\n#include <climits>\nusing namespace std;\n\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n#define RREP(i,n) for(int i=(int)n-1; i>=0; i--)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();++i)\n#define ALL(c) (c).begin(), (c).end()\n\ntypedef long long int ll;\ntypedef pair<int, int> pii;\ntypedef pair<int, pair<int, int> > pipii;\ntypedef vector<int> vi;\n\nconst int INF = 1e9;\nconst int MOD = 1e9+7;\n\nint main(void){\n    int n, l;\n    while(cin >> n >> l, n || l){\n        vector<char> d(n);\n        vi p(n);\n        REP(i, n) cin >> d[i] >> p[i];\n        vector<vi> tunnel(l+2, vi(2, 0));\n        REP(i, n){\n            if(d[i] == 'R') tunnel[p[i]][0] = i+1;\n            else tunnel[p[i]][1] = i+1;\n        }\n        int cnt = 0;\n        while(1){\n            cnt++;\n            for(int i = l-1; i >= 1; i--){\n                if(tunnel[i][0]){\n                    tunnel[i+1][0] = tunnel[i][0];\n                    tunnel[i][0] = 0;\n                }\n            }\n            for(int i = 1; i <= l-1; i++){\n                if(tunnel[i][1]){\n                    tunnel[i-1][1] = tunnel[i][1];\n                    tunnel[i][1] = 0;\n                }\n            }\n            int f = 0;\n            for(int i = 1; i <= l-1; i++){\n                if(tunnel[i][0] || tunnel[i][1]) f = 1;\n                if(tunnel[i][0] && tunnel[i][1]) swap(tunnel[i][0], tunnel[i][1]);\n            }\n            if(!f) break;\n            tunnel[0][1] = tunnel[l][0] = 0;\n        }\n        if(tunnel[0][1]) cout << cnt << \" \" << tunnel[0][1] << endl;\n        else cout << cnt << \" \" << tunnel[l][0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < (int)(j); ++i)\n#define FOR(i, j, k) for(int i = (int)(j); i < (int)(k); ++i)\n#define SORT(v) sort((v).begin(), (v).end())\n#define REVERSE(v) reverse((v).begin(), (v).end())\ntypedef pair<int, int> P;\n\nint power(int b, int n){\n  if(n <= 0) return 1;\n  return power(b, n - 1) * b;\n}\n\nint main() {\n  int N, L;\n  while(cin >>N >>L && N){\n    vector<int> l(L + 1, 0), r(L + 1, 0);\n    REP(i, N){\n      char d; int p; cin >>d >>p;\n      if(d == 'R') r[p] = i + 1;\n      else l[p] = i + 1;\n    }\n    int t = -1, cnt = 0, last = -1;\n    while(cnt < N){\n      if(r[L] != 0) { last = r[L]; r[L] = 0; ++cnt; }\n      if(l[0] != 0) { last = l[0]; l[0] = 0; ++cnt; }\n      vector<int> nl(L + 1, 0), nr(L + 1, 0);\n      FOR(i, 1, L){\n        int nra = r[i - 1], nla = l[i + 1];\n        if(nra != 0 && nla != 0) { nl[i] = nra; nr[i] = nla; }\n        else { nl[i] = nla; nr[i] = nra; }\n      }\n      nl[0] = l[1]; nr[L] = r[L - 1];\n      l = nl; r = nr;\n      ++t;\n    }\n    cout <<t <<\" \" <<last <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\n#define mp make_pair\n\nint main(){\n    int n,l;\n    while(cin>>n>>l && n){\n        typedef pair<int,pair<char,int>> P;\n        vector<P> v(n);\n        int t=-1;\n        rep(i,n){\n            char d; int p;\n            cin>>d>>p;\n            v[i]=mp(p,mp(d,i+1));\n            t=max(t, (d=='L' ? p : l-p));\n        }\n        int ans;\n        while(1){\n            rep(i,v.size()){\n                if(v[i].second.first=='L')v[i].first--;\n                else v[i].first++;\n            }\n            auto it=remove_if(v.begin(),v.end(),[l](const P& a){\n                    return a.first==0 || a.first==l;\n                });\n            v.erase(it,v.end());\n            if(v.size()==0)break;\n            sort(v.begin(),v.end());\n            // rep(i,v.size()){\n            //     printf(\"(%c %d %d) \", v[i].second.first,v[i].first,v[i].second.second);\n            // }\n            // puts(\"\");\n            ans=v.front().second.second;\n            rep(i,v.size()-1){\n                if(v[i].first==v[i+1].first){\n                    swap(v[i].second.second,v[i+1].second.second);\n                }\n            }\n        }\n        cout << t << \" \" << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "// テ・ツ淞コテヲツ慊ャテ」ツδ?」ツδウテ」ツδ療」ツδャテ」ツδシテ」ツδ?\n\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define int long long int\n\ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconstexpr ll INF = 1001001001001001LL;\nconstexpr ll MOD = 1000000007LL;\n\nint N, L;\n\nstruct Elem {\n    int time, pos, idx;\n};\n\nbool operator<(const Elem &a, const Elem &b) {\n    if(a.time != b.time) return a.time > b.time;\n    else if(a.pos != b.pos) return a.pos < b.pos;\n    else return a.idx < b.idx;\n}\n\nsigned main() {\n    while(cin >> N >> L, N || L) {\n        vector<int> dir, pos;\n        rep(i,0,N) {\n            char c; int p; cin >> c >> p;\n            if(c == 'R') dir.push_back(1);\n            else dir.push_back(-1);\n            pos.push_back(p);\n        }\n\n        Elem ans = Elem{-1, -1, -1};\n        rep(i,0,110) {\n            rep(j,0,N) {\n                if(pos[j] == 0 || pos[j] == L) continue;\n                if(dir[j] > 0) pos[j]++;\n                else pos[j]--;\n\n                if(pos[j] == L || pos[j] == 0) {\n                    chmin(ans, Elem{i+1, pos[j], j+1});\n                }\n            }\n\n            rep(i,0,N) rep(j,i+1,N) {\n                if(pos[i] == pos[j]) {\n                    dir[i] *= -1;\n                    dir[j] *= -1;\n                }\n            }\n        }\n        printf(\"%lld %lld\\n\", ans.time, ans.idx);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n#include <tuple>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e12;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100\n\nll sq(ll num) { return num*num; }\nll mod_pow(ll x, ll n) {\n\tif (n == 0)return 1;\n\tif (n == 1)return x%MOD;\n\tll res = sq(mod_pow(x, n / 2));\n\tres %= MOD;\n\tif (n % 2 == 1) {\n\t\tres *= x;\n\t\tres %= MOD;\n\t}\n\treturn res;\n}\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nint n, l;\nchar d[100];\nint p[100];\nset<int> table[110];\n\nvoid print() {\n\trep(i, n) {\n\t\tcout << i << \" \" << d[i] << \" \" << p[i] << endl;\n\t}\n\tcout << endl;\n}\n\nint main() {\n\twhile (cin >> n >> l&&n + l) {\n\t\trep(i, 100)table[i].clear();\n\t\trep(i, n) {\n\t\t\tcin >> d[i] >> p[i];\n\t\t\ttable[p[i]].insert(i);\n\t\t}\n\t\tint num = -1;\n\t\tint ans = 0;\n\t\twhile (1) {\n\t\t\tint pp = -1;\n\t\t\tint cnt = 0;\n\t\t\trep(i, n) {\n\t\t\t\tif (p[i] < 1 || l <= p[i])continue;\n\t\t\t\tif (p[i] == 1 || p[i] == l - 1) {\n\t\t\t\t\tif (pp == -1) {\n\t\t\t\t\t\tnum = i;\n\t\t\t\t\t\tpp = p[i];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (p[i] == 1)num = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcnt++;\n\t\t\t\ttable[p[i]].erase(i);\n\t\t\t\tif (d[i] == 'R')p[i]++;\n\t\t\t\telse p[i]--;\n\t\t\t\tif (p[i] >= 1 && l > p[i])table[p[i]].insert(i);\n\t\t\t}\n\t\t\t//print();\n\t\t\tif (cnt == 0)break;\n\t\t\tans++;\n\t\t\trep(i, l) {\n\t\t\t\tif (table[i].size() == 2) {\n\t\t\t\t\tauto it = table[i].begin();\n\t\t\t\t\tauto it2 = it;\n\t\t\t\t\tit2++;\n\t\t\t\t\tswap(d[*it], d[*it2]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \" << num + 1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#define f first\n#define s second\n#define mp make_pair \n#define pv push_back\nusing namespace std;\n\nint main()\n{\n  char a;\n  int n,l,b;\n  vector<pair<int,int> > ant; \n\n  while(1){\n    cin>>n>>l;\n    if(n+l==0)break;\n    ant.clear();\n    for(int i=0;i<n;i++){\n      cin>>a>>b;\n      if(a=='R')ant.pv(mp(1,b));\n      else ant.pv(mp(-1,b));\n    }\n    int time=0,lastant,leavetime=0;\n    while(1){\n      int nest[101]={};\n      bool flag=false,LR=false;\n\n      for(int i=0;i<ant.size();i++)if(ant[i].f!=0)flag=true;\n      if(!flag)break;\n\n      for(int i=0;i<ant.size();i++){\n\tif(ant[i].f==0)continue;\n\tant[i].s+=ant[i].f;\n\tif(ant[i].s==l){\n\t  if(!LR)lastant=i+1;\n\t  ant[i].f=0;\n\t  continue;\n\t}\n\tif(ant[i].s==0){\n\t  lastant=i+1;\n\t  LR=true;\n\t  ant[i].f=0;\n\t  continue;\n\t}\n\tnest[ant[i].s]++;\n      }\n\n      for(int i=0;i<l;i++){\n\tif(nest[i]>=2){\n\t  for(int j=0;j<ant.size();j++){\n\t    if(ant[j].s==i)ant[j].f=-ant[j].f;\n\t  }\n\t}\n      }\n      time++;\n    }\n    cout<<time<<\" \"<<lastant<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst double inf=1e8;\nint main(){\n\tint n,k;\n\twhile(cin>>n>>k,n+k){\n\t\tvvp in(k-1);\n\t\trep(i,n){\n\t\t\tchar c;int a;\n\t\t\tcin>>c>>a;\n\t\t\tin[a-1].pb(pii(c,i));\n\t\t}\n\t\tint cnt=0;\n\t\tint last;\n\t\twhile(1){\n\t\t\tcnt++;\n\t\t\tvvp tmp(k-1);\n\t\t\tfor(int i=k-2;i>=0;i--)rep(j,in[i].size()){\n\t\t\t\tlast=in[i][j].second;\n\t\t\t\tint t=i;\n\t\t\t\tif(in[i][j].first=='L')t--;\n\t\t\t\telse t++;\n\t\t\t\tif(t==-1||t==k-1)n--;\n\t\t\t\telse{\n\t\t\t\t\ttmp[t].pb(in[i][j]);\n\t\t\t\t\tif(tmp[t].size()==2){\n\t\t\t\t\t\tswap(tmp[t][0].first,tmp[t][1].first);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tin=tmp;\n\t\t\tif(!n)break;\n\t\t}\n\t\tcout<<cnt<<\" \"<<last+1<<endl;;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nint main() {\n\tint n, l;\n\twhile (cin >> n >> l, n) {\n\t\tvector<pii> ants(n);\n\t\tREP(i, n) {\n\t\t\tchar d;\n\t\t\tcin >> d >> ants[i].second;\n\t\t\tif (d == 'R') {\n\t\t\t\tants[i].first = 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tants[i].first = -1;\n\t\t\t}\n\t\t}\n\n\t\tint left = n, sec = 0, ans = -1;\n\t\twhile (true) {\n\t\t\tsec++;\n\t\t\tans = -1;\n\t\t\tREP(i, n) {\n\t\t\t\tants[i].second += ants[i].first;\n\t\t\t}\n\n\t\t\tREP(i, n) {\n\t\t\t\tif (ants[i].first != 0) {\n\t\t\t\t\tif (ants[i].second == 0) {\n\t\t\t\t\t\tans = i + 1;\n\t\t\t\t\t\tants[i].first = 0;\n\t\t\t\t\t\tleft--;\n\t\t\t\t\t}\n\t\t\t\t\telse if (ants[i].second == l) {\n\t\t\t\t\t\tif (ans == -1) {\n\t\t\t\t\t\t\tans = i + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tants[i].first = 0;\n\t\t\t\t\t\tleft--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (n != 1) {\n\t\t\t\tREP(i, n) {\n\t\t\t\t\tFOR(j, i, n - 1) {\n\t\t\t\t\t\tif (ants[i].second == ants[j].second && ants[i].first != 0) {\n\t\t\t\t\t\t\tants[i].first *= -1;\n\t\t\t\t\t\t\tants[j].first *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (left == 0) {\n\t\t\t\tcout << sec << \" \" << ans << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\n\nint main(){\n\tint n,l;\n\tchar d[100];\n\tint x[100];\n\twhile(cin>>n>>l,n|l){\n\t\tint count=0;\n\t\tint leave,t=0;\n\t\trep(i,n)cin>>d[i]>>x[i];\n\t\twhile(count<n){\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==-1)continue;\n\t\t\t\tif(d[i]=='L')x[i]--;\n\t\t\t\telse x[i]++;\n\t\t\t}\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==-1)continue;\n\t\t\t\tfor(int j=i+1;j<n;j++){\n\t\t\t\t\tif(x[j]==-1)continue;\n\t\t\t\t\tif(x[i]==x[j])swap(d[i],d[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tleave=-1;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==0||x[i]==l){\n\t\t\t\t\tcount++;\n\t\t\t\t\tx[i]=-1;\n\t\t\t\t\tif(leave==-1 || d[leave]=='R')leave=i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tt++;\n\t\t}\n\t\tcout<<t<<' '<<leave+1<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<sstream>\n#include<utility>\n#include<map>\n#include<vector>\n#include<queue>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int>P;\n\nint N,L,c,r,ra,D[100];\nqueue<int>q[2][105],w;\nint main()\n{\n\tfor(;scanf(\"%d%d\\n\",&N,&L),N;)\n\t{\n\t\tr=-1;\n\t\tc=N;\n\t\tfor(int i=0;i<N;i++)\n\t\t{\n\t\t\tint t;\n\t\t\tchar d;\n\t\t\tscanf(\"%c%d\\n\",&d,&t);\n\t\t\tq[0][t].push(i);\n\t\t\tD[i]=d=='R'?1:-1;\n\t\t}\n\t\tfor(int time=0;c>0;time++)\n\t\t{\n\t\t\tint f=time%2,nf=f^1;\n\t\t\tfor(int i=0;i<=L;i++)\n\t\t\t{\n\t\t\t\twhile(!q[f][i].empty())\n\t\t\t\t{\n\t\t\t\t\tint p=q[f][i].front();q[f][i].pop();\n\t\t\t\t\tif(i+D[p]<0||i+D[p]>L)\n\t\t\t\t\t{\n\t\t\t\t\t\tc--;\n\t\t\t\t\t\tif(r<time)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tr=time;\n\t\t\t\t\t\t\tra=p+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tq[nf][i+D[p]].push(p);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<=L;i++)\n\t\t\t{\n\t\t\t\tif(q[nf][i].size()>1)\n\t\t\t\t{\n\t\t\t\t\twhile(!q[nf][i].empty())\n\t\t\t\t\t{\n\t\t\t\t\t\tint p=q[nf][i].front();q[nf][i].pop();\n\t\t\t\t\t\tD[p]*=-1;\n\t\t\t\t\t\tw.push(p);\n\t\t\t\t\t}\n\t\t\t\t\twhile(!w.empty())\n\t\t\t\t\t{\n\t\t\t\t\t\tq[nf][i].push(w.front());\n\t\t\t\t\t\tw.pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\",r,ra);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n\nint main()\n{\n    int n, l;\n    while (scanf(\"%d%d\", &n, &l), n) {\n        int d[21], p[21];\n        for(int i=0;i<n;++i) {\n            char t[2];\n            scanf(\"%s%d\", t, p+i);\n            d[i]=*t=='R'?1:-1;\n        }\n#define f(i) (0<p[i] and p[i]<l)\n#define swap(x, y) { int $=x; x=y; y=$; }\n        int sec=-1, last=-1;\n        bool done=false;\n        while (!done) {\n            done=true;\n            int x=-1;\n            for(int i=0;i<n;++i) if (f(i)) {\n                p[i]+=d[i];\n                if (x<0) { last=i; x=p[i]; }\n                else if (p[i]==0) { last=i; }\n                done=false;\n            }\n            for(int i=0;i<n;++i) if (f(i))\n                for(int j=i+1;j<n;++j) if (f(j) and p[i]==p[j])\n                    swap(d[i], d[j]);\n            ++sec;\n        }\n        printf(\"%d %d\\n\", sec, last+1);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <numeric>\n#include <map>\n#include <vector>\n#include <cmath>\n#include <iostream>\n#include <cassert>\n\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(int)n;i++)\n#define ALL(s) s.begin(),s.end()\nint main() {\n\twhile(true){\n\t\tint n,l;cin >> n >> l;if(n==0)break;\n\t\tvector<int> dirL(n),pos(n);\n\t\tvector<int> map(n);iota(ALL(map),1);\n\t\tREP(i,n){\n\t\t\tchar d;int p;cin >> d >> p;\n\t\t\tif(d=='L')dirL[i]=true;\n\t\t\tpos[i]=p;\n\t\t}\n\n\t\tvector<int> ndirL,npos;\n\t\tvector<int> nmap;\n\t\tint t=0;int last=-1;\n\t\twhile(n>0){\n\t\t\tt++;\n\t\t\t// move\n\t\t\tREP(i,n){\n\t\t\t\tif(dirL[i])pos[i]--;\n\t\t\t\telse pos[i]++;\n\t\t\t}\n\t\t\tREP(i,n-1)if(pos[i]>pos[i+1]){\n\t\t\t\tswap(dirL[i],dirL[i+1]);\n\t\t\t\tswap(pos[i],pos[i+1]);\n\t\t\t\tswap(map[i],map[i+1]);\n\t\t\t}\n\t\t\t// rot\n\t\t\tREP(i,n-1)if(pos[i]==pos[i+1]){\n\t\t\t\tdirL[i]=!dirL[i];\n\t\t\t\tdirL[i+1]=!dirL[i+1];\n\t\t\t}\n\t\t\t//remove\n\t\t\tREP(i,n)if(1<=pos[i] && pos[i]<l){\n\t\t\t\tndirL.push_back(dirL[i]);npos.push_back(pos[i]);nmap.push_back(map[i]);\n\t\t\t}\n\t\t\t//end\n\t\t\tif(npos.size()==0){\n\t\t\t\tREP(i,n)if(pos[i]==0)last=map[i];\n\t\t\t\tif(last==-1)REP(i,n)if(pos[i]==l)last=map[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//next\n\t\t\tdirL=ndirL;pos=npos;map=nmap;\n\t\t\tndirL.clear();npos.clear();nmap.clear();\n\t\t\tn=pos.size();\n\t\t}\n\t\tassert(last!=-1);\n\t\tcout << t <<\" \"<< last <<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define DEBUG(x) cerr << #x << \" = \" << x << endl\n\nconst int MAX_N = 50;\n// x, y\nint field[2 * (2 * MAX_N) + 1][2 * (2 * MAX_N) + 1];\n\nint X, Y;\n\ntypedef pair<int, int> P;\nvoid dfs(int x, int y) {\n    queue<P> Q;\n    Q.push(P(x, y));\n    while(!Q.empty()) {\n        P p = Q.front(); Q.pop();\n        for(int i = 0; i < 4; i++) {\n            int dx[4] = { 1, 0, -1, 0 };\n            int dy[4] = { 0, 1, 0, -1 };\n            int nx = p.first + dx[i];\n            int ny = p.second + dy[i];\n            if(0 <= nx && nx < X && 0 <= ny && ny < Y && field[nx][ny] == 0) {\n                field[nx][ny] = 1;\n                Q.push(P(nx, ny));\n            }\n        }\n    }\n}\n\nvoid show() {\n#if 0\n   cerr << '-' << endl;\n   for(int i = Y - 1; i >= 0; i--) {\n       for(int j = 0; j < X; j++) {\n           cerr << field[j][i];\n       }\n       cerr << '|' << endl;\n   }\n   cerr << '-' << endl;\n#endif\n}\n\nint main() {\n    while(true) {\n        int N; cin >> N;\n        if(N == 0) break;\n        vector<int> x1(N), y1(N), x2(N), y2(N);\n        vector<int> xs;\n        vector<int> ys;\n        for(int i = 0; i < N; i++) {\n            cin >> x1[i] >> y1[i] >> x2[i] >> y2[i];\n            xs.push_back(x1[i]);\n            xs.push_back(x2[i]);\n            ys.push_back(y1[i]);\n            ys.push_back(y2[i]);\n        }\n        sort(xs.begin(), xs.end());\n        sort(ys.begin(), ys.end());\n        xs.erase(unique(xs.begin(), xs.end()), xs.end());\n        ys.erase(unique(ys.begin(), ys.end()), ys.end());\n        for(int i = 0; i < N; i++) {\n            x1[i] = find(xs.begin(), xs.end(), x1[i]) - xs.begin();\n            y1[i] = find(ys.begin(), ys.end(), y1[i]) - ys.begin();\n            x2[i] = find(xs.begin(), xs.end(), x2[i]) - xs.begin();\n            y2[i] = find(ys.begin(), ys.end(), y2[i]) - ys.begin();\n        }\n        memset(field, 0, sizeof(field));\n        for(int i = 0; i < N; i++) {\n            for(int x = 2 * x1[i]; x <= 2 * x2[i]; x++) {\n                field[x + 1][2 * y1[i] + 1] = 1;\n                field[x + 1][2 * y2[i] + 1] = 1;\n            }\n            for(int y = 2 * y1[i]; y >= 2 * y2[i]; y--) {\n                field[2 * x1[i] + 1][y + 1] = 1;\n                field[2 * x2[i] + 1][y + 1] = 1;\n            }\n        }\n        X = 2 * (int)xs.size() + 1;\n        Y = 2 * (int)ys.size() + 1;\n        show();\n        int ans = 0;\n        for(int x = 0; x < X; x++) {\n            for(int y = 0; y < Y; y++) {\n                if(field[x][y] == 0) {\n                    ans++;\n                    field[x][y] = 1;\n                    dfs(x, y);\n                    show();\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <regex>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nint main()\n{\n\tint n, l;\n\twhile (cin >> n >> l,n)\n\t{\n\t\tvector<P> v;\n\t\tREP(i, n)\n\t\t{\n\t\t\tchar c; int p;\n\t\t\tcin >> c >> p;\n\t\t\tv.push_back(P(c == 'L' ? -1 : 1, p));\n\t\t}\n\t\tint res = n;\n\t\tint cnt = 0;\n\t\tP lastl,lastr;\n\t\twhile (res)\n\t\t{\n\t\t\tcnt++;\n\t\t\tmap<int, vector<int>> m;\n\t\t\tREP(i, v.size())\n\t\t\t{\n\t\t\t\tv[i].second += v[i].first;\n\t\t\t\tm[v[i].second].push_back(i);\n\t\t\t\tif (v[i].second == 0)\n\t\t\t\t{\n\t\t\t\t\tlastl = P(cnt, i);\n\t\t\t\t\tres--;\n\t\t\t\t}\n\t\t\t\tif (v[i].second == l)\n\t\t\t\t{\n\t\t\t\t\tlastr = P(cnt, i);\n\t\t\t\t\tres--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(i, l)\n\t\t\t{\n\t\t\t\tif (m[i].size() == 2)\n\t\t\t\t{\n\t\t\t\t\tswap(v[m[i][0]].first, v[m[i][1]].first);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << cnt << \" \" << (lastl.first >= lastr.first ? lastl.second + 1 : lastr.second + 1) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=300005,INF=1<<30;\n\nstruct point{\n    double pos;\n    int id;\n    int dir;\n    \n    bool operator<(const point &another) const\n    {\n        return pos<another.pos;\n    };\n};\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int N,L;cin>>N>>L;\n        if(N+L==0) break;\n        \n        vector<point> S(N);\n        \n        for(int i=0;i<N;i++){\n            char a;cin>>a;\n            if(a=='L') S[i].dir=0;\n            else S[i].dir=1;\n            \n            cin>>S[i].pos;\n            S[i].id=i;\n        }\n        \n        for(int t=1;;t++){\n            for(int i=0;i<N;i++){\n                if(S[i].dir==0) S[i].pos-=0.5;\n                else S[i].pos+=0.5;\n            }\n            \n            sort(all(S));\n            \n            for(int i=0;i<N-1;i++){\n                if(S[i].pos==S[i+1].pos){\n                    if(int(S[i].pos*2)%2==0){\n                        swap(S[i].id,S[i+1].id);\n                    }\n                }\n            }\n            \n            int cnt=0;\n            \n            for(int i=0;i<N;i++){\n                if(S[i].pos<=0.0||S[i].pos>=L) cnt++;\n            }\n            \n            if(cnt==N){\n                int ans=-1;\n                for(int i=N-1;i>=0;i--){\n                    if(S[i].pos==0.0) ans=S[i].id;\n                    if(S[i].pos==L) ans=S[i].id;\n                }\n                \n                cout<<t/2<<\" \"<<ans+1<<endl;\n                break;\n            }\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\n\nint main(){\n\tint n,l;\n\tchar d[100];\n\tint x[100];\n\twhile(cin>>n>>l,n|l){\n\t\tint count=0;\n\t\tint leave,t=0;\n\t\tfor(int i=0;i<n;i++)cin>>d[i]>>x[i];\n\t\twhile(count<n){\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==-1)continue;\n\t\t\t\tif(d[i]=='L')x[i]--;\n\t\t\t\telse x[i]++;\n\t\t\t}\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==-1)continue;\n\t\t\t\tfor(int j=i+1;j<n;j++){\n\t\t\t\t\tif(x[j]==-1)continue;\n\t\t\t\t\tif(x[i]==x[j])swap(d[i],d[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tleave=-1;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(x[i]==0||x[i]==l){\n\t\t\t\t\tcount++;\n\t\t\t\t\tx[i]=-1;\n\t\t\t\t\tif(leave==-1 || d[leave]=='R')leave=i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tt++;\n\t\t}\n\t\tcout<<t<<' '<<leave+1<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tfor(int n,l;cin>>n>>l && n|l;){\n\t\tvector<char> ds(n);\n\t\tvector<int> ps(n);\n\t\tfor(int i=0;i<n;i++) cin>>ds[i]>>ps[i],ps[i]*=2;\n\t\tint res=-1,last=-1;\n\t\tfor(int t=0;;t++){\n\t\t\tif(count(begin(ds),end(ds),'#')==n){\n\t\t\t\tres=t;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast=find_if(begin(ds),end(ds),[](char c){return c!='#';})-begin(ds);\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++) if(ds[i]!='#'){\n\t\t\t\tif(ds[i]=='L') ps[i]--;\n\t\t\t\tif(ds[i]=='R') ps[i]++;\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++) if(ds[i]!='#' && ps[i]==2*l) last=i,ds[i]='#';\n\t\t\tfor(int i=0;i<n;i++) if(ds[i]!='#' && ps[i]==0) last=i,ds[i]='#';\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\tfor(int j=i+1;j<n;j++)\n\t\t\t\t\tif(ds[i]!='#' && ds[j]!='#' && ps[i]==ps[j] && ps[i]%2==0)\n\t\t\t\t\t\tswap(ds[i],ds[j]);\n\t\t}\n\t\tcout<<res/2<<' '<<last+1<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\n#include <cmath>\n#include <cassert>\nusing namespace std;\n\nchar c[20];\nint p[20];\nbool alive[20];\nvector<int> now[110];\nvector<int> nxt[110];\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint n, l;\n\twhile(cin >> n >> l, n | l) {\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tcin >> c[i] >> p[i];\n\t\t\talive[i] = true;\n\t\t\tnow[p[i]].push_back(i);\n\t\t}\n\n\t\tint rem = n, last = -1, t = 0;\n\t\twhile(rem) {\n\t\t\tfor(int i = 1; i < l; i++) {\n\t\t\t\tif(now[i].size() == 2) {\n\t\t\t\t\tif(c[now[i][0]] == 'R') {\n\t\t\t\t\t\tc[now[i][0]] = 'L';\n\t\t\t\t\t\tc[now[i][1]] = 'R';\n\t\t\t\t\t\tnxt[i - 1].push_back(now[i][0]);\n\t\t\t\t\t\tnxt[i + 1].push_back(now[i][1]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tc[now[i][0]] = 'R';\n\t\t\t\t\t\tc[now[i][1]] = 'L';\n\t\t\t\t\t\tnxt[i + 1].push_back(now[i][0]);\n\t\t\t\t\t\tnxt[i - 1].push_back(now[i][1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(now[i].size() == 1) {\n\t\t\t\t\tif(c[now[i][0]] == 'R') {\n\t\t\t\t\t\tnxt[i + 1].push_back(now[i][0]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnxt[i - 1].push_back(now[i][0]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(nxt[l].size()) {\n\t\t\t\trem--;\n\t\t\t\tlast = nxt[l][0];\n\t\t\t\tnxt[l].clear();\n\t\t\t}\n\t\t\tif(nxt[0].size()) {\n\t\t\t\trem--;\n\t\t\t\tlast = nxt[0][0];\n\t\t\t\tnxt[0].clear();\n\t\t\t}\n\t\t\tfor(int i = 0; i <= l; i++) {\n\t\t\t\tnow[i] = nxt[i];\n\t\t\t\tnxt[i].clear();\n\t\t\t}\n\t\t\tt++;\n\t\t}\n\n\t\tcout << t << \" \" << last + 1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint ansTime;\nint dx[] = {-1, 1};\nint n, l;\nint d[22], p[22];\n\nvoid solve(){\n  int ansAnt = -1;\n  int rem = n;\n\n  while(rem > 0){\n    int nd[22], np[22];\n\n    for(int i = 0; i < n; i++){\n      if(p[i] == 0 || p[i] == l){\n        nd[i] = d[i];\n        np[i] = p[i];\n        continue;\n      }\n\n      bool flg = false;\n\n      for(int j = 0; j < n; j++){\n        if(i == j) continue;\n        if(p[i] == p[j]){\n          flg = true;\n          break;\n        }\n      }\n\n      nd[i] = flg ? !d[i] : d[i];\n      np[i] = p[i] + dx[nd[i]];\n\n      if(np[i] == 0 || np[i] == l){\n        rem--;\n        if(np[i] == l && ansAnt != -1) continue;\n        ansAnt = i + 1;\n      }\n    }\n\n    for(int i = 0; i < n; i++){\n      d[i] = nd[i];\n      p[i] = np[i];\n    }\n  }\n\n  cout << ansTime << \" \" << ansAnt << endl;\n}\n\nint main(){\n  while(cin >> n >> l){\n    if(n == 0) break;\n\n    ansTime = 0;\n\n    for(int i = 0; i < n; i++){\n      char dir;\n      cin >> dir >> p[i];\n\n      if(dir == 'L'){\n        d[i] = 0;\n        ansTime = max(ansTime, p[i]);\n      }\n      else{\n        d[i] = 1;\n        ansTime = max(ansTime, l - p[i]);\n      }\n    }\n\n    solve();\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nint main() {\n\tint N, L;\n\t\n\twhile (cin >> N >> L, N != 0) {\n\t\tvector< char > d(N);\n\t\tvector< int > p(N);\n\t\tfor_(i,0,N) cin >> d[i] >> p[i];\n\t\t\n\t\tint step = 0;\n\t\tvector< int > leave(N, -1);\n\t\tbool end = false;\n\t\t\n\t\twhile (!end) {\n\t\t\t++step;\n\t\t\t\n\t\t\tfor_(i,0,N) {\n\t\t\t\tif (1 <= p[i] && p[i] < L) {\n\t\t\t\t\tp[i] += (d[i] == 'L' ? -1 : 1);\n\t\t\t\t\tif (p[i] < 1 || p[i] >= L) leave[i] = step;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor_(i,0,N) for_(j,0,N) {\n\t\t\t\tif (leave[i] > 0 || leave[j] > 0 || i == j) continue;\n\t\t\t\tif (p[i] == p[j]) d[i] = (d[i] == 'L' ? 'R' : 'L');\n\t\t\t}\n\t\t\t\n\t\t\tend = true;\n\t\t\tfor_(i,0,N) end &= (leave[i] > 0);\n\t\t}\n\t\t\n\t\tint ant = -1;\n\t\tfor_(i,0,N) {\n\t\t\tif (leave[i] == step) {\n\t\t\t\tif (ant > 0) {\n\t\t\t\t\tif (d[i] == 'L') ant = i + 1;\n\t\t\t\t} else {\n\t\t\t\t\tant = i + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << step << \" \" << ant << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tint n, d;\n\n\twhile (scanf(\"%d %d\", &n, &d) && n){\n\t\tchar dir[100][2], pos[100];\n\n\t\tint ltime = 0;\n\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tscanf(\"%s %d\", dir[i], pos + i);\n\t\t\tltime = max(ltime, dir[i][0] == 'L' ? pos[i] : d - pos[i]);\n\t\t}\n\n\t\tint occ[128];\n\t\tfor (int i = 0; i < ltime; i++){\n\t\t\tfor (int j = 0; j < d; j++) occ[j] = -1;\n\t\t\tfor (int j = 0; j < n; j++){\n\t\t\t\tdir[j][0] == 'L' ? pos[j]-- : pos[j]++;\n\t\t\t\tif (0 < pos[j] && pos[j] < d){\n\t\t\t\t\tif (~occ[pos[j]]){\n\t\t\t\t\t\tdir[occ[pos[j]]][0] ^= ('L' ^ 'R');\n\t\t\t\t\t\tdir[j][0] ^= ('L' ^ 'R');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tocc[pos[j]] = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint lant = 0;\n\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tif (pos[i] == 0) lant = i + 1;\n\t\t\tif (pos[i] == d && !lant) lant = i + 1;\n\t\t}\n\n\t\tprintf(\"%d %d\\n\", ltime, lant);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;char T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;main(){while(1){M=0;memset(y,0,999);cin>>b>>l;if(!l){break;}for(i=1;i<=b;i++){cin>>T>>x[i];if(T=='L'){d[i]=0;M=max(M,x[i]);}else{d[i]=1;M=max(M,l-x[i]);}}N=0;for(i=1;i<M+2;i++){memset(z,0,sizeof(z));for(j=b;j>0;j--) {if(!y[j]) {if(!d[j]){x[j]--;}else{x[j]++;}if(x[j]<0||x[j]>l){y[j]=1;}z[x[j]]++;if(M<i){if(N){if(x[j]<0){N=j;}}else{N=j;}}}}for(j=b;j>0;j--){if(z[x[j]]>1){if(d[j]){d[j]=0;}else{d[j]=1;}}}}printf(\"%d %d\\n\",M,N);}}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 100010;\n\nint main(){\n    int n, L;\n    while(scanf(\"%d%d\", &n, &L) && n){\n        int pos[n], dir[n];\n        rep(i, n){\n            char c;\n            scanf(\" %c%d\", &c, &pos[i]);\n            pos[i] *= 2;\n            dir[i] = (c == 'R' ? 1 : -1);\n        }\n        auto in = [&](int x){return x > 0 && x < 2*L;};\n\n        int ans = 0, last;\n        bool flag = true;\n        for(int t=1; flag; ++t){\n            flag = false;\n            int last_l = -1, last_r = -1;\n            rep(i, n)if(in(pos[i])){\n                pos[i] += dir[i];\n                if(in(pos[i])) flag = true;\n                else{\n                    chmax(ans, t);\n                    (pos[i] == 0 ? last_l : last_r) = i;\n                }\n            }\n\n            rep(i, n)if(in(pos[i]))For(j, i+1, n)if(pos[i] == pos[j]){\n                if(pos[i] % 2 == 0){\n                    dir[i] *= -1;\n                    dir[j] *= -1;\n                }\n            }\n\n            if(last_l >= 0) last = last_l;\n            else if(last_r >= 0) last = last_r;\n        }\n        printf(\"%d %d\\n\", ans/2, last+1);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\n\n#define REP(i,a,b) for(int i=int(a);i<int(b);i++)\n\nusing namespace std;\n\ntypedef long long int lli;\ntypedef pair<int,int> pii;\n\nint main () {\n    int n, l;\n    while (cin >> n >> l, n + l) {\n        vector<vector<pii>> v(l + 1);\n        REP (i, 0, n) {\n            char d;\n            int p;\n            cin >> d >> p;\n            v[p].push_back({(d == 'R'), i + 1});\n        }\n        int cnt = n;\n        int ans = -1;\n        int tm = -1;\n        REP (i, 0, l + 1) {\n            if (cnt == 0) break;\n            vector<vector<pii>> vv(l + 1);\n            REP (j, 0, v.size()) {\n                REP (k, 0, v[j].size()) {\n                    if (v[j][k].first == 0) {\n                        vv[j - 1].push_back(v[j][k]);\n                    } else {\n                        vv[j + 1].push_back(v[j][k]);\n                    }\n                }\n            }\n            REP (j, 0, vv.size()) {\n                if (vv[j].size() >= 2) {\n                    REP (k, 0, vv[j].size()) {\n                        vv[j][k].first = 1 - vv[j][k].first;\n                    }\n                }\n            }\n            if (vv[vv.size() - 1].size() > 0) {\n                ans = vv[vv.size() - 1][0].second;\n                tm = i + 1;\n                vv[vv.size() - 1].clear();\n                cnt--;\n            }\n            if (vv[0].size() > 0) {\n                ans = vv[0][0].second;\n                tm = i + 1;\n                vv[0].clear();\n                cnt--;\n            }\n            v = vv;\n        }\n        cout << tm << ' ' << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\n\n#define each(i,a) for (auto&& i : a)\n#define FOR(i,a,b) for (ll i=(a),__last_##i=(b);i<__last_##i;i++)\n#define RFOR(i,a,b) for (ll i=(b)-1,__last_##i=(a);i>=__last_##i;i--)\n#define REP(i,n) FOR(i,0,n)\n#define RREP(i,n) RFOR(i,0,n)\n#define __GET_MACRO3(_1, _2, _3, NAME, ...) NAME\n#define rep(...) __GET_MACRO3(__VA_ARGS__, FOR, REP)(__VA_ARGS__)\n#define rrep(...) __GET_MACRO3(__VA_ARGS__, RFOR, RREP)(__VA_ARGS__)\n#define pb push_back\n#define all(a) (a).begin(),(a).end()\n#define chmin(x,v) x = min(x, v)\n#define chmax(x,v) x = max(x, v)\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n    each(x,vec) is >> x;\n    return is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector<T>& vec) {\n    rep(i,vec.size()) {\n        if (i) os << \" \";\n        os << vec[i];\n    }\n    return os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector< vector<T> >& vec) {\n    rep(i,vec.size()) {\n        if (i) os << endl;\n        os << vec[i];\n    }\n    return os;\n}\nstruct Ant {\n    ll x, dir, id;\n};\nbool operator<(const Ant& a1, const Ant& a2) {\n    return a1.x < a2.x;\n}\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    ll n, L;\n    while (cin >> n >> L, n || L) {\n        vector<Ant> ants;\n        rep(i, n) {\n            string d; ll x; cin >> d >> x;\n            ants.pb(Ant{x, (d == \"L\" ? -1 : 1), i});\n        }\n        sort(all(ants));\n        rep(t, 2*(L+1)) {\n            each(a, ants) {\n                // cout << \"(\" << a.x << \", \" << a.dir << \", \" << a.id << \")\" << \" \";\n                a.x += a.dir;\n            }\n            // cout << endl;\n            sort(all(ants));\n            rep(i, 1, ants.size()) {\n                if (ants[i-1].x == ants[i].x) {\n                    ants[i-1].dir *= -1;\n                    ants[i].dir *= -1;\n                }\n            }\n            vector<Ant> nants;\n            each(a, ants) {\n                if (0 <= a.x && a.x <= L) {\n                    nants.pb(a);\n                }\n            }\n            if (nants.size() == 0) {\n                cout << t << \" \" << ants[0].id+1 << endl;\n                break;\n            }\n            ants = nants;\n        }\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n, l; cin >> n >> l && (n|l); ) {\n    l = l * 2 + 1;\n    vector<int> p(n), v(n), f(n);\n    for(int i = 0; i < n; ++i) {\n      char d;\n      cin >> d >> p[i];\n      p[i] *= 2;\n      v[i] = (d == 'L') ? -1 : 1;\n    }\n    int a, b;\n    for(int t = 1, k = 0; k < n; ++t) {\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        p[i] += v[i];\n      }\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        for(int j = i+1; j < n; ++j) {\n          if(f[j]) continue;\n          if(p[i] == p[j]) {\n            v[i] *= -1; v[j] *= -1;\n          }\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == l) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n      cout << a << \" \" << b << endl;\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == 0) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n    }\n    cout << a << \" \" << b << endl;\n    return 0;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; ll w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-9;\n\nint hoge(vector< vector<int> >& a, int i, int j) {\n\treturn i < a[j].size() ? a[j][i] : 0;\n}\n\nint main() {\n\tfor (;;) {\n\t\tint n, l; cin >> n >> l;\n\t\tif (n == 0) break;\n\t\tvector<int> x(n), dx(n);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tchar c; cin >> c >> x[i];\n\t\t\tdx[i] = (c == 'L' ? -1 : 1);\n\t\t}\n\t\tint t;\n\t\tfor (t = 1; ; t++) {\n\t\t\tvector<int> a(l + 1);\n\t\t\tbool flag = false;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tx[i] += dx[i];\n\t\t\t\tif (x[i] > 0 && x[i] < l) {\n\t\t\t\t\tflag = true;\n\t\t\t\t\ta[x[i]]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!flag) break;\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tif (x[i] > 0 && x[i] < l && a[x[i]] >= 2) dx[i] *= -1;\n\t\t}\n\t\tcout << t << ' ';\n\t\tint _i = -1;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tif (x[i] == 0) _i = i;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tif (x[i] == l && _i == -1) _i = i;\n\t\tcout << _i + 1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// compile in C++11. use -std=c++11.\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <valarray>\n#include <map>\n#include <set>\n#include <list>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <complex>\n#include <string>\n#include <sstream>\n\n#include <cstdio>\n#include <cstdlib>\n#include <cctype>\n#include <cstring>\n\n// these require C++11\n#include <unordered_set>\n#include <unordered_map>\n#include <random>\n\nusing namespace std;\n\n#define int long long\n\n#define all(c) c.begin(), c.end()\n#define repeat(i, n) for (int i = 0; i < static_cast<int>(n); i++)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define dump(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define dump(x) \n#endif\n\n\nstruct Ant{\n    int number;\n    bool to_left;\n    int position;\n    Ant(int _number,bool _to_left,int _position)\n        : number(_number),to_left(_to_left),position(_position){}\n};\n\n// time,who\npair<int,int> solve(int l,vector<Ant> ants){\n    l *= 2;\n    for(Ant& a : ants){\n        a.position *= 2;\n    }\n    // left_out = 0\n    // right_out = 2*l\n    int time = 0;\n    for(const Ant& a : ants){\n        if(a.to_left){\n            time = max(time,a.position/2);\n        }else{\n            time = max(time,(l-a.position)/2);\n        }\n    }\n    for(int t=0;t<time*2;t++){\n        for(Ant& a : ants){\n            if(a.to_left){\n                a.position--;\n            }else{\n                a.position++;\n            }\n        }\n        for(int i=0;i<ants.size();i++){\n            for(int j=i+1;j<ants.size();j++){\n                if(ants[i].position == ants[j].position and ants[i].position % 2 == 0){\n                    ants[i].to_left = not ants[i].to_left;\n                    ants[j].to_left = not ants[j].to_left;\n                }\n            }\n        }\n    }\n    int number = -1;\n    for(const Ant& a : ants){\n        if(a.position == 0){\n            number = a.number;\n        }\n        if(a.position == l and number == -1){\n            number = a.number;\n        }\n    }\n    return make_pair(time,number);\n}\n\nsigned main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    while(true){\n        int n,l;\n        cin >> n >> l;\n        if(n == 0 and l == 0) return 0;\n        vector<Ant> ants;\n        for(int i=0;i<n;i++){\n            char d;\n            int p;\n            cin >> d >> p;\n            ants.push_back(Ant(i+1,d=='L',p));\n        }\n        pair<int,int> p = solve(l,ants);\n        cout << p.first << \" \" << p.second << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n/*\n??????????????????????????£??????????????????????????????????????????????????£????????????????????????????????????????????????????????????\n??????????????????????????????????????????????????\\????????????????????????????§???????????????¨??????????????????1cm/s???????????§?§?????????????\n???????????????????????£?????¨????????????????????????????????????????????¨?????????????????????????????????????????????????????????????´°?????????????????????\n?????????????????????????????¨?????§???????????????????????????????´°???????????§????????£?????¨?????????????????????????????????????????????????§??????????\n???????????????????????????????????????????????£?????°???????????¨?????????????????????????????????????????????\n\n???????????????????????´??°????????????(cm)??§????????????????????????????´°?????????????????????????????£????????´??°???????????¢????????????\n?????????????´°?????????????????§???????????????????????????????????????????????????????????????????????????????????????????´°???????????§???????§?????????????\n??°???????????????????????\\??£????????????????????????????????¨??????????????????????????????????????????????????¨???????????????????????????????????????????????¨?????§?????????\n????????????????????????????????????????????????????????????????????????????????¨????????????????????°????????????????????¨??????\n\n???B.1???6cm????????????????????§???????????????2s?????§???????????????????????????????????????????????§?????????\n????????????1?????????????????¨?????????????????????3?????????????´°??????????????????????§??????????????????????cm???2cm???5cm???????????????????????????????????????\n0.5s??????????????¨???????????????????????§??§???????????????????????????????????????????????????????????????2s??????????????¨??????????´°???????????§??§??????????????????\n???????????????\n\n\nInput\nn l\nd1 p1\nd2 p2\n...\ndn pn\n\n1?????????????????°n(1<=n<=20)???????????????????????????l(n+1<=l<=100)\n?¶????n???????????????i?????????d(1<=i<=n)????????????????????????p(1<=i<=n)\n\n????????????p????????????????????????????????´??°???????????????????????????\n??????????????????????????????????????????????????§?????\\?????¨?????????\n\n??????????????????????????????n = 0 && l == 0\n\n\nOutput\n??????????????????????????????????????¨??????????????????????????????????????§??????????????????????????????????????£?????????\n??????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????????????????????????????????????´???????????´??????????????????????????????????????????????????????\n\n*/\n#define ll long long\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tll n, l;\n\twhile (cin >> n >> l, n | l ) {\n\t\tvector<vector<pair<char, int>>> tunnel(l+1);\n\t\tfor (int i = 1; i <= n;i++) {\n\t\t\tchar d; int p; cin >> d >> p;\n\t\t\ttunnel[p].push_back({ d,i });\n\t\t}\n\t\tint sec = 0;\n\t\tint ant = n;\n\t\twhile (ant != 0) {\n\t\t\tint la = -1;\n\t\t\tint s = (1 << 30);\n\n\t      /*cout << sec << \" wwww\" << endl;\n\t\t\tfor (int i = 1; i < l;i++) {\n\t\t\t\tcout << i << \": \";\n\t\t\t\tfor (int j = 0; j < tunnel[i].size();j++) {\n\t\t\t\t\tcout << tunnel[i][j].first << \" / \" << tunnel[i][j].second << \" : \";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}*/\n\n\t\t\tfor (int i = 1; i <= l;i++) {\n\t\t\t\tif (tunnel[i].size() == 0) continue;\n\t\t\t\tif (tunnel[i].size() == 1) {\n\t\t\t\t\tif (tunnel[i][0].first == 'L') {\n\t\t\t\t\t\tif (la == -1) continue;\n\t\t\t\t\t\tif ((i - la) % 2 == 1)continue;\n\t\t\t\t\t\ts = min(s, (i - la) / 2);\n\t\t\t\t\t\tla = -1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tla = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // L,R ????????????\n\t\t\t\t\tpair<char, int> lant, rant;\n\t\t\t\t\tfor (int j = 0; j < 2;j++) {\n\t\t\t\t\t\tif (tunnel[i][j].first == 'L') lant = tunnel[i][j];\n\t\t\t\t\t\telse rant = tunnel[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tif (la == -1) continue;\n\t\t\t\t\tif ((i - la) % 2 == 1) continue;\n\t\t\t\t\ts = min(s, (i - la) / 2);\n\t\t\t\t\tla = i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//cout << sec << \" haha\" << endl;\n\t\t\tvector<vector<pair<char, int>>> temp(l + 1);\n\t\t\tbool f = false;\n\t\t\tint ans = sec;\n\t\t\tint pos = -1;\n\n\t\t\tfor (int i = 1;i < l;i++) {\n\t\t\t\tif (tunnel[i].size() == 0)continue;\n\t\t\t\tint Size = tunnel[i].size();\n\t\t\t\t//cout << i << \" \" << Size << endl;\n\t\t\t\tfor (int j = 0; j < Size;j++) {\n\t\t\t\t\tif (tunnel[i][j].first == 'L') {\n\t\t\t\t\t\tif (s >= i) {\n\t\t\t\t\t\t\tant--;\n\t\t\t\t\t\t\tif (sec + i >= ans) {\n\t\t\t\t\t\t\t\tans = sec + i;\n\t\t\t\t\t\t\t\tpos = tunnel[i][j].second;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ant == 0 || (ant == 1 && Size == 2)) {\n\t\t\t\t\t\t\t\tant = 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (!f) f = true;\n\t\t\t\t\t\t\ttemp[i - s].push_back(tunnel[i][j]);\n\t\t\t\t\t\t\tif (temp[i - s].size() != 1) {\n\t\t\t\t\t\t\t\t//cout << tunnel[i - sec].size << endl;\n\t\t\t\t\t\t\t\tfor (int j = 0; j < 2;j++) {\n\t\t\t\t\t\t\t\t\tif (temp[i - s][j].first == 'L') temp[i - s][j].first = 'R';\n\t\t\t\t\t\t\t\t\telse temp[i - s][j].first = 'L';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (s >= (l - i)) {\n\t\t\t\t\t\t\tant--;\n\n\t\t\t\t\t\t\tif (sec + (l - i) > ans) {\n\t\t\t\t\t\t\t\tans = sec + (l - i);\n\t\t\t\t\t\t\t\tpos = tunnel[i][j].second;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ant == 0) { \n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (!f)f = true;\n\t\t\t\t\t\t\ttemp[s + i].push_back(tunnel[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!f) {\n\t\t\t\tcout << ans << \" \" << pos << endl;\n\t\t\t}\n\n\t\t\ttunnel = temp;\n\t\t\tsec += s;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nusing Ant = tuple<int, int, int>;\n\nint forward(int n, int l, const vector<Ant>& ants, vector<int>& meet) {\n    int dt = l;\n    rep(i, n) {\n        int p, d, k1; tie(p, d, k1) = ants[i];\n        if (meet[i] != -1) continue;\n        if (d == 1) {\n            int j = i + 1;\n            for (; j < n; ++j) {\n                int q, b, k2; tie(q, b, k2) = ants[j];\n                if (b == 1 || (q - p) & 1) continue;\n                meet[i] = j; meet[j] = i;\n                chmin(dt, (q - p) / 2);\n                break;\n            }\n            if (j == n) chmin(dt, l - p);\n        }\n        else {\n            int j = i - 1;\n            for (; j >= 0; --j) {\n                int q, b, k2; tie(q, b, k2) = ants[j];\n                if (b == -1 || (p - q) & 1) continue;\n                meet[i] = j; meet[j] = i;\n                chmin(dt, (p - q) / 2);\n                break;\n            }\n            if (j == -1) chmin(dt, p);\n        }\n    }\n    return dt;\n}\n\nstring solve(int n, int l, vector<Ant>& ants) {\n    int t = 0, last = -1;\n    for (; n; n = int(ants.size())) {\n        sort(all(ants));\n        vector<int> meet(n, -1);\n        int dt = forward(n, l, ants, meet);\n        bool leave_left = false;\n        vector<Ant> nxt;\n        rep(i, n) {\n            int p, d, k1; tie(p, d, k1) = ants[i];\n            int np = p + dt * d;\n            if (d == 1) {\n                if (np == l) { if (!leave_left) last = k1; }\n                else if (meet[i] == -1) nxt.emplace_back(np, d, k1);\n                else {\n                    int q, b, k2; tie(q, b, k2) = ants[meet[i]];\n                    nxt.emplace_back(np, q - p > dt * 2 ? d : -d, k1);\n                }\n            }\n            else {\n                if (np == 0) last = k1, leave_left = true;\n                else if (meet[i] == -1) nxt.emplace_back(np, d, k1);\n                else {\n                    int q, b, k2; tie(q, b, k2) = ants[meet[i]];\n                    nxt.emplace_back(np, p - q > dt * 2 ? d : -d, k1);\n                }\n            }\n        }\n        ants.swap(nxt);\n        t += dt;\n    }\n    stringstream ss;\n    ss << t << ' ' << last;\n    return ss.str();\n}\n\nint main() {\n    for (int n, l; cin >> n >> l, n | l;) {\n        vector<Ant> ants;\n        rep(i, n) {\n            char d; int p;\n            cin >> d >> p;\n            ants.emplace_back(p, d == 'L' ? -1 : 1, i + 1);\n        }\n        cout << solve(n, l, ants) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\ntypedef pair<int, int> P;\ntypedef pair<int, P> PP;\ntypedef vector<PP> V;\n\nclass Ant {\n    public:\n        char d;\n        int p;\n};\n\nP compute(int n, int l, Ant ants[]) {\n    int index[20];\n    P residual_time[20];\n    V exchanges;\n    for (int i=0; i<n; i++) {\n        index[i] = i;\n        if (ants[i].d == 'R') {\n            residual_time[i] = P(l-ants[i].p, i);\n        }\n        else {\n            residual_time[i] = P(ants[i].p, i);\n        }\n    }\n    sort(residual_time, residual_time+n);\n    for (int i=0; i<n; i++) {\n        for (int j=i+1; j<n; j++) {\n            int delta = ants[j].p-ants[i].p;\n            if (ants[i].d != 'R' || ants[j].d != 'L') {\n                continue;\n            }\n            if ((ants[i].p+ants[j].p)%2 == 1) {\n                continue;\n            }\n            exchanges.push_back(PP(delta/2, P(i, j)));\n        }\n    }\n    sort(exchanges.begin(), exchanges.end());\n    for (int k=0; k<(int)exchanges.size(); k++) {\n        int i = exchanges[k].second.first;\n        int j = exchanges[k].second.second;\n        int tmp = index[i];\n        index[i] = index[j];\n        index[j] = tmp;\n    }\n    return P(residual_time[n-1].first, index[residual_time[n-1].second]);\n}\n\nint main() {\n    int n, l;\n    Ant ants[20];\n    P answer;\n    while (true) {\n        cin >> n >> l;\n        if (n == 0) {\n            return 0;\n        }\n        for (int i=0; i<n; i++) {\n            cin >> ants[i].d >> ants[i].p;\n        }\n        answer = compute(n, l, ants);\n        cout << answer.first << ' ' << answer.second+1 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  int n, l;\n  while(cin >> n >> l, n || l){\n    l *= 2;\n    int ant[20];\n    for(int i = 0; i < n; i++){\n      char d; int p;\n      cin >> d >> p;\n      if(d == 'R') ant[i] = p*2;\n      else ant[i] = -p*2;\n    }\n    int m = n, out = -1; \n    for(int t = 0; ; t++){\n      //cout << \"TIME: \" << t << endl;\n      if(m == 0){\n\tcout << t/2 << \" \" << out + 1 << endl;\n\tbreak;\n      } else {\n\tint now = -1;\n\tint tunnel[201];\n\tmemset(tunnel, -1, sizeof(tunnel));\n\tfor(int i = 0; i < n; i++){ \n\t  if(ant[i] == 114514) continue;\n\t  //cout << \"ANT: \" << i+1 << \" \" << ant[i] << endl;\n\t  ant[i] += 1;\n\t  if(ant[i] == 0 || ant[i] == l){\n\t    ant[i] = 114514;\n\t    m--;\n\t    if(now == -1 || ant[i] == 0) now = i;\n\t  } else {\n\t    if(tunnel[abs(ant[i])] == -1) tunnel[abs(ant[i])] = i;\n\t    else if(abs(ant[i])%2 == 0) ant[i] *= -1, ant[tunnel[abs(ant[i])]] *= -1;\n\t  }\n\t}\n\tout = now;\n      }\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\n\ntemplate<typename T>\nvoid printv(const vector<T>& s) {\n  for(int i=0;i<(int)(s.size());++i) {\n    cout << s[i];\n    if(i == (int)(s.size())-1) cout << endl;\n    else cout << \" \";\n  }\n}\n\nbool noElm(const vector<vector<pair<int, int>>> &v) {\n  for(int i=0;i<(int)(v.size());++i) {\n    if((int)(v[i].size()) > 0) {\n      return false;\n    }\n  }\n  return true;\n}\n\nint main () {\n  cin.tie(0);\n  cout << fixed << setprecision(10);\n\n  while(1) {\n    int n, l; cin >> n >> l;\n    if(n == 0 && l == 0) break;\n    vector<vector<pair<int, int>>> v(l+1);\n    for(int i=1;i<=n;++i) {\n      char d; int p; cin >> d >> p;\n      if(d == 'R') {\n        v[p].push_back(make_pair(i, 1));\n      } else {\n        v[p].push_back(make_pair(i, -1));\n      }\n    }\n\n    int ex = -1;\n    int cnt = 0;\n    while(!noElm(v)) {\n      cnt++;\n      vector<vector<pair<int, int>>> newv(l+1);\n      bool nowex = false;\n      for(int i=1;i<l;++i) {\n        if((int)(v[i].size()) == 2) {\n          v[i][0].second = -v[i][0].second;\n          v[i][1].second = -v[i][1].second;\n          newv[i+v[i][0].second].push_back(v[i][0]);\n          newv[i+v[i][1].second].push_back(v[i][1]);\n        } else if((int)(v[i].size()) == 1) {\n          newv[i+v[i][0].second].push_back(v[i][0]);\n        }\n        if(i == 1 && (int)(newv[0].size() == 1)) {\n          ex = newv[0][0].first;\n          nowex = true;\n        } else if(!nowex && i == l-1 && (int)(newv[l].size()) == 1) {\n          ex = newv[l][0].first;\n        }\n      }\n      copy(newv.begin(), newv.end(), v.begin());\n\n/*       for(int i=0;i<(int)(v.size());++i) {\n        for(int j=0;j<(int)(v[i].size());++j) {\n          cout << v[i][j].first << \" \";\n        }\n        cout << endl;\n      } */\n    }\n    cout << cnt-1 << \" \" << ex << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint main(void)\n{\n  for(;;){\n    int n,l;\n    cin >> n >> l;\n    if(!n&&!l) return 0;\n    int ant[128][2];\n    // pos,(l=0,r=1);\n    REP(i,128) REP(j,2) ant[i][j]=0;\n    REP(i,n){\n      string lr;\n      int pos;\n      cin >> lr >> pos;\n      if(lr==\"L\") ant[pos][0]=i+1;\n      else ant[pos][1]=i+1;\n    }\n    int anst,ansi;\n    REP(time,128){\n      if(ant[l][1]){\n\tanst=time;\n\tansi=ant[l][1];\n      }\n      if(ant[0][0]){\n\tanst=time;\n\tansi=ant[0][0];\n      }\n      for(int i=0;i<l;i++) ant[i][0]=ant[i+1][0];\n      for(int i=l;i>0;i--) ant[i][1]=ant[i-1][1];\n      ant[l][0]=0;\n      ant[0][1]=0;\n      REP(i,l) if(ant[i][0]&&ant[i][1]){\n\tint a,b;\n\ta=ant[i][0];\n\tb=ant[i][1];\n\tant[i][0]=b;\n\tant[i][1]=a;\n      }\n    }\n    cout << anst << ' ' << ansi << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint N, L;\nint Left[101], Right[101];\n\nbool Check()\n{\n  for(int i = 0; i <= L; i++) {\n    if(Left[i] != 0) return(true);\n    if(Right[i] != 0) return(true);\n  }\n  return(false);\n}\n\nint main()\n{\n  while(cin >> N >> L, N) {\n    memset(Left, 0, sizeof(Left));\n    memset(Right, 0, sizeof(Right));\n    for(int i = 0; i < N; i++) {\n      char c;\n      int d;\n      cin >> c >> d;\n      if(c == 'L') Left[d] = i + 1;\n      else Right[d] = i + 1;\n    }\n    int last, time;\n    for(time = 0; Check(); ++time) {\n      for(int i = L; i > 0; i--) {\n        Right[i] = Right[i - 1];\n      }\n      for(int i = 0; i < L; i++) {\n        Left[i] = Left[i + 1];\n      }\n      if(Right[L] > 0) last = Right[L];\n      if(Left[0] > 0) last = Left[0];\n      for(int i = 1; i < L; i++) {\n        if(Left[i] > 0 && Right[i] > 0) swap(Left[i], Right[i]);\n      }\n    }\n    cout << --time << \" \" << last << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define mk make_pair\n#define f first\nusing namespace std;\nint main(){\n  int n,m,w;\n  while(cin>>n>>m,n){\n    int pp=0;string q;\n    vector<pair<pair<int,string>,int> >p;\n    for(int i=0;i<n;i++){\n      cin>>q>>w;\n      p.push_back(mk(mk(w,q),i+1));\n    }\n    //p.erase(p.begin());\n    for(int i=0;i<10000000;i++){//if(i==4){cout<<p.size();break;}\n      for(int j=0;j<p.size();j++){\n     \t if(p[j].f.s==\"R\")p[j].f.f+=1;\n       else p[j].f.f-=1;\n    \t}\n      sort(p.begin(),p.end());\n      int e=1;\n      for(int j=0;j<p.size();j++)\n        if(p[j].f.f<=0||p[j].f.f>=m){//cout<<p.size();\n          if(e)pp=p[j].s,e=0;//cout<<pp<<endl;\n          p.erase(p.begin()+j);j--;\n        }\n      if(p.size())for(int j=0;j<p.size()-1;j++)\n        if(p[j].f.f==p[j+1].f.f){\n\t        if(p[j].f.s==\"R\")p[j].f.s=\"L\";\n\t        else p[j].f.s=\"R\";\n\t        if(p[j+1].f.s==\"R\")p[j+1].f.s=\"L\";\n\t        else p[j+1].f.s=\"R\";\n\t      }\n      if(p.size()<=0){\n\t      cout<<i+1<<' '<<pp<<endl;\n\t      break;\n      }\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nconst int MAX_N = 23;\n\nstruct Ant {\n    int  num, p;\n    char d;\n    Ant() { p = -1; }\n};\n\nint n, l;\nAnt even[MAX_N], odd[MAX_N];\nint num_odd, num_even;\n\nvoid Input()\n{\n    int  p;\n    char d;\n\n    num_odd = num_even = 0;\n    for (int i = 0; i < n; i++) {\n        cin >> d >> p;\n\n        if (p % 2 == 0) {       // 偶数番目のあり\n            if (d == 'L')\n                even[num_even].p = p;\n            else\n                even[num_even].p = l - p;\n\n            even[num_even].num = i + 1;\n            even[num_even++].d = d;\n        }\n        else {                  // 奇数番目のあり\n            if (d == 'L')\n                odd[num_odd].p = p;\n            else\n                odd[num_odd].p = l - p;\n\n            odd[num_odd].num = i + 1;\n            odd[num_odd++].d = d;\n        }\n    }\n}\n\nAnt Solve(const Ant ant[MAX_N], const int &num)\n{\n    Ant res;                    // antにおける最後に落ちるあり\n\n    if (num <= 0)\n        return res;\n\n    int left_num = 0, right_num = 0; // 左向きの数，右向きの数\n    Ant right, left;            // 一番左にいる右向きのあり，一番右にいる左向きのあり\n\n    // 左向き，右向きの数のカウント\n    for (int i = 0; i < num; i++) {\n        if (ant[i].d == 'L')\n            left_num++;\n        else\n            right_num++;\n    }\n\n    // 一番左にいる右向きのありの探索\n    for (int i = 0; i < num; i++)\n        if (ant[i].d == 'R') {\n            right = ant[i];\n            break;\n        }\n    // １番右にいる左向きのありの探索\n    for (int i = num - 1; i >= 0; i--)\n        if (ant[i].d == 'L') {\n            left = ant[i];\n            break;\n        }\n\n    // rightとleftの比較\n    if (left.p >= right.p) {\n        res.p   = left.p;\n        res.num = ant[left_num - 1].num;\n        res.d   = 'L';\n    }\n    else {\n        res.p   = right.p;\n        res.num = ant[num - right_num].num;\n        res.d   = 'R';\n    }\n\n    return res;\n}\n\nint main()\n{\n    while (cin >> n >> l, n || l) {\n        Input();\n        Ant ant_e = Solve(even, num_even);\n        Ant ant_o = Solve(odd, num_odd);\n\n        if (ant_e.p == ant_o.p) {\n            if (ant_e.d == 'L')\n                cout << ant_e.p << \" \" << ant_e.num << endl;\n            else\n                cout << ant_o.p << \" \" << ant_o.num << endl;\n        }\n        else if (ant_e.p > ant_o.p)\n            cout << ant_e.p << \" \" << ant_e.num << endl;\n        else\n            cout << ant_o.p << \" \" << ant_o.num << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nchar T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;\nmain(){\nwhile(1){\nM=0;\nmemset(y,0,999);\ncin>>b>>l;if(!l){break;}\nfor(i=1;i<=b;i++){\ncin>>T>>x[i];\nif(T=='L'){d[i]=0;M=max(M,x[i]);}\nelse{d[i]=1;M=max(M,l-x[i]);}\n}\nN=0;\nfor(i=1;i<M+2;i++){\nmemset(z,0,sizeof(z));\nfor(j=b;j>0;j--) {\nif(!y[j]) {\nif(!d[j]){\nx[j]--;\n}\nelse{\nx[j]++;\n}\nif(x[j]<0||x[j]>l){\ny[j]=1;\n}\nz[x[j]]++;\nif(M+1==i){\nif(N){\nif(x[j]<0){N=j;}\n}\nelse{\nN=j;\n}\n}\n}\n}\nfor(j=b;j>0;j--){\nif(z[x[j]]>1){\nif(d[j]){d[j]=0;}\nelse{d[j]=1;}\n}\n}\n}\nprintf(\"%d %d\\n\",M,N);\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N=1<<5;\n\nchar s[N];\nbool vis[N];\nint n,l,p[N],d[N];\n\nint main()\n{\n\tfor(;cin>>n>>l,n;)\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tscanf(\"%s%d\",s,p+i);\n\t\t\tif(s[0]=='L') d[i]=-1; else d[i]=1;\n\t\t}\n\n\t\tmemset(vis,0,sizeof(vis));\n\t\tfor(int i=1,cnt=0;;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tif(!vis[j]) p[j]+=d[j];\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=j+1;k<=n;k++)\n\t\t\t\t\tif(p[j]==p[k]) d[j]=-d[j],d[k]=-d[k];\n\n\t\t\tint u=-1;\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tif(!vis[j] && p[j]==l)\n\t\t\t\t\tvis[j]=1,cnt++,u=j;\n\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tif(!vis[j] && !p[j])\n\t\t\t\t\tvis[j]=1,cnt++,u=j;\n\t\t\tif(cnt==n)\n\t\t\t{\n\t\t\t\tcout<<i<<\" \"<<u<<endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nconst int INF = 1e9;\nconst int MOD = 1e9+7;\nconst long long LINF = 1e18;\n#define dump(x)  cout << 'x' << ' = ' << (x) << ` `;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) for(int i=0;i<(n);++i)\n#define REPR(i,n) for(int i=n;i>=0;i--)\n#define FOREACH(x,a) for(auto& (x) : (a) )\ntypedef long long ll;\nusing namespace std;\n\ntypedef pair<int, int> P;\nint n, l;\n\nvoid move_right(vector<int> &tunnel) {\n    for (int i = l; i >= 1; --i) {\n        if (tunnel[i] != -1) {\n            tunnel[i+1] = tunnel[i];\n            tunnel[i] = -1;\n        }\n    }\n}\n\nvoid move_left(vector<int> &tunnel) {\n    for (int i = 1; i < l; ++i) {\n        if (tunnel[i] != -1) {\n            tunnel[i-1] = tunnel[i];\n            tunnel[i] = -1;\n        }\n    }\n}\n\nvoid check_turn(vector<int> &rt, vector<int> &lt) {\n    for (int i = 1; i < l; ++i) {\n        if (rt[i] != -1 && lt[i] != -1) {\n            swap(rt[i], lt[i]);\n        }\n    }\n}\n\nvoid check_end(vector<int> &rt, vector<int> &lt, vector<P> &leaved, int cnt) {\n    if (rt[l] != -1) {\n        leaved.push_back({cnt, rt[l]});\n        rt[l] = -1;\n    }\n\n    if (lt[0] != -1) {\n        leaved.push_back({cnt, lt[0]});\n        lt[0] = -1;\n    }\n}\n\nint main(int argc, char const *argv[]) {\n    while (cin >> n >> l, n) {\n        vector<char> d(n);\n        vector<int> p(n), rtunnel(l+1, -1), ltunnel(l+1, -1);\n        // 出たかどうか\n        vector<P> leaved;\n        \n        // input\n        REP(i,n) {\n            cin >> d[i] >> p[i];\n            if (d[i] == 'R') rtunnel[p[i]] = i;\n            else ltunnel[p[i]] = i;\n        }\n\n        int cnt = 1;\n        while (leaved.size() < n) {\n            move_right(rtunnel);\n            move_left(ltunnel);\n            check_turn(rtunnel, ltunnel);\n            check_end(rtunnel, ltunnel, leaved, cnt);\n            ++cnt;\n        }\n        \n        P last = leaved.back();\n\n        cout << last.first << \" \" << last.second+1 << endl;\n\n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<climits>\n#include<iostream>\n#include<algorithm>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<list>\n#include<map>\n#include<set>\ntypedef long long ll;\ntypedef unsigned long long ull;\nusing namespace std;\n#define pb push_back\nint dy[]={0, 0, 1, -1, 0};\nint dx[]={1, -1, 0, 0, 0};\n \n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n\nint n,l;\nchar c[100];\nint p[100];\n\nbool input(){\n    scanf(\"%d%d\",&n,&l);\n    REP(i,n){\n        cin >> c[i] >> p[i];\n        p[i] *= 2;\n    }\n    return n != 0;\n}\n\nvoid solve(){\n    int t = 0;int down = 0;int e[1000],maxi;\n    while(down < n){\n        fill(e,e+1000,0);\n        maxi = -1;\n        REP(i,n){\n            if(p[i] == -1)\n                continue;\n            if(c[i] == 'R')\n                p[i]++;\n            else\n                p[i]--;\n            if(p[i] == 0 || p[i] == l * 2){\n                if(p[i] == 0 || (p[i] == l * 2 && maxi == -1))\n                    maxi = i;\n                p[i] = -1;\n                down++;\n                continue;\n            }\n            e[p[i]]++;\n        }\n        REP(i,l*2 + 2){\n            if(e[i] == 2){\n                vector<int> a;\n                REP(j,n){\n                    if(p[j] == i)\n                        a.pb(j);\n                }\n                if(i % 2 == 0){\n                    char ex = c[a[0]];\n                    c[a[0]] = c[a[1]];\n                    c[a[1]] = ex;\n                }\n            }\n        }\n        t++;\n    }\n    printf(\"%d %d\\n\",t/2,maxi+1);\n}\n\nint main(){\n    while(input()){\n        solve();\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(i, (v).size()) { cout << v[i]; if (i != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile (1) {\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (!n)break;\n\t\tvi v(n), d(n);\n\t\tREP(i, n) {\n\t\t\tchar c;\n\t\t\tcin >> c >> v[i];\n\t\t\tif (c == 'R')d[i] = 1;\n\t\t\telse d[i] = -1;\n\t\t}\n\t\tint cnt = 0, last = 0;\n\t\tvector<bool> end(n, false);\n\t\tREP(i ,INF) {\n\t\t\tvi prev = v;\n\n\n\t\t\tREP(j, n) {\n\t\t\t\tif(!end[j])v[j] += d[j];\n\t\t\t}\n\t\t\tREP(s, n) {\n\t\t\t\tFOR(t, s + 1, n) {\n\t\t\t\t\tif ((prev[s] < prev[t] && v[s] >= v[t]) || (prev[s] > prev[t] && v[s] <= v[t])) {\n\t\t\t\t\t\tif (abs(prev[s] - prev[t])==2) {\n\t\t\t\t\t\t\tswap(d[t], d[s]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(j, n) {\n\t\t\t\tif (v[j] >= l&&!end[j]) {\n\t\t\t\t\tend[j] = true;\n\t\t\t\t\tcnt++;\n\t\t\t\t\tlast = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(j, n) {\n\t\t\t\tif (v[j] <= 0 && !end[j]) {\n\t\t\t\t\tend[j] = true;\n\t\t\t\t\tcnt++;\n\t\t\t\t\tlast = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (cnt == n) {\n\t\t\t\tcout << i + 1 << \" \" << last + 1 << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef pair<int, int> P;\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  int n, l;\n  while ( cin >> n >> l, n ) {\n    vector<int> datl(l+3, 0);\n    vector<int> datr(l+3, 0);\n    for ( int i = 1; i <= n; i++ ) {\n      char d;\n      int p;\n      cin >> d >> p;\n      if ( d == 'R' ) datr[p] = i;      \n      else datl[p] = i;      \n    }\n\n    bool flag = true;\n    int last_ant = -1;\n    int cnt = 0;    \n    while ( flag ) {\n      cnt++;      \n      flag = false;\n      int ant = 100000;      \n      vector<int> nxtl(l+3, 0);\n      vector<int> nxtr(l+3, 0);      \n      for ( int i = 1; i < l; i++ ) {\n\tif ( datr[i] && datl[i+2] ) {\n\t  flag = true;\n\t  nxtr[i+1] = datl[i+2];\n\t  nxtl[i+1] = datr[i];\n\t  datr[i] = datl[i+2] = 0;\t  \n\t}\n\tif ( datr[i] ) {\n\t  flag = true;\n\t  nxtr[i+1] = datr[i];\n\t  datr[i] = 0;\t  \n\t}\n\tif ( datl[i] ) {\n\t  flag = true;\t  \t  \n\t  nxtl[i-1] = datl[i];\n\t  datl[i] = 0;\t  \n\t}\n      }\n      \n      if ( nxtl[0] ) last_ant = nxtl[0];\n      else if ( nxtr[l] ) last_ant = nxtr[l];      \n      datl = nxtl;\n      datr = nxtr;      \n    }\n\n    cout << cnt-1 << \" \" << last_ant << endl;\n  }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define each(a, b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout <<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout <<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout <<\" \"<<kbrni;cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int>P;\n\nconst int MAX_N = 100005;\n\nint main()\n{\n    while(1){\n        int n,l;\n        cin >> n >> l;\n        if(n == 0 && l == 0){\n            break;\n        }\n        vector<P> vec(n);\n        rep(i,n){\n            char c;\n            cin >> c;\n            int p;\n            cin >> p;\n            if(c == 'R'){\n                vec[i] = P(p,0);\n            }else{\n                vec[i] = P(p,1);\n            }\n        }\n        int cnt = 0;\n        int tm = 0;\n        int la;\n        int flag[41];\n        rep(i,41){\n            flag[i] = i;\n        }\n        while(1){\n            tm++;\n            vector<P> fall;\n            rep(i,n){\n                if(vec[i].fi == 0 || vec[i].fi == l){\n                    continue;\n                }\n                if(i <= n-1 && vec[i].fi == vec[i+1].fi){\n                    vec[i].fi--;\n                    vec[i].se = 1;\n                    vec[i+1].fi++;\n                    vec[i+1].se = 0;\n                    if(vec[i].fi == 0 || vec[i+1].fi == l){\n                        cnt++;\n                    }\n                    i++;\n                }else if(i <= n-1 && vec[i+1].fi-vec[i].fi == 1 && vec[i].se == 0 && vec[i+1].se == 1){\n                    vec[i].se = 1;\n                    vec[i+1].se = 0;\n                    swap(flag[i],flag[i+1]);\n                    i++;\n                }else{\n                    if(vec[i].se){\n                        vec[i].fi--;\n                    }else{\n                        vec[i].fi++;\n                    }\n                    if(vec[i].fi == 0){\n                        cnt++;\n                        fall.pb(P(0,flag[i]+1));\n                    }else if(vec[i].fi == l){\n                        cnt++;\n                        fall.pb(P(1,flag[i]+1));\n                    }\n                }\n            }\n            if(cnt == n){\n                sort(all(fall));\n                cout << tm << \" \" << fall[0].se << endl;\n                break;\n            }\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nint main(void){\n    int n, len;\n    while (cin>>n>>len && n) {   \n        int l = -1, r = -1;\n        vector<int> vr(len+1, 0);\n        vector<int> vl(len+1, 0);\n        for (int i = 0; i < n; i++) {\n            char a; int b; cin >> a >> b;\n            if (a == 'R' && r == -1) r = b;\n            if (a == 'L') l = b;\n            \n            if (a == 'R') vr[b] = i+1;\n            if (a == 'L') vl[b] = i+1;\n        }\n        int ans1 = max(len-r, l), ans2;\n        \n        while (1) {\n            int cnt = 0;\n            for (int i = 1; i < len; i++) {\n                if (vl[i]) {\n                    cnt++;\n                    swap(vl[i-1], vl[i]);\n                }\n            }\n            for (int i = len-1; i >= 0; i--) {\n                if (vr[i]) {\n                    cnt++;\n                    swap(vr[i+1], vr[i]);\n                }\n            }\n            if (cnt == 2 && vl[0] && vr[len]) {\n                ans2 = vl[0];\n                break;\n            }\n            if (cnt == 1 && vl[0]) {\n                ans2 = vl[0];\n                break;\n            }\n            if (cnt == 1 && vr[len]) {\n                ans2 = vr[len];\n                break;\n            }\n            \n            vl[0] = 0;\n            vr[len] = 0;\n            for (int i = 1; i < len-1; i++) {\n                if (vl[i] && vr[i]) swap(vl[i], vr[i]);\n            }\n        }\n        cout << ans1 << \" \" << ans2 << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define F first\n#define S second\n#define pii pair<int, int>\n#define mp make_pair\n#define eb emplace_back\n#define all(v) v.begin(), v.end()\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n#define rep3(i, l, n) for (int i = l; i < (n); ++i)\n#define sz(v) (int)v.size()\n#define inf (int)(1e9+7)\n#define abs(x) (x >= 0 ? x : -(x))\ntemplate<typename T1, typename T2> inline void chmin(T1 &a, T2 b) { if (a > b) a = b; }\ntemplate<typename T1, typename T2> inline void chmax(T1 &a, T2 b) { if (a < b) a = b; }\ntemplate<typename T> inline T gcd(T a, T b) { if (b == 0) return a; return gcd(b, a % b); }\n\n\n\n\n\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    \n    \n    \n    int n;\n    while (cin >> n && n) {\n        int l;\n        cin >> l;\n        l *= 2;\n        // cout << n << \" \" << l << endl;\n        vector<pair<char, int> > v;\n        rep(i, n) { char d; int p; cin >> d >> p; p *= 2; v.eb(mp(d, p)); }\n        \n        int cnt = 0;\n        rep(t, 10000000) {\n            // rep(i, n) cout << v[i].S << \" \"; cout << endl;\n            int tmp = -1; // 左から抜けるやつ\n            int breakflg = 0;\n            rep(i, n) { // 20\n                if (v[i].S == 0 || v[i].S == l) continue;\n                \n                if (v[i].F == 'L') {\n                    v[i].S--;\n                    if (v[i].S == 0) {\n                        cnt++;\n                        tmp = i;\n                    }\n                } else {\n                    v[i].S++;\n                    if (v[i].S == l) {\n                        cnt++;\n                    }\n                }\n                if (cnt == n) {\n                    if (v[i].F == 'R' && tmp != -1) cout << (t + 1) / 2 << \" \" << tmp + 1 << endl;\n                    else cout << (t + 1) / 2 << \" \" << i + 1 << endl;\n                    breakflg = 1;\n                    break;\n                }\n                \n                if (t % 2 == 0) continue;\n                rep(j, n) { // collision\n                    if (v[i].S == v[j].S) {\n                        if (v[i].F == 'L') {\n                            v[i].F = 'R';\n                            v[j].F = 'L';\n                        } else {\n                            v[i].F = 'L';\n                            v[j].F = 'R';\n                        }\n                        break;\n                    }\n                }\n            }\n            if (breakflg) break;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<ll, pair<ll, ll> > P3;\n\nconst ll MOD = ll(1e9 + 7);\nconst ll LLINF = LLONG_MAX;\nconst int IINF = INT_MAX;\nconst int MAX_N = int(1e5) + 5;\nconst double EPS = 1e-8;\nconst int dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\n#define SORT(v) sort((v).begin(), (v).end())\n#define SORTR(v) sort((v).rbegin(), (v).rend())\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define REPR(i, n) for (int i = n; i >= 0; i--)\n#define FOR(i, m, n) for (ll i = m; i < n; i++)\n#define ALL(v) (v).begin(), (v).end()\n\nint main() {\n        while (1) {\n        int n, l;\n        vector<int> a[2][2], b[2];\n        map<int,int> mp;\n        cin >> n >> l;\n        if (n == 0) break;\n        REP(i,2)a[i][0].push_back(0);\n        REP(i,n){\n            string d;\n            int p;\n            cin >> d >> p;\n            a[p%2][d==\"L\"?0:1].push_back(p);\n            b[p%2].push_back(p);\n            mp[p] = i+1;\n        }\n        REP(i,2)a[i][1].push_back(l);\n        int tmax[2]{}, pi[2], L=0, R=1;\n        bool f[2]{};\n        REP(i,2){\n            if(b[i].size()==0)continue;\n            if(l - a[i][R][0] > *--a[i][L].end()){\n                tmax[i] = l - a[i][R][0];\n                pi[i] = b[i][b[i].size()-a[i][R].size()+1];\n            }\n            else{\n                tmax[i] = *--a[i][L].end();\n                pi[i] = b[i][a[i][L].size()-2];\n                f[i] = true;\n            }\n        }\n        if(tmax[0] > tmax[1]){\n            cout << tmax[0] << \" \" << mp[pi[0]] << endl;\n        }\n        else if(tmax[0] < tmax[1]){\n            cout << tmax[1] << \" \" << mp[pi[1]] << endl;\n        }\n        else if(f[0]){\n            cout << tmax[0] << \" \" << mp[pi[0]] << endl;\n        }\n        else {\n            cout << tmax[1] << \" \" << mp[pi[1]] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <iostream>\nusing namespace std;\nint n,l;\nint dx[2]={-1,1};\nint dir[22];\nint p[22];\nint np[22];\nint ndir[22];\nbool move[22];\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d %d\",&n,&l);\n\t\tif(n+l==0)break;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tstring str;\n\t\t\tcin >> str >> p[i];\n\t\t\tif(str==\"L\")dir[i]=0;\n\t\t\telse dir[i]=1;\n\t\t}\n\t\tint t=0,rest=n,res;\n\t\tmemset(move,false,sizeof(move));\n\t\twhile(rest>0){\n\t\t\tres=-1;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(p[i]%l==0)continue;\n\t\t\t\tnp[i]=p[i]+dx[dir[i]];\n\t\t\t\tndir[i]=dir[i];\n\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\tif(i==j || p[j]%l==0)continue;\n\t\t\t\t\tif(p[i]+dx[dir[i]]==p[j]+dx[dir[j]]){\n\t\t\t\t\t\tnp[i]=p[i]+dx[dir[i]];\n\t\t\t\t\t\tndir[i]=1-dir[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(p[i]%l==0)continue;\n\t\t\t\tp[i]=np[i];\n\t\t\t\tdir[i]=ndir[i];\n\t\t\t\tif(res==-1 || p[i]==0)res=i;\n\t\t\t\tif(p[i]%l==0){\n\t\t\t\t\tif(!move[i]){\n\t\t\t\t\t\tmove[i]=true;\n\t\t\t\t\t\trest--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tt++;\n\t\t}\n\t\tprintf(\"%d %d\\n\",t,res+1);\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n\ntypedef pair<int,int> pi;\n\nint main()\n{\n    int n,l;\n    while(cin >>n >>l,n)\n    {\n        vector<pi> ant(n);\n        rep(i,n)\n        {\n            char c;\n            int p;\n            scanf(\" %c %d\", &c, &p);\n\n            if(c=='L') ant[i]=pi(-1,p);\n            else ant[i]=pi(1,p);\n        }\n\n        int t=0;\n        int last=-1;\n\n        while(1)\n        {\n            int alive=n;\n            rep(i,n) if(ant[i].se==0 || ant[i].se==l) --alive;\n\n            if(alive==0) break;\n            else if(alive==1)\n            {\n                rep(i,n) if(0<ant[i].se && ant[i].se<l) last=i+1;\n            }\n            else if(alive==2)\n            {\n                rep(i,n) if(ant[i].se==1) last=i+1;\n            }\n\n            // printf(\" t= %d, last= %d\\n\", t,last);\n            // rep(i,n) printf(\"  %d : pos %d, %c\\n\", i,ant[i].se,(ant[i].fi==-1)?'L':'R');\n\n            int nf[100];\n            fill(nf,nf+100,-1);\n            rep(i,n)\n            {\n                int nx=ant[i].se+ant[i].fi;\n\n                if(nx==0 || nx==l) ant[i]=pi(0,nx);\n                else\n                {\n                    ant[i].se+=ant[i].fi;\n                    if(nf[ant[i].se]==-1) nf[ant[i].se]=i;\n                    else\n                    {\n                        int idx=nf[ant[i].se];\n                        ant[i].fi = -ant[i].fi;\n                        ant[idx].fi = -ant[idx].fi;\n                        // printf(\" swap %d, %d\\n\", idx,i);\n\n                    }\n                }\n            }\n\n            ++t;\n        }\n\n        printf(\"%d %d\\n\", t, last);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\n#define FOR(i, a, b) for(int i = (a); i < (b); i++)\n#define rep(i, n) FOR(i, 0, n)\n\nusing namespace std;\n\n\nint dx[256];\nint dir[100];\nint pos[100];\nint main(){\n\tdx['L'] = -1;\n\tdx['R'] = 1;\n\n\tint n, l;\n\twhile(cin >> n >> l, n|l){\n\t\trep(i, n){\n\t\t\tchar c;\n\t\t\tcin >> c >> pos[i];\n\t\t\tdir[i] = dx[c];\n\t\t}\n\n\t\tint cnt = n;\n\t\tint time = 0;\n\t\tint last = -1;\n\t\twhile(1){\n\t\t\trep(i, n){\n\t\t\t\tif(pos[i] == l){\n\t\t\t\t\tpos[i] = 1<<29;\n\t\t\t\t\tlast = i;\n\t\t\t\t\tcnt--;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(i, n){\n\t\t\t\tif(pos[i] == 0){\n\t\t\t\t\tpos[i] = 1<<29;\n\t\t\t\t\tlast = i;\n\t\t\t\t\tcnt--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!cnt) break;\n\n\t\t\trep(i, n){\n\t\t\t\tpos[i] += dir[i];\n\t\t\t}\n\t\t\ttime++;\n\n\t\t\trep(i, n){\t// meets\n\t\t\t\trep(j, i){\n\t\t\t\t\tif(pos[i] == pos[j]){\n\t\t\t\t\t\tdir[i] *= -1;\n\t\t\t\t\t\tdir[j] *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} // end while\n\n\t\tcout << time << ' ' << last+1 << endl;\n\t}\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdlib>\n#include <iostream>\n#include <tuple>\n#include <vector>\nusing namespace std;\n\ntemplate<class T> inline void chmax(T &a, const T &b) { if(b > a) a = b; }\n\ntuple<int, bool, int> calc(const vector<tuple<char, int, int>> &ants, int l) {\n\ttuple<int, bool, int> res{0, false, -1};\n\tconst int n = ants.size();\n\tif(n == 0) return res;\n\n\tfor(int i = 0; i < n; ++i) {\n\t\tif(get<0>(ants[i]) == 'R')\n\t\t\tchmax(res, make_tuple(l - get<1>(ants[i]), false, i));\n\t\telse\n\t\t\tchmax(res, make_tuple(get<1>(ants[i]), true, i));\n\t}\n\n\tint idx = get<2>(res);\n\tif(get<0>(ants[idx]) == 'R') {\n\t\tfor(int i = idx + 1; i < n; ++i) {\n\t\t\tif(get<0>(ants[i]) == 'L')\n\t\t\t\t++idx;\n\t\t}\n\t}\n\telse {\n\t\tfor(int i = idx - 1; i >= 0; --i) {\n\t\t\tif(get<0>(ants[i]) == 'R')\n\t\t\t\t--idx;\n\t\t}\n\t}\n\n\tget<2>(res) = get<2>(ants[idx]);\n\treturn res;\n}\n\nint main() {\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\n\tfor(int n, l; cin >> n >> l && n;) {\n\t\tvector<tuple<char, int, int>> even, odd;\n\t\tfor(int i = 0; i < n; ++i) {\n\t\t\tchar d;\n\t\t\tint p;\n\t\t\tcin >> d >> p;\n\t\t\t(p & 1 ? odd : even).emplace_back(d, p, i + 1);\n\t\t}\n\n\t\tconst auto answer = max(calc(odd, l), calc(even, l));\n\t\tcout << get<0>(answer) << \" \" << get<2>(answer) << endl;\n\t}\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nsigned main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n\n    int n, l;\n    while (1)\n    {\n        cin >> n >> l;\n        if (n == 0)\n            break;\n        vector<int> d(n);\n        int pos[2][110] = {};\n        for (int i = 0; i < n; i++)\n        {\n            char d;\n            int p;\n            cin >> d >> p;\n            if (d == 'R')\n                pos[0][p] = i + 1;\n            else\n                pos[1][p] = i + 1;\n        }\n        int maxl = 0;\n        for (int i = 0; i < l; i++)\n        {\n            if (pos[0][i] != 0)\n                maxl = max(maxl, l - i);\n            if (pos[1][i] != 0)\n                maxl = max(maxl, i);\n        }\n        cout << maxl << \" \";\n        int rest = n, la = 0;\n        while (rest > 0)\n        {\n            int nxt[2][110] = {};\n            for (int i = l - 1; i >= 0; i--)\n            {\n                if (pos[0][i] != 0 && pos[1][i] != 0)\n                {\n                    nxt[0][i + 1] = pos[1][i];\n                    nxt[1][i - 1] = pos[0][i];\n                    continue;\n                }\n                if (pos[0][i] != 0)\n                {\n                    if (i == l - 1)\n                    {\n                        rest--;\n                        la = pos[0][i];\n                    }\n                    else\n                    {\n                        nxt[0][i + 1] = pos[0][i];\n                    }\n                }\n                if (pos[1][i] != 0)\n                {\n                    if (i == 1)\n                    {\n                        rest--;\n                        la = pos[1][i];\n                    }\n                    else\n                    {\n                        nxt[1][i - 1] = pos[1][i];\n                    }\n                }\n            }\n            for (int i = 0; i < l; i++)\n            {\n                pos[0][i] = nxt[0][i];\n                pos[1][i] = nxt[1][i];\n            }\n        }\n        cout << la << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<utility>\n#include<algorithm>\nusing namespace std;\n\nint main(int argc, char *argv[])\n{\n  for(;;){\n    int n, l;\n    cin >> n >> l;\n    if(n == 0 && l == 0) break;\n    vector<pair<pair<int,int>,int>> as;\n    for(int i = 0; i < n; i++) {\n      char c;\n      int p;\n      cin >> c >> p;\n      as.push_back(make_pair(make_pair(p, c == 'R' ? 1 : -1), i));\n    }\n    int t = 0;\n    int last = -1;\n    for(;;){\n      last = -1;\n      // erase finished\n      for(auto it = as.begin(); it != as.end(); ) {\n        int p = (*it).first.first;\n        if (p <= 0 || p >= l) {\n          if(last == -1) last = (*it).second;\n          it = as.erase(it);\n        } else {\n          it++;\n        }\n      }\n      if(as.size()==0) break;\n      t++;\n      // move\n      for(auto it = as.begin(); it != as.end(); it++) {\n        (*it).first.first += (*it).first.second;\n      }\n      // sort\n      sort(as.begin(), as.end());\n      // reflect\n      for(int i = 1; i < as.size(); i++) {\n        if(as[i-1].first.first == as[i].first.first) {\n          as[i-1].first.second = -as[i-1].first.second;\n          as[i].first.second = -as[i].first.second;\n        }\n      }\n    }\n    cout << t << \" \" << (last+1) << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n// #define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\n// ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\n// ll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint n,l;\nchar d[250];\nint p[250];\nbool goal[250];\n\nint main(){\n\twhile(1){\n\t\tint n,l;\n\t\tint ll,rr;\n\t\tcin >> n >> l;\n\t\tif(n==0&&l==0) break;\n\t\tREP(i,n){\n\t\t\tcin >> d[i] >> p[i];\n\t\t\tgoal[i] = false;\n\t\t}\n\t\tint rest = n;\n\t\tint goaltime = 0;\n\t\twhile(rest!=0){\n\t\t\tgoaltime++;\n\t\t\tvector<int> posd[500];\n\t\t\tREP(i,500) posd[i].clear();\n\t\t\tREP(i,n){\n\t\t\t\t//if(p[i]!=-1) cout << i << \" \" << d[i] << \" \" << p[i] << endl;\n\t\t\t}\n\t\t\tREP(i,n){\n\t\t\t\tif(goal[i]) continue;\n\t\t\t\tif(p[i]<=0||p[i]==l) continue;\n\t\t\t\tif(d[i]=='L') p[i]--;\n\t\t\t\telse p[i]++;\n\t\t\t\tif(p[i]>=0) posd[p[i]].pb(i);\n\t\t\t}\n\t\t\tFOR(i,1,l){\n\t\t\t\tif(posd[i].size()==2){\n \t\t\t\t\tswap(d[posd[i][1]],d[posd[i][0]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tll = -1; rr = -1;\n\t\t\tREP(i,n){\n\t\t\t\tif(p[i]==0){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\tll = i;\n\t\t\t\t\trest--;\n\t\t\t\t}\n\t\t\t\tif(p[i]==l){\n\t\t\t\t\tp[i]=-1;\n\t\t\t\t\trest--;\n\t\t\t\t\trr = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans;\n\t\tif(ll==-1&&rr!=-1) ans = rr;\n\t\telse if(ll!=-1&&rr==-1) ans = ll;\n\t\telse ans = ll;\n\t\tcout << goaltime << \" \" << ans+1 << endl;\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing T = tuple<int,char,int>; //p,d,i\n\nint main(){\n    int n,l;\n    while(cin>>n>>l,n){\n        int R[l+1],L[l+1];\n        fill(R,R+l+1,0);\n        fill(L,L+l+1,0);\n\n        for(int i=1;i<=n;i++){\n            char d;\n            int p;\n            cin>>d>>p;\n            // cout<<d<<' '<<p<<' '<<i<<endl;\n            if(d=='R'){\n                R[p]=i;\n            }else{\n                L[p]=i;\n            }\n        }\n        int cnt = n;\n        int last = -1;\n        int t=0;\n        while(cnt){\n            t++;\n            if(R[l]){\n                last=R[l];\n                R[l]=0;\n                cnt--;\n            }\n            if(L[0]){\n                last=L[0];\n                L[0]=0;\n                cnt--;\n            }\n            for(int loc=1;loc<l;loc++){\n                if(L[loc]){\n                    L[loc-1]=L[loc];\n                    L[loc]=0;\n                }\n            }\n            for(int loc=l-1;loc>0;loc--){\n                if(R[loc]){\n                    R[loc+1]=R[loc];\n                    R[loc]=0;\n                }\n            }\n            for(int loc=1;loc<l;loc++){\n                if(R[loc]&&L[loc]) swap(R[loc],L[loc]);\n            }\n        }\n        cout<<t-1<<' '<<last<<endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nchar T;int l,a,b,x[999],d[999],M,N,y[999],z[999],i,j;\nint main(){\n\twhile(1){\n\t\tM=0;\n\t\tmemset(y,0,3996);\n\t\tcin>>b>>l;if(!l){break;}\n\t\tfor(i=1;i<=b;i++){\n\t\t\tcin>>T>>x[i];\n\t\t\tif(T=='L'){d[i]=0;M=max(M,x[i]);}\n\t\t\telse{d[i]=1;M=max(M,l-x[i]);}\n\t\t}\n\t\tN=0;\n\t\tfor(i=1;i<M+2;i++){\n\t\t\tmemset(z,0,sizeof(z));\n\t\t\tfor(j=b;j>0; j--) {\n\t\t\t\tif(!y[j]) {\n\t\t\t\t\tif(!d[j]){\n\t\t\t\t\t\tx[j]--;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tx[j]++;\n\t\t\t\t\t}\n\t\t\t\t\tif(x[j]<0||x[j]>l){\n\t\t\t\t\t\ty[j]=1;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tz[x[j]]++;\n\t\t\t\t\t}\n\t\t\t\t\tif(M+1==i){\n\t\t\t\t\t\tif(N){\n\t\t\t\t\t\t\tif(x[j]<0){N=j;}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tN=j;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(j=b;j>0;j--){\n\t\t\t\tif(z[x[j]]>1){\n\t\t\t\t\tif(d[j]){d[j]=0;}\n\t\t\t\t\telse{d[j]=1;}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\",M,N);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nint mp[2][101],n,l;\n\nvoid solve(){\n  int sec=0,ant;\n  while(1){\n    sec++;\n    for(int i=l;i>0;i--)mp[0][i]=mp[0][i-1]; //to right\n    for(int i=0;i<l;i++)mp[1][i]=mp[1][i+1]; //to left\n    for(int i=1;i<=l;i++)if((mp[0][i]>0&&mp[1][i]>0)) swap(mp[0][i],mp[1][i]); //turn\n    int flg;\n    for(flg=1;flg<l&&mp[0][flg]+mp[1][flg]==0;flg++);\n    if(flg==l)break;\n  }\n  if(mp[0][l]>0)ant=mp[0][l];\n  if(mp[1][0]>0)ant=mp[1][0];\n  cout << sec <<\" \"<<ant<<endl;\n}\n\nint main(){\n  while(1){\n    cin >>n>>l;\n    if(n==0&&l==0)break;\n    memset(mp,0,sizeof(mp));\n    for(int i=1;i<=n;i++){\n      char c;\n      int a,flg=0;\n      cin >>c>>a;\n      if(c=='L') flg=1;\n      mp[flg][a]=i;\n    }\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <iterator>\n#include <cmath>\n\nusing namespace std;\n\nint main(){\n\t\n\tint n, l;\n\t\n\twhile(true){\n\t\tcin >> n >> l;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tstring d[30];\n\t\tint p[30] = {};\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tcin >> d[i] >> p[i];\n\t\t}\n\t\tint ans = 0;\n\t\tint num = 1;\n\t\tfor(int i = n - 1; i > 0; i--){\n\t\t\tif(d[i][0] == 'L'){\n\t\t\t\tans = p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j > 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'L'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tif(d[i][0] == 'R'){\n\t\t\t\tif(ans >= l - p[i]){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tans = l - p[i];\n\t\t\t\tint rest = p[i] % 2;\n\t\t\t\tint count = 0;\n\t\t\t\tfor(int j = i; j < n; j++){\n\t\t\t\t\tif(p[j] % 2 == rest && d[j][0] == 'R'){\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = n - 1; j > 0; j--){\n\t\t\t\t\tif(p[j] % 2 == rest){\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t}\n\t\t\t\t\tif(count == 0){\n\t\t\t\t\t\tnum = j + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \" << num << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define IN(a, b, x) (a<=x&&x<b)\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};\n\npair<char, int> t[1000][105][2];\nint l;\nbool check(int m) {\n\tbool flag = false;\n\tREP(i, l+1) {\n\t\tif(t[m][i][0] != MP('-', -1)) flag = true;\n\t\tif(t[m][i][1] != MP('-', -1)) flag = true;\n\t}\n\treturn flag;\n}\n\nsigned main(void)\n{\n\twhile(1) {\n\t\tint n;\n\t\tcin >> n >> l;\n\t\tif(!n && !l) break;\n\t\tREP(j, 1000) REP(i, l+1) t[j][i][0] = t[j][i][1] = {'-', -1};\n\t\tREP(i, n) {\n\t\t\tchar c;\n\t\t\tint a;\n\t\t\tcin >> c >> a;\n\t\t\tt[0][a][0] = {c, i+1};\n\t\t}\n\n\t\tint j = 0, ans;\n\t\twhile(check(j)) {\n\t\t\tans = -1;\n\t\t\tREP(i, l+1) {\n\t\t\t\t//???????????¨\n\t\t\t\tif(t[j][i][0] != MP('-', -1)) {\n\t\t\t\t\t// Right\n\t\t\t\t\tif(t[j][i][0].first == 'R') {\n\t\t\t\t\t\tif(i+1 > l) {\n\t\t\t\t\t\t \tif(ans == -1) ans = t[j][i][0].second;\n\t\t\t\t\t \t} else if(t[j+1][i+1][0] == MP('-', -1)) {\n\t\t\t\t\t\t\tt[j+1][i+1][0] = t[j][i][0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tt[j+1][i+1][1] = t[j][i][0];\n\t\t\t\t\t\t\tif(t[j+1][i+1][1].first == 'R') t[j+1][i+1][1].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i+1][1].first = 'R';\n\t\t\t\t\t\t\tif(t[j+1][i+1][0].first == 'R') t[j+1][i+1][0].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i+1][0].first = 'R';\n\t\t\t\t\t\t}\n\t\t\t\t\t// Left\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(i-1 < 0) {\n\t\t\t\t\t\t \tans = t[j][i][0].second;\n\t\t\t\t\t \t} else if(t[j+1][i-1][0] == MP('-', -1)) {\n\t\t\t\t\t\t\tt[j+1][i-1][0] = t[j][i][0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tt[j+1][i-1][1] = t[j][i][0];\n\t\t\t\t\t\t\tif(t[j+1][i-1][1].first == 'R') t[j+1][i-1][1].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i-1][1].first = 'R';\n\t\t\t\t\t\t\tif(t[j+1][i-1][0].first == 'R') t[j+1][i-1][0].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i-1][0].first = 'R';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//???????????¨\n\t\t\t\tif(t[j][i][1] != MP('-', -1)) {\n\t\t\t\t\t// Right\n\t\t\t\t\tif(t[j][i][1].first == 'R') {\n\t\t\t\t\t\tif(i+1 > l) {\n\t\t\t\t\t\t \tif(ans == -1) ans = t[j][i][1].second;\n\t\t\t\t\t \t} else if(t[j+1][i+1][0] == MP('-', -1)) {\n\t\t\t\t\t\t\tt[j+1][i+1][0] = t[j][i][1];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tt[j+1][i+1][1] = t[j][i][1];\n\t\t\t\t\t\t\tif(t[j+1][i+1][1].first == 'R') t[j+1][i+1][1].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i+1][1].first = 'R';\n\t\t\t\t\t\t\tif(t[j+1][i+1][0].first == 'R') t[j+1][i+1][0].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i+1][0].first = 'R';\n\t\t\t\t\t\t}\n\t\t\t\t\t// Left\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(i-1 < 0) {\n\t\t\t\t\t\t \tans = t[j][i][1].second;\n\t\t\t\t\t \t} else if(t[j+1][i-1][1] == MP('-', -1)) {\n\t\t\t\t\t\t\tt[j+1][i-1][0] = t[j][i][1];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tt[j+1][i-1][1] = t[j][i][1];\n\t\t\t\t\t\t\tif(t[j+1][i-1][1].first == 'R') t[j+1][i-1][1].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i-1][1].first = 'R';\n\t\t\t\t\t\t\tif(t[j+1][i-1][0].first == 'R') t[j+1][i-1][0].first = 'L';\n\t\t\t\t\t\t\telse t[j+1][i-1][0].first = 'R';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*cout << \"j:\" << j << \" \";\n\t\t\tREP(i, l+1) {\n\t\t\t\tcout << \"(\" << t[j][i][0].first << \",\" << t[j][i][0].second << \")(\" << t[j][i][1].first << \",\" << t[j][i][1].second << \")\";\n\t\t\t}\n\t\t\tcout << endl;*/\n\t\t\tj++;\n\t\t}\n\t\tcout << j-1 << \" \" << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\ntypedef struct\n{\n\t// direction\n\t// if 0 then go left\n\t// el 1 then go right\n\tint d;\n\t// position\n\tdouble p;\n\t// in\n\t// hool\n\t// if h is true then ant in hool\n\t// el h is false then ant go out\n\tbool h;\n} ant;\n\n\tint\nmain (void)\n{\n\twhile (1)\n\t{\n\t\tint n, l;\n\t\tcin >> n >> l;\n\t\tif (n == 0)\n\t\t\tbreak;\n\t\tant a[n];\n\t\tfor (int i = 0; i < n; i++)\n\t\t{\n\t\t\tchar d;\n\t\t\tcin >> d >> a[i].p;\n\t\t\tif (d == 'L')\n\t\t\t\ta[i].d = 0;\n\t\t\telse\n\t\t\t\ta[i].d = 1;\n\t\t\ta[i].h = true;\n\t\t}\n\n\t\tint ants = n;\n\t\tbool flag = false;\n\n\t\tfor (int t = 1; ; t++)\n\t\t{\n\t\t\t// ありの動きを更新\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t{\n\t\t\t\t// left\n\t\t\t\tif (!a[i].d)\n\t\t\t\t\ta[i].p -= 1;\n\t\t\t\t// right\n\t\t\t\telse\n\t\t\t\t\ta[i].p += 1;\n\t\t\t}\n\t\t\t// 出て行ったやつの更新\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t{\n\t\t\t\tif (a[i].h)\n\t\t\t\t{\n\t\t\t\t\t// 左から\n\t\t\t\t\tif (a[i].p < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ta[i].h = false;\n\t\t\t\t\t\tants--;\n\t\t\t\t\t}\n\t\t\t\t\t// 右から\n\t\t\t\t\telse if (l < a[i].p) \n\t\t\t\t\t{\n\t\t\t\t\t\ta[i].h = false;\n\t\t\t\t\t\tants--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// ぶつかった時\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t{\n\t\t\t\tfor (int j = i+1; j < n; j++)\n\t\t\t\t{\n\t\t\t\t\tif (a[i].p == a[j].p)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (a[i].d)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ta[i].d = 0;\n\t\t\t\t\t\t\ta[j].d = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ta[i].d = 1;\n\t\t\t\t\t\t\ta[j].d = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// DEBUG\n\t\t\t{\n#ifdef D\n\t\t\t\tcout << \"time:\" << t << endl;\n\t\t\t\tcout << \"ants:\" << ants << endl;\n\t\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\t{\n\t\t\t\t\tcout << i << endl;\n\t\t\t\t\tcout << \" \" << \"d:\" << a[i].d << endl;\n\t\t\t\t\tcout << \" \" << \"p:\" << a[i].p << endl;\n\t\t\t\t\tcout << \" \" << \"h:\" << a[i].h << endl;\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t\tcout << \"------------------\"<< endl;\n#endif\n\t\t\t}\n\t\t\tif (ants == 2)\n\t\t\t{\n\t\t\t\tint start, end;\n\t\t\t\tstart = end = -1;\n\t\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\t{\n\t\t\t\t\tif (a[i].h)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (a[i].p == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstart = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (a[i].p == l)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tend = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (-1 < start && -1 < end)\n\t\t\t\t{\n\t\t\t\t\tcout << t << \" \" << start + 1 << endl;\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\telse if (end)\n\t\t\t\t{\n\t\t\t\t\tcout << t << \" \" << end + 1 << endl;\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t}\n\t\t\telse if (ants == 1)\n\t\t\t{\n\t\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\t\tif (a[i].h)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (a[i].p == 0 || a[i].p == l)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcout << t << \" \" << i + 1 << endl;\n\t\t\t\t\t\t\tflag = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tif (flag)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<iostream>\nusing namespace std;\nstruct node{\n\tint x,y;\n}f[110];\nchar str[11];\nint n,m,p;\nbool w[110];\nint main()\n{\n\twhile (~scanf(\"%d%d\",&n,&m) && (n!=0 || m!=0))\n\t{\n\t\tfor (int i=1;i<=n;i++)\n\t\t{\n\t\t\tscanf(\"%s%d\", str,&p);\n\t\t\tf[i].x=p;\n\t\t\tf[i].y=str[0]=='L'?-1:1;\n\t\t}\n\t\tint t=n;\n\t\tint sum=0;\n\t\tint ans;\n\t\twhile (t)\n\t\t{\n\t\t\tsum++;\n\t\t\tfor (int i=1;i<=n;i++)\n\t\t\t\tf[i].x+=f[i].y;\n\t\t\tfor (int i=1;i<=n;i++)\n\t\t\t\tif (!w[i])\n\t\t\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\t\t\tif (i!=j && !w[j])\n\t\t\t\t\t\t\tif (f[i].x==f[j].x)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tf[i].y=f[i].y==1?-1:1;\n\t\t\t\t\t\t\t\tf[j].y=f[j].y==1?-1:1;\n\t\t\t\t\t\t\t}\n\t\t\tfor (int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif (f[i].x==m && f[i].y==1)\n\t\t\t\t{\n\t\t\t\t\tans=i;\n\t\t\t\t\tw[i]=true;\n\t\t\t\t\tt--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif (f[i].x==0 && f[i].y==-1)\n\t\t\t\t{\n\t\t\t\t\tans=i;\n\t\t\t\t\tw[i]=true;\n\t\t\t\t\tt--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tprintf(\"%d %d\\n\",sum,ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <map>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\npii ants[20];\n\nint main() {\n\tint n, l;\n\twhile(cin >> n >> l, n and l) {\n\t\trep(i,n) {\n\t\t\tchar d;\n\t\t\tint p;\n\t\t\tcin >> d >> p;\n\t\t\tants[i] = pii(p, (d=='L' ? -1 : 1));\n\t\t}\n\t\tint t=0, last=-1;\n\t\tfor(;;) {\n\t\t\tbool goal = true, left=false;\n\t\t\trep(i, n) {\n\t\t\t\tif(ants[i].first%l == 0) continue;\n\t\t\t\tgoal = false;\n\t\t\t\tants[i].first += ants[i].second;\n\t\t\t\tif(ants[i].first == 0) {\n\t\t\t\t\tleft = true;\n\t\t\t\t\tlast = i+1;\n\t\t\t\t}\n\t\t\t\telse if(ants[i].first == l && !left) {\n\t\t\t\t\tlast = i+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(goal) break;\n\t\t\trep(i, n) {\n\t\t\t\tfor(int j=i+1; j<n; j++) {\n\t\t\t\t\tif( ants[i].first == ants[j].first && ants[i].first%l > 0 ) {\n\t\t\t\t\t\tants[i].second *= -1;\n\t\t\t\t\t\tants[j].second *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tt++;\n\t\t}\n\t\tcout << t << \" \" << last << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\n// 愚直なシミュレート\nint main(){\n    int n, l;\n    while(cin >> n >> l, n+l){\n        vector<vector<int>> v(2, vector<int>(l+1, 0));\n        for(int i = 0; i < n; i++){\n            char c; int p;\n            cin >> c >> p;\n            if(c == 'L')    v[0][p] = i+1;\n            else            v[1][p] = i+1;\n        }\n        int tim = -1, exit = 0, id = -1;\n        while(exit < n){\n            tim++;\n            for(int j = l; j >= 0; j--){\n                if(v[1][j] == 0)    continue;\n                if(j == l){\n                    exit++, id = v[1][j];\n                    v[1][j] = 0;\n                }else{\n                    swap(v[1][j], v[1][j+1]);\n                }\n            }\n            for(int j = 0; j <= l; j++){\n                if(v[0][j] == 0)    continue;\n                if(j == 0){\n                    exit++, id = v[0][j];\n                    v[0][j] = 0;\n                }else{\n                    swap(v[0][j-1], v[0][j]);\n                }\n            }\n            for(int j = 0; j <= l; j++){\n                if(v[0][j] != 0 && v[1][j] != 0){\n                    swap(v[0][j], v[1][j]);\n                }\n            }\n        }\n        cout << tim << \" \" << id << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int n, l;\n    int x[20], dx[20];\n    while(true) {\n        scanf(\"%d%d\", &n, &l);\n        if(n == 0 && l == 0) break;\n        for(int i = 0; i < n; ++i){\n            char c;\n            scanf(\" %c %d\", &c, x + i);\n            dx[i] = (c == 'L') ? -1 : 1;\n        }\n        int v, t = 0, e;\n        char alive[20], updated = true, drop;\n        fill(alive, alive + n, 1);\n        while(updated){\n            ++t;\n            updated = false;\n            drop = false;\n            for(int i = 0; i < n; ++i){\n                if(!alive[i]) continue;\n                x[i] += dx[i];\n                if(x[i] == 0 || x[i] == l){\n                    if(!drop || (drop && x[i] == 0)){\n                        v = i;\n                    }\n                    drop = true;\n                    alive[i] = false;\n                }else{\n                    updated = true;\n                }\n            }\n            for(int i = 0; i < n; ++i){\n                if(!alive[i]) continue;\n                for(int j = i + 1; j < n; ++j){\n                    if(!alive[j]) continue;\n                    if(x[i] == x[j]){\n                        dx[i] *= -1;\n                        dx[j] *= -1;\n                    }\n                }\n            }\n        }\n        printf(\"%d %d\\n\", t, v + 1);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>inline void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>inline void chmax(T &t,U f){if(t<f)t=f;}\n\n//0 1\n//< >\n//L R\nconst double EPS=1e-9;\nint N,L;\nint D[111],X[111];\n\nvoid solve(){\n    int ans=0;\n    rep(i,N){\n        char d;\n        cin>>d>>X[i];\n        if(d=='L')D[i]=0;\n        else D[i]=1;\n        chmax(ans,D[i]?L-X[i]:X[i]);\n    }\n\n    deque<int>d,id;\n    deque<double>x;\n    rep(i,N)d.pb(D[i]),id.pb(i),x.pb(X[i]);\n\n    while(true){\n        double hoge=111111111;\n        rep(i,d.size()-1){\n            if(d[i]==0||d[i+1]==1)continue;\n            chmin(hoge,(x[i+1]-x[i])/2);\n        }\n        if(d[0]==0)chmin(hoge,x[0]);\n        if(d.back()==1)chmin(hoge,L-x.back());\n        rep(i,d.size()){\n            if(d[i])x[i]+=hoge;\n            else x[i]-=hoge;\n        }\n        rep(i,d.size()-1){\n            if(d[i]==0||d[i+1]==1)continue;\n            if(x[i+1]-x[i]<EPS){\n                bool f=false;\n                reps(j,1,L)if(abs(x[i]-j)<EPS)f=true;\n                if(f){\n                    d[i]=0;d[i+1]=1;\n                }\n                else{\n                    swap(d[i],d[i+1]);\n                    swap(id[i],id[i+1]);\n                }\n                i++;\n            }\n        }\n        if(L-x.back()<EPS){\n            if(d.size()==1){\n                cout<<ans<<\" \"<<id[0]+1<<endl;\n                return;\n            }\n            d.pop_back();id.pop_back();x.pop_back();\n        }\n        if(x.front()<EPS){\n            if(d.size()==1){\n                cout<<ans<<\" \"<<id[0]+1<<endl;\n                return;\n            }\n            d.pop_front();id.pop_front();x.pop_front();\n        }\n        //rep(i,d.size())cout<<d[i]<<\" \";cout<<\"||\";\n        //rep(i,id.size())cout<<id[i]+1<<\" \";cout<<endl;\n    }\n}\n\nsigned main(){\n    while(cin>>N>>L,N||L)solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n\n#define MP make_pair\n \nint main() {\n  \n  int N, L;\n  while(cin >> N >> L && (N|L)) {\n    vector<pair<int, int> > v;\n    rep(i, N) {\n      char d; int p; cin >> d >> p;\n      v.push_back(MP(d == 'R' ? +1 : -1, p));\n    }\n    \n    int time = 0;\n    int ans = -1;\n    int remain = N;\n    while(remain > 0) {\n      int ch[2*L+2]; memset(ch, 0, sizeof ch);\n      int *check = ch+L+1;\n      rep(i, N) {\n        v[i].second += v[i].first;\n        check[v[i].second] ++; \n      }\n      \n      rep(i, N) {\n        if(check[v[i].second] == 2) {\n          v[i].first *= -1;\n        }\n      }\n\n      bool f = 0;\n      rep(i, N) {\n        if(v[i].second == 0) {\n          remain --;\n          f = 1;\n          ans = i+1;\n        }\n        if(v[i].second == L) {\n          remain --;\n          if(!f) { ans = i+1; }\n        }\n      }\n      time ++;\n    }\n    cout << time << \" \" << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\n\nint main () {\n    int N, L;\n    while (cin >> N >> L, N || L) {\n        vec V[2];\n        V[0].resize(L + 2);\n        V[1].resize(L + 2);\n\n        for (int i = 1; i <= N; i++) {\n            char d; int p;\n            cin >> d >> p;\n            if (d == 'R') {\n                V[1][p] = i;\n            } else {\n                V[0][p] = i;\n            }\n        }\n        bool flag = true;\n        int ans = -1;\n        int t = -1;\n        for (int k = 0; k <= L; k++) {\n            for (int i = 1; i <= L + 1; i++)\n                V[0][i-1] = V[0][i];\n            for (int i = L + 1; i > 0; i--)\n                V[1][i] = V[1][i-1];\n            for (int i = 1; i <= L; i++) {\n                if (V[0][i] > 0 && V[1][i] > 0) {\n                    int tmp = V[0][i];\n                    V[0][i] = V[1][i];\n                    V[1][i] = tmp;\n                }\n            }\n            if (V[0][1] > 0) t = k + 2, ans = V[0][1];\n            else if (V[1][L-1] > 0) t = k + 2, ans = V[1][L-1];\n        }\n        cout << t << \" \" << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <ctime>\n#include <assert.h>\n#include <chrono>\n#include <random>\n#include <numeric>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned long long ull;\n\nmt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());\nll myRand(ll B) {\n    return (ull)rng() % B;\n}\n\nint main(){\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int n,l;\n    while(cin >> n >> l,n){\n        vector<pair<int,int>> v(n);\n        for(int i=0;i<n;i++){\n            char c; cin >> c;\n            cin >> v[i].first;\n            v[i].second=(c=='R'?1:-1);\n        }\n        int ti=0,id=-1;\n        while(1){\n            ti++;\n            for(int i=0;i<n;i++){\n                if(v[i].first==-1)continue;\n                v[i].first+=v[i].second;\n            }\n            int jd=-1;\n            for(int i=0;i<n;i++){\n                if(v[i].first==0||v[i].first==l){\n                    if(v[i].first==0)jd=i+1;\n                    else if(jd==-1)jd=i+1;\n                    v[i].first=-1;\n                }\n                else{\n                    for(int j=i+1;j<n;j++){\n                        if(v[i].first==v[j].first){\n                            swap(v[i].second,v[j].second);\n                            break;\n                        }\n                    }\n                }\n            }\n            id=jd;\n            bool ed=1;\n            for(int i=0;i<n;i++){\n                if(v[i].first!=-1){\n                    ed=0;\n                    break;\n                }\n            }\n            if(ed)break;\n        }\n        printf(\"%d %d\\n\",ti,id);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\n#include <utility>\nusing namespace std;\nconst int LEFT = 1;\nconst int RIGHT = 0;\n\nint main() {\n  int N, L;\n  while(cin >> N >> L, N || L) {\n    vector< tuple<int, int> > tup;\n    for(int i=0; i<N; i++) {\n      char c; int pos;\n      cin >> c >> pos;\n      tup.emplace_back(c == 'L', pos);\n    }\n\n    int step = 0, ans = -1;\n    while(1) {\n      step++;\n\n      \n      int ansL = -1, ansR = -1;\n      vector<int> cnt(L+1);\n      for(int i=0; i<N; i++) {\n        int dir, pos; tie(dir, pos) = tup[i];\n        // fprintf(stderr, \"step = %d, index = %d, dir = %d, pos = %d\\n\", step, i, dir, pos);\n        if(pos == 0 or pos == L) continue;\n        if(dir == LEFT) pos--;\n        else pos++;\n\n        if(1 <= pos and pos < L) {\n          cnt[pos]++;\n        }\n        else if(pos == 0) {\n          ansL = i+1;\n        }\n        else if(pos == L) {\n          ansR = i+1;\n        }\n\n        tup[i] = tuple<int, int>(dir, pos);\n      }\n\n      bool rem = false;\n      for(int i=0; i<N; i++) {\n        int dir, pos; tie(dir, pos) = tup[i];\n        if(pos == 0 or pos == L) continue;\n\n        rem = true;\n        if(cnt[pos] > 1) {\n          dir = 1 - dir;\n        }\n\n        tup[i] = tuple<int, int>(dir, pos);\n      }\n\n      if(ansR > 0) ans = ansR;\n      if(ansL > 0) ans = ansL;\n      if(!rem) break;\n    }\n    cout << step << \" \" << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  int N, L;\n  while(cin>>N>>L, N){\n\tVI d(N), p(N), gp[2];\n\tREP(i,N){\n\t  char ch; cin >> ch >> p[i];\n\t  d[i] = (ch == 'R'? 1: -1);\n\t  gp[p[i]%2].PB(i);\n\t}\n\n\tint id[2] = {0,0}, ans_t[2] = {0,0};\n\tfor(int g=0;g<2;++g){\n\t  bool up = true;\n\t  for(;up;++ans_t[g]){\n\t\tup = false;\n\t\tfor(int i=SZ(gp[g])-1;i>=0;--i){\n\t\t  int idx = gp[g][i];\n\t\t  int tx = p[idx] + d[idx];\n\t\t  if(tx < 0 || tx > L) continue;\n\t\t  if(tx == 0 || tx == L){\n\t\t\tp[idx] = tx;\n\t\t\tid[g] = (idx+1) * d[idx];\n\t\t\tcontinue;\n\t\t  }\n\n\t\t  up = true;\n\t\t  if(i > 0){\n\t\t\tint pidx = gp[g][i-1];\n\t\t\tif(p[pidx]+2 == p[idx] && d[pidx] == 1 && d[idx] == -1){\n\t\t\t  p[idx]--; d[idx] *= -1;\n\t\t\t  p[pidx]++; d[pidx] *= -1;\n\t\t\t  --i;\n\t\t\t  continue;\n\t\t\t}\n\t\t  }\n\t\t  p[idx] = tx;\n\t\t}\n\t  }\n\t}\n\tif(ans_t[0] < ans_t[1] || (ans_t[0] == ans_t[1] && id[1] < 0))\n\t  cout << ans_t[1] << \" \" << abs(id[1]) << endl;\n\telse\n\t  cout << ans_t[0] << \" \" << abs(id[0]) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint N, L;\nint Left[101], Right[101];\n\nbool Check()\n{\n  for(int i = 0; i < L; i++) {\n    if(Left[i] != 0) return(true);\n    if(Right[i] != 0) return(true);\n  }\n  return(false);\n}\n\nint main()\n{\n  while(cin >> N >> L, N) {\n    for(int i = 0; i < N; i++) {\n      char c;\n      int d;\n      cin >> c >> d;\n      if(c == 'L') Left[d] = i + 1;\n      else Right[d] = i + 1;\n    }\n    int last, time;\n    for(time = 0; Check(); ++time) {\n      for(int i = L; i > 0; i--) {\n        Right[i] = Right[i - 1];\n      }\n      for(int i = 1; i < L; i++) {\n        Left[i] = Left[i + 1];\n      }\n      if(Left[1] > 0) last = Left[1];\n      for(int i = 1; i < L; i++) {\n        if(Left[i] > 0 && Right[i] > 0) swap(Left[i], Right[i]);\n      }\n    }\n    cout << time << \" \" << last << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct Ant{\n    int num;\n    char direc;\n    Ant(){}\n    Ant(int num, char direc):num(num),direc(direc){}\n    bool operator<(const Ant& a) const{ return num < a.num; }\n    bool operator>(const Ant& a) const{ return num > a.num; }\n};\n\nint main(){\n    \n    while(1){\n        int n, l; cin >> n >> l;\n        if(!n) break;\n\n        vector<vector<set<Ant> > > tunnel(2, vector<set<Ant> > (l + 1));\n        \n\n        \n        for(int i = 1; i <= n; i++){\n            char d; cin >> d;\n            int loc; cin >> loc;\n            tunnel[0][loc].insert(Ant(i, d));\n        }\n\n        int t = 0;\n        int now = 0;\n        int next = 1;\n        for(;;){\n\n            /*de\n            cout << endl;\n            for(int i = 0; i <= l; i++){\n                cout << i << \": \";\n                for(auto ant : tunnel[now][i]){\n                    cout << \"(\" << ant.num << \", \" << ant.direc << \") \";\n                }\n                cout << endl;\n            }*/\n\n\n            int cnt_ant = 0;\n            for(int i = 1; i < l; i++){\n                cnt_ant += (int)tunnel[now][i].size();\n            }\n            if(cnt_ant == 0){\n                if(tunnel[now][0].size() == 1){\n                    for(auto ant : tunnel[now][0]){\n                        cout << t << \" \" << ant.num << endl;\n                    }\n                }else{\n                    for(auto ant : tunnel[now][l]){\n                        cout << t << \" \" << ant.num << endl;\n                    }\n                }\n\n                break;\n            }\n\n            for(int i = 1; i < l; i++){\n                for(auto ant : tunnel[now][i]){\n                    if(ant.direc == 'R'){\n                        tunnel[next][i + 1].insert(ant);\n                    }else{\n                        tunnel[next][i - 1].insert(ant);\n                    }\n                }\n            }\n\n            for(int i = 1; i < l; i++){\n                if(tunnel[next][i].size() == 2){\n                    set<Ant> tmp;\n                    for(auto ant : tunnel[next][i]){\n                        if(ant.direc == 'L') ant.direc = 'R';\n                        else ant.direc = 'L';\n                        tmp.insert(ant);\n                    }\n                    tunnel[next][i] = tmp;\n                }\n            }\n\n            t++;\n            swap(now, next);\n            for(int i = 0; i <= l; i++) tunnel[next][i].clear();\n        }\n\n\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main() {\n\n  while( true ) {\n\n    long long int n, l;\n    cin >> n >> l;\n    if ( n == 0 ) break;\n\n    vector< pair< long long int, long long int > > v;\n\n    for ( long long int i = 0; i < n; i++ ) {\n\n      char c;\n      long long int in;\n      cin >> c >> in;\n\n      if ( c == 'R' ) {\n\tv.push_back( make_pair( in, 1 ) );\n      }else {\n\t  v.push_back( make_pair( in, -1 ) );\n      }\n\n    }\n\n    long long int ans = 0;\n    long long int cnt;\n\n    for ( long long int j = 0; j <= 100; j++ ) {\n\n      long long int t[101] = {};\n\n      for ( long long int i = 0; i < n; i++ ) {\n\tif ( v[i].second != 0 ) {\n\t  v[i].first += v[i].second;\n\t  if ( v[i].first == 0 || v[i].first == l ) {\n\t    v[i].second = 0;\n\t    if ( v[i].first == 0 ) {\n\t      if ( ans <= j ) {\n\t\tans = j + 1;\n\t\tcnt = i + 1;\n\t      }\n\t    }else {\n\t      if ( ans < j ) {\n\t\tans = j + 1;\n\t\tcnt = i + 1;\n\t      }\n\t    }\n\t  }else if ( t[ v[i].first ] != 0 ) {\n\t    v[i].second *= -1;\n\t    v[ t[ v[i].first ] - 1 ].second *= -1;\n\t  }else {\n\t    t[ v[i].first ] = i + 1;\n\t  }\n\t}\n      }\n\n    }\n\n    cout << ans << \" \" << cnt << endl;\n\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n, l; cin >> n >> l && (n|l); ) {\n    l = l * 2 + 1;\n    vector<int> p(n), v(n), f(n);\n    for(int i = 0; i < n; ++i) {\n      char d;\n      cin >> d >> p[i];\n      p[i] *= 2;\n      v[i] = (d == 'L') ? -1 : 1;\n    }\n    int a, b;\n    for(int t = 1, k = 0; k < n; ++t) {\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        p[i] += v[i];\n      }\n      for(int i = 0; i < n; ++i) {\n        if(f[i]) continue;\n        for(int j = i+1; j < n; ++j) {\n          if(f[j]) continue;\n          if(p[i] == p[j]) {\n            v[i] *= -1; v[j] *= -1;\n          }\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == l) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n      for(int i = 0; i < n; ++i) {\n        if(!f[i] && p[i] == 0) {\n          f[i] = true;\n          ++k;\n          a = t/2; b = i+1;\n        }\n      }\n    }\n    cout << a << \" \" << b << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX 110\ntypedef pair<char,int> P;\n\nbool check(int ant[MAX],int L){\n  for(int i = 0 ; i < L ; i++){\n    if(ant[i] != 0) return false;\n  }\n  return true;\n}\n\nint main(){\n  int N,L,p;\n  char d;\n  while(cin >> N >> L, N){\n    int ant[MAX]={0};\n    vector<int> tunnel[MAX],id[MAX];\n    L--;\n    for(int i = 0 ; i < N ; i++){\n      cin >> d >> p;\n      ant[p-1]++;\n      id[p-1].push_back(i+1);\n      tunnel[p-1].push_back((d == 'L' ? 1 : 2));\n    }\n    int t = 0,last;\n    while(!check(ant,L)){\n      vector<int> next[MAX],nid[MAX];\n      last = -1;\n      for(int i = 0 ; i < L ; i++){\n        next[i].clear();\n        nid[i].clear();\n        if(ant[i] && last == -1){\n          last = id[i][0];\n        }\n      }\n      for(int i = 0 ; i < L ; i++){\n        while(tunnel[i].size()){\n          if(tunnel[i][0] == 1){\n            tunnel[i].erase(tunnel[i].begin());\n            if(i-1 >= 0){\n              next[i-1].push_back(1);\n              nid[i-1].push_back(id[i][0]);\n              id[i].erase(id[i].begin());\n            }\n          }else if(tunnel[i][0] == 2){\n            tunnel[i].erase(tunnel[i].begin());\n            if(i+1 < L){\n              next[i+1].push_back(2);\n              nid[i+1].push_back(id[i][0]);\n              id[i].erase(id[i].begin());\n            }\n          }\n        }\n      }\n      for(int i = 0 ; i < L ; i++){\n        tunnel[i] = next[i];\n        id[i] = nid[i];\n        if(tunnel[i].size() == 2){\n          swap(tunnel[i][0],tunnel[i][1]);\n        }\n        ant[i] = tunnel[i].size();\n      }\n      t++;\n    }\n    cout << t << \" \" << last << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    while(1){\n        int n,l;\n        cin >> n >> l;\n        if(n==0) break;\n\n        vector<int> d(n), p(n);\n        int time = 0;\n        for(int i=0; i<n; i++){\n            char dir;\n            int pos;\n            cin >> dir >> pos;\n            if(dir == 'L'){\n                d[i]=-1;\n                time = max(time, pos);\n            }else{\n                d[i]=1;\n                time = max(time, l-pos);\n            }\n            p[i] = pos*2;\n        }\n\n        for(int t=1; t<=time*2; t++){\n            for(int i=0; i<n; i++){\n                p[i] += d[i];\n            }\n            for(int i=0; i<n; i++){\n                for(int j=i+1; j<n; j++){\n                    if(p[i]==p[j]){\n                        if(t%2==0){ //narrow\n                            d[i] = -d[i];\n                            d[j] = -d[j];\n                        }\n                    }\n                }\n            }\n        }\n\n        int last;\n        for(int i=0; i<n; i++){\n            if(p[i]==l*2) last=i+1;\n        }\n        for(int i=0; i<n; i++){\n            if(p[i]==0) last=i+1;\n        }\n        cout << time << \" \" << last << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n#include <iostream>\n#include <vector>\n#include <stdio.h>\n#include <bits/stdc++.h>\n\n\nusing namespace std;\n#define ll long long\n#define ld long double\n#define  P pair<ll,ll>\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORa(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define FORr(i,m,n) for(ll i=n; i>=(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define FORs(i,st) for(auto i : st)\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define ALL(c) (c).begin(), (c).end()\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,l;\n    cin>>n>>l;\n    while(n!=0){\n      ll res=0;\n      ll most_left_1 = 0;\n      ll most_right_1 = 0;\n      ll num_left_1 = -1;\n      ll most_left_2 = 0;\n      ll most_right_2 = 0;\n      ll num_left_2 = -1;\n\n      vector<ll> ant1;\n      vector<ll> ant2;\n      FOR(i,0,n){\n        char c;\n        ll p;\n        cin>>c>>p;\n        res = (c == 'L' ? max(res,p) : max(res,l-p));\n        if(p % 2 == 0){\n          if(c == 'L'){\n            num_left_1++;\n            most_left_1 = max(most_left_1, p);\n          }\n          else most_right_1 = max(most_right_1, l-p);\n          ant1.push_back(i);\n        }\n        else{\n          if(c == 'L'){\n            num_left_2++;\n            most_left_2 = max(most_left_2, p);\n          }\n          else most_right_2 = max(most_right_2, l-p);\n          ant2.push_back(i);\n        }\n      }\n      ll flag1 = 1;\n      if(most_left_1<most_right_1){\n        num_left_1++;\n        flag1=0;\n      }\n      if(most_left_2<most_right_2){\n        num_left_2++;\n      }\n      ll x = max(most_left_1,most_right_1);\n      ll y = max(most_left_2,most_right_2);\n//      cout<<x<<\" \"<<y<<endl;\n      ll ans = (x>y ? ant1[num_left_1] : ant2[num_left_2]);\n      if(x==y) ans = (flag1 ? ant1[num_left_1] : ant2[num_left_2]);\n\n//      cout<<num_left_1<<\" \"<<num_left_2<<endl;\n      cout<<res<<\" \"<<ans+1<<endl;\n      cin>>n>>l;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main(){\n  while(true){\n    int n, l;\n    cin >> n >> l;\n    if(n == 0) break;\n    vector<char> dirs(n);\n    vector<int> pos(n);\n    vector<bool> alive(n, true);\n    for(int i=0;i<n;i++){\n      cin >> dirs[i] >> pos[i];\n    }\n    int cnt = 0;\n    for(int t=1;t<=l+2;t++){\n      int last_dead = -1;\n      for(int i=n-1;i>=0;i--){\n        if(!alive[i]) continue;\n        pos[i] += dirs[i] == 'L' ? -1 : 1;\n        if(pos[i] == 0 || pos[i] == l){\n          cnt++;\n          last_dead = i;\n        }\n      }\n      for(int i=0;i<n;i++){\n        for(int j=i+1;j<n;j++){\n          if(pos[i] == pos[j]){\n            swap(dirs[i], dirs[j]);\n          }\n        }\n      }\n      if(cnt == n){\n        assert(last_dead != -1);\n        cout << t << \" \" << last_dead + 1 << endl;\n        break;\n      }\n    }\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<queue>\n#include<stack>\n#include<algorithm>\n#include<set>\n#include<ctime>\nusing namespace std;\nint n,l;\nstruct array\n{\n    int x,y;\n    int flag;\n    int anstime;\n} s[22];\nint g[22],num;\nint main()\n{\n    int i,j,d;\n    char t[2];\n    while(scanf(\"%d%d\",&n,&l)!=EOF)\n    {\n        if(n==0&&l==0)break;\n        num=0;\n        for(i=1; i<=n; i++)\n        {\n            scanf(\"%s%d\",t,&d);\n            if(t[0]=='L')\n                s[i].x=-1;\n            else\n                s[i].x=1;\n            s[i].y=d;\n            s[i].flag=0;\n            g[num++]=i;\n            s[i].anstime=0;\n        }\n//        for(i=0;i<num;i++)\n//            cout<<g[i]<<\"()\"<<endl;\n        while(1)\n        {\n            int a=-1,b=-1;\n            double tmp=l+1;\n            for(int _i=0; _i<num; _i++)\n            {\n                for(int _j=_i+1; _j<num; _j++)\n                {\n                    i = g[_i];\n                    j = g[_j];\n                    if(s[i].y<s[j].y&&s[i].x==1&&s[j].x==-1)\n                    {\n                        int gg = (s[j].y-s[i].y)/2;\n                        if((s[j].y-s[i].y)%2==0)\n                        {\n                            if(s[j].y-s[i].y<tmp)\n                            {\n                                tmp=s[j].y-s[i].y;\n                                a=i;\n                                b=j;\n                            }\n                        }\n                    }\n\n                    if(s[i].y>s[j].y&&s[i].x==-1&&s[j].x==1)\n                    {\n                        int gg = (s[i].y-s[j].y)/2;\n                        if((s[i].y-s[j].y)%2==0)\n                        {\n                            if(s[i].y-s[j].y<tmp)\n                            {\n                                tmp=s[i].y-s[j].y;\n                                a=j;\n                                b=i;\n                            }\n                        }\n                    }\n                }\n            }\n\n//            cout<<a<<\"*\"<<b<<endl;\n            if(a!=-1)\n            {\n                int tim = (s[b].y-s[a].y)/2;\n                for(i=0; i<num; i++)\n                {\n                    int t1=0;\n                    if(s[g[i]].x==-1)\n                    {\n                        t1 = s[g[i]].y;\n                    }\n                    else\n                        t1 = (l-s[g[i]].y);\n                    if(t1<tim)\n                    {\n                        s[g[i]].anstime+=t1;\n                        s[g[i]].flag=1;\n                        continue;\n                    }\n                    else\n                    {\n                        s[g[i]].anstime+=tim;\n                        s[g[i]].y+=s[g[i]].x*tim;\n                        if(s[g[i]].y<=0||s[g[i]].y>=l+1)\n                        {\n                            s[g[i]].flag=1;\n                            continue;\n                        }\n                    }\n                    if(g[i]==a||g[i]==b)\n                        s[g[i]].x=-s[g[i]].x;\n                }\n            }\n            else\n            {\n                for(i=0; i<num; i++)\n                {\n                    int t1=0;\n                    if(s[g[i]].x==-1)\n                    {\n                        t1 = s[g[i]].y*1.0;\n                    }\n                    else\n                        t1 = (l-s[g[i]].y);\n                    s[g[i]].anstime += t1;\n                    s[g[i]].flag=1;\n                }\n            }\n//            for(i=1;i<=n;i++)\n//            {\n//                cout<<i<<\"++\"<<s[i].x<<\" \"<<s[i].y<<\"  \"<<s[i].flag<<\n//                \" = \"<<s[i].anstime<<endl;\n//            }\n\n            int _num=num;\n            num=0;\n            for(i=0; i<_num; i++)\n            {\n                if(s[g[i]].flag)continue;\n                else\n                    g[num++]=g[i];\n            }\n            if(num==0)break;\n        }\n        int ans=0;\n        int anstime =-1;\n        for(i=1;i<=n;i++)\n        {\n            if(anstime<s[i].anstime)\n            {\n                anstime=s[i].anstime;\n                ans=i;\n            }\n            else if(anstime==s[i].anstime)\n            {\n                if(s[i].x==-1)\n                    ans=i;\n            }\n            //cout<<s[i].anstime<<endl;\n        }\n        printf(\"%d %d\\n\",anstime,ans);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nstruct node {int id, way, p;};\nstruct qry {int x, y, val;};\nconst int maxn = 100;\nnode d[maxn];\nqry a[10000];\nint n, l, cnt;\n\nbool cmp(const qry &a, const qry &b)\n{\n    return a.val < b.val;\n}\n\nvoid input()\n{\n    char ml[2];\n    int tmp;\n    for (int i = 1; i <= n; ++i)\n    {\n        cin >> ml >> tmp;\n        d[i] = (node) {i, ml[0] == 'R', tmp};\n    }\n}\n\nvoid solve()\n{\n    cnt = 0;\n    for (int i = 1; i < n; ++i)\n        for (int j = i + 1; j <= n; ++j)\n            if (d[i].way == 1 && d[j].way == 0 && (d[j].p - d[i].p) % 2 == 0)\n                a[cnt++] = (qry) {i, j, d[j].p - d[i].p};\n    sort(a, a + cnt, cmp);\n    int ans1 = 0, ans2;\n    for (int i = 0; i < cnt; ++i)\n        swap(d[a[i].x].id, d[a[i].y].id);\n    for (int i = 1; i <= n; ++i)\n    {\n        int time = d[i].way ? l - d[i].p : d[i].p;\n        if (time > ans1)\n        {\n            ans1 = time;\n            ans2 = d[i].id;\n        }\n        else if (time == ans1 && d[i].way == 0)\n            ans2 = d[i].id;\n    }\n    cout << ans1 << ' ' << ans2 << endl;\n}\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    while (cin >> n >> l && n)\n    {\n        input();\n        solve();\n    }\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tint n,l,tun[102],pos[21],dir[21],sec,i,j,last,exi;\n\tchar x[9];\n\twhile(1){\n\t\tfor(i=0;i<102;i++){\n\t\t\ttun[i]=0;\n\t\t}\n\t\tfor(i=0;i<21;i++){\n\t\t\tpos[i]=dir[i]=0;\n\t\t}\n\t\tsec=0;\n\t\texi=0;\n\t\tscanf(\"%d %d\",&n,&l);\n\t\tif(n==0&&l==0){\n\t\t\tbreak;\n\t\t}\n\t\tfor(i=1;i<=n;i++){\n\t\t\tscanf(\"%s %d\",&x,&pos[i]);\n\t\t\tif(x[0]=='R'){\n\t\t\t\tdir[i]=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdir[i]=-1;\n\t\t\t}\n\t\t}\n\t\twhile(1){\n\t\t\tsec++;\n\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\tif(pos[i]==1000){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tpos[i]+=dir[i];\n\t\t\t\ttun[pos[i]]++;\n\t\t\t}\n\t\t\tfor(i=1;i<l;i++){\n\t\t\t\tif(tun[i]>1){\n\t\t\t\t\tfor(j=1;j<=n;j++){\n\t\t\t\t\t\tif(pos[j]==i){\n\t\t\t\t\t\t\tdir[j]=dir[j]*(-1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(tun[l]!=0||tun[0]!=0){\n\t\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\t\tif(pos[i]==l){\n\t\t\t\t\t\tpos[i]=1000;\n\t\t\t\t\t\tdir[i]=0;\n\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\texi++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(exi==n){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\t\tif(pos[i]==0){\n\t\t\t\t\t\tpos[i]=1000;\n\t\t\t\t\t\tdir[i]=0;\n\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\texi++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(exi==n){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(i=0;i<102;i++){\n\t\t\t\ttun[i]=0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\",sec,last);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 1336: The Last Ant\n// 2017.12.16 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint l[102], r[102];\n\nint main()\n{\n\tint N, L, i, p, t, last;\n\tchar buf[5];\n\n\twhile (scanf(\"%d%d\", &N, &L) && N > 0) {\n\t\tmemset(l, 0, sizeof(l)), memset(r, 0, sizeof(r));\n\t\tfor (i = 1; i <= N; i++) {\n\t\t\tscanf(\"%s%d\", buf, &p);\n\t\t\tif (*buf == 'L') l[p] = i;\n\t\t\telse             r[p] = i;\n\t\t}\n\n\t\tfor (last = 0, t = -1; N > 0; t++) {\n\t\t\tif (r[L]) last = r[L], r[L] = 0, N--;\n\t\t\tfor (i = L-1; i >= 0; i--) r[i+1] = r[i];\n\n\t\t\tif (l[0]) last = l[0], l[0] = 0, N--;\n\t\t\tfor (i = 1; i <= L; i++) {\n\t\t\t\tif (!l[i]) continue;\n\t\t\t\tif (r[i-1]) {\n\t\t\t\t\tl[i-1] = r[i-1], r[i-1] = l[i];\n\t\t\t\t} else l[i-1] = l[i];\n\t\t\t\tl[i] = 0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\", t, last);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\ntypedef struct {\n\tint is_left;\n\tint pos;\n\tint alive;\n} ant_t;\n\nint solve(void) {\n\tint n, l;\n\tant_t ants[30];\n\tint i;\n\tint e_time = 0;\n\tint last_ant = 0;\n\tif (scanf(\"%d%d\", &n, &l) != 2 || (n == 0 && l == 0)) return 0;\n\tfor (i = 0; i < n; i++) {\n\t\tchar d[4];\n\t\tif (scanf(\"%s%d\", d, &ants[i].pos) != 2) return 0;\n\t\tants[i].is_left = (d[0] == 'L');\n\t\tants[i].alive = 1;\n\t}\n\tfor (;;) {\n\t\tint ant_lives = 0;\n\t\tint ant_count[110] = {};\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tif (ants[i].alive) {\n\t\t\t\tant_lives = 1;\n\t\t\t\tif (ants[i].is_left) {\n\t\t\t\t\tants[i].pos--;\n\t\t\t\t} else {\n\t\t\t\t\tants[i].pos++;\n\t\t\t\t}\n\t\t\t\tant_count[ants[i].pos]++;\n\t\t\t}\n\t\t}\n\t\tif (!ant_lives) break;\n\t\te_time++;\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tif (ants[i].alive && ants[i].pos == l) {\n\t\t\t\tants[i].alive = 0;\n\t\t\t\tlast_ant = i;\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tif (ants[i].alive) {\n\t\t\t\tif (ants[i].pos == 0) {\n\t\t\t\t\tants[i].alive = 0;\n\t\t\t\t\tlast_ant = i;\n\t\t\t\t} else if(ant_count[ants[i].pos] > 1) {\n\t\t\t\t\tants[i].is_left = !ants[i].is_left;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\", e_time, last_ant + 1);\n\treturn 1;\n}\n\nint main(void) {\n\twhile(solve());\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tint n,l,tun[102],pos[21],dir[21],sec,i,j,last,exit;\n\tchar x[9];\n\twhile(1){\n\t\tfor(i=0;i<102;i++){\n\t\t\ttun[i]=0;\n\t\t}\n\t\tfor(i=0;i<21;i++){\n\t\t\tpos[i]=dir[i]=0;\n\t\t}\n\t\tsec=0;\n\t\texit=0;\n\t\tscanf(\"%d %d\",&n,&l);\n\t\tif(n==0&&l==0){\n\t\t\tbreak;\n\t\t}\n\t\tfor(i=1;i<=n;i++){\n\t\t\tscanf(\"%s %d\",&x,&pos[i]);\n\t\t\tif(x[0]=='R'){\n\t\t\t\tdir[i]=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdir[i]=-1;\n\t\t\t}\n\t\t}\n\t\twhile(1){\n\t\t\tsec++;\n\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\tif(pos[i]==1000){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tpos[i]+=dir[i];\n\t\t\t\ttun[pos[i]]++;\n\t\t\t}\n\t\t\tfor(i=1;i<l;i++){\n\t\t\t\tif(tun[i]>1){\n\t\t\t\t\tfor(j=1;j<=n;j++){\n\t\t\t\t\t\tif(pos[j]==i){\n\t\t\t\t\t\t\tdir[j]=dir[j]*(-1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(tun[l]!=0||tun[0]!=0){\n\t\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\t\tif(pos[i]==l){\n\t\t\t\t\t\tpos[i]=1000;\n\t\t\t\t\t\tdir[i]=0;\n\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\texit++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(exit==n){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tfor(i=1;i<=n;i++){\n\t\t\t\t\tif(pos[i]==0){\n\t\t\t\t\t\tpos[i]=1000;\n\t\t\t\t\t\tdir[i]=0;\n\t\t\t\t\t\tlast=i;\n\t\t\t\t\t\texit++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(exit==n){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(i=0;i<102;i++){\n\t\t\t\ttun[i]=0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d %d\\n\",sec,last);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nvoid swap(int* a, int* b) { int c = *a; *a = *b; *b = c; }\n\nint main(void) {\n\tint n, l;\n\tint tunnel_l[101], tunnel_r[101]; /* トンネルの状態 */\n\tint t, lastant;\n\tint i;\n\n\t/* データセット毎の処理 */\n\twhile (scanf(\"%d%d\", &n, &l) == 2 && n >= 1 && n <= 20 && l >= n + 1 && l <= 100) {\n\t\t/* 初期化する */\n\t\tfor (i = 0; i < l + 1; i++) {\n\t\t\ttunnel_l[i] = 0;\n\t\t\ttunnel_r[i] = 0;\n\t\t}\n\t\tt = 0;\n\n\t\t/* アリを読み込む */\n\t\tfor (i = 1; i <= n; i++) {\n\t\t\tchar d; int p;\n\t\t\tscanf(\"%1s%d\", &d, &p);\n\t\t\tif (d == 'L') tunnel_l[p] = i; /* 左向きのアリを入れる配列 */\n\t\t\telse if (d == 'R') tunnel_r[p] = i; /* 右向きのアリを入れる配列 */\n\t\t}\n\n\t\t/* アリの動きをシミュレートする */\n\t\tint f = 1;\n\t\twhile (f) {\n\t\t\tt++;\n\t\t\t/* アリを歩かせる */\n\t\t\tfor (i = 0; i <= l - 1; i++) {\n\t\t\t\ttunnel_l[i] = tunnel_l[i+1];\n\t\t\t\ttunnel_r[l-i] = tunnel_r[l-i-1];\n\t\t\t}\n\t\t\t/* 衝突を判定する */\n\t\t\tfor (i = 1; i <= l - 1; i++) {\n\t\t\t\tif (tunnel_l[i] && tunnel_r[i]) swap(tunnel_l + i, tunnel_r + i); /* 衝突した2匹の向きを変える */\n\t\t\t}\n\n\t\t\t/* 全てのアリがトンネルを出たか調べる */\n\t\t\tf = 0;\n\t\t\tfor (i = 1; i <= l - 1; i++) {\n\t\t\t\tif (tunnel_l[i] || tunnel_r[i]) {\n\t\t\t\t\tf = 1; /* トンネルにアリがいる */\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f == 0) {\n\t\t\t\t/* シミュレーション終了 */\n\t\t\t\tif (tunnel_l[0]) lastant = tunnel_l[0];\n\t\t\t\telse lastant = tunnel_r[l];\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%d %d\\n\", t, lastant);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.Closeable;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.PrintWriter;\nimport java.math.BigInteger;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.LinkedHashMap;\nimport java.util.LinkedHashSet;\nimport java.util.LinkedList;\nimport java.util.Map;\nimport java.util.Map.Entry;\nimport java.util.PriorityQueue;\nimport java.util.StringTokenizer;\nimport java.util.TreeSet;\n \npublic class Main {\n\t\n\tpublic static class Ant {\n\t\tint pos, id, dir;\n\t\tboolean turned;\n\t\t\n\t\tpublic Ant(int id, int pos, int dir) {\n\t\t\tthis.id = id;\n\t\t\tthis.pos = pos;\n\t\t\tthis.dir = dir;\n\t\t\tthis.turned = false;\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true){\n\t\t\tfinal int n = sc.nextInt();\n\t\t\tfinal int l = sc.nextInt();\n\t\t\t\n\t\t\tif(n == 0 || l == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tArrayList<Ant> ants = new ArrayList<Ant>();\n\t\t\tArrayList<Ant> nexts = new ArrayList<Ant>();\n\t\t\t\n\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\tfinal String dir = sc.next();\n\t\t\t\tfinal int pos = sc.nextInt();\n\t\t\t\t\n\t\t\t\tif(\"L\".equals(dir)){\n\t\t\t\t\tants.add(new Ant((i + 1), pos, -1));\n\t\t\t\t}else{\n\t\t\t\t\tants.add(new Ant((i + 1), pos, 1));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint answer_time = 0, answer_num = 0;\n\t\t\tfor(int time = 0; !ants.isEmpty(); time++){\n\t\t\t\tfor(final Ant ant : ants){\n\t\t\t\t\tant.pos += ant.dir;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(Iterator<Ant> ant_itr = ants.iterator(); ant_itr.hasNext(); ){\n\t\t\t\t\tfinal Ant ant = ant_itr.next();\n\t\t\t\t\t\n\t\t\t\t\tif(ant.pos > l){\n\t\t\t\t\t\tanswer_time = time;\n\t\t\t\t\t\tanswer_num = ant.id;\n\t\t\t\t\t\tant_itr.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(Iterator<Ant> ant_itr = ants.iterator(); ant_itr.hasNext(); ){\n\t\t\t\t\tfinal Ant ant = ant_itr.next();\n\t\t\t\t\t\n\t\t\t\t\tif(ant.pos < 0){\n\t\t\t\t\t\tanswer_time = time;\n\t\t\t\t\t\tanswer_num = ant.id;\n\t\t\t\t\t\tant_itr.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(final Ant ant_1 : ants){\n\t\t\t\t\tif(ant_1.turned){ continue; }\n\t\t\t\t\t\n\t\t\t\t\tfor(final Ant ant_2 : ants){\n\t\t\t\t\t\tif(ant_2.turned){ continue; }\n\t\t\t\t\t\tif(ant_1 == ant_2){ continue; }\n\t\t\t\t\t\tif(ant_1.pos != ant_2.pos){ continue; }\n\t\t\t\t\t\t\n\t\t\t\t\t\tant_1.turned = ant_2.turned = true;\n\t\t\t\t\t\tant_1.dir = -ant_1.dir;\n\t\t\t\t\t\tant_2.dir = -ant_2.dir;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(final Ant ant : ants){\n\t\t\t\t\tant.turned = false;\n\t\t\t\t\t//System.out.println(ant.id + \" \" + ant.pos + \" \" + ant.dir);\n\t\t\t\t}\n\t\t\t\t//System.out.println();\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(answer_time + \" \" + answer_num);\n\t\t}\n\t\t\n\t}\n \n\tpublic static class Scanner implements Closeable {\n\t\tprivate BufferedReader br;\n\t\tprivate StringTokenizer tok;\n \n\t\tpublic Scanner(InputStream is) throws IOException {\n\t\t\tbr = new BufferedReader(new InputStreamReader(is));\n\t\t}\n \n\t\tprivate void getLine() throws IOException {\n\t\t\twhile (!hasNext()) {\n\t\t\t\ttok = new StringTokenizer(br.readLine());\n\t\t\t}\n\t\t}\n \n\t\tprivate boolean hasNext() {\n\t\t\treturn tok != null && tok.hasMoreTokens();\n\t\t}\n \n\t\tpublic String next() throws IOException {\n\t\t\tgetLine();\n\t\t\treturn tok.nextToken();\n\t\t}\n \n\t\tpublic int nextInt() throws IOException {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n \n\t\tpublic long nextLong() throws IOException {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n \n\t\tpublic void close() throws IOException {\n\t\t\tbr.close();\n\t\t}\n\t}\n \n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        while (b) {\n            b = runOnce(reader);\n        }\n\n        reader.close();\n    }\n\n    private boolean runOnce(BufferedReader reader) throws IOException {\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    private void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n\n        int index = (deleted.size() == 2) ? (deleted.get(0).left ? deleted.get(0).index : deleted.get(1).index) : deleted.get(0).index;\n        System.out.println(count + \" \" + index);\n    }\n\n    private List<Ant> update(List<Ant> ants, int length) {\n        final Map<Integer, Ant> map = new HashMap<>();\n        final ArrayList<Ant> outList = new ArrayList<>();\n        for (final Ant ant : ants) {\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if (map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if (ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        ants.removeAll(outList);\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0) {\n\t\t\t\tsc.close();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint l = sc.nextInt();\n\n\t\t\tchar[] dir = new char[n];\n\t\t\tint[] place = new int[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tdir[i] = sc.next().charAt(0);\n\t\t\t\tplace[i] = sc.nextInt();\n\t\t\t}\n\n\t\t\tint time = 0;\n\t\t\twhile (true) {\n\t\t\t\ttime++;\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (place[i] < 1 && place[i] >= l) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (dir[i] == 'R') {\n\t\t\t\t\t\tplace[i]++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tplace[i]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tArrayList<Integer> inside = new ArrayList<Integer>();\n\t\t\t\tfor (int p = 1; p < l; p++) {\n\t\t\t\t\tArrayList<Integer> list = new ArrayList<Integer>();\n\t\t\t\t\tfor (int ant = 0; ant < n; ant++) {\n\t\t\t\t\t\tif (place[ant] == p) {\n\t\t\t\t\t\t\tlist.add(ant);\n\t\t\t\t\t\t\tinside.add(ant);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ぶつかった奴は向きを変える\n\t\t\t\t\tif (list.size() >= 2) {\n\t\t\t\t\t\tfor (Integer ant : list) {\n\t\t\t\t\t\t\tif (dir[ant] == 'R') {\n\t\t\t\t\t\t\t\tdir[ant] = 'L';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdir[ant] = 'R';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (inside.size() == 1) {\n\t\t\t\t\t// 最後に残っているアリが1匹いた場合\n\t\t\t\t\tint ant = inside.get(0);\n\t\t\t\t\tif (dir[ant] == 'R') {\n\t\t\t\t\t\t// 右向きならtimeにplace[ant]がlになるまでの時間を足す\n\t\t\t\t\t\tint rest = l - place[ant];\n\t\t\t\t\t\tSystem.out.println((time + rest) + \" \" + (ant + 1));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 左向きならtimeにplace[ant]が0になるまでの時間を足す\n\t\t\t\t\t\tSystem.out.println((time + place[ant]) + \" \"\n\t\t\t\t\t\t\t\t+ (ant + 1));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (inside.size() == 2) {\n\t\t\t\t\tint antL = inside.get(0);\n\t\t\t\t\tint antR = inside.get(1);\n\n\t\t\t\t\tif (dir[antL] == 'L' && place[antL] == 1\n\t\t\t\t\t\t\t&& dir[antR] == 'R' && place[antR] == l - 1) {\n\t\t\t\t\t\t// 2匹同時退出の場合、左側のアリを出力\n\t\t\t\t\t\tSystem.out.println((time + 1) + \" \" + (antL + 1));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif ((n | l) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAnt[] ant = new Ant[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tant[i] = new Ant(i + 1, sc.next(), sc.nextDouble(), false);\n\t\t\t}\n\t\t\tint cnt = 0;\n\t\t\tint last = 0;\n\t\t\tdouble time = 0;\n\t\t\tdouble tmp = 0;\n\t\t\twhile (cnt != n) {\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave) {\n\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\tant[i].dis += 0.5;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tant[i].dis -= 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = i + 1; j < n; j++) {\n\t\t\t\t\t\tif (ant[i].leave || ant[j].leave) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ant[i].dis == ant[j].dis) {\n\t\t\t\t\t\t\tif (ant[i].dis * 10 % 10 != 5) {\n\t\t\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"L\";\n\t\t\t\t\t\t\t\t\tant[j].dir = \"R\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"R\";\n\t\t\t\t\t\t\t\t\tant[j].dir = \"L\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave && (ant[i].dis == 0 || ant[i].dis == l)) {\n\t\t\t\t\t\tant[i].leave = true;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (time == tmp && ant[i].dir.equals(\"L\")) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t} else if (tmp == 0) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmp = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime += 0.5;\n\t\t\t}\n\t\t\tSystem.out.println((int) time + \" \" + last);\n\t\t}\n\t}\n\n\tclass Ant {\n\t\tint num;\n\t\tString dir;\n\t\tdouble dis;\n\t\tboolean leave;\n\n\t\tpublic Ant(int num, String dir, double dis, boolean leave) {\n\t\t\tsuper();\n\t\t\tthis.num = num;\n\t\t\tthis.dir = dir;\n\t\t\tthis.dis = dis;\n\t\t\tthis.leave = leave;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(int[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\nclass Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    void run() throws IOException {\n        while (runOnce()) {\n\n        }\n    }\n\n    boolean runOnce() throws IOException {\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n            list.add(a);\n        }\n        exec(list, length);\n        reader.close();\n        return true;\n    }\n\n    void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    List<Ant> update(List<Ant> ants, int length) {\n        Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        public Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main{\n\tpublic void solve(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[] pos = new int[20];\n\t\tint[] d = new int[20];\n\t\tint[] exit = new int[20];\n\t\twhile(true){\n\t\t\tint N = sc.nextInt();\n\t\t\tint L = sc.nextInt();\n\t\t\tif(N == 0 && L == 0) break;\n\t\t\tfor(int i = 0; i < N; i++){\n\t\t\t\td[i] = sc.next().equals(\"L\") ? -1 : 1;\n\t\t\t\tpos[i] = sc.nextInt();\n\t\t\t}\n\t\t\tboolean flg = true;\n\t\t\tint time = 0;\n\t\t\twhile(flg){\n\t\t\t\tflg = false;\n\t\t\t\ttime++;\n\t\t\t\tfor(int i = 0; i < N; i++){\n\t\t\t\t\tif(pos[i] != -1){\n\t\t\t\t\t\tpos[i] += d[i];\n\t\t\t\t\t\tif(pos[i] == 0 || pos[i] == L){\n\t\t\t\t\t\t\tpos[i] = -1;\n\t\t\t\t\t\t\texit[i] = time;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tflg = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int i = 0; i < N; i++){\n\t\t\t\t\tif(pos[i] == -1) continue;\n\t\t\t\t\tfor(int j = i + 1; j < N; j++){\n\t\t\t\t\t\tif(pos[j] == -1) continue;\n\t\t\t\t\t\tif(pos[i] == pos[j]){\n\t\t\t\t\t\t\td[i] *= -1;\n\t\t\t\t\t\t\td[j] *= -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint last = 0;\n\t\t\tint li = 0;\n\t\t\tfor(int i = 0; i < N; i++){\n\t\t\t\tif(exit[i] > last){\n\t\t\t\t\tli = i;\n\t\t\t\t\tlast = exit[i];\n\t\t\t\t}else if(exit[i] == last && d[i] == -1){\n\t\t\t\t\tli = i;\n\t\t\t\t\tlast = exit[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(last + \" \" + (li + 1));\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args){\n\t\tnew Main().solve();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        while (b) {\n            b = runOnce(reader);\n        }\n\n        reader.close();\n    }\n\n    private boolean runOnce(BufferedReader reader) throws IOException {\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    private void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(deleted.size() - 1).index);\n    }\n\n    private List<Ant> update(List<Ant> ants, int length) {\n        final Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        while (b) {\n            b = runOnce();\n        }\n    }\n\n    private boolean runOnce() throws IOException {\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        reader.close();\n        return true;\n    }\n\n    private void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    private List<Ant> update(List<Ant> ants, int length) {\n        final Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.lang.ArrayIndexOutOfBoundsException;\nimport java.math.BigInteger;\n\n/**\n * @author yoshikyoto\n */\nclass Main extends MyUtil{\n\tstatic int n;\n\tstatic long mod = 1L << 32;\n\t\n\tpublic static void main(String[] args) throws Exception{\n\t\tScanner sc = new Scanner(new InputStreamReader(System.in));\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tint m = sc.nextInt();\n\t\t\tif(n+m == 0) break; \n\t\t\t\n\t\t\tint[] lant = new int[m+1];\n\t\t\tint[] rant = new int[m+1];\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tchar dir = sc.next().charAt(0);\n\t\t\t\tint x = sc.nextInt();\n\t\t\t\t\n\t\t\t\tif(dir =='R'){\n\t\t\t\t\trant[x] = i;\n\t\t\t\t}else{\n\t\t\t\t\tlant[x] = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// System.out.println(Arrays.toString(rant));\n\t\t\t// System.out.println(Arrays.toString(lant));\n\t\t\t// System.out.println();\n\t\t\t\n\t\t\t// ????????\\??¬????????§???????§?\n\t\t\tint last_ant = 0;\n\t\t\tint cnt = 0;\n\t\t\twhile(check(rant, lant)){\n\t\t\t\tcnt++;\n\t\t\t\t\n\t\t\t\tif(rant[m] != 0){\n\t\t\t\t\tlast_ant = rant[m];\n\t\t\t\t\trant[m] = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(int i = m-1; i >= 0; i--){\n\t\t\t\t\trant[i+1] = rant[i];\n\t\t\t\t\trant[i] = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(lant[0] != 0){\n\t\t\t\t\tlast_ant = lant[0];\n\t\t\t\t\tlant[0] = 0;\n\t\t\t\t}\n\t\t\t\tfor(int i = 1; i <= m; i++){\n\t\t\t\t\tif(lant[i] == 0) continue;\n\t\t\t\t\tif(rant[i-1] != 0){\n\t\t\t\t\t\tlant[i-1] = rant[i-1];\n\t\t\t\t\t\trant[i-1] = lant[i];\n\t\t\t\t\t\tlant[i] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlant[i-1] = lant[i];\n\t\t\t\t\t\tlant[i] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// System.out.println(Arrays.toString(rant));\n\t\t\t\t// System.out.println(Arrays.toString(lant));\n\t\t\t\t// System.out.println();\n\t\t\t}\n\t\t\tcnt--;\n\t\t\tSystem.out.println(cnt + \" \" + last_ant);\n\t\t}\n\t\tsc.close();\n\t}\n\t\n\tstatic boolean check(int[] a, int[] b){\n\t\tfor(int i = 0; i < a.length; i++){\n\t\t\tif(a[i] != 0) return true;\n\t\t\tif(b[i] != 0) return true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\n\nclass Node{\n\tstatic Node prev;\n\t// next??????????????????\n\tNode parent, child, next;\n\tint depth = 0;\n\tString name;\n\t\n\tpublic Node(String str){\n\t\tint i = 0;\n\t\twhile(str.charAt(i) =='.')\n\t\t\ti++;\n\t\tdepth = i;\n\t\tname = str.substring(i);\n\t\t\n\t\twhile(prev != null){\n\t\t\tif(prev.depth == depth - 1)\n\t\t\t\tparent = prev;\n\t\t\t\n\t\t\tif(prev.depth == depth){\n\t\t\t\tprev.next = this;\n\t\t\t\tparent = prev.parent;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprev = prev.parent;\n\t\t}\n\t\tprev = this;\n\t}\n\t\n\t@Override\n\tpublic String toString(){\n\t\tStringBuffer buf = new StringBuffer(name);\n\t\tif(depth != 0){\n\t\t\tbuf.insert(0, '+');\n\t\t\tif(parent.parent != null){\n\t\t\t\tparent.appendString(buf);\n\t\t\t}\n\t\t}\n\t\treturn buf.toString();\n\t}\n\t\n\tpublic void appendString(StringBuffer buf){\n\t\tif(parent == null) return;\n\n\t\tif(next != null){\n\t\t\tbuf.insert(0, '|');\n\t\t}else{\n\t\t\tbuf.insert(0, ' ');\n\t\t}\n\t\tif(parent != null){\n\t\t\tparent.appendString(buf);\n\t\t}\n\t}\n}\n\n// --- ????????????????????????????????? ----------\n/**\n * MyUtil\n * @author yoshikyoto\n */\nclass MyUtil {\n\tpublic static int toInt(boolean[] a){\n\t\tint pow = 1, ret = 0, l = a.length;\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i]) ret += pow;\n\t\t\tpow *= 2;\n\t\t}\n\t\treturn ret;\n\t}\n\tstatic BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\tpublic static int ins[];\n\tpublic static int[] readIntMap() throws IOException{return parseInt(readLine().split(\" \"));}\n\tpublic static int readIntMap(int i) throws Exception{\n\t\tif(i == 0) ins = readIntMap();\n\t\treturn ins[i];\n\t}\n\tpublic static int[][] readIntMap(int n, int m) throws IOException{\n\t\tint[][] ret = new int[n][];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readIntMap();\n\t\treturn ret;\n\t}\n\tpublic static int[] readIntToMap(int n) throws IOException{\n\t\tint[] ret = new int[n];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readInt();\n\t\treturn ret;\n\t}\n\tpublic static int[] readNoDistIntMap() throws IOException{\n\t\tString[] strs = readLine().split(\"\");\n\t\tint l = strs.length;\n\t\tint[] ret = new int[l-1];\n\t\tfor(int i = 1; i < l; i++)\n\t\t\tret[i-1] = parseInt(strs[i]);\n\t\treturn ret;\n\t}\n\tpublic static String readLine() throws IOException{return br.readLine();}\n\tpublic static int readInt() throws IOException{return Integer.parseInt(br.readLine());}\n\tpublic static int[] parseInt(String[] arr){\n\t\tint[] res = new int[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Integer.parseInt(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static double[] parseDouble(String[] arr){\n\t\tdouble[] res = new double[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Double.parseDouble(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static boolean[] parseBool(String[] arr){\n\t\tint[] t = parseInt(arr);\n\t\tboolean[] res = new boolean[t.length];\n\t\tfor(int i = 0; i < t.length; i++){\n\t\t\tif(t[i] == 1){res[i] = true;\n\t\t\t}else{res[i] = false;}\n\t\t}\n\t\treturn res;\n\t}\n\tpublic static int parseInt(Object o){\n\t\treturn Integer.parseInt(o.toString());\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif ((n | l) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAnt[] ant = new Ant[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tant[i] = new Ant(i + 1, sc.next(), sc.nextDouble(), false);\n\t\t\t}\n\t\t\tint cnt = 0;\n\t\t\tint last = 0;\n\t\t\tdouble time = 0;\n\t\t\tdouble tmp = 0;\n\t\t\twhile (cnt != n) {\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave) {\n\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\tant[i].dis += 0.5;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tant[i].dis -= 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = i + 1; j < n; j++) {\n\t\t\t\t\t\tif (ant[i].leave || ant[j].leave) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ant[i].dis == ant[j].dis) {\n\t\t\t\t\t\t\tif (ant[i].dis * 10 % 10 != 5) {\n\t\t\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"L\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"R\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ant[j].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\t\tant[j].dir = \"L\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tant[j].dir = \"R\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave && (ant[i].dis == 0 || ant[i].dis == l)) {\n\t\t\t\t\t\tant[i].leave = true;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (time == tmp && ant[i].dir.equals(\"L\")) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t} else if (tmp == 0) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmp = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime += 0.5;\n\t\t\t}\n\t\t\tSystem.out.println((int) time + \" \" + last);\n\t\t}\n\t}\n\n\tclass Ant {\n\t\tint num;\n\t\tString dir;\n\t\tdouble dis;\n\t\tboolean leave;\n\n\t\tpublic Ant(int num, String dir, double dis, boolean leave) {\n\t\t\tsuper();\n\t\t\tthis.num = num;\n\t\t\tthis.dir = dir;\n\t\t\tthis.dis = dis;\n\t\t\tthis.leave = leave;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(int[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    void run() throws IOException {\n        while (runOnce()) {\n\n        }\n    }\n\n    boolean runOnce() throws IOException {\n        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    void exec(List<Ant> ants, int length) {\n        List<List<Ant>> state = new ArrayList<List<Ant>>(length);\n        for (int i = 0; i < length; i++) {\n            state.add(new ArrayList<Ant>());\n        }\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    List<Ant> update(List<Ant> ants, int length) {\n        Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        public Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif ((n | l) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAnt[] ant = new Ant[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tant[i] = new Ant(i + 1, sc.next(), sc.nextInt(), false);\n\t\t\t}\n\t\t\tint cnt = 0;\n\t\t\tint last = 0;\n\t\t\tint time = 0;\n\t\t\tint tmp = 0;\n\t\t\twhile (cnt != n) {\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave) {\n\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\tant[i].dis += 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tant[i].dis -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = i + 1; j < n; j++) {\n\t\t\t\t\t\tif (ant[i].leave || ant[j].leave) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ant[i].dis == ant[j].dis) {\n\t\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\tant[i].dir = \"L\";\n\t\t\t\t\t\t\t\tant[j].dir = \"R\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tant[i].dir = \"R\";\n\t\t\t\t\t\t\t\tant[j].dir = \"L\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave && (ant[i].dis == 0 || ant[i].dis == l)) {\n\t\t\t\t\t\tant[i].leave = true;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (time == tmp && ant[i].dir.equals(\"L\")) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t} else if (tmp == 0) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmp = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime++;\n\t\t\t}\n\t\t\tSystem.out.println(time + \" \" + last);\n\t\t}\n\t}\n\n\tclass Ant {\n\t\tint num;\n\t\tString dir;\n\t\tint dis;\n\t\tboolean leave;\n\n\t\tpublic Ant(int num, String dir, int dis, boolean leave) {\n\t\t\tsuper();\n\t\t\tthis.num = num;\n\t\t\tthis.dir = dir;\n\t\t\tthis.dis = dis;\n\t\t\tthis.leave = leave;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(int[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tArrayList<Data> list = new ArrayList<Data>();\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint l = stdIn.nextInt();\n\t\t\tif(n == 0 && l == 0) break;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tString a = stdIn.next();\n\t\t\t\tint b = stdIn.nextInt();\n\t\t\t\tif(a.equals(\"R\")) {\n\t\t\t\t\tlist.add(new Data(true,b,i+1));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlist.add(new Data(false,b,i+1));\n\t\t\t\t}\n\t\t\t}\n\t\t\tint t = 0;\n\t\t\tMyComp comp = new MyComp();\n\t\t\tint lastremid = 0;\n\t\t\twhile(true) {\n\t\t\t\tif(list.size() == 0) break;\n\t\t\t\tCollections.sort(list,comp);\n\t\t\t\tint lastp = -1;\n\t\t\t\tboolean isLR = false;\n\t\t\t\tfor(int i = 0; i < list.size(); i++) {\n\t\t\t\t\tData tmp = list.get(i);\n\t\t\t\t\tif(tmp.p == l) {\n\t\t\t\t\t\tif(!isLR) {\n\t\t\t\t\t\t\tlastremid = tmp.id;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist.remove(i);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(tmp.p == 0) {\n\t\t\t\t\t\t\tlastremid = tmp.id;\n\t\t\t\t\t\t\tlist.remove(i);\n\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\tisLR = true;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(tmp.p == lastp) {\n\t\t\t\t\t\tif(tmp.isR) {\n\t\t\t\t\t\t\ttmp.isR = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ttmp.isR = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist.set(i, tmp);\n\t\t\t\t\t\ttmp = list.get(i-1);\n\t\t\t\t\t\tif(tmp.isR) {\n\t\t\t\t\t\t\ttmp.isR = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ttmp.isR = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist.set(i-1, tmp);\n\t\t\t\t\t}\n\t\t\t\t\tlastp = tmp.p;\n\t\t\t\t}\n\t\t\t\tfor(int i = 0; i < list.size(); i++) {\n\t\t\t\t\tData tmp = list.get(i);\n\t\t\t\t\tif(tmp.isR) {\n\t\t\t\t\t\ttmp.p++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttmp.p--;\n\t\t\t\t\t}\n\t\t\t\t\tlist.set(i, tmp);\n\t\t\t\t}\n\t\t\t\tt++;\n\t\t\t}\n\t\t\tSystem.out.println(t-1 +\" \" + lastremid);\n\t\t}\n\t}\n}\nclass Data {\n\tboolean isR;\n\tint p;\n\tint id;\n\tData(boolean a, int b,int c) {\n\t\tisR = a;\n\t\tp = b;\n\t\tid = c;\n\t}\n}\n\nclass MyComp implements Comparator<Data> {\n\n\t@Override\n\tpublic int compare(Data o1, Data o2) {\n\t\tif(o1.p < o2.p) {\n\t\t\treturn -1;\n\t\t}\n\t\tif(o1.p > o2.p) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\t\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        TheLastAnt solver = new TheLastAnt();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class TheLastAnt {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            int n = in.nextInt();\n            int l = in.nextInt();\n            if (n == 0 && l == 0) throw new UnknownError();\n            int last = 0;\n            int[] ltunnel = new int[l];\n            int[] rtunnel = new int[l];\n            for (int i = 0; i < n; i++) {\n                String d = in.next();\n                int p = in.nextInt();\n                if (d.equals(\"R\")) {\n                    last = Math.max(last, l - p);\n                    rtunnel[p] = i + 1;\n                } else {\n                    last = Math.max(last, p);\n                    ltunnel[p] = i + 1;\n                }\n            }\n            int[] newltunnel, newrtunnel;\n            int cnt = n, lastant = -1;\n            while (true) {\n                //outArray(ltunnel);\n                //outArray(rtunnel);\n                if (cnt == 0) {\n                    out.println(last + \" \" + lastant);\n                    return;\n                }\n                newltunnel = new int[l];\n                newrtunnel = new int[l];\n                Arrays.fill(newltunnel, 0);\n                Arrays.fill(newrtunnel, 0);\n                for (int i = 0; i < l; i++) {\n                    if (rtunnel[i] != 0) {\n                        if (i + 1 != l) newrtunnel[i + 1] = rtunnel[i];\n                        else {\n                            lastant = rtunnel[i];\n                            cnt--;\n                        }\n                    }\n                    if (ltunnel[i] != 0) {\n                        if (i != 0) newltunnel[i - 1] = ltunnel[i];\n                        else {\n                            lastant = ltunnel[i];\n                            cnt--;\n                        }\n                    }\n                }\n                for (int i = 0; i < l; i++) {\n                    if (newltunnel[i] != 0 && newrtunnel[i] != 0) {\n                        final int buf = newrtunnel[i];\n                        newrtunnel[i] = newltunnel[i];\n                        newltunnel[i] = buf;\n                    }\n                }\n                ltunnel = newltunnel;\n                rtunnel = newrtunnel;\n            }\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif ((n | l) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAnt[] ant = new Ant[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tant[i] = new Ant(i + 1, sc.next(), sc.nextDouble(), false);\n\t\t\t}\n\t\t\tint cnt = 0;\n\t\t\tint last = 0;\n\t\t\tdouble time = 0;\n\t\t\tdouble tmp = 0;\n\t\t\twhile (cnt != n) {\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave) {\n\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\tant[i].dis += 0.5;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tant[i].dis -= 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = i + i; j < n; j++) {\n\t\t\t\t\t\tif (ant[i].leave || ant[j].leave) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ant[i].dis == ant[j].dis) {\n\t\t\t\t\t\t\tif (ant[i].dis * 10 % 10 != 5) {\n\t\t\t\t\t\t\t\tif (ant[i].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"L\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tant[i].dir = \"R\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ant[j].dir.equals(\"R\")) {\n\t\t\t\t\t\t\t\t\tant[j].dir = \"L\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tant[j].dir = \"R\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (!ant[i].leave && (ant[i].dis == 0 || ant[i].dis == l)) {\n\t\t\t\t\t\tant[i].leave = true;\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (time == tmp && ant[i].dir.equals(\"L\")) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t} else if (tmp == 0) {\n\t\t\t\t\t\t\tlast = ant[i].num;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmp = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime += 0.5;\n\t\t\t}\n\t\t\tSystem.out.println((int) time + \" \" + last);\n\t\t}\n\t}\n\n\tclass Ant {\n\t\tint num;\n\t\tString dir;\n\t\tdouble dis;\n\t\tboolean leave;\n\n\t\t/**\n\t\t * @param num\n\t\t * @param dir\n\t\t * @param dis\n\t\t * @param leave\n\t\t */\n\t\tpublic Ant(int num, String dir, double dis, boolean leave) {\n\t\t\tsuper();\n\t\t\tthis.num = num;\n\t\t\tthis.dir = dir;\n\t\t\tthis.dis = dis;\n\t\t\tthis.leave = leave;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(int[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    void run() throws IOException {\n        while (runOnce()) {\n\n        }\n    }\n\n    boolean runOnce() throws IOException {\n        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    void exec(List<Ant> ants, int length) {\n        List<List<Ant>> state = new ArrayList<List<Ant>>(length);\n        for (int i = 0; i < length; i++) {\n            state.add(new ArrayList<>());\n        }\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    List<Ant> update(List<Ant> ants, int length) {\n        Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        public Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(final String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        while (b) {\n            b = runOnce(reader);\n        }\n\n        reader.close();\n    }\n\n    private boolean runOnce(final BufferedReader reader) throws IOException {\n        final String[] params = reader.readLine().split(\" \");\n        final int count = Integer.parseInt(params[0]);\n        final int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    private void exec(final List<Ant> ants, final int length) {\n        List<Ant> deleted = new ArrayList<>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n\n        final int index = (deleted.size() == 2) ? (deleted.get(0).left ? deleted.get(0).index : deleted.get(1).index) : deleted.get(0).index;\n        System.out.println(count + \" \" + index);\n    }\n\n    private List<Ant> update(final List<Ant> ants, final int length) {\n        final Map<Integer, Ant> map = new HashMap<>();\n        final ArrayList<Ant> outList = new ArrayList<>();\n        for (final Ant ant : ants) {\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if (map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if (ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        ants.removeAll(outList);\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, final int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\n\tpublic static void main(String[] args) {\n\t\twhile (true) {\n\t\t\tint N = sc.nextInt();\n\t\t\tif (N == 0) break;\n\t\t\tint L = sc.nextInt();\n\t\t\tint[] pos = new int[N];\n\t\t\tint[] dir = new int[N];\n\t\t\tboolean[] exit = new boolean[N];\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tdir[i] = sc.next().charAt(0) == 'R' ? 1 : -1;\n\t\t\t\tpos[i] = sc.nextInt() * 2;\n\t\t\t}\n\t\t\tint c = 0;\n\t\t\tint exitL = -1;\n\t\t\tint exitR = -1;\n\t\t\tint time = 0;\n\t\t\tfor (; c < N; ++time) {\n\t\t\t\texitL = -1;\n\t\t\t\texitR = -1;\n\t\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\t\tif (exit[j]) continue;\n\t\t\t\t\tpos[j] += dir[j];\n\t\t\t\t\tif (pos[j] == 0) {\n\t\t\t\t\t\texitL = j;\n\t\t\t\t\t\t++c;\n\t\t\t\t\t}\n\t\t\t\t\tif (pos[j] == L * 2) {\n\t\t\t\t\t\texitR = j;\n\t\t\t\t\t\t++c;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\t\tif (!exit[j] && pos[j] % 2 == 0) {\n\t\t\t\t\t\tfor (int k = 0; k < j; ++k) {\n\t\t\t\t\t\t\tif (pos[k] == pos[j]) {\n\t\t\t\t\t\t\t\tdir[k] *= -1;\n\t\t\t\t\t\t\t\tdir[j] *= -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(time / 2 + \" \" + ((exitL != -1 ? exitL : exitR) + 1));\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    void run() throws IOException {\n        while (runOnce()) {\n\n        }\n    }\n\n    boolean runOnce() throws IOException {\n        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    void exec(List<Ant> ants, int length) {\n        List<List<Ant>> state = new ArrayList<List<Ant>>(length);\n        for (int i = 0; i < length; i++) {\n            state.add(new ArrayList<Ant>());\n        }\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    List<Ant> update(List<Ant> ants, int length) {\n        Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        public Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        while (b) {\n            b = runOnce(reader);\n        }\n\n        reader.close();\n    }\n\n    private boolean runOnce(BufferedReader reader) throws IOException {\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    private void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n\n        int index = (deleted.size() == 2) ? (deleted.get(0).left ? deleted.get(0).index : deleted.get(1).index) : deleted.get(0).index;\n        System.out.println(count + \" \" + index);\n    }\n\n    private List<Ant> update(List<Ant> ants, int length) {\n        final Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Iterator;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif (n == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tArrayList<Ant> a = new ArrayList<Ant>();\n\t\t\tfor(int i=0;i<n;i++) {\n\t\t\t\ta.add(new Ant(i+1, sc.next().charAt(0) == 'L' ? -1 : 1, sc.nextInt() * 2)); \n\t\t\t}\n\t\t\tint step = 0;\n\t\t\tAnt last = null;\n\t\t\twhile(!a.isEmpty()) {\n\t\t\t\tint m = a.size();\n\t\t\t\tfor(Ant x: a) {\n\t\t\t\t\tx.pos += x.dir;\n\t\t\t\t}\n\t\t\t\tfor(int i=0;i<m;i++) {\n\t\t\t\t\tAnt x = a.get(i);\n\t\t\t\t\tfor(int j=i+1;j<m;j++) {\n\t\t\t\t\t\tAnt y = a.get(j);\n\t\t\t\t\t\tif (x.pos == y.pos && x.pos % 2 == 0) {\n\t\t\t\t\t\t\tx.dir *= -1;\n\t\t\t\t\t\t\ty.dir *= -1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (Iterator<Ant> it = a.iterator(); it.hasNext();) {\n\t\t\t\t\tAnt x = it.next();\n\t\t\t\t\tif (x.pos >= l * 2) {\n\t\t\t\t\t\tlast = x;\n\t\t\t\t\t\tit.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (Iterator<Ant> it = a.iterator(); it.hasNext();) {\n\t\t\t\t\tAnt x = it.next();\n\t\t\t\t\tif (x.pos <= 0) {\n\t\t\t\t\t\tlast = x;\n\t\t\t\t\t\tit.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstep++;\n\t\t\t}\n\t\t\tSystem.out.println(step/2 + \" \" + last.id);\n\t\t}\n\n\t\t\n\t}\n\t\n\tstatic class Ant {\n\t\tint id,dir,pos;\n\t\tpublic Ant(int id,int dir,int pos) {\n\t\t\tthis.id = id;\n\t\t\tthis.dir = dir;\n\t\t\tthis.pos = pos;\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    private void run() throws IOException {\n        boolean b = true;\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        while (b) {\n            b = runOnce(reader);\n        }\n\n        reader.close();\n    }\n\n    private boolean runOnce(BufferedReader reader) throws IOException {\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        return true;\n    }\n\n    private void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    private List<Ant> update(List<Ant> ants, int length) {\n        final Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "public class Main{\n  public void run(java.io.InputStream in, java.io.PrintStream out){\n    java.util.Scanner sc = new java.util.Scanner(in);\n    int n, l, i, j, t, a, b, count;\n    int[] p;\n    String[] d;\n    String tmp;\n\n    for(;;){\n      n = sc.nextInt(); l = sc.nextInt();\n      if(n == 0 && l == 0)break;\n      d = new String[n]; p = new int[n];\n      for(i = 0;i < n;i++){\n        d[i] = sc.next(); p[i] = sc.nextInt();\n      }\n      a = -1; b = -1; count = 0;\n\n      for(t = 0;;t++){\n//        for(i = 0;i < n;i++)out.println(d[i] + p[i]);\n        for(i = 0;i < n;i++){\n          if(\"L\".equals(d[i]))p[i]--;\n          else p[i]++;\n          if(p[i] == 0 || p[i] == l)count++;\n        }\n        for(i = 0;i < n;i++){\n          for(j = i + 1;j < n;j++)if(p[i] == p[j]){\n            tmp = d[i]; d[i] = d[j]; d[j] = tmp;\n          }\n        }\n        if(count == n){\n          for(i = 0;i < n;i++){\n            if(p[i] == 0)a = i + 1;\n            if(p[i] == l)b = i + 1;\n          }\n          break;\n        }\n      }\n\n\n      if(a == -1)a = b;\n      out.println((t + 1) + \" \" + a);\n    }\n\n    sc.close();\n  }\n  public static void main(String[] args){\n    (new Main()).run(System.in, System.out);\n  }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tclass Ant {\n\t\tchar d;\n\t\tint p;\n\n\t\tAnt(char d, int p) {\n\t\t\tthis.d = d;\n\t\t\tthis.p = p;\n\t\t}\n\t}\n\t\n\tpublic void run() {\n\t\touter : \n\t\twhile (true) {\n\t\t\tint n = in.nextInt(), l = in.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\t\n\t\t\tAnt[] ant = new Ant[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tant[i] = new Ant(in.next().charAt(0), in.nextInt());\n\t\t\t}\n\t\t\t\n\t\t\tint cnt = 0;\n\t\t\tfor (int t = 1; ; t++) {\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (ant[i].p == 0 || ant[i].p == l) continue;\n\t\t\t\t\t\n\t\t\t\t\tif (ant[i].d == 'R') {\n\t\t\t\t\t\tant[i].p++;\n\t\t\t\t\t} \n\t\t\t\t\t\n\t\t\t\t\tif (ant[i].p == 0 || ant[i].p == l) {\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (cnt == n) {\n\t\t\t\t\t\t\tSystem.out.println(t + \" \" + (i+1));\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tif (ant[i].p == 0 || ant[i].p == l) continue;\n\t\t\t\t\t\n\t\t\t\t\tif (ant[i].d == 'L') {\n\t\t\t\t\t\tant[i].p--;\n\t\t\t\t\t} \n\t\t\t\t\t\n\t\t\t\t\tif (ant[i].p == 0 || ant[i].p == l) {\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tif (cnt == n) {\n\t\t\t\t\t\t\tSystem.out.println(t + \" \" + (i+1));\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (int i = 0; i < n; i++) for (int j = i + 1; j < n; j++) {\n\t\t\t\t\tif (ant[i].p == ant[j].p) {\n\t\t\t\t\t\tchar temp = ant[i].d;\n\t\t\t\t\t\tant[i].d = ant[j].d;\n\t\t\t\t\t\tant[j].d = temp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.math.*;\nimport java.util.*;\n\nimport com.sun.media.sound.DirectAudioDeviceProvider;\nimport com.sun.org.apache.xml.internal.serializer.ElemDesc;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile (cin.hasNextInt()) {\n\t\t\tint n = cin.nextInt(), l = cin.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\tint dir[] = new int[n];\n\t\t\tint pos[] = new int[n];\n\t\t\tboolean in[] = new boolean[n];\n\t\t\t//System.out.println(\"ffff\");\n\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\tin[i] = true;\n\t\t\t\tString s = cin.next();\n\t\t\t\tif (s.charAt(0) == 'L') dir[i] = -1;\n\t\t\t\telse dir[i] = 1;\n\t\t\t\tpos[i] = cin.nextInt();\n\t\t\t}\n\t\t\tint ltime = -1, rtime = -1, lid = -1, rid = -1;\n\t\t\tfor (int t = 1, rest = n; rest > 0; ++ t) {\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tpos[i] += dir[i];\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tif (!in[i]) continue;\n\t\t\t\t\tif (pos[i] == 0) {\n\t\t\t\t\t\tin[i] = false; -- rest;\n\t\t\t\t\t\tltime = t; lid = i + 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (pos[i] == l) {\n\t\t\t\t\t\tin[i] = false; -- rest;\n\t\t\t\t\t\trtime = t; rid = i + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tfor (int j = 0; j < n; ++ j) {\n\t\t\t\t\t\tif (i != j && in[i] && in[j] && pos[i] == pos[j]) {\n\t\t\t\t\t\t\tdir[i] = -dir[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ltime >= rtime) System.out.println(ltime + \" \" + lid);\n\t\t\telse System.out.println(rtime + \" \" + rid);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.math.*;\nimport java.util.*;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile (cin.hasNextInt()) {\n\t\t\tint n = cin.nextInt(), l = cin.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\tint dir[] = new int[n];\n\t\t\tint pos[] = new int[n];\n\t\t\tboolean in[] = new boolean[n];\n\t\t\t//System.out.println(\"ffff\");\n\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\tin[i] = true;\n\t\t\t\tString s = cin.next();\n\t\t\t\tif (s.charAt(0) == 'L') dir[i] = -1;\n\t\t\t\telse dir[i] = 1;\n\t\t\t\tpos[i] = cin.nextInt();\n\t\t\t}\n\t\t\tint ltime = -1, rtime = -1, lid = -1, rid = -1;\n\t\t\tfor (int t = 1, rest = n; rest > 0; ++ t) {\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tpos[i] += dir[i];\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tif (!in[i]) continue;\n\t\t\t\t\tif (pos[i] == 0) {\n\t\t\t\t\t\tin[i] = false; -- rest;\n\t\t\t\t\t\tltime = t; lid = i + 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (pos[i] == l) {\n\t\t\t\t\t\tin[i] = false; -- rest;\n\t\t\t\t\t\trtime = t; rid = i + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\t\t\tfor (int j = 0; j < n; ++ j) {\n\t\t\t\t\t\tif (i != j && in[i] && in[j] && pos[i] == pos[j]) {\n\t\t\t\t\t\t\tdir[i] = -dir[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ltime >= rtime) System.out.println(ltime + \" \" + lid);\n\t\t\telse System.out.println(rtime + \" \" + rid);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "// The Last Ant\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint l = sc.nextInt();\n\t\t\tif ((n | l) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchar[] d = new char[n];\n\t\t\tint[] p = new int[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\td[i] = sc.next().charAt(0);\n\t\t\t\tp[i] = sc.nextInt();\n\t\t\t}\n\t\t\tint time = 0;\n\t\t\tint last = -1;\n\t\t\twhile (n > 0) {\n\t\t\t\ttime++;\n\t\t\t\tfor (int i = 0; i < d.length; i++) {\n\t\t\t\t\tif (p[i] == -1)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif (d[i] == 'L' && p[i] > 0)\n\t\t\t\t\t\tp[i]--;\n\t\t\t\t\tif (d[i] == 'R' && p[i] < l)\n\t\t\t\t\t\tp[i]++;\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < p.length; i++) {\n\t\t\t\t\tif (p[i] == l) {\n\t\t\t\t\t\tlast = i;\n\t\t\t\t\t\tp[i] = -1;\n\t\t\t\t\t\tn--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < p.length; i++) {\n\t\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\t\tlast = i;\n\t\t\t\t\t\tp[i] = -1;\n\t\t\t\t\t\tn--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < p.length; i++) {\n\t\t\t\t\tif (p[i] == -1)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tfor (int j = i + 1; j < p.length; j++) {\n\t\t\t\t\t\tif (p[i] == p[j]) {\n\t\t\t\t\t\t\tchar temp = d[i];\n\t\t\t\t\t\t\td[i] = d[j];\n\t\t\t\t\t\t\td[j] = temp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(time + \" \" + (last + 1));\n\t\t}\n\t\tsc.close();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        new Main().run();\n    }\n\n    void run() throws IOException {\n        while (runOnce()) {\n\n        }\n    }\n\n    boolean runOnce() throws IOException {\n        final BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));\n        final String[] params = reader.readLine().split(\" \");\n        int count = Integer.parseInt(params[0]);\n        int length = Integer.parseInt(params[1]);\n        if (count == 0 && length == 0) return false;\n        final List<Ant> list = new ArrayList<Ant>(count);\n        for (int i = 0; i < count; i++) {\n            final Ant a = new Ant(reader.readLine().split(\" \"), i + 1);\n\n            list.add(a);\n        }\n        exec(list, length);\n        reader.close();\n        return true;\n    }\n\n    void exec(List<Ant> ants, int length) {\n        List<Ant> deleted = new ArrayList<Ant>();\n        int count;\n        for (count = 0; !ants.isEmpty(); count++) {\n            deleted = update(ants, length);\n        }\n        System.out.println(count + \" \" + deleted.get(0).index);\n    }\n\n    List<Ant> update(List<Ant> ants, int length) {\n        Map<Integer, Ant> map = new HashMap<Integer, Ant>();\n        final ArrayList<Ant> outList = new ArrayList<Ant>();\n        final int size = ants.size();\n        for (int i = 0; i < size; i++) {\n            final Ant ant = ants.get(i);\n            ant.position = ant.left ? ant.position - 1 : ant.position + 1;\n            if(map.containsKey(ant.position)) {\n                final Ant ant1 = map.get(ant.position);\n                ant1.left = !ant1.left;\n                ant.left = !ant.left;\n            }\n            map.put(ant.position, ant);\n            if(ant.position == 0 || ant.position == length) {\n                outList.add(ant);\n            }\n        }\n        for (final Ant ant : outList) {\n            ants.remove(ant);\n        }\n        return outList;\n    }\n\n    class Ant {\n        int position;\n        int index;\n        boolean left;\n\n        public Ant(final String[] params, int index) {\n            this.position = Integer.parseInt(params[1]);\n            this.left = params[0].equals(\"L\");\n            this.index = index;\n        }\n    }\n}"
  },
  {
    "language": "C#",
    "code": "using System.Linq;\nusing System.Collections.Generic;\nusing System;\n\npublic class P\n{\n    public int p { get; set; }\n    public int id { get; set; }\n}\n\npublic class hello\n{\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var n = int.Parse(line[0]);\n            var L = int.Parse(line[1]);\n            if (n == 0 && L == 0) break;\n            var input = new int[n, 2];\n            var maxd = -1; var maxmod = 0; var maxt = 0;\n            for (int i = 0; i < n; i++)\n            {\n                line = Console.ReadLine().Trim().Split(' ');\n                var outd = line[0] == \"L\" ? 1 : 0;\n                var p = int.Parse(line[1]);\n                input[i, 0] = outd;\n                input[i, 1] = p;\n                var wt = outd == 1 ? p : L - p;\n                var wmod = p % 2;\n                if (wt > maxt | (wt == maxt && outd > maxd))\n                { maxd = outd; maxt = wt; maxmod = wmod; }\n            }\n            var a = new List<P>();\n            var count1 = 0;\n            for (int i = 0; i < n; i++)\n            {\n                if (input[i, 1] % 2 == maxmod)\n                {\n                    a.Add(new P { id = i, p = input[i, 1] });\n                    if (input[i, 0] == 1) count1++;\n                }\n            }\n            if (maxd == 1) count1--;\n            var ans = a.OrderBy(x => x.p).Select(x => x.id).ToArray();\n            Console.WriteLine(\"{0} {1}\", maxt, ans[count1] + 1);\n        }\n    }\n}\n\n"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n\n  a_d = data_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = data_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : data_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position]).even?}.count\n    right_count = index==data_array.count-1 ? 0 : data_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position]).even?}.count\n    e[:exit_direction] = left_count==right_count ? e[:direction] : left_count - right_count\n    e\n  end\n  ans_array = additional_array.select{|data| data[:exit_direction]*a_d==1 && (a_d==-1 && (data[:position]-max_time).even? || a_d==1 && (j-data[:position]-1).even?) }\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n  select_array = data_array.select {|data| (max_time - data[:time]) % 2 == 0}.sort{|a, b| a[:position]<=>b[:position]}\n\n  if select_array.count == 1\n    puts \"#{max_time} #{select_array[0][:index]}\"\n    next\n  end\n\n  a_d = select_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = select_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : select_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position])%2==0}.count\n    right_count = index==select_array.count-1 ? 0 : select_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position])%2==0}.count\n    e[:exit_direction] = left_count==right_count ? e[:direction] : left_count - right_count\n    e\n  end\n  ans_array = additional_array.select{|data| data[:exit_direction] * a_d == 1}\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n\n  a_d = data_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = data_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : data_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position]).even?}.count\n    right_count = index==data_array.count-1 ? 0 : data_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position]).even?}.count\n    e[:exit_direction] = e[:direction] + (left_count - right_count) * 2\n    {exit_direction: e[:exit_direction], position: e[:position], index: e[:index]}\n  end\n  additional_array = additional_array.select{|data| data[:exit_direction]*a_d>0}\n  ans_array = additional_array.select{|data| a_d==-1 ? (data[:position]+max_time).even? : (data[:position]+j+max_time).even? }\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "### main\n\nloop do\n  n, l = gets.split.map(&:to_i)\n  break if (n | l) == 0\n  \n  ants = []\n  n.times do\n    di, pi = gets.strip.split\n    ants << [(di == 'L') ? -1 : 1, pi.to_i]\n  end\n  #p ants\n\n  t = 0\n  rn = n\n  last = nil\n  \n  loop do\n    #p ants\n    t += 1\n    pos = Array.new(n){nil}\n    exit_left = nil\n    \n    for i in (0...n)\n      ai = ants[i]\n      if ai\n        ai[1] += ai[0]\n        if ai[1] == 0 || ai[1] == l\n          ants[i] = nil\n          exit_left = i + 1 if ai[1] == 0\n          rn -= 1\n          if rn == 0\n            last = exit_left || i + 1\n            break\n          end\n          next\n        end\n\n        pi = pos[ai[1]]\n        if pi\n          ants[pi][0] *= -1\n          ai[0] *= -1\n        else\n          pos[ai[1]] = i\n        end\n        \n      end\n    end\n    break if rn == 0\n  end\n\n  puts [t, last].join(' ')\nend"
  },
  {
    "language": "Ruby",
    "code": "class Ant\n\tdef initialize(*args)\n\t\t@index, @dx, @x = args\n\tend\n\tattr_accessor :index, :dx, :x, :time\nend\n\nloop {\n\tn, l = gets.split.map &:to_i\n\tbreak if n == 0\n\tants = (1..n).map {|i|\n\t\tdir, x = gets.chomp.split \n\t\tAnt.new(i, {?R=>1, ?L=>-1}[dir], x.to_i)\n\t}\n\n\tevents = []\n\tants.combination(2){|a1, a2|\n\t\tnext if a1.dx == a2.dx || \n\t\t\t\t(a1.x + a2.x).odd? ||\n\t\t\t\t(a1.dx > 0) ^ (a1.x < a2.x)\n\t\tevents << [a1.index, a2.index, (a2.x - a1.x).abs / 2]\n\t}\n\tants.each{|a| a.time = (a.dx > 0 ? l - a.x : a.x)}\n\n\tevents.sort_by(&:last).each{|i, j, _|\n\t\ta1 = ants[i-1]\n\t\ta2 = ants[j-1]\n\t\ta1.index, a2.index = a2.index, a1.index\n\t}\n\n\tlast = ants.max_by{|a| [a.time, -a.dx]}\n\tputs \"#{last.time} #{last.index}\"\n}"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n\n  a_d = data_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = data_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : data_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position]).even?}.count\n    right_count = index==data_array.count-1 ? 0 : data_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position]).even?}.count\n    e[:exit_direction] = e[:direction] + (left_count - right_count) * 2\n    e\n  end.select{|data| data[:exit_direction]*a_d>0}\n  ans_array = additional_array.select{|data| a_d==-1 && (data[:position]-max_time).even? || a_d==1 && (data[:position]-j+1).even? }\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n  select_array = data_array.select {|data| (max_time - data[:time]) % 2 == 0}.sort{|a, b| a[:position]<=>b[:position]}\n\n  if select_array.count == 1\n    puts \"#{max_time} #{select_array[0][:index]}\"\n    next\n  end\n\n  a_d = select_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = select_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : select_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position])%2==0}.count\n    right_count = index==select_array.count-1 ? 0 : select_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position])%2==0}.count\n    e[:exit_direction] = left_count==right_count ? e[:direction] : left_count - right_count\n    e\n  end\n  ans_array = additional_array.select{|data| data[:exit_direction] * a_d == 1}\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "class Ant\n\tdef initialize(*args)\n\t\t@index, @dx, @x = args\n\tend\n\tattr_accessor :index, :dx, :x, :time\nend\n\nloop {\n\tn, l = gets.split.map &:to_i\n\tbreak if n == 0\n\tants = (1..n).map {|i|\n\t\tdir, x = gets.chomp.split \n\t\tAnt.new(i, {?R=>1, ?L=>-1}[dir], x.to_i)\n\t}\n\n\tevents = []\n\tants.combination(2){|a1, a2|\n\t\tnext if a1.dx == a2.dx\n\t\tnext if (a1.x + a2.x).odd?\n\t\tif a1.dx == 1\n\t\t\tnext if a1.x > a2.x\n\t\t\tevents << [a1.index, a2.index, (a2.x - a1.x) / 2]\n\t\telse\n\t\t\tnext if a1.x < a2.x\n\t\t\tevents << [a1.index, a2.index, (a1.x - a2.x) / 2]\n\t\tend\n\t}\n\tants.each{|a|\n\t\ta.time = (a.dx > 0 ? l - a.x : a.x)\n\t}\n\n\tevents.sort_by!(&:last)\n\t\n\tevents.each{|i, j, _|\n\t\ta1 = ants[i-1]\n\t\ta2 = ants[j-1]\n\t\ta1.index, a2.index = a2.index, a1.index\n\t}\n\n\tmax_t = ants.map(&:time).max\n\tlast = ants.select{|a| a.time == max_t}\n\tif last.size == 1\n\t\tlast = last[0].index\n\telse\n\t\tlast = last.find{|a| a.dx == -1}.index\n\tend\n\tputs \"#{max_t} #{last}\"\n}"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  n, l = gets.split(' ').map(&:to_i)\n  break if n == 0 && l == 0\n  array = (1..n).to_a.map do |i|\n    d_s, p_s = gets.split(' ')\n    p = p_s.to_i\n    t, d = (d_s == 'R') ? [l-p, 1] : [p, -1]\n    {d: d, t: t, i: i, p: p}\n  end\n  t_max = array.map{|e| e[:t]}.max\n  d_ans = array.select{|e| e[:t] == t_max}.map{|e| e[:d]}.inject(1, :*)\n  array_ans = array.each_with_index.map do |e, index|\n    left_count = array[0..index].select{|el| el[:d] == 1 && (el[:p]-e[:p]).even?}.count\n    right_count = array[index..-1].select{|el| el[:d] == -1  && (el[:p]-e[:p]).even?}.count\n    e.merge({d_exit: (left_count - right_count) * 2 -e[:d]})\n  end.select{|e| e[:d_exit]*d_ans>0}.select{|e| d_ans==-1 ? (e[:p]+t_max).even? : (e[:p]+l+t_max).even? }\n  i_ans = d_ans == 1 ? array_ans[0][:i] : array_ans[-1][:i]\n  puts \"#{t_max} #{i_ans}\"\nend"
  },
  {
    "language": "Ruby",
    "code": "while true do\n  i, j = gets.split(' ').map(&:to_i)\n  break if i == 0 && j == 0\n  arr = []\n  i.times { arr.push(gets.split(' ')) }\n\n  data_array = arr.each_with_index.map do |e, index|\n    p = e[1].to_i\n    time, direction = e[0] == 'R' ? [j-p, 1] : [p, -1]\n    {direction: direction, time: time, index: index + 1, position: p}\n  end\n  max_time = data_array.map{|x| x[:time]}.max\n\n  if data_array.count == 1\n    puts \"#{max_time} #{data_array[0][:index]}\"\n    next\n  end\n\n  a_d = data_array.select{|data| data[:time] == max_time}.map{|data| data[:direction]}.inject(1, :*)\n  additional_array = data_array.each_with_index.map do |e, index|\n    left_count = index==0 ? 0 : data_array[0..index-1].select{|el| el[:direction] == 1 && (el[:position]-e[:position])%2==0}.count\n    right_count = index==data_array.count-1 ? 0 : data_array[index+1..-1].select{|el| el[:direction] == -1  && (el[:position]-e[:position])%2==0}.count\n    e[:exit_direction] = left_count==right_count ? e[:direction] : left_count - right_count\n    e\n  end\n  ans_array = additional_array.select{|data| data[:exit_direction] * a_d == 1}\n  ans_index = a_d == 1 ? ans_array[0][:index] : ans_array[-1][:index]\n  puts \"#{max_time} #{ans_index}\"\nend"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\n\nconst L = -1,\n      R = 1;\n\nclass Ant {\n    int index;\n    int dir;\n    int pos;\n    bool left;\n    this(int index, int dir, int pos) {\n        this.index = index;\n        this.dir = dir;\n        this.pos = pos;\n        this.left = false;\n    }\n}\n\nvoid main() {\n    int n, l;\n    while (readf(\"%d %d\\n\", &n, &l), n || l) {\n        Ant[] ants = new Ant[n];\n        foreach (i; 1 .. n + 1) {\n            char d; int p;\n            auto input = readln.chomp.split(\" \");\n            d = input[0][0];\n            p = input[1].to!int;\n            ants[i - 1] = new Ant(i, (d == 'L' ? L : R), p);\n        }\n\n        Ant[] last = new Ant[2];\n        void step() {\n            foreach (ref ant; ants) {\n                if (ant.left) continue;\n                ant.pos += ant.dir;\n            }\n            foreach (i, ref ant; ants) {\n                if (ant.left) continue;\n                if (ant.pos >= l) {\n                    ant.left = true;\n                    last[1] = ant;\n                }\n                if (ant.pos <= 0) {\n                    ant.left = true;\n                    last[0] = ant;\n                }\n            }\n            foreach (i; 0 .. ants.length) {\n                if (ants[i].left) continue;\n                foreach (j; i + 1 .. ants.length) {\n                    if (ants[j].left) continue;\n                    if (ants[i].pos == ants[j].pos) {\n                        ants[i].dir *= -1;\n                        ants[j].dir *= -1;\n                    }\n                }\n            }\n        }\n\n        bool finished() {\n            foreach (ant; ants) {\n                if (!ant.left) return false;\n            }\n            return true;\n        }\n\n        int c = 0;\n        while (!finished) {\n            //writeln(c, \" \", ants.map!((a) => (a.left ? [] : [a.index, a.pos, a.dir])).array);\n            step();\n            c++;\n        }\n        writeln(c, \" \", (last[0] ? last[0] : last[1]).index);\n    }\n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\n\nconst L = -1,\n      R = 1;\n\nclass Ant {\n    int index;\n    int dir;\n    int pos;\n    bool left;\n    this(int index, int dir, int pos) {\n        this.index = index;\n        this.dir = dir;\n        this.pos = pos;\n        this.left = false;\n    }\n}\n\nvoid main() {\n    int n, l;\n    while (readf(\"%d %d\\n\", &n, &l), n || l) {\n        Ant[] ants = new Ant[n];\n        foreach (i; 1 .. n + 1) {\n            char d; int p;\n            auto input = readln.chomp.split(\" \");\n            d = input[0][0];\n            p = input[1].to!int;\n            ants[i - 1] = new Ant(i, (d == 'L' ? L : R), p);\n        }\n\n        Ant[] last;\n        void step() {\n            last = new Ant[2];\n            foreach (ref ant; ants) {\n                if (ant.left) continue;\n                ant.pos += ant.dir;\n            }\n            foreach (i, ref ant; ants) {\n                if (ant.left) continue;\n                if (ant.pos >= l) {\n                    ant.left = true;\n                    last[1] = ant;\n                }\n                if (ant.pos <= 0) {\n                    ant.left = true;\n                    last[0] = ant;\n                }\n            }\n            foreach (i; 0 .. ants.length) {\n                if (ants[i].left) continue;\n                foreach (j; i + 1 .. ants.length) {\n                    if (ants[j].left) continue;\n                    if (ants[i].pos == ants[j].pos) {\n                        ants[i].dir *= -1;\n                        ants[j].dir *= -1;\n                    }\n                }\n            }\n        }\n\n        bool finished() {\n            foreach (ant; ants) {\n                if (!ant.left) return false;\n            }\n            return true;\n        }\n\n        int c = 0;\n        while (!finished) {\n            //writeln(c, \" \", ants.map!((a) => (a.left ? [] : [a.index, a.pos, a.dir])).array);\n            step();\n            c++;\n        }\n        writeln(c, \" \", (last[0] ? last[0] : last[1]).index);\n    }\n}"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,l = map(int,raw_input().split())\n    if n == 0: break\n    \n    tunnel = [[] for i in xrange(l-1)]\n    for i in xrange(1,n+1):\n        d,p = raw_input().split()\n        tunnel[int(p)-1].append(i if d == \"R\" else -i)\n    t = num = 0\n    while sum(sum(unit) for unit in tunnel) != 0:\n        for i in xrange(l-2,-1,-1):\n            for a in tunnel[i]:\n                if a > 0:\n                    tunnel[i].remove(a)\n                    if i == l-2:\n                        num = a\n                    else:\n                        tunnel[i+1].append(a)\n        for i in xrange(l-1):\n            for a in tunnel[i]:\n                if a < 0:\n                    tunnel[i].remove(a)\n                    if i == 0:\n                        num = -a\n                    else:\n                        tunnel[i-1].append(a)\n        for i in xrange(l-1):\n            if len(tunnel[i]) > 1:\n                tunnel[i] = [-a for a in tunnel[i]]\n        t += 1\n    print t,num"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,l = map(int,raw_input().split())\n    if n == 0: break\n    R = [0]*(l-1)\n    L = [0]*(l-1)\n    for i in xrange(1,n+1):\n        d,p = raw_input().split()\n        p = int(p)-1\n        if d == \"R\": R[p] = i\n        else: L[p] = i\n    t = num = 0\n    while sum(R)+sum(L) != 0:\n        if R[-1] > 0: num = R[-1]\n        R = [0]+R[:-1]\n        if L[0]  > 0: num = L[0]\n        L = L[1:]+[0]\n        for i in xrange(l-1):\n            if min(L[i],R[i]) > 0: R[i],L[i] = L[i],R[i]\n        t += 1\n    print t,num"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\n\nLR = \"LR\".index\n\ndef solve(A, L):\n    K = len(A)\n    if K == 0:\n        return -1, -1, -1\n    T = []\n    v = -1; last = None\n    left = 0\n    for i in range(K):\n        di, pi, ki = A[i]\n        for j in range(i+1, K):\n            dj, pj, kj = A[j]\n            if di > dj:\n                T.append(((pj - pi)//2, i, j))\n        if di == 0:\n            if v <= pi:\n                v = pi\n                last = i\n                left = 1\n        else:\n            if v < L - pi:\n                v = L - pi\n                last = i\n                left = 0\n    T.sort()\n    for _, i, j in T:\n        A[i], A[j] = A[j], A[i]\n    return v, A[last][2], left\n\nans = []\nwhile 1:\n    N, L = map(int, readline().split())\n    if N == 0:\n        break\n    A = []; B = []\n    for i in range(N):\n        d, p = readline().split(); d = LR(d); p = int(p)\n        if p % 2:\n            A.append((d, p, i+1))\n        else:\n            B.append((d, p, i+1))\n    v0, i0, l0 = solve(A, L)\n    v1, i1, l1 = solve(B, L)\n    if v0 > v1:\n        ans.append(\"%d %d\\n\" % (v0, i0))\n    elif v0 < v1:\n        ans.append(\"%d %d\\n\" % (v1, i1))\n    else:\n        if l0:\n            ans.append(\"%d %d\\n\" % (v0, i0))\n        else:\n            ans.append(\"%d %d\\n\" % (v1, i1))\nsys.stdout.writelines(ans)\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,l = map(int,raw_input().split())\n    if n == 0: break\n    \n    R = [0]*(l-1)\n    L = [0]*(l-1)\n    for i in xrange(1,n+1):\n        d,p = raw_input().split()\n        p = int(p)-1\n        if d == \"R\": R[p] = i\n        else: L[p] = i\n    t = num = 0\n    while sum(R)+sum(L) != 0:\n        if R[-1] > 0: num = R[-1]\n        R = [0]+R[:-1]\n        if L[0]  > 0: num = L[0]\n        L = L[1:]+[0]\n        for i in xrange(l-1):\n            if min(L[i],R[i]) > 0: R[i],L[i] = L[i],R[i]\n        t += 1\n        print R\n    print t,num"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,l = map(int,raw_input().split())\n    if n == 0: break\n    \n    tunnel = [[] for i in xrange(l-1)]\n    for i in xrange(1,n+1):\n        d,p = raw_input().split()\n        tunnel[int(p)-1].append(i if d == \"R\" else -i)\n    t = num = 0\n    while sum(len(unit) for unit in tunnel) != 0:\n        for i in xrange(l-2,-1,-1):\n            for a in tunnel[i]:\n                if a > 0:\n                    tunnel[i].remove(a)\n                    if i == l-2:\n                        num = a\n                    else:\n                        tunnel[i+1].append(a)\n        for i in xrange(l-1):\n            for a in tunnel[i]:\n                if a < 0:\n                    tunnel[i].remove(a)\n                    if i == 0:\n                        num = -a\n                    else:\n                        tunnel[i-1].append(a)\n        for i in xrange(l-1):\n            if len(tunnel[i]) > 1:\n                tunnel[i] = [-a for a in tunnel[i]]\n        t += 1\n    print t,num"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,l = map(int,raw_input().split())\n    if n == 0: break\n    \n    tube = [[] for i in xrange(l-1)]\n    for i in xrange(1,n+1):\n        d,p = raw_input().split()\n        tube[int(p)-1].append(i if d == \"R\" else -i)\n    t = num = 0\n    while sum(len(ele) for ele in tube) != 0:\n        for s in [-1,1]:\n            for i in range(l-1)[::s]:\n                for a in tube[i]:\n                    if -s*a > 0:\n                        tube[i].remove(a)\n                        if i == (l-2 if s == -1 else 0):\n                            num = abs(a)\n                        else:\n                            tube[i-s].append(a)\n        for i in xrange(l-1):\n            if len(tube[i]) > 1:\n                tube[i] = [-a for a in tube[i]]\n        t += 1\n    print t,num"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        n,l = LI()\n        if n == 0:\n            break\n        a = []\n        b = []\n        for _ in range(n):\n            d,p = LS()\n            if int(p) % 2 == 0:\n                a.append((d,int(p),_+1))\n            else:\n                b.append((d,int(p),_+1))\n\n        lc = 0\n        rm = 0\n        rf = False\n        for d,p,i in a:\n            if d == 'L':\n                lc += 1\n            m = int(p)\n            if d == 'R':\n                m = l - m\n            if rm < m or (rm == m and d == 'L'):\n                rm = m\n                rf = d == 'R'\n        ri = lc\n        if rf:\n            ri = lc + 1\n        ari = -1\n        if a:\n            ari = a[ri-1][2]\n\n        lc = 0\n        rf = False\n        af = True\n        for d,p,i in b:\n            if d == 'L':\n                lc += 1\n            m = int(p)\n            if d == 'R':\n                m = l - m\n            if rm < m or (rm == m and d == 'L'):\n                rm = m\n                rf = d == 'R'\n                af = False\n        ri = lc\n        if rf:\n            ri = lc + 1\n        bri = -1\n        if b:\n            bri = b[ri-1][2]\n\n        if af:\n            rr.append('{} {}'.format(rm, ari))\n        else:\n            rr.append('{} {}'.format(rm, bri))\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Rust",
    "code": "extern crate core;\n\nuse std::fmt;\nuse std::cmp::{Ordering, min, max};\nuse std::fmt::{Display, Error, Formatter};\nuse std::f32::MAX;\nuse std::ops::{Add, Sub, Mul, Div, Neg, Index, IndexMut};\nuse std::collections::{BTreeMap, VecDeque, BinaryHeap, BTreeSet};\n\nfn show<T: Display>(vec: &Vec<T>) {\n    if vec.is_empty() {\n        println!(\"[]\");\n    }else {\n        print!(\"[{}\", vec[0]);\n        for i in 1 .. vec.len() {\n            print!(\", {}\", vec[i]);\n        }\n        println!(\"]\");\n    }\n}\nfn show2<T: Display>(vec: &Vec<Vec<T>>) {\n    if vec.is_empty() {\n        println!(\"[]\");\n    }else {\n        for l in vec {\n            show(l);\n        }\n    }\n}\nmacro_rules! read_line{\n    () => {{\n        let mut line = String::new();\n        std::io::stdin().read_line(&mut line).ok();\n        line\n    }};\n    (delimiter: ' ') => {\n        read_line!().split_whitespace().map(|x|x.to_string()).collect::<Vec<_>>()\n    };\n    (delimiter: $p:expr) => {\n        read_line!().split($p).map(|x|x.to_string()).collect::<Vec<_>>()\n    };\n    (' ') => {\n        read_line!(delimiter: ' ')\n    };\n    ($delimiter:expr) => {\n        read_line!(delimiter: $delimiter)\n    };\n    (' '; $ty:ty) => {\n        read_line!().split_whitespace().map(|x|x.parse::<$ty>().ok().unwrap()).collect::<Vec<$ty>>()\n    };\n    ($delimiter:expr; $ty:ty) => {\n        read_line!($delimiter).into_iter().map(|x|x.parse::<$ty>().ok().unwrap()).collect::<Vec<$ty>>()\n    };\n}\nmacro_rules! read_value{\n    () => {\n        read_line!().trim().parse().ok().unwrap()\n    }\n}\nmacro_rules! let_all {\n    ($($n:ident:$t:ty),*) => {\n        let line = read_line!(delimiter: ' ');\n        let mut iter = line.iter();\n        $(let $n:$t = iter.next().unwrap().parse().ok().unwrap();)*\n    };\n}\nmacro_rules! let_mut_all {\n    ($($n:ident:$t:ty),*) => {\n        let line = read_line!(delimiter: ' ');\n        let mut iter = line.iter();\n        $(let mut $n:$t = iter.next().unwrap().parse().ok().unwrap();)*\n    };\n}\nfn main() {\n    loop {\n        let_all!(n: usize, l: usize);\n        if n == 0 {\n            return\n        }\n        let mut to_left_position = Vec::new();\n        let mut to_left_id = Vec::new();\n        let mut to_right_position = Vec::new();\n        let mut to_right_id = Vec::new();\n        for i in 0 .. n {\n            let_all!(d: String, p: usize);\n            match &d[..] {\n                \"R\" => {\n                    to_right_position.push(p);\n                    to_right_id.push(i + 1);\n                },\n                \"L\" => {\n                    to_left_position.push(p);\n                    to_left_id.push(i + 1);\n                },\n                _ => unreachable!()\n            }\n        }\n        for j in 0 .. to_left_id.len() {\n            for ri in 0 .. to_right_id.len() {\n                let i = to_right_id.len() - ri - 1;\n                if to_right_position[i] < to_left_position[j] && (to_left_position[j] - to_right_position[i]) % 2 == 0 {\n                    let temp = to_right_id[i];\n                    to_right_id[i] = to_left_id[j];\n                    to_left_id[j] = temp;\n                }\n            }\n        }\n        match (to_right_position.first(), to_left_position.last()) {\n            (Some(&right), Some(&left)) if l - right <= left => {\n                println!(\"{} {}\", left, to_left_id.last().unwrap());\n            }\n            (Some(&right), Some(&left)) => {\n                println!(\"{} {}\", l - right, to_right_id.first().unwrap());\n            }\n            (Some(&right), _) => {\n                println!(\"{} {}\", l - right, to_right_id.first().unwrap());\n            }\n            (_, Some(&left)) => {\n                println!(\"{} {}\", left, to_left_id.last().unwrap());\n            }\n            _ => unreachable!()\n        }\n    }\n}\n"
  }
]