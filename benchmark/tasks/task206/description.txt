Toshizo is the manager of a convenience store chain and needs to reconstruct a sales table for products based on available partial data. Each table contains data about products sold across multiple stores, including sales totals. The program should replace question marks in the sales data with correct figures where possible. If the data can be reconstructed uniquely, output the missing numbers. If there are infinitely many solutions or no solutions, output 'NO'. The program should handle multiple datasets and ensure each output is correctly formatted with separations.