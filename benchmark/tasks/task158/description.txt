JOI-kun came to the beach with his family. After swimming, he played by making a sandcastle on the beach. After a while, he got bored and left his castle behind to swim again. The castle made by JOI-kun is located within a certain rectangular area on the sand. This area is divided into a grid of squares, where each square is either part of the castle ('castle square') or empty land ('empty square'). Each castle square has a strength represented by an integer between 1 and 9. There are no castle squares on the outer edge of the rectangular area. As the tide rises, waves will wash over the area, causing all castle squares that are adjacent to a number of empty squares greater than or equal to their strength to collapse into empty squares. Given enough waves, the castle will either completely collapse or stabilize where no castle squares can collapse. The task is to determine the number of waves that will cause at least one castle square to collapse.