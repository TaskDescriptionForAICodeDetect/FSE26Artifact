In this problem, you need to compute the number of chains that occur when matching blocks in a falling block puzzle game. The game consists of a grid of blocks where blocks of six types (red, green, blue, yellow, purple, and a blocking block) fall in pairs. When blocks of the same color connect in groups of four or more, they disappear and the blocks above them fall down, potentially causing more blocks to disappear in a chain reaction. Your task is to determine how many chains occur after processing the input grid according to the specified rules. If no blocks disappear, the output should be zero. The input consists of multiple datasets. Each dataset starts with the number of datasets followed by the grid states. You should read the grid states and output the number of chains for each dataset in a single line.