Given a dial lock composed of vertically stacked dials, your task is to determine the fewest number of rotations needed to unlock the lock using the unlocking sequence. Each dial can show numbers from 0 to 9, and you can rotate adjacent dials simultaneously in the same direction. You need to find the minimum number of rotations for multiple datasets until a terminating zero is encountered.