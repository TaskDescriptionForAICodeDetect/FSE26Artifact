[
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (now != -1 && idx < K) {\n          Ans(now) = true\n          now = A(now)\n          idx += 1\n        }\n      }\n      i += 1\n    }\n    \n    i=0\n    var ans=0\n    while(i<N){\n      if(Ans(i)){\n        ans+=1\n      }\n      i+=1\n    }\n    ans\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (idx < K && A(now) != -1) {\n          Ans(now) = true\n          if (A(now) != -1) (now = A(now))\n          idx += 1\n        }\n      }\n      i += 1\n    }\n    Ans.filter(x => x).length\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = Array.fill(N)().zipWithIndex.map(X => A(X._2) == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    for (i <- 0 until N) {\n      if (leaf(i)) {\n        var now = i\n        for (_ <- 0 until K) {\n          Ans(now) = true\n          if (A(now) != -1) (now = A(now))\n        }\n      }\n    }\n    Ans.filter(x => x).length\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    val memo = Array.fill(N)(K * 2)\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (now != -1 && idx < K) {\n          Ans(now) = true\n          now = A(now)\n          idx += 1\n          if (now != -1) {\n            if (memo(now) < idx) {\n              now = -1\n            } else {\n              memo(now) = idx\n            }\n          }\n        }\n      }\n      i += 1\n    }\n\n    i = 0\n    var ans = 0\n    while (i < N) {\n      if (Ans(i)) {\n        ans += 1\n      }\n      i += 1\n    }\n    ans\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import scala.collection.mutable\n\nobject Main extends App {\n\n  import scala.io.StdIn._\n  import scala.math._\n\n  val Array(n, k) = readLine.trim.split(' ').map(_.toInt)\n  val tweet = Array.tabulate(n){_ ⇒ readLine.trim.toInt}\n  val resCount = Array.tabulate(n){_ ⇒ 0}\n  for (t ← tweet if t != 0){\n    resCount(t - 1) += 1\n  }\n  val queue:mutable.Queue[Int] = mutable.Queue()\n  for (i ← resCount.indices if resCount(i) == 0){\n    queue.enqueue(i)\n  }\n  for (_ ← 1 to k){\n    for (_ ← queue.indices){\n      val i = queue.dequeue()\n      if (tweet(i) != 0){\n        queue.enqueue(tweet(i) - 1)\n        tweet(i) = 0\n      }\n    }\n  }\n  println(\n    tweet.count(_ == 0)\n  )\n\n\n  implicit class Extension[T](val value :T){\n    def also(func: T ⇒ Unit): T = {\n      func(value)\n      value\n    }\n    def let[R](func: T ⇒ R): R = func(value)\n  }\n}\n"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    val memo = Array.fill(N)(K * 2)\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (now != -1 && idx < K) {\n          Ans(now) = true\n          now = A(now)\n          idx += 1\n          if (now != -1) {\n            if (memo(now) <= idx) {\n              now = -1\n            } else {\n              memo(now) = idx\n            }\n          }\n        }\n      }\n      i += 1\n    }\n\n    i = 0\n    var ans = 0\n    while (i < N) {\n      if (Ans(i)) {\n        ans += 1\n      }\n      i += 1\n    }\n    ans\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    val memo = Array.fill(N)(K * 2)\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (now != -1 && idx < K) {\n          Ans(now) = true\n          now = A(now)\n          idx += 1\n          if (memo(now) < idx) {\n            now = -1\n          } else {\n            memo(now) = idx\n          }\n        }\n      }\n      i += 1\n    }\n\n    i = 0\n    var ans = 0\n    while (i < N) {\n      if (Ans(i)) {\n        ans += 1\n      }\n      i += 1\n    }\n    ans\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    for (i <- 0 until N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (idx < K) {\n          Ans(now) = true\n          if (A(now) != -1) (now = A(now))\n          idx += 1\n        }\n      }\n    }\n    Ans.filter(x => x).length\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "import java.util.Scanner\n\nobject Main {\n  def solve(sc: => Scanner): Long = {\n    val N, K = sc.nextInt\n    val A = Array.fill(N)(sc.nextInt - 1)\n    val Ans = A.map(X => X == -1)\n    val leaf = Array.fill(N)(true)\n    for (i <- 0 until N) {\n      if (A(i) != -1) (leaf(A(i)) = false)\n    }\n    var i = 0\n    while (i < N) {\n      if (leaf(i)) {\n        var now = i\n        var idx = 0\n        while (now != -1 && idx < K) {\n          Ans(now) = true\n          now = A(now)\n          idx += 1\n        }\n      }\n      i += 1\n    }\n    Ans.filter(x => x).length\n  }\n\n  def main(args: Array[String]): Unit = {\n    val sc: Scanner = new Scanner(System.in)\n\n    println(solve(sc))\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n,k;\nvector<int> v[111111];\nint d[111111],c[111111];\n\nint dfs(int x,int p) {\n  int z=1<<30;\n  for(int i=0; i<v[x].size(); i++) {\n    int y=v[x][i];\n    z=min(z,dfs(y,x));\n  }\n  if(z==1<<30||p==-1) z=0;\n  d[x]=z;\n  return z+1;\n}\n\nint main() {\n  cin >> n >> k;\n  for(int i=0; i<n; i++) {\n    int x;\n    cin >> x;\n    if(x) {\n      v[x-1].push_back(i);\n      c[i]++;\n    }\n  }\n  for(int i=0; i<n; i++) {\n    if(!c[i]) dfs(i,-1);\n  }\n  int ans=0;\n  for(int i=0; i<n; i++) {\n    if(d[i]<k) ans++;\n  }\n  cout << ans << endl;\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pairInt;\n#define FOR(i, n) for (int i = 0; i < int(n); i++)\n#define FOR1(i, m, n) for (int i = int(m); i < int(n); i++)\n#define MAX(a, b) ((a) >= (b) ? (a) : (b))\n#define MIN(a, b) ((a) <= (b) ? (a) : (b))\n\nint main(int argc, char *argv[]) {\n  int N, K;\n\n  scanf(\"%d%d\", &N, &K);\n\n  set<int> not_replyed;\n  set<int> not_replying;\n  multimap<int, int> replying;\n\n  FOR1(i, 1, N + 1) { not_replyed.insert(i); }\n\n  FOR1(i, 1, N + 1) {\n    int a;\n    scanf(\"%d\", &a);\n    if (a != 0) {\n      replying.insert(make_pair(i, a));\n      not_replyed.erase(a);\n    } else {\n      not_replying.insert(i);\n    }\n  }\n\n  // printf(\"not_replyed:{\");\n  // for (auto x : not_replyed) {\n  //   printf(\"%d, \", x);\n  // }\n  // printf(\"}\\n\");\n  // printf(\"not_replying:{\");\n  // for (auto x : not_replying) {\n  //   printf(\"%d, \", x);\n  // }\n  // printf(\"\\n\");\n\n  set<int> displayed(not_replyed);\n  FOR(i, K - 1) {\n    set<int> temp(displayed);\n    for (auto x : temp) {\n      using iterator = decltype(replying)::iterator;\n      pair<iterator, iterator> ret = replying.equal_range(x);\n      for(auto it = ret.first; it != ret.second; it++) {\n        displayed.insert(it->second);\n      }\n    }\n    // printf(\"displayed%d:{\", i);\n    // for (auto x : displayed) {\n    //   printf(\"%d, \", x);\n    // }\n    // printf(\"}\\n\");\n  }\n  displayed.insert(not_replying.begin(), not_replying.end());\n\n  printf(\"%lu\\n\", displayed.size());\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pairInt;\n#define FOR(i, n) for (int i = 0; i < int(n); i++)\n#define FOR1(i, m, n) for (int i = int(m); i < int(n); i++)\n#define MAX(a, b) ((a) >= (b) ? (a) : (b))\n#define MIN(a, b) ((a) <= (b) ? (a) : (b))\n\nint main(int argc, char *argv[]) {\n  int N, K;\n\n  scanf(\"%d%d\", &N, &K);\n\n  set<int> not_replyed;\n  set<int> not_replying;\n  multimap<int, int> replying;\n\n  FOR1(i, 1, N + 1) { not_replyed.insert(i); }\n\n  FOR1(i, 1, N + 1) {\n    int a;\n    scanf(\"%d\", &a);\n    if (a != 0) {\n      replying.insert(make_pair(i, a));\n      not_replyed.erase(a);\n    } else {\n      not_replying.insert(i);\n    }\n  }\n\n  set<int> displayed(not_replyed);\n  set<int> temp(not_replyed);\n  FOR(i, K - 1) {\n    set<int> temp2;\n    for (auto x : temp) {\n      using iterator = decltype(replying)::iterator;\n      pair<iterator, iterator> ret = replying.equal_range(x);\n      for (auto it = ret.first; it != ret.second; it++) {\n        if (displayed.find(it->second) == displayed.end()) {\n          temp2.insert(it->second);\n          displayed.insert(it->second);\n        }\n      }\n    }\n    temp = move(temp2);\n    // printf(\"displayed%d:{\", i);\n    // for (auto x : displayed) {\n    //   printf(\"%d, \", x);\n    // }\n    // printf(\"}\\n\");\n  }\n  displayed.insert(not_replying.begin(), not_replying.end());\n\n  printf(\"%lu\\n\", displayed.size());\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n\nstruct FastIO{\n  FastIO(){\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n  }\n}fastio_beet;\n\n//INSERT ABOVE HERE\nsigned main(){\n  Int n,k;\n  cin>>n>>k;\n  \n  vector<vector<Int> > G(n);\n  vector<Int> a(n);\n  for(Int i=0;i<n;i++){\n    cin>>a[i];\n    a[i]--;\n    if(~a[i]) G[a[i]].emplace_back(i);\n  }\n\n  vector<Int> dist(n,-1);\n  queue<Int> qu;\n  for(Int i=0;i<n;i++){\n    if(G[i].empty()){\n      dist[i]=0;\n      qu.emplace(i);\n    }\n  }\n  \n  while(!qu.empty()){\n    Int v=qu.front();qu.pop();\n    if(~dist[a[v]]) continue;\n    dist[a[v]]=dist[v]+1;\n    qu.emplace(a[v]);\n  }\n  \n  Int ans=0;\n  for(Int i=0;i<n;i++){\n    if(~a[i]||dist[i]<k) ans++;    \n  } \n  cout<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  int n,k; cin >> n >> k;\n  vector<int> a(n),G[n];\n  int ans = 0;\n  for(int i = 0; i < n; i++){\n    cin >> a[i];\n    a[i]--;\n    if(a[i] == -1) continue;\n    G[a[i]].push_back(i);\n  }\n\n  vector<int> d(n,0);\n  function< int(int,int) > rec =\n  [&](int u,int par){\n    if(G[u].empty()) d[u] = 1;\n    else {\n      for(auto v : G[u]){\n        d[u] = max(d[u],rec(v,0) + 1);\n      }\n    }\n    if(par == -1 || d[u] <= k) ans++;\n    return d[u];\n  };\n\n  for(int i = 0; i < n; i++){\n    if(!d[i]){\n      if(G[i].empty()) ans++;\n      else rec(i,-1);\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n\nstruct FastIO{\n  FastIO(){\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n  }\n}fastio_beet;\n\n//INSERT ABOVE HERE\nsigned main(){\n  Int n,k;\n  cin>>n>>k;\n  \n  vector<vector<Int> > G(n);\n  vector<Int> a(n);\n  for(Int i=0;i<n;i++){\n    cin>>a[i];\n    a[i]--;\n    if(~a[i]) G[a[i]].emplace_back(i);\n  }\n\n  vector<Int> dist(n,-1);\n  queue<Int> qu;\n  for(Int i=0;i<n;i++){\n    if(G[i].empty()){\n      dist[i]=0;\n      qu.emplace(i);\n    }\n  }\n  \n  while(!qu.empty()){\n    Int v=qu.front();qu.pop();\n    if(a[v]<0||~dist[a[v]]) continue;\n    dist[a[v]]=dist[v]+1;\n    qu.emplace(a[v]);\n  }\n  \n  Int ans=0;\n  for(Int i=0;i<n;i++){\n    if(a[i]<0||dist[i]<k) ans++;    \n  } \n  cout<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n\nconst int R = 10101010;\n\nint main()\n{\n    int n,k;\n    cin >>n >>k;\n    vector<int> a(n);\n    rep(i,n)\n    {\n        cin >>a[i];\n        --a[i];\n    }\n\n    vector<int> x(n,-1);\n    for(int i=n-1; i>=0; --i)\n    {\n        // leaf\n        if(x[i]==-1) x[i] = k;\n\n        if(a[i]>=0)\n        {\n            x[a[i]] = max(x[a[i]],x[i]-1);\n        }\n        else x[i]=R;\n    }\n\n    int ans = 0;\n    rep(i,n) ans += (x[i]>0);\n    cout << ans << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  // REP(i, 0, R.size()) ans[R[i]] = true;\n  // REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0; i<n;i++)\nusing namespace std;\n#define int long long\nsigned main(){\n    int n,k;\n    typedef pair<int,int> pii;\n    cin>>n>>k;\n    vector<bool>flag(n+1,true);\n    vector<bool>IsPrint(n+1,true);\n    vector<pii>mp(n+1);\n    int ans=0;\n    rep(i,n){\n        int temp; cin>>temp;\n        if(temp==0){ans++; mp[i+1]=pii(0,0);flag[i+1]=false; continue;}\n        mp[i+1]=pii(temp,mp[temp].second+1);\n        flag[temp]=false;\n    }\n    vector<int>yebi;\n    vector<int>dp(n+1,0);\n    rep(i,n)if(flag[i+1])yebi.push_back(i+1);\n    rep(z,yebi.size()){\n        int i=yebi[z];\n        ans++;\n        IsPrint[i]=false;\n        flag[i]=false;\n        pii next=mp[i];\n        for(int i=1;i<=k-1;i++){\n            if(mp[next.first].second==0)break;\n            if(IsPrint[next.first]==false){\n                if(dp[next.first]>=k-1-i)break;\n                dp[next.first]=max(dp[next.first],k-1-i);\n                IsPrint[next.first]=false;\n                next=mp[next.first];\n                continue;\n            }\n            IsPrint[next.first]=false;\n            flag[next.first]=false;\n            ans++;\n            next=mp[next.first];\n        }\n    }\n    cout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n \nint n,k;\nint a[100001];\nvector<int> G[100005];\nvector<int> rG[100005];\nint dist[100005];\n \nint main(void){\n    scanf(\"%d%d\",&n,&k);\n    queue<int> que;\n    memset(dist,-1,sizeof(dist));\n    for(int i=0;i<n;i++){\n        scanf(\"%d\",&a[i]);\n        if(a[i]>0){\n            G[a[i]-1].push_back(i);\n            rG[i].push_back(a[i]-1);\n        }\n    }\n    for(int i=0;i<n;i++){\n        if(G[i].size()==0){\n            que.push(i);\n            dist[i]=0;\n        }\n    }\n    while(que.size()){\n        int v=que.front();\n        que.pop();\n        for(int i=0;i<rG[v].size();i++){\n            if(dist[rG[v][i]]==-1){\n                dist[rG[v][i]]=dist[v]+1;\n                que.push(rG[v][i]);\n            }\n        }\n    }\n    int res=0;\n    for(int i=0;i<n;i++){\n        if(dist[i]<k || rG[i].size()==0)res++;\n    }\n    printf(\"%d\\n\",res);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nvector<pint> vp[100001];\nint d[100001];\nint INF=1000100010;\nint n;\nint dijkstra(int st){\n    priority_queue<pint,vector<pint>,greater<pint> > pq;\n    rep(i,n+1) d[i]=INF;\n    d[st]=0;\n    pq.push(make_pair(0,st));\n    while(!pq.empty()){\n        pint pi=pq.top();pq.pop();\n        int t=pi.second;\n        if(d[t]<pi.first) continue;\n        for(auto it:vp[t]){\n            if(d[it.second]>d[t]+it.first){\n                d[it.second]=d[t]+it.first;\n                pq.push(make_pair(d[it.second],it.second));\n            }\n        }\n    }\n}\nint cnt[100001];\nint main(){\n    int k,ai;\n    cin>>n>>k;\n    rep(i,n){\n        cin>>ai;\n        if(ai==0) vp[0].pb(1,i+1);\n        else vp[i+1].pb(1,ai);\n        ++cnt[ai];\n    }\n    FOR(i,1,n+1){\n        if(cnt[i]==0) vp[0].pb(1,i);\n    }\n    dijkstra(0);\n    int ans=0;\n    FOR(i,1,n+1)if(d[i]<=k) ++ans;\n    cout<<ans<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<queue>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n#include<climits>\n#include<sstream>\n#include<deque>\n#include<vector>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<bitset>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst int IINF = INT_MAX;\nconst ll LLINF = LLONG_MAX;\n\n#define MAX 101000\nint V,K;\nvector<int> G[MAX];\nvector<int> out_deg,depth,in_deg;\n\nvoid dfs(int cur,int pre,int d) {\n  assert( depth[cur] == 0 );\n  depth[cur] = d;\n  rep(i,(int)G[cur].size()) {\n    int nex = G[cur][i];\n    if( pre == nex ) continue;\n    dfs(nex,cur,d+1);\n  }\n}\n\nint main(){\n  cin >> V >> K;\n  out_deg = vector<int>(V+1,0);\n  in_deg = vector<int>(V+1,0);\n  depth = vector<int>(V+1,0);\n  rep(i,V) {\n    int a;\n    cin >> a;\n    if( a == 0 ) continue;\n    G[a].push_back(i+1);\n    ++out_deg[i+1];\n    ++in_deg[a];\n  }\n  REP(i,1,V+1) {\n    if( out_deg[i] == 0 ) {\n      dfs(i,-1,0);\n    }\n  }\n  int cnt = 0;\n  REP(i,1,V+1) {\n    if( depth[i] < K || in_deg[i] == 0 || out_deg[i] == 0 ) {\n      ++cnt;\n    }\n  }\n  cout << cnt << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(int i = ((int) a); i < ((int) n); i++)\n#define INF (1 << 30)\nusing namespace std;\n\nint N, K, A;\nvector<int> R, E[100000];\nbool ans[100000];\n\nint dfs(int v) {\n  int depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(int u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  REP(i, 0, N) ans[i] = false;\n  REP(i, 0, R.size()) ans[R[i]] = true, dfs(R[i]);\n\n  int cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint n,k,x;\nvector<int>v[100002];\nint d[100002],ans;\nbool b[100002],c[100002];\nbool t[100002],ng[100002];\nvoid dfs2(int p){\n\tif(ng[p])return;\n\tng[p]=1;\n\tr(i,v[p].size()){\n\t\tdfs2(v[p][i]);\n\t}\n}\nvoid dfs(int p,int de){\n\tc[p]=1;\n\tr(i,v[p].size()){\n\t\tif(de<k-1){\n\t\t\tdfs(v[p][i],de+1);\n\t\t}\n\t\telse{\n\t\t\tdfs2(v[p][i]);\n\t\t}\n\t}\n}\nint main(){\n\tr(i,100002)d[i]=1e8;\n\tcin>>n>>k;\n\tr(i,n){\n\t\tscanf(\"%d\",&x);\n\t\tif(x){\n\t\t\tv[i].push_back(x-1);\n\t\t\tb[i]=1;\n\t\t\tt[x-1]=1;\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(!t[i]){\n\t\t\tdfs(i,0);\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(c[i]||!b[i]){\n\t\t\tans++;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(int i = ((int) a); i < ((int) n); i++)\n#define INF (1 << 30)\nusing namespace std;\n\nint N, K, A;\nvector<int> R, E[100000];\nbool ans[100000];\n\nint dfs(int v) {\n  int depth = INF;\n  for(int u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth == INF) depth = 0;\n  if(depth < K) ans[v] = true;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  REP(i, 0, N) ans[i] = false;\n  REP(i, 0, R.size()) ans[R[i]] = true, dfs(R[i]);\n\n  int cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst int INF = 1 << 25;\nint to[100000];\nint dist[100000];\nint indeg[100000];\n\nint main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n#ifdef LOCAL\n\tstd::ifstream in(\"in\");\n\tstd::cin.rdbuf(in.rdbuf());\n#endif\n\n\tint N, K;\n\tcin >> N >> K;\n\tfor(int i = 0; i < N; i++){\n\t\tcin >> to[i];\n\t\tto[i]--;\n\t\tif(to[i] != -1) indeg[to[i]]++;\n\t\tdist[i] = INF;\n\t}\n\n\tqueue<int> q;\n\tfor(int i = 0; i < N; i++){\n\t\tif(indeg[i] == 0 && to[i] != -1){\n\t\t\tdist[i] = 0;\n\t\t\tq.push(i);\n\t\t}\n\t}\n\n\twhile(q.size()){\n\t\tint v = q.front();\n\t\tq.pop();\n\t\tif(dist[v] == K - 1 || to[v] == -1) continue;\n\t\tif(dist[to[v]] == INF){\n\t\t\tdist[to[v]] = dist[v] + 1;\n\t\t\tq.push(to[v]);\n\t\t}\n\t}\n\n\tint ans = 0;\n\tfor(int i = 0; i < N; i++){\n\t\tif(to[i] == -1 || dist[i] < K) ans++;\n\t}\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint k;\nbool y[123456];\nvector<pair<int,int> >a;\nvoid ta(int aa,int b){\n  b++;\n  if(b>k)return;\n  if(a[aa].second>b){\n    a[aa].second=b;\n    y[aa]=1;\n    ta(a[aa].first,b);\n  }\n  else return;\n}\n  \nint main(){\n  int n;\n  int co=0;\n  cin >> n >> k;\n  bool x[123456]={};\n  a=vector<pair<int,int> >(n,pair<int,int>(0,1234567));\n  for(int i=0;i<n;i++){\n    cin >> a[i].first;\n    if(a[i].first!=0){\n      a[i].first--;\n      x[a[i].first]=1;\n    }\n    else{\n      y[i]=1;\n    }\n  }\n  \n  //\n  for(int i=0;i<n;i++){\n    //cout << x[i] << endl;\n    if(!x[i]){\n      y[i]=1;\n      ta(i,0);\n    }\n  }\n  for(int i=0;i<n;i++){\n    //cout << y[i] << endl;\n    if(y[i]==1){\n      co++;\n    }\n  }\n  cout << co << endl;\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  // REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<string>\n#include<algorithm>\n#include<cmath>\n#include<queue>\n#include<vector>\n#include<stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;(i)<(n);(i)++)\n#define ll long long\n\nint color[100005];\n\nint main() {\n\tint N, K;\n\tint A[100005];\n\tcin >> N >> K;\n\tREP(i, N) {\n\t\tcin >> A[i];\n\t}\n\n\tREP(i, N) color[i] = -1;\n\n\tREP(i, N) {\n\t\tif (A[i] == 0) continue;\n\t\telse color[A[i] - 1] = 1;//????????§??????????????????\n\t}\n\tREP(i, N) {\n\t\tif (A[i] == 0) color[i] = 0;//????????????\n\t}\n\n\t//REP(i, N) {\n\t//\tcout << i << \" \" << color[i] << endl;\n\t//}\n\n\tint nxt;\n\tint cnt;\n\tREP(i, N) {\n\t\tif (color[i] == -1) {\n\t\t\tcolor[i] = 0;\n\n\t\t\tcnt = 1;\n\t\t\tnxt = A[i]-1;\n\t\t\twhile (cnt < K) {\n\t\t\t\tif (nxt == -1) break;\n\t\t\t\tcolor[nxt] = 0;\n\t\t\t\tcnt++;\n\t\t\t\tnxt = A[nxt]-1;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\tREP(i, N) {\n\t\tif (color[i] == 0) ans++;\n\t}\n\n\t//REP(i, N) {\n\t//\tcout << i << \" \" << color[i] << endl;\n\t//}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n\nstruct FastIO{\n  FastIO(){\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n  }\n}fastio_beet;\n\n//INSERT ABOVE HERE\nsigned main(){\n  Int n,k;\n  cin>>n>>k;\n  \n  vector<vector<Int> > G(n);\n  vector<Int> a(n);\n  for(Int i=0;i<n;i++){\n    cin>>a[i];\n    a[i]--;\n    if(~a[i]) G[a[i]].emplace_back(i);\n  }\n\n  vector<Int> dist(n,-1);\n  queue<Int> qu;\n  for(Int i=0;i<n;i++){\n    if(G[i].empty()){\n      dist[i]=0;\n      qu.emplace(i);\n    }\n  }\n  \n  while(!qu.empty()){\n    Int v=qu.front();qu.pop();\n    if(a[v]<0||~dist[a[v]]) continue;\n    dist[a[v]]=dist[v]+1;\n    qu.emplace(a[v]);\n  }\n  \n  Int ans=0;\n  for(Int i=0;i<n;i++){\n    if(~a[i]||dist[i]<k) ans++;    \n  } \n  cout<<ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define N 100010\n#define INF (1e9)\nusing namespace std;\n\nint n,K;\nint par[N];\nvector<int> G[N];\n\nint bfs(){\n  queue<int> Q;\n  vector<int> D(N,INF);\n  \n  for(int i=1;i<=n;i++) if(par[i] == 0) Q.push(i),D[i] = 1;\n  \n  int res = 0;\n  while(!Q.empty()){\n    int pos = Q.front();Q.pop();\n    int cost = D[pos];\n    int to = G[pos].empty()? -1:G[pos][0];\n    cout<<pos<<\" \"<<cost<<\" \"<<to<<endl;\n    res += to == 0 || cost <= K;\n    if(to >0 && D[to] == INF) Q.push(to),D[to] = cost+1;\n  }\n  return res;\n}\n\n\nint main(){\n  cin>>n>>K;\n\n  for(int i=1;i<=n;i++){\n    int a;\n    cin>>a;\n    G[i].push_back(a);\n    par[a] = 1; \n  }\n  cout<<bfs()<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iomanip>\n#include <iostream>\n#include <vector>\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\nconst int N = 123456;\n\nVI edges[N];\nint depth[N];\n\nvoid dfs(int v) {\n  int mi = 1e8;\n  REP(i, 0, edges[v].size()) {\n    int w = edges[v][i];\n    dfs(w);\n    mi = min(mi, depth[w]);\n  }\n  if (mi == (int) 1e8) {\n    depth[v] = 0;\n  } else {\n    depth[v] = mi + 1;\n  }\n}\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n, k;\n  cin >> n >> k;\n  VI a(n);\n  REP(i, 0, n) {\n    cin >> a[i];\n    a[i]--;\n    if (a[i] >= 0) {\n      edges[a[i]].push_back(i);\n    }\n  }\n  fill_n(depth, N, -1);\n  REP(i, 0, n) {\n    if (depth[i] == -1) {\n      dfs(i);\n    }\n  }\n  int tot = 0;\n  REP(i, 0, n) {\n    tot += depth[i] < k || a[i] == -1 ? 1 : 0;\n  }\n  cout << tot << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nconst double EPS = 1e-10;\nconst ll INF = 100000000;\nconst ll MOD = 1000000007;\n\nint n, k;\nint a[100000];\nvector<int> b[100000];\nbool saw[100000];\nint ans = 0;\n\nvoid dfs(int dep, int v) {\n    if(dep > k) return;\n    if(saw[v]) return;\n    saw[v] = true;\n    dfs(dep+1, a[v]);\n}\n\nint main(){\n    cin >> n >> k;\n    rep(i,n) {\n        cin >> a[i];\n        a[i]--;\n        if(a[i] == -1) continue;\n        b[a[i]].push_back(i);\n    }\n    rep(i,n) {\n        if(a[i] == -1 && saw[i] == false) {\n            saw[i] = true;\n            continue;\n        }\n        if(a[i] == -1) continue;\n        if(b[i].size() == 0) {\n            dfs(1, i);\n        }\n    }\n    rep(i,n) {\n        if(saw[i]) ans++;\n    }\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\n#define F first\n#define S second\n\nint used[100009];\nint jis[100009],n,k,a[100009];\nvector<int>v[100009];\n\nsigned main(){\n  cin>>n>>k;\n  r(i,n){\n    cin>>a[i];\n    if(a[i]){\n      v[a[i]-1].push_back(i);\n      jis[a[i]-1]++;\n    }\n  }\n  queue<int>q;\n  r(i,n){\n    if(jis[i]==0||a[i]==0){\n      q.push(i);\n      used[i]=1;\n    }\n  }\n  while(!q.empty()){\n    int x=q.front();q.pop();\n    //cout<<x<<' '<<used[x]<<endl;\n    if(used[x]==k)continue;\n    r(i,v[x].size()){\n      if(used[v[x][i]])continue;\n      used[v[x][i]]=used[x]+1;\n      q.push(v[x][i]);\n    }\n  }\n  int s=0;\n  r(i,n){\n    if(used[i])s++;\n  }\n  cout<<s<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\nll N, K;\nvoid dfs(ll& ans,vector<int>& f,vector<int>&b,vector<ll>&A, int n,int k) {\n\tif (k == K)return;\n\tif (b[n] == 0) {\n\t\tf[n] = 1; ans++; b[n] = 1;\n\t\tdfs(ans, f, b, A, A[n], k + 1);\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tcin >> N >> K;\n\tll ans = 0;\n\tvector<int> f(N, 0);\n\tvector<int> b(N, 0);\n\tvector<ll> A(N);\n\tfor (int i = 0; i < N;i++) {\n\t\tcin >> A[i];\n\t\tif (A[i] == 0) { ans++; f[i] = 1; b[i] = 1; }\n\t\telse {\n\t\t\tA[i]--;\n\t\t\tf[A[i]] = 1;\n\t\t}\n\t}\n\tfor (int i = 0; i < N;i++) {\n\t\tif (f[i] == 0) {\n\t\t\tdfs(ans, f, b, A, i,0);\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) /* depth = min(depth, dfs(u) + 1); */ dfs(u);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n// http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\ntypedef long long ll;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\nll N, K;\nll ans;\nvector<pll> T;\nvector<int> S;\nvector<ll> A;\n\nvoid solve(ll n, ll k) {\n\tif (n == 0) return;\n\tif (T[n].second > k)return;\n\tT[n].second = k;\n\tif (T[n].first == 0) { ans++; T[n].first = 1; }\n\tsolve(A[n], k - 1);\n\treturn;\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tans = 0;\n\tcin >> N >> K;\n\tT.resize(N + 1, { 0,0 });\n\tS.resize(N + 1, 0);\n\tA.resize(N + 1,-1);\n\tfor (int i = 1; i <= N;i++) {\n\t\tcin >> A[i];\n\t\tif (A[i] == 0) {\n\t\t\tans++; T[i] = { 1,K };\n\t\t\tS[i] = 1;\n\t\t}\n\t\telse {\n\t\t\tS[A[i]] = 1;\n\t\t}\n\t}\n\tfor (int i = 1; i <= N;i++) {\n\t\tif (S[i] == 1)continue;\n\t\tsolve(i, K - 1);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n#define all(a) (a).begin(),(a).end()\n#define pb emplace_back\n#define INF (1e9+1)\n\nvector<int> G[100001];\nvector<bool> used;\n\nint main(){\n    int n,k;\n    cin>>n>>k;\n    used.resize(n,false);\n    \n    vector<int> indeg(n,0), outdeg(n,0);\n    \n    rep(i,n){\n        int to;\n        cin>>to;\n        to--;\n        if(to>=0){\n            G[i].pb(to);\n            indeg[to]++;\n            outdeg[i]++;\n        }\n    }\n    rep(i,n){\n        if(outdeg[i]==0)used[i] = true;\n    }\n    \n    rep(i,n){\n        if(indeg[i]==0){\n            G[n].pb(i);\n        }\n    }\n    \n    vector<int> d(n+1,INF);\n    d[n] = 0;\n    \n    queue<int> que;\n    que.push(n);\n    \n    while(que.size()){\n        int q = que.front();\n        que.pop();\n        \n        for(auto e:G[q]){\n            if(d[e]>d[q]+1){\n                d[e] = d[q]+1;\n                que.push(e);\n            }\n        }\n    }\n    rep(i,n){\n        if(d[i]<=k)used[i] = true;\n    }\n    \n    int ans = 0;\n    rep(i,n)if(used[i])ans++;\n    \n    cout<<ans<<endl;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n\nusing namespace std;\n#define repeat(i,n) for(int i=0;i<(n);i++)\n\nvector<int> g[100005];// 0-indexed\nint root[100005];\nconst int inf=1e8;\nvector<int> d(100005, inf);\nint N, K;\n\nvoid f(int i, int p=-1){\n  int ret=inf;\n  for(int j: g[i])if(j!=p){\n    f(j, i);\n    ret=min(ret, d[j]);\n  }\n  if(ret==inf) d[i]=0;\n  else d[i]=ret+1;\n}\n\nint main(){\n\n  cin>> N>> K;\n  repeat(i, N){\n    int x; cin>> x;\n    if(x==0){\n      root[i]=1;\n    }else{\n      g[x-1].push_back(i);\n      // g[i].push_back(x-1);\n    }\n  }\n\n  repeat(i, N)if(root[i]){\n    f(i);\n  }\n\n  int c=0;\n  repeat(i, N){\n    if(root[i]) c++;\n    else c+=(d[i]<K);\n  }\n  cout<< c<< endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define REP2(i,m,n) for (int i=m;i<(n);i++)\ntypedef long long ll;\n\nint N, K;\nint A[101010];\nvector<int> edges[101010];\nint indeg[101010];\nbool ok[101010];\n\n\nint dfs(int n) {\n    if (edges[n].size() == 0) {\n        ok[n] = true;\n        return 1;\n    }\n\n    if (indeg[n] == 0)\n        ok[n] = true;\n\n    int ret = 1 << 29;\n    for (auto m: edges[n])\n        ret = min(ret, dfs(m));\n\n    if (ret < K)\n        ok[n] = true;\n\n    return ret + 1;\n}\n\n\nint main() {\n    memset(ok, 0, sizeof(ok));\n    memset(indeg, 0, sizeof(indeg));\n\n    cin >> N >> K;\n    REP(i, N) {\n        int a; cin >> a;\n        A[i] = a - 1;\n    }\n\n    REP(i, N) if (A[i] >= 0) {\n        edges[A[i]].push_back(i);\n        indeg[i] += 1;\n    }\n\n    REP(i, N) if (indeg[i] == 0) dfs(i);\n\n    int ans = 0;\n    REP(i, N) if (ok[i]) ans += 1;\n    cout << ans << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n// http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\ntypedef long long ll;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\nll N, K;\nll ans;\nvector<pll> T;\nvector<int> f1;\nvector<ll> f2;\n\nvoid solve(ll n, ll k) {\n\tk++;\n\tif (k > K)return;\n\tif (T[n].second > k) {\n\t\tT[n].second = k;\n\t\tf1[n] = 1;\n\t\tsolve(T[n].first, k);\n\t}\n\treturn;\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tans = 0;\n\tcin >> N >> K;\n\tT.resize(N , { 0,INF });\n\tf1.resize(N , 0);\n\tf2.resize(N, 0);\n\tfor (int i = 0; i < N;i++) {\n\t\tcin >> T[i].first;\n\t\tif (T[i].first == 0) {\n\t\t\tf1[i] = 1;\n\t\t}\n\t\telse {\n\t\t\tT[i].first--;\n\t\t\tf2[T[i].first] = 1;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < N;i++) {\n\t\tif (f2[i] == 0) {\n\t\t\tf1[i] = 1;\n\t\t\tsolve(i, 0);\n\t\t}\n\t}\n\tfor (int i = 0; i < N;i++) {\n\t\tif (f1[i] == 1)ans++;\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <queue>\n#include <vector>\n#define loop(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) loop(i, 0, n)\n#define all(v) (v).begin(), (v).end()\ntemplate<typename A, typename B> bool cmax(A &a, const B &b) { return a < b ? (a = b, true) : false; }\nusing namespace std;\n\nusing Weight = int;\nstruct Edge {\n  int src, dst;\n  Weight weight;\n  Edge(const int s = 0, const int d = 0, const Weight w = 0) : src(s), dst(d), weight(w) {}\n};\n\nusing Edges = std::vector<Edge>;\n\nclass Graph {\n  std::vector<Edges> g;\n  using const_iterator = std::vector<Edges>::const_iterator;\n\npublic:\n  Graph(const int size = 0) : g(size) {}\n  size_t size() const { return g.size(); }\n  const Edges &operator[](const int i) const { return g[i]; }\n  void addArc(const int src, const int dst, const Weight w = 1) { g[src].emplace_back(src, dst, w); }\n  void addEdge(const int node1, const int node2, const Weight w = 1) {\n    addArc(node1, node2, w);\n    addArc(node2, node1, w);\n  }\n  const_iterator begin() const { return g.begin(); }\n  const_iterator end() const { return g.end(); }\n};\n\nint main() {\n  int n, k;\n  cin >> n >> k;\n  Graph g(n);\n  rep(i, n) {\n    int a;\n    cin >> a;\n    if (a > 0) g.addArc(i, a - 1);\n  }\n  vector<int> in(n), out(n);\n  for (auto &es : g) {\n    for (auto &e : es) in[e.dst]++, out[e.src]++;\n  }\n  vector<int> dp(n);\n  rep(i, n) if (in[i] == 0) dp[i] = k;\n  for (int i = n - 1; i >= 0; i--) {\n    if (g[i].size()) cmax(dp[g[i][0].dst], dp[i] - 1);\n  }\n  rep(i, n) if (out[i] == 0) dp[i] = 1;\n  cout << count_if(all(dp), [](int x) { return x > 0; }) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <queue>\nusing namespace std;\n\nint n, k;\nvector<int> et[100000];\nint inCnt[100000];\n\nint main() {\n\tint i;\n\t\n\tcin >> n >> k;\n\tfor (i = 0; i < n; i++) {\n\t\tint a;\n\t\tcin >> a; a--;\n\t\tif (a >= 0) {\n\t\t\tet[i].push_back(a);\n\t\t\tinCnt[a]++;\n\t\t}\n\t}\n\t\n\tstatic int minDist[100000];\n\tqueue<int> que;\n\tfor (i = 0; i < n; i++) {\n\t\tminDist[i] = 11451419;\n\t\tif (et[i].size() == 0 || inCnt[i] == 0) {\n\t\t\tque.push(i);\n\t\t\tminDist[i] = 0;\n\t\t}\n\t}\n\t\n\twhile (!que.empty()) {\n\t\tint v = que.front(); que.pop();\n\t\tfor (i = 0; i < et[v].size(); i++) {\n\t\t\tif (minDist[et[v][i]] > minDist[v] + 1) {\n\t\t\t\tminDist[et[v][i]] = minDist[v] + 1;\n\t\t\t\tque.push(et[v][i]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint ans = 0;\n\tfor (i = 0; i < n; i++) {\n\t\tif (minDist[i] < k) {\n\t\t\tans++;\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A[100000];\nbool ans[100000];\n\nvoid dfs(ll i, ll depth) {\n  if(depth >= K) return;\n  ans[i] = true;\n  if(A[i] >= 0) dfs(A[i], depth + 1);\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) cin >> A[i], A[i]--;\n\n  REP(i, 0, N) ans[i] = true;\n  REP(i, 0, N) if(A[i] >= 0) ans[A[i]] = false;\n  REP(i, 0, N) ans[i] = ans[i] || A[i] == -1;\n\n  vector<ll> vec;\n  REP(i, 0, N) if(ans[i] >= 0) vec.push_back(i);\n  REP(i, 0, vec.size()) if(ans[vec[i]] && A[vec[i]] >= 0) dfs(vec[i], 0);\n\n  // REP(i, 0, N) cout << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <random>\n#include <set>\n#include <sstream>\n#include <string>\n#include <utility>\n#include <vector>\n\n#define REP(i,s,n) for(int i=(int)(s);i<(int)(n);i++)\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef pair<int, int> PI;\nconst int N = 123456;\n\nVI edges[N];\nint depth[N];\n\nvoid dfs(int v) {\n  int mi = 1e8;\n  REP(i, 0, edges[v].size()) {\n    int w = edges[v][i];\n    dfs(w);\n    mi = min(mi, depth[w]);\n  }\n  if (mi == (int) 1e8) {\n    depth[v] = 0;\n  } else {\n    depth[v] = mi + 1;\n  }\n}\n\nint main(void) {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  int n, k;\n  cin >> n >> k;\n  VI a(n);\n  REP(i, 0, n) {\n    cin >> a[i];\n    a[i]--;\n    if (a[i] >= 0) {\n      edges[a[i]].push_back(i);\n    }\n  }\n  fill_n(depth, N, -1);\n  REP(i, 0, n) {\n    if (depth[i] == -1) {\n      dfs(i);\n    }\n  }\n  int tot = 0;\n  REP(i, 0, n) {\n    tot += depth[i] < k || a[i] == -1 ? 1 : 0;\n  }\n  cout << tot << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main() {\n\n\tint N,K;\n\n\tscanf(\"%d %d\",&N,&K);\n\n\tint* table = new int[N];\n\tbool* henshin_sareru = new bool[N];\n\tbool* rule_3_apply = new bool[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d\",&table[i]);\n\t\thenshin_sareru[i] = false;\n\t\trule_3_apply[i] = false;\n\t}\n\n\tint rule_3_line = N;\n\n\tfor(int i = N-1; i >= 0; i--){\n\t\tif(table[i] > 0){\n\t\t\thenshin_sareru[table[i]-1] = true;\n\t\t}\n\t\tif(henshin_sareru[i] == false){\n\t\t\trule_3_line = max(0,i-(K-1));\n\t\t}else{\n\t\t\tif(i >= rule_3_line){\n\t\t\t\trule_3_apply[i] = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(table[i] == 0 || henshin_sareru[i] == false || rule_3_apply[i] == true)ans++;\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\n#define F first\n#define S second\n\nint used[100009];\nint jis[100009],n,k,a[100009];\nvector<int>v[100009];\n\nsigned main(){\n  cin>>n>>k;\n  r(i,n){\n    cin>>a[i];\n    if(a[i]){\n      v[i].push_back(a[i]-1);\n      jis[a[i]-1]++;\n    }\n  }\n  queue<int>q;\n  r(i,n){\n    if(jis[i]==0||a[i]==0){\n      if(a[i])q.push(i);\n      used[i]=1;\n    }\n  }\n  while(!q.empty()){\n    int x=q.front();q.pop();\n   // cout<<x<<' '<<used[x]<<endl;\n    if(used[x]==k)continue;\n    r(i,v[x].size()){\n      if(used[v[x][i]])continue;\n      used[v[x][i]]=used[x]+1;\n      q.push(v[x][i]);\n    }\n  }\n  int s=0;\n  r(i,n){\n    if(used[i])s++;\n  }\n  cout<<s<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n\nusing namespace std;\n#define repeat(i,n) for(int i=0;i<(n);i++)\n\nvector<int> g[100005];// 0-indexed\nint root[100005];\nconst int inf=1e8;\nvector<int> d(100005, inf);\nint N, K;\n\nvoid f(int i, int p=-1){\n  int ret=inf;\n  for(int j: g[i])if(j!=p){\n    f(j, i);\n    ret=min(ret, d[j]);\n  }\n  if(ret==inf) d[i]=0;\n  else d[i]=ret+1;\n}\n\nint main(){\n\n  cin>> N>> K;\n  repeat(i, N){\n    int x; cin>> x;\n    if(x==0){\n      root[i]=1;\n    }else{\n      g[x-1].push_back(i);\n      g[i].push_back(x-1);\n    }\n  }\n\n  repeat(i, N)if(root[i]){\n    f(i);\n  }\n\n  int c=0;\n  repeat(i, N){\n    if(root[i]) c++;\n    else c+=(d[i]<K);\n  }\n  cout<< c<< endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <queue>\n#include <vector>\n#define loop(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) loop(i, 0, n)\n#define all(v) (v).begin(), (v).end()\ntemplate<typename A, typename B> bool cmax(A &a, const B &b) { return a < b ? (a = b, true) : false; }\nusing namespace std;\n\nusing Weight = int;\nstruct Edge {\n  int src, dst;\n  Weight weight;\n  Edge(const int s = 0, const int d = 0, const Weight w = 0) : src(s), dst(d), weight(w) {}\n};\n\nusing Edges = std::vector<Edge>;\n\nclass Graph {\n  std::vector<Edges> g;\n  using const_iterator = std::vector<Edges>::const_iterator;\n\npublic:\n  Graph(const int size = 0) : g(size) {}\n  size_t size() const { return g.size(); }\n  const Edges &operator[](const int i) const { return g[i]; }\n  void addArc(const int src, const int dst, const Weight w = 1) { g[src].emplace_back(src, dst, w); }\n  void addEdge(const int node1, const int node2, const Weight w = 1) {\n    addArc(node1, node2, w);\n    addArc(node2, node1, w);\n  }\n  const_iterator begin() const { return g.begin(); }\n  const_iterator end() const { return g.end(); }\n};\n\nint main() {\n  int n, k;\n  cin >> n >> k;\n  Graph g(n);\n  rep(i, n) {\n    int a;\n    cin >> a;\n    if (a > 0) g.addArc(i, a - 1);\n  }\n  vector<int> in(n), out(n);\n  for (auto &es : g) {\n    for (auto &e : es) in[e.dst]++, out[e.src]++;\n  }\n  vector<int> dp(n);\n  rep(i, n) {\n    if (in[i] == 0) dp[i] = 0;\n    if (out[i] == 0) dp[i] = 0;\n  }\n  for (int i = n - 1; i >= 0; i--) {\n    if (g[i].size()) cmax(dp[g[i][0].dst], dp[i] + 1);\n  }\n  cout << count_if(all(dp), [&](int x) { return x <= k; }) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500010],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\telse if(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<=K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num <= 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint n,k;\nint a[100001];\nvector<int> G[100005];\nvector<int> rG[100005];\nint dist[100005];\n\nint main(void){\n\tscanf(\"%d%d\",&n,&k);\n\tqueue<int> que;\n\tmemset(dist,-1,sizeof(dist));\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tif(a[i]>0){\n\t\t\tG[a[i]-1].push_back(i);\n\t\t\trG[i].push_back(a[i]-1);\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tif(G[i].size()==0){\n\t\t\tque.push(i);\n\t\t\tdist[i]=0;\n\t\t}\n\t}\n\twhile(que.size()){\n\t\tint v=que.front();\n\t\tque.pop();\n\t\tfor(int i=0;i<rG[v].size();i++){\n\t\t\tif(dist[rG[v][i]]==-1){\n\t\t\t\tdist[rG[v][i]]=dist[v]+1;\n\t\t\t\tque.push(rG[v][i]);\n\t\t\t}\n\t\t}\n\t}\n\tint res=0;\n\tfor(int i=0;i<n;i++){\n\t\tif(dist[i]<k || rG[i].size()==0)res++;\n\t}\n\tprintf(\"%d\\n\",res);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main() {\n\n\tint N,K;\n\n\tscanf(\"%d %d\",&N,&K);\n\n\tint* table = new int[N];\n\tbool* henshin_sareru = new bool[N];\n\tbool* rule_3_apply = new bool[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d\",&table[i]);\n\t\thenshin_sareru[i] = false;\n\t\trule_3_apply[i] = false;\n\t}\n\n\tfor(int i = N-1; i >= 0; i--){\n\t\tif(table[i] > 0){\n\n\t\t\thenshin_sareru[table[i]-1] = true;\n\n\t\t\tif(henshin_sareru[i] == false){\n\n\t\t\t\tint count = 0,loc = table[i]-1;\n\n\t\t\t\twhile(count < K-1){\n\n\t\t\t\t\trule_3_apply[loc] = true;\n\t\t\t\t\thenshin_sareru[i] = true;\n\n\t\t\t\t\tif(table[loc] == 0)break;\n\n\t\t\t\t\tloc = table[loc]-1;\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(table[i] == 0 || henshin_sareru[i] == false || rule_3_apply[i] == true)ans++;\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n// http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\ntypedef long long ll;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\nll N, K;\nll ans;\nvector<pll> T;\nvector<int> S;\nvector<ll> A;\n\nvoid solve(ll n, ll k) {\n\tif (n == 0) return;\n\tif (T[n].second > k)return;\n\tif (T[n].first == 0) { ans++; T[n].first = 1; }\n\tsolve(A[n], k - 1);\n\treturn;\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tans = 0;\n\tcin >> N >> K;\n\tT.resize(N + 1, { 0,0 });\n\tS.resize(N + 1, 0);\n\tA.resize(N + 1,-1);\n\tfor (int i = 1; i <= N;i++) {\n\t\tcin >> A[i];\n\t\tif (A[i] == 0) {\n\t\t\tans++; T[i] = { 1,K };\n\t\t\tS[i] = 1;\n\t\t}\n\t\telse {\n\t\t\tS[A[i]] = 1;\n\t\t}\n\t}\n\tfor (int i = 1; i <= N;i++) {\n\t\tif (S[i] == 1)continue;\n\t\tsolve(i, K - 1);\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint n,k,x;\nvector<int>v[100002];\nint d[100002],ans;\nbool b[100002],c[100002];\nvoid dfs(int p,int de){\n\tc[p]=1;\n\td[p]=de;\n\tif(de<k)r(i,v[p].size()){\n\t\tif(d[v[p][i]]>de+1){\n\t\t\tdfs(v[p][i],de+1);\n\t\t}\n\t}\n}\nint main(){\n\tr(i,100002)d[i]=1e8;\n\tcin>>n>>k;\n\tr(i,n){\n\t\tscanf(\"%d\",&x);\n\t\tif(x){\n\t\t\tv[x-1].push_back(i);\n\t\t\tb[i]=1;\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(!b[i]){\n\t\t\tdfs(i,0);\n\t\t}\n\t}\n\tr(i,n)if(c[i])ans++;\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(int i = ((int) a); i < ((int) n); i++)\n#define INF (1 << 30)\nusing namespace std;\n\nint N, K, A;\nvector<int> R, E[100000];\nbool ans[100000];\n\nint dfs(int v) {\n  int depth = INF;\n  REP(i, 0, E[v].size()) depth = min(depth, dfs(E[v][i]));\n  if(depth == INF) depth = 0;\n  if(depth < K) ans[v] = true;\n  return depth + 1;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  REP(i, 0, N) ans[i] = false;\n  REP(i, 0, R.size()) ans[R[i]] = true, dfs(R[i]);\n\n  int cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<queue>\n#include<numeric>\nusing namespace std;\n\nint main(){\n    int n, k;\n    cin >> n >> k;\n    vector<int> a(n, 0), indeg(n, 0), v(n);\n    for(int i = 0; i < n; i++){\n        cin >> v[i];\n        v[i]--;\n        if(v[i] != -1)   indeg[v[i]]++;\n    }\n    priority_queue<pair<int,int>> pq;\n    for(int i = 0; i < n; i++){\n        if(indeg[i] == 0)   pq.push({k, i});\n    }\n    while(!pq.empty()){\n        pair<int,int> p = pq.top(); pq.pop();\n        int x = p.first, y = p.second;\n        if(a[y] == 1)    continue;\n        a[y] = 1;\n        if(x == 1 || v[y] == -1)    continue;\n        if(a[v[y]] == 0) pq.push({x-1, v[y]});\n    }\n    for(int i = 0; i < n; i++)  if(v[i] == -1)   a[i] = 1;\n    cout << accumulate(a.begin(), a.end(), 0) << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = double;\nconst ld eps = 1e-9;\n//\n//using Graph = vector<vector<int>>;\n//\n//int dfs(const Graph&g, const int now, vector<int>&ch_cnts) {\n//  ch_cnts[now]++;\n//  for (auto&& e : g[now]) {\n//      ch_cnts[now] += dfs(g, e, ch_cnts);\n//  }\n//  return ch_cnts[now];\n//}\n//\n//struct HL_Edge {\n//  int from;\n//  int to;\n//  bool heavy;\n//};\n//\n//void dfs2(const Graph&g, vector<vector<HL_Edge>>&hl_tree, const int now, const vector<int>&ch_cnts) {\n//\n//  int max_ch_id = 1;\n//  {\n//      int max_ch_num = -1;\n//      for (auto&&e : g[now]) {\n//          if (max_ch_num < ch_cnts[e]) {\n//              max_ch_num = ch_cnts[e];\n//              max_ch_id = e;\n//          }\n//      }\n//  }\n//  for (auto e : g[now]) {\n//      bool heavy = (e == max_ch_id);\n//\n//      hl_tree[now].push_back(HL_Edge{ now,e,heavy });\n//  }\n//  return;\n//}\n//\n//void HL(const vector<vector<int>>&ro_tree) {\n//  vector<int>ch_cnts(ro_tree.size());\n//\n//  dfs(ro_tree, 0, ch_cnts);\n//\n//  vector<vector<HL_Edge>>hl_tree(ro_tree.size());\n//\n//  dfs2(ro_tree, hl_tree, 0, ch_cnts);\n//}\n//\n//namespace FastFourierTransform\n//{\n//  using C = complex< double >;\n//\n//  void DiscreteFourierTransform(vector< C > &F, bool rev)\n//  {\n//      const int N = (int)F.size();\n//      const double PI = (rev ? -1 : 1) * acos(-1);\n//      for (int i = 0, j = 1; j + 1 < N; j++) {\n//          for (int k = N >> 1; k > (i ^= k); k >>= 1);\n//          if (i > j) swap(F[i], F[j]);\n//      }\n//      C w, s, t;\n//      for (int i = 1; i < N; i <<= 1) {\n//          for (int k = 0; k < i; k++) {\n//              w = polar(1.0, PI / i * k);\n//              for (int j = 0; j < N; j += i * 2) {\n//                  s = F[j + k];\n//                  t = C(F[j + k + i].real() * w.real() - F[j + k + i].imag() * w.imag(),\n//                      F[j + k + i].real() * w.imag() + F[j + k + i].imag() * w.real());\n//                  F[j + k] = s + t, F[j + k + i] = s - t;\n//              }\n//          }\n//      }\n//      if (rev) for (int i = 0; i < N; i++) F[i] /= N;\n//  }\n//\n//  vector< int> Multiply(const vector<int > &A, const vector<int > &B)\n//  {\n//      int sz = 1;\n//      while (sz <= A.size() + B.size()) sz <<= 1;\n//      vector< C > F(sz), G(sz);\n//      for (int i = 0; i < A.size(); i++) F[i] = A[i];\n//      for (int i = 0; i < B.size(); i++) G[i] = B[i];\n//      DiscreteFourierTransform(F, false);\n//      DiscreteFourierTransform(G, false);\n//      for (int i = 0; i < sz; i++) F[i] *= G[i];\n//      DiscreteFourierTransform(F, true);\n//      vector< int > X(A.size() + B.size() - 1);\n//      for (int i = 0; i < A.size() + B.size() - 1; i++) X[i] = F[i].real() + 0.5;\n//      return (X);\n//  }\n//};\n\n#define Seg_Max_N (1<<19) \n\nusing Value = int;\nconst Value ini = 0;\nstruct segtree {\n\tint N;\n\tvector<Value>dat;\n\n\tsegtree() {}\n\tsegtree(int n) :dat(2 * Seg_Max_N) {\n\t\tN = 1;\n\t\twhile (N < n) N *= 2;\n\t\tfor (int i = 0; i < 2 * N - 1; i++) {\n\t\t\tdat[i] = ini;\n\t\t}\n\t}\n\tValue connect(const Value&l, const Value&r) {\n\t\treturn l+r;\n\t}\n\t// update k th element\n\tvoid update(int k, Value a) {\n\t\tk += N - 1;\n\t\tdat[k] = a;\n\n\t\twhile (k > 0) {\n\t\t\tk = (k - 1) / 2;\n\t\t\tconst Value al(dat[k * 2 + 1]);\n\t\t\tconst Value ar(dat[k * 2 + 2]);\n\t\t\tdat[k] = connect(al, ar);\n\t\t}\n\t}\n\t// min [a, b)\n\tValue  query(int a, int b) { return query(a, b, 0, 0, N); }\n\tValue  query(int a, int b, int k, int l, int r) {\n\t\tif (r <= a or b <= l) return ini;\n\t\tif (a <= l and r <= b) return dat[k];\n\t\tconst int m = (l + r) / 2;\n\t\tconst Value al(query(a, b, k * 2 + 1, l, m));\n\t\tconst Value ar(query(a, b, k * 2 + 2, m, r));\n\t\treturn connect(al, ar);\n\t}\n};\n\npair<int, int>dfs(const vector<vector<int>>&edges, const int K,const int now) {\n\n\tint d=1e8;\n\tint sum=0;\n\tfor (auto e : edges[now]) {\n\t\tauto p(dfs(edges,K,e));\n\t\td=min(d,p.first);\n\t\tsum+=p.second;\n\t}\n\tif (edges[now].empty()) {\n\t\td=0;\n\t}\n\t{\n\t\tif (d < K) {\n\t\t\tsum++;\n\t\t}\n\t}\n\treturn make_pair(d+1,sum);\n\t\n}\n\n\nint main() {\n\tint N;cin>>N;\n\tint K;\n\tcin>>K;\n\n\tvector<vector<int>>edges(N);\n\tvector<int>comes(N);\n\tfor (int i = 0; i < N; ++i) {\n\t\tint a;cin>>a;\n\t\tif (a) {\n\t\t\tedges[a-1].push_back(i);\n\t\t\tcomes[i]++;\n\t\t}\n\t}\n\tint ans=0;\n\tfor (int i = 0; i < N; ++i) {\n\t\tif (comes[i] == 0) {\n\t\t\tauto p=dfs(edges,K,i);\n\t\t\tif (p.first <= K) {\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tans++;\n\t\t\t}\n\t\t\tans+=p.second;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500010],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\telse if(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<=K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num == 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<double,int,double> tp;\n//typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nDef inf=sizeof(Def)==sizeof(long long)?2e18:1e9;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nvi G;\nvvi rG;\nint out;\nint n,k;\nint dfs(int a){\n\tint t=inf;\n\trep(i,rG[a].size())t=min(t,dfs(rG[a][i]));\n\tif(t==inf)t=0;\n\tt++;\n\tif(t<=k&&G[a])out++;\n\treturn t;\n}\nint main(){\n\tcin>>n>>k;\n\tG=vi(n);\n\trep(i,n)cin>>G[i];\n\trG=vvi(n);\n\trep(i,n)if(G[i])rG[G[i]-1].pb(i);\n\tout=0;\n\trep(i,n)if(!G[i]){\n\t\tout++;\n\t\tdfs(i);\n\t}\n\tcout<<out<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#ifdef _DEBUG\n#include \"dump.hpp\"\n#else\n#define dump(...)\n#endif\n\n//#define int long long\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(c) begin(c),end(c)\nconst int INF = sizeof(int) == sizeof(long long) ? 0x3f3f3f3f3f3f3f3fLL : 0x3f3f3f3f;\nconst int MOD = (int)(1e9) + 7;\ntemplate<class T> bool chmax(T &a, const T &b) { if (a < b) { a = b; return true; } return false; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (b < a) { a = b; return true; } return false; }\n\nsigned main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint N, K; cin >> N >> K;\n\tvector<int> cnt(N);\n\tvector<vector<int>> child(N);\n\tvector<int> A(N); rep(i, 0, N) {\n\t\tcin >> A[i];\n\t\tA[i]--;\n\t\tif (A[i] != -1) {\n\t\t\tcnt[A[i]]++;\n\t\t\tchild[A[i]].push_back(i);\n\t\t}\n\t}\n\tdump(cnt);\n\tdump(child);\n\tvector<int> v(N);\n\tvector<bool> ok(N);\n\trep(i, 0, N) {\n\t\tif (A[i] == -1) {\n\t\t\tok[i] = true;\n\t\t}\n\t\tif (cnt[i] == 0) {\n\t\t\tok[i] = true;\n\t\t\tv[i] = K;\n\t\t}\n\t}\n\tfunction<int(int)> dfs = [&](int i) {\n\t\t\n\t\trep(j, 0, child[i].size()) {\n\t\t\tchmax(v[i], dfs(child[i][j]));\n\t\t}\n\n\t\tif (v[i] > 0)\n\t\t\tok[i] = true;\n\n\t\treturn v[i] - 1;\n\t};\n\n\trep(i, 0, N) {\n\t\tif (A[i] == -1) {\n\t\t\tdfs(i);\n\t\t}\n\t}\n\tint ans = 0;\n\trep(i, 0, N) {\n\t\tif (ok[i])\n\t\t\tans++;\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n \nvector<vector<int>> v(100010);\nvector<vector<int>> inv(100010);\nint a[100010];\n\nbool used[100010];\nint ans = 0;\nint n,k;\n\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout << fixed << setprecision(20);\n \n    cin>>n>>k;\n    for(int i=0;i<n;i++){\n        cin>>a[i];\n        a[i]--;\n        if(a[i]>=0){\n            v[i].push_back(a[i]);\n            inv[a[i]].push_back(i);\n        }\n    }\n    queue<int> q;\n    for(int i=0;i<n;i++){\n        if(a[i]==-1){\n            ans++;\n            used[i] = true;\n            continue;\n        }\n        if(inv[i].size()==0){\n            q.push(i);\n        }\n    }\n    int d[n] = {};\n    while(q.size()){\n        int t = q.front(); q.pop();\n        if(!used[t]) ans++;\n        used[t] = true;\n        for(auto i:v[t]){\n            if(!used[i] && d[t]+1<k){\n                if(d[i]==0){\n                    d[i] = d[t]+1;\n                    q.push(i);\n                }\n            }\n        }\n    }\n    \n    cout << ans << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500000],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\tif(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<=K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num == 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <string>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <stdio.h>\nusing namespace std;\n#define int long long\nint MOD = 1000000007;\nint N, K;\nvector<vector<int> > ed;\nvector<vector<int> > ed2;\nvector<int> ok;\nvector<int> v;\nvector<int> c;\nvector<int> c2;\nvector<int> dp;\nint dfs(int a, int d) {\n\tv[a] = 1;\n\tif (dp[a] != -1) {\n\t\treturn dp[a];\n\t}\n\tif (c[a] == 0) {\n\t\tdp[a] = 0;\n\t\treturn 0;\n\t}\n\tdp[a] = 100000000;\n\tfor (int i = 0; i < ed[a].size(); i++) {\n\t\tif (v[ed[a][i]] == 0) {\n\t\t\tdp[a] = min(dp[a] , 1 + dfs(ed[a][i], d + 1));\n\t\t}\n\t}\n\treturn dp[a];\n}\nsigned main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\t\n\tcin >> N>>K;\n\ted.resize(N);\n\tok.resize(N,0);\n\tv.resize(N, 0);\n\tc.resize(N, 0);\n\tc2.resize(N, 0);\n\tdp.resize(N, -1);\n\tint res = 0;\n\tint a;\n\n\tfor (int i = 0; i < N; i++) {\n\t\tcin >> a;\n\t\ta--;\n\t\tif (a == -1) {\n\t\t\tok[i] = 1;\n\t\t}\n\t\telse {\n\t\t\ted[a].push_back(i);\n\t\t\tc[a]++;\n\t\t\tc2[i]++;\n\t\t}\n\n\t}\n\tfor (int i = 0; i < N; i++) {\n\t\tif (c[i] == 0) {\n\t\t\tok[i] = 1;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < N; i++) {\n\t\tif (c2[i] == 0) {\n\t\t\tdfs(i, 0);\n\t\t}\n\t}\n\tfor (int i = 0; i < N; i++) {\n\t\tif (dp[i] < K) {\n\t\t\tok[i] = 1;\n\t\t}\n\t}\n\tfor (int i = 0; i < N; i++) {\n\t\tif (ok[i] == 1)res++;\n\t}\n\tcout << res << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define REP(i, n) rep(i, 0, n)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define int long long\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\ntypedef pair<int, int> P;\nconst int mod = 1000000007;\nconst int INF = 1e12;\n\nint b[100010];\nint f[100010];\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n, k;\n    cin >> n >> k;\n    vector<int> a(n);\n    rep(i, 0, n){\n        cin >> a[i]; a[i]--;\n        if(a[i] != -1){\n            b[a[i]]++;\n        }\n    }\n    set<int> st;\n    rep(i, 0, n){\n        if(a[i] == -1){\n            st.insert(i);\n            f[i] = 1;\n        }else if(b[i] == 0){\n            int now = i;\n            rep(j, 0, k){\n                if(now == -1) break;\n                if(f[now] > k - j) break;\n                // cout << now << endl;\n                st.insert(now);\n                f[now] = k - j;\n                now = a[now];\n            }\n        }\n    }\n    cout << st.size() << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#define loop(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) loop(i, 0, n)\n#define all(v) (v).begin(), (v).end()\ntemplate<typename A, typename B> bool cmax(A &a, const B &b) { return a < b ? (a = b, true) : false; }\nusing namespace std;\n\nint main() {\n  int n, k;\n  cin >> n >> k;\n  vector<int> tree(n), in(n), out(n);\n  rep(i, n) {\n    int a;\n    cin >> a;\n    tree[i] = a - 1;\n    if (a > 0) in[a - 1]++, out[i]++;\n  }\n  vector<int> dp(n);\n  rep(i, n) if (in[i] == 0) dp[i] = k;\n  for (int i = n - 1; i >= 0; i--) {\n    if (tree[i] > 0) cmax(dp[tree[i]], dp[i] - 1);\n  }\n  rep(i, n) if (out[i] == 0) dp[i] = 1;\n  cout << count_if(all(dp), [](int x) { return x > 0; }) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define REP2(i,m,n) for (int i=m;i<(n);i++)\ntypedef long long ll;\n\nint N, K;\nint A[101010];\nvector<int> edges[101010];\nint indeg[101010];\nbool ok[101010];\n\n\nint dfs(int n) {\n    if (edges[n].size() == 0) {\n        ok[n] = true;\n        return 1;\n    }\n\n    if (indeg[n] == 0)\n        ok[n] = true;\n\n    int ret = 1 << 29;\n    for (auto m: edges[n])\n        ret = min(ret, dfs(m));\n\n    if (ret < K)\n        ok[n] = true;\n\n    return ret + 1;\n}\n\n\nint main() {\n    memset(ok, 0, sizeof(ok));\n    memset(indeg, 0, sizeof(indeg));\n\n    cin >> N >> K;\n    REP(i, N) {\n        int a; cin >> a;\n        A[i] = a - 1;\n    }\n\n    REP(i, N) if (A[i] >= 0) {\n        edges[A[i]].push_back(i);\n        indeg[i] += 1;\n    }\n\n    REP(i, N) if (indeg[i] == 0) dfs(i);\n\n    int ans = 0;\n    REP(i, N) ans += ok[i];\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i, n) for(int i = 0; i < (n); i++)\n#define MEM(a, x) memset(a, x, sizeof(a))\n#define ALL(a) a.begin(), a.end()\n#define UNIQUE(a) a.erase(unique(ALL(a)), a.end())\ntypedef long long ll;\n\nint n, k;\nvector<int> g[100005];\nbool a[100005], b[100005], c[100005];\n\nvoid dfs(int x, int cnt) {\n\tc[x] = true;\n\tif (cnt+1 < k) {\n\t\tFOR(i, g[x].size()) dfs(g[x][i], cnt+1);\n\t}\n\treturn;\n}\n\nint main(int argc, char const *argv[]) {\n\tios_base::sync_with_stdio(false);\n\tcin >> n >> k;\n\tFOR(i, n) {\n\t\tint x;\n\t\tcin >> x;\n\t\tif (x == 0) a[i] = true;\n\t\telse {\n\t\t\tb[x-1] = true;\n\t\t\tg[i].push_back(x-1);\n\t\t}\n\t}\n\tFOR(i, n) {\n\t\tif (!b[i]) dfs(i, 0);\n\t}\n\tint ret = 0;\n\tFOR(i, n) {\n\t\tif (a[i] || c[i]) ret++;\n\t}\n\tcout << ret << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n\nconst int R = 10101010;\n\nint main()\n{\n    int n,k;\n    cin >>n >>k;\n    vector<int> a(n);\n    rep(i,n)\n    {\n        cin >>a[i];\n        --a[i];\n    }\n\n    vector<int> x(n,-1);\n    for(int i=n-1; i>=0; --i)\n    {\n        // leaf\n        if(x[i]==-1) x[i] = k;\n\n        if(a[i]>=0)\n        {\n            x[a[i]] = max(x[a[i]],max(0,x[i]-1));\n        }\n        else x[i]=R;\n    }\n\n    // rep(i,n) printf(\"x[%d] =%d\\n\", i,x[i]);\n\n    int ans = 0;\n    rep(i,n) ans += (x[i]>0);\n    cout << ans << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define loop(i,x,n) for(int i=x;i<n;i++)\n#define pb push_back\n#define mp make_pair\n#define fir first\n#define sec second\n#define MAX 100005\n#define int long long\nusing namespace std;\nconst int MOD=1000000007;\nconst int INF=1000000009;\n\nint n,k,ans=0;\nvector<int> in;\nvector<vector<int>> tree;\n\nint dfs(int x){\n  int t=INF;\n  rep(i,tree[x].size()){\n    t=min(t,dfs(tree[x][i]));\n  }\n  if(t==INF)t=0;\n  t++;\n  if(t<=k&&in[x]!=0)ans++;\n  return t;\n}\n\nsigned main(){\n    cin>>n>>k;\n    in=vector<int>(n);\n    tree=vector<vector<int>>(n);\n    rep(i,n)cin>>in[i];\n    rep(i,n){\n      if(in[i]!=0)tree[in[i]-1].pb(i);\n    }\n    rep(i,n){\n        if(in[i]==0){\n          ans++;\n          dfs(i);\n        }\n    }\n    cout<<ans<<endl;\n\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing ll = long long;\n// #define int ll\n#define FOR(i, a, b) for (int i = (a); i < int(b); ++i)\n#define RFOR(i, a, b) for (int i = (b)-1; i >= int(a); --i)\n#define rep(i, n) FOR(i, 0, n)\n#define rep1(i, n) FOR(i, 1, int(n) + 1)\n#define rrep(i, n) RFOR(i, 0, n)\n#define rrep1(i, n) RFOR(i, 1, int(n) + 1)\n#define all(c) begin(c), end(c)\n// const int MOD = 1000000007;\n\ntemplate <typename T>\nvoid __print__(std::ostream &os, const char *, const char *tail, const T &fst) {\n    os << fst << tail;\n}\ntemplate <typename Fst, typename... Rst>\nvoid __print__(std::ostream &os, const char *del, const char *tail, const Fst &fst,\n               const Rst &... rst) {\n    os << fst << del;\n    __print__(os, del, tail, rst...);\n}\n\n#ifdef LOCAL\n#define dump(...)                                         \\\n    do {                                                  \\\n        std::ostringstream os;                            \\\n        os << __LINE__ << \":\\t\" << #__VA_ARGS__ << \" = \"; \\\n        __print__(os, \", \", \"\\n\", __VA_ARGS__);           \\\n        std::cerr << os.str();                            \\\n    } while (0)\n#else\n#define dump(...)\n#endif\n\ntemplate <typename Fst, typename... Rst>\nvoid println(const Fst &fst, const Rst &... rst) {\n    __print__(std::cout, \"\\n\", \"\\n\", fst, rst...);\n}\ntemplate <typename Fst, typename... Rst>\nvoid print(const Fst &fst, const Rst &... rst) {\n    __print__(std::cout, \" \", \"\\n\", fst, rst...);\n}\n\ntemplate <typename iter>\nvoid println_(iter bgn, iter end) {\n    while (bgn != end) println(*bgn++);\n}\n\ntemplate <typename iter>\nvoid print_(iter bgn, iter end) {\n    while (bgn != end) {\n        std::cout << *bgn++;\n        std::cout << (bgn == end ? \"\\n\" : \" \");\n    }\n}\n\nint _ = (std::cout.precision(10), std::cout.setf(std::ios::fixed), std::cin.tie(0),\n         std::ios::sync_with_stdio(0), 0);\n\ntemplate <typename T>\nstd::vector<T> ndarray(int n, T v) {\n    return std::vector<T>(n, v);\n}\ntemplate <typename... Args>\nauto ndarray(int n, Args... args) {\n    auto val = ndarray(args...);\n    return std::vector<decltype(val)>(n, move(val));\n}\n\ntemplate <typename T>\nbool umax(T &a, const T &b) {\n    return a < b ? a = b, true : false;\n}\n\ntemplate <typename T>\nbool umin(T &a, const T &b) {\n    return a > b ? a = b, true : false;\n}\n\nusing namespace std;\n\nint n, k;\nint par[100010];\nvector<vector<int>> ch;\nint show[100010];\n\nint dfs(int v) {\n    if (ch[v].size() == 0) {\n        show[v] = true;\n        return 0;\n    } else {\n        int mi = 1e9;\n        for (auto &c : ch[v]) {\n            mi = min(mi, 1 + dfs(c));\n        }\n        show[v] = mi < k || par[v] == -1;\n        return mi;\n    }\n}\n\nsigned main() {\n    while (cin >> n >> k && n) {\n        memset(show, 0, sizeof show);\n        memset(par, -1, sizeof par);\n        ch.assign(n, {});\n        rep(i, n) {\n            cin >> par[i];\n            --par[i];\n            if (par[i] != -1) {\n                ch[par[i]].push_back(i);\n            }\n        }\n\n        rep(i, n) if (par[i] == -1) dfs(i);\n        int ans = count(show, show + n, 1);\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint k;\nbool y[12345];\nvector<pair<int,int> >a;\nvoid ta(int aa,int b){\n  b++;\n  if(b>k)return;\n  if(a[aa].second>b){\n    a[aa].second=b;\n    y[aa]=1;\n    ta(a[aa].first,b);\n  }\n  else return;\n}\n  \nint main(){\n  int n;\n  int co=0;\n  cin >> n >> k;\n  bool x[12345]={};\n  a=vector<pair<int,int> >(n,pair<int,int>(0,1234567));\n  for(int i=0;i<n;i++){\n    cin >> a[i].first;\n    if(a[i].first!=0){\n      a[i].first--;\n      x[a[i].first]=1;\n    }\n    else{\n      y[i]=1;\n    }\n  }\n  \n  //\n  for(int i=0;i<n;i++){\n    //cout << x[i] << endl;\n    if(!x[i]){\n      y[i]=1;\n      ta(i,0);\n    }\n  }\n  for(int i=0;i<n;i++){\n    //cout << y[i] << endl;\n    if(y[i]==1){\n      co++;\n    }\n  }\n  cout << co << endl;\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "// need\n#include <iostream>\n#include <algorithm>\n\n// data structure\n#include <bitset>\n//#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#include <array>\n//#include <tuple>\n//#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n//#include <deque>\n#include<valarray>\n\n// stream\n//#include <istream>\n//#include <sstream>\n//#include <ostream>\n//#include <fstream>\n\n// etc\n#include <cmath>\n#include <cassert>\n#include <functional>\n#include <iomanip>\n//#include <typeinfo>\n#include <chrono>\n#include <random>\n#include <numeric>\n\n// input\n#define INIT std::ios::sync_with_stdio(false);std::cin.tie(0);\n#define VAR(type, ...)type __VA_ARGS__;MACRO_VAR_Scan(__VA_ARGS__);\ntemplate<typename T> void MACRO_VAR_Scan(T& t) { std::cin >> t; }\ntemplate<typename First, typename...Rest>void MACRO_VAR_Scan(First& first, Rest&...rest) { std::cin >> first; MACRO_VAR_Scan(rest...); }\n#define VEC_ROW(type, n, ...)std::vector<type> __VA_ARGS__;MACRO_VEC_ROW_Init(n, __VA_ARGS__); for(int i=0; i<n; ++i){MACRO_VEC_ROW_Scan(i, __VA_ARGS__);}\ntemplate<typename T> void MACRO_VEC_ROW_Init(int n, T& t) { t.resize(n); }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Init(int n, First& first, Rest&...rest) { first.resize(n); MACRO_VEC_ROW_Init(n, rest...); }\ntemplate<typename T> void MACRO_VEC_ROW_Scan(int p, T& t) { std::cin >> t[p]; }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Scan(int p, First& first, Rest&...rest) { std::cin >> first[p]; MACRO_VEC_ROW_Scan(p, rest...); }\n#define VEC(type, c, n) std::vector<type> c(n);for(auto& i:c)std::cin>>i;\n#define MAT(type, c, m, n) std::vector<std::vector<type>> c(m, std::vector<type>(n));for(auto& r:c)for(auto& i:r)std::cin>>i;\n\n// output\n#define OUT(d) std::cout<<d;\n#define FOUT(n, d) std::cout<<std::fixed<<std::setprecision(n)<<d;\n#define SOUT(n, c, d) std::cout<<std::setw(n)<<std::setfill(c)<<d;\n#define SP std::cout<<\" \";\n#define TAB std::cout<<\"\\t\";\n#define BR std::cout<<\"\\n\";\n#define SPBR(i, n) std::cout<<(i + 1 == n ? '\\n' : ' ');\n#define ENDL std::cout<<std::endl;\n#define FLUSH std::cout<<std::flush;\n#define SHOW(d) {std::cerr << #d << \"\\t:\" << d << \"\\n\";}\n#define SHOWVECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOWVECTOR2(v) {std::cerr << #v << \"\\t:\\n\";for(const auto& xxx : v){for(const auto& yyy : xxx){std::cerr << yyy << \" \";}std::cerr << \"\\n\";}}\n#define SHOWQUEUE(a) {auto tmp(a);std::cerr << #a << \"\\t:\";while(!tmp.empty()){std::cerr << tmp.front() << \" \";tmp.pop();}std::cerr << \"\\n\";}\n\n// utility\n#define ALL(a) (a).begin(),(a).end()\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RFOR(i, a, b) for(int i=(b)-1;i>=(a);--i)\n#define REP(i, n) for(int i=0;i<int(n);++i)\n#define RREP(i, n) for(int i=int(n)-1;i>=0;--i)\n#define FORLL(i, a, b) for(ll i=ll(a);i<ll(b);++i)\n#define RFORLL(i, a, b) for(ll i=ll(b)-1;i>=ll(a);--i)\n#define REPLL(i, n) for(ll i=0;i<ll(n);++i)\n#define RREPLL(i, n) for(ll i=ll(n)-1;i>=0;--i)\n#define IN(a, x, b) (a<=x && x<b)\ntemplate<typename T> inline T CHMAX(T& a, const T b) { return a = (a < b) ? b : a; }\ntemplate<typename T> inline T CHMIN(T& a, const T b) { return a = (a > b) ? b : a; }\n#define EXCEPTION(msg) throw std::string(\"Exception : \" msg \" [ in \") + __func__ + \" : \" + std::to_string(__LINE__) + \" lines ]\"\n#define TRY(cond, msg) try {if (cond) EXCEPTION(msg);}catch (std::string s) {std::cerr << s << std::endl;}\nvoid CHECKTIME(std::function<void()> f) { auto start = std::chrono::system_clock::now(); f(); auto end = std::chrono::system_clock::now(); auto res = std::chrono::duration_cast<std::chrono::nanoseconds>((end - start)).count(); std::cerr << \"[Time:\" << res << \"ns  (\" << res / (1.0e9) << \"s)]\\n\"; }\n\n// test\ntemplate<class T> std::vector<std::vector<T>> VV(int n) {\n\treturn std::vector<std::vector<T>>(n);\n}\ntemplate<class T> std::vector<std::vector<T>> VV(int n, int m, T init = T()) {\n\treturn std::vector<std::vector<T>>(n, std::vector<T>(m, init));\n}\ntemplate<typename S, typename T>\nstd::ostream& operator<<(std::ostream& os, std::pair<S, T> p) {\n\tos << \"(\" << p.first << \", \" << p.second << \")\"; return os;\n}\n\n// type/const\n\n#define int ll\nusing ll = long long;\nusing ull = unsigned long long;\nusing PAIR = std::pair<int, int>;\nusing PAIRLL = std::pair<ll, ll>;\nconstexpr int INFINT = 1 << 30;                          // 1.07x10^ 9\nconstexpr int INFINT_LIM = (1LL << 31) - 1;              // 2.15x10^ 9\nconstexpr ll INFLL = 1LL << 60;                          // 1.15x10^18\nconstexpr ll INFLL_LIM = (1LL << 62) - 1 + (1LL << 62);  // 9.22x10^18\nconstexpr double EPS = 1e-7;\nconstexpr int MOD = 1000000007;\nconstexpr double PI = 3.141592653589793238462643383279;\n\nsigned main() {\n\tINIT;\n\tVAR(int, n, k);\n\tVEC(int, a, n);\n\tREP(i, n) --a[i];\n\tstd::vector<std::vector<int>> g(n + 1);\n\tstd::set<int> set;\n\tREP(i, n) {\n\t\tif (a[i] == -1) continue;\n\t\tg[i].emplace_back(a[i]);\n\t\tset.insert(a[i]);\n\t}\n\tREP(i, n) { // n -> [rule2]\n\t\tif (set.find(i) != set.end()) continue;\n\t\tg[n].emplace_back(i);\n\t}\n\n\tstd::vector<int> dist(n+1);\n\tstd::function<void(int)> Dijkstra = [&](int s) {\n\t\tusing P = std::pair<int, int>;\n\t\tstd::priority_queue<P, std::vector<P>, std::greater<P>> pq;\n\t\tstd::fill(dist.begin(), dist.end(), INFLL);\n\t\tdist[s] = 0;\n\t\tpq.push(P(0, s));\n\t\twhile (!pq.empty()) {\n\t\t\tP p = pq.top(); pq.pop();\n\t\t\tint v = p.second;\n\t\t\tif (dist[v] < p.first) continue;\n\t\t\tfor (int i = 0; i < g[v].size(); ++i) {\n\t\t\t\tint to = g[v][i];\n\t\t\t\tif (dist[to] > dist[v] + 1) {\n\t\t\t\t\tdist[to] = dist[v] + 1;\n\t\t\t\t\tpq.push(P(dist[to], to));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tDijkstra(n);\n\n\tREP(i, n) {\n\t\tif (a[i] == -1) dist[i] = 0;\n\t}\n\tint ans = 0;\n\tREP(i, n) {\n\t\tif (dist[i] <= k) ++ans;\n\t}\n\tOUT(ans)BR;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(int i = ((int) a); i < ((int) n); i++)\n#define INF (1 << 30)\nusing namespace std;\n\nint N, K, A;\nvector<int> R, E[100000];\nbool ans[100000];\n\nint dfs(int v) {\n  int depth = INF;\n  for(int u : E[v]) depth = min(depth, dfs(u));\n  if(depth == INF) depth = 0;\n  if(depth < K) ans[v] = true;\n  return depth + 1;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  REP(i, 0, N) ans[i] = false;\n  REP(i, 0, R.size()) ans[R[i]] = true, dfs(R[i]);\n\n  int cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nint n,k;\nint a[125252];\nint outdeg[125252], indeg[125252];\nint po[125252];\nbool view[125252];\nbool used[125252];\n\nint main(){\n  scanf(\"%d%d\",&n,&k);\n  REP(i,n)scanf(\"%d\",a+i),a[i]--;\n  REP(i,n){\n    if(a[i]!=-1){\n      outdeg[i]++;\n      indeg[a[i]]++;\n    }\n  }\n  REP(i,n)view[i] = (outdeg[i]==0) || (indeg[i]==0);\n  stack<int> S;\n  REP(i,n)if(indeg[i]==0){\n    po[i] = k;\n    S.push(i);\n  }\n  while(!S.empty()){\n    int p = S.top(); S.pop();\n    used[p] = true;\n    int to = a[p];\n    po[to] = max(po[to], po[p]-1);\n    indeg[to]--;\n    if(indeg[to] == 0){\n      S.push(to);\n    }\n  }\n  REP(i,n)view[i] = view[i] || (po[i]>0);\n  int ans = 0;\n  REP(i,n)ans+=view[i];\n  printf(\"%d\\n\",ans);\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) if(u >= 0) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint n,k;\nint a[100001];\nvector<int> G[100005];\nvector<int> rG[100005];\nint dist[100005];\n\nint main(void){\n\tscanf(\"%d%d\",&n,&k);\n\tqueue<int> que;\n\tmemset(dist,-1,sizeof(dist));\n\tfor(int i=0;i<n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tif(a[i]>0){\n\t\t\tG[a[i]-1].push_back(i);\n\t\t\trG[i].push_back(a[i]-1);\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++){\n\t\tif(G[i].size()==0){\n\t\t\tque.push(i);\n\t\t\tdist[i]=0;\n\t\t}\n\t}\n\twhile(que.size()){\n\t\tint v=que.front();\n\t\tque.pop();\n\t\tfor(int i=0;i<rG[v].size();i++){\n\t\t\tif(dist[rG[v][i]]==-1){\n\t\t\t\tdist[rG[v][i]]=dist[v]+1;\n\t\t\t\tque.push(rG[v][i]);\n\t\t\t}\n\t\t}\n\t}\n\tint res=0;\n\tfor(int i=0;i<n;i++){\n\t\tif(dist[i]<k || rG[i].size()==0)res++;\n\t}\n\tprintf(\"%d\\n\",res);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(int i = ((int) a); i < ((int) n); i++)\n#define INF (1 << 30)\nusing namespace std;\n\nint N, K, A;\nvector<int> R, E[100000];\nbool ans[100000];\n\nint dfs(int v) {\n  int depth = INF;\n  for(int u : E[v]) depth = min(depth, dfs(u));\n  if(depth == INF) depth = 0;\n  if(depth < K) ans[v] = true;\n  return depth + 1;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  REP(i, 0, N) ans[i] = false;\n  REP(i, 0, R.size()) ans[R[i]] = true, dfs(R[i]);\n\n  int cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i, n) for (long long i = 0, max_i = (n); i < max_i; i++)\ntemplate <class T>\nostream& operator<<(ostream& s, vector<T>& d) {\n    REP(i, d.size()) s << d[i] << (i == d.size() - 1 ? \"\" : \" \");\n    return s;\n}\nusing Int = long long;\n\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n\n    Int n, K;\n    cin >> n >> K;\n    vector<vector<Int>> g(n);\n    vector<Int> ps(n);\n    REP(i, n) {\n        Int p;\n        cin >> p;\n        ps[i] = p;\n        if (p) {\n            g[p - 1].push_back(i);\n        }\n    }\n\n    vector<bool> use(n);\n    vector<Int> rem(n, -1);\n    function<Int(Int)> dfs = [&](Int v) {\n        if (g[v].size() == 0) return rem[v] = K;\n        if (rem[v] != -1) return rem[v];\n        Int ma = 0;\n        for (Int s : g[v]) {\n            ma = max(ma, dfs(s) - 1);\n        }\n        return rem[v] = ma;\n    };\n    REP(i, n) { dfs(i); }\n    int ans = 0;\n    REP(i, n) {\n        ans += (rem[i] > 0 || ps[i] == 0);\n        // cerr << ans << \" \" << i << endl;\n    }\n    cout << ans << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500010],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\telse if(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<=K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num <= 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "x#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0; i<n;i++)\nusing namespace std;\n#define int long long\nsigned main(){\n    int n,k;\n    typedef pair<int,int> pii;\n    cin>>n>>k;\n    vector<bool>flag(n+1,true);\n    vector<bool>IsPrint(n+1,true);\n    vector<pii>mp(n+1);\n    int ans=0;\n    rep(i,n){\n        int temp; cin>>temp;\n        if(temp==0){ans++; mp[i+1]=pii(0,0);flag[i+1]=false; continue;}\n        mp[i+1]=pii(temp,mp[temp].second+1);\n        flag[temp]=false;\n    }\n    vector<int>yebi;\n    vector<int>dp(n+1,0);\n    rep(i,n)if(flag[i+1])yebi.push_back(i+1);\n    rep(z,yebi.size()){\n        int i=yebi[z];\n        ans++;\n        IsPrint[i]=false;\n        flag[i]=false;\n        pii next=mp[i];\n        for(int i=1;i<=k-1;i++){\n            if(mp[next.first].second==0)break;\n            if(IsPrint[next.first]==false){\n                if(dp[next.first]>=k-1-i)break;\n                dp[next.first]=max(dp[next.first],k-1-i);\n                IsPrint[next.first]=false;\n                next=mp[next.first];\n                continue;\n            }\n            IsPrint[next.first]=false;\n            flag[next.first]=false;\n            ans++;\n            next=mp[next.first];\n        }\n    }\n    cout<<ans<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n\n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=int(a)-1;i>=int(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n\n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n#define popcount(n) (__builtin_popcountll(n))\n\nusing namespace std;\n\ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n\nusing ll=long long;\nusing R=long double;\nconst R EPS=1e-9L; // [-1000,1000]->EPS=1e-8 [-10000,10000]->EPS=1e-7\ninline int sgn(const R& r){return(r > EPS)-(r < -EPS);}\ninline R sq(R x){return sqrt(max(x,0.0L));}\n\nconst int dx[8]={1,0,-1,0,1,-1,-1,1};\nconst int dy[8]={0,1,0,-1,1,1,-1,-1};\n\n// Problem Specific Parameter:\n\nset<int> ans;\nint a[100010];\nint d[100010];\n\nint main(void){\n\tint n,k;\n\tcin >> n >> k;\n\n\trep(i,n){\n\t\tcin >> a[i];\n\t\ta[i]--;\n\t\tif(a[i]>=0) d[a[i]]++;\n\t}\n\n\trep(i,n){\n\t\tif(a[i]==-1){ \n\t\t\tans.insert(i);\n\t\t}else if(d[i]==0){\n\n\t\t\tint cur = i;\n\t\t\trep(loop,k){\n\t\t\t\tans.insert(cur);\n\t\t\t\tif(a[cur]==-1) break;\n\t\t\t\tcur = a[cur];\n\t\t\t}\n\n\t\t}\n\t}\n\n\tcout << ans.size() << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nvector<vector<int> > G(100005);\nint N, K;\nint ans;\nbool checked[100005];\n// ??¨??????????????????????????????????????¢\nint dfs(int v, int s) {\n  int ret = 1e9;\n  checked[v] = true;\n  if(G[v].size() == 0) {\n    ans++;\n    return 1;\n  }\n  for(auto to : G[v]) {\n    ret = min(ret, dfs(to, s));\n  }\n  if(ret < K && v != s) ans++;\n  return ret + 1;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cin >> N >> K;\n  int st;\n  FOR(i,1,N+1) {\n    int in; cin >> in;\n    G[in].push_back(i);\n  }\n  FOR(i,1,N+1){\n    if(checked[i]) continue;\n    if(dfs(i, i) != 1) ans ++;\n  }\n  cout << ans << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define REP(i, n) rep(i, 0, n)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define int long long\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\ntypedef pair<int, int> P;\nconst int mod = 1000000007;\nconst int INF = 1e12;\n\nint G[100010];\nint b[100010];\nint f[100010];\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n, k;\n    cin >> n >> k;\n    vector<int> a(n);\n    rep(i, 0, n){\n        cin >> a[i];\n        G[i] = a[i] - 1;\n        if(a[i] != 0){\n            b[a[i] - 1]++;\n        }\n    }\n    set<int> st;\n    rep(i, 0, n){\n        if(G[i] == -1) st.insert(i);\n        else if(b[i] == 0){\n            int now = i;\n            rep(j, 0, k){\n                if(now == -1) break;\n                if(f[now] > k - j) break;\n                st.insert(now);\n                f[now] = k - j;\n                int next = G[now];\n                now = next;\n            }\n        }\n    }\n    cout << st.size() << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<double,int,double> tp;\n//typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nDef inf=sizeof(Def)==sizeof(long long)?2e18:1e9;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\nint n,m;\nint out;\nvi in;\nvvi G;\nint dfs(int a){\n\tint t=inf;\n\trep(i,G[a].size()){\n\t\tt=min(t,dfs(G[a][i]));\n\t}\n\tif(t==inf)t=0;\n\tt++;\n\tif(t<=m&&in[a])out++;\n\treturn t;\n}\nint main(){\n\tout=0;\n\tcin>>n>>m;\n\tin=vi(n);\n\trep(i,n)cin>>in[i];\n\tG=vvi(n);\n\trep(i,n)if(in[i]){\n\t\tG[in[i]-1].pb(i);\n\t}\n\trep(i,n)if(!in[i]){\n\t\tout++;\n\t\tdfs(i);\n\t}\n\tcout<<out<<endl;\n}\n\n\n\n\n/*\nvi G;\nvvi rG;\nint out;\nint n,k;\nint dfs(int a){\n\tint t=inf;\n\trep(i,rG[a].size())t=min(t,dfs(rG[a][i]));\n\tif(t==inf)t=0;\n\tt++;\n\tif(t<=k&&G[a])out++;\n\treturn t;\n}\nint main(){\n\tcin>>n>>k;\n\tG=vi(n);\n\trep(i,n)cin>>G[i];\n\trG=vvi(n);\n\trep(i,n)if(G[i])rG[G[i]-1].pb(i);\n\tout=0;\n\trep(i,n)if(!G[i]){\n\t\tout++;\n\t\tdfs(i);\n\t}\n\tcout<<out<<endl;\n}\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define FOR(i,a,b) for(ut i=(a);i<(ut)(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define ALL(c) c.begin(),c.end()\n#define PB push_back\n#define cat //cout << __LINE__ << endl;\nusing namespace std;\ntypedef long long LL;\ntypedef double ld;\ntypedef LL ut;\ntypedef vector<ut> VI;\ntypedef pair<ut,ut> pr;\ntypedef pair<ut,pr> ppr;\ntypedef vector<pr> Vpr;\ntypedef vector<ppr> Vppr;\ntypedef priority_queue<ut,VI> PQ;\nconst int SIZE=2*1e5;\nconst LL INF=1LL<<60;\nconst LL p=7+1e9;\nLL N,K,A[SIZE];\nLL B[SIZE];\nLL dist[SIZE];\nLL solve(){\n\tLL ans=0;\n\tcin >> N >> K;\n\tFOR(i,1,N+1){\n\t\tcin >> A[i];\n\t\tB[A[i]]++;\n\t}\n\tqueue<LL> qu;\n\tFOR(i,1,N+1){\n\t\tdist[i]=INF;\n\t\tif(B[i]==0){\n\t\t\tdist[i]=0;\n\t\t\tqu.push(i);\n\t\t}\n\t\telse if(A[i]==0){\n\t\t\tdist[i]=0;\n\t\t\tans++;\n\t\t}\n\t}\n\twhile(!qu.empty()){\n\t\tint now=qu.front();\n\t\tqu.pop();\n\t\tans++;\n\n\t\tif(dist[A[now]]==INF){\n\t\t\tdist[A[now]]=dist[now]+1;\n\t\t\tif(dist[A[now]]<K)\n\t\t\t\tqu.push(A[now]);\n\t\t}\n\t}\n\treturn ans;\n}\nint main(){\n\tcout << solve() << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define loop(i, a, b) for(int i = a; i < b; i++) \n#define rep(i, a) loop(i, 0, a)\nusing namespace std;\nconst int MOD = 1000000007;\nconst int inf = 1e8;\nusing vi = vector <int>;\nusing vvi = vector <vi>;\nusing vc = vector <char>;\nusing vvc = vector <vc>;\nusing vs = vector <string>;\nusing vvs = vector <vs>;\n//g++ -std==c++14\n//setprecision(10)\nint n, k, ans;\nvi in;\nvvi G;\n\nint dfs(int a){\n    int t = inf;\n    if(!G[a].size()){\n        if(in[a])ans++;\n        return 1;\n    }\n    rep(i,G[a].size()) t = min(t, dfs(G[a][i]));\n    t++;\n    if(t <= k && in[a]) ans++;\n    return t;\n}\n\nint main(){\n    cin >> n >> k;\n    in = vi(n);\n    G = vvi(n);\n    rep(i, n){\n        cin >> in[i];\n        if(in[i]) G[in[i] - 1].push_back(i);\n    }\n    rep(i, n){\n        if(!in[i]){\n            ans++;\n            dfs(i);\n        }\n    }\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A[100000];\nbool ans[100000];\n\nvoid dfs(ll i, ll depth) {\n  if(depth >= K) return;\n  ans[i] = true;\n  if(A[i] >= 0) dfs(A[i], depth + 1);\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) cin >> A[i], A[i]--;\n\n  REP(i, 0, N) ans[i] = true;\n  REP(i, 0, N) if(A[i] >= 0) ans[A[i]] = false;\n\n  vector<ll> vec;\n  REP(i, 0, N) if(ans[i]) vec.push_back(i);\n  REP(i, 0, vec.size()) if(A[vec[i]] >= 0) dfs(vec[i], 0);\n\n  REP(i, 0, N) ans[i] = ans[i] || A[i] == -1;\n\n  // REP(i, 0, N) cout << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define REP(i, n) rep(i, 0, n)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define int long long\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\ntypedef pair<int, int> P;\nconst int mod = 1000000007;\nconst int INF = 1e12;\n\nint b[100010];\nint f[100010];\nvector<int> G[100010];\nint n, k;\nset<int> st;\n\nint dfs(int now){\n    if(G[now].size() == 0){\n        st.insert(now);\n        return 1;\n    }\n    int res = INF;\n    rep(i, 0, G[now].size()){\n        chmin(res, dfs(G[now][i]) + 1);\n    }\n    if(res <= k) st.insert(now);\n    return res;\n}\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cin >> n >> k;\n    vector<int> a(n);\n    rep(i, 0, n){\n        cin >> a[i]; a[i]--;\n        if(a[i] != -1){\n            b[a[i]]++;\n            G[a[i]].push_back(i);\n        }\n    }\n    // set<int> st;\n    rep(i, 0, n){\n        if(a[i] == -1){\n            st.insert(i);\n            dfs(i);\n        }\n    }\n    // cout << ans << endl;\n    cout << st.size() << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nconst double EPS = 1e-10;\nconst ll INF = 100000000;\nconst ll MOD = 1000000007;\n\nint n, k;\nint a[100000];\nvector<int> b[100000];\nbool saw[100000];\nint ans = 0;\nqueue<P> que;\n\nint main(){\n    cin >> n >> k;\n    rep(i,n) {\n        cin >> a[i];\n        a[i]--;\n        if(a[i] == -1) continue;\n        b[a[i]].push_back(i);\n    }\n    rep(i,n) {\n        if(a[i] == -1 && saw[i] == false) {\n            saw[i] = true;\n            continue;\n        }\n        if(a[i] == -1) continue;\n        if(b[i].size() == 0) {\n            while(!que.empty()) que.pop();\n            que.push(P(1, i));\n            while(!que.empty()) {\n                P p = que.front(); que.pop();\n                if(saw[p.second]) continue;\n                saw[p.second] = true;\n                if(p.first == k) continue;\n                que.push(P(p.first+1, a[p.second]));\n            }\n        }\n    }\n    rep(i,n) {\n        if(saw[i]) ans++;\n    }\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n// http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\ntypedef long long ll;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\nll N, K;\nll ans;\nvector<pll> T;\nvector<int> f1;\nvector<ll> f2;\n \nvoid solve(ll n, ll k) {\n    k++;\n    if (k > K)return;\n    if (T[n].second > k) {\n        T[n].second = k;\n        f1[n] = 1;\n        solve(T[n].first, k);\n    }\n    return;\n}\n \nint main() {\n    cin.tie(0); ios::sync_with_stdio(false);\n    ans = 0;\n    cin >> N >> K;\n    T.resize(N , { 0,INF });\n    f1.resize(N , 0);\n    f2.resize(N, 0);\n    for (int i = 0; i < N;i++) {\n        cin >> T[i].first;\n        if (T[i].first == 0) {\n            f1[i] = 1;\n        }\n        else {\n            T[i].first--;\n            f2[T[i].first] = 1;\n        }\n    }\n \n    for (int i = 0; i < N;i++) {\n        if (f2[i] == 0) {\n            f1[i] = 1;\n            solve(i, 0);\n        }\n    }\n    for (int i = 0; i < N;i++) {\n        if (f1[i] == 1)ans++;\n    }\n    cout << ans << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// need\n#include <iostream>\n#include <algorithm>\n\n// data structure\n#include <bitset>\n//#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#include <array>\n//#include <tuple>\n//#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n//#include <deque>\n#include<valarray>\n\n// stream\n//#include <istream>\n//#include <sstream>\n//#include <ostream>\n//#include <fstream>\n\n// etc\n#include <cmath>\n#include <cassert>\n#include <functional>\n#include <iomanip>\n//#include <typeinfo>\n#include <chrono>\n#include <random>\n#include <numeric>\n\n// input\n#define INIT std::ios::sync_with_stdio(false);std::cin.tie(0);\n#define VAR(type, ...)type __VA_ARGS__;MACRO_VAR_Scan(__VA_ARGS__);\ntemplate<typename T> void MACRO_VAR_Scan(T& t) { std::cin >> t; }\ntemplate<typename First, typename...Rest>void MACRO_VAR_Scan(First& first, Rest&...rest) { std::cin >> first; MACRO_VAR_Scan(rest...); }\n#define VEC_ROW(type, n, ...)std::vector<type> __VA_ARGS__;MACRO_VEC_ROW_Init(n, __VA_ARGS__); for(int i=0; i<n; ++i){MACRO_VEC_ROW_Scan(i, __VA_ARGS__);}\ntemplate<typename T> void MACRO_VEC_ROW_Init(int n, T& t) { t.resize(n); }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Init(int n, First& first, Rest&...rest) { first.resize(n); MACRO_VEC_ROW_Init(n, rest...); }\ntemplate<typename T> void MACRO_VEC_ROW_Scan(int p, T& t) { std::cin >> t[p]; }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Scan(int p, First& first, Rest&...rest) { std::cin >> first[p]; MACRO_VEC_ROW_Scan(p, rest...); }\n#define VEC(type, c, n) std::vector<type> c(n);for(auto& i:c)std::cin>>i;\n#define MAT(type, c, m, n) std::vector<std::vector<type>> c(m, std::vector<type>(n));for(auto& r:c)for(auto& i:r)std::cin>>i;\n\n// output\n#define OUT(d) std::cout<<d;\n#define FOUT(n, d) std::cout<<std::fixed<<std::setprecision(n)<<d;\n#define SOUT(n, c, d) std::cout<<std::setw(n)<<std::setfill(c)<<d;\n#define SP std::cout<<\" \";\n#define TAB std::cout<<\"\\t\";\n#define BR std::cout<<\"\\n\";\n#define SPBR(i, n) std::cout<<(i + 1 == n ? '\\n' : ' ');\n#define ENDL std::cout<<std::endl;\n#define FLUSH std::cout<<std::flush;\n#define SHOW(d) {std::cerr << #d << \"\\t:\" << d << \"\\n\";}\n#define SHOWVECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOWVECTOR2(v) {std::cerr << #v << \"\\t:\\n\";for(const auto& xxx : v){for(const auto& yyy : xxx){std::cerr << yyy << \" \";}std::cerr << \"\\n\";}}\n#define SHOWQUEUE(a) {auto tmp(a);std::cerr << #a << \"\\t:\";while(!tmp.empty()){std::cerr << tmp.front() << \" \";tmp.pop();}std::cerr << \"\\n\";}\n\n// utility\n#define ALL(a) (a).begin(),(a).end()\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RFOR(i, a, b) for(int i=(b)-1;i>=(a);--i)\n#define REP(i, n) for(int i=0;i<int(n);++i)\n#define RREP(i, n) for(int i=int(n)-1;i>=0;--i)\n#define FORLL(i, a, b) for(ll i=ll(a);i<ll(b);++i)\n#define RFORLL(i, a, b) for(ll i=ll(b)-1;i>=ll(a);--i)\n#define REPLL(i, n) for(ll i=0;i<ll(n);++i)\n#define RREPLL(i, n) for(ll i=ll(n)-1;i>=0;--i)\n#define IN(a, x, b) (a<=x && x<b)\ntemplate<typename T> inline T CHMAX(T& a, const T b) { return a = (a < b) ? b : a; }\ntemplate<typename T> inline T CHMIN(T& a, const T b) { return a = (a > b) ? b : a; }\n#define EXCEPTION(msg) throw std::string(\"Exception : \" msg \" [ in \") + __func__ + \" : \" + std::to_string(__LINE__) + \" lines ]\"\n#define TRY(cond, msg) try {if (cond) EXCEPTION(msg);}catch (std::string s) {std::cerr << s << std::endl;}\nvoid CHECKTIME(std::function<void()> f) { auto start = std::chrono::system_clock::now(); f(); auto end = std::chrono::system_clock::now(); auto res = std::chrono::duration_cast<std::chrono::nanoseconds>((end - start)).count(); std::cerr << \"[Time:\" << res << \"ns  (\" << res / (1.0e9) << \"s)]\\n\"; }\n\n// test\ntemplate<class T> std::vector<std::vector<T>> VV(int n) {\n\treturn std::vector<std::vector<T>>(n);\n}\ntemplate<class T> std::vector<std::vector<T>> VV(int n, int m, T init = T()) {\n\treturn std::vector<std::vector<T>>(n, std::vector<T>(m, init));\n}\ntemplate<typename S, typename T>\nstd::ostream& operator<<(std::ostream& os, std::pair<S, T> p) {\n\tos << \"(\" << p.first << \", \" << p.second << \")\"; return os;\n}\n\n// type/const\n\n#define int ll\nusing ll = long long;\nusing ull = unsigned long long;\nusing PAIR = std::pair<int, int>;\nusing PAIRLL = std::pair<ll, ll>;\nconstexpr int INFINT = 1 << 30;                          // 1.07x10^ 9\nconstexpr int INFINT_LIM = (1LL << 31) - 1;              // 2.15x10^ 9\nconstexpr ll INFLL = 1LL << 60;                          // 1.15x10^18\nconstexpr ll INFLL_LIM = (1LL << 62) - 1 + (1LL << 62);  // 9.22x10^18\nconstexpr double EPS = 1e-7;\nconstexpr int MOD = 1000000007;\nconstexpr double PI = 3.141592653589793238462643383279;\n\nsigned main() {\n\tINIT;\n\tVAR(int, n, k);\n\tVEC(int, a, n);\n\tREP(i, n) --a[i];\n\tstd::vector<std::vector<int>> g(n + 1);\n\tstd::set<int> set;\n\tREP(i, n) {\n\t\tif (a[i] == -1) continue;\n\t\tg[i].emplace_back(a[i]);\n\t\tset.insert(a[i]);\n\t}\n\tREP(i, n) { // n -> [rule2]\n\t\tif (set.find(i) != set.end()) continue;\n\t\tg[n].emplace_back(i);\n\t}\n\n\tstd::queue<int> que;\n\tque.push(n);\n\tstd::vector<int> dist(n + 1, 0);\n\twhile (!que.empty()) {\n\t\tint now = que.front(); que.pop();\n\t\tfor (auto to : g[now]) {\n\t\t\tdist[to] = dist[now] + 1;\n\t\t\tque.push(to);\n\t\t}\n\t}\n\n\tREP(i, n) {\n\t\tif (a[i] == -1) dist[i] = 0;\n\t}\n\tint ans = 0;\n\tREP(i, n) {\n\t\tif (dist[i] <= k) ++ans;\n\t}\n\tOUT(ans)BR;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// need\n#include <iostream>\n#include <algorithm>\n\n// data structure\n#include <bitset>\n//#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#include <array>\n//#include <tuple>\n//#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n//#include <deque>\n#include<valarray>\n\n// stream\n//#include <istream>\n//#include <sstream>\n//#include <ostream>\n//#include <fstream>\n\n// etc\n#include <cmath>\n#include <cassert>\n#include <functional>\n#include <iomanip>\n//#include <typeinfo>\n#include <chrono>\n#include <random>\n#include <numeric>\n\n// input\n#define INIT std::ios::sync_with_stdio(false);std::cin.tie(0);\n#define VAR(type, ...)type __VA_ARGS__;MACRO_VAR_Scan(__VA_ARGS__);\ntemplate<typename T> void MACRO_VAR_Scan(T& t) { std::cin >> t; }\ntemplate<typename First, typename...Rest>void MACRO_VAR_Scan(First& first, Rest&...rest) { std::cin >> first; MACRO_VAR_Scan(rest...); }\n#define VEC_ROW(type, n, ...)std::vector<type> __VA_ARGS__;MACRO_VEC_ROW_Init(n, __VA_ARGS__); for(int i=0; i<n; ++i){MACRO_VEC_ROW_Scan(i, __VA_ARGS__);}\ntemplate<typename T> void MACRO_VEC_ROW_Init(int n, T& t) { t.resize(n); }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Init(int n, First& first, Rest&...rest) { first.resize(n); MACRO_VEC_ROW_Init(n, rest...); }\ntemplate<typename T> void MACRO_VEC_ROW_Scan(int p, T& t) { std::cin >> t[p]; }\ntemplate<typename First, typename...Rest>void MACRO_VEC_ROW_Scan(int p, First& first, Rest&...rest) { std::cin >> first[p]; MACRO_VEC_ROW_Scan(p, rest...); }\n#define VEC(type, c, n) std::vector<type> c(n);for(auto& i:c)std::cin>>i;\n#define MAT(type, c, m, n) std::vector<std::vector<type>> c(m, std::vector<type>(n));for(auto& r:c)for(auto& i:r)std::cin>>i;\n\n// output\n#define OUT(d) std::cout<<d;\n#define FOUT(n, d) std::cout<<std::fixed<<std::setprecision(n)<<d;\n#define SOUT(n, c, d) std::cout<<std::setw(n)<<std::setfill(c)<<d;\n#define SP std::cout<<\" \";\n#define TAB std::cout<<\"\\t\";\n#define BR std::cout<<\"\\n\";\n#define SPBR(i, n) std::cout<<(i + 1 == n ? '\\n' : ' ');\n#define ENDL std::cout<<std::endl;\n#define FLUSH std::cout<<std::flush;\n#define SHOW(d) {std::cerr << #d << \"\\t:\" << d << \"\\n\";}\n#define SHOWVECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOWVECTOR2(v) {std::cerr << #v << \"\\t:\\n\";for(const auto& xxx : v){for(const auto& yyy : xxx){std::cerr << yyy << \" \";}std::cerr << \"\\n\";}}\n#define SHOWQUEUE(a) {auto tmp(a);std::cerr << #a << \"\\t:\";while(!tmp.empty()){std::cerr << tmp.front() << \" \";tmp.pop();}std::cerr << \"\\n\";}\n\n// utility\n#define ALL(a) (a).begin(),(a).end()\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RFOR(i, a, b) for(int i=(b)-1;i>=(a);--i)\n#define REP(i, n) for(int i=0;i<int(n);++i)\n#define RREP(i, n) for(int i=int(n)-1;i>=0;--i)\n#define FORLL(i, a, b) for(ll i=ll(a);i<ll(b);++i)\n#define RFORLL(i, a, b) for(ll i=ll(b)-1;i>=ll(a);--i)\n#define REPLL(i, n) for(ll i=0;i<ll(n);++i)\n#define RREPLL(i, n) for(ll i=ll(n)-1;i>=0;--i)\n#define IN(a, x, b) (a<=x && x<b)\ntemplate<typename T> inline T CHMAX(T& a, const T b) { return a = (a < b) ? b : a; }\ntemplate<typename T> inline T CHMIN(T& a, const T b) { return a = (a > b) ? b : a; }\n#define EXCEPTION(msg) throw std::string(\"Exception : \" msg \" [ in \") + __func__ + \" : \" + std::to_string(__LINE__) + \" lines ]\"\n#define TRY(cond, msg) try {if (cond) EXCEPTION(msg);}catch (std::string s) {std::cerr << s << std::endl;}\nvoid CHECKTIME(std::function<void()> f) { auto start = std::chrono::system_clock::now(); f(); auto end = std::chrono::system_clock::now(); auto res = std::chrono::duration_cast<std::chrono::nanoseconds>((end - start)).count(); std::cerr << \"[Time:\" << res << \"ns  (\" << res / (1.0e9) << \"s)]\\n\"; }\n\n// test\ntemplate<class T> std::vector<std::vector<T>> VV(int n) {\n\treturn std::vector<std::vector<T>>(n);\n}\ntemplate<class T> std::vector<std::vector<T>> VV(int n, int m, T init = T()) {\n\treturn std::vector<std::vector<T>>(n, std::vector<T>(m, init));\n}\ntemplate<typename S, typename T>\nstd::ostream& operator<<(std::ostream& os, std::pair<S, T> p) {\n\tos << \"(\" << p.first << \", \" << p.second << \")\"; return os;\n}\n\n// type/const\n\n#define int ll\nusing ll = long long;\nusing ull = unsigned long long;\nusing PAIR = std::pair<int, int>;\nusing PAIRLL = std::pair<ll, ll>;\nconstexpr int INFINT = 1 << 30;                          // 1.07x10^ 9\nconstexpr int INFINT_LIM = (1LL << 31) - 1;              // 2.15x10^ 9\nconstexpr ll INFLL = 1LL << 60;                          // 1.15x10^18\nconstexpr ll INFLL_LIM = (1LL << 62) - 1 + (1LL << 62);  // 9.22x10^18\nconstexpr double EPS = 1e-7;\nconstexpr int MOD = 1000000007;\nconstexpr double PI = 3.141592653589793238462643383279;\n\nsigned main() {\n\tINIT;\n\tVAR(int, n, d);\n\tVEC_ROW(int, n, t, f);\n\tint pos = 1;\n\tint preT = 0;\n\tint ele = 0;\n\tint ans = 0;\n\tREP(i, n) {\n\t\tint ti = t[i] - preT;\n\t\tif (pos - 1 + f[i] - 1 <= ti) {\n\t\t\tans += (pos - 1) * ele;\n\t\t\tele = 1;\n\t\t}\n\t\telse if(std::abs(pos - f[i]) <= ti) {\n\t\t\tans += ti * ele;\n\t\t\t++ele;\n\t\t\tif (ele > d) {\n\t\t\t\tOUT(-1)BR;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tOUT(-1)BR;\n\t\t\treturn 0;\n\t\t}\n\t\tpreT = t[i];\n\t\tpos = f[i];\n\t}\n\tans += (pos - 1) * ele;\n\tOUT(ans)BR;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n\nusing namespace std;\n\n#define REP(i, n) for(int i=0; i<n; i++)\n\nint INF = 10e8;\nint n, k;\nint a[100000];\nvector<int> g[100000];\nbool show[100000];\nint d[100000];\n\nint dfs(int idx){\n\tif((int)g[idx].size() == 0){\n\t\td[idx] = 0; return 0;\n\t} else {\n\t\tint mindis = INF;\n\t\tREP(i, (int)g[idx].size()){\n\t\t\tmindis = min(dfs(g[idx][i]) + 1, mindis);\n\t\t}\n\t\td[idx] = mindis;\n\t\treturn mindis;\n\t}\n}\n\nint main(){\n\tcin >> n >> k;\n\tREP(i, n){\n\t\tcin >> a[i];\n\t}\n\n\tREP(i, n){\n\t\t show[i] = false;\n\t}\n\n\tREP(i, n){\n\t\tif(a[i] == 0){\n\t\t\tg[i] = vector<int>();\n\t\t\tshow[i] = true;\n\t\t} else {\n\t\t\tg[a[i]-1].push_back(i);\n\t\t}\n\t}\n\n\tREP(i, n){\n\t\td[i] = INF;\n\t}\n\n\tREP(i, n){\n\t\tif(a[i] == 0){\n\t\t\tint d = dfs(i);\n\t\t}\n\t}\n\n\tREP(i, n){\n\t\tif(d[i] < k){\n\t\t\tshow[i] = true;\n\t\t}\n\t}\n\t\n\tint output = 0;\n\tREP(i, n){\n\t\tif(show[i]) output += 1;\n\t}\n\n\tcout << output << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\n#define fore(i,a) for(auto &i:a)\n#pragma GCC optimize (\"-O3\")\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\n//---------------------------------------------------------------------------------------------------\n/*---------------------------------------------------------------------------------------------------\n????????????????????????????????? ??§?????§  \n??????????????? ??§?????§ ???????´<_??? ?????? Welcome to My Coding Space!\n???????????? ??? ?´_???`??????/??? ???i     \n?????????????????????????????? ???  |???|     \n????????? /?????? /??£??£??£??£/??????|  \n??? ???_(__??????/???    ???/ .| .|????????????  \n??? ????????????/????????????/??????u??????  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\n\n\nint N, K, A[101010];\nint ok[101010];\nvector<int> E[101010];\nint ein[101010], dp[101010], vis[101010];\n//--------------------------------------------------------------------------------------------------\nvoid _main() {\n    cin >> N >> K;\n    rep(i, 0, N) cin >> A[i];\n\n    rep(i, 0, N) {\n        if (A[i] == 0) ok[i] = 1;\n        else {\n            E[i].push_back(A[i] - 1);\n            ein[A[i] - 1]++;\n        }\n    }\n\n    rep(i, 0, N) if (ein[i] == 0) ok[i] = 1;\n\n    queue<int> q;\n    rep(i, 0, N) if (ein[i] == 0 && 0 < E[i].size()) {\n        q.push(i);\n        dp[i] = K;\n    }\n\n    while (!q.empty()) {\n        int i = q.front(); q.pop();\n        if (vis[i]) continue;\n        vis[i] = 1;\n\n        if (dp[i] == 0) continue;\n\n        ok[i] = 1;\n        fore(to, E[i]) {\n            dp[to] = max(dp[to], dp[i] - 1);\n            q.push(to);\n        }\n    }\n\n    int ans = 0;\n    rep(i, 0, N) if (ok[i]) ans++;\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A - 1 >= 0) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nusing ll=long long;\nusing vi=vector<int>;\nusing pii=pair<int,int>;\n#define ALL(c) begin(c),end(c)\n#define RALL(c) rbegin(c),rend(c)\n#define ITR(i,b,e) for(auto i=(b);i!=(e);++i)\n#define FORE(x,c) for(auto &x:c)\n#define REPF(i,a,n) for(int i=a,i##len=(int)(n);i<i##len;++i)\n#define REP(i,n) REPF(i,0,n)\n#define REPR(i,n) for(int i=(int)(n);i>=0;--i)\n#define SZ(c) ((int)c.size())\n#define CONTAIN(c,x) (c.find(x)!=end(c))\n#define OUTOFRANGE(y,x,h,w) (y<0||x<0||y>=h||x>=w)\n#define dump(...)\nconst int DX[9]={0,1,0,-1,1,1,-1,-1,0},DY[9]={-1,0,1,0,-1,1,1,-1,0};\n#define INF (1001001001)\n#define INFLL (1001001001001001001ll)\ntemplate<class T> ostream& operator << (ostream &os,const vector<T> &v) {\n    ITR(i,begin(v),end(v)) os<<*i<<(i==end(v)-1?\"\":\" \"); return os; }\ntemplate<class T> istream& operator >> (istream &is,vector<T> &v) {\n    ITR(i,begin(v),end(v)) is>>*i; return is; }\ntemplate<class T> istream& operator >> (istream &is, pair<T,T> &p) {\n    is>>p.first>>p.second; return is; }\ntemplate<class T> bool chmax(T &a,const T &b) {if(a<b) {a=b;return 1;} return 0;}\ntemplate<class T> bool chmin(T &a,const T &b) {if(b<a) {a=b;return 1;} return 0;}\ntemplate <class T> using heap = priority_queue<T,vector<T>,greater<T>>;\n//------------------------------------------------------------------------------\nstruct before_main_function {\n    before_main_function() {\n        #ifdef int\n            #undef INF\n            #define INF INFLL\n            #define stoi stoll\n        #endif\n        cin.tie(0);ios::sync_with_stdio(false);\n        cout<<setprecision(15)<<fixed;\n        #define endl \"\\n\"\n    }\n} before_main_function;\n//------------------8<------------------------------------8<--------------------\n\nstruct node {\n    bool root;\n    int child;\n    node():root(1),child(-1) {}\n};\nsigned main() {\n    int n,k;\n    cin>>n>>k;\n    vector<node> g(n);\n    REP(i,n) {\n        int a;\n        cin>>a;\n        g[i].child=a-1;\n        if(a-1>0) g[a-1].root=0;\n    }\n    set<int> ans;\n    REP(i,n) {\n        if(g[i].child==-1) ans.insert(i);\n        else if(g[i].root) {\n            int cur=i;\n            int d=0;\n            while(g[cur].child!=-1 && d<k) {\n                ans.insert(cur);\n                cur=g[cur].child;\n                d++;\n            }\n        }\n    }\n    cout<<SZ(ans)<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\n#define REP(i, b, e) for (auto i = b; i < e; ++i)\n\nint n, k;\n\nvector<vector<int>> graph;\nvector<int> par;\n\nint ans;\n\nint dfs(int node) {\n    if (graph[node].empty()) {\n        ans++;\n        return 0;\n    }\n\n    int ret = n + 1;\n\n    for (int to : graph[node]) {\n        ret = min(ret, dfs(to) + 1);\n    }\n\n    if (ret < k || par[node] == -1) {\n        ans++;\n    }\n\n    return ret;\n}\n\nint main() {\n    cin >> n >> k;\n\n    graph.assign(n, {});\n    par.assign(n, -1);\n    REP(i, 0, n) {\n        int x;\n        cin >> x;\n        x--;\n        if (x == -1) {\n            continue;\n        }\n        graph[x].push_back(i);\n        par[i] = x;\n    }\n\n    REP(i, 0, n) {\n        if (par[i] == -1) {\n            dfs(i);\n        }\n    }\n\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n\n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=int(a)-1;i>=int(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n\n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n#define popcount(n) (__builtin_popcountll(n))\n\nusing namespace std;\n\ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n\nusing ll=long long;\nusing R=long double;\nconst R EPS=1e-9L; // [-1000,1000]->EPS=1e-8 [-10000,10000]->EPS=1e-7\ninline int sgn(const R& r){return(r > EPS)-(r < -EPS);}\ninline R sq(R x){return sqrt(max(x,0.0L));}\n\nconst int dx[8]={1,0,-1,0,1,-1,-1,1};\nconst int dy[8]={0,1,0,-1,1,1,-1,-1};\n\n// Problem Specific Parameter:\n\n\nconst int limit = 100010;\nvector<int> graph[limit];\nset<int> ans;\nint n,k;\n\nint dfs(int v,int p,int d){\n\n\tif(graph[v].size()==0){\n\t\tans.insert(v);\n\t\treturn d;\n\t}\n\n\tint ret = 1 << 20;\n\tfor(auto &v2:graph[v]){\n\t\tif(v2==p) continue;\n\t\tret = min(ret,dfs(v2,v,d+1));\n\t}\n\n\tif(ret - d < k) ans.insert(v);\n\n\treturn ret;\n}\n\nint a[limit];\n\nint main(void){\n\tcin >> n >> k;\n\n\trep(i,n){\n\t\tcin >> a[i];\n\t\ta[i]--;\n\t\tif(a[i]>=0) graph[a[i]].push_back(i);\n\t}\n\n\trep(i,n){\n\t\tif(a[i]==-1){\n\t\t\tdfs(i,-1,0);\n\t\t\tans.insert(i);\n\t\t}\n\t}\n\n\tcout << ans.size() << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<queue>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n#include<climits>\n#include<sstream>\n#include<deque>\n#include<vector>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<bitset>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst int IINF = INT_MAX;\nconst ll LLINF = LLONG_MAX;\n\n#define MAX 101000\nint V,K;\nvector<int> G[MAX];\nvector<int> out_deg,depth,in_deg;\n\nvoid dfs(int cur,int pre,int d) {\n  assert( depth[cur] == 0 );\n  depth[cur] = d;\n  rep(i,(int)G[cur].size()) {\n    int nex = G[cur][i];\n    if( pre == nex ) continue;\n    dfs(nex,cur,d+1);\n  }\n}\n\nint main(){\n  cin >> V >> K;\n  out_deg = vector<int>(V+1,0);\n  in_deg = vector<int>(V+1,0);\n  depth = vector<int>(V+1,0);\n  rep(i,V) {\n    int a;\n    cin >> a;\n    if( a == 0 ) continue;\n    G[a].push_back(i+1);\n    ++out_deg[i+1];\n    ++in_deg[a];\n  }\n  REP(i,1,V+1) {\n    if( out_deg[i] == 0 ) {\n      dfs(i,-1,0);\n    }\n  }\n  int cnt = 0;\n  rep(i,V) {\n    if( depth[i] < K || in_deg[i] == 0 ) {\n      ++cnt;\n    }\n  }\n  cout << cnt << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define lp(i,n) for(int i=0;i<n;i++)\n#define lps(i,j,n) for(int i=j;i<n;i++)\n#define fordebug int hoge;cin>>hoge;\n#define DEKAI 1000000007;\n#define INF (1<<28)\n#define int long long\n#define double long double\n#define floot10 cout<<fixed<<setprecision(10)\nint check[101000];\nint nex[101000];\nint done[101000];\n\nsigned main(){\n  int n,k;\n  cin>>n>>k;\n  int ans=0;\n  lp(i,n){\n    int a;\n    cin>>a;\n    if(a==0) ans++;\n    else{\n      nex[i+1]=a;\n      check[a]=1;\n    }\n  }\n  queue<pair<int,int> > q;\n  lp(i,n+1){\n    if(i==0) continue;\n    if(check[i]==0){\n      q.push({i,0});\n    }\n  }\n  while(!q.empty()){\n    int now=q.front().first;\n    int count=q.front().second;\n    q.pop();\n    if(done[now]==1) continue;\n    done[now]=1;\n    if(count>=k) continue;\n    if(nex[now]==0) continue;\n    ans++;\n    q.push({nex[now],count+1});\n  }\n  cout<<ans<<endl;\n  return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main() {\n\n\tint N,K;\n\n\tscanf(\"%d %d\",&N,&K);\n\n\tint* table = new int[N];\n\tbool* henshin_sareru = new bool[N];\n\tbool* rule_3_apply = new bool[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d\",&table[i]);\n\t\thenshin_sareru[i] = false;\n\t\trule_3_apply[i] = false;\n\t}\n\n\tfor(int i = N-1; i >= 0; i--){\n\t\tif(table[i] > 0){\n\n\t\t\thenshin_sareru[table[i]-1] = true;\n\n\t\t\tif(henshin_sareru[i] == false){\n\n\t\t\t\tint count = 0,loc = table[i]-1;\n\n\t\t\t\twhile(count < K-1){\n\n\t\t\t\t\trule_3_apply[loc] = true;\n\t\t\t\t\thenshin_sareru[loc] = true;\n\n\t\t\t\t\tif(table[loc] == 0)break;\n\n\t\t\t\t\tloc = table[loc]-1;\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(table[i] == 0 || henshin_sareru[i] == false || rule_3_apply[i] == true)ans++;\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nusing ll=long long;\nusing vi=vector<int>;\nusing pii=pair<int,int>;\n#define ALL(c) begin(c),end(c)\n#define RALL(c) rbegin(c),rend(c)\n#define ITR(i,b,e) for(auto i=(b);i!=(e);++i)\n#define FORE(x,c) for(auto &x:c)\n#define REPF(i,a,n) for(int i=a,i##len=(int)(n);i<i##len;++i)\n#define REP(i,n) REPF(i,0,n)\n#define REPR(i,n) for(int i=(int)(n);i>=0;--i)\n#define SZ(c) ((int)c.size())\n#define CONTAIN(c,x) (c.find(x)!=end(c))\n#define OUTOFRANGE(y,x,h,w) (y<0||x<0||y>=h||x>=w)\n#define dump(...)\nconst int DX[9]={0,1,0,-1,1,1,-1,-1,0},DY[9]={-1,0,1,0,-1,1,1,-1,0};\n#define INF (1001001001)\n#define INFLL (1001001001001001001ll)\ntemplate<class T> ostream& operator << (ostream &os,const vector<T> &v) {\n    ITR(i,begin(v),end(v)) os<<*i<<(i==end(v)-1?\"\":\" \"); return os; }\ntemplate<class T> istream& operator >> (istream &is,vector<T> &v) {\n    ITR(i,begin(v),end(v)) is>>*i; return is; }\ntemplate<class T> istream& operator >> (istream &is, pair<T,T> &p) {\n    is>>p.first>>p.second; return is; }\ntemplate<class T> bool chmax(T &a,const T &b) {if(a<b) {a=b;return 1;} return 0;}\ntemplate<class T> bool chmin(T &a,const T &b) {if(b<a) {a=b;return 1;} return 0;}\ntemplate <class T> using heap = priority_queue<T,vector<T>,greater<T>>;\n//------------------------------------------------------------------------------\nstruct before_main_function {\n    before_main_function() {\n        #ifdef int\n            #undef INF\n            #define INF INFLL\n            #define stoi stoll\n        #endif\n        cin.tie(0);ios::sync_with_stdio(false);\n        cout<<setprecision(15)<<fixed;\n        #define endl \"\\n\"\n    }\n} before_main_function;\n//------------------8<------------------------------------8<--------------------\n\nstruct node {\n    bool root;\n    int child;\n    int h;\n    node():root(1),child(-1) {}\n};\nsigned main() {\n    int n,k;\n    cin>>n>>k;\n    vector<node> g(n);\n    REP(i,n) {\n        int a;\n        cin>>a;\n        g[i].child=a-1;\n        if(a-1>0) g[a-1].root=0;\n    }\n    unordered_set<int> ans;\n    REP(i,n) {\n        if(g[i].child==-1) ans.insert(i);\n        else if(g[i].root) {\n            int cur=i;\n            int d=k;\n            while(g[cur].child!=-1 && d>0) {\n                ans.insert(cur);\n                g[cur].h=d;\n                cur=g[cur].child;\n                d--;\n                if(g[cur].h>=d) break;\n            }\n        }\n    }\n    cout<<SZ(ans)<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  int n,k; cin >> n >> k;\n  vector<int> a(n),G[n];\n  int ans = 0;\n  for(int i = 0; i < n; i++){\n    cin >> a[i];\n    a[i]--;\n    if(a[i] == -1) continue;\n    G[a[i]].push_back(i);\n  }\n\n  vector<int> d(n,0);\n  function< int(int) > rec =\n  [&](int u){\n    if(G[u].empty()) return d[u] = 1;\n    for(auto v : G[u]){\n      d[u] = max(d[u],rec(v) + 1);\n    }\n    return d[u];\n  };\n\n  for(int i = 0; i < n; i++){\n    if(!G[i].empty() && !d[i]){\n      rec(i);\n      ans++;\n      if(a[i] == -1) ans++;\n    }\n  }\n  cout << ans << endl;\n  for(int i = 0; i < n; i++){\n    cout << i << \" \" << d[i] << endl;\n    if(d[i] < k) ans++;\n  }\n  cout << ans << endl;\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\n#define fi first\n#define se second\nint n,k,x;\nvector<int>v[100002];\nint d[100002],ans;\nbool b[100002],c[100002];\nbool t[100002],ng[100002];\nint main(){\n\tr(i,100002)d[i]=1e8;\n\tcin>>n>>k;\n\tr(i,n){\n\t\tscanf(\"%d\",&x);\n\t\tif(x){\n\t\t\tv[i].push_back(x-1);\n\t\t\tb[i]=1;\n\t\t\tt[x-1]=1;\n\t\t}\n\t}\n\tqueue<P>q;\n\tr(i,n){\n\t\tif(!t[i]){\n\t\t\tq.push(P(i,0));\n\t\t\tc[i]=1;\n\t\t}\n\t}\n\twhile(!q.empty()){\n\t\tP p=q.front();q.pop();\n\t\tx=p.fi;\n\t\tint dis=p.se;\n\t\tif(dis>=k-1)continue;\n\t\tr(i,v[x].size()){\n\t\t\tif(!c[v[x][i]]){\n\t\t\t\tc[v[x][i]]=1;\n\t\t\t\tq.push(P(v[x][i],dis+1));\n\t\t\t}\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(c[i]||!b[i]){\n\t\t\tans++;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i, n) for(int i = 0; i < (n); i++)\n#define MEM(a, x) memset(a, x, sizeof(a))\n#define ALL(a) a.begin(), a.end()\n#define UNIQUE(a) a.erase(unique(ALL(a)), a.end())\ntypedef long long ll;\n\nint n, k, d[100005], INF = 1e9;\nvector<int> g[100005];\nbool a[100005], b[100005], c[100005];\n\nvoid dfs(int x, int cnt) {\n\tc[x] = true;\n\td[x] = min(d[x], cnt);\n\tif (cnt+1 < k) {\n\t\tFOR(i, g[x].size()) {\n\t\t\tif (d[g[x][i]] > cnt+1) dfs(g[x][i], cnt+1);\n\t\t}\n\t}\n\treturn;\n}\n\nint main(int argc, char const *argv[]) {\n\tios_base::sync_with_stdio(false);\n\tcin >> n >> k;\n\tFOR(i, n) {\n\t\tint x;\n\t\tcin >> x;\n\t\tif (x == 0) a[i] = true;\n\t\telse {\n\t\t\tb[x-1] = true;\n\t\t\tg[i].push_back(x-1);\n\t\t}\n\t}\n\tfill(d, d+n, INF);\n\tFOR(i, n) {\n\t\tif (!b[i] && !a[i]) dfs(i, 0);\n\t}\n\tint ret = 0;\n\tFOR(i, n) {\n\t\tif (a[i] || c[i]) ret++;\n\t}\n\tcout << ret << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nconst double EPS = 1e-10;\nconst ll INF = 100000000;\nconst ll MOD = 1000000007;\n\nint n, k;\nint a[100000];\nvector<int> b[100000];\nbool saw[100000];\nint ans = 0;\nint dist[100000];\n\nvoid dfs(int v) {\n    if(saw[v]) return;\n    if(b[v].size() == 0) {\n        dist[v] = 0;\n        return;\n    }\n    dist[v] = MOD;\n    rep(i,b[v].size()) {\n        dfs(b[v][i]);\n    }\n    rep(i,b[v].size()) {\n        dist[v] = min(dist[v], dist[b[v][i]]+1);\n    }\n}\n\nint main(){\n    cin >> n >> k;\n    rep(i,n) {\n        cin >> a[i];\n        a[i]--;\n        if(a[i] == -1) continue;\n        b[a[i]].push_back(i);\n    }\n    rep(i,n) {\n        if(a[i] == -1) {\n            dfs(i);\n        }\n    }\n    rep(i,n) {\n        if(dist[i] < k || a[i] == -1) ans++;\n    }\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nconst double EPS = 1e-10;\nconst ll INF = 100000000;\nconst ll MOD = 1000000007;\n\nint n, k;\nint a[100000];\nvector<int> b[100000];\nbool saw[100000];\nint ans = 0;\n\nvoid dfs(int dep, int v) {\n    if(dep > k) return;\n    if(saw[v]) return;\n    saw[v] = true;\n    dfs(dep+1, a[v]);\n}\n\nint main(){\n    cin >> n >> k;\n    rep(i,n) {\n        cin >> a[i];\n        if(a[i] == 0) continue;\n        a[i]--;\n        b[a[i]].push_back(i);\n    }\n    rep(i,n) {\n        if(a[i] == 0 && saw[i] == false) {\n            saw[i] = true;\n            continue;\n        }\n        if(b[i].size() == 0) {\n            dfs(1, i);\n        }\n    }\n    rep(i,n) {\n        if(saw[i]) ans++;\n    }\n    cout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint n,k,x;\nvector<int>v[100002];\nint d[100002],ans;\nbool b[100002],c[100002];\nbool t[100002],ng[100002];\nvoid dfs2(int p){\n\tif(ng[p])return;\n\tng[p]=1;\n\tr(i,v[p].size()){\n\t\tdfs2(v[p][i]);\n\t}\n}\nvoid dfs(int p,int de){\n\tc[p]=1;\n\tr(i,v[p].size()){\n\t\tif(de<k){\n\t\t\tdfs(v[p][i],de+1);\n\t\t}\n\t\telse{\n\t\t\tdfs2(v[p][i]);\n\t\t}\n\t}\n}\nint main(){\n\tr(i,100002)d[i]=1e8;\n\tcin>>n>>k;\n\tr(i,n){\n\t\tscanf(\"%d\",&x);\n\t\tif(x){\n\t\t\tv[i].push_back(x-1);\n\t\t\tb[i]=1;\n\t\t\tt[x-1]=1;\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(!t[i]){\n\t\t\tdfs(i,0);\n\t\t}\n\t}\n\t//r(i,n)cout<<i<<' '<<ng[i]<<endl;\n\tr(i,n)if(c[i]&&!ng[i])ans++;\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pairInt;\n#define FOR(i, n) for (int i = 0; i < int(n); i++)\n#define FOR1(i, m, n) for (int i = int(m); i < int(n); i++)\n#define MAX(a, b) ((a) >= (b) ? (a) : (b))\n#define MIN(a, b) ((a) <= (b) ? (a) : (b))\n\nint main(int argc, char *argv[]) {\n  int N, K;\n\n  scanf(\"%d%d\", &N, &K);\n\n  set<int> not_replyed;\n  set<int> not_replying;\n  map<int, int> replying;\n\n  FOR1(i, 1, N + 1) { not_replyed.insert(i); }\n\n  FOR1(i, 1, N + 1) {\n    int a;\n    scanf(\"%d\", &a);\n    if (a != 0) {\n      replying.insert(make_pair(i, a));\n      not_replyed.erase(a);\n    } else {\n      not_replying.insert(i);\n    }\n  }\n\n  set<int> displayed(not_replyed);\n  set<int> temp(not_replyed);\n  FOR(i, K - 1) {\n    set<int> temp2;\n    for (auto x : temp) {\n      auto it = replying.find(x);\n      if (it != replying.end() &&\n          displayed.find(it->second) == displayed.end()) {\n        temp2.insert(it->second);\n        displayed.insert(it->second);\n      }\n    }\n    temp = move(temp2);\n  }\n  displayed.insert(not_replying.begin(), not_replying.end());\n\n  printf(\"%lu\\n\", displayed.size());\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\n#define fi first\n#define se second\nint n,k,x;\nvector<int>v[100002];\nint d[100002],ans;\nbool b[100002],c[100002];\nbool t[100002];\nint main(){\n\tr(i,100002)d[i]=1e8;\n\tcin>>n>>k;\n\tr(i,n){\n\t\tscanf(\"%d\",&x);\n\t\tif(x){\n\t\t\tv[i].push_back(x-1);\n\t\t\tb[i]=1;\n\t\t\tt[x-1]=1;\n\t\t}\n\t}\n\tqueue<P>q;\n\tr(i,n){\n\t\tif(!t[i]){\n\t\t\tq.push(P(i,0));\n\t\t\tc[i]=1;\n\t\t}\n\t}\n\twhile(!q.empty()){\n\t\tP p=q.front();q.pop();\n\t\tx=p.fi;\n\t\tint dis=p.se;\n\t\tif(dis>=k-1)continue;\n\t\tr(i,v[x].size()){\n\t\t\tif(!c[v[x][i]]){\n\t\t\t\tc[v[x][i]]=1;\n\t\t\t\tq.push(P(v[x][i],dis+1));\n\t\t\t}\n\t\t}\n\t}\n\tr(i,n){\n\t\tif(c[i]||!b[i]){\n\t\t\tans++;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[100000];\nbool ans[100000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A - 1 >= 0) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAX_N = 100001;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int N, K;\n  int A[MAX_N];\n  bool leaf[MAX_N];\n  int dist[MAX_N];\n  fill_n(leaf, MAX_N, true);\n  fill_n(dist, MAX_N, 1e8);\n\n  cin >> N >> K;\n  for ( int i = 0; i < N; i++ ) {\n    cin >> A[i];\n    if ( A[i] != 0 ) leaf[A[i]-1] = false;\n  }\n\n  queue< pair<int, int> > q;\n  for ( int i = 0; i < N; i++ ) {\n    if ( leaf[i] ) q.push(pair<int, int>(i, 0));\n  }\n\n  while ( !q.empty() ) {\n    pair<int, int> p = q.front(); q.pop();\n    int n = p.first, cost = p.second;\n    //cout << n << \" \" << cost << endl;\n    if ( dist[n] <= cost ) continue;\n    dist[n] = cost;\n    q.push(pair<int, int>(A[n]-1, cost+1));\n  }\n\n  int ans = 0;\n  for ( int i = 0; i < N; i++ ) {\n    if ( dist[i] < K || A[i] == 0 ) {\n      ans++;\n      //cout << i << endl;\n    }\n  }\n\n  cout << ans << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nconst int INF = 1 << 30;\n\nsigned main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  int n,k; cin >> n >> k;\n  vector<int> a(n),G[n];\n  int ans = 0;\n  for(int i = 0; i < n; i++){\n    cin >> a[i];\n    a[i]--;\n    if(a[i] == -1) continue;\n    G[a[i]].push_back(i);\n  }\n\n  vector<int> d(n,INF);\n  function< int(int,int) > rec =\n  [&](int u,int par){\n    if(G[u].empty()) d[u] = 1;\n    else {\n      for(auto v : G[u]){\n        d[u] = min(d[u],rec(v,0) + 1);\n      }\n    }\n    if(par == -1 || d[u] <= k) ans++;\n    return d[u];\n  };\n\n  for(int i = 0; i < n; i++){\n    if(d[i] == INF){\n      if(G[i].empty()) ans++;\n      else rec(i,-1);\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define N 100010\n#define INF (1e9)\nusing namespace std;\n\nint n,K;\nint par[N];\nvector<int> G[N];\n\nint bfs(){\n  queue<int> Q;\n  vector<int> D(N,INF);\n  \n  for(int i=1;i<=n;i++) if(par[i] == 0) Q.push(i),D[i] = 1;\n  \n  int res = 0;\n  while(!Q.empty()){\n    int pos = Q.front();Q.pop();\n    int cost = D[pos];\n    int to = G[pos].empty()? -1:G[pos][0];\n    res += to == 0 || cost <= K;\n    if(to >0 && D[to] == INF) Q.push(to),D[to] = cost+1;\n  }\n  return res;\n}\n\n\nint main(){\n  cin>>n>>K;\n\n  for(int i=1;i<=n;i++){\n    int a;\n    cin>>a;\n    G[i].push_back(a);\n    par[a] = 1; \n  }\n  cout<<bfs()<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<iomanip>\n#include<math.h>\n#include<complex>\n#include<queue>\n#include<deque>\n#include<stack>\n#include<map>\n#include<set>\n#include<bitset>\n#include<functional>\n#include<assert.h>\n#include<numeric>\nusing namespace std;\n#define REP(i,m,n) for(int i=(int)(m) ; i < (int) (n) ; ++i )\n#define rep(i,n) REP(i,0,n)\nusing ll = long long;\nconst int inf=1e9+7;\nconst ll longinf=1LL<<60 ;\nconst ll mod=1e9+7 ;\n\nint main(){\n\tint n,k;\n\tcin>>n>>k;\n\tvector<int> nxt(n);\n\trep(i,n){\n\t\tcin>>nxt[i];\n\t\t--nxt[i];\n\t}\n\tvector<int> dp(n,inf);\n\tfor(int i=n-1;i>=0;--i){\n\t\tif(dp[i]==inf)dp[i]=0;\n\t\tif(~nxt[i])dp[nxt[i]]=min(dp[nxt[i]],dp[i]+1);\n\t\telse dp[i]=0;\n\t}\n\tint ans=0;\n\trep(i,n){\n\t\tif(dp[i]<k)++ans;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500010],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\telse if(a[i]>0){\n\t\t\tnum=a[i];\n\t\t\ta[i]=-1;\n\t\t\twhile(1){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[val-1];\n\t\t\t\tif(num <= 0)\tbreak;\n\t\t\t\ta[val-1]=-1;\n\t\t\t\tk++;\n\t\t\t}\n\t\t\tif(k>K)\tk=K-1;\n\t\t\tcount = count + k;\n\t\t\tk=0;\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*  -*- coding: utf-8 -*-\n *\n * 2833.cc: Displayed tweets\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 100000;\nconst int INF = 1 << 30;\n\n/* typedef */\n\ntypedef pair<int,int> pii;\n\n/* global variables */\n\nint rts[MAX_N], rns[MAX_N], ds[MAX_N];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  int n, k;\n  scanf(\"%d%d\", &n, &k);\n\n  for (int i = 0; i < n; i++) {\n    int ai;\n    scanf(\"%d\", &ai);\n    ai--;\n\n    rts[i] = ai;\n    if (ai >= 0) rns[ai]++;\n    ds[i] = INF;\n  }\n\n  queue<pii> q;\n  for (int i = 0; i < n; i++)\n    if (rns[i] == 0) {\n      ds[i] = 0;\n      q.push(pii(i, -1));\n    }\n\n  int cnt = 0;\n  while (! q.empty()) {\n    pii u = q.front(); q.pop();\n    int &ui = u.first, &up = u.second;\n    int &vi = rts[ui];\n\n    if (ds[ui] < k || vi < 0) cnt++;\n\n    if (vi >= 0) {\n      int vd = ds[ui] + 1;\n      if (ds[vi] > vd) ds[vi] = vd;\n      if (--rns[vi] == 0) q.push(pii(vi, ui));\n    }\n  }\n\n  printf(\"%d\\n\", cnt);\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#define REP(i,N) for(int i=0;i<(N);++i)\nusing namespace std;\nclass tree{\npublic:\n  bool parent;\n  vector<int> child;\n};\nvector<tree> t;\nint N,K;\nint ans;\nint func(int place){\n  if(t[place].child.empty()){\n    ++ans;\n    return 1;\n  }\n  if(t[place].parent){\n    ++ans;\n    REP(i,t[place].child.size()){\n      func(t[place].child[i]);\n    }\n    return 0;\n  }\n  int dep = 1000000;\n  REP(i,t[place].child.size()){\n    dep = min(dep,func(t[place].child[i]));\n  }\n  if(dep < K)++ans;\n  return dep + 1;\n}\nint main(){\n  cin >> N >> K;\n  t.resize(N+1);\n  REP(i,N){\n    int j = i + 1;\n    int d;\n    cin >> d;\n    t[j].parent = d == 0;\n    t[d].child.push_back(j);\n  }\n  REP(i,N){\n    int j = i + 1;\n    if(t[j].parent){\n      func(j);\n    }\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\n#define INF (1LL << 60)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A;\nvector<ll> R, E[200000];\nbool ans[200000];\n\nll dfs(ll v) {\n  ll depth = INF;\n  if(E[v].size() == 0) depth = 0;\n  // else for(ll u : E[v]) depth = min(depth, dfs(u) + 1);\n  if(depth < K) ans[v] = true;\n  // cout << \"  \" << v << \": \" << depth << endl;\n  return depth;\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) {\n    cin >> A;\n    if(A >= 1) E[A - 1].push_back(i);\n    else R.push_back(i);\n  }\n\n  // REP(i, 0, R.size()) cout << R[i] << \" \";\n  // cout << endl;\n  // REP(i, 0, N) {\n  //   cout << i << \": \";\n  //   REP(j, 0, E[i].size()) cout << E[i][j] << \" \";\n  //   cout << endl;\n  // }\n\n  REP(i, 0, N) ans[i] = false;\n\n  REP(i, 0, R.size()) ans[R[i]] = true;\n  REP(i, 0, R.size()) dfs(R[i]);\n\n  // REP(i, 0, N) cout << i << \" \" << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main() {\n\n\tint N,K;\n\n\tscanf(\"%d %d\",&N,&K);\n\n\tint* table = new int[N];\n\tbool* henshin_sareru = new bool[N];\n\tbool* rule_3_apply = new bool[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d\",&table[i]);\n\t\thenshin_sareru[i] = false;\n\t\trule_3_apply[i] = false;\n\t}\n\n\tfor(int i = N-1; i >= 0; i--){\n\t\tif(table[i] > 0){\n\n\t\t\thenshin_sareru[table[i]-1] = true;\n\n\t\t\tif(henshin_sareru[i] == false){\n\n\t\t\t\tint count = 0,loc = table[i]-1;\n\n\t\t\t\twhile(count < K-1){\n\n\t\t\t\t\trule_3_apply[loc] = true;\n\n\t\t\t\t\tif(table[loc] == 0)break;\n\n\t\t\t\t\tloc = table[loc]-1;\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(table[i] == 0 || henshin_sareru[i] == false || rule_3_apply[i] == true)ans++;\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, a, n) for(ll i = ((ll) a); i < ((ll) n); i++)\nusing namespace std;\ntypedef long long ll;\n\nll N, K, A[100000];\nbool ans[100000];\n\nvoid dfs(ll i, ll depth) {\n  if(depth >= K) return;\n  ans[i] = true;\n  if(A[i] >= 0) dfs(A[i], depth + 1);\n}\n\nint main(void) {\n  cin >> N >> K;\n  REP(i, 0, N) cin >> A[i], A[i]--;\n\n  REP(i, 0, N) ans[i] = true;\n  REP(i, 0, N) if(A[i] >= 0) ans[A[i]] = false;\n  REP(i, 0, N) ans[i] = ans[i] || A[i] == -1;\n\n  vector<ll> vec;\n  REP(i, 0, N) if(ans[i] >= 0) vec.push_back(i);\n  REP(i, 0, vec.size()) if(ans[vec[i]] && A[vec[i]] >= 0) dfs(vec[i], 0);\n\n  // REP(i, 0, N) cout << ans[i] << endl;\n\n  ll cnt = 0;\n  REP(i, 0, N) if(ans[i]) cnt++;\n  cout << cnt << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <queue>\n#include <vector>\n#define loop(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) loop(i, 0, n)\n#define all(v) (v).begin(), (v).end()\ntemplate<typename A, typename B> bool cmax(A &a, const B &b) { return a < b ? (a = b, true) : false; }\nusing namespace std;\n\nint main() {\n  int n, k;\n  cin >> n >> k;\n  vector<int> tree(n), in(n), out(n);\n  rep(i, n) {\n    int a;\n    cin >> a;\n    tree[i] = a - 1;\n    if (a > 0) in[a - 1]++, out[i]++;\n  }\n  vector<int> dp(n);\n  rep(i, n) if (in[i] == 0) dp[i] = k;\n  for (int i = n - 1; i >= 0; i--) {\n    if (tree[i] > 0) cmax(dp[tree[i]], dp[i] - 1);\n  }\n  rep(i, n) if (out[i] == 0) dp[i] = 1;\n  cout << count_if(all(dp), [](int x) { return x > 0; }) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500010],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\telse if(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num <= 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N,K;\n\nbool ans[100005];\nvector<int> G[100005];\nint depth[100005];\nint parent[100005];\n\nvoid dfs(int pos,int d=0){\n  depth[pos]=d;\n  for(int i=0;i<(int)G[pos].size();i++){\n    int to=G[pos][i];\n    dfs(to,d+1);\n  }\n}\n\nint main(){\n  \n  cin>>N>>K;\n  for(int i=1;i<=N;i++){\n    int x;\n    cin>>x;\n    if(x==0)ans[i]=1;\n    else{\n      G[x].push_back(i);\n      parent[i]=x;\n    }\n  }\n  \n  for(int i=1;i<=N;i++){\n    if(ans[i])dfs(i);\n  }\n  \n  typedef pair<int,int> P;\n  vector<P> vec;\n  for(int i=1;i<=N;i++){\n    if(G[i].empty())\n      vec.push_back( P(depth[i],i) );\n  }\n  sort(vec.begin(),vec.end());\n  for(int i=0;i<(int)vec.size();i++){\n    int p=vec[i].second;\n    for(int j=0;j<K;j++){\n      if(ans[p])break;\n      ans[p]=1;\n      p=parent[p];\n    }\n  }\n\n  int count=0;\n  for(int i=1;i<=N;i++){\n    count+=ans[i];\n  }\n  \n  cout<<count<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1<<28;\n\nint main() {\n    int n, k;\n    cin >> n >> k;\n    vector<int> a(n);\n    for (auto& i : a) cin >> i;\n\n    vector<int> depth(n, INF);\n\n    int count = 0;\n    for (int i = n-1; i >= 0; i--) {\n        if (depth[i] == INF) {\n            count++;\n            depth[i] = 0;\n        } else if (depth[i] < k) {\n            count++;\n        } else if (a[i] == 0) {\n            count++;\n        }\n\n        if (a[i] > 0) {\n            depth[a[i]-1] = min(depth[a[i]-1], depth[i] + 1);\n        }\n    }\n\n    cout << count << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\nint main() {\n\n\tint N,K;\n\n\tscanf(\"%d %d\",&N,&K);\n\n\tint* table = new int[N];\n\tbool* henshin_sareru = new bool[N];\n\tbool* rule_3_apply = new bool[N];\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%d\",&table[i]);\n\t\thenshin_sareru[i] = false;\n\t\trule_3_apply[i] = false;\n\t}\n\n\tint* min_count = new int[N];\n\n\tfor(int i = 0; i < N; i++)min_count[i] = BIG_NUM;\n\n\tfor(int i = N-1; i >= 0; i--){\n\t\tif(table[i] > 0){\n\n\t\t\thenshin_sareru[table[i]-1] = true;\n\n\t\t\tif(henshin_sareru[i] == false){\n\n\t\t\t\tint count = 0,loc = table[i]-1;\n\n\t\t\t\twhile(count < K-1){\n\n\t\t\t\t\tif(min_count[loc] <= count)break;\n\n\t\t\t\t\tmin_count[loc] = count;\n\n\t\t\t\t\trule_3_apply[loc] = true;\n\t\t\t\t\thenshin_sareru[loc] = true;\n\n\t\t\t\t\tif(table[loc] == 0)break;\n\n\t\t\t\t\tloc = table[loc]-1;\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(table[i] == 0 || henshin_sareru[i] == false || rule_3_apply[i] == true)ans++;\n\t}\n\n\tprintf(\"%d\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cmath>\n#include <cstdlib>\n#include <iomanip>\n#include <iostream>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\nint main() {\n  int n, a;\n  cin >> n >> a;\n  int t[n];\n  int ans = 0;\n  for (int i = 0; i < n; i++) {\n    cin >> t[i];\n  }\n  for (int i = 0; i < n; i++) {\n    if (t[i] != 0) {\n      if (t[t[i] - 1] == 0) {\n      } else {\n        ans += 1;\n      }\n    } else {\n      ans += 1;\n    }\n  }\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<queue>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n#include<climits>\n#include<sstream>\n#include<deque>\n#include<vector>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<bitset>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst int IINF = INT_MAX;\nconst ll LLINF = LLONG_MAX;\n\n#define MAX 101000\nint V,K;\nvector<int> G[MAX];\nvector<int> out_deg,depth,in_deg;\n\nvoid dfs(int cur,int pre,int d) {\n  assert( depth[cur] == 0 );\n  depth[cur] = d;\n  rep(i,(int)G[cur].size()) {\n    int nex = G[cur][i];\n    if( pre == nex ) continue;\n    dfs(nex,cur,d+1);\n  }\n}\n\ntypedef pair<int,int> ii;\nint main(){\n  if( 0 ) {\n    V = 100000;\n    K = 100000;\n    cout << V << \" \" << K << endl;\n    rep(i,V) {\n      cout << i << endl;\n    }\n    return 0;\n  }\n  cin >> V >> K;\n  out_deg = vector<int>(V+1,0);\n  in_deg = vector<int>(V+1,0);\n  depth = vector<int>(V+1,0);\n  rep(i,V) {\n    int a;\n    cin >> a;\n    if( a == 0 ) continue;\n    G[i+1].push_back(a);\n    ++out_deg[i+1];\n    ++in_deg[a];\n  }\n  rep(i,V+1) depth[i] = INT_MAX;\n  deque<ii> deq;\n  REP(i,1,V+1) {\n    if( in_deg[i] == 0 )  {\n      deq.push_back(ii(i,0));\n      depth[i] = 0;\n    }\n  }\n\n  while( !deq.empty() ) {\n    ii v = deq.front(); deq.pop_front();\n    int cur = v.first;\n    int d   = v.second;\n    rep(i,(int)G[cur].size()) {\n      int nex = G[cur][i];\n      if( depth[nex] > d + 1 ) {\n\tdepth[nex] = d + 1;\n\tdeq.push_back(ii(nex,d+1));\n      }\n    }\n  }\n  \n  int cnt = 0;\n  REP(i,1,V+1) {\n    //cout << i << \"-th : \" << depth[i] << \" in = \" << in_deg[i] << \", out = \" << out_deg[i];\n    if( depth[i] < K || in_deg[i] == 0 || out_deg[i] == 0 ) {\n      ++cnt;\n      //cout << \" +1\";\n    }\n    //cout << endl;\n  }\n  cout << cnt << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<queue>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n#include<climits>\n#include<sstream>\n#include<deque>\n#include<vector>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<bitset>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst int IINF = INT_MAX;\nconst ll LLINF = LLONG_MAX;\n\n#define MAX 101000\nint V,K;\nvector<int> G[MAX];\nvector<int> out_deg,depth,in_deg;\n\nvoid dfs(int cur,int pre,int d) {\n  assert( depth[cur] == 0 );\n  depth[cur] = d;\n  rep(i,(int)G[cur].size()) {\n    int nex = G[cur][i];\n    if( pre == nex ) continue;\n    dfs(nex,cur,d+1);\n  }\n}\n\ntypedef pair<int,int> ii;\nint main(){\n  if( 0 ) {\n    V = 100000;\n    K = 100000;\n    cout << V << \" \" << K << endl;\n    rep(i,V) {\n      cout << i << endl;\n    }\n    return 0;\n  }\n  cin >> V >> K;\n  out_deg = vector<int>(V+1,0);\n  in_deg = vector<int>(V+1,0);\n  depth = vector<int>(V+1,0);\n  rep(i,V) {\n    int a;\n    cin >> a;\n    if( a == 0 ) continue;\n    G[i+1].push_back(a);\n    ++out_deg[i+1];\n    ++in_deg[a];\n  }\n  rep(i,V+1) depth[i] = INT_MAX;\n  deque<ii> deq;\n  REP(i,1,V+1) {\n    if( in_deg[i] == 0 )  {\n      deq.push_back(ii(i,0));\n      depth[i] = 0;\n    }\n  }\n\n  while( !deq.empty() ) {\n    ii v = deq.front(); deq.pop_front();\n    int cur = v.first;\n    int d   = v.second;\n    rep(i,(int)G[cur].size()) {\n      int nex = G[cur][i];\n      if( depth[nex] > d + 1 ) {\n\tdepth[nex] = d + 1;\n\tdeq.push_back(ii(nex,d+1));\n      }\n    }\n  }\n  \n  int cnt = 0;\n  REP(i,1,V+1) {\n    //cout << i << \"-th : \" << depth[i] << \" in = \" << in_deg[i] << \", out = \" << out_deg[i];\n    if( depth[i] < K || in_deg[i] == 0 || out_deg[i] == 0 ) {\n      ++cnt;\n      //cout << \" +1\";\n    }\n    //cout << endl;\n  }\n  cout << cnt << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n#include<queue>\n\nusing namespace std;\n\n#define int long long\n#define rep(i,n) for(int i = 0; i < (n); i++)\n#define INF ((long long)1e18)\n#define MOD ((int)1e9+7)\n#define endl \"\\n\"\n\n#define yn(f) ((f)?\"Yes\":\"No\")\n#define YN(f) ((f)?\"YES\":\"NO\")\n\n#define MAX\n\nsigned main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout<<fixed<<setprecision(10);\n\t\n\tint N, K, ans = 0;\n\tvector<int> A, used, con;\n\tqueue<pair<int,int>> Q;\n\t\n\tcin>>N>>K;\n\t\n\tA.resize(N+1);\n\tused.resize(N+1);\n\tcon.resize(N+1);\n\t\n\tfor(int i = 1; i <= N; i++){\n\t\tcin>>A[i];\n\t\t\n\t\tcon[A[i]]++;\n\t\t\n\t\tif(!A[i]){\n\t\t\tused[i] = true;\n\t\t\tans++;\n\t\t}\n\t}\n\t\n\tfor(int i = 1; i <= N; i++){\n\t\tif(!con[i]){\n\t\t\tQ.push(make_pair(i,K));\n\t\t\t// cout<<i<<\" Q \"<<endl;\n\t\t}\n\t}\n\t// cout<<\"ans -> \"<<ans<<endl;\n\t\n\twhile(!Q.empty()){\n\t\tpair<int,int> t = Q.front(); Q.pop();\n\t\t\n\t\tif(used[t.first] || t.second == 0) continue;\n\t\t\n\t\tused[t.first] = true;\n\t\t\n\t\t// cout<<t.first<<endl;\n\t\t\n\t\tans++;\n\t\tQ.push(make_pair(A[t.first],t.second-1));\n\t}\n\t\n\tcout<<ans<<endl;\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n\tint N,K,a[500000],count=0,k=0,num,val;\n\tcin >> N >> K;\n\tfor(int i=0;i<N;i++){\n\t\tcin >> a[i];\n\t}\n\tfor(int i=N-1;i>=0;i--){\n\t\tif(a[i]==0){\n\t\t\tcount++;\n\t\t\ta[i] = -1;\n\t\t}\n\t\tif(a[i]>0){\n\t\t\tk=0;\n\t\t\tnum = a[i];\n\t\t\ta[i] = -1;\n\t\t\twhile(k<=K){\n\t\t\t\tval = num;\n\t\t\t\tnum = a[num-1];\n\t\t\t\ta[val-1] = -1;\n\t\t\t\tk++;\n\t\t\t\tcount++;\n\t\t\t\tif(num == 0)\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout << count << \"\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\nchar f[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tmemset(k, 0x33, sizeof(int)*(N+1));\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re) ans++;\n\t\telse {\n\t\t\tif (!f[i]) v = 0, ans++;\n\t\t\telse if ((v = k[i]) < K) ans++;\n\t\t\tv++;\n\t\t\tif (v < K && k[re] > v) k[re] = v;\n\t\t\tf[re] = 1;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨(????????§???head??§?????????)\n    int tail[101010] = {0};//??????????°???¨\n    int jump[101010] = {0};//?????£????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        \n        \n        //????????????1\n        tail[i] = 1;//?????°??????????????????tail=1???????????????\n        if(A[i] == 0){ \n            disp[i] = 1;//????????????disp=1\n            //ans++;\n        }\n        else tail[A[i]] = 0;//????????????tail??§?????????\n        \n        \n    }\n    \n    //printf(\"??\\????????????ans = %d\\n\",ans);\n    \n    //printf(\"??\\????????????\\n\");\n    //for(i = 1;i <= N;i++) printf(\"tail[%d] = %d, disp[%d] = %d\\n\",i,tail[i],i,disp[i]);\n    \n    \n    /*\n    //????????¨?????????\n    printf(\"\\nOR?????????\\n\");\n    for(i = 1;i <= N;i++){\n        disp[i] = disp[i] || tail[i];\n        printf(\"disp[%d] = %d\\n\",i,disp[i]);\n    }\n    */\n    \n    //????????????2\n    for(i = N;i > 0;i--){\n        if(tail[i] == 0) continue;\n        if(disp[i] == 0){\n            disp[i] = 1;\n            //ans++;\n        }\n        \n        for(now_k = 1;now_k < K;now_k++){\n            //now_k++;\n            //if(now_k >= K) break;\n            //printf(\"now_k = %d\\n\",now_k);\n            now_i = A[i];\n            if(disp[now_i] == 0){\n                disp[now_i] = 1;\n               //ans++;\n            }\n            A[i] = A[now_i];//A[i]??????????????????????????§???????????????//?¬?????????£??????\n        }\n        \n    }\n    \n    //printf(\"\\nfor?????????\\n\");\n    //for(i = 1;i <= N;i++) printf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n\t\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10001] = {0};//????????¨\n    int disp[10001] = {0};//??¨?????¨\n    int head[10001] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                now_i_mem = A[now_i];\n                now_i = now_i_mem;\n                head[now_i] = 0;\n                now_k++;\n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i] = 1;\n                }\n            }\n            now_k = 0;//now_k???????????????????????????\n        }\n    }\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10010] = {0};//????????¨\n    int disp[10010] = {0};//??¨?????¨\n    int head[10010] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                now_i_mem = A[now_i];\n                head[now_i_mem] = 0;\n                now_k++;\n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i_mem] = 1;\n                }\n                now_i = now_i_mem;\n            }\n            now_k = 0;//now_k???????????????????????????\n        }\n    }\n\t\n\t//for(i = 1;i <= N;i++){\n\t//\tprintf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t//}\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n// 2018.1.9\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\nchar f[100001];\n\n//#define getchar_unlocked()  getchar()\nint in()\n{\n\tint n = 0;\n\tint c = getchar_unlocked();\n\tdo n = (n<<3)+(n<<1) + (c & 0xf), c = getchar_unlocked();\n\twhile (c >= '0');\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tN = in(), K = in();\n\tmemset(k, 0x33, sizeof(int)*(N+1));\n\tfor (i = 1; i <= N; i++) a[i] = in();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (re) {\n\t\t\tif (!f[i]) v = 0, ans++;\n\t\t\telse if ((v = k[i]) < K) ans++;\n\t\t\tv++;\n\t\t\tif (v < K && k[re] > v) k[re] = v;\n\t\t\tf[re] = 1;\n\t\t} else ans++;\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re) ans++;\n\t\telse {\n\t\t\tif (k[i] >= 0) {\n\t\t\t\tans++;\n\t\t\t\tif ((v = k[i]+1) < K && (k[re] <= 0 || k[re] > v)) k[re] = v;\n\t\t\t\telse k[re] = -1;\n\t\t\t} else k[re] = -1;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n\nint a[100001], k[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re || k[i] < K) ans++;\n\t\tv = k[i] + 1;\n\t\tif (k[re] > v) k[re] = v;\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨\n    int head[101010] = {0};//??????????????¨\n    int jump[101010] = {0};//?????£????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        \n        \n        //????????????1\n        head[i] = 1;//?????°??????????????????head=1???????????????\n        if(A[i] == 0) disp[i] = 1;//????????????disp=1\n        else head[A[i]] = 0;//????????????head??§?????????\n    }\n    \n    \n    //????????????2\n    for(i = N;i > 0;i--){\n        if(head[i] == 0) continue;\n        now_i = A[i];\n        disp[i] = 1;//head=1????????°disp=1\n        now_k++;\n        while(now_k < K){//??????????????§??????\n            \t    now_i_mem = A[now_i];\n            \t    head[now_i_mem] = 0;\n                    disp[now_i_mem] = 1;\n                    now_i = now_i_mem;//?¬?????????£??????????????????????????°??´??°\n            \t    now_k++;\n        }\n        now_k = 0;//now_k???????????????????????????\n    }\t\n\t//for(i = 1;i <= N;i++) printf(\"head[%d] = %d\\n\",i,head[i]);\n    //for(i = 1;i <= N;i++) printf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n\t\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10001] = {0};//????????¨\n    int disp[10001] = {0};//??¨?????¨\n    int head[10001] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        \n        //printf(\"?????°??? i = %d\\n\",i);\n        //printf(\"head[%d] = %d\\n\",i,head[i]);\n        \n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            \n            //printf(\"?????????1\\n\");\n            \n            disp[i] = 1;\n            \n            //printf(\"disp[%d] = %d\\n\",i,disp[i]);\n            \n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            \n            //printf(\"?????????2\\n\");\n            \n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n                \n                //printf(\"disp[%d] = %d\\n\",now_i,disp[now_i]);\n                //printf(\"now_k = %d\\n\",now_k);\n                \n            }\n            while(now_i > 0){//??????????????§??????\n                \n                //printf(\"while\\n\");\n                \n                now_i_mem = A[now_i];\n                now_i = now_i_mem;\n                head[now_i] = 0;\n                now_k++;\n                \n                \n                 //printf(\"disp[%d] = %d\\n\",now_i,disp[now_i]);\n                 //printf(\"now_k = %d\\n\",now_k);\n                \n                \n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i] = 1;\n                }\n            }\n            now_k = 0;//now_k???????????????????????????\n            \n        }\n    }\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    \n    \n    //for(i = 1; i <= N;i++) printf(\"disp[%d] %d\\n\",i,disp[i]);\n    //printf(\"\\n\");\n    //for(i = 1; i <= N;i++) printf(\"head[%d] %d\\n\",i,head[i]);\n    \n    \n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re) ans++;\n\t\telse {\n\t\t\tif (!k[i]) v = 0, ans++;\n\t\t\telse {\n\t\t\t\tv = k[i];\n\t\t\t\tif (v > 0 && v < K) ans++;\n\t\t\t}\n\t\t\tif (++v < K && (k[re] <= 0 || k[re] > v)) k[re] = v;\n\t\t\telse k[re] = -1;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨\n    int head[101010] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        \n        \n        //?????????\n        head[i] = 1;//??¨??¨head???????????????\n        if(A[i] != 0) head[A[i]] = 0;//????????????head??§?????????\n        \n        \n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n    \t\n    \t\n    \t//if(disp[i] == 1){//?????????IF???\n    \t\n    \t\t\n        \tif(A[i] == 0){//?????????1_????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tcontinue;\n        \t}\n        \tif(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tnow_i = A[i];\n            \t//head[now_i] = 0;\n            \tnow_k++;\n            \tif(now_k < K){//?????§????????°???????????´???\n            \t    disp[now_i] = 1;\n            \t}\n            \twhile(now_i > 0){//??????????????§??????\n            \t    now_i_mem = A[now_i];\n            \t    //head[now_i_mem] = 0;\n            \t    now_k++;\n            \t    if(now_k < K){//?????§??°?????????????????´???\n            \t        disp[now_i_mem] = 1;\n            \t    }else break;//K??\\???????????£?????´???????????????\n            \t    now_i = now_i_mem;\n            \t}\n            \tnow_k = 0;//now_k???????????????????????????\n        \t}\n    \t\t\n    \t\t\n    \t//}//?????????if???\n    \t\n    \t\n    }\n\t\n\t//for(i = 1;i <= N;i++){\n\t//\tprintf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t//}\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n\t\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10000] = {0};//????????¨\n    int disp[10000] = {0};//??¨?????¨\n    int head[10000] = {1};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++) scanf(\"%d\",&A[i]);//???????????\\???\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] = 1){//?????????2_?????????????????????????????????????????´???\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                now_i_mem = A[now_i];\n                now_i = now_i_mem;\n                head[now_i] = 0;\n                now_k++;\n                if(now_k > K){//?????§??°?????????????????´???\n                    disp[now_i] = 1;\n                }\n            }\n        }\n    }\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n\nint a[100001], k[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re || k[i] < K) ans++;\n\t\tv = k[i] + 1;\n\t\tif (k[re] < v) k[re] = v;\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10001] = {0};//????????¨\n    int disp[10001] = {0};//??¨?????¨\n    int head[10001] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                \n                //printf(\"while\\n\");\n                \n                now_i_mem = A[now_i];\n                now_i = now_i_mem;\n                head[now_i] = 0;\n                now_k++;\n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i] = 1;\n                }\n            }\n            now_k = 0;//now_k???????????????????????????\n        }\n    }\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[10001] = {0};//????????¨\n    int disp[10001] = {0};//??¨?????¨\n    int head[10001] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                now_i_mem = A[now_i];\n                head[now_i_mem] = 0;\n                now_k++;\n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i_mem] = 1;\n                }\n                now_i = now_i_mem;\n            }\n            now_k = 0;//now_k???????????????????????????\n        }\n    }\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨\n    int head[101010] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        \n        \n        //?????????\n        head[i] = 1;//??¨??¨head???????????????\n        if(A[i] != 0) head[A[i]] = 0;//????????????head??§?????????\n        \n        \n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n    \t\n    \t\n    \t//if(disp[i] == 1){//?????????IF???\n    \t\n    \t\t\n        \tif(A[i] == 0){//?????????1_????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tcontinue;\n        \t}\n        \tif(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tnow_i = A[i];\n            \t//head[now_i] = 0;\n            \tnow_k++;\n            \tif(now_k < K){//?????§????????°???????????´???\n            \t    disp[now_i] = 1;\n            \t}\n            \twhile(now_i > 0){//??????????????§??????\n            \t    now_i_mem = A[now_i];\n            \t    //head[now_i_mem] = 0;\n            \t    now_k++;\n            \t    if(now_k < K){//?????§??°?????????????????´???\n            \t        disp[now_i_mem] = 1;\n            \t        break;\n            \t    }//else break;//K??\\???????????£?????´???????????????\n            \t    now_i = now_i_mem;\n            \t}\n            \tnow_k = 0;//now_k???????????????????????????\n        \t}\n    \t\t\n    \t\t\n    \t//}//?????????if???\n    \t\n    \t\n    }\n\t\n\t//for(i = 1;i <= N;i++){\n\t//\tprintf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t//}\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n\t\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#define minz(p,q)((p)&&(p<q)?(p):(q))\n\nint dp[100010];\nint a[100010];\n\nint main(){\n\tint n,k;\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",a+i);\n\tfor(int i=n;i>0;i--){\n\t\tif(dp[i]==0)dp[i]=1;\n\t\tdp[a[i]]=minz(dp[a[i]],dp[i]+1);\n\t}\n\tint ans=0;\n\tfor(int i=1;i<=n;i++)if(a[i]==0||dp[i]<=k)ans++;\n\tprintf(\"%d\\n\",ans);\n}\n\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨\n    int head[101010] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n    \t\n    \t\n    \t//if(disp[i] == 1){//?????????IF???\n    \t\n    \t\t\n        \tif(A[i] == 0){//?????????1_????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tcontinue;\n        \t}\n        \tif(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            \tdisp[i] = 1;\n            \tnow_i = A[i];\n            \thead[now_i] = 0;\n            \tnow_k++;\n            \tif(now_k < K){//?????§????????°???????????´???\n            \t    disp[now_i] = 1;\n            \t}\n            \twhile(now_i > 0){//??????????????§??????\n            \t    now_i_mem = A[now_i];\n            \t    head[now_i_mem] = 0;\n            \t    now_k++;\n            \t    if(now_k < K){//?????§??°?????????????????´???\n            \t        disp[now_i_mem] = 1;\n            \t    }else break;//K??\\???????????£?????´???????????????\n            \t    now_i = now_i_mem;\n            \t}\n            \tnow_k = 0;//now_k???????????????????????????\n        \t}\n    \t\t\n    \t\t\n    \t//}//?????????if???\n    \t\n    \t\n    }\n\t\n\t//for(i = 1;i <= N;i++){\n\t//\tprintf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t//}\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\nchar f[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tmemset(k, 0x33, sizeof(int)*(N+1));\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re) ans++;\n\t\telse {\n\t\t\tif (!f[i]) k[i] = 0, ans++;\n\t\t\telse if (k[i] < K) ans++;\n\t\t\tif (k[i] + 1 < K) k[re] = k[i] + 1;\n\t\t\tf[re] = 1;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(){\n    \n    int ans = 0;//????????¨\n    int A[101010] = {0};//????????¨\n    int disp[101010] = {0};//??¨?????¨\n    int head[101010] = {0};//??????????????¨\n    int N = 0;//??\\????????°??¨\n    int K = 0;//?????§????????°\n    int now_i = 0;//?????¨??°\n    int now_i_mem = 0;//??????????????¨\n    int now_k = 0;//?????¨?????????\n    int i = 0;//??????????????°\n    \n    scanf(\"%d %d\",&N,&K);//??\\?????°??¨?????§????????°\n    for(i = 1;i <= N;i++){\n        scanf(\"%d\",&A[i]);//???????????\\???\n        head[i] = 1;//head???1????????????\n    }\n    disp[N] = 1;//????????????????????????????????¶????????¨????????????\n    for(i = N;i > 0;i--){//??????????????°????????????\n        if(A[i] == 0){//?????????1_????????????????????????????????´???\n            disp[i] = 1;\n            continue;\n        }\n        if(head[i] == 1){//?????????2_?????????????????????????????????????????´???\n            disp[i] = 1;\n            now_i = A[i];\n            head[now_i] = 0;\n            now_k++;\n            if(now_k < K){//?????§????????°???????????´???\n                disp[now_i] = 1;\n            }\n            while(now_i > 0){//??????????????§??????\n                now_i_mem = A[now_i];\n                head[now_i_mem] = 0;\n                now_k++;\n                if(now_k < K){//?????§??°?????????????????´???\n                    disp[now_i_mem] = 1;\n                }\n                now_i = now_i_mem;\n            }\n            now_k = 0;//now_k???????????????????????????\n        }\n    }\n\t\n\t//for(i = 1;i <= N;i++){\n\t//\tprintf(\"disp[%d] = %d\\n\",i,disp[i]);\n\t//}\n\t\n    for(i = 1;i <= N;i++) ans += disp[i];\n    printf(\"%d\\n\",ans);\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 2833: Displayed tweets\n// 2017.11.25 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint a[100001], k[100001];\n\nchar buf[20], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint main()\n{\n\tint N, K, i, re, v, ans;\n\n\tfgets(p=buf, 20, stdin), N = getint(), p++, K = getint();\n\tfor (i = 1; i <= N; i++) fgets(p=buf, 10, stdin), a[i] = getint();\n\n\tans = 0;\n\tfor (i = N; i > 0; i--) {\n\t\tre = a[i];\n\t\tif (!re) ans++;\n\t\telse {\n\t\t\tk[re] = -1;\n\t\t\tif (k[i] >= 0) {\n\t\t\t\tans++;\n\t\t\t\tif ((v = k[i]+1) < K && (k[re] <= 0 || k[re] > v)) k[re] = v;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unchecked\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        for(int i = N-1;i >= 0;i--) {\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = -1;\n                    int next = i;\n                    while(G[next].size() > 0 && (pre == -1 || d[next] > d[pre] + 1)) {\n                        if (pre != -1){\n                            d[next] = Math.min(d[next],d[pre] + 1);\n                        }\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unused\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        for(int i = N-1;i >= 0;i--) {\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = i;\n                    int next = i;\n                    while(G[next].size() > 0) {\n                        d[next] = Math.min(d[next],d[pre] + 1);\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unchecked\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        boolean[] used = new boolean[N];\n        for(int i = N-1;i >= 0;i--) {\n            if (used[i])continue;\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = -1;\n                    int next = i;\n                    while(!used[next] && G[next].size() > 0 && (pre == -1 || d[next] > d[pre])) {\n                        used[next] = true;\n                        if (pre != -1){\n                            d[next] = Math.min(d[next],d[pre] + 1);\n                        }\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unused\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        for(int i = N-1;i >= 0;i--) {\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = i;\n                    int next = i;\n                    while(G[next].size() > 0) {\n                        d[next] = Math.min(d[next],d[pre] + 1);\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unchecked\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        for(int i = N-1;i >= 0;i--) {\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = i;\n                    int next = i;\n                    while(G[next].size() > 0) {\n                        d[next] = Math.min(d[next],d[pre] + 1);\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner s = new Scanner(System.in);\n\t\tint n = s.nextInt();\n\t\tint k = s.nextInt();\n\t\tboolean [] not_replay = new boolean[n];\n\t\tboolean [] is_replayed = new boolean[n];\n\t\tboolean [] visible = new boolean[n];\n\t\tint [] parent = new int[n];\n\t\tint [] height = new int[n];\n\t\tfor (int i=0;i<n;i++) {\n\t\t\tint a = s.nextInt();\n\t\t\tif (a == 0) {\n\t\t\t\tnot_replay[i] = true;\n\t\t\t\tparent[i] = -1;\n\t\t\t} else {\n\t\t\t\tis_replayed[a - 1] = true;\n\t\t\t\tparent[i] = a - 1;\n\t\t\t}\n\t\t}\n\t\tDeque<Integer> que = new ArrayDeque<Integer>();\n\t\tboolean[] checked = new boolean[n];\n\t\tfor (int i=0;i<n;i++) {\n\t\t\tcheck(i, not_replay, is_replayed, visible, que, height, checked);\n\t\t}\n\t\twhile (!que.isEmpty()) {\n\t\t\tint x = que.poll();\n\t\t\tif (height[x] < k) {\n\t\t\t\tvisible[x] = true;\n\t\t\t\tint p = parent[x];\n\t\t\t\tif (p != -1 && !checked[p]) {\n\t\t\t\t\theight[p] = height[x] + 1;\n\t\t\t\t\tchecked[p] = true;\n\t\t\t\t\tque.add(p);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i=0;i<n;i++) {\n\t\t\tif (visible[i]) ans++;\n\t\t}\n\t\tSystem.out.println(ans);\n\t}\n\tstatic void check (int x, boolean[] not_replay, boolean[] is_replayed, boolean[] visible, Deque<Integer> que, int[] height, boolean[] checked) {\n\t\tif (not_replay[x]) {\n\t\t\tvisible[x] = true;\n\t\t}\n\t\tif (!is_replayed[x]) {\n\t\t\theight[x] = 0;\n\t\t\tchecked[x] = true;\n\t\t\tque.push(x);\n\t\t}\n\t}\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n    static final int INF = (int)1e9+7;\n    int N,K;\n    int[] A;\n    ArrayList<Integer>[] G,revG;\n\n\n    @SuppressWarnings(\"unchecked\")\n    public void solve() {\n        N = nextInt();\n        K = nextInt();\n\n        A = new int[N];\n        for(int i = 0;i < N;i++) {\n            A[i] = nextInt();\n        }\n\n        G = new ArrayList[N];\n        revG = new ArrayList[N];\n        for(int i = 0;i < N;i++) {\n            G[i] = new ArrayList<>();\n            revG[i] = new ArrayList<>();\n        }\n\n        for(int i = 0;i < N;i++) {\n            if (A[i] != 0) {\n                G[i].add(A[i]-1);\n                revG[A[i]-1].add(i);\n            }\n        }\n        int[] d = new int[N];\n        Arrays.fill(d,INF);\n\n        for(int i = N-1;i >= 0;i--) {\n            if (revG[i].size() == 0) {\n                d[i] = 0;\n                if (G[i].size() > 0){\n                    int pre = -1;\n                    int next = i;\n                    while(G[next].size() > 0 && (pre == - 1 || d[next] > d[pre])) {\n                        if (pre != -1){\n                            d[next] = Math.min(d[next],d[pre] + 1);\n                        }\n                        pre = next;\n                        next = G[next].get(0);\n                    }\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0;i < N;i++) {\n            if (G[i].size() == 0 || d[i] < K) {\n                ans++;\n            }\n        }\n\n        out.println(ans);\n\n    }\n\n    public static void main(String[] args) {\n        out.flush();\n        new Main().solve();\n        out.close();\n    }\n\n    /* Input */\n    private static final InputStream in = System.in;\n    private static final PrintWriter out = new PrintWriter(System.out);\n    private final byte[] buffer = new byte[2048];\n    private int p = 0;\n    private int buflen = 0;\n\n    private boolean hasNextByte() {\n        if (p < buflen)\n            return true;\n        p = 0;\n        try {\n            buflen = in.read(buffer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        if (buflen <= 0)\n            return false;\n        return true;\n    }\n\n    public boolean hasNext() {\n        while (hasNextByte() && !isPrint(buffer[p])) {\n            p++;\n        }\n        return hasNextByte();\n    }\n\n    private boolean isPrint(int ch) {\n        if (ch >= '!' && ch <= '~')\n            return true;\n        return false;\n    }\n\n    private int nextByte() {\n        if (!hasNextByte())\n            return -1;\n        return buffer[p++];\n    }\n\n    public String next() {\n        if (!hasNext())\n            throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = -1;\n        while (isPrint((b = nextByte()))) {\n            sb.appendCodePoint(b);\n        }\n        return sb.toString();\n    }\n\n    public int nextInt() {\n        return Integer.parseInt(next());\n    }\n\n    public long nextLong() {\n        return Long.parseLong(next());\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.IO;\nusing System.Text;\nusing System.Globalization;\nusing System.Diagnostics;\n\n\n\nclass Myon\n{\n    public Myon() { }\n    public static int Main()\n    {\n        new Myon().calc();\n        return 0;\n    }\n\n    Scanner cin;\n\n    void calc()\n    {\n        cin = new Scanner();\n        int N = cin.nextInt();\n        int K = cin.nextInt();\n        int[] A = cin.ArrayInt(N, -1);\n        int[] depth = new int[N];\n        for (int i = N - 1; i >= 0; i--)\n        {\n            if (A[i] == -1) continue;\n            depth[A[i]] = depth[i] + 1;\n        }\n\n        int ans = 0;\n        for (int i = 0; i < N; i++)\n        {\n            if (A[i] == -1 || depth[i] < K) ans++;\n        }\n        Console.WriteLine(ans);\n    }\n}\n\n\nclass Scanner\n{\n    string[] s;\n    int i;\n\n    char[] cs = new char[] { ' ' };\n\n    public Scanner()\n    {\n        s = new string[0];\n        i = 0;\n    }\n\n    public string next()\n    {\n        if (i < s.Length) return s[i++];\n        string st = Console.ReadLine();\n        while (st == \"\") st = Console.ReadLine();\n        s = st.Split(cs, StringSplitOptions.RemoveEmptyEntries);\n        if (s.Length == 0) return next();\n        i = 0;\n        return s[i++];\n    }\n\n    public int nextInt()\n    {\n        return int.Parse(next());\n    }\n    public int[] ArrayInt(int N, int add = 0)\n    {\n        int[] Array = new int[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextInt() + add;\n        }\n        return Array;\n    }\n\n    public long nextLong()\n    {\n        return long.Parse(next());\n    }\n\n    public long[] ArrayLong(int N, long add = 0)\n    {\n        long[] Array = new long[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextLong() + add;\n        }\n        return Array;\n    }\n\n    public double nextDouble()\n    {\n        return double.Parse(next());\n    }\n\n\n    public double[] ArrayDouble(int N, double add = 0)\n    {\n        double[] Array = new double[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextDouble() + add;\n        }\n        return Array;\n    }\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.IO;\nusing System.Text;\nusing System.Globalization;\nusing System.Diagnostics;\n\n\n\nclass Myon\n{\n    public Myon() { }\n    public static int Main()\n    {\n        new Myon().calc();\n        return 0;\n    }\n\n    Scanner cin;\n\n    void calc()\n    {\n        cin = new Scanner();\n        int N = cin.nextInt();\n        int K = cin.nextInt();\n        int[] A = cin.ArrayInt(N, -1);\n        int[] depth = new int[N];\n        int MAX = 9999999;\n        for (int i = 0; i < N; i++)\n        {\n            depth[i] = MAX;\n        }\n        for (int i = N - 1; i >= 0; i--)\n        {\n            if (A[i] == -1) continue;\n            if (depth[i] == MAX) depth[i] = 0;\n            depth[A[i]] = Math.Min(depth[A[i]], depth[i] + 1);\n        }\n\n        int ans = 0;\n        for (int i = 0; i < N; i++)\n        {\n            if (A[i] == -1 || depth[i] < K) ans++;\n        }\n        Console.WriteLine(ans);\n    }\n}\n\n\nclass Scanner\n{\n    string[] s;\n    int i;\n\n    char[] cs = new char[] { ' ' };\n\n    public Scanner()\n    {\n        s = new string[0];\n        i = 0;\n    }\n\n    public string next()\n    {\n        if (i < s.Length) return s[i++];\n        string st = Console.ReadLine();\n        while (st == \"\") st = Console.ReadLine();\n        s = st.Split(cs, StringSplitOptions.RemoveEmptyEntries);\n        if (s.Length == 0) return next();\n        i = 0;\n        return s[i++];\n    }\n\n    public int nextInt()\n    {\n        return int.Parse(next());\n    }\n    public int[] ArrayInt(int N, int add = 0)\n    {\n        int[] Array = new int[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextInt() + add;\n        }\n        return Array;\n    }\n\n    public long nextLong()\n    {\n        return long.Parse(next());\n    }\n\n    public long[] ArrayLong(int N, long add = 0)\n    {\n        long[] Array = new long[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextLong() + add;\n        }\n        return Array;\n    }\n\n    public double nextDouble()\n    {\n        return double.Parse(next());\n    }\n\n\n    public double[] ArrayDouble(int N, double add = 0)\n    {\n        double[] Array = new double[N];\n        for (int i = 0; i < N; i++)\n        {\n            Array[i] = nextDouble() + add;\n        }\n        return Array;\n    }\n}"
  },
  {
    "language": "Ruby",
    "code": "n, k = gets.chomp.split.map(&:to_i)\narr2 = (1 .. n).to_a\narr, display = [], []\nn.times{|i|\n    x = gets.to_i\n    arr << x\n    if x == 0\n        display << (i + 1) \n    else\n        arr2[x - 1] = nil\n    end\n}\narr2.compact!\ndisplay += arr2\n\nif k > 1\n    temp = []\n    arr2.each{|x|\n        if arr[x - 1] != 0\n            temp << [arr[x - 1], 1]\n        end\n    }\n    temp.uniq!\n    temp.each{|x, c| display << x}\n    while xc = temp.pop\n        x, c = xc\n        if arr[x - 1] != 0 && c < k - 1\n            temp << [arr[x - 1], c + 1]\n            display << arr[x - 1]\n        end\nend\nend\ndisplay.uniq!\nputs display.length\n"
  },
  {
    "language": "Python",
    "code": "from collections import deque\nN, K = map(int, input().split())\na = [int(input())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nleaves = {i for i in range(N) if a[i] > -1} - set(a)\ndq = deque()\nappend = dq.append\nfor i in leaves:\n    v = i\n    l = 0\n    while a[v] != -1 and l < K:\n        append(v)\n        l += 1\n        v = a[v]\n\nprint(result+len(set(dq)))"
  },
  {
    "language": "Python",
    "code": "#????????????ACPC2017Day1_C Displayed tweets\n#URL???http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\n#???????????????\n#???????????????\n\ns = input().split()\nN = int(s[0])\nK = int(s[1])\nA = [0]\nB = [0]\nC = [K]\ncnt = 0\n\nfor h in range(N):\n    x = input()\n    x = int(x)\n    A.append(x)\n    B.append(0)\n    C.append(K)\n    \nfor i in range(N):\n    if A[i+1] != 0:\n        B[A[i+1]] += 1\n\nif K > 1:\n    for j in range(N):\n        if B[j+1] == 0:\n            k = 0\n            m = j+1\n            for k in range(K-1):\n                C[A[m]] = k+1\n                m = A[m]\n\nfor l in range(N):\n    if A[l+1]*B[l+1] == 0:\n        cnt += 1\n    elif C[l+1] < K:\n        cnt += 1\n\nprint(cnt)"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    hoge_add(a[i])\n\nvisited = set()\nadd = visited.add\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        #print(\"start:\", v, \"length:\", l)\n        result += (v not in visited)\n        v = a[v]\n        while a[v] > -1 and v not in nodes and l > 0:\n            #print(v)\n            if v not in visited:\n                result += 1\n                add(v)\n            l -= 1\n            v = a[v]\n        if a[v] > -1 and v in nodes and l > 0:\n            #print(\"->\", v)\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    hoge_add(a[i])\n\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        result += 1\n        v = a[v]\n        while a[v] > -1 and v not in nodes and l > 0:\n            result += 1\n            l -= 1\n            v = a[v]\n        if v > -1 and a[v] > -1 and v in nodes:\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    hoge_add(a[i])\n\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        #print(\"start:\", v, \"length:\", l)\n        result += 1\n        v = a[v]\n        while a[v] > -1 and v not in nodes and l > 0:\n            #print(v)\n            result += 1\n            l -= 1\n            v = a[v]\n        if a[v] > -1 and v in nodes and l > 0:\n            #print(\"->\", v)\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "#????????????ACPC2017Day1_C Displayed tweets\n#URL???http://judge.u-aizu.ac.jp/onlinejudge/cdescription.jsp?cid=ACPC2017Day1&pid=C\n#???????????????\n#???????????????\n\ns = input().split()\nN = int(s[0])\nK = int(s[1])\nA = [0]\nB = [0]\nC = [K]\ncnt = 0\n\nfor h in range(N):\n    x = input()\n    x = int(x)\n    A.append(x)\n    B.append(0)\n    C.append(K)\n    \nfor i in range(N):\n    if A[i+1] != 0:\n        B[A[i+1]] += 1\n\nif K > 1:\n    for j in range(N):\n        if B[j+1] == 0:\n            k = 0\n            m = j+1\n            for k in range(K-1):\n                C[A[m]] = k+1\n                m = A[m]\n\nfor l in range(N):\n    if A[l+1]*B[l+1] == 0:\n        cnt += 1\n    elif C[l+1] < K:\n        cnt += 1\n\nprint(cnt)"
  },
  {
    "language": "Python",
    "code": "# AOJ 2833: Displayed tweets\n# Python3 2018.7.12 bal4u\n\nINF = 0x7ffffff\n\nN, K = map(int, input().split())\nk, f = [INF]*(N+1), [0]*(N+1)\na = [0]+[int(input()) for i in range(N)]\nans = 0\nfor i in range(N, 0, -1):\n\tre = a[i]\n\tif re:\n\t\tif f[i] == 0: v = 0; ans += 1\n\t\telse:\n\t\t\tv = k[i]\n\t\t\tif v < K: ans += 1\n\t\tv += 1\n\t\tif v < K and k[re] > v: k[re] = v\n\t\tf[re] = 1;\n\telse: ans += 1\nprint(ans)\n"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    hoge_add(a[i])\n\nvisited = set()\nadd = visited.add\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        #print(\"start:\", v, \"length:\", l)\n        result += (v not in visited)\n        add(v)\n        v = a[v]\n        while a[v] > -1 and v not in nodes and l > 0:\n            #print(v)\n            if v not in visited:\n                result += 1\n                add(v)\n            l -= 1\n            v = a[v]\n        if a[v] > -1 and v in nodes and l > 0:\n            #print(\"->\", v)\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "N, K = map(int, input().split())\na = [int(input())-1 for _ in [0]*N]\nend = set()\nend2 = set()\nadd = end.add\nadd2 = end2.add\nresult = a.count(-1)\n\nleaves = {i for i in range(N) if a[i] > -1} - set(a)\nfor i in leaves:\n    v = i\n    l = 0\n    n = 0\n    while a[v] != -1:\n        if v not in end2 and l < K:\n            n += 1\n            add2(v)\n        l += 1\n        v = a[v]\n    result += n\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "N, K = map(int, input().split())\na = [int(input())-1 for _ in [0]*N]\nend = set()\nend2 = set()\nadd = end.add\nadd2 = end2.add\nresult = 0\nfor i in range(N-1, -1, -1):\n    if a[i] == -1:\n        result += 1\n    elif i in end:\n        continue\n    else:\n        v = i\n        l = 0\n        n = 0\n        while a[v] != -1:\n            if v not in end2 and l < K:\n                n += 1\n                add2(v)\n            l += 1\n            add(v)\n            v = a[v]\n        result += n\n\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    if a[i] > -1 and a[a[i]] > -1:\n        hoge_add(a[i])\nnodes -= {-1}\n\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        result += 1\n        v = a[v]\n        while a[v] != -1 and v not in nodes and l > 0:\n            result += 1\n            l -= 1\n            v = a[v]\n        if v in nodes and l > 0:\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "N, K = map(int, input().split())\na = [int(input())-1 for _ in [0]*N]\nend = set()\nadd = end.add\nresult = 0\nfor i in range(N-1, -1, -1):\n    if a[i] == -1:\n        result += 1\n    elif i in end:\n        continue\n    else:\n        v = i\n        l = 0\n        while v != -1 and v not in end:\n            l += 1\n            add(v)\n            v = a[v]\n        result += min(l-(v==-1), K)\n\n\nprint(result)"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nN, K = map(int, readline().split())\na = [int(readline())-1 for _ in [0]*N]\nresult = a.count(-1)\n\nnodes = set()\nnode_add = nodes.add\nhoge = set()\nhoge_add = hoge.add\nfor i in range(N):\n    if a[i] in hoge:\n        node_add(a[i])\n    hoge_add(a[i])\n\nvisited = set()\nadd = visited.add\nstartnode = {v: K-1 for v in {i for i in range(N) if a[i] > -1} - set(a)}\nwhile startnode:\n    nextnode = dict()\n    for v, l in startnode.items():\n        #print(\"start:\", v, \"length:\", l)\n        result += 1\n        v = a[v]\n        while a[v] > -1 and v not in nodes and l > 0:\n            #print(v)\n            if v not in visited:\n                result += 1\n                add(v)\n            l -= 1\n            v = a[v]\n        if a[v] > -1 and v in nodes and l > 0:\n            #print(\"->\", v)\n            nextnode[v] = max(nextnode.get(v, 0), l-1)\n    startnode = nextnode\n\nprint(result)"
  }
]