In Takahashi's mind, there is always an integer sequence of length 2 × 10^9 + 1: A = (A_{-10^9}, A_{-10^9 + 1}, ..., A_{10^9 - 1}, A_{10^9}) and an integer P. Initially, all the elements in the sequence A are 0, and the value of the integer P is 0. When Takahashi eats symbols +, -, > and <, the sequence A and the integer P will change as follows: When he eats +, the value of A_P increases by 1; When he eats -, the value of A_P decreases by 1; When he eats >, the value of P increases by 1; When he eats <, the value of P decreases by 1. Takahashi has a string S of length N. Each character in S is one of the symbols +, -, > and <. He chose a pair of integers (i, j) such that 1 ≤ i ≤ j ≤ N and ate the symbols that are the i-th, (i+1)-th, ..., j-th characters in S, in this order. We heard that, after he finished eating, the sequence A became the same as if he had eaten all the symbols in S from first to last. How many such possible pairs (i, j) are there?