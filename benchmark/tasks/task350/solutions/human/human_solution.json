[
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\n// 最大公約数\nlong long gcd(long long a, long long b){\n    while(b != 0){\n        long long tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\n// 最小公倍数\nlong long lcm(long long a, long long b){\n    return a / gcd(a, b) * b;\n}\n\nint main()\n{\n    const int prime[] = {13, 17, 19, 23};\n\n    long long a = 1;\n    for(int i=1; i<=24; ++i){\n        if(find(prime, prime+4, i) == prime+4)\n            a = lcm(a, i);\n    }\n\n    for(;;){\n        int n;\n        cin >> n;\n        if(n == 0)\n            return 0;\n\n        vector<vector<int> > x(25, vector<int>(24, 0));\n        for(int i=0; i<n; ++i){\n            int d, t;\n            cin >> d >> t;\n            for(int j=0; j<d; ++j){\n                int q;\n                cin >> q;\n                x[d][(t-j+d)%d] += q;\n            }\n        }\n\n        for(int i=0; i<4; ++i){\n            int d = prime[i];\n            x[d].assign(d, *max_element(x[d].begin(), x[d].end()));\n        }\n\n        int ret = 0;\n        for(int i=0; i<a; ++i){\n            int sum = 0;\n            for(int j=1; j<=24; ++j)\n                sum += x[j][i%j];\n            ret = max(ret, sum);\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nint gcd(int a, int b) { return b==0?a:gcd(b,a%b); }\nint lcm(int a, int b) { return a*b/gcd(a,b); }\n\nint main(){\n\tint n;\n\twhile(cin >> n, n){\n\t\tint size[100];\n\t\tvector<int> vol[100];\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint offset;\n\t\t\tcin >> size[i] >> offset;\n\t\t\tvol[i].resize(size[i]);\n\t\t\tfor(int j=0;j<size[i];j++) cin >> vol[i][(j+size[i]-offset)%size[i]];\n\t\t}\n\t\tint left = n;\n\t\tbool used[100];\n\t\tmemset(used, false, sizeof(used));\n\t\twhile(true){\n\t\t\tint prevsize = left;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\tif(i==j||used[j]) continue;\n\t\t\t\t\tint gd = lcm(size[i], size[j]);\n\t\t\t\t\tif(gd==size[i]*size[j]) continue;\n\t\t\t\t\tvector<int> vi;\n\t\t\t\t\tfor(int k=0;k<gd;k++)\n\t\t\t\t\t\tvi.push_back(vol[i][k%size[i]]+vol[j][k%size[j]]);\n\t\t\t\t\tsize[i] = gd;\n\t\t\t\t\tvol[i] = vi;\n\t\t\t\t\tused[j] = true;\n\t\t\t\t\tleft--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(prevsize == left) break;\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tif(used[i]) continue;\n\t\t\tint tmp = 0;\n\t\t\tfor(int j=0;j<size[i];j++) tmp = max(tmp, vol[i][j]);\n\t\t\tans += tmp;\n\t\t}\n\t}\n\tcout << ans << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e16\n#define mod 1000000007\n\nint lcm(int a,int b){\n  return (a/__gcd(a,b))*b;\n}\n\nint N;\nint A[25][25];\nint ps[]={13,17,19,23};\n\nint main(){\n  while(1){\n    scanf(\"%d\",&N);\n    if(N==0)break;\n    memset(A,0,sizeof(A));\n    int sz=1;\n    rep(i,N){\n      int D,T;\n      scanf(\"%d%d\",&D,&T);\n      bool ok=true;\n      rep(j,4)if(ps[j]==D)ok=false;\n      if(ok)sz=lcm(sz,D);\n      rep(j,D){\n        int B;\n        scanf(\"%d\",&B);\n        A[D][(j-T+D)%D]+=B;\n      }\n    }\n    vector<int> sum(sz,0);\n    int res=0;\n    rep(i,4)res+=*max_element(A[ps[i]],A[ps[i]]+25);\n    repl(i,1,25){\n      bool ok=true;\n      rep(j,4)if(ps[j]==i)ok=false;\n      if(!ok)continue;\n      rep(j,sz)sum[j]+=A[i][j%i];\n    }\n    res+=*max_element(all(sum));\n    printf(\"%d\\n\",res);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint main() {\n\twhile (1) {\n\t\tint N; cin >> N;\n\t\tif (!N)break;\n\t\tconst int ro = 16 * 9 * 5 * 7;\n\t\tvector<vector<int>>access;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, t; cin >> d >> t;\n\t\t\tvector<int>v(d);\n\t\t\tfor (int j = 0; j < d; ++j) {\n\t\t\t\tcin >> v[(j + d - t) % d];\n\t\t\t}\n\t\t\tvector<int>av;\n\t\t\tif (ro%d) {\n\t\t\t\tconst int num = *max_element(v.begin(), v.end());\n\t\t\t\tfor (int j = 0; j < ro; ++j) {\n\t\t\t\t\tav .emplace_back( num);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int j = 0; j < ro / d; ++j) {\n\t\t\t\t\tav.insert(av.end(), v.begin(), v.end());\n\t\t\t\t}\n\t\t\t}\n\t\t\taccess.push_back(av);\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < ro; ++i) {\n\t\t\tint sum = 0;\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tsum += access[j][i];\n\t\t\t}\n\t\t\tans = max(ans, sum);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint gcd(int a,int b){\n\twhile(a){\n\t\tb%=a;\n\t\tint c=b;\n\t\tb=a;\n\t\ta=c;\n\t}\n\treturn b;\n}\nint lcm(int a,int b){\n\treturn a/gcd(a,b)*b;\n}\nint q[100][100];\nint t[100000];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<100000;i++)t[i]=0;\n\t\tfor(int i=0;i<100;i++)\n\t\t\tfor(int j=0;j<100;j++)\n\t\t\t\tq[i][j]=0;\n\t\tfor(int i=0;i<a;i++){\n\t\t\tint b,c;\n\t\t\tscanf(\"%d%d\",&b,&c);\n\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\tint d;\n\t\t\t\tscanf(\"%d\",&d);\n\t\t\t\tq[b][(j+c)%b]+=d;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<55440;i++){\n\t\t\tfor(int j=1;j<=24;j++){\n\t\t\t\tif(j==13)continue;\n\t\t\t\tif(j==17)continue;\n\t\t\t\tif(j==19)continue;\n\t\t\t\tif(j==23)continue;\n\t\t\t\tt[i]+=q[j][i%j];\n\t\t\t}\n\t\t}\n\t\tint f=0;\n\t\tint g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[13][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[17][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[19][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[23][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<55440;i++){\n\t\t\tg=max(g,t[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",f+g);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint n,a[25],x,t,d[25][25],s[100000],MAX[25];\n\nsigned main(){\n    while(cin>>n,n){\n        int ans=0;\n        memset(s,0,sizeof(s));\n        memset(d,0,sizeof(d));\n        memset(MAX,0,sizeof(MAX));\n        r(i,n){\n            cin>>x>>t;\n            r(j,x)cin>>a[j];\n            r(j,x)d[x][j]+=a[(t+j)%x];\n        }\n        for(int i=1;i<=24;i++){\n            if(i==13||i==17||i==19||i==23){\n                r(j,i+1)MAX[i]=max(MAX[i],d[i][j]);\n            }\n            else{\n                r(j,100000){\n                    s[j]+=d[i][j%i];\n                    ans=max(ans,s[j]);\n                }\n            }\n        }\n        cout<<ans+MAX[13]+MAX[17]+MAX[19]+MAX[23]<<endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <string>\n#include <cmath>\n#include <cassert>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\n#include <iomanip>\n#include <fstream>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define chmax(a,b) (a<b?(a=b,1):0)\n#define chmin(a,b) (a>b?(a=b,1):0)\n#define valid(y,x,h,w) (0<=y&&y<h&&0<=x&&x<w)\nconst int INF = 1<<29;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\nint d[100];\nint q[100][24];\n\nint main() {\n  int n;\n  while(cin>>n,n) {\n    REP(i,n) {\n      cin >> d[i];\n      int t; cin >> t;\n      REP(j,d[i]) cin >> q[i][j];\n    }\n    int t[4] = {13,17,19,23};\n    int f[25];\n    REP(i,25) {\n      f[i] = -1;\n      REP(j,4)if(i==t[j])f[i]=j;\n    }\n    int N = 55440;\n    int ans = 0;\n    REP(t,N) {\n      int tmp = 0;\n      REP(i,n) {\n        if (f[d[i]] == -1) {\n          tmp += q[i][t%d[i]];\n        }\n      }\n      chmax(ans, tmp);\n    }\n    int hoge[4][25] = {};\n    REP(i,n) {\n      if (f[d[i]] >= 0) {\n        REP(j,d[i]) hoge[f[d[i]]][j] += q[i][j];\n      }\n    }\n    REP(i,4) {\n      ans += *max_element(hoge[i],hoge[i]+25);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j+t)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                int a=p.first,b=q.first;\n                if(a==b) continue;\n                int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%a]+q.second[i%b];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint N, d, t, q, Q[25][25] = {{0}};\n\nconst int L = 16 * 9 * 5 * 7 * 11;\n\nint main() {\n\n\twhile ( cin >> N && N ) {\n\n\t\tfor ( int i = 0; i < N; i++ ) {\n\n\t\t\tcin >> d >> t;\n\n\t\t\tfor ( int j = 0; j < d; j++ ) {\n\n\t\t\t\tcin >> q;\n\t\t\t\tQ[d][( j + d - t ) % d] += q;\n\n\t\t\t}\n\n\t\t}\n\n\t\tint sum = 0, T[L] = {0};\n\n\t\tfor ( int d = 1; d <= 24; d++ ) {\n\n\t\t\tif ( d == 13 || d == 17 || d == 19 || d == 23 || d == 1 ) {\n\n\t\t\t\tint max = 0;\n\n\t\t\t\tfor ( int i = 0; i < d; i++ ) {\n\n\t\t\t\t\tif ( max < Q[d][i] ) { max = Q[d][i]; }\n\n\t\t\t\t}\n\n\t\t\t\tsum += max;\n\n\t\t\t} else {\n\n\t\t\t\tfor ( int i = 0; i < L; i++ ) { T[i] += Q[d][i % d]; }\n\n\t\t\t}\n\n\t\t}\n\n\t\tint max = 0;\n\n\t\tfor ( int i = 0; i < L; i++ ) {\n\n\t\t\tif ( max < T[i] ) { max = T[i]; }\n\n\t\t}\n\t\t\t\n\t\tcout << sum + max << endl;\n\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> l_l;\ntypedef pair<int, int> i_i;\ntemplate<class T>\ninline bool chmax(T &a, T b) {\n    if(a < b) {\n        a = b;\n        return true;\n    }\n    return false;\n}\n\ntemplate<class T>\ninline bool chmin(T &a, T b) {\n    if(a > b) {\n        a = b;\n        return true;\n    }\n    return false;\n}\n\nconst long double EPS = 1e-10;\nconst long long INF = 1e18;\nconst long double PI = acos(-1.0L);\n//const ll mod = 1000000007;\nll N;\nll ans;\nconst ll T = 55440;\nll a[T];\nll A[13], B[17], C[19], D[23];\nint main() {\n    while(cin >> N) {\n        if(N == 0) break;\n        for(int i = 0; i < T; i++) {\n            a[i] = 0;\n        }\n        for(int i = 0; i < 13; i++) A[i] = 0;\n        for(int i = 0; i < 17; i++) B[i] = 0;\n        for(int i = 0; i < 19; i++) C[i] = 0;\n        for(int i = 0; i < 23; i++) D[i] = 0;\n        ans = 0;\n        for(int i = 0; i < N; i++) {\n            ll d;\n            cin >> d;\n            ll t;\n            cin >> t;\n            vector<ll> q(d);\n            for(int j = 0; j < d; j++) cin >> q[j];\n            if(d == 13 or d == 17 or d == 19 or d == 23) {\n                for(int j = 0; j < d; j++) {\n                    if(d == 13) A[j] += q[(j+t)%d];\n                    if(d == 17) B[j] += q[(j+t)%d];\n                    if(d == 19) C[j] += q[(j+t)%d];\n                    if(d == 23) D[j] += q[(j+t)%d];\n                }\n                continue;\n            }\n            for(int j = 0; j < T; j++) {\n                a[j] += q[(t + j) % d];\n            }\n        }\n        ll maxi = 0;\n        for(auto tmp : a) {\n            chmax(maxi, tmp);\n        }\n        ans += maxi;\n        maxi = 0;\n        for(int i = 0; i < 13; i++) chmax(maxi, A[i]);\n        ans += maxi;\n        maxi = 0;\n        for(int i = 0; i < 17; i++) chmax(maxi, B[i]);\n        ans += maxi;\n        maxi = 0;\n        for(int i = 0; i < 19; i++) chmax(maxi, C[i]);\n        ans += maxi;\n        maxi = 0;\n        for(int i = 0; i < 23; i++) chmax(maxi, D[i]);\n        ans += maxi;\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint main() {\n\twhile (1) {\n\t\tint N; cin >> N;\n\t\tif (!N)break;\n\t\tconst int ro = 16 * 9 * 5 * 7*11;\n\t\tvector<vector<int>>access;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, t; cin >> d >> t;\n\t\t\tvector<int>v(d);\n\t\t\tfor (int j = 0; j < d; ++j) {\n\t\t\t\tcin >> v[(j + d - t) % d];\n\t\t\t}\n\t\t\tvector<int>av;\n\t\t\tif (ro%d) {\n\t\t\t\tconst int num = *max_element(v.begin(), v.end());\n\t\t\t\tfor (int j = 0; j < ro; ++j) {\n\t\t\t\t\tav .emplace_back( num);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int j = 0; j < ro / d; ++j) {\n\t\t\t\t\tav.insert(av.end(), v.begin(), v.end());\n\t\t\t\t}\n\t\t\t}\n\t\t\taccess.push_back(av);\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < ro; ++i) {\n\t\t\tint sum = 0;\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tsum += access[j][i];\n\t\t\t}\n\t\t\tans = max(ans, sum);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\nusing namespace std;\n\ntypedef unsigned long long ullong;\n\nullong gcd(ullong a, ullong b){ return b==0?a: gcd(b, a%b);}\nullong lcm(ullong a, ullong b){ return a*(b/gcd(a, b));}\n\nbool isRP(int x){\n  if (  x == 13 || x == 17 || x == 19 || x == 23 ) return true;\n  return false;\n}\n\nmain(){\n  int N;\n  ullong D[100], S[100], T[100][24];\n  ullong lcm1, lcm2, max1, max2;\n\n  while(1){\n    cin >> N;\n    if ( N == 0 ) break;\n    lcm1 = lcm2 = 1;\n    max1 = max2 = 0;\n\n    for ( int i = 0; i < N; i++ ){\n      cin >> D[i] >> S[i];\n      assert( 0 <= S[i] && S[i] <= D[i]-1);\n      for ( int j = 0; j < D[i]; j++ ) cin >> T[i][j];\n      if ( isRP(D[i])) {\n\tlcm2 = lcm(lcm2, D[i]);\n      } else {\n\tlcm1 = lcm(lcm1, D[i]);\n      }\n    }\n\n    for ( int j = 0; j < lcm1; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max1 = max(max1, sum);\n    }\n\n    for ( int j = 0; j < lcm2; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( !isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max2 = max(max2, sum);\n    }\n\n    cout << max1 + max2 << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint main() {\n\twhile (1) {\n\t\tint N; cin >> N;\n\t\tif (!N)break;\n\t\tconst int ro = 16 * 9 * 5 * 7*11;\n\t\tvector<vector<int>>specials(4);\n\t\tspecials[0].resize(13);\n\t\tspecials[1].resize(17);\n\t\tspecials[2].resize(19);\n\t\tspecials[3].resize(23);\n\t\tvector<vector<int>>access;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, t; cin >> d >> t;\n\t\t\tvector<int>v(d);\n\t\t\tfor (int j = 0; j < d; ++j) {\n\t\t\t\tcin >> v[(j + d - t) % d];\n\t\t\t}\n\t\t\tvector<int>av;\n\t\t\tif (ro%d) {\n\t\t\t\tconst int num = *max_element(v.begin(), v.end());\n\t\t\t\tfor (int j = 0; j < d; ++j) {\n\t\t\t\t\t int p;\n\t\t\t\t\tif (d == 13) {\n\t\t\t\t\t\tp = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse if (d == 17) {\n\t\t\t\t\t\tp = 1;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (d == 19) {\n\n\t\t\t\t\t\tp = 2;\n\t\t\t\t\t}\n\t\t\t\t\telse if (d == 23) {\n\t\t\t\t\t\tp = 3;\n\n\t\t\t\t\t}\n\t\t\t\t\tspecials[p][j] += v[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int j = 0; j < ro / d; ++j) {\n\t\t\t\t\tav.insert(av.end(), v.begin(), v.end());\n\t\t\t\t}\n\t\t\t}\n\t\t\taccess.push_back(av);\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < ro; ++i) {\n\t\t\tint sum = 0;\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tif (!access[j].empty()) {\n\t\t\t\t\tsum += access[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, sum);\n\t\t}\n\t\tfor (int i = 0; i < 4; ++i) {\n\t\t\tans += *max_element(specials[i].begin(), specials[i].end());\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0,acc[tmax];\n\t\tmemset(acc,0,sizeof(acc));\n\t\trep(loop,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(i,d) cin >> q[i];\n\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(i,tmax){\n\t\t\t\t\tint cur=(i+t)%tmax;\n\t\t\t\t\tacc[cur]+=q[cur%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(cycle, 0);\n    MEMSET(total, 0);\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      assert(0 <= offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(d - offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    FOR(i, 1, 25) {\n      if (i == 13 || i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n        continue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int C=55440;\nint sum[4][24];\nint lsum[C],table[4]={13,17,19,23};\n\nint main(){\n    int N;\n    for(;;){\n        scanf(\"%d\",&N);\n        if(N==0) break;\n        for(int i=0;i<N;i++){\n            int d,t;\n            scanf(\"%d%d\",&d,&t);\n            int now[24];\n            for(int j=0;j<d;j++){\n                scanf(\"%d\",&now[j]);\n            }\n            rotate(now,now+t,now+d);\n            if(find(table,end(table),d)!=end(table)){\n                int at=find(table,end(table),d)-end(table);\n                for(int j=0;j<d;j++){\n                    sum[at][j]+=now[j];\n                }\n            }else{\n                for(int j=0;j<C/d;j++){\n                    for(int k=0;k<d;k++){\n                        lsum[j*d+k]+=now[k];\n                    }\n                }\n            }\n        }\n        int ret=*max_element(lsum,lsum+C);\n        for(int j=0;j<4;j++){\n            ret+=*max_element(sum[j],sum[j]+table[j]);\n        }\n        printf(\"%d\\n\",ret);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 55440;\n\nint cnt[MAX_N+1];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(1){\n        int n;\n        cin >> n;\n        if(n == 0){\n            break;\n        }\n        rep(i,MAX_N){\n            cnt[i] = 0;\n        }\n        vvi vec(25);\n        rep(i,25){\n            vec[i].resize(i,0);\n        }\n        rep(i,n){\n            int d,t;\n            cin >> d >> t;\n            rep(j,d){\n                int a;\n                cin >> a;\n                vec[d][(t+d-j)%d] += a;\n            }\n        }\n        int ans = 0;\n        srep(i,1,25){\n            if(MAX_N % i == 0){\n                rep(j,MAX_N){\n                    cnt[j] += vec[i][j%i];\n                }\n            }else{\n                int mx = 0;\n                rep(j,i){\n                    cmx(mx,vec[i][j]);\n                }\n                ans += mx;\n            }\n        }\n        int res = 0;\n        rep(i,MAX_N){\n            cmx(res,cnt[i]);\n        }\n        cout << ans + res << \"\\n\";\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 55440;\n\nint cnt[MAX_N+1];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(1){\n        int n;\n        cin >> n;\n        if(n == 0){\n            break;\n        }\n        rep(i,MAX_N){\n            cnt[i] = 0;\n        }\n        vvi vec(25);\n        rep(i,25){\n            vec[i].resize(i,0);\n        }\n        rep(i,n){\n            int d,t;\n            cin >> d >> t;\n            rep(j,d){\n                int a;\n                cin >> a;\n                cmx(vec[d][(t+j)%d],a);\n            }\n        }\n        int ans = 0;\n        srep(i,1,25){\n            if(MAX_N % i == 0){\n                rep(j,MAX_N){\n                    cnt[j] += vec[i][j%i];\n                }\n            }else{\n                int mx = 0;\n                rep(j,i){\n                    cmx(mx,vec[i][j]);\n                }\n                ans += mx;\n            }\n        }\n        int res = 0;\n        rep(i,MAX_N){\n            cmx(res,cnt[i]);\n        }\n        cout << ans + res << \"\\n\";\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <algorithm>\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nusing ll = long long int;\n\nll gcd(ll a, ll b) {\n    return b == 0 ? a : gcd(b, a%b);\n}\n\nll lcm(ll a, ll b) {\n    return a / gcd(a, b) * b;\n}\n\nint solve_testcase() {\n    int N; cin >> N;\n    if(N == 0) return 1;\n\n    const int M = 55440 * 2;\n    vector<int> rec(M);\n    vector< vector<int> > sum(25, vector<int>(25));\n    for(int i=0; i<N; i++) {\n        int K, T; cin >> K >> T;\n\n        if(K == 13 or K == 17 or K == 19 or K == 23) {\n            for(int j=0; j<K; j++) {\n                int v; cin >> v;\n                sum[K][(j-T+K)%K] += v;\n            }\n        }\n        else {\n            for(int j=0; j<K; j++) {\n                int v; cin >> v;\n                for(int t=j-T; t<M; t+=K) {\n                    if(t < 0) continue;\n                    rec[t] += v;\n                }\n            }\n        }\n    }\n\n    int ans = *max_element(rec.begin(), rec.end());\n    for(int i=0; i<25; i++) {\n        ans += *max_element(sum[i].begin(), sum[i].end());\n    }\n    cout << ans << endl;\n    return 0;\n}\n\nint main() {\n    while(!solve_testcase());\n\n    if(false) {   \n        ll l = 1;\n        for(int i=1; i<=24; i++) {\n            if(i == 13 or i == 17 or i == 19 or i == 23) continue;\n            l = lcm(l, i);\n            fprintf(stderr, \"i = %d, lcm = %lld\\n\", i, l);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define N 110\nusing namespace std;\nconst int INF = 1LL<<55;\nconst int mod = (1e9)+7;\nconst double EPS = 1e-8;\nconst double PI = 6.0 * asin(0.5);\ntemplate<class T> T Max(T &a,T b){return a=max(a,b);}\ntemplate<class T> T Min(T &a,T b){return a=min(a,b);}\nvector<vector<int> >D;\n\nsigned main(){\n  \n  while(1){\n    int n;\n    cin>>n;\n    if(!n) break;\n    D.clear(); D.resize(25);\n    for(int i=0;i<25;i++) D[i].resize(i,0);\n    \n    for(int i=0;i<n;i++){\n      int d,t;\n      cin>>d>>t;\n      for(int j=0,a;j<d;j++) cin>>a, D[d][(j-t+d)%d]+=a;\n    }\n    \n    vector<vector<int> > dp(N);\n    dp[1].push_back(0);\n    for(int i=1;i<=24;i++){\n      int d = dp[i].size();\n      if(i == 13 || i == 17 || i == 19 || i == 23) {\n        int mx = 0;\n        for(int j=0;j<i;j++) Max(mx,D[i][j]);\n        dp[i+1].resize(d);\n        for(int j=0;j<d;j++) dp[i+1][j] = dp[i][j] + mx;\n        continue;\n      }\n      int lcm = d * i / __gcd(d,i);\n      dp[i+1].resize(lcm);\n      for(int j=0;j<lcm;j++) dp[i+1][j] = dp[i][j%d] + D[i][j%i];\n    }\n    int ans = 0;\n    for(int a:dp[25]) Max(ans,a);\n    cout<<ans<<endl;\n  }  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\n#include <set>\n#include <map>\n#include <time.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nll calc(ll x,ll y){\n\tif(y == 0){\n\t\treturn x;\n\t}else{\n\t\treturn calc(y,x%y);\n\t}\n}\n\nint N;\nll day_len[100],now_t[100],access[100][24];\nll table1[60000],table2[100000];\n\n\n\nvoid func(){\n\n\n\n\tll cicle1 = 1,cicle2 = 1,common;\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%lld %lld\",&day_len[i],&now_t[i]);\n\t\tif(day_len[i] == 13 || day_len[i] == 17 || day_len[i] == 19 || day_len[i] == 23){\n\t\t\tif(cicle2 >= day_len[i]){\n\t\t\t\tcommon = calc(cicle2,day_len[i]);\n\t\t\t}else{\n\t\t\t\tcommon = calc(day_len[i],cicle2);\n\t\t\t}\n\t\t\tcicle2 = (cicle2*day_len[i])/common;\n\t\t}else{\n\t\t\tif(cicle1 >= day_len[i]){\n\t\t\t\tcommon = calc(cicle1,day_len[i]);\n\t\t\t}else{\n\t\t\t\tcommon = calc(day_len[i],cicle1);\n\t\t\t}\n\t\t\tcicle1 = (cicle1*day_len[i])/common;\n\t\t}\n\n\t\tfor(int k = 0; k < day_len[i]; k++)scanf(\"%d\",&access[i][k]);\n\t}\n\n\tfor(int i = 0; i < cicle1; i++)table1[i] = 0;\n\tfor(int i = 0; i < cicle2; i++)table2[i] = 0;\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(day_len[i] == 13 || day_len[i] == 17 || day_len[i] == 19 || day_len[i] == 23){\n\t\t\tfor(int k = 0; k < cicle2; k++){\n\t\t\t\ttable2[k] += access[i][(now_t[i]+k)%day_len[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tfor(int k = 0; k < cicle1; k++){\n\t\t\t\ttable1[k] +=  access[i][(now_t[i]+k)%day_len[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tll maximum1 = 0,maximum2 = 0;\n\tfor(int k = 0; k < cicle1; k++)maximum1 = max(maximum1,table1[k]);\n\tfor(int k = 0; k < cicle2; k++)maximum2 = max(maximum2,table2[k]);\n\n\tprintf(\"%lld\\n\",maximum1+maximum2);\n\n}\n\n\nint main(){\n\n\twhile(true){\n\t\tscanf(\"%d\",&N);\n\t\tif(N == 0)break;\n\n\t\tfunc();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    while(1){\n        int n;\n        cin >> n;\n        if(n == 0) break;\n\n        int v[25][25] = {};\n        for(int i=0; i<n; i++){\n            int d,t;\n            cin >> d >> t;\n            for(int j=0; j<d; j++){\n                int vol;\n                cin >> vol;\n                v[d][(j-t+d)%d] += vol;\n            }\n        }\n\n        int ans = 0;\n        // 13,17,19,23以外の周期\n        for(int i=0; i<55400; i++){\n            int sub = 0;\n            for(int j=1; j<=24; j++){\n                if(j==13 or j==17 or j==19 or j==23){\n                    continue;\n                }\n                sub += v[j][i%j];\n            }\n            ans = max(ans, sub);\n        }\n        for(int i=0; i<=24; i++){\n            if(i==13 or i==17 or i==19 or i==23){\n                ans += *max_element(v[i], v[i]+i);\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint N, d, t, q, Q[25][25] = {{0}};\n\nconst int L = 16 * 9 * 5 * 7 * 11;\n\nint main() {\n\n\twhile ( cin >> N && N ) {\n\n\t\tfor ( int i = 0; i < N; i++ ) {\n\n\t\t\tcin >> d >> t;\n\n\t\t\tfor ( int j = 0; j < d; j++ ) {\n\n\t\t\t\tcin >> q;\n\t\t\t\tQ[d][( j + d - t ) % d] += q;\n\n\t\t\t}\n\n\t\t}\n\n\t\tint sum = 0, T[L] = {0};\n\n\t\tfor ( int d = 1; d <= 24; d++ ) {\n\n\t\t\tif ( d == 13 || d == 17 || d == 19 || d == 23 || d == 1 ) {\n\n\t\t\t\tint max = 0;\n\n\t\t\t\tfor ( int i = 0; i < d; i++ ) {\n\n\t\t\t\t\tif ( max < Q[d][i] ) { max = Q[d][i]; }\n\n\t\t\t\t}\n\n\t\t\t\tsum += max;\n\n\t\t\t} else {\n\n\t\t\t\tfor ( int i = 0; i < L; i++ ) { T[i] += Q[d][i % d]; }\n\n\t\t\t}\n\n\t\t}\n\n\t\tint max = 0;\n\n\t\tfor ( int i = 0; i < L; i++ ) {\n\n\t\t\tif ( max < T[i] ) { max = T[i]; }\n\n\t\t}\n\t\t\t\n\t\tcout << sum + max << endl;\n\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\n\n// 2 3 5 7 11 13 17 19 23\n// 13 17 19 23\n\nbool use[101];\nvector<ll> volume[101];\nint current_time[101];\nvector<ll> buf[101];\nint pm[4] = {13,17,19,23};\n\nint main(){\n  int N;\n  while( cin >> N, N ) {\n  ll lcm = 1;\n    rep(i,N) {\n      use[i] = false;\n      volume[i].clear();\n    }\n    rep(i,4) buf[pm[i]].clear();\n    rep(i,N){\n      int size;\n      cin >> size;\n      volume[i].resize(size);\n      cin >> current_time[i];\n      rep(j,size) cin >> volume[i][j];\n      if( size != 13 && size != 17 && size != 19 && size != 23 ) {\n        lcm = lcm / __gcd(lcm,(ll)size) * (ll)size;\n        use[i] = true;\n      } else {\n        if( buf[size].empty() ) buf[size].resize(size,0);\n        rep(j,size) {\n          buf[size][j] += volume[i][(current_time[i]+j)%size];\n        }\n      }\n    }\n    ll maxi = 0;\n    for(ll i=0;i<lcm;i++){\n      ll maxi_sub = 0;\n      rep(j,N) if( use[j] ){\n        maxi_sub += volume[j][current_time[j]];\n        ( current_time[j] += 1 ) %= (int)volume[j].size();\n      }\n      maxi = max(maxi,maxi_sub);\n    }\n    rep(i,4) {\n      ll maxi_sub = 0;\n      rep(j,buf[pm[i]].size()) maxi_sub = max(maxi_sub,buf[pm[i]][j]);\n      maxi += maxi_sub;\n    }\n    cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n \nconst int MAXN = 101;\n \nint N;\nvector<vector<int> > q;\n \nint lcm(int a, int b) {\n  return a * b / __gcd(a, b);\n}\n \nint main() {\n  while(cin >> N && N) {\n    q.clear();\n    vector<int> a(13), b(17), c(19), d(23);\n    for(int i = 0; i < N; ++i) {\n      int s, t; cin >> s >> t;\n      vector<int> v(s);\n      for(int j = 0; j < s; ++j) cin >> v[(j-t+s)%s];\n      if(s == 13) for(int j = 0; j < 13; ++j) a[j] += v[j];\n      else if(s == 17) for(int j = 0; j < 17; ++j) b[j] += v[j];\n      else if(s == 19) for(int j = 0; j < 19; ++j) c[j] += v[j];\n      else if(s == 23) for(int j = 0; j < 23; ++j) d[j] += v[j];\n      else q.push_back(v);\n    }\n    int T = 1;\n    for(int i = 0; i < q.size(); ++i) {\n      T = lcm(T, q[i].size());\n    }\n    int res = 0;\n    for(int t = 0; t < T; ++t) {\n      int sum = 0;\n      for(int i = 0; i < q.size(); ++i) {\n        sum += q[i][t%q[i].size()];\n      }\n      res = max(res, sum);\n    }\n    res += *max_element(a.begin(), a.end());\n    res += *max_element(b.begin(), b.end());\n    res += *max_element(c.begin(), c.end());\n    res += *max_element(d.begin(), d.end());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst int INF=1e9;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nint lcm(int a,int b)\n{\n\treturn a/__gcd(a,b)*b;\n}\nint lcm(const vi& a)\n{\n\tint res=1;\n\tfor(int x:a) res=lcm(res,x);\n\treturn res;\n}\n\nint main()\n{\n\tfor(int n;cin>>n && n;){\n\t\tvvi q(n);\n\t\trep(i,n){\n\t\t\tint d,t; cin>>d>>t;\n\t\t\tq[i].resize(d);\n\t\t\trep(j,d) cin>>q[i][(t-j+d)%d];\n\t\t}\n\t\t\n\t\tvi ds={13,17,19,23};\n\t\tvvi qq[2];\n\t\trep(i,n)\n\t\t\tqq[count(all(ds),q[i].size())].push_back(q[i]);\n\t\t\n\t\tvi sum[2]={vi(1),vi(1)};\n\t\trep(i,2){\n\t\t\trep(j,qq[i].size())\n\t\t\t\tsum[i].resize(lcm(sum[i].size(),qq[i][j].size()));\n\t\t\trep(j,qq[i].size()) rep(k,sum[i].size())\n\t\t\t\tsum[i][k]+=qq[i][j][k%qq[i][j].size()];\n\t\t}\n\t\t\n\t\tint res=0;\n\t\trep(i,2) res+=*max_element(all(sum[i]));\n\t\tcout<<res<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j+t)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                if(p.first==q.first) continue;\n                int c=lcm(p.first,q.first),d=gcd(p.first,q.first);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%p.first]+q.second[i%q.first];\n                x.erase(p.first);\n                x.erase(q.first);\n                x[c]=v;\n\n                update=true;\n            }\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <string>\n#include <cmath>\n#include <cassert>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\n#include <iomanip>\n#include <fstream>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define chmax(a,b) (a<b?(a=b,1):0)\n#define chmin(a,b) (a>b?(a=b,1):0)\n#define valid(y,x,h,w) (0<=y&&y<h&&0<=x&&x<w)\nconst int INF = 1<<29;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\nint d[100];\nint q[100][24];\nint t[100];\n\nint main() {\n  int n;\n  while(cin>>n,n) {\n    REP(i,n) {\n      cin >> d[i];\n      cin >> t[i];\n      int tmp[d[i]];\n      REP(j,d[i]) cin >> tmp[j];\n      REP(j,d[i]) q[i][j] = tmp[(j+t[i])%d[i]];\n    }\n    int t[4] = {13,17,19,23};\n    int f[25];\n    REP(i,25) {\n      f[i] = -1;\n      REP(j,4)if(i==t[j])f[i]=j;\n    }\n    int N = 55440;\n    int ans = 0;\n    REP(t,N) {\n      int tmp = 0;\n      REP(i,n) {\n        if (f[d[i]] == -1) {\n          tmp += q[i][t%d[i]];\n        }\n      }\n      chmax(ans, tmp);\n    }\n    int hoge[4][25] = {};\n    REP(i,n) {\n      if (f[d[i]] >= 0) {\n        REP(j,d[i]) hoge[f[d[i]]][j] += q[i][j];\n      }\n    }\n    REP(i,4) {\n      ans += *max_element(hoge[i],hoge[i]+25);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <cstdlib>\n#define L 16*9*5*7*11\nint Q[25][25]; // d周期のi時間目の量\nint T[L];\nint main(){\n\tint N,d,t,q;\n\tfor(;scanf(\"%d\",&N),N;){\n\t\tmemset(Q,0,sizeof(Q));\n\t\tfor(int i=0;i<N;++i){\n\t\t\tscanf(\"%d%d\",&d,&t);\n\t\t\tfor(int j=0;j<d;++j){\n\t\t\t\tscanf(\"%d\",&q);\n\t\t\t\tQ[d][(j+d-t)%d] += q;\n\t\t\t}\n\t\t}\n\t\tint sum=0;\n\t\tmemset(T,0,sizeof(T));\n\t\tfor(int d=1;d<=24;++d){\n\t\t\tif(d==13 || d==17 || d==19 || d==23 || d==1)\n\t\t\t\tsum+=*std::max_element(Q[d],Q[d]+d);\n\t\t\telse\n\t\t\t\tfor(int i=0;i<L;++i)T[i]+=Q[d][i%d];\n\t\t}\n\t\tprintf(\"%d\\n\",sum+*std::max_element(T,T+L));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvector<int> vec={16,9,5,7,11};\nint solve(int n){\n    vector<int> d(n);\n    vector<vector<int>> q(n);\n    for(int i=0;i<n;i++){\n        cin>>d[i];\n        q[i].resize(d[i]);\n        int t;\n        cin>>t;\n        for(int j=0;j<d[i];j++){\n            cin>>q[i][(j+(d[i]-t))%d[i]];\n        }\n    }\n    auto calc=[&](vector<int> v){\n        int res=0;\n        for(int i=0;i<n;i++){\n            int sc=-1e9;\n            for(int j=0;j<d[i];j++){\n                bool isok=true;\n                for(int k=0;k<vec.size();k++){\n                    int g=__gcd(vec[k],d[i]);\n                    isok=isok && v[k]%g==j%g;                    \n                }\n                if(isok) sc=max(sc,q[i][j]);\n            }\n            res+=sc;\n        }\n        return res;\n    };\n    function<int(int,vector<int>)> dfs=[&](int idx,vector<int> v){\n        if(idx==vec.size()) return calc(v);\n        int res=0;\n        for(int i=0;i<vec[idx];i++){\n            v[idx]=i;\n            res=max(res,dfs(idx+1,v));\n        }\n        return res;\n    };\n    vector<int> tmp(vec.size());\n    return dfs(0,tmp);\n}\nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define all(v) (v).begin(), (v).end()\n#define resz(v, ...) (v).clear(), (v).resize(__VA_ARGS__)\n#define reps(i, m, n) for(int i = (int)(m); i < (int)(n); i++)\n#define rep(i, n) reps(i, 0, n)\n\ntemplate<class T1, class T2> void chmin(T1 &a, T2 b){if(a>b)a=b;}\ntemplate<class T1, class T2> void chmax(T1 &a, T2 b){if(a<b)a=b;}\n\ntypedef pair<int, int> Pi;\ntypedef tuple<int, int, int> Ti;\ntypedef vector<int> vint;\n\nconst int inf = 1LL << 55;\nconst int mod = 1e9 + 7;\n\nint N;\nvint d, t;\nvector<vint> q;\nint sum[60000];\nint psum[25][60000];\n\nint lcm(int a, int b) {\n  return a / __gcd(a, b) * b;\n}\n\nbool avoid(int a) {\n  return a==13||a==17||a==19||a==23;\n}\n\nsigned main()\n{\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  while(cin >> N, N) {\n    resz(d, N), resz(t, N), resz(q, N);\n    rep(i, N) {\n      cin >> d[i] >> t[i];\n      resz(q[i], d[i]);\n      rep(j, d[i]) cin >> q[i][j];\n    }\n    int LCM = 1;\n    rep(i, N) if(!avoid(d[i])) LCM = lcm(LCM, d[i]);\n    memset(sum, 0, sizeof(sum));\n    memset(psum, 0, sizeof(psum));\n    rep(i, N) {\n      if(avoid(d[i])) {\n\trep(j, d[i]) psum[d[i]][j] += q[i][(t[i]+j)%d[i]];\n      } else {\n\trep(j, LCM) sum[j] += q[i][(t[i]+j)%d[i]];\n      }\n    }\n    int ans = 0;\n    rep(i, LCM) chmax(ans, sum[i]);\n    rep(i, N) if(avoid(d[i])) {\n    int tmp = 0;\n      rep(j, d[i]) chmax(tmp, psum[d[i]][j]);\n      ans += tmp;\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(cycle, 0);\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    MEMSET(total, 0);\n    FOR(i, 1, 25) {\n      if (i == 13 || i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define N 110\nusing namespace std;\nconst int INF = 1LL<<55;\nconst int mod = (1e9)+7;\nconst double EPS = 1e-8;\nconst double PI = 6.0 * asin(0.5);\ntemplate<class T> T Max(T &a,T b){return a=max(a,b);}\ntemplate<class T> T Min(T &a,T b){return a=min(a,b);}\nvector<vector<int> >D;\n\nsigned main(){\n  \n  while(1){\n    int n;\n    cin>>n;\n    if(!n) break;\n    D.clear(); D.resize(25);\n    for(int i=0;i<25;i++) D[i].resize(i,0);\n    \n    for(int i=0;i<n;i++){\n      int d,t;\n      cin>>d>>t;\n      for(int j=0,a;j<d;j++) cin>>a, D[d][(j-t+d)%d]+=a;\n    }\n    \n    vector<vector<int> > dp(N);\n    dp[1].push_back(0);\n    for(int i=1;i<=24;i++){\n      int d = dp[i].size();\n      if(i == 13 || i == 17 || i == 19 || i == 23) {\n        int mx = 0;\n        for(int j=0;j<i;j++) Max(mx,D[i][j]);\n        dp[i+1].resize(d);\n        for(int j=0;j<d;j++) dp[i+1][j] = dp[i][j] + mx;\n        continue;\n      }\n      int lcm = d * i / __gcd(d,i);\n      dp[i+1].resize(lcm);\n      for(int j=0;j<lcm;j++) dp[i+1][j] = dp[i][j%d] + D[i][j%i];\n    }\n    int ans = 0;\n    for(int a:dp[25]) Max(ans,a);\n    cout<<ans<<endl;\n  }  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\n\n// 2 3 5 7 11 13 17 19 23\n// 13 17 19 23\n\nbool use[101];\nvector<ll> volume[101];\nint current_time[101];\nvector<ll> buf[101];\nint pm[4] = {13,17,19,23};\n\nint main(){\n  int N;\n  while( cin >> N, N ) {\n  ll lcm = 1;\n    rep(i,N) {\n      use[i] = false;\n      volume[i].clear();\n      buf[i].clear();\n    }\n    rep(i,N){\n      int size;\n      cin >> size;\n      volume[i].resize(size);\n      cin >> current_time[i];\n      rep(j,size) cin >> volume[i][j];\n      if( size != 13 && size != 17 && size != 19 && size != 23 ) {\n        lcm = lcm / __gcd(lcm,(ll)size) * (ll)size;\n        use[i] = true;\n      } else {\n        if( buf[size].empty() ) buf[size].resize(size,0);\n        rep(j,size) {\n          buf[size][j] += volume[i][(current_time[i]+j)%size];\n        }\n      }\n    }\n    ll maxi = 0;\n    for(ll i=0;i<lcm;i++){\n      ll maxi_sub = 0;\n      rep(j,N) if( use[j] ){\n        maxi_sub += volume[j][current_time[j]];\n        ( current_time[j] += 1 ) %= (int)volume[j].size();\n      }\n      maxi = max(maxi,maxi_sub);\n    }\n    rep(i,4) {\n      ll maxi_sub = 0;\n      rep(j,buf[pm[i]].size()) maxi_sub = max(maxi_sub,buf[pm[i]][j]);\n      maxi += maxi_sub;\n    }\n    cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define llint long long\n\nusing namespace std;\n\nllint N;\nllint data[25][25];\nllint array[60000];\nllint p[] = {13, 17, 19, 23};\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> N;\n\t\tif(N == 0) break;\n\t\t\n\t\tfor(int i = 1; i <= 24; i++){\n\t\t\tfor(int j = 0; j <= 24; j++){\n\t\t\t\tdata[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 60000; i++) array[i] = 0;\n\t\t\n\t\tllint d, t, q[25];\n\t\tfor(int i = 1; i <= N; i++){\n\t\t\tcin >> d >> t;\n\t\t\tfor(int j = 0; j < d; j++) cin >> q[j];\n\t\t\tfor(int j = 0; j < d; j++) data[d][j] += q[(j+t)%d];\n\t\t}\n\t\t\n\t\tfor(int i = 1; i <= 24; i++){\n\t\t\tfor(int j = 0; j < 4; j++) if(i == p[i]) goto pass;\n\t\t\tfor(int j = 0; j < 60000; j++) array[j] += data[i][j%i];\n\t\t\tpass:;\n\t\t}\n\t\t\n\t\tllint ans = 0;\n\t\tfor(int i = 0; i < 60000; i++) ans = max(ans, array[i]);\n\t\tfor(int i = 0; i < 4; i++){\n\t\t\tllint tmp = 0;\n\t\t\tfor(int j = 0; j < p[i]; j++) tmp = max(tmp, data[p[i]][j]);\n\t\t\tans += tmp;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n//#include <bits/stdc++.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PI;\n#define EPS (1e-6)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define min3(a,b,c) min((a),min((b),(c)))\n#define min4(a,b,c,d) min((a),min3((b),(c),(d)))\n#define SZ(a) (int)((a).size())\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) a.rbegin(),a.rend()\n#define FLL(a,b) memset((a),b,sizeof(a))\n#define CLR(a) memset((a),0,sizeof(a))\n#define declare(a,it) __typeof(a) it=(a)\n#define FOR(it,a) for(declare(a.begin(),it);it!=a.end();++it)\n#define FORR(it,a) for(declare(a.rbegin(),it);it!=a.rend();++it)\n\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, const pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, const vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\ntypedef double FP;\ntypedef complex<FP> pt;\ntypedef pt P;\ntypedef pair<pt,pt> line;\nnamespace std{\n  bool operator<(const P&a,const P&b){\n    if(abs(a.real()-b.real())>EPS)\n      return a.real()<b.real();\n    return a.imag()<b.imag();\n  }\n}\nFP dot(P a,P b){return real(conj(a)*b);}\nFP crs(P a,P b){return imag(conj(a)*b);}\nP ortho(P a){return P(imag(a),-real(a));}\nP ortho(line a){return ortho(a.S-a.F);}\nP crspt(P a,P b,P c,P d){b-=a,d-=c;return a+b*crs(d,c-a)/crs(d,b);}\nP crspt(line a,line b){return crspt(a.F,a.S,b.F,b.S);}\nbool onl(P a1,P a2,P b){return abs(b-a1)+abs(b-a2)<abs(a1-a2)+EPS;}\nbool onl(line a,P b){return onl(a.F,a.S,b);}\nbool iscrs(line a,line b){P c=crspt(a,b);return onl(a,c)&&onl(b,c);}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\nenum{TOP,BTM,LFT,RGT,FRT,BCK};\nint dxdy2ce[]={RGT,FRT,LFT,BCK};\nint s2i(string& a){stringstream ss(a);int r;ss>>r;return r;}\ntemplate<class T> T shift(T a,int b,int c,int d,int e){\n  __typeof(a[0])t=a[b];\n  a[b]=a[c];a[c]=a[d];a[d]=a[e];a[e]=t;return a;}\ntemplate<class T> T rgt(T a){return shift(a,TOP,LFT,BTM,RGT);}\ntemplate<class T> T lft(T a){return shift(a,TOP,RGT,BTM,LFT);}\ntemplate<class T> T frt(T a){return shift(a,TOP,BCK,BTM,FRT);}\ntemplate<class T> T bck(T a){return shift(a,TOP,FRT,BTM,BCK);}\nline mkl(P a,P v){return line(a,a+v);}\nFP lpdist(line a,P b){return abs(b-crspt(a,mkl(b,ortho(a))));}\nFP spdist(line a,P b){\n  P c(crspt(a,mkl(b,ortho(a))));\n  return onl(a,c)?abs(b-c):min(abs(a.F-b),abs(a.S-b));\n}\nFP ssdist(line a,line b){\n  return\n    iscrs(a,b)?0.:\n    min4(spdist(a,b.F),spdist(a,b.S),\n         spdist(b,a.F),spdist(b,a.S));\n}\n\nint n;\n\nvoid solve(){\n  vector<vector<int> > app(n);\n  vector<vector<int> > app2(n);\n  vector<int> ti(n);\n  \n  \n  int lcm = 1;\n  int lcm2 = 1;\n  rep(i,n){\n    int d,t;\n    cin >> d >> t;\n    ti[i] = t;\n    vector<int> q(d);\n    rep(j,d) cin >> q[j];\n    if(d==13 || d==17 || d==19 || d==23){\n      app2[i]=q;\n      lcm2 = lcm2/__gcd(lcm2,d)*d;\n    }else{\n      app[i]=q;\n      lcm = lcm/__gcd(lcm,d)*d;      \n    }\n  }\n  \n  vector<ll> su(lcm);\n  \n  //cout << lcm << endl;\n  rep(i,n)\n    if(!app[i].empty())\n      rep(j,lcm)\n        su[j] += app[i][(j+ti[i])%SZ(app[i])];\n  \n  vector<ll> maxs(lcm2);\n  \n  rep(i,max(lcm,lcm2)) \n    maxs[i%lcm2] = max(maxs[i%lcm2],su[i%lcm]);\n  \n  rep(i,n)\n    if(!app2[i].empty())\n      rep(j,lcm2)\n        maxs[j] += app2[i][(j+ti[i])%SZ(app2[i])];  \n  \n  cout << *max_element(ALL(maxs)) << endl;\n}\n\nint main(int argc, char *argv[])\n{\n  // vector<int> a;\n  // a[0]=1;\n  while(cin >> n,n) solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<ll> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\nvoid extgcd(ll a, ll b, ll& x, ll& y)\n{\n\tif (b != 0) { extgcd(b, a % b, y, x); y -= a / b * x; }\n\telse { x = 1; y = 0; }\n}\n\n\nint main()\n{\n\tcin.sync_with_stdio(false);\n\tint lcma = 1, lcmb = 1;\n\tFOR(i, 1, 24)\n\t{\n\t\tif (i == 13 || i == 17 || i == 19 || i == 23)\n\t\t{\n\t\t\tlcmb = lcm(lcmb, i);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlcma = lcm(lcma, i);\n\t\t}\n\t}\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tvi a(lcma), b(lcmb);\n\t\tREP(i, n)\n\t\t{\n\t\t\tint d, t;\n\t\t\tcin >> d >> t;\n\t\t\tvi v(d);\n\t\t\tREP(i, d) cin >> v[i];\n\t\t\tif (d == 13 || d == 17 || d == 19 || d == 23)\n\t\t\t{\n\t\t\t\tREP(i, lcmb)\n\t\t\t\t{\n\t\t\t\t\tif (t == d) t = 0;\n\t\t\t\t\tb[i] += v[t];\n\t\t\t\t\tt++;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tREP(i, lcma)\n\t\t\t\t{\n\t\t\t\t\tif (t == d) t = 0;\n\t\t\t\t\ta[i] += v[t];\n\t\t\t\t\tt++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << *max_element(ALL(a)) + *max_element(ALL(b)) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\nvoid extgcd(ll a, ll b, ll& x, ll& y)\n{\n\tif (b != 0) { extgcd(b, a % b, y, x); y -= a / b * x; }\n\telse { x = 1; y = 0; }\n}\n\n\nint main()\n{\n\tcin.sync_with_stdio(false);\n\tint lcma = 1, lcmb = 1;\n\tFOR(i, 1, 24)\n\t{\n\t\tif (i == 13 || i == 17 || i == 19 || i == 23)\n\t\t{\n\t\t\tlcmb = lcm(lcmb, i);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlcma = lcm(lcma, i);\n\t\t}\n\t}\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tvi a(lcma), b(lcmb);\n\t\tREP(i, n)\n\t\t{\n\t\t\tint d, t;\n\t\t\tcin >> d >> t;\n\t\t\tvi v(d);\n\t\t\tREP(i, d) cin >> v[i];\n\t\t\tif (d == 13 || d == 17 || d == 19 || d == 23)\n\t\t\t{\n\t\t\t\tif (t == d) t = 0;\n\t\t\t\tb[i] += v[t];\n\t\t\t\tt++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tREP(i, lcma)\n\t\t\t\t{\n\t\t\t\t\tif (t == d) t = 0;\n\t\t\t\t\ta[i] += v[t];\n\t\t\t\t\tt++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << *max_element(ALL(a)) + *max_element(ALL(b)) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint N, d, t, q;\n\nconst int L = 16 * 9 * 5 * 7 * 11;\n\nint main() {\n\n\twhile ( cin >> N && N ) {\n\t\n\t\tint Q[25][25] = {{0}};\n\n\t\tfor ( int i = 0; i < N; i++ ) {\n\n\t\t\tcin >> d >> t;\n\n\t\t\tfor ( int j = 0; j < d; j++ ) {\n\n\t\t\t\tcin >> q;\n\t\t\t\tQ[d][( j + d - t ) % d] += q;\n\n\t\t\t}\n\n\t\t}\n\n\t\tint sum = 0, T[L] = {0};\n\n\t\tfor ( int d = 1; d <= 24; d++ ) {\n\n\t\t\tif ( d == 13 || d == 17 || d == 19 || d == 23 || d == 1 ) {\n\n\t\t\t\tint max = 0;\n\n\t\t\t\tfor ( int i = 0; i < d; i++ ) {\n\n\t\t\t\t\tif ( max < Q[d][i] ) { max = Q[d][i]; }\n\n\t\t\t\t}\n\n\t\t\t\tsum += max;\n\n\t\t\t} else {\n\n\t\t\t\tfor ( int i = 0; i < L; i++ ) { T[i] += Q[d][i % d]; }\n\n\t\t\t}\n\n\t\t}\n\n\t\tint max = 0;\n\n\t\tfor ( int i = 0; i < L; i++ ) {\n\n\t\t\tif ( max < T[i] ) { max = T[i]; }\n\n\t\t}\n\t\t\t\n\t\tcout << sum + max << endl;\n\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n\nusing namespace std;\n\nint gcd(int a, int b) { return b==0?a:gcd(b,a%b); }\nint lcm(int a, int b) { return a*b/gcd(a,b); }\n\nint main(){\n\tint n;\n\twhile(cin >> n, n){\n\t\tint size[100];\n\t\tvector<int> vol[100];\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint offset;\n\t\t\tcin >> size[i] >> offset;\n\t\t\tvol[i].resize(size[i]);\n\t\t\tfor(int j=0;j<size[i];j++) cin >> vol[i][(j+size[i]-offset)%size[i]];\n\t\t}\n\t\tint left = n;\n\t\tbool used[100];\n\t\tmemset(used, false, sizeof(used));\n\t\twhile(true){\n\t\t\tint prevsize = left;\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tif(used[i]) continue;\n\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\tif(i==j||used[j]) continue;\n\t\t\t\t\tint gd = lcm(size[i], size[j]);\n\t\t\t\t\tif(gd==size[i]*size[j]) continue;\n\t\t\t\t\tvector<int> vi;\n\t\t\t\t\tfor(int k=0;k<gd;k++)\n\t\t\t\t\t\tvi.push_back(vol[i][k%size[i]]+vol[j][k%size[j]]);\n\t\t\t\t\tsize[i] = gd;\n\t\t\t\t\tvol[i] = vi;\n\t\t\t\t\tused[j] = true;\n\t\t\t\t\tleft--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(prevsize == left) break;\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tif(used[i]) continue;\n\t\t\tint tmp = 0;\n\t\t\tfor(int j=0;j<size[i];j++) tmp = max(tmp, vol[i][j]);\n\t\t\tans += tmp;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<ll> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll gcd(ll a, ll b)\n{\n\tif (a < b) swap(a, b);\n\treturn (a%b ? gcd(a%b, b) : b);\n}\n\nll lcm(ll a, ll b)\n{\n\treturn a / gcd(a, b)*b;\n}\n\nvoid extgcd(ll a, ll b, ll& x, ll& y)\n{\n\tif (b != 0) { extgcd(b, a % b, y, x); y -= a / b * x; }\n\telse { x = 1; y = 0; }\n}\n\n\nint main()\n{\n\tcin.sync_with_stdio(false);\n\tint lcma = 1, lcmb = 1;\n\tFOR(i, 1, 24)\n\t{\n\t\tif (i == 13 || i == 17 || i == 19 || i == 23)\n\t\t{\n\t\t\tlcmb = lcm(lcmb, i);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlcma = lcm(lcma, i);\n\t\t}\n\t}\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tvi a(lcma), b(lcmb);\n\t\tREP(i, n)\n\t\t{\n\t\t\tint d, t;\n\t\t\tcin >> d >> t;\n\t\t\tvi v(d);\n\t\t\tREP(i, d) cin >> v[i];\n\t\t\tif (d == 13 || d == 17 || d == 19 || d == 23)\n\t\t\t{\n\t\t\t\tif (t == d) t = 0;\n\t\t\t\tb[i] += v[t];\n\t\t\t\tt++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tREP(i, lcma)\n\t\t\t\t{\n\t\t\t\t\tif (t == d) t = 0;\n\t\t\t\t\ta[i] += v[t];\n\t\t\t\t\tt++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << *max_element(ALL(a)) + *max_element(ALL(b)) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int C=55440;\nint sum[4][24];\nint lsum[C],table[4]={13,17,19,23};\n\nint main(){\n    int N;\n    for(;;){\n        scanf(\"%d\",&N);\n        if(N==0) break;\n        for(int i=0;i<4;i++){\n            fill(sum[i],sum[i]+24,0);\n        }\n        fill(lsum,lsum+C,0);\n        for(int i=0;i<N;i++){\n            int d,t;\n            scanf(\"%d%d\",&d,&t);\n            int now[24];\n            for(int j=0;j<d;j++){\n                scanf(\"%d\",&now[j]);\n            }\n            rotate(now,now+t,now+d);\n            if(find(table,end(table),d)!=end(table)){\n                int at=find(table,end(table),d)-table;\n                for(int j=0;j<d;j++){\n                    sum[at][j]+=now[j];\n                }\n            }else{\n                for(int j=0;j<C/d;j++){\n                    for(int k=0;k<d;k++){\n                        lsum[j*d+k]+=now[k];\n                    }\n                }\n            }\n        }\n        int ret=*max_element(lsum,lsum+C);\n        for(int j=0;j<4;j++){\n            ret+=*max_element(sum[j],sum[j]+table[j]);\n        }\n        printf(\"%d\\n\",ret);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nvector<int> sieve(int n) {\n  vector<int> p(n);\n  for(int i=2; i<n; i++) p[i]=i;\n  for(int i=2; i*i<n; i++) {\n    if(p[i]) {\n      for(int j=i*i; j<n; j+=i) p[j]=0;\n    }\n  }\n  return p;\n}\n\nint main() {\n  vector<int> p=sieve(25);\n  for(int i=1; i<13; i++) p[i]=0;\n  int z=1;\n  for(int i=1; i<25; i++) {\n    if(!p[i]) z=z*i/__gcd(i,z);\n  }\n  int n;\n  while(cin >> n && n) {\n    vector<vector<int> > v[25];\n    for(int i=0; i<n; i++) {\n      int m,t;\n      cin >> m >> t;\n      vector<int> a(m);\n      for(int j=0; j<m; j++) cin >> a[(j-t+m)%m];\n      v[m].push_back(a);\n    }\n    int ans=0;\n    for(int l=0; l<z; l++) {\n      int d=0;\n      for(int i=1; i<25; i++) {\n        if(p[i]) continue;\n        for(int j=0; j<v[i].size(); j++) d+=v[i][j][l%v[i][j].size()];\n      }\n      ans=max(ans,d);\n    }\n    for(int i=1; i<25; i++) {\n      if(!p[i]) continue;\n      int M=0;\n      for(int k=0; k<i; k++) {\n        int sum=0;\n        for(int j=0; j<v[i].size(); j++) sum+=v[i][j][k];\n        M=max(M,sum);\n      }\n      ans+=M;\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nconst int CYCLE = 2 * 2 * 2 * 2 * 3 * 3 * 5 * 7 * 11;\n\nint main(){\n  int N;\n  while(cin>>N && N){\n    int access[25][25] = {};\n    REP(i, N){\n      int cycle, offset; cin>>cycle>>offset;\n      REP(j, cycle){\n        int volume; cin>>volume;\n        access[cycle][(j - offset + cycle) % cycle] += volume;\n      }\n    }\n    vector<int> access_sum(CYCLE);\n    for(int cycle = 1; cycle <= 24; cycle++){\n      if(cycle == 13 || cycle == 17 || cycle == 19 || cycle == 23){\n        int max_a = 0;\n        REP(i, cycle) max_a = max(max_a, access[cycle][i]);\n        REP(i, CYCLE) access_sum[i] += max_a;\n      }else{\n        int idx = 0;\n        REP(i, CYCLE){\n          access_sum[i] += access[cycle][idx];\n          idx = (idx + 1) % cycle;\n        }\n      }\n    }\n    cout<<*max_element(access_sum.begin(), access_sum.end())<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int N;cin>>N,N;){\n    const int C=55440;\n    int a[C]={};\n    while(N--){\n      int d,t;\n      cin>>d>>t;\n      int q[24];\n      int m=0;\n      for(int i=0;i<d;i++){\n\tcin>>q[i];\n\tm=max(m,q[i]);\n      }\n      for(int i=0;i<C;i++){\n\ta[i]+=(C%d)?m:q[(i+t)%d];\n      }\n    }\n    cout<<*max_element(begin(a),end(a))<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nconst int loop=2*2*2*2*3*3*5*7*11;\nint n;\nint d[101],t[101],q[101][25];\nint all[loop];\nvoid solve(){\n\tint res=0;\n\tmemset(all,0,sizeof(all));\n\tfor(int i=0;i<n;i++){\n\t\tif(loop%d[i]==0){\n\t\t\tfor(int j=0;j<loop;j++){\n\t\t\t\tall[j]+=q[i][(j+t[i])%d[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tint maxi=0;\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tmaxi=max(q[i][j],maxi);\n\t\t\t}\n\t\t\tres+=maxi;\n\t\t}\n\t}\n\tint maxi=0;\n\tfor(int i=0;i<loop;i++){\n\t\tmaxi=max(maxi,all[i]);\n\t}\n\tprintf(\"%d\\n\",maxi+res);\n}\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%d%d\",&d[i],&t[i]);\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tscanf(\"%d\",&q[i][j]);\n\t\t\t}\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 101;\n\nint N;\nvector<vector<int> > q;\n\nint lcm(int a, int b) {\n  return a * b / __gcd(a, b);\n}\n\nint main() {\n  while(cin >> N && N) {\n    q.clear();\n    vector<int> a(13), b(17), c(19), d(23);\n    for(int i = 0; i < N; ++i) {\n      int s, t; cin >> s >> t;\n      vector<int> v(s);\n      for(int j = 0; j < s; ++j) cin >> v[(j-t+s)%s];\n      if(s == 13) for(int j = 0; j < 13; ++j) a[j] += v[j];\n      else if(s == 17) for(int j = 0; j < 17; ++j) b[j] += v[j];\n      else if(s == 19) for(int j = 0; j < 19; ++j) c[j] += v[j];\n      else if(s == 23) for(int j = 0; j < 23; ++j) d[j] += v[j];\n      else q.push_back(v);\n    }\n    int T = 1;\n    for(int i = 0; i < q.size(); ++i) {\n      T = lcm(T, q[i].size());\n    }\n    int res = 0;\n    for(int t = 0; t < T; ++t) {\n      int sum = 0;\n      for(int i = 0; i < q.size(); ++i) {\n\tsum += q[i][t%q[i].size()];\n      }\n      res = max(res, sum);\n    }\n    res += *max_element(a.begin(), a.end());\n    res += *max_element(b.begin(), b.end());\n    res += *max_element(c.begin(), c.end());\n    res += *max_element(d.begin(), d.end());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) {a = b; return true;}\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if(a > b) {a = b; return true;}\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if(i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T, typename U>\nostream &operator<<(ostream &os, const map<T,U> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \"; a = 1;\n        os << tp.first << \":\" << tp.second;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    const int MAX = 24;\n\n    for (;;) {\n        int N; cin >> N;\n        if (N == 0) break;\n        vector<vector<ll>> sum(MAX);\n        FOR(i, 1, MAX+1) {\n            sum[i-1].resize(i);\n        }\n        REP(i, N) {\n            int d, t; cin >> d >> t;\n            REP(j, d) {\n                ll q; cin >> q;\n                sum[d-1][(j + d - t) % d] += q;\n            }\n        }\n        // REP(d, MAX) DEBUG(sum[d]);\n\n        int LCM = 1;\n        FOR(i, 1, MAX) {\n            if (i == 13 or i == 17 or i == 19 or i == 23) continue;\n            LCM = LCM / __gcd(LCM, i) * i;\n        }\n\n        ll ans = 0;\n\n        REP(k, LCM) {\n            ll s = 0;\n            FOR(i, 1, MAX+1) {\n                if (i == 13 or i == 17 or i == 19 or i == 23) continue;\n                s += sum[i-1][k % i];\n            }\n            chmax(ans, s);\n        }\n\n        for (int i : {13, 17, 19, 23}) {\n            ans += *max_element(ALL(sum[i-1]));\n        }\n\n        // DEBUG(ans);\n        cout << ans << endl;\n\n    }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(x) (x).begin(),(x).end()\n#define YES() printf(\"YES\\n\")\n#define NO() printf(\"NO\\n\")\n#define isYES(x) printf(\"%s\\n\",(x) ? \"YES\" : \"NO\")\n#define Yes() printf(\"Yes\\n\")\n#define No() printf(\"No\\n\")\n#define isYes(x) printf(\"%s\\n\",(x) ? \"Yes\" : \"No\")\n#define isIn(x,y,h,w) (x >= 0 && x < h && y >= 0 && y < w)\n\n#define int long long\n//using ll = long long;\nusing P = pair<int,int>;\n\nostream &operator<<(ostream &os,const P &p){ return os << \"(\" << p.first << \",\" << p.second << \")\"; }\n\ntemplate<class T> T &chmin(T &a,const T &b){ return a = min(a,b); }\ntemplate<class T> T &chmax(T &a,const T &b){ return a = max(a,b); }\n \nconst int INF=1e+18;\nconst double EPS=1e-9;\nconst int MOD=1000000007;\n\nconst int dx[]={1,0,-1,0},dy[]={0,-1,0,1};\n\ntemplate<class T> T gcd(T a,T b){ return b ? gcd(b,a % b) : a; }\ntemplate<class T> T lcm(T a,T b){ return a / gcd(a,b) * b; }\n\ninline bool isSkip(int x){\n\treturn x == 13 || x == 17 || x == 19 || x == 23;\n}\n\nint n;\n\nvoid solve(){\n\tint q[30][30] = {};\n\tfor(int i = 0;i < n;i++){\n\t\tint d,t,p[30];\n\t\tcin >> d >> t;\n\t\tfor(int j = 0;j < d;j++){\n\t\t\tcin >> p[j];\n\t\t\tq[d][(t - j + d) % d] += p[j];\n\t\t}\n\t}\n\tint ans = q[1][0],l = 1;\n\tfor(int i = 2;i <= 24;i++){\n\t\tif(isSkip(i)){\n\t\t\tint ma = 0;\n\t\t\tfor(int j = 0;j < i;j++) chmax(ma,q[i][j]);\n\t\t\tans += ma;\n\t\t}else l = lcm(l,i);\n\t}\n\tint ma = 0;\n\tfor(int i = 0;i < l;i++){\n\t\tint sum = 0;\n\t\tfor(int j = 2;j <= 24;j++){\n\t\t\tif(!isSkip(j)) sum += q[j][i % j];\n\t\t}\n\t\tchmax(ma,sum);\n\t}\n\tans += ma;\n\tcout << ans << endl;\n}\n\nsigned main(){\n\twhile(cin >> n,n) solve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nconst int CYCLE = 2 * 2 * 2 * 3 * 3 * 5 * 7 * 11;\n\nint main(){\n  int N;\n  while(cin>>N && N){\n    int access[25][25] = {};\n    REP(i, N){\n      int cycle, offset; cin>>cycle>>offset;\n      REP(j, cycle){\n        int volume; cin>>volume;\n        access[cycle][(j - offset + cycle) % cycle] += volume;\n      }\n    }\n    vector<int> access_sum(CYCLE);\n    for(int cycle = 1; cycle <= 24; cycle++){\n      if(cycle == 11 || cycle == 13 || cycle == 17 || cycle == 23){\n        int max_a = 0;\n        REP(i, cycle) max_a = max(max_a, access[cycle][i]);\n        REP(i, CYCLE) access_sum[i] += max_a;\n      }else{\n        int idx = 0;\n        REP(i, CYCLE){\n          access_sum[i] += access[cycle][idx];\n          idx = (idx + 1) % cycle;\n        }\n      }\n    }\n    cout<<*max_element(access_sum.begin(), access_sum.end())<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint main(){\n\twhile(true){\n\t\tint N;\n\t\tint a[25][25]={};\n\t\tcin>>N;\n\t\tif(N==0) break;\n\t\trep(i,N){\n\t\t\tint d,t;\n\t\t\tcin>>d>>t;\n\t\t\trep(j,d){\n\t\t\t\tint x;\n\t\t\t\tcin>>x;\n\t\t\t\ta[d][(t-j+d)%d]+=x;\n\t\t\t}\n\t\t}\n\t\tint mx=0;\n\t\trep(i,55440){\n\t\t\tint tmp=0;\n\t\t\trep1(j,24){\n\t\t\t\tif(j==13||j==17||j==19||j==23) continue;\n\t\t\t\ttmp+=a[j][i%j];\n\t\t\t}\n\t\t\tchmax(mx,tmp);\n\t\t}\n\t\tint b[4]={13,17,19,23};\n\t\trep(i,4){\n\t\t\tint c=b[i];\n\t\t\tint m=0;\n\t\t\trep(j,c) chmax(m,a[c][j]);\n\t\t\tmx+=m;\n\t\t}\n\t\tcout<<mx<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint gcd(int a,int b){\n\twhile(a){\n\t\tb%=a;\n\t\tint c=b;\n\t\tb=a;\n\t\ta=c;\n\t}\n\treturn b;\n}\nint lcm(int a,int b){\n\treturn a/gcd(a,b)*b;\n}\nint q[100][100];\nint t[100000];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<100000;i++)t[i]=0;\n\t\tfor(int i=0;i<100;i++)\n\t\t\tfor(int j=0;j<100;j++)\n\t\t\t\tq[i][j]=0;\n\t\tfor(int i=0;i<a;i++){\n\t\t\tint b,c;\n\t\t\tscanf(\"%d%d\",&b,&c);\n\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\tint d;\n\t\t\t\tscanf(\"%d\",&d);\n\t\t\t\tq[b][(j+b-c)%b]+=d;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<55440;i++){\n\t\t\tfor(int j=1;j<=24;j++){\n\t\t\t\tif(j==13)continue;\n\t\t\t\tif(j==17)continue;\n\t\t\t\tif(j==19)continue;\n\t\t\t\tif(j==23)continue;\n\t\t\t\tt[i]+=q[j][i%j];\n\t\t\t}\n\t\t}\n\t\tint f=0;\n\t\tint g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[13][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[17][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[19][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tg=max(g,q[23][i]);\n\t\t}f+=g;g=0;\n\t\tfor(int i=0;i<55440;i++){\n\t\t\tg=max(g,t[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",f+g);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(cycle, 0);\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    MEMSET(total, 0);\n    FOR(i, 1, 25) {\n      if (i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N;\nint s[25][25];\nint t[60000];\nint u[25];\nint lc;\nbool flg[100];\n\nint main(){\n  flg[1]=flg[13]=flg[17]=flg[19]=flg[23]=true;\n  \n  while(1){\n    cin>>N;\n    if(N==0)break;\n    memset(s,0,sizeof(s));\n    memset(t,0,sizeof(t));\n    memset(u,0,sizeof(u));\n    lc=1;\n    for(int i=0;i<N;i++){\n      int a,b,c;\n      cin>>a>>b;\n      if(!flg[a])lc = lc/__gcd(lc,a)*a;\n      for(int j=0;j<a;j++){\n        cin>>c;\n        s[a][(j-b%a+a)%a]+=c;\n        if(flg[a])u[a]=max(u[a],s[a][(j-b%a+a)%a]);\n      }\n    }\n    int ans=0,ans2=0;\n    for(int i=1;i<=24;i++){\n      if(flg[i])ans+=u[i];\n      else for(int j=0;j<lc;j++)t[j]+=s[i][j%i];\n    }\n    for(int i=0;i<lc;i++)ans2=max(ans2,t[i]);\n    cout<<ans+ans2<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _GLIBCXX_DEBUG\n//#include <bits/stdc++.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PI;\n#define EPS (1e-6)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define min3(a,b,c) min((a),min((b),(c)))\n#define min4(a,b,c,d) min((a),min3((b),(c),(d)))\n#define SZ(a) (int)((a).size())\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) a.rbegin(),a.rend()\n#define FLL(a,b) memset((a),b,sizeof(a))\n#define CLR(a) memset((a),0,sizeof(a))\n#define declare(a,it) __typeof(a) it=(a)\n#define FOR(it,a) for(declare(a.begin(),it);it!=a.end();++it)\n#define FORR(it,a) for(declare(a.rbegin(),it);it!=a.rend();++it)\n\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, const pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, const vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\ntypedef double FP;\ntypedef complex<FP> pt;\ntypedef pt P;\ntypedef pair<pt,pt> line;\nnamespace std{\n  bool operator<(const P&a,const P&b){\n    if(abs(a.real()-b.real())>EPS)\n      return a.real()<b.real();\n    return a.imag()<b.imag();\n  }\n}\nFP dot(P a,P b){return real(conj(a)*b);}\nFP crs(P a,P b){return imag(conj(a)*b);}\nP ortho(P a){return P(imag(a),-real(a));}\nP ortho(line a){return ortho(a.S-a.F);}\nP crspt(P a,P b,P c,P d){b-=a,d-=c;return a+b*crs(d,c-a)/crs(d,b);}\nP crspt(line a,line b){return crspt(a.F,a.S,b.F,b.S);}\nbool onl(P a1,P a2,P b){return abs(b-a1)+abs(b-a2)<abs(a1-a2)+EPS;}\nbool onl(line a,P b){return onl(a.F,a.S,b);}\nbool iscrs(line a,line b){P c=crspt(a,b);return onl(a,c)&&onl(b,c);}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\nenum{TOP,BTM,LFT,RGT,FRT,BCK};\nint dxdy2ce[]={RGT,FRT,LFT,BCK};\nint s2i(string& a){stringstream ss(a);int r;ss>>r;return r;}\ntemplate<class T> T shift(T a,int b,int c,int d,int e){\n  __typeof(a[0])t=a[b];\n  a[b]=a[c];a[c]=a[d];a[d]=a[e];a[e]=t;return a;}\ntemplate<class T> T rgt(T a){return shift(a,TOP,LFT,BTM,RGT);}\ntemplate<class T> T lft(T a){return shift(a,TOP,RGT,BTM,LFT);}\ntemplate<class T> T frt(T a){return shift(a,TOP,BCK,BTM,FRT);}\ntemplate<class T> T bck(T a){return shift(a,TOP,FRT,BTM,BCK);}\nline mkl(P a,P v){return line(a,a+v);}\nFP lpdist(line a,P b){return abs(b-crspt(a,mkl(b,ortho(a))));}\nFP spdist(line a,P b){\n  P c(crspt(a,mkl(b,ortho(a))));\n  return onl(a,c)?abs(b-c):min(abs(a.F-b),abs(a.S-b));\n}\nFP ssdist(line a,line b){\n  return\n    iscrs(a,b)?0.:\n    min4(spdist(a,b.F),spdist(a,b.S),\n         spdist(b,a.F),spdist(b,a.S));\n}\n\nint n;\n\nvoid solve(){\n  vector<vector<int> > app(n);\n  vector<vector<int> > app2(n);\n  vector<int> ti(n);\n  \n  \n  int lcm = 1;\n  int lcm2 = 1;\n  rep(i,n){\n    int d,t;\n    cin >> d >> t;\n    ti[i] = t;\n    vector<int> q(d);\n    rep(j,d) cin >> q[j];\n    if(d==13 || d==17 || d==19 || d==23){\n      app2[i]=q;\n      lcm2 = lcm2/__gcd(lcm2,d)*d;\n    }else{\n      app[i]=q;\n      lcm = lcm/__gcd(lcm,d)*d;      \n    }\n  }\n  \n  vector<int> su(lcm);\n  \n  //cout << lcm << endl;\n  rep(i,n)\n    if(!app[i].empty())\n      rep(j,lcm)\n        su[j] += app[i][(j+ti[i])%SZ(app[i])];\n  \n  vector<int> maxs(lcm2);\n  \n  rep(i,max(lcm,lcm2)) \n    maxs[i%lcm2] = max(maxs[i%lcm2],su[i%lcm]);\n  \n  rep(i,n)\n    if(!app2[i].empty())\n      rep(j,lcm2)\n        maxs[j] += app2[i][(j+ti[i])%SZ(app2[i])];  \n  \n  cout << *max_element(ALL(maxs)) << endl;\n}\n\nint main(int argc, char *argv[])\n{\n  // vector<int> a;\n  // a[0]=1;\n  while(cin >> n,n) solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <bitset>\n\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n    int N;\n    cin >> N;\n    \n    int q[100][24] = {0};\n    int d[100] = {0};\n    \n    for(int i=0; i<N; ++i){\n        int t;\n        cin >> d[i] >> t;\n        for(int j=0; j<d[i]; ++j){\n            cin >> q[i][(j + d[i] - t)%d[i]];\n        }\n    }\n    \n    const int M = 2*2*2*2*3*3*5*7*11;\n    ll sum[M] = {0};\n    ll sum13[13] = {0};\n    ll sum17[17] = {0};\n    ll sum19[19] = {0};\n    ll sum23[23] = {0};\n    \n    for(int i=0; i<N; ++i){\n        switch(d[i]){\n            case 13:for(int j=0; j<13; ++j){sum13[j] += q[i][j];}break;\n            case 17:for(int j=0; j<17; ++j){sum17[j] += q[i][j];}break;\n            case 19:for(int j=0; j<19; ++j){sum19[j] += q[i][j];}break;\n            case 23:for(int j=0; j<23; ++j){sum23[j] += q[i][j];}break;\n            default:{\n                int cnt=0;\n                while(cnt != M){\n                    for(int j=0; j<d[i]; ++j){\n                        sum[cnt] += q[i][j];\n                        ++cnt;\n                    }\n                }\n            }break;\n        }\n    }\n    ll maxSum = 0, maxSum13 = 0, maxSum17 = 0, maxSum19 = 0, maxSum23 = 0;\n    for(int j=0; j<13; ++j){maxSum13 = max(maxSum13, sum13[j]);}\n    for(int j=0; j<17; ++j){maxSum17 = max(maxSum17, sum17[j]);}\n    for(int j=0; j<19; ++j){maxSum19 = max(maxSum19, sum19[j]);}\n    for(int j=0; j<23; ++j){maxSum23 = max(maxSum23, sum23[j]);}\n    for(int j=0; j<M; ++j){maxSum = max(maxSum, sum[j]);}\n    \n    cout << (maxSum + maxSum13 + maxSum17 + maxSum19 + maxSum23) << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n\n#include <iostream>\n#include <complex>\n#include <string>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n\n#include <functional>\n#include <cassert>\n\ntypedef long long ll;\nusing namespace std;\n\n#ifndef LOCAL\n#define debug(x) ;\n#else\n#define debug(x) cerr << __LINE__ << \" : \" << #x << \" = \" << (x) << endl;\n\ntemplate <typename T1, typename T2>\nostream &operator<<(ostream &out, const pair<T1, T2> &p) {\n  out << \"{\" << p.first << \", \" << p.second << \"}\";\n  return out;\n}\n\ntemplate <typename T>\nostream &operator<<(ostream &out, const vector<T> &v) {\n  out << '{';\n  for (const T &item : v) out << item << \", \";\n  out << \"\\b\\b}\";\n  return out;\n}\n#endif\n\n#define mod 1000000007 //1e9+7(prime number)\n#define INF 1000000000 //1e9\n#define LLINF 2000000000000000000LL //2e18\n#define SIZE 200010\n\n#define X 55440 // lcm({1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 20, 21, 22, 24})\n\nll sum[24][X];\n\nbool solve() {\n  int N;\n\n  cin >> N;\n  debug(N);\n\n  if (!N) return false;\n\n  memset(sum, 0, sizeof(sum));\n\n  for(int i=0; i<N; i++) {\n    int d, t, q[24], loop;\n\n    cin >> d >> t;\n\n    for(int j=0; j<d; j++)\n      cin >> q[(j+d-t) % d];\n\n    int id;\n\n    if (d == 13 || d == 17 || d == 19 || d == 23) {\n      id = d;\n      loop = d;\n    } else {\n      id = 0;\n      loop = X;\n    }\n\n    for (int j=0; j<loop; j++) {\n      sum[id][j] += q[j%d];\n    }\n  }\n\n  ll ans = 0;\n\n  for (int i=0; i<24; i++) {\n    ll maxVal = 0;\n    for (int j=0; j<X; j++)\n      maxVal = max(maxVal, sum[i][j]);\n    ans += maxVal;\n  }\n\n  cout << ans << endl;\n\n  return true;\n}\n\nint main(){\n\n  while(solve());\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\nusing namespace std;\n\ntypedef unsigned long long ullong;\n\nullong gcd(ullong a, ullong b){ return b==0?a: gcd(b, a%b);}\nullong lcm(ullong a, ullong b){ return a*(b/gcd(a, b));}\n\nbool isRP(int x){\n  if (  x == 13 || x == 17 || x == 19 || x == 23 ) return true;\n  return false;\n}\n\nmain(){\n  int N;\n  ullong D[100], S[100], T[100][24];\n  ullong lcm1, lcm2, max1, max2;\n\n  while(1){\n    cin >> N;\n    if ( N == 0 ) break;\n    lcm1 = lcm2 = 1;\n    max1 = max2 = 0;\n\n    for ( int i = 0; i < N; i++ ){\n      cin >> D[i] >> S[i];\n      assert( 0 <= S[i] && S[i] <= D[i]-1);\n      for ( int j = 0; j < D[i]; j++ ) cin >> T[i][j];\n      if ( isRP(D[i])) {\n\tlcm2 = lcm(lcm2, D[i]);\n      } else {\n\tlcm1 = lcm(lcm1, D[i]);\n      }\n    }\n\n    for ( int j = 0; j < lcm1; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max1 = max(max1, sum);\n    }\n\n    for ( int j = 0; j < lcm2; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( !isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max2 = max(max2, sum);\n    }\n\n    cout << max1 + max2 << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define all(v) (v).begin(), (v).end()\n#define resz(v, ...) (v).clear(), (v).resize(__VA_ARGS__)\n#define reps(i, m, n) for(int i = (int)(m); i < (int)(n); i++)\n#define rep(i, n) reps(i, 0, n)\n\ntemplate<class T1, class T2> void chmin(T1 &a, T2 b){if(a>b)a=b;}\ntemplate<class T1, class T2> void chmax(T1 &a, T2 b){if(a<b)a=b;}\n\ntypedef pair<int, int> Pi;\ntypedef tuple<int, int, int> Ti;\ntypedef vector<int> vint;\n\nconst int inf = 1LL << 55;\nconst int mod = 1e9 + 7;\n\nint N;\nvint d, t;\nvector<vint> q;\nint sum[60000];\nint psum[25][60000];\n\nint lcm(int a, int b) {\n  return a / __gcd(a, b) * b;\n}\n\nbool avoid(int a) {\n  return a==13||a==17||a==19||a==23;\n}\n\nsigned main()\n{\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  while(cin >> N, N) {\n    resz(d, N), resz(t, N), resz(q, N);\n    rep(i, N) {\n      cin >> d[i] >> t[i];\n      resz(q[i], d[i]);\n      rep(j, d[i]) cin >> q[i][j];\n    }\n    int LCM = 1;\n    rep(i, N) if(!avoid(d[i])) LCM = lcm(LCM, d[i]);\n    memset(sum, 0, sizeof(sum));\n    memset(psum, 0, sizeof(psum));\n    rep(i, N) {\n      if(avoid(d[i])) {\n\trep(j, d[i]) psum[d[i]][j] += q[i][(t[i]+j)%d[i]];\n      } else {\n\trep(j, LCM) sum[j] += q[i][(t[i]+j)%d[i]];\n      }\n    }\n    int ans = 0;\n    rep(i, LCM) chmax(ans, sum[i]);\n    int tmp = ans;\n    rep(i, N) if(avoid(d[i])) {\n      rep(j, d[i]) chmax(ans, tmp+psum[d[i]][j]);\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define llint long long\n\nusing namespace std;\n\nllint N;\nllint data[25][25];\nllint array[60000];\nllint p[] = {13, 17, 19, 23};\n\nint main(void)\n{\n\tcin >> N;\n\tllint d, t, q[25];\n\tfor(int i = 1; i <= N; i++){\n\t\tcin >> d >> t;\n\t\tfor(int j = 0; j < d; j++) cin >> q[j];\n\t\tfor(int j = 0; j < d; j++) data[d][j] += q[(j+t)%d];\n\t}\n\t\n\tfor(int i = 1; i <= 24; i++){\n\t\tfor(int j = 0; j < 4; j++) if(i == p[i]) goto pass;\n\t\tfor(int j = 0; j < 60000; j++) array[j] += data[i][j%i];\n\t\tpass:;\n\t}\n\t\n\tllint ans = 0;\n\tfor(int i = 0; i < 60000; i++) ans = max(ans, array[i]);\n\tfor(int i = 0; i < 4; i++){\n\t\tllint tmp = 0;\n\t\tfor(int j = 0; j < p[i]; j++) tmp = max(tmp, data[p[i]][j]);\n\t\tans += tmp;\n\t}\n\tcout << ans << endl;\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include <stack>\nusing namespace std;\nint gcd(int a,int b);\nbool bigprime(int a);\n\nint main(){\n\n  int n;\n  while(  cin >> n && n!=0){\n\n    int pdayh[n];\n    int npdayh[n];\n    int nowh[n];\n    int data[n][100];\n    int maxdata[n];\n    int minc=1;\n\n    int nprime[n];\n\n    int amari=1;\n    int temp;\n    int numnprime=0;\n    int numprime=0;\n    int day,now,inp;\n    for(int i=0;i<n;i++){\n      cin >> day >> now;\n      if(!bigprime(day)){\n\tamari*=day;\n\tminc=gcd(minc,day);\n\ttemp=numnprime;\n\tnumnprime++;\n\tpdayh[temp]=day;\n\tfor(int j=0;j<day;j++){\n\t  cin >> data[temp][(j+now)%day];\n\t}\n      }else{\n\ttemp=numprime;\n\tnumprime++;\n\tnpdayh[temp]=day;\n\tfor(int j=0;j<day;j++){\n\t  cin >> inp;\n\t  if(maxdata[temp]<inp){\n\t    maxdata[temp]=inp;\n\t  }\n\t}\n      }\n    }\n  \n    int maxinnprime=0;\n      temp=0;\n    for(int i=0;i<55400;i++){\n      for(int j=0;j<numnprime;j++){\n\ttemp+=data[j][i%pdayh[j]];\n      }\n    \n      if(maxinnprime<temp){\n\tmaxinnprime=temp;\n      }\n      temp=0;\n    }\n\n    int maxn=0;\n\n    for(int i=0;i<numprime;i++){\n      maxinnprime+=maxdata[i];\n    }\n  \n\n    cout << maxinnprime << endl;\n  }\n}\n\nint gcd(int a,int b){\n  if(a<b){\n    int t=a;\n    a=b;\n    b=t;\n  }\n\n  if(b==0){\n    return a;\n  }else{\n    return gcd(b,a%b);\n  }\n}\n\nbool bigprime(int a){\n  if(a==13||a==19||a==17||a==23){\n    return true;\n  }else{\n    return false;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include <stack>\nusing namespace std;\nint gcd(int a,int b);\nbool bigprime(int a);\n\nint main(){\n\n  int n;\n  while(  cin >> n && n!=0){\n\n  int dayh[n];\n  int nowh[n];\n  int data[n][100];\n\n  int minc=1;\n\n  int nprime[n];\n\n  int amari=1;\n\n  int numnprime=0;\n  for(int i=0;i<n;i++){\n    cin >> dayh[i] >> nowh[i];\n    if(!bigprime(dayh[i])){\n      amari*=dayh[i];\n      minc=gcd(minc,dayh[i]);\n      nprime[numnprime]=i;\n      numnprime++;\n    }\n    for(int j=0;j<dayh[i];j++){\n      cin >> data[i][j];\n    }\n  }\n  int maxinnprime=0;\n  int temp=0;\n  for(int i=0;i<55400;i++){\n    for(int j=0;j<numnprime;j++){\n      temp+=data[nprime[j]][(i+nowh[nprime[j]])%dayh[nprime[j]]];\n    }\n    if(maxinnprime<temp){\n      maxinnprime=temp;\n    }\n    temp=0;\n  }\n\n  int maxn=0;\n  cout << minc << endl; \n  for(int i=0;i<n;i++){\n    if(bigprime(dayh[i])){\n      for(int j=0;j<n;j++){\n\tif(maxn<data[i][j]){\n\t  maxn=data[i][j];\n\t}\n      }\n      maxinnprime+=maxn;\n    }\n  }\n\n  cout << maxinnprime << endl;\n  }\n}\n\nint gcd(int a,int b){\n  if(a<b){\n    int t=a;\n    a=b;\n    b=t;\n  }\n\n  if(b==0){\n    return a;\n  }else{\n    return gcd(b,a%b);\n  }\n}\n\nbool bigprime(int a){\n  if(a==13||a==19||a==17||a==23){\n    return true;\n  }else{\n    return false;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvector<int> vec={8,9,5,7};\nint solve(int n){\n    vector<int> d(n);\n    vector<vector<int>> q(n);\n    for(int i=0;i<n;i++){\n        cin>>d[i];\n        q[i].resize(d[i]);\n        int t;\n        cin>>t;\n        for(int j=0;j<d[i];j++){\n            cin>>q[i][(j+(d[i]-t))%d[i]];\n        }\n    }\n    vector<vector<int>> gcdv(25,vector<int>(25,0));\n    for(int i=0;i<25;i++){\n        for(int j=0;j<25;j++){\n            if(i!=0 && j!=0) gcdv[i][j]=__gcd(i,j);\n        }\n    }\n    vector<vector<int>> tq(24);\n    for(int i=0;i<24;i++){\n        tq[i].assign(i+1,0);\n    }\n    for(int i=0;i<n;i++){\n        if(d[i]==11) for(int j=0;j<d[i];j++) tq[21][j]+=q[i][j],tq[21][j+11]+=q[i][j];\n        else for(int j=0;j<d[i];j++) tq[d[i]-1][j]+=q[i][j];\n    }\n    int cnt=0;\n    auto calc=[&](vector<int> v){\n        int res=0;\n        for(int i=0;i<24;i++){\n            int sc=-1e9;\n            for(int j=0;j<i+1;j++){\n                bool isok=true;\n                for(int k=0;k<vec.size();k++){\n                    int g=gcdv[vec[k]][i+1];\n                    isok=isok && (v[k]%g==j%g);  \n                    cnt++;\n                }\n                if(isok) sc=max(sc,tq[i][j]);\n            }\n            res+=sc;\n        }\n        return res;\n    };\n    function<int(int,vector<int>)> dfs=[&](int idx,vector<int> v){\n        if(idx==vec.size()) return calc(v);\n        int res=0;\n        for(int i=0;i<vec[idx];i++){\n            v[idx]=i;\n            res=max(res,dfs(idx+1,v));\n        }\n        return res;\n    };\n    \n    vector<int> tmp(vec.size());\n    int ret=dfs(0,tmp);\n    return ret;\n}\nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n#define dbg(x) cout<<#x\" = \"<<((x))<<endl\ntemplate<class T,class U> ostream& operator<<(ostream& o, const pair<T,U> &p){o<<\"(\"<<p.fi<<\",\"<<p.se<<\")\";return o;}\ntemplate<class T> ostream& operator<<(ostream& o, const vector<T> &v){o<<\"[\";for(T t:v){o<<t<<\",\";}o<<\"]\";return o;}\n\nint lcm(int x, int y){\n    return x/__gcd(x,y)*y;\n}\n\nint main(){\n    set<int> bp;\n    for(int i:{13,17,19,23}) bp.insert(i);\n\n    int a = 1, b = 1;\n    for(int i=1; i<=24; ++i){\n        if(bp.count(i)) b = lcm(b,i);\n        else a = lcm(a,i);\n    }\n\n    int n;\n    while(cin >>n,n){\n        vector<int> A(a), B(b);\n\n        rep(i,n){\n            int d,t;\n            cin >>d >>t;\n\n            vector<int> x(d);\n            rep(j,d) cin >>x[j];\n\n            if(bp.count(d)){\n                rep(j,b) B[j] += x[(j+t)%d];\n            }\n            else{\n                rep(j,a) A[j] += x[(j+t)%d];\n            }\n        }\n\n        int maxA = 0, maxB = 0;\n        rep(i,a) maxA = max(maxA, A[i]);\n        rep(i,b) maxB = max(maxB, B[i]);\n        cout << maxA+maxB << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main() {\n    int N;\n    while (cin >> N, N) {\n        // Q[d][i] := d 周期の i 時間目の量（0 < i < d）\n        // 周期ごとにアクセス数をまとめる（t 時間のずれを吸収）\n        vector<vector<int>> Q(25, vector<int>(25, 0));\n        for (int i = 0; i < N; i++) {\n            int d, t; cin >> d >> t;\n            for (int j = 0; j < d; j++) {\n                int q; cin >> q;\n                Q[d][(j + d - t) % d] += q;\n            }\n        }\n        const int L = 55440;\n        vector<int> T(L, 0);\n        int cop = 0;\n        for (int i = 1; i <= 24; i++) {\n            if (i == 13 || i == 17 || i == 19 || i == 23) {\n                cop += *max_element(Q[i].begin(), Q[i].end());\n            } else {\n                for (int j = 0; j < L; j++) T[j] += Q[i][j % i];\n            }\n        }\n        cout << cop + *max_element(T.begin(), T.end()) << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define N 110\nusing namespace std;\nconst int INF = 1LL<<55;\nconst int mod = (1e9)+7;\nconst double EPS = 1e-8;\nconst double PI = 6.0 * asin(0.5);\ntemplate<class T> T Max(T &a,T b){return a=max(a,b);}\ntemplate<class T> T Min(T &a,T b){return a=min(a,b);}\nvector<vector<int> >D;\n\nsigned main(){\n  int n;\n  cin>>n;\n  D.clear(); D.resize(n+1);\n  for(int i=0;i<n;i++){\n    int d,t;\n    cin>>d>>t;\n    D[i].resize(d);\n    for(int j=0;j<d;j++) cin>>D[i][(j+t)%d];\n  }\n\n  typedef pair<int,int> P;\n  map<int,int> dp[N];\n  for(int i=0;i<(int)D[0].size();i++) dp[0][i] = D[0][i];\n\n  for(int i=0;i<n-1;i++){\n    int d = D[i].size();\n    int d2 = D[i+1].size();\n    for(P p:dp[i]){\n      int j = p.first;\n      int v = p.second;\n      vector<int> used(d2);\n      for(int k=0; k<d2;k++){\n        int J = (j + k)%d;\n        int K = (j + k)%d2;\n        //cout<<j<<\" \"<<k<<\" \"<<J<<\" \"<<K<<\" \"<<v + D[i+1][K]<<endl;\n        Max(dp[i+1][K], dp[i][J] + D[i+1][K]);\n      }\n    }\n  }\n    \n  int ans = 0;\n  for(int i=0;i<(int)D[n-1].size();i++) Max(ans,dp[n-1][i]);\n  cout<<ans<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main(){\n\tint N,d,t,q,i,j;\n\tfor(;cin>>N,N;){\n\t\tint Q[25][25] = {{0}}; // Q[d][i] d 周期の i 時間目の量 (0<=i<d)\n\t\tfor(i=0;i<N;++i){\n\t\t\tcin>>d>>t;\n\t\t\tfor(j=0;j<d;++j){\n\t\t\t\tcin>>q;\n\t\t\t\tQ[d][(j+d-t)%d]+=q;\n\t\t\t}\n\t\t}\n\t\tconst int L = 16*9*5*7*11;\n\t\tint sum = 0, T[L] = {0};\n\t\tfor(d=1;d<=24;++d){\n\t\t\tif(d==13||d==17||d==19||d==23||d==1)\n\t\t\t\tsum+=*max_element(Q[d],Q[d]+d);\n\t\t\telse\n\t\t\t\tfor(i=0;i<L;++i)T[i]+=Q[d][i%d];\n\t\t}\n\t\tcout << sum + *max_element(T,T+L) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int N;cin>>N,N;){\n    const int C=55440;\n    long long a[C]={};\n    while(N--){\n      int d,t;\n      cin>>d>>t;\n      int q[24];\n      int m=0;\n      for(int i=0;i<d;i++){\n\tcin>>q[i];\n\tm=max(m,q[i]);\n      }\n      for(int i=0;i<C;i++){\n\ta[i]+=(C%d)?m:q[(i+t)%d];\n      }\n    }\n    cout<<*max_element(begin(a),end(a))<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tint a[25][24]={};\n\t\trep(_,n){\n\t\t\tint m,t,q; scanf(\"%d%d\",&m,&t);\n\t\t\trep(i,m) scanf(\"%d\",&q), a[m][(i-t+m)%m]+=q;\n\t\t}\n\n\t\t// 55440 = LCM({1,2,...,24}\\{13,17,19,23})\n\t\tstatic int L[55440];\n\t\tmemset(L,0,sizeof L);\n\t\tfor(int m=1;m<=24;m++) if(m!=13 && m!=17 && m!=19 && m!=23) {\n\t\t\trep(j,55440) L[j]+=a[m][j%m];\n\t\t}\n\n\t\tint ans=*max_element(L,L+55440)\n\t\t\t   +*max_element(a[13],a[13]+13)\n\t\t\t   +*max_element(a[17],a[17]+17)\n\t\t\t   +*max_element(a[19],a[19]+19)\n\t\t\t   +*max_element(a[23],a[23]+23);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\n\n// 2 3 5 7 11 13 17 19 23\n// 13 17 19 23\n\nbool use[101];\nvector<ll> volume[101];\nint current_time[101];\nvector<ll> buf[101];\nint pm[4] = {13,17,19,23};\n\nint main(){\n  int N;\n  while( cin >> N, N ) {\n  ll lcm = 1;\n    rep(i,N) {\n      use[i] = false;\n      volume[i].clear();\n    }\n    rep(i,4) buf[pm[i]].clear();\n    rep(i,N){\n      int size;\n      cin >> size;\n      volume[i].resize(size);\n      cin >> current_time[i];\n      rep(j,size) cin >> volume[i][j];\n      if( size != 13 && size != 17 && size != 19 && size != 23 ) {\n        lcm = lcm / __gcd(lcm,(ll)size) * (ll)size;\n        use[i] = true;\n      } else {\n        if( buf[size].empty() ) buf[size].resize(size,0);\n        rep(j,size) {\n          buf[size][j] += volume[i][(current_time[i]+j)%size];\n        }\n      }\n    }\n    ll maxi = 0;\n    for(ll i=0;i<lcm;i++){\n      ll maxi_sub = 0;\n      rep(j,N) if( use[j] ){\n        maxi_sub += volume[j][current_time[j]];\n        ( current_time[j] += 1 ) %= (int)volume[j].size();\n      }\n      maxi = max(maxi,maxi_sub);\n    }\n    rep(i,4) {\n      ll maxi_sub = 0;\n      rep(j,buf[pm[i]].size()) maxi_sub = max(maxi_sub,buf[pm[i]][j]);\n      maxi += maxi_sub;\n    }\n    cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N;\nint s[25][25];\nint t[60000];\nint u[25];\nint lc;\nbool flg[100];\n\nint main(){\n  flg[1]=flg[13]=flg[17]=flg[19]=flg[23]=true;\n  \n  while(1){\n    cin>>N;\n    if(N==0)break;\n    memset(s,0,sizeof(s));\n    memset(t,0,sizeof(t));\n    memset(u,0,sizeof(u));\n    lc=1;\n    for(int i=0;i<N;i++){\n      int a,b,c;\n      cin>>a>>b;\n      if(!flg[a])lc = lc/__gcd(lc,a)*a;\n      for(int j=0;j<a;j++){\n        cin>>c;\n        s[a][(j-b%a+a)%a]+=c;\n        if(flg[a])u[a]=max(u[a],c);\n      }\n    }\n    int ans=0,ans2=0;\n    for(int i=2;i<=24;i++){\n      if(flg[i])ans+=u[i];\n      else for(int j=0;j<lc;j++)t[j]+=s[i][j%i];\n    }\n    for(int i=0;i<lc;i++)ans2=max(ans2,t[i]);\n    cout<<ans+ans2<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\n// 最大公約数\nlong long gcd(long long a, long long b){\n    while(b != 0){\n        long long tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\n// 最小公倍数\nlong long lcm(long long a, long long b){\n    return a / gcd(a, b) * b;\n}\n\nint main()\n{\n    const int prime[] = {13, 17, 19, 23};\n\n    long long a = 1;\n    for(int i=1; i<=24; ++i){\n        if(find(prime, prime+4, i) == prime+4)\n            a = lcm(a, i);\n    }\n\n    for(;;){\n        int n;\n        cin >> n;\n        if(n == 0)\n            return 0;\n\n        vector<int> t(n);\n        vector<vector<int> > q(n);\n        for(int i=0; i<n; ++i){\n            int d;\n            cin >> d >> t[i];\n            q[i].resize(d);\n            for(int j=0; j<d; ++j)\n                cin >> q[i][j];\n\n            if(find(prime, prime+4, d) != prime+4)\n                q[i].assign(1, *max_element(q[i].begin(), q[i].end()));\n        }\n\n        int ret = 0;\n        for(int i=0; i<a; ++i){\n            int sum = 0;\n            for(int j=0; j<n; ++j)\n                sum += q[j][(i+t[j])%q[j].size()];\n            ret = max(ret, sum);\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <numeric>\nusing namespace std;\n\nint main() {\n  for(int tci = 0; ; tci++) {\n    int N; scanf(\"%d\", &N); if(N==0) break;\n    int l13[13],l17[17],l19[19],l23[23],l[55440];\n    fill(l13,l13+13,0); fill(l17,l17+17,0);\n    fill(l19,l19+19,0); fill(l23,l23+23,0);\n    fill(l,l+55440,0);\n    int *ls[25], lens[25];\n    fill(ls+1,ls+25,(int*)l); ls[13]=l13,ls[17]=l17,ls[19]=l19,ls[23]=l23;\n    fill(lens+1,lens+25,55440); lens[13]=13,lens[17]=17,lens[19]=19,lens[23]=23;\n    for(int i = 0; i < N; i++) {\n      int d,t; scanf(\"%d%d\", &d, &t);\n      int q[24];\n      for(int j = 0; j < d; j++) scanf(\"%d\", q+j);\n      for(int j = 0; j < lens[d]; j++) {\n        ls[d][j] += q[(j+t)%d];\n      }\n    }\n    printf(\"%d\\n\",\n           accumulate(l13,l13+13,0,max<int>)+\n           accumulate(l17,l17+17,0,max<int>)+\n           accumulate(l19,l19+19,0,max<int>)+\n           accumulate(l23,l23+23,0,max<int>)+\n           accumulate(l,l+55440,0,max<int>));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nconst int loop=2*2*2*2*3*5*7*11;\nint n;\nint d[101],t[101],q[101][25];\nint all[loop];\nvoid solve(){\n\tint res=0;\n\tmemset(all,0,sizeof(all));\n\tfor(int i=0;i<n;i++){\n\t\tif(loop%d[i]==0){\n\t\t\tfor(int j=0;j<loop;j++){\n\t\t\t\tall[j]+=q[i][(j+t[i])%d[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tint maxi=0;\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tmaxi=max(q[i][j],maxi);\n\t\t\t}\n\t\t\tres+=maxi;\n\t\t}\n\t}\n\tint maxi=0;\n\tfor(int i=0;i<loop;i++){\n\t\tmaxi=max(maxi,all[i]);\n\t}\n\tprintf(\"%d\\n\",maxi+res);\n}\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%d%d\",&d[i],&t[i]);\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tscanf(\"%d\",&q[i][j]);\n\t\t\t}\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0,acc[tmax];\n\t\tmemset(acc,0,sizeof(acc));\n\t\trep(loop,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(i,d) cin >> q[i];\n\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(i,tmax){\n\t\t\t\t\tint cur=(i+t)%tmax;\n\t\t\t\t\tacc[cur]+=q[i%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#define L 16*9*5*7*11\nint Q[25][25]; // d周期のi時間目の量\nint T[L];\nint main(){\n\tint N,d,t,q;\n\tfor(;scanf(\"%d\",&N),N;){\n\t\tmemset(Q,0,sizeof(Q));\n\t\tfor(int i=0;i<N;++i){\n\t\t\tscanf(\"%d%d\",&d,&t);\n\t\t\tfor(int j=0;j<d;++j){\n\t\t\t\tscanf(\"%d\",&q);\n\t\t\t\tQ[d][(j+d-t)%d] += q;\n\t\t\t}\n\t\t}\n\t\tint sum=0;\n\t\tmemset(T,0,sizeof(T));\n\t\tfor(int d=1;d<=24;++d){\n\t\t\tif(d==13 || d==17 || d==19 || d==23 || d==1)\n\t\t\t\tsum+=*std::max_element(Q[d],Q[d]+d);\n\t\t\telse\n\t\t\t\tfor(int i=0;i<L;++i)T[i]+=Q[d][i%d];\n\t\t}\n\t\tprintf(\"%d\\n\",sum+*std::max_element(T,T+L));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 55440;\n\nint cnt[MAX_N+1];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int n;\n    cin >> n;\n    vvi vec(25);\n    rep(i,25){\n        vec[i].resize(i,0);\n    }\n    rep(i,n){\n        int d,t;\n        cin >> d >> t;\n        rep(j,d){\n            int a;\n            cin >> a;\n            cmx(vec[d][(t+j)%d],a);\n        }\n    }\n    int ans = 0;\n    srep(i,1,25){\n        if(MAX_N % i == 0){\n            rep(j,MAX_N){\n                cnt[j] += vec[i][j%i];\n            }\n        }else{\n            int mx = 0;\n            rep(j,i){\n                cmx(mx,vec[i][j]);\n            }\n            ans += mx;\n        }\n    }\n    int res = 0;\n    rep(i,MAX_N){\n        cmx(res,cnt[i]);\n    }\n    cout << ans + res << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int N;cin>>N,N;){\n    const int C=55440;\n    int a[C]={};\n    while(N--){\n      int d,t;\n      cin>>d>>t;\n      if(C%d){\n\tint m=0;\n\twhile(d--){\n\t  int q;\n\t  cin>>q;\n\t  m=max(m,q);\n\t}\n\tfor(auto &e:a){\n\t  e+=m;\n\t}\n      }else{\n\tint q[24];\n\tfor(int i=0;i<d;i++){\n\t  cin>>q[i];\n\t}\n\tfor(int i=0;i<C;i++){\n\t  a[i]+=q[(i+t)%d];\n\t}\n      }\n    }\n    cout<<*max_element(begin(a),end(a))<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nint main(){\n\tint n;\n\twhile(cin >> n, n){\n\t\tint ans = 0, cur[24], len;\n\t\trep(i, n){\n\t\t\tint k, o, in[24];\n\t\t\tcin >> k >> o;\n\t\t\trep(j, k) cin >> in[(j - o + 1 + k) % k];\n\t\t\tif(i == 0){\n\t\t\t\tlen = k;\n\t\t\t\trep(j, k) cur[j] = in[j];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint nlen = __gcd(len, k);\n\t\t\t\trep(j, k) in[j % nlen] = max(in[j % nlen], in[j]);\n\t\t\t\trep(j, len) cur[j % nlen] = max(cur[j % nlen], cur[j]);\n\t\t\t\t\n\t\t\t\trep(j, nlen) cur[j] += in[j];\n\t\t\t}\n\t\t}\n\t\trep(i, len) ans = max(ans, cur[i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int C=55440;\nint sum[4][24];\nint lsum[C],table[4]={13,17,19,23};\n\nint main(){\n    int N;\n    for(;;){\n        scanf(\"%d\",&N);\n        if(N==0) break;\n        for(int i=0;i<N;i++){\n            int d,t;\n            scanf(\"%d%d\",&d,&t);\n            int now[24];\n            for(int j=0;j<d;j++){\n                scanf(\"%d\",&now[j]);\n            }\n            rotate(now,now+t,now+d);\n            if(find(table,end(table),d)!=end(table)){\n                int at=find(table,end(table),d)-table;\n                for(int j=0;j<d;j++){\n                    sum[at][j]+=now[j];\n                }\n            }else{\n                for(int j=0;j<C/d;j++){\n                    for(int k=0;k<d;k++){\n                        lsum[j*d+k]+=now[k];\n                    }\n                }\n            }\n        }\n        int ret=*max_element(lsum,lsum+C);\n        for(int j=0;j<4;j++){\n            ret+=*max_element(sum[j],sum[j]+table[j]);\n        }\n        printf(\"%d\\n\",ret);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <vector>\n#include <algorithm>\n#include <utility>\n\n// std::vector<size_t> const neko{\n//   0,\n//   5, 2, 3, 2, 5, 2, 7, 2, 3, 2,\n//   11, 2, 13, 2, 3, 2, 17, 2, 19, 2,\n//   3, 2, 23, 2\n// };\n\nint testcase_ends() {\n  size_t n;\n  scanf(\"%zu\", &n);\n  if (n == 0) return 1;\n\n  std::vector<std::vector<intmax_t>> dp(5, std::vector<intmax_t>(1, 0));\n  dp[0].resize(2*2*2*2*3*3*5*7*11);\n  dp[1].resize(13);\n  dp[2].resize(17);\n  dp[3].resize(19);\n  dp[4].resize(23);\n\n  for (size_t i = 0; i < n; ++i) {\n    size_t d, t;\n    scanf(\"%zu %zu\", &d, &t);\n    std::vector<intmax_t> q(d);\n    for (auto& qi: q) scanf(\"%jd\", &qi);\n\n    size_t ind = 0;\n    if (d == 13) {\n      ind = 1;\n    } else if (d == 17) {\n      ind = 2;\n    } else if (d == 19) {\n      ind = 3;\n    } else if (d == 23) {\n      ind = 4;\n    }\n    size_t m = dp[ind].size();\n    for (size_t j = 0; j < m; ++j)\n      dp[ind][j%m] += q[(j+t)%d];\n  }\n\n  intmax_t res = 0;\n  for (auto d: dp)\n    res += *std::max_element(d.begin(), d.end());\n\n  printf(\"%jd\\n\", res);\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                const int a=p.first,b=q.first;\n                if(a==b) continue;\n                const int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%a]+q.second[i%b];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    MEMSET(total, 0);\n    FOR(i, 1, 25) {\n      if (i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nconst int loop=2*2*2*2*3*3*5*7*11;\nint n;\nint d[101],t[101],q[101][25];\nint all[loop];\nint val[25][25];\nvoid solve(){\n\tmemset(all,0,sizeof(all));\n\tmemset(val,0,sizeof(val));\n\tfor(int i=0;i<n;i++){\n\t\tif(loop%d[i]==0){\n\t\t\tfor(int j=0;j<loop;j++){\n\t\t\t\tall[j]+=q[i][(j+t[i])%d[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tval[d[i]][j]+=q[i][(j+t[i])%d[i]];\n\t\t\t}\n\t\t}\n\t}\n\tint res=0;\n\tint maxi=0;\n\tfor(int i=0;i<loop;i++){\n\t\tmaxi=max(maxi,all[i]);\n\t}\n\tres+=maxi;\n\tfor(int i=1;i<=24;i++){\n\t\tmaxi=0;\n\t\tfor(int j=0;j<i;j++){\n\t\t\tmaxi=max(maxi,val[i][j]);\n\t\t}\n\t\tres+=maxi;\n\t}\n\tprintf(\"%d\\n\",res);\n}\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%d%d\",&d[i],&t[i]);\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tscanf(\"%d\",&q[i][j]);\n\t\t\t}\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                const int a=p.first,b=q.first;\n                if(a==b) continue;\n                const int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%a]+q.second[i%b];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst ll LLINF = LLONG_MAX;\nint N,len[110];\n\nint main(){\n  while(cin>>N,N){\n    vector<ll> buf[N];\n    rep(i,N){\n      int cur;\n      cin >> len[i] >> cur;\n      buf[i].resize(len[i]);\n      rep(j,len[i]) cin >> buf[i][(j-cur+len[i])%len[i]];\n    }\n\n    ll ans = 0;\n    rep(i,len[0]){\n      ll cost = buf[0][i];\n      REP(j,1,N){\n        set<int> used;\n        int cur = i % len[j];\n        ll tmp_max = buf[j][cur];\n        while(true){\n          if( used.find(cur) != used.end() ) break;\n          used.insert(cur);\n          tmp_max = max(tmp_max,buf[j][cur]);\n          ( cur += len[0] )  %= len[j];\n        }\n        cost += tmp_max;\n      }\n      ans = max(ans,cost);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<map>\n#include<stack>\n#include<cmath>\n#include<iomanip>\n#include<set>\n#include<numeric>\n#include<sstream>\n#include<random>\n#include<cassert>\n#include<complex>\n#include<list>\nusing namespace std;\ntypedef long long ll;\n#define rep(i, n) for (int i = 0; i < n; ++i)\n#define rrep(i, st, n) for (int i = st; i < n; ++i)\nusing pii = pair<int, int>;\nconst int inf = 1e9 + 7;\nint dy[] = {0, 0, -1, 1, -1, 1, -1, 1};\nint dx[] = {1, -1, 0, 0, -1, 1, 1, -1};\n#define ceil(a, b) a / b + !!(a % b)\n#define chmax(a, b) a = max(a, b)\n#define chmin(a, b) a = min(a, b)\n\nint n;\nint d[101], t[101];\nvector<int> q[101];\nint ans_prime(int p) {\n    int ret = 0;\n    int c = 0;\n    while (c++ < p) {\n        int tmp = 0;\n        rep(i, n) {\n            if (d[i] == p) {\n                tmp += q[i][t[i]];\n                t[i] = (t[i] + 1 == q[i].size() ? 0 : t[i] + 1);\n            }\n        }\n        chmax(ret, tmp);\n    }\n    return ret;\n}\nint main() {\n    while (cin >> n && n) {\n        rep(i, n) { //input phase\n            q[i].resize(0);\n            cin >> d[i] >> t[i];\n            rep(j, d[i]) {\n                int q_; cin >> q_; q[i].push_back(q_);\n            }\n        }\n        int c = 0;\n        int ans = 0;\n        while (c++ < 55440) {\n            int tmp = 0;\n            rep(i, n) {\n                if (d[i] == 13 || d[i] == 17 || d[i] == 23 || d[i] == 19) continue;\n                tmp += q[i][t[i]];\n                t[i] = (t[i] + 1 == q[i].size() ? 0 : t[i] + 1);\n            }\n            chmax(ans, tmp);\n        }\n        ans += ans_prime(13);\n        ans += ans_prime(17);\n        ans += ans_prime(19);\n        ans += ans_prime(23);\n        cout << ans << endl;\n    }\n    \n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<utility>\n#include<map>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 1000000007;\nconst ll INF = mod * mod;\ntypedef pair<int, int> P;\ntypedef pair<ll, ll> LP;\ntypedef vector<int> vec;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define stop char nyaa;cin>>nyaa;\n#define per(i,n) for(int i=n-1;i>=0;i--)\ntypedef long double ld;\n\nvector<int> v = { 13,17,19,23 };\nint trans(int x) {\n\trep(j, 4)if (x == v[j])return j;\n\treturn -1;\n}\nconst int mn = 55440;\nint n;\nvoid solve() {\n\tvector<int> memo(mn, 0);\n\tvector<vector<int>> memo2(4);\n\trep(i, 4)memo2[i].resize(v[i], 0);\n\trep(i, n) {\n\t\tint d, t; cin >> d >> t;\n\t\tvector<int> a(d); rep(j, d)cin >> a[j];\n\t\tint z = trans(d);\n\t\tif (z < 0) {\n\t\t\trep(j, mn) {\n\t\t\t\tmemo[j] += a[(j + t) % d];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\trep(j, d)memo2[z][j] += a[(j+t)%d];\n\t\t}\n\t}\n\tint ans = 0;\n\trep(i, mn)ans = max(ans, memo[i]);\n\trep(i, 4) {\n\t\tint ma = 0;\n\t\trep(j, v[i])ma = max(ma, memo2[i][j]);\n\t\tans += ma;\n\t}\n\tcout << ans << endl;\n}\n\n\nsigned main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\t//cout << fixed << setprecision(10);\n\twhile(cin>>n,n)solve();\n\t//stop\n\t\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n\tconst int M = 11 * 7 * 5 * 3 * 3 * 2 * 2 * 2 * 2;\n\tint n, d, t, q;\n\twhile(scanf(\"%d\", &n), n){\n\t\tint v[25][24] = {};\n\t\tfor(int i = 0; i < n; ++i){\n\t\t\tscanf(\"%d%d\", &d, &t);\n\t\t\tfor(int j = 0; j < d; ++j){\n\t\t\t\tscanf(\"%d\", &q);\n\t\t\t\tv[d][(j + t) % d] += q;\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tint s[M] = {};\n\t\tfor(int i = 1; i <= 24; ++i){\n\t\t\tif(i == 13 || i == 17 || i == 19 || i == 23){\n\t\t\t\tans += *max_element(v[i], v[i] + i);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int j = 0; j < M; ++j){\n\t\t\t\t\ts[j] += v[i][j % i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tans += *max_element(s, s + M);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nconst int T=55440;\n\nint dp[33][T];\n\nsigned main(){\n  int n;\n  while(cin>>n,n){\n    int d[n],t[n];\n    int q[111][33];\n    for(int i=0;i<n;i++){\n      cin>>d[i]>>t[i];\n      for(int j=0;j<d[i];j++) cin>>q[i][j];\n    }\n    //puts(\"OK\");\n    memset(dp,0,sizeof(dp));\n    for(int i=0;i<n;i++){\n      //cout<<d[i]<<\" \"<<t[i]<<endl;\n      if(__gcd(d[i],T)==1){\n\tfor(int j=0;j<d[i];j++){\n\t  //cout<<q[i][j]<<endl;\n\t  dp[d[i]][(t[i]+j)%d[i]]+=q[i][j];\n\t}\n\tcontinue;\n      }\n      for(int j=0;j<T;j++){\n\tdp[0][(t[i]+j)%T]+=q[i][j%d[i]];\n      }\n    }\n    //for(int i=0;i<T;i++) cout<<dp[0][i]<<endl;\n    int ans=0;\n    for(int i=0;i<T;i++) ans=max(ans,dp[0][i]);\n    for(int i=1;i<=24;i++){\n      if(__gcd(i,T)==1){\n\tint tmp=0;\n\tfor(int j=0;j<i;j++) tmp=max(tmp,dp[i][j]);\n\tans+=tmp;\n      }\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nconst int loop=2*2*2*2*3*3*5*7*11;\nint n;\nint d[101],t[101],q[101][25];\nint all[loop];\nvoid solve(){\n\tint res=0;\n\tmemset(all,0,sizeof(all));\n\tfor(int i=0;i<n;i++){\n\t\tif(loop%d[i]==0){\n\t\t\tfor(int j=0;j<loop;j++){\n\t\t\t\tall[j]+=q[i][(j+t[i])%d[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tint maxi=0;\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tmaxi=max(q[i][j],maxi);\n\t\t\t}\n\t\t\tres+=maxi;\n\t\t}\n\t}\n\tint maxi=0;\n\tfor(int i=0;i<loop;i++){\n\t\tmaxi=max(maxi,all[i]);\n\t}\n\tprintf(\"%d\\n\",maxi+res);\n}\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%d%d\",&d[i],&t[i]);\n\t\t\tfor(int j=0;j<d[i];j++){\n\t\t\t\tscanf(\"%d\",&q[i][j]);\n\t\t\t}\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <valarray>\n#include <vector>\n\n#define EPS 1e-9\n#define INF 1070000000LL\n#define MOD 1000000007LL\n#define fir first\n#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)\n#define ite iterator\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define pb push_back\n#define sec second\n#define sz(x) ((int)(x).size())\n\nusing namespace std;\n\nstruct timer{\n\ttime_t start;\n\ttimer(){start=clock();}\n\t~timer(){cerr<<1.*(clock()-start)/CLOCKS_PER_SEC<<\" secs\"<<endl;}\n};\n\ntypedef istringstream iss;\ntypedef long long ll;\ntypedef pair<int,int> pi;\ntypedef stringstream sst;\ntypedef vector<int> vi;\n\nint N;\nconst int cycle[] = {55440,13,17,19,23};\nvector<vi> v[5];\n\nint main(){\n\tcin.tie(0);\n\tios_base::sync_with_stdio(0);\n\t\n\twhile(cin>>N && N){\n\t\trep(i,5)v[i].clear();\n\t\trep(i,N){\n\t\t\tint d,t,q[25];\n\t\t\tcin>>d>>t;\n\t\t\trep(j,d)cin>>q[j];\n\t\t\tint c=0;\n\t\t\twhile(cycle[c] % d)c++;\n\t\t\tvi w;\n\t\t\trep(j,cycle[c]){\n\t\t\t\tw.pb(q[(j+t)%d]);\n\t\t\t}\n\t\t\tv[c].pb(w);\n\t\t}\n\t\tint ans=0;\n\t\trep(i,5){\n\t\t\tint mx=0;\n\t\t\trep(j,cycle[i]){\n\t\t\t\tint sum=0;\n\t\t\t\trep(k,sz(v[i])){\n\t\t\t\t\tsum += v[i][k][j];\n\t\t\t\t}\n\t\t\t\tmx=max(mx,sum);\n\t\t\t}\n\t\t\tans+=mx;\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PI;\n#define EPS (1e-6)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define min3(a,b,c) min((a),min((b),(c)))\n#define min4(a,b,c,d) min((a),min3((b),(c),(d)))\n#define SZ(a) (int)((a).size())\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) a.rbegin(),a.rend()\n#define FLL(a,b) memset((a),b,sizeof(a))\n#define CLR(a) memset((a),0,sizeof(a))\n#define declare(a,it) __typeof(a) it=(a)\n#define FOR(it,a) for(declare(a.begin(),it);it!=a.end();++it)\n#define FORR(it,a) for(declare(a.rbegin(),it);it!=a.rend();++it)\n\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, const pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, const vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\ntypedef double FP;\ntypedef complex<FP> pt;\ntypedef pt P;\ntypedef pair<pt,pt> line;\nnamespace std{\n  bool operator<(const P&a,const P&b){\n    if(abs(a.real()-b.real())>EPS)\n      return a.real()<b.real();\n    return a.imag()<b.imag();\n  }\n}\nFP dot(P a,P b){return real(conj(a)*b);}\nFP crs(P a,P b){return imag(conj(a)*b);}\nP ortho(P a){return P(imag(a),-real(a));}\nP ortho(line a){return ortho(a.S-a.F);}\nP crspt(P a,P b,P c,P d){b-=a,d-=c;return a+b*crs(d,c-a)/crs(d,b);}\nP crspt(line a,line b){return crspt(a.F,a.S,b.F,b.S);}\nbool onl(P a1,P a2,P b){return abs(b-a1)+abs(b-a2)<abs(a1-a2)+EPS;}\nbool onl(line a,P b){return onl(a.F,a.S,b);}\nbool iscrs(line a,line b){P c=crspt(a,b);return onl(a,c)&&onl(b,c);}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\nenum{TOP,BTM,LFT,RGT,FRT,BCK};\nint dxdy2ce[]={RGT,FRT,LFT,BCK};\nint s2i(string& a){stringstream ss(a);int r;ss>>r;return r;}\ntemplate<class T> T shift(T a,int b,int c,int d,int e){\n  __typeof(a[0])t=a[b];\n  a[b]=a[c];a[c]=a[d];a[d]=a[e];a[e]=t;return a;}\ntemplate<class T> T rgt(T a){return shift(a,TOP,LFT,BTM,RGT);}\ntemplate<class T> T lft(T a){return shift(a,TOP,RGT,BTM,LFT);}\ntemplate<class T> T frt(T a){return shift(a,TOP,BCK,BTM,FRT);}\ntemplate<class T> T bck(T a){return shift(a,TOP,FRT,BTM,BCK);}\nline mkl(P a,P v){return line(a,a+v);}\nFP lpdist(line a,P b){return abs(b-crspt(a,mkl(b,ortho(a))));}\nFP spdist(line a,P b){\n  P c(crspt(a,mkl(b,ortho(a))));\n  return onl(a,c)?abs(b-c):min(abs(a.F-b),abs(a.S-b));\n}\nFP ssdist(line a,line b){\n  return\n    iscrs(a,b)?0.:\n    min4(spdist(a,b.F),spdist(a,b.S),\n         spdist(b,a.F),spdist(b,a.S));\n}\n\nint n;\n\nvoid solve(){\n  vector<vector<int> > app(n);\n  vector<vector<int> > app2(n);\n  int ti[n];\n  \n  int lcm = 1;\n  int lcm2 = 1;\n  rep(i,n){\n    int d,t;\n    cin >> d >> t;\n    ti[i] = t;\n    vector<int> q(d);\n    rep(j,d) cin >> q[j];\n    if(d==13 || d==17 || d==19 || d==23){\n      app2[i]=q;\n      lcm2 = lcm2/__gcd(lcm2,d)*d;\n    }else{\n      app[i]=q;\n      lcm = lcm/__gcd(lcm,d)*d;      \n    }\n  }\n  \n  vector<int> su(lcm);\n  \n  //cout << lcm << endl;\n  rep(i,n)\n    if(!app[i].empty())\n      rep(j,lcm)\n        su[j] += app[i][(j+ti[i])%SZ(app[i])];\n\n  vector<int> maxs(lcm2);\n  rep(i,max(lcm,lcm2)) maxs[i%lcm2] = max(maxs[i%lcm2],su[i%lcm]);\n  \n  rep(i,n)\n    if(!app2[i].empty())\n      rep(j,lcm2)\n        maxs[j] += app2[i][(j+ti[i])%SZ(app2[i])];  \n  \n  cout << *max_element(ALL(maxs)) << endl;\n}\n\nint main(int argc, char *argv[])\n{\n  while(cin >> n,n) solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int N;cin>>N,N;){\n    const int C=55440;\n    int a[C]={};\n    int eq[25][24]={};\n    while(N--){\n      int d,t;\n      cin>>d>>t;\n      int q[24];\n      for(int i=0;i<d;i++){\n\tcin>>q[i];\n\teq[d][(i-t+d)%d]+=q[i];\n      }\n      if(C%d==0){\n\tfor(int i=0;i<C;i++){\n\t  a[i]+=q[(i+t)%d];\n\t}\n      }\n    }\n    for(int i=1;i<=24;i++){\n      if(C%i){\n\tint m=*max_element(eq[i],eq[i]+i);\n\tfor(auto &e:a){\n\t  e+=m;\n\t}\n      }\n    }\n    cout<<*max_element(begin(a),end(a))<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N;\nint s[25][25];\nint t[60000];\nint u[25];\nint lc;\nbool flg[100];\n\nint main(){\n  flg[1]=flg[13]=flg[17]=flg[19]=flg[23]=true;\n  \n  while(1){\n    cin>>N;\n    if(N==0)break;\n    memset(s,0,sizeof(s));\n    memset(t,0,sizeof(t));\n    memset(u,0,sizeof(u));\n    lc=1;\n    for(int i=0;i<N;i++){\n      int a,b,c;\n      cin>>a>>b;\n      if(!flg[a])lc = lc/__gcd(lc,a)*a;\n      for(int j=0;j<a;j++){\n        cin>>c;\n        s[a][(j-b%a+a)%a]+=c;\n        if(flg[a])u[a]=max(u[a],s[a][(j-b%a+a)%a]);\n      }\n    }\n    int ans=0,ans2=0;\n    for(int i=2;i<=24;i++){\n      if(flg[i])ans+=u[i];\n      else for(int j=0;j<lc;j++)t[j]+=s[i][j%i];\n    }\n    for(int i=0;i<lc;i++)ans2=max(ans2,t[i]);\n    cout<<ans+ans2<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <string>\n#include <iostream>\n#include <set>\n#include <map>\n#include <time.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nll calc(ll x,ll y){\n\tif(y == 0){\n\t\treturn x;\n\t}else{\n\t\treturn calc(y,x%y);\n\t}\n}\n\nint N;\nll day_len[100],now_t[100],access[100][24];\nll table1[60000],table2[100000];\n\n\n\nvoid func(){\n\n\tfor(int i = 0; i < 60000; i++)table1[i] = 0;\n\tfor(int i = 0; i < 100000; i++)table2[i] = 0;\n\n\tll cicle1 = 1,cicle2 = 1,common;\n\n\tfor(int i = 0; i < N; i++){\n\t\tscanf(\"%lld %lld\",&day_len[i],&now_t[i]);\n\t\tif(day_len[i] == 13 || day_len[i] == 17 || day_len[i] == 19 || day_len[i] == 23){\n\t\t\tif(cicle2 >= day_len[i]){\n\t\t\t\tcommon = calc(cicle2,day_len[i]);\n\t\t\t}else{\n\t\t\t\tcommon = calc(day_len[i],cicle2);\n\t\t\t}\n\t\t\tcicle2 = (cicle2*day_len[i])/common;\n\t\t}else{\n\t\t\tif(cicle1 >= day_len[i]){\n\t\t\t\tcommon = calc(cicle1,day_len[i]);\n\t\t\t}else{\n\t\t\t\tcommon = calc(day_len[i],cicle1);\n\t\t\t}\n\t\t\tcicle1 = (cicle1*day_len[i])/common;\n\t\t}\n\n\t\tfor(int k = 0; k < day_len[i]; k++)scanf(\"%d\",&access[i][k]);\n\t}\n\n\tfor(int i = 0; i < N; i++){\n\t\tif(day_len[i] == 13 || day_len[i] == 17 || day_len[i] == 19 || day_len[i] == 23){\n\t\t\tfor(int k = 0; k < cicle2; k++){\n\t\t\t\ttable2[k] += access[i][(now_t[i]+k)%day_len[i]];\n\t\t\t}\n\t\t}else{\n\t\t\tfor(int k = 0; k < cicle1; k++){\n\t\t\t\ttable1[k] +=  access[i][(now_t[i]+k)%day_len[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tll maximum1 = 0,maximum2 = 0;\n\tfor(int k = 0; k < cicle1; k++)maximum1 = max(maximum1,table1[k]);\n\tfor(int k = 0; k < cicle2; k++)maximum2 = max(maximum2,table2[k]);\n\n\tprintf(\"%lld\\n\",maximum1+maximum2);\n\n}\n\n\nint main(){\n\n\twhile(true){\n\t\tscanf(\"%d\",&N);\n\t\tif(N == 0)break;\n\n\t\tfunc();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct P {\n  double time;\n  int x,y;\n  bool operator > (const P &p)const{\n    return time > p.time;\n  }\n};\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    priority_queue<P,vector<P>,greater<P> > que;\n    for(int i=0; i<n; i++) {\n      int d,t;\n      cin >> d >> t;\n      int a[d];\n      for(int j=0; j<d; j++) cin >> a[j];\n      double p=(double)d/24;\n      int k=0;\n      for(int j=t; j<d; j++,k++) que.push((P){p*k,a[j],i});\n      for(int j=0; j<t; j++,k++) que.push((P){p*k,a[j],i});\n    }\n    int z[n],ans=0;\n    memset(z,0,sizeof(z));\n    while(!que.empty()) {\n      double t=que.top().time;\n      while(!que.empty() && que.top().time==t) {\n\tP p=que.top();que.pop();\n\tz[p.y]=p.x;\n      }\n      int sum=0;\n      for(int i=0; i<n; i++) sum+=z[i];\n      ans=max(ans,sum);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\n\n// 2 3 5 7 11 13 17 19 23\n// 13 17 19 23\n\nbool use[101];\nvector<ll> volume[101];\nint current_time[101];\n\nint main(){\n  ll lcm = 1;\n  int N;\n  while( cin >> N, N ) {\n    rep(i,N) {\n      use[i] = false;\n      volume[i].clear();\n    }\n    rep(i,N){\n      int size;\n      cin >> size;\n      volume[i].resize(size);\n      cin >> current_time[i];\n      rep(j,size) cin >> volume[i][j];\n      if( size != 13 && size != 17 && size != 19 && size != 23 ) {\n        lcm = lcm / __gcd(lcm,(ll)size) * (ll)size;\n        use[i] = true;\n      }\n    }\n    ll maxi = 0;\n    for(ll i=0;i<lcm;i++){\n      ll maxi_sub = 0;\n      rep(j,N) if( use[j] ){\n        maxi_sub += volume[j][current_time[j]];\n        ( current_time[j] += 1 ) %= (int)volume[j].size();\n      }\n      maxi = max(maxi,maxi_sub);\n    }\n    rep(i,N) if( !use[i] ) {\n      ll maxi_sub = 0;\n      rep(j,volume[i].size()) maxi_sub = max(maxi_sub,(ll)volume[i][j]);\n      maxi += maxi_sub;\n    }\n    cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvector<int> vec={8,9,5,7,11};\nint solve(int n){\n    vector<int> d(n);\n    vector<vector<int>> q(n);\n    for(int i=0;i<n;i++){\n        cin>>d[i];\n        q[i].resize(d[i]);\n        int t;\n        cin>>t;\n        for(int j=0;j<d[i];j++){\n            cin>>q[i][(j+(d[i]-t))%d[i]];\n        }\n    }\n    vector<vector<int>> gcdv(25,vector<int>(25,0));\n    for(int i=0;i<25;i++){\n        for(int j=0;j<25;j++){\n            if(i!=0 && j!=0) gcdv[i][j]=__gcd(i,j);\n        }\n    }\n    vector<vector<int>> tq(24);\n    for(int i=0;i<24;i++){\n        tq[i].assign(i+1,0);\n    }\n    for(int i=0;i<n;i++){\n        for(int j=0;j<d[i];j++) tq[d[i]-1][j]+=q[i][j];\n    }\n    int cnt=0;\n    auto calc=[&](vector<int> v){\n        int res=0;\n        for(int i=0;i<24;i++){\n            int sc=-1e9;\n            for(int j=0;j<i+1;j++){\n                bool isok=true;\n                for(int k=0;k<vec.size();k++){\n                    int g=gcdv[vec[k]][i+1];\n                    isok=isok && (v[k]%g==j%g);  \n                    cnt++;\n                }\n                if(isok) sc=max(sc,tq[i][j]);\n            }\n            res+=sc;\n        }\n        return res;\n    };\n    function<int(int,vector<int>)> dfs=[&](int idx,vector<int> v){\n        if(idx==vec.size()) return calc(v);\n        int res=0;\n        for(int i=0;i<vec[idx];i++){\n            v[idx]=i;\n            res=max(res,dfs(idx+1,v));\n        }\n        return res;\n    };\n    \n    vector<int> tmp(vec.size());\n    int ret=dfs(0,tmp);\n    return ret;\n}\nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(cycle, 0);\n    MEMSET(total, 0);\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      assert(0 <= offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    FOR(i, 1, 25) {\n      if (i == 13 || i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n        continue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tint a[25][24]={};\n\t\trep(_,n){\n\t\t\tint m,t,q; scanf(\"%d%d\",&m,&t);\n\t\t\trep(i,m) scanf(\"%d\",&q), a[m][(t+i)%m]+=q;\n\t\t}\n\n\t\t// 55440 = LCM({1,2,...,24}\\{13,17,19,23})\n\t\tstatic int L[55440];\n\t\tmemset(L,0,sizeof L);\n\t\tfor(int m=1;m<=24;m++) if(m!=13 && m!=17 && m!=19 && m!=23) {\n\t\t\trep(j,55440) L[j]+=a[m][j%m];\n\t\t}\n\n\t\tint ans=*max_element(L,L+55440)\n\t\t\t   +*max_element(a[13],a[13]+13)\n\t\t\t   +*max_element(a[17],a[17]+17)\n\t\t\t   +*max_element(a[19],a[19]+19)\n\t\t\t   +*max_element(a[23],a[23]+23);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nconst ll MAXCYCLE = 16 * 9 * 5 * 7 * 11;\nll cycle[25][25];\nll total[MAXCYCLE];\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(cycle, 0);\n    REP(i, n) {\n      int d, offset;\n      scanf(\"%d %d\", &d, &offset);\n      REP(j, d) {\n        int q;\n        scanf(\"%d\", &q);\n        cycle[d][(offset + j) % d] += q;\n      }\n    }\n    ll ans = 0;\n    MEMSET(total, 0);\n    FOR(i, 1, 25) {\n      if (i == 13 || i == 17 || i == 19 || i == 23) {\n        ll maxvalue = 0;\n        REP(j, i) {\n          maxvalue = max(maxvalue, cycle[i][j]);\n        }\n        ans += maxvalue;\n        continue;\n      }\n      int hour = 0;\n      REP(j, MAXCYCLE) {\n        total[j] += cycle[i][hour];\n        hour = (hour + 1) % i;\n      }\n    }\n    ll maxvalue = 0;\n    REP(i, MAXCYCLE) {\n      maxvalue = max(maxvalue, total[i]);\n    }\n    ans += maxvalue;\n    printf(\"%lld\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define llint long long\n\nusing namespace std;\n\nllint N;\nllint data[25][25];\nllint array[60000];\nllint p[] = {13, 17, 19, 23};\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> N;\n\t\tif(N == 0) break;\n\t\t\n\t\tfor(int i = 1; i <= 24; i++){\n\t\t\tfor(int j = 0; j <= 24; j++){\n\t\t\t\tdata[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 60000; i++) array[i] = 0;\n\t\t\n\t\tllint d, t, q[25];\n\t\tfor(int i = 1; i <= N; i++){\n\t\t\tcin >> d >> t;\n\t\t\tfor(int j = 0; j < d; j++) cin >> q[j];\n\t\t\tfor(int j = 0; j < d; j++) data[d][j] += q[(j+t)%d];\n\t\t}\n\t\t\n\t\tfor(int i = 1; i <= 24; i++){\n\t\t\tfor(int j = 0; j < 4; j++) if(i == p[j]) goto pass;\n\t\t\tfor(int j = 0; j < 60000; j++) array[j] += data[i][j%i];\n\t\t\tpass:;\n\t\t}\n\t\t\n\t\tllint ans = 0;\n\t\tfor(int i = 0; i < 60000; i++) ans = max(ans, array[i]);\n\t\tfor(int i = 0; i < 4; i++){\n\t\t\tllint tmp = 0;\n\t\t\tfor(int j = 0; j < p[i]; j++) tmp = max(tmp, data[p[i]][j]);\n\t\t\tans += tmp;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct P {\n  double time;\n  int x,y;\n  bool operator > (const P &p)const{\n    return time > p.time;\n  }\n};\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    priority_queue<P,vector<P>,greater<P> > que;\n    for(int i=0; i<n; i++) {\n      int d,t;\n      cin >> d >> t;\n      int a[d];\n      for(int j=0; j<d; j++) cin >> a[j];\n      double p=24.0/(double)d;\n      int k=0;\n      for(int j=t; j<d; j++,k++) que.push((P){p*k,a[j],i});\n      for(int j=0; j<t; j++,k++) que.push((P){p*k,a[j],i});\n    }\n    int z[n],ans=0;\n    memset(z,0,sizeof(z));\n    while(!que.empty()) {\n      double t=que.top().time;\n      while(!que.empty() && que.top().time==t) {\n\tP p=que.top();que.pop();\n\tz[p.y]=p.x;\n      }\n      int sum=0;\n      for(int i=0; i<n; i++) sum+=z[i];\n      ans=max(ans,sum);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvector<int> vec={8,9,5,7,11};\nint solve(int n){\n    vector<int> d(n);\n    vector<vector<int>> q(n);\n    for(int i=0;i<n;i++){\n        cin>>d[i];\n        q[i].resize(d[i]);\n        int t;\n        cin>>t;\n        for(int j=0;j<d[i];j++){\n            cin>>q[i][(j+(d[i]-t))%d[i]];\n        }\n    }\n    vector<vector<int>> gcdv(25,vector<int>(25,0));\n    for(int i=0;i<25;i++){\n        for(int j=0;j<25;j++){\n            if(i!=0 && j!=0) gcdv[i][j]=__gcd(i,j);\n        }\n    }\n    vector<vector<int>> tq(24);\n    for(int i=0;i<24;i++){\n        tq[i].assign(i+1,0);\n    }\n    for(int i=0;i<n;i++){\n        for(int j=0;j<d[i];j++) tq[d[i]-1][j]+=q[i][j];\n    }\n    int cnt=0;\n    auto calc=[&](vector<int> v){\n        int res=0;\n        for(int i=0;i<24;i++){\n            int sc=-1e9;\n            for(int j=0;j<i+1;j++){\n                bool isok=true;\n                for(int k=0;k<vec.size();k++){\n                    int g=gcdv[vec[k]][i+1];\n                    isok=isok && (v[k]%g==j%g);  \n                    cnt++;\n                }\n                if(isok) sc=max(sc,tq[i][j]);\n            }\n            res+=sc;\n        }\n        return res;\n    };\n    function<int(int,vector<int>)> dfs=[&](int idx,vector<int> v){\n        if(idx==vec.size()) return calc(v);\n        int res=0;\n        for(int i=0;i<vec[idx];i++){\n            v[idx]=i;\n            res=max(res,dfs(idx+1,v));\n        }\n        return res;\n    };\n    \n    vector<int> tmp(vec.size());\n    int ret=dfs(0,tmp);\n    return ret;\n}\nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\nint acc[tmax];\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0;\n\t\trep(i,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(j,d) cin >> q[j];\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(j,tmax){\n\t\t\t\t\tint cur=(j+t)%tmax;\n\t\t\t\t\tacc[cur]+=q[cur%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\n// 最大公約数\nlong long gcd(long long a, long long b){\n    while(b != 0){\n        long long tmp = a % b;\n        a = b;\n        b = tmp;\n    }\n    return a;\n}\n\n// 最小公倍数\nlong long lcm(long long a, long long b){\n    return a / gcd(a, b) * b;\n}\n\nint main()\n{\n    const int prime[] = {13, 17, 19, 23};\n\n    long long a = 1;\n    for(int i=1; i<=24; ++i){\n        if(find(prime, prime+4, i) == prime+4)\n            a = lcm(a, i);\n    }\n\n    for(;;){\n        int n;\n        cin >> n;\n        if(n == 0)\n            return 0;\n\n        vector<vector<int> > x(25);\n        for(int i=1; i<=24; ++i)\n            x[i].resize(i);\n\n        for(int i=0; i<n; ++i){\n            int d, t;\n            cin >> d >> t;\n            for(int j=0; j<d; ++j){\n                int q;\n                cin >> q;\n                x[d][(t+j)%d] += q;\n            }\n        }\n\n        for(int i=0; i<4; ++i)\n            x[prime[i]].assign(prime[i], *max_element(x[prime[i]].begin(), x[prime[i]].end()));\n\n        int ret = 0;\n        for(int i=0; i<a; ++i){\n            int sum = 0;\n            for(int j=1; j<=24; ++j)\n                sum += x[j][i%j];\n            ret = max(ret, sum);\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst ll LLINF = LLONG_MAX;\nint N,len[110];\n\nint main(){\n  while(cin>>N,N){\n    vector<ll> buf[N];\n    rep(i,N){\n      int cur;\n      cin >> len[i] >> cur;\n      buf[i].resize(len[i]);\n      rep(j,len[i]) cin >> buf[i][(cur+j)%len[i]];\n    }\n\n    ll ans = 0;\n    rep(i,len[0]){\n      ll cost = buf[0][i];\n      REP(j,1,N){\n        set<int> used;\n        int cur = i % len[j];\n        ll tmp_max = buf[j][cur];\n        while(true){\n          if( used.find(cur) != used.end() ) break;\n          used.insert(cur);\n          tmp_max = max(tmp_max,buf[j][cur]);\n          ( cur += len[0] )  %= len[j];\n        }\n        cost += tmp_max;\n      }\n      ans = max(ans,cost);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint N;\nint Q[25][25] = {};\nint P[4] = {13,17,19,23};\n\nint main(){\n    while(cin >> N && N>0){\n        int d,t,q;\n        for(int i=1;i<=24;i++) for(int j=0;j<24;j++) Q[i][j] = 0;\n        for(int i=1;i<=N;i++){\n            cin >> d >> t;\n            for(int j=0;j<d;j++){\n                cin >> q;\n                Q[d][(j-t+d)%d] += q;\n            }\n        }\n        int ans = 0;\n        for(int i=0;i<=55440;i++){\n            int now = 0;\n            for(int j=1;j<=24;j++){\n                if(j==13 || j==17 || j==19 || j==23) continue;\n                now += Q[j][i%j];\n            }\n            ans = max(ans,now);\n        }\n        for(int i=0;i<4;i++){\n            int ma = 0;\n            for(int j=0;j<P[i];j++) ma = max(ma,Q[P[i]][j]);\n            ans += ma;\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nusing VS = vector<string>;    using LL = long long;\nusing VI = vector<int>;       using VVI = vector<VI>;\nusing PII = pair<int, int>;   using PLL = pair<LL, LL>;\nusing VL = vector<LL>;        using VVL = vector<VL>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n#define FOR(i, s, e) for (int(i) = (s); (i) < (e); (i)++)\n#define FORR(i, s, e) for (int(i) = (s); (i) > (e); (i)--)\n#define debug(x) cerr << #x << \": \" << x << endl\nconst int INF = 1e9;                          const LL LINF = 1e16;\nconst LL MOD = 1000000007;                    const double PI = acos(-1.0);\nint DX[8] = { 0, 0, 1, -1, 1, 1, -1, -1 };    int DY[8] = { 1, -1, 0, 0, 1, -1, 1, -1 };\n\n/* -----  2017/11/15  Problem: AOJ 2162 / Link: http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2162  ----- */\n/* ------問題------\n\n\n\n-----問題ここまで----- */\n/* -----解説等-----\n\n全周期をみたいけどLCM(1 to 24)は5*10^9overなのできびしい。\n3,7だけ見ると愚直をしなくての3maxと7maxをとって足しても答えになる。これは互いに素の時のみできる\nつまり2,4は無理\n互いに素なものは別でやっていいのでなるべく取り除けばLCMを小さくできる。\n今回はmaxが24なので13以上の素数を取り除くと、これらのLDMは 55440でハッピー\nこっちは全探索をしてあとは独立にやってもよいから間に合ってくれる。\n\n----解説ここまで---- */\n\nLL N;\n\nLL ans = 0LL;\nbool doku(int a) { return (a == 13 || a == 17 || a == 19 || a == 23); }\n\nint main() {\n\tcin.tie(0);\n\tios_base::sync_with_stdio(false);\n\tmap<int, int>m;\n\twhile (cin >> N, N) {\n\t\tVL a(55440 + 1, 0);\n\t\tVVL b(24 + 1, VL(24, 0));\n\t\tFOR(_, 0, N) {\n\t\t\tint d; cin >> d;\n\t\t\tint t; cin >> t;\n\t\t\tVL in(d);\n\t\t\tFOR(j, 0, d) {\n\t\t\t\tcin >> in[j];\n\t\t\t\tb[d][(j - t + d) % d] += in[j];\n\t\t\t}\n\t\t}\n\t\tans = 0;\n\t\tFOR(i, 1, 24 + 1) {\n\t\t\tif (doku(i)) {\n\t\t\t\tans += *max_element(ALL(b[i]));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tFOR(j, 0, 55440 + 1) {\n\t\t\t\t\ta[j] += b[i][j%i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tans += *max_element(ALL(a));\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e16\n#define mod 1000000007\n\nint lcm(int a,int b){\n  return (a/__gcd(a,b))*b;\n}\n\nint N;\nint A[25][25];\nint ps[]={13,17,23};\n\nint main(){\n  while(1){\n    scanf(\"%d\",&N);\n    if(N==0)break;\n    memset(A,0,sizeof(A));\n    int sz=1;\n    rep(i,N){\n      int D,T;\n      scanf(\"%d%d\",&D,&T);\n      bool ok=true;\n      rep(j,3)if(ps[j]==D)ok=false;\n      if(ok)sz=lcm(sz,D);\n      rep(j,D){\n        int B;\n        scanf(\"%d\",&B);\n        A[D][(j-T+D)%D]+=B;\n      }\n    }\n    vector<int> sum(sz,0);\n    int res=0;\n    rep(i,3)res+=*max_element(A[ps[i]],A[ps[i]]+25);\n    repl(i,1,25){\n      bool ok=true;\n      rep(j,3)if(ps[j]==i)ok=false;\n      if(!ok)continue;\n      rep(j,sz)sum[j]+=A[i][j%i];\n    }\n    res+=*max_element(all(sum));\n    printf(\"%d\\n\",res);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n\tconst int M = 11 * 7 * 5 * 3 * 3 * 2 * 2 * 2 * 2;\n\tint n, d, t, q;\n\twhile(scanf(\"%d\", &n), n){\n\t\tint v[25][24] = {};\n\t\tfor(int i = 0; i < n; ++i){\n\t\t\tscanf(\"%d%d\", &d, &t);\n\t\t\tfor(int j = 0; j < d; ++j){\n\t\t\t\tscanf(\"%d\", &q);\n\t\t\t\tv[d][(j + d - t) % d] += q;\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tint s[M] = {};\n\t\tfor(int i = 1; i <= 24; ++i){\n\t\t\tif(i == 13 || i == 17 || i == 19 || i == 23){\n\t\t\t\tans += *max_element(v[i], v[i] + i);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int j = 0; j < M; ++j){\n\t\t\t\t\ts[j] += v[i][j % i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tans += *max_element(s, s + M);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include <stack>\nusing namespace std;\nint gcd(int a,int b);\nbool bigprime(int a);\n\nint main(){\n\n  int n;\n  while(  cin >> n && n!=0){\n\n\n\n    \n    int data[25][24];\n\n    int day,now,inp;\n    for(int i=0;i<n;i++){\n      cin >> day >> now;\n      \n      for(int j=0;j<day;j++){\n\tcin >> inp;\n\tif(data[day][(j+now)%day]){\n\t  data[day][(j+now)%day]+=inp;\n\t}else{\n\t  data[day][(j+now)%day]=inp;\n\t}\n      }\n      \n    }\n\n    int ans=0,max=0,temp=0;\n  \n    for(int i=0;i<55440;i++){\n\n      for(int j=1;j<25;j++){\n\tif(bigprime(j))break;\n\ttemp+=data[j][i%j];\n      }\n      if(temp<ans)ans=temp;\n      temp=0;\n    }\n\n    for(int i=1;i<24;i++){\n      if(bigprime(i)){\n\tfor(int j=0;j<i;j++){\n\t  if(max<data[i][j])max=data[i][j];\n\t}\n\tans+=max;\n\tmax=0;\n      }\n    }\n    cout << ans << endl;\n  }\n}\n\nint gcd(int a,int b){\n  if(a<b){\n    int t=a;\n    a=b;\n    b=t;\n  }\n\n  if(b==0){\n    return a;\n  }else{\n    return gcd(b,a%b);\n  }\n}\n\nbool bigprime(int a){\n  if(a==13||a==19||a==17||a==23){\n    return true;\n  }else{\n    return false;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct P {\n  double time;\n  int x,y;\n  bool operator > (const P &p)const{\n    return time > p.time;\n  }\n};\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    priority_queue<P,vector<P>,greater<P> > que;\n    for(int i=0; i<n; i++) {\n      int d,t;\n      cin >> d >> t;\n      int a[d];\n      for(int j=0; j<d; j++) cin >> a[j];\n      double p=24.0/(double)d;\n      int k=0;\n      for(int j=t; j<d; j++,k++) que.push((P){p*k,a[j],i});\n      for(int j=0; j<t; j++,k++) que.push((P){p*k,a[j],i});\n    }\n    int z[n],ans=0;\n    memset(z,0,sizeof(z));\n    while(!que.empty()) {\n      double t=que.top().time;\n      while(!que.empty() && fabs(que.top().time-t)<=1e-8) {\n\tP p=que.top();que.pop();\n\tz[p.y]=p.x;\n      }\n      int sum=0;\n      for(int i=0; i<n; i++) sum+=z[i];\n      ans=max(ans,sum);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0,acc[tmax];\n\t\tmemset(acc,0,sizeof(acc));\n\t\trep(loop,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(i,d) cin >> q[i];\n\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(i,tmax){\n\t\t\t\t\tint cur=(i+t)%tmax;\n\t\t\t\t\tacc[i]+=q[cur%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define llint long long\n\nusing namespace std;\n\nllint N;\nllint data[25][25];\nllint array[60000];\nllint p[] = {13, 17, 19, 23};\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> N;\n\t\tif(N == 0) break;\n\t\t\n\t\tllint d, t, q[25];\n\t\tfor(int i = 1; i <= N; i++){\n\t\t\tcin >> d >> t;\n\t\t\tfor(int j = 0; j < d; j++) cin >> q[j];\n\t\t\tfor(int j = 0; j < d; j++) data[d][j] += q[(j+t)%d];\n\t\t}\n\t\t\n\t\tfor(int i = 1; i <= 24; i++){\n\t\t\tfor(int j = 0; j < 4; j++) if(i == p[i]) goto pass;\n\t\t\tfor(int j = 0; j < 60000; j++) array[j] += data[i][j%i];\n\t\t\tpass:;\n\t\t}\n\t\t\n\t\tllint ans = 0;\n\t\tfor(int i = 0; i < 60000; i++) ans = max(ans, array[i]);\n\t\tfor(int i = 0; i < 4; i++){\n\t\t\tllint tmp = 0;\n\t\t\tfor(int j = 0; j < p[i]; j++) tmp = max(tmp, data[p[i]][j]);\n\t\t\tans += tmp;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nconst int L = 16*9*5*7*11;\n\nint main() {\n  int N;\n  while (cin >> N && N) {\n    int Q[30][30] = {{0}};\n    for (int i=0; i<N; i++) {\n      int d, t;\n      cin >> d >> t;\n      for (int j=0; j<d; j++) {\n\tint q;\n\tcin >> q;\n\tQ[d][(j+d-t)%d] += q;\n      }\n    }\n    int sum = 0;\n    int T[L] = {0};\n    for (int d=1; d<=24; d++) {\n      if (d == 13 || d == 17 || d == 19 || d == 23 || d == 1) {\n\tint M = 0;\n\tfor (int i=0; i<d; i++) {\n\t  if (M < Q[d][i]) M = Q[d][i];\n\t}\n\tsum += M;\n      } else {\n\tfor (int i=0; i<L; i++) {\n\t  T[i] += Q[d][i%d];\n\t}\n      }\n    }\n    int MM = 0;\n    for (int i=0; i<L; i++) {\n      if (MM < T[i]) MM = T[i];\n    }\n    cout << sum + MM << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int N;cin>>N,N;){\n    const int C=55440;\n    int a[C]={};\n    while(N--){\n      int d,t;\n      cin>>d>>t;\n      int q[24];\n      int m=-(1<<29);\n      for(int i=0;i<d;i++){\n\tcin>>q[i];\n\tm=max(m,q[i]);\n      }\n      for(int i=0;i<C;i++){\n\ta[i]+=(C%d)?m:q[(i+t)%d];\n      }\n    }\n    cout<<*max_element(begin(a),end(a))<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing vi = vector<ll>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<ll, ll>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst ll INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n  if(a < b) {a = b; return true;}\n  return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n  if(a > b) {a = b; return true;}\n  return false;\n}\ntemplate<typename T1, typename T2>\nostream& operator<<(ostream &os, const pair<T1, T2> p) {\n  os << p.first << \":\" << p.second;\n  return os;\n}\ntemplate<class T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n  for(ll i=0;i<((ll)(v.size()));++i) {\n    if(i) os << \" \";\n    os << v[i];\n  }\n  return os;\n}\nsigned main() {\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  while(1) {\n    ll n;\n    cin >> n;\n    if (n == 0) break;\n    map<ll, bool> mp;\n    mp[13] = true;\n    mp[17] = true;\n    mp[19] = true;\n    mp[23] = true;\n    ll l = 55440;\n    vvi v(n);\n    for(ll i=0;i<(n);++i) {\n      ll d;\n      cin >> d;\n      v[i].resize(d);\n      ll t; cin >> t;\n      for(ll j=0;j<(d);++j) {\n        cin >> v[i][(j + d - t) % d];\n      }\n    }\n    vi tmp(l);\n    vi tmp13(13), tmp17(17), tmp19(19), tmp23(23);\n    ll ans = 0;\n    for(ll i=0;i<(n);++i) {\n      if(mp[(ll)(v[i].size())]) {\n        ll sz = (ll)(v[i].size());\n        if(sz == 13) {\n          for(ll j=0;j<(13);++j) {\n            tmp13[j] += v[i][j];\n          }\n        } else if(sz == 17) {\n          for(ll j=0;j<(17);++j) {\n            tmp17[j] += v[i][j];\n          }\n        } else if(sz == 19) {\n          for(ll j=0;j<(19);++j) {\n            tmp19[j] += v[i][j];\n          }\n        } else {\n          for(ll j=0;j<(23);++j) {\n            tmp23[j] += v[i][j];\n          }\n        }\n      } else {\n        for(ll j=0;j<(l);++j) {\n          tmp[j] += v[i][j%(ll)(v[i].size())];\n        }\n      }\n    }\n    ll ma = 0;\n    for(ll i=0;i<(l);++i) {\n      chmax(ma, tmp[i]);\n    }\n    ans += ma;\n    vi hoge = {13, 17, 19, 23};\n    for(ll i=0;i<(4);++i) {\n      ma = 0;\n      if(hoge[i] == 13) {\n        for(ll j=0;j<(hoge[i]);++j) {\n          chmax(ma, tmp13[j]);\n        }\n      } else if(hoge[i] == 17) {\n        for(ll j=0;j<(hoge[i]);++j) {\n          chmax(ma, tmp17[j]);\n        }\n      } else if(hoge[i] == 19) {\n        for(ll j=0;j<(hoge[i]);++j) {\n          chmax(ma, tmp19[j]);\n        }\n      } else {\n        for(ll j=0;j<(hoge[i]);++j) {\n          chmax(ma, tmp23[j]);\n        }\n      }\n      ans += ma;\n    }\n    cout << ans << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint N;\nint s[24][24];\nint t[60000];\nint u[24];\nint lc;\nbool flg[100];\n\nint main(){\n  flg[1]=flg[13]=flg[17]=flg[19]=flg[23]=true;\n  \n  while(1){\n    cin>>N;\n    if(N==0)break;\n    memset(s,0,sizeof(s));\n    memset(t,0,sizeof(t));\n    memset(u,0,sizeof(u));\n    lc=1;\n    for(int i=0;i<N;i++){\n      int a,b,c;\n      cin>>a>>b;\n      if(!flg[a])lc = lc/__gcd(lc,a)*a;\n      for(int j=0;j<a;j++){\n        cin>>c;\n        s[a][(j-b%a+a)%a]+=c;\n        if(flg[a])u[a]=max(u[a],c);\n      }\n    }\n    int ans=0,ans2=0;\n    for(int i=2;i<24;i++){\n      if(flg[i])ans+=u[i];\n      else for(int j=0;j<lc;j++)t[j]+=s[i][j%i];\n    }\n    for(int i=0;i<lc;i++)ans2=max(ans2,t[i]);\n    cout<<ans+ans2<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e16\n#define mod 1000000007\n\nint N;\nint A[25][25];\nint sum[1053360];\nint ps[]={13,17,23};\n\nint main(){\n  while(1){\n    cin>>N;\n    if(N==0)break;\n    memset(sum,0,sizeof(sum));\n    memset(A,0,sizeof(A));\n    rep(i,N){\n      int D,T;\n      scanf(\"%d%d\",&D,&T);\n      rep(j,D){\n        int B;\n        scanf(\"%d\",&B);\n        A[D][(j+T)%D]+=B;\n      }\n    }\n    int res=0;\n    rep(i,3)res+=*max_element(A[ps[i]],A[ps[i]]+33);\n    repl(i,1,25){\n      bool ok=true;\n      rep(j,3)if(ps[j]==i)ok=false;\n      if(!ok)continue;\n      rep(j,1053360)sum[j]+=A[i][j%i];\n    }\n    res+=*max_element(sum,sum+1053360);\n    printf(\"%d\\n\",res);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                const int a=p.first,b=q.first;\n                if(a==b) continue;\n                const int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v=x[c];\n                if(v.empty()) v.resize(c);\n                rep(i,0,c){\n                    if(a!=c) v[i]+=p.second[i%a];\n                    if(b!=c) v[i]+=q.second[i%b];\n                }\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N;\n    while(cin >> N, N) {\n        vector<vector<int>> q(25);\n        int L = 1;\n        for(int i = 0; i < N; ++i) {\n            int d, t;\n            cin >> d >> t;\n            if(q[d].size() == 0) {\n                q[d] = vector<int>(d);\n            }\n            for(int j = 0; j < d; ++j) {\n                int qq;\n                cin >> qq;\n                q[d][(j - t + d) % d] += qq;\n            }\n            if(d != 13 && d != 17 && d != 19 && d != 23) {\n                L = d / __gcd(d, L) * L;\n            }\n        }\n\n        vector<int> v(L);\n        int res = 0;\n        for(int i = 0; i < 25; ++i) {\n            if(q[i].size() == 0) {\n                continue;\n            }\n            if(i == 13 || i == 17 || i == 19 || i == 23) {\n                res += *max_element(q[i].begin(), q[i].end());\n            } else {\n                for(int j = 0; j < L; ++j) {\n                    v[j] += q[i][j % i];\n                }\n            }\n        }\n        res += *max_element(v.begin(), v.end());\n        cout << res << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=55440;\n\nint main(void){\n\tint n;\n\tconst int prime[4]={13,17,19,23};\n\twhile(cin >> n,n){\n\t\tint any[4][24],acc[tmax];\n\t\tmemset(acc,0,sizeof(acc));\n\t\tmemset(any,0,sizeof(any));\n\t\trep(loop,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(i,d) cin >> q[i];\n\n\t\t\tbool ok=false;\n\t\t\trep(i,4){\n\t\t\t\tif(d!=prime[i]) continue;\n\t\t\t\tok=true;\n\t\t\t\trep(j,d){\n\t\t\t\t\tint cur=(j+t)%d;\n\t\t\t\t\tany[i][j]+=q[cur];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ok) continue;\n\t\t\trep(i,tmax){\n\t\t\t\tint cur=(i+t)%d;\n\t\t\t\tacc[i]+=q[cur];\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax);\n\t\trep(i,4) ans+=*max_element(any[i],any[i]+prime[i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <string>\n#include <cmath>\n#include <cassert>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\n#include <iomanip>\n#include <fstream>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define chmax(a,b) (a<b?(a=b,1):0)\n#define chmin(a,b) (a>b?(a=b,1):0)\n#define valid(y,x,h,w) (0<=y&&y<h&&0<=x&&x<w)\nconst int INF = 1<<29;\ntypedef long long ll;\ntypedef pair<int,int> pii;\n\nint d[100];\nint q[100][24];\n\nint main() {\n  int n;\n  while(cin>>n,n) {\n    REP(i,n) {\n      cin >> d[i];\n      int t; cin >> t;\n      REP(j,d[i]) cin >> q[i][j];\n    }\n    int t[4] = {13,17,19,23};\n    int f[25];\n    REP(i,25) {\n      f[i] = -1;\n      REP(j,4)if(i==t[j])f[i]=j;\n    }\n    int N = 2*3*5*7*11;\n    int ans = 0;\n    REP(t,N) {\n      int tmp = 0;\n      REP(i,n) {\n        if (f[d[i]] == -1) {\n          tmp += q[i][t%d[i]];\n        }\n      }\n      chmax(ans, tmp);\n    }\n    int hoge[4][25] = {};\n    REP(i,n) {\n      if (f[d[i]] >= 0) {\n        REP(j,d[i]) hoge[f[d[i]]][j] += q[i][j];\n      }\n    }\n    REP(i,4) {\n      ans += *max_element(hoge[i],hoge[i]+25);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nint n, dp[60000];\n\nint main(){\n\twhile(cin >> n, n){\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tvector<vi> in;\n\t\tvi i13(13), i17(17), i19(19), i23(23);\n\t\trep(i, n){\n\t\t\tint d, t;\n\t\t\tcin >> d >> t;\n\t\t\tvi v(d);\n\t\t\trep(j, d) cin >> v[(j - t + d) % d];\n\t\t\tif(d == 13) rep(j, d) i13[j] += v[j];\n\t\t\telse if(d == 17) rep(j, d) i17[j] += v[j];\n\t\t\telse if(d == 19) rep(j, d) i19[j] += v[j];\n\t\t\telse if(d == 23) rep(j, d) i23[j] += v[j];\n\t\t\telse{\n\t\t\t\trep(j, 60000) dp[j] += v[j % v.size()];\n\t\t\t}\n\t\t}\n\t\tint ans = *max_element(dp, dp + 60000);\n\t\tans += *max_element(all(i13)) + *max_element(all(i17));\n\t\tans += *max_element(all(i19)) + *max_element(all(i23));\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 101;\n\nint N;\nvector<vector<int> > q;\n\nint lcm(int a, int b) {\n  return a * b / __gcd(a, b);\n}\n\nint main() {\n  while(cin >> N && N) {\n    q.clear();\n    int a = 0, b = 0, c = 0, d = 0;\n    for(int i = 0; i < N; ++i) {\n      int d, t; cin >> d >> t;\n      vector<int> v(d);\n      for(int j = 0; j < d; ++j) cin >> v[(j-t+d)%d];\n      if(d == 13) a = max(a, *max_element(v.begin(), v.end()));\n      else if(d == 17) b = max(b, *max_element(v.begin(), v.end()));\n      else if(d == 19) c = max(c, *max_element(v.begin(), v.end()));\n      else if(d == 23) d = max(d, *max_element(v.begin(), v.end()));\n      else q.push_back(v);\n    }\n    int T = 1;\n    for(int i = 0; i < q.size(); ++i) {\n      T = lcm(T, q[i].size());\n    }\n    int res = 0;\n    for(int t = 0; t < T; ++t) {\n      int sum = 0;\n      for(int i = 0; i < q.size(); ++i) {\n\tsum += q[i][t%q[i].size()];\n      }\n      res = max(res, sum);\n    }\n    res += a + b + c + d;\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define all(v) (v).begin(), (v).end()\n#define resz(v, ...) (v).clear(), (v).resize(__VA_ARGS__)\n#define reps(i, m, n) for(int i = (int)(m); i < (int)(n); i++)\n#define rep(i, n) reps(i, 0, n)\n\ntemplate<class T1, class T2> void chmin(T1 &a, T2 b){if(a>b)a=b;}\ntemplate<class T1, class T2> void chmax(T1 &a, T2 b){if(a<b)a=b;}\n\ntypedef pair<int, int> Pi;\ntypedef tuple<int, int, int> Ti;\ntypedef vector<int> vint;\n\nconst int inf = 1LL << 55;\nconst int mod = 1e9 + 7;\n\nint N;\nvint d, t;\nvector<vint> q;\nint sum[60000];\nint psum[25][60000];\n\nint lcm(int a, int b) {\n  return a / __gcd(a, b) * b;\n}\n\nbool avoid(int a) {\n  return a==13||a==17||a==19||a==23;\n}\n\nsigned main()\n{\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  while(cin >> N, N) {\n    resz(d, N), resz(t, N), resz(q, N);\n    rep(i, N) {\n      cin >> d[i] >> t[i];\n      resz(q[i], d[i]);\n      rep(j, d[i]) cin >> q[i][j];\n    }\n    int LCM = 1;\n    rep(i, N) if(!avoid(d[i])) LCM = lcm(LCM, d[i]);\n    memset(sum, 0, sizeof(sum));\n    memset(psum, 0, sizeof(psum));\n    rep(i, N) {\n      if(avoid(d[i])) {\n\trep(j, d[i]) psum[d[i]][j] += q[i][(t[i]+j)%d[i]];\n      } else {\n\trep(j, LCM) sum[j] += q[i][(t[i]+j)%d[i]];\n      }\n    }\n    int ans = *max_element(sum, sum+60000);\n    ans += *max_element(psum[13], psum[13]+60000);\n    ans += *max_element(psum[17], psum[17]+60000);\n    ans += *max_element(psum[19], psum[19]+60000);\n    ans += *max_element(psum[23], psum[23]+60000);\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include <stack>\nusing namespace std;\nint gcd(int a,int b);\nbool bigprime(int a);\n\nint main(){\n\n  int n;\n  while(  cin >> n && n!=0){\n\n\n\n    \n    int data[25][24];\n    for(int i=0;i<25;i++){\n      for(int j=0;j<24;j++){\n\tdata[i][j]=0;\n      }\n    }\n    int day,now,inp;\n    for(int i=0;i<n;i++){\n      cin >> day >> now;\n      \n      for(int j=0;j<day;j++){\n\tcin >> inp;\n\t  data[day][(j+day-now)%day]+=inp;\n      }\n      \n    }\n\n    int ans=0,max=0,temp=0;\n  \n    for(int i=0;i<55440;i++){\n\n      for(int j=1;j<25;j++){\n\tif(!bigprime(j)){\n\t  temp+=data[j][i%j];\n\t}\n      }\n      if(temp>ans)ans=temp;\n      temp=0;\n    }\n    \n    for(int i=13;i<24;i++){\n      if(bigprime(i)){\n\tfor(int j=0;j<i;j++){\n\t  if(max<data[i][j])max=data[i][j];\n\t}\n\tans+=max;\n\tmax=0;\n      }\n    }\n    cout << ans << endl;\n  }\n}\n\nint gcd(int a,int b){\n  if(a<b){\n    int t=a;\n    a=b;\n    b=t;\n  }\n\n  if(b==0){\n    return a;\n  }else{\n    return gcd(b,a%b);\n  }\n}\n\nbool bigprime(int a){\n  if(a==13||a==19||a==17||a==23){\n    return true;\n  }else{\n    return false;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nconst ll LLINF = LLONG_MAX;\nint N,len[110];\n\nint main(){\n  while(cin>>N,N){\n    vector<ll> buf[N];\n    vector<ll> tmp[25];\n    rep(i,N){\n      int cur;\n      cin >> len[i] >> cur;\n      buf[i].resize(len[i]);\n      rep(j,len[i]){\n        cin >> buf[i][(j-cur+len[i])%len[i]];\n      }\n      if( tmp[len[i]].empty() ) tmp[len[i]] = buf[i];\n      else rep(j,len[i]) tmp[len[i]][j] += buf[i][j];\n    }\n\n    int cnt = 0,sp = 0;\n    rep(i,25) if( !tmp[i].empty() ) cnt++;\n    vector<ll> nbuf[cnt];\n    rep(i,25) if( !tmp[i].empty() ){\n      rep(j,tmp[i].size()) nbuf[sp].push_back(tmp[i][j]);\n      sp++;\n    }\n\n    ll ans = 0;\n    rep(i,nbuf[0].size()){\n      ll cost = nbuf[0][i];\n      REP(j,1,cnt){\n        set<int> used;\n        int cur = i % (int)nbuf[j].size();\n        ll tmp_max = nbuf[j][cur];\n        while(true){\n          if( used.find(cur) != used.end() ) break;\n          used.insert(cur);\n          tmp_max = max(tmp_max,nbuf[j][cur]);\n          ( cur += (int)nbuf[0].size() )  %= (int)nbuf[j].size();\n        }\n        cost += tmp_max;\n      }\n      ans = max(ans,cost);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0,acc[tmax];\n\t\tmemset(acc,0,sizeof(acc));\n\t\trep(loop,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(i,d) cin >> q[i];\n\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(i,tmax){\n\t\t\t\t\tint cur=(i+t)%tmax;\n\t\t\t\t\tcerr << cur << endl;\n\t\t\t\t\tacc[cur]+=q[i%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                const int a=p.first,b=q.first;\n                if(a==b) continue;\n                const int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v=x[c];\n                if(v.empty()) v.resize(c);\n                rep(i,0,c) v[i]+=p.second[i%a]+q.second[i%b];\n                if(a==c) rep(i,0,c) v[i]-=p.second[i];\n                if(b==c) rep(i,0,c) v[i]-=q.second[i];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\nconst int CYCLE = 2 * 2 * 2 * 2 * 3 * 3 * 5 * 7 * 11;\n\nint main(){\n  int N;\n  while(cin>>N && N){\n    int access[25][25] = {};\n    REP(i, N){\n      int cycle, offset; cin>>cycle>>offset;\n      REP(j, cycle){\n        int volume; cin>>volume;\n        access[cycle][(j - offset + cycle) % cycle] += volume;\n      }\n    }\n    vector<int> access_sum(CYCLE);\n    for(int cycle = 1; cycle <= 24; cycle++){\n      if(cycle == 11 || cycle == 13 || cycle == 17 || cycle == 23){\n        int max_a = 0;\n        REP(i, cycle) max_a = max(max_a, access[cycle][i]);\n        REP(i, CYCLE) access_sum[i] += max_a;\n      }else{\n        int idx = 0;\n        REP(i, CYCLE){\n          access_sum[i] += access[cycle][idx];\n          idx = (idx + 1) % cycle;\n        }\n      }\n    }\n    cout<<*max_element(access_sum.begin(), access_sum.end())<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                int a=p.first,b=q.first;\n                if(a==b) continue;\n                int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%a]+q.second[i%b];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst int INF=1e9;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\nint main()\n{\n\tfor(int n;cin>>n && n;){\n\t\tvvi q(n);\n\t\trep(i,n){\n\t\t\tint d,t; cin>>d>>t;\n\t\t\tq[i].resize(d);\n\t\t\trep(j,d) cin>>q[i][(t+j)%d];\n\t\t}\n\t\t\n\t\tvvi dp(n);\n\t\trep(i,n) dp[i].resize(q[i].size());\n\t\tdp[0]=q[0];\n\t\t\n\t\trepi(i,1,n){\n\t\t\tint g=__gcd(dp[i-1].size(),dp[i].size());\n\t\t\trep(j,q[i].size()) for(int k=j%g;k<q[i-1].size();k+=g)\n\t\t\t\tdp[i][j]=max(dp[i][j],q[i][j]+dp[i-1][k]);\n\t\t}\n\t\t\n\t\tcout<<*max_element(all(dp.back()))<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n\nconst int tmax=16*9*5*7*11;\nint acc[tmax];\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tint any=0;\n\t\tmemset(acc,0,sizeof(acc));\n\t\trep(i,n){\n\t\t\tint d,t;\n\t\t\tint q[24];\n\t\t\tcin >> d >> t;\n\t\t\trep(j,d) cin >> q[j];\n\n\t\t\tif(d==13||d==17||d==19||d==23)\n\t\t\t\tany+=*max_element(q,q+d);\n\t\t\telse{\n\t\t\t\trep(j,tmax){\n\t\t\t\t\tint cur=(j+t)%tmax;\n\t\t\t\t\tacc[cur]+=q[cur%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=*max_element(acc,acc+tmax)+any;\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j-t+d)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                const int a=p.first,b=q.first;\n                if(a==b) continue;\n                const int c=lcm(a,b),d=gcd(a,b);\n                if(d==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%a]+q.second[i%b];\n                x.erase(a);\n                x.erase(b);\n                x[c]=v;\n\n                update=true;\n                break;\n            }\n            if(update) break;\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PI;\n#define EPS (1e-6)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define min3(a,b,c) min((a),min((b),(c)))\n#define min4(a,b,c,d) min((a),min3((b),(c),(d)))\n#define SZ(a) (int)((a).size())\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) a.rbegin(),a.rend()\n#define FLL(a,b) memset((a),b,sizeof(a))\n#define CLR(a) memset((a),0,sizeof(a))\n#define declare(a,it) __typeof(a) it=(a)\n#define FOR(it,a) for(declare(a.begin(),it);it!=a.end();++it)\n#define FORR(it,a) for(declare(a.rbegin(),it);it!=a.rend();++it)\n\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, const pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, const vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\ntypedef double FP;\ntypedef complex<FP> pt;\ntypedef pt P;\ntypedef pair<pt,pt> line;\nnamespace std{\n  bool operator<(const P&a,const P&b){\n    if(abs(a.real()-b.real())>EPS)\n      return a.real()<b.real();\n    return a.imag()<b.imag();\n  }\n}\nFP dot(P a,P b){return real(conj(a)*b);}\nFP crs(P a,P b){return imag(conj(a)*b);}\nP ortho(P a){return P(imag(a),-real(a));}\nP ortho(line a){return ortho(a.S-a.F);}\nP crspt(P a,P b,P c,P d){b-=a,d-=c;return a+b*crs(d,c-a)/crs(d,b);}\nP crspt(line a,line b){return crspt(a.F,a.S,b.F,b.S);}\nbool onl(P a1,P a2,P b){return abs(b-a1)+abs(b-a2)<abs(a1-a2)+EPS;}\nbool onl(line a,P b){return onl(a.F,a.S,b);}\nbool iscrs(line a,line b){P c=crspt(a,b);return onl(a,c)&&onl(b,c);}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\nenum{TOP,BTM,LFT,RGT,FRT,BCK};\nint dxdy2ce[]={RGT,FRT,LFT,BCK};\nint s2i(string& a){stringstream ss(a);int r;ss>>r;return r;}\ntemplate<class T> T shift(T a,int b,int c,int d,int e){\n  __typeof(a[0])t=a[b];\n  a[b]=a[c];a[c]=a[d];a[d]=a[e];a[e]=t;return a;}\ntemplate<class T> T rgt(T a){return shift(a,TOP,LFT,BTM,RGT);}\ntemplate<class T> T lft(T a){return shift(a,TOP,RGT,BTM,LFT);}\ntemplate<class T> T frt(T a){return shift(a,TOP,BCK,BTM,FRT);}\ntemplate<class T> T bck(T a){return shift(a,TOP,FRT,BTM,BCK);}\nline mkl(P a,P v){return line(a,a+v);}\nFP lpdist(line a,P b){return abs(b-crspt(a,mkl(b,ortho(a))));}\nFP spdist(line a,P b){\n  P c(crspt(a,mkl(b,ortho(a))));\n  return onl(a,c)?abs(b-c):min(abs(a.F-b),abs(a.S-b));\n}\nFP ssdist(line a,line b){\n  return\n    iscrs(a,b)?0.:\n    min4(spdist(a,b.F),spdist(a,b.S),\n         spdist(b,a.F),spdist(b,a.S));\n}\n\nint n;\n\nvoid solve(){\n  vector<vector<int> > app;\n  \n  int ti[n];\n  \n  int lcm = 1;\n  rep(i,n){\n    int d,t;\n    cin >> d >> t;\n    ti[i] = t;\n    vector<int> q(d);\n    rep(j,d) cin >> q[j];\n    app.pb(q);\n    lcm = lcm/__gcd(lcm,d)*d;\n  }\n\n  vector<int> su(lcm);\n  //cout << lcm << endl;\n  rep(i,n)\n    rep(j,lcm)\n    su[j] += app[i][(j+ti[i])%SZ(app[i])];\n  \n  cout << *max_element(ALL(su)) << endl;\n}\n\nint main(int argc, char *argv[])\n{\n  while(cin >> n,n) solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main() {\n int N, d, t, q;\n while (cin >> N && N) {\n  int Q[25][25] = {{0}};\n  for (int i=0; i<N; ++i) {\n   cin >> d >> t;\n   for (int j=0; j<d; ++j) {\n    cin >> q;\n    Q[d][(j+d-t) % d] += q;\n   }\n  }\n  const int L = 55440;\n  int sum = 0;\n  int T[L] = {0};\n  for (int j=1; j<=24; ++j) {\n   if (j != 13 && j != 17 && j != 19 && j != 23 && j != 1) {\n    for (int i=0; i<L; ++i) { T[i] += Q[j][i % j]; }\n   }\n   else { sum += *max_element(Q[j],Q[j]+j); }\n  }\n  cout << sum + *max_element(T,T+L) << endl;\n }\n}\n"
  },
  {
    "language": "C++",
    "code": "// BEGIN CUT HERE\n#ifdef _MSC_VER\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric>\n#include <cctype>\n#include <tuple>\n#include <array>\n#include <climits>\n#include <bitset>\n#include <cassert>\n#include <unordered_map>\n#include <agents.h>\n#else\n// END CUT HERE\n#include <bits/stdc++.h>\n// BEGIN CUT HERE\n#endif\n// END CUT HERE\n\n#define FOR(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define REV(v) v.rbegin(), v.rend()\n#define MEMSET(v, s) memset(v, s, sizeof(v))\n#define UNIQUE(v) (v).erase(unique(ALL(v)), (v).end())\n#define MP make_pair\n#define MT make_tuple\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> P;\n\nconst int N = 1e5;\nint x[N];\nint sum[4][44];\n\nint main(){\n\tvector<int> num = { 13, 17, 19, 23 };\n\n\tint n;\n\twhile (cin >> n, n){\n\t\tMEMSET(x, 0);\n\t\tMEMSET(sum, 0);\n\t\trep(i, n){\n\t\t\tint d, t;\n\t\t\tcin >> d >> t;\n\t\t\tvector<int> q(d);\n\t\t\trep(j, d) cin >> q[(j - t + d) % d];\n\t\t\tint id = [&](){rep(j, 4) if (num[j] == d) return j; return -1; }();\n\t\t\tif (id >= 0){\n\t\t\t\trep(j, d) sum[id][j] += q[j];\n\t\t\t}\n\t\t\telse{\n\t\t\t\trep(j, N){\n\t\t\t\t\tx[j] += q[j%d];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = *max_element(x, x+N);\n\t\trep(i, 4) ans += *max_element(sum[i], sum[i] + 44);\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <bitset>\n\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n    int N;\n    \n    while(1){\n        cin >> N;\n        \n        if(!N)break;\n        \n        int q[100][24] = {0};\n        int d[100] = {0};\n        \n        for(int i=0; i<N; ++i){\n            int t;\n            cin >> d[i] >> t;\n            for(int j=0; j<d[i]; ++j){\n                cin >> q[i][(j + d[i] - t)%d[i]];\n            }\n        }\n        \n        const int M = 2*2*2*2*3*3*5*7*11;\n        ll sum[M] = {0};\n        ll sum13[13] = {0};\n        ll sum17[17] = {0};\n        ll sum19[19] = {0};\n        ll sum23[23] = {0};\n        \n        for(int i=0; i<N; ++i){\n            switch(d[i]){\n                case 13:for(int j=0; j<13; ++j){sum13[j] += q[i][j];}break;\n                case 17:for(int j=0; j<17; ++j){sum17[j] += q[i][j];}break;\n                case 19:for(int j=0; j<19; ++j){sum19[j] += q[i][j];}break;\n                case 23:for(int j=0; j<23; ++j){sum23[j] += q[i][j];}break;\n                default:{\n                    int cnt=0;\n                    while(cnt != M){\n                        for(int j=0; j<d[i]; ++j){\n                            sum[cnt] += q[i][j];\n                            ++cnt;\n                        }\n                    }\n                }break;\n            }\n        }\n        ll maxSum = 0, maxSum13 = 0, maxSum17 = 0, maxSum19 = 0, maxSum23 = 0;\n        for(int j=0; j<13; ++j){maxSum13 = max(maxSum13, sum13[j]);}\n        for(int j=0; j<17; ++j){maxSum17 = max(maxSum17, sum17[j]);}\n        for(int j=0; j<19; ++j){maxSum19 = max(maxSum19, sum19[j]);}\n        for(int j=0; j<23; ++j){maxSum23 = max(maxSum23, sum23[j]);}\n        for(int j=0; j<M; ++j){maxSum = max(maxSum, sum[j]);}\n        \n        cout << (maxSum + maxSum13 + maxSum17 + maxSum19 + maxSum23) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\n\n// 2 3 5 7 11 13 17 19 23\n// 13 17 19 23\n\nbool use[101];\nvector<ll> volume[101];\nint current_time[101];\nvector<ll> buf[101];\nint pm[4] = {13,17,19,23};\n\nint main(){\n  int N;\n  while( cin >> N, N ) {\n  ll lcm = 1;\n    rep(i,N) {\n      use[i] = false;\n      volume[i].clear();\n      buf[i].clear();\n    }\n    rep(i,N){\n      int size;\n      cin >> size;\n      volume[i].resize(size);\n      cin >> current_time[i];\n      rep(j,size) cin >> volume[i][j];\n      if( size != 13 && size != 17 && size != 19 && size != 23 ) {\n        lcm = lcm / __gcd(lcm,(ll)size) * (ll)size;\n        use[i] = true;\n      } else {\n        if( buf[size].empty() ) buf[size] = volume[i];\n        else rep(j,size) buf[size][j] += volume[i][j];\n      }\n    }\n    ll maxi = 0;\n    for(ll i=0;i<lcm;i++){\n      ll maxi_sub = 0;\n      rep(j,N) if( use[j] ){\n        maxi_sub += volume[j][current_time[j]];\n        ( current_time[j] += 1 ) %= (int)volume[j].size();\n      }\n      maxi = max(maxi,maxi_sub);\n    }\n    rep(i,4) {\n      ll maxi_sub = 0;\n      rep(j,buf[pm[i]].size()) maxi_sub = max(maxi_sub,buf[pm[i]][j]);\n      maxi += maxi_sub;\n    }\n    cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\ntypedef unsigned long long ullong;\n\nullong gcd(ullong a, ullong b){ return b==0?a: gcd(b, a%b);}\nullong lcm(ullong a, ullong b){ return a*(b/gcd(a, b));}\n\nbool isRP(int x){\n  if (  x == 13 || x == 17 || x == 19 || x == 23 ) return true;\n  return false;\n}\n\nmain(){\n  int N;\n  ullong D[100], S[100], T[100][24];\n  ullong lcm1, lcm2, max1, max2;\n\n  while(1){\n    cin >> N;\n    if ( N == 0 ) break;\n    lcm1 = lcm2 = 1;\n    max1 = max2 = 0;\n\n    for ( int i = 0; i < N; i++ ){\n      cin >> D[i] >> S[i];\n      for ( int j = 0; j < D[i]; j++ ) cin >> T[i][j];\n      if ( isRP(D[i])) {\n\tlcm2 = lcm(lcm2, D[i]);\n      } else {\n\tlcm1 = lcm(lcm1, D[i]);\n      }\n    }\n\n    for ( int j = 0; j < lcm1; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max1 = max(max1, sum);\n    }\n\n    for ( int j = 0; j < lcm2; j++ ){\n      ullong sum = 0;\n      for ( int i = 0; i < N; i++ ){\n\tif ( !isRP(D[i]) ) continue;      \n\tsum += T[i][(j+S[i])%D[i]];\n      }\n      max2 = max(max2, sum);\n    }\n\n    cout << max1 + max2 << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nconst int T=55440;\n\nint dp[33][T];\n\nsigned main(){\n  int n;\n  while(cin>>n,n){\n    int d[n],t[n];\n    int q[111][33];\n    for(int i=0;i<n;i++){\n      cin>>d[i]>>t[i];\n      for(int j=0;j<d[i];j++) cin>>q[i][j];\n    }\n    //puts(\"OK\");\n    memset(dp,0,sizeof(dp));\n    for(int i=0;i<n;i++){\n      //cout<<d[i]<<\" \"<<t[i]<<endl;\n      if(__gcd(d[i],T)==1){\n\tfor(int j=0;j<d[i];j++){\n\t  //cout<<q[i][j]<<endl;\n\t  dp[d[i]][j]+=q[i][(t[i]+j)%d[i]];\n\t}\n\tcontinue;\n      }\n      for(int j=0;j<T;j++){\n\tdp[0][j]+=q[i][(t[i]+j)%d[i]];\n      }\n    }\n    //for(int i=0;i<T;i++) cout<<dp[0][i]<<endl;\n    int ans=0;\n    for(int i=0;i<T;i++) ans=max(ans,dp[0][i]);\n    for(int i=1;i<=24;i++){\n      if(__gcd(i,T)==1){\n\tint tmp=0;\n\tfor(int j=0;j<i;j++) tmp=max(tmp,dp[i][j]);\n\tans+=tmp;\n      }\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nint main(){\n\tint N,d,t,q;\n\tconst int L = 16 * 9 * 5 * 7 * 11;\n\twhile(cin >> N && N){\n\t\tint Q[25][25] = {{0}};\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tcin >> d >> t;\n\t\t\tfor(int j = 0; j < d; j++){\n\t\t\t\tcin >> q;\n\t\t\t\tQ[d][(j+d-t)%d] += q;\n\t\t\t}\n\t\t}\n\t\tint sum = 0, T[L] = {0};\n\t\tfor(int d = 1; d <= 24; d++){\n\t\t\tif(d == 13 || d == 17 || d == 19 || d == 23)\n\t\t\t\tsum += *max_element(Q[d],Q[d]+d);\n\t\t\telse\n\t\t\t\tfor(int i = 0; i < L; i++) T[i] += Q[d][i%d];\n\t\t}\n\t\tcout << sum + *max_element(T,T+L) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <sstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <algorithm>\n#include <iostream>\n#include <utility>\n#include <set>\n#include <cctype>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\nusing namespace std;\n#define INF 100000000\n\ntypedef long long ll;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\n\nconst int L = 16 * 9 * 5 * 7 * 11;\n\nint main(void) {\n    int N;\n    while (cin >> N && N) {\n        int Q[25][25] = {{0}};\n        for (int i = 0; i < N; i++) {\n            int d, t;\n            cin >> d >> t;\n            for (int j = 0; j < d; j++) {\n                int q;\n                cin >> q;\n                Q[d][(j+d-t) % d] += q;\n            }\n        }\n        int sum = 0, T[L] = {0};\n        for (int d = 1; d <= 24; d++) {\n            if (d == 13 || d == 17 || d == 19 || d == 23) {\n                int ma = 0;\n                for (int i = 0; i < d; i++) ma = max(ma, Q[d][i]);\n                sum += ma;\n            } else {\n                for (int i = 0; i < L; i++) {\n                    T[i] += Q[d][i%d];\n                }\n            }\n        }\n        int ma = 0;\n        for (int i = 0; i < L; i++) ma = max(ma, T[i]);\n        cout << sum + ma << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int LCM = 55440;\nint sum[25][55555];\nint getMax(int d){\n    int mx = 0;\n    for(int i=0;i<d;i++)mx = max(mx, sum[d][i]);\n    return mx;\n}\nint main(){\n    for(int N;cin>>N, N;){\n        int ans = 0;\n        for(int i=0;i<25;i++){\n            for(int j=0;j<55555;j++){\n                sum[i][j]=0;\n            }\n        }\n        for(int n=0;n<N;n++){\n            int d, t;\n            cin>>d>>t;\n            vector<int>vec(d);\n            for(int i=0;i<d;i++){\n                cin>>vec[(i - t + d) % d];\n            }\n            if(d==13 || d==17 || d==19 || d==23){\n                for(int i=0;i<d;i++){\n                    sum[d][i] += vec[i];\n                }\n            }\n            else{\n                for(int i=0;i<LCM;i++){\n                    sum[0][i] += vec[i%d];\n                    ans = max(ans, sum[0][i]);\n                }\n            }\n        }\n        ans += getMax(13);\n        ans += getMax(17);\n        ans += getMax(19);\n        ans += getMax(23);\n        cout<<ans<<endl;\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include <stack>\nusing namespace std;\nint gcd(int a,int b);\nbool bigprime(int a);\n\nint main(){\n\n  int n;\n  while(  cin >> n && n!=0){\n\n\n\n    \n    int data[25][24];\n    for(int i=0;i<25;i++){\n      for(int j=0;j<24;j++){\n\tdata[i][j]=0;\n      }\n    }\n    int day,now,inp;\n    for(int i=0;i<n;i++){\n      cin >> day >> now;\n      \n      for(int j=0;j<day;j++){\n\tcin >> inp;\n\t  data[day][(j-now)%day]+=inp;\n      }\n      \n    }\n\n    int ans=0,max=0,temp=0;\n  \n    for(int i=0;i<55440;i++){\n\n      for(int j=1;j<25;j++){\n\tif(!bigprime(j)){\n\t  temp+=data[j][i%j];\n\t}\n      }\n      if(temp>ans)ans=temp;\n      temp=0;\n    }\n    \n    for(int i=13;i<24;i++){\n      if(bigprime(i)){\n\tfor(int j=0;j<i;j++){\n\t  if(max<data[i][j])max=data[i][j];\n\t}\n\tans+=max;\n\tmax=0;\n      }\n    }\n    cout << ans << endl;\n  }\n}\n\nint gcd(int a,int b){\n  if(a<b){\n    int t=a;\n    a=b;\n    b=t;\n  }\n\n  if(b==0){\n    return a;\n  }else{\n    return gcd(b,a%b);\n  }\n}\n\nbool bigprime(int a){\n  if(a==13||a==19||a==17||a==23){\n    return true;\n  }else{\n    return false;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n \nconst int T=55440;\n \nint dp[33][T];\n \nsigned main(){\n  int n;\n  while(cin>>n,n){\n    int d[n],t[n];\n    int q[111][33];\n    for(int i=0;i<n;i++){\n      cin>>d[i]>>t[i];\n      for(int j=0;j<d[i];j++) cin>>q[i][j];\n    }\n    //puts(\"OK\");\n    memset(dp,0,sizeof(dp));\n    for(int i=0;i<n;i++){\n      //cout<<d[i]<<\" \"<<t[i]<<endl;\n      if(__gcd(d[i],T)==1){\n\tfor(int j=0;j<d[i];j++){\n\t  //cout<<q[i][j]<<endl;\n\t  dp[d[i]][j]+=q[i][(t[i]+j)%d[i]];\n\t}\n\tcontinue;\n      }\n      for(int j=0;j<T;j++){\n\tdp[0][j]+=q[i][(t[i]+j)%d[i]];\n      }\n    }\n    //for(int i=0;i<T;i++) cout<<dp[0][i]<<endl;\n    int ans=0;\n    for(int i=0;i<T;i++) ans=max(ans,dp[0][i]);\n    for(int i=1;i<=24;i++){\n      if(__gcd(i,T)==1){\n\tint tmp=0;\n\tfor(int j=0;j<i;j++) tmp=max(tmp,dp[i][j]);\n\tans+=tmp;\n      }\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nint64_t gcd(int64_t a,int64_t b){\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\nint64_t lcm(int64_t a,int64_t b){\n\treturn a/gcd(a,b)*b;\n}\n\nvoid solve(int n){\n    map<int,vector<int>> x;\n    rep(i,0,n){\n        int d,t;\n        cin >> d >> t;\n        if(x.find(d)==x.end()) x[d].resize(d);\n        rep(j,0,d){\n            int a;\n            cin >> a;\n            x[d][(j+t)%d]+=a;\n        }\n    }\n\n    for(;;){\n        bool update=false;\n        for(auto &p:x){\n            for(auto &q:x){\n                if(p.first==q.first) continue;\n                int c=lcm(p.first,q.first);\n                if(c==1) continue;\n                vector<int> v(c);\n                rep(i,0,c) v[i]=p.second[i%p.first]+q.second[i%q.first];\n                x.erase(p.first);\n                x.erase(q.first);\n                x[c]=v;\n\n                update=true;\n            }\n        }\n        if(!update) break;\n    }\n\n    int ans=0;\n    for(auto &p:x){\n        int ma=0;\n        for(int a:p.second) ma=max(ma,a);\n        ans+=ma;\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    for(;;){\n        int n;\n        cin >> n;\n        if(!n) break;\n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2162: Galaxy Wide Web Service\n// 2017.12.13 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\n#define MAX1 55440\n#define MAX2 96577\n\nint a[MAX1+1], b[MAX2+1];\nint p1, p2;\nint q[25][25];\nchar f[25], chk[25];\nchar buf[205], *p;\n\nint getint(void)\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\tp++;\n\treturn n;\n}\n\nint gcd(int a, int b)\n{\n\tint r;\n\twhile (b != 0) r = a % b, a = b, b = r;\n\treturn a;\n}\n\nint lcm(int a, int b)\n{\n\treturn a/gcd(a, b)*b;\n}\n\nint main()\n{\n\tint n, i, j, jj, k, d, t, ans1, ans2;\n\n\tchk[13] = chk[17] = chk[19] = chk[23] = 1;\n\n\twhile (fgets(p=buf, 10, stdin) && *p != '0') {\n\t\tn = getint();\n\n\t\tmemset(q, 0, sizeof(q));\n\t\tmemset(f, 1, sizeof(f));\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tfgets(p=buf, 205, stdin);\n\t\t\td = getint(), t = getint(); f[d] = 0;\n\t\t\tjj = 0; if (t > 0) jj = d-t; \t\t\t\n\t\t\tj = d; while (j--) {\n\t\t\t\tq[d][jj] += getint();\n\t\t\t\tif (++jj == d) jj = 0;\n\t\t\t}\n\t\t}\n\n\t\tp1 = p2 = 1;\n\t\tfor (d = 1; d <= 24; d++) {\n\t\t\tif (f[d]) continue;\n\t\t\tif (chk[d]) p2 *= d;\n\t\t\telse p1 = lcm(p1, d);\n\t\t}\n\n\t\tmemset(a, 0, sizeof(int)*p1);\n\t\tmemset(b, 0, sizeof(int)*p2);\n\n\t\tfor (d = 1; d <= 24; d++) {\n\t\t\tif (f[d]) continue;\n\t\t\tif (chk[d]) {\n\t\t\t\tfor (i = 0; i < d; i++) {\n\t\t\t\t\tk = q[d][i];\n\t\t\t\t\tfor (j = i; j < p2; j += d) b[j] += k;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (i = 0; i < d; i++) {\n\t\t\t\t\tk = q[d][i];\n\t\t\t\t\tfor (j = i; j < p1; j += d) a[j] += k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans1 = 0; for (i = 0; i < p1; i++) if (a[i] > ans1) ans1 = a[i];\n\t\tans2 = 0; for (i = 0; i < p2; i++) if (b[i] > ans2) ans2 = b[i];\n\t\tprintf(\"%d\\n\", ans1+ans2);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2162: Galaxy Wide Web Service\n// 2017.12.13 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\n#define MAX1 55440\n\nint a[MAX1+1];\nint q[25][25];\nchar f[25], chk[25];\nchar buf[205], *bp;\n\nint getint(void)\n{\n\tint n = 0;\n\twhile (*bp >= '0') n = (n<<3) + (n<<1) + (*bp++ & 0xf);\n\tbp++;\n\treturn n;\n}\n\nint gcd(int a, int b)\n{\n\tint r;\n\twhile (b != 0) r = a % b, a = b, b = r;\n\treturn a;\n}\n\nint lcm(int a, int b)\n{\n\treturn a/gcd(a, b)*b;\n}\n\nint main()\n{\n\tint n, i, j, jj, k, d, t, p, ans1, ans;\n\n\tchk[13] = chk[17] = chk[19] = chk[23] = 1;\n\n\twhile (fgets(bp=buf, 10, stdin) && *bp != '0') {\n\t\tn = getint();\n\n\t\tmemset(q, 0, sizeof(q));\n\t\tmemset(f, 1, sizeof(f));\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tfgets(bp=buf, 205, stdin);\n\t\t\td = getint(), t = getint(); f[d] = 0;\n\t\t\tjj = d-t; \t\t\t\n\t\t\tj = d; while (j--) {\n\t\t\t\tif (jj == d) jj = 0;\n\t\t\t\tq[d][jj++] += getint();\n\t\t\t}\n\t\t}\n\n\t\tp = 1;\n\t\tfor (d = 1; d <= 24; d++) {\n\t\t\tif (f[d]) continue;\n\t\t\tif (!chk[d]) p = lcm(p, d);\n\t\t}\n\n\t\tmemset(a, 0, sizeof(int)*p);\n\n\t\tans = 0;\n\t\tfor (d = 1; d <= 24; d++) {\n\t\t\tif (f[d]) continue;\n\t\t\tif (chk[d]) {\n\t\t\t\tk = 0;\n\t\t\t\tfor (i = 0; i < d; i++) {\n\t\t\t\t\tif (q[d][i] > k) k = q[d][i];\n\t\t\t\t}\n\t\t\t\tans += k;\n\t\t\t} else {\n\t\t\t\tfor (i = 0; i < d; i++) {\n\t\t\t\t\tk = q[d][i];\n\t\t\t\t\tfor (j = i; j < p; j += d) a[j] += k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans1 = 0; for (i = 0; i < p; i++) if (a[i] > ans1) ans1 = a[i];\n\t\tprintf(\"%d\\n\", ans+ans1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2162: Galaxy Wide Web Service\n// 2017.12.13 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\n#define MAX1 55440\n#define MAX2 96577\n\nint a[MAX1+1], b[MAX2+1];\nchar chk[25], f[25];\nint p1, p2;\n\ntypedef struct { int d, t, q[24]; } T;\nT tbl[101];\nchar buf[205], *p;\n\nint getint(void)\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\tp++;\n\treturn n;\n}\n\nint gcd(int a, int b)\n{\n\tint r;\n\twhile (b != 0) r = a % b, a = b, b = r;\n\treturn a;\n}\n\nint lcm(int a, int b)\n{\n\treturn a/gcd(a, b)*b;\n}\n\nint main()\n{\n\tint n, i, j, jj, k, d, t, q, ans1, ans2;\n\n\tchk[13] = chk[17] = chk[19] = chk[23] = 1;\n\n\twhile (fgets(p=buf, 10, stdin) && *p != '0') {\n\t\tn = getint();\n\n\n\t\tmemset(f, 0, sizeof(f));\n\t\tp1 = p2 = 1;\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tfgets(p=buf, 205, stdin);\n\t\t\td = getint(), t = getint();\n\t\t\tif (chk[d]) {\n\t\t\t\tif (!f[d]) f[d] = 1, p2 *= d;\n\t\t\t} else p1 = lcm(p1, d);\n\t\t\t\n\t\t\ttbl[i].d = d, tbl[i].t = t;\n\t\t\tfor (j = 0; j < d; j++) tbl[i].q[j] = getint();\n\t\t}\n\n\t\tmemset(a, 0, sizeof(int)*p1);\n\t\tmemset(b, 0, sizeof(int)*p2);\n\n\t\tfor (i = 0; i < n; i++) {\n\t\t\td = tbl[i].d, t = tbl[i].t;\n\t\t\tif (chk[d]) {\n\t\t\t\tfor (jj = t-1, j = 0; j < d; j++) {\n\t\t\t\t\tif (++jj == d) jj = 0;\n\t\t\t\t\tq = tbl[i].q[jj];\n\t\t\t\t\tfor (k = j; k < p2; k += d) b[k] += q;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (jj = t-1, j = 0; j < d; j++) {\n\t\t\t\t\tif (++jj == d) jj = 0;\n\t\t\t\t\tq = tbl[i].q[jj];\n\t\t\t\t\tfor (k = j; k < p1; k += d) a[k] += q;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans1 = 0; for (i = 0; i < p1; i++) if (a[i] > ans1) ans1 = a[i];\n\t\tans2 = 0; for (i = 0; i < p2; i++) if (b[i] > ans2) ans2 = b[i];\n\t\tprintf(\"%d\\n\", ans1+ans2);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint[] h = new int[600];\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint t = sc.nextInt();\n\t\t\t\tint[] a = new int[d];\n\t\t\t\tfor(int j=0;j<d;j++)a[j]=sc.nextInt();\n\t\t\t\tint j = t;\n\t\t\t\twhile(j<600)h[j]+=a[j++%d];\n\t\t\t\tj = t-1;\n\t\t\t\twhile(j>=0){\n\t\t\t\t\th[j]+=a[(j+d)%d];\n\t\t\t\t\tj--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(int i=0;i<600;i++)max = Math.max(max, h[i]);\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint[][] h = new int[n][600];\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint t = sc.nextInt();\n\t\t\t\tint[] a = new int[d];\n\t\t\t\tfor(int j=0;j<d;j++)a[j]=sc.nextInt();\n\t\t\t\tfor(int j=0;j<600;j++)h[t][j]+=a[j%d];\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(int t=0;t<n;t++)for(int i=0;i<600;i++)max = Math.max(max, h[t][i]);\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint[][] t = new int[n][600];\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint k = sc.nextInt();\n\t\t\t\tsc.nextInt();\n\t\t\t\tint[] a = new int[k];\n\t\t\t\tfor(int j=0;j<k;j++)a[j]=sc.nextInt();\n\t\t\t\tfor(int j=0;j<600;j++)t[i][j] = a[j%k];\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(int j=0;j<600;j++){\n\t\t\t\tint sum = 0;\n\t\t\t\tfor(int i=0;i<n;i++)sum+=t[i][j];\n\t\t\t\tmax = Math.max(max, sum);\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint[] h = new int[600];\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint t = sc.nextInt();\n\t\t\t\tint[] a = new int[d];\n\t\t\t\tfor(int j=0;j<d;j++)a[j]=sc.nextInt();\n\t\t\t\tfor(int j=0;j<600;j++)h[j]+=a[(j+t)%d];\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(int i=0;i<600;i++)max = Math.max(max, h[i]);\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.HashMap;\nimport java.util.Map;\nimport java.util.Scanner;\n\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tMap<Integer, int[]> map = new HashMap<Integer, int[]>();\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint t = sc.nextInt();\n\t\t\t\tif(!map.containsKey(t))map.put(t, new int[600]);\n\t\t\t\tint[] a = new int[d];\n\t\t\t\tfor(int j=0;j<d;j++)a[j]=sc.nextInt();\n\t\t\t\tint[] h = map.get(t);\n\t\t\t\tfor(int j=0;j<600;j++)h[j]+=a[j%d];\n\t\t\t\tmap.put(t, h);\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(int t:map.keySet()){\n\t\t\t\tint[] h = map.get(t);\n\t\t\t\tfor(int s:h)max = Math.max(max, s);\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\n\nclass MyClass\n{\n    static void Main(string[] args)\n    {\n        int N, d, t, q;\n        while ((N = int.Parse(Console.ReadLine())) != 0)\n        {\n            int[][] Q = new int[25][];\n            for (int i = 0; i < 25; i++)\n            {\n                Q[i] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };\n            }\n            for (int i = 0; i < N; i++)\n            {\n                string[] str = Console.ReadLine().Split(' ');\n                d = int.Parse(str[0]);\n                t = int.Parse(str[1]);\n                for (int j = 0; j < d; j++)\n                {\n                    q = int.Parse(str[j + 2]);\n                    Q[d][(j + d - t) % d] += q;\n                }\n            }\n            const int L = 55440;\n            int sum = 0;\n            int[] T = new int[L];\n            for (int i = 0; i < L; i++)\n            {\n                T[i] = 0;\n            }\n            for (int i = 1; i <= 24; i++)\n            {\n                if (i != 13 && i != 17 && i != 19 && i != 23)\n                {\n                    for (int j = 0; j < L; j++)\n                    {\n                        T[j] += Q[i][j % i];\n                    }\n                }\n                else\n                {\n                    sum += Q[i].Max();\n                }\n            }\n            Console.WriteLine(sum + T.Max());\n        }\n    }\n}\n"
  },
  {
    "language": "Ruby",
    "code": "def gcd(m, n)\n    if m < n \n        gcd(n, m)\n    elsif n == 0\n        m   \n    else\n        gcd(n, m % n)\n    end \nend\n\ndef lcm(m, n)\n    m * n / gcd(m, n)\nend\n\nrequire 'prime'\n\nCYCLE = (1..24).reject {|x| Prime.prime?(x)}.inject {|r, x| lcm(r, x)} \n\nloop do\n    n = gets.to_i\n    break if n == 0\n    cycles = {CYCLE => [0] * CYCLE}\n    n.times do\n        d, t, *qs = gets.split.map(&:to_i)\n        qs.rotate!(-d)\n        if Prime.prime?(d) && d * 2 > 24\n            if cycles[d]\n                cycles[d] = cycles[d].zip(qs).map {|x, y| x + y}\n            else\n                cycles[d] = qs\n            end \n        else\n            qs *= CYCLE / qs.size\n            cycles[CYCLE] = cycles[CYCLE].zip(qs).map {|x, y| x + y}\n        end \n    end \n    p cycles.values.map(&:max).inject(:+)\nend"
  },
  {
    "language": "Ruby",
    "code": "def gcd(m, n)\n    if m < n \n        gcd(n, m)\n    elsif n == 0\n        m   \n    else\n        gcd(n, m % n)\n    end \nend\n\ndef lcm(m, n)\n    m * n / gcd(m, n)\nend\n\nrequire 'prime'\n\nCYCLE = (1..24).reject {|x| Prime.prime?(x)}.inject {|r, x| lcm(r, x)} \n\nloop do\n    n = gets.to_i\n    break if n == 0\n    cycles = {CYCLE => [0] * CYCLE}\n    n.times do\n        d, t, *qs = gets.split.map(&:to_i)\n        qs.rotate!(t)\n        if Prime.prime?(d) && d * 2 > 24\n            if cycles[d]\n                cycles[d] = cycles[d].zip(qs).map {|x, y| x + y}\n            else\n                cycles[d] = qs\n            end \n        else\n            qs *= CYCLE / qs.size\n            cycles[CYCLE] = cycles[CYCLE].zip(qs).map {|x, y| x + y}\n        end \n    end \n    p cycles.values.map(&:max).inject(:+)\nend"
  },
  {
    "language": "Ruby",
    "code": "def gcd(m, n)\n    if m < n \n        gcd(n, m)\n    elsif n == 0\n        m   \n    else\n        gcd(n, m % n)\n    end \nend\n\ndef lcm(m, n)\n    m * n / gcd(m, n)\nend\n\nrequire 'prime'\n\nCYCLE = (1..24).reject {|x| Prime.prime?(x)}.inject {|r, x| lcm(r, x)} \n\nloop do\n    n = gets.to_i\n    break if n == 0\n    cycles = {CYCLE => [0] * CYCLE}\n    n.times do\n        d, t, *qs = gets.split.map(&:to_i)\n        qs.rotate!(-d)\n        if Prime.prime?(d) && d * 2 > 24\n            if cycles[d]\n                cycles[d] = cycles[d].zip(qs).map {|x, y| x + y}\n            else\n                cycles[d] = qs\n            end \n        else\n            qs *= CYCLE / qs.size\n            cycles[CYCLE] = cycles[CYCLE].zip(qs).map {|x, y| x + y}\n        end \n    end \n    p cycles.values.map(&:max).inject(:*)\nend"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nwrite = sys.stdout.write\n\ndef gcd(m, n):\n    while n:\n        m, n = n, m % n\n    return m\ndef lcm(m, n):\n    return m // gcd(m, n) * n\ndef solve():\n    N = int(readline())\n    if N == 0:\n        return False\n\n    pp = [13, 17, 19, 23]\n    E = [[0]*i for i in range(25)]\n    Q = []\n    for i in range(N):\n        d, t, *qs = map(int, readline().split())\n        qs = qs[t:] + qs[:t]\n        Ed = E[d]\n        for i in range(d):\n            Ed[i] += qs[i]\n    L = 13860\n    V = [0]*L\n    for i in range(1, 25):\n        if i in pp:\n            continue\n        if i <= 12:\n            Ei = E[i]; Ej = E[2*i]\n            for j in range(2*i):\n                Ej[j] += Ei[j % i]\n        else:\n            Ei = E[i]\n            if i == 16:\n                for j in range(8):\n                    Ei[j] = max(Ei[j+8], Ei[j])\n                Ej = E[24]\n                for j in range(24):\n                    Ej[j] += Ei[j % 8]\n            elif i == 24:\n                for j in range(12):\n                    Ei[j] = max(Ei[j+12], Ei[j])\n                for j in range(L):\n                    V[j] += Ei[j % 12]\n            else:\n                for j in range(L):\n                    V[j] += Ei[j % i]\n    ans = max(V)\n    for i in pp:\n        ans += max(E[i])\n    write(\"%d\\n\" % ans)\n    return True\nwhile solve():\n    ...\n"
  },
  {
    "language": "Python",
    "code": "from itertools import cycle\n\nwhile True:\n    n = int(input())\n    if not n:\n        break\n    qs = {}\n    for i in range(n):\n        d, t, *q = (int(s) for s in input().split())\n        q = q[t:] + q[:t]\n        if d not in qs:\n            qs[d] = q\n        else:\n            qs[d] = [a + b for a, b in zip(qs[d], q)]\n    L = 16 * 9 * 5 * 7 * 11\n    ps = [13, 17, 19, 23, 1]\n    psum = sum(max(qs.pop(i, [0])) for i in ps)\n    qmax = max(sum(j) for i, j in zip(range(L-1),\n                                      zip(*[cycle(q) for q in qs.values()])\n                                      )\n               )\n    print(psum + qmax)"
  }
]